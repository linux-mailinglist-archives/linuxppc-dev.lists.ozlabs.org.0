Return-Path: <linuxppc-dev-bounces+lists+linuxppc-dev=lfdr.de@lists.ozlabs.org>
X-Original-To: lists+linuxppc-dev@lfdr.de
Delivered-To: lists+linuxppc-dev@lfdr.de
Received: from lists.ozlabs.org (lists.ozlabs.org [203.11.71.2])
	by mail.lfdr.de (Postfix) with ESMTPS id 7E4E820FDEC
	for <lists+linuxppc-dev@lfdr.de>; Tue, 30 Jun 2020 22:44:53 +0200 (CEST)
Received: from bilbo.ozlabs.org (lists.ozlabs.org [IPv6:2401:3900:2:1::3])
	by lists.ozlabs.org (Postfix) with ESMTP id 49xGZB5Jj7zDqsD
	for <lists+linuxppc-dev@lfdr.de>; Wed,  1 Jul 2020 06:44:50 +1000 (AEST)
X-Original-To: linuxppc-dev@lists.ozlabs.org
Delivered-To: linuxppc-dev@lists.ozlabs.org
Authentication-Results: lists.ozlabs.org; spf=pass (sender SPF authorized)
 smtp.mailfrom=csgroup.eu (client-ip=93.17.236.30; helo=pegase1.c-s.fr;
 envelope-from=christophe.leroy@csgroup.eu; receiver=<UNKNOWN>)
Authentication-Results: lists.ozlabs.org;
 dmarc=none (p=none dis=none) header.from=csgroup.eu
Received: from pegase1.c-s.fr (pegase1.c-s.fr [93.17.236.30])
 (using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
 (No client certificate requested)
 by lists.ozlabs.org (Postfix) with ESMTPS id 49x9fB0R31zDqbv
 for <linuxppc-dev@lists.ozlabs.org>; Wed,  1 Jul 2020 03:02:54 +1000 (AEST)
Received: from localhost (mailhub1-int [192.168.12.234])
 by localhost (Postfix) with ESMTP id 49x9dx72Jwz9v1cN;
 Tue, 30 Jun 2020 19:02:44 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at c-s.fr
Received: from pegase1.c-s.fr ([192.168.12.234])
 by localhost (pegase1.c-s.fr [192.168.12.234]) (amavisd-new, port 10024)
 with ESMTP id qLfwWsc_D0Eu; Tue, 30 Jun 2020 19:02:44 +0200 (CEST)
Received: from messagerie.si.c-s.fr (messagerie.si.c-s.fr [192.168.25.192])
 by pegase1.c-s.fr (Postfix) with ESMTP id 49x9dv2tSdz9v1c5;
 Tue, 30 Jun 2020 19:02:43 +0200 (CEST)
Received: from localhost (localhost [127.0.0.1])
 by messagerie.si.c-s.fr (Postfix) with ESMTP id 7F2C38B7E7;
 Tue, 30 Jun 2020 19:02:45 +0200 (CEST)
X-Virus-Scanned: amavisd-new at c-s.fr
Received: from messagerie.si.c-s.fr ([127.0.0.1])
 by localhost (messagerie.si.c-s.fr [127.0.0.1]) (amavisd-new, port 10023)
 with ESMTP id 588JzexpGxRB; Tue, 30 Jun 2020 19:02:44 +0200 (CEST)
Received: from [192.168.4.90] (unknown [192.168.4.90])
 by messagerie.si.c-s.fr (Postfix) with ESMTP id 79FF28B7E5;
 Tue, 30 Jun 2020 19:02:16 +0200 (CEST)
Subject: Re: [PATCH v2] powerpc/uaccess: Use flexible addressing with
 __put_user()/__get_user()
To: Segher Boessenkool <segher@kernel.crashing.org>
References: <c2addbd9d76212242d3d8554a2f7ff849fb08b85.1587040754.git.christophe.leroy@c-s.fr>
 <7b916759-1683-b4df-0d4b-b04b3fcd9a02@csgroup.eu>
 <878sg6862r.fsf@mpe.ellerman.id.au> <875zb98i5a.fsf@mpe.ellerman.id.au>
 <311c3471-cad7-72d5-a5e6-04cf892c5e41@csgroup.eu>
 <20200630163324.GW3598@gate.crashing.org>
From: Christophe Leroy <christophe.leroy@csgroup.eu>
Message-ID: <b1f598dd-ecb7-de88-8c9c-d47b6a5ec9de@csgroup.eu>
Date: Tue, 30 Jun 2020 19:02:16 +0200
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:68.0) Gecko/20100101
 Thunderbird/68.9.0
MIME-Version: 1.0
In-Reply-To: <20200630163324.GW3598@gate.crashing.org>
Content-Type: multipart/mixed; boundary="------------8566AE628493B5C35158C76F"
Content-Language: fr
X-Mailman-Approved-At: Wed, 01 Jul 2020 06:41:20 +1000
X-BeenThere: linuxppc-dev@lists.ozlabs.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Linux on PowerPC Developers Mail List <linuxppc-dev.lists.ozlabs.org>
List-Unsubscribe: <https://lists.ozlabs.org/options/linuxppc-dev>,
 <mailto:linuxppc-dev-request@lists.ozlabs.org?subject=unsubscribe>
List-Archive: <http://lists.ozlabs.org/pipermail/linuxppc-dev/>
List-Post: <mailto:linuxppc-dev@lists.ozlabs.org>
List-Help: <mailto:linuxppc-dev-request@lists.ozlabs.org?subject=help>
List-Subscribe: <https://lists.ozlabs.org/listinfo/linuxppc-dev>,
 <mailto:linuxppc-dev-request@lists.ozlabs.org?subject=subscribe>
Cc: linux-kernel@vger.kernel.org, npiggin@gmail.com,
 Paul Mackerras <paulus@samba.org>, linuxppc-dev@lists.ozlabs.org
Errors-To: linuxppc-dev-bounces+lists+linuxppc-dev=lfdr.de@lists.ozlabs.org
Sender: "Linuxppc-dev"
 <linuxppc-dev-bounces+lists+linuxppc-dev=lfdr.de@lists.ozlabs.org>

This is a multi-part message in MIME format.
--------------8566AE628493B5C35158C76F
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 8bit



Le 30/06/2020 à 18:33, Segher Boessenkool a écrit :
> On Tue, Jun 30, 2020 at 04:55:05PM +0200, Christophe Leroy wrote:
>> Le 30/06/2020 à 03:19, Michael Ellerman a écrit :
>>> Michael Ellerman <mpe@ellerman.id.au> writes:
>>>> Because it uses the "m<>" constraint which didn't work on GCC 4.6.
>>>>
>>>> https://github.com/linuxppc/issues/issues/297
>>>>
>>>> So we should be able to pick it up for v5.9 hopefully.
>>>
>>> It seems to break the build with the kernel.org 4.9.4 compiler and
>>> corenet64_smp_defconfig:
>>
>> Looks like 4.9.4 doesn't accept "m<>" constraint either.
> 
> The evidence contradicts this assertion.
> 
>> Changing it to "m" make it build.
> 
> But that just means something else is wrong.
> 
>>> + make -s CC=powerpc64-linux-gnu-gcc -j 160
>>> In file included from /linux/include/linux/uaccess.h:11:0,
>>>                   from /linux/include/linux/sched/task.h:11,
>>>                   from /linux/include/linux/sched/signal.h:9,
>>>                   from /linux/include/linux/rcuwait.h:6,
>>>                   from /linux/include/linux/percpu-rwsem.h:7,
>>>                   from /linux/include/linux/fs.h:33,
>>>                   from /linux/include/linux/huge_mm.h:8,
>>>                   from /linux/include/linux/mm.h:675,
>>>                   from /linux/arch/powerpc/kernel/signal_32.c:17:
>>> /linux/arch/powerpc/kernel/signal_32.c: In function
>>> 'save_user_regs.isra.14.constprop':
>>> /linux/arch/powerpc/include/asm/uaccess.h:161:2: error: 'asm' operand has
>>> impossible constraints
>>>    __asm__ __volatile__(     \
>>>    ^
>>> /linux/arch/powerpc/include/asm/uaccess.h:197:12: note: in expansion of
>>> macro '__put_user_asm'
>>>      case 4: __put_user_asm(x, ptr, retval, "stw"); break; \
>>>              ^
>>> /linux/arch/powerpc/include/asm/uaccess.h:206:2: note: in expansion of
>>> macro '__put_user_size_allowed'
>>>    __put_user_size_allowed(x, ptr, size, retval);  \
>>>    ^
>>> /linux/arch/powerpc/include/asm/uaccess.h:220:2: note: in expansion of
>>> macro '__put_user_size'
>>>    __put_user_size(__pu_val, __pu_addr, __pu_size, __pu_err); \
>>>    ^
>>> /linux/arch/powerpc/include/asm/uaccess.h:96:2: note: in expansion of
>>> macro '__put_user_nocheck'
>>>    __put_user_nocheck((__typeof__(*(ptr)))(x), (ptr), sizeof(*(ptr)))
>>>    ^
>>> /linux/arch/powerpc/kernel/signal_32.c:120:7: note: in expansion of macro
>>> '__put_user'
>>>     if (__put_user((unsigned int)gregs[i], &frame->mc_gregs[i]))
>>>         ^
> 
> Can we see what that was after the macro jungle?  Like, the actual
> preprocessed code?

Preprocessor output attached

> 
> Also, what GCC version *does* work on this?

Among the versions available in kernel.org crosstool
4.7.3 is too old
4.8.5 has this error
4.9.4 has this error
5.5.0 works

With 4.9.4:
- it also fails with powerpc64e_defconfig
- it works with mpc885_ads_defconfig and with powerpc64_defconfig

Christophe

--------------8566AE628493B5C35158C76F
Content-Type: text/plain; charset=UTF-8;
 name="signal_32.E"
Content-Transfer-Encoding: base64
Content-Disposition: attachment;
 filename="signal_32.E"

IyAxICJhcmNoL3Bvd2VycGMva2VybmVsL3NpZ25hbF8zMi5jIgojIDEgIi9ob21lL2Nocmlz
dG9waGUvbGludXgtcG93ZXJwYy8vIgojIDEgIjxidWlsdC1pbj4iCiMgMSAiPGNvbW1hbmQt
bGluZT4iCiMgMSAiLi8uL2luY2x1ZGUvbGludXgva2NvbmZpZy5oIiAxCgoKCgoKCiMgMSAi
Li9pbmNsdWRlL2dlbmVyYXRlZC9hdXRvY29uZi5oIiAxCiMgOCAiLi8uL2luY2x1ZGUvbGlu
dXgva2NvbmZpZy5oIiAyCiMgMSAiPGNvbW1hbmQtbGluZT4iIDIKIyAxICIuLy4vaW5jbHVk
ZS9saW51eC9jb21waWxlcl90eXBlcy5oIiAxCiMgNTkgIi4vLi9pbmNsdWRlL2xpbnV4L2Nv
bXBpbGVyX3R5cGVzLmgiCiMgMSAiLi9pbmNsdWRlL2xpbnV4L2NvbXBpbGVyX2F0dHJpYnV0
ZXMuaCIgMQojIDYwICIuLy4vaW5jbHVkZS9saW51eC9jb21waWxlcl90eXBlcy5oIiAyCiMg
NjggIi4vLi9pbmNsdWRlL2xpbnV4L2NvbXBpbGVyX3R5cGVzLmgiCiMgMSAiLi9pbmNsdWRl
L2xpbnV4L2NvbXBpbGVyLWdjYy5oIiAxCiMgNjkgIi4vLi9pbmNsdWRlL2xpbnV4L2NvbXBp
bGVyX3R5cGVzLmgiIDIKIyA4NSAiLi8uL2luY2x1ZGUvbGludXgvY29tcGlsZXJfdHlwZXMu
aCIKc3RydWN0IGZ0cmFjZV9icmFuY2hfZGF0YSB7CiBjb25zdCBjaGFyICpmdW5jOwogY29u
c3QgY2hhciAqZmlsZTsKIHVuc2lnbmVkIGxpbmU7CiB1bmlvbiB7CiAgc3RydWN0IHsKICAg
dW5zaWduZWQgbG9uZyBjb3JyZWN0OwogICB1bnNpZ25lZCBsb25nIGluY29ycmVjdDsKICB9
OwogIHN0cnVjdCB7CiAgIHVuc2lnbmVkIGxvbmcgbWlzczsKICAgdW5zaWduZWQgbG9uZyBo
aXQ7CiAgfTsKICB1bnNpZ25lZCBsb25nIG1pc3NfaGl0WzJdOwogfTsKfTsKCnN0cnVjdCBm
dHJhY2VfbGlrZWx5X2RhdGEgewogc3RydWN0IGZ0cmFjZV9icmFuY2hfZGF0YSBkYXRhOwog
dW5zaWduZWQgbG9uZyBjb25zdGFudDsKfTsKIyAxICI8Y29tbWFuZC1saW5lPiIgMgojIDEg
ImFyY2gvcG93ZXJwYy9rZXJuZWwvc2lnbmFsXzMyLmMiCiMgMTYgImFyY2gvcG93ZXJwYy9r
ZXJuZWwvc2lnbmFsXzMyLmMiCiMgMSAiLi9pbmNsdWRlL2xpbnV4L3NjaGVkLmgiIDEKIyAx
MCAiLi9pbmNsdWRlL2xpbnV4L3NjaGVkLmgiCiMgMSAiLi9pbmNsdWRlL3VhcGkvbGludXgv
c2NoZWQuaCIgMQoKCgoKIyAxICIuL2luY2x1ZGUvbGludXgvdHlwZXMuaCIgMQoKCgoKCiMg
MSAiLi9pbmNsdWRlL3VhcGkvbGludXgvdHlwZXMuaCIgMQoKCgoKIyAxICIuL2FyY2gvcG93
ZXJwYy9pbmNsdWRlL2FzbS90eXBlcy5oIiAxCiMgMTIgIi4vYXJjaC9wb3dlcnBjL2luY2x1
ZGUvYXNtL3R5cGVzLmgiCiMgMSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS91YXBpL2FzbS90
eXBlcy5oIiAxCiMgMjggIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvdWFwaS9hc20vdHlwZXMu
aCIKIyAxICIuL2luY2x1ZGUvYXNtLWdlbmVyaWMvaW50LWxsNjQuaCIgMQojIDExICIuL2lu
Y2x1ZGUvYXNtLWdlbmVyaWMvaW50LWxsNjQuaCIKIyAxICIuL2luY2x1ZGUvdWFwaS9hc20t
Z2VuZXJpYy9pbnQtbGw2NC5oIiAxCiMgMTIgIi4vaW5jbHVkZS91YXBpL2FzbS1nZW5lcmlj
L2ludC1sbDY0LmgiCiMgMSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS91YXBpL2FzbS9iaXRz
cGVybG9uZy5oIiAxCiMgMTEgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvdWFwaS9hc20vYml0
c3BlcmxvbmcuaCIKIyAxICIuL2luY2x1ZGUvYXNtLWdlbmVyaWMvYml0c3BlcmxvbmcuaCIg
MQoKCgoKIyAxICIuL2luY2x1ZGUvdWFwaS9hc20tZ2VuZXJpYy9iaXRzcGVybG9uZy5oIiAx
CiMgNiAiLi9pbmNsdWRlL2FzbS1nZW5lcmljL2JpdHNwZXJsb25nLmgiIDIKIyAxMiAiLi9h
cmNoL3Bvd2VycGMvaW5jbHVkZS91YXBpL2FzbS9iaXRzcGVybG9uZy5oIiAyCiMgMTMgIi4v
aW5jbHVkZS91YXBpL2FzbS1nZW5lcmljL2ludC1sbDY0LmgiIDIKCgoKCgoKCnR5cGVkZWYg
X19zaWduZWRfXyBjaGFyIF9fczg7CnR5cGVkZWYgdW5zaWduZWQgY2hhciBfX3U4OwoKdHlw
ZWRlZiBfX3NpZ25lZF9fIHNob3J0IF9fczE2Owp0eXBlZGVmIHVuc2lnbmVkIHNob3J0IF9f
dTE2OwoKdHlwZWRlZiBfX3NpZ25lZF9fIGludCBfX3MzMjsKdHlwZWRlZiB1bnNpZ25lZCBp
bnQgX191MzI7CgoKX19leHRlbnNpb25fXyB0eXBlZGVmIF9fc2lnbmVkX18gbG9uZyBsb25n
IF9fczY0OwpfX2V4dGVuc2lvbl9fIHR5cGVkZWYgdW5zaWduZWQgbG9uZyBsb25nIF9fdTY0
OwojIDEyICIuL2luY2x1ZGUvYXNtLWdlbmVyaWMvaW50LWxsNjQuaCIgMgoKCgoKdHlwZWRl
ZiBfX3M4IHM4Owp0eXBlZGVmIF9fdTggdTg7CnR5cGVkZWYgX19zMTYgczE2Owp0eXBlZGVm
IF9fdTE2IHUxNjsKdHlwZWRlZiBfX3MzMiBzMzI7CnR5cGVkZWYgX191MzIgdTMyOwp0eXBl
ZGVmIF9fczY0IHM2NDsKdHlwZWRlZiBfX3U2NCB1NjQ7CiMgMjkgIi4vYXJjaC9wb3dlcnBj
L2luY2x1ZGUvdWFwaS9hc20vdHlwZXMuaCIgMgoKCgoKCnR5cGVkZWYgc3RydWN0IHsKIF9f
dTMyIHVbNF07Cn0gX19hdHRyaWJ1dGVfXygoYWxpZ25lZCgxNikpKSBfX3ZlY3RvcjEyODsK
IyAxMyAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vdHlwZXMuaCIgMgojIDI0ICIuL2Fy
Y2gvcG93ZXJwYy9pbmNsdWRlL2FzbS90eXBlcy5oIgp0eXBlZGVmIF9fdmVjdG9yMTI4IHZl
Y3RvcjEyODsKCnR5cGVkZWYgc3RydWN0IHsKIHVuc2lnbmVkIGxvbmcgZW50cnk7CiB1bnNp
Z25lZCBsb25nIHRvYzsKIHVuc2lnbmVkIGxvbmcgZW52Owp9IGZ1bmNfZGVzY3JfdDsKIyA2
ICIuL2luY2x1ZGUvdWFwaS9saW51eC90eXBlcy5oIiAyCiMgMTQgIi4vaW5jbHVkZS91YXBp
L2xpbnV4L3R5cGVzLmgiCiMgMSAiLi9pbmNsdWRlL3VhcGkvbGludXgvcG9zaXhfdHlwZXMu
aCIgMQoKCgoKIyAxICIuL2luY2x1ZGUvbGludXgvc3RkZGVmLmgiIDEKCgoKCiMgMSAiLi9p
bmNsdWRlL3VhcGkvbGludXgvc3RkZGVmLmgiIDEKCiMgMSAiLi9pbmNsdWRlL2xpbnV4L2Nv
bXBpbGVyX3R5cGVzLmgiIDEKIyAzICIuL2luY2x1ZGUvdWFwaS9saW51eC9zdGRkZWYuaCIg
MgojIDYgIi4vaW5jbHVkZS9saW51eC9zdGRkZWYuaCIgMgoKCgoKZW51bSB7CiBmYWxzZSA9
IDAsCiB0cnVlID0gMQp9OwojIDYgIi4vaW5jbHVkZS91YXBpL2xpbnV4L3Bvc2l4X3R5cGVz
LmgiIDIKIyAyNSAiLi9pbmNsdWRlL3VhcGkvbGludXgvcG9zaXhfdHlwZXMuaCIKdHlwZWRl
ZiBzdHJ1Y3QgewogdW5zaWduZWQgbG9uZyBmZHNfYml0c1sxMDI0IC8gKDggKiBzaXplb2Yo
bG9uZykpXTsKfSBfX2tlcm5lbF9mZF9zZXQ7CgoKdHlwZWRlZiB2b2lkICgqX19rZXJuZWxf
c2lnaGFuZGxlcl90KShpbnQpOwoKCnR5cGVkZWYgaW50IF9fa2VybmVsX2tleV90Owp0eXBl
ZGVmIGludCBfX2tlcm5lbF9tcWRfdDsKCiMgMSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS91
YXBpL2FzbS9wb3NpeF90eXBlcy5oIiAxCiMgMTIgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUv
dWFwaS9hc20vcG9zaXhfdHlwZXMuaCIKdHlwZWRlZiB1bnNpZ25lZCBsb25nIF9fa2VybmVs
X29sZF9kZXZfdDsKIyAyNCAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS91YXBpL2FzbS9wb3Np
eF90eXBlcy5oIgojIDEgIi4vaW5jbHVkZS91YXBpL2FzbS1nZW5lcmljL3Bvc2l4X3R5cGVz
LmgiIDEKIyAxNSAiLi9pbmNsdWRlL3VhcGkvYXNtLWdlbmVyaWMvcG9zaXhfdHlwZXMuaCIK
dHlwZWRlZiBsb25nIF9fa2VybmVsX2xvbmdfdDsKdHlwZWRlZiB1bnNpZ25lZCBsb25nIF9f
a2VybmVsX3Vsb25nX3Q7CgoKCnR5cGVkZWYgX19rZXJuZWxfdWxvbmdfdCBfX2tlcm5lbF9p
bm9fdDsKCgoKdHlwZWRlZiB1bnNpZ25lZCBpbnQgX19rZXJuZWxfbW9kZV90OwoKCgp0eXBl
ZGVmIGludCBfX2tlcm5lbF9waWRfdDsKCgoKdHlwZWRlZiBpbnQgX19rZXJuZWxfaXBjX3Bp
ZF90OwoKCgp0eXBlZGVmIHVuc2lnbmVkIGludCBfX2tlcm5lbF91aWRfdDsKdHlwZWRlZiB1
bnNpZ25lZCBpbnQgX19rZXJuZWxfZ2lkX3Q7CgoKCnR5cGVkZWYgX19rZXJuZWxfbG9uZ190
IF9fa2VybmVsX3N1c2Vjb25kc190OwoKCgp0eXBlZGVmIGludCBfX2tlcm5lbF9kYWRkcl90
OwoKCgp0eXBlZGVmIHVuc2lnbmVkIGludCBfX2tlcm5lbF91aWQzMl90Owp0eXBlZGVmIHVu
c2lnbmVkIGludCBfX2tlcm5lbF9naWQzMl90OwoKCgp0eXBlZGVmIF9fa2VybmVsX3VpZF90
IF9fa2VybmVsX29sZF91aWRfdDsKdHlwZWRlZiBfX2tlcm5lbF9naWRfdCBfX2tlcm5lbF9v
bGRfZ2lkX3Q7CiMgNzIgIi4vaW5jbHVkZS91YXBpL2FzbS1nZW5lcmljL3Bvc2l4X3R5cGVz
LmgiCnR5cGVkZWYgX19rZXJuZWxfdWxvbmdfdCBfX2tlcm5lbF9zaXplX3Q7CnR5cGVkZWYg
X19rZXJuZWxfbG9uZ190IF9fa2VybmVsX3NzaXplX3Q7CnR5cGVkZWYgX19rZXJuZWxfbG9u
Z190IF9fa2VybmVsX3B0cmRpZmZfdDsKCgoKCnR5cGVkZWYgc3RydWN0IHsKIGludCB2YWxb
Ml07Cn0gX19rZXJuZWxfZnNpZF90OwoKCgoKCnR5cGVkZWYgX19rZXJuZWxfbG9uZ190IF9f
a2VybmVsX29mZl90Owp0eXBlZGVmIGxvbmcgbG9uZyBfX2tlcm5lbF9sb2ZmX3Q7CnR5cGVk
ZWYgX19rZXJuZWxfbG9uZ190IF9fa2VybmVsX29sZF90aW1lX3Q7CgoKCnR5cGVkZWYgbG9u
ZyBsb25nIF9fa2VybmVsX3RpbWU2NF90Owp0eXBlZGVmIF9fa2VybmVsX2xvbmdfdCBfX2tl
cm5lbF9jbG9ja190Owp0eXBlZGVmIGludCBfX2tlcm5lbF90aW1lcl90Owp0eXBlZGVmIGlu
dCBfX2tlcm5lbF9jbG9ja2lkX3Q7CnR5cGVkZWYgY2hhciAqIF9fa2VybmVsX2NhZGRyX3Q7
CnR5cGVkZWYgdW5zaWduZWQgc2hvcnQgX19rZXJuZWxfdWlkMTZfdDsKdHlwZWRlZiB1bnNp
Z25lZCBzaG9ydCBfX2tlcm5lbF9naWQxNl90OwojIDI1ICIuL2FyY2gvcG93ZXJwYy9pbmNs
dWRlL3VhcGkvYXNtL3Bvc2l4X3R5cGVzLmgiIDIKIyAzNyAiLi9pbmNsdWRlL3VhcGkvbGlu
dXgvcG9zaXhfdHlwZXMuaCIgMgojIDE1ICIuL2luY2x1ZGUvdWFwaS9saW51eC90eXBlcy5o
IiAyCiMgMjkgIi4vaW5jbHVkZS91YXBpL2xpbnV4L3R5cGVzLmgiCnR5cGVkZWYgX191MTYg
X19sZTE2Owp0eXBlZGVmIF9fdTE2IF9fYmUxNjsKdHlwZWRlZiBfX3UzMiBfX2xlMzI7CnR5
cGVkZWYgX191MzIgX19iZTMyOwp0eXBlZGVmIF9fdTY0IF9fbGU2NDsKdHlwZWRlZiBfX3U2
NCBfX2JlNjQ7Cgp0eXBlZGVmIF9fdTE2IF9fc3VtMTY7CnR5cGVkZWYgX191MzIgX193c3Vt
OwojIDUyICIuL2luY2x1ZGUvdWFwaS9saW51eC90eXBlcy5oIgp0eXBlZGVmIHVuc2lnbmVk
IF9fcG9sbF90OwojIDcgIi4vaW5jbHVkZS9saW51eC90eXBlcy5oIiAyCgoKCgoKCnR5cGVk
ZWYgdTMyIF9fa2VybmVsX2Rldl90OwoKdHlwZWRlZiBfX2tlcm5lbF9mZF9zZXQgZmRfc2V0
Owp0eXBlZGVmIF9fa2VybmVsX2Rldl90IGRldl90Owp0eXBlZGVmIF9fa2VybmVsX2lub190
IGlub190Owp0eXBlZGVmIF9fa2VybmVsX21vZGVfdCBtb2RlX3Q7CnR5cGVkZWYgdW5zaWdu
ZWQgc2hvcnQgdW1vZGVfdDsKdHlwZWRlZiB1MzIgbmxpbmtfdDsKdHlwZWRlZiBfX2tlcm5l
bF9vZmZfdCBvZmZfdDsKdHlwZWRlZiBfX2tlcm5lbF9waWRfdCBwaWRfdDsKdHlwZWRlZiBf
X2tlcm5lbF9kYWRkcl90IGRhZGRyX3Q7CnR5cGVkZWYgX19rZXJuZWxfa2V5X3Qga2V5X3Q7
CnR5cGVkZWYgX19rZXJuZWxfc3VzZWNvbmRzX3Qgc3VzZWNvbmRzX3Q7CnR5cGVkZWYgX19r
ZXJuZWxfdGltZXJfdCB0aW1lcl90Owp0eXBlZGVmIF9fa2VybmVsX2Nsb2NraWRfdCBjbG9j
a2lkX3Q7CnR5cGVkZWYgX19rZXJuZWxfbXFkX3QgbXFkX3Q7Cgp0eXBlZGVmIF9Cb29sIGJv
b2w7Cgp0eXBlZGVmIF9fa2VybmVsX3VpZDMyX3QgdWlkX3Q7CnR5cGVkZWYgX19rZXJuZWxf
Z2lkMzJfdCBnaWRfdDsKdHlwZWRlZiBfX2tlcm5lbF91aWQxNl90IHVpZDE2X3Q7CnR5cGVk
ZWYgX19rZXJuZWxfZ2lkMTZfdCBnaWQxNl90OwoKdHlwZWRlZiB1bnNpZ25lZCBsb25nIHVp
bnRwdHJfdDsKIyA0NiAiLi9pbmNsdWRlL2xpbnV4L3R5cGVzLmgiCnR5cGVkZWYgX19rZXJu
ZWxfbG9mZl90IGxvZmZfdDsKIyA1NSAiLi9pbmNsdWRlL2xpbnV4L3R5cGVzLmgiCnR5cGVk
ZWYgX19rZXJuZWxfc2l6ZV90IHNpemVfdDsKCgoKCnR5cGVkZWYgX19rZXJuZWxfc3NpemVf
dCBzc2l6ZV90OwoKCgoKdHlwZWRlZiBfX2tlcm5lbF9wdHJkaWZmX3QgcHRyZGlmZl90OwoK
CgoKdHlwZWRlZiBfX2tlcm5lbF9jbG9ja190IGNsb2NrX3Q7CgoKCgp0eXBlZGVmIF9fa2Vy
bmVsX2NhZGRyX3QgY2FkZHJfdDsKCgoKdHlwZWRlZiB1bnNpZ25lZCBjaGFyIHVfY2hhcjsK
dHlwZWRlZiB1bnNpZ25lZCBzaG9ydCB1X3Nob3J0Owp0eXBlZGVmIHVuc2lnbmVkIGludCB1
X2ludDsKdHlwZWRlZiB1bnNpZ25lZCBsb25nIHVfbG9uZzsKCgp0eXBlZGVmIHVuc2lnbmVk
IGNoYXIgdW5jaGFyOwp0eXBlZGVmIHVuc2lnbmVkIHNob3J0IHVzaG9ydDsKdHlwZWRlZiB1
bnNpZ25lZCBpbnQgdWludDsKdHlwZWRlZiB1bnNpZ25lZCBsb25nIHVsb25nOwoKCgoKdHlw
ZWRlZiB1OCB1X2ludDhfdDsKdHlwZWRlZiBzOCBpbnQ4X3Q7CnR5cGVkZWYgdTE2IHVfaW50
MTZfdDsKdHlwZWRlZiBzMTYgaW50MTZfdDsKdHlwZWRlZiB1MzIgdV9pbnQzMl90Owp0eXBl
ZGVmIHMzMiBpbnQzMl90OwoKCgp0eXBlZGVmIHU4IHVpbnQ4X3Q7CnR5cGVkZWYgdTE2IHVp
bnQxNl90Owp0eXBlZGVmIHUzMiB1aW50MzJfdDsKCgp0eXBlZGVmIHU2NCB1aW50NjRfdDsK
dHlwZWRlZiB1NjQgdV9pbnQ2NF90Owp0eXBlZGVmIHM2NCBpbnQ2NF90OwojIDEyNSAiLi9p
bmNsdWRlL2xpbnV4L3R5cGVzLmgiCnR5cGVkZWYgdTY0IHNlY3Rvcl90Owp0eXBlZGVmIHU2
NCBibGtjbnRfdDsKIyAxNDMgIi4vaW5jbHVkZS9saW51eC90eXBlcy5oIgp0eXBlZGVmIHU2
NCBkbWFfYWRkcl90OwoKCgoKdHlwZWRlZiB1bnNpZ25lZCBpbnQgZ2ZwX3Q7CnR5cGVkZWYg
dW5zaWduZWQgaW50IHNsYWJfZmxhZ3NfdDsKdHlwZWRlZiB1bnNpZ25lZCBpbnQgZm1vZGVf
dDsKCgp0eXBlZGVmIHU2NCBwaHlzX2FkZHJfdDsKCgoKCnR5cGVkZWYgcGh5c19hZGRyX3Qg
cmVzb3VyY2Vfc2l6ZV90OwoKCgoKCnR5cGVkZWYgdW5zaWduZWQgbG9uZyBpcnFfaHdfbnVt
YmVyX3Q7Cgp0eXBlZGVmIHN0cnVjdCB7CiBpbnQgY291bnRlcjsKfSBhdG9taWNfdDsKCgp0
eXBlZGVmIHN0cnVjdCB7CiBzNjQgY291bnRlcjsKfSBhdG9taWM2NF90OwoKCnN0cnVjdCBs
aXN0X2hlYWQgewogc3RydWN0IGxpc3RfaGVhZCAqbmV4dCwgKnByZXY7Cn07CgpzdHJ1Y3Qg
aGxpc3RfaGVhZCB7CiBzdHJ1Y3QgaGxpc3Rfbm9kZSAqZmlyc3Q7Cn07CgpzdHJ1Y3QgaGxp
c3Rfbm9kZSB7CiBzdHJ1Y3QgaGxpc3Rfbm9kZSAqbmV4dCwgKipwcHJldjsKfTsKCnN0cnVj
dCB1c3RhdCB7CiBfX2tlcm5lbF9kYWRkcl90IGZfdGZyZWU7CiBfX2tlcm5lbF9pbm9fdCBm
X3Rpbm9kZTsKIGNoYXIgZl9mbmFtZVs2XTsKIGNoYXIgZl9mcGFja1s2XTsKfTsKIyAyMTQg
Ii4vaW5jbHVkZS9saW51eC90eXBlcy5oIgpzdHJ1Y3QgY2FsbGJhY2tfaGVhZCB7CiBzdHJ1
Y3QgY2FsbGJhY2tfaGVhZCAqbmV4dDsKIHZvaWQgKCpmdW5jKShzdHJ1Y3QgY2FsbGJhY2tf
aGVhZCAqaGVhZCk7Cn0gX19hdHRyaWJ1dGVfXygoYWxpZ25lZChzaXplb2Yodm9pZCAqKSkp
KTsKCgp0eXBlZGVmIHZvaWQgKCpyY3VfY2FsbGJhY2tfdCkoc3RydWN0IGNhbGxiYWNrX2hl
YWQgKmhlYWQpOwp0eXBlZGVmIHZvaWQgKCpjYWxsX3JjdV9mdW5jX3QpKHN0cnVjdCBjYWxs
YmFja19oZWFkICpoZWFkLCByY3VfY2FsbGJhY2tfdCBmdW5jKTsKCnR5cGVkZWYgdm9pZCAo
KnN3YXBfZnVuY190KSh2b2lkICphLCB2b2lkICpiLCBpbnQgc2l6ZSk7Cgp0eXBlZGVmIGlu
dCAoKmNtcF9yX2Z1bmNfdCkoY29uc3Qgdm9pZCAqYSwgY29uc3Qgdm9pZCAqYiwgY29uc3Qg
dm9pZCAqcHJpdik7CnR5cGVkZWYgaW50ICgqY21wX2Z1bmNfdCkoY29uc3Qgdm9pZCAqYSwg
Y29uc3Qgdm9pZCAqYik7CiMgNiAiLi9pbmNsdWRlL3VhcGkvbGludXgvc2NoZWQuaCIgMgoj
IDkyICIuL2luY2x1ZGUvdWFwaS9saW51eC9zY2hlZC5oIgpzdHJ1Y3QgY2xvbmVfYXJncyB7
CiBfX3U2NCBfX2F0dHJpYnV0ZV9fKChhbGlnbmVkKDgpKSkgZmxhZ3M7CiBfX3U2NCBfX2F0
dHJpYnV0ZV9fKChhbGlnbmVkKDgpKSkgcGlkZmQ7CiBfX3U2NCBfX2F0dHJpYnV0ZV9fKChh
bGlnbmVkKDgpKSkgY2hpbGRfdGlkOwogX191NjQgX19hdHRyaWJ1dGVfXygoYWxpZ25lZCg4
KSkpIHBhcmVudF90aWQ7CiBfX3U2NCBfX2F0dHJpYnV0ZV9fKChhbGlnbmVkKDgpKSkgZXhp
dF9zaWduYWw7CiBfX3U2NCBfX2F0dHJpYnV0ZV9fKChhbGlnbmVkKDgpKSkgc3RhY2s7CiBf
X3U2NCBfX2F0dHJpYnV0ZV9fKChhbGlnbmVkKDgpKSkgc3RhY2tfc2l6ZTsKIF9fdTY0IF9f
YXR0cmlidXRlX18oKGFsaWduZWQoOCkpKSB0bHM7CiBfX3U2NCBfX2F0dHJpYnV0ZV9fKChh
bGlnbmVkKDgpKSkgc2V0X3RpZDsKIF9fdTY0IF9fYXR0cmlidXRlX18oKGFsaWduZWQoOCkp
KSBzZXRfdGlkX3NpemU7CiBfX3U2NCBfX2F0dHJpYnV0ZV9fKChhbGlnbmVkKDgpKSkgY2dy
b3VwOwp9OwojIDExICIuL2luY2x1ZGUvbGludXgvc2NoZWQuaCIgMgoKIyAxICIuL2FyY2gv
cG93ZXJwYy9pbmNsdWRlL2FzbS9jdXJyZW50LmgiIDEKIyA5ICIuL2FyY2gvcG93ZXJwYy9p
bmNsdWRlL2FzbS9jdXJyZW50LmgiCnN0cnVjdCB0YXNrX3N0cnVjdDsKCgoKIyAxICIuL2Fy
Y2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9wYWNhLmgiIDEKIyAxNSAiLi9hcmNoL3Bvd2VycGMv
aW5jbHVkZS9hc20vcGFjYS5oIgojIDEgIi4vaW5jbHVkZS9saW51eC9zdHJpbmcuaCIgMQoK
CgoKCiMgMSAiLi9pbmNsdWRlL2xpbnV4L2NvbXBpbGVyLmgiIDEKIyAyNTEgIi4vaW5jbHVk
ZS9saW51eC9jb21waWxlci5oIgojIDEgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2Jh
cnJpZXIuaCIgMQoKCgoKCgoKIyAxICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9hc20t
Y29uc3QuaCIgMQojIDkgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2JhcnJpZXIuaCIg
MgojIDEwMCAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vYmFycmllci5oIgojIDEgIi4v
aW5jbHVkZS9hc20tZ2VuZXJpYy9iYXJyaWVyLmgiIDEKIyAxNiAiLi9pbmNsdWRlL2FzbS1n
ZW5lcmljL2JhcnJpZXIuaCIKIyAxICIuL2luY2x1ZGUvbGludXgvY29tcGlsZXIuaCIgMQoj
IDE3ICIuL2luY2x1ZGUvYXNtLWdlbmVyaWMvYmFycmllci5oIiAyCiMgMTAxICIuL2FyY2gv
cG93ZXJwYy9pbmNsdWRlL2FzbS9iYXJyaWVyLmgiIDIKIyAyNTIgIi4vaW5jbHVkZS9saW51
eC9jb21waWxlci5oIiAyCiMgMSAiLi9pbmNsdWRlL2xpbnV4L2thc2FuLWNoZWNrcy5oIiAx
CiMgMTYgIi4vaW5jbHVkZS9saW51eC9rYXNhbi1jaGVja3MuaCIKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wg
X19rYXNhbl9jaGVja19yZWFkKGNvbnN0IHZvbGF0aWxlIHZvaWQgKnAsIHVuc2lnbmVkIGlu
dCBzaXplKQp7CiByZXR1cm4gdHJ1ZTsKfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBfX2thc2FuX2NoZWNr
X3dyaXRlKGNvbnN0IHZvbGF0aWxlIHZvaWQgKnAsIHVuc2lnbmVkIGludCBzaXplKQp7CiBy
ZXR1cm4gdHJ1ZTsKfQojIDM0ICIuL2luY2x1ZGUvbGludXgva2FzYW4tY2hlY2tzLmgiCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSBib29sIGthc2FuX2NoZWNrX3JlYWQoY29uc3Qgdm9sYXRpbGUgdm9pZCAqcCwg
dW5zaWduZWQgaW50IHNpemUpCnsKIHJldHVybiB0cnVlOwp9CnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIGth
c2FuX2NoZWNrX3dyaXRlKGNvbnN0IHZvbGF0aWxlIHZvaWQgKnAsIHVuc2lnbmVkIGludCBz
aXplKQp7CiByZXR1cm4gdHJ1ZTsKfQojIDI1MyAiLi9pbmNsdWRlL2xpbnV4L2NvbXBpbGVy
LmgiIDIKIyAxICIuL2luY2x1ZGUvbGludXgva2NzYW4tY2hlY2tzLmgiIDEKIyAxNDggIi4v
aW5jbHVkZS9saW51eC9rY3Nhbi1jaGVja3MuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgX19rY3Nhbl9j
aGVja19hY2Nlc3MoY29uc3Qgdm9sYXRpbGUgdm9pZCAqcHRyLCBzaXplX3Qgc2l6ZSwKICAg
ICBpbnQgdHlwZSkgeyB9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBrY3Nhbl9kaXNhYmxlX2N1cnJlbnQo
dm9pZCkgeyB9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGtjc2FuX2VuYWJsZV9jdXJyZW50KHZvaWQpIHsg
fQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgdm9pZCBrY3Nhbl9lbmFibGVfY3VycmVudF9ub3dhcm4odm9pZCkgeyB9
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSB2b2lkIGtjc2FuX25lc3RhYmxlX2F0b21pY19iZWdpbih2b2lkKSB7IH0K
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIHZvaWQga2NzYW5fbmVzdGFibGVfYXRvbWljX2VuZCh2b2lkKSB7IH0Kc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIHZvaWQga2NzYW5fZmxhdF9hdG9taWNfYmVnaW4odm9pZCkgeyB9CnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSB2b2lkIGtjc2FuX2ZsYXRfYXRvbWljX2VuZCh2b2lkKSB7IH0Kc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQg
a2NzYW5fYXRvbWljX25leHQoaW50IG4pIHsgfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBrY3Nhbl9zZXRf
YWNjZXNzX21hc2sodW5zaWduZWQgbG9uZyBtYXNrKSB7IH0KCnN0cnVjdCBrY3Nhbl9zY29w
ZWRfYWNjZXNzIHsgfTsKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3Qga2NzYW5fc2NvcGVkX2FjY2VzcyAq
Cmtjc2FuX2JlZ2luX3Njb3BlZF9hY2Nlc3MoY29uc3Qgdm9sYXRpbGUgdm9pZCAqcHRyLCBz
aXplX3Qgc2l6ZSwgaW50IHR5cGUsCiAgICAgc3RydWN0IGtjc2FuX3Njb3BlZF9hY2Nlc3Mg
KnNhKSB7IHJldHVybiBzYTsgfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBrY3Nhbl9lbmRfc2NvcGVkX2Fj
Y2VzcyhzdHJ1Y3Qga2NzYW5fc2NvcGVkX2FjY2VzcyAqc2EpIHsgfQojIDE4NCAiLi9pbmNs
dWRlL2xpbnV4L2tjc2FuLWNoZWNrcy5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBrY3Nhbl9jaGVja19h
Y2Nlc3MoY29uc3Qgdm9sYXRpbGUgdm9pZCAqcHRyLCBzaXplX3Qgc2l6ZSwKICAgICAgICAg
IGludCB0eXBlKSB7IH0Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgX19rY3Nhbl9lbmFibGVfY3VycmVudCh2
b2lkKSB7IH0Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgX19rY3Nhbl9kaXNhYmxlX2N1cnJlbnQodm9pZCkg
eyB9CiMgMjU0ICIuL2luY2x1ZGUvbGludXgvY29tcGlsZXIuaCIgMgojIDMwNiAiLi9pbmNs
dWRlL2xpbnV4L2NvbXBpbGVyLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5
c19pbmxpbmVfXykpCnVuc2lnbmVkIGxvbmcgX19yZWFkX29uY2Vfd29yZF9ub2NoZWNrKGNv
bnN0IHZvaWQgKmFkZHIpCnsKIHJldHVybiAoKihjb25zdCB2b2xhdGlsZSB0eXBlb2YoIF9H
ZW5lcmljKCgqKHVuc2lnbmVkIGxvbmcgKilhZGRyKSwgY2hhcjogKGNoYXIpMCwgdW5zaWdu
ZWQgY2hhcjogKHVuc2lnbmVkIGNoYXIpMCwgc2lnbmVkIGNoYXI6IChzaWduZWQgY2hhcikw
LCB1bnNpZ25lZCBzaG9ydDogKHVuc2lnbmVkIHNob3J0KTAsIHNpZ25lZCBzaG9ydDogKHNp
Z25lZCBzaG9ydCkwLCB1bnNpZ25lZCBpbnQ6ICh1bnNpZ25lZCBpbnQpMCwgc2lnbmVkIGlu
dDogKHNpZ25lZCBpbnQpMCwgdW5zaWduZWQgbG9uZzogKHVuc2lnbmVkIGxvbmcpMCwgc2ln
bmVkIGxvbmc6IChzaWduZWQgbG9uZykwLCB1bnNpZ25lZCBsb25nIGxvbmc6ICh1bnNpZ25l
ZCBsb25nIGxvbmcpMCwgc2lnbmVkIGxvbmcgbG9uZzogKHNpZ25lZCBsb25nIGxvbmcpMCwg
ZGVmYXVsdDogKCoodW5zaWduZWQgbG9uZyAqKWFkZHIpKSkgKikmKCoodW5zaWduZWQgbG9u
ZyAqKWFkZHIpKTsKfQojIDMyNyAiLi9pbmNsdWRlL2xpbnV4L2NvbXBpbGVyLmgiCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpCnVuc2lnbmVkIGxvbmcg
cmVhZF93b3JkX2F0X2FfdGltZShjb25zdCB2b2lkICphZGRyKQp7CiBrYXNhbl9jaGVja19y
ZWFkKGFkZHIsIDEpOwogcmV0dXJuICoodW5zaWduZWQgbG9uZyAqKWFkZHI7Cn0KIyAzNTAg
Ii4vaW5jbHVkZS9saW51eC9jb21waWxlci5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCAqb2Zmc2V0X3Rv
X3B0cihjb25zdCBpbnQgKm9mZikKewogcmV0dXJuICh2b2lkICopKCh1bnNpZ25lZCBsb25n
KW9mZiArICpvZmYpOwp9CiMgNyAiLi9pbmNsdWRlL2xpbnV4L3N0cmluZy5oIiAyCgoKIyAx
ICIvb3B0L2djYy00LjkuNC1ub2xpYmMvcG93ZXJwYzY0LWxpbnV4L2xpYi9nY2MvcG93ZXJw
YzY0LWxpbnV4LzQuOS40L2luY2x1ZGUvc3RkYXJnLmgiIDEgMyA0CiMgNDAgIi9vcHQvZ2Nj
LTQuOS40LW5vbGliYy9wb3dlcnBjNjQtbGludXgvbGliL2djYy9wb3dlcnBjNjQtbGludXgv
NC45LjQvaW5jbHVkZS9zdGRhcmcuaCIgMyA0CnR5cGVkZWYgX19idWlsdGluX3ZhX2xpc3Qg
X19nbnVjX3ZhX2xpc3Q7CiMgOTggIi9vcHQvZ2NjLTQuOS40LW5vbGliYy9wb3dlcnBjNjQt
bGludXgvbGliL2djYy9wb3dlcnBjNjQtbGludXgvNC45LjQvaW5jbHVkZS9zdGRhcmcuaCIg
MyA0CnR5cGVkZWYgX19nbnVjX3ZhX2xpc3QgdmFfbGlzdDsKIyAxMCAiLi9pbmNsdWRlL2xp
bnV4L3N0cmluZy5oIiAyCiMgMSAiLi9pbmNsdWRlL3VhcGkvbGludXgvc3RyaW5nLmgiIDEK
IyAxMSAiLi9pbmNsdWRlL2xpbnV4L3N0cmluZy5oIiAyCgpleHRlcm4gY2hhciAqc3RybmR1
cF91c2VyKGNvbnN0IGNoYXIgKiwgbG9uZyk7CmV4dGVybiB2b2lkICptZW1kdXBfdXNlcihj
b25zdCB2b2lkICosIHNpemVfdCk7CmV4dGVybiB2b2lkICp2bWVtZHVwX3VzZXIoY29uc3Qg
dm9pZCAqLCBzaXplX3QpOwpleHRlcm4gdm9pZCAqbWVtZHVwX3VzZXJfbnVsKGNvbnN0IHZv
aWQgKiwgc2l6ZV90KTsKCgoKCiMgMSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vc3Ry
aW5nLmgiIDEKIyAyMCAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vc3RyaW5nLmgiCmV4
dGVybiBjaGFyICogc3RyY3B5KGNoYXIgKixjb25zdCBjaGFyICopOwpleHRlcm4gY2hhciAq
IHN0cm5jcHkoY2hhciAqLGNvbnN0IGNoYXIgKiwgX19rZXJuZWxfc2l6ZV90KTsKZXh0ZXJu
IF9fa2VybmVsX3NpemVfdCBzdHJsZW4oY29uc3QgY2hhciAqKTsKZXh0ZXJuIGludCBzdHJj
bXAoY29uc3QgY2hhciAqLGNvbnN0IGNoYXIgKik7CmV4dGVybiBpbnQgc3RybmNtcChjb25z
dCBjaGFyICosIGNvbnN0IGNoYXIgKiwgX19rZXJuZWxfc2l6ZV90KTsKZXh0ZXJuIGNoYXIg
KiBzdHJjYXQoY2hhciAqLCBjb25zdCBjaGFyICopOwpleHRlcm4gdm9pZCAqIG1lbXNldCh2
b2lkICosaW50LF9fa2VybmVsX3NpemVfdCk7CmV4dGVybiB2b2lkICogbWVtY3B5KHZvaWQg
Kixjb25zdCB2b2lkICosX19rZXJuZWxfc2l6ZV90KTsKZXh0ZXJuIHZvaWQgKiBtZW1tb3Zl
KHZvaWQgKixjb25zdCB2b2lkICosX19rZXJuZWxfc2l6ZV90KTsKZXh0ZXJuIGludCBtZW1j
bXAoY29uc3Qgdm9pZCAqLGNvbnN0IHZvaWQgKixfX2tlcm5lbF9zaXplX3QpOwpleHRlcm4g
dm9pZCAqIG1lbWNocihjb25zdCB2b2lkICosaW50LF9fa2VybmVsX3NpemVfdCk7CmV4dGVy
biB2b2lkICogbWVtY3B5X2ZsdXNoY2FjaGUodm9pZCAqLGNvbnN0IHZvaWQgKixfX2tlcm5l
bF9zaXplX3QpOwoKdm9pZCAqX19tZW1zZXQodm9pZCAqcywgaW50IGMsIF9fa2VybmVsX3Np
emVfdCBjb3VudCk7CnZvaWQgKl9fbWVtY3B5KHZvaWQgKnRvLCBjb25zdCB2b2lkICpmcm9t
LCBfX2tlcm5lbF9zaXplX3Qgbik7CnZvaWQgKl9fbWVtbW92ZSh2b2lkICp0bywgY29uc3Qg
dm9pZCAqZnJvbSwgX19rZXJuZWxfc2l6ZV90IG4pOwojIDU4ICIuL2FyY2gvcG93ZXJwYy9p
bmNsdWRlL2FzbS9zdHJpbmcuaCIKZXh0ZXJuIGludCBtZW1jcHlfbWNzYWZlKHZvaWQgKmRz
dCwgY29uc3Qgdm9pZCAqc3JjLCBfX2tlcm5lbF9zaXplX3Qgc3opOwpleHRlcm4gdm9pZCAq
X19tZW1zZXQxNih1aW50MTZfdCAqLCB1aW50MTZfdCB2LCBfX2tlcm5lbF9zaXplX3QpOwpl
eHRlcm4gdm9pZCAqX19tZW1zZXQzMih1aW50MzJfdCAqLCB1aW50MzJfdCB2LCBfX2tlcm5l
bF9zaXplX3QpOwpleHRlcm4gdm9pZCAqX19tZW1zZXQ2NCh1aW50NjRfdCAqLCB1aW50NjRf
dCB2LCBfX2tlcm5lbF9zaXplX3QpOwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgKm1lbXNldDE2KHVpbnQx
Nl90ICpwLCB1aW50MTZfdCB2LCBfX2tlcm5lbF9zaXplX3QgbikKewogcmV0dXJuIF9fbWVt
c2V0MTYocCwgdiwgbiAqIDIpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCAqbWVtc2V0MzIodWludDMy
X3QgKnAsIHVpbnQzMl90IHYsIF9fa2VybmVsX3NpemVfdCBuKQp7CiByZXR1cm4gX19tZW1z
ZXQzMihwLCB2LCBuICogNCk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkICptZW1zZXQ2NCh1aW50NjRf
dCAqcCwgdWludDY0X3QgdiwgX19rZXJuZWxfc2l6ZV90IG4pCnsKIHJldHVybiBfX21lbXNl
dDY0KHAsIHYsIG4gKiA4KTsKfQojIDIxICIuL2luY2x1ZGUvbGludXgvc3RyaW5nLmgiIDIK
CgpleHRlcm4gY2hhciAqIHN0cmNweShjaGFyICosY29uc3QgY2hhciAqKTsKCgoKCgpzaXpl
X3Qgc3RybGNweShjaGFyICosIGNvbnN0IGNoYXIgKiwgc2l6ZV90KTsKCgpzc2l6ZV90IHN0
cnNjcHkoY2hhciAqLCBjb25zdCBjaGFyICosIHNpemVfdCk7CgoKCnNzaXplX3Qgc3Ryc2Nw
eV9wYWQoY2hhciAqZGVzdCwgY29uc3QgY2hhciAqc3JjLCBzaXplX3QgY291bnQpOwoKCmV4
dGVybiBjaGFyICogc3RyY2F0KGNoYXIgKiwgY29uc3QgY2hhciAqKTsKCgpleHRlcm4gY2hh
ciAqIHN0cm5jYXQoY2hhciAqLCBjb25zdCBjaGFyICosIF9fa2VybmVsX3NpemVfdCk7CgoK
ZXh0ZXJuIHNpemVfdCBzdHJsY2F0KGNoYXIgKiwgY29uc3QgY2hhciAqLCBfX2tlcm5lbF9z
aXplX3QpOwoKCmV4dGVybiBpbnQgc3RyY21wKGNvbnN0IGNoYXIgKixjb25zdCBjaGFyICop
OwoKCgoKCmV4dGVybiBpbnQgc3RyY2FzZWNtcChjb25zdCBjaGFyICpzMSwgY29uc3QgY2hh
ciAqczIpOwoKCmV4dGVybiBpbnQgc3RybmNhc2VjbXAoY29uc3QgY2hhciAqczEsIGNvbnN0
IGNoYXIgKnMyLCBzaXplX3Qgbik7CgoKZXh0ZXJuIGNoYXIgKiBzdHJjaHIoY29uc3QgY2hh
ciAqLGludCk7CgoKZXh0ZXJuIGNoYXIgKiBzdHJjaHJudWwoY29uc3QgY2hhciAqLGludCk7
CgpleHRlcm4gY2hhciAqIHN0cm5jaHJudWwoY29uc3QgY2hhciAqLCBzaXplX3QsIGludCk7
CgpleHRlcm4gY2hhciAqIHN0cm5jaHIoY29uc3QgY2hhciAqLCBzaXplX3QsIGludCk7CgoK
ZXh0ZXJuIGNoYXIgKiBzdHJyY2hyKGNvbnN0IGNoYXIgKixpbnQpOwoKZXh0ZXJuIGNoYXIg
KiBfX2F0dHJpYnV0ZV9fKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkgc2tpcF9zcGFjZXMo
Y29uc3QgY2hhciAqKTsKCmV4dGVybiBjaGFyICpzdHJpbShjaGFyICopOwoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IF9fYXR0cmlidXRlX18oKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKSBjaGFyICpzdHJzdHJp
cChjaGFyICpzdHIpCnsKIHJldHVybiBzdHJpbShzdHIpOwp9CgoKZXh0ZXJuIGNoYXIgKiBz
dHJzdHIoY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICopOwoKCmV4dGVybiBjaGFyICogc3Ry
bnN0cihjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKiwgc2l6ZV90KTsKCgpleHRlcm4gX19r
ZXJuZWxfc2l6ZV90IHN0cmxlbihjb25zdCBjaGFyICopOwoKCmV4dGVybiBfX2tlcm5lbF9z
aXplX3Qgc3Rybmxlbihjb25zdCBjaGFyICosX19rZXJuZWxfc2l6ZV90KTsKCgpleHRlcm4g
Y2hhciAqIHN0cnBicmsoY29uc3QgY2hhciAqLGNvbnN0IGNoYXIgKik7CgoKZXh0ZXJuIGNo
YXIgKiBzdHJzZXAoY2hhciAqKixjb25zdCBjaGFyICopOwoKCmV4dGVybiBfX2tlcm5lbF9z
aXplX3Qgc3Ryc3BuKGNvbnN0IGNoYXIgKixjb25zdCBjaGFyICopOwoKCmV4dGVybiBfX2tl
cm5lbF9zaXplX3Qgc3RyY3Nwbihjb25zdCBjaGFyICosY29uc3QgY2hhciAqKTsKIyAxMjIg
Ii4vaW5jbHVkZS9saW51eC9zdHJpbmcuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgKm1lbXNldF9sKHVu
c2lnbmVkIGxvbmcgKnAsIHVuc2lnbmVkIGxvbmcgdiwKICBfX2tlcm5lbF9zaXplX3QgbikK
ewogaWYgKDY0ID09IDMyKQogIHJldHVybiBtZW1zZXQzMigodWludDMyX3QgKilwLCB2LCBu
KTsKIGVsc2UKICByZXR1cm4gbWVtc2V0NjQoKHVpbnQ2NF90ICopcCwgdiwgbik7Cn0KCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSB2b2lkICptZW1zZXRfcCh2b2lkICoqcCwgdm9pZCAqdiwgX19rZXJuZWxfc2l6
ZV90IG4pCnsKIGlmICg2NCA9PSAzMikKICByZXR1cm4gbWVtc2V0MzIoKHVpbnQzMl90ICop
cCwgKHVpbnRwdHJfdCl2LCBuKTsKIGVsc2UKICByZXR1cm4gbWVtc2V0NjQoKHVpbnQ2NF90
ICopcCwgKHVpbnRwdHJfdCl2LCBuKTsKfQoKZXh0ZXJuIHZvaWQgKipfX21lbWNhdF9wKHZv
aWQgKiphLCB2b2lkICoqYik7CiMgMTUzICIuL2luY2x1ZGUvbGludXgvc3RyaW5nLmgiCmV4
dGVybiB2b2lkICogbWVtc2Nhbih2b2lkICosaW50LF9fa2VybmVsX3NpemVfdCk7CgoKCgoK
ZXh0ZXJuIGludCBiY21wKGNvbnN0IHZvaWQgKixjb25zdCB2b2lkICosX19rZXJuZWxfc2l6
ZV90KTsKIyAxNzggIi4vaW5jbHVkZS9saW51eC9zdHJpbmcuaCIKdm9pZCAqbWVtY2hyX2lu
dihjb25zdCB2b2lkICpzLCBpbnQgYywgc2l6ZV90IG4pOwpjaGFyICpzdHJyZXBsYWNlKGNo
YXIgKnMsIGNoYXIgb2xkLCBjaGFyIG5ldyk7CgpleHRlcm4gdm9pZCBrZnJlZV9jb25zdChj
b25zdCB2b2lkICp4KTsKCmV4dGVybiBjaGFyICprc3RyZHVwKGNvbnN0IGNoYXIgKnMsIGdm
cF90IGdmcCkgX19hdHRyaWJ1dGVfXygoX19tYWxsb2NfXykpOwpleHRlcm4gY29uc3QgY2hh
ciAqa3N0cmR1cF9jb25zdChjb25zdCBjaGFyICpzLCBnZnBfdCBnZnApOwpleHRlcm4gY2hh
ciAqa3N0cm5kdXAoY29uc3QgY2hhciAqcywgc2l6ZV90IGxlbiwgZ2ZwX3QgZ2ZwKTsKZXh0
ZXJuIHZvaWQgKmttZW1kdXAoY29uc3Qgdm9pZCAqc3JjLCBzaXplX3QgbGVuLCBnZnBfdCBn
ZnApOwpleHRlcm4gY2hhciAqa21lbWR1cF9udWwoY29uc3QgY2hhciAqcywgc2l6ZV90IGxl
biwgZ2ZwX3QgZ2ZwKTsKCmV4dGVybiBjaGFyICoqYXJndl9zcGxpdChnZnBfdCBnZnAsIGNv
bnN0IGNoYXIgKnN0ciwgaW50ICphcmdjcCk7CmV4dGVybiB2b2lkIGFyZ3ZfZnJlZShjaGFy
ICoqYXJndik7CgpleHRlcm4gYm9vbCBzeXNmc19zdHJlcShjb25zdCBjaGFyICpzMSwgY29u
c3QgY2hhciAqczIpOwpleHRlcm4gaW50IGtzdHJ0b2Jvb2woY29uc3QgY2hhciAqcywgYm9v
bCAqcmVzKTsKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIGludCBzdHJ0b2Jvb2woY29uc3QgY2hhciAqcywgYm9vbCAq
cmVzKQp7CiByZXR1cm4ga3N0cnRvYm9vbChzLCByZXMpOwp9CgppbnQgbWF0Y2hfc3RyaW5n
KGNvbnN0IGNoYXIgKiBjb25zdCAqYXJyYXksIHNpemVfdCBuLCBjb25zdCBjaGFyICpzdHJp
bmcpOwppbnQgX19zeXNmc19tYXRjaF9zdHJpbmcoY29uc3QgY2hhciAqIGNvbnN0ICphcnJh
eSwgc2l6ZV90IG4sIGNvbnN0IGNoYXIgKnMpOwojIDIxMiAiLi9pbmNsdWRlL2xpbnV4L3N0
cmluZy5oIgppbnQgdmJpbl9wcmludGYodTMyICpiaW5fYnVmLCBzaXplX3Qgc2l6ZSwgY29u
c3QgY2hhciAqZm10LCB2YV9saXN0IGFyZ3MpOwppbnQgYnN0cl9wcmludGYoY2hhciAqYnVm
LCBzaXplX3Qgc2l6ZSwgY29uc3QgY2hhciAqZm10LCBjb25zdCB1MzIgKmJpbl9idWYpOwpp
bnQgYnByaW50Zih1MzIgKmJpbl9idWYsIHNpemVfdCBzaXplLCBjb25zdCBjaGFyICpmbXQs
IC4uLikgX19hdHRyaWJ1dGVfXygoX19mb3JtYXRfXyhwcmludGYsIDMsIDQpKSk7CgoKZXh0
ZXJuIHNzaXplX3QgbWVtb3J5X3JlYWRfZnJvbV9idWZmZXIodm9pZCAqdG8sIHNpemVfdCBj
b3VudCwgbG9mZl90ICpwcG9zLAogICAgICAgICAgIGNvbnN0IHZvaWQgKmZyb20sIHNpemVf
dCBhdmFpbGFibGUpOwoKaW50IHB0cl90b19oYXNodmFsKGNvbnN0IHZvaWQgKnB0ciwgdW5z
aWduZWQgbG9uZyAqaGFzaHZhbF9vdXQpOwoKCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBzdHJzdGFy
dHMoY29uc3QgY2hhciAqc3RyLCBjb25zdCBjaGFyICpwcmVmaXgpCnsKIHJldHVybiBzdHJu
Y21wKHN0ciwgcHJlZml4LCBzdHJsZW4ocHJlZml4KSkgPT0gMDsKfQoKc2l6ZV90IG1lbXdl
aWdodChjb25zdCB2b2lkICpwdHIsIHNpemVfdCBieXRlcyk7CiMgMjQ4ICIuL2luY2x1ZGUv
bGludXgvc3RyaW5nLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIG1lbXplcm9fZXhwbGljaXQodm9pZCAq
cywgc2l6ZV90IGNvdW50KQp7CiBtZW1zZXQocywgMCwgY291bnQpOwogX19hc21fXyBfX3Zv
bGF0aWxlX18oIiI6IDoiciIocykgOiJtZW1vcnkiKTsKfQoKCgoKCgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgY29u
c3QgY2hhciAqa2Jhc2VuYW1lKGNvbnN0IGNoYXIgKnBhdGgpCnsKIGNvbnN0IGNoYXIgKnRh
aWwgPSBzdHJyY2hyKHBhdGgsICcvJyk7CiByZXR1cm4gdGFpbCA/IHRhaWwgKyAxIDogcGF0
aDsKfQoKCgoKdm9pZCBmb3J0aWZ5X3BhbmljKGNvbnN0IGNoYXIgKm5hbWUpIF9fYXR0cmli
dXRlX18oKF9fbm9yZXR1cm5fXykpIF9fYXR0cmlidXRlX18oKF9fY29sZF9fKSk7CnZvaWQg
X19yZWFkX292ZXJmbG93KHZvaWQpIF9fYXR0cmlidXRlX18oKF9fZXJyb3JfXygiZGV0ZWN0
ZWQgcmVhZCBiZXlvbmQgc2l6ZSBvZiBvYmplY3QgcGFzc2VkIGFzIDFzdCBwYXJhbWV0ZXIi
KSkpOwp2b2lkIF9fcmVhZF9vdmVyZmxvdzIodm9pZCkgX19hdHRyaWJ1dGVfXygoX19lcnJv
cl9fKCJkZXRlY3RlZCByZWFkIGJleW9uZCBzaXplIG9mIG9iamVjdCBwYXNzZWQgYXMgMm5k
IHBhcmFtZXRlciIpKSk7CnZvaWQgX19yZWFkX292ZXJmbG93Myh2b2lkKSBfX2F0dHJpYnV0
ZV9fKChfX2Vycm9yX18oImRldGVjdGVkIHJlYWQgYmV5b25kIHNpemUgb2Ygb2JqZWN0IHBh
c3NlZCBhcyAzcmQgcGFyYW1ldGVyIikpKTsKdm9pZCBfX3dyaXRlX292ZXJmbG93KHZvaWQp
IF9fYXR0cmlidXRlX18oKF9fZXJyb3JfXygiZGV0ZWN0ZWQgd3JpdGUgYmV5b25kIHNpemUg
b2Ygb2JqZWN0IHBhc3NlZCBhcyAxc3QgcGFyYW1ldGVyIikpKTsKIyA1MTQgIi4vaW5jbHVk
ZS9saW51eC9zdHJpbmcuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgbWVtY3B5X2FuZF9wYWQodm9pZCAq
ZGVzdCwgc2l6ZV90IGRlc3RfbGVuLAogICAgICBjb25zdCB2b2lkICpzcmMsIHNpemVfdCBj
b3VudCwgaW50IHBhZCkKewogaWYgKGRlc3RfbGVuID4gY291bnQpIHsKICBtZW1jcHkoZGVz
dCwgc3JjLCBjb3VudCk7CiAgbWVtc2V0KGRlc3QgKyBjb3VudCwgcGFkLCBkZXN0X2xlbiAt
IGNvdW50KTsKIH0gZWxzZQogIG1lbWNweShkZXN0LCBzcmMsIGRlc3RfbGVuKTsKfQojIDUz
OSAiLi9pbmNsdWRlL2xpbnV4L3N0cmluZy5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygo
X19hbHdheXNfaW5saW5lX18pKSBzaXplX3Qgc3RyX2hhc19wcmVmaXgoY29uc3QgY2hhciAq
c3RyLCBjb25zdCBjaGFyICpwcmVmaXgpCnsKIHNpemVfdCBsZW4gPSBzdHJsZW4ocHJlZml4
KTsKIHJldHVybiBzdHJuY21wKHN0ciwgcHJlZml4LCBsZW4pID09IDAgPyBsZW4gOiAwOwp9
CiMgMTYgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL3BhY2EuaCIgMgoKIyAxICIuL2Fy
Y2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9scHBhY2EuaCIgMQojIDE4ICIuL2FyY2gvcG93ZXJw
Yy9pbmNsdWRlL2FzbS9wYWNhLmgiIDIKIyAxICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2Fz
bS9tbXUuaCIgMQojIDEzMSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vbW11LmgiCiMg
MSAiLi9pbmNsdWRlL2xpbnV4L2J1Zy5oIiAxCgoKCgojIDEgIi4vYXJjaC9wb3dlcnBjL2lu
Y2x1ZGUvYXNtL2J1Zy5oIiAxCgoKCgoKIyAxICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2Fz
bS9hc20tY29tcGF0LmgiIDEKCgoKCgojIDEgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNt
L3BwYy1vcGNvZGUuaCIgMQojIDcgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2FzbS1j
b21wYXQuaCIgMgojIDcgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2J1Zy5oIiAyCiMg
MTA5ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9idWcuaCIKIyAxICIuL2luY2x1ZGUv
YXNtLWdlbmVyaWMvYnVnLmgiIDEKIyAxOSAiLi9pbmNsdWRlL2FzbS1nZW5lcmljL2J1Zy5o
IgojIDEgIi4vaW5jbHVkZS9saW51eC9rZXJuZWwuaCIgMQoKCgoKCgojIDEgIi4vaW5jbHVk
ZS9saW51eC9saW1pdHMuaCIgMQoKCgoKIyAxICIuL2luY2x1ZGUvdWFwaS9saW51eC9saW1p
dHMuaCIgMQojIDYgIi4vaW5jbHVkZS9saW51eC9saW1pdHMuaCIgMgoKIyAxICIuL2luY2x1
ZGUvdmRzby9saW1pdHMuaCIgMQojIDggIi4vaW5jbHVkZS9saW51eC9saW1pdHMuaCIgMgoj
IDggIi4vaW5jbHVkZS9saW51eC9rZXJuZWwuaCIgMgojIDEgIi4vaW5jbHVkZS9saW51eC9s
aW5rYWdlLmgiIDEKCgoKCgojIDEgIi4vaW5jbHVkZS9saW51eC9zdHJpbmdpZnkuaCIgMQoj
IDcgIi4vaW5jbHVkZS9saW51eC9saW5rYWdlLmgiIDIKIyAxICIuL2luY2x1ZGUvbGludXgv
ZXhwb3J0LmgiIDEKIyA3MiAiLi9pbmNsdWRlL2xpbnV4L2V4cG9ydC5oIgpzdHJ1Y3Qga2Vy
bmVsX3N5bWJvbCB7CiB1bnNpZ25lZCBsb25nIHZhbHVlOwogY29uc3QgY2hhciAqbmFtZTsK
IGNvbnN0IGNoYXIgKm5hbWVzcGFjZTsKfTsKIyA4ICIuL2luY2x1ZGUvbGludXgvbGlua2Fn
ZS5oIiAyCiMgMSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vbGlua2FnZS5oIiAxCiMg
OSAiLi9pbmNsdWRlL2xpbnV4L2xpbmthZ2UuaCIgMgojIDkgIi4vaW5jbHVkZS9saW51eC9r
ZXJuZWwuaCIgMgoKCgojIDEgIi4vaW5jbHVkZS9saW51eC9iaXRvcHMuaCIgMQoKCgoKIyAx
ICIuL2luY2x1ZGUvbGludXgvYml0cy5oIiAxCgoKCgojIDEgIi4vaW5jbHVkZS9saW51eC9j
b25zdC5oIiAxCgoKCiMgMSAiLi9pbmNsdWRlL3Zkc28vY29uc3QuaCIgMQoKCgoKIyAxICIu
L2luY2x1ZGUvdWFwaS9saW51eC9jb25zdC5oIiAxCiMgNiAiLi9pbmNsdWRlL3Zkc28vY29u
c3QuaCIgMgojIDUgIi4vaW5jbHVkZS9saW51eC9jb25zdC5oIiAyCiMgNiAiLi9pbmNsdWRl
L2xpbnV4L2JpdHMuaCIgMgojIDEgIi4vaW5jbHVkZS92ZHNvL2JpdHMuaCIgMQojIDcgIi4v
aW5jbHVkZS9saW51eC9iaXRzLmgiIDIKIyA2ICIuL2luY2x1ZGUvbGludXgvYml0b3BzLmgi
IDIKIyAyMCAiLi9pbmNsdWRlL2xpbnV4L2JpdG9wcy5oIgpleHRlcm4gdW5zaWduZWQgaW50
IF9fc3dfaHdlaWdodDgodW5zaWduZWQgaW50IHcpOwpleHRlcm4gdW5zaWduZWQgaW50IF9f
c3dfaHdlaWdodDE2KHVuc2lnbmVkIGludCB3KTsKZXh0ZXJuIHVuc2lnbmVkIGludCBfX3N3
X2h3ZWlnaHQzMih1bnNpZ25lZCBpbnQgdyk7CmV4dGVybiB1bnNpZ25lZCBsb25nIF9fc3df
aHdlaWdodDY0KF9fdTY0IHcpOwoKCgoKCiMgMSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9h
c20vYml0b3BzLmgiIDEKIyA0MyAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vYml0b3Bz
LmgiCiMgMSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vc3luY2guaCIgMQoKCgoKCiMg
MSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vZmVhdHVyZS1maXh1cHMuaCIgMQojIDIz
OSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vZmVhdHVyZS1maXh1cHMuaCIKZXh0ZXJu
IGxvbmcgc3RmX2JhcnJpZXJfZmFsbGJhY2s7CmV4dGVybiBsb25nIF9fc3RhcnRfX19zdGZf
ZW50cnlfYmFycmllcl9maXh1cCwgX19zdG9wX19fc3RmX2VudHJ5X2JhcnJpZXJfZml4dXA7
CmV4dGVybiBsb25nIF9fc3RhcnRfX19zdGZfZXhpdF9iYXJyaWVyX2ZpeHVwLCBfX3N0b3Bf
X19zdGZfZXhpdF9iYXJyaWVyX2ZpeHVwOwpleHRlcm4gbG9uZyBfX3N0YXJ0X19fcmZpX2Zs
dXNoX2ZpeHVwLCBfX3N0b3BfX19yZmlfZmx1c2hfZml4dXA7CmV4dGVybiBsb25nIF9fc3Rh
cnRfX19iYXJyaWVyX25vc3BlY19maXh1cCwgX19zdG9wX19fYmFycmllcl9ub3NwZWNfZml4
dXA7CmV4dGVybiBsb25nIF9fc3RhcnRfX2J0Yl9mbHVzaF9maXh1cCwgX19zdG9wX19idGJf
Zmx1c2hfZml4dXA7Cgp2b2lkIGFwcGx5X2ZlYXR1cmVfZml4dXBzKHZvaWQpOwp2b2lkIHNl
dHVwX2ZlYXR1cmVfa2V5cyh2b2lkKTsKIyA3ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2Fz
bS9zeW5jaC5oIiAyCgoKCmV4dGVybiB1bnNpZ25lZCBpbnQgX19zdGFydF9fX2x3c3luY19m
aXh1cCwgX19zdG9wX19fbHdzeW5jX2ZpeHVwOwpleHRlcm4gdm9pZCBkb19sd3N5bmNfZml4
dXBzKHVuc2lnbmVkIGxvbmcgdmFsdWUsIHZvaWQgKmZpeHVwX3N0YXJ0LAogICAgICAgIHZv
aWQgKmZpeHVwX2VuZCk7CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBlaWVpbyh2b2lkKQp7CiBfX2FzbV9f
IF9fdm9sYXRpbGVfXyAoImVpZWlvIiA6IDogOiAibWVtb3J5Iik7Cn0KCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2
b2lkIGlzeW5jKHZvaWQpCnsKIF9fYXNtX18gX192b2xhdGlsZV9fICgiaXN5bmMiIDogOiA6
ICJtZW1vcnkiKTsKfQojIDQ0ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9iaXRvcHMu
aCIgMgojIDgyICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9iaXRvcHMuaCIKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIHZvaWQgc2V0X2JpdHModW5zaWduZWQgbG9uZyBtYXNrLCB2b2xhdGlsZSB1bnNpZ25l
ZCBsb25nICpfcCkgeyB1bnNpZ25lZCBsb25nIG9sZDsgdW5zaWduZWQgbG9uZyAqcCA9ICh1
bnNpZ25lZCBsb25nICopX3A7IF9fYXNtX18gX192b2xhdGlsZV9fICggIiIgIjE6IiAiLmxv
bmcgMHg3YzAwMDBhOCB8ICgoKCUwKSAmIDB4MWYpIDw8IDIxKSB8ICgoKDApICYgMHgxZikg
PDwgMTYpIHwgKCgoJTMpICYgMHgxZikgPDwgMTEpIHwgKCgoMCkgJiAweDEpIDw8IDApIiAi
ICIgIlxuIiAib3IiICIgIiAiJTAsJTAsJTJcbiIgInN0ZGN4LiIgIiAiICIlMCwwLCUzXG4i
ICJibmUtIDFiXG4iIDogIj0mciIgKG9sZCksICIrbSIgKCpwKSA6ICJyIiAobWFzayksICJy
IiAocCkgOiAiY2MiLCAibWVtb3J5Iik7IH0Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgY2xlYXJfYml0cyh1
bnNpZ25lZCBsb25nIG1hc2ssIHZvbGF0aWxlIHVuc2lnbmVkIGxvbmcgKl9wKSB7IHVuc2ln
bmVkIGxvbmcgb2xkOyB1bnNpZ25lZCBsb25nICpwID0gKHVuc2lnbmVkIGxvbmcgKilfcDsg
X19hc21fXyBfX3ZvbGF0aWxlX18gKCAiIiAiMToiICIubG9uZyAweDdjMDAwMGE4IHwgKCgo
JTApICYgMHgxZikgPDwgMjEpIHwgKCgoMCkgJiAweDFmKSA8PCAxNikgfCAoKCglMykgJiAw
eDFmKSA8PCAxMSkgfCAoKCgwKSAmIDB4MSkgPDwgMCkiICIgIiAiXG4iICJhbmRjIiAiICIg
IiUwLCUwLCUyXG4iICJzdGRjeC4iICIgIiAiJTAsMCwlM1xuIiAiYm5lLSAxYlxuIiA6ICI9
JnIiIChvbGQpLCAiK20iICgqcCkgOiAiciIgKG1hc2spLCAiciIgKHApIDogImNjIiwgIm1l
bW9yeSIpOyB9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGNsZWFyX2JpdHNfdW5sb2NrKHVuc2lnbmVkIGxv
bmcgbWFzaywgdm9sYXRpbGUgdW5zaWduZWQgbG9uZyAqX3ApIHsgdW5zaWduZWQgbG9uZyBv
bGQ7IHVuc2lnbmVkIGxvbmcgKnAgPSAodW5zaWduZWQgbG9uZyAqKV9wOyBfX2FzbV9fIF9f
dm9sYXRpbGVfXyAoICJsd3N5bmMiICIgIiAiXG4iICIxOiIgIi5sb25nIDB4N2MwMDAwYTgg
fCAoKCglMCkgJiAweDFmKSA8PCAyMSkgfCAoKCgwKSAmIDB4MWYpIDw8IDE2KSB8ICgoKCUz
KSAmIDB4MWYpIDw8IDExKSB8ICgoKDApICYgMHgxKSA8PCAwKSIgIiAiICJcbiIgImFuZGMi
ICIgIiAiJTAsJTAsJTJcbiIgInN0ZGN4LiIgIiAiICIlMCwwLCUzXG4iICJibmUtIDFiXG4i
IDogIj0mciIgKG9sZCksICIrbSIgKCpwKSA6ICJyIiAobWFzayksICJyIiAocCkgOiAiY2Mi
LCAibWVtb3J5Iik7IH0Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgY2hhbmdlX2JpdHModW5zaWduZWQgbG9u
ZyBtYXNrLCB2b2xhdGlsZSB1bnNpZ25lZCBsb25nICpfcCkgeyB1bnNpZ25lZCBsb25nIG9s
ZDsgdW5zaWduZWQgbG9uZyAqcCA9ICh1bnNpZ25lZCBsb25nICopX3A7IF9fYXNtX18gX192
b2xhdGlsZV9fICggIiIgIjE6IiAiLmxvbmcgMHg3YzAwMDBhOCB8ICgoKCUwKSAmIDB4MWYp
IDw8IDIxKSB8ICgoKDApICYgMHgxZikgPDwgMTYpIHwgKCgoJTMpICYgMHgxZikgPDwgMTEp
IHwgKCgoMCkgJiAweDEpIDw8IDApIiAiICIgIlxuIiAieG9yIiAiICIgIiUwLCUwLCUyXG4i
ICJzdGRjeC4iICIgIiAiJTAsMCwlM1xuIiAiYm5lLSAxYlxuIiA6ICI9JnIiIChvbGQpLCAi
K20iICgqcCkgOiAiciIgKG1hc2spLCAiciIgKHApIDogImNjIiwgIm1lbW9yeSIpOyB9Cgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgdm9pZCBhcmNoX3NldF9iaXQoaW50IG5yLCB2b2xhdGlsZSB1bnNpZ25lZCBs
b25nICphZGRyKQp7CiBzZXRfYml0cygoKCgoMVVMKSkpIDw8ICgobnIpICUgNjQpKSwgYWRk
ciArICgobnIpIC8gNjQpKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgYXJjaF9jbGVhcl9iaXQoaW50
IG5yLCB2b2xhdGlsZSB1bnNpZ25lZCBsb25nICphZGRyKQp7CiBjbGVhcl9iaXRzKCgoKCgx
VUwpKSkgPDwgKChucikgJSA2NCkpLCBhZGRyICsgKChucikgLyA2NCkpOwp9CgpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgdm9pZCBhcmNoX2NsZWFyX2JpdF91bmxvY2soaW50IG5yLCB2b2xhdGlsZSB1bnNpZ25l
ZCBsb25nICphZGRyKQp7CiBjbGVhcl9iaXRzX3VubG9jaygoKCgoMVVMKSkpIDw8ICgobnIp
ICUgNjQpKSwgYWRkciArICgobnIpIC8gNjQpKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgYXJjaF9j
aGFuZ2VfYml0KGludCBuciwgdm9sYXRpbGUgdW5zaWduZWQgbG9uZyAqYWRkcikKewogY2hh
bmdlX2JpdHMoKCgoKDFVTCkpKSA8PCAoKG5yKSAlIDY0KSksIGFkZHIgKyAoKG5yKSAvIDY0
KSk7Cn0KIyAxMjkgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2JpdG9wcy5oIgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgdW5zaWduZWQgbG9uZyB0ZXN0X2FuZF9zZXRfYml0cyggdW5zaWduZWQgbG9uZyBt
YXNrLCB2b2xhdGlsZSB1bnNpZ25lZCBsb25nICpfcCkgeyB1bnNpZ25lZCBsb25nIG9sZCwg
dDsgdW5zaWduZWQgbG9uZyAqcCA9ICh1bnNpZ25lZCBsb25nICopX3A7IF9fYXNtX18gX192
b2xhdGlsZV9fICggIlxuIiAic3luYyIgIiAiICJcbiIgIjE6IiAiLmxvbmcgMHg3YzAwMDBh
OCB8ICgoKCUwKSAmIDB4MWYpIDw8IDIxKSB8ICgoKDApICYgMHgxZikgPDwgMTYpIHwgKCgo
JTMpICYgMHgxZikgPDwgMTEpIHwgKCgoMCkgJiAweDEpIDw8IDApIiAiICIgIlxuIiAib3Ii
ICIgIiAiJTEsJTAsJTJcbiIgInN0ZGN4LiIgIiAiICIlMSwwLCUzXG4iICJibmUtIDFiXG4i
ICJcbiIgInN5bmMiICIgIiAiXG4iIDogIj0mciIgKG9sZCksICI9JnIiICh0KSA6ICJyIiAo
bWFzayksICJyIiAocCkgOiAiY2MiLCAibWVtb3J5Iik7IHJldHVybiAob2xkICYgbWFzayk7
IH0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSB1bnNpZ25lZCBsb25nIHRlc3RfYW5kX3NldF9iaXRzX2xvY2soIHVu
c2lnbmVkIGxvbmcgbWFzaywgdm9sYXRpbGUgdW5zaWduZWQgbG9uZyAqX3ApIHsgdW5zaWdu
ZWQgbG9uZyBvbGQsIHQ7IHVuc2lnbmVkIGxvbmcgKnAgPSAodW5zaWduZWQgbG9uZyAqKV9w
OyBfX2FzbV9fIF9fdm9sYXRpbGVfXyAoICIiICIxOiIgIi5sb25nIDB4N2MwMDAwYTggfCAo
KCglMCkgJiAweDFmKSA8PCAyMSkgfCAoKCgwKSAmIDB4MWYpIDw8IDE2KSB8ICgoKCUzKSAm
IDB4MWYpIDw8IDExKSB8ICgoKDEpICYgMHgxKSA8PCAwKSIgIiAiICJcbiIgIm9yIiAiICIg
IiUxLCUwLCUyXG4iICJzdGRjeC4iICIgIiAiJTEsMCwlM1xuIiAiYm5lLSAxYlxuIiAiXG4i
ICI5NzE6OyBpc3luYzsgOTcyOiAucHVzaHNlY3Rpb24gX19sd3N5bmNfZml4dXAsXCJhXCI7
IC5hbGlnbiAyOyA5NzM6IC44Ynl0ZSA5NzFiLTk3M2I7IC5wb3BzZWN0aW9uOzsiICIgIiA6
ICI9JnIiIChvbGQpLCAiPSZyIiAodCkgOiAiciIgKG1hc2spLCAiciIgKHApIDogImNjIiwg
Im1lbW9yeSIpOyByZXR1cm4gKG9sZCAmIG1hc2spOyB9CgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQg
bG9uZyB0ZXN0X2FuZF9jbGVhcl9iaXRzKCB1bnNpZ25lZCBsb25nIG1hc2ssIHZvbGF0aWxl
IHVuc2lnbmVkIGxvbmcgKl9wKSB7IHVuc2lnbmVkIGxvbmcgb2xkLCB0OyB1bnNpZ25lZCBs
b25nICpwID0gKHVuc2lnbmVkIGxvbmcgKilfcDsgX19hc21fXyBfX3ZvbGF0aWxlX18gKCAi
XG4iICJzeW5jIiAiICIgIlxuIiAiMToiICIubG9uZyAweDdjMDAwMGE4IHwgKCgoJTApICYg
MHgxZikgPDwgMjEpIHwgKCgoMCkgJiAweDFmKSA8PCAxNikgfCAoKCglMykgJiAweDFmKSA8
PCAxMSkgfCAoKCgwKSAmIDB4MSkgPDwgMCkiICIgIiAiXG4iICJhbmRjIiAiICIgIiUxLCUw
LCUyXG4iICJzdGRjeC4iICIgIiAiJTEsMCwlM1xuIiAiYm5lLSAxYlxuIiAiXG4iICJzeW5j
IiAiICIgIlxuIiA6ICI9JnIiIChvbGQpLCAiPSZyIiAodCkgOiAiciIgKG1hc2spLCAiciIg
KHApIDogImNjIiwgIm1lbW9yeSIpOyByZXR1cm4gKG9sZCAmIG1hc2spOyB9CgpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgdW5zaWduZWQgbG9uZyB0ZXN0X2FuZF9jaGFuZ2VfYml0cyggdW5zaWduZWQgbG9uZyBt
YXNrLCB2b2xhdGlsZSB1bnNpZ25lZCBsb25nICpfcCkgeyB1bnNpZ25lZCBsb25nIG9sZCwg
dDsgdW5zaWduZWQgbG9uZyAqcCA9ICh1bnNpZ25lZCBsb25nICopX3A7IF9fYXNtX18gX192
b2xhdGlsZV9fICggIlxuIiAic3luYyIgIiAiICJcbiIgIjE6IiAiLmxvbmcgMHg3YzAwMDBh
OCB8ICgoKCUwKSAmIDB4MWYpIDw8IDIxKSB8ICgoKDApICYgMHgxZikgPDwgMTYpIHwgKCgo
JTMpICYgMHgxZikgPDwgMTEpIHwgKCgoMCkgJiAweDEpIDw8IDApIiAiICIgIlxuIiAieG9y
IiAiICIgIiUxLCUwLCUyXG4iICJzdGRjeC4iICIgIiAiJTEsMCwlM1xuIiAiYm5lLSAxYlxu
IiAiXG4iICJzeW5jIiAiICIgIlxuIiA6ICI9JnIiIChvbGQpLCAiPSZyIiAodCkgOiAiciIg
KG1hc2spLCAiciIgKHApIDogImNjIiwgIm1lbW9yeSIpOyByZXR1cm4gKG9sZCAmIG1hc2sp
OyB9CgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIGludCBhcmNoX3Rlc3RfYW5kX3NldF9iaXQodW5zaWduZWQgbG9u
ZyBuciwKICAgICB2b2xhdGlsZSB1bnNpZ25lZCBsb25nICphZGRyKQp7CiByZXR1cm4gdGVz
dF9hbmRfc2V0X2JpdHMoKCgoKDFVTCkpKSA8PCAoKG5yKSAlIDY0KSksIGFkZHIgKyAoKG5y
KSAvIDY0KSkgIT0gMDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBhcmNoX3Rlc3RfYW5kX3NldF9iaXRf
bG9jayh1bnNpZ25lZCBsb25nIG5yLAogICAgICAgICAgdm9sYXRpbGUgdW5zaWduZWQgbG9u
ZyAqYWRkcikKewogcmV0dXJuIHRlc3RfYW5kX3NldF9iaXRzX2xvY2soKCgoKDFVTCkpKSA8
PCAoKG5yKSAlIDY0KSksCiAgICBhZGRyICsgKChucikgLyA2NCkpICE9IDA7Cn0KCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBpbnQgYXJjaF90ZXN0X2FuZF9jbGVhcl9iaXQodW5zaWduZWQgbG9uZyBuciwKICAg
ICAgIHZvbGF0aWxlIHVuc2lnbmVkIGxvbmcgKmFkZHIpCnsKIHJldHVybiB0ZXN0X2FuZF9j
bGVhcl9iaXRzKCgoKCgxVUwpKSkgPDwgKChucikgJSA2NCkpLCBhZGRyICsgKChucikgLyA2
NCkpICE9IDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgYXJjaF90ZXN0X2FuZF9jaGFuZ2VfYml0KHVu
c2lnbmVkIGxvbmcgbnIsCiAgICAgICAgdm9sYXRpbGUgdW5zaWduZWQgbG9uZyAqYWRkcikK
ewogcmV0dXJuIHRlc3RfYW5kX2NoYW5nZV9iaXRzKCgoKCgxVUwpKSkgPDwgKChucikgJSA2
NCkpLCBhZGRyICsgKChucikgLyA2NCkpICE9IDA7Cn0KCgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQg
bG9uZwpjbGVhcl9iaXRfdW5sb2NrX3JldHVybl93b3JkKGludCBuciwgdm9sYXRpbGUgdW5z
aWduZWQgbG9uZyAqYWRkcikKewogdW5zaWduZWQgbG9uZyBvbGQsIHQ7CiB1bnNpZ25lZCBs
b25nICpwID0gKHVuc2lnbmVkIGxvbmcgKilhZGRyICsgKChucikgLyA2NCk7CiB1bnNpZ25l
ZCBsb25nIG1hc2sgPSAoKCgoMVVMKSkpIDw8ICgobnIpICUgNjQpKTsKCiBfX2FzbV9fIF9f
dm9sYXRpbGVfXyAoCiAibHdzeW5jIiAiICIgIlxuIgoiMToiICIubG9uZyAweDdjMDAwMGE4
IHwgKCgoJTApICYgMHgxZikgPDwgMjEpIHwgKCgoMCkgJiAweDFmKSA8PCAxNikgfCAoKCgl
MykgJiAweDFmKSA8PCAxMSkgfCAoKCgwKSAmIDB4MSkgPDwgMCkiICIgIiAiXG4iCiAiYW5k
YyAlMSwlMCwlMlxuIgogInN0ZGN4LiIgIiAiICIlMSwwLCUzXG4iCiAiYm5lLSAxYlxuIgog
OiAiPSZyIiAob2xkKSwgIj0mciIgKHQpCiA6ICJyIiAobWFzayksICJyIiAocCkKIDogImNj
IiwgIm1lbW9yeSIpOwoKIHJldHVybiBvbGQ7Cn0KIyAxOTMgIi4vYXJjaC9wb3dlcnBjL2lu
Y2x1ZGUvYXNtL2JpdG9wcy5oIgojIDEgIi4vaW5jbHVkZS9hc20tZ2VuZXJpYy9iaXRvcHMv
bm9uLWF0b21pYy5oIiAxCiMgMTYgIi4vaW5jbHVkZS9hc20tZ2VuZXJpYy9iaXRvcHMvbm9u
LWF0b21pYy5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBfX3NldF9iaXQoaW50IG5yLCB2b2xhdGlsZSB1
bnNpZ25lZCBsb25nICphZGRyKQp7CiB1bnNpZ25lZCBsb25nIG1hc2sgPSAoKCgoMVVMKSkp
IDw8ICgobnIpICUgNjQpKTsKIHVuc2lnbmVkIGxvbmcgKnAgPSAoKHVuc2lnbmVkIGxvbmcg
KilhZGRyKSArICgobnIpIC8gNjQpOwoKICpwIHw9IG1hc2s7Cn0KCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lk
IF9fY2xlYXJfYml0KGludCBuciwgdm9sYXRpbGUgdW5zaWduZWQgbG9uZyAqYWRkcikKewog
dW5zaWduZWQgbG9uZyBtYXNrID0gKCgoKDFVTCkpKSA8PCAoKG5yKSAlIDY0KSk7CiB1bnNp
Z25lZCBsb25nICpwID0gKCh1bnNpZ25lZCBsb25nICopYWRkcikgKyAoKG5yKSAvIDY0KTsK
CiAqcCAmPSB+bWFzazsKfQojIDQxICIuL2luY2x1ZGUvYXNtLWdlbmVyaWMvYml0b3BzL25v
bi1hdG9taWMuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgX19jaGFuZ2VfYml0KGludCBuciwgdm9sYXRp
bGUgdW5zaWduZWQgbG9uZyAqYWRkcikKewogdW5zaWduZWQgbG9uZyBtYXNrID0gKCgoKDFV
TCkpKSA8PCAoKG5yKSAlIDY0KSk7CiB1bnNpZ25lZCBsb25nICpwID0gKCh1bnNpZ25lZCBs
b25nICopYWRkcikgKyAoKG5yKSAvIDY0KTsKCiAqcCBePSBtYXNrOwp9CiMgNTggIi4vaW5j
bHVkZS9hc20tZ2VuZXJpYy9iaXRvcHMvbm9uLWF0b21pYy5oIgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IF9f
dGVzdF9hbmRfc2V0X2JpdChpbnQgbnIsIHZvbGF0aWxlIHVuc2lnbmVkIGxvbmcgKmFkZHIp
CnsKIHVuc2lnbmVkIGxvbmcgbWFzayA9ICgoKCgxVUwpKSkgPDwgKChucikgJSA2NCkpOwog
dW5zaWduZWQgbG9uZyAqcCA9ICgodW5zaWduZWQgbG9uZyAqKWFkZHIpICsgKChucikgLyA2
NCk7CiB1bnNpZ25lZCBsb25nIG9sZCA9ICpwOwoKICpwID0gb2xkIHwgbWFzazsKIHJldHVy
biAob2xkICYgbWFzaykgIT0gMDsKfQojIDc3ICIuL2luY2x1ZGUvYXNtLWdlbmVyaWMvYml0
b3BzL25vbi1hdG9taWMuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBfX3Rlc3RfYW5kX2NsZWFyX2JpdChp
bnQgbnIsIHZvbGF0aWxlIHVuc2lnbmVkIGxvbmcgKmFkZHIpCnsKIHVuc2lnbmVkIGxvbmcg
bWFzayA9ICgoKCgxVUwpKSkgPDwgKChucikgJSA2NCkpOwogdW5zaWduZWQgbG9uZyAqcCA9
ICgodW5zaWduZWQgbG9uZyAqKWFkZHIpICsgKChucikgLyA2NCk7CiB1bnNpZ25lZCBsb25n
IG9sZCA9ICpwOwoKICpwID0gb2xkICYgfm1hc2s7CiByZXR1cm4gKG9sZCAmIG1hc2spICE9
IDA7Cn0KCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgaW50IF9fdGVzdF9hbmRfY2hhbmdlX2JpdChpbnQgbnIsCiAg
ICAgICAgIHZvbGF0aWxlIHVuc2lnbmVkIGxvbmcgKmFkZHIpCnsKIHVuc2lnbmVkIGxvbmcg
bWFzayA9ICgoKCgxVUwpKSkgPDwgKChucikgJSA2NCkpOwogdW5zaWduZWQgbG9uZyAqcCA9
ICgodW5zaWduZWQgbG9uZyAqKWFkZHIpICsgKChucikgLyA2NCk7CiB1bnNpZ25lZCBsb25n
IG9sZCA9ICpwOwoKICpwID0gb2xkIF4gbWFzazsKIHJldHVybiAob2xkICYgbWFzaykgIT0g
MDsKfQoKCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHRlc3RfYml0KGludCBuciwgY29uc3Qgdm9sYXRp
bGUgdW5zaWduZWQgbG9uZyAqYWRkcikKewogcmV0dXJuIDFVTCAmIChhZGRyWygobnIpIC8g
NjQpXSA+PiAobnIgJiAoNjQgLTEpKSk7Cn0KIyAxOTQgIi4vYXJjaC9wb3dlcnBjL2luY2x1
ZGUvYXNtL2JpdG9wcy5oIiAyCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBhcmNoX19fY2xlYXJfYml0X3Vu
bG9jayhpbnQgbnIsIHZvbGF0aWxlIHVuc2lnbmVkIGxvbmcgKmFkZHIpCnsKIF9fYXNtX18g
X192b2xhdGlsZV9fKCJsd3N5bmMiICIgIiAiXG4iICIiIDo6OiAibWVtb3J5Iik7CiBfX2Ns
ZWFyX2JpdChuciwgYWRkcik7Cn0KCgoKCgoKCiMgMSAiLi9pbmNsdWRlL2FzbS1nZW5lcmlj
L2JpdG9wcy9mZnouaCIgMQojIDIwOCAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vYml0
b3BzLmgiIDIKCiMgMSAiLi9pbmNsdWRlL2FzbS1nZW5lcmljL2JpdG9wcy9idWlsdGluLV9f
ZmZzLmgiIDEKIyAxMSAiLi9pbmNsdWRlL2FzbS1nZW5lcmljL2JpdG9wcy9idWlsdGluLV9f
ZmZzLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHVu
c2lnbmVkIGxvbmcgX19mZnModW5zaWduZWQgbG9uZyB3b3JkKQp7CiByZXR1cm4gX19idWls
dGluX2N0emwod29yZCk7Cn0KIyAyMTAgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2Jp
dG9wcy5oIiAyCgojIDEgIi4vaW5jbHVkZS9hc20tZ2VuZXJpYy9iaXRvcHMvYnVpbHRpbi1m
ZnMuaCIgMQojIDEzICIuL2luY2x1ZGUvYXNtLWdlbmVyaWMvYml0b3BzL2J1aWx0aW4tZmZz
LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIGludCBm
ZnMoaW50IHgpCnsKIHJldHVybiBfX2J1aWx0aW5fZmZzKHgpOwp9CiMgMjEyICIuL2FyY2gv
cG93ZXJwYy9pbmNsdWRlL2FzbS9iaXRvcHMuaCIgMgoKCgoKCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgZmxz
KHVuc2lnbmVkIGludCB4KQp7CiByZXR1cm4gMzIgLSBfX2J1aWx0aW5fY2x6KHgpOwp9Cgoj
IDEgIi4vaW5jbHVkZS9hc20tZ2VuZXJpYy9iaXRvcHMvYnVpbHRpbi1fX2Zscy5oIiAxCiMg
MTEgIi4vaW5jbHVkZS9hc20tZ2VuZXJpYy9iaXRvcHMvYnVpbHRpbi1fX2Zscy5oIgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB1bnNpZ25lZCBsb25n
IF9fZmxzKHVuc2lnbmVkIGxvbmcgd29yZCkKewogcmV0dXJuIChzaXplb2Yod29yZCkgKiA4
KSAtIDEgLSBfX2J1aWx0aW5fY2x6bCh3b3JkKTsKfQojIDIyMyAiLi9hcmNoL3Bvd2VycGMv
aW5jbHVkZS9hc20vYml0b3BzLmgiIDIKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgZmxzNjQoX191NjQgeCkK
ewogcmV0dXJuIDY0IC0gX19idWlsdGluX2NsemxsKHgpOwp9CgoKdW5zaWduZWQgaW50IF9f
YXJjaF9od2VpZ2h0OCh1bnNpZ25lZCBpbnQgdyk7CnVuc2lnbmVkIGludCBfX2FyY2hfaHdl
aWdodDE2KHVuc2lnbmVkIGludCB3KTsKdW5zaWduZWQgaW50IF9fYXJjaF9od2VpZ2h0MzIo
dW5zaWduZWQgaW50IHcpOwp1bnNpZ25lZCBsb25nIF9fYXJjaF9od2VpZ2h0NjQoX191NjQg
dyk7CiMgMSAiLi9pbmNsdWRlL2FzbS1nZW5lcmljL2JpdG9wcy9jb25zdF9od2VpZ2h0Lmgi
IDEKIyAyMzUgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2JpdG9wcy5oIiAyCgoKCgoj
IDEgIi4vaW5jbHVkZS9hc20tZ2VuZXJpYy9iaXRvcHMvZmluZC5oIiAxCiMgMTUgIi4vaW5j
bHVkZS9hc20tZ2VuZXJpYy9iaXRvcHMvZmluZC5oIgpleHRlcm4gdW5zaWduZWQgbG9uZyBm
aW5kX25leHRfYml0KGNvbnN0IHVuc2lnbmVkIGxvbmcgKmFkZHIsIHVuc2lnbmVkIGxvbmcK
ICBzaXplLCB1bnNpZ25lZCBsb25nIG9mZnNldCk7CiMgMzAgIi4vaW5jbHVkZS9hc20tZ2Vu
ZXJpYy9iaXRvcHMvZmluZC5oIgpleHRlcm4gdW5zaWduZWQgbG9uZyBmaW5kX25leHRfYW5k
X2JpdChjb25zdCB1bnNpZ25lZCBsb25nICphZGRyMSwKICBjb25zdCB1bnNpZ25lZCBsb25n
ICphZGRyMiwgdW5zaWduZWQgbG9uZyBzaXplLAogIHVuc2lnbmVkIGxvbmcgb2Zmc2V0KTsK
IyA0NSAiLi9pbmNsdWRlL2FzbS1nZW5lcmljL2JpdG9wcy9maW5kLmgiCmV4dGVybiB1bnNp
Z25lZCBsb25nIGZpbmRfbmV4dF96ZXJvX2JpdChjb25zdCB1bnNpZ25lZCBsb25nICphZGRy
LCB1bnNpZ25lZAogIGxvbmcgc2l6ZSwgdW5zaWduZWQgbG9uZyBvZmZzZXQpOwojIDkzICIu
L2luY2x1ZGUvYXNtLWdlbmVyaWMvYml0b3BzL2ZpbmQuaCIKZXh0ZXJuIHVuc2lnbmVkIGxv
bmcgZmluZF9uZXh0X2NsdW1wOCh1bnNpZ25lZCBsb25nICpjbHVtcCwKICAgICAgICAgIGNv
bnN0IHVuc2lnbmVkIGxvbmcgKmFkZHIsCiAgICAgICAgICB1bnNpZ25lZCBsb25nIHNpemUs
IHVuc2lnbmVkIGxvbmcgb2Zmc2V0KTsKIyAyNDAgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUv
YXNtL2JpdG9wcy5oIiAyCgoKIyAxICIuL2luY2x1ZGUvYXNtLWdlbmVyaWMvYml0b3BzL2lu
c3RydW1lbnRlZC1hdG9taWMuaCIgMQojIDE0ICIuL2luY2x1ZGUvYXNtLWdlbmVyaWMvYml0
b3BzL2luc3RydW1lbnRlZC1hdG9taWMuaCIKIyAxICIuL2luY2x1ZGUvbGludXgvaW5zdHJ1
bWVudGVkLmgiIDEKIyAyNCAiLi9pbmNsdWRlL2xpbnV4L2luc3RydW1lbnRlZC5oIgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB2b2lkIGluc3RydW1l
bnRfcmVhZChjb25zdCB2b2xhdGlsZSB2b2lkICp2LCBzaXplX3Qgc2l6ZSkKewoga2FzYW5f
Y2hlY2tfcmVhZCh2LCBzaXplKTsKIGtjc2FuX2NoZWNrX2FjY2Vzcyh2LCBzaXplLCAwKTsK
fQojIDM5ICIuL2luY2x1ZGUvbGludXgvaW5zdHJ1bWVudGVkLmgiCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0
dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHZvaWQgaW5zdHJ1bWVudF93cml0ZShj
b25zdCB2b2xhdGlsZSB2b2lkICp2LCBzaXplX3Qgc2l6ZSkKewoga2FzYW5fY2hlY2tfd3Jp
dGUodiwgc2l6ZSk7CiBrY3Nhbl9jaGVja19hY2Nlc3Modiwgc2l6ZSwgMHgxKTsKfQojIDU0
ICIuL2luY2x1ZGUvbGludXgvaW5zdHJ1bWVudGVkLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0
ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHZvaWQgaW5zdHJ1bWVudF9hdG9taWNfcmVhZChj
b25zdCB2b2xhdGlsZSB2b2lkICp2LCBzaXplX3Qgc2l6ZSkKewoga2FzYW5fY2hlY2tfcmVh
ZCh2LCBzaXplKTsKIGtjc2FuX2NoZWNrX2FjY2Vzcyh2LCBzaXplLCAweDIpOwp9CiMgNjkg
Ii4vaW5jbHVkZS9saW51eC9pbnN0cnVtZW50ZWQuaCIKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRl
X18oKF9fYWx3YXlzX2lubGluZV9fKSkgdm9pZCBpbnN0cnVtZW50X2F0b21pY193cml0ZShj
b25zdCB2b2xhdGlsZSB2b2lkICp2LCBzaXplX3Qgc2l6ZSkKewoga2FzYW5fY2hlY2tfd3Jp
dGUodiwgc2l6ZSk7CiBrY3Nhbl9jaGVja19hY2Nlc3Modiwgc2l6ZSwgMHgyIHwgMHgxKTsK
fQojIDg1ICIuL2luY2x1ZGUvbGludXgvaW5zdHJ1bWVudGVkLmgiCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0
dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHZvaWQKaW5zdHJ1bWVudF9jb3B5X3Rv
X3VzZXIodm9pZCAqdG8sIGNvbnN0IHZvaWQgKmZyb20sIHVuc2lnbmVkIGxvbmcgbikKewog
a2FzYW5fY2hlY2tfcmVhZChmcm9tLCBuKTsKIGtjc2FuX2NoZWNrX2FjY2Vzcyhmcm9tLCBu
LCAwKTsKfQojIDEwMiAiLi9pbmNsdWRlL2xpbnV4L2luc3RydW1lbnRlZC5oIgpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB2b2lkCmluc3RydW1lbnRf
Y29weV9mcm9tX3VzZXIoY29uc3Qgdm9pZCAqdG8sIGNvbnN0IHZvaWQgKmZyb20sIHVuc2ln
bmVkIGxvbmcgbikKewoga2FzYW5fY2hlY2tfd3JpdGUodG8sIG4pOwoga2NzYW5fY2hlY2tf
YWNjZXNzKHRvLCBuLCAweDEpOwp9CiMgMTUgIi4vaW5jbHVkZS9hc20tZ2VuZXJpYy9iaXRv
cHMvaW5zdHJ1bWVudGVkLWF0b21pYy5oIiAyCiMgMjYgIi4vaW5jbHVkZS9hc20tZ2VuZXJp
Yy9iaXRvcHMvaW5zdHJ1bWVudGVkLWF0b21pYy5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBzZXRfYml0
KGxvbmcgbnIsIHZvbGF0aWxlIHVuc2lnbmVkIGxvbmcgKmFkZHIpCnsKIGluc3RydW1lbnRf
YXRvbWljX3dyaXRlKGFkZHIgKyAoKG5yKSAvIDY0KSwgc2l6ZW9mKGxvbmcpKTsKIGFyY2hf
c2V0X2JpdChuciwgYWRkcik7Cn0KIyAzOSAiLi9pbmNsdWRlL2FzbS1nZW5lcmljL2JpdG9w
cy9pbnN0cnVtZW50ZWQtYXRvbWljLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGNsZWFyX2JpdChsb25n
IG5yLCB2b2xhdGlsZSB1bnNpZ25lZCBsb25nICphZGRyKQp7CiBpbnN0cnVtZW50X2F0b21p
Y193cml0ZShhZGRyICsgKChucikgLyA2NCksIHNpemVvZihsb25nKSk7CiBhcmNoX2NsZWFy
X2JpdChuciwgYWRkcik7Cn0KIyA1NSAiLi9pbmNsdWRlL2FzbS1nZW5lcmljL2JpdG9wcy9p
bnN0cnVtZW50ZWQtYXRvbWljLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGNoYW5nZV9iaXQobG9uZyBu
ciwgdm9sYXRpbGUgdW5zaWduZWQgbG9uZyAqYWRkcikKewogaW5zdHJ1bWVudF9hdG9taWNf
d3JpdGUoYWRkciArICgobnIpIC8gNjQpLCBzaXplb2YobG9uZykpOwogYXJjaF9jaGFuZ2Vf
Yml0KG5yLCBhZGRyKTsKfQojIDY4ICIuL2luY2x1ZGUvYXNtLWdlbmVyaWMvYml0b3BzL2lu
c3RydW1lbnRlZC1hdG9taWMuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgdGVzdF9hbmRfc2V0X2JpdChs
b25nIG5yLCB2b2xhdGlsZSB1bnNpZ25lZCBsb25nICphZGRyKQp7CiBpbnN0cnVtZW50X2F0
b21pY193cml0ZShhZGRyICsgKChucikgLyA2NCksIHNpemVvZihsb25nKSk7CiByZXR1cm4g
YXJjaF90ZXN0X2FuZF9zZXRfYml0KG5yLCBhZGRyKTsKfQojIDgxICIuL2luY2x1ZGUvYXNt
LWdlbmVyaWMvYml0b3BzL2luc3RydW1lbnRlZC1hdG9taWMuaCIKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wg
dGVzdF9hbmRfY2xlYXJfYml0KGxvbmcgbnIsIHZvbGF0aWxlIHVuc2lnbmVkIGxvbmcgKmFk
ZHIpCnsKIGluc3RydW1lbnRfYXRvbWljX3dyaXRlKGFkZHIgKyAoKG5yKSAvIDY0KSwgc2l6
ZW9mKGxvbmcpKTsKIHJldHVybiBhcmNoX3Rlc3RfYW5kX2NsZWFyX2JpdChuciwgYWRkcik7
Cn0KIyA5NCAiLi9pbmNsdWRlL2FzbS1nZW5lcmljL2JpdG9wcy9pbnN0cnVtZW50ZWQtYXRv
bWljLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSBib29sIHRlc3RfYW5kX2NoYW5nZV9iaXQobG9uZyBuciwgdm9s
YXRpbGUgdW5zaWduZWQgbG9uZyAqYWRkcikKewogaW5zdHJ1bWVudF9hdG9taWNfd3JpdGUo
YWRkciArICgobnIpIC8gNjQpLCBzaXplb2YobG9uZykpOwogcmV0dXJuIGFyY2hfdGVzdF9h
bmRfY2hhbmdlX2JpdChuciwgYWRkcik7Cn0KIyAyNDMgIi4vYXJjaC9wb3dlcnBjL2luY2x1
ZGUvYXNtL2JpdG9wcy5oIiAyCiMgMSAiLi9pbmNsdWRlL2FzbS1nZW5lcmljL2JpdG9wcy9p
bnN0cnVtZW50ZWQtbG9jay5oIiAxCiMgMjMgIi4vaW5jbHVkZS9hc20tZ2VuZXJpYy9iaXRv
cHMvaW5zdHJ1bWVudGVkLWxvY2suaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgY2xlYXJfYml0X3VubG9j
ayhsb25nIG5yLCB2b2xhdGlsZSB1bnNpZ25lZCBsb25nICphZGRyKQp7CiBpbnN0cnVtZW50
X2F0b21pY193cml0ZShhZGRyICsgKChucikgLyA2NCksIHNpemVvZihsb25nKSk7CiBhcmNo
X2NsZWFyX2JpdF91bmxvY2sobnIsIGFkZHIpOwp9CiMgMzggIi4vaW5jbHVkZS9hc20tZ2Vu
ZXJpYy9iaXRvcHMvaW5zdHJ1bWVudGVkLWxvY2suaCIKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgX19jbGVh
cl9iaXRfdW5sb2NrKGxvbmcgbnIsIHZvbGF0aWxlIHVuc2lnbmVkIGxvbmcgKmFkZHIpCnsK
IGluc3RydW1lbnRfd3JpdGUoYWRkciArICgobnIpIC8gNjQpLCBzaXplb2YobG9uZykpOwog
YXJjaF9fX2NsZWFyX2JpdF91bmxvY2sobnIsIGFkZHIpOwp9CiMgNTMgIi4vaW5jbHVkZS9h
c20tZ2VuZXJpYy9iaXRvcHMvaW5zdHJ1bWVudGVkLWxvY2suaCIKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wg
dGVzdF9hbmRfc2V0X2JpdF9sb2NrKGxvbmcgbnIsIHZvbGF0aWxlIHVuc2lnbmVkIGxvbmcg
KmFkZHIpCnsKIGluc3RydW1lbnRfYXRvbWljX3dyaXRlKGFkZHIgKyAoKG5yKSAvIDY0KSwg
c2l6ZW9mKGxvbmcpKTsKIHJldHVybiBhcmNoX3Rlc3RfYW5kX3NldF9iaXRfbG9jayhuciwg
YWRkcik7Cn0KIyA3MSAiLi9pbmNsdWRlL2FzbS1nZW5lcmljL2JpdG9wcy9pbnN0cnVtZW50
ZWQtbG9jay5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkKCiMgNzEgIi4vaW5jbHVkZS9hc20tZ2VuZXJpYy9iaXRv
cHMvaW5zdHJ1bWVudGVkLWxvY2suaCIKICAgICAgICAgICAgICBib29sCmNsZWFyX2JpdF91
bmxvY2tfaXNfbmVnYXRpdmVfYnl0ZShsb25nIG5yLCB2b2xhdGlsZSB1bnNpZ25lZCBsb25n
ICphZGRyKQp7CiBpbnN0cnVtZW50X2F0b21pY193cml0ZShhZGRyICsgKChucikgLyA2NCks
IHNpemVvZihsb25nKSk7CiByZXR1cm4gKGNsZWFyX2JpdF91bmxvY2tfcmV0dXJuX3dvcmQo
bnIsIGFkZHIpICYgKCgoKDFVTCkpKSA8PCAoKDcpICUgNjQpKSk7Cn0KIyAyNDQgIi4vYXJj
aC9wb3dlcnBjL2luY2x1ZGUvYXNtL2JpdG9wcy5oIiAyCgoKIyAxICIuL2luY2x1ZGUvYXNt
LWdlbmVyaWMvYml0b3BzL2xlLmgiIDEKCgoKCgojIDEgIi4vYXJjaC9wb3dlcnBjL2luY2x1
ZGUvdWFwaS9hc20vYnl0ZW9yZGVyLmgiIDEKIyAxNCAiLi9hcmNoL3Bvd2VycGMvaW5jbHVk
ZS91YXBpL2FzbS9ieXRlb3JkZXIuaCIKIyAxICIuL2luY2x1ZGUvbGludXgvYnl0ZW9yZGVy
L2JpZ19lbmRpYW4uaCIgMQoKCgoKIyAxICIuL2luY2x1ZGUvdWFwaS9saW51eC9ieXRlb3Jk
ZXIvYmlnX2VuZGlhbi5oIiAxCiMgMTMgIi4vaW5jbHVkZS91YXBpL2xpbnV4L2J5dGVvcmRl
ci9iaWdfZW5kaWFuLmgiCiMgMSAiLi9pbmNsdWRlL2xpbnV4L3N3YWIuaCIgMQoKCgoKIyAx
ICIuL2luY2x1ZGUvdWFwaS9saW51eC9zd2FiLmgiIDEKCgoKCgoKCiMgMSAiLi9hcmNoL3Bv
d2VycGMvaW5jbHVkZS9hc20vc3dhYi5oIiAxCgoKCgoKCiMgMSAiLi9hcmNoL3Bvd2VycGMv
aW5jbHVkZS91YXBpL2FzbS9zd2FiLmgiIDEKIyA4ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRl
L2FzbS9zd2FiLmgiIDIKIyA5ICIuL2luY2x1ZGUvdWFwaS9saW51eC9zd2FiLmgiIDIKIyA0
OCAiLi9pbmNsdWRlL3VhcGkvbGludXgvc3dhYi5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVf
XygoX19jb25zdF9fKSkgX191MTYgX19mc3dhYjE2KF9fdTE2IHZhbCkKewoKCgogcmV0dXJu
ICgoX191MTYpKCAoKChfX3UxNikodmFsKSAmIChfX3UxNikweDAwZmZVKSA8PCA4KSB8ICgo
KF9fdTE2KSh2YWwpICYgKF9fdTE2KTB4ZmYwMFUpID4+IDgpKSk7Cgp9CgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
X19hdHRyaWJ1dGVfXygoX19jb25zdF9fKSkgX191MzIgX19mc3dhYjMyKF9fdTMyIHZhbCkK
ewoKCgogcmV0dXJuICgoX191MzIpKCAoKChfX3UzMikodmFsKSAmIChfX3UzMikweDAwMDAw
MGZmVUwpIDw8IDI0KSB8ICgoKF9fdTMyKSh2YWwpICYgKF9fdTMyKTB4MDAwMGZmMDBVTCkg
PDwgOCkgfCAoKChfX3UzMikodmFsKSAmIChfX3UzMikweDAwZmYwMDAwVUwpID4+IDgpIHwg
KCgoX191MzIpKHZhbCkgJiAoX191MzIpMHhmZjAwMDAwMFVMKSA+PiAyNCkpKTsKCn0KCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2NvbnN0X18pKSBfX3U2NCBfX2Zzd2FiNjQoX191
NjQgdmFsKQp7CgoKCgoKCgogcmV0dXJuICgoX191NjQpKCAoKChfX3U2NCkodmFsKSAmIChf
X3U2NCkweDAwMDAwMDAwMDAwMDAwZmZVTEwpIDw8IDU2KSB8ICgoKF9fdTY0KSh2YWwpICYg
KF9fdTY0KTB4MDAwMDAwMDAwMDAwZmYwMFVMTCkgPDwgNDApIHwgKCgoX191NjQpKHZhbCkg
JiAoX191NjQpMHgwMDAwMDAwMDAwZmYwMDAwVUxMKSA8PCAyNCkgfCAoKChfX3U2NCkodmFs
KSAmIChfX3U2NCkweDAwMDAwMDAwZmYwMDAwMDBVTEwpIDw8IDgpIHwgKCgoX191NjQpKHZh
bCkgJiAoX191NjQpMHgwMDAwMDBmZjAwMDAwMDAwVUxMKSA+PiA4KSB8ICgoKF9fdTY0KSh2
YWwpICYgKF9fdTY0KTB4MDAwMGZmMDAwMDAwMDAwMFVMTCkgPj4gMjQpIHwgKCgoX191NjQp
KHZhbCkgJiAoX191NjQpMHgwMGZmMDAwMDAwMDAwMDAwVUxMKSA+PiA0MCkgfCAoKChfX3U2
NCkodmFsKSAmIChfX3U2NCkweGZmMDAwMDAwMDAwMDAwMDBVTEwpID4+IDU2KSkpOwoKfQoK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fY29uc3RfXykpIF9fdTMyIF9fZnN3YWh3MzIo
X191MzIgdmFsKQp7CgoKCiByZXR1cm4gKChfX3UzMikoICgoKF9fdTMyKSh2YWwpICYgKF9f
dTMyKTB4MDAwMGZmZmZVTCkgPDwgMTYpIHwgKCgoX191MzIpKHZhbCkgJiAoX191MzIpMHhm
ZmZmMDAwMFVMKSA+PiAxNikpKTsKCn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Nv
bnN0X18pKSBfX3UzMiBfX2Zzd2FoYjMyKF9fdTMyIHZhbCkKewoKCgogcmV0dXJuICgoX191
MzIpKCAoKChfX3UzMikodmFsKSAmIChfX3UzMikweDAwZmYwMGZmVUwpIDw8IDgpIHwgKCgo
X191MzIpKHZhbCkgJiAoX191MzIpMHhmZjAwZmYwMFVMKSA+PiA4KSkpOwoKfQojIDEzNiAi
Li9pbmNsdWRlL3VhcGkvbGludXgvc3dhYi5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygo
X19hbHdheXNfaW5saW5lX18pKSB1bnNpZ25lZCBsb25nIF9fc3dhYihjb25zdCB1bnNpZ25l
ZCBsb25nIHkpCnsKCiByZXR1cm4gKF9fdTY0KV9fYnVpbHRpbl9ic3dhcDY0KChfX3U2NCko
eSkpOwoKCgp9CiMgMTcxICIuL2luY2x1ZGUvdWFwaS9saW51eC9zd2FiLmgiCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIF9fdTE2IF9fc3dhYjE2cChj
b25zdCBfX3UxNiAqcCkKewoKCgogcmV0dXJuIChfX3UxNilfX2J1aWx0aW5fYnN3YXAxNigo
X191MTYpKCpwKSk7Cgp9CgoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlz
X2lubGluZV9fKSkgX191MzIgX19zd2FiMzJwKGNvbnN0IF9fdTMyICpwKQp7CgoKCiByZXR1
cm4gKF9fdTMyKV9fYnVpbHRpbl9ic3dhcDMyKChfX3UzMikoKnApKTsKCn0KCgoKCgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBfX3U2NCBfX3N3YWI2
NHAoY29uc3QgX191NjQgKnApCnsKCgoKIHJldHVybiAoX191NjQpX19idWlsdGluX2Jzd2Fw
NjQoKF9fdTY0KSgqcCkpOwoKfQoKCgoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fdTMyIF9fc3dhaHczMnAo
Y29uc3QgX191MzIgKnApCnsKCgoKIHJldHVybiAoX19idWlsdGluX2NvbnN0YW50X3AoKF9f
dTMyKSgqcCkpID8gKChfX3UzMikoICgoKF9fdTMyKSgqcCkgJiAoX191MzIpMHgwMDAwZmZm
ZlVMKSA8PCAxNikgfCAoKChfX3UzMikoKnApICYgKF9fdTMyKTB4ZmZmZjAwMDBVTCkgPj4g
MTYpKSkgOiBfX2Zzd2FodzMyKCpwKSk7Cgp9CgoKCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX191MzIgX19z
d2FoYjMycChjb25zdCBfX3UzMiAqcCkKewoKCgogcmV0dXJuIChfX2J1aWx0aW5fY29uc3Rh
bnRfcCgoX191MzIpKCpwKSkgPyAoKF9fdTMyKSggKCgoX191MzIpKCpwKSAmIChfX3UzMikw
eDAwZmYwMGZmVUwpIDw8IDgpIHwgKCgoX191MzIpKCpwKSAmIChfX3UzMikweGZmMDBmZjAw
VUwpID4+IDgpKSkgOiBfX2Zzd2FoYjMyKCpwKSk7Cgp9CgoKCgoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQg
X19zd2FiMTZzKF9fdTE2ICpwKQp7CgoKCiAqcCA9IF9fc3dhYjE2cChwKTsKCn0KCgoKCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHZvaWQgX19zd2Fi
MzJzKF9fdTMyICpwKQp7CgoKCiAqcCA9IF9fc3dhYjMycChwKTsKCn0KCgoKCgpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB2b2lkIF9fc3dhYjY0cyhf
X3U2NCAqcCkKewoKCgogKnAgPSBfX3N3YWI2NHAocCk7Cgp9CgoKCgoKCgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
dm9pZCBfX3N3YWh3MzJzKF9fdTMyICpwKQp7CgoKCiAqcCA9IF9fc3dhaHczMnAocCk7Cgp9
CgoKCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBfX3N3YWhiMzJzKF9fdTMyICpwKQp7CgoKCiAqcCA9
IF9fc3dhaGIzMnAocCk7Cgp9CiMgNiAiLi9pbmNsdWRlL2xpbnV4L3N3YWIuaCIgMgojIDE0
ICIuL2luY2x1ZGUvdWFwaS9saW51eC9ieXRlb3JkZXIvYmlnX2VuZGlhbi5oIiAyCiMgNDQg
Ii4vaW5jbHVkZS91YXBpL2xpbnV4L2J5dGVvcmRlci9iaWdfZW5kaWFuLmgiCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIF9fbGU2NCBfX2NwdV90b19s
ZTY0cChjb25zdCBfX3U2NCAqcCkKewogcmV0dXJuICggX19sZTY0KV9fc3dhYjY0cChwKTsK
fQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBfX3U2NCBf
X2xlNjRfdG9fY3B1cChjb25zdCBfX2xlNjQgKnApCnsKIHJldHVybiBfX3N3YWI2NHAoKF9f
dTY0ICopcCk7Cn0Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9f
KSkgX19sZTMyIF9fY3B1X3RvX2xlMzJwKGNvbnN0IF9fdTMyICpwKQp7CiByZXR1cm4gKCBf
X2xlMzIpX19zd2FiMzJwKHApOwp9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5
c19pbmxpbmVfXykpIF9fdTMyIF9fbGUzMl90b19jcHVwKGNvbnN0IF9fbGUzMiAqcCkKewog
cmV0dXJuIF9fc3dhYjMycCgoX191MzIgKilwKTsKfQpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVf
XygoX19hbHdheXNfaW5saW5lX18pKSBfX2xlMTYgX19jcHVfdG9fbGUxNnAoY29uc3QgX191
MTYgKnApCnsKIHJldHVybiAoIF9fbGUxNilfX3N3YWIxNnAocCk7Cn0Kc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9f
YXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgX191MTYgX19sZTE2X3RvX2NwdXAo
Y29uc3QgX19sZTE2ICpwKQp7CiByZXR1cm4gX19zd2FiMTZwKChfX3UxNiAqKXApOwp9CnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIF9fYmU2NCBfX2Nw
dV90b19iZTY0cChjb25zdCBfX3U2NCAqcCkKewogcmV0dXJuICggX19iZTY0KSpwOwp9CnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIF9fdTY0IF9fYmU2
NF90b19jcHVwKGNvbnN0IF9fYmU2NCAqcCkKewogcmV0dXJuICggX191NjQpKnA7Cn0Kc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgX19iZTMyIF9fY3B1
X3RvX2JlMzJwKGNvbnN0IF9fdTMyICpwKQp7CiByZXR1cm4gKCBfX2JlMzIpKnA7Cn0Kc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgX191MzIgX19iZTMy
X3RvX2NwdXAoY29uc3QgX19iZTMyICpwKQp7CiByZXR1cm4gKCBfX3UzMikqcDsKfQpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBfX2JlMTYgX19jcHVf
dG9fYmUxNnAoY29uc3QgX191MTYgKnApCnsKIHJldHVybiAoIF9fYmUxNikqcDsKfQpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBfX3UxNiBfX2JlMTZf
dG9fY3B1cChjb25zdCBfX2JlMTYgKnApCnsKIHJldHVybiAoIF9fdTE2KSpwOwp9CiMgNiAi
Li9pbmNsdWRlL2xpbnV4L2J5dGVvcmRlci9iaWdfZW5kaWFuLmgiIDIKCgoKCgojIDEgIi4v
aW5jbHVkZS9saW51eC9ieXRlb3JkZXIvZ2VuZXJpYy5oIiAxCiMgMTQ0ICIuL2luY2x1ZGUv
bGludXgvYnl0ZW9yZGVyL2dlbmVyaWMuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgbGUxNl9hZGRfY3B1
KF9fbGUxNiAqdmFyLCB1MTYgdmFsKQp7CiAqdmFyID0gKCggX19sZTE2KShfX3UxNilfX2J1
aWx0aW5fYnN3YXAxNigoX191MTYpKCgoX191MTYpX19idWlsdGluX2Jzd2FwMTYoKF9fdTE2
KSgoIF9fdTE2KShfX2xlMTYpKCp2YXIpKSkgKyB2YWwpKSkpOwp9CgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9p
ZCBsZTMyX2FkZF9jcHUoX19sZTMyICp2YXIsIHUzMiB2YWwpCnsKICp2YXIgPSAoKCBfX2xl
MzIpKF9fdTMyKV9fYnVpbHRpbl9ic3dhcDMyKChfX3UzMikoKChfX3UzMilfX2J1aWx0aW5f
YnN3YXAzMigoX191MzIpKCggX191MzIpKF9fbGUzMikoKnZhcikpKSArIHZhbCkpKSk7Cn0K
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSB2b2lkIGxlNjRfYWRkX2NwdShfX2xlNjQgKnZhciwgdTY0IHZhbCkKewog
KnZhciA9ICgoIF9fbGU2NCkoX191NjQpX19idWlsdGluX2Jzd2FwNjQoKF9fdTY0KSgoKF9f
dTY0KV9fYnVpbHRpbl9ic3dhcDY0KChfX3U2NCkoKCBfX3U2NCkoX19sZTY0KSgqdmFyKSkp
ICsgdmFsKSkpKTsKfQoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGxlMzJfdG9fY3B1X2FycmF5KHUzMiAq
YnVmLCB1bnNpZ25lZCBpbnQgd29yZHMpCnsKIHdoaWxlICh3b3Jkcy0tKSB7CiAgX19zd2Fi
MzJzKChidWYpKTsKICBidWYrKzsKIH0KfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgY3B1X3RvX2xlMzJf
YXJyYXkodTMyICpidWYsIHVuc2lnbmVkIGludCB3b3JkcykKewogd2hpbGUgKHdvcmRzLS0p
IHsKICBfX3N3YWIzMnMoKGJ1ZikpOwogIGJ1ZisrOwogfQp9CgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBi
ZTE2X2FkZF9jcHUoX19iZTE2ICp2YXIsIHUxNiB2YWwpCnsKICp2YXIgPSAoKCBfX2JlMTYp
KF9fdTE2KSgoKCBfX3UxNikoX19iZTE2KSgqdmFyKSkgKyB2YWwpKTsKfQoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IHZvaWQgYmUzMl9hZGRfY3B1KF9fYmUzMiAqdmFyLCB1MzIgdmFsKQp7CiAqdmFyID0gKCgg
X19iZTMyKShfX3UzMikoKCggX191MzIpKF9fYmUzMikoKnZhcikpICsgdmFsKSk7Cn0KCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSB2b2lkIGJlNjRfYWRkX2NwdShfX2JlNjQgKnZhciwgdTY0IHZhbCkKewogKnZh
ciA9ICgoIF9fYmU2NCkoX191NjQpKCgoIF9fdTY0KShfX2JlNjQpKCp2YXIpKSArIHZhbCkp
Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgdm9pZCBjcHVfdG9fYmUzMl9hcnJheShfX2JlMzIgKmRzdCwgY29u
c3QgdTMyICpzcmMsIHNpemVfdCBsZW4pCnsKIGludCBpOwoKIGZvciAoaSA9IDA7IGkgPCBs
ZW47IGkrKykKICBkc3RbaV0gPSAoKCBfX2JlMzIpKF9fdTMyKShzcmNbaV0pKTsKfQoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIHZvaWQgYmUzMl90b19jcHVfYXJyYXkodTMyICpkc3QsIGNvbnN0IF9fYmUzMiAq
c3JjLCBzaXplX3QgbGVuKQp7CiBpbnQgaTsKCiBmb3IgKGkgPSAwOyBpIDwgbGVuOyBpKysp
CiAgZHN0W2ldID0gKCggX191MzIpKF9fYmUzMikoc3JjW2ldKSk7Cn0KIyAxMiAiLi9pbmNs
dWRlL2xpbnV4L2J5dGVvcmRlci9iaWdfZW5kaWFuLmgiIDIKIyAxNSAiLi9hcmNoL3Bvd2Vy
cGMvaW5jbHVkZS91YXBpL2FzbS9ieXRlb3JkZXIuaCIgMgojIDcgIi4vaW5jbHVkZS9hc20t
Z2VuZXJpYy9iaXRvcHMvbGUuaCIgMgojIDM1ICIuL2luY2x1ZGUvYXNtLWdlbmVyaWMvYml0
b3BzL2xlLmgiCmV4dGVybiB1bnNpZ25lZCBsb25nIGZpbmRfbmV4dF96ZXJvX2JpdF9sZShj
b25zdCB2b2lkICphZGRyLAogIHVuc2lnbmVkIGxvbmcgc2l6ZSwgdW5zaWduZWQgbG9uZyBv
ZmZzZXQpOwoKCgpleHRlcm4gdW5zaWduZWQgbG9uZyBmaW5kX25leHRfYml0X2xlKGNvbnN0
IHZvaWQgKmFkZHIsCiAgdW5zaWduZWQgbG9uZyBzaXplLCB1bnNpZ25lZCBsb25nIG9mZnNl
dCk7CiMgNTMgIi4vaW5jbHVkZS9hc20tZ2VuZXJpYy9iaXRvcHMvbGUuaCIKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IGludCB0ZXN0X2JpdF9sZShpbnQgbnIsIGNvbnN0IHZvaWQgKmFkZHIpCnsKIHJldHVybiB0
ZXN0X2JpdChuciBeICgoNjQgLTEpICYgfjB4NyksIGFkZHIpOwp9CgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9p
ZCBzZXRfYml0X2xlKGludCBuciwgdm9pZCAqYWRkcikKewogc2V0X2JpdChuciBeICgoNjQg
LTEpICYgfjB4NyksIGFkZHIpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBjbGVhcl9iaXRfbGUoaW50
IG5yLCB2b2lkICphZGRyKQp7CiBjbGVhcl9iaXQobnIgXiAoKDY0IC0xKSAmIH4weDcpLCBh
ZGRyKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgX19zZXRfYml0X2xlKGludCBuciwgdm9pZCAqYWRk
cikKewogX19zZXRfYml0KG5yIF4gKCg2NCAtMSkgJiB+MHg3KSwgYWRkcik7Cn0KCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSB2b2lkIF9fY2xlYXJfYml0X2xlKGludCBuciwgdm9pZCAqYWRkcikKewogX19jbGVh
cl9iaXQobnIgXiAoKDY0IC0xKSAmIH4weDcpLCBhZGRyKTsKfQoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCB0
ZXN0X2FuZF9zZXRfYml0X2xlKGludCBuciwgdm9pZCAqYWRkcikKewogcmV0dXJuIHRlc3Rf
YW5kX3NldF9iaXQobnIgXiAoKDY0IC0xKSAmIH4weDcpLCBhZGRyKTsKfQoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IGludCB0ZXN0X2FuZF9jbGVhcl9iaXRfbGUoaW50IG5yLCB2b2lkICphZGRyKQp7CiByZXR1
cm4gdGVzdF9hbmRfY2xlYXJfYml0KG5yIF4gKCg2NCAtMSkgJiB+MHg3KSwgYWRkcik7Cn0K
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSBpbnQgX190ZXN0X2FuZF9zZXRfYml0X2xlKGludCBuciwgdm9pZCAqYWRk
cikKewogcmV0dXJuIF9fdGVzdF9hbmRfc2V0X2JpdChuciBeICgoNjQgLTEpICYgfjB4Nyks
IGFkZHIpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IF9fdGVzdF9hbmRfY2xlYXJfYml0X2xlKGludCBu
ciwgdm9pZCAqYWRkcikKewogcmV0dXJuIF9fdGVzdF9hbmRfY2xlYXJfYml0KG5yIF4gKCg2
NCAtMSkgJiB+MHg3KSwgYWRkcik7Cn0KIyAyNDcgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUv
YXNtL2JpdG9wcy5oIiAyCgoKCiMgMSAiLi9pbmNsdWRlL2FzbS1nZW5lcmljL2JpdG9wcy9l
eHQyLWF0b21pYy1zZXRiaXQuaCIgMQojIDI1MSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9h
c20vYml0b3BzLmgiIDIKCiMgMSAiLi9pbmNsdWRlL2FzbS1nZW5lcmljL2JpdG9wcy9zY2hl
ZC5oIiAxCiMgMTMgIi4vaW5jbHVkZS9hc20tZ2VuZXJpYy9iaXRvcHMvc2NoZWQuaCIKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIGludCBzY2hlZF9maW5kX2ZpcnN0X2JpdChjb25zdCB1bnNpZ25lZCBsb25nICpi
KQp7CgogaWYgKGJbMF0pCiAgcmV0dXJuIF9fZmZzKGJbMF0pOwogcmV0dXJuIF9fZmZzKGJb
MV0pICsgNjQ7CiMgMzAgIi4vaW5jbHVkZS9hc20tZ2VuZXJpYy9iaXRvcHMvc2NoZWQuaCIK
fQojIDI1MyAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vYml0b3BzLmgiIDIKIyAzMCAi
Li9pbmNsdWRlL2xpbnV4L2JpdG9wcy5oIiAyCiMgNjUgIi4vaW5jbHVkZS9saW51eC9iaXRv
cHMuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIGludCBnZXRfYml0bWFza19vcmRlcih1bnNpZ25lZCBpbnQgY291
bnQpCnsKIGludCBvcmRlcjsKCiBvcmRlciA9IGZscyhjb3VudCk7CiByZXR1cm4gb3JkZXI7
Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHVuc2ln
bmVkIGxvbmcgaHdlaWdodF9sb25nKHVuc2lnbmVkIGxvbmcgdykKewogcmV0dXJuIHNpemVv
Zih3KSA9PSA0ID8gKF9fYnVpbHRpbl9jb25zdGFudF9wKHcpID8gKCgoKHVuc2lnbmVkIGlu
dCkgKCghISgodykgJiAoMVVMTCA8PCAwKSkpICsgKCEhKCh3KSAmICgxVUxMIDw8IDEpKSkg
KyAoISEoKHcpICYgKDFVTEwgPDwgMikpKSArICghISgodykgJiAoMVVMTCA8PCAzKSkpICsg
KCEhKCh3KSAmICgxVUxMIDw8IDQpKSkgKyAoISEoKHcpICYgKDFVTEwgPDwgNSkpKSArICgh
ISgodykgJiAoMVVMTCA8PCA2KSkpICsgKCEhKCh3KSAmICgxVUxMIDw8IDcpKSkpKSArICgo
dW5zaWduZWQgaW50KSAoKCEhKCgodykgPj4gOCkgJiAoMVVMTCA8PCAwKSkpICsgKCEhKCgo
dykgPj4gOCkgJiAoMVVMTCA8PCAxKSkpICsgKCEhKCgodykgPj4gOCkgJiAoMVVMTCA8PCAy
KSkpICsgKCEhKCgodykgPj4gOCkgJiAoMVVMTCA8PCAzKSkpICsgKCEhKCgodykgPj4gOCkg
JiAoMVVMTCA8PCA0KSkpICsgKCEhKCgodykgPj4gOCkgJiAoMVVMTCA8PCA1KSkpICsgKCEh
KCgodykgPj4gOCkgJiAoMVVMTCA8PCA2KSkpICsgKCEhKCgodykgPj4gOCkgJiAoMVVMTCA8
PCA3KSkpKSkpICsgKCgodW5zaWduZWQgaW50KSAoKCEhKCgodykgPj4gMTYpICYgKDFVTEwg
PDwgMCkpKSArICghISgoKHcpID4+IDE2KSAmICgxVUxMIDw8IDEpKSkgKyAoISEoKCh3KSA+
PiAxNikgJiAoMVVMTCA8PCAyKSkpICsgKCEhKCgodykgPj4gMTYpICYgKDFVTEwgPDwgMykp
KSArICghISgoKHcpID4+IDE2KSAmICgxVUxMIDw8IDQpKSkgKyAoISEoKCh3KSA+PiAxNikg
JiAoMVVMTCA8PCA1KSkpICsgKCEhKCgodykgPj4gMTYpICYgKDFVTEwgPDwgNikpKSArICgh
ISgoKHcpID4+IDE2KSAmICgxVUxMIDw8IDcpKSkpKSArICgodW5zaWduZWQgaW50KSAoKCEh
KCgoKHcpID4+IDE2KSA+PiA4KSAmICgxVUxMIDw8IDApKSkgKyAoISEoKCgodykgPj4gMTYp
ID4+IDgpICYgKDFVTEwgPDwgMSkpKSArICghISgoKCh3KSA+PiAxNikgPj4gOCkgJiAoMVVM
TCA8PCAyKSkpICsgKCEhKCgoKHcpID4+IDE2KSA+PiA4KSAmICgxVUxMIDw8IDMpKSkgKyAo
ISEoKCgodykgPj4gMTYpID4+IDgpICYgKDFVTEwgPDwgNCkpKSArICghISgoKCh3KSA+PiAx
NikgPj4gOCkgJiAoMVVMTCA8PCA1KSkpICsgKCEhKCgoKHcpID4+IDE2KSA+PiA4KSAmICgx
VUxMIDw8IDYpKSkgKyAoISEoKCgodykgPj4gMTYpID4+IDgpICYgKDFVTEwgPDwgNykpKSkp
KSkgOiBfX2FyY2hfaHdlaWdodDMyKHcpKSA6IChfX2J1aWx0aW5fY29uc3RhbnRfcCgoX191
NjQpdykgPyAoKCgoKHVuc2lnbmVkIGludCkgKCghISgoKF9fdTY0KXcpICYgKDFVTEwgPDwg
MCkpKSArICghISgoKF9fdTY0KXcpICYgKDFVTEwgPDwgMSkpKSArICghISgoKF9fdTY0KXcp
ICYgKDFVTEwgPDwgMikpKSArICghISgoKF9fdTY0KXcpICYgKDFVTEwgPDwgMykpKSArICgh
ISgoKF9fdTY0KXcpICYgKDFVTEwgPDwgNCkpKSArICghISgoKF9fdTY0KXcpICYgKDFVTEwg
PDwgNSkpKSArICghISgoKF9fdTY0KXcpICYgKDFVTEwgPDwgNikpKSArICghISgoKF9fdTY0
KXcpICYgKDFVTEwgPDwgNykpKSkpICsgKCh1bnNpZ25lZCBpbnQpICgoISEoKCgoX191NjQp
dykgPj4gOCkgJiAoMVVMTCA8PCAwKSkpICsgKCEhKCgoKF9fdTY0KXcpID4+IDgpICYgKDFV
TEwgPDwgMSkpKSArICghISgoKChfX3U2NCl3KSA+PiA4KSAmICgxVUxMIDw8IDIpKSkgKyAo
ISEoKCgoX191NjQpdykgPj4gOCkgJiAoMVVMTCA8PCAzKSkpICsgKCEhKCgoKF9fdTY0KXcp
ID4+IDgpICYgKDFVTEwgPDwgNCkpKSArICghISgoKChfX3U2NCl3KSA+PiA4KSAmICgxVUxM
IDw8IDUpKSkgKyAoISEoKCgoX191NjQpdykgPj4gOCkgJiAoMVVMTCA8PCA2KSkpICsgKCEh
KCgoKF9fdTY0KXcpID4+IDgpICYgKDFVTEwgPDwgNykpKSkpKSArICgoKHVuc2lnbmVkIGlu
dCkgKCghISgoKChfX3U2NCl3KSA+PiAxNikgJiAoMVVMTCA8PCAwKSkpICsgKCEhKCgoKF9f
dTY0KXcpID4+IDE2KSAmICgxVUxMIDw8IDEpKSkgKyAoISEoKCgoX191NjQpdykgPj4gMTYp
ICYgKDFVTEwgPDwgMikpKSArICghISgoKChfX3U2NCl3KSA+PiAxNikgJiAoMVVMTCA8PCAz
KSkpICsgKCEhKCgoKF9fdTY0KXcpID4+IDE2KSAmICgxVUxMIDw8IDQpKSkgKyAoISEoKCgo
X191NjQpdykgPj4gMTYpICYgKDFVTEwgPDwgNSkpKSArICghISgoKChfX3U2NCl3KSA+PiAx
NikgJiAoMVVMTCA8PCA2KSkpICsgKCEhKCgoKF9fdTY0KXcpID4+IDE2KSAmICgxVUxMIDw8
IDcpKSkpKSArICgodW5zaWduZWQgaW50KSAoKCEhKCgoKChfX3U2NCl3KSA+PiAxNikgPj4g
OCkgJiAoMVVMTCA8PCAwKSkpICsgKCEhKCgoKChfX3U2NCl3KSA+PiAxNikgPj4gOCkgJiAo
MVVMTCA8PCAxKSkpICsgKCEhKCgoKChfX3U2NCl3KSA+PiAxNikgPj4gOCkgJiAoMVVMTCA8
PCAyKSkpICsgKCEhKCgoKChfX3U2NCl3KSA+PiAxNikgPj4gOCkgJiAoMVVMTCA8PCAzKSkp
ICsgKCEhKCgoKChfX3U2NCl3KSA+PiAxNikgPj4gOCkgJiAoMVVMTCA8PCA0KSkpICsgKCEh
KCgoKChfX3U2NCl3KSA+PiAxNikgPj4gOCkgJiAoMVVMTCA8PCA1KSkpICsgKCEhKCgoKChf
X3U2NCl3KSA+PiAxNikgPj4gOCkgJiAoMVVMTCA8PCA2KSkpICsgKCEhKCgoKChfX3U2NCl3
KSA+PiAxNikgPj4gOCkgJiAoMVVMTCA8PCA3KSkpKSkpKSArICgoKCh1bnNpZ25lZCBpbnQp
ICgoISEoKCgoX191NjQpdykgPj4gMzIpICYgKDFVTEwgPDwgMCkpKSArICghISgoKChfX3U2
NCl3KSA+PiAzMikgJiAoMVVMTCA8PCAxKSkpICsgKCEhKCgoKF9fdTY0KXcpID4+IDMyKSAm
ICgxVUxMIDw8IDIpKSkgKyAoISEoKCgoX191NjQpdykgPj4gMzIpICYgKDFVTEwgPDwgMykp
KSArICghISgoKChfX3U2NCl3KSA+PiAzMikgJiAoMVVMTCA8PCA0KSkpICsgKCEhKCgoKF9f
dTY0KXcpID4+IDMyKSAmICgxVUxMIDw8IDUpKSkgKyAoISEoKCgoX191NjQpdykgPj4gMzIp
ICYgKDFVTEwgPDwgNikpKSArICghISgoKChfX3U2NCl3KSA+PiAzMikgJiAoMVVMTCA8PCA3
KSkpKSkgKyAoKHVuc2lnbmVkIGludCkgKCghISgoKCgoX191NjQpdykgPj4gMzIpID4+IDgp
ICYgKDFVTEwgPDwgMCkpKSArICghISgoKCgoX191NjQpdykgPj4gMzIpID4+IDgpICYgKDFV
TEwgPDwgMSkpKSArICghISgoKCgoX191NjQpdykgPj4gMzIpID4+IDgpICYgKDFVTEwgPDwg
MikpKSArICghISgoKCgoX191NjQpdykgPj4gMzIpID4+IDgpICYgKDFVTEwgPDwgMykpKSAr
ICghISgoKCgoX191NjQpdykgPj4gMzIpID4+IDgpICYgKDFVTEwgPDwgNCkpKSArICghISgo
KCgoX191NjQpdykgPj4gMzIpID4+IDgpICYgKDFVTEwgPDwgNSkpKSArICghISgoKCgoX191
NjQpdykgPj4gMzIpID4+IDgpICYgKDFVTEwgPDwgNikpKSArICghISgoKCgoX191NjQpdykg
Pj4gMzIpID4+IDgpICYgKDFVTEwgPDwgNykpKSkpKSArICgoKHVuc2lnbmVkIGludCkgKCgh
ISgoKCgoX191NjQpdykgPj4gMzIpID4+IDE2KSAmICgxVUxMIDw8IDApKSkgKyAoISEoKCgo
KF9fdTY0KXcpID4+IDMyKSA+PiAxNikgJiAoMVVMTCA8PCAxKSkpICsgKCEhKCgoKChfX3U2
NCl3KSA+PiAzMikgPj4gMTYpICYgKDFVTEwgPDwgMikpKSArICghISgoKCgoX191NjQpdykg
Pj4gMzIpID4+IDE2KSAmICgxVUxMIDw8IDMpKSkgKyAoISEoKCgoKF9fdTY0KXcpID4+IDMy
KSA+PiAxNikgJiAoMVVMTCA8PCA0KSkpICsgKCEhKCgoKChfX3U2NCl3KSA+PiAzMikgPj4g
MTYpICYgKDFVTEwgPDwgNSkpKSArICghISgoKCgoX191NjQpdykgPj4gMzIpID4+IDE2KSAm
ICgxVUxMIDw8IDYpKSkgKyAoISEoKCgoKF9fdTY0KXcpID4+IDMyKSA+PiAxNikgJiAoMVVM
TCA8PCA3KSkpKSkgKyAoKHVuc2lnbmVkIGludCkgKCghISgoKCgoKF9fdTY0KXcpID4+IDMy
KSA+PiAxNikgPj4gOCkgJiAoMVVMTCA8PCAwKSkpICsgKCEhKCgoKCgoX191NjQpdykgPj4g
MzIpID4+IDE2KSA+PiA4KSAmICgxVUxMIDw8IDEpKSkgKyAoISEoKCgoKChfX3U2NCl3KSA+
PiAzMikgPj4gMTYpID4+IDgpICYgKDFVTEwgPDwgMikpKSArICghISgoKCgoKF9fdTY0KXcp
ID4+IDMyKSA+PiAxNikgPj4gOCkgJiAoMVVMTCA8PCAzKSkpICsgKCEhKCgoKCgoX191NjQp
dykgPj4gMzIpID4+IDE2KSA+PiA4KSAmICgxVUxMIDw8IDQpKSkgKyAoISEoKCgoKChfX3U2
NCl3KSA+PiAzMikgPj4gMTYpID4+IDgpICYgKDFVTEwgPDwgNSkpKSArICghISgoKCgoKF9f
dTY0KXcpID4+IDMyKSA+PiAxNikgPj4gOCkgJiAoMVVMTCA8PCA2KSkpICsgKCEhKCgoKCgo
X191NjQpdykgPj4gMzIpID4+IDE2KSA+PiA4KSAmICgxVUxMIDw8IDcpKSkpKSkpKSA6IF9f
YXJjaF9od2VpZ2h0NjQoKF9fdTY0KXcpKTsKfQoKCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX191NjQgcm9s
NjQoX191NjQgd29yZCwgdW5zaWduZWQgaW50IHNoaWZ0KQp7CiByZXR1cm4gKHdvcmQgPDwg
KHNoaWZ0ICYgNjMpKSB8ICh3b3JkID4+ICgoLXNoaWZ0KSAmIDYzKSk7Cn0KCgoKCgoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIF9fdTY0IHJvcjY0KF9fdTY0IHdvcmQsIHVuc2lnbmVkIGludCBzaGlmdCkKewog
cmV0dXJuICh3b3JkID4+IChzaGlmdCAmIDYzKSkgfCAod29yZCA8PCAoKC1zaGlmdCkgJiA2
MykpOwp9CgoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX3UzMiByb2wzMihfX3UzMiB3b3JkLCB1bnNpZ25l
ZCBpbnQgc2hpZnQpCnsKIHJldHVybiAod29yZCA8PCAoc2hpZnQgJiAzMSkpIHwgKHdvcmQg
Pj4gKCgtc2hpZnQpICYgMzEpKTsKfQoKCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX191MzIgcm9yMzIoX191
MzIgd29yZCwgdW5zaWduZWQgaW50IHNoaWZ0KQp7CiByZXR1cm4gKHdvcmQgPj4gKHNoaWZ0
ICYgMzEpKSB8ICh3b3JkIDw8ICgoLXNoaWZ0KSAmIDMxKSk7Cn0KCgoKCgoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IF9fdTE2IHJvbDE2KF9fdTE2IHdvcmQsIHVuc2lnbmVkIGludCBzaGlmdCkKewogcmV0dXJu
ICh3b3JkIDw8IChzaGlmdCAmIDE1KSkgfCAod29yZCA+PiAoKC1zaGlmdCkgJiAxNSkpOwp9
CgoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSBfX3UxNiByb3IxNihfX3UxNiB3b3JkLCB1bnNpZ25lZCBpbnQg
c2hpZnQpCnsKIHJldHVybiAod29yZCA+PiAoc2hpZnQgJiAxNSkpIHwgKHdvcmQgPDwgKCgt
c2hpZnQpICYgMTUpKTsKfQoKCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX191OCByb2w4KF9fdTggd29yZCwg
dW5zaWduZWQgaW50IHNoaWZ0KQp7CiByZXR1cm4gKHdvcmQgPDwgKHNoaWZ0ICYgNykpIHwg
KHdvcmQgPj4gKCgtc2hpZnQpICYgNykpOwp9CgoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX3U4IHJvcjgo
X191OCB3b3JkLCB1bnNpZ25lZCBpbnQgc2hpZnQpCnsKIHJldHVybiAod29yZCA+PiAoc2hp
ZnQgJiA3KSkgfCAod29yZCA8PCAoKC1zaGlmdCkgJiA3KSk7Cn0KIyAxNjUgIi4vaW5jbHVk
ZS9saW51eC9iaXRvcHMuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lu
bGluZV9fKSkgX19zMzIgc2lnbl9leHRlbmQzMihfX3UzMiB2YWx1ZSwgaW50IGluZGV4KQp7
CiBfX3U4IHNoaWZ0ID0gMzEgLSBpbmRleDsKIHJldHVybiAoX19zMzIpKHZhbHVlIDw8IHNo
aWZ0KSA+PiBzaGlmdDsKfQoKCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdh
eXNfaW5saW5lX18pKSBfX3M2NCBzaWduX2V4dGVuZDY0KF9fdTY0IHZhbHVlLCBpbnQgaW5k
ZXgpCnsKIF9fdTggc2hpZnQgPSA2MyAtIGluZGV4OwogcmV0dXJuIChfX3M2NCkodmFsdWUg
PDwgc2hpZnQpID4+IHNoaWZ0Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgZmxzX2xvbmcodW5z
aWduZWQgbG9uZyBsKQp7CiBpZiAoc2l6ZW9mKGwpID09IDQpCiAgcmV0dXJuIGZscyhsKTsK
IHJldHVybiBmbHM2NChsKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBnZXRfY291bnRfb3JkZXIodW5z
aWduZWQgaW50IGNvdW50KQp7CiBpbnQgb3JkZXI7Cgogb3JkZXIgPSBmbHMoY291bnQpIC0g
MTsKIGlmIChjb3VudCAmIChjb3VudCAtIDEpKQogIG9yZGVyKys7CiByZXR1cm4gb3JkZXI7
Cn0KCgoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgZ2V0X2NvdW50X29yZGVyX2xvbmcodW5zaWduZWQg
bG9uZyBsKQp7CiBpZiAobCA9PSAwVUwpCiAgcmV0dXJuIC0xOwogZWxzZSBpZiAobCAmIChs
IC0gMVVMKSkKICByZXR1cm4gKGludClmbHNfbG9uZyhsKTsKIGVsc2UKICByZXR1cm4gKGlu
dClmbHNfbG9uZyhsKSAtIDE7Cn0KIyAyMjMgIi4vaW5jbHVkZS9saW51eC9iaXRvcHMuaCIK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIHVuc2lnbmVkIGxvbmcgX19mZnM2NCh1NjQgd29yZCkKewoKCgoKCgogcmV0
dXJuIF9fZmZzKCh1bnNpZ25lZCBsb25nKXdvcmQpOwp9CgoKCgoKCgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19h
dHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB2b2lkIGFzc2lnbl9iaXQobG9uZyBu
ciwgdm9sYXRpbGUgdW5zaWduZWQgbG9uZyAqYWRkciwKICAgICAgICAgICBib29sIHZhbHVl
KQp7CiBpZiAodmFsdWUpCiAgc2V0X2JpdChuciwgYWRkcik7CiBlbHNlCiAgY2xlYXJfYml0
KG5yLCBhZGRyKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGlu
ZV9fKSkgdm9pZCBfX2Fzc2lnbl9iaXQobG9uZyBuciwgdm9sYXRpbGUgdW5zaWduZWQgbG9u
ZyAqYWRkciwKICAgICAgYm9vbCB2YWx1ZSkKewogaWYgKHZhbHVlKQogIF9fc2V0X2JpdChu
ciwgYWRkcik7CiBlbHNlCiAgX19jbGVhcl9iaXQobnIsIGFkZHIpOwp9CiMgMjk5ICIuL2lu
Y2x1ZGUvbGludXgvYml0b3BzLmgiCmV4dGVybiB1bnNpZ25lZCBsb25nIGZpbmRfbGFzdF9i
aXQoY29uc3QgdW5zaWduZWQgbG9uZyAqYWRkciwKICAgICAgIHVuc2lnbmVkIGxvbmcgc2l6
ZSk7CiMgMTMgIi4vaW5jbHVkZS9saW51eC9rZXJuZWwuaCIgMgojIDEgIi4vaW5jbHVkZS9s
aW51eC9sb2cyLmgiIDEKIyAyMSAiLi9pbmNsdWRlL2xpbnV4L2xvZzIuaCIKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IF9fYXR0cmlidXRlX18oKGNvbnN0KSkKaW50IF9faWxvZzJfdTMyKHUzMiBuKQp7CiByZXR1
cm4gZmxzKG4pIC0gMTsKfQoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoY29uc3QpKQpp
bnQgX19pbG9nMl91NjQodTY0IG4pCnsKIHJldHVybiBmbHM2NChuKSAtIDE7Cn0KIyA0NCAi
Li9pbmNsdWRlL2xpbnV4L2xvZzIuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKGNvbnN0
KSkKYm9vbCBpc19wb3dlcl9vZl8yKHVuc2lnbmVkIGxvbmcgbikKewogcmV0dXJuIChuICE9
IDAgJiYgKChuICYgKG4gLSAxKSkgPT0gMCkpOwp9CgoKCgoKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmli
dXRlX18oKGNvbnN0KSkKdW5zaWduZWQgbG9uZyBfX3JvdW5kdXBfcG93X29mX3R3byh1bnNp
Z25lZCBsb25nIG4pCnsKIHJldHVybiAxVUwgPDwgZmxzX2xvbmcobiAtIDEpOwp9CgoKCgoK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIF9fYXR0cmlidXRlX18oKGNvbnN0KSkKdW5zaWduZWQgbG9uZyBfX3JvdW5k
ZG93bl9wb3dfb2ZfdHdvKHVuc2lnbmVkIGxvbmcgbikKewogcmV0dXJuIDFVTCA8PCAoZmxz
X2xvbmcobikgLSAxKTsKfQojIDE5NyAiLi9pbmNsdWRlL2xpbnV4L2xvZzIuaCIKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIF9fYXR0cmlidXRlX18oKF9fY29uc3RfXykpCmludCBfX29yZGVyX2Jhc2VfMih1bnNp
Z25lZCBsb25nIG4pCnsKIHJldHVybiBuID4gMSA/ICggX19idWlsdGluX2NvbnN0YW50X3Ao
biAtIDEpID8gKCBfX2J1aWx0aW5fY29uc3RhbnRfcChuIC0gMSkgPyAoIChuIC0gMSkgPCAy
ID8gMCA6IChuIC0gMSkgJiAoMVVMTCA8PCA2MykgPyA2MyA6IChuIC0gMSkgJiAoMVVMTCA8
PCA2MikgPyA2MiA6IChuIC0gMSkgJiAoMVVMTCA8PCA2MSkgPyA2MSA6IChuIC0gMSkgJiAo
MVVMTCA8PCA2MCkgPyA2MCA6IChuIC0gMSkgJiAoMVVMTCA8PCA1OSkgPyA1OSA6IChuIC0g
MSkgJiAoMVVMTCA8PCA1OCkgPyA1OCA6IChuIC0gMSkgJiAoMVVMTCA8PCA1NykgPyA1NyA6
IChuIC0gMSkgJiAoMVVMTCA8PCA1NikgPyA1NiA6IChuIC0gMSkgJiAoMVVMTCA8PCA1NSkg
PyA1NSA6IChuIC0gMSkgJiAoMVVMTCA8PCA1NCkgPyA1NCA6IChuIC0gMSkgJiAoMVVMTCA8
PCA1MykgPyA1MyA6IChuIC0gMSkgJiAoMVVMTCA8PCA1MikgPyA1MiA6IChuIC0gMSkgJiAo
MVVMTCA8PCA1MSkgPyA1MSA6IChuIC0gMSkgJiAoMVVMTCA8PCA1MCkgPyA1MCA6IChuIC0g
MSkgJiAoMVVMTCA8PCA0OSkgPyA0OSA6IChuIC0gMSkgJiAoMVVMTCA8PCA0OCkgPyA0OCA6
IChuIC0gMSkgJiAoMVVMTCA8PCA0NykgPyA0NyA6IChuIC0gMSkgJiAoMVVMTCA8PCA0Nikg
PyA0NiA6IChuIC0gMSkgJiAoMVVMTCA8PCA0NSkgPyA0NSA6IChuIC0gMSkgJiAoMVVMTCA8
PCA0NCkgPyA0NCA6IChuIC0gMSkgJiAoMVVMTCA8PCA0MykgPyA0MyA6IChuIC0gMSkgJiAo
MVVMTCA8PCA0MikgPyA0MiA6IChuIC0gMSkgJiAoMVVMTCA8PCA0MSkgPyA0MSA6IChuIC0g
MSkgJiAoMVVMTCA8PCA0MCkgPyA0MCA6IChuIC0gMSkgJiAoMVVMTCA8PCAzOSkgPyAzOSA6
IChuIC0gMSkgJiAoMVVMTCA8PCAzOCkgPyAzOCA6IChuIC0gMSkgJiAoMVVMTCA8PCAzNykg
PyAzNyA6IChuIC0gMSkgJiAoMVVMTCA8PCAzNikgPyAzNiA6IChuIC0gMSkgJiAoMVVMTCA8
PCAzNSkgPyAzNSA6IChuIC0gMSkgJiAoMVVMTCA8PCAzNCkgPyAzNCA6IChuIC0gMSkgJiAo
MVVMTCA8PCAzMykgPyAzMyA6IChuIC0gMSkgJiAoMVVMTCA8PCAzMikgPyAzMiA6IChuIC0g
MSkgJiAoMVVMTCA8PCAzMSkgPyAzMSA6IChuIC0gMSkgJiAoMVVMTCA8PCAzMCkgPyAzMCA6
IChuIC0gMSkgJiAoMVVMTCA8PCAyOSkgPyAyOSA6IChuIC0gMSkgJiAoMVVMTCA8PCAyOCkg
PyAyOCA6IChuIC0gMSkgJiAoMVVMTCA8PCAyNykgPyAyNyA6IChuIC0gMSkgJiAoMVVMTCA8
PCAyNikgPyAyNiA6IChuIC0gMSkgJiAoMVVMTCA8PCAyNSkgPyAyNSA6IChuIC0gMSkgJiAo
MVVMTCA8PCAyNCkgPyAyNCA6IChuIC0gMSkgJiAoMVVMTCA8PCAyMykgPyAyMyA6IChuIC0g
MSkgJiAoMVVMTCA8PCAyMikgPyAyMiA6IChuIC0gMSkgJiAoMVVMTCA8PCAyMSkgPyAyMSA6
IChuIC0gMSkgJiAoMVVMTCA8PCAyMCkgPyAyMCA6IChuIC0gMSkgJiAoMVVMTCA8PCAxOSkg
PyAxOSA6IChuIC0gMSkgJiAoMVVMTCA8PCAxOCkgPyAxOCA6IChuIC0gMSkgJiAoMVVMTCA8
PCAxNykgPyAxNyA6IChuIC0gMSkgJiAoMVVMTCA8PCAxNikgPyAxNiA6IChuIC0gMSkgJiAo
MVVMTCA8PCAxNSkgPyAxNSA6IChuIC0gMSkgJiAoMVVMTCA8PCAxNCkgPyAxNCA6IChuIC0g
MSkgJiAoMVVMTCA8PCAxMykgPyAxMyA6IChuIC0gMSkgJiAoMVVMTCA8PCAxMikgPyAxMiA6
IChuIC0gMSkgJiAoMVVMTCA8PCAxMSkgPyAxMSA6IChuIC0gMSkgJiAoMVVMTCA8PCAxMCkg
PyAxMCA6IChuIC0gMSkgJiAoMVVMTCA8PCA5KSA/IDkgOiAobiAtIDEpICYgKDFVTEwgPDwg
OCkgPyA4IDogKG4gLSAxKSAmICgxVUxMIDw8IDcpID8gNyA6IChuIC0gMSkgJiAoMVVMTCA8
PCA2KSA/IDYgOiAobiAtIDEpICYgKDFVTEwgPDwgNSkgPyA1IDogKG4gLSAxKSAmICgxVUxM
IDw8IDQpID8gNCA6IChuIC0gMSkgJiAoMVVMTCA8PCAzKSA/IDMgOiAobiAtIDEpICYgKDFV
TEwgPDwgMikgPyAyIDogMSkgOiAtMSkgOiAoc2l6ZW9mKG4gLSAxKSA8PSA0KSA/IF9faWxv
ZzJfdTMyKG4gLSAxKSA6IF9faWxvZzJfdTY0KG4gLSAxKSApICsgMSA6IDA7Cn0KIyAyMjQg
Ii4vaW5jbHVkZS9saW51eC9sb2cyLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChjb25z
dCkpCmludCBfX2JpdHNfcGVyKHVuc2lnbmVkIGxvbmcgbikKewogaWYgKG4gPCAyKQogIHJl
dHVybiAxOwogaWYgKGlzX3Bvd2VyX29mXzIobikpCiAgcmV0dXJuICggX19idWlsdGluX2Nv
bnN0YW50X3AobikgPyAoICgobikgPT0gMCB8fCAobikgPT0gMSkgPyAwIDogKCBfX2J1aWx0
aW5fY29uc3RhbnRfcCgobikgLSAxKSA/ICggX19idWlsdGluX2NvbnN0YW50X3AoKG4pIC0g
MSkgPyAoICgobikgLSAxKSA8IDIgPyAwIDogKChuKSAtIDEpICYgKDFVTEwgPDwgNjMpID8g
NjMgOiAoKG4pIC0gMSkgJiAoMVVMTCA8PCA2MikgPyA2MiA6ICgobikgLSAxKSAmICgxVUxM
IDw8IDYxKSA/IDYxIDogKChuKSAtIDEpICYgKDFVTEwgPDwgNjApID8gNjAgOiAoKG4pIC0g
MSkgJiAoMVVMTCA8PCA1OSkgPyA1OSA6ICgobikgLSAxKSAmICgxVUxMIDw8IDU4KSA/IDU4
IDogKChuKSAtIDEpICYgKDFVTEwgPDwgNTcpID8gNTcgOiAoKG4pIC0gMSkgJiAoMVVMTCA8
PCA1NikgPyA1NiA6ICgobikgLSAxKSAmICgxVUxMIDw8IDU1KSA/IDU1IDogKChuKSAtIDEp
ICYgKDFVTEwgPDwgNTQpID8gNTQgOiAoKG4pIC0gMSkgJiAoMVVMTCA8PCA1MykgPyA1MyA6
ICgobikgLSAxKSAmICgxVUxMIDw8IDUyKSA/IDUyIDogKChuKSAtIDEpICYgKDFVTEwgPDwg
NTEpID8gNTEgOiAoKG4pIC0gMSkgJiAoMVVMTCA8PCA1MCkgPyA1MCA6ICgobikgLSAxKSAm
ICgxVUxMIDw8IDQ5KSA/IDQ5IDogKChuKSAtIDEpICYgKDFVTEwgPDwgNDgpID8gNDggOiAo
KG4pIC0gMSkgJiAoMVVMTCA8PCA0NykgPyA0NyA6ICgobikgLSAxKSAmICgxVUxMIDw8IDQ2
KSA/IDQ2IDogKChuKSAtIDEpICYgKDFVTEwgPDwgNDUpID8gNDUgOiAoKG4pIC0gMSkgJiAo
MVVMTCA8PCA0NCkgPyA0NCA6ICgobikgLSAxKSAmICgxVUxMIDw8IDQzKSA/IDQzIDogKChu
KSAtIDEpICYgKDFVTEwgPDwgNDIpID8gNDIgOiAoKG4pIC0gMSkgJiAoMVVMTCA8PCA0MSkg
PyA0MSA6ICgobikgLSAxKSAmICgxVUxMIDw8IDQwKSA/IDQwIDogKChuKSAtIDEpICYgKDFV
TEwgPDwgMzkpID8gMzkgOiAoKG4pIC0gMSkgJiAoMVVMTCA8PCAzOCkgPyAzOCA6ICgobikg
LSAxKSAmICgxVUxMIDw8IDM3KSA/IDM3IDogKChuKSAtIDEpICYgKDFVTEwgPDwgMzYpID8g
MzYgOiAoKG4pIC0gMSkgJiAoMVVMTCA8PCAzNSkgPyAzNSA6ICgobikgLSAxKSAmICgxVUxM
IDw8IDM0KSA/IDM0IDogKChuKSAtIDEpICYgKDFVTEwgPDwgMzMpID8gMzMgOiAoKG4pIC0g
MSkgJiAoMVVMTCA8PCAzMikgPyAzMiA6ICgobikgLSAxKSAmICgxVUxMIDw8IDMxKSA/IDMx
IDogKChuKSAtIDEpICYgKDFVTEwgPDwgMzApID8gMzAgOiAoKG4pIC0gMSkgJiAoMVVMTCA8
PCAyOSkgPyAyOSA6ICgobikgLSAxKSAmICgxVUxMIDw8IDI4KSA/IDI4IDogKChuKSAtIDEp
ICYgKDFVTEwgPDwgMjcpID8gMjcgOiAoKG4pIC0gMSkgJiAoMVVMTCA8PCAyNikgPyAyNiA6
ICgobikgLSAxKSAmICgxVUxMIDw8IDI1KSA/IDI1IDogKChuKSAtIDEpICYgKDFVTEwgPDwg
MjQpID8gMjQgOiAoKG4pIC0gMSkgJiAoMVVMTCA8PCAyMykgPyAyMyA6ICgobikgLSAxKSAm
ICgxVUxMIDw8IDIyKSA/IDIyIDogKChuKSAtIDEpICYgKDFVTEwgPDwgMjEpID8gMjEgOiAo
KG4pIC0gMSkgJiAoMVVMTCA8PCAyMCkgPyAyMCA6ICgobikgLSAxKSAmICgxVUxMIDw8IDE5
KSA/IDE5IDogKChuKSAtIDEpICYgKDFVTEwgPDwgMTgpID8gMTggOiAoKG4pIC0gMSkgJiAo
MVVMTCA8PCAxNykgPyAxNyA6ICgobikgLSAxKSAmICgxVUxMIDw8IDE2KSA/IDE2IDogKChu
KSAtIDEpICYgKDFVTEwgPDwgMTUpID8gMTUgOiAoKG4pIC0gMSkgJiAoMVVMTCA8PCAxNCkg
PyAxNCA6ICgobikgLSAxKSAmICgxVUxMIDw8IDEzKSA/IDEzIDogKChuKSAtIDEpICYgKDFV
TEwgPDwgMTIpID8gMTIgOiAoKG4pIC0gMSkgJiAoMVVMTCA8PCAxMSkgPyAxMSA6ICgobikg
LSAxKSAmICgxVUxMIDw8IDEwKSA/IDEwIDogKChuKSAtIDEpICYgKDFVTEwgPDwgOSkgPyA5
IDogKChuKSAtIDEpICYgKDFVTEwgPDwgOCkgPyA4IDogKChuKSAtIDEpICYgKDFVTEwgPDwg
NykgPyA3IDogKChuKSAtIDEpICYgKDFVTEwgPDwgNikgPyA2IDogKChuKSAtIDEpICYgKDFV
TEwgPDwgNSkgPyA1IDogKChuKSAtIDEpICYgKDFVTEwgPDwgNCkgPyA0IDogKChuKSAtIDEp
ICYgKDFVTEwgPDwgMykgPyAzIDogKChuKSAtIDEpICYgKDFVTEwgPDwgMikgPyAyIDogMSkg
OiAtMSkgOiAoc2l6ZW9mKChuKSAtIDEpIDw9IDQpID8gX19pbG9nMl91MzIoKG4pIC0gMSkg
OiBfX2lsb2cyX3U2NCgobikgLSAxKSApICsgMSkgOiBfX29yZGVyX2Jhc2VfMihuKSApICsg
MTsKIHJldHVybiAoIF9fYnVpbHRpbl9jb25zdGFudF9wKG4pID8gKCAoKG4pID09IDAgfHwg
KG4pID09IDEpID8gMCA6ICggX19idWlsdGluX2NvbnN0YW50X3AoKG4pIC0gMSkgPyAoIF9f
YnVpbHRpbl9jb25zdGFudF9wKChuKSAtIDEpID8gKCAoKG4pIC0gMSkgPCAyID8gMCA6ICgo
bikgLSAxKSAmICgxVUxMIDw8IDYzKSA/IDYzIDogKChuKSAtIDEpICYgKDFVTEwgPDwgNjIp
ID8gNjIgOiAoKG4pIC0gMSkgJiAoMVVMTCA8PCA2MSkgPyA2MSA6ICgobikgLSAxKSAmICgx
VUxMIDw8IDYwKSA/IDYwIDogKChuKSAtIDEpICYgKDFVTEwgPDwgNTkpID8gNTkgOiAoKG4p
IC0gMSkgJiAoMVVMTCA8PCA1OCkgPyA1OCA6ICgobikgLSAxKSAmICgxVUxMIDw8IDU3KSA/
IDU3IDogKChuKSAtIDEpICYgKDFVTEwgPDwgNTYpID8gNTYgOiAoKG4pIC0gMSkgJiAoMVVM
TCA8PCA1NSkgPyA1NSA6ICgobikgLSAxKSAmICgxVUxMIDw8IDU0KSA/IDU0IDogKChuKSAt
IDEpICYgKDFVTEwgPDwgNTMpID8gNTMgOiAoKG4pIC0gMSkgJiAoMVVMTCA8PCA1MikgPyA1
MiA6ICgobikgLSAxKSAmICgxVUxMIDw8IDUxKSA/IDUxIDogKChuKSAtIDEpICYgKDFVTEwg
PDwgNTApID8gNTAgOiAoKG4pIC0gMSkgJiAoMVVMTCA8PCA0OSkgPyA0OSA6ICgobikgLSAx
KSAmICgxVUxMIDw8IDQ4KSA/IDQ4IDogKChuKSAtIDEpICYgKDFVTEwgPDwgNDcpID8gNDcg
OiAoKG4pIC0gMSkgJiAoMVVMTCA8PCA0NikgPyA0NiA6ICgobikgLSAxKSAmICgxVUxMIDw8
IDQ1KSA/IDQ1IDogKChuKSAtIDEpICYgKDFVTEwgPDwgNDQpID8gNDQgOiAoKG4pIC0gMSkg
JiAoMVVMTCA8PCA0MykgPyA0MyA6ICgobikgLSAxKSAmICgxVUxMIDw8IDQyKSA/IDQyIDog
KChuKSAtIDEpICYgKDFVTEwgPDwgNDEpID8gNDEgOiAoKG4pIC0gMSkgJiAoMVVMTCA8PCA0
MCkgPyA0MCA6ICgobikgLSAxKSAmICgxVUxMIDw8IDM5KSA/IDM5IDogKChuKSAtIDEpICYg
KDFVTEwgPDwgMzgpID8gMzggOiAoKG4pIC0gMSkgJiAoMVVMTCA8PCAzNykgPyAzNyA6ICgo
bikgLSAxKSAmICgxVUxMIDw8IDM2KSA/IDM2IDogKChuKSAtIDEpICYgKDFVTEwgPDwgMzUp
ID8gMzUgOiAoKG4pIC0gMSkgJiAoMVVMTCA8PCAzNCkgPyAzNCA6ICgobikgLSAxKSAmICgx
VUxMIDw8IDMzKSA/IDMzIDogKChuKSAtIDEpICYgKDFVTEwgPDwgMzIpID8gMzIgOiAoKG4p
IC0gMSkgJiAoMVVMTCA8PCAzMSkgPyAzMSA6ICgobikgLSAxKSAmICgxVUxMIDw8IDMwKSA/
IDMwIDogKChuKSAtIDEpICYgKDFVTEwgPDwgMjkpID8gMjkgOiAoKG4pIC0gMSkgJiAoMVVM
TCA8PCAyOCkgPyAyOCA6ICgobikgLSAxKSAmICgxVUxMIDw8IDI3KSA/IDI3IDogKChuKSAt
IDEpICYgKDFVTEwgPDwgMjYpID8gMjYgOiAoKG4pIC0gMSkgJiAoMVVMTCA8PCAyNSkgPyAy
NSA6ICgobikgLSAxKSAmICgxVUxMIDw8IDI0KSA/IDI0IDogKChuKSAtIDEpICYgKDFVTEwg
PDwgMjMpID8gMjMgOiAoKG4pIC0gMSkgJiAoMVVMTCA8PCAyMikgPyAyMiA6ICgobikgLSAx
KSAmICgxVUxMIDw8IDIxKSA/IDIxIDogKChuKSAtIDEpICYgKDFVTEwgPDwgMjApID8gMjAg
OiAoKG4pIC0gMSkgJiAoMVVMTCA8PCAxOSkgPyAxOSA6ICgobikgLSAxKSAmICgxVUxMIDw8
IDE4KSA/IDE4IDogKChuKSAtIDEpICYgKDFVTEwgPDwgMTcpID8gMTcgOiAoKG4pIC0gMSkg
JiAoMVVMTCA8PCAxNikgPyAxNiA6ICgobikgLSAxKSAmICgxVUxMIDw8IDE1KSA/IDE1IDog
KChuKSAtIDEpICYgKDFVTEwgPDwgMTQpID8gMTQgOiAoKG4pIC0gMSkgJiAoMVVMTCA8PCAx
MykgPyAxMyA6ICgobikgLSAxKSAmICgxVUxMIDw8IDEyKSA/IDEyIDogKChuKSAtIDEpICYg
KDFVTEwgPDwgMTEpID8gMTEgOiAoKG4pIC0gMSkgJiAoMVVMTCA8PCAxMCkgPyAxMCA6ICgo
bikgLSAxKSAmICgxVUxMIDw8IDkpID8gOSA6ICgobikgLSAxKSAmICgxVUxMIDw8IDgpID8g
OCA6ICgobikgLSAxKSAmICgxVUxMIDw8IDcpID8gNyA6ICgobikgLSAxKSAmICgxVUxMIDw8
IDYpID8gNiA6ICgobikgLSAxKSAmICgxVUxMIDw8IDUpID8gNSA6ICgobikgLSAxKSAmICgx
VUxMIDw8IDQpID8gNCA6ICgobikgLSAxKSAmICgxVUxMIDw8IDMpID8gMyA6ICgobikgLSAx
KSAmICgxVUxMIDw8IDIpID8gMiA6IDEpIDogLTEpIDogKHNpemVvZigobikgLSAxKSA8PSA0
KSA/IF9faWxvZzJfdTMyKChuKSAtIDEpIDogX19pbG9nMl91NjQoKG4pIC0gMSkgKSArIDEp
IDogX19vcmRlcl9iYXNlXzIobikgKTsKfQojIDE0ICIuL2luY2x1ZGUvbGludXgva2VybmVs
LmgiIDIKIyAxICIuL2luY2x1ZGUvbGludXgvdHlwZWNoZWNrLmgiIDEKIyAxNSAiLi9pbmNs
dWRlL2xpbnV4L2tlcm5lbC5oIiAyCiMgMSAiLi9pbmNsdWRlL2xpbnV4L3ByaW50ay5oIiAx
CgoKCgoKIyAxICIuL2luY2x1ZGUvbGludXgvaW5pdC5oIiAxCiMgMTE2ICIuL2luY2x1ZGUv
bGludXgvaW5pdC5oIgp0eXBlZGVmIGludCAoKmluaXRjYWxsX3QpKHZvaWQpOwp0eXBlZGVm
IHZvaWQgKCpleGl0Y2FsbF90KSh2b2lkKTsKIyAxMjcgIi4vaW5jbHVkZS9saW51eC9pbml0
LmgiCnR5cGVkZWYgaW5pdGNhbGxfdCBpbml0Y2FsbF9lbnRyeV90OwoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGlu
aXRjYWxsX3QgaW5pdGNhbGxfZnJvbV9lbnRyeShpbml0Y2FsbF9lbnRyeV90ICplbnRyeSkK
ewogcmV0dXJuICplbnRyeTsKfQoKCmV4dGVybiBpbml0Y2FsbF9lbnRyeV90IF9fY29uX2lu
aXRjYWxsX3N0YXJ0W10sIF9fY29uX2luaXRjYWxsX2VuZFtdOwoKCnR5cGVkZWYgdm9pZCAo
KmN0b3JfZm5fdCkodm9pZCk7CgpzdHJ1Y3QgZmlsZV9zeXN0ZW1fdHlwZTsKCgpleHRlcm4g
aW50IGRvX29uZV9pbml0Y2FsbChpbml0Y2FsbF90IGZuKTsKZXh0ZXJuIGNoYXIgX19hdHRy
aWJ1dGVfXygoX19zZWN0aW9uX18oIi5pbml0LmRhdGEiKSkpIGJvb3RfY29tbWFuZF9saW5l
W107CmV4dGVybiBjaGFyICpzYXZlZF9jb21tYW5kX2xpbmU7CmV4dGVybiB1bnNpZ25lZCBp
bnQgcmVzZXRfZGV2aWNlczsKCgp2b2lkIHNldHVwX2FyY2goY2hhciAqKik7CnZvaWQgcHJl
cGFyZV9uYW1lc3BhY2Uodm9pZCk7CnZvaWQgX19hdHRyaWJ1dGVfXygoX19zZWN0aW9uX18o
Ii5pbml0LnRleHQiKSkpIF9fYXR0cmlidXRlX18oKF9fY29sZF9fKSkgaW5pdF9yb290ZnMo
dm9pZCk7CmV4dGVybiBzdHJ1Y3QgZmlsZV9zeXN0ZW1fdHlwZSByb290ZnNfZnNfdHlwZTsK
IyAxNjEgIi4vaW5jbHVkZS9saW51eC9pbml0LmgiCmV4dGVybiB2b2lkICgqbGF0ZV90aW1l
X2luaXQpKHZvaWQpOwoKZXh0ZXJuIGJvb2wgaW5pdGNhbGxfZGVidWc7CiMgMjQxICIuL2lu
Y2x1ZGUvbGludXgvaW5pdC5oIgpzdHJ1Y3Qgb2JzX2tlcm5lbF9wYXJhbSB7CiBjb25zdCBj
aGFyICpzdHI7CiBpbnQgKCpzZXR1cF9mdW5jKShjaGFyICopOwogaW50IGVhcmx5Owp9Owoj
IDI5MCAiLi9pbmNsdWRlL2xpbnV4L2luaXQuaCIKdm9pZCBfX2F0dHJpYnV0ZV9fKChfX3Nl
Y3Rpb25fXygiLmluaXQudGV4dCIpKSkgX19hdHRyaWJ1dGVfXygoX19jb2xkX18pKSBwYXJz
ZV9lYXJseV9wYXJhbSh2b2lkKTsKdm9pZCBfX2F0dHJpYnV0ZV9fKChfX3NlY3Rpb25fXygi
LmluaXQudGV4dCIpKSkgX19hdHRyaWJ1dGVfXygoX19jb2xkX18pKSBwYXJzZV9lYXJseV9v
cHRpb25zKGNoYXIgKmNtZGxpbmUpOwojIDcgIi4vaW5jbHVkZS9saW51eC9wcmludGsuaCIg
MgojIDEgIi4vaW5jbHVkZS9saW51eC9rZXJuX2xldmVscy5oIiAxCiMgOCAiLi9pbmNsdWRl
L2xpbnV4L3ByaW50ay5oIiAyCgojIDEgIi4vaW5jbHVkZS9saW51eC9jYWNoZS5oIiAxCgoK
CgojIDEgIi4vaW5jbHVkZS91YXBpL2xpbnV4L2tlcm5lbC5oIiAxCgoKCgojIDEgIi4vaW5j
bHVkZS91YXBpL2xpbnV4L3N5c2luZm8uaCIgMQoKCgoKCgoKc3RydWN0IHN5c2luZm8gewog
X19rZXJuZWxfbG9uZ190IHVwdGltZTsKIF9fa2VybmVsX3Vsb25nX3QgbG9hZHNbM107CiBf
X2tlcm5lbF91bG9uZ190IHRvdGFscmFtOwogX19rZXJuZWxfdWxvbmdfdCBmcmVlcmFtOwog
X19rZXJuZWxfdWxvbmdfdCBzaGFyZWRyYW07CiBfX2tlcm5lbF91bG9uZ190IGJ1ZmZlcnJh
bTsKIF9fa2VybmVsX3Vsb25nX3QgdG90YWxzd2FwOwogX19rZXJuZWxfdWxvbmdfdCBmcmVl
c3dhcDsKIF9fdTE2IHByb2NzOwogX191MTYgcGFkOwogX19rZXJuZWxfdWxvbmdfdCB0b3Rh
bGhpZ2g7CiBfX2tlcm5lbF91bG9uZ190IGZyZWVoaWdoOwogX191MzIgbWVtX3VuaXQ7CiBj
aGFyIF9mWzIwLTIqc2l6ZW9mKF9fa2VybmVsX3Vsb25nX3QpLXNpemVvZihfX3UzMildOwp9
OwojIDYgIi4vaW5jbHVkZS91YXBpL2xpbnV4L2tlcm5lbC5oIiAyCiMgNiAiLi9pbmNsdWRl
L2xpbnV4L2NhY2hlLmgiIDIKIyAxICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9jYWNo
ZS5oIiAxCiMgMzkgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2NhY2hlLmgiCnN0cnVj
dCBwcGNfY2FjaGVfaW5mbyB7CiB1MzIgc2l6ZTsKIHUzMiBsaW5lX3NpemU7CiB1MzIgYmxv
Y2tfc2l6ZTsKIHUzMiBsb2dfYmxvY2tfc2l6ZTsKIHUzMiBibG9ja3NfcGVyX3BhZ2U7CiB1
MzIgc2V0czsKIHUzMiBhc3NvYzsKfTsKCnN0cnVjdCBwcGM2NF9jYWNoZXMgewogc3RydWN0
IHBwY19jYWNoZV9pbmZvIGwxZDsKIHN0cnVjdCBwcGNfY2FjaGVfaW5mbyBsMWk7CiBzdHJ1
Y3QgcHBjX2NhY2hlX2luZm8gbDI7CiBzdHJ1Y3QgcHBjX2NhY2hlX2luZm8gbDM7Cn07Cgpl
eHRlcm4gc3RydWN0IHBwYzY0X2NhY2hlcyBwcGM2NF9jYWNoZXM7CgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdTMy
IGwxX2RjYWNoZV9zaGlmdCh2b2lkKQp7CiByZXR1cm4gcHBjNjRfY2FjaGVzLmwxZC5sb2df
YmxvY2tfc2l6ZTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHUzMiBsMV9kY2FjaGVfYnl0ZXModm9pZCkKewog
cmV0dXJuIHBwYzY0X2NhY2hlcy5sMWQuYmxvY2tfc2l6ZTsKfQoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHUzMiBs
MV9pY2FjaGVfc2hpZnQodm9pZCkKewogcmV0dXJuIHBwYzY0X2NhY2hlcy5sMWkubG9nX2Js
b2NrX3NpemU7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1MzIgbDFfaWNhY2hlX2J5dGVzKHZvaWQpCnsKIHJl
dHVybiBwcGM2NF9jYWNoZXMubDFpLmJsb2NrX3NpemU7Cn0KIyAxMTQgIi4vYXJjaC9wb3dl
cnBjL2luY2x1ZGUvYXNtL2NhY2hlLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGRjYnoodm9pZCAqYWRk
cikKewogX19hc21fXyBfX3ZvbGF0aWxlX18gKCJkY2J6IDAsICUwIiA6IDogInIiKGFkZHIp
IDogIm1lbW9yeSIpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBkY2JpKHZvaWQgKmFkZHIpCnsKIF9f
YXNtX18gX192b2xhdGlsZV9fICgiZGNiaSAwLCAlMCIgOiA6ICJyIihhZGRyKSA6ICJtZW1v
cnkiKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgZGNiZih2b2lkICphZGRyKQp7CiBfX2FzbV9fIF9f
dm9sYXRpbGVfXyAoImRjYmYgMCwgJTAiIDogOiAiciIoYWRkcikgOiAibWVtb3J5Iik7Cn0K
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSB2b2lkIGRjYnN0KHZvaWQgKmFkZHIpCnsKIF9fYXNtX18gX192b2xhdGls
ZV9fICgiZGNic3QgMCwgJTAiIDogOiAiciIoYWRkcikgOiAibWVtb3J5Iik7Cn0KCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSB2b2lkIGljYmkodm9pZCAqYWRkcikKewogYXNtIHZvbGF0aWxlICgiaWNiaSAwLCAl
MCIgOiA6ICJyIihhZGRyKSA6ICJtZW1vcnkiKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgaWNjY2ko
dm9pZCAqYWRkcikKewogYXNtIHZvbGF0aWxlICgiaWNjY2kgMCwgJTAiIDogOiAiciIoYWRk
cikgOiAibWVtb3J5Iik7Cn0KIyA3ICIuL2luY2x1ZGUvbGludXgvY2FjaGUuaCIgMgojIDEw
ICIuL2luY2x1ZGUvbGludXgvcHJpbnRrLmgiIDIKCmV4dGVybiBjb25zdCBjaGFyIGxpbnV4
X2Jhbm5lcltdOwpleHRlcm4gY29uc3QgY2hhciBsaW51eF9wcm9jX2Jhbm5lcltdOwoKCgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgaW50IHByaW50a19nZXRfbGV2ZWwoY29uc3QgY2hhciAqYnVmZmVyKQp7CiBp
ZiAoYnVmZmVyWzBdID09ICdcMDAxJyAmJiBidWZmZXJbMV0pIHsKICBzd2l0Y2ggKGJ1ZmZl
clsxXSkgewogIGNhc2UgJzAnIC4uLiAnNyc6CiAgY2FzZSAnYyc6CiAgIHJldHVybiBidWZm
ZXJbMV07CiAgfQogfQogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBjb25zdCBjaGFyICpwcmlu
dGtfc2tpcF9sZXZlbChjb25zdCBjaGFyICpidWZmZXIpCnsKIGlmIChwcmludGtfZ2V0X2xl
dmVsKGJ1ZmZlcikpCiAgcmV0dXJuIGJ1ZmZlciArIDI7CgogcmV0dXJuIGJ1ZmZlcjsKfQoK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIGNvbnN0IGNoYXIgKnByaW50a19za2lwX2hlYWRlcnMoY29uc3QgY2hhciAq
YnVmZmVyKQp7CiB3aGlsZSAocHJpbnRrX2dldF9sZXZlbChidWZmZXIpKQogIGJ1ZmZlciA9
IHByaW50a19za2lwX2xldmVsKGJ1ZmZlcik7CgogcmV0dXJuIGJ1ZmZlcjsKfQojIDYyICIu
L2luY2x1ZGUvbGludXgvcHJpbnRrLmgiCmV4dGVybiBpbnQgY29uc29sZV9wcmludGtbXTsK
CgoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIHZvaWQgY29uc29sZV9zaWxlbnQodm9pZCkKewogKGNvbnNvbGVf
cHJpbnRrWzBdKSA9IDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGNvbnNvbGVfdmVyYm9zZSh2b2lk
KQp7CiBpZiAoKGNvbnNvbGVfcHJpbnRrWzBdKSkKICAoY29uc29sZV9wcmludGtbMF0pID0g
MTU7Cn0KCgoKZXh0ZXJuIGNoYXIgZGV2a21zZ19sb2dfc3RyW107CnN0cnVjdCBjdGxfdGFi
bGU7CgpleHRlcm4gaW50IHN1cHByZXNzX3ByaW50azsKCnN0cnVjdCB2YV9mb3JtYXQgewog
Y29uc3QgY2hhciAqZm10OwogdmFfbGlzdCAqdmE7Cn07CiMgMTQyICIuL2luY2x1ZGUvbGlu
dXgvcHJpbnRrLmgiCmV4dGVybiBfX2F0dHJpYnV0ZV9fKChfX2Zvcm1hdF9fKHByaW50Ziwg
MSwgMikpKQp2b2lkIGVhcmx5X3ByaW50ayhjb25zdCBjaGFyICpmbXQsIC4uLik7CgoKCgoK
CmV4dGVybiB2b2lkIHByaW50a19ubWlfZW50ZXIodm9pZCk7CmV4dGVybiB2b2lkIHByaW50
a19ubWlfZXhpdCh2b2lkKTsKZXh0ZXJuIHZvaWQgcHJpbnRrX25taV9kaXJlY3RfZW50ZXIo
dm9pZCk7CmV4dGVybiB2b2lkIHByaW50a19ubWlfZGlyZWN0X2V4aXQodm9pZCk7CiMgMTYy
ICIuL2luY2x1ZGUvbGludXgvcHJpbnRrLmgiCiBfX2F0dHJpYnV0ZV9fKChfX2Zvcm1hdF9f
KHByaW50ZiwgNSwgMCkpKQppbnQgdnByaW50a19lbWl0KGludCBmYWNpbGl0eSwgaW50IGxl
dmVsLAogICBjb25zdCBjaGFyICpkaWN0LCBzaXplX3QgZGljdGxlbiwKICAgY29uc3QgY2hh
ciAqZm10LCB2YV9saXN0IGFyZ3MpOwoKIF9fYXR0cmlidXRlX18oKF9fZm9ybWF0X18ocHJp
bnRmLCAxLCAwKSkpCmludCB2cHJpbnRrKGNvbnN0IGNoYXIgKmZtdCwgdmFfbGlzdCBhcmdz
KTsKCiBfX2F0dHJpYnV0ZV9fKChfX2Zvcm1hdF9fKHByaW50ZiwgMSwgMikpKSBfX2F0dHJp
YnV0ZV9fKChfX2NvbGRfXykpCmludCBwcmludGsoY29uc3QgY2hhciAqZm10LCAuLi4pOwoK
CgoKX19hdHRyaWJ1dGVfXygoX19mb3JtYXRfXyhwcmludGYsIDEsIDIpKSkgX19hdHRyaWJ1
dGVfXygoX19jb2xkX18pKSBpbnQgcHJpbnRrX2RlZmVycmVkKGNvbnN0IGNoYXIgKmZtdCwg
Li4uKTsKCgoKCgoKZXh0ZXJuIGludCBfX3ByaW50a19yYXRlbGltaXQoY29uc3QgY2hhciAq
ZnVuYyk7CgpleHRlcm4gYm9vbCBwcmludGtfdGltZWRfcmF0ZWxpbWl0KHVuc2lnbmVkIGxv
bmcgKmNhbGxlcl9qaWZmaWVzLAogICAgICAgdW5zaWduZWQgaW50IGludGVydmFsX21zZWMp
OwoKZXh0ZXJuIGludCBwcmludGtfZGVsYXlfbXNlYzsKZXh0ZXJuIGludCBkbWVzZ19yZXN0
cmljdDsKCmV4dGVybiBpbnQKZGV2a21zZ19zeXNjdGxfc2V0X2xvZ2x2bChzdHJ1Y3QgY3Rs
X3RhYmxlICp0YWJsZSwgaW50IHdyaXRlLCB2b2lkICpidWYsCiAgICAgc2l6ZV90ICpsZW5w
LCBsb2ZmX3QgKnBwb3MpOwoKZXh0ZXJuIHZvaWQgd2FrZV91cF9rbG9nZCh2b2lkKTsKCmNo
YXIgKmxvZ19idWZfYWRkcl9nZXQodm9pZCk7CnUzMiBsb2dfYnVmX2xlbl9nZXQodm9pZCk7
CnZvaWQgbG9nX2J1Zl92bWNvcmVpbmZvX3NldHVwKHZvaWQpOwp2b2lkIF9fYXR0cmlidXRl
X18oKF9fc2VjdGlvbl9fKCIuaW5pdC50ZXh0IikpKSBfX2F0dHJpYnV0ZV9fKChfX2NvbGRf
XykpIHNldHVwX2xvZ19idWYoaW50IGVhcmx5KTsKX19hdHRyaWJ1dGVfXygoX19mb3JtYXRf
XyhwcmludGYsIDEsIDIpKSkgdm9pZCBkdW1wX3N0YWNrX3NldF9hcmNoX2Rlc2MoY29uc3Qg
Y2hhciAqZm10LCAuLi4pOwp2b2lkIGR1bXBfc3RhY2tfcHJpbnRfaW5mbyhjb25zdCBjaGFy
ICpsb2dfbHZsKTsKdm9pZCBzaG93X3JlZ3NfcHJpbnRfaW5mbyhjb25zdCBjaGFyICpsb2df
bHZsKTsKZXh0ZXJuIHZvaWQgZHVtcF9zdGFjayh2b2lkKSBfX2F0dHJpYnV0ZV9fKChfX2Nv
bGRfXykpOwpleHRlcm4gdm9pZCBwcmludGtfc2FmZV9mbHVzaCh2b2lkKTsKZXh0ZXJuIHZv
aWQgcHJpbnRrX3NhZmVfZmx1c2hfb25fcGFuaWModm9pZCk7CiMgMjgwICIuL2luY2x1ZGUv
bGludXgvcHJpbnRrLmgiCmV4dGVybiBpbnQga3B0cl9yZXN0cmljdDsKIyA1NjAgIi4vaW5j
bHVkZS9saW51eC9wcmludGsuaCIKZXh0ZXJuIGNvbnN0IHN0cnVjdCBmaWxlX29wZXJhdGlv
bnMga21zZ19mb3BzOwoKZW51bSB7CiBEVU1QX1BSRUZJWF9OT05FLAogRFVNUF9QUkVGSVhf
QUREUkVTUywKIERVTVBfUFJFRklYX09GRlNFVAp9OwpleHRlcm4gaW50IGhleF9kdW1wX3Rv
X2J1ZmZlcihjb25zdCB2b2lkICpidWYsIHNpemVfdCBsZW4sIGludCByb3dzaXplLAogICAg
ICAgICBpbnQgZ3JvdXBzaXplLCBjaGFyICpsaW5lYnVmLCBzaXplX3QgbGluZWJ1ZmxlbiwK
ICAgICAgICAgYm9vbCBhc2NpaSk7CgpleHRlcm4gdm9pZCBwcmludF9oZXhfZHVtcChjb25z
dCBjaGFyICpsZXZlbCwgY29uc3QgY2hhciAqcHJlZml4X3N0ciwKICAgICAgaW50IHByZWZp
eF90eXBlLCBpbnQgcm93c2l6ZSwgaW50IGdyb3Vwc2l6ZSwKICAgICAgY29uc3Qgdm9pZCAq
YnVmLCBzaXplX3QgbGVuLCBib29sIGFzY2lpKTsKIyA1OTkgIi4vaW5jbHVkZS9saW51eC9w
cmludGsuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgcHJpbnRfaGV4X2R1bXBfZGVidWcoY29uc3QgY2hh
ciAqcHJlZml4X3N0ciwgaW50IHByZWZpeF90eXBlLAogICAgIGludCByb3dzaXplLCBpbnQg
Z3JvdXBzaXplLAogICAgIGNvbnN0IHZvaWQgKmJ1Ziwgc2l6ZV90IGxlbiwgYm9vbCBhc2Np
aSkKewp9CiMgMTYgIi4vaW5jbHVkZS9saW51eC9rZXJuZWwuaCIgMgojIDEgIi4vaW5jbHVk
ZS9saW51eC9idWlsZF9idWcuaCIgMQojIDE3ICIuL2luY2x1ZGUvbGludXgva2VybmVsLmgi
IDIKCiMgMSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9nZW5lcmF0ZWQvYXNtL2RpdjY0Lmgi
IDEKIyAxICIuL2luY2x1ZGUvYXNtLWdlbmVyaWMvZGl2NjQuaCIgMQojIDEgIi4vYXJjaC9w
b3dlcnBjL2luY2x1ZGUvZ2VuZXJhdGVkL2FzbS9kaXY2NC5oIiAyCiMgMTkgIi4vaW5jbHVk
ZS9saW51eC9rZXJuZWwuaCIgMgoKIyAxICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2dlbmVy
YXRlZC9hc20vZGl2NjQuaCIgMQojIDIxICIuL2luY2x1ZGUvbGludXgva2VybmVsLmgiIDIK
IyAxOTEgIi4vaW5jbHVkZS9saW51eC9rZXJuZWwuaCIKc3RydWN0IGNvbXBsZXRpb247CnN0
cnVjdCBwdF9yZWdzOwpzdHJ1Y3QgdXNlcjsKIyAyNDcgIi4vaW5jbHVkZS9saW51eC9rZXJu
ZWwuaCIKICBzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBfX19taWdodF9zbGVlcChjb25zdCBjaGFyICpmaWxl
LCBpbnQgbGluZSwKICAgICAgIGludCBwcmVlbXB0X29mZnNldCkgeyB9CiAgc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IHZvaWQgX19taWdodF9zbGVlcChjb25zdCBjaGFyICpmaWxlLCBpbnQgbGluZSwKICAgICAg
IGludCBwcmVlbXB0X29mZnNldCkgeyB9CiMgMzA0ICIuL2luY2x1ZGUvbGludXgva2VybmVs
LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSB1MzIgcmVjaXByb2NhbF9zY2FsZSh1MzIgdmFsLCB1MzIgZXBfcm8p
CnsKIHJldHVybiAodTMyKSgoKHU2NCkgdmFsICogZXBfcm8pID4+IDMyKTsKfQoKCgoKCgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgdm9pZCBtaWdodF9mYXVsdCh2b2lkKSB7IH0KCgpleHRlcm4gc3RydWN0IGF0
b21pY19ub3RpZmllcl9oZWFkIHBhbmljX25vdGlmaWVyX2xpc3Q7CmV4dGVybiBsb25nICgq
cGFuaWNfYmxpbmspKGludCBzdGF0ZSk7Cl9fYXR0cmlidXRlX18oKF9fZm9ybWF0X18ocHJp
bnRmLCAxLCAyKSkpCnZvaWQgcGFuaWMoY29uc3QgY2hhciAqZm10LCAuLi4pIF9fYXR0cmli
dXRlX18oKF9fbm9yZXR1cm5fXykpIF9fYXR0cmlidXRlX18oKF9fY29sZF9fKSk7CnZvaWQg
bm1pX3BhbmljKHN0cnVjdCBwdF9yZWdzICpyZWdzLCBjb25zdCBjaGFyICptc2cpOwpleHRl
cm4gdm9pZCBvb3BzX2VudGVyKHZvaWQpOwpleHRlcm4gdm9pZCBvb3BzX2V4aXQodm9pZCk7
CnZvaWQgcHJpbnRfb29wc19lbmRfbWFya2VyKHZvaWQpOwpleHRlcm4gaW50IG9vcHNfbWF5
X3ByaW50KHZvaWQpOwp2b2lkIGRvX2V4aXQobG9uZyBlcnJvcl9jb2RlKSBfX2F0dHJpYnV0
ZV9fKChfX25vcmV0dXJuX18pKTsKdm9pZCBjb21wbGV0ZV9hbmRfZXhpdChzdHJ1Y3QgY29t
cGxldGlvbiAqLCBsb25nKSBfX2F0dHJpYnV0ZV9fKChfX25vcmV0dXJuX18pKTsKCgppbnQg
X19hdHRyaWJ1dGVfXygoX193YXJuX3VudXNlZF9yZXN1bHRfXykpIF9rc3RydG91bChjb25z
dCBjaGFyICpzLCB1bnNpZ25lZCBpbnQgYmFzZSwgdW5zaWduZWQgbG9uZyAqcmVzKTsKaW50
IF9fYXR0cmlidXRlX18oKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKSBfa3N0cnRvbChjb25z
dCBjaGFyICpzLCB1bnNpZ25lZCBpbnQgYmFzZSwgbG9uZyAqcmVzKTsKCmludCBfX2F0dHJp
YnV0ZV9fKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkga3N0cnRvdWxsKGNvbnN0IGNoYXIg
KnMsIHVuc2lnbmVkIGludCBiYXNlLCB1bnNpZ25lZCBsb25nIGxvbmcgKnJlcyk7CmludCBf
X2F0dHJpYnV0ZV9fKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkga3N0cnRvbGwoY29uc3Qg
Y2hhciAqcywgdW5zaWduZWQgaW50IGJhc2UsIGxvbmcgbG9uZyAqcmVzKTsKIyAzNTEgIi4v
aW5jbHVkZS9saW51eC9rZXJuZWwuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBfX2F0dHJpYnV0ZV9fKChf
X3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkga3N0cnRvdWwoY29uc3QgY2hhciAqcywgdW5zaWdu
ZWQgaW50IGJhc2UsIHVuc2lnbmVkIGxvbmcgKnJlcykKewoKCgoKIGlmIChzaXplb2YodW5z
aWduZWQgbG9uZykgPT0gc2l6ZW9mKHVuc2lnbmVkIGxvbmcgbG9uZykgJiYKICAgICBfX2Fs
aWdub2ZfXyh1bnNpZ25lZCBsb25nKSA9PSBfX2FsaWdub2ZfXyh1bnNpZ25lZCBsb25nIGxv
bmcpKQogIHJldHVybiBrc3RydG91bGwocywgYmFzZSwgKHVuc2lnbmVkIGxvbmcgbG9uZyAq
KXJlcyk7CiBlbHNlCiAgcmV0dXJuIF9rc3RydG91bChzLCBiYXNlLCByZXMpOwp9CiMgMzc5
ICIuL2luY2x1ZGUvbGludXgva2VybmVsLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgX19hdHRyaWJ1dGVf
XygoX193YXJuX3VudXNlZF9yZXN1bHRfXykpIGtzdHJ0b2woY29uc3QgY2hhciAqcywgdW5z
aWduZWQgaW50IGJhc2UsIGxvbmcgKnJlcykKewoKCgoKIGlmIChzaXplb2YobG9uZykgPT0g
c2l6ZW9mKGxvbmcgbG9uZykgJiYKICAgICBfX2FsaWdub2ZfXyhsb25nKSA9PSBfX2FsaWdu
b2ZfXyhsb25nIGxvbmcpKQogIHJldHVybiBrc3RydG9sbChzLCBiYXNlLCAobG9uZyBsb25n
ICopcmVzKTsKIGVsc2UKICByZXR1cm4gX2tzdHJ0b2wocywgYmFzZSwgcmVzKTsKfQoKaW50
IF9fYXR0cmlidXRlX18oKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKSBrc3RydG91aW50KGNv
bnN0IGNoYXIgKnMsIHVuc2lnbmVkIGludCBiYXNlLCB1bnNpZ25lZCBpbnQgKnJlcyk7Cmlu
dCBfX2F0dHJpYnV0ZV9fKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkga3N0cnRvaW50KGNv
bnN0IGNoYXIgKnMsIHVuc2lnbmVkIGludCBiYXNlLCBpbnQgKnJlcyk7CgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
aW50IF9fYXR0cmlidXRlX18oKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKSBrc3RydG91NjQo
Y29uc3QgY2hhciAqcywgdW5zaWduZWQgaW50IGJhc2UsIHU2NCAqcmVzKQp7CiByZXR1cm4g
a3N0cnRvdWxsKHMsIGJhc2UsIHJlcyk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgX19hdHRyaWJ1dGVf
XygoX193YXJuX3VudXNlZF9yZXN1bHRfXykpIGtzdHJ0b3M2NChjb25zdCBjaGFyICpzLCB1
bnNpZ25lZCBpbnQgYmFzZSwgczY0ICpyZXMpCnsKIHJldHVybiBrc3RydG9sbChzLCBiYXNl
LCByZXMpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IF9fYXR0cmlidXRlX18oKF9fd2Fybl91bnVzZWRf
cmVzdWx0X18pKSBrc3RydG91MzIoY29uc3QgY2hhciAqcywgdW5zaWduZWQgaW50IGJhc2Us
IHUzMiAqcmVzKQp7CiByZXR1cm4ga3N0cnRvdWludChzLCBiYXNlLCByZXMpOwp9CgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgaW50IF9fYXR0cmlidXRlX18oKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKSBrc3Ry
dG9zMzIoY29uc3QgY2hhciAqcywgdW5zaWduZWQgaW50IGJhc2UsIHMzMiAqcmVzKQp7CiBy
ZXR1cm4ga3N0cnRvaW50KHMsIGJhc2UsIHJlcyk7Cn0KCmludCBfX2F0dHJpYnV0ZV9fKChf
X3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkga3N0cnRvdTE2KGNvbnN0IGNoYXIgKnMsIHVuc2ln
bmVkIGludCBiYXNlLCB1MTYgKnJlcyk7CmludCBfX2F0dHJpYnV0ZV9fKChfX3dhcm5fdW51
c2VkX3Jlc3VsdF9fKSkga3N0cnRvczE2KGNvbnN0IGNoYXIgKnMsIHVuc2lnbmVkIGludCBi
YXNlLCBzMTYgKnJlcyk7CmludCBfX2F0dHJpYnV0ZV9fKChfX3dhcm5fdW51c2VkX3Jlc3Vs
dF9fKSkga3N0cnRvdTgoY29uc3QgY2hhciAqcywgdW5zaWduZWQgaW50IGJhc2UsIHU4ICpy
ZXMpOwppbnQgX19hdHRyaWJ1dGVfXygoX193YXJuX3VudXNlZF9yZXN1bHRfXykpIGtzdHJ0
b3M4KGNvbnN0IGNoYXIgKnMsIHVuc2lnbmVkIGludCBiYXNlLCBzOCAqcmVzKTsKaW50IF9f
YXR0cmlidXRlX18oKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKSBrc3RydG9ib29sKGNvbnN0
IGNoYXIgKnMsIGJvb2wgKnJlcyk7CgppbnQgX19hdHRyaWJ1dGVfXygoX193YXJuX3VudXNl
ZF9yZXN1bHRfXykpIGtzdHJ0b3VsbF9mcm9tX3VzZXIoY29uc3QgY2hhciAqcywgc2l6ZV90
IGNvdW50LCB1bnNpZ25lZCBpbnQgYmFzZSwgdW5zaWduZWQgbG9uZyBsb25nICpyZXMpOwpp
bnQgX19hdHRyaWJ1dGVfXygoX193YXJuX3VudXNlZF9yZXN1bHRfXykpIGtzdHJ0b2xsX2Zy
b21fdXNlcihjb25zdCBjaGFyICpzLCBzaXplX3QgY291bnQsIHVuc2lnbmVkIGludCBiYXNl
LCBsb25nIGxvbmcgKnJlcyk7CmludCBfX2F0dHJpYnV0ZV9fKChfX3dhcm5fdW51c2VkX3Jl
c3VsdF9fKSkga3N0cnRvdWxfZnJvbV91c2VyKGNvbnN0IGNoYXIgKnMsIHNpemVfdCBjb3Vu
dCwgdW5zaWduZWQgaW50IGJhc2UsIHVuc2lnbmVkIGxvbmcgKnJlcyk7CmludCBfX2F0dHJp
YnV0ZV9fKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkga3N0cnRvbF9mcm9tX3VzZXIoY29u
c3QgY2hhciAqcywgc2l6ZV90IGNvdW50LCB1bnNpZ25lZCBpbnQgYmFzZSwgbG9uZyAqcmVz
KTsKaW50IF9fYXR0cmlidXRlX18oKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKSBrc3RydG91
aW50X2Zyb21fdXNlcihjb25zdCBjaGFyICpzLCBzaXplX3QgY291bnQsIHVuc2lnbmVkIGlu
dCBiYXNlLCB1bnNpZ25lZCBpbnQgKnJlcyk7CmludCBfX2F0dHJpYnV0ZV9fKChfX3dhcm5f
dW51c2VkX3Jlc3VsdF9fKSkga3N0cnRvaW50X2Zyb21fdXNlcihjb25zdCBjaGFyICpzLCBz
aXplX3QgY291bnQsIHVuc2lnbmVkIGludCBiYXNlLCBpbnQgKnJlcyk7CmludCBfX2F0dHJp
YnV0ZV9fKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkga3N0cnRvdTE2X2Zyb21fdXNlcihj
b25zdCBjaGFyICpzLCBzaXplX3QgY291bnQsIHVuc2lnbmVkIGludCBiYXNlLCB1MTYgKnJl
cyk7CmludCBfX2F0dHJpYnV0ZV9fKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkga3N0cnRv
czE2X2Zyb21fdXNlcihjb25zdCBjaGFyICpzLCBzaXplX3QgY291bnQsIHVuc2lnbmVkIGlu
dCBiYXNlLCBzMTYgKnJlcyk7CmludCBfX2F0dHJpYnV0ZV9fKChfX3dhcm5fdW51c2VkX3Jl
c3VsdF9fKSkga3N0cnRvdThfZnJvbV91c2VyKGNvbnN0IGNoYXIgKnMsIHNpemVfdCBjb3Vu
dCwgdW5zaWduZWQgaW50IGJhc2UsIHU4ICpyZXMpOwppbnQgX19hdHRyaWJ1dGVfXygoX193
YXJuX3VudXNlZF9yZXN1bHRfXykpIGtzdHJ0b3M4X2Zyb21fdXNlcihjb25zdCBjaGFyICpz
LCBzaXplX3QgY291bnQsIHVuc2lnbmVkIGludCBiYXNlLCBzOCAqcmVzKTsKaW50IF9fYXR0
cmlidXRlX18oKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKSBrc3RydG9ib29sX2Zyb21fdXNl
cihjb25zdCBjaGFyICpzLCBzaXplX3QgY291bnQsIGJvb2wgKnJlcyk7CgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
aW50IF9fYXR0cmlidXRlX18oKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKSBrc3RydG91NjRf
ZnJvbV91c2VyKGNvbnN0IGNoYXIgKnMsIHNpemVfdCBjb3VudCwgdW5zaWduZWQgaW50IGJh
c2UsIHU2NCAqcmVzKQp7CiByZXR1cm4ga3N0cnRvdWxsX2Zyb21fdXNlcihzLCBjb3VudCwg
YmFzZSwgcmVzKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBfX2F0dHJpYnV0ZV9fKChfX3dhcm5fdW51
c2VkX3Jlc3VsdF9fKSkga3N0cnRvczY0X2Zyb21fdXNlcihjb25zdCBjaGFyICpzLCBzaXpl
X3QgY291bnQsIHVuc2lnbmVkIGludCBiYXNlLCBzNjQgKnJlcykKewogcmV0dXJuIGtzdHJ0
b2xsX2Zyb21fdXNlcihzLCBjb3VudCwgYmFzZSwgcmVzKTsKfQoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBf
X2F0dHJpYnV0ZV9fKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkga3N0cnRvdTMyX2Zyb21f
dXNlcihjb25zdCBjaGFyICpzLCBzaXplX3QgY291bnQsIHVuc2lnbmVkIGludCBiYXNlLCB1
MzIgKnJlcykKewogcmV0dXJuIGtzdHJ0b3VpbnRfZnJvbV91c2VyKHMsIGNvdW50LCBiYXNl
LCByZXMpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IF9fYXR0cmlidXRlX18oKF9fd2Fybl91bnVzZWRf
cmVzdWx0X18pKSBrc3RydG9zMzJfZnJvbV91c2VyKGNvbnN0IGNoYXIgKnMsIHNpemVfdCBj
b3VudCwgdW5zaWduZWQgaW50IGJhc2UsIHMzMiAqcmVzKQp7CiByZXR1cm4ga3N0cnRvaW50
X2Zyb21fdXNlcihzLCBjb3VudCwgYmFzZSwgcmVzKTsKfQojIDQ2NiAiLi9pbmNsdWRlL2xp
bnV4L2tlcm5lbC5oIgpleHRlcm4gdW5zaWduZWQgbG9uZyBzaW1wbGVfc3RydG91bChjb25z
dCBjaGFyICosY2hhciAqKix1bnNpZ25lZCBpbnQpOwpleHRlcm4gbG9uZyBzaW1wbGVfc3Ry
dG9sKGNvbnN0IGNoYXIgKixjaGFyICoqLHVuc2lnbmVkIGludCk7CmV4dGVybiB1bnNpZ25l
ZCBsb25nIGxvbmcgc2ltcGxlX3N0cnRvdWxsKGNvbnN0IGNoYXIgKixjaGFyICoqLHVuc2ln
bmVkIGludCk7CmV4dGVybiBsb25nIGxvbmcgc2ltcGxlX3N0cnRvbGwoY29uc3QgY2hhciAq
LGNoYXIgKiosdW5zaWduZWQgaW50KTsKCmV4dGVybiBpbnQgbnVtX3RvX3N0cihjaGFyICpi
dWYsIGludCBzaXplLAogICAgICAgIHVuc2lnbmVkIGxvbmcgbG9uZyBudW0sIHVuc2lnbmVk
IGludCB3aWR0aCk7CgoKCmV4dGVybiBfX2F0dHJpYnV0ZV9fKChfX2Zvcm1hdF9fKHByaW50
ZiwgMiwgMykpKSBpbnQgc3ByaW50ZihjaGFyICpidWYsIGNvbnN0IGNoYXIgKiBmbXQsIC4u
Lik7CmV4dGVybiBfX2F0dHJpYnV0ZV9fKChfX2Zvcm1hdF9fKHByaW50ZiwgMiwgMCkpKSBp
bnQgdnNwcmludGYoY2hhciAqYnVmLCBjb25zdCBjaGFyICosIHZhX2xpc3QpOwpleHRlcm4g
X19hdHRyaWJ1dGVfXygoX19mb3JtYXRfXyhwcmludGYsIDMsIDQpKSkKaW50IHNucHJpbnRm
KGNoYXIgKmJ1Ziwgc2l6ZV90IHNpemUsIGNvbnN0IGNoYXIgKmZtdCwgLi4uKTsKZXh0ZXJu
IF9fYXR0cmlidXRlX18oKF9fZm9ybWF0X18ocHJpbnRmLCAzLCAwKSkpCmludCB2c25wcmlu
dGYoY2hhciAqYnVmLCBzaXplX3Qgc2l6ZSwgY29uc3QgY2hhciAqZm10LCB2YV9saXN0IGFy
Z3MpOwpleHRlcm4gX19hdHRyaWJ1dGVfXygoX19mb3JtYXRfXyhwcmludGYsIDMsIDQpKSkK
aW50IHNjbnByaW50ZihjaGFyICpidWYsIHNpemVfdCBzaXplLCBjb25zdCBjaGFyICpmbXQs
IC4uLik7CmV4dGVybiBfX2F0dHJpYnV0ZV9fKChfX2Zvcm1hdF9fKHByaW50ZiwgMywgMCkp
KQppbnQgdnNjbnByaW50ZihjaGFyICpidWYsIHNpemVfdCBzaXplLCBjb25zdCBjaGFyICpm
bXQsIHZhX2xpc3QgYXJncyk7CmV4dGVybiBfX2F0dHJpYnV0ZV9fKChfX2Zvcm1hdF9fKHBy
aW50ZiwgMiwgMykpKSBfX2F0dHJpYnV0ZV9fKChfX21hbGxvY19fKSkKY2hhciAqa2FzcHJp
bnRmKGdmcF90IGdmcCwgY29uc3QgY2hhciAqZm10LCAuLi4pOwpleHRlcm4gX19hdHRyaWJ1
dGVfXygoX19mb3JtYXRfXyhwcmludGYsIDIsIDApKSkgX19hdHRyaWJ1dGVfXygoX19tYWxs
b2NfXykpCmNoYXIgKmt2YXNwcmludGYoZ2ZwX3QgZ2ZwLCBjb25zdCBjaGFyICpmbXQsIHZh
X2xpc3QgYXJncyk7CmV4dGVybiBfX2F0dHJpYnV0ZV9fKChfX2Zvcm1hdF9fKHByaW50Ziwg
MiwgMCkpKQpjb25zdCBjaGFyICprdmFzcHJpbnRmX2NvbnN0KGdmcF90IGdmcCwgY29uc3Qg
Y2hhciAqZm10LCB2YV9saXN0IGFyZ3MpOwoKZXh0ZXJuIF9fYXR0cmlidXRlX18oKF9fZm9y
bWF0X18oc2NhbmYsIDIsIDMpKSkKaW50IHNzY2FuZihjb25zdCBjaGFyICosIGNvbnN0IGNo
YXIgKiwgLi4uKTsKZXh0ZXJuIF9fYXR0cmlidXRlX18oKF9fZm9ybWF0X18oc2NhbmYsIDIs
IDApKSkKaW50IHZzc2NhbmYoY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIHZhX2xpc3Qp
OwoKZXh0ZXJuIGludCBnZXRfb3B0aW9uKGNoYXIgKipzdHIsIGludCAqcGludCk7CmV4dGVy
biBjaGFyICpnZXRfb3B0aW9ucyhjb25zdCBjaGFyICpzdHIsIGludCBuaW50cywgaW50ICpp
bnRzKTsKZXh0ZXJuIHVuc2lnbmVkIGxvbmcgbG9uZyBtZW1wYXJzZShjb25zdCBjaGFyICpw
dHIsIGNoYXIgKipyZXRwdHIpOwpleHRlcm4gYm9vbCBwYXJzZV9vcHRpb25fc3RyKGNvbnN0
IGNoYXIgKnN0ciwgY29uc3QgY2hhciAqb3B0aW9uKTsKZXh0ZXJuIGNoYXIgKm5leHRfYXJn
KGNoYXIgKmFyZ3MsIGNoYXIgKipwYXJhbSwgY2hhciAqKnZhbCk7CgpleHRlcm4gaW50IGNv
cmVfa2VybmVsX3RleHQodW5zaWduZWQgbG9uZyBhZGRyKTsKZXh0ZXJuIGludCBpbml0X2tl
cm5lbF90ZXh0KHVuc2lnbmVkIGxvbmcgYWRkcik7CmV4dGVybiBpbnQgY29yZV9rZXJuZWxf
ZGF0YSh1bnNpZ25lZCBsb25nIGFkZHIpOwpleHRlcm4gaW50IF9fa2VybmVsX3RleHRfYWRk
cmVzcyh1bnNpZ25lZCBsb25nIGFkZHIpOwpleHRlcm4gaW50IGtlcm5lbF90ZXh0X2FkZHJl
c3ModW5zaWduZWQgbG9uZyBhZGRyKTsKZXh0ZXJuIGludCBmdW5jX3B0cl9pc19rZXJuZWxf
dGV4dCh2b2lkICpwdHIpOwoKdTY0IGludF9wb3codTY0IGJhc2UsIHVuc2lnbmVkIGludCBl
eHApOwp1bnNpZ25lZCBsb25nIGludF9zcXJ0KHVuc2lnbmVkIGxvbmcpOwoKCgoKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIHUzMiBpbnRfc3FydDY0KHU2NCB4KQp7CiByZXR1cm4gKHUzMilpbnRfc3FydCh4KTsK
fQoKCgpleHRlcm4gdW5zaWduZWQgaW50IHN5c2N0bF9vb3BzX2FsbF9jcHVfYmFja3RyYWNl
OwoKCgoKZXh0ZXJuIHZvaWQgYnVzdF9zcGlubG9ja3MoaW50IHllcyk7CmV4dGVybiBpbnQg
b29wc19pbl9wcm9ncmVzczsKZXh0ZXJuIGludCBwYW5pY190aW1lb3V0OwpleHRlcm4gdW5z
aWduZWQgbG9uZyBwYW5pY19wcmludDsKZXh0ZXJuIGludCBwYW5pY19vbl9vb3BzOwpleHRl
cm4gaW50IHBhbmljX29uX3VucmVjb3ZlcmVkX25taTsKZXh0ZXJuIGludCBwYW5pY19vbl9p
b19ubWk7CmV4dGVybiBpbnQgcGFuaWNfb25fd2FybjsKZXh0ZXJuIHVuc2lnbmVkIGxvbmcg
cGFuaWNfb25fdGFpbnQ7CmV4dGVybiBib29sIHBhbmljX29uX3RhaW50X25vdXNlcnRhaW50
OwpleHRlcm4gaW50IHN5c2N0bF9wYW5pY19vbl9yY3Vfc3RhbGw7CmV4dGVybiBpbnQgc3lz
Y3RsX3BhbmljX29uX3N0YWNrb3ZlcmZsb3c7CgpleHRlcm4gYm9vbCBjcmFzaF9rZXhlY19w
b3N0X25vdGlmaWVyczsKCgoKCgoKZXh0ZXJuIGF0b21pY190IHBhbmljX2NwdTsKCgoKCgoK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIHZvaWQgc2V0X2FyY2hfcGFuaWNfdGltZW91dChpbnQgdGltZW91dCwgaW50
IGFyY2hfZGVmYXVsdF90aW1lb3V0KQp7CiBpZiAocGFuaWNfdGltZW91dCA9PSBhcmNoX2Rl
ZmF1bHRfdGltZW91dCkKICBwYW5pY190aW1lb3V0ID0gdGltZW91dDsKfQpleHRlcm4gY29u
c3QgY2hhciAqcHJpbnRfdGFpbnRlZCh2b2lkKTsKZW51bSBsb2NrZGVwX29rIHsKIExPQ0tE
RVBfU1RJTExfT0ssCiBMT0NLREVQX05PV19VTlJFTElBQkxFCn07CmV4dGVybiB2b2lkIGFk
ZF90YWludCh1bnNpZ25lZCBmbGFnLCBlbnVtIGxvY2tkZXBfb2spOwpleHRlcm4gaW50IHRl
c3RfdGFpbnQodW5zaWduZWQgZmxhZyk7CmV4dGVybiB1bnNpZ25lZCBsb25nIGdldF90YWlu
dCh2b2lkKTsKZXh0ZXJuIGludCByb290X21vdW50ZmxhZ3M7CgpleHRlcm4gYm9vbCBlYXJs
eV9ib290X2lycXNfZGlzYWJsZWQ7CgoKCgoKZXh0ZXJuIGVudW0gc3lzdGVtX3N0YXRlcyB7
CiBTWVNURU1fQk9PVElORywKIFNZU1RFTV9TQ0hFRFVMSU5HLAogU1lTVEVNX1JVTk5JTkcs
CiBTWVNURU1fSEFMVCwKIFNZU1RFTV9QT1dFUl9PRkYsCiBTWVNURU1fUkVTVEFSVCwKIFNZ
U1RFTV9TVVNQRU5ELAp9IHN5c3RlbV9zdGF0ZTsKIyA2MDkgIi4vaW5jbHVkZS9saW51eC9r
ZXJuZWwuaCIKc3RydWN0IHRhaW50X2ZsYWcgewogY2hhciBjX3RydWU7CiBjaGFyIGNfZmFs
c2U7CiBib29sIG1vZHVsZTsKfTsKCmV4dGVybiBjb25zdCBzdHJ1Y3QgdGFpbnRfZmxhZyB0
YWludF9mbGFnc1sxOF07CgpleHRlcm4gY29uc3QgY2hhciBoZXhfYXNjW107CgoKCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBjaGFyICpoZXhfYnl0ZV9wYWNrKGNoYXIgKmJ1ZiwgdTggYnl0ZSkKewogKmJ1Zisr
ID0gaGV4X2FzY1soKGJ5dGUpICYgMHhmMCkgPj4gNF07CiAqYnVmKysgPSBoZXhfYXNjWygo
Ynl0ZSkgJiAweDBmKV07CiByZXR1cm4gYnVmOwp9CgpleHRlcm4gY29uc3QgY2hhciBoZXhf
YXNjX3VwcGVyW107CgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBjaGFyICpoZXhfYnl0ZV9wYWNrX3VwcGVyKGNo
YXIgKmJ1ZiwgdTggYnl0ZSkKewogKmJ1ZisrID0gaGV4X2FzY191cHBlclsoKGJ5dGUpICYg
MHhmMCkgPj4gNF07CiAqYnVmKysgPSBoZXhfYXNjX3VwcGVyWygoYnl0ZSkgJiAweDBmKV07
CiByZXR1cm4gYnVmOwp9CgpleHRlcm4gaW50IGhleF90b19iaW4oY2hhciBjaCk7CmV4dGVy
biBpbnQgX19hdHRyaWJ1dGVfXygoX193YXJuX3VudXNlZF9yZXN1bHRfXykpIGhleDJiaW4o
dTggKmRzdCwgY29uc3QgY2hhciAqc3JjLCBzaXplX3QgY291bnQpOwpleHRlcm4gY2hhciAq
YmluMmhleChjaGFyICpkc3QsIGNvbnN0IHZvaWQgKnNyYywgc2l6ZV90IGNvdW50KTsKCmJv
b2wgbWFjX3B0b24oY29uc3QgY2hhciAqcywgdTggKm1hYyk7CiMgNjY1ICIuL2luY2x1ZGUv
bGludXgva2VybmVsLmgiCmVudW0gZnRyYWNlX2R1bXBfbW9kZSB7CiBEVU1QX05PTkUsCiBE
VU1QX0FMTCwKIERVTVBfT1JJRywKfTsKCgp2b2lkIHRyYWNpbmdfb24odm9pZCk7CnZvaWQg
dHJhY2luZ19vZmYodm9pZCk7CmludCB0cmFjaW5nX2lzX29uKHZvaWQpOwp2b2lkIHRyYWNp
bmdfc25hcHNob3Qodm9pZCk7CnZvaWQgdHJhY2luZ19zbmFwc2hvdF9hbGxvYyh2b2lkKTsK
CmV4dGVybiB2b2lkIHRyYWNpbmdfc3RhcnQodm9pZCk7CmV4dGVybiB2b2lkIHRyYWNpbmdf
c3RvcCh2b2lkKTsKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Zvcm1hdF9fKHByaW50
ZiwgMSwgMikpKQp2b2lkIF9fX190cmFjZV9wcmludGtfY2hlY2tfZm9ybWF0KGNvbnN0IGNo
YXIgKmZtdCwgLi4uKQp7Cn0KIyA3NDQgIi4vaW5jbHVkZS9saW51eC9rZXJuZWwuaCIKZXh0
ZXJuIF9fYXR0cmlidXRlX18oKF9fZm9ybWF0X18ocHJpbnRmLCAyLCAzKSkpCmludCBfX3Ry
YWNlX2JwcmludGsodW5zaWduZWQgbG9uZyBpcCwgY29uc3QgY2hhciAqZm10LCAuLi4pOwoK
ZXh0ZXJuIF9fYXR0cmlidXRlX18oKF9fZm9ybWF0X18ocHJpbnRmLCAyLCAzKSkpCmludCBf
X3RyYWNlX3ByaW50ayh1bnNpZ25lZCBsb25nIGlwLCBjb25zdCBjaGFyICpmbXQsIC4uLik7
CiMgNzg1ICIuL2luY2x1ZGUvbGludXgva2VybmVsLmgiCmV4dGVybiBpbnQgX190cmFjZV9i
cHV0cyh1bnNpZ25lZCBsb25nIGlwLCBjb25zdCBjaGFyICpzdHIpOwpleHRlcm4gaW50IF9f
dHJhY2VfcHV0cyh1bnNpZ25lZCBsb25nIGlwLCBjb25zdCBjaGFyICpzdHIsIGludCBzaXpl
KTsKCmV4dGVybiB2b2lkIHRyYWNlX2R1bXBfc3RhY2soaW50IHNraXApOwojIDgwNyAiLi9p
bmNsdWRlL2xpbnV4L2tlcm5lbC5oIgpleHRlcm4gX19hdHRyaWJ1dGVfXygoX19mb3JtYXRf
XyhwcmludGYsIDIsIDApKSkgaW50Cl9fZnRyYWNlX3ZicHJpbnRrKHVuc2lnbmVkIGxvbmcg
aXAsIGNvbnN0IGNoYXIgKmZtdCwgdmFfbGlzdCBhcCk7CgpleHRlcm4gX19hdHRyaWJ1dGVf
XygoX19mb3JtYXRfXyhwcmludGYsIDIsIDApKSkgaW50Cl9fZnRyYWNlX3ZwcmludGsodW5z
aWduZWQgbG9uZyBpcCwgY29uc3QgY2hhciAqZm10LCB2YV9saXN0IGFwKTsKCmV4dGVybiB2
b2lkIGZ0cmFjZV9kdW1wKGVudW0gZnRyYWNlX2R1bXBfbW9kZSBvb3BzX2R1bXBfbW9kZSk7
CiMgMjAgIi4vaW5jbHVkZS9hc20tZ2VuZXJpYy9idWcuaCIgMgoKCgoKc3RydWN0IGJ1Z19l
bnRyeSB7CgogdW5zaWduZWQgbG9uZyBidWdfYWRkcjsKCgoKCgogY29uc3QgY2hhciAqZmls
ZTsKCgoKIHVuc2lnbmVkIHNob3J0IGxpbmU7CgogdW5zaWduZWQgc2hvcnQgZmxhZ3M7Cn07
CiMgOTIgIi4vaW5jbHVkZS9hc20tZ2VuZXJpYy9idWcuaCIKZXh0ZXJuIF9fYXR0cmlidXRl
X18oKF9fZm9ybWF0X18ocHJpbnRmLCAxLCAyKSkpIHZvaWQgX193YXJuX3ByaW50ayhjb25z
dCBjaGFyICpmbXQsIC4uLik7CiMgMTEwICIuL2luY2x1ZGUvYXNtLWdlbmVyaWMvYnVnLmgi
CnN0cnVjdCB3YXJuX2FyZ3M7CnN0cnVjdCBwdF9yZWdzOwoKdm9pZCBfX3dhcm4oY29uc3Qg
Y2hhciAqZmlsZSwgaW50IGxpbmUsIHZvaWQgKmNhbGxlciwgdW5zaWduZWQgdGFpbnQsCiAg
ICAgc3RydWN0IHB0X3JlZ3MgKnJlZ3MsIHN0cnVjdCB3YXJuX2FyZ3MgKmFyZ3MpOwojIDEx
MCAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vYnVnLmgiIDIKCgoKc3RydWN0IHB0X3Jl
Z3M7CmV4dGVybiBpbnQgZG9fcGFnZV9mYXVsdChzdHJ1Y3QgcHRfcmVncyAqLCB1bnNpZ25l
ZCBsb25nLCB1bnNpZ25lZCBsb25nKTsKZXh0ZXJuIHZvaWQgYmFkX3BhZ2VfZmF1bHQoc3Ry
dWN0IHB0X3JlZ3MgKiwgdW5zaWduZWQgbG9uZywgaW50KTsKZXh0ZXJuIHZvaWQgX2V4Y2Vw
dGlvbihpbnQsIHN0cnVjdCBwdF9yZWdzICosIGludCwgdW5zaWduZWQgbG9uZyk7CmV4dGVy
biB2b2lkIF9leGNlcHRpb25fcGtleShzdHJ1Y3QgcHRfcmVncyAqLCB1bnNpZ25lZCBsb25n
LCBpbnQpOwpleHRlcm4gdm9pZCBkaWUoY29uc3QgY2hhciAqLCBzdHJ1Y3QgcHRfcmVncyAq
LCBsb25nKTsKZXh0ZXJuIGJvb2wgZGllX3dpbGxfY3Jhc2godm9pZCk7CmV4dGVybiB2b2lk
IHBhbmljX2ZsdXNoX2ttc2dfc3RhcnQodm9pZCk7CmV4dGVybiB2b2lkIHBhbmljX2ZsdXNo
X2ttc2dfZW5kKHZvaWQpOwojIDYgIi4vaW5jbHVkZS9saW51eC9idWcuaCIgMgoKCgplbnVt
IGJ1Z190cmFwX3R5cGUgewogQlVHX1RSQVBfVFlQRV9OT05FID0gMCwKIEJVR19UUkFQX1RZ
UEVfV0FSTiA9IDEsCiBCVUdfVFJBUF9UWVBFX0JVRyA9IDIsCn07CgpzdHJ1Y3QgcHRfcmVn
czsKIyAzNCAiLi9pbmNsdWRlL2xpbnV4L2J1Zy5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGlzX3dhcm5p
bmdfYnVnKGNvbnN0IHN0cnVjdCBidWdfZW50cnkgKmJ1ZykKewogcmV0dXJuIGJ1Zy0+Zmxh
Z3MgJiAoMSA8PCAwKTsKfQoKc3RydWN0IGJ1Z19lbnRyeSAqZmluZF9idWcodW5zaWduZWQg
bG9uZyBidWdhZGRyKTsKCmVudW0gYnVnX3RyYXBfdHlwZSByZXBvcnRfYnVnKHVuc2lnbmVk
IGxvbmcgYnVnX2FkZHIsIHN0cnVjdCBwdF9yZWdzICpyZWdzKTsKCgppbnQgaXNfdmFsaWRf
YnVnYWRkcih1bnNpZ25lZCBsb25nIGFkZHIpOwoKdm9pZCBnZW5lcmljX2J1Z19jbGVhcl9v
bmNlKHZvaWQpOwojIDcwICIuL2luY2x1ZGUvbGludXgvYnVnLmgiCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkgYm9vbCBjaGVja19kYXRhX2Nv
cnJ1cHRpb24oYm9vbCB2KSB7IHJldHVybiB2OyB9CiMgMTMyICIuL2FyY2gvcG93ZXJwYy9p
bmNsdWRlL2FzbS9tbXUuaCIgMgojIDEgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2Nw
dXRhYmxlLmgiIDEKCgoKCgoKIyAxICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL3VhcGkvYXNt
L2NwdXRhYmxlLmgiIDEKIyA4ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9jcHV0YWJs
ZS5oIiAyCgoKCgoKCgpzdHJ1Y3QgY3B1X3NwZWM7Cgp0eXBlZGVmIHZvaWQgKCpjcHVfc2V0
dXBfdCkodW5zaWduZWQgbG9uZyBvZmZzZXQsIHN0cnVjdCBjcHVfc3BlYyogc3BlYyk7CnR5
cGVkZWYgdm9pZCAoKmNwdV9yZXN0b3JlX3QpKHZvaWQpOwoKZW51bSBwb3dlcnBjX29wcm9m
aWxlX3R5cGUgewogUFBDX09QUk9GSUxFX0lOVkFMSUQgPSAwLAogUFBDX09QUk9GSUxFX1JT
NjQgPSAxLAogUFBDX09QUk9GSUxFX1BPV0VSNCA9IDIsCiBQUENfT1BST0ZJTEVfRzQgPSAz
LAogUFBDX09QUk9GSUxFX0ZTTF9FTUIgPSA0LAogUFBDX09QUk9GSUxFX0NFTEwgPSA1LAog
UFBDX09QUk9GSUxFX1BBNlQgPSA2LAp9OwoKZW51bSBwb3dlcnBjX3BtY190eXBlIHsKIFBQ
Q19QTUNfREVGQVVMVCA9IDAsCiBQUENfUE1DX0lCTSA9IDEsCiBQUENfUE1DX1BBNlQgPSAy
LAogUFBDX1BNQ19HNCA9IDMsCn07CgpzdHJ1Y3QgcHRfcmVnczsKCmV4dGVybiBpbnQgbWFj
aGluZV9jaGVja19nZW5lcmljKHN0cnVjdCBwdF9yZWdzICpyZWdzKTsKZXh0ZXJuIGludCBt
YWNoaW5lX2NoZWNrXzR4eChzdHJ1Y3QgcHRfcmVncyAqcmVncyk7CmV4dGVybiBpbnQgbWFj
aGluZV9jaGVja180NDBBKHN0cnVjdCBwdF9yZWdzICpyZWdzKTsKZXh0ZXJuIGludCBtYWNo
aW5lX2NoZWNrX2U1MDBtYyhzdHJ1Y3QgcHRfcmVncyAqcmVncyk7CmV4dGVybiBpbnQgbWFj
aGluZV9jaGVja19lNTAwKHN0cnVjdCBwdF9yZWdzICpyZWdzKTsKZXh0ZXJuIGludCBtYWNo
aW5lX2NoZWNrX2UyMDAoc3RydWN0IHB0X3JlZ3MgKnJlZ3MpOwpleHRlcm4gaW50IG1hY2hp
bmVfY2hlY2tfNDd4KHN0cnVjdCBwdF9yZWdzICpyZWdzKTsKaW50IG1hY2hpbmVfY2hlY2tf
OHh4KHN0cnVjdCBwdF9yZWdzICpyZWdzKTsKaW50IG1hY2hpbmVfY2hlY2tfODN4eChzdHJ1
Y3QgcHRfcmVncyAqcmVncyk7CgpleHRlcm4gdm9pZCBjcHVfZG93bl9mbHVzaF9lNTAwdjIo
dm9pZCk7CmV4dGVybiB2b2lkIGNwdV9kb3duX2ZsdXNoX2U1MDBtYyh2b2lkKTsKZXh0ZXJu
IHZvaWQgY3B1X2Rvd25fZmx1c2hfZTU1MDAodm9pZCk7CmV4dGVybiB2b2lkIGNwdV9kb3du
X2ZsdXNoX2U2NTAwKHZvaWQpOwoKCnN0cnVjdCBjcHVfc3BlYyB7CgogdW5zaWduZWQgaW50
IHB2cl9tYXNrOwogdW5zaWduZWQgaW50IHB2cl92YWx1ZTsKCiBjaGFyICpjcHVfbmFtZTsK
IHVuc2lnbmVkIGxvbmcgY3B1X2ZlYXR1cmVzOwogdW5zaWduZWQgaW50IGNwdV91c2VyX2Zl
YXR1cmVzOwogdW5zaWduZWQgaW50IGNwdV91c2VyX2ZlYXR1cmVzMjsKIHVuc2lnbmVkIGlu
dCBtbXVfZmVhdHVyZXM7CgoKIHVuc2lnbmVkIGludCBpY2FjaGVfYnNpemU7CiB1bnNpZ25l
ZCBpbnQgZGNhY2hlX2JzaXplOwoKCiB2b2lkICgqY3B1X2Rvd25fZmx1c2gpKHZvaWQpOwoK
CiB1bnNpZ25lZCBpbnQgbnVtX3BtY3M7CiBlbnVtIHBvd2VycGNfcG1jX3R5cGUgcG1jX3R5
cGU7CgoKCgogY3B1X3NldHVwX3QgY3B1X3NldHVwOwoKIGNwdV9yZXN0b3JlX3QgY3B1X3Jl
c3RvcmU7CgoKIGNoYXIgKm9wcm9maWxlX2NwdV90eXBlOwoKCiBlbnVtIHBvd2VycGNfb3By
b2ZpbGVfdHlwZSBvcHJvZmlsZV90eXBlOwoKCiB1bnNpZ25lZCBsb25nIG9wcm9maWxlX21t
Y3JhX3NpaHY7CiB1bnNpZ25lZCBsb25nIG9wcm9maWxlX21tY3JhX3NpcHI7CgoKIHVuc2ln
bmVkIGxvbmcgb3Byb2ZpbGVfbW1jcmFfY2xlYXI7CgoKIGNoYXIgKnBsYXRmb3JtOwoKCgoK
IGludCAoKm1hY2hpbmVfY2hlY2spKHN0cnVjdCBwdF9yZWdzICpyZWdzKTsKCgoKCgogbG9u
ZyAoKm1hY2hpbmVfY2hlY2tfZWFybHkpKHN0cnVjdCBwdF9yZWdzICpyZWdzKTsKfTsKCmV4
dGVybiBzdHJ1Y3QgY3B1X3NwZWMgKmN1cl9jcHVfc3BlYzsKCmV4dGVybiB1bnNpZ25lZCBp
bnQgX19zdGFydF9fX2Z0cl9maXh1cCwgX19zdG9wX19fZnRyX2ZpeHVwOwoKZXh0ZXJuIHZv
aWQgc2V0X2N1cl9jcHVfc3BlYyhzdHJ1Y3QgY3B1X3NwZWMgKnMpOwpleHRlcm4gc3RydWN0
IGNwdV9zcGVjICppZGVudGlmeV9jcHUodW5zaWduZWQgbG9uZyBvZmZzZXQsIHVuc2lnbmVk
IGludCBwdnIpOwpleHRlcm4gdm9pZCBpZGVudGlmeV9jcHVfbmFtZSh1bnNpZ25lZCBpbnQg
cHZyKTsKZXh0ZXJuIHZvaWQgZG9fZmVhdHVyZV9maXh1cHModW5zaWduZWQgbG9uZyB2YWx1
ZSwgdm9pZCAqZml4dXBfc3RhcnQsCiAgICAgICAgIHZvaWQgKmZpeHVwX2VuZCk7CgpleHRl
cm4gY29uc3QgY2hhciAqcG93ZXJwY19iYXNlX3BsYXRmb3JtOwoKCgoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZv
aWQgY3B1X2ZlYXR1cmVfa2V5c19pbml0KHZvaWQpIHsgfQojIDEzMyAiLi9hcmNoL3Bvd2Vy
cGMvaW5jbHVkZS9hc20vbW11LmgiIDIKIyAxICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2Fz
bS9wYWdlLmgiIDEKIyAxMjEgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL3BhZ2UuaCIK
ZXh0ZXJuIHVuc2lnbmVkIGxvbmcgbWF4X21hcG5yOwpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBwZm5fdmFs
aWQodW5zaWduZWQgbG9uZyBwZm4pCnsKIHVuc2lnbmVkIGxvbmcgbWluX3BmbiA9ICgodW5z
aWduZWQgbG9uZykoMFVMID4+IDEyKSk7CgogcmV0dXJuIHBmbiA+PSBtaW5fcGZuICYmIHBm
biA8IG1heF9tYXBucjsKfQojIDI0NyAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vcGFn
ZS5oIgojIDEgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL3BhZ2VfNjQuaCIgMQojIDQx
ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9wYWdlXzY0LmgiCnR5cGVkZWYgdW5zaWdu
ZWQgbG9uZyBwdGVfYmFzaWNfdDsKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGNsZWFyX3BhZ2Uodm9pZCAq
YWRkcikKewogdW5zaWduZWQgbG9uZyBpdGVyYXRpb25zOwogdW5zaWduZWQgbG9uZyBvbmV4
LCB0d294LCBmb3VyeCwgZWlnaHR4OwoKIGl0ZXJhdGlvbnMgPSBwcGM2NF9jYWNoZXMubDFk
LmJsb2Nrc19wZXJfcGFnZSAvIDg7CgoKCgoKCiBvbmV4ID0gcHBjNjRfY2FjaGVzLmwxZC5i
bG9ja19zaXplOwogdHdveCA9IG9uZXggPDwgMTsKIGZvdXJ4ID0gb25leCA8PCAyOwogZWln
aHR4ID0gb25leCA8PCAzOwoKIGFzbSB2b2xhdGlsZSgKICJtdGN0cgklMQkjIGNsZWFyX3Bh
Z2VcbgkuYmFsaWduCTE2XG4xOglkY2J6CTAsJTBcbglkY2J6CSUzLCUwXG4JZGNiegklNCwl
MFxuCWRjYnoJJTUsJTBcbglkY2J6CSU2LCUwXG4JZGNiegklNywlMFxuCWRjYnoJJTgsJTBc
bglkY2J6CSU5LCUwXG4JYWRkCSUwLCUwLCUxMFxuCWJkbnorCTFiIgojIDczICIuL2FyY2gv
cG93ZXJwYy9pbmNsdWRlL2FzbS9wYWdlXzY0LmgiCiA6ICI9JnIiIChhZGRyKQogOiAiciIg
KGl0ZXJhdGlvbnMpLCAiMCIgKGFkZHIpLCAiYiIgKG9uZXgpLCAiYiIgKHR3b3gpLAogICJi
IiAodHdveCtvbmV4KSwgImIiIChmb3VyeCksICJiIiAoZm91cngrb25leCksCiAgImIiICh0
d294K2ZvdXJ4KSwgImIiIChlaWdodHgtb25leCksICJyIiAoZWlnaHR4KQogOiAiY3RyIiwg
Im1lbW9yeSIpOwp9CgpleHRlcm4gdm9pZCBjb3B5X3BhZ2Uodm9pZCAqdG8sIHZvaWQgKmZy
b20pOwoKCmV4dGVybiB1NjQgcHBjNjRfcGZ0X3NpemU7CiMgMTA0ICIuL2FyY2gvcG93ZXJw
Yy9pbmNsdWRlL2FzbS9wYWdlXzY0LmgiCiMgMSAiLi9pbmNsdWRlL2FzbS1nZW5lcmljL2dl
dG9yZGVyLmgiIDEKIyAyOSAiLi9pbmNsdWRlL2FzbS1nZW5lcmljL2dldG9yZGVyLmgiCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2NvbnN0X18pKSBpbnQgZ2V0X29yZGVyKHVuc2ln
bmVkIGxvbmcgc2l6ZSkKewogaWYgKF9fYnVpbHRpbl9jb25zdGFudF9wKHNpemUpKSB7CiAg
aWYgKCFzaXplKQogICByZXR1cm4gNjQgLSAxMjsKCiAgaWYgKHNpemUgPCAoMVVMIDw8IDEy
KSkKICAgcmV0dXJuIDA7CgogIHJldHVybiAoIF9fYnVpbHRpbl9jb25zdGFudF9wKChzaXpl
KSAtIDEpID8gKCBfX2J1aWx0aW5fY29uc3RhbnRfcCgoc2l6ZSkgLSAxKSA/ICggKChzaXpl
KSAtIDEpIDwgMiA/IDAgOiAoKHNpemUpIC0gMSkgJiAoMVVMTCA8PCA2MykgPyA2MyA6ICgo
c2l6ZSkgLSAxKSAmICgxVUxMIDw8IDYyKSA/IDYyIDogKChzaXplKSAtIDEpICYgKDFVTEwg
PDwgNjEpID8gNjEgOiAoKHNpemUpIC0gMSkgJiAoMVVMTCA8PCA2MCkgPyA2MCA6ICgoc2l6
ZSkgLSAxKSAmICgxVUxMIDw8IDU5KSA/IDU5IDogKChzaXplKSAtIDEpICYgKDFVTEwgPDwg
NTgpID8gNTggOiAoKHNpemUpIC0gMSkgJiAoMVVMTCA8PCA1NykgPyA1NyA6ICgoc2l6ZSkg
LSAxKSAmICgxVUxMIDw8IDU2KSA/IDU2IDogKChzaXplKSAtIDEpICYgKDFVTEwgPDwgNTUp
ID8gNTUgOiAoKHNpemUpIC0gMSkgJiAoMVVMTCA8PCA1NCkgPyA1NCA6ICgoc2l6ZSkgLSAx
KSAmICgxVUxMIDw8IDUzKSA/IDUzIDogKChzaXplKSAtIDEpICYgKDFVTEwgPDwgNTIpID8g
NTIgOiAoKHNpemUpIC0gMSkgJiAoMVVMTCA8PCA1MSkgPyA1MSA6ICgoc2l6ZSkgLSAxKSAm
ICgxVUxMIDw8IDUwKSA/IDUwIDogKChzaXplKSAtIDEpICYgKDFVTEwgPDwgNDkpID8gNDkg
OiAoKHNpemUpIC0gMSkgJiAoMVVMTCA8PCA0OCkgPyA0OCA6ICgoc2l6ZSkgLSAxKSAmICgx
VUxMIDw8IDQ3KSA/IDQ3IDogKChzaXplKSAtIDEpICYgKDFVTEwgPDwgNDYpID8gNDYgOiAo
KHNpemUpIC0gMSkgJiAoMVVMTCA8PCA0NSkgPyA0NSA6ICgoc2l6ZSkgLSAxKSAmICgxVUxM
IDw8IDQ0KSA/IDQ0IDogKChzaXplKSAtIDEpICYgKDFVTEwgPDwgNDMpID8gNDMgOiAoKHNp
emUpIC0gMSkgJiAoMVVMTCA8PCA0MikgPyA0MiA6ICgoc2l6ZSkgLSAxKSAmICgxVUxMIDw8
IDQxKSA/IDQxIDogKChzaXplKSAtIDEpICYgKDFVTEwgPDwgNDApID8gNDAgOiAoKHNpemUp
IC0gMSkgJiAoMVVMTCA8PCAzOSkgPyAzOSA6ICgoc2l6ZSkgLSAxKSAmICgxVUxMIDw8IDM4
KSA/IDM4IDogKChzaXplKSAtIDEpICYgKDFVTEwgPDwgMzcpID8gMzcgOiAoKHNpemUpIC0g
MSkgJiAoMVVMTCA8PCAzNikgPyAzNiA6ICgoc2l6ZSkgLSAxKSAmICgxVUxMIDw8IDM1KSA/
IDM1IDogKChzaXplKSAtIDEpICYgKDFVTEwgPDwgMzQpID8gMzQgOiAoKHNpemUpIC0gMSkg
JiAoMVVMTCA8PCAzMykgPyAzMyA6ICgoc2l6ZSkgLSAxKSAmICgxVUxMIDw8IDMyKSA/IDMy
IDogKChzaXplKSAtIDEpICYgKDFVTEwgPDwgMzEpID8gMzEgOiAoKHNpemUpIC0gMSkgJiAo
MVVMTCA8PCAzMCkgPyAzMCA6ICgoc2l6ZSkgLSAxKSAmICgxVUxMIDw8IDI5KSA/IDI5IDog
KChzaXplKSAtIDEpICYgKDFVTEwgPDwgMjgpID8gMjggOiAoKHNpemUpIC0gMSkgJiAoMVVM
TCA8PCAyNykgPyAyNyA6ICgoc2l6ZSkgLSAxKSAmICgxVUxMIDw8IDI2KSA/IDI2IDogKChz
aXplKSAtIDEpICYgKDFVTEwgPDwgMjUpID8gMjUgOiAoKHNpemUpIC0gMSkgJiAoMVVMTCA8
PCAyNCkgPyAyNCA6ICgoc2l6ZSkgLSAxKSAmICgxVUxMIDw8IDIzKSA/IDIzIDogKChzaXpl
KSAtIDEpICYgKDFVTEwgPDwgMjIpID8gMjIgOiAoKHNpemUpIC0gMSkgJiAoMVVMTCA8PCAy
MSkgPyAyMSA6ICgoc2l6ZSkgLSAxKSAmICgxVUxMIDw8IDIwKSA/IDIwIDogKChzaXplKSAt
IDEpICYgKDFVTEwgPDwgMTkpID8gMTkgOiAoKHNpemUpIC0gMSkgJiAoMVVMTCA8PCAxOCkg
PyAxOCA6ICgoc2l6ZSkgLSAxKSAmICgxVUxMIDw8IDE3KSA/IDE3IDogKChzaXplKSAtIDEp
ICYgKDFVTEwgPDwgMTYpID8gMTYgOiAoKHNpemUpIC0gMSkgJiAoMVVMTCA8PCAxNSkgPyAx
NSA6ICgoc2l6ZSkgLSAxKSAmICgxVUxMIDw8IDE0KSA/IDE0IDogKChzaXplKSAtIDEpICYg
KDFVTEwgPDwgMTMpID8gMTMgOiAoKHNpemUpIC0gMSkgJiAoMVVMTCA8PCAxMikgPyAxMiA6
ICgoc2l6ZSkgLSAxKSAmICgxVUxMIDw8IDExKSA/IDExIDogKChzaXplKSAtIDEpICYgKDFV
TEwgPDwgMTApID8gMTAgOiAoKHNpemUpIC0gMSkgJiAoMVVMTCA8PCA5KSA/IDkgOiAoKHNp
emUpIC0gMSkgJiAoMVVMTCA8PCA4KSA/IDggOiAoKHNpemUpIC0gMSkgJiAoMVVMTCA8PCA3
KSA/IDcgOiAoKHNpemUpIC0gMSkgJiAoMVVMTCA8PCA2KSA/IDYgOiAoKHNpemUpIC0gMSkg
JiAoMVVMTCA8PCA1KSA/IDUgOiAoKHNpemUpIC0gMSkgJiAoMVVMTCA8PCA0KSA/IDQgOiAo
KHNpemUpIC0gMSkgJiAoMVVMTCA8PCAzKSA/IDMgOiAoKHNpemUpIC0gMSkgJiAoMVVMTCA8
PCAyKSA/IDIgOiAxKSA6IC0xKSA6IChzaXplb2YoKHNpemUpIC0gMSkgPD0gNCkgPyBfX2ls
b2cyX3UzMigoc2l6ZSkgLSAxKSA6IF9faWxvZzJfdTY0KChzaXplKSAtIDEpICkgLSAxMiAr
IDE7CiB9Cgogc2l6ZS0tOwogc2l6ZSA+Pj0gMTI7CgoKCiByZXR1cm4gZmxzNjQoc2l6ZSk7
Cgp9CiMgMTA1ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9wYWdlXzY0LmgiIDIKIyAy
NDggIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL3BhZ2UuaCIgMgojIDI5OSAiLi9hcmNo
L3Bvd2VycGMvaW5jbHVkZS9hc20vcGFnZS5oIgojIDEgIi4vYXJjaC9wb3dlcnBjL2luY2x1
ZGUvYXNtL3BndGFibGUtdHlwZXMuaCIgMQojIDkgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUv
YXNtL3BndGFibGUtdHlwZXMuaCIKdHlwZWRlZiBzdHJ1Y3QgeyBwdGVfYmFzaWNfdCBwdGU7
IH0gcHRlX3Q7CgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIHB0ZV9iYXNpY190IHB0ZV92YWwocHRlX3QgeCkKewog
cmV0dXJuIHgucHRlOwp9CgoKCnR5cGVkZWYgc3RydWN0IHsgdW5zaWduZWQgbG9uZyBwbWQ7
IH0gcG1kX3Q7CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgbG9uZyBwbWRfdmFsKHBtZF90IHgpCnsK
IHJldHVybiB4LnBtZDsKfQoKCnR5cGVkZWYgc3RydWN0IHsgdW5zaWduZWQgbG9uZyBwdWQ7
IH0gcHVkX3Q7CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgbG9uZyBwdWRfdmFsKHB1ZF90IHgpCnsK
IHJldHVybiB4LnB1ZDsKfQoKCgp0eXBlZGVmIHN0cnVjdCB7IHVuc2lnbmVkIGxvbmcgcGdk
OyB9IHBnZF90OwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIHVuc2lnbmVkIGxvbmcgcGdkX3ZhbChwZ2RfdCB4KQp7
CiByZXR1cm4geC5wZ2Q7Cn0KCgp0eXBlZGVmIHN0cnVjdCB7IHVuc2lnbmVkIGxvbmcgcGdw
cm90OyB9IHBncHJvdF90OwojIDU1ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9wZ3Rh
YmxlLXR5cGVzLmgiCnR5cGVkZWYgc3RydWN0IHsgcHRlX3QgcHRlOyB9IHJlYWxfcHRlX3Q7
CiMgNzAgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL3BndGFibGUtdHlwZXMuaCIKdHlw
ZWRlZiBzdHJ1Y3QgeyB1bnNpZ25lZCBsb25nIHBkOyB9IGh1Z2VwZF90OwoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IHVuc2lnbmVkIGxvbmcgaHBkX3ZhbChodWdlcGRfdCB4KQp7CiByZXR1cm4geC5wZDsKfQoj
IDMwMCAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vcGFnZS5oIiAyCiMgMzA4ICIuL2Fy
Y2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9wYWdlLmgiCnN0cnVjdCBwYWdlOwpleHRlcm4gdm9p
ZCBjbGVhcl91c2VyX3BhZ2Uodm9pZCAqcGFnZSwgdW5zaWduZWQgbG9uZyB2YWRkciwgc3Ry
dWN0IHBhZ2UgKnBnKTsKZXh0ZXJuIHZvaWQgY29weV91c2VyX3BhZ2Uodm9pZCAqdG8sIHZv
aWQgKmZyb20sIHVuc2lnbmVkIGxvbmcgdmFkZHIsCiAgc3RydWN0IHBhZ2UgKnApOwpleHRl
cm4gaW50IGRldm1lbV9pc19hbGxvd2VkKHVuc2lnbmVkIGxvbmcgcGZuKTsKCgoKCgoKc3Ry
dWN0IHZtX2FyZWFfc3RydWN0OwoKZXh0ZXJuIHVuc2lnbmVkIGxvbmcga2VybnN0YXJ0X3Zp
cnRfYWRkcjsKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSB1bnNpZ25lZCBsb25nIGthc2xyX29mZnNldCh2b2lkKQp7
CiByZXR1cm4ga2VybnN0YXJ0X3ZpcnRfYWRkciAtIDB4YzAwMDAwMDAwMDAwMDAwMFVMOwp9
CgojIDEgIi4vaW5jbHVkZS9hc20tZ2VuZXJpYy9tZW1vcnlfbW9kZWwuaCIgMQoKCgoKIyAx
ICIuL2luY2x1ZGUvbGludXgvcGZuLmgiIDEKIyAxMyAiLi9pbmNsdWRlL2xpbnV4L3Bmbi5o
Igp0eXBlZGVmIHN0cnVjdCB7CiB1NjQgdmFsOwp9IHBmbl90OwojIDYgIi4vaW5jbHVkZS9h
c20tZ2VuZXJpYy9tZW1vcnlfbW9kZWwuaCIgMgojIDMyOSAiLi9hcmNoL3Bvd2VycGMvaW5j
bHVkZS9hc20vcGFnZS5oIiAyCgojIDEgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL3Ns
aWNlLmgiIDEKIyAxMSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vc2xpY2UuaCIKc3Ry
dWN0IG1tX3N0cnVjdDsKIyAzNSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vc2xpY2Uu
aCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIHZvaWQgc2xpY2VfaW5pdF9uZXdfY29udGV4dF9leGVjKHN0cnVjdCBt
bV9zdHJ1Y3QgKm1tKSB7fQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHVuc2lnbmVkIGludCBnZXRfc2xpY2VfcHNp
emUoc3RydWN0IG1tX3N0cnVjdCAqbW0sIHVuc2lnbmVkIGxvbmcgYWRkcikKewogcmV0dXJu
IDA7Cn0KIyAzMzEgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL3BhZ2UuaCIgMgojIDEz
NCAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vbW11LmgiIDIKCnR5cGVkZWYgcHRlX3Qg
KnBndGFibGVfdDsKCgojIDEgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL3BlcmNwdS5o
IiAxCiMgMTMgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL3BlcmNwdS5oIgojIDEgIi4v
YXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL3BhY2EuaCIgMQojIDE0ICIuL2FyY2gvcG93ZXJw
Yy9pbmNsdWRlL2FzbS9wZXJjcHUuaCIgMgoKCgoKCgojIDEgIi4vaW5jbHVkZS9hc20tZ2Vu
ZXJpYy9wZXJjcHUuaCIgMQoKCgoKCiMgMSAiLi9pbmNsdWRlL2xpbnV4L3RocmVhZHMuaCIg
MQojIDcgIi4vaW5jbHVkZS9hc20tZ2VuZXJpYy9wZXJjcHUuaCIgMgojIDEgIi4vaW5jbHVk
ZS9saW51eC9wZXJjcHUtZGVmcy5oIiAxCiMgMzA4ICIuL2luY2x1ZGUvbGludXgvcGVyY3B1
LWRlZnMuaCIKZXh0ZXJuIHZvaWQgX19iYWRfc2l6ZV9jYWxsX3BhcmFtZXRlcih2b2lkKTsK
CgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSB2b2lkIF9fdGhpc19jcHVfcHJlZW1wdF9jaGVjayhjb25zdCBjaGFy
ICpvcCkgeyB9CiMgOCAiLi9pbmNsdWRlL2FzbS1nZW5lcmljL3BlcmNwdS5oIiAyCiMgMTkg
Ii4vaW5jbHVkZS9hc20tZ2VuZXJpYy9wZXJjcHUuaCIKZXh0ZXJuIHVuc2lnbmVkIGxvbmcg
X19wZXJfY3B1X29mZnNldFsyNF07CiMgNDggIi4vaW5jbHVkZS9hc20tZ2VuZXJpYy9wZXJj
cHUuaCIKZXh0ZXJuIHZvaWQgc2V0dXBfcGVyX2NwdV9hcmVhcyh2b2lkKTsKIyAyMSAiLi9h
cmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vcGVyY3B1LmgiIDIKIyAxMzkgIi4vYXJjaC9wb3dl
cnBjL2luY2x1ZGUvYXNtL21tdS5oIiAyCmV4dGVybiBfX2F0dHJpYnV0ZV9fKChzZWN0aW9u
KCIuZGF0YS4ucGVyY3B1IiAiIikpKSBfX3R5cGVvZl9fKGludCkgbmV4dF90bGJjYW1faWR4
OwoKCmVudW0gewogTU1VX0ZUUlNfUE9TU0lCTEUgPQojIDE1NyAiLi9hcmNoL3Bvd2VycGMv
aW5jbHVkZS9hc20vbW11LmgiCiAgMHgwMDAwMDAxMFVMIHwgMHgwMDAyMDAwMFVMIHwgMHgw
MDA4MDAwMFVMIHwKIyAxNjYgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL21tdS5oIgog
IDB4MDA4MDAwMDBVTCB8IDB4MDEwMDAwMDBVTCB8CiMgMTgwICIuL2FyY2gvcG93ZXJwYy9p
bmNsdWRlL2FzbS9tbXUuaCIKICAwLAp9OwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgZWFybHlfbW11X2hh
c19mZWF0dXJlKHVuc2lnbmVkIGxvbmcgZmVhdHVyZSkKewogcmV0dXJuICEhKE1NVV9GVFJT
X1BPU1NJQkxFICYgY3VyX2NwdV9zcGVjLT5tbXVfZmVhdHVyZXMgJiBmZWF0dXJlKTsKfQoj
IDIzMCAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vbW11LmgiCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lk
IG1tdV9mZWF0dXJlX2tleXNfaW5pdCh2b2lkKQp7Cgp9CgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBtbXVf
aGFzX2ZlYXR1cmUodW5zaWduZWQgbG9uZyBmZWF0dXJlKQp7CiByZXR1cm4gZWFybHlfbW11
X2hhc19mZWF0dXJlKGZlYXR1cmUpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBtbXVfY2xlYXJfZmVh
dHVyZSh1bnNpZ25lZCBsb25nIGZlYXR1cmUpCnsKIGN1cl9jcHVfc3BlYy0+bW11X2ZlYXR1
cmVzICY9IH5mZWF0dXJlOwp9CgoKZXh0ZXJuIHVuc2lnbmVkIGludCBfX3N0YXJ0X19fbW11
X2Z0cl9maXh1cCwgX19zdG9wX19fbW11X2Z0cl9maXh1cDsKCgoKCgpleHRlcm4gdTY0IHBw
YzY0X3JtYV9zaXplOwoKCmV4dGVybiB2b2lkIG1tdV9jbGVhbnVwX2FsbCh2b2lkKTsKZXh0
ZXJuIHZvaWQgcmFkaXhfX21tdV9jbGVhbnVwX2FsbCh2b2lkKTsKCgpleHRlcm4gdm9pZCBt
bXVfcGFydGl0aW9uX3RhYmxlX2luaXQodm9pZCk7CmV4dGVybiB2b2lkIG1tdV9wYXJ0aXRp
b25fdGFibGVfc2V0X2VudHJ5KHVuc2lnbmVkIGludCBscGlkLCB1bnNpZ25lZCBsb25nIGR3
MCwKICAgICAgIHVuc2lnbmVkIGxvbmcgZHcxLCBib29sIGZsdXNoKTsKCgpzdHJ1Y3QgbW1f
c3RydWN0OwoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBhc3NlcnRfcHRlX2xvY2tlZChzdHJ1Y3QgbW1f
c3RydWN0ICptbSwgdW5zaWduZWQgbG9uZyBhZGRyKQp7Cn0KIyAyODQgIi4vYXJjaC9wb3dl
cnBjL2luY2x1ZGUvYXNtL21tdS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCByYWRpeF9lbmFibGVkKHZv
aWQpCnsKIHJldHVybiBmYWxzZTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgZWFybHlfcmFkaXhfZW5h
YmxlZCh2b2lkKQp7CiByZXR1cm4gZmFsc2U7Cn0KIyAzMDEgIi4vYXJjaC9wb3dlcnBjL2lu
Y2x1ZGUvYXNtL21tdS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBzdHJpY3Rfa2VybmVsX3J3eF9lbmFi
bGVkKHZvaWQpCnsKIHJldHVybiBmYWxzZTsKfQojIDM1MyAiLi9hcmNoL3Bvd2VycGMvaW5j
bHVkZS9hc20vbW11LmgiCmV4dGVybiB2b2lkIGVhcmx5X2luaXRfbW11KHZvaWQpOwpleHRl
cm4gdm9pZCBlYXJseV9pbml0X21tdV9zZWNvbmRhcnkodm9pZCk7CmV4dGVybiB2b2lkIHNl
dHVwX2luaXRpYWxfbWVtb3J5X2xpbWl0KHBoeXNfYWRkcl90IGZpcnN0X21lbWJsb2NrX2Jh
c2UsCiAgICAgICAgICAgcGh5c19hZGRyX3QgZmlyc3RfbWVtYmxvY2tfc2l6ZSk7CnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSB2b2lkIG1tdV9lYXJseV9pbml0X2RldnRyZWUodm9pZCkgeyB9CgpleHRlcm4gdm9p
ZCAqYWJhdHJvbl9wdGVwdHJzWzJdOwoKCgoKCgoKIyAxICIuL2FyY2gvcG93ZXJwYy9pbmNs
dWRlL2FzbS9ub2hhc2gvbW11LmgiIDEKIyAxMyAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9h
c20vbm9oYXNoL21tdS5oIgojIDEgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL25vaGFz
aC9tbXUtYm9vazNlLmgiIDEKIyAyMzYgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL25v
aGFzaC9tbXUtYm9vazNlLmgiCmV4dGVybiB1bnNpZ25lZCBpbnQgdGxiY2FtX2luZGV4OwoK
dHlwZWRlZiBzdHJ1Y3QgewogdW5zaWduZWQgaW50IGlkOwogdW5zaWduZWQgaW50IGFjdGl2
ZTsKIHVuc2lnbmVkIGxvbmcgdmRzb19iYXNlOwp9IG1tX2NvbnRleHRfdDsKCgoKCgoKCnN0
cnVjdCBtbXVfcHNpemVfZGVmCnsKIHVuc2lnbmVkIGludCBzaGlmdDsKIHVuc2lnbmVkIGlu
dCBlbmM7CiB1bnNpZ25lZCBpbnQgaW5kOwogdW5zaWduZWQgaW50IGZsYWdzOwoKCn07CmV4
dGVybiBzdHJ1Y3QgbW11X3BzaXplX2RlZiBtbXVfcHNpemVfZGVmc1sxNl07CgpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgaW50IHNoaWZ0X3RvX21tdV9wc2l6ZSh1bnNpZ25lZCBpbnQgc2hpZnQpCnsKIGludCBw
c2l6ZTsKCiBmb3IgKHBzaXplID0gMDsgcHNpemUgPCAxNjsgKytwc2l6ZSkKICBpZiAobW11
X3BzaXplX2RlZnNbcHNpemVdLnNoaWZ0ID09IHNoaWZ0KQogICByZXR1cm4gcHNpemU7CiBy
ZXR1cm4gLTE7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1bnNpZ25lZCBpbnQgbW11X3BzaXplX3RvX3NoaWZ0
KHVuc2lnbmVkIGludCBtbXVfcHNpemUpCnsKIGlmIChtbXVfcHNpemVfZGVmc1ttbXVfcHNp
emVdLnNoaWZ0KQogIHJldHVybiBtbXVfcHNpemVfZGVmc1ttbXVfcHNpemVdLnNoaWZ0Owog
ZG8geyBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CSIgInR3aSAzMSwgMCwgMCIgIlxuIiAi
LnNlY3Rpb24gX19idWdfdGFibGUsXCJhd1wiXG4iICIyOlx0IiAiLjhieXRlIiAiICIgIjFi
LCAlMFxuIiAiXHQuc2hvcnQgJTEsICUyXG4iICIub3JnIDJiKyUzXG4iICIucHJldmlvdXNc
biIgOiA6ICJpIiAoIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL25vaGFzaC9tbXUtYm9v
azNlLmgiKSwgImkiICgyNzUpLCAiaSIgKDApLCAiaSIgKHNpemVvZihzdHJ1Y3QgYnVnX2Vu
dHJ5KSkpOyBkbyB7IDsgYXNtIHZvbGF0aWxlKCIiKTsgX19idWlsdGluX3VucmVhY2hhYmxl
KCk7IH0gd2hpbGUgKDApOyB9IHdoaWxlICgwKTsKfQojIDI4NyAiLi9hcmNoL3Bvd2VycGMv
aW5jbHVkZS9hc20vbm9oYXNoL21tdS1ib29rM2UuaCIKZXh0ZXJuIGludCBtbXVfbGluZWFy
X3BzaXplOwpleHRlcm4gaW50IG1tdV92bWVtbWFwX3BzaXplOwoKc3RydWN0IHRsYl9jb3Jl
X2RhdGEgewoKCgoKIHU4IGxvY2s7CgoKIHU4IGVzZWxfbmV4dCwgZXNlbF9tYXgsIGVzZWxf
Zmlyc3Q7Cn07CgoKZXh0ZXJuIHVuc2lnbmVkIGxvbmcgbGluZWFyX21hcF90b3A7CmV4dGVy
biBpbnQgYm9vazNlX2h0d19tb2RlOwojIDE0ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2Fz
bS9ub2hhc2gvbW11LmgiIDIKIyAzNjggIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL21t
dS5oIiAyCiMgMTkgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL3BhY2EuaCIgMgoKCiMg
MSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vZXhjZXB0aW9uLTY0ZS5oIiAxCiMgMjIg
Ii4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL3BhY2EuaCIgMgoKCgoKCgojIDEgIi4vYXJj
aC9wb3dlcnBjL2luY2x1ZGUvYXNtL2FjY291bnRpbmcuaCIgMQojIDEwICIuL2FyY2gvcG93
ZXJwYy9pbmNsdWRlL2FzbS9hY2NvdW50aW5nLmgiCnN0cnVjdCBjcHVfYWNjb3VudGluZ19k
YXRhIHsKCiB1bnNpZ25lZCBsb25nIHV0aW1lOwogdW5zaWduZWQgbG9uZyBzdGltZTsKCgoK
CiB1bnNpZ25lZCBsb25nIGd0aW1lOwogdW5zaWduZWQgbG9uZyBoYXJkaXJxX3RpbWU7CiB1
bnNpZ25lZCBsb25nIHNvZnRpcnFfdGltZTsKIHVuc2lnbmVkIGxvbmcgc3RlYWxfdGltZTsK
IHVuc2lnbmVkIGxvbmcgaWRsZV90aW1lOwoKIHVuc2lnbmVkIGxvbmcgc3RhcnR0aW1lOwog
dW5zaWduZWQgbG9uZyBzdGFydHRpbWVfdXNlcjsKCgoKCn07CiMgMjkgIi4vYXJjaC9wb3dl
cnBjL2luY2x1ZGUvYXNtL3BhY2EuaCIgMgojIDEgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUv
YXNtL2htaS5oIiAxCiMgMzAgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2htaS5oIgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgdm9pZCB3YWl0X2Zvcl9zdWJjb3JlX2d1ZXN0X2V4aXQodm9pZCkgeyB9CnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSB2b2lkIHdhaXRfZm9yX3RiX3Jlc3luYyh2b2lkKSB7IH0KCgpzdHJ1Y3QgcHRf
cmVnczsKZXh0ZXJuIGxvbmcgaG1pX2hhbmRsZV9kZWJ1Z3RyaWcoc3RydWN0IHB0X3JlZ3Mg
KnJlZ3MpOwojIDMwICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9wYWNhLmgiIDIKIyAx
ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9jcHVpZGxlLmgiIDEKIyAzMSAiLi9hcmNo
L3Bvd2VycGMvaW5jbHVkZS9hc20vcGFjYS5oIiAyCiMgMSAiLi9hcmNoL3Bvd2VycGMvaW5j
bHVkZS9hc20vYXRvbWljLmgiIDEKIyAxMSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20v
YXRvbWljLmgiCiMgMSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vY21weGNoZy5oIiAx
CiMgODAgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2NtcHhjaGcuaCIKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IHUzMiBfX3hjaGdfdThfbG9jYWwodm9sYXRpbGUgdm9pZCAqcCwgdTMyIHZhbCkgeyB1bnNp
Z25lZCBpbnQgcHJldiwgcHJldl9tYXNrLCB0bXAsIGJpdG9mZiwgb2ZmOyBvZmYgPSAodW5z
aWduZWQgbG9uZylwICUgc2l6ZW9mKHUzMik7IGJpdG9mZiA9ICgoc2l6ZW9mKHUzMikgLSBz
aXplb2YodTgpIC0gb2ZmKSAqIDgpOyBwIC09IG9mZjsgdmFsIDw8PSBiaXRvZmY7IHByZXZf
bWFzayA9ICh1MzIpKHU4KS0xIDw8IGJpdG9mZjsgX19hc21fXyBfX3ZvbGF0aWxlX18oICIx
Oglsd2FyeCAgICUwLDAsJTNcbiIgIglhbmRjCSUxLCUwLCU1XG4iICIJb3IJJTEsJTEsJTRc
biIgIglzdHdjeC4JJTEsMCwlM1xuIiAiCWJuZS0JMWJcbiIgOiAiPSZyIiAocHJldiksICI9
JnIiICh0bXApLCAiK20iICgqKHUzMiopcCkgOiAiciIgKHApLCAiciIgKHZhbCksICJyIiAo
cHJldl9tYXNrKSA6ICJjYyIsICJtZW1vcnkiKTsgcmV0dXJuIHByZXYgPj4gYml0b2ZmOyB9
OwpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgdTMyIF9feGNoZ191OF9yZWxheGVkKHZvbGF0aWxlIHZvaWQgKnAsIHUz
MiB2YWwpIHsgdW5zaWduZWQgaW50IHByZXYsIHByZXZfbWFzaywgdG1wLCBiaXRvZmYsIG9m
Zjsgb2ZmID0gKHVuc2lnbmVkIGxvbmcpcCAlIHNpemVvZih1MzIpOyBiaXRvZmYgPSAoKHNp
emVvZih1MzIpIC0gc2l6ZW9mKHU4KSAtIG9mZikgKiA4KTsgcCAtPSBvZmY7IHZhbCA8PD0g
Yml0b2ZmOyBwcmV2X21hc2sgPSAodTMyKSh1OCktMSA8PCBiaXRvZmY7IF9fYXNtX18gX192
b2xhdGlsZV9fKCAiMToJbHdhcnggICAlMCwwLCUzXG4iICIJYW5kYwklMSwlMCwlNVxuIiAi
CW9yCSUxLCUxLCU0XG4iICIJc3R3Y3guCSUxLDAsJTNcbiIgIglibmUtCTFiXG4iIDogIj0m
ciIgKHByZXYpLCAiPSZyIiAodG1wKSwgIittIiAoKih1MzIqKXApIDogInIiIChwKSwgInIi
ICh2YWwpLCAiciIgKHByZXZfbWFzaykgOiAiY2MiLCAiY2MiKTsgcmV0dXJuIHByZXYgPj4g
Yml0b2ZmOyB9OwpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgdTMyIF9feGNoZ191MTZfbG9jYWwodm9sYXRpbGUgdm9p
ZCAqcCwgdTMyIHZhbCkgeyB1bnNpZ25lZCBpbnQgcHJldiwgcHJldl9tYXNrLCB0bXAsIGJp
dG9mZiwgb2ZmOyBvZmYgPSAodW5zaWduZWQgbG9uZylwICUgc2l6ZW9mKHUzMik7IGJpdG9m
ZiA9ICgoc2l6ZW9mKHUzMikgLSBzaXplb2YodTE2KSAtIG9mZikgKiA4KTsgcCAtPSBvZmY7
IHZhbCA8PD0gYml0b2ZmOyBwcmV2X21hc2sgPSAodTMyKSh1MTYpLTEgPDwgYml0b2ZmOyBf
X2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CWx3YXJ4ICAgJTAsMCwlM1xuIiAiCWFuZGMJJTEs
JTAsJTVcbiIgIglvcgklMSwlMSwlNFxuIiAiCXN0d2N4LgklMSwwLCUzXG4iICIJYm5lLQkx
YlxuIiA6ICI9JnIiIChwcmV2KSwgIj0mciIgKHRtcCksICIrbSIgKCoodTMyKilwKSA6ICJy
IiAocCksICJyIiAodmFsKSwgInIiIChwcmV2X21hc2spIDogImNjIiwgIm1lbW9yeSIpOyBy
ZXR1cm4gcHJldiA+PiBiaXRvZmY7IH07CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1MzIgX194Y2hnX3UxNl9yZWxh
eGVkKHZvbGF0aWxlIHZvaWQgKnAsIHUzMiB2YWwpIHsgdW5zaWduZWQgaW50IHByZXYsIHBy
ZXZfbWFzaywgdG1wLCBiaXRvZmYsIG9mZjsgb2ZmID0gKHVuc2lnbmVkIGxvbmcpcCAlIHNp
emVvZih1MzIpOyBiaXRvZmYgPSAoKHNpemVvZih1MzIpIC0gc2l6ZW9mKHUxNikgLSBvZmYp
ICogOCk7IHAgLT0gb2ZmOyB2YWwgPDw9IGJpdG9mZjsgcHJldl9tYXNrID0gKHUzMikodTE2
KS0xIDw8IGJpdG9mZjsgX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOglsd2FyeCAgICUwLDAs
JTNcbiIgIglhbmRjCSUxLCUwLCU1XG4iICIJb3IJJTEsJTEsJTRcbiIgIglzdHdjeC4JJTEs
MCwlM1xuIiAiCWJuZS0JMWJcbiIgOiAiPSZyIiAocHJldiksICI9JnIiICh0bXApLCAiK20i
ICgqKHUzMiopcCkgOiAiciIgKHApLCAiciIgKHZhbCksICJyIiAocHJldl9tYXNrKSA6ICJj
YyIsICJjYyIpOyByZXR1cm4gcHJldiA+PiBiaXRvZmY7IH07CgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRy
aWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB1bnNpZ25lZCBsb25nCl9feGNoZ191MzJf
bG9jYWwodm9sYXRpbGUgdm9pZCAqcCwgdW5zaWduZWQgbG9uZyB2YWwpCnsKIHVuc2lnbmVk
IGxvbmcgcHJldjsKCiBfX2FzbV9fIF9fdm9sYXRpbGVfXygKIjE6CWx3YXJ4CSUwLDAsJTIg
XG4iCiIJc3R3Y3guCSUzLDAsJTIgXG4JYm5lLQkxYiIKCiA6ICI9JnIiIChwcmV2KSwgIitt
IiAoKih2b2xhdGlsZSB1bnNpZ25lZCBpbnQgKilwKQogOiAiciIgKHApLCAiciIgKHZhbCkK
IDogImNjIiwgIm1lbW9yeSIpOwoKIHJldHVybiBwcmV2Owp9CgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRy
aWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB1bnNpZ25lZCBsb25nCl9feGNoZ191MzJf
cmVsYXhlZCh1MzIgKnAsIHVuc2lnbmVkIGxvbmcgdmFsKQp7CiB1bnNpZ25lZCBsb25nIHBy
ZXY7CgogX19hc21fXyBfX3ZvbGF0aWxlX18oCiIxOglsd2FyeAklMCwwLCUyXG4iCiIJc3R3
Y3guCSUzLDAsJTJcbiIKIglibmUtCTFiIgogOiAiPSZyIiAocHJldiksICIrbSIgKCpwKQog
OiAiciIgKHApLCAiciIgKHZhbCkKIDogImNjIik7CgogcmV0dXJuIHByZXY7Cn0KCgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB1bnNpZ25lZCBsb25n
Cl9feGNoZ191NjRfbG9jYWwodm9sYXRpbGUgdm9pZCAqcCwgdW5zaWduZWQgbG9uZyB2YWwp
CnsKIHVuc2lnbmVkIGxvbmcgcHJldjsKCiBfX2FzbV9fIF9fdm9sYXRpbGVfXygKIjE6CWxk
YXJ4CSUwLDAsJTIgXG4iCiIJc3RkY3guCSUzLDAsJTIgXG4JYm5lLQkxYiIKCiA6ICI9JnIi
IChwcmV2KSwgIittIiAoKih2b2xhdGlsZSB1bnNpZ25lZCBsb25nICopcCkKIDogInIiIChw
KSwgInIiICh2YWwpCiA6ICJjYyIsICJtZW1vcnkiKTsKCiByZXR1cm4gcHJldjsKfQoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgdW5zaWduZWQgbG9u
ZwpfX3hjaGdfdTY0X3JlbGF4ZWQodTY0ICpwLCB1bnNpZ25lZCBsb25nIHZhbCkKewogdW5z
aWduZWQgbG9uZyBwcmV2OwoKIF9fYXNtX18gX192b2xhdGlsZV9fKAoiMToJbGRhcngJJTAs
MCwlMlxuIgoiCXN0ZGN4LgklMywwLCUyXG4iCiIJYm5lLQkxYiIKIDogIj0mciIgKHByZXYp
LCAiK20iICgqcCkKIDogInIiIChwKSwgInIiICh2YWwpCiA6ICJjYyIpOwoKIHJldHVybiBw
cmV2Owp9CgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkg
dW5zaWduZWQgbG9uZwpfX3hjaGdfbG9jYWwodm9pZCAqcHRyLCB1bnNpZ25lZCBsb25nIHgs
IHVuc2lnbmVkIGludCBzaXplKQp7CiBzd2l0Y2ggKHNpemUpIHsKIGNhc2UgMToKICByZXR1
cm4gX194Y2hnX3U4X2xvY2FsKHB0ciwgeCk7CiBjYXNlIDI6CiAgcmV0dXJuIF9feGNoZ191
MTZfbG9jYWwocHRyLCB4KTsKIGNhc2UgNDoKICByZXR1cm4gX194Y2hnX3UzMl9sb2NhbChw
dHIsIHgpOwoKIGNhc2UgODoKICByZXR1cm4gX194Y2hnX3U2NF9sb2NhbChwdHIsIHgpOwoK
IH0KIGRvIHsgZXh0ZXJuIHZvaWQgX19jb21waWxldGltZV9hc3NlcnRfMCh2b2lkKSBfX2F0
dHJpYnV0ZV9fKChfX2Vycm9yX18oIlVuc3VwcG9ydGVkIHNpemUgZm9yIF9feGNoZyIpKSk7
IGlmICghKCEoMSkpKSBfX2NvbXBpbGV0aW1lX2Fzc2VydF8wKCk7IH0gd2hpbGUgKDApOwog
cmV0dXJuIHg7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVf
XykpIHVuc2lnbmVkIGxvbmcKX194Y2hnX3JlbGF4ZWQodm9pZCAqcHRyLCB1bnNpZ25lZCBs
b25nIHgsIHVuc2lnbmVkIGludCBzaXplKQp7CiBzd2l0Y2ggKHNpemUpIHsKIGNhc2UgMToK
ICByZXR1cm4gX194Y2hnX3U4X3JlbGF4ZWQocHRyLCB4KTsKIGNhc2UgMjoKICByZXR1cm4g
X194Y2hnX3UxNl9yZWxheGVkKHB0ciwgeCk7CiBjYXNlIDQ6CiAgcmV0dXJuIF9feGNoZ191
MzJfcmVsYXhlZChwdHIsIHgpOwoKIGNhc2UgODoKICByZXR1cm4gX194Y2hnX3U2NF9yZWxh
eGVkKHB0ciwgeCk7CgogfQogZG8geyBleHRlcm4gdm9pZCBfX2NvbXBpbGV0aW1lX2Fzc2Vy
dF8xKHZvaWQpIF9fYXR0cmlidXRlX18oKF9fZXJyb3JfXygiVW5zdXBwb3J0ZWQgc2l6ZSBm
b3IgX194Y2hnX2xvY2FsIikpKTsgaWYgKCEoISgxKSkpIF9fY29tcGlsZXRpbWVfYXNzZXJ0
XzEoKTsgfSB3aGlsZSAoMCk7CiByZXR1cm4geDsKfQojIDIwNiAiLi9hcmNoL3Bvd2VycGMv
aW5jbHVkZS9hc20vY21weGNoZy5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdTMyIF9fY21weGNoZ191OCh2b2xh
dGlsZSB2b2lkICpwLCB1MzIgb2xkLCB1MzIgbmV3KSB7IHVuc2lnbmVkIGludCBwcmV2LCBw
cmV2X21hc2ssIHRtcCwgYml0b2ZmLCBvZmY7IG9mZiA9ICh1bnNpZ25lZCBsb25nKXAgJSBz
aXplb2YodTMyKTsgYml0b2ZmID0gKChzaXplb2YodTMyKSAtIHNpemVvZih1OCkgLSBvZmYp
ICogOCk7IHAgLT0gb2ZmOyBvbGQgPDw9IGJpdG9mZjsgbmV3IDw8PSBiaXRvZmY7IHByZXZf
bWFzayA9ICh1MzIpKHU4KS0xIDw8IGJpdG9mZjsgX19hc21fXyBfX3ZvbGF0aWxlX18oICJc
biIgInN5bmMiICIgIiAiXG4iICIxOglsd2FyeCAgICUwLDAsJTNcbiIgIglhbmQJJTEsJTAs
JTZcbiIgIgljbXB3CTAsJTEsJTRcbiIgIglibmUtCTJmXG4iICIJYW5kYwklMSwlMCwlNlxu
IiAiCW9yCSUxLCUxLCU1XG4iICIJc3R3Y3guICAlMSwwLCUzXG4iICIJYm5lLSAgICAxYlxu
IiAiXG4iICJzeW5jIiAiICIgIlxuIiAiXG4iICIyOiIgOiAiPSZyIiAocHJldiksICI9JnIi
ICh0bXApLCAiK20iICgqKHUzMiopcCkgOiAiciIgKHApLCAiciIgKG9sZCksICJyIiAobmV3
KSwgInIiIChwcmV2X21hc2spIDogImNjIiwgIm1lbW9yeSIpOyByZXR1cm4gcHJldiA+PiBi
aXRvZmY7IH07CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSB1MzIgX19jbXB4Y2hnX3U4X2xvY2FsKHZvbGF0aWxlIHZv
aWQgKnAsIHUzMiBvbGQsIHUzMiBuZXcpIHsgdW5zaWduZWQgaW50IHByZXYsIHByZXZfbWFz
aywgdG1wLCBiaXRvZmYsIG9mZjsgb2ZmID0gKHVuc2lnbmVkIGxvbmcpcCAlIHNpemVvZih1
MzIpOyBiaXRvZmYgPSAoKHNpemVvZih1MzIpIC0gc2l6ZW9mKHU4KSAtIG9mZikgKiA4KTsg
cCAtPSBvZmY7IG9sZCA8PD0gYml0b2ZmOyBuZXcgPDw9IGJpdG9mZjsgcHJldl9tYXNrID0g
KHUzMikodTgpLTEgPDwgYml0b2ZmOyBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CWx3YXJ4
ICAgJTAsMCwlM1xuIiAiCWFuZAklMSwlMCwlNlxuIiAiCWNtcHcJMCwlMSwlNFxuIiAiCWJu
ZS0JMmZcbiIgIglhbmRjCSUxLCUwLCU2XG4iICIJb3IJJTEsJTEsJTVcbiIgIglzdHdjeC4g
ICUxLDAsJTNcbiIgIglibmUtICAgIDFiXG4iICJcbiIgIjI6IiA6ICI9JnIiIChwcmV2KSwg
Ij0mciIgKHRtcCksICIrbSIgKCoodTMyKilwKSA6ICJyIiAocCksICJyIiAob2xkKSwgInIi
IChuZXcpLCAiciIgKHByZXZfbWFzaykgOiAiY2MiLCAibWVtb3J5Iik7IHJldHVybiBwcmV2
ID4+IGJpdG9mZjsgfTsKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHUzMiBfX2NtcHhjaGdfdThfYWNxdWlyZSh2b2xh
dGlsZSB2b2lkICpwLCB1MzIgb2xkLCB1MzIgbmV3KSB7IHVuc2lnbmVkIGludCBwcmV2LCBw
cmV2X21hc2ssIHRtcCwgYml0b2ZmLCBvZmY7IG9mZiA9ICh1bnNpZ25lZCBsb25nKXAgJSBz
aXplb2YodTMyKTsgYml0b2ZmID0gKChzaXplb2YodTMyKSAtIHNpemVvZih1OCkgLSBvZmYp
ICogOCk7IHAgLT0gb2ZmOyBvbGQgPDw9IGJpdG9mZjsgbmV3IDw8PSBiaXRvZmY7IHByZXZf
bWFzayA9ICh1MzIpKHU4KS0xIDw8IGJpdG9mZjsgX19hc21fXyBfX3ZvbGF0aWxlX18oICIx
Oglsd2FyeCAgICUwLDAsJTNcbiIgIglhbmQJJTEsJTAsJTZcbiIgIgljbXB3CTAsJTEsJTRc
biIgIglibmUtCTJmXG4iICIJYW5kYwklMSwlMCwlNlxuIiAiCW9yCSUxLCUxLCU1XG4iICIJ
c3R3Y3guICAlMSwwLCUzXG4iICIJYm5lLSAgICAxYlxuIiAiXG4iICI5NzE6OyBpc3luYzsg
OTcyOiAucHVzaHNlY3Rpb24gX19sd3N5bmNfZml4dXAsXCJhXCI7IC5hbGlnbiAyOyA5NzM6
IC44Ynl0ZSA5NzFiLTk3M2I7IC5wb3BzZWN0aW9uOzsiICIgIiAiXG4iICIyOiIgOiAiPSZy
IiAocHJldiksICI9JnIiICh0bXApLCAiK20iICgqKHUzMiopcCkgOiAiciIgKHApLCAiciIg
KG9sZCksICJyIiAobmV3KSwgInIiIChwcmV2X21hc2spIDogImNjIiwgIm1lbW9yeSIpOyBy
ZXR1cm4gcHJldiA+PiBiaXRvZmY7IH07CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1MzIgX19jbXB4Y2hnX3U4X3Jl
bGF4ZWQodm9sYXRpbGUgdm9pZCAqcCwgdTMyIG9sZCwgdTMyIG5ldykgeyB1bnNpZ25lZCBp
bnQgcHJldiwgcHJldl9tYXNrLCB0bXAsIGJpdG9mZiwgb2ZmOyBvZmYgPSAodW5zaWduZWQg
bG9uZylwICUgc2l6ZW9mKHUzMik7IGJpdG9mZiA9ICgoc2l6ZW9mKHUzMikgLSBzaXplb2Yo
dTgpIC0gb2ZmKSAqIDgpOyBwIC09IG9mZjsgb2xkIDw8PSBiaXRvZmY7IG5ldyA8PD0gYml0
b2ZmOyBwcmV2X21hc2sgPSAodTMyKSh1OCktMSA8PCBiaXRvZmY7IF9fYXNtX18gX192b2xh
dGlsZV9fKCAiMToJbHdhcnggICAlMCwwLCUzXG4iICIJYW5kCSUxLCUwLCU2XG4iICIJY21w
dwkwLCUxLCU0XG4iICIJYm5lLQkyZlxuIiAiCWFuZGMJJTEsJTAsJTZcbiIgIglvcgklMSwl
MSwlNVxuIiAiCXN0d2N4LiAgJTEsMCwlM1xuIiAiCWJuZS0gICAgMWJcbiIgIlxuIiAiMjoi
IDogIj0mciIgKHByZXYpLCAiPSZyIiAodG1wKSwgIittIiAoKih1MzIqKXApIDogInIiIChw
KSwgInIiIChvbGQpLCAiciIgKG5ldyksICJyIiAocHJldl9tYXNrKSA6ICJjYyIsICJjYyIp
OyByZXR1cm4gcHJldiA+PiBiaXRvZmY7IH07CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1MzIgX19jbXB4Y2hnX3Ux
Nih2b2xhdGlsZSB2b2lkICpwLCB1MzIgb2xkLCB1MzIgbmV3KSB7IHVuc2lnbmVkIGludCBw
cmV2LCBwcmV2X21hc2ssIHRtcCwgYml0b2ZmLCBvZmY7IG9mZiA9ICh1bnNpZ25lZCBsb25n
KXAgJSBzaXplb2YodTMyKTsgYml0b2ZmID0gKChzaXplb2YodTMyKSAtIHNpemVvZih1MTYp
IC0gb2ZmKSAqIDgpOyBwIC09IG9mZjsgb2xkIDw8PSBiaXRvZmY7IG5ldyA8PD0gYml0b2Zm
OyBwcmV2X21hc2sgPSAodTMyKSh1MTYpLTEgPDwgYml0b2ZmOyBfX2FzbV9fIF9fdm9sYXRp
bGVfXyggIlxuIiAic3luYyIgIiAiICJcbiIgIjE6CWx3YXJ4ICAgJTAsMCwlM1xuIiAiCWFu
ZAklMSwlMCwlNlxuIiAiCWNtcHcJMCwlMSwlNFxuIiAiCWJuZS0JMmZcbiIgIglhbmRjCSUx
LCUwLCU2XG4iICIJb3IJJTEsJTEsJTVcbiIgIglzdHdjeC4gICUxLDAsJTNcbiIgIglibmUt
ICAgIDFiXG4iICJcbiIgInN5bmMiICIgIiAiXG4iICJcbiIgIjI6IiA6ICI9JnIiIChwcmV2
KSwgIj0mciIgKHRtcCksICIrbSIgKCoodTMyKilwKSA6ICJyIiAocCksICJyIiAob2xkKSwg
InIiIChuZXcpLCAiciIgKHByZXZfbWFzaykgOiAiY2MiLCAibWVtb3J5Iik7IHJldHVybiBw
cmV2ID4+IGJpdG9mZjsgfTsKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHUzMiBfX2NtcHhjaGdfdTE2X2xvY2FsKHZv
bGF0aWxlIHZvaWQgKnAsIHUzMiBvbGQsIHUzMiBuZXcpIHsgdW5zaWduZWQgaW50IHByZXYs
IHByZXZfbWFzaywgdG1wLCBiaXRvZmYsIG9mZjsgb2ZmID0gKHVuc2lnbmVkIGxvbmcpcCAl
IHNpemVvZih1MzIpOyBiaXRvZmYgPSAoKHNpemVvZih1MzIpIC0gc2l6ZW9mKHUxNikgLSBv
ZmYpICogOCk7IHAgLT0gb2ZmOyBvbGQgPDw9IGJpdG9mZjsgbmV3IDw8PSBiaXRvZmY7IHBy
ZXZfbWFzayA9ICh1MzIpKHUxNiktMSA8PCBiaXRvZmY7IF9fYXNtX18gX192b2xhdGlsZV9f
KCAiMToJbHdhcnggICAlMCwwLCUzXG4iICIJYW5kCSUxLCUwLCU2XG4iICIJY21wdwkwLCUx
LCU0XG4iICIJYm5lLQkyZlxuIiAiCWFuZGMJJTEsJTAsJTZcbiIgIglvcgklMSwlMSwlNVxu
IiAiCXN0d2N4LiAgJTEsMCwlM1xuIiAiCWJuZS0gICAgMWJcbiIgIlxuIiAiMjoiIDogIj0m
ciIgKHByZXYpLCAiPSZyIiAodG1wKSwgIittIiAoKih1MzIqKXApIDogInIiIChwKSwgInIi
IChvbGQpLCAiciIgKG5ldyksICJyIiAocHJldl9tYXNrKSA6ICJjYyIsICJtZW1vcnkiKTsg
cmV0dXJuIHByZXYgPj4gYml0b2ZmOyB9OwpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdTMyIF9fY21weGNoZ191MTZf
YWNxdWlyZSh2b2xhdGlsZSB2b2lkICpwLCB1MzIgb2xkLCB1MzIgbmV3KSB7IHVuc2lnbmVk
IGludCBwcmV2LCBwcmV2X21hc2ssIHRtcCwgYml0b2ZmLCBvZmY7IG9mZiA9ICh1bnNpZ25l
ZCBsb25nKXAgJSBzaXplb2YodTMyKTsgYml0b2ZmID0gKChzaXplb2YodTMyKSAtIHNpemVv
Zih1MTYpIC0gb2ZmKSAqIDgpOyBwIC09IG9mZjsgb2xkIDw8PSBiaXRvZmY7IG5ldyA8PD0g
Yml0b2ZmOyBwcmV2X21hc2sgPSAodTMyKSh1MTYpLTEgPDwgYml0b2ZmOyBfX2FzbV9fIF9f
dm9sYXRpbGVfXyggIjE6CWx3YXJ4ICAgJTAsMCwlM1xuIiAiCWFuZAklMSwlMCwlNlxuIiAi
CWNtcHcJMCwlMSwlNFxuIiAiCWJuZS0JMmZcbiIgIglhbmRjCSUxLCUwLCU2XG4iICIJb3IJ
JTEsJTEsJTVcbiIgIglzdHdjeC4gICUxLDAsJTNcbiIgIglibmUtICAgIDFiXG4iICJcbiIg
Ijk3MTo7IGlzeW5jOyA5NzI6IC5wdXNoc2VjdGlvbiBfX2x3c3luY19maXh1cCxcImFcIjsg
LmFsaWduIDI7IDk3MzogLjhieXRlIDk3MWItOTczYjsgLnBvcHNlY3Rpb247OyIgIiAiICJc
biIgIjI6IiA6ICI9JnIiIChwcmV2KSwgIj0mciIgKHRtcCksICIrbSIgKCoodTMyKilwKSA6
ICJyIiAocCksICJyIiAob2xkKSwgInIiIChuZXcpLCAiciIgKHByZXZfbWFzaykgOiAiY2Mi
LCAibWVtb3J5Iik7IHJldHVybiBwcmV2ID4+IGJpdG9mZjsgfTsKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHUzMiBf
X2NtcHhjaGdfdTE2X3JlbGF4ZWQodm9sYXRpbGUgdm9pZCAqcCwgdTMyIG9sZCwgdTMyIG5l
dykgeyB1bnNpZ25lZCBpbnQgcHJldiwgcHJldl9tYXNrLCB0bXAsIGJpdG9mZiwgb2ZmOyBv
ZmYgPSAodW5zaWduZWQgbG9uZylwICUgc2l6ZW9mKHUzMik7IGJpdG9mZiA9ICgoc2l6ZW9m
KHUzMikgLSBzaXplb2YodTE2KSAtIG9mZikgKiA4KTsgcCAtPSBvZmY7IG9sZCA8PD0gYml0
b2ZmOyBuZXcgPDw9IGJpdG9mZjsgcHJldl9tYXNrID0gKHUzMikodTE2KS0xIDw8IGJpdG9m
ZjsgX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOglsd2FyeCAgICUwLDAsJTNcbiIgIglhbmQJ
JTEsJTAsJTZcbiIgIgljbXB3CTAsJTEsJTRcbiIgIglibmUtCTJmXG4iICIJYW5kYwklMSwl
MCwlNlxuIiAiCW9yCSUxLCUxLCU1XG4iICIJc3R3Y3guICAlMSwwLCUzXG4iICIJYm5lLSAg
ICAxYlxuIiAiXG4iICIyOiIgOiAiPSZyIiAocHJldiksICI9JnIiICh0bXApLCAiK20iICgq
KHUzMiopcCkgOiAiciIgKHApLCAiciIgKG9sZCksICJyIiAobmV3KSwgInIiIChwcmV2X21h
c2spIDogImNjIiwgImNjIik7IHJldHVybiBwcmV2ID4+IGJpdG9mZjsgfTsKCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHVuc2lnbmVkIGxvbmcKX19j
bXB4Y2hnX3UzMih2b2xhdGlsZSB1bnNpZ25lZCBpbnQgKnAsIHVuc2lnbmVkIGxvbmcgb2xk
LCB1bnNpZ25lZCBsb25nIG5ldykKewogdW5zaWduZWQgaW50IHByZXY7CgogX19hc21fXyBf
X3ZvbGF0aWxlX18gKAogIlxuIiAic3luYyIgIiAiICJcbiIKIjE6CWx3YXJ4CSUwLDAsJTIJ
CSMgX19jbXB4Y2hnX3UzMlxuCWNtcHcJMCwlMCwlM1xuCWJuZS0JMmZcbiIKCgoiCXN0d2N4
LgklNCwwLCUyXG4JYm5lLQkxYiIKCiAiXG4iICJzeW5jIiAiICIgIlxuIgogIlxuMjoiCgog
OiAiPSZyIiAocHJldiksICIrbSIgKCpwKQogOiAiciIgKHApLCAiciIgKG9sZCksICJyIiAo
bmV3KQogOiAiY2MiLCAibWVtb3J5Iik7CgogcmV0dXJuIHByZXY7Cn0KCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBf
X2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHVuc2lnbmVkIGxvbmcKX19jbXB4
Y2hnX3UzMl9sb2NhbCh2b2xhdGlsZSB1bnNpZ25lZCBpbnQgKnAsIHVuc2lnbmVkIGxvbmcg
b2xkLAogICB1bnNpZ25lZCBsb25nIG5ldykKewogdW5zaWduZWQgaW50IHByZXY7CgogX19h
c21fXyBfX3ZvbGF0aWxlX18gKAoiMToJbHdhcngJJTAsMCwlMgkJIyBfX2NtcHhjaGdfdTMy
XG4JY21wdwkwLCUwLCUzXG4JYm5lLQkyZlxuIgoKCiIJc3R3Y3guCSU0LDAsJTJcbglibmUt
CTFiIgoKICJcbjI6IgoKIDogIj0mciIgKHByZXYpLCAiK20iICgqcCkKIDogInIiIChwKSwg
InIiIChvbGQpLCAiciIgKG5ldykKIDogImNjIiwgIm1lbW9yeSIpOwoKIHJldHVybiBwcmV2
Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB1bnNp
Z25lZCBsb25nCl9fY21weGNoZ191MzJfcmVsYXhlZCh1MzIgKnAsIHVuc2lnbmVkIGxvbmcg
b2xkLCB1bnNpZ25lZCBsb25nIG5ldykKewogdW5zaWduZWQgbG9uZyBwcmV2OwoKIF9fYXNt
X18gX192b2xhdGlsZV9fICgKIjE6CWx3YXJ4CSUwLDAsJTIJCSMgX19jbXB4Y2hnX3UzMl9y
ZWxheGVkXG4iCiIJY21wdwkwLCUwLCUzXG4iCiIJYm5lLQkyZlxuIgoiCXN0d2N4LgklNCww
LCUyXG4iCiIJYm5lLQkxYlxuIgoiMjoiCiA6ICI9JnIiIChwcmV2KSwgIittIiAoKnApCiA6
ICJyIiAocCksICJyIiAob2xkKSwgInIiIChuZXcpCiA6ICJjYyIpOwoKIHJldHVybiBwcmV2
Owp9CiMgMjg1ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9jbXB4Y2hnLmgiCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHVuc2lnbmVkIGxvbmcK
X19jbXB4Y2hnX3UzMl9hY3F1aXJlKHUzMiAqcCwgdW5zaWduZWQgbG9uZyBvbGQsIHVuc2ln
bmVkIGxvbmcgbmV3KQp7CiB1bnNpZ25lZCBsb25nIHByZXY7CgogX19hc21fXyBfX3ZvbGF0
aWxlX18gKAoiMToJbHdhcngJJTAsMCwlMgkJIyBfX2NtcHhjaGdfdTMyX2FjcXVpcmVcbiIK
IgljbXB3CTAsJTAsJTNcbiIKIglibmUtCTJmXG4iCiIJc3R3Y3guCSU0LDAsJTJcbiIKIgli
bmUtCTFiXG4iCiAiXG4iICI5NzE6OyBpc3luYzsgOTcyOiAucHVzaHNlY3Rpb24gX19sd3N5
bmNfZml4dXAsXCJhXCI7IC5hbGlnbiAyOyA5NzM6IC44Ynl0ZSA5NzFiLTk3M2I7IC5wb3Bz
ZWN0aW9uOzsiICIgIgogIlxuIgoiMjoiCiA6ICI9JnIiIChwcmV2KSwgIittIiAoKnApCiA6
ICJyIiAocCksICJyIiAob2xkKSwgInIiIChuZXcpCiA6ICJjYyIsICJtZW1vcnkiKTsKCiBy
ZXR1cm4gcHJldjsKfQoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxp
bmVfXykpIHVuc2lnbmVkIGxvbmcKX19jbXB4Y2hnX3U2NCh2b2xhdGlsZSB1bnNpZ25lZCBs
b25nICpwLCB1bnNpZ25lZCBsb25nIG9sZCwgdW5zaWduZWQgbG9uZyBuZXcpCnsKIHVuc2ln
bmVkIGxvbmcgcHJldjsKCiBfX2FzbV9fIF9fdm9sYXRpbGVfXyAoCiAiXG4iICJzeW5jIiAi
ICIgIlxuIgoiMToJbGRhcngJJTAsMCwlMgkJIyBfX2NtcHhjaGdfdTY0XG4JY21wZAkwLCUw
LCUzXG4JYm5lLQkyZlxuCXN0ZGN4LgklNCwwLCUyXG4JYm5lLQkxYiIKCgoKCiAiXG4iICJz
eW5jIiAiICIgIlxuIgogIlxuMjoiCgogOiAiPSZyIiAocHJldiksICIrbSIgKCpwKQogOiAi
ciIgKHApLCAiciIgKG9sZCksICJyIiAobmV3KQogOiAiY2MiLCAibWVtb3J5Iik7CgogcmV0
dXJuIHByZXY7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVf
XykpIHVuc2lnbmVkIGxvbmcKX19jbXB4Y2hnX3U2NF9sb2NhbCh2b2xhdGlsZSB1bnNpZ25l
ZCBsb25nICpwLCB1bnNpZ25lZCBsb25nIG9sZCwKICAgdW5zaWduZWQgbG9uZyBuZXcpCnsK
IHVuc2lnbmVkIGxvbmcgcHJldjsKCiBfX2FzbV9fIF9fdm9sYXRpbGVfXyAoCiIxOglsZGFy
eAklMCwwLCUyCQkjIF9fY21weGNoZ191NjRcbgljbXBkCTAsJTAsJTNcbglibmUtCTJmXG4J
c3RkY3guCSU0LDAsJTJcbglibmUtCTFiIgoKCgoKICJcbjI6IgoKIDogIj0mciIgKHByZXYp
LCAiK20iICgqcCkKIDogInIiIChwKSwgInIiIChvbGQpLCAiciIgKG5ldykKIDogImNjIiwg
Im1lbW9yeSIpOwoKIHJldHVybiBwcmV2Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygo
X19hbHdheXNfaW5saW5lX18pKSB1bnNpZ25lZCBsb25nCl9fY21weGNoZ191NjRfcmVsYXhl
ZCh1NjQgKnAsIHVuc2lnbmVkIGxvbmcgb2xkLCB1bnNpZ25lZCBsb25nIG5ldykKewogdW5z
aWduZWQgbG9uZyBwcmV2OwoKIF9fYXNtX18gX192b2xhdGlsZV9fICgKIjE6CWxkYXJ4CSUw
LDAsJTIJCSMgX19jbXB4Y2hnX3U2NF9yZWxheGVkXG4iCiIJY21wZAkwLCUwLCUzXG4iCiIJ
Ym5lLQkyZlxuIgoiCXN0ZGN4LgklNCwwLCUyXG4iCiIJYm5lLQkxYlxuIgoiMjoiCiA6ICI9
JnIiIChwcmV2KSwgIittIiAoKnApCiA6ICJyIiAocCksICJyIiAob2xkKSwgInIiIChuZXcp
CiA6ICJjYyIpOwoKIHJldHVybiBwcmV2Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygo
X19hbHdheXNfaW5saW5lX18pKSB1bnNpZ25lZCBsb25nCl9fY21weGNoZ191NjRfYWNxdWly
ZSh1NjQgKnAsIHVuc2lnbmVkIGxvbmcgb2xkLCB1bnNpZ25lZCBsb25nIG5ldykKewogdW5z
aWduZWQgbG9uZyBwcmV2OwoKIF9fYXNtX18gX192b2xhdGlsZV9fICgKIjE6CWxkYXJ4CSUw
LDAsJTIJCSMgX19jbXB4Y2hnX3U2NF9hY3F1aXJlXG4iCiIJY21wZAkwLCUwLCUzXG4iCiIJ
Ym5lLQkyZlxuIgoiCXN0ZGN4LgklNCwwLCUyXG4iCiIJYm5lLQkxYlxuIgogIlxuIiAiOTcx
OjsgaXN5bmM7IDk3MjogLnB1c2hzZWN0aW9uIF9fbHdzeW5jX2ZpeHVwLFwiYVwiOyAuYWxp
Z24gMjsgOTczOiAuOGJ5dGUgOTcxYi05NzNiOyAucG9wc2VjdGlvbjs7IiAiICIKICJcbiIK
IjI6IgogOiAiPSZyIiAocHJldiksICIrbSIgKCpwKQogOiAiciIgKHApLCAiciIgKG9sZCks
ICJyIiAobmV3KQogOiAiY2MiLCAibWVtb3J5Iik7CgogcmV0dXJuIHByZXY7Cn0KCgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB1bnNpZ25lZCBsb25n
Cl9fY21weGNoZyh2b2xhdGlsZSB2b2lkICpwdHIsIHVuc2lnbmVkIGxvbmcgb2xkLCB1bnNp
Z25lZCBsb25nIG5ldywKICAgdW5zaWduZWQgaW50IHNpemUpCnsKIHN3aXRjaCAoc2l6ZSkg
ewogY2FzZSAxOgogIHJldHVybiBfX2NtcHhjaGdfdTgocHRyLCBvbGQsIG5ldyk7CiBjYXNl
IDI6CiAgcmV0dXJuIF9fY21weGNoZ191MTYocHRyLCBvbGQsIG5ldyk7CiBjYXNlIDQ6CiAg
cmV0dXJuIF9fY21weGNoZ191MzIocHRyLCBvbGQsIG5ldyk7CgogY2FzZSA4OgogIHJldHVy
biBfX2NtcHhjaGdfdTY0KHB0ciwgb2xkLCBuZXcpOwoKIH0KIGRvIHsgZXh0ZXJuIHZvaWQg
X19jb21waWxldGltZV9hc3NlcnRfMih2b2lkKSBfX2F0dHJpYnV0ZV9fKChfX2Vycm9yX18o
IlVuc3VwcG9ydGVkIHNpemUgZm9yIF9fY21weGNoZyIpKSk7IGlmICghKCEoMSkpKSBfX2Nv
bXBpbGV0aW1lX2Fzc2VydF8yKCk7IH0gd2hpbGUgKDApOwogcmV0dXJuIG9sZDsKfQoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgdW5zaWduZWQgbG9u
ZwpfX2NtcHhjaGdfbG9jYWwodm9pZCAqcHRyLCB1bnNpZ25lZCBsb25nIG9sZCwgdW5zaWdu
ZWQgbG9uZyBuZXcsCiAgIHVuc2lnbmVkIGludCBzaXplKQp7CiBzd2l0Y2ggKHNpemUpIHsK
IGNhc2UgMToKICByZXR1cm4gX19jbXB4Y2hnX3U4X2xvY2FsKHB0ciwgb2xkLCBuZXcpOwog
Y2FzZSAyOgogIHJldHVybiBfX2NtcHhjaGdfdTE2X2xvY2FsKHB0ciwgb2xkLCBuZXcpOwog
Y2FzZSA0OgogIHJldHVybiBfX2NtcHhjaGdfdTMyX2xvY2FsKHB0ciwgb2xkLCBuZXcpOwoK
IGNhc2UgODoKICByZXR1cm4gX19jbXB4Y2hnX3U2NF9sb2NhbChwdHIsIG9sZCwgbmV3KTsK
CiB9CiBkbyB7IGV4dGVybiB2b2lkIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzModm9pZCkgX19h
dHRyaWJ1dGVfXygoX19lcnJvcl9fKCJVbnN1cHBvcnRlZCBzaXplIGZvciBfX2NtcHhjaGdf
bG9jYWwiKSkpOyBpZiAoISghKDEpKSkgX19jb21waWxldGltZV9hc3NlcnRfMygpOyB9IHdo
aWxlICgwKTsKIHJldHVybiBvbGQ7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fs
d2F5c19pbmxpbmVfXykpIHVuc2lnbmVkIGxvbmcKX19jbXB4Y2hnX3JlbGF4ZWQodm9pZCAq
cHRyLCB1bnNpZ25lZCBsb25nIG9sZCwgdW5zaWduZWQgbG9uZyBuZXcsCiAgICB1bnNpZ25l
ZCBpbnQgc2l6ZSkKewogc3dpdGNoIChzaXplKSB7CiBjYXNlIDE6CiAgcmV0dXJuIF9fY21w
eGNoZ191OF9yZWxheGVkKHB0ciwgb2xkLCBuZXcpOwogY2FzZSAyOgogIHJldHVybiBfX2Nt
cHhjaGdfdTE2X3JlbGF4ZWQocHRyLCBvbGQsIG5ldyk7CiBjYXNlIDQ6CiAgcmV0dXJuIF9f
Y21weGNoZ191MzJfcmVsYXhlZChwdHIsIG9sZCwgbmV3KTsKCiBjYXNlIDg6CiAgcmV0dXJu
IF9fY21weGNoZ191NjRfcmVsYXhlZChwdHIsIG9sZCwgbmV3KTsKCiB9CiBkbyB7IGV4dGVy
biB2b2lkIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzQodm9pZCkgX19hdHRyaWJ1dGVfXygoX19l
cnJvcl9fKCJVbnN1cHBvcnRlZCBzaXplIGZvciBfX2NtcHhjaGdfcmVsYXhlZCIpKSk7IGlm
ICghKCEoMSkpKSBfX2NvbXBpbGV0aW1lX2Fzc2VydF80KCk7IH0gd2hpbGUgKDApOwogcmV0
dXJuIG9sZDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9f
KSkgdW5zaWduZWQgbG9uZwpfX2NtcHhjaGdfYWNxdWlyZSh2b2lkICpwdHIsIHVuc2lnbmVk
IGxvbmcgb2xkLCB1bnNpZ25lZCBsb25nIG5ldywKICAgIHVuc2lnbmVkIGludCBzaXplKQp7
CiBzd2l0Y2ggKHNpemUpIHsKIGNhc2UgMToKICByZXR1cm4gX19jbXB4Y2hnX3U4X2FjcXVp
cmUocHRyLCBvbGQsIG5ldyk7CiBjYXNlIDI6CiAgcmV0dXJuIF9fY21weGNoZ191MTZfYWNx
dWlyZShwdHIsIG9sZCwgbmV3KTsKIGNhc2UgNDoKICByZXR1cm4gX19jbXB4Y2hnX3UzMl9h
Y3F1aXJlKHB0ciwgb2xkLCBuZXcpOwoKIGNhc2UgODoKICByZXR1cm4gX19jbXB4Y2hnX3U2
NF9hY3F1aXJlKHB0ciwgb2xkLCBuZXcpOwoKIH0KIGRvIHsgZXh0ZXJuIHZvaWQgX19jb21w
aWxldGltZV9hc3NlcnRfNSh2b2lkKSBfX2F0dHJpYnV0ZV9fKChfX2Vycm9yX18oIlVuc3Vw
cG9ydGVkIHNpemUgZm9yIF9fY21weGNoZ19hY3F1aXJlIikpKTsgaWYgKCEoISgxKSkpIF9f
Y29tcGlsZXRpbWVfYXNzZXJ0XzUoKTsgfSB3aGlsZSAoMCk7CiByZXR1cm4gb2xkOwp9CiMg
MTIgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2F0b21pYy5oIiAyCiMgMjcgIi4vYXJj
aC9wb3dlcnBjL2luY2x1ZGUvYXNtL2F0b21pYy5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGF0b21pY19y
ZWFkKGNvbnN0IGF0b21pY190ICp2KQp7CiBpbnQgdDsKCiBfX2FzbV9fIF9fdm9sYXRpbGVf
XygibHd6JVUxJVgxICUwLCUxIiA6ICI9ciIodCkgOiAibSIodi0+Y291bnRlcikpOwoKIHJl
dHVybiB0Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBhdG9taWNfc2V0KGF0b21pY190ICp2LCBpbnQg
aSkKewogX19hc21fXyBfX3ZvbGF0aWxlX18oInN0dyVVMCVYMCAlMSwlMCIgOiAiPW0iKHYt
PmNvdW50ZXIpIDogInIiKGkpKTsKfQojIDk1ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2Fz
bS9hdG9taWMuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgYXRvbWljX2FkZChpbnQgYSwgYXRvbWljX3Qg
KnYpIHsgaW50IHQ7IF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJbHdhcngJJTAsMCwlMwkJ
IyBhdG9taWNfIiAiYWRkIiAiXG4iICJhZGQiICIgJTAsJTIsJTBcbiIgIglzdHdjeC4JJTAs
MCwlMyBcbiIgIglibmUtCTFiXG4iIDogIj0mciIgKHQpLCAiK20iICh2LT5jb3VudGVyKSA6
ICJyIiAoYSksICJyIiAoJnYtPmNvdW50ZXIpIDogImNjIik7IH0gc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBh
dG9taWNfYWRkX3JldHVybl9yZWxheGVkKGludCBhLCBhdG9taWNfdCAqdikgeyBpbnQgdDsg
X19hc21fXyBfX3ZvbGF0aWxlX18oICIxOglsd2FyeAklMCwwLCUzCQkjIGF0b21pY18iICJh
ZGQiICJfcmV0dXJuX3JlbGF4ZWRcbiIgImFkZCIgIiAlMCwlMiwlMFxuIiAiCXN0d2N4Lgkl
MCwwLCUzXG4iICIJYm5lLQkxYlxuIiA6ICI9JnIiICh0KSwgIittIiAodi0+Y291bnRlcikg
OiAiciIgKGEpLCAiciIgKCZ2LT5jb3VudGVyKSA6ICJjYyIpOyByZXR1cm4gdDsgfSBzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgaW50IGF0b21pY19mZXRjaF9hZGRfcmVsYXhlZChpbnQgYSwgYXRvbWljX3QgKnYp
IHsgaW50IHJlcywgdDsgX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOglsd2FyeAklMCwwLCU0
CQkjIGF0b21pY19mZXRjaF8iICJhZGQiICJfcmVsYXhlZFxuIiAiYWRkIiAiICUxLCUzLCUw
XG4iICIJc3R3Y3guCSUxLDAsJTRcbiIgIglibmUtCTFiXG4iIDogIj0mciIgKHJlcyksICI9
JnIiICh0KSwgIittIiAodi0+Y291bnRlcikgOiAiciIgKGEpLCAiciIgKCZ2LT5jb3VudGVy
KSA6ICJjYyIpOyByZXR1cm4gcmVzOyB9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGF0b21pY19zdWIoaW50
IGEsIGF0b21pY190ICp2KSB7IGludCB0OyBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CWx3
YXJ4CSUwLDAsJTMJCSMgYXRvbWljXyIgInN1YiIgIlxuIiAic3ViZiIgIiAlMCwlMiwlMFxu
IiAiCXN0d2N4LgklMCwwLCUzIFxuIiAiCWJuZS0JMWJcbiIgOiAiPSZyIiAodCksICIrbSIg
KHYtPmNvdW50ZXIpIDogInIiIChhKSwgInIiICgmdi0+Y291bnRlcikgOiAiY2MiKTsgfSBz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgaW50IGF0b21pY19zdWJfcmV0dXJuX3JlbGF4ZWQoaW50IGEsIGF0b21pY190
ICp2KSB7IGludCB0OyBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CWx3YXJ4CSUwLDAsJTMJ
CSMgYXRvbWljXyIgInN1YiIgIl9yZXR1cm5fcmVsYXhlZFxuIiAic3ViZiIgIiAlMCwlMiwl
MFxuIiAiCXN0d2N4LgklMCwwLCUzXG4iICIJYm5lLQkxYlxuIiA6ICI9JnIiICh0KSwgIitt
IiAodi0+Y291bnRlcikgOiAiciIgKGEpLCAiciIgKCZ2LT5jb3VudGVyKSA6ICJjYyIpOyBy
ZXR1cm4gdDsgfSBzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGF0b21pY19mZXRjaF9zdWJfcmVsYXhlZChpbnQg
YSwgYXRvbWljX3QgKnYpIHsgaW50IHJlcywgdDsgX19hc21fXyBfX3ZvbGF0aWxlX18oICIx
Oglsd2FyeAklMCwwLCU0CQkjIGF0b21pY19mZXRjaF8iICJzdWIiICJfcmVsYXhlZFxuIiAi
c3ViZiIgIiAlMSwlMywlMFxuIiAiCXN0d2N4LgklMSwwLCU0XG4iICIJYm5lLQkxYlxuIiA6
ICI9JnIiIChyZXMpLCAiPSZyIiAodCksICIrbSIgKHYtPmNvdW50ZXIpIDogInIiIChhKSwg
InIiICgmdi0+Y291bnRlcikgOiAiY2MiKTsgcmV0dXJuIHJlczsgfQojIDEwOSAiLi9hcmNo
L3Bvd2VycGMvaW5jbHVkZS9hc20vYXRvbWljLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGF0b21pY19h
bmQoaW50IGEsIGF0b21pY190ICp2KSB7IGludCB0OyBfX2FzbV9fIF9fdm9sYXRpbGVfXygg
IjE6CWx3YXJ4CSUwLDAsJTMJCSMgYXRvbWljXyIgImFuZCIgIlxuIiAiYW5kIiAiICUwLCUy
LCUwXG4iICIJc3R3Y3guCSUwLDAsJTMgXG4iICIJYm5lLQkxYlxuIiA6ICI9JnIiICh0KSwg
IittIiAodi0+Y291bnRlcikgOiAiciIgKGEpLCAiciIgKCZ2LT5jb3VudGVyKSA6ICJjYyIp
OyB9IHN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSBpbnQgYXRvbWljX2ZldGNoX2FuZF9yZWxheGVkKGludCBhLCBhdG9t
aWNfdCAqdikgeyBpbnQgcmVzLCB0OyBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CWx3YXJ4
CSUwLDAsJTQJCSMgYXRvbWljX2ZldGNoXyIgImFuZCIgIl9yZWxheGVkXG4iICJhbmQiICIg
JTEsJTMsJTBcbiIgIglzdHdjeC4JJTEsMCwlNFxuIiAiCWJuZS0JMWJcbiIgOiAiPSZyIiAo
cmVzKSwgIj0mciIgKHQpLCAiK20iICh2LT5jb3VudGVyKSA6ICJyIiAoYSksICJyIiAoJnYt
PmNvdW50ZXIpIDogImNjIik7IHJldHVybiByZXM7IH0Kc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgYXRvbWlj
X29yKGludCBhLCBhdG9taWNfdCAqdikgeyBpbnQgdDsgX19hc21fXyBfX3ZvbGF0aWxlX18o
ICIxOglsd2FyeAklMCwwLCUzCQkjIGF0b21pY18iICJvciIgIlxuIiAib3IiICIgJTAsJTIs
JTBcbiIgIglzdHdjeC4JJTAsMCwlMyBcbiIgIglibmUtCTFiXG4iIDogIj0mciIgKHQpLCAi
K20iICh2LT5jb3VudGVyKSA6ICJyIiAoYSksICJyIiAoJnYtPmNvdW50ZXIpIDogImNjIik7
IH0gc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIGludCBhdG9taWNfZmV0Y2hfb3JfcmVsYXhlZChpbnQgYSwgYXRvbWlj
X3QgKnYpIHsgaW50IHJlcywgdDsgX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOglsd2FyeAkl
MCwwLCU0CQkjIGF0b21pY19mZXRjaF8iICJvciIgIl9yZWxheGVkXG4iICJvciIgIiAlMSwl
MywlMFxuIiAiCXN0d2N4LgklMSwwLCU0XG4iICIJYm5lLQkxYlxuIiA6ICI9JnIiIChyZXMp
LCAiPSZyIiAodCksICIrbSIgKHYtPmNvdW50ZXIpIDogInIiIChhKSwgInIiICgmdi0+Y291
bnRlcikgOiAiY2MiKTsgcmV0dXJuIHJlczsgfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBhdG9taWNfeG9y
KGludCBhLCBhdG9taWNfdCAqdikgeyBpbnQgdDsgX19hc21fXyBfX3ZvbGF0aWxlX18oICIx
Oglsd2FyeAklMCwwLCUzCQkjIGF0b21pY18iICJ4b3IiICJcbiIgInhvciIgIiAlMCwlMiwl
MFxuIiAiCXN0d2N4LgklMCwwLCUzIFxuIiAiCWJuZS0JMWJcbiIgOiAiPSZyIiAodCksICIr
bSIgKHYtPmNvdW50ZXIpIDogInIiIChhKSwgInIiICgmdi0+Y291bnRlcikgOiAiY2MiKTsg
fSBzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgaW50IGF0b21pY19mZXRjaF94b3JfcmVsYXhlZChpbnQgYSwgYXRvbWlj
X3QgKnYpIHsgaW50IHJlcywgdDsgX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOglsd2FyeAkl
MCwwLCU0CQkjIGF0b21pY19mZXRjaF8iICJ4b3IiICJfcmVsYXhlZFxuIiAieG9yIiAiICUx
LCUzLCUwXG4iICIJc3R3Y3guCSUxLDAsJTRcbiIgIglibmUtCTFiXG4iIDogIj0mciIgKHJl
cyksICI9JnIiICh0KSwgIittIiAodi0+Y291bnRlcikgOiAiciIgKGEpLCAiciIgKCZ2LT5j
b3VudGVyKSA6ICJjYyIpOyByZXR1cm4gcmVzOyB9CiMgMTIyICIuL2FyY2gvcG93ZXJwYy9p
bmNsdWRlL2FzbS9hdG9taWMuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgYXRvbWljX2luYyhhdG9taWNf
dCAqdikKewogaW50IHQ7CgogX19hc21fXyBfX3ZvbGF0aWxlX18oCiIxOglsd2FyeAklMCww
LCUyCQkjIGF0b21pY19pbmNcbglhZGRpYwklMCwlMCwxXG4iCgoiCXN0d2N4LgklMCwwLCUy
IFxuCWJuZS0JMWIiCgogOiAiPSZyIiAodCksICIrbSIgKHYtPmNvdW50ZXIpCiA6ICJyIiAo
JnYtPmNvdW50ZXIpCiA6ICJjYyIsICJ4ZXIiKTsKfQoKCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgYXRvbWlj
X2luY19yZXR1cm5fcmVsYXhlZChhdG9taWNfdCAqdikKewogaW50IHQ7CgogX19hc21fXyBf
X3ZvbGF0aWxlX18oCiIxOglsd2FyeAklMCwwLCUyCQkjIGF0b21pY19pbmNfcmV0dXJuX3Jl
bGF4ZWRcbiIKIglhZGRpYwklMCwlMCwxXG4iCiIJc3R3Y3guCSUwLDAsJTJcbiIKIglibmUt
CTFiIgogOiAiPSZyIiAodCksICIrbSIgKHYtPmNvdW50ZXIpCiA6ICJyIiAoJnYtPmNvdW50
ZXIpCiA6ICJjYyIsICJ4ZXIiKTsKCiByZXR1cm4gdDsKfQoKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgYXRv
bWljX2RlYyhhdG9taWNfdCAqdikKewogaW50IHQ7CgogX19hc21fXyBfX3ZvbGF0aWxlX18o
CiIxOglsd2FyeAklMCwwLCUyCQkjIGF0b21pY19kZWNcbglhZGRpYwklMCwlMCwtMVxuIgoK
IglzdHdjeC4JJTAsMCwlMlxuCWJuZS0JMWIiCgogOiAiPSZyIiAodCksICIrbSIgKHYtPmNv
dW50ZXIpCiA6ICJyIiAoJnYtPmNvdW50ZXIpCiA6ICJjYyIsICJ4ZXIiKTsKfQoKCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBpbnQgYXRvbWljX2RlY19yZXR1cm5fcmVsYXhlZChhdG9taWNfdCAqdikKewogaW50
IHQ7CgogX19hc21fXyBfX3ZvbGF0aWxlX18oCiIxOglsd2FyeAklMCwwLCUyCQkjIGF0b21p
Y19kZWNfcmV0dXJuX3JlbGF4ZWRcbiIKIglhZGRpYwklMCwlMCwtMVxuIgoiCXN0d2N4Lgkl
MCwwLCUyXG4iCiIJYm5lLQkxYiIKIDogIj0mciIgKHQpLCAiK20iICh2LT5jb3VudGVyKQog
OiAiciIgKCZ2LT5jb3VudGVyKQogOiAiY2MiLCAieGVyIik7CgogcmV0dXJuIHQ7Cn0KIyAy
MDUgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2F0b21pYy5oIgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50
IGF0b21pY19mZXRjaF9hZGRfdW5sZXNzKGF0b21pY190ICp2LCBpbnQgYSwgaW50IHUpCnsK
IGludCB0OwoKIF9fYXNtX18gX192b2xhdGlsZV9fICgKICJcbiIgInN5bmMiICIgIiAiXG4i
CiIxOglsd2FyeAklMCwwLCUxCQkjIGF0b21pY19mZXRjaF9hZGRfdW5sZXNzXG4JY21wdwkw
LCUwLCUzIFxuCWJlcQkyZiBcbglhZGQJJTAsJTIsJTAgXG4iCgoKCiIJc3R3Y3guCSUwLDAs
JTEgXG4JYm5lLQkxYiBcbiIKCiAiXG4iICJzeW5jIiAiICIgIlxuIgoiCXN1YmYJJTAsJTIs
JTAgXG4yOiIKCiA6ICI9JnIiICh0KQogOiAiciIgKCZ2LT5jb3VudGVyKSwgInIiIChhKSwg
InIiICh1KQogOiAiY2MiLCAibWVtb3J5Iik7CgogcmV0dXJuIHQ7Cn0KIyAyMzUgIi4vYXJj
aC9wb3dlcnBjL2luY2x1ZGUvYXNtL2F0b21pYy5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGF0b21pY19p
bmNfbm90X3plcm8oYXRvbWljX3QgKnYpCnsKIGludCB0MSwgdDI7CgogX19hc21fXyBfX3Zv
bGF0aWxlX18gKAogIlxuIiAic3luYyIgIiAiICJcbiIKIjE6CWx3YXJ4CSUwLDAsJTIJCSMg
YXRvbWljX2luY19ub3RfemVyb1xuCWNtcHdpCTAsJTAsMFxuCWJlcS0JMmZcbglhZGRpYwkl
MSwlMCwxXG4iCgoKCiIJc3R3Y3guCSUxLDAsJTJcbglibmUtCTFiXG4iCgogIlxuIiAic3lu
YyIgIiAiICJcbiIKICJcbjI6IgoKIDogIj0mciIgKHQxKSwgIj0mciIgKHQyKQogOiAiciIg
KCZ2LT5jb3VudGVyKQogOiAiY2MiLCAieGVyIiwgIm1lbW9yeSIpOwoKIHJldHVybiB0MTsK
fQoKCgoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIGludCBhdG9taWNfZGVjX2lmX3Bvc2l0aXZlKGF0b21pY190
ICp2KQp7CiBpbnQgdDsKCiBfX2FzbV9fIF9fdm9sYXRpbGVfXygKICJcbiIgInN5bmMiICIg
IiAiXG4iCiIxOglsd2FyeAklMCwwLCUxCQkjIGF0b21pY19kZWNfaWZfcG9zaXRpdmVcbglj
bXB3aQklMCwxXG4JYWRkaQklMCwlMCwtMVxuCWJsdC0JMmZcbiIKCgoKIglzdHdjeC4JJTAs
MCwlMVxuCWJuZS0JMWIiCgogIlxuIiAic3luYyIgIiAiICJcbiIKICJcbjI6IgogICAgOiAi
PSZiIiAodCkKIDogInIiICgmdi0+Y291bnRlcikKIDogImNjIiwgIm1lbW9yeSIpOwoKIHJl
dHVybiB0Owp9CgoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzNjQgYXRvbWljNjRfcmVhZChjb25zdCBhdG9t
aWM2NF90ICp2KQp7CiBzNjQgdDsKCiBfX2FzbV9fIF9fdm9sYXRpbGVfXygibGQlVTElWDEg
JTAsJTEiIDogIj1yIih0KSA6ICJtIih2LT5jb3VudGVyKSk7CgogcmV0dXJuIHQ7Cn0KCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSB2b2lkIGF0b21pYzY0X3NldChhdG9taWM2NF90ICp2LCBzNjQgaSkKewogX19h
c21fXyBfX3ZvbGF0aWxlX18oInN0ZCVVMCVYMCAlMSwlMCIgOiAiPW0iKHYtPmNvdW50ZXIp
IDogInIiKGkpKTsKfQojIDM1OSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vYXRvbWlj
LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSB2b2lkIGF0b21pYzY0X2FkZChzNjQgYSwgYXRvbWljNjRfdCAqdikg
eyBzNjQgdDsgX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOglsZGFyeAklMCwwLCUzCQkjIGF0
b21pYzY0XyIgImFkZCIgIlxuIiAiYWRkIiAiICUwLCUyLCUwXG4iICIJc3RkY3guCSUwLDAs
JTMgXG4iICIJYm5lLQkxYlxuIiA6ICI9JnIiICh0KSwgIittIiAodi0+Y291bnRlcikgOiAi
ciIgKGEpLCAiciIgKCZ2LT5jb3VudGVyKSA6ICJjYyIpOyB9IHN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzNjQgYXRv
bWljNjRfYWRkX3JldHVybl9yZWxheGVkKHM2NCBhLCBhdG9taWM2NF90ICp2KSB7IHM2NCB0
OyBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CWxkYXJ4CSUwLDAsJTMJCSMgYXRvbWljNjRf
IiAiYWRkIiAiX3JldHVybl9yZWxheGVkXG4iICJhZGQiICIgJTAsJTIsJTBcbiIgIglzdGRj
eC4JJTAsMCwlM1xuIiAiCWJuZS0JMWJcbiIgOiAiPSZyIiAodCksICIrbSIgKHYtPmNvdW50
ZXIpIDogInIiIChhKSwgInIiICgmdi0+Y291bnRlcikgOiAiY2MiKTsgcmV0dXJuIHQ7IH0g
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIHM2NCBhdG9taWM2NF9mZXRjaF9hZGRfcmVsYXhlZChzNjQgYSwgYXRvbWlj
NjRfdCAqdikgeyBzNjQgcmVzLCB0OyBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CWxkYXJ4
CSUwLDAsJTQJCSMgYXRvbWljNjRfZmV0Y2hfIiAiYWRkIiAiX3JlbGF4ZWRcbiIgImFkZCIg
IiAlMSwlMywlMFxuIiAiCXN0ZGN4LgklMSwwLCU0XG4iICIJYm5lLQkxYlxuIiA6ICI9JnIi
IChyZXMpLCAiPSZyIiAodCksICIrbSIgKHYtPmNvdW50ZXIpIDogInIiIChhKSwgInIiICgm
di0+Y291bnRlcikgOiAiY2MiKTsgcmV0dXJuIHJlczsgfQpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBhdG9t
aWM2NF9zdWIoczY0IGEsIGF0b21pYzY0X3QgKnYpIHsgczY0IHQ7IF9fYXNtX18gX192b2xh
dGlsZV9fKCAiMToJbGRhcngJJTAsMCwlMwkJIyBhdG9taWM2NF8iICJzdWIiICJcbiIgInN1
YmYiICIgJTAsJTIsJTBcbiIgIglzdGRjeC4JJTAsMCwlMyBcbiIgIglibmUtCTFiXG4iIDog
Ij0mciIgKHQpLCAiK20iICh2LT5jb3VudGVyKSA6ICJyIiAoYSksICJyIiAoJnYtPmNvdW50
ZXIpIDogImNjIik7IH0gc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHM2NCBhdG9taWM2NF9zdWJfcmV0dXJuX3JlbGF4
ZWQoczY0IGEsIGF0b21pYzY0X3QgKnYpIHsgczY0IHQ7IF9fYXNtX18gX192b2xhdGlsZV9f
KCAiMToJbGRhcngJJTAsMCwlMwkJIyBhdG9taWM2NF8iICJzdWIiICJfcmV0dXJuX3JlbGF4
ZWRcbiIgInN1YmYiICIgJTAsJTIsJTBcbiIgIglzdGRjeC4JJTAsMCwlM1xuIiAiCWJuZS0J
MWJcbiIgOiAiPSZyIiAodCksICIrbSIgKHYtPmNvdW50ZXIpIDogInIiIChhKSwgInIiICgm
di0+Y291bnRlcikgOiAiY2MiKTsgcmV0dXJuIHQ7IH0gc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHM2NCBhdG9taWM2
NF9mZXRjaF9zdWJfcmVsYXhlZChzNjQgYSwgYXRvbWljNjRfdCAqdikgeyBzNjQgcmVzLCB0
OyBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CWxkYXJ4CSUwLDAsJTQJCSMgYXRvbWljNjRf
ZmV0Y2hfIiAic3ViIiAiX3JlbGF4ZWRcbiIgInN1YmYiICIgJTEsJTMsJTBcbiIgIglzdGRj
eC4JJTEsMCwlNFxuIiAiCWJuZS0JMWJcbiIgOiAiPSZyIiAocmVzKSwgIj0mciIgKHQpLCAi
K20iICh2LT5jb3VudGVyKSA6ICJyIiAoYSksICJyIiAoJnYtPmNvdW50ZXIpIDogImNjIik7
IHJldHVybiByZXM7IH0KIyAzNzMgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2F0b21p
Yy5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgdm9pZCBhdG9taWM2NF9hbmQoczY0IGEsIGF0b21pYzY0X3QgKnYp
IHsgczY0IHQ7IF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJbGRhcngJJTAsMCwlMwkJIyBh
dG9taWM2NF8iICJhbmQiICJcbiIgImFuZCIgIiAlMCwlMiwlMFxuIiAiCXN0ZGN4LgklMCww
LCUzIFxuIiAiCWJuZS0JMWJcbiIgOiAiPSZyIiAodCksICIrbSIgKHYtPmNvdW50ZXIpIDog
InIiIChhKSwgInIiICgmdi0+Y291bnRlcikgOiAiY2MiKTsgfSBzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgczY0IGF0
b21pYzY0X2ZldGNoX2FuZF9yZWxheGVkKHM2NCBhLCBhdG9taWM2NF90ICp2KSB7IHM2NCBy
ZXMsIHQ7IF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJbGRhcngJJTAsMCwlNAkJIyBhdG9t
aWM2NF9mZXRjaF8iICJhbmQiICJfcmVsYXhlZFxuIiAiYW5kIiAiICUxLCUzLCUwXG4iICIJ
c3RkY3guCSUxLDAsJTRcbiIgIglibmUtCTFiXG4iIDogIj0mciIgKHJlcyksICI9JnIiICh0
KSwgIittIiAodi0+Y291bnRlcikgOiAiciIgKGEpLCAiciIgKCZ2LT5jb3VudGVyKSA6ICJj
YyIpOyByZXR1cm4gcmVzOyB9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGF0b21pYzY0X29yKHM2NCBhLCBh
dG9taWM2NF90ICp2KSB7IHM2NCB0OyBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CWxkYXJ4
CSUwLDAsJTMJCSMgYXRvbWljNjRfIiAib3IiICJcbiIgIm9yIiAiICUwLCUyLCUwXG4iICIJ
c3RkY3guCSUwLDAsJTMgXG4iICIJYm5lLQkxYlxuIiA6ICI9JnIiICh0KSwgIittIiAodi0+
Y291bnRlcikgOiAiciIgKGEpLCAiciIgKCZ2LT5jb3VudGVyKSA6ICJjYyIpOyB9IHN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBzNjQgYXRvbWljNjRfZmV0Y2hfb3JfcmVsYXhlZChzNjQgYSwgYXRvbWljNjRfdCAq
dikgeyBzNjQgcmVzLCB0OyBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CWxkYXJ4CSUwLDAs
JTQJCSMgYXRvbWljNjRfZmV0Y2hfIiAib3IiICJfcmVsYXhlZFxuIiAib3IiICIgJTEsJTMs
JTBcbiIgIglzdGRjeC4JJTEsMCwlNFxuIiAiCWJuZS0JMWJcbiIgOiAiPSZyIiAocmVzKSwg
Ij0mciIgKHQpLCAiK20iICh2LT5jb3VudGVyKSA6ICJyIiAoYSksICJyIiAoJnYtPmNvdW50
ZXIpIDogImNjIik7IHJldHVybiByZXM7IH0Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgYXRvbWljNjRfeG9y
KHM2NCBhLCBhdG9taWM2NF90ICp2KSB7IHM2NCB0OyBfX2FzbV9fIF9fdm9sYXRpbGVfXygg
IjE6CWxkYXJ4CSUwLDAsJTMJCSMgYXRvbWljNjRfIiAieG9yIiAiXG4iICJ4b3IiICIgJTAs
JTIsJTBcbiIgIglzdGRjeC4JJTAsMCwlMyBcbiIgIglibmUtCTFiXG4iIDogIj0mciIgKHQp
LCAiK20iICh2LT5jb3VudGVyKSA6ICJyIiAoYSksICJyIiAoJnYtPmNvdW50ZXIpIDogImNj
Iik7IH0gc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIHM2NCBhdG9taWM2NF9mZXRjaF94b3JfcmVsYXhlZChzNjQgYSwg
YXRvbWljNjRfdCAqdikgeyBzNjQgcmVzLCB0OyBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6
CWxkYXJ4CSUwLDAsJTQJCSMgYXRvbWljNjRfZmV0Y2hfIiAieG9yIiAiX3JlbGF4ZWRcbiIg
InhvciIgIiAlMSwlMywlMFxuIiAiCXN0ZGN4LgklMSwwLCU0XG4iICIJYm5lLQkxYlxuIiA6
ICI9JnIiIChyZXMpLCAiPSZyIiAodCksICIrbSIgKHYtPmNvdW50ZXIpIDogInIiIChhKSwg
InIiICgmdi0+Y291bnRlcikgOiAiY2MiKTsgcmV0dXJuIHJlczsgfQojIDM4NiAiLi9hcmNo
L3Bvd2VycGMvaW5jbHVkZS9hc20vYXRvbWljLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGF0b21pYzY0
X2luYyhhdG9taWM2NF90ICp2KQp7CiBzNjQgdDsKCiBfX2FzbV9fIF9fdm9sYXRpbGVfXygK
IjE6CWxkYXJ4CSUwLDAsJTIJCSMgYXRvbWljNjRfaW5jXG4JYWRkaWMJJTAsJTAsMVxuCXN0
ZGN4LgklMCwwLCUyIFxuCWJuZS0JMWIiCgoKCiA6ICI9JnIiICh0KSwgIittIiAodi0+Y291
bnRlcikKIDogInIiICgmdi0+Y291bnRlcikKIDogImNjIiwgInhlciIpOwp9CgoKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIHM2NCBhdG9taWM2NF9pbmNfcmV0dXJuX3JlbGF4ZWQoYXRvbWljNjRfdCAqdikKewog
czY0IHQ7CgogX19hc21fXyBfX3ZvbGF0aWxlX18oCiIxOglsZGFyeAklMCwwLCUyCQkjIGF0
b21pYzY0X2luY19yZXR1cm5fcmVsYXhlZFxuIgoiCWFkZGljCSUwLCUwLDFcbiIKIglzdGRj
eC4JJTAsMCwlMlxuIgoiCWJuZS0JMWIiCiA6ICI9JnIiICh0KSwgIittIiAodi0+Y291bnRl
cikKIDogInIiICgmdi0+Y291bnRlcikKIDogImNjIiwgInhlciIpOwoKIHJldHVybiB0Owp9
CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgdm9pZCBhdG9taWM2NF9kZWMoYXRvbWljNjRfdCAqdikKewogczY0IHQ7
CgogX19hc21fXyBfX3ZvbGF0aWxlX18oCiIxOglsZGFyeAklMCwwLCUyCQkjIGF0b21pYzY0
X2RlY1xuCWFkZGljCSUwLCUwLC0xXG4Jc3RkY3guCSUwLDAsJTJcbglibmUtCTFiIgoKCgog
OiAiPSZyIiAodCksICIrbSIgKHYtPmNvdW50ZXIpCiA6ICJyIiAoJnYtPmNvdW50ZXIpCiA6
ICJjYyIsICJ4ZXIiKTsKfQoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzNjQgYXRvbWljNjRfZGVjX3JldHVybl9y
ZWxheGVkKGF0b21pYzY0X3QgKnYpCnsKIHM2NCB0OwoKIF9fYXNtX18gX192b2xhdGlsZV9f
KAoiMToJbGRhcngJJTAsMCwlMgkJIyBhdG9taWM2NF9kZWNfcmV0dXJuX3JlbGF4ZWRcbiIK
IglhZGRpYwklMCwlMCwtMVxuIgoiCXN0ZGN4LgklMCwwLCUyXG4iCiIJYm5lLQkxYiIKIDog
Ij0mciIgKHQpLCAiK20iICh2LT5jb3VudGVyKQogOiAiciIgKCZ2LT5jb3VudGVyKQogOiAi
Y2MiLCAieGVyIik7CgogcmV0dXJuIHQ7Cn0KIyA0NTUgIi4vYXJjaC9wb3dlcnBjL2luY2x1
ZGUvYXNtL2F0b21pYy5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgczY0IGF0b21pYzY0X2RlY19pZl9wb3NpdGl2
ZShhdG9taWM2NF90ICp2KQp7CiBzNjQgdDsKCiBfX2FzbV9fIF9fdm9sYXRpbGVfXygKICJc
biIgInN5bmMiICIgIiAiXG4iCiIxOglsZGFyeAklMCwwLCUxCQkjIGF0b21pYzY0X2RlY19p
Zl9wb3NpdGl2ZVxuCWFkZGljLgklMCwlMCwtMVxuCWJsdC0JMmZcbglzdGRjeC4JJTAsMCwl
MVxuCWJuZS0JMWIiCgoKCgogIlxuIiAic3luYyIgIiAiICJcbiIKICJcbjI6IgogICAgOiAi
PSZyIiAodCkKIDogInIiICgmdi0+Y291bnRlcikKIDogImNjIiwgInhlciIsICJtZW1vcnki
KTsKCiByZXR1cm4gdDsKfQojIDQ5NCAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vYXRv
bWljLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSBzNjQgYXRvbWljNjRfZmV0Y2hfYWRkX3VubGVzcyhhdG9taWM2
NF90ICp2LCBzNjQgYSwgczY0IHUpCnsKIHM2NCB0OwoKIF9fYXNtX18gX192b2xhdGlsZV9f
ICgKICJcbiIgInN5bmMiICIgIiAiXG4iCiIxOglsZGFyeAklMCwwLCUxCQkjIGF0b21pYzY0
X2ZldGNoX2FkZF91bmxlc3NcbgljbXBkCTAsJTAsJTMgXG4JYmVxCTJmIFxuCWFkZAklMCwl
MiwlMCBcbiIKCgoKIglzdGRjeC4JJTAsMCwlMSBcbglibmUtCTFiIFxuIgoKICJcbiIgInN5
bmMiICIgIiAiXG4iCiIJc3ViZgklMCwlMiwlMCBcbjI6IgoKIDogIj0mciIgKHQpCiA6ICJy
IiAoJnYtPmNvdW50ZXIpLCAiciIgKGEpLCAiciIgKHUpCiA6ICJjYyIsICJtZW1vcnkiKTsK
CiByZXR1cm4gdDsKfQojIDUyNCAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vYXRvbWlj
LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSBpbnQgYXRvbWljNjRfaW5jX25vdF96ZXJvKGF0b21pYzY0X3QgKnYp
CnsKIHM2NCB0MSwgdDI7CgogX19hc21fXyBfX3ZvbGF0aWxlX18gKAogIlxuIiAic3luYyIg
IiAiICJcbiIKIjE6CWxkYXJ4CSUwLDAsJTIJCSMgYXRvbWljNjRfaW5jX25vdF96ZXJvXG4J
Y21wZGkJMCwlMCwwXG4JYmVxLQkyZlxuCWFkZGljCSUxLCUwLDFcbglzdGRjeC4JJTEsMCwl
MlxuCWJuZS0JMWJcbiIKCgoKCgogIlxuIiAic3luYyIgIiAiICJcbiIKICJcbjI6IgoKIDog
Ij0mciIgKHQxKSwgIj0mciIgKHQyKQogOiAiciIgKCZ2LT5jb3VudGVyKQogOiAiY2MiLCAi
eGVyIiwgIm1lbW9yeSIpOwoKIHJldHVybiB0MSAhPSAwOwp9CiMgMzIgIi4vYXJjaC9wb3dl
cnBjL2luY2x1ZGUvYXNtL3BhY2EuaCIgMgojIDEgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUv
YXNtL3J0YXMtdHlwZXMuaCIgMQoKCgoKIyAxICIuL2luY2x1ZGUvbGludXgvc3BpbmxvY2tf
dHlwZXMuaCIgMQojIDEzICIuL2luY2x1ZGUvbGludXgvc3BpbmxvY2tfdHlwZXMuaCIKIyAx
ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9zcGlubG9ja190eXBlcy5oIiAxCiMgOSAi
Li9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vc3BpbmxvY2tfdHlwZXMuaCIKdHlwZWRlZiBz
dHJ1Y3Qgewogdm9sYXRpbGUgdW5zaWduZWQgaW50IHNsb2NrOwp9IGFyY2hfc3BpbmxvY2tf
dDsKCgoKdHlwZWRlZiBzdHJ1Y3Qgewogdm9sYXRpbGUgc2lnbmVkIGludCBsb2NrOwp9IGFy
Y2hfcndsb2NrX3Q7CiMgMTQgIi4vaW5jbHVkZS9saW51eC9zcGlubG9ja190eXBlcy5oIiAy
CgoKCgojIDEgIi4vaW5jbHVkZS9saW51eC9sb2NrZGVwLmgiIDEKIyAxMyAiLi9pbmNsdWRl
L2xpbnV4L2xvY2tkZXAuaCIKc3RydWN0IHRhc2tfc3RydWN0OwpzdHJ1Y3QgbG9ja2RlcF9t
YXA7CgoKZXh0ZXJuIGludCBwcm92ZV9sb2NraW5nOwpleHRlcm4gaW50IGxvY2tfc3RhdDsK
CgoKCgplbnVtIGxvY2tkZXBfd2FpdF90eXBlIHsKIExEX1dBSVRfSU5WID0gMCwKCiBMRF9X
QUlUX0ZSRUUsCiBMRF9XQUlUX1NQSU4sCgoKCgogTERfV0FJVF9DT05GSUcgPSBMRF9XQUlU
X1NQSU4sCgogTERfV0FJVF9TTEVFUCwKCiBMRF9XQUlUX01BWCwKfTsKIyA0NzcgIi4vaW5j
bHVkZS9saW51eC9sb2NrZGVwLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGxvY2tkZXBfaW5pdF90YXNr
KHN0cnVjdCB0YXNrX3N0cnVjdCAqdGFzaykKewp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBsb2NrZGVw
X29mZih2b2lkKQp7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGxvY2tkZXBfb24odm9pZCkKewp9Cgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgdm9pZCBsb2NrZGVwX3NldF9zZWxmdGVzdF90YXNrKHN0cnVjdCB0YXNrX3N0
cnVjdCAqdGFzaykKewp9CiMgNTI2ICIuL2luY2x1ZGUvbGludXgvbG9ja2RlcC5oIgpzdHJ1
Y3QgbG9ja19jbGFzc19rZXkgeyB9OwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgbG9ja2RlcF9yZWdpc3Rl
cl9rZXkoc3RydWN0IGxvY2tfY2xhc3Nfa2V5ICprZXkpCnsKfQoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQg
bG9ja2RlcF91bnJlZ2lzdGVyX2tleShzdHJ1Y3QgbG9ja19jbGFzc19rZXkgKmtleSkKewp9
CgoKCgpzdHJ1Y3QgbG9ja2RlcF9tYXAgeyB9OwojIDU1MiAiLi9pbmNsdWRlL2xpbnV4L2xv
Y2tkZXAuaCIKc3RydWN0IHBpbl9jb29raWUgeyB9OwojIDU2MiAiLi9pbmNsdWRlL2xpbnV4
L2xvY2tkZXAuaCIKZW51bSB4aGxvY2tfY29udGV4dF90IHsKIFhITE9DS19IQVJELAogWEhM
T0NLX1NPRlQsCiBYSExPQ0tfQ1RYX05SLAp9OwojIDU3NiAiLi9pbmNsdWRlL2xpbnV4L2xv
Y2tkZXAuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgbG9ja2RlcF9pbnZhcmlhbnRfc3RhdGUoYm9vbCBm
b3JjZSkge30Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgbG9ja2RlcF9mcmVlX3Rhc2soc3RydWN0IHRhc2tf
c3RydWN0ICp0YXNrKSB7fQojIDYzOCAiLi9pbmNsdWRlL2xpbnV4L2xvY2tkZXAuaCIKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIHZvaWQgcHJpbnRfaXJxdHJhY2VfZXZlbnRzKHN0cnVjdCB0YXNrX3N0cnVjdCAq
Y3VycikKewp9CiMgNzUxICIuL2luY2x1ZGUvbGludXgvbG9ja2RlcC5oIgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
dm9pZApsb2NrZGVwX3JjdV9zdXNwaWNpb3VzKGNvbnN0IGNoYXIgKmZpbGUsIGNvbnN0IGlu
dCBsaW5lLCBjb25zdCBjaGFyICpzKQp7Cn0KIyAxOSAiLi9pbmNsdWRlL2xpbnV4L3NwaW5s
b2NrX3R5cGVzLmgiIDIKCnR5cGVkZWYgc3RydWN0IHJhd19zcGlubG9jayB7CiBhcmNoX3Nw
aW5sb2NrX3QgcmF3X2xvY2s7CgoKCgoKCgp9IHJhd19zcGlubG9ja190OwojIDcxICIuL2lu
Y2x1ZGUvbGludXgvc3BpbmxvY2tfdHlwZXMuaCIKdHlwZWRlZiBzdHJ1Y3Qgc3BpbmxvY2sg
ewogdW5pb24gewogIHN0cnVjdCByYXdfc3BpbmxvY2sgcmxvY2s7CiMgODIgIi4vaW5jbHVk
ZS9saW51eC9zcGlubG9ja190eXBlcy5oIgogfTsKfSBzcGlubG9ja190OwojIDk5ICIuL2lu
Y2x1ZGUvbGludXgvc3BpbmxvY2tfdHlwZXMuaCIKIyAxICIuL2luY2x1ZGUvbGludXgvcnds
b2NrX3R5cGVzLmgiIDEKIyAxMSAiLi9pbmNsdWRlL2xpbnV4L3J3bG9ja190eXBlcy5oIgp0
eXBlZGVmIHN0cnVjdCB7CiBhcmNoX3J3bG9ja190IHJhd19sb2NrOwoKCgoKCgoKfSByd2xv
Y2tfdDsKIyAxMDAgIi4vaW5jbHVkZS9saW51eC9zcGlubG9ja190eXBlcy5oIiAyCiMgNiAi
Li9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vcnRhcy10eXBlcy5oIiAyCgp0eXBlZGVmIF9f
YmUzMiBydGFzX2FyZ190OwoKc3RydWN0IHJ0YXNfYXJncyB7CiBfX2JlMzIgdG9rZW47CiBf
X2JlMzIgbmFyZ3M7CiBfX2JlMzIgbnJldDsKIHJ0YXNfYXJnX3QgYXJnc1sxNl07CiBydGFz
X2FyZ190ICpyZXRzOwp9OwoKc3RydWN0IHJ0YXNfdCB7CiB1bnNpZ25lZCBsb25nIGVudHJ5
OwogdW5zaWduZWQgbG9uZyBiYXNlOwogdW5zaWduZWQgbG9uZyBzaXplOwogYXJjaF9zcGlu
bG9ja190IGxvY2s7CiBzdHJ1Y3QgcnRhc19hcmdzIGFyZ3M7CiBzdHJ1Y3QgZGV2aWNlX25v
ZGUgKmRldjsKfTsKCnN0cnVjdCBydGFzX3N1c3BlbmRfbWVfZGF0YSB7CiBhdG9taWNfdCB3
b3JraW5nOwogYXRvbWljX3QgZG9uZTsKIGludCB0b2tlbjsKIGF0b21pY190IGVycm9yOwog
c3RydWN0IGNvbXBsZXRpb24gKmNvbXBsZXRlOwp9OwoKc3RydWN0IHJ0YXNfZXJyb3JfbG9n
IHsKCiB1OCBieXRlMDsKCgogdTggYnl0ZTE7CiMgNDggIi4vYXJjaC9wb3dlcnBjL2luY2x1
ZGUvYXNtL3J0YXMtdHlwZXMuaCIKIHU4IGJ5dGUyOwoKCgoKIHU4IGJ5dGUzOwogX19iZTMy
IGV4dGVuZGVkX2xvZ19sZW5ndGg7CiB1bnNpZ25lZCBjaGFyIGJ1ZmZlclsxXTsKCn07CgoK
CgpzdHJ1Y3QgcnRhc19leHRfZXZlbnRfbG9nX3Y2IHsKCiB1OCBieXRlMDsKIyA3NyAiLi9h
cmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vcnRhcy10eXBlcy5oIgogdTggYnl0ZTE7CgoKIHU4
IGJ5dGUyOwoKCgoKCgoKIHU4IGJ5dGUzOwoKIHU4IHJlc2VydmVkWzhdOwoKIF9fYmUzMiBj
b21wYW55X2lkOwoKCgogdTggdmVuZG9yX2xvZ1sxXTsKCn07CgoKc3RydWN0IHBzZXJpZXNf
ZXJyb3Jsb2cgewogX19iZTE2IGlkOwogX19iZTE2IGxlbmd0aDsKIHU4IHZlcnNpb247CiB1
OCBzdWJ0eXBlOwogX19iZTE2IGNyZWF0b3JfY29tcG9uZW50OwogdTggZGF0YVtdOwp9OwoK
CnN0cnVjdCBwc2VyaWVzX2hwX2Vycm9ybG9nIHsKIHU4IHJlc291cmNlOwogdTggYWN0aW9u
OwogdTggaWRfdHlwZTsKIHU4IHJlc2VydmVkOwogdW5pb24gewogIF9fYmUzMiBkcmNfaW5k
ZXg7CiAgX19iZTMyIGRyY19jb3VudDsKICBzdHJ1Y3QgeyBfX2JlMzIgY291bnQsIGluZGV4
OyB9IGljOwogIGNoYXIgZHJjX25hbWVbMV07CiB9IF9kcmNfdTsKfTsKIyAzMyAiLi9hcmNo
L3Bvd2VycGMvaW5jbHVkZS9hc20vcGFjYS5oIiAyCgojIDEgIi4vaW5jbHVkZS9hc20tZ2Vu
ZXJpYy9tbWlvd2JfdHlwZXMuaCIgMQoKCgoKCgpzdHJ1Y3QgbW1pb3diX3N0YXRlIHsKIHUx
NiBuZXN0aW5nX2NvdW50OwogdTE2IG1taW93Yl9wZW5kaW5nOwp9OwojIDM1ICIuL2FyY2gv
cG93ZXJwYy9pbmNsdWRlL2FzbS9wYWNhLmgiIDIKCnJlZ2lzdGVyIHN0cnVjdCBwYWNhX3N0
cnVjdCAqbG9jYWxfcGFjYSBhc20oInIxMyIpOwojIDU1ICIuL2FyY2gvcG93ZXJwYy9pbmNs
dWRlL2FzbS9wYWNhLmgiCnN0cnVjdCB0YXNrX3N0cnVjdDsKCgoKCgoKCnN0cnVjdCBwYWNh
X3N0cnVjdCB7CiMgODIgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL3BhY2EuaCIKIHUx
NiBsb2NrX3Rva2VuOwogdTE2IHBhY2FfaW5kZXg7CgoKCgoKIHU2NCBrZXJuZWxfdG9jOwog
dTY0IGtlcm5lbGJhc2U7CiB1NjQga2VybmVsX21zcjsKIHZvaWQgKmVtZXJnZW5jeV9zcDsK
IHU2NCBkYXRhX29mZnNldDsKIHMxNiBod19jcHVfaWQ7CiB1OCBjcHVfc3RhcnQ7CgogdTgg
a2V4ZWNfc3RhdGU7CgoKCgoKIHU2NCBkc2NyX2RlZmF1bHQ7CiMgMTI2ICIuL2FyY2gvcG93
ZXJwYy9pbmNsdWRlL2FzbS9wYWNhLmgiCiB1NjQgZXhnZW5bOF0gX19hdHRyaWJ1dGVfXygo
X19hbGlnbmVkX18oMHg0MCkpKTsKCiBwZ2RfdCAqcGdkIF9fYXR0cmlidXRlX18oKF9fYWxp
Z25lZF9fKDB4NDApKSk7CiBwZ2RfdCAqa2VybmVsX3BnZDsKCgogc3RydWN0IHRsYl9jb3Jl
X2RhdGEgKnRjZF9wdHI7CgoKCgoKIHU2NCBleHRsYlsxMl1bKDEzICogOCkgLyBzaXplb2Yo
dTY0KV07CiB1NjQgZXhtY1s4XTsKIHU2NCBleGNyaXRbOF07CiB1NjQgZXhkYmdbOF07CgoK
IHZvaWQgKm1jX2tzdGFjazsKIHZvaWQgKmNyaXRfa3N0YWNrOwogdm9pZCAqZGJnX2tzdGFj
azsKCiBzdHJ1Y3QgdGxiX2NvcmVfZGF0YSB0Y2Q7CiMgMTY2ICIuL2FyY2gvcG93ZXJwYy9p
bmNsdWRlL2FzbS9wYWNhLmgiCiBzdHJ1Y3QgdGFza19zdHJ1Y3QgKl9fY3VycmVudDsKIHU2
NCBrc3RhY2s7CiB1NjQgc2F2ZWRfcjE7CiB1NjQgc2F2ZWRfbXNyOwoKIHUxNiB0cmFwX3Nh
dmU7CgogdTggaXJxX3NvZnRfbWFzazsKIHU4IGlycV9oYXBwZW5lZDsKIHU4IGlycV93b3Jr
X3BlbmRpbmc7CgoKCiB1NjQgc3ByZ192ZHNvOwojIDIyOSAiLi9hcmNoL3Bvd2VycGMvaW5j
bHVkZS9hc20vcGFjYS5oIgogdTggZnRyYWNlX2VuYWJsZWQ7CgoKIHN0cnVjdCBjcHVfYWNj
b3VudGluZ19kYXRhIGFjY291bnRpbmc7CiB1NjQgZHRsX3JpZHg7CiBzdHJ1Y3QgZHRsX2Vu
dHJ5ICpkdGxfY3VycjsKIyAyNzMgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL3BhY2Eu
aCIKIHN0cnVjdCBtbWlvd2Jfc3RhdGUgbW1pb3diX3N0YXRlOwoKfSBfX2F0dHJpYnV0ZV9f
KChfX2FsaWduZWRfXygoMSA8PCA2KSkpKTsKCmV4dGVybiB2b2lkIGNvcHlfbW1fdG9fcGFj
YShzdHJ1Y3QgbW1fc3RydWN0ICptbSk7CmV4dGVybiBzdHJ1Y3QgcGFjYV9zdHJ1Y3QgKipw
YWNhX3B0cnM7CmV4dGVybiB2b2lkIGluaXRpYWxpc2VfcGFjYShzdHJ1Y3QgcGFjYV9zdHJ1
Y3QgKm5ld19wYWNhLCBpbnQgY3B1KTsKZXh0ZXJuIHZvaWQgc2V0dXBfcGFjYShzdHJ1Y3Qg
cGFjYV9zdHJ1Y3QgKm5ld19wYWNhKTsKZXh0ZXJuIHZvaWQgYWxsb2NhdGVfcGFjYV9wdHJz
KHZvaWQpOwpleHRlcm4gdm9pZCBhbGxvY2F0ZV9wYWNhKGludCBjcHUpOwpleHRlcm4gdm9p
ZCBmcmVlX3VudXNlZF9wYWNhcyh2b2lkKTsKIyAxNCAiLi9hcmNoL3Bvd2VycGMvaW5jbHVk
ZS9hc20vY3VycmVudC5oIiAyCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IHRhc2tfc3RydWN0ICpnZXRf
Y3VycmVudCh2b2lkKQp7CiBzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRhc2s7CgoKIGFzbSAoImxk
ICUwLCUxKDEzKSIKIDogIj1yIiAodGFzaykKIDogImkiIChfX2J1aWx0aW5fb2Zmc2V0b2Yo
c3RydWN0IHBhY2Ffc3RydWN0LCBfX2N1cnJlbnQpKSk7CgogcmV0dXJuIHRhc2s7Cn0KIyAx
MyAiLi9pbmNsdWRlL2xpbnV4L3NjaGVkLmgiIDIKCiMgMSAiLi9pbmNsdWRlL2xpbnV4L3Bp
ZC5oIiAxCgoKCgojIDEgIi4vaW5jbHVkZS9saW51eC9yY3VsaXN0LmgiIDEKIyAxMCAiLi9p
bmNsdWRlL2xpbnV4L3JjdWxpc3QuaCIKIyAxICIuL2luY2x1ZGUvbGludXgvbGlzdC5oIiAx
CgoKCgoKCiMgMSAiLi9pbmNsdWRlL2xpbnV4L3BvaXNvbi5oIiAxCiMgOCAiLi9pbmNsdWRl
L2xpbnV4L2xpc3QuaCIgMgojIDMzICIuL2luY2x1ZGUvbGludXgvbGlzdC5oIgpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgdm9pZCBJTklUX0xJU1RfSEVBRChzdHJ1Y3QgbGlzdF9oZWFkICpsaXN0KQp7CiBkbyB7
IGRvIHsgZXh0ZXJuIHZvaWQgX19jb21waWxldGltZV9hc3NlcnRfNih2b2lkKSBfX2F0dHJp
YnV0ZV9fKChfX2Vycm9yX18oIlVuc3VwcG9ydGVkIGFjY2VzcyBzaXplIGZvciB7UkVBRCxX
UklURX1fT05DRSgpLiIpKSk7IGlmICghKChzaXplb2YobGlzdC0+bmV4dCkgPT0gc2l6ZW9m
KGNoYXIpIHx8IHNpemVvZihsaXN0LT5uZXh0KSA9PSBzaXplb2Yoc2hvcnQpIHx8IHNpemVv
ZihsaXN0LT5uZXh0KSA9PSBzaXplb2YoaW50KSB8fCBzaXplb2YobGlzdC0+bmV4dCkgPT0g
c2l6ZW9mKGxvbmcpKSB8fCBzaXplb2YobGlzdC0+bmV4dCkgPT0gc2l6ZW9mKGxvbmcgbG9u
ZykpKSBfX2NvbXBpbGV0aW1lX2Fzc2VydF82KCk7IH0gd2hpbGUgKDApOyBkbyB7ICoodm9s
YXRpbGUgdHlwZW9mKGxpc3QtPm5leHQpICopJihsaXN0LT5uZXh0KSA9IChsaXN0KTsgfSB3
aGlsZSAoMCk7IH0gd2hpbGUgKDApOwogbGlzdC0+cHJldiA9IGxpc3Q7Cn0KCgoKCgoKCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSBib29sIF9fbGlzdF9hZGRfdmFsaWQoc3RydWN0IGxpc3RfaGVhZCAqbmV3LAog
ICAgc3RydWN0IGxpc3RfaGVhZCAqcHJldiwKICAgIHN0cnVjdCBsaXN0X2hlYWQgKm5leHQp
CnsKIHJldHVybiB0cnVlOwp9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIF9fbGlzdF9kZWxfZW50cnlfdmFs
aWQoc3RydWN0IGxpc3RfaGVhZCAqZW50cnkpCnsKIHJldHVybiB0cnVlOwp9CiMgNjMgIi4v
aW5jbHVkZS9saW51eC9saXN0LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIF9fbGlzdF9hZGQoc3RydWN0
IGxpc3RfaGVhZCAqbmV3LAogICAgICAgICBzdHJ1Y3QgbGlzdF9oZWFkICpwcmV2LAogICAg
ICAgICBzdHJ1Y3QgbGlzdF9oZWFkICpuZXh0KQp7CiBpZiAoIV9fbGlzdF9hZGRfdmFsaWQo
bmV3LCBwcmV2LCBuZXh0KSkKICByZXR1cm47CgogbmV4dC0+cHJldiA9IG5ldzsKIG5ldy0+
bmV4dCA9IG5leHQ7CiBuZXctPnByZXYgPSBwcmV2OwogZG8geyBkbyB7IGV4dGVybiB2b2lk
IF9fY29tcGlsZXRpbWVfYXNzZXJ0Xzcodm9pZCkgX19hdHRyaWJ1dGVfXygoX19lcnJvcl9f
KCJVbnN1cHBvcnRlZCBhY2Nlc3Mgc2l6ZSBmb3Ige1JFQUQsV1JJVEV9X09OQ0UoKS4iKSkp
OyBpZiAoISgoc2l6ZW9mKHByZXYtPm5leHQpID09IHNpemVvZihjaGFyKSB8fCBzaXplb2Yo
cHJldi0+bmV4dCkgPT0gc2l6ZW9mKHNob3J0KSB8fCBzaXplb2YocHJldi0+bmV4dCkgPT0g
c2l6ZW9mKGludCkgfHwgc2l6ZW9mKHByZXYtPm5leHQpID09IHNpemVvZihsb25nKSkgfHwg
c2l6ZW9mKHByZXYtPm5leHQpID09IHNpemVvZihsb25nIGxvbmcpKSkgX19jb21waWxldGlt
ZV9hc3NlcnRfNygpOyB9IHdoaWxlICgwKTsgZG8geyAqKHZvbGF0aWxlIHR5cGVvZihwcmV2
LT5uZXh0KSAqKSYocHJldi0+bmV4dCkgPSAobmV3KTsgfSB3aGlsZSAoMCk7IH0gd2hpbGUg
KDApOwp9CiMgODQgIi4vaW5jbHVkZS9saW51eC9saXN0LmgiCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGxp
c3RfYWRkKHN0cnVjdCBsaXN0X2hlYWQgKm5ldywgc3RydWN0IGxpc3RfaGVhZCAqaGVhZCkK
ewogX19saXN0X2FkZChuZXcsIGhlYWQsIGhlYWQtPm5leHQpOwp9CiMgOTggIi4vaW5jbHVk
ZS9saW51eC9saXN0LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGxpc3RfYWRkX3RhaWwoc3RydWN0IGxp
c3RfaGVhZCAqbmV3LCBzdHJ1Y3QgbGlzdF9oZWFkICpoZWFkKQp7CiBfX2xpc3RfYWRkKG5l
dywgaGVhZC0+cHJldiwgaGVhZCk7Cn0KIyAxMTAgIi4vaW5jbHVkZS9saW51eC9saXN0Lmgi
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSB2b2lkIF9fbGlzdF9kZWwoc3RydWN0IGxpc3RfaGVhZCAqIHByZXYsIHN0
cnVjdCBsaXN0X2hlYWQgKiBuZXh0KQp7CiBuZXh0LT5wcmV2ID0gcHJldjsKIGRvIHsgZG8g
eyBleHRlcm4gdm9pZCBfX2NvbXBpbGV0aW1lX2Fzc2VydF84KHZvaWQpIF9fYXR0cmlidXRl
X18oKF9fZXJyb3JfXygiVW5zdXBwb3J0ZWQgYWNjZXNzIHNpemUgZm9yIHtSRUFELFdSSVRF
fV9PTkNFKCkuIikpKTsgaWYgKCEoKHNpemVvZihwcmV2LT5uZXh0KSA9PSBzaXplb2YoY2hh
cikgfHwgc2l6ZW9mKHByZXYtPm5leHQpID09IHNpemVvZihzaG9ydCkgfHwgc2l6ZW9mKHBy
ZXYtPm5leHQpID09IHNpemVvZihpbnQpIHx8IHNpemVvZihwcmV2LT5uZXh0KSA9PSBzaXpl
b2YobG9uZykpIHx8IHNpemVvZihwcmV2LT5uZXh0KSA9PSBzaXplb2YobG9uZyBsb25nKSkp
IF9fY29tcGlsZXRpbWVfYXNzZXJ0XzgoKTsgfSB3aGlsZSAoMCk7IGRvIHsgKih2b2xhdGls
ZSB0eXBlb2YocHJldi0+bmV4dCkgKikmKHByZXYtPm5leHQpID0gKG5leHQpOyB9IHdoaWxl
ICgwKTsgfSB3aGlsZSAoMCk7Cn0KIyAxMjQgIi4vaW5jbHVkZS9saW51eC9saXN0LmgiCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSB2b2lkIF9fbGlzdF9kZWxfY2xlYXJwcmV2KHN0cnVjdCBsaXN0X2hlYWQgKmVu
dHJ5KQp7CiBfX2xpc3RfZGVsKGVudHJ5LT5wcmV2LCBlbnRyeS0+bmV4dCk7CiBlbnRyeS0+
cHJldiA9ICgodm9pZCAqKTApOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBfX2xpc3RfZGVsX2VudHJ5
KHN0cnVjdCBsaXN0X2hlYWQgKmVudHJ5KQp7CiBpZiAoIV9fbGlzdF9kZWxfZW50cnlfdmFs
aWQoZW50cnkpKQogIHJldHVybjsKCiBfX2xpc3RfZGVsKGVudHJ5LT5wcmV2LCBlbnRyeS0+
bmV4dCk7Cn0KCgoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGxpc3RfZGVsKHN0cnVjdCBsaXN0X2hl
YWQgKmVudHJ5KQp7CiBfX2xpc3RfZGVsX2VudHJ5KGVudHJ5KTsKIGVudHJ5LT5uZXh0ID0g
KCh2b2lkICopIDB4MTAwICsgKDB4NWRlYWRiZWVmMDAwMDAwMFVMKSk7CiBlbnRyeS0+cHJl
diA9ICgodm9pZCAqKSAweDEyMiArICgweDVkZWFkYmVlZjAwMDAwMDBVTCkpOwp9CiMgMTU4
ICIuL2luY2x1ZGUvbGludXgvbGlzdC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBsaXN0X3JlcGxhY2Uo
c3RydWN0IGxpc3RfaGVhZCAqb2xkLAogICAgc3RydWN0IGxpc3RfaGVhZCAqbmV3KQp7CiBu
ZXctPm5leHQgPSBvbGQtPm5leHQ7CiBuZXctPm5leHQtPnByZXYgPSBuZXc7CiBuZXctPnBy
ZXYgPSBvbGQtPnByZXY7CiBuZXctPnByZXYtPm5leHQgPSBuZXc7Cn0KIyAxNzQgIi4vaW5j
bHVkZS9saW51eC9saXN0LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGxpc3RfcmVwbGFjZV9pbml0KHN0
cnVjdCBsaXN0X2hlYWQgKm9sZCwKICAgICAgICAgc3RydWN0IGxpc3RfaGVhZCAqbmV3KQp7
CiBsaXN0X3JlcGxhY2Uob2xkLCBuZXcpOwogSU5JVF9MSVNUX0hFQUQob2xkKTsKfQoKCgoK
CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgdm9pZCBsaXN0X3N3YXAoc3RydWN0IGxpc3RfaGVhZCAqZW50cnkxLAog
ICAgICAgIHN0cnVjdCBsaXN0X2hlYWQgKmVudHJ5MikKewogc3RydWN0IGxpc3RfaGVhZCAq
cG9zID0gZW50cnkyLT5wcmV2OwoKIGxpc3RfZGVsKGVudHJ5Mik7CiBsaXN0X3JlcGxhY2Uo
ZW50cnkxLCBlbnRyeTIpOwogaWYgKHBvcyA9PSBlbnRyeTEpCiAgcG9zID0gZW50cnkyOwog
bGlzdF9hZGQoZW50cnkxLCBwb3MpOwp9CgoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgbGlzdF9kZWxf
aW5pdChzdHJ1Y3QgbGlzdF9oZWFkICplbnRyeSkKewogX19saXN0X2RlbF9lbnRyeShlbnRy
eSk7CiBJTklUX0xJU1RfSEVBRChlbnRyeSk7Cn0KCgoKCgoKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgbGlz
dF9tb3ZlKHN0cnVjdCBsaXN0X2hlYWQgKmxpc3QsIHN0cnVjdCBsaXN0X2hlYWQgKmhlYWQp
CnsKIF9fbGlzdF9kZWxfZW50cnkobGlzdCk7CiBsaXN0X2FkZChsaXN0LCBoZWFkKTsKfQoK
CgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgdm9pZCBsaXN0X21vdmVfdGFpbChzdHJ1Y3QgbGlzdF9oZWFkICps
aXN0LAogICAgICBzdHJ1Y3QgbGlzdF9oZWFkICpoZWFkKQp7CiBfX2xpc3RfZGVsX2VudHJ5
KGxpc3QpOwogbGlzdF9hZGRfdGFpbChsaXN0LCBoZWFkKTsKfQojIDI0MCAiLi9pbmNsdWRl
L2xpbnV4L2xpc3QuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgbGlzdF9idWxrX21vdmVfdGFpbChzdHJ1
Y3QgbGlzdF9oZWFkICpoZWFkLAogICAgICAgICAgIHN0cnVjdCBsaXN0X2hlYWQgKmZpcnN0
LAogICAgICAgICAgIHN0cnVjdCBsaXN0X2hlYWQgKmxhc3QpCnsKIGZpcnN0LT5wcmV2LT5u
ZXh0ID0gbGFzdC0+bmV4dDsKIGxhc3QtPm5leHQtPnByZXYgPSBmaXJzdC0+cHJldjsKCiBo
ZWFkLT5wcmV2LT5uZXh0ID0gZmlyc3Q7CiBmaXJzdC0+cHJldiA9IGhlYWQtPnByZXY7Cgog
bGFzdC0+bmV4dCA9IGhlYWQ7CiBoZWFkLT5wcmV2ID0gbGFzdDsKfQoKCgoKCgpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgaW50IGxpc3RfaXNfZmlyc3QoY29uc3Qgc3RydWN0IGxpc3RfaGVhZCAqbGlzdCwKICAg
ICBjb25zdCBzdHJ1Y3QgbGlzdF9oZWFkICpoZWFkKQp7CiByZXR1cm4gbGlzdC0+cHJldiA9
PSBoZWFkOwp9CgoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgbGlzdF9pc19sYXN0KGNvbnN0IHN0cnVj
dCBsaXN0X2hlYWQgKmxpc3QsCiAgICBjb25zdCBzdHJ1Y3QgbGlzdF9oZWFkICpoZWFkKQp7
CiByZXR1cm4gbGlzdC0+bmV4dCA9PSBoZWFkOwp9CgoKCgoKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBsaXN0
X2VtcHR5KGNvbnN0IHN0cnVjdCBsaXN0X2hlYWQgKmhlYWQpCnsKIHJldHVybiAoeyBkbyB7
IGV4dGVybiB2b2lkIF9fY29tcGlsZXRpbWVfYXNzZXJ0Xzkodm9pZCkgX19hdHRyaWJ1dGVf
XygoX19lcnJvcl9fKCJVbnN1cHBvcnRlZCBhY2Nlc3Mgc2l6ZSBmb3Ige1JFQUQsV1JJVEV9
X09OQ0UoKS4iKSkpOyBpZiAoISgoc2l6ZW9mKGhlYWQtPm5leHQpID09IHNpemVvZihjaGFy
KSB8fCBzaXplb2YoaGVhZC0+bmV4dCkgPT0gc2l6ZW9mKHNob3J0KSB8fCBzaXplb2YoaGVh
ZC0+bmV4dCkgPT0gc2l6ZW9mKGludCkgfHwgc2l6ZW9mKGhlYWQtPm5leHQpID09IHNpemVv
Zihsb25nKSkgfHwgc2l6ZW9mKGhlYWQtPm5leHQpID09IHNpemVvZihsb25nIGxvbmcpKSkg
X19jb21waWxldGltZV9hc3NlcnRfOSgpOyB9IHdoaWxlICgwKTsgKHsgdHlwZW9mKCBfR2Vu
ZXJpYygoaGVhZC0+bmV4dCksIGNoYXI6IChjaGFyKTAsIHVuc2lnbmVkIGNoYXI6ICh1bnNp
Z25lZCBjaGFyKTAsIHNpZ25lZCBjaGFyOiAoc2lnbmVkIGNoYXIpMCwgdW5zaWduZWQgc2hv
cnQ6ICh1bnNpZ25lZCBzaG9ydCkwLCBzaWduZWQgc2hvcnQ6IChzaWduZWQgc2hvcnQpMCwg
dW5zaWduZWQgaW50OiAodW5zaWduZWQgaW50KTAsIHNpZ25lZCBpbnQ6IChzaWduZWQgaW50
KTAsIHVuc2lnbmVkIGxvbmc6ICh1bnNpZ25lZCBsb25nKTAsIHNpZ25lZCBsb25nOiAoc2ln
bmVkIGxvbmcpMCwgdW5zaWduZWQgbG9uZyBsb25nOiAodW5zaWduZWQgbG9uZyBsb25nKTAs
IHNpZ25lZCBsb25nIGxvbmc6IChzaWduZWQgbG9uZyBsb25nKTAsIGRlZmF1bHQ6IChoZWFk
LT5uZXh0KSkpIF9feCA9ICgqKGNvbnN0IHZvbGF0aWxlIHR5cGVvZiggX0dlbmVyaWMoKGhl
YWQtPm5leHQpLCBjaGFyOiAoY2hhcikwLCB1bnNpZ25lZCBjaGFyOiAodW5zaWduZWQgY2hh
cikwLCBzaWduZWQgY2hhcjogKHNpZ25lZCBjaGFyKTAsIHVuc2lnbmVkIHNob3J0OiAodW5z
aWduZWQgc2hvcnQpMCwgc2lnbmVkIHNob3J0OiAoc2lnbmVkIHNob3J0KTAsIHVuc2lnbmVk
IGludDogKHVuc2lnbmVkIGludCkwLCBzaWduZWQgaW50OiAoc2lnbmVkIGludCkwLCB1bnNp
Z25lZCBsb25nOiAodW5zaWduZWQgbG9uZykwLCBzaWduZWQgbG9uZzogKHNpZ25lZCBsb25n
KTAsIHVuc2lnbmVkIGxvbmcgbG9uZzogKHVuc2lnbmVkIGxvbmcgbG9uZykwLCBzaWduZWQg
bG9uZyBsb25nOiAoc2lnbmVkIGxvbmcgbG9uZykwLCBkZWZhdWx0OiAoaGVhZC0+bmV4dCkp
KSAqKSYoaGVhZC0+bmV4dCkpOyBkbyB7IH0gd2hpbGUgKDApOyAodHlwZW9mKGhlYWQtPm5l
eHQpKV9feDsgfSk7IH0pID09IGhlYWQ7Cn0KIyAyOTggIi4vaW5jbHVkZS9saW51eC9saXN0
LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSBpbnQgbGlzdF9lbXB0eV9jYXJlZnVsKGNvbnN0IHN0cnVjdCBsaXN0
X2hlYWQgKmhlYWQpCnsKIHN0cnVjdCBsaXN0X2hlYWQgKm5leHQgPSBoZWFkLT5uZXh0Owog
cmV0dXJuIChuZXh0ID09IGhlYWQpICYmIChuZXh0ID09IGhlYWQtPnByZXYpOwp9CgoKCgoK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIHZvaWQgbGlzdF9yb3RhdGVfbGVmdChzdHJ1Y3QgbGlzdF9oZWFkICpoZWFk
KQp7CiBzdHJ1Y3QgbGlzdF9oZWFkICpmaXJzdDsKCiBpZiAoIWxpc3RfZW1wdHkoaGVhZCkp
IHsKICBmaXJzdCA9IGhlYWQtPm5leHQ7CiAgbGlzdF9tb3ZlX3RhaWwoZmlyc3QsIGhlYWQp
OwogfQp9CiMgMzI1ICIuL2luY2x1ZGUvbGludXgvbGlzdC5oIgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBs
aXN0X3JvdGF0ZV90b19mcm9udChzdHJ1Y3QgbGlzdF9oZWFkICpsaXN0LAogICAgIHN0cnVj
dCBsaXN0X2hlYWQgKmhlYWQpCnsKCgoKCgogbGlzdF9tb3ZlX3RhaWwoaGVhZCwgbGlzdCk7
Cn0KCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgaW50IGxpc3RfaXNfc2luZ3VsYXIoY29uc3Qgc3RydWN0IGxp
c3RfaGVhZCAqaGVhZCkKewogcmV0dXJuICFsaXN0X2VtcHR5KGhlYWQpICYmIChoZWFkLT5u
ZXh0ID09IGhlYWQtPnByZXYpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBfX2xpc3RfY3V0X3Bvc2l0
aW9uKHN0cnVjdCBsaXN0X2hlYWQgKmxpc3QsCiAgc3RydWN0IGxpc3RfaGVhZCAqaGVhZCwg
c3RydWN0IGxpc3RfaGVhZCAqZW50cnkpCnsKIHN0cnVjdCBsaXN0X2hlYWQgKm5ld19maXJz
dCA9IGVudHJ5LT5uZXh0OwogbGlzdC0+bmV4dCA9IGhlYWQtPm5leHQ7CiBsaXN0LT5uZXh0
LT5wcmV2ID0gbGlzdDsKIGxpc3QtPnByZXYgPSBlbnRyeTsKIGVudHJ5LT5uZXh0ID0gbGlz
dDsKIGhlYWQtPm5leHQgPSBuZXdfZmlyc3Q7CiBuZXdfZmlyc3QtPnByZXYgPSBoZWFkOwp9
CiMgMzcxICIuL2luY2x1ZGUvbGludXgvbGlzdC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBsaXN0X2N1
dF9wb3NpdGlvbihzdHJ1Y3QgbGlzdF9oZWFkICpsaXN0LAogIHN0cnVjdCBsaXN0X2hlYWQg
KmhlYWQsIHN0cnVjdCBsaXN0X2hlYWQgKmVudHJ5KQp7CiBpZiAobGlzdF9lbXB0eShoZWFk
KSkKICByZXR1cm47CiBpZiAobGlzdF9pc19zaW5ndWxhcihoZWFkKSAmJgogIChoZWFkLT5u
ZXh0ICE9IGVudHJ5ICYmIGhlYWQgIT0gZW50cnkpKQogIHJldHVybjsKIGlmIChlbnRyeSA9
PSBoZWFkKQogIElOSVRfTElTVF9IRUFEKGxpc3QpOwogZWxzZQogIF9fbGlzdF9jdXRfcG9z
aXRpb24obGlzdCwgaGVhZCwgZW50cnkpOwp9CiMgMzk5ICIuL2luY2x1ZGUvbGludXgvbGlz
dC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgdm9pZCBsaXN0X2N1dF9iZWZvcmUoc3RydWN0IGxpc3RfaGVhZCAq
bGlzdCwKICAgICAgIHN0cnVjdCBsaXN0X2hlYWQgKmhlYWQsCiAgICAgICBzdHJ1Y3QgbGlz
dF9oZWFkICplbnRyeSkKewogaWYgKGhlYWQtPm5leHQgPT0gZW50cnkpIHsKICBJTklUX0xJ
U1RfSEVBRChsaXN0KTsKICByZXR1cm47CiB9CiBsaXN0LT5uZXh0ID0gaGVhZC0+bmV4dDsK
IGxpc3QtPm5leHQtPnByZXYgPSBsaXN0OwogbGlzdC0+cHJldiA9IGVudHJ5LT5wcmV2Owog
bGlzdC0+cHJldi0+bmV4dCA9IGxpc3Q7CiBoZWFkLT5uZXh0ID0gZW50cnk7CiBlbnRyeS0+
cHJldiA9IGhlYWQ7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIF9fbGlzdF9zcGxpY2UoY29uc3Qgc3Ry
dWN0IGxpc3RfaGVhZCAqbGlzdCwKICAgICBzdHJ1Y3QgbGlzdF9oZWFkICpwcmV2LAogICAg
IHN0cnVjdCBsaXN0X2hlYWQgKm5leHQpCnsKIHN0cnVjdCBsaXN0X2hlYWQgKmZpcnN0ID0g
bGlzdC0+bmV4dDsKIHN0cnVjdCBsaXN0X2hlYWQgKmxhc3QgPSBsaXN0LT5wcmV2OwoKIGZp
cnN0LT5wcmV2ID0gcHJldjsKIHByZXYtPm5leHQgPSBmaXJzdDsKCiBsYXN0LT5uZXh0ID0g
bmV4dDsKIG5leHQtPnByZXYgPSBsYXN0Owp9CgoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGxpc3Rf
c3BsaWNlKGNvbnN0IHN0cnVjdCBsaXN0X2hlYWQgKmxpc3QsCiAgICBzdHJ1Y3QgbGlzdF9o
ZWFkICpoZWFkKQp7CiBpZiAoIWxpc3RfZW1wdHkobGlzdCkpCiAgX19saXN0X3NwbGljZShs
aXN0LCBoZWFkLCBoZWFkLT5uZXh0KTsKfQoKCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBsaXN0X3Nw
bGljZV90YWlsKHN0cnVjdCBsaXN0X2hlYWQgKmxpc3QsCiAgICBzdHJ1Y3QgbGlzdF9oZWFk
ICpoZWFkKQp7CiBpZiAoIWxpc3RfZW1wdHkobGlzdCkpCiAgX19saXN0X3NwbGljZShsaXN0
LCBoZWFkLT5wcmV2LCBoZWFkKTsKfQojIDQ2MCAiLi9pbmNsdWRlL2xpbnV4L2xpc3QuaCIK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIHZvaWQgbGlzdF9zcGxpY2VfaW5pdChzdHJ1Y3QgbGlzdF9oZWFkICpsaXN0
LAogICAgICAgIHN0cnVjdCBsaXN0X2hlYWQgKmhlYWQpCnsKIGlmICghbGlzdF9lbXB0eShs
aXN0KSkgewogIF9fbGlzdF9zcGxpY2UobGlzdCwgaGVhZCwgaGVhZC0+bmV4dCk7CiAgSU5J
VF9MSVNUX0hFQUQobGlzdCk7CiB9Cn0KIyA0NzcgIi4vaW5jbHVkZS9saW51eC9saXN0Lmgi
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSB2b2lkIGxpc3Rfc3BsaWNlX3RhaWxfaW5pdChzdHJ1Y3QgbGlzdF9oZWFk
ICpsaXN0LAogICAgICBzdHJ1Y3QgbGlzdF9oZWFkICpoZWFkKQp7CiBpZiAoIWxpc3RfZW1w
dHkobGlzdCkpIHsKICBfX2xpc3Rfc3BsaWNlKGxpc3QsIGhlYWQtPnByZXYsIGhlYWQpOwog
IElOSVRfTElTVF9IRUFEKGxpc3QpOwogfQp9CiMgNzY1ICIuL2luY2x1ZGUvbGludXgvbGlz
dC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgdm9pZCBJTklUX0hMSVNUX05PREUoc3RydWN0IGhsaXN0X25vZGUg
KmgpCnsKIGgtPm5leHQgPSAoKHZvaWQgKikwKTsKIGgtPnBwcmV2ID0gKCh2b2lkICopMCk7
Cn0KIyA3NzkgIi4vaW5jbHVkZS9saW51eC9saXN0LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgaGxpc3Rf
dW5oYXNoZWQoY29uc3Qgc3RydWN0IGhsaXN0X25vZGUgKmgpCnsKIHJldHVybiAhaC0+cHBy
ZXY7Cn0KIyA3OTIgIi4vaW5jbHVkZS9saW51eC9saXN0LmgiCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgaGxp
c3RfdW5oYXNoZWRfbG9ja2xlc3MoY29uc3Qgc3RydWN0IGhsaXN0X25vZGUgKmgpCnsKIHJl
dHVybiAhKHsgZG8geyBleHRlcm4gdm9pZCBfX2NvbXBpbGV0aW1lX2Fzc2VydF8xMCh2b2lk
KSBfX2F0dHJpYnV0ZV9fKChfX2Vycm9yX18oIlVuc3VwcG9ydGVkIGFjY2VzcyBzaXplIGZv
ciB7UkVBRCxXUklURX1fT05DRSgpLiIpKSk7IGlmICghKChzaXplb2YoaC0+cHByZXYpID09
IHNpemVvZihjaGFyKSB8fCBzaXplb2YoaC0+cHByZXYpID09IHNpemVvZihzaG9ydCkgfHwg
c2l6ZW9mKGgtPnBwcmV2KSA9PSBzaXplb2YoaW50KSB8fCBzaXplb2YoaC0+cHByZXYpID09
IHNpemVvZihsb25nKSkgfHwgc2l6ZW9mKGgtPnBwcmV2KSA9PSBzaXplb2YobG9uZyBsb25n
KSkpIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzEwKCk7IH0gd2hpbGUgKDApOyAoeyB0eXBlb2Yo
IF9HZW5lcmljKChoLT5wcHJldiksIGNoYXI6IChjaGFyKTAsIHVuc2lnbmVkIGNoYXI6ICh1
bnNpZ25lZCBjaGFyKTAsIHNpZ25lZCBjaGFyOiAoc2lnbmVkIGNoYXIpMCwgdW5zaWduZWQg
c2hvcnQ6ICh1bnNpZ25lZCBzaG9ydCkwLCBzaWduZWQgc2hvcnQ6IChzaWduZWQgc2hvcnQp
MCwgdW5zaWduZWQgaW50OiAodW5zaWduZWQgaW50KTAsIHNpZ25lZCBpbnQ6IChzaWduZWQg
aW50KTAsIHVuc2lnbmVkIGxvbmc6ICh1bnNpZ25lZCBsb25nKTAsIHNpZ25lZCBsb25nOiAo
c2lnbmVkIGxvbmcpMCwgdW5zaWduZWQgbG9uZyBsb25nOiAodW5zaWduZWQgbG9uZyBsb25n
KTAsIHNpZ25lZCBsb25nIGxvbmc6IChzaWduZWQgbG9uZyBsb25nKTAsIGRlZmF1bHQ6ICho
LT5wcHJldikpKSBfX3ggPSAoKihjb25zdCB2b2xhdGlsZSB0eXBlb2YoIF9HZW5lcmljKCho
LT5wcHJldiksIGNoYXI6IChjaGFyKTAsIHVuc2lnbmVkIGNoYXI6ICh1bnNpZ25lZCBjaGFy
KTAsIHNpZ25lZCBjaGFyOiAoc2lnbmVkIGNoYXIpMCwgdW5zaWduZWQgc2hvcnQ6ICh1bnNp
Z25lZCBzaG9ydCkwLCBzaWduZWQgc2hvcnQ6IChzaWduZWQgc2hvcnQpMCwgdW5zaWduZWQg
aW50OiAodW5zaWduZWQgaW50KTAsIHNpZ25lZCBpbnQ6IChzaWduZWQgaW50KTAsIHVuc2ln
bmVkIGxvbmc6ICh1bnNpZ25lZCBsb25nKTAsIHNpZ25lZCBsb25nOiAoc2lnbmVkIGxvbmcp
MCwgdW5zaWduZWQgbG9uZyBsb25nOiAodW5zaWduZWQgbG9uZyBsb25nKTAsIHNpZ25lZCBs
b25nIGxvbmc6IChzaWduZWQgbG9uZyBsb25nKTAsIGRlZmF1bHQ6IChoLT5wcHJldikpKSAq
KSYoaC0+cHByZXYpKTsgZG8geyB9IHdoaWxlICgwKTsgKHR5cGVvZihoLT5wcHJldikpX194
OyB9KTsgfSk7Cn0KCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGhsaXN0X2VtcHR5KGNvbnN0IHN0cnVj
dCBobGlzdF9oZWFkICpoKQp7CiByZXR1cm4gISh7IGRvIHsgZXh0ZXJuIHZvaWQgX19jb21w
aWxldGltZV9hc3NlcnRfMTEodm9pZCkgX19hdHRyaWJ1dGVfXygoX19lcnJvcl9fKCJVbnN1
cHBvcnRlZCBhY2Nlc3Mgc2l6ZSBmb3Ige1JFQUQsV1JJVEV9X09OQ0UoKS4iKSkpOyBpZiAo
ISgoc2l6ZW9mKGgtPmZpcnN0KSA9PSBzaXplb2YoY2hhcikgfHwgc2l6ZW9mKGgtPmZpcnN0
KSA9PSBzaXplb2Yoc2hvcnQpIHx8IHNpemVvZihoLT5maXJzdCkgPT0gc2l6ZW9mKGludCkg
fHwgc2l6ZW9mKGgtPmZpcnN0KSA9PSBzaXplb2YobG9uZykpIHx8IHNpemVvZihoLT5maXJz
dCkgPT0gc2l6ZW9mKGxvbmcgbG9uZykpKSBfX2NvbXBpbGV0aW1lX2Fzc2VydF8xMSgpOyB9
IHdoaWxlICgwKTsgKHsgdHlwZW9mKCBfR2VuZXJpYygoaC0+Zmlyc3QpLCBjaGFyOiAoY2hh
cikwLCB1bnNpZ25lZCBjaGFyOiAodW5zaWduZWQgY2hhcikwLCBzaWduZWQgY2hhcjogKHNp
Z25lZCBjaGFyKTAsIHVuc2lnbmVkIHNob3J0OiAodW5zaWduZWQgc2hvcnQpMCwgc2lnbmVk
IHNob3J0OiAoc2lnbmVkIHNob3J0KTAsIHVuc2lnbmVkIGludDogKHVuc2lnbmVkIGludCkw
LCBzaWduZWQgaW50OiAoc2lnbmVkIGludCkwLCB1bnNpZ25lZCBsb25nOiAodW5zaWduZWQg
bG9uZykwLCBzaWduZWQgbG9uZzogKHNpZ25lZCBsb25nKTAsIHVuc2lnbmVkIGxvbmcgbG9u
ZzogKHVuc2lnbmVkIGxvbmcgbG9uZykwLCBzaWduZWQgbG9uZyBsb25nOiAoc2lnbmVkIGxv
bmcgbG9uZykwLCBkZWZhdWx0OiAoaC0+Zmlyc3QpKSkgX194ID0gKCooY29uc3Qgdm9sYXRp
bGUgdHlwZW9mKCBfR2VuZXJpYygoaC0+Zmlyc3QpLCBjaGFyOiAoY2hhcikwLCB1bnNpZ25l
ZCBjaGFyOiAodW5zaWduZWQgY2hhcikwLCBzaWduZWQgY2hhcjogKHNpZ25lZCBjaGFyKTAs
IHVuc2lnbmVkIHNob3J0OiAodW5zaWduZWQgc2hvcnQpMCwgc2lnbmVkIHNob3J0OiAoc2ln
bmVkIHNob3J0KTAsIHVuc2lnbmVkIGludDogKHVuc2lnbmVkIGludCkwLCBzaWduZWQgaW50
OiAoc2lnbmVkIGludCkwLCB1bnNpZ25lZCBsb25nOiAodW5zaWduZWQgbG9uZykwLCBzaWdu
ZWQgbG9uZzogKHNpZ25lZCBsb25nKTAsIHVuc2lnbmVkIGxvbmcgbG9uZzogKHVuc2lnbmVk
IGxvbmcgbG9uZykwLCBzaWduZWQgbG9uZyBsb25nOiAoc2lnbmVkIGxvbmcgbG9uZykwLCBk
ZWZhdWx0OiAoaC0+Zmlyc3QpKSkgKikmKGgtPmZpcnN0KSk7IGRvIHsgfSB3aGlsZSAoMCk7
ICh0eXBlb2YoaC0+Zmlyc3QpKV9feDsgfSk7IH0pOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBfX2hs
aXN0X2RlbChzdHJ1Y3QgaGxpc3Rfbm9kZSAqbikKewogc3RydWN0IGhsaXN0X25vZGUgKm5l
eHQgPSBuLT5uZXh0Owogc3RydWN0IGhsaXN0X25vZGUgKipwcHJldiA9IG4tPnBwcmV2OwoK
IGRvIHsgZG8geyBleHRlcm4gdm9pZCBfX2NvbXBpbGV0aW1lX2Fzc2VydF8xMih2b2lkKSBf
X2F0dHJpYnV0ZV9fKChfX2Vycm9yX18oIlVuc3VwcG9ydGVkIGFjY2VzcyBzaXplIGZvciB7
UkVBRCxXUklURX1fT05DRSgpLiIpKSk7IGlmICghKChzaXplb2YoKnBwcmV2KSA9PSBzaXpl
b2YoY2hhcikgfHwgc2l6ZW9mKCpwcHJldikgPT0gc2l6ZW9mKHNob3J0KSB8fCBzaXplb2Yo
KnBwcmV2KSA9PSBzaXplb2YoaW50KSB8fCBzaXplb2YoKnBwcmV2KSA9PSBzaXplb2YobG9u
ZykpIHx8IHNpemVvZigqcHByZXYpID09IHNpemVvZihsb25nIGxvbmcpKSkgX19jb21waWxl
dGltZV9hc3NlcnRfMTIoKTsgfSB3aGlsZSAoMCk7IGRvIHsgKih2b2xhdGlsZSB0eXBlb2Yo
KnBwcmV2KSAqKSYoKnBwcmV2KSA9IChuZXh0KTsgfSB3aGlsZSAoMCk7IH0gd2hpbGUgKDAp
OwogaWYgKG5leHQpCiAgZG8geyBkbyB7IGV4dGVybiB2b2lkIF9fY29tcGlsZXRpbWVfYXNz
ZXJ0XzEzKHZvaWQpIF9fYXR0cmlidXRlX18oKF9fZXJyb3JfXygiVW5zdXBwb3J0ZWQgYWNj
ZXNzIHNpemUgZm9yIHtSRUFELFdSSVRFfV9PTkNFKCkuIikpKTsgaWYgKCEoKHNpemVvZihu
ZXh0LT5wcHJldikgPT0gc2l6ZW9mKGNoYXIpIHx8IHNpemVvZihuZXh0LT5wcHJldikgPT0g
c2l6ZW9mKHNob3J0KSB8fCBzaXplb2YobmV4dC0+cHByZXYpID09IHNpemVvZihpbnQpIHx8
IHNpemVvZihuZXh0LT5wcHJldikgPT0gc2l6ZW9mKGxvbmcpKSB8fCBzaXplb2YobmV4dC0+
cHByZXYpID09IHNpemVvZihsb25nIGxvbmcpKSkgX19jb21waWxldGltZV9hc3NlcnRfMTMo
KTsgfSB3aGlsZSAoMCk7IGRvIHsgKih2b2xhdGlsZSB0eXBlb2YobmV4dC0+cHByZXYpICop
JihuZXh0LT5wcHJldikgPSAocHByZXYpOyB9IHdoaWxlICgwKTsgfSB3aGlsZSAoMCk7Cn0K
IyA4MjMgIi4vaW5jbHVkZS9saW51eC9saXN0LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGhsaXN0X2Rl
bChzdHJ1Y3QgaGxpc3Rfbm9kZSAqbikKewogX19obGlzdF9kZWwobik7CiBuLT5uZXh0ID0g
KCh2b2lkICopIDB4MTAwICsgKDB4NWRlYWRiZWVmMDAwMDAwMFVMKSk7CiBuLT5wcHJldiA9
ICgodm9pZCAqKSAweDEyMiArICgweDVkZWFkYmVlZjAwMDAwMDBVTCkpOwp9CgoKCgoKCgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgdm9pZCBobGlzdF9kZWxfaW5pdChzdHJ1Y3QgaGxpc3Rfbm9kZSAqbikKewog
aWYgKCFobGlzdF91bmhhc2hlZChuKSkgewogIF9faGxpc3RfZGVsKG4pOwogIElOSVRfSExJ
U1RfTk9ERShuKTsKIH0KfQojIDg1MiAiLi9pbmNsdWRlL2xpbnV4L2xpc3QuaCIKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIHZvaWQgaGxpc3RfYWRkX2hlYWQoc3RydWN0IGhsaXN0X25vZGUgKm4sIHN0cnVjdCBo
bGlzdF9oZWFkICpoKQp7CiBzdHJ1Y3QgaGxpc3Rfbm9kZSAqZmlyc3QgPSBoLT5maXJzdDsK
IGRvIHsgZG8geyBleHRlcm4gdm9pZCBfX2NvbXBpbGV0aW1lX2Fzc2VydF8xNCh2b2lkKSBf
X2F0dHJpYnV0ZV9fKChfX2Vycm9yX18oIlVuc3VwcG9ydGVkIGFjY2VzcyBzaXplIGZvciB7
UkVBRCxXUklURX1fT05DRSgpLiIpKSk7IGlmICghKChzaXplb2Yobi0+bmV4dCkgPT0gc2l6
ZW9mKGNoYXIpIHx8IHNpemVvZihuLT5uZXh0KSA9PSBzaXplb2Yoc2hvcnQpIHx8IHNpemVv
ZihuLT5uZXh0KSA9PSBzaXplb2YoaW50KSB8fCBzaXplb2Yobi0+bmV4dCkgPT0gc2l6ZW9m
KGxvbmcpKSB8fCBzaXplb2Yobi0+bmV4dCkgPT0gc2l6ZW9mKGxvbmcgbG9uZykpKSBfX2Nv
bXBpbGV0aW1lX2Fzc2VydF8xNCgpOyB9IHdoaWxlICgwKTsgZG8geyAqKHZvbGF0aWxlIHR5
cGVvZihuLT5uZXh0KSAqKSYobi0+bmV4dCkgPSAoZmlyc3QpOyB9IHdoaWxlICgwKTsgfSB3
aGlsZSAoMCk7CiBpZiAoZmlyc3QpCiAgZG8geyBkbyB7IGV4dGVybiB2b2lkIF9fY29tcGls
ZXRpbWVfYXNzZXJ0XzE1KHZvaWQpIF9fYXR0cmlidXRlX18oKF9fZXJyb3JfXygiVW5zdXBw
b3J0ZWQgYWNjZXNzIHNpemUgZm9yIHtSRUFELFdSSVRFfV9PTkNFKCkuIikpKTsgaWYgKCEo
KHNpemVvZihmaXJzdC0+cHByZXYpID09IHNpemVvZihjaGFyKSB8fCBzaXplb2YoZmlyc3Qt
PnBwcmV2KSA9PSBzaXplb2Yoc2hvcnQpIHx8IHNpemVvZihmaXJzdC0+cHByZXYpID09IHNp
emVvZihpbnQpIHx8IHNpemVvZihmaXJzdC0+cHByZXYpID09IHNpemVvZihsb25nKSkgfHwg
c2l6ZW9mKGZpcnN0LT5wcHJldikgPT0gc2l6ZW9mKGxvbmcgbG9uZykpKSBfX2NvbXBpbGV0
aW1lX2Fzc2VydF8xNSgpOyB9IHdoaWxlICgwKTsgZG8geyAqKHZvbGF0aWxlIHR5cGVvZihm
aXJzdC0+cHByZXYpICopJihmaXJzdC0+cHByZXYpID0gKCZuLT5uZXh0KTsgfSB3aGlsZSAo
MCk7IH0gd2hpbGUgKDApOwogZG8geyBkbyB7IGV4dGVybiB2b2lkIF9fY29tcGlsZXRpbWVf
YXNzZXJ0XzE2KHZvaWQpIF9fYXR0cmlidXRlX18oKF9fZXJyb3JfXygiVW5zdXBwb3J0ZWQg
YWNjZXNzIHNpemUgZm9yIHtSRUFELFdSSVRFfV9PTkNFKCkuIikpKTsgaWYgKCEoKHNpemVv
ZihoLT5maXJzdCkgPT0gc2l6ZW9mKGNoYXIpIHx8IHNpemVvZihoLT5maXJzdCkgPT0gc2l6
ZW9mKHNob3J0KSB8fCBzaXplb2YoaC0+Zmlyc3QpID09IHNpemVvZihpbnQpIHx8IHNpemVv
ZihoLT5maXJzdCkgPT0gc2l6ZW9mKGxvbmcpKSB8fCBzaXplb2YoaC0+Zmlyc3QpID09IHNp
emVvZihsb25nIGxvbmcpKSkgX19jb21waWxldGltZV9hc3NlcnRfMTYoKTsgfSB3aGlsZSAo
MCk7IGRvIHsgKih2b2xhdGlsZSB0eXBlb2YoaC0+Zmlyc3QpICopJihoLT5maXJzdCkgPSAo
bik7IH0gd2hpbGUgKDApOyB9IHdoaWxlICgwKTsKIGRvIHsgZG8geyBleHRlcm4gdm9pZCBf
X2NvbXBpbGV0aW1lX2Fzc2VydF8xNyh2b2lkKSBfX2F0dHJpYnV0ZV9fKChfX2Vycm9yX18o
IlVuc3VwcG9ydGVkIGFjY2VzcyBzaXplIGZvciB7UkVBRCxXUklURX1fT05DRSgpLiIpKSk7
IGlmICghKChzaXplb2Yobi0+cHByZXYpID09IHNpemVvZihjaGFyKSB8fCBzaXplb2Yobi0+
cHByZXYpID09IHNpemVvZihzaG9ydCkgfHwgc2l6ZW9mKG4tPnBwcmV2KSA9PSBzaXplb2Yo
aW50KSB8fCBzaXplb2Yobi0+cHByZXYpID09IHNpemVvZihsb25nKSkgfHwgc2l6ZW9mKG4t
PnBwcmV2KSA9PSBzaXplb2YobG9uZyBsb25nKSkpIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzE3
KCk7IH0gd2hpbGUgKDApOyBkbyB7ICoodm9sYXRpbGUgdHlwZW9mKG4tPnBwcmV2KSAqKSYo
bi0+cHByZXYpID0gKCZoLT5maXJzdCk7IH0gd2hpbGUgKDApOyB9IHdoaWxlICgwKTsKfQoK
CgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgdm9pZCBobGlzdF9hZGRfYmVmb3JlKHN0cnVjdCBobGlzdF9ub2Rl
ICpuLAogICAgICAgIHN0cnVjdCBobGlzdF9ub2RlICpuZXh0KQp7CiBkbyB7IGRvIHsgZXh0
ZXJuIHZvaWQgX19jb21waWxldGltZV9hc3NlcnRfMTgodm9pZCkgX19hdHRyaWJ1dGVfXygo
X19lcnJvcl9fKCJVbnN1cHBvcnRlZCBhY2Nlc3Mgc2l6ZSBmb3Ige1JFQUQsV1JJVEV9X09O
Q0UoKS4iKSkpOyBpZiAoISgoc2l6ZW9mKG4tPnBwcmV2KSA9PSBzaXplb2YoY2hhcikgfHwg
c2l6ZW9mKG4tPnBwcmV2KSA9PSBzaXplb2Yoc2hvcnQpIHx8IHNpemVvZihuLT5wcHJldikg
PT0gc2l6ZW9mKGludCkgfHwgc2l6ZW9mKG4tPnBwcmV2KSA9PSBzaXplb2YobG9uZykpIHx8
IHNpemVvZihuLT5wcHJldikgPT0gc2l6ZW9mKGxvbmcgbG9uZykpKSBfX2NvbXBpbGV0aW1l
X2Fzc2VydF8xOCgpOyB9IHdoaWxlICgwKTsgZG8geyAqKHZvbGF0aWxlIHR5cGVvZihuLT5w
cHJldikgKikmKG4tPnBwcmV2KSA9IChuZXh0LT5wcHJldik7IH0gd2hpbGUgKDApOyB9IHdo
aWxlICgwKTsKIGRvIHsgZG8geyBleHRlcm4gdm9pZCBfX2NvbXBpbGV0aW1lX2Fzc2VydF8x
OSh2b2lkKSBfX2F0dHJpYnV0ZV9fKChfX2Vycm9yX18oIlVuc3VwcG9ydGVkIGFjY2VzcyBz
aXplIGZvciB7UkVBRCxXUklURX1fT05DRSgpLiIpKSk7IGlmICghKChzaXplb2Yobi0+bmV4
dCkgPT0gc2l6ZW9mKGNoYXIpIHx8IHNpemVvZihuLT5uZXh0KSA9PSBzaXplb2Yoc2hvcnQp
IHx8IHNpemVvZihuLT5uZXh0KSA9PSBzaXplb2YoaW50KSB8fCBzaXplb2Yobi0+bmV4dCkg
PT0gc2l6ZW9mKGxvbmcpKSB8fCBzaXplb2Yobi0+bmV4dCkgPT0gc2l6ZW9mKGxvbmcgbG9u
ZykpKSBfX2NvbXBpbGV0aW1lX2Fzc2VydF8xOSgpOyB9IHdoaWxlICgwKTsgZG8geyAqKHZv
bGF0aWxlIHR5cGVvZihuLT5uZXh0KSAqKSYobi0+bmV4dCkgPSAobmV4dCk7IH0gd2hpbGUg
KDApOyB9IHdoaWxlICgwKTsKIGRvIHsgZG8geyBleHRlcm4gdm9pZCBfX2NvbXBpbGV0aW1l
X2Fzc2VydF8yMCh2b2lkKSBfX2F0dHJpYnV0ZV9fKChfX2Vycm9yX18oIlVuc3VwcG9ydGVk
IGFjY2VzcyBzaXplIGZvciB7UkVBRCxXUklURX1fT05DRSgpLiIpKSk7IGlmICghKChzaXpl
b2YobmV4dC0+cHByZXYpID09IHNpemVvZihjaGFyKSB8fCBzaXplb2YobmV4dC0+cHByZXYp
ID09IHNpemVvZihzaG9ydCkgfHwgc2l6ZW9mKG5leHQtPnBwcmV2KSA9PSBzaXplb2YoaW50
KSB8fCBzaXplb2YobmV4dC0+cHByZXYpID09IHNpemVvZihsb25nKSkgfHwgc2l6ZW9mKG5l
eHQtPnBwcmV2KSA9PSBzaXplb2YobG9uZyBsb25nKSkpIF9fY29tcGlsZXRpbWVfYXNzZXJ0
XzIwKCk7IH0gd2hpbGUgKDApOyBkbyB7ICoodm9sYXRpbGUgdHlwZW9mKG5leHQtPnBwcmV2
KSAqKSYobmV4dC0+cHByZXYpID0gKCZuLT5uZXh0KTsgfSB3aGlsZSAoMCk7IH0gd2hpbGUg
KDApOwogZG8geyBkbyB7IGV4dGVybiB2b2lkIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzIxKHZv
aWQpIF9fYXR0cmlidXRlX18oKF9fZXJyb3JfXygiVW5zdXBwb3J0ZWQgYWNjZXNzIHNpemUg
Zm9yIHtSRUFELFdSSVRFfV9PTkNFKCkuIikpKTsgaWYgKCEoKHNpemVvZigqKG4tPnBwcmV2
KSkgPT0gc2l6ZW9mKGNoYXIpIHx8IHNpemVvZigqKG4tPnBwcmV2KSkgPT0gc2l6ZW9mKHNo
b3J0KSB8fCBzaXplb2YoKihuLT5wcHJldikpID09IHNpemVvZihpbnQpIHx8IHNpemVvZigq
KG4tPnBwcmV2KSkgPT0gc2l6ZW9mKGxvbmcpKSB8fCBzaXplb2YoKihuLT5wcHJldikpID09
IHNpemVvZihsb25nIGxvbmcpKSkgX19jb21waWxldGltZV9hc3NlcnRfMjEoKTsgfSB3aGls
ZSAoMCk7IGRvIHsgKih2b2xhdGlsZSB0eXBlb2YoKihuLT5wcHJldikpICopJigqKG4tPnBw
cmV2KSkgPSAobik7IH0gd2hpbGUgKDApOyB9IHdoaWxlICgwKTsKfQoKCgoKCgpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgdm9pZCBobGlzdF9hZGRfYmVoaW5kKHN0cnVjdCBobGlzdF9ub2RlICpuLAogICAgICAg
IHN0cnVjdCBobGlzdF9ub2RlICpwcmV2KQp7CiBkbyB7IGRvIHsgZXh0ZXJuIHZvaWQgX19j
b21waWxldGltZV9hc3NlcnRfMjIodm9pZCkgX19hdHRyaWJ1dGVfXygoX19lcnJvcl9fKCJV
bnN1cHBvcnRlZCBhY2Nlc3Mgc2l6ZSBmb3Ige1JFQUQsV1JJVEV9X09OQ0UoKS4iKSkpOyBp
ZiAoISgoc2l6ZW9mKG4tPm5leHQpID09IHNpemVvZihjaGFyKSB8fCBzaXplb2Yobi0+bmV4
dCkgPT0gc2l6ZW9mKHNob3J0KSB8fCBzaXplb2Yobi0+bmV4dCkgPT0gc2l6ZW9mKGludCkg
fHwgc2l6ZW9mKG4tPm5leHQpID09IHNpemVvZihsb25nKSkgfHwgc2l6ZW9mKG4tPm5leHQp
ID09IHNpemVvZihsb25nIGxvbmcpKSkgX19jb21waWxldGltZV9hc3NlcnRfMjIoKTsgfSB3
aGlsZSAoMCk7IGRvIHsgKih2b2xhdGlsZSB0eXBlb2Yobi0+bmV4dCkgKikmKG4tPm5leHQp
ID0gKHByZXYtPm5leHQpOyB9IHdoaWxlICgwKTsgfSB3aGlsZSAoMCk7CiBkbyB7IGRvIHsg
ZXh0ZXJuIHZvaWQgX19jb21waWxldGltZV9hc3NlcnRfMjModm9pZCkgX19hdHRyaWJ1dGVf
XygoX19lcnJvcl9fKCJVbnN1cHBvcnRlZCBhY2Nlc3Mgc2l6ZSBmb3Ige1JFQUQsV1JJVEV9
X09OQ0UoKS4iKSkpOyBpZiAoISgoc2l6ZW9mKHByZXYtPm5leHQpID09IHNpemVvZihjaGFy
KSB8fCBzaXplb2YocHJldi0+bmV4dCkgPT0gc2l6ZW9mKHNob3J0KSB8fCBzaXplb2YocHJl
di0+bmV4dCkgPT0gc2l6ZW9mKGludCkgfHwgc2l6ZW9mKHByZXYtPm5leHQpID09IHNpemVv
Zihsb25nKSkgfHwgc2l6ZW9mKHByZXYtPm5leHQpID09IHNpemVvZihsb25nIGxvbmcpKSkg
X19jb21waWxldGltZV9hc3NlcnRfMjMoKTsgfSB3aGlsZSAoMCk7IGRvIHsgKih2b2xhdGls
ZSB0eXBlb2YocHJldi0+bmV4dCkgKikmKHByZXYtPm5leHQpID0gKG4pOyB9IHdoaWxlICgw
KTsgfSB3aGlsZSAoMCk7CiBkbyB7IGRvIHsgZXh0ZXJuIHZvaWQgX19jb21waWxldGltZV9h
c3NlcnRfMjQodm9pZCkgX19hdHRyaWJ1dGVfXygoX19lcnJvcl9fKCJVbnN1cHBvcnRlZCBh
Y2Nlc3Mgc2l6ZSBmb3Ige1JFQUQsV1JJVEV9X09OQ0UoKS4iKSkpOyBpZiAoISgoc2l6ZW9m
KG4tPnBwcmV2KSA9PSBzaXplb2YoY2hhcikgfHwgc2l6ZW9mKG4tPnBwcmV2KSA9PSBzaXpl
b2Yoc2hvcnQpIHx8IHNpemVvZihuLT5wcHJldikgPT0gc2l6ZW9mKGludCkgfHwgc2l6ZW9m
KG4tPnBwcmV2KSA9PSBzaXplb2YobG9uZykpIHx8IHNpemVvZihuLT5wcHJldikgPT0gc2l6
ZW9mKGxvbmcgbG9uZykpKSBfX2NvbXBpbGV0aW1lX2Fzc2VydF8yNCgpOyB9IHdoaWxlICgw
KTsgZG8geyAqKHZvbGF0aWxlIHR5cGVvZihuLT5wcHJldikgKikmKG4tPnBwcmV2KSA9ICgm
cHJldi0+bmV4dCk7IH0gd2hpbGUgKDApOyB9IHdoaWxlICgwKTsKCiBpZiAobi0+bmV4dCkK
ICBkbyB7IGRvIHsgZXh0ZXJuIHZvaWQgX19jb21waWxldGltZV9hc3NlcnRfMjUodm9pZCkg
X19hdHRyaWJ1dGVfXygoX19lcnJvcl9fKCJVbnN1cHBvcnRlZCBhY2Nlc3Mgc2l6ZSBmb3Ig
e1JFQUQsV1JJVEV9X09OQ0UoKS4iKSkpOyBpZiAoISgoc2l6ZW9mKG4tPm5leHQtPnBwcmV2
KSA9PSBzaXplb2YoY2hhcikgfHwgc2l6ZW9mKG4tPm5leHQtPnBwcmV2KSA9PSBzaXplb2Yo
c2hvcnQpIHx8IHNpemVvZihuLT5uZXh0LT5wcHJldikgPT0gc2l6ZW9mKGludCkgfHwgc2l6
ZW9mKG4tPm5leHQtPnBwcmV2KSA9PSBzaXplb2YobG9uZykpIHx8IHNpemVvZihuLT5uZXh0
LT5wcHJldikgPT0gc2l6ZW9mKGxvbmcgbG9uZykpKSBfX2NvbXBpbGV0aW1lX2Fzc2VydF8y
NSgpOyB9IHdoaWxlICgwKTsgZG8geyAqKHZvbGF0aWxlIHR5cGVvZihuLT5uZXh0LT5wcHJl
dikgKikmKG4tPm5leHQtPnBwcmV2KSA9ICgmbi0+bmV4dCk7IH0gd2hpbGUgKDApOyB9IHdo
aWxlICgwKTsKfQojIDkwMCAiLi9pbmNsdWRlL2xpbnV4L2xpc3QuaCIKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZv
aWQgaGxpc3RfYWRkX2Zha2Uoc3RydWN0IGhsaXN0X25vZGUgKm4pCnsKIG4tPnBwcmV2ID0g
Jm4tPm5leHQ7Cn0KCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBobGlzdF9mYWtlKHN0cnVjdCBobGlz
dF9ub2RlICpoKQp7CiByZXR1cm4gaC0+cHByZXYgPT0gJmgtPm5leHQ7Cn0KIyA5MjIgIi4v
aW5jbHVkZS9saW51eC9saXN0LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKQoKIyA5MjIgIi4vaW5jbHVkZS9saW51
eC9saXN0LmgiCiAgICAgICAgICAgICAgYm9vbApobGlzdF9pc19zaW5ndWxhcl9ub2RlKHN0
cnVjdCBobGlzdF9ub2RlICpuLCBzdHJ1Y3QgaGxpc3RfaGVhZCAqaCkKewogcmV0dXJuICFu
LT5uZXh0ICYmIG4tPnBwcmV2ID09ICZoLT5maXJzdDsKfQojIDkzNiAiLi9pbmNsdWRlL2xp
bnV4L2xpc3QuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgaGxpc3RfbW92ZV9saXN0KHN0cnVjdCBobGlz
dF9oZWFkICpvbGQsCiAgICAgICBzdHJ1Y3QgaGxpc3RfaGVhZCAqbmV3KQp7CiBuZXctPmZp
cnN0ID0gb2xkLT5maXJzdDsKIGlmIChuZXctPmZpcnN0KQogIG5ldy0+Zmlyc3QtPnBwcmV2
ID0gJm5ldy0+Zmlyc3Q7CiBvbGQtPmZpcnN0ID0gKCh2b2lkICopMCk7Cn0KIyAxMSAiLi9p
bmNsdWRlL2xpbnV4L3JjdWxpc3QuaCIgMgojIDEgIi4vaW5jbHVkZS9saW51eC9yY3VwZGF0
ZS5oIiAxCiMgMjUgIi4vaW5jbHVkZS9saW51eC9yY3VwZGF0ZS5oIgojIDEgIi4vaW5jbHVk
ZS9saW51eC9hdG9taWMuaCIgMQojIDg0ICIuL2luY2x1ZGUvbGludXgvYXRvbWljLmgiCiMg
MSAiLi9pbmNsdWRlL2xpbnV4L2F0b21pYy1mYWxsYmFjay5oIiAxCiMgODQgIi4vaW5jbHVk
ZS9saW51eC9hdG9taWMtZmFsbGJhY2suaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9f
YWx3YXlzX2lubGluZV9fKSkgaW50CmF0b21pY19yZWFkX2FjcXVpcmUoY29uc3QgYXRvbWlj
X3QgKnYpCnsKIHJldHVybiAoeyB0eXBlb2YoKiYodiktPmNvdW50ZXIpIF9fX3AxID0gKHsg
ZG8geyBleHRlcm4gdm9pZCBfX2NvbXBpbGV0aW1lX2Fzc2VydF8yNih2b2lkKSBfX2F0dHJp
YnV0ZV9fKChfX2Vycm9yX18oIlVuc3VwcG9ydGVkIGFjY2VzcyBzaXplIGZvciB7UkVBRCxX
UklURX1fT05DRSgpLiIpKSk7IGlmICghKChzaXplb2YoKiYodiktPmNvdW50ZXIpID09IHNp
emVvZihjaGFyKSB8fCBzaXplb2YoKiYodiktPmNvdW50ZXIpID09IHNpemVvZihzaG9ydCkg
fHwgc2l6ZW9mKComKHYpLT5jb3VudGVyKSA9PSBzaXplb2YoaW50KSB8fCBzaXplb2YoKiYo
diktPmNvdW50ZXIpID09IHNpemVvZihsb25nKSkgfHwgc2l6ZW9mKComKHYpLT5jb3VudGVy
KSA9PSBzaXplb2YobG9uZyBsb25nKSkpIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzI2KCk7IH0g
d2hpbGUgKDApOyAoeyB0eXBlb2YoIF9HZW5lcmljKCgqJih2KS0+Y291bnRlciksIGNoYXI6
IChjaGFyKTAsIHVuc2lnbmVkIGNoYXI6ICh1bnNpZ25lZCBjaGFyKTAsIHNpZ25lZCBjaGFy
OiAoc2lnbmVkIGNoYXIpMCwgdW5zaWduZWQgc2hvcnQ6ICh1bnNpZ25lZCBzaG9ydCkwLCBz
aWduZWQgc2hvcnQ6IChzaWduZWQgc2hvcnQpMCwgdW5zaWduZWQgaW50OiAodW5zaWduZWQg
aW50KTAsIHNpZ25lZCBpbnQ6IChzaWduZWQgaW50KTAsIHVuc2lnbmVkIGxvbmc6ICh1bnNp
Z25lZCBsb25nKTAsIHNpZ25lZCBsb25nOiAoc2lnbmVkIGxvbmcpMCwgdW5zaWduZWQgbG9u
ZyBsb25nOiAodW5zaWduZWQgbG9uZyBsb25nKTAsIHNpZ25lZCBsb25nIGxvbmc6IChzaWdu
ZWQgbG9uZyBsb25nKTAsIGRlZmF1bHQ6ICgqJih2KS0+Y291bnRlcikpKSBfX3ggPSAoKihj
b25zdCB2b2xhdGlsZSB0eXBlb2YoIF9HZW5lcmljKCgqJih2KS0+Y291bnRlciksIGNoYXI6
IChjaGFyKTAsIHVuc2lnbmVkIGNoYXI6ICh1bnNpZ25lZCBjaGFyKTAsIHNpZ25lZCBjaGFy
OiAoc2lnbmVkIGNoYXIpMCwgdW5zaWduZWQgc2hvcnQ6ICh1bnNpZ25lZCBzaG9ydCkwLCBz
aWduZWQgc2hvcnQ6IChzaWduZWQgc2hvcnQpMCwgdW5zaWduZWQgaW50OiAodW5zaWduZWQg
aW50KTAsIHNpZ25lZCBpbnQ6IChzaWduZWQgaW50KTAsIHVuc2lnbmVkIGxvbmc6ICh1bnNp
Z25lZCBsb25nKTAsIHNpZ25lZCBsb25nOiAoc2lnbmVkIGxvbmcpMCwgdW5zaWduZWQgbG9u
ZyBsb25nOiAodW5zaWduZWQgbG9uZyBsb25nKTAsIHNpZ25lZCBsb25nIGxvbmc6IChzaWdu
ZWQgbG9uZyBsb25nKTAsIGRlZmF1bHQ6ICgqJih2KS0+Y291bnRlcikpKSAqKSYoKiYodikt
PmNvdW50ZXIpKTsgZG8geyB9IHdoaWxlICgwKTsgKHR5cGVvZigqJih2KS0+Y291bnRlcikp
X194OyB9KTsgfSk7IGRvIHsgZXh0ZXJuIHZvaWQgX19jb21waWxldGltZV9hc3NlcnRfMjco
dm9pZCkgX19hdHRyaWJ1dGVfXygoX19lcnJvcl9fKCJOZWVkIG5hdGl2ZSB3b3JkIHNpemVk
IHN0b3Jlcy9sb2FkcyBmb3IgYXRvbWljaXR5LiIpKSk7IGlmICghKChzaXplb2YoKiYodikt
PmNvdW50ZXIpID09IHNpemVvZihjaGFyKSB8fCBzaXplb2YoKiYodiktPmNvdW50ZXIpID09
IHNpemVvZihzaG9ydCkgfHwgc2l6ZW9mKComKHYpLT5jb3VudGVyKSA9PSBzaXplb2YoaW50
KSB8fCBzaXplb2YoKiYodiktPmNvdW50ZXIpID09IHNpemVvZihsb25nKSkpKSBfX2NvbXBp
bGV0aW1lX2Fzc2VydF8yNygpOyB9IHdoaWxlICgwKTsgX19hc21fXyBfX3ZvbGF0aWxlX18g
KCJsd3N5bmMiICIgIiA6IDogOiJtZW1vcnkiKTsgX19fcDE7IH0pOwp9CgoKCgoKCgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB2b2lkCmF0b21pY19z
ZXRfcmVsZWFzZShhdG9taWNfdCAqdiwgaW50IGkpCnsKIGRvIHsgZG8geyBleHRlcm4gdm9p
ZCBfX2NvbXBpbGV0aW1lX2Fzc2VydF8yOCh2b2lkKSBfX2F0dHJpYnV0ZV9fKChfX2Vycm9y
X18oIk5lZWQgbmF0aXZlIHdvcmQgc2l6ZWQgc3RvcmVzL2xvYWRzIGZvciBhdG9taWNpdHku
IikpKTsgaWYgKCEoKHNpemVvZigqJih2KS0+Y291bnRlcikgPT0gc2l6ZW9mKGNoYXIpIHx8
IHNpemVvZigqJih2KS0+Y291bnRlcikgPT0gc2l6ZW9mKHNob3J0KSB8fCBzaXplb2YoKiYo
diktPmNvdW50ZXIpID09IHNpemVvZihpbnQpIHx8IHNpemVvZigqJih2KS0+Y291bnRlcikg
PT0gc2l6ZW9mKGxvbmcpKSkpIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzI4KCk7IH0gd2hpbGUg
KDApOyBfX2FzbV9fIF9fdm9sYXRpbGVfXyAoImx3c3luYyIgIiAiIDogOiA6Im1lbW9yeSIp
OyBkbyB7IGRvIHsgZXh0ZXJuIHZvaWQgX19jb21waWxldGltZV9hc3NlcnRfMjkodm9pZCkg
X19hdHRyaWJ1dGVfXygoX19lcnJvcl9fKCJVbnN1cHBvcnRlZCBhY2Nlc3Mgc2l6ZSBmb3Ig
e1JFQUQsV1JJVEV9X09OQ0UoKS4iKSkpOyBpZiAoISgoc2l6ZW9mKComKHYpLT5jb3VudGVy
KSA9PSBzaXplb2YoY2hhcikgfHwgc2l6ZW9mKComKHYpLT5jb3VudGVyKSA9PSBzaXplb2Yo
c2hvcnQpIHx8IHNpemVvZigqJih2KS0+Y291bnRlcikgPT0gc2l6ZW9mKGludCkgfHwgc2l6
ZW9mKComKHYpLT5jb3VudGVyKSA9PSBzaXplb2YobG9uZykpIHx8IHNpemVvZigqJih2KS0+
Y291bnRlcikgPT0gc2l6ZW9mKGxvbmcgbG9uZykpKSBfX2NvbXBpbGV0aW1lX2Fzc2VydF8y
OSgpOyB9IHdoaWxlICgwKTsgZG8geyAqKHZvbGF0aWxlIHR5cGVvZigqJih2KS0+Y291bnRl
cikgKikmKComKHYpLT5jb3VudGVyKSA9IChpKTsgfSB3aGlsZSAoMCk7IH0gd2hpbGUgKDAp
OyB9IHdoaWxlICgwKTsKfQojIDExOCAiLi9pbmNsdWRlL2xpbnV4L2F0b21pYy1mYWxsYmFj
ay5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBpbnQK
YXRvbWljX2FkZF9yZXR1cm5fYWNxdWlyZShpbnQgaSwgYXRvbWljX3QgKnYpCnsKIGludCBy
ZXQgPSBhdG9taWNfYWRkX3JldHVybl9yZWxheGVkKGksIHYpOwogX19hc21fXyBfX3ZvbGF0
aWxlX18oIlxuIiAiOTcxOjsgaXN5bmM7IDk3MjogLnB1c2hzZWN0aW9uIF9fbHdzeW5jX2Zp
eHVwLFwiYVwiOyAuYWxpZ24gMjsgOTczOiAuOGJ5dGUgOTcxYi05NzNiOyAucG9wc2VjdGlv
bjs7IiAiICIgIiIgOiA6IDogIm1lbW9yeSIpOwogcmV0dXJuIHJldDsKfQoKCgoKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgaW50CmF0b21pY19hZGRf
cmV0dXJuX3JlbGVhc2UoaW50IGksIGF0b21pY190ICp2KQp7CiBfX2FzbV9fIF9fdm9sYXRp
bGVfXygibHdzeW5jIiAiICIgIlxuIiAiIiA6IDogOiAibWVtb3J5Iik7CiByZXR1cm4gYXRv
bWljX2FkZF9yZXR1cm5fcmVsYXhlZChpLCB2KTsKfQoKCgoKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmli
dXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgaW50CmF0b21pY19hZGRfcmV0dXJuKGludCBp
LCBhdG9taWNfdCAqdikKewogaW50IHJldDsKIF9fYXNtX18gX192b2xhdGlsZV9fICgic3lu
YyIgOiA6IDogIm1lbW9yeSIpOwogcmV0ID0gYXRvbWljX2FkZF9yZXR1cm5fcmVsYXhlZChp
LCB2KTsKIF9fYXNtX18gX192b2xhdGlsZV9fICgic3luYyIgOiA6IDogIm1lbW9yeSIpOwog
cmV0dXJuIHJldDsKfQojIDE2NSAiLi9pbmNsdWRlL2xpbnV4L2F0b21pYy1mYWxsYmFjay5o
IgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBpbnQKYXRv
bWljX2ZldGNoX2FkZF9hY3F1aXJlKGludCBpLCBhdG9taWNfdCAqdikKewogaW50IHJldCA9
IGF0b21pY19mZXRjaF9hZGRfcmVsYXhlZChpLCB2KTsKIF9fYXNtX18gX192b2xhdGlsZV9f
KCJcbiIgIjk3MTo7IGlzeW5jOyA5NzI6IC5wdXNoc2VjdGlvbiBfX2x3c3luY19maXh1cCxc
ImFcIjsgLmFsaWduIDI7IDk3MzogLjhieXRlIDk3MWItOTczYjsgLnBvcHNlY3Rpb247OyIg
IiAiICIiIDogOiA6ICJtZW1vcnkiKTsKIHJldHVybiByZXQ7Cn0KCgoKCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBf
X2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIGludAphdG9taWNfZmV0Y2hfYWRk
X3JlbGVhc2UoaW50IGksIGF0b21pY190ICp2KQp7CiBfX2FzbV9fIF9fdm9sYXRpbGVfXygi
bHdzeW5jIiAiICIgIlxuIiAiIiA6IDogOiAibWVtb3J5Iik7CiByZXR1cm4gYXRvbWljX2Zl
dGNoX2FkZF9yZWxheGVkKGksIHYpOwp9CgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygo
X19hbHdheXNfaW5saW5lX18pKSBpbnQKYXRvbWljX2ZldGNoX2FkZChpbnQgaSwgYXRvbWlj
X3QgKnYpCnsKIGludCByZXQ7CiBfX2FzbV9fIF9fdm9sYXRpbGVfXyAoInN5bmMiIDogOiA6
ICJtZW1vcnkiKTsKIHJldCA9IGF0b21pY19mZXRjaF9hZGRfcmVsYXhlZChpLCB2KTsKIF9f
YXNtX18gX192b2xhdGlsZV9fICgic3luYyIgOiA6IDogIm1lbW9yeSIpOwogcmV0dXJuIHJl
dDsKfQojIDIxNCAiLi9pbmNsdWRlL2xpbnV4L2F0b21pYy1mYWxsYmFjay5oIgpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBpbnQKYXRvbWljX3N1Yl9y
ZXR1cm5fYWNxdWlyZShpbnQgaSwgYXRvbWljX3QgKnYpCnsKIGludCByZXQgPSBhdG9taWNf
c3ViX3JldHVybl9yZWxheGVkKGksIHYpOwogX19hc21fXyBfX3ZvbGF0aWxlX18oIlxuIiAi
OTcxOjsgaXN5bmM7IDk3MjogLnB1c2hzZWN0aW9uIF9fbHdzeW5jX2ZpeHVwLFwiYVwiOyAu
YWxpZ24gMjsgOTczOiAuOGJ5dGUgOTcxYi05NzNiOyAucG9wc2VjdGlvbjs7IiAiICIgIiIg
OiA6IDogIm1lbW9yeSIpOwogcmV0dXJuIHJldDsKfQoKCgoKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmli
dXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgaW50CmF0b21pY19zdWJfcmV0dXJuX3JlbGVh
c2UoaW50IGksIGF0b21pY190ICp2KQp7CiBfX2FzbV9fIF9fdm9sYXRpbGVfXygibHdzeW5j
IiAiICIgIlxuIiAiIiA6IDogOiAibWVtb3J5Iik7CiByZXR1cm4gYXRvbWljX3N1Yl9yZXR1
cm5fcmVsYXhlZChpLCB2KTsKfQoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3
YXlzX2lubGluZV9fKSkgaW50CmF0b21pY19zdWJfcmV0dXJuKGludCBpLCBhdG9taWNfdCAq
dikKewogaW50IHJldDsKIF9fYXNtX18gX192b2xhdGlsZV9fICgic3luYyIgOiA6IDogIm1l
bW9yeSIpOwogcmV0ID0gYXRvbWljX3N1Yl9yZXR1cm5fcmVsYXhlZChpLCB2KTsKIF9fYXNt
X18gX192b2xhdGlsZV9fICgic3luYyIgOiA6IDogIm1lbW9yeSIpOwogcmV0dXJuIHJldDsK
fQojIDI2MSAiLi9pbmNsdWRlL2xpbnV4L2F0b21pYy1mYWxsYmFjay5oIgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
X19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBpbnQKYXRvbWljX2ZldGNoX3N1
Yl9hY3F1aXJlKGludCBpLCBhdG9taWNfdCAqdikKewogaW50IHJldCA9IGF0b21pY19mZXRj
aF9zdWJfcmVsYXhlZChpLCB2KTsKIF9fYXNtX18gX192b2xhdGlsZV9fKCJcbiIgIjk3MTo7
IGlzeW5jOyA5NzI6IC5wdXNoc2VjdGlvbiBfX2x3c3luY19maXh1cCxcImFcIjsgLmFsaWdu
IDI7IDk3MzogLjhieXRlIDk3MWItOTczYjsgLnBvcHNlY3Rpb247OyIgIiAiICIiIDogOiA6
ICJtZW1vcnkiKTsKIHJldHVybiByZXQ7Cn0KCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9f
KChfX2Fsd2F5c19pbmxpbmVfXykpIGludAphdG9taWNfZmV0Y2hfc3ViX3JlbGVhc2UoaW50
IGksIGF0b21pY190ICp2KQp7CiBfX2FzbV9fIF9fdm9sYXRpbGVfXygibHdzeW5jIiAiICIg
IlxuIiAiIiA6IDogOiAibWVtb3J5Iik7CiByZXR1cm4gYXRvbWljX2ZldGNoX3N1Yl9yZWxh
eGVkKGksIHYpOwp9CgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5s
aW5lX18pKSBpbnQKYXRvbWljX2ZldGNoX3N1YihpbnQgaSwgYXRvbWljX3QgKnYpCnsKIGlu
dCByZXQ7CiBfX2FzbV9fIF9fdm9sYXRpbGVfXyAoInN5bmMiIDogOiA6ICJtZW1vcnkiKTsK
IHJldCA9IGF0b21pY19mZXRjaF9zdWJfcmVsYXhlZChpLCB2KTsKIF9fYXNtX18gX192b2xh
dGlsZV9fICgic3luYyIgOiA6IDogIm1lbW9yeSIpOwogcmV0dXJuIHJldDsKfQojIDM1OCAi
Li9pbmNsdWRlL2xpbnV4L2F0b21pYy1mYWxsYmFjay5oIgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1
dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBpbnQKYXRvbWljX2luY19yZXR1cm5fYWNxdWly
ZShhdG9taWNfdCAqdikKewogaW50IHJldCA9IGF0b21pY19pbmNfcmV0dXJuX3JlbGF4ZWQo
dik7CiBfX2FzbV9fIF9fdm9sYXRpbGVfXygiXG4iICI5NzE6OyBpc3luYzsgOTcyOiAucHVz
aHNlY3Rpb24gX19sd3N5bmNfZml4dXAsXCJhXCI7IC5hbGlnbiAyOyA5NzM6IC44Ynl0ZSA5
NzFiLTk3M2I7IC5wb3BzZWN0aW9uOzsiICIgIiAiIiA6IDogOiAibWVtb3J5Iik7CiByZXR1
cm4gcmV0Owp9CgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5l
X18pKSBpbnQKYXRvbWljX2luY19yZXR1cm5fcmVsZWFzZShhdG9taWNfdCAqdikKewogX19h
c21fXyBfX3ZvbGF0aWxlX18oImx3c3luYyIgIiAiICJcbiIgIiIgOiA6IDogIm1lbW9yeSIp
OwogcmV0dXJuIGF0b21pY19pbmNfcmV0dXJuX3JlbGF4ZWQodik7Cn0KCgoKCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIGludAphdG9taWNfaW5jX3Jl
dHVybihhdG9taWNfdCAqdikKewogaW50IHJldDsKIF9fYXNtX18gX192b2xhdGlsZV9fICgi
c3luYyIgOiA6IDogIm1lbW9yeSIpOwogcmV0ID0gYXRvbWljX2luY19yZXR1cm5fcmVsYXhl
ZCh2KTsKIF9fYXNtX18gX192b2xhdGlsZV9fICgic3luYyIgOiA6IDogIm1lbW9yeSIpOwog
cmV0dXJuIHJldDsKfQojIDQwNiAiLi9pbmNsdWRlL2xpbnV4L2F0b21pYy1mYWxsYmFjay5o
IgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBpbnQKYXRv
bWljX2ZldGNoX2luYyhhdG9taWNfdCAqdikKewogcmV0dXJuIGF0b21pY19mZXRjaF9hZGQo
MSwgdik7Cn0KCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVf
XykpIGludAphdG9taWNfZmV0Y2hfaW5jX2FjcXVpcmUoYXRvbWljX3QgKnYpCnsKIHJldHVy
biBhdG9taWNfZmV0Y2hfYWRkX2FjcXVpcmUoMSwgdik7Cn0KCgoKCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0
dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIGludAphdG9taWNfZmV0Y2hfaW5jX3Jl
bGVhc2UoYXRvbWljX3QgKnYpCnsKIHJldHVybiBhdG9taWNfZmV0Y2hfYWRkX3JlbGVhc2Uo
MSwgdik7Cn0KCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVf
XykpIGludAphdG9taWNfZmV0Y2hfaW5jX3JlbGF4ZWQoYXRvbWljX3QgKnYpCnsKIHJldHVy
biBhdG9taWNfZmV0Y2hfYWRkX3JlbGF4ZWQoMSwgdik7Cn0KIyA1NDEgIi4vaW5jbHVkZS9s
aW51eC9hdG9taWMtZmFsbGJhY2suaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3
YXlzX2lubGluZV9fKSkgaW50CmF0b21pY19kZWNfcmV0dXJuX2FjcXVpcmUoYXRvbWljX3Qg
KnYpCnsKIGludCByZXQgPSBhdG9taWNfZGVjX3JldHVybl9yZWxheGVkKHYpOwogX19hc21f
XyBfX3ZvbGF0aWxlX18oIlxuIiAiOTcxOjsgaXN5bmM7IDk3MjogLnB1c2hzZWN0aW9uIF9f
bHdzeW5jX2ZpeHVwLFwiYVwiOyAuYWxpZ24gMjsgOTczOiAuOGJ5dGUgOTcxYi05NzNiOyAu
cG9wc2VjdGlvbjs7IiAiICIgIiIgOiA6IDogIm1lbW9yeSIpOwogcmV0dXJuIHJldDsKfQoK
CgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgaW50CmF0
b21pY19kZWNfcmV0dXJuX3JlbGVhc2UoYXRvbWljX3QgKnYpCnsKIF9fYXNtX18gX192b2xh
dGlsZV9fKCJsd3N5bmMiICIgIiAiXG4iICIiIDogOiA6ICJtZW1vcnkiKTsKIHJldHVybiBh
dG9taWNfZGVjX3JldHVybl9yZWxheGVkKHYpOwp9CgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1
dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBpbnQKYXRvbWljX2RlY19yZXR1cm4oYXRvbWlj
X3QgKnYpCnsKIGludCByZXQ7CiBfX2FzbV9fIF9fdm9sYXRpbGVfXyAoInN5bmMiIDogOiA6
ICJtZW1vcnkiKTsKIHJldCA9IGF0b21pY19kZWNfcmV0dXJuX3JlbGF4ZWQodik7CiBfX2Fz
bV9fIF9fdm9sYXRpbGVfXyAoInN5bmMiIDogOiA6ICJtZW1vcnkiKTsKIHJldHVybiByZXQ7
Cn0KIyA1ODkgIi4vaW5jbHVkZS9saW51eC9hdG9taWMtZmFsbGJhY2suaCIKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgaW50CmF0b21pY19mZXRjaF9k
ZWMoYXRvbWljX3QgKnYpCnsKIHJldHVybiBhdG9taWNfZmV0Y2hfc3ViKDEsIHYpOwp9CgoK
CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBpbnQKYXRv
bWljX2ZldGNoX2RlY19hY3F1aXJlKGF0b21pY190ICp2KQp7CiByZXR1cm4gYXRvbWljX2Zl
dGNoX3N1Yl9hY3F1aXJlKDEsIHYpOwp9CgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygo
X19hbHdheXNfaW5saW5lX18pKSBpbnQKYXRvbWljX2ZldGNoX2RlY19yZWxlYXNlKGF0b21p
Y190ICp2KQp7CiByZXR1cm4gYXRvbWljX2ZldGNoX3N1Yl9yZWxlYXNlKDEsIHYpOwp9CgoK
CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBpbnQKYXRv
bWljX2ZldGNoX2RlY19yZWxheGVkKGF0b21pY190ICp2KQp7CiByZXR1cm4gYXRvbWljX2Zl
dGNoX3N1Yl9yZWxheGVkKDEsIHYpOwp9CiMgNjc2ICIuL2luY2x1ZGUvbGludXgvYXRvbWlj
LWZhbGxiYWNrLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVf
XykpIGludAphdG9taWNfZmV0Y2hfYW5kX2FjcXVpcmUoaW50IGksIGF0b21pY190ICp2KQp7
CiBpbnQgcmV0ID0gYXRvbWljX2ZldGNoX2FuZF9yZWxheGVkKGksIHYpOwogX19hc21fXyBf
X3ZvbGF0aWxlX18oIlxuIiAiOTcxOjsgaXN5bmM7IDk3MjogLnB1c2hzZWN0aW9uIF9fbHdz
eW5jX2ZpeHVwLFwiYVwiOyAuYWxpZ24gMjsgOTczOiAuOGJ5dGUgOTcxYi05NzNiOyAucG9w
c2VjdGlvbjs7IiAiICIgIiIgOiA6IDogIm1lbW9yeSIpOwogcmV0dXJuIHJldDsKfQoKCgoK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgaW50CmF0b21p
Y19mZXRjaF9hbmRfcmVsZWFzZShpbnQgaSwgYXRvbWljX3QgKnYpCnsKIF9fYXNtX18gX192
b2xhdGlsZV9fKCJsd3N5bmMiICIgIiAiXG4iICIiIDogOiA6ICJtZW1vcnkiKTsKIHJldHVy
biBhdG9taWNfZmV0Y2hfYW5kX3JlbGF4ZWQoaSwgdik7Cn0KCgoKCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0
dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIGludAphdG9taWNfZmV0Y2hfYW5kKGlu
dCBpLCBhdG9taWNfdCAqdikKewogaW50IHJldDsKIF9fYXNtX18gX192b2xhdGlsZV9fICgi
c3luYyIgOiA6IDogIm1lbW9yeSIpOwogcmV0ID0gYXRvbWljX2ZldGNoX2FuZF9yZWxheGVk
KGksIHYpOwogX19hc21fXyBfX3ZvbGF0aWxlX18gKCJzeW5jIiA6IDogOiAibWVtb3J5Iik7
CiByZXR1cm4gcmV0Owp9CiMgNzE0ICIuL2luY2x1ZGUvbGludXgvYXRvbWljLWZhbGxiYWNr
LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHZvaWQK
YXRvbWljX2FuZG5vdChpbnQgaSwgYXRvbWljX3QgKnYpCnsKIGF0b21pY19hbmQofmksIHYp
Owp9CiMgNzM1ICIuL2luY2x1ZGUvbGludXgvYXRvbWljLWZhbGxiYWNrLmgiCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIGludAphdG9taWNfZmV0Y2hf
YW5kbm90KGludCBpLCBhdG9taWNfdCAqdikKewogcmV0dXJuIGF0b21pY19mZXRjaF9hbmQo
fmksIHYpOwp9CgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5l
X18pKSBpbnQKYXRvbWljX2ZldGNoX2FuZG5vdF9hY3F1aXJlKGludCBpLCBhdG9taWNfdCAq
dikKewogcmV0dXJuIGF0b21pY19mZXRjaF9hbmRfYWNxdWlyZSh+aSwgdik7Cn0KCgoKCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIGludAphdG9taWNf
ZmV0Y2hfYW5kbm90X3JlbGVhc2UoaW50IGksIGF0b21pY190ICp2KQp7CiByZXR1cm4gYXRv
bWljX2ZldGNoX2FuZF9yZWxlYXNlKH5pLCB2KTsKfQoKCgoKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmli
dXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgaW50CmF0b21pY19mZXRjaF9hbmRub3RfcmVs
YXhlZChpbnQgaSwgYXRvbWljX3QgKnYpCnsKIHJldHVybiBhdG9taWNfZmV0Y2hfYW5kX3Jl
bGF4ZWQofmksIHYpOwp9CiMgODIyICIuL2luY2x1ZGUvbGludXgvYXRvbWljLWZhbGxiYWNr
LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIGludAph
dG9taWNfZmV0Y2hfb3JfYWNxdWlyZShpbnQgaSwgYXRvbWljX3QgKnYpCnsKIGludCByZXQg
PSBhdG9taWNfZmV0Y2hfb3JfcmVsYXhlZChpLCB2KTsKIF9fYXNtX18gX192b2xhdGlsZV9f
KCJcbiIgIjk3MTo7IGlzeW5jOyA5NzI6IC5wdXNoc2VjdGlvbiBfX2x3c3luY19maXh1cCxc
ImFcIjsgLmFsaWduIDI7IDk3MzogLjhieXRlIDk3MWItOTczYjsgLnBvcHNlY3Rpb247OyIg
IiAiICIiIDogOiA6ICJtZW1vcnkiKTsKIHJldHVybiByZXQ7Cn0KCgoKCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBf
X2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIGludAphdG9taWNfZmV0Y2hfb3Jf
cmVsZWFzZShpbnQgaSwgYXRvbWljX3QgKnYpCnsKIF9fYXNtX18gX192b2xhdGlsZV9fKCJs
d3N5bmMiICIgIiAiXG4iICIiIDogOiA6ICJtZW1vcnkiKTsKIHJldHVybiBhdG9taWNfZmV0
Y2hfb3JfcmVsYXhlZChpLCB2KTsKfQoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9f
YWx3YXlzX2lubGluZV9fKSkgaW50CmF0b21pY19mZXRjaF9vcihpbnQgaSwgYXRvbWljX3Qg
KnYpCnsKIGludCByZXQ7CiBfX2FzbV9fIF9fdm9sYXRpbGVfXyAoInN5bmMiIDogOiA6ICJt
ZW1vcnkiKTsKIHJldCA9IGF0b21pY19mZXRjaF9vcl9yZWxheGVkKGksIHYpOwogX19hc21f
XyBfX3ZvbGF0aWxlX18gKCJzeW5jIiA6IDogOiAibWVtb3J5Iik7CiByZXR1cm4gcmV0Owp9
CiMgODcxICIuL2luY2x1ZGUvbGludXgvYXRvbWljLWZhbGxiYWNrLmgiCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBf
X2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIGludAphdG9taWNfZmV0Y2hfeG9y
X2FjcXVpcmUoaW50IGksIGF0b21pY190ICp2KQp7CiBpbnQgcmV0ID0gYXRvbWljX2ZldGNo
X3hvcl9yZWxheGVkKGksIHYpOwogX19hc21fXyBfX3ZvbGF0aWxlX18oIlxuIiAiOTcxOjsg
aXN5bmM7IDk3MjogLnB1c2hzZWN0aW9uIF9fbHdzeW5jX2ZpeHVwLFwiYVwiOyAuYWxpZ24g
MjsgOTczOiAuOGJ5dGUgOTcxYi05NzNiOyAucG9wc2VjdGlvbjs7IiAiICIgIiIgOiA6IDog
Im1lbW9yeSIpOwogcmV0dXJuIHJldDsKfQoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18o
KF9fYWx3YXlzX2lubGluZV9fKSkgaW50CmF0b21pY19mZXRjaF94b3JfcmVsZWFzZShpbnQg
aSwgYXRvbWljX3QgKnYpCnsKIF9fYXNtX18gX192b2xhdGlsZV9fKCJsd3N5bmMiICIgIiAi
XG4iICIiIDogOiA6ICJtZW1vcnkiKTsKIHJldHVybiBhdG9taWNfZmV0Y2hfeG9yX3JlbGF4
ZWQoaSwgdik7Cn0KCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxp
bmVfXykpIGludAphdG9taWNfZmV0Y2hfeG9yKGludCBpLCBhdG9taWNfdCAqdikKewogaW50
IHJldDsKIF9fYXNtX18gX192b2xhdGlsZV9fICgic3luYyIgOiA6IDogIm1lbW9yeSIpOwog
cmV0ID0gYXRvbWljX2ZldGNoX3hvcl9yZWxheGVkKGksIHYpOwogX19hc21fXyBfX3ZvbGF0
aWxlX18gKCJzeW5jIiA6IDogOiAibWVtb3J5Iik7CiByZXR1cm4gcmV0Owp9CiMgOTE4ICIu
L2luY2x1ZGUvbGludXgvYXRvbWljLWZhbGxiYWNrLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0
ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIGludAphdG9taWNfeGNoZ19hY3F1aXJlKGF0b21p
Y190ICp2LCBpbnQgaSkKewogaW50IHJldCA9ICh7IF9fdHlwZW9mX18oKigmKCh2KS0+Y291
bnRlcikpKSBfeF8gPSAoKGkpKTsgKF9fdHlwZW9mX18oKigmKCh2KS0+Y291bnRlcikpKSkg
X194Y2hnX3JlbGF4ZWQoKCYoKHYpLT5jb3VudGVyKSksICh1bnNpZ25lZCBsb25nKV94Xywg
c2l6ZW9mKCooJigodiktPmNvdW50ZXIpKSkpOyB9KTsKIF9fYXNtX18gX192b2xhdGlsZV9f
KCJcbiIgIjk3MTo7IGlzeW5jOyA5NzI6IC5wdXNoc2VjdGlvbiBfX2x3c3luY19maXh1cCxc
ImFcIjsgLmFsaWduIDI7IDk3MzogLjhieXRlIDk3MWItOTczYjsgLnBvcHNlY3Rpb247OyIg
IiAiICIiIDogOiA6ICJtZW1vcnkiKTsKIHJldHVybiByZXQ7Cn0KCgoKCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBf
X2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIGludAphdG9taWNfeGNoZ19yZWxl
YXNlKGF0b21pY190ICp2LCBpbnQgaSkKewogX19hc21fXyBfX3ZvbGF0aWxlX18oImx3c3lu
YyIgIiAiICJcbiIgIiIgOiA6IDogIm1lbW9yeSIpOwogcmV0dXJuICh7IF9fdHlwZW9mX18o
KigmKCh2KS0+Y291bnRlcikpKSBfeF8gPSAoKGkpKTsgKF9fdHlwZW9mX18oKigmKCh2KS0+
Y291bnRlcikpKSkgX194Y2hnX3JlbGF4ZWQoKCYoKHYpLT5jb3VudGVyKSksICh1bnNpZ25l
ZCBsb25nKV94Xywgc2l6ZW9mKCooJigodiktPmNvdW50ZXIpKSkpOyB9KTsKfQojIDk3NiAi
Li9pbmNsdWRlL2xpbnV4L2F0b21pYy1mYWxsYmFjay5oIgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1
dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBpbnQKYXRvbWljX2NtcHhjaGdfcmVsZWFzZShh
dG9taWNfdCAqdiwgaW50IG9sZCwgaW50IG5ldykKewogX19hc21fXyBfX3ZvbGF0aWxlX18o
Imx3c3luYyIgIiAiICJcbiIgIiIgOiA6IDogIm1lbW9yeSIpOwogcmV0dXJuICh7IF9fdHlw
ZW9mX18oKigmKCh2KS0+Y291bnRlcikpKSBfb18gPSAoKG9sZCkpOyBfX3R5cGVvZl9fKCoo
JigodiktPmNvdW50ZXIpKSkgX25fID0gKChuZXcpKTsgKF9fdHlwZW9mX18oKigmKCh2KS0+
Y291bnRlcikpKSkgX19jbXB4Y2hnX3JlbGF4ZWQoKCYoKHYpLT5jb3VudGVyKSksICh1bnNp
Z25lZCBsb25nKV9vXywgKHVuc2lnbmVkIGxvbmcpX25fLCBzaXplb2YoKigmKCh2KS0+Y291
bnRlcikpKSk7IH0pOwp9CiMgMTAxMyAiLi9pbmNsdWRlL2xpbnV4L2F0b21pYy1mYWxsYmFj
ay5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKQoKIyAx
MDEzICIuL2luY2x1ZGUvbGludXgvYXRvbWljLWZhbGxiYWNrLmgiCiAgICAgICAgICAgICAg
ICAgICAgICAgYm9vbAphdG9taWNfdHJ5X2NtcHhjaGcoYXRvbWljX3QgKnYsIGludCAqb2xk
LCBpbnQgbmV3KQp7CiBpbnQgciwgbyA9ICpvbGQ7CiByID0gKCh7IF9fdHlwZW9mX18oKigm
KCh2KS0+Y291bnRlcikpKSBfb18gPSAoKG8pKTsgX190eXBlb2ZfXygqKCYoKHYpLT5jb3Vu
dGVyKSkpIF9uXyA9ICgobmV3KSk7IChfX3R5cGVvZl9fKCooJigodiktPmNvdW50ZXIpKSkp
IF9fY21weGNoZygoJigodiktPmNvdW50ZXIpKSwgKHVuc2lnbmVkIGxvbmcpX29fLCAodW5z
aWduZWQgbG9uZylfbl8sIHNpemVvZigqKCYoKHYpLT5jb3VudGVyKSkpKTsgfSkpOwogaWYg
KF9fYnVpbHRpbl9leHBlY3QoISEociAhPSBvKSwgMCkpCiAgKm9sZCA9IHI7CiByZXR1cm4g
X19idWlsdGluX2V4cGVjdCghIShyID09IG8pLCAxKTsKfQoKCgoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0
cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkKCiMgMTAyNiAiLi9pbmNsdWRlL2xpbnV4
L2F0b21pYy1mYWxsYmFjay5oIgogICAgICAgICAgICAgICAgICAgICAgIGJvb2wKYXRvbWlj
X3RyeV9jbXB4Y2hnX2FjcXVpcmUoYXRvbWljX3QgKnYsIGludCAqb2xkLCBpbnQgbmV3KQp7
CiBpbnQgciwgbyA9ICpvbGQ7CiByID0gKHsgX190eXBlb2ZfXygqKCYoKHYpLT5jb3VudGVy
KSkpIF9vXyA9ICgobykpOyBfX3R5cGVvZl9fKCooJigodiktPmNvdW50ZXIpKSkgX25fID0g
KChuZXcpKTsgKF9fdHlwZW9mX18oKigmKCh2KS0+Y291bnRlcikpKSkgX19jbXB4Y2hnX2Fj
cXVpcmUoKCYoKHYpLT5jb3VudGVyKSksICh1bnNpZ25lZCBsb25nKV9vXywgKHVuc2lnbmVk
IGxvbmcpX25fLCBzaXplb2YoKigmKCh2KS0+Y291bnRlcikpKSk7IH0pOwogaWYgKF9fYnVp
bHRpbl9leHBlY3QoISEociAhPSBvKSwgMCkpCiAgKm9sZCA9IHI7CiByZXR1cm4gX19idWls
dGluX2V4cGVjdCghIShyID09IG8pLCAxKTsKfQoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRl
X18oKF9fYWx3YXlzX2lubGluZV9fKSkKCiMgMTAzOSAiLi9pbmNsdWRlL2xpbnV4L2F0b21p
Yy1mYWxsYmFjay5oIgogICAgICAgICAgICAgICAgICAgICAgIGJvb2wKYXRvbWljX3RyeV9j
bXB4Y2hnX3JlbGVhc2UoYXRvbWljX3QgKnYsIGludCAqb2xkLCBpbnQgbmV3KQp7CiBpbnQg
ciwgbyA9ICpvbGQ7CiByID0gYXRvbWljX2NtcHhjaGdfcmVsZWFzZSh2LCBvLCBuZXcpOwog
aWYgKF9fYnVpbHRpbl9leHBlY3QoISEociAhPSBvKSwgMCkpCiAgKm9sZCA9IHI7CiByZXR1
cm4gX19idWlsdGluX2V4cGVjdCghIShyID09IG8pLCAxKTsKfQoKCgoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9f
YXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkKCiMgMTA1MiAiLi9pbmNsdWRlL2xp
bnV4L2F0b21pYy1mYWxsYmFjay5oIgogICAgICAgICAgICAgICAgICAgICAgIGJvb2wKYXRv
bWljX3RyeV9jbXB4Y2hnX3JlbGF4ZWQoYXRvbWljX3QgKnYsIGludCAqb2xkLCBpbnQgbmV3
KQp7CiBpbnQgciwgbyA9ICpvbGQ7CiByID0gKHsgX190eXBlb2ZfXygqKCYoKHYpLT5jb3Vu
dGVyKSkpIF9vXyA9ICgobykpOyBfX3R5cGVvZl9fKCooJigodiktPmNvdW50ZXIpKSkgX25f
ID0gKChuZXcpKTsgKF9fdHlwZW9mX18oKigmKCh2KS0+Y291bnRlcikpKSkgX19jbXB4Y2hn
X3JlbGF4ZWQoKCYoKHYpLT5jb3VudGVyKSksICh1bnNpZ25lZCBsb25nKV9vXywgKHVuc2ln
bmVkIGxvbmcpX25fLCBzaXplb2YoKigmKCh2KS0+Y291bnRlcikpKSk7IH0pOwogaWYgKF9f
YnVpbHRpbl9leHBlY3QoISEociAhPSBvKSwgMCkpCiAgKm9sZCA9IHI7CiByZXR1cm4gX19i
dWlsdGluX2V4cGVjdCghIShyID09IG8pLCAxKTsKfQojIDExMTQgIi4vaW5jbHVkZS9saW51
eC9hdG9taWMtZmFsbGJhY2suaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlz
X2lubGluZV9fKSkKCiMgMTExNCAiLi9pbmNsdWRlL2xpbnV4L2F0b21pYy1mYWxsYmFjay5o
IgogICAgICAgICAgICAgICAgICAgICAgIGJvb2wKYXRvbWljX3N1Yl9hbmRfdGVzdChpbnQg
aSwgYXRvbWljX3QgKnYpCnsKIHJldHVybiBhdG9taWNfc3ViX3JldHVybihpLCB2KSA9PSAw
Owp9CiMgMTEzMyAiLi9pbmNsdWRlL2xpbnV4L2F0b21pYy1mYWxsYmFjay5oIgpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKQoKIyAxMTMzICIuL2luY2x1
ZGUvbGludXgvYXRvbWljLWZhbGxiYWNrLmgiCiAgICAgICAgICAgICAgICAgICAgICAgYm9v
bAphdG9taWNfZGVjX2FuZF90ZXN0KGF0b21pY190ICp2KQp7CiByZXR1cm4gYXRvbWljX2Rl
Y19yZXR1cm4odikgPT0gMDsKfQojIDExNTIgIi4vaW5jbHVkZS9saW51eC9hdG9taWMtZmFs
bGJhY2suaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkK
CiMgMTE1MiAiLi9pbmNsdWRlL2xpbnV4L2F0b21pYy1mYWxsYmFjay5oIgogICAgICAgICAg
ICAgICAgICAgICAgIGJvb2wKYXRvbWljX2luY19hbmRfdGVzdChhdG9taWNfdCAqdikKewog
cmV0dXJuIGF0b21pY19pbmNfcmV0dXJuKHYpID09IDA7Cn0KIyAxMTcyICIuL2luY2x1ZGUv
bGludXgvYXRvbWljLWZhbGxiYWNrLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fs
d2F5c19pbmxpbmVfXykpCgojIDExNzIgIi4vaW5jbHVkZS9saW51eC9hdG9taWMtZmFsbGJh
Y2suaCIKICAgICAgICAgICAgICAgICAgICAgICBib29sCmF0b21pY19hZGRfbmVnYXRpdmUo
aW50IGksIGF0b21pY190ICp2KQp7CiByZXR1cm4gYXRvbWljX2FkZF9yZXR1cm4oaSwgdikg
PCAwOwp9CiMgMTIxOSAiLi9pbmNsdWRlL2xpbnV4L2F0b21pYy1mYWxsYmFjay5oIgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKQoKIyAxMjE5ICIuL2lu
Y2x1ZGUvbGludXgvYXRvbWljLWZhbGxiYWNrLmgiCiAgICAgICAgICAgICAgICAgICAgICAg
Ym9vbAphdG9taWNfYWRkX3VubGVzcyhhdG9taWNfdCAqdiwgaW50IGEsIGludCB1KQp7CiBy
ZXR1cm4gYXRvbWljX2ZldGNoX2FkZF91bmxlc3ModiwgYSwgdSkgIT0gdTsKfQojIDEyNDgg
Ii4vaW5jbHVkZS9saW51eC9hdG9taWMtZmFsbGJhY2suaCIKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmli
dXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkKCiMgMTI0OCAiLi9pbmNsdWRlL2xpbnV4L2F0
b21pYy1mYWxsYmFjay5oIgogICAgICAgICAgICAgICAgICAgICAgIGJvb2wKYXRvbWljX2lu
Y191bmxlc3NfbmVnYXRpdmUoYXRvbWljX3QgKnYpCnsKIGludCBjID0gYXRvbWljX3JlYWQo
dik7CgogZG8gewogIGlmIChfX2J1aWx0aW5fZXhwZWN0KCEhKGMgPCAwKSwgMCkpCiAgIHJl
dHVybiBmYWxzZTsKIH0gd2hpbGUgKCFhdG9taWNfdHJ5X2NtcHhjaGcodiwgJmMsIGMgKyAx
KSk7CgogcmV0dXJuIHRydWU7Cn0KCgoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9f
YWx3YXlzX2lubGluZV9fKSkKCiMgMTI2NiAiLi9pbmNsdWRlL2xpbnV4L2F0b21pYy1mYWxs
YmFjay5oIgogICAgICAgICAgICAgICAgICAgICAgIGJvb2wKYXRvbWljX2RlY191bmxlc3Nf
cG9zaXRpdmUoYXRvbWljX3QgKnYpCnsKIGludCBjID0gYXRvbWljX3JlYWQodik7CgogZG8g
ewogIGlmIChfX2J1aWx0aW5fZXhwZWN0KCEhKGMgPiAwKSwgMCkpCiAgIHJldHVybiBmYWxz
ZTsKIH0gd2hpbGUgKCFhdG9taWNfdHJ5X2NtcHhjaGcodiwgJmMsIGMgLSAxKSk7CgogcmV0
dXJuIHRydWU7Cn0KIyAxMzA4ICIuL2luY2x1ZGUvbGludXgvYXRvbWljLWZhbGxiYWNrLmgi
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHM2NAphdG9t
aWM2NF9yZWFkX2FjcXVpcmUoY29uc3QgYXRvbWljNjRfdCAqdikKewogcmV0dXJuICh7IHR5
cGVvZigqJih2KS0+Y291bnRlcikgX19fcDEgPSAoeyBkbyB7IGV4dGVybiB2b2lkIF9fY29t
cGlsZXRpbWVfYXNzZXJ0XzMwKHZvaWQpIF9fYXR0cmlidXRlX18oKF9fZXJyb3JfXygiVW5z
dXBwb3J0ZWQgYWNjZXNzIHNpemUgZm9yIHtSRUFELFdSSVRFfV9PTkNFKCkuIikpKTsgaWYg
KCEoKHNpemVvZigqJih2KS0+Y291bnRlcikgPT0gc2l6ZW9mKGNoYXIpIHx8IHNpemVvZigq
Jih2KS0+Y291bnRlcikgPT0gc2l6ZW9mKHNob3J0KSB8fCBzaXplb2YoKiYodiktPmNvdW50
ZXIpID09IHNpemVvZihpbnQpIHx8IHNpemVvZigqJih2KS0+Y291bnRlcikgPT0gc2l6ZW9m
KGxvbmcpKSB8fCBzaXplb2YoKiYodiktPmNvdW50ZXIpID09IHNpemVvZihsb25nIGxvbmcp
KSkgX19jb21waWxldGltZV9hc3NlcnRfMzAoKTsgfSB3aGlsZSAoMCk7ICh7IHR5cGVvZigg
X0dlbmVyaWMoKComKHYpLT5jb3VudGVyKSwgY2hhcjogKGNoYXIpMCwgdW5zaWduZWQgY2hh
cjogKHVuc2lnbmVkIGNoYXIpMCwgc2lnbmVkIGNoYXI6IChzaWduZWQgY2hhcikwLCB1bnNp
Z25lZCBzaG9ydDogKHVuc2lnbmVkIHNob3J0KTAsIHNpZ25lZCBzaG9ydDogKHNpZ25lZCBz
aG9ydCkwLCB1bnNpZ25lZCBpbnQ6ICh1bnNpZ25lZCBpbnQpMCwgc2lnbmVkIGludDogKHNp
Z25lZCBpbnQpMCwgdW5zaWduZWQgbG9uZzogKHVuc2lnbmVkIGxvbmcpMCwgc2lnbmVkIGxv
bmc6IChzaWduZWQgbG9uZykwLCB1bnNpZ25lZCBsb25nIGxvbmc6ICh1bnNpZ25lZCBsb25n
IGxvbmcpMCwgc2lnbmVkIGxvbmcgbG9uZzogKHNpZ25lZCBsb25nIGxvbmcpMCwgZGVmYXVs
dDogKComKHYpLT5jb3VudGVyKSkpIF9feCA9ICgqKGNvbnN0IHZvbGF0aWxlIHR5cGVvZigg
X0dlbmVyaWMoKComKHYpLT5jb3VudGVyKSwgY2hhcjogKGNoYXIpMCwgdW5zaWduZWQgY2hh
cjogKHVuc2lnbmVkIGNoYXIpMCwgc2lnbmVkIGNoYXI6IChzaWduZWQgY2hhcikwLCB1bnNp
Z25lZCBzaG9ydDogKHVuc2lnbmVkIHNob3J0KTAsIHNpZ25lZCBzaG9ydDogKHNpZ25lZCBz
aG9ydCkwLCB1bnNpZ25lZCBpbnQ6ICh1bnNpZ25lZCBpbnQpMCwgc2lnbmVkIGludDogKHNp
Z25lZCBpbnQpMCwgdW5zaWduZWQgbG9uZzogKHVuc2lnbmVkIGxvbmcpMCwgc2lnbmVkIGxv
bmc6IChzaWduZWQgbG9uZykwLCB1bnNpZ25lZCBsb25nIGxvbmc6ICh1bnNpZ25lZCBsb25n
IGxvbmcpMCwgc2lnbmVkIGxvbmcgbG9uZzogKHNpZ25lZCBsb25nIGxvbmcpMCwgZGVmYXVs
dDogKComKHYpLT5jb3VudGVyKSkpICopJigqJih2KS0+Y291bnRlcikpOyBkbyB7IH0gd2hp
bGUgKDApOyAodHlwZW9mKComKHYpLT5jb3VudGVyKSlfX3g7IH0pOyB9KTsgZG8geyBleHRl
cm4gdm9pZCBfX2NvbXBpbGV0aW1lX2Fzc2VydF8zMSh2b2lkKSBfX2F0dHJpYnV0ZV9fKChf
X2Vycm9yX18oIk5lZWQgbmF0aXZlIHdvcmQgc2l6ZWQgc3RvcmVzL2xvYWRzIGZvciBhdG9t
aWNpdHkuIikpKTsgaWYgKCEoKHNpemVvZigqJih2KS0+Y291bnRlcikgPT0gc2l6ZW9mKGNo
YXIpIHx8IHNpemVvZigqJih2KS0+Y291bnRlcikgPT0gc2l6ZW9mKHNob3J0KSB8fCBzaXpl
b2YoKiYodiktPmNvdW50ZXIpID09IHNpemVvZihpbnQpIHx8IHNpemVvZigqJih2KS0+Y291
bnRlcikgPT0gc2l6ZW9mKGxvbmcpKSkpIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzMxKCk7IH0g
d2hpbGUgKDApOyBfX2FzbV9fIF9fdm9sYXRpbGVfXyAoImx3c3luYyIgIiAiIDogOiA6Im1l
bW9yeSIpOyBfX19wMTsgfSk7Cn0KCgoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChf
X2Fsd2F5c19pbmxpbmVfXykpIHZvaWQKYXRvbWljNjRfc2V0X3JlbGVhc2UoYXRvbWljNjRf
dCAqdiwgczY0IGkpCnsKIGRvIHsgZG8geyBleHRlcm4gdm9pZCBfX2NvbXBpbGV0aW1lX2Fz
c2VydF8zMih2b2lkKSBfX2F0dHJpYnV0ZV9fKChfX2Vycm9yX18oIk5lZWQgbmF0aXZlIHdv
cmQgc2l6ZWQgc3RvcmVzL2xvYWRzIGZvciBhdG9taWNpdHkuIikpKTsgaWYgKCEoKHNpemVv
ZigqJih2KS0+Y291bnRlcikgPT0gc2l6ZW9mKGNoYXIpIHx8IHNpemVvZigqJih2KS0+Y291
bnRlcikgPT0gc2l6ZW9mKHNob3J0KSB8fCBzaXplb2YoKiYodiktPmNvdW50ZXIpID09IHNp
emVvZihpbnQpIHx8IHNpemVvZigqJih2KS0+Y291bnRlcikgPT0gc2l6ZW9mKGxvbmcpKSkp
IF9fY29tcGlsZXRpbWVfYXNzZXJ0XzMyKCk7IH0gd2hpbGUgKDApOyBfX2FzbV9fIF9fdm9s
YXRpbGVfXyAoImx3c3luYyIgIiAiIDogOiA6Im1lbW9yeSIpOyBkbyB7IGRvIHsgZXh0ZXJu
IHZvaWQgX19jb21waWxldGltZV9hc3NlcnRfMzModm9pZCkgX19hdHRyaWJ1dGVfXygoX19l
cnJvcl9fKCJVbnN1cHBvcnRlZCBhY2Nlc3Mgc2l6ZSBmb3Ige1JFQUQsV1JJVEV9X09OQ0Uo
KS4iKSkpOyBpZiAoISgoc2l6ZW9mKComKHYpLT5jb3VudGVyKSA9PSBzaXplb2YoY2hhcikg
fHwgc2l6ZW9mKComKHYpLT5jb3VudGVyKSA9PSBzaXplb2Yoc2hvcnQpIHx8IHNpemVvZigq
Jih2KS0+Y291bnRlcikgPT0gc2l6ZW9mKGludCkgfHwgc2l6ZW9mKComKHYpLT5jb3VudGVy
KSA9PSBzaXplb2YobG9uZykpIHx8IHNpemVvZigqJih2KS0+Y291bnRlcikgPT0gc2l6ZW9m
KGxvbmcgbG9uZykpKSBfX2NvbXBpbGV0aW1lX2Fzc2VydF8zMygpOyB9IHdoaWxlICgwKTsg
ZG8geyAqKHZvbGF0aWxlIHR5cGVvZigqJih2KS0+Y291bnRlcikgKikmKComKHYpLT5jb3Vu
dGVyKSA9IChpKTsgfSB3aGlsZSAoMCk7IH0gd2hpbGUgKDApOyB9IHdoaWxlICgwKTsKfQoj
IDEzNDIgIi4vaW5jbHVkZS9saW51eC9hdG9taWMtZmFsbGJhY2suaCIKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9f
YXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgczY0CmF0b21pYzY0X2FkZF9yZXR1
cm5fYWNxdWlyZShzNjQgaSwgYXRvbWljNjRfdCAqdikKewogczY0IHJldCA9IGF0b21pYzY0
X2FkZF9yZXR1cm5fcmVsYXhlZChpLCB2KTsKIF9fYXNtX18gX192b2xhdGlsZV9fKCJcbiIg
Ijk3MTo7IGlzeW5jOyA5NzI6IC5wdXNoc2VjdGlvbiBfX2x3c3luY19maXh1cCxcImFcIjsg
LmFsaWduIDI7IDk3MzogLjhieXRlIDk3MWItOTczYjsgLnBvcHNlY3Rpb247OyIgIiAiICIi
IDogOiA6ICJtZW1vcnkiKTsKIHJldHVybiByZXQ7Cn0KCgoKCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJp
YnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHM2NAphdG9taWM2NF9hZGRfcmV0dXJuX3Jl
bGVhc2UoczY0IGksIGF0b21pYzY0X3QgKnYpCnsKIF9fYXNtX18gX192b2xhdGlsZV9fKCJs
d3N5bmMiICIgIiAiXG4iICIiIDogOiA6ICJtZW1vcnkiKTsKIHJldHVybiBhdG9taWM2NF9h
ZGRfcmV0dXJuX3JlbGF4ZWQoaSwgdik7Cn0KCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9f
KChfX2Fsd2F5c19pbmxpbmVfXykpIHM2NAphdG9taWM2NF9hZGRfcmV0dXJuKHM2NCBpLCBh
dG9taWM2NF90ICp2KQp7CiBzNjQgcmV0OwogX19hc21fXyBfX3ZvbGF0aWxlX18gKCJzeW5j
IiA6IDogOiAibWVtb3J5Iik7CiByZXQgPSBhdG9taWM2NF9hZGRfcmV0dXJuX3JlbGF4ZWQo
aSwgdik7CiBfX2FzbV9fIF9fdm9sYXRpbGVfXyAoInN5bmMiIDogOiA6ICJtZW1vcnkiKTsK
IHJldHVybiByZXQ7Cn0KIyAxMzg5ICIuL2luY2x1ZGUvbGludXgvYXRvbWljLWZhbGxiYWNr
LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHM2NAph
dG9taWM2NF9mZXRjaF9hZGRfYWNxdWlyZShzNjQgaSwgYXRvbWljNjRfdCAqdikKewogczY0
IHJldCA9IGF0b21pYzY0X2ZldGNoX2FkZF9yZWxheGVkKGksIHYpOwogX19hc21fXyBfX3Zv
bGF0aWxlX18oIlxuIiAiOTcxOjsgaXN5bmM7IDk3MjogLnB1c2hzZWN0aW9uIF9fbHdzeW5j
X2ZpeHVwLFwiYVwiOyAuYWxpZ24gMjsgOTczOiAuOGJ5dGUgOTcxYi05NzNiOyAucG9wc2Vj
dGlvbjs7IiAiICIgIiIgOiA6IDogIm1lbW9yeSIpOwogcmV0dXJuIHJldDsKfQoKCgoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgczY0CmF0b21pYzY0
X2ZldGNoX2FkZF9yZWxlYXNlKHM2NCBpLCBhdG9taWM2NF90ICp2KQp7CiBfX2FzbV9fIF9f
dm9sYXRpbGVfXygibHdzeW5jIiAiICIgIlxuIiAiIiA6IDogOiAibWVtb3J5Iik7CiByZXR1
cm4gYXRvbWljNjRfZmV0Y2hfYWRkX3JlbGF4ZWQoaSwgdik7Cn0KCgoKCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBf
X2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHM2NAphdG9taWM2NF9mZXRjaF9h
ZGQoczY0IGksIGF0b21pYzY0X3QgKnYpCnsKIHM2NCByZXQ7CiBfX2FzbV9fIF9fdm9sYXRp
bGVfXyAoInN5bmMiIDogOiA6ICJtZW1vcnkiKTsKIHJldCA9IGF0b21pYzY0X2ZldGNoX2Fk
ZF9yZWxheGVkKGksIHYpOwogX19hc21fXyBfX3ZvbGF0aWxlX18gKCJzeW5jIiA6IDogOiAi
bWVtb3J5Iik7CiByZXR1cm4gcmV0Owp9CiMgMTQzOCAiLi9pbmNsdWRlL2xpbnV4L2F0b21p
Yy1mYWxsYmFjay5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5l
X18pKSBzNjQKYXRvbWljNjRfc3ViX3JldHVybl9hY3F1aXJlKHM2NCBpLCBhdG9taWM2NF90
ICp2KQp7CiBzNjQgcmV0ID0gYXRvbWljNjRfc3ViX3JldHVybl9yZWxheGVkKGksIHYpOwog
X19hc21fXyBfX3ZvbGF0aWxlX18oIlxuIiAiOTcxOjsgaXN5bmM7IDk3MjogLnB1c2hzZWN0
aW9uIF9fbHdzeW5jX2ZpeHVwLFwiYVwiOyAuYWxpZ24gMjsgOTczOiAuOGJ5dGUgOTcxYi05
NzNiOyAucG9wc2VjdGlvbjs7IiAiICIgIiIgOiA6IDogIm1lbW9yeSIpOwogcmV0dXJuIHJl
dDsKfQoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkg
czY0CmF0b21pYzY0X3N1Yl9yZXR1cm5fcmVsZWFzZShzNjQgaSwgYXRvbWljNjRfdCAqdikK
ewogX19hc21fXyBfX3ZvbGF0aWxlX18oImx3c3luYyIgIiAiICJcbiIgIiIgOiA6IDogIm1l
bW9yeSIpOwogcmV0dXJuIGF0b21pYzY0X3N1Yl9yZXR1cm5fcmVsYXhlZChpLCB2KTsKfQoK
CgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgczY0CmF0
b21pYzY0X3N1Yl9yZXR1cm4oczY0IGksIGF0b21pYzY0X3QgKnYpCnsKIHM2NCByZXQ7CiBf
X2FzbV9fIF9fdm9sYXRpbGVfXyAoInN5bmMiIDogOiA6ICJtZW1vcnkiKTsKIHJldCA9IGF0
b21pYzY0X3N1Yl9yZXR1cm5fcmVsYXhlZChpLCB2KTsKIF9fYXNtX18gX192b2xhdGlsZV9f
ICgic3luYyIgOiA6IDogIm1lbW9yeSIpOwogcmV0dXJuIHJldDsKfQojIDE0ODUgIi4vaW5j
bHVkZS9saW51eC9hdG9taWMtZmFsbGJhY2suaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18o
KF9fYWx3YXlzX2lubGluZV9fKSkgczY0CmF0b21pYzY0X2ZldGNoX3N1Yl9hY3F1aXJlKHM2
NCBpLCBhdG9taWM2NF90ICp2KQp7CiBzNjQgcmV0ID0gYXRvbWljNjRfZmV0Y2hfc3ViX3Jl
bGF4ZWQoaSwgdik7CiBfX2FzbV9fIF9fdm9sYXRpbGVfXygiXG4iICI5NzE6OyBpc3luYzsg
OTcyOiAucHVzaHNlY3Rpb24gX19sd3N5bmNfZml4dXAsXCJhXCI7IC5hbGlnbiAyOyA5NzM6
IC44Ynl0ZSA5NzFiLTk3M2I7IC5wb3BzZWN0aW9uOzsiICIgIiAiIiA6IDogOiAibWVtb3J5
Iik7CiByZXR1cm4gcmV0Owp9CgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdh
eXNfaW5saW5lX18pKSBzNjQKYXRvbWljNjRfZmV0Y2hfc3ViX3JlbGVhc2UoczY0IGksIGF0
b21pYzY0X3QgKnYpCnsKIF9fYXNtX18gX192b2xhdGlsZV9fKCJsd3N5bmMiICIgIiAiXG4i
ICIiIDogOiA6ICJtZW1vcnkiKTsKIHJldHVybiBhdG9taWM2NF9mZXRjaF9zdWJfcmVsYXhl
ZChpLCB2KTsKfQoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGlu
ZV9fKSkgczY0CmF0b21pYzY0X2ZldGNoX3N1YihzNjQgaSwgYXRvbWljNjRfdCAqdikKewog
czY0IHJldDsKIF9fYXNtX18gX192b2xhdGlsZV9fICgic3luYyIgOiA6IDogIm1lbW9yeSIp
OwogcmV0ID0gYXRvbWljNjRfZmV0Y2hfc3ViX3JlbGF4ZWQoaSwgdik7CiBfX2FzbV9fIF9f
dm9sYXRpbGVfXyAoInN5bmMiIDogOiA6ICJtZW1vcnkiKTsKIHJldHVybiByZXQ7Cn0KIyAx
NTgyICIuL2luY2x1ZGUvbGludXgvYXRvbWljLWZhbGxiYWNrLmgiCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0
dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHM2NAphdG9taWM2NF9pbmNfcmV0dXJu
X2FjcXVpcmUoYXRvbWljNjRfdCAqdikKewogczY0IHJldCA9IGF0b21pYzY0X2luY19yZXR1
cm5fcmVsYXhlZCh2KTsKIF9fYXNtX18gX192b2xhdGlsZV9fKCJcbiIgIjk3MTo7IGlzeW5j
OyA5NzI6IC5wdXNoc2VjdGlvbiBfX2x3c3luY19maXh1cCxcImFcIjsgLmFsaWduIDI7IDk3
MzogLjhieXRlIDk3MWItOTczYjsgLnBvcHNlY3Rpb247OyIgIiAiICIiIDogOiA6ICJtZW1v
cnkiKTsKIHJldHVybiByZXQ7Cn0KCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fs
d2F5c19pbmxpbmVfXykpIHM2NAphdG9taWM2NF9pbmNfcmV0dXJuX3JlbGVhc2UoYXRvbWlj
NjRfdCAqdikKewogX19hc21fXyBfX3ZvbGF0aWxlX18oImx3c3luYyIgIiAiICJcbiIgIiIg
OiA6IDogIm1lbW9yeSIpOwogcmV0dXJuIGF0b21pYzY0X2luY19yZXR1cm5fcmVsYXhlZCh2
KTsKfQoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkg
czY0CmF0b21pYzY0X2luY19yZXR1cm4oYXRvbWljNjRfdCAqdikKewogczY0IHJldDsKIF9f
YXNtX18gX192b2xhdGlsZV9fICgic3luYyIgOiA6IDogIm1lbW9yeSIpOwogcmV0ID0gYXRv
bWljNjRfaW5jX3JldHVybl9yZWxheGVkKHYpOwogX19hc21fXyBfX3ZvbGF0aWxlX18gKCJz
eW5jIiA6IDogOiAibWVtb3J5Iik7CiByZXR1cm4gcmV0Owp9CiMgMTYzMCAiLi9pbmNsdWRl
L2xpbnV4L2F0b21pYy1mYWxsYmFjay5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19h
bHdheXNfaW5saW5lX18pKSBzNjQKYXRvbWljNjRfZmV0Y2hfaW5jKGF0b21pYzY0X3QgKnYp
CnsKIHJldHVybiBhdG9taWM2NF9mZXRjaF9hZGQoMSwgdik7Cn0KCgoKCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBf
X2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHM2NAphdG9taWM2NF9mZXRjaF9p
bmNfYWNxdWlyZShhdG9taWM2NF90ICp2KQp7CiByZXR1cm4gYXRvbWljNjRfZmV0Y2hfYWRk
X2FjcXVpcmUoMSwgdik7Cn0KCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5
c19pbmxpbmVfXykpIHM2NAphdG9taWM2NF9mZXRjaF9pbmNfcmVsZWFzZShhdG9taWM2NF90
ICp2KQp7CiByZXR1cm4gYXRvbWljNjRfZmV0Y2hfYWRkX3JlbGVhc2UoMSwgdik7Cn0KCgoK
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHM2NAphdG9t
aWM2NF9mZXRjaF9pbmNfcmVsYXhlZChhdG9taWM2NF90ICp2KQp7CiByZXR1cm4gYXRvbWlj
NjRfZmV0Y2hfYWRkX3JlbGF4ZWQoMSwgdik7Cn0KIyAxNzY1ICIuL2luY2x1ZGUvbGludXgv
YXRvbWljLWZhbGxiYWNrLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19p
bmxpbmVfXykpIHM2NAphdG9taWM2NF9kZWNfcmV0dXJuX2FjcXVpcmUoYXRvbWljNjRfdCAq
dikKewogczY0IHJldCA9IGF0b21pYzY0X2RlY19yZXR1cm5fcmVsYXhlZCh2KTsKIF9fYXNt
X18gX192b2xhdGlsZV9fKCJcbiIgIjk3MTo7IGlzeW5jOyA5NzI6IC5wdXNoc2VjdGlvbiBf
X2x3c3luY19maXh1cCxcImFcIjsgLmFsaWduIDI7IDk3MzogLjhieXRlIDk3MWItOTczYjsg
LnBvcHNlY3Rpb247OyIgIiAiICIiIDogOiA6ICJtZW1vcnkiKTsKIHJldHVybiByZXQ7Cn0K
CgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHM2NAph
dG9taWM2NF9kZWNfcmV0dXJuX3JlbGVhc2UoYXRvbWljNjRfdCAqdikKewogX19hc21fXyBf
X3ZvbGF0aWxlX18oImx3c3luYyIgIiAiICJcbiIgIiIgOiA6IDogIm1lbW9yeSIpOwogcmV0
dXJuIGF0b21pYzY0X2RlY19yZXR1cm5fcmVsYXhlZCh2KTsKfQoKCgoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9f
YXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgczY0CmF0b21pYzY0X2RlY19yZXR1
cm4oYXRvbWljNjRfdCAqdikKewogczY0IHJldDsKIF9fYXNtX18gX192b2xhdGlsZV9fICgi
c3luYyIgOiA6IDogIm1lbW9yeSIpOwogcmV0ID0gYXRvbWljNjRfZGVjX3JldHVybl9yZWxh
eGVkKHYpOwogX19hc21fXyBfX3ZvbGF0aWxlX18gKCJzeW5jIiA6IDogOiAibWVtb3J5Iik7
CiByZXR1cm4gcmV0Owp9CiMgMTgxMyAiLi9pbmNsdWRlL2xpbnV4L2F0b21pYy1mYWxsYmFj
ay5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBzNjQK
YXRvbWljNjRfZmV0Y2hfZGVjKGF0b21pYzY0X3QgKnYpCnsKIHJldHVybiBhdG9taWM2NF9m
ZXRjaF9zdWIoMSwgdik7Cn0KCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5
c19pbmxpbmVfXykpIHM2NAphdG9taWM2NF9mZXRjaF9kZWNfYWNxdWlyZShhdG9taWM2NF90
ICp2KQp7CiByZXR1cm4gYXRvbWljNjRfZmV0Y2hfc3ViX2FjcXVpcmUoMSwgdik7Cn0KCgoK
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHM2NAphdG9t
aWM2NF9mZXRjaF9kZWNfcmVsZWFzZShhdG9taWM2NF90ICp2KQp7CiByZXR1cm4gYXRvbWlj
NjRfZmV0Y2hfc3ViX3JlbGVhc2UoMSwgdik7Cn0KCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0
ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHM2NAphdG9taWM2NF9mZXRjaF9kZWNfcmVsYXhl
ZChhdG9taWM2NF90ICp2KQp7CiByZXR1cm4gYXRvbWljNjRfZmV0Y2hfc3ViX3JlbGF4ZWQo
MSwgdik7Cn0KIyAxOTAwICIuL2luY2x1ZGUvbGludXgvYXRvbWljLWZhbGxiYWNrLmgiCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHM2NAphdG9taWM2
NF9mZXRjaF9hbmRfYWNxdWlyZShzNjQgaSwgYXRvbWljNjRfdCAqdikKewogczY0IHJldCA9
IGF0b21pYzY0X2ZldGNoX2FuZF9yZWxheGVkKGksIHYpOwogX19hc21fXyBfX3ZvbGF0aWxl
X18oIlxuIiAiOTcxOjsgaXN5bmM7IDk3MjogLnB1c2hzZWN0aW9uIF9fbHdzeW5jX2ZpeHVw
LFwiYVwiOyAuYWxpZ24gMjsgOTczOiAuOGJ5dGUgOTcxYi05NzNiOyAucG9wc2VjdGlvbjs7
IiAiICIgIiIgOiA6IDogIm1lbW9yeSIpOwogcmV0dXJuIHJldDsKfQoKCgoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgczY0CmF0b21pYzY0X2ZldGNo
X2FuZF9yZWxlYXNlKHM2NCBpLCBhdG9taWM2NF90ICp2KQp7CiBfX2FzbV9fIF9fdm9sYXRp
bGVfXygibHdzeW5jIiAiICIgIlxuIiAiIiA6IDogOiAibWVtb3J5Iik7CiByZXR1cm4gYXRv
bWljNjRfZmV0Y2hfYW5kX3JlbGF4ZWQoaSwgdik7Cn0KCgoKCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJp
YnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHM2NAphdG9taWM2NF9mZXRjaF9hbmQoczY0
IGksIGF0b21pYzY0X3QgKnYpCnsKIHM2NCByZXQ7CiBfX2FzbV9fIF9fdm9sYXRpbGVfXyAo
InN5bmMiIDogOiA6ICJtZW1vcnkiKTsKIHJldCA9IGF0b21pYzY0X2ZldGNoX2FuZF9yZWxh
eGVkKGksIHYpOwogX19hc21fXyBfX3ZvbGF0aWxlX18gKCJzeW5jIiA6IDogOiAibWVtb3J5
Iik7CiByZXR1cm4gcmV0Owp9CiMgMTkzOCAiLi9pbmNsdWRlL2xpbnV4L2F0b21pYy1mYWxs
YmFjay5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB2
b2lkCmF0b21pYzY0X2FuZG5vdChzNjQgaSwgYXRvbWljNjRfdCAqdikKewogYXRvbWljNjRf
YW5kKH5pLCB2KTsKfQojIDE5NTkgIi4vaW5jbHVkZS9saW51eC9hdG9taWMtZmFsbGJhY2su
aCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgczY0CmF0
b21pYzY0X2ZldGNoX2FuZG5vdChzNjQgaSwgYXRvbWljNjRfdCAqdikKewogcmV0dXJuIGF0
b21pYzY0X2ZldGNoX2FuZCh+aSwgdik7Cn0KCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9f
KChfX2Fsd2F5c19pbmxpbmVfXykpIHM2NAphdG9taWM2NF9mZXRjaF9hbmRub3RfYWNxdWly
ZShzNjQgaSwgYXRvbWljNjRfdCAqdikKewogcmV0dXJuIGF0b21pYzY0X2ZldGNoX2FuZF9h
Y3F1aXJlKH5pLCB2KTsKfQoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlz
X2lubGluZV9fKSkgczY0CmF0b21pYzY0X2ZldGNoX2FuZG5vdF9yZWxlYXNlKHM2NCBpLCBh
dG9taWM2NF90ICp2KQp7CiByZXR1cm4gYXRvbWljNjRfZmV0Y2hfYW5kX3JlbGVhc2Uofmks
IHYpOwp9CgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18p
KSBzNjQKYXRvbWljNjRfZmV0Y2hfYW5kbm90X3JlbGF4ZWQoczY0IGksIGF0b21pYzY0X3Qg
KnYpCnsKIHJldHVybiBhdG9taWM2NF9mZXRjaF9hbmRfcmVsYXhlZCh+aSwgdik7Cn0KIyAy
MDQ2ICIuL2luY2x1ZGUvbGludXgvYXRvbWljLWZhbGxiYWNrLmgiCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0
dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHM2NAphdG9taWM2NF9mZXRjaF9vcl9h
Y3F1aXJlKHM2NCBpLCBhdG9taWM2NF90ICp2KQp7CiBzNjQgcmV0ID0gYXRvbWljNjRfZmV0
Y2hfb3JfcmVsYXhlZChpLCB2KTsKIF9fYXNtX18gX192b2xhdGlsZV9fKCJcbiIgIjk3MTo7
IGlzeW5jOyA5NzI6IC5wdXNoc2VjdGlvbiBfX2x3c3luY19maXh1cCxcImFcIjsgLmFsaWdu
IDI7IDk3MzogLjhieXRlIDk3MWItOTczYjsgLnBvcHNlY3Rpb247OyIgIiAiICIiIDogOiA6
ICJtZW1vcnkiKTsKIHJldHVybiByZXQ7Cn0KCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9f
KChfX2Fsd2F5c19pbmxpbmVfXykpIHM2NAphdG9taWM2NF9mZXRjaF9vcl9yZWxlYXNlKHM2
NCBpLCBhdG9taWM2NF90ICp2KQp7CiBfX2FzbV9fIF9fdm9sYXRpbGVfXygibHdzeW5jIiAi
ICIgIlxuIiAiIiA6IDogOiAibWVtb3J5Iik7CiByZXR1cm4gYXRvbWljNjRfZmV0Y2hfb3Jf
cmVsYXhlZChpLCB2KTsKfQoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlz
X2lubGluZV9fKSkgczY0CmF0b21pYzY0X2ZldGNoX29yKHM2NCBpLCBhdG9taWM2NF90ICp2
KQp7CiBzNjQgcmV0OwogX19hc21fXyBfX3ZvbGF0aWxlX18gKCJzeW5jIiA6IDogOiAibWVt
b3J5Iik7CiByZXQgPSBhdG9taWM2NF9mZXRjaF9vcl9yZWxheGVkKGksIHYpOwogX19hc21f
XyBfX3ZvbGF0aWxlX18gKCJzeW5jIiA6IDogOiAibWVtb3J5Iik7CiByZXR1cm4gcmV0Owp9
CiMgMjA5NSAiLi9pbmNsdWRlL2xpbnV4L2F0b21pYy1mYWxsYmFjay5oIgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
X19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBzNjQKYXRvbWljNjRfZmV0Y2hf
eG9yX2FjcXVpcmUoczY0IGksIGF0b21pYzY0X3QgKnYpCnsKIHM2NCByZXQgPSBhdG9taWM2
NF9mZXRjaF94b3JfcmVsYXhlZChpLCB2KTsKIF9fYXNtX18gX192b2xhdGlsZV9fKCJcbiIg
Ijk3MTo7IGlzeW5jOyA5NzI6IC5wdXNoc2VjdGlvbiBfX2x3c3luY19maXh1cCxcImFcIjsg
LmFsaWduIDI7IDk3MzogLjhieXRlIDk3MWItOTczYjsgLnBvcHNlY3Rpb247OyIgIiAiICIi
IDogOiA6ICJtZW1vcnkiKTsKIHJldHVybiByZXQ7Cn0KCgoKCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJp
YnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHM2NAphdG9taWM2NF9mZXRjaF94b3JfcmVs
ZWFzZShzNjQgaSwgYXRvbWljNjRfdCAqdikKewogX19hc21fXyBfX3ZvbGF0aWxlX18oImx3
c3luYyIgIiAiICJcbiIgIiIgOiA6IDogIm1lbW9yeSIpOwogcmV0dXJuIGF0b21pYzY0X2Zl
dGNoX3hvcl9yZWxheGVkKGksIHYpOwp9CgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygo
X19hbHdheXNfaW5saW5lX18pKSBzNjQKYXRvbWljNjRfZmV0Y2hfeG9yKHM2NCBpLCBhdG9t
aWM2NF90ICp2KQp7CiBzNjQgcmV0OwogX19hc21fXyBfX3ZvbGF0aWxlX18gKCJzeW5jIiA6
IDogOiAibWVtb3J5Iik7CiByZXQgPSBhdG9taWM2NF9mZXRjaF94b3JfcmVsYXhlZChpLCB2
KTsKIF9fYXNtX18gX192b2xhdGlsZV9fICgic3luYyIgOiA6IDogIm1lbW9yeSIpOwogcmV0
dXJuIHJldDsKfQojIDIxNDIgIi4vaW5jbHVkZS9saW51eC9hdG9taWMtZmFsbGJhY2suaCIK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgczY0CmF0b21p
YzY0X3hjaGdfYWNxdWlyZShhdG9taWM2NF90ICp2LCBzNjQgaSkKewogczY0IHJldCA9ICh7
IF9fdHlwZW9mX18oKigmKCh2KS0+Y291bnRlcikpKSBfeF8gPSAoKGkpKTsgKF9fdHlwZW9m
X18oKigmKCh2KS0+Y291bnRlcikpKSkgX194Y2hnX3JlbGF4ZWQoKCYoKHYpLT5jb3VudGVy
KSksICh1bnNpZ25lZCBsb25nKV94Xywgc2l6ZW9mKCooJigodiktPmNvdW50ZXIpKSkpOyB9
KTsKIF9fYXNtX18gX192b2xhdGlsZV9fKCJcbiIgIjk3MTo7IGlzeW5jOyA5NzI6IC5wdXNo
c2VjdGlvbiBfX2x3c3luY19maXh1cCxcImFcIjsgLmFsaWduIDI7IDk3MzogLjhieXRlIDk3
MWItOTczYjsgLnBvcHNlY3Rpb247OyIgIiAiICIiIDogOiA6ICJtZW1vcnkiKTsKIHJldHVy
biByZXQ7Cn0KCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVf
XykpIHM2NAphdG9taWM2NF94Y2hnX3JlbGVhc2UoYXRvbWljNjRfdCAqdiwgczY0IGkpCnsK
IF9fYXNtX18gX192b2xhdGlsZV9fKCJsd3N5bmMiICIgIiAiXG4iICIiIDogOiA6ICJtZW1v
cnkiKTsKIHJldHVybiAoeyBfX3R5cGVvZl9fKCooJigodiktPmNvdW50ZXIpKSkgX3hfID0g
KChpKSk7IChfX3R5cGVvZl9fKCooJigodiktPmNvdW50ZXIpKSkpIF9feGNoZ19yZWxheGVk
KCgmKCh2KS0+Y291bnRlcikpLCAodW5zaWduZWQgbG9uZylfeF8sIHNpemVvZigqKCYoKHYp
LT5jb3VudGVyKSkpKTsgfSk7Cn0KIyAyMjAwICIuL2luY2x1ZGUvbGludXgvYXRvbWljLWZh
bGxiYWNrLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykp
IHM2NAphdG9taWM2NF9jbXB4Y2hnX3JlbGVhc2UoYXRvbWljNjRfdCAqdiwgczY0IG9sZCwg
czY0IG5ldykKewogX19hc21fXyBfX3ZvbGF0aWxlX18oImx3c3luYyIgIiAiICJcbiIgIiIg
OiA6IDogIm1lbW9yeSIpOwogcmV0dXJuICh7IF9fdHlwZW9mX18oKigmKCh2KS0+Y291bnRl
cikpKSBfb18gPSAoKG9sZCkpOyBfX3R5cGVvZl9fKCooJigodiktPmNvdW50ZXIpKSkgX25f
ID0gKChuZXcpKTsgKF9fdHlwZW9mX18oKigmKCh2KS0+Y291bnRlcikpKSkgX19jbXB4Y2hn
X3JlbGF4ZWQoKCYoKHYpLT5jb3VudGVyKSksICh1bnNpZ25lZCBsb25nKV9vXywgKHVuc2ln
bmVkIGxvbmcpX25fLCBzaXplb2YoKigmKCh2KS0+Y291bnRlcikpKSk7IH0pOwp9CiMgMjIz
NyAiLi9pbmNsdWRlL2xpbnV4L2F0b21pYy1mYWxsYmFjay5oIgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRy
aWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKQoKIyAyMjM3ICIuL2luY2x1ZGUvbGludXgv
YXRvbWljLWZhbGxiYWNrLmgiCiAgICAgICAgICAgICAgICAgICAgICAgYm9vbAphdG9taWM2
NF90cnlfY21weGNoZyhhdG9taWM2NF90ICp2LCBzNjQgKm9sZCwgczY0IG5ldykKewogczY0
IHIsIG8gPSAqb2xkOwogciA9ICgoeyBfX3R5cGVvZl9fKCooJigodiktPmNvdW50ZXIpKSkg
X29fID0gKChvKSk7IF9fdHlwZW9mX18oKigmKCh2KS0+Y291bnRlcikpKSBfbl8gPSAoKG5l
dykpOyAoX190eXBlb2ZfXygqKCYoKHYpLT5jb3VudGVyKSkpKSBfX2NtcHhjaGcoKCYoKHYp
LT5jb3VudGVyKSksICh1bnNpZ25lZCBsb25nKV9vXywgKHVuc2lnbmVkIGxvbmcpX25fLCBz
aXplb2YoKigmKCh2KS0+Y291bnRlcikpKSk7IH0pKTsKIGlmIChfX2J1aWx0aW5fZXhwZWN0
KCEhKHIgIT0gbyksIDApKQogICpvbGQgPSByOwogcmV0dXJuIF9fYnVpbHRpbl9leHBlY3Qo
ISEociA9PSBvKSwgMSk7Cn0KCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5
c19pbmxpbmVfXykpCgojIDIyNTAgIi4vaW5jbHVkZS9saW51eC9hdG9taWMtZmFsbGJhY2su
aCIKICAgICAgICAgICAgICAgICAgICAgICBib29sCmF0b21pYzY0X3RyeV9jbXB4Y2hnX2Fj
cXVpcmUoYXRvbWljNjRfdCAqdiwgczY0ICpvbGQsIHM2NCBuZXcpCnsKIHM2NCByLCBvID0g
Km9sZDsKIHIgPSAoeyBfX3R5cGVvZl9fKCooJigodiktPmNvdW50ZXIpKSkgX29fID0gKChv
KSk7IF9fdHlwZW9mX18oKigmKCh2KS0+Y291bnRlcikpKSBfbl8gPSAoKG5ldykpOyAoX190
eXBlb2ZfXygqKCYoKHYpLT5jb3VudGVyKSkpKSBfX2NtcHhjaGdfYWNxdWlyZSgoJigodikt
PmNvdW50ZXIpKSwgKHVuc2lnbmVkIGxvbmcpX29fLCAodW5zaWduZWQgbG9uZylfbl8sIHNp
emVvZigqKCYoKHYpLT5jb3VudGVyKSkpKTsgfSk7CiBpZiAoX19idWlsdGluX2V4cGVjdCgh
IShyICE9IG8pLCAwKSkKICAqb2xkID0gcjsKIHJldHVybiBfX2J1aWx0aW5fZXhwZWN0KCEh
KHIgPT0gbyksIDEpOwp9CgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNf
aW5saW5lX18pKQoKIyAyMjYzICIuL2luY2x1ZGUvbGludXgvYXRvbWljLWZhbGxiYWNrLmgi
CiAgICAgICAgICAgICAgICAgICAgICAgYm9vbAphdG9taWM2NF90cnlfY21weGNoZ19yZWxl
YXNlKGF0b21pYzY0X3QgKnYsIHM2NCAqb2xkLCBzNjQgbmV3KQp7CiBzNjQgciwgbyA9ICpv
bGQ7CiByID0gYXRvbWljNjRfY21weGNoZ19yZWxlYXNlKHYsIG8sIG5ldyk7CiBpZiAoX19i
dWlsdGluX2V4cGVjdCghIShyICE9IG8pLCAwKSkKICAqb2xkID0gcjsKIHJldHVybiBfX2J1
aWx0aW5fZXhwZWN0KCEhKHIgPT0gbyksIDEpOwp9CgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1
dGVfXygoX19hbHdheXNfaW5saW5lX18pKQoKIyAyMjc2ICIuL2luY2x1ZGUvbGludXgvYXRv
bWljLWZhbGxiYWNrLmgiCiAgICAgICAgICAgICAgICAgICAgICAgYm9vbAphdG9taWM2NF90
cnlfY21weGNoZ19yZWxheGVkKGF0b21pYzY0X3QgKnYsIHM2NCAqb2xkLCBzNjQgbmV3KQp7
CiBzNjQgciwgbyA9ICpvbGQ7CiByID0gKHsgX190eXBlb2ZfXygqKCYoKHYpLT5jb3VudGVy
KSkpIF9vXyA9ICgobykpOyBfX3R5cGVvZl9fKCooJigodiktPmNvdW50ZXIpKSkgX25fID0g
KChuZXcpKTsgKF9fdHlwZW9mX18oKigmKCh2KS0+Y291bnRlcikpKSkgX19jbXB4Y2hnX3Jl
bGF4ZWQoKCYoKHYpLT5jb3VudGVyKSksICh1bnNpZ25lZCBsb25nKV9vXywgKHVuc2lnbmVk
IGxvbmcpX25fLCBzaXplb2YoKigmKCh2KS0+Y291bnRlcikpKSk7IH0pOwogaWYgKF9fYnVp
bHRpbl9leHBlY3QoISEociAhPSBvKSwgMCkpCiAgKm9sZCA9IHI7CiByZXR1cm4gX19idWls
dGluX2V4cGVjdCghIShyID09IG8pLCAxKTsKfQojIDIzMzggIi4vaW5jbHVkZS9saW51eC9h
dG9taWMtZmFsbGJhY2suaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lu
bGluZV9fKSkKCiMgMjMzOCAiLi9pbmNsdWRlL2xpbnV4L2F0b21pYy1mYWxsYmFjay5oIgog
ICAgICAgICAgICAgICAgICAgICAgIGJvb2wKYXRvbWljNjRfc3ViX2FuZF90ZXN0KHM2NCBp
LCBhdG9taWM2NF90ICp2KQp7CiByZXR1cm4gYXRvbWljNjRfc3ViX3JldHVybihpLCB2KSA9
PSAwOwp9CiMgMjM1NyAiLi9pbmNsdWRlL2xpbnV4L2F0b21pYy1mYWxsYmFjay5oIgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKQoKIyAyMzU3ICIuL2lu
Y2x1ZGUvbGludXgvYXRvbWljLWZhbGxiYWNrLmgiCiAgICAgICAgICAgICAgICAgICAgICAg
Ym9vbAphdG9taWM2NF9kZWNfYW5kX3Rlc3QoYXRvbWljNjRfdCAqdikKewogcmV0dXJuIGF0
b21pYzY0X2RlY19yZXR1cm4odikgPT0gMDsKfQojIDIzNzYgIi4vaW5jbHVkZS9saW51eC9h
dG9taWMtZmFsbGJhY2suaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lu
bGluZV9fKSkKCiMgMjM3NiAiLi9pbmNsdWRlL2xpbnV4L2F0b21pYy1mYWxsYmFjay5oIgog
ICAgICAgICAgICAgICAgICAgICAgIGJvb2wKYXRvbWljNjRfaW5jX2FuZF90ZXN0KGF0b21p
YzY0X3QgKnYpCnsKIHJldHVybiBhdG9taWM2NF9pbmNfcmV0dXJuKHYpID09IDA7Cn0KIyAy
Mzk2ICIuL2luY2x1ZGUvbGludXgvYXRvbWljLWZhbGxiYWNrLmgiCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0
dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpCgojIDIzOTYgIi4vaW5jbHVkZS9saW51
eC9hdG9taWMtZmFsbGJhY2suaCIKICAgICAgICAgICAgICAgICAgICAgICBib29sCmF0b21p
YzY0X2FkZF9uZWdhdGl2ZShzNjQgaSwgYXRvbWljNjRfdCAqdikKewogcmV0dXJuIGF0b21p
YzY0X2FkZF9yZXR1cm4oaSwgdikgPCAwOwp9CiMgMjQ0MyAiLi9pbmNsdWRlL2xpbnV4L2F0
b21pYy1mYWxsYmFjay5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5s
aW5lX18pKQoKIyAyNDQzICIuL2luY2x1ZGUvbGludXgvYXRvbWljLWZhbGxiYWNrLmgiCiAg
ICAgICAgICAgICAgICAgICAgICAgYm9vbAphdG9taWM2NF9hZGRfdW5sZXNzKGF0b21pYzY0
X3QgKnYsIHM2NCBhLCBzNjQgdSkKewogcmV0dXJuIGF0b21pYzY0X2ZldGNoX2FkZF91bmxl
c3ModiwgYSwgdSkgIT0gdTsKfQojIDI0NzIgIi4vaW5jbHVkZS9saW51eC9hdG9taWMtZmFs
bGJhY2suaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkK
CiMgMjQ3MiAiLi9pbmNsdWRlL2xpbnV4L2F0b21pYy1mYWxsYmFjay5oIgogICAgICAgICAg
ICAgICAgICAgICAgIGJvb2wKYXRvbWljNjRfaW5jX3VubGVzc19uZWdhdGl2ZShhdG9taWM2
NF90ICp2KQp7CiBzNjQgYyA9IGF0b21pYzY0X3JlYWQodik7CgogZG8gewogIGlmIChfX2J1
aWx0aW5fZXhwZWN0KCEhKGMgPCAwKSwgMCkpCiAgIHJldHVybiBmYWxzZTsKIH0gd2hpbGUg
KCFhdG9taWM2NF90cnlfY21weGNoZyh2LCAmYywgYyArIDEpKTsKCiByZXR1cm4gdHJ1ZTsK
fQoKCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKQoK
IyAyNDkwICIuL2luY2x1ZGUvbGludXgvYXRvbWljLWZhbGxiYWNrLmgiCiAgICAgICAgICAg
ICAgICAgICAgICAgYm9vbAphdG9taWM2NF9kZWNfdW5sZXNzX3Bvc2l0aXZlKGF0b21pYzY0
X3QgKnYpCnsKIHM2NCBjID0gYXRvbWljNjRfcmVhZCh2KTsKCiBkbyB7CiAgaWYgKF9fYnVp
bHRpbl9leHBlY3QoISEoYyA+IDApLCAwKSkKICAgcmV0dXJuIGZhbHNlOwogfSB3aGlsZSAo
IWF0b21pYzY0X3RyeV9jbXB4Y2hnKHYsICZjLCBjIC0gMSkpOwoKIHJldHVybiB0cnVlOwp9
CiMgODUgIi4vaW5jbHVkZS9saW51eC9hdG9taWMuaCIgMgoKCiMgMSAiLi9pbmNsdWRlL2Fz
bS1nZW5lcmljL2F0b21pYy1sb25nLmgiIDEKIyAxMyAiLi9pbmNsdWRlL2FzbS1nZW5lcmlj
L2F0b21pYy1sb25nLmgiCnR5cGVkZWYgYXRvbWljNjRfdCBhdG9taWNfbG9uZ190OwojIDI2
ICIuL2luY2x1ZGUvYXNtLWdlbmVyaWMvYXRvbWljLWxvbmcuaCIKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0
cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgbG9uZwphdG9taWNfbG9uZ19yZWFkKGNv
bnN0IGF0b21pY19sb25nX3QgKnYpCnsKIHJldHVybiBhdG9taWM2NF9yZWFkKHYpOwp9Cgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBsb25nCmF0b21p
Y19sb25nX3JlYWRfYWNxdWlyZShjb25zdCBhdG9taWNfbG9uZ190ICp2KQp7CiByZXR1cm4g
YXRvbWljNjRfcmVhZF9hY3F1aXJlKHYpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygo
X19hbHdheXNfaW5saW5lX18pKSB2b2lkCmF0b21pY19sb25nX3NldChhdG9taWNfbG9uZ190
ICp2LCBsb25nIGkpCnsKIGF0b21pYzY0X3NldCh2LCBpKTsKfQoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0
cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgdm9pZAphdG9taWNfbG9uZ19zZXRfcmVs
ZWFzZShhdG9taWNfbG9uZ190ICp2LCBsb25nIGkpCnsKIGF0b21pYzY0X3NldF9yZWxlYXNl
KHYsIGkpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18p
KSB2b2lkCmF0b21pY19sb25nX2FkZChsb25nIGksIGF0b21pY19sb25nX3QgKnYpCnsKIGF0
b21pYzY0X2FkZChpLCB2KTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlz
X2lubGluZV9fKSkgbG9uZwphdG9taWNfbG9uZ19hZGRfcmV0dXJuKGxvbmcgaSwgYXRvbWlj
X2xvbmdfdCAqdikKewogcmV0dXJuIGF0b21pYzY0X2FkZF9yZXR1cm4oaSwgdik7Cn0KCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIGxvbmcKYXRvbWlj
X2xvbmdfYWRkX3JldHVybl9hY3F1aXJlKGxvbmcgaSwgYXRvbWljX2xvbmdfdCAqdikKewog
cmV0dXJuIGF0b21pYzY0X2FkZF9yZXR1cm5fYWNxdWlyZShpLCB2KTsKfQoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgbG9uZwphdG9taWNfbG9uZ19h
ZGRfcmV0dXJuX3JlbGVhc2UobG9uZyBpLCBhdG9taWNfbG9uZ190ICp2KQp7CiByZXR1cm4g
YXRvbWljNjRfYWRkX3JldHVybl9yZWxlYXNlKGksIHYpOwp9CgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRy
aWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBsb25nCmF0b21pY19sb25nX2FkZF9yZXR1
cm5fcmVsYXhlZChsb25nIGksIGF0b21pY19sb25nX3QgKnYpCnsKIHJldHVybiBhdG9taWM2
NF9hZGRfcmV0dXJuX3JlbGF4ZWQoaSwgdik7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9f
KChfX2Fsd2F5c19pbmxpbmVfXykpIGxvbmcKYXRvbWljX2xvbmdfZmV0Y2hfYWRkKGxvbmcg
aSwgYXRvbWljX2xvbmdfdCAqdikKewogcmV0dXJuIGF0b21pYzY0X2ZldGNoX2FkZChpLCB2
KTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgbG9u
ZwphdG9taWNfbG9uZ19mZXRjaF9hZGRfYWNxdWlyZShsb25nIGksIGF0b21pY19sb25nX3Qg
KnYpCnsKIHJldHVybiBhdG9taWM2NF9mZXRjaF9hZGRfYWNxdWlyZShpLCB2KTsKfQoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgbG9uZwphdG9taWNf
bG9uZ19mZXRjaF9hZGRfcmVsZWFzZShsb25nIGksIGF0b21pY19sb25nX3QgKnYpCnsKIHJl
dHVybiBhdG9taWM2NF9mZXRjaF9hZGRfcmVsZWFzZShpLCB2KTsKfQoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9f
YXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgbG9uZwphdG9taWNfbG9uZ19mZXRj
aF9hZGRfcmVsYXhlZChsb25nIGksIGF0b21pY19sb25nX3QgKnYpCnsKIHJldHVybiBhdG9t
aWM2NF9mZXRjaF9hZGRfcmVsYXhlZChpLCB2KTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRl
X18oKF9fYWx3YXlzX2lubGluZV9fKSkgdm9pZAphdG9taWNfbG9uZ19zdWIobG9uZyBpLCBh
dG9taWNfbG9uZ190ICp2KQp7CiBhdG9taWM2NF9zdWIoaSwgdik7Cn0KCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBf
X2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIGxvbmcKYXRvbWljX2xvbmdfc3Vi
X3JldHVybihsb25nIGksIGF0b21pY19sb25nX3QgKnYpCnsKIHJldHVybiBhdG9taWM2NF9z
dWJfcmV0dXJuKGksIHYpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNf
aW5saW5lX18pKSBsb25nCmF0b21pY19sb25nX3N1Yl9yZXR1cm5fYWNxdWlyZShsb25nIGks
IGF0b21pY19sb25nX3QgKnYpCnsKIHJldHVybiBhdG9taWM2NF9zdWJfcmV0dXJuX2FjcXVp
cmUoaSwgdik7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVf
XykpIGxvbmcKYXRvbWljX2xvbmdfc3ViX3JldHVybl9yZWxlYXNlKGxvbmcgaSwgYXRvbWlj
X2xvbmdfdCAqdikKewogcmV0dXJuIGF0b21pYzY0X3N1Yl9yZXR1cm5fcmVsZWFzZShpLCB2
KTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgbG9u
ZwphdG9taWNfbG9uZ19zdWJfcmV0dXJuX3JlbGF4ZWQobG9uZyBpLCBhdG9taWNfbG9uZ190
ICp2KQp7CiByZXR1cm4gYXRvbWljNjRfc3ViX3JldHVybl9yZWxheGVkKGksIHYpOwp9Cgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBsb25nCmF0b21p
Y19sb25nX2ZldGNoX3N1Yihsb25nIGksIGF0b21pY19sb25nX3QgKnYpCnsKIHJldHVybiBh
dG9taWM2NF9mZXRjaF9zdWIoaSwgdik7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChf
X2Fsd2F5c19pbmxpbmVfXykpIGxvbmcKYXRvbWljX2xvbmdfZmV0Y2hfc3ViX2FjcXVpcmUo
bG9uZyBpLCBhdG9taWNfbG9uZ190ICp2KQp7CiByZXR1cm4gYXRvbWljNjRfZmV0Y2hfc3Vi
X2FjcXVpcmUoaSwgdik7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19p
bmxpbmVfXykpIGxvbmcKYXRvbWljX2xvbmdfZmV0Y2hfc3ViX3JlbGVhc2UobG9uZyBpLCBh
dG9taWNfbG9uZ190ICp2KQp7CiByZXR1cm4gYXRvbWljNjRfZmV0Y2hfc3ViX3JlbGVhc2Uo
aSwgdik7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykp
IGxvbmcKYXRvbWljX2xvbmdfZmV0Y2hfc3ViX3JlbGF4ZWQobG9uZyBpLCBhdG9taWNfbG9u
Z190ICp2KQp7CiByZXR1cm4gYXRvbWljNjRfZmV0Y2hfc3ViX3JlbGF4ZWQoaSwgdik7Cn0K
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHZvaWQKYXRv
bWljX2xvbmdfaW5jKGF0b21pY19sb25nX3QgKnYpCnsKIGF0b21pYzY0X2luYyh2KTsKfQoK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgbG9uZwphdG9t
aWNfbG9uZ19pbmNfcmV0dXJuKGF0b21pY19sb25nX3QgKnYpCnsKIHJldHVybiBhdG9taWM2
NF9pbmNfcmV0dXJuKHYpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNf
aW5saW5lX18pKSBsb25nCmF0b21pY19sb25nX2luY19yZXR1cm5fYWNxdWlyZShhdG9taWNf
bG9uZ190ICp2KQp7CiByZXR1cm4gYXRvbWljNjRfaW5jX3JldHVybl9hY3F1aXJlKHYpOwp9
CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBsb25nCmF0
b21pY19sb25nX2luY19yZXR1cm5fcmVsZWFzZShhdG9taWNfbG9uZ190ICp2KQp7CiByZXR1
cm4gYXRvbWljNjRfaW5jX3JldHVybl9yZWxlYXNlKHYpOwp9CgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRy
aWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBsb25nCmF0b21pY19sb25nX2luY19yZXR1
cm5fcmVsYXhlZChhdG9taWNfbG9uZ190ICp2KQp7CiByZXR1cm4gYXRvbWljNjRfaW5jX3Jl
dHVybl9yZWxheGVkKHYpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNf
aW5saW5lX18pKSBsb25nCmF0b21pY19sb25nX2ZldGNoX2luYyhhdG9taWNfbG9uZ190ICp2
KQp7CiByZXR1cm4gYXRvbWljNjRfZmV0Y2hfaW5jKHYpOwp9CgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRy
aWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBsb25nCmF0b21pY19sb25nX2ZldGNoX2lu
Y19hY3F1aXJlKGF0b21pY19sb25nX3QgKnYpCnsKIHJldHVybiBhdG9taWM2NF9mZXRjaF9p
bmNfYWNxdWlyZSh2KTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lu
bGluZV9fKSkgbG9uZwphdG9taWNfbG9uZ19mZXRjaF9pbmNfcmVsZWFzZShhdG9taWNfbG9u
Z190ICp2KQp7CiByZXR1cm4gYXRvbWljNjRfZmV0Y2hfaW5jX3JlbGVhc2Uodik7Cn0KCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIGxvbmcKYXRvbWlj
X2xvbmdfZmV0Y2hfaW5jX3JlbGF4ZWQoYXRvbWljX2xvbmdfdCAqdikKewogcmV0dXJuIGF0
b21pYzY0X2ZldGNoX2luY19yZWxheGVkKHYpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVf
XygoX19hbHdheXNfaW5saW5lX18pKSB2b2lkCmF0b21pY19sb25nX2RlYyhhdG9taWNfbG9u
Z190ICp2KQp7CiBhdG9taWM2NF9kZWModik7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9f
KChfX2Fsd2F5c19pbmxpbmVfXykpIGxvbmcKYXRvbWljX2xvbmdfZGVjX3JldHVybihhdG9t
aWNfbG9uZ190ICp2KQp7CiByZXR1cm4gYXRvbWljNjRfZGVjX3JldHVybih2KTsKfQoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgbG9uZwphdG9taWNf
bG9uZ19kZWNfcmV0dXJuX2FjcXVpcmUoYXRvbWljX2xvbmdfdCAqdikKewogcmV0dXJuIGF0
b21pYzY0X2RlY19yZXR1cm5fYWNxdWlyZSh2KTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRl
X18oKF9fYWx3YXlzX2lubGluZV9fKSkgbG9uZwphdG9taWNfbG9uZ19kZWNfcmV0dXJuX3Jl
bGVhc2UoYXRvbWljX2xvbmdfdCAqdikKewogcmV0dXJuIGF0b21pYzY0X2RlY19yZXR1cm5f
cmVsZWFzZSh2KTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGlu
ZV9fKSkgbG9uZwphdG9taWNfbG9uZ19kZWNfcmV0dXJuX3JlbGF4ZWQoYXRvbWljX2xvbmdf
dCAqdikKewogcmV0dXJuIGF0b21pYzY0X2RlY19yZXR1cm5fcmVsYXhlZCh2KTsKfQoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgbG9uZwphdG9taWNf
bG9uZ19mZXRjaF9kZWMoYXRvbWljX2xvbmdfdCAqdikKewogcmV0dXJuIGF0b21pYzY0X2Zl
dGNoX2RlYyh2KTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGlu
ZV9fKSkgbG9uZwphdG9taWNfbG9uZ19mZXRjaF9kZWNfYWNxdWlyZShhdG9taWNfbG9uZ190
ICp2KQp7CiByZXR1cm4gYXRvbWljNjRfZmV0Y2hfZGVjX2FjcXVpcmUodik7Cn0KCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIGxvbmcKYXRvbWljX2xv
bmdfZmV0Y2hfZGVjX3JlbGVhc2UoYXRvbWljX2xvbmdfdCAqdikKewogcmV0dXJuIGF0b21p
YzY0X2ZldGNoX2RlY19yZWxlYXNlKHYpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygo
X19hbHdheXNfaW5saW5lX18pKSBsb25nCmF0b21pY19sb25nX2ZldGNoX2RlY19yZWxheGVk
KGF0b21pY19sb25nX3QgKnYpCnsKIHJldHVybiBhdG9taWM2NF9mZXRjaF9kZWNfcmVsYXhl
ZCh2KTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkg
dm9pZAphdG9taWNfbG9uZ19hbmQobG9uZyBpLCBhdG9taWNfbG9uZ190ICp2KQp7CiBhdG9t
aWM2NF9hbmQoaSwgdik7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19p
bmxpbmVfXykpIGxvbmcKYXRvbWljX2xvbmdfZmV0Y2hfYW5kKGxvbmcgaSwgYXRvbWljX2xv
bmdfdCAqdikKewogcmV0dXJuIGF0b21pYzY0X2ZldGNoX2FuZChpLCB2KTsKfQoKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgbG9uZwphdG9taWNfbG9u
Z19mZXRjaF9hbmRfYWNxdWlyZShsb25nIGksIGF0b21pY19sb25nX3QgKnYpCnsKIHJldHVy
biBhdG9taWM2NF9mZXRjaF9hbmRfYWNxdWlyZShpLCB2KTsKfQoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0
cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgbG9uZwphdG9taWNfbG9uZ19mZXRjaF9h
bmRfcmVsZWFzZShsb25nIGksIGF0b21pY19sb25nX3QgKnYpCnsKIHJldHVybiBhdG9taWM2
NF9mZXRjaF9hbmRfcmVsZWFzZShpLCB2KTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18o
KF9fYWx3YXlzX2lubGluZV9fKSkgbG9uZwphdG9taWNfbG9uZ19mZXRjaF9hbmRfcmVsYXhl
ZChsb25nIGksIGF0b21pY19sb25nX3QgKnYpCnsKIHJldHVybiBhdG9taWM2NF9mZXRjaF9h
bmRfcmVsYXhlZChpLCB2KTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlz
X2lubGluZV9fKSkgdm9pZAphdG9taWNfbG9uZ19hbmRub3QobG9uZyBpLCBhdG9taWNfbG9u
Z190ICp2KQp7CiBhdG9taWM2NF9hbmRub3QoaSwgdik7Cn0KCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJp
YnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIGxvbmcKYXRvbWljX2xvbmdfZmV0Y2hfYW5k
bm90KGxvbmcgaSwgYXRvbWljX2xvbmdfdCAqdikKewogcmV0dXJuIGF0b21pYzY0X2ZldGNo
X2FuZG5vdChpLCB2KTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lu
bGluZV9fKSkgbG9uZwphdG9taWNfbG9uZ19mZXRjaF9hbmRub3RfYWNxdWlyZShsb25nIGks
IGF0b21pY19sb25nX3QgKnYpCnsKIHJldHVybiBhdG9taWM2NF9mZXRjaF9hbmRub3RfYWNx
dWlyZShpLCB2KTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGlu
ZV9fKSkgbG9uZwphdG9taWNfbG9uZ19mZXRjaF9hbmRub3RfcmVsZWFzZShsb25nIGksIGF0
b21pY19sb25nX3QgKnYpCnsKIHJldHVybiBhdG9taWM2NF9mZXRjaF9hbmRub3RfcmVsZWFz
ZShpLCB2KTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9f
KSkgbG9uZwphdG9taWNfbG9uZ19mZXRjaF9hbmRub3RfcmVsYXhlZChsb25nIGksIGF0b21p
Y19sb25nX3QgKnYpCnsKIHJldHVybiBhdG9taWM2NF9mZXRjaF9hbmRub3RfcmVsYXhlZChp
LCB2KTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkg
dm9pZAphdG9taWNfbG9uZ19vcihsb25nIGksIGF0b21pY19sb25nX3QgKnYpCnsKIGF0b21p
YzY0X29yKGksIHYpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5s
aW5lX18pKSBsb25nCmF0b21pY19sb25nX2ZldGNoX29yKGxvbmcgaSwgYXRvbWljX2xvbmdf
dCAqdikKewogcmV0dXJuIGF0b21pYzY0X2ZldGNoX29yKGksIHYpOwp9CgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
X19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBsb25nCmF0b21pY19sb25nX2Zl
dGNoX29yX2FjcXVpcmUobG9uZyBpLCBhdG9taWNfbG9uZ190ICp2KQp7CiByZXR1cm4gYXRv
bWljNjRfZmV0Y2hfb3JfYWNxdWlyZShpLCB2KTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRl
X18oKF9fYWx3YXlzX2lubGluZV9fKSkgbG9uZwphdG9taWNfbG9uZ19mZXRjaF9vcl9yZWxl
YXNlKGxvbmcgaSwgYXRvbWljX2xvbmdfdCAqdikKewogcmV0dXJuIGF0b21pYzY0X2ZldGNo
X29yX3JlbGVhc2UoaSwgdik7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5
c19pbmxpbmVfXykpIGxvbmcKYXRvbWljX2xvbmdfZmV0Y2hfb3JfcmVsYXhlZChsb25nIGks
IGF0b21pY19sb25nX3QgKnYpCnsKIHJldHVybiBhdG9taWM2NF9mZXRjaF9vcl9yZWxheGVk
KGksIHYpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18p
KSB2b2lkCmF0b21pY19sb25nX3hvcihsb25nIGksIGF0b21pY19sb25nX3QgKnYpCnsKIGF0
b21pYzY0X3hvcihpLCB2KTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlz
X2lubGluZV9fKSkgbG9uZwphdG9taWNfbG9uZ19mZXRjaF94b3IobG9uZyBpLCBhdG9taWNf
bG9uZ190ICp2KQp7CiByZXR1cm4gYXRvbWljNjRfZmV0Y2hfeG9yKGksIHYpOwp9CgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBsb25nCmF0b21pY19s
b25nX2ZldGNoX3hvcl9hY3F1aXJlKGxvbmcgaSwgYXRvbWljX2xvbmdfdCAqdikKewogcmV0
dXJuIGF0b21pYzY0X2ZldGNoX3hvcl9hY3F1aXJlKGksIHYpOwp9CgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19h
dHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBsb25nCmF0b21pY19sb25nX2ZldGNo
X3hvcl9yZWxlYXNlKGxvbmcgaSwgYXRvbWljX2xvbmdfdCAqdikKewogcmV0dXJuIGF0b21p
YzY0X2ZldGNoX3hvcl9yZWxlYXNlKGksIHYpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVf
XygoX19hbHdheXNfaW5saW5lX18pKSBsb25nCmF0b21pY19sb25nX2ZldGNoX3hvcl9yZWxh
eGVkKGxvbmcgaSwgYXRvbWljX2xvbmdfdCAqdikKewogcmV0dXJuIGF0b21pYzY0X2ZldGNo
X3hvcl9yZWxheGVkKGksIHYpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdh
eXNfaW5saW5lX18pKSBsb25nCmF0b21pY19sb25nX3hjaGcoYXRvbWljX2xvbmdfdCAqdiwg
bG9uZyBpKQp7CiByZXR1cm4gKCh7IHR5cGVvZigoeyBfX3R5cGVvZl9fKCooJigodiktPmNv
dW50ZXIpKSkgX3hfID0gKGkpOyAoX190eXBlb2ZfXygqKCYoKHYpLT5jb3VudGVyKSkpKSBf
X3hjaGdfcmVsYXhlZCgoJigodiktPmNvdW50ZXIpKSwgKHVuc2lnbmVkIGxvbmcpX3hfLCBz
aXplb2YoKigmKCh2KS0+Y291bnRlcikpKSk7IH0pKSBfX3JldDsgX19hc21fXyBfX3ZvbGF0
aWxlX18gKCJzeW5jIiA6IDogOiAibWVtb3J5Iik7IF9fcmV0ID0gKHsgX190eXBlb2ZfXygq
KCYoKHYpLT5jb3VudGVyKSkpIF94XyA9IChpKTsgKF9fdHlwZW9mX18oKigmKCh2KS0+Y291
bnRlcikpKSkgX194Y2hnX3JlbGF4ZWQoKCYoKHYpLT5jb3VudGVyKSksICh1bnNpZ25lZCBs
b25nKV94Xywgc2l6ZW9mKCooJigodiktPmNvdW50ZXIpKSkpOyB9KTsgX19hc21fXyBfX3Zv
bGF0aWxlX18gKCJzeW5jIiA6IDogOiAibWVtb3J5Iik7IF9fcmV0OyB9KSk7Cn0KCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIGxvbmcKYXRvbWljX2xv
bmdfeGNoZ19hY3F1aXJlKGF0b21pY19sb25nX3QgKnYsIGxvbmcgaSkKewogcmV0dXJuIGF0
b21pYzY0X3hjaGdfYWNxdWlyZSh2LCBpKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18o
KF9fYWx3YXlzX2lubGluZV9fKSkgbG9uZwphdG9taWNfbG9uZ194Y2hnX3JlbGVhc2UoYXRv
bWljX2xvbmdfdCAqdiwgbG9uZyBpKQp7CiByZXR1cm4gYXRvbWljNjRfeGNoZ19yZWxlYXNl
KHYsIGkpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18p
KSBsb25nCmF0b21pY19sb25nX3hjaGdfcmVsYXhlZChhdG9taWNfbG9uZ190ICp2LCBsb25n
IGkpCnsKIHJldHVybiAoeyBfX3R5cGVvZl9fKCooJigodiktPmNvdW50ZXIpKSkgX3hfID0g
KChpKSk7IChfX3R5cGVvZl9fKCooJigodiktPmNvdW50ZXIpKSkpIF9feGNoZ19yZWxheGVk
KCgmKCh2KS0+Y291bnRlcikpLCAodW5zaWduZWQgbG9uZylfeF8sIHNpemVvZigqKCYoKHYp
LT5jb3VudGVyKSkpKTsgfSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5
c19pbmxpbmVfXykpIGxvbmcKYXRvbWljX2xvbmdfY21weGNoZyhhdG9taWNfbG9uZ190ICp2
LCBsb25nIG9sZCwgbG9uZyBuZXcpCnsKIHJldHVybiAoKHsgX190eXBlb2ZfXygqKCYoKHYp
LT5jb3VudGVyKSkpIF9vXyA9ICgob2xkKSk7IF9fdHlwZW9mX18oKigmKCh2KS0+Y291bnRl
cikpKSBfbl8gPSAoKG5ldykpOyAoX190eXBlb2ZfXygqKCYoKHYpLT5jb3VudGVyKSkpKSBf
X2NtcHhjaGcoKCYoKHYpLT5jb3VudGVyKSksICh1bnNpZ25lZCBsb25nKV9vXywgKHVuc2ln
bmVkIGxvbmcpX25fLCBzaXplb2YoKigmKCh2KS0+Y291bnRlcikpKSk7IH0pKTsKfQoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgbG9uZwphdG9taWNf
bG9uZ19jbXB4Y2hnX2FjcXVpcmUoYXRvbWljX2xvbmdfdCAqdiwgbG9uZyBvbGQsIGxvbmcg
bmV3KQp7CiByZXR1cm4gKHsgX190eXBlb2ZfXygqKCYoKHYpLT5jb3VudGVyKSkpIF9vXyA9
ICgob2xkKSk7IF9fdHlwZW9mX18oKigmKCh2KS0+Y291bnRlcikpKSBfbl8gPSAoKG5ldykp
OyAoX190eXBlb2ZfXygqKCYoKHYpLT5jb3VudGVyKSkpKSBfX2NtcHhjaGdfYWNxdWlyZSgo
JigodiktPmNvdW50ZXIpKSwgKHVuc2lnbmVkIGxvbmcpX29fLCAodW5zaWduZWQgbG9uZylf
bl8sIHNpemVvZigqKCYoKHYpLT5jb3VudGVyKSkpKTsgfSk7Cn0KCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0
dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIGxvbmcKYXRvbWljX2xvbmdfY21weGNo
Z19yZWxlYXNlKGF0b21pY19sb25nX3QgKnYsIGxvbmcgb2xkLCBsb25nIG5ldykKewogcmV0
dXJuIGF0b21pYzY0X2NtcHhjaGdfcmVsZWFzZSh2LCBvbGQsIG5ldyk7Cn0KCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIGxvbmcKYXRvbWljX2xvbmdf
Y21weGNoZ19yZWxheGVkKGF0b21pY19sb25nX3QgKnYsIGxvbmcgb2xkLCBsb25nIG5ldykK
ewogcmV0dXJuICh7IF9fdHlwZW9mX18oKigmKCh2KS0+Y291bnRlcikpKSBfb18gPSAoKG9s
ZCkpOyBfX3R5cGVvZl9fKCooJigodiktPmNvdW50ZXIpKSkgX25fID0gKChuZXcpKTsgKF9f
dHlwZW9mX18oKigmKCh2KS0+Y291bnRlcikpKSkgX19jbXB4Y2hnX3JlbGF4ZWQoKCYoKHYp
LT5jb3VudGVyKSksICh1bnNpZ25lZCBsb25nKV9vXywgKHVuc2lnbmVkIGxvbmcpX25fLCBz
aXplb2YoKigmKCh2KS0+Y291bnRlcikpKSk7IH0pOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1
dGVfXygoX19hbHdheXNfaW5saW5lX18pKQoKIyA0MzQgIi4vaW5jbHVkZS9hc20tZ2VuZXJp
Yy9hdG9taWMtbG9uZy5oIgogICAgICAgICAgICAgICAgICAgICAgIGJvb2wKYXRvbWljX2xv
bmdfdHJ5X2NtcHhjaGcoYXRvbWljX2xvbmdfdCAqdiwgbG9uZyAqb2xkLCBsb25nIG5ldykK
ewogcmV0dXJuIGF0b21pYzY0X3RyeV9jbXB4Y2hnKHYsIChzNjQgKilvbGQsIG5ldyk7Cn0K
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpCgojIDQ0MCAi
Li9pbmNsdWRlL2FzbS1nZW5lcmljL2F0b21pYy1sb25nLmgiCiAgICAgICAgICAgICAgICAg
ICAgICAgYm9vbAphdG9taWNfbG9uZ190cnlfY21weGNoZ19hY3F1aXJlKGF0b21pY19sb25n
X3QgKnYsIGxvbmcgKm9sZCwgbG9uZyBuZXcpCnsKIHJldHVybiBhdG9taWM2NF90cnlfY21w
eGNoZ19hY3F1aXJlKHYsIChzNjQgKilvbGQsIG5ldyk7Cn0KCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJp
YnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpCgojIDQ0NiAiLi9pbmNsdWRlL2FzbS1nZW5l
cmljL2F0b21pYy1sb25nLmgiCiAgICAgICAgICAgICAgICAgICAgICAgYm9vbAphdG9taWNf
bG9uZ190cnlfY21weGNoZ19yZWxlYXNlKGF0b21pY19sb25nX3QgKnYsIGxvbmcgKm9sZCwg
bG9uZyBuZXcpCnsKIHJldHVybiBhdG9taWM2NF90cnlfY21weGNoZ19yZWxlYXNlKHYsIChz
NjQgKilvbGQsIG5ldyk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19p
bmxpbmVfXykpCgojIDQ1MiAiLi9pbmNsdWRlL2FzbS1nZW5lcmljL2F0b21pYy1sb25nLmgi
CiAgICAgICAgICAgICAgICAgICAgICAgYm9vbAphdG9taWNfbG9uZ190cnlfY21weGNoZ19y
ZWxheGVkKGF0b21pY19sb25nX3QgKnYsIGxvbmcgKm9sZCwgbG9uZyBuZXcpCnsKIHJldHVy
biBhdG9taWM2NF90cnlfY21weGNoZ19yZWxheGVkKHYsIChzNjQgKilvbGQsIG5ldyk7Cn0K
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpCgojIDQ1OCAi
Li9pbmNsdWRlL2FzbS1nZW5lcmljL2F0b21pYy1sb25nLmgiCiAgICAgICAgICAgICAgICAg
ICAgICAgYm9vbAphdG9taWNfbG9uZ19zdWJfYW5kX3Rlc3QobG9uZyBpLCBhdG9taWNfbG9u
Z190ICp2KQp7CiByZXR1cm4gYXRvbWljNjRfc3ViX2FuZF90ZXN0KGksIHYpOwp9CgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKQoKIyA0NjQgIi4vaW5j
bHVkZS9hc20tZ2VuZXJpYy9hdG9taWMtbG9uZy5oIgogICAgICAgICAgICAgICAgICAgICAg
IGJvb2wKYXRvbWljX2xvbmdfZGVjX2FuZF90ZXN0KGF0b21pY19sb25nX3QgKnYpCnsKIHJl
dHVybiBhdG9taWM2NF9kZWNfYW5kX3Rlc3Qodik7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0
ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpCgojIDQ3MCAiLi9pbmNsdWRlL2FzbS1nZW5lcmlj
L2F0b21pYy1sb25nLmgiCiAgICAgICAgICAgICAgICAgICAgICAgYm9vbAphdG9taWNfbG9u
Z19pbmNfYW5kX3Rlc3QoYXRvbWljX2xvbmdfdCAqdikKewogcmV0dXJuIGF0b21pYzY0X2lu
Y19hbmRfdGVzdCh2KTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lu
bGluZV9fKSkKCiMgNDc2ICIuL2luY2x1ZGUvYXNtLWdlbmVyaWMvYXRvbWljLWxvbmcuaCIK
ICAgICAgICAgICAgICAgICAgICAgICBib29sCmF0b21pY19sb25nX2FkZF9uZWdhdGl2ZShs
b25nIGksIGF0b21pY19sb25nX3QgKnYpCnsKIHJldHVybiBhdG9taWM2NF9hZGRfbmVnYXRp
dmUoaSwgdik7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVf
XykpIGxvbmcKYXRvbWljX2xvbmdfZmV0Y2hfYWRkX3VubGVzcyhhdG9taWNfbG9uZ190ICp2
LCBsb25nIGEsIGxvbmcgdSkKewogcmV0dXJuIGF0b21pYzY0X2ZldGNoX2FkZF91bmxlc3Mo
diwgYSwgdSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVf
XykpCgojIDQ4OCAiLi9pbmNsdWRlL2FzbS1nZW5lcmljL2F0b21pYy1sb25nLmgiCiAgICAg
ICAgICAgICAgICAgICAgICAgYm9vbAphdG9taWNfbG9uZ19hZGRfdW5sZXNzKGF0b21pY19s
b25nX3QgKnYsIGxvbmcgYSwgbG9uZyB1KQp7CiByZXR1cm4gYXRvbWljNjRfYWRkX3VubGVz
cyh2LCBhLCB1KTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGlu
ZV9fKSkKCiMgNDk0ICIuL2luY2x1ZGUvYXNtLWdlbmVyaWMvYXRvbWljLWxvbmcuaCIKICAg
ICAgICAgICAgICAgICAgICAgICBib29sCmF0b21pY19sb25nX2luY19ub3RfemVybyhhdG9t
aWNfbG9uZ190ICp2KQp7CiByZXR1cm4gYXRvbWljNjRfaW5jX25vdF96ZXJvKCh2KSk7Cn0K
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpCgojIDUwMCAi
Li9pbmNsdWRlL2FzbS1nZW5lcmljL2F0b21pYy1sb25nLmgiCiAgICAgICAgICAgICAgICAg
ICAgICAgYm9vbAphdG9taWNfbG9uZ19pbmNfdW5sZXNzX25lZ2F0aXZlKGF0b21pY19sb25n
X3QgKnYpCnsKIHJldHVybiBhdG9taWM2NF9pbmNfdW5sZXNzX25lZ2F0aXZlKHYpOwp9Cgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKQoKIyA1MDYgIi4v
aW5jbHVkZS9hc20tZ2VuZXJpYy9hdG9taWMtbG9uZy5oIgogICAgICAgICAgICAgICAgICAg
ICAgIGJvb2wKYXRvbWljX2xvbmdfZGVjX3VubGVzc19wb3NpdGl2ZShhdG9taWNfbG9uZ190
ICp2KQp7CiByZXR1cm4gYXRvbWljNjRfZGVjX3VubGVzc19wb3NpdGl2ZSh2KTsKfQoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgbG9uZwphdG9taWNf
bG9uZ19kZWNfaWZfcG9zaXRpdmUoYXRvbWljX2xvbmdfdCAqdikKewogcmV0dXJuIGF0b21p
YzY0X2RlY19pZl9wb3NpdGl2ZSh2KTsKfQojIDg4ICIuL2luY2x1ZGUvbGludXgvYXRvbWlj
LmgiIDIKIyAyNiAiLi9pbmNsdWRlL2xpbnV4L3JjdXBkYXRlLmgiIDIKIyAxICIuL2luY2x1
ZGUvbGludXgvaXJxZmxhZ3MuaCIgMQojIDE2ICIuL2luY2x1ZGUvbGludXgvaXJxZmxhZ3Mu
aCIKIyAxICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9pcnFmbGFncy5oIiAxCiMgMTIg
Ii4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2lycWZsYWdzLmgiCiMgMSAiLi9hcmNoL3Bv
d2VycGMvaW5jbHVkZS9hc20vaHdfaXJxLmgiIDEKIyAxMCAiLi9hcmNoL3Bvd2VycGMvaW5j
bHVkZS9hc20vaHdfaXJxLmgiCiMgMSAiLi9pbmNsdWRlL2xpbnV4L2Vycm5vLmgiIDEKCgoK
CiMgMSAiLi9pbmNsdWRlL3VhcGkvbGludXgvZXJybm8uaCIgMQojIDEgIi4vYXJjaC9wb3dl
cnBjL2luY2x1ZGUvdWFwaS9hc20vZXJybm8uaCIgMQoKCgoKIyAxICIuL2luY2x1ZGUvdWFw
aS9hc20tZ2VuZXJpYy9lcnJuby5oIiAxCgoKCgojIDEgIi4vaW5jbHVkZS91YXBpL2FzbS1n
ZW5lcmljL2Vycm5vLWJhc2UuaCIgMQojIDYgIi4vaW5jbHVkZS91YXBpL2FzbS1nZW5lcmlj
L2Vycm5vLmgiIDIKIyA2ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL3VhcGkvYXNtL2Vycm5v
LmgiIDIKIyAxICIuL2luY2x1ZGUvdWFwaS9saW51eC9lcnJuby5oIiAyCiMgNiAiLi9pbmNs
dWRlL2xpbnV4L2Vycm5vLmgiIDIKIyAxMSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20v
aHdfaXJxLmgiIDIKCiMgMSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vcHRyYWNlLmgi
IDEKIyAyMiAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vcHRyYWNlLmgiCiMgMSAiLi9h
cmNoL3Bvd2VycGMvaW5jbHVkZS91YXBpL2FzbS9wdHJhY2UuaCIgMQojIDMzICIuL2FyY2gv
cG93ZXJwYy9pbmNsdWRlL3VhcGkvYXNtL3B0cmFjZS5oIgpzdHJ1Y3QgdXNlcl9wdF9yZWdz
CgoKCnsKIHVuc2lnbmVkIGxvbmcgZ3ByWzMyXTsKIHVuc2lnbmVkIGxvbmcgbmlwOwogdW5z
aWduZWQgbG9uZyBtc3I7CiB1bnNpZ25lZCBsb25nIG9yaWdfZ3ByMzsKIHVuc2lnbmVkIGxv
bmcgY3RyOwogdW5zaWduZWQgbG9uZyBsaW5rOwogdW5zaWduZWQgbG9uZyB4ZXI7CiB1bnNp
Z25lZCBsb25nIGNjcjsKCiB1bnNpZ25lZCBsb25nIHNvZnRlOwoKCgoKIHVuc2lnbmVkIGxv
bmcgdHJhcDsKCgogdW5zaWduZWQgbG9uZyBkYXI7CiB1bnNpZ25lZCBsb25nIGRzaXNyOwog
dW5zaWduZWQgbG9uZyByZXN1bHQ7Cn07CiMgMjA1ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRl
L3VhcGkvYXNtL3B0cmFjZS5oIgpzdHJ1Y3QgcHBjX2RlYnVnX2luZm8gewogX191MzIgdmVy
c2lvbjsKIF9fdTMyIG51bV9pbnN0cnVjdGlvbl9icHM7CiBfX3UzMiBudW1fZGF0YV9icHM7
CiBfX3UzMiBudW1fY29uZGl0aW9uX3JlZ3M7CiBfX3UzMiBkYXRhX2JwX2FsaWdubWVudDsK
IF9fdTMyIHNpemVvZl9jb25kaXRpb247CiBfX3U2NCBmZWF0dXJlczsKfTsKIyAyMjggIi4v
YXJjaC9wb3dlcnBjL2luY2x1ZGUvdWFwaS9hc20vcHRyYWNlLmgiCnN0cnVjdCBwcGNfaHdf
YnJlYWtwb2ludCB7CiBfX3UzMiB2ZXJzaW9uOwogX191MzIgdHJpZ2dlcl90eXBlOwogX191
MzIgYWRkcl9tb2RlOwogX191MzIgY29uZGl0aW9uX21vZGU7CiBfX3U2NCBhZGRyOwogX191
NjQgYWRkcjI7CiBfX3U2NCBjb25kaXRpb25fdmFsdWU7Cn07CiMgMjMgIi4vYXJjaC9wb3dl
cnBjL2luY2x1ZGUvYXNtL3B0cmFjZS5oIiAyCgoKCnN0cnVjdCBwdF9yZWdzCnsKIHVuaW9u
IHsKICBzdHJ1Y3QgdXNlcl9wdF9yZWdzIHVzZXJfcmVnczsKICBzdHJ1Y3QgewogICB1bnNp
Z25lZCBsb25nIGdwclszMl07CiAgIHVuc2lnbmVkIGxvbmcgbmlwOwogICB1bnNpZ25lZCBs
b25nIG1zcjsKICAgdW5zaWduZWQgbG9uZyBvcmlnX2dwcjM7CiAgIHVuc2lnbmVkIGxvbmcg
Y3RyOwogICB1bnNpZ25lZCBsb25nIGxpbms7CiAgIHVuc2lnbmVkIGxvbmcgeGVyOwogICB1
bnNpZ25lZCBsb25nIGNjcjsKCiAgIHVuc2lnbmVkIGxvbmcgc29mdGU7CgoKCiAgIHVuc2ln
bmVkIGxvbmcgdHJhcDsKICAgdW5zaWduZWQgbG9uZyBkYXI7CiAgIHVuc2lnbmVkIGxvbmcg
ZHNpc3I7CiAgIHVuc2lnbmVkIGxvbmcgcmVzdWx0OwogIH07CiB9OwoKIHVuaW9uIHsKICBz
dHJ1Y3QgewoKICAgdW5zaWduZWQgbG9uZyBwcHI7CgoKCgogIH07CiAgdW5zaWduZWQgbG9u
ZyBfX3BhZFsyXTsKIH07Cn07CiMgMTE0ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9w
dHJhY2UuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHVuc2lnbmVkIGxvbmcgaW5zdHJ1Y3Rpb25fcG9pbnRlcihz
dHJ1Y3QgcHRfcmVncyAqcmVncykKewogcmV0dXJuIHJlZ3MtPm5pcDsKfQoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IHZvaWQgaW5zdHJ1Y3Rpb25fcG9pbnRlcl9zZXQoc3RydWN0IHB0X3JlZ3MgKnJlZ3MsCiAg
dW5zaWduZWQgbG9uZyB2YWwpCnsKIHJlZ3MtPm5pcCA9IHZhbDsKfQoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHVu
c2lnbmVkIGxvbmcgdXNlcl9zdGFja19wb2ludGVyKHN0cnVjdCBwdF9yZWdzICpyZWdzKQp7
CiByZXR1cm4gcmVncy0+Z3ByWzFdOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgbG9uZyBmcmFt
ZV9wb2ludGVyKHN0cnVjdCBwdF9yZWdzICpyZWdzKQp7CiByZXR1cm4gMDsKfQoKCmV4dGVy
biB1bnNpZ25lZCBsb25nIHByb2ZpbGVfcGMoc3RydWN0IHB0X3JlZ3MgKnJlZ3MpOwoKCgoK
bG9uZyBkb19zeXNjYWxsX3RyYWNlX2VudGVyKHN0cnVjdCBwdF9yZWdzICpyZWdzKTsKdm9p
ZCBkb19zeXNjYWxsX3RyYWNlX2xlYXZlKHN0cnVjdCBwdF9yZWdzICpyZWdzKTsKCgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgaW50IGlzX3N5c2NhbGxfc3VjY2VzcyhzdHJ1Y3QgcHRfcmVncyAqcmVncykKewog
cmV0dXJuICEocmVncy0+Y2NyICYgMHgxMDAwMDAwMCk7Cn0KCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBsb25nIHJl
Z3NfcmV0dXJuX3ZhbHVlKHN0cnVjdCBwdF9yZWdzICpyZWdzKQp7CiBpZiAoaXNfc3lzY2Fs
bF9zdWNjZXNzKHJlZ3MpKQogIHJldHVybiByZWdzLT5ncHJbM107CiBlbHNlCiAgcmV0dXJu
IC1yZWdzLT5ncHJbM107Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHJlZ3Nfc2V0X3JldHVybl92YWx1
ZShzdHJ1Y3QgcHRfcmVncyAqcmVncywgdW5zaWduZWQgbG9uZyByYykKewogcmVncy0+Z3By
WzNdID0gcmM7Cn0KIyAxNzQgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL3B0cmFjZS5o
IgpzdHJ1Y3QgdGFza19zdHJ1Y3Q7CmV4dGVybiBpbnQgcHRyYWNlX2dldF9yZWcoc3RydWN0
IHRhc2tfc3RydWN0ICp0YXNrLCBpbnQgcmVnbm8sCiAgICAgdW5zaWduZWQgbG9uZyAqZGF0
YSk7CmV4dGVybiBpbnQgcHRyYWNlX3B1dF9yZWcoc3RydWN0IHRhc2tfc3RydWN0ICp0YXNr
LCBpbnQgcmVnbm8sCiAgICAgdW5zaWduZWQgbG9uZyBkYXRhKTsKIyAyMjAgIi4vYXJjaC9w
b3dlcnBjL2luY2x1ZGUvYXNtL3B0cmFjZS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBzZXRfdHJhcChz
dHJ1Y3QgcHRfcmVncyAqcmVncywgdW5zaWduZWQgbG9uZyB2YWwpCnsKIHJlZ3MtPnRyYXAg
PSAocmVncy0+dHJhcCAmIDB4MTEpIHwgKHZhbCAmIH4weDExKTsKfQoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJv
b2wgdHJhcF9pc19zeXNjYWxsKHN0cnVjdCBwdF9yZWdzICpyZWdzKQp7CiByZXR1cm4gKChy
ZWdzKS0+dHJhcCAmIH4weDExKSA9PSAweGMwMDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgdHJhcF9u
b3Jlc3RhcnQoc3RydWN0IHB0X3JlZ3MgKnJlZ3MpCnsKIHJldHVybiByZWdzLT50cmFwICYg
MHgxMDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgc2V0X3RyYXBfbm9yZXN0YXJ0KHN0cnVjdCBwdF9y
ZWdzICpyZWdzKQp7CiByZWdzLT50cmFwIHw9IDB4MTA7Cn0KIyAyNTMgIi4vYXJjaC9wb3dl
cnBjL2luY2x1ZGUvYXNtL3B0cmFjZS5oIgojIDEgIi4vaW5jbHVkZS9saW51eC90aHJlYWRf
aW5mby5oIiAxCiMgMTMgIi4vaW5jbHVkZS9saW51eC90aHJlYWRfaW5mby5oIgojIDEgIi4v
aW5jbHVkZS9saW51eC9yZXN0YXJ0X2Jsb2NrLmgiIDEKIyAxMCAiLi9pbmNsdWRlL2xpbnV4
L3Jlc3RhcnRfYmxvY2suaCIKIyAxICIuL2luY2x1ZGUvbGludXgvdGltZTY0LmgiIDEKCgoK
CiMgMSAiLi9pbmNsdWRlL2xpbnV4L21hdGg2NC5oIiAxCgoKCgoKIyAxICIuL2luY2x1ZGUv
dmRzby9tYXRoNjQuaCIgMQoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlz
X2lubGluZV9fKSkgdTMyCl9faXRlcl9kaXZfdTY0X3JlbSh1NjQgZGl2aWRlbmQsIHUzMiBk
aXZpc29yLCB1NjQgKnJlbWFpbmRlcikKewogdTMyIHJldCA9IDA7Cgogd2hpbGUgKGRpdmlk
ZW5kID49IGRpdmlzb3IpIHsKCgogIGFzbSgiIiA6ICIrcm0iKGRpdmlkZW5kKSk7CgogIGRp
dmlkZW5kIC09IGRpdmlzb3I7CiAgcmV0Kys7CiB9CgogKnJlbWFpbmRlciA9IGRpdmlkZW5k
OwoKIHJldHVybiByZXQ7Cn0KIyA3ICIuL2luY2x1ZGUvbGludXgvbWF0aDY0LmgiIDIKIyAx
ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2dlbmVyYXRlZC9hc20vZGl2NjQuaCIgMQojIDgg
Ii4vaW5jbHVkZS9saW51eC9tYXRoNjQuaCIgMgojIDI1ICIuL2luY2x1ZGUvbGludXgvbWF0
aDY0LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSB1NjQgZGl2X3U2NF9yZW0odTY0IGRpdmlkZW5kLCB1MzIgZGl2
aXNvciwgdTMyICpyZW1haW5kZXIpCnsKICpyZW1haW5kZXIgPSBkaXZpZGVuZCAlIGRpdmlz
b3I7CiByZXR1cm4gZGl2aWRlbmQgLyBkaXZpc29yOwp9CiMgMzkgIi4vaW5jbHVkZS9saW51
eC9tYXRoNjQuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIHM2NCBkaXZfczY0X3JlbShzNjQgZGl2aWRlbmQsIHMz
MiBkaXZpc29yLCBzMzIgKnJlbWFpbmRlcikKewogKnJlbWFpbmRlciA9IGRpdmlkZW5kICUg
ZGl2aXNvcjsKIHJldHVybiBkaXZpZGVuZCAvIGRpdmlzb3I7Cn0KIyA1MyAiLi9pbmNsdWRl
L2xpbnV4L21hdGg2NC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdTY0IGRpdjY0X3U2NF9yZW0odTY0IGRpdmlk
ZW5kLCB1NjQgZGl2aXNvciwgdTY0ICpyZW1haW5kZXIpCnsKICpyZW1haW5kZXIgPSBkaXZp
ZGVuZCAlIGRpdmlzb3I7CiByZXR1cm4gZGl2aWRlbmQgLyBkaXZpc29yOwp9CiMgNjYgIi4v
aW5jbHVkZS9saW51eC9tYXRoNjQuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHU2NCBkaXY2NF91NjQodTY0IGRp
dmlkZW5kLCB1NjQgZGl2aXNvcikKewogcmV0dXJuIGRpdmlkZW5kIC8gZGl2aXNvcjsKfQoj
IDc4ICIuL2luY2x1ZGUvbGludXgvbWF0aDY0LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzNjQgZGl2NjRfczY0
KHM2NCBkaXZpZGVuZCwgczY0IGRpdmlzb3IpCnsKIHJldHVybiBkaXZpZGVuZCAvIGRpdmlz
b3I7Cn0KIyAxMjQgIi4vaW5jbHVkZS9saW51eC9tYXRoNjQuaCIKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHU2NCBk
aXZfdTY0KHU2NCBkaXZpZGVuZCwgdTMyIGRpdmlzb3IpCnsKIHUzMiByZW1haW5kZXI7CiBy
ZXR1cm4gZGl2X3U2NF9yZW0oZGl2aWRlbmQsIGRpdmlzb3IsICZyZW1haW5kZXIpOwp9CiMg
MTM3ICIuL2luY2x1ZGUvbGludXgvbWF0aDY0LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzNjQgZGl2X3M2NChz
NjQgZGl2aWRlbmQsIHMzMiBkaXZpc29yKQp7CiBzMzIgcmVtYWluZGVyOwogcmV0dXJuIGRp
dl9zNjRfcmVtKGRpdmlkZW5kLCBkaXZpc29yLCAmcmVtYWluZGVyKTsKfQoKCnUzMiBpdGVy
X2Rpdl91NjRfcmVtKHU2NCBkaXZpZGVuZCwgdTMyIGRpdmlzb3IsIHU2NCAqcmVtYWluZGVy
KTsKCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgdTY0IG11bF91MzJfdTMyKHUzMiBhLCB1MzIgYikKewogcmV0
dXJuICh1NjQpYSAqIGI7Cn0KIyAxNzUgIi4vaW5jbHVkZS9saW51eC9tYXRoNjQuaCIKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIHU2NCBtdWxfdTY0X3UzMl9zaHIodTY0IGEsIHUzMiBtdWwsIHVuc2lnbmVkIGlu
dCBzaGlmdCkKewogdTMyIGFoLCBhbDsKIHU2NCByZXQ7CgogYWwgPSBhOwogYWggPSBhID4+
IDMyOwoKIHJldCA9IG11bF91MzJfdTMyKGFsLCBtdWwpID4+IHNoaWZ0OwogaWYgKGFoKQog
IHJldCArPSBtdWxfdTMyX3UzMihhaCwgbXVsKSA8PCAoMzIgLSBzaGlmdCk7CgogcmV0dXJu
IHJldDsKfQoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgdTY0IG11bF91NjRfdTY0X3Nocih1NjQgYSwgdTY0IGIs
IHVuc2lnbmVkIGludCBzaGlmdCkKewogdW5pb24gewogIHU2NCBsbDsKICBzdHJ1Y3QgewoK
ICAgdTMyIGhpZ2gsIGxvdzsKCgoKICB9IGw7CiB9IHJsLCBybSwgcm4sIHJoLCBhMCwgYjA7
CiB1NjQgYzsKCiBhMC5sbCA9IGE7CiBiMC5sbCA9IGI7CgogcmwubGwgPSBtdWxfdTMyX3Uz
MihhMC5sLmxvdywgYjAubC5sb3cpOwogcm0ubGwgPSBtdWxfdTMyX3UzMihhMC5sLmxvdywg
YjAubC5oaWdoKTsKIHJuLmxsID0gbXVsX3UzMl91MzIoYTAubC5oaWdoLCBiMC5sLmxvdyk7
CiByaC5sbCA9IG11bF91MzJfdTMyKGEwLmwuaGlnaCwgYjAubC5oaWdoKTsKCgoKCgoKIHJs
LmwuaGlnaCA9IGMgPSAodTY0KXJsLmwuaGlnaCArIHJtLmwubG93ICsgcm4ubC5sb3c7CiBy
aC5sLmxvdyA9IGMgPSAoYyA+PiAzMikgKyBybS5sLmhpZ2ggKyBybi5sLmhpZ2ggKyByaC5s
LmxvdzsKIHJoLmwuaGlnaCA9IChjID4+IDMyKSArIHJoLmwuaGlnaDsKCgoKCgogaWYgKHNo
aWZ0ID09IDApCiAgcmV0dXJuIHJsLmxsOwogaWYgKHNoaWZ0IDwgNjQpCiAgcmV0dXJuIChy
bC5sbCA+PiBzaGlmdCkgfCAocmgubGwgPDwgKDY0IC0gc2hpZnQpKTsKIHJldHVybiByaC5s
bCA+PiAoc2hpZnQgJiA2Myk7Cn0KCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdTY0IG11bF91NjRfdTMyX2Rp
dih1NjQgYSwgdTMyIG11bCwgdTMyIGRpdmlzb3IpCnsKIHVuaW9uIHsKICB1NjQgbGw7CiAg
c3RydWN0IHsKCiAgIHUzMiBoaWdoLCBsb3c7CgoKCiAgfSBsOwogfSB1LCBybCwgcmg7Cgog
dS5sbCA9IGE7CiBybC5sbCA9IG11bF91MzJfdTMyKHUubC5sb3csIG11bCk7CiByaC5sbCA9
IG11bF91MzJfdTMyKHUubC5oaWdoLCBtdWwpICsgcmwubC5oaWdoOwoKCiBybC5sLmhpZ2gg
PSAoeyB1aW50MzJfdCBfX2Jhc2UgPSAoZGl2aXNvcik7IHVpbnQzMl90IF9fcmVtOyBfX3Jl
bSA9ICgodWludDY0X3QpKHJoLmxsKSkgJSBfX2Jhc2U7IChyaC5sbCkgPSAoKHVpbnQ2NF90
KShyaC5sbCkpIC8gX19iYXNlOyBfX3JlbTsgfSk7CgoKICh7IHVpbnQzMl90IF9fYmFzZSA9
IChkaXZpc29yKTsgdWludDMyX3QgX19yZW07IF9fcmVtID0gKCh1aW50NjRfdCkocmwubGwp
KSAlIF9fYmFzZTsgKHJsLmxsKSA9ICgodWludDY0X3QpKHJsLmxsKSkgLyBfX2Jhc2U7IF9f
cmVtOyB9KTsKCiBybC5sLmhpZ2ggPSByaC5sLmxvdzsKIHJldHVybiBybC5sbDsKfQojIDYg
Ii4vaW5jbHVkZS9saW51eC90aW1lNjQuaCIgMgojIDEgIi4vaW5jbHVkZS92ZHNvL3RpbWU2
NC5oIiAxCiMgNyAiLi9pbmNsdWRlL2xpbnV4L3RpbWU2NC5oIiAyCgp0eXBlZGVmIF9fczY0
IHRpbWU2NF90Owp0eXBlZGVmIF9fdTY0IHRpbWV1NjRfdDsKCiMgMSAiLi9pbmNsdWRlL3Vh
cGkvbGludXgvdGltZS5oIiAxCgoKCgoKIyAxICIuL2luY2x1ZGUvdWFwaS9saW51eC90aW1l
X3R5cGVzLmgiIDEKCgoKCgoKc3RydWN0IF9fa2VybmVsX3RpbWVzcGVjIHsKIF9fa2VybmVs
X3RpbWU2NF90IHR2X3NlYzsKIGxvbmcgbG9uZyB0dl9uc2VjOwp9OwoKc3RydWN0IF9fa2Vy
bmVsX2l0aW1lcnNwZWMgewogc3RydWN0IF9fa2VybmVsX3RpbWVzcGVjIGl0X2ludGVydmFs
Owogc3RydWN0IF9fa2VybmVsX3RpbWVzcGVjIGl0X3ZhbHVlOwp9OwojIDI1ICIuL2luY2x1
ZGUvdWFwaS9saW51eC90aW1lX3R5cGVzLmgiCnN0cnVjdCBfX2tlcm5lbF9vbGRfdGltZXZh
bCB7CiBfX2tlcm5lbF9sb25nX3QgdHZfc2VjOwogX19rZXJuZWxfbG9uZ190IHR2X3VzZWM7
Cn07CgoKc3RydWN0IF9fa2VybmVsX29sZF90aW1lc3BlYyB7CiBfX2tlcm5lbF9vbGRfdGlt
ZV90IHR2X3NlYzsKIGxvbmcgdHZfbnNlYzsKfTsKCnN0cnVjdCBfX2tlcm5lbF9vbGRfaXRp
bWVydmFsIHsKIHN0cnVjdCBfX2tlcm5lbF9vbGRfdGltZXZhbCBpdF9pbnRlcnZhbDsKIHN0
cnVjdCBfX2tlcm5lbF9vbGRfdGltZXZhbCBpdF92YWx1ZTsKfTsKCnN0cnVjdCBfX2tlcm5l
bF9zb2NrX3RpbWV2YWwgewogX19zNjQgdHZfc2VjOwogX19zNjQgdHZfdXNlYzsKfTsKIyA3
ICIuL2luY2x1ZGUvdWFwaS9saW51eC90aW1lLmgiIDIKIyAzMyAiLi9pbmNsdWRlL3VhcGkv
bGludXgvdGltZS5oIgpzdHJ1Y3QgdGltZXpvbmUgewogaW50IHR6X21pbnV0ZXN3ZXN0Owog
aW50IHR6X2RzdHRpbWU7Cn07CiMgMTIgIi4vaW5jbHVkZS9saW51eC90aW1lNjQuaCIgMgoK
c3RydWN0IHRpbWVzcGVjNjQgewogdGltZTY0X3QgdHZfc2VjOwogbG9uZyB0dl9uc2VjOwp9
OwoKc3RydWN0IGl0aW1lcnNwZWM2NCB7CiBzdHJ1Y3QgdGltZXNwZWM2NCBpdF9pbnRlcnZh
bDsKIHN0cnVjdCB0aW1lc3BlYzY0IGl0X3ZhbHVlOwp9OwojIDQxICIuL2luY2x1ZGUvbGlu
dXgvdGltZTY0LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgdGltZXNwZWM2NF9lcXVhbChjb25zdCBzdHJ1
Y3QgdGltZXNwZWM2NCAqYSwKICAgICAgIGNvbnN0IHN0cnVjdCB0aW1lc3BlYzY0ICpiKQp7
CiByZXR1cm4gKGEtPnR2X3NlYyA9PSBiLT50dl9zZWMpICYmIChhLT50dl9uc2VjID09IGIt
PnR2X25zZWMpOwp9CgoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgdGltZXNwZWM2NF9jb21wYXJlKGNv
bnN0IHN0cnVjdCB0aW1lc3BlYzY0ICpsaHMsIGNvbnN0IHN0cnVjdCB0aW1lc3BlYzY0ICpy
aHMpCnsKIGlmIChsaHMtPnR2X3NlYyA8IHJocy0+dHZfc2VjKQogIHJldHVybiAtMTsKIGlm
IChsaHMtPnR2X3NlYyA+IHJocy0+dHZfc2VjKQogIHJldHVybiAxOwogcmV0dXJuIGxocy0+
dHZfbnNlYyAtIHJocy0+dHZfbnNlYzsKfQoKZXh0ZXJuIHZvaWQgc2V0X25vcm1hbGl6ZWRf
dGltZXNwZWM2NChzdHJ1Y3QgdGltZXNwZWM2NCAqdHMsIHRpbWU2NF90IHNlYywgczY0IG5z
ZWMpOwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIHN0cnVjdCB0aW1lc3BlYzY0IHRpbWVzcGVjNjRfYWRkKHN0cnVj
dCB0aW1lc3BlYzY0IGxocywKICAgICAgc3RydWN0IHRpbWVzcGVjNjQgcmhzKQp7CiBzdHJ1
Y3QgdGltZXNwZWM2NCB0c19kZWx0YTsKIHNldF9ub3JtYWxpemVkX3RpbWVzcGVjNjQoJnRz
X2RlbHRhLCBsaHMudHZfc2VjICsgcmhzLnR2X3NlYywKICAgIGxocy50dl9uc2VjICsgcmhz
LnR2X25zZWMpOwogcmV0dXJuIHRzX2RlbHRhOwp9CgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IHRp
bWVzcGVjNjQgdGltZXNwZWM2NF9zdWIoc3RydWN0IHRpbWVzcGVjNjQgbGhzLAogICAgICBz
dHJ1Y3QgdGltZXNwZWM2NCByaHMpCnsKIHN0cnVjdCB0aW1lc3BlYzY0IHRzX2RlbHRhOwog
c2V0X25vcm1hbGl6ZWRfdGltZXNwZWM2NCgmdHNfZGVsdGEsIGxocy50dl9zZWMgLSByaHMu
dHZfc2VjLAogICAgbGhzLnR2X25zZWMgLSByaHMudHZfbnNlYyk7CiByZXR1cm4gdHNfZGVs
dGE7Cn0KCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIHRpbWVzcGVjNjRfdmFsaWQoY29uc3Qgc3RydWN0
IHRpbWVzcGVjNjQgKnRzKQp7CgogaWYgKHRzLT50dl9zZWMgPCAwKQogIHJldHVybiBmYWxz
ZTsKCiBpZiAoKHVuc2lnbmVkIGxvbmcpdHMtPnR2X25zZWMgPj0gMTAwMDAwMDAwMEwpCiAg
cmV0dXJuIGZhbHNlOwogcmV0dXJuIHRydWU7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIHRpbWVzcGVj
NjRfdmFsaWRfc3RyaWN0KGNvbnN0IHN0cnVjdCB0aW1lc3BlYzY0ICp0cykKewogaWYgKCF0
aW1lc3BlYzY0X3ZhbGlkKHRzKSkKICByZXR1cm4gZmFsc2U7CgogaWYgKCh1bnNpZ25lZCBs
b25nIGxvbmcpdHMtPnR2X3NlYyA+PSAoKChzNjQpfigodTY0KTEgPDwgNjMpKSAvIDEwMDAw
MDAwMDBMKSkKICByZXR1cm4gZmFsc2U7CiByZXR1cm4gdHJ1ZTsKfQoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJv
b2wgdGltZXNwZWM2NF92YWxpZF9zZXR0b2QoY29uc3Qgc3RydWN0IHRpbWVzcGVjNjQgKnRz
KQp7CiBpZiAoIXRpbWVzcGVjNjRfdmFsaWQodHMpKQogIHJldHVybiBmYWxzZTsKCiBpZiAo
KHVuc2lnbmVkIGxvbmcgbG9uZyl0cy0+dHZfc2VjID49ICgoKChzNjQpfigodTY0KTEgPDwg
NjMpKSAvIDEwMDAwMDAwMDBMKSAtICgzMExMICogMzY1ICogMjQgKjM2MDApKSkKICByZXR1
cm4gZmFsc2U7CiByZXR1cm4gdHJ1ZTsKfQojIDEyNSAiLi9pbmNsdWRlL2xpbnV4L3RpbWU2
NC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgczY0IHRpbWVzcGVjNjRfdG9fbnMoY29uc3Qgc3RydWN0IHRpbWVz
cGVjNjQgKnRzKQp7CiByZXR1cm4gKChzNjQpIHRzLT50dl9zZWMgKiAxMDAwMDAwMDAwTCkg
KyB0cy0+dHZfbnNlYzsKfQoKCgoKCgoKZXh0ZXJuIHN0cnVjdCB0aW1lc3BlYzY0IG5zX3Rv
X3RpbWVzcGVjNjQoY29uc3QgczY0IG5zZWMpOwojIDE0NiAiLi9pbmNsdWRlL2xpbnV4L3Rp
bWU2NC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB2
b2lkIHRpbWVzcGVjNjRfYWRkX25zKHN0cnVjdCB0aW1lc3BlYzY0ICphLCB1NjQgbnMpCnsK
IGEtPnR2X3NlYyArPSBfX2l0ZXJfZGl2X3U2NF9yZW0oYS0+dHZfbnNlYyArIG5zLCAxMDAw
MDAwMDAwTCwgJm5zKTsKIGEtPnR2X25zZWMgPSBuczsKfQoKCgoKCmV4dGVybiBzdHJ1Y3Qg
dGltZXNwZWM2NCB0aW1lc3BlYzY0X2FkZF9zYWZlKGNvbnN0IHN0cnVjdCB0aW1lc3BlYzY0
IGxocywKICAgICAgY29uc3Qgc3RydWN0IHRpbWVzcGVjNjQgcmhzKTsKIyAxMSAiLi9pbmNs
dWRlL2xpbnV4L3Jlc3RhcnRfYmxvY2suaCIgMgoKc3RydWN0IHRpbWVzcGVjOwpzdHJ1Y3Qg
b2xkX3RpbWVzcGVjMzI7CnN0cnVjdCBwb2xsZmQ7CgplbnVtIHRpbWVzcGVjX3R5cGUgewog
VFRfTk9ORSA9IDAsCiBUVF9OQVRJVkUgPSAxLAogVFRfQ09NUEFUID0gMiwKfTsKCgoKCnN0
cnVjdCByZXN0YXJ0X2Jsb2NrIHsKIGxvbmcgKCpmbikoc3RydWN0IHJlc3RhcnRfYmxvY2sg
Kik7CiB1bmlvbiB7CgogIHN0cnVjdCB7CiAgIHUzMiAqdWFkZHI7CiAgIHUzMiB2YWw7CiAg
IHUzMiBmbGFnczsKICAgdTMyIGJpdHNldDsKICAgdTY0IHRpbWU7CiAgIHUzMiAqdWFkZHIy
OwogIH0gZnV0ZXg7CgogIHN0cnVjdCB7CiAgIGNsb2NraWRfdCBjbG9ja2lkOwogICBlbnVt
IHRpbWVzcGVjX3R5cGUgdHlwZTsKICAgdW5pb24gewogICAgc3RydWN0IF9fa2VybmVsX3Rp
bWVzcGVjICpybXRwOwogICAgc3RydWN0IG9sZF90aW1lc3BlYzMyICpjb21wYXRfcm10cDsK
ICAgfTsKICAgdTY0IGV4cGlyZXM7CiAgfSBuYW5vc2xlZXA7CgogIHN0cnVjdCB7CiAgIHN0
cnVjdCBwb2xsZmQgKnVmZHM7CiAgIGludCBuZmRzOwogICBpbnQgaGFzX3RpbWVvdXQ7CiAg
IHVuc2lnbmVkIGxvbmcgdHZfc2VjOwogICB1bnNpZ25lZCBsb25nIHR2X25zZWM7CiAgfSBw
b2xsOwogfTsKfTsKCmV4dGVybiBsb25nIGRvX25vX3Jlc3RhcnRfc3lzY2FsbChzdHJ1Y3Qg
cmVzdGFydF9ibG9jayAqcGFybSk7CiMgMTQgIi4vaW5jbHVkZS9saW51eC90aHJlYWRfaW5m
by5oIiAyCiMgMzEgIi4vaW5jbHVkZS9saW51eC90aHJlYWRfaW5mby5oIgplbnVtIHsKIEJB
RF9TVEFDSyA9IC0xLAogTk9UX1NUQUNLID0gMCwKIEdPT0RfRlJBTUUsCiBHT09EX1NUQUNL
LAp9OwoKIyAxICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS90aHJlYWRfaW5mby5oIiAx
CiMgNDAgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL3RocmVhZF9pbmZvLmgiCiMgMSAi
Li9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vcHJvY2Vzc29yLmgiIDEKIyA5ICIuL2FyY2gv
cG93ZXJwYy9pbmNsdWRlL2FzbS9wcm9jZXNzb3IuaCIKIyAxICIuL2FyY2gvcG93ZXJwYy9p
bmNsdWRlL2FzbS9yZWcuaCIgMQojIDIxICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9y
ZWcuaCIKIyAxICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9yZWdfYm9va2UuaCIgMQoj
IDIyICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9yZWcuaCIgMgoKCgojIDEgIi4vYXJj
aC9wb3dlcnBjL2luY2x1ZGUvYXNtL3JlZ19mc2xfZW1iLmgiIDEKIyAyNiAiLi9hcmNoL3Bv
d2VycGMvaW5jbHVkZS9hc20vcmVnLmgiIDIKCgojIDEgIi4vYXJjaC9wb3dlcnBjL2luY2x1
ZGUvYXNtL3JlZ184eHguaCIgMQojIDI5ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9y
ZWcuaCIgMgojIDEzNzUgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL3JlZy5oIgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgdm9pZCBtdG1zcl9pc3luYyh1bnNpZ25lZCBsb25nIHZhbCkKewogYXNtIHZvbGF0
aWxlKCJtdG1zciIgIiAlMDsgIiAiOTcxOiIgIiAiICJpc3luYyIgIjsgIiAiOTcyOiAucHVz
aHNlY3Rpb24gX19mdHJfYWx0Xzk3LFwiYVwiOyAuYWxpZ24gMjsgOTczOiIgIiAiICJub3Ai
ICI7ICIgIjk3NDogLnBvcHNlY3Rpb247IC5wdXNoc2VjdGlvbiBfX2Z0cl9maXh1cCxcImFc
IjsgLmFsaWduIDM7IDk3NTogLjhieXRlICgoJTEpKTsgLjhieXRlICgwKTsgLjhieXRlIDk3
MWItOTc1YjsgLjhieXRlIDk3MmItOTc1YjsgLjhieXRlIDk3M2ItOTc1YjsgLjhieXRlIDk3
NGItOTc1YjsgLmlmZ3QgKDk3NGItIDk3M2IpLSg5NzJiLSA5NzFiKTsgLmVycm9yIFwiRmVh
dHVyZSBzZWN0aW9uIGVsc2UgY2FzZSBsYXJnZXIgdGhhbiBib2R5XCI7IC5lbmRpZjsgLnBv
cHNlY3Rpb247IiAiICIgOiA6CiAgICJyIiAodmFsKSwgImkiICgweDAwMDAwMDAwMDAwMDgw
MDBVTCkgOiAibWVtb3J5Iik7Cn0KIyAxMzkyICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2Fz
bS9yZWcuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgd3J0ZWUodW5zaWduZWQgbG9uZyB2YWwpCnsKIGlm
IChfX2J1aWx0aW5fY29uc3RhbnRfcCh2YWwpKQogIGFzbSB2b2xhdGlsZSgid3J0ZWVpICUw
IiA6IDogImkiICgodmFsICYgKDFVTDw8KDE1KSkpID8gMSA6IDApIDogIm1lbW9yeSIpOwog
ZWxzZQogIGFzbSB2b2xhdGlsZSgid3J0ZWUgJTAiIDogOiAiciIgKHZhbCkgOiAibWVtb3J5
Iik7Cn0KCmV4dGVybiB1bnNpZ25lZCBsb25nIG1zcl9jaGVja19hbmRfc2V0KHVuc2lnbmVk
IGxvbmcgYml0cyk7CmV4dGVybiBib29sIHN0cmljdF9tc3JfY29udHJvbDsKZXh0ZXJuIHZv
aWQgX19tc3JfY2hlY2tfYW5kX2NsZWFyKHVuc2lnbmVkIGxvbmcgYml0cyk7CnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSB2b2lkIG1zcl9jaGVja19hbmRfY2xlYXIodW5zaWduZWQgbG9uZyBiaXRzKQp7CiBpZiAo
c3RyaWN0X21zcl9jb250cm9sKQogIF9fbXNyX2NoZWNrX2FuZF9jbGVhcihiaXRzKTsKfQoj
IDE0NjAgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL3JlZy5oIgpleHRlcm4gdW5zaWdu
ZWQgbG9uZyBjdXJyZW50X3N0YWNrX2ZyYW1lKHZvaWQpOwoKcmVnaXN0ZXIgdW5zaWduZWQg
bG9uZyBjdXJyZW50X3N0YWNrX3BvaW50ZXIgYXNtKCJyMSIpOwoKZXh0ZXJuIHVuc2lnbmVk
IGxvbmcgc2NvbTk3MF9yZWFkKHVuc2lnbmVkIGludCBhZGRyZXNzKTsKZXh0ZXJuIHZvaWQg
c2NvbTk3MF93cml0ZSh1bnNpZ25lZCBpbnQgYWRkcmVzcywgdW5zaWduZWQgbG9uZyB2YWx1
ZSk7CgpzdHJ1Y3QgcHRfcmVnczsKCmV4dGVybiB2b2lkIHBwY19zYXZlX3JlZ3Moc3RydWN0
IHB0X3JlZ3MgKnJlZ3MpOwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgdXBkYXRlX3Bvd2VyOF9oaWQwKHVu
c2lnbmVkIGxvbmcgaGlkMCkKewoKCgoKCiBhc20gdm9sYXRpbGUoInN5bmM7IG10c3ByICUw
LCUxOyBpc3luYyI6OiAiaSIoMHgzRjApLCAiciIoaGlkMCkpOwp9CiMgMTAgIi4vYXJjaC9w
b3dlcnBjL2luY2x1ZGUvYXNtL3Byb2Nlc3Nvci5oIiAyCiMgMzkgIi4vYXJjaC9wb3dlcnBj
L2luY2x1ZGUvYXNtL3Byb2Nlc3Nvci5oIgojIDEgIi4vaW5jbHVkZS9saW51eC90aHJlYWRf
aW5mby5oIiAxCiMgNDAgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL3Byb2Nlc3Nvci5o
IiAyCiMgMSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vcHRyYWNlLmgiIDEKIyA0MSAi
Li9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vcHJvY2Vzc29yLmgiIDIKIyAxICIuL2FyY2gv
cG93ZXJwYy9pbmNsdWRlL2FzbS9od19icmVha3BvaW50LmgiIDEKIyAxMyAiLi9hcmNoL3Bv
d2VycGMvaW5jbHVkZS9hc20vaHdfYnJlYWtwb2ludC5oIgpzdHJ1Y3QgYXJjaF9od19icmVh
a3BvaW50IHsKIHVuc2lnbmVkIGxvbmcgYWRkcmVzczsKIHUxNiB0eXBlOwogdTE2IGxlbjsK
IHUxNiBod19sZW47Cn07CiMgNDcgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2h3X2Jy
ZWFrcG9pbnQuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBucl93cF9zbG90cyh2b2lkKQp7CiByZXR1cm4g
MTsKfQojIDk0ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9od19icmVha3BvaW50Lmgi
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSB2b2lkIGh3X2JyZWFrcG9pbnRfZGlzYWJsZSh2b2lkKSB7IH0Kc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIHZvaWQgdGhyZWFkX2NoYW5nZV9wYyhzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRzaywKICAg
ICBzdHJ1Y3QgcHRfcmVncyAqcmVncykgeyB9CgoKCgoKZXh0ZXJuIGJvb2wgZGF3cl9mb3Jj
ZV9lbmFibGU7CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIGRhd3JfZW5hYmxlZCh2b2lkKQp7CiByZXR1cm4g
ZGF3cl9mb3JjZV9lbmFibGU7Cn0KaW50IHNldF9kYXdyKGludCBuciwgc3RydWN0IGFyY2hf
aHdfYnJlYWtwb2ludCAqYnJrKTsKIyA0MiAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20v
cHJvY2Vzc29yLmgiIDIKIyA3NyAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vcHJvY2Vz
c29yLmgiCiMgMSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vdGFza19zaXplXzY0Lmgi
IDEKIyA3OCAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vcHJvY2Vzc29yLmgiIDIKCgoK
CnN0cnVjdCB0YXNrX3N0cnVjdDsKdm9pZCBzdGFydF90aHJlYWQoc3RydWN0IHB0X3JlZ3Mg
KnJlZ3MsIHVuc2lnbmVkIGxvbmcgZmRwdHIsIHVuc2lnbmVkIGxvbmcgc3ApOwp2b2lkIHJl
bGVhc2VfdGhyZWFkKHN0cnVjdCB0YXNrX3N0cnVjdCAqKTsKCnR5cGVkZWYgc3RydWN0IHsK
IHVuc2lnbmVkIGxvbmcgc2VnOwp9IG1tX3NlZ21lbnRfdDsKCgoKCgpzdHJ1Y3QgdGhyZWFk
X2ZwX3N0YXRlIHsKIHU2NCBmcHJbMzJdWzFdIF9fYXR0cmlidXRlX18oKGFsaWduZWQoMTYp
KSk7CiB1NjQgZnBzY3I7Cn07CgoKc3RydWN0IHRocmVhZF92cl9zdGF0ZSB7CiB2ZWN0b3Ix
MjggdnJbMzJdIF9fYXR0cmlidXRlX18oKGFsaWduZWQoMTYpKSk7CiB2ZWN0b3IxMjggdnNj
ciBfX2F0dHJpYnV0ZV9fKChhbGlnbmVkKDE2KSkpOwp9OwoKc3RydWN0IGRlYnVnX3JlZyB7
CgoKCgoKIHVpbnQzMl90IGRiY3IwOwogdWludDMyX3QgZGJjcjE7CgogdWludDMyX3QgZGJj
cjI7CgoKCgoKCgogdWludDMyX3QgZGJzcjsKCgoKCgoKIHVuc2lnbmVkIGxvbmcgaWFjMTsK
IHVuc2lnbmVkIGxvbmcgaWFjMjsKCgoKCiB1bnNpZ25lZCBsb25nIGRhYzE7CiB1bnNpZ25l
ZCBsb25nIGRhYzI7CgoKCgoKfTsKCnN0cnVjdCB0aHJlYWRfc3RydWN0IHsKIHVuc2lnbmVk
IGxvbmcga3NwOwoKCiB1bnNpZ25lZCBsb25nIGtzcF92c2lkOwoKIHN0cnVjdCBwdF9yZWdz
ICpyZWdzOwogbW1fc2VnbWVudF90IGFkZHJfbGltaXQ7CgoKIHVuc2lnbmVkIGxvbmcgbm9y
bXNhdmVbOF0gX19hdHRyaWJ1dGVfXygoX19hbGlnbmVkX18oKDEgPDwgNikpKSk7CiMgMTc3
ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9wcm9jZXNzb3IuaCIKIHN0cnVjdCBkZWJ1
Z19yZWcgZGVidWc7CiBzdHJ1Y3QgdGhyZWFkX2ZwX3N0YXRlIGZwX3N0YXRlOwogc3RydWN0
IHRocmVhZF9mcF9zdGF0ZSAqZnBfc2F2ZV9hcmVhOwogaW50IGZwZXhjX21vZGU7CiB1bnNp
Z25lZCBpbnQgYWxpZ25fY3RsOwojIDE5MCAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20v
cHJvY2Vzc29yLmgiCiBzdHJ1Y3QgYXJjaF9od19icmVha3BvaW50IGh3X2Jya1sxXTsKIHVu
c2lnbmVkIGxvbmcgdHJhcF9ucjsKIHU4IGxvYWRfc2xiOwogdTggbG9hZF9mcDsKCiB1OCBs
b2FkX3ZlYzsKIHN0cnVjdCB0aHJlYWRfdnJfc3RhdGUgdnJfc3RhdGU7CiBzdHJ1Y3QgdGhy
ZWFkX3ZyX3N0YXRlICp2cl9zYXZlX2FyZWE7CiB1bnNpZ25lZCBsb25nIHZyc2F2ZTsKIGlu
dCB1c2VkX3ZyOwojIDI0OSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vcHJvY2Vzc29y
LmgiCiB1bnNpZ25lZCBsb25nIGRzY3I7CiB1bnNpZ25lZCBsb25nIGZzY3I7CiMgMjYwICIu
L2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9wcm9jZXNzb3IuaCIKIGludCBkc2NyX2luaGVy
aXQ7CiB1bnNpZ25lZCBsb25nIHRpZHI7CiMgMjc2ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRl
L2FzbS9wcm9jZXNzb3IuaCIKfTsKIyAzMTAgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNt
L3Byb2Nlc3Nvci5oIgp1bnNpZ25lZCBsb25nIGdldF93Y2hhbihzdHJ1Y3QgdGFza19zdHJ1
Y3QgKnApOwojIDMxOSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vcHJvY2Vzc29yLmgi
CmV4dGVybiBpbnQgZ2V0X2ZwZXhjX21vZGUoc3RydWN0IHRhc2tfc3RydWN0ICp0c2ssIHVu
c2lnbmVkIGxvbmcgYWRyKTsKZXh0ZXJuIGludCBzZXRfZnBleGNfbW9kZShzdHJ1Y3QgdGFz
a19zdHJ1Y3QgKnRzaywgdW5zaWduZWQgaW50IHZhbCk7CgoKCgpleHRlcm4gaW50IGdldF9l
bmRpYW4oc3RydWN0IHRhc2tfc3RydWN0ICp0c2ssIHVuc2lnbmVkIGxvbmcgYWRyKTsKZXh0
ZXJuIGludCBzZXRfZW5kaWFuKHN0cnVjdCB0YXNrX3N0cnVjdCAqdHNrLCB1bnNpZ25lZCBp
bnQgdmFsKTsKCgoKCmV4dGVybiBpbnQgZ2V0X3VuYWxpZ25fY3RsKHN0cnVjdCB0YXNrX3N0
cnVjdCAqdHNrLCB1bnNpZ25lZCBsb25nIGFkcik7CmV4dGVybiBpbnQgc2V0X3VuYWxpZ25f
Y3RsKHN0cnVjdCB0YXNrX3N0cnVjdCAqdHNrLCB1bnNpZ25lZCBpbnQgdmFsKTsKCmV4dGVy
biB2b2lkIGxvYWRfZnBfc3RhdGUoc3RydWN0IHRocmVhZF9mcF9zdGF0ZSAqZnApOwpleHRl
cm4gdm9pZCBzdG9yZV9mcF9zdGF0ZShzdHJ1Y3QgdGhyZWFkX2ZwX3N0YXRlICpmcCk7CmV4
dGVybiB2b2lkIGxvYWRfdnJfc3RhdGUoc3RydWN0IHRocmVhZF92cl9zdGF0ZSAqdnIpOwpl
eHRlcm4gdm9pZCBzdG9yZV92cl9zdGF0ZShzdHJ1Y3QgdGhyZWFkX3ZyX3N0YXRlICp2cik7
CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgdW5zaWduZWQgaW50IF9fdW5wYWNrX2ZlMDEodW5zaWduZWQgbG9uZyBt
c3JfYml0cykKewogcmV0dXJuICgobXNyX2JpdHMgJiAoMVVMPDwoMTEpKSkgPj4gMTApIHwg
KChtc3JfYml0cyAmICgxVUw8PCg4KSkpID4+IDgpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQg
bG9uZyBfX3BhY2tfZmUwMSh1bnNpZ25lZCBpbnQgZnBtb2RlKQp7CiByZXR1cm4gKChmcG1v
ZGUgPDwgMTApICYgKDFVTDw8KDExKSkpIHwgKChmcG1vZGUgPDwgOCkgJiAoMVVMPDwoOCkp
KTsKfQojIDM3NCAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vcHJvY2Vzc29yLmgiCmlu
dCB2YWxpZGF0ZV9zcCh1bnNpZ25lZCBsb25nIHNwLCBzdHJ1Y3QgdGFza19zdHJ1Y3QgKnAs
CiAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgbG9uZyBuYnl0ZXMpOwojIDM4NCAi
Li9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vcHJvY2Vzc29yLmgiCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lk
IHByZWZldGNoKGNvbnN0IHZvaWQgKngpCnsKIGlmIChfX2J1aWx0aW5fZXhwZWN0KCEhKCF4
KSwgMCkpCiAgcmV0dXJuOwoKIF9fYXNtX18gX192b2xhdGlsZV9fICgiZGNidCAwLCUwIiA6
IDogInIiICh4KSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHByZWZldGNodyhjb25zdCB2b2lkICp4
KQp7CiBpZiAoX19idWlsdGluX2V4cGVjdCghISgheCksIDApKQogIHJldHVybjsKCiBfX2Fz
bV9fIF9fdm9sYXRpbGVfXyAoImRjYnRzdCAwLCUwIiA6IDogInIiICh4KSk7Cn0KCgoKCgoK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIHVuc2lnbmVkIGxvbmcgZ2V0X2NsZWFuX3NwKHVuc2lnbmVkIGxvbmcgc3As
IGludCBpc18zMikKewogaWYgKGlzXzMyKQogIHJldHVybiBzcCAmIDB4MGZmZmZmZmZmVUw7
CiByZXR1cm4gc3A7Cn0KIyA0MTkgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL3Byb2Nl
c3Nvci5oIgpleHRlcm4gdW5zaWduZWQgbG9uZyBpc2EzMDBfaWRsZV9zdG9wX25vbG9zcyh1
bnNpZ25lZCBsb25nIHBzc2NyX3ZhbCk7CmV4dGVybiB1bnNpZ25lZCBsb25nIGlzYTMwMF9p
ZGxlX3N0b3BfbWF5bG9zcyh1bnNpZ25lZCBsb25nIHBzc2NyX3ZhbCk7CmV4dGVybiB1bnNp
Z25lZCBsb25nIGlzYTIwNl9pZGxlX2luc25fbWF5bG9zcyh1bnNpZ25lZCBsb25nIHR5cGUp
OwoKCgoKZXh0ZXJuIHVuc2lnbmVkIGxvbmcgY3B1aWRsZV9kaXNhYmxlOwplbnVtIGlkbGVf
Ym9vdF9vdmVycmlkZSB7SURMRV9OT19PVkVSUklERSA9IDAsIElETEVfUE9XRVJTQVZFX09G
Rn07CgpleHRlcm4gaW50IHBvd2Vyc2F2ZV9uYXA7CgpleHRlcm4gdm9pZCBwb3dlcjdfaWRs
ZV90eXBlKHVuc2lnbmVkIGxvbmcgdHlwZSk7CmV4dGVybiB2b2lkIHBvd2VyOV9pZGxlX3R5
cGUodW5zaWduZWQgbG9uZyBzdG9wX3Bzc2NyX3ZhbCwKICAgICAgICAgdW5zaWduZWQgbG9u
ZyBzdG9wX3Bzc2NyX21hc2spOwoKZXh0ZXJuIHZvaWQgZmx1c2hfaW5zdHJ1Y3Rpb25fY2Fj
aGUodm9pZCk7CmV4dGVybiB2b2lkIGhhcmRfcmVzZXRfbm93KHZvaWQpOwpleHRlcm4gdm9p
ZCBwb3dlcm9mZl9ub3codm9pZCk7CmV4dGVybiBpbnQgZml4X2FsaWdubWVudChzdHJ1Y3Qg
cHRfcmVncyAqKTsKZXh0ZXJuIHZvaWQgY3Z0X2ZkKGZsb2F0ICpmcm9tLCBkb3VibGUgKnRv
KTsKZXh0ZXJuIHZvaWQgY3Z0X2RmKGRvdWJsZSAqZnJvbSwgZmxvYXQgKnRvKTsKZXh0ZXJu
IHZvaWQgX25tYXNrX2FuZF9vcl9tc3IodW5zaWduZWQgbG9uZyBubWFzaywgdW5zaWduZWQg
bG9uZyBvcl92YWwpOwojIDQxICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS90aHJlYWRf
aW5mby5oIiAyCgoKCgoKCgpzdHJ1Y3QgdGhyZWFkX2luZm8gewogaW50IHByZWVtcHRfY291
bnQ7CgogdW5zaWduZWQgbG9uZyBsb2NhbF9mbGFnczsKCgoKCgoKIHVuc2lnbmVkIGNoYXIg
c2xiX3ByZWxvYWRfbnI7CiB1bnNpZ25lZCBjaGFyIHNsYl9wcmVsb2FkX3RhaWw7CiB1MzIg
c2xiX3ByZWxvYWRfZXNpZFsxNlVdOwoKCiB1bnNpZ25lZCBsb25nIGZsYWdzIF9fYXR0cmli
dXRlX18oKF9fYWxpZ25lZF9fKCgxIDw8IDYpKSkpOwp9OwojIDc4ICIuL2FyY2gvcG93ZXJw
Yy9pbmNsdWRlL2FzbS90aHJlYWRfaW5mby5oIgpleHRlcm4gaW50IGFyY2hfZHVwX3Rhc2tf
c3RydWN0KHN0cnVjdCB0YXNrX3N0cnVjdCAqZHN0LCBzdHJ1Y3QgdGFza19zdHJ1Y3QgKnNy
Yyk7CiMgMTU5ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS90aHJlYWRfaW5mby5oIgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgYm9vbCB0ZXN0X3RocmVhZF9sb2NhbF9mbGFncyh1bnNpZ25lZCBpbnQgZmxh
Z3MpCnsKIHN0cnVjdCB0aHJlYWRfaW5mbyAqdGkgPSAoKHN0cnVjdCB0aHJlYWRfaW5mbyAq
KWdldF9jdXJyZW50KCkpOwogcmV0dXJuICh0aS0+bG9jYWxfZmxhZ3MgJiBmbGFncykgIT0g
MDsKfQojIDM5ICIuL2luY2x1ZGUvbGludXgvdGhyZWFkX2luZm8uaCIgMgojIDUzICIuL2lu
Y2x1ZGUvbGludXgvdGhyZWFkX2luZm8uaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgc2V0X3RpX3RocmVh
ZF9mbGFnKHN0cnVjdCB0aHJlYWRfaW5mbyAqdGksIGludCBmbGFnKQp7CiBzZXRfYml0KGZs
YWcsICh1bnNpZ25lZCBsb25nICopJnRpLT5mbGFncyk7Cn0KCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGNs
ZWFyX3RpX3RocmVhZF9mbGFnKHN0cnVjdCB0aHJlYWRfaW5mbyAqdGksIGludCBmbGFnKQp7
CiBjbGVhcl9iaXQoZmxhZywgKHVuc2lnbmVkIGxvbmcgKikmdGktPmZsYWdzKTsKfQoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIHZvaWQgdXBkYXRlX3RpX3RocmVhZF9mbGFnKHN0cnVjdCB0aHJlYWRfaW5mbyAq
dGksIGludCBmbGFnLAogICAgICBib29sIHZhbHVlKQp7CiBpZiAodmFsdWUpCiAgc2V0X3Rp
X3RocmVhZF9mbGFnKHRpLCBmbGFnKTsKIGVsc2UKICBjbGVhcl90aV90aHJlYWRfZmxhZyh0
aSwgZmxhZyk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgdGVzdF9hbmRfc2V0X3RpX3RocmVhZF9mbGFn
KHN0cnVjdCB0aHJlYWRfaW5mbyAqdGksIGludCBmbGFnKQp7CiByZXR1cm4gdGVzdF9hbmRf
c2V0X2JpdChmbGFnLCAodW5zaWduZWQgbG9uZyAqKSZ0aS0+ZmxhZ3MpOwp9CgpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgaW50IHRlc3RfYW5kX2NsZWFyX3RpX3RocmVhZF9mbGFnKHN0cnVjdCB0aHJlYWRfaW5m
byAqdGksIGludCBmbGFnKQp7CiByZXR1cm4gdGVzdF9hbmRfY2xlYXJfYml0KGZsYWcsICh1
bnNpZ25lZCBsb25nICopJnRpLT5mbGFncyk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgdGVzdF90aV90
aHJlYWRfZmxhZyhzdHJ1Y3QgdGhyZWFkX2luZm8gKnRpLCBpbnQgZmxhZykKewogcmV0dXJu
IHRlc3RfYml0KGZsYWcsICh1bnNpZ25lZCBsb25nICopJnRpLT5mbGFncyk7Cn0KIyAxMDMg
Ii4vaW5jbHVkZS9saW51eC90aHJlYWRfaW5mby5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGFyY2hfd2l0
aGluX3N0YWNrX2ZyYW1lcyhjb25zdCB2b2lkICogY29uc3Qgc3RhY2ssCiAgICAgICAgY29u
c3Qgdm9pZCAqIGNvbnN0IHN0YWNrZW5kLAogICAgICAgIGNvbnN0IHZvaWQgKm9iaiwgdW5z
aWduZWQgbG9uZyBsZW4pCnsKIHJldHVybiAwOwp9CiMgMTIyICIuL2luY2x1ZGUvbGludXgv
dGhyZWFkX2luZm8uaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgY2hlY2tfb2JqZWN0X3NpemUoY29uc3Qg
dm9pZCAqcHRyLCB1bnNpZ25lZCBsb25nIG4sCiAgICAgICAgIGJvb2wgdG9fdXNlcikKeyB9
CgoKZXh0ZXJuIHZvaWQgX19hdHRyaWJ1dGVfXygoX19lcnJvcl9fKCJjb3B5IHNvdXJjZSBz
aXplIGlzIHRvbyBzbWFsbCIpKSkKX19iYWRfY29weV9mcm9tKHZvaWQpOwpleHRlcm4gdm9p
ZCBfX2F0dHJpYnV0ZV9fKChfX2Vycm9yX18oImNvcHkgZGVzdGluYXRpb24gc2l6ZSBpcyB0
b28gc21hbGwiKSkpCl9fYmFkX2NvcHlfdG8odm9pZCk7CgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBjb3B5
X292ZXJmbG93KGludCBzaXplLCB1bnNpZ25lZCBsb25nIGNvdW50KQp7CiAoeyBpbnQgX19y
ZXRfd2Fybl9vbiA9ICEhKDEpOyBpZiAoX19idWlsdGluX2V4cGVjdCghIShfX3JldF93YXJu
X29uKSwgMCkpIGRvIHsgZG8geyB9IHdoaWxlKDApOyBfX3dhcm5fcHJpbnRrKCJCdWZmZXIg
b3ZlcmZsb3cgZGV0ZWN0ZWQgKCVkIDwgJWx1KSFcbiIsIHNpemUsIGNvdW50KTsgX19hc21f
XyBfX3ZvbGF0aWxlX18oICIxOgkiICJ0d2kgMzEsIDAsIDAiICJcbiIgIi5zZWN0aW9uIF9f
YnVnX3RhYmxlLFwiYXdcIlxuIiAiMjpcdCIgIi44Ynl0ZSIgIiAiICIxYiwgJTBcbiIgIlx0
LnNob3J0ICUxLCAlMlxuIiAiLm9yZyAyYislM1xuIiAiLnByZXZpb3VzXG4iIDogOiAiaSIg
KCIuL2luY2x1ZGUvbGludXgvdGhyZWFkX2luZm8uaCIpLCAiaSIgKDEzNCksICJpIiAoKDEg
PDwgMCkgfCAoKDEgPDwgMykgfCAoKDkpIDw8IDgpKSksICJpIiAoc2l6ZW9mKHN0cnVjdCBi
dWdfZW50cnkpKSk7IGRvIHsgfSB3aGlsZSgwKTsgfSB3aGlsZSAoMCk7IF9fYnVpbHRpbl9l
eHBlY3QoISEoX19yZXRfd2Fybl9vbiksIDApOyB9KTsKfQoKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmli
dXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX193YXJuX3VudXNl
ZF9yZXN1bHRfXykpCgojIDEzNyAiLi9pbmNsdWRlL2xpbnV4L3RocmVhZF9pbmZvLmgiCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvb2wKY2hlY2tfY29weV9zaXpl
KGNvbnN0IHZvaWQgKmFkZHIsIHNpemVfdCBieXRlcywgYm9vbCBpc19zb3VyY2UpCnsKIGlu
dCBzeiA9IF9fYnVpbHRpbl9vYmplY3Rfc2l6ZShhZGRyLCAwKTsKIGlmIChfX2J1aWx0aW5f
ZXhwZWN0KCEhKHN6ID49IDAgJiYgc3ogPCBieXRlcyksIDApKSB7CiAgaWYgKCFfX2J1aWx0
aW5fY29uc3RhbnRfcChieXRlcykpCiAgIGNvcHlfb3ZlcmZsb3coc3osIGJ5dGVzKTsKICBl
bHNlIGlmIChpc19zb3VyY2UpCiAgIF9fYmFkX2NvcHlfZnJvbSgpOwogIGVsc2UKICAgX19i
YWRfY29weV90bygpOwogIHJldHVybiBmYWxzZTsKIH0KIGlmICgoeyBpbnQgX19yZXRfd2Fy
bl9vbiA9ICEhKGJ5dGVzID4gKChpbnQpKH4wVSA+PiAxKSkpOyBpZiAoX19idWlsdGluX2V4
cGVjdCghIShfX3JldF93YXJuX29uKSwgMCkpIF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJ
IiAidHdpIDMxLCAwLCAwIiAiXG4iICIuc2VjdGlvbiBfX2J1Z190YWJsZSxcImF3XCJcbiIg
IjI6XHQiICIuOGJ5dGUiICIgIiAiMWIsICUwXG4iICJcdC5zaG9ydCAlMSwgJTJcbiIgIi5v
cmcgMmIrJTNcbiIgIi5wcmV2aW91c1xuIiA6IDogImkiICgiLi9pbmNsdWRlL2xpbnV4L3Ro
cmVhZF9pbmZvLmgiKSwgImkiICgxNTApLCAiaSIgKCgxIDw8IDApIHwgKCgxIDw8IDEpIHwg
KCg5KSA8PCA4KSkpLCAiaSIgKHNpemVvZihzdHJ1Y3QgYnVnX2VudHJ5KSkpOyBfX2J1aWx0
aW5fZXhwZWN0KCEhKF9fcmV0X3dhcm5fb24pLCAwKTsgfSkpCiAgcmV0dXJuIGZhbHNlOwog
Y2hlY2tfb2JqZWN0X3NpemUoYWRkciwgYnl0ZXMsIGlzX3NvdXJjZSk7CiByZXR1cm4gdHJ1
ZTsKfQoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSB2b2lkIGFyY2hfc2V0dXBfbmV3X2V4ZWModm9pZCkgeyB9CiMg
MjU0ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9wdHJhY2UuaCIgMgpleHRlcm4gaW50
IHJlZ3NfcXVlcnlfcmVnaXN0ZXJfb2Zmc2V0KGNvbnN0IGNoYXIgKm5hbWUpOwpleHRlcm4g
Y29uc3QgY2hhciAqcmVnc19xdWVyeV9yZWdpc3Rlcl9uYW1lKHVuc2lnbmVkIGludCBvZmZz
ZXQpOwojIDI2NyAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vcHRyYWNlLmgiCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSB1bnNpZ25lZCBsb25nIHJlZ3NfZ2V0X3JlZ2lzdGVyKHN0cnVjdCBwdF9yZWdzICpy
ZWdzLAogICAgICB1bnNpZ25lZCBpbnQgb2Zmc2V0KQp7CiBpZiAoX19idWlsdGluX2V4cGVj
dCghIShvZmZzZXQgPiAoX19idWlsdGluX29mZnNldG9mKHN0cnVjdCBwdF9yZWdzLCBkc2lz
cikpKSwgMCkpCiAgcmV0dXJuIDA7CiByZXR1cm4gKih1bnNpZ25lZCBsb25nICopKCh1bnNp
Z25lZCBsb25nKXJlZ3MgKyBvZmZzZXQpOwp9CiMgMjg0ICIuL2FyY2gvcG93ZXJwYy9pbmNs
dWRlL2FzbS9wdHJhY2UuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgcmVnc193aXRoaW5fa2VybmVsX3N0
YWNrKHN0cnVjdCBwdF9yZWdzICpyZWdzLAogICAgICB1bnNpZ25lZCBsb25nIGFkZHIpCnsK
IHJldHVybiAoKGFkZHIgJiB+KCgxIDw8IDE0KSAtIDEpKSA9PQogICgoKHJlZ3MpLT5ncHJb
MV0pICYgfigoMSA8PCAxNCkgLSAxKSkpOwp9CiMgMzAwICIuL2FyY2gvcG93ZXJwYy9pbmNs
dWRlL2FzbS9wdHJhY2UuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHVuc2lnbmVkIGxvbmcgcmVnc19nZXRfa2Vy
bmVsX3N0YWNrX250aChzdHJ1Y3QgcHRfcmVncyAqcmVncywKICAgICAgICAgICAgdW5zaWdu
ZWQgaW50IG4pCnsKIHVuc2lnbmVkIGxvbmcgKmFkZHIgPSAodW5zaWduZWQgbG9uZyAqKSgo
cmVncyktPmdwclsxXSk7CiBhZGRyICs9IG47CiBpZiAocmVnc193aXRoaW5fa2VybmVsX3N0
YWNrKHJlZ3MsICh1bnNpZ25lZCBsb25nKWFkZHIpKQogIHJldHVybiAqYWRkcjsKIGVsc2UK
ICByZXR1cm4gMDsKfQojIDEzICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9od19pcnEu
aCIgMgojIDU0ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9od19pcnEuaCIKZXh0ZXJu
IHZvaWQgcmVwbGF5X3N5c3RlbV9yZXNldCh2b2lkKTsKZXh0ZXJuIHZvaWQgcmVwbGF5X3Nv
ZnRfaW50ZXJydXB0cyh2b2lkKTsKCmV4dGVybiB2b2lkIHRpbWVyX2ludGVycnVwdChzdHJ1
Y3QgcHRfcmVncyAqKTsKZXh0ZXJuIHZvaWQgdGltZXJfYnJvYWRjYXN0X2ludGVycnVwdCh2
b2lkKTsKZXh0ZXJuIHZvaWQgcGVyZm9ybWFuY2VfbW9uaXRvcl9leGNlcHRpb24oc3RydWN0
IHB0X3JlZ3MgKnJlZ3MpOwpleHRlcm4gdm9pZCBXYXRjaGRvZ0V4Y2VwdGlvbihzdHJ1Y3Qg
cHRfcmVncyAqcmVncyk7CmV4dGVybiB2b2lkIHVua25vd25fZXhjZXB0aW9uKHN0cnVjdCBw
dF9yZWdzICpyZWdzKTsKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHVuc2lnbmVkIGxvbmcgaXJxX3NvZnRfbWFza19yZXR1cm4o
dm9pZCkKewogdW5zaWduZWQgbG9uZyBmbGFnczsKCiBhc20gdm9sYXRpbGUoCiAgImxieiAl
MCwlMSgxMykiCiAgOiAiPXIiIChmbGFncykKICA6ICJpIiAoX19idWlsdGluX29mZnNldG9m
KHN0cnVjdCBwYWNhX3N0cnVjdCwgaXJxX3NvZnRfbWFzaykpKTsKCiByZXR1cm4gZmxhZ3M7
Cn0KCgoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgdm9pZCBpcnFfc29mdF9tYXNrX3NldCh1bnNpZ25lZCBsb25nIG1hc2spCnsK
IyAxMDMgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2h3X2lycS5oIgogYXNtIHZvbGF0
aWxlKAogICJzdGIgJTAsJTEoMTMpIgogIDoKICA6ICJyIiAobWFzayksCiAgICAiaSIgKF9f
YnVpbHRpbl9vZmZzZXRvZihzdHJ1Y3QgcGFjYV9zdHJ1Y3QsIGlycV9zb2Z0X21hc2spKQog
IDogIm1lbW9yeSIpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSB1bnNpZ25lZCBsb25nIGlycV9zb2Z0X21hc2tfc2V0X3JldHVy
bih1bnNpZ25lZCBsb25nIG1hc2spCnsKIHVuc2lnbmVkIGxvbmcgZmxhZ3M7CgoKCgoKIGFz
bSB2b2xhdGlsZSgKICAibGJ6ICUwLCUxKDEzKTsgc3RiICUyLCUxKDEzKSIKICA6ICI9JnIi
IChmbGFncykKICA6ICJpIiAoX19idWlsdGluX29mZnNldG9mKHN0cnVjdCBwYWNhX3N0cnVj
dCwgaXJxX3NvZnRfbWFzaykpLAogICAgInIiIChtYXNrKQogIDogIm1lbW9yeSIpOwoKIHJl
dHVybiBmbGFnczsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgbG9uZyBpcnFfc29mdF9tYXNrX29yX3JldHVybih1
bnNpZ25lZCBsb25nIG1hc2spCnsKIHVuc2lnbmVkIGxvbmcgZmxhZ3MsIHRtcDsKCiBhc20g
dm9sYXRpbGUoCiAgImxieiAlMCwlMigxMyk7IG9yICUxLCUwLCUzOyBzdGIgJTEsJTIoMTMp
IgogIDogIj0mciIgKGZsYWdzKSwgIj1yIiAodG1wKQogIDogImkiIChfX2J1aWx0aW5fb2Zm
c2V0b2Yoc3RydWN0IHBhY2Ffc3RydWN0LCBpcnFfc29mdF9tYXNrKSksCiAgICAiciIgKG1h
c2spCiAgOiAibWVtb3J5Iik7CgoKCgoKIHJldHVybiBmbGFnczsKfQoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHVu
c2lnbmVkIGxvbmcgYXJjaF9sb2NhbF9zYXZlX2ZsYWdzKHZvaWQpCnsKIHJldHVybiBpcnFf
c29mdF9tYXNrX3JldHVybigpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBhcmNoX2xvY2FsX2lycV9k
aXNhYmxlKHZvaWQpCnsKIGlycV9zb2Z0X21hc2tfc2V0KDEpOwp9CgpleHRlcm4gdm9pZCBh
cmNoX2xvY2FsX2lycV9yZXN0b3JlKHVuc2lnbmVkIGxvbmcpOwoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQg
YXJjaF9sb2NhbF9pcnFfZW5hYmxlKHZvaWQpCnsKIGFyY2hfbG9jYWxfaXJxX3Jlc3RvcmUo
MCk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSB1bnNpZ25lZCBsb25nIGFyY2hfbG9jYWxfaXJxX3NhdmUodm9p
ZCkKewogcmV0dXJuIGlycV9zb2Z0X21hc2tfc2V0X3JldHVybigxKTsKfQoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IGJvb2wgYXJjaF9pcnFzX2Rpc2FibGVkX2ZsYWdzKHVuc2lnbmVkIGxvbmcgZmxhZ3MpCnsK
IHJldHVybiBmbGFncyAmIDE7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIGFyY2hfaXJxc19kaXNhYmxl
ZCh2b2lkKQp7CiByZXR1cm4gYXJjaF9pcnFzX2Rpc2FibGVkX2ZsYWdzKGFyY2hfbG9jYWxf
c2F2ZV9mbGFncygpKTsKfQojIDI1MyAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vaHdf
aXJxLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSBib29sIF9fbGF6eV9pcnFfcGVuZGluZyh1OCBpcnFfaGFwcGVu
ZWQpCnsKIHJldHVybiAhIShpcnFfaGFwcGVuZWQgJiB+MHgwMSk7Cn0KCgoKCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBib29sIGxhenlfaXJxX3BlbmRpbmcodm9pZCkKewogcmV0dXJuIF9fbGF6eV9pcnFfcGVu
ZGluZyhsb2NhbF9wYWNhLT5pcnFfaGFwcGVuZWQpOwp9CgoKCgoKCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29s
IGxhenlfaXJxX3BlbmRpbmdfbm9jaGVjayh2b2lkKQp7CiByZXR1cm4gX19sYXp5X2lycV9w
ZW5kaW5nKGxvY2FsX3BhY2EtPmlycV9oYXBwZW5lZCk7Cn0KCgoKCgoKCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2
b2lkIG1heV9oYXJkX2lycV9lbmFibGUodm9pZCkKewogaWYgKCEobG9jYWxfcGFjYS0+aXJx
X2hhcHBlbmVkICYgKDB4MDQpKSkgewogIGxvY2FsX3BhY2EtPmlycV9oYXBwZW5lZCAmPSB+
MHgwMTsKICB3cnRlZSgoMVVMPDwoMTUpKSk7CiB9Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIGFyY2hf
aXJxX2Rpc2FibGVkX3JlZ3Moc3RydWN0IHB0X3JlZ3MgKnJlZ3MpCnsKIHJldHVybiAocmVn
cy0+c29mdGUgJiAxKTsKfQoKZXh0ZXJuIGJvb2wgcHJlcF9pcnFfZm9yX2lkbGUodm9pZCk7
CmV4dGVybiBib29sIHByZXBfaXJxX2Zvcl9pZGxlX2lycXNvZmYodm9pZCk7CmV4dGVybiB2
b2lkIGlycV9zZXRfcGVuZGluZ19mcm9tX3NycjEodW5zaWduZWQgbG9uZyBzcnIxKTsKCgoK
ZXh0ZXJuIHZvaWQgZm9yY2VfZXh0ZXJuYWxfaXJxX3JlcGxheSh2b2lkKTsKIyAzNzkgIi4v
YXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2h3X2lycS5oIgpzdHJ1Y3QgaXJxX2NoaXA7CiMg
MTMgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2lycWZsYWdzLmgiIDIKIyAxNyAiLi9p
bmNsdWRlL2xpbnV4L2lycWZsYWdzLmgiIDIKIyAyNiAiLi9pbmNsdWRlL2xpbnV4L2lycWZs
YWdzLmgiCiAgc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgbG9ja2RlcF9zb2Z0aXJxc19vbih1bnNpZ25lZCBs
b25nIGlwKSB7IH0KICBzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBsb2NrZGVwX3NvZnRpcnFzX29mZih1bnNp
Z25lZCBsb25nIGlwKSB7IH0KICBzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBsb2NrZGVwX2hhcmRpcnFzX29u
X3ByZXBhcmUodW5zaWduZWQgbG9uZyBpcCkgeyB9CiAgc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgbG9ja2Rl
cF9oYXJkaXJxc19vbih1bnNpZ25lZCBsb25nIGlwKSB7IH0KICBzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBs
b2NrZGVwX2hhcmRpcnFzX29mZih1bnNpZ25lZCBsb25nIGlwKSB7IH0KIyAyNyAiLi9pbmNs
dWRlL2xpbnV4L3JjdXBkYXRlLmgiIDIKIyAxICIuL2luY2x1ZGUvbGludXgvcHJlZW1wdC5o
IiAxCiMgNzggIi4vaW5jbHVkZS9saW51eC9wcmVlbXB0LmgiCiMgMSAiLi9hcmNoL3Bvd2Vy
cGMvaW5jbHVkZS9nZW5lcmF0ZWQvYXNtL3ByZWVtcHQuaCIgMQojIDEgIi4vaW5jbHVkZS9h
c20tZ2VuZXJpYy9wcmVlbXB0LmgiIDEKIyA5ICIuL2luY2x1ZGUvYXNtLWdlbmVyaWMvcHJl
ZW1wdC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBp
bnQgcHJlZW1wdF9jb3VudCh2b2lkKQp7CiByZXR1cm4gKHsgZG8geyBleHRlcm4gdm9pZCBf
X2NvbXBpbGV0aW1lX2Fzc2VydF8zNCh2b2lkKSBfX2F0dHJpYnV0ZV9fKChfX2Vycm9yX18o
IlVuc3VwcG9ydGVkIGFjY2VzcyBzaXplIGZvciB7UkVBRCxXUklURX1fT05DRSgpLiIpKSk7
IGlmICghKChzaXplb2YoKChzdHJ1Y3QgdGhyZWFkX2luZm8gKilnZXRfY3VycmVudCgpKS0+
cHJlZW1wdF9jb3VudCkgPT0gc2l6ZW9mKGNoYXIpIHx8IHNpemVvZigoKHN0cnVjdCB0aHJl
YWRfaW5mbyAqKWdldF9jdXJyZW50KCkpLT5wcmVlbXB0X2NvdW50KSA9PSBzaXplb2Yoc2hv
cnQpIHx8IHNpemVvZigoKHN0cnVjdCB0aHJlYWRfaW5mbyAqKWdldF9jdXJyZW50KCkpLT5w
cmVlbXB0X2NvdW50KSA9PSBzaXplb2YoaW50KSB8fCBzaXplb2YoKChzdHJ1Y3QgdGhyZWFk
X2luZm8gKilnZXRfY3VycmVudCgpKS0+cHJlZW1wdF9jb3VudCkgPT0gc2l6ZW9mKGxvbmcp
KSB8fCBzaXplb2YoKChzdHJ1Y3QgdGhyZWFkX2luZm8gKilnZXRfY3VycmVudCgpKS0+cHJl
ZW1wdF9jb3VudCkgPT0gc2l6ZW9mKGxvbmcgbG9uZykpKSBfX2NvbXBpbGV0aW1lX2Fzc2Vy
dF8zNCgpOyB9IHdoaWxlICgwKTsgKHsgdHlwZW9mKCBfR2VuZXJpYygoKChzdHJ1Y3QgdGhy
ZWFkX2luZm8gKilnZXRfY3VycmVudCgpKS0+cHJlZW1wdF9jb3VudCksIGNoYXI6IChjaGFy
KTAsIHVuc2lnbmVkIGNoYXI6ICh1bnNpZ25lZCBjaGFyKTAsIHNpZ25lZCBjaGFyOiAoc2ln
bmVkIGNoYXIpMCwgdW5zaWduZWQgc2hvcnQ6ICh1bnNpZ25lZCBzaG9ydCkwLCBzaWduZWQg
c2hvcnQ6IChzaWduZWQgc2hvcnQpMCwgdW5zaWduZWQgaW50OiAodW5zaWduZWQgaW50KTAs
IHNpZ25lZCBpbnQ6IChzaWduZWQgaW50KTAsIHVuc2lnbmVkIGxvbmc6ICh1bnNpZ25lZCBs
b25nKTAsIHNpZ25lZCBsb25nOiAoc2lnbmVkIGxvbmcpMCwgdW5zaWduZWQgbG9uZyBsb25n
OiAodW5zaWduZWQgbG9uZyBsb25nKTAsIHNpZ25lZCBsb25nIGxvbmc6IChzaWduZWQgbG9u
ZyBsb25nKTAsIGRlZmF1bHQ6ICgoKHN0cnVjdCB0aHJlYWRfaW5mbyAqKWdldF9jdXJyZW50
KCkpLT5wcmVlbXB0X2NvdW50KSkpIF9feCA9ICgqKGNvbnN0IHZvbGF0aWxlIHR5cGVvZigg
X0dlbmVyaWMoKCgoc3RydWN0IHRocmVhZF9pbmZvICopZ2V0X2N1cnJlbnQoKSktPnByZWVt
cHRfY291bnQpLCBjaGFyOiAoY2hhcikwLCB1bnNpZ25lZCBjaGFyOiAodW5zaWduZWQgY2hh
cikwLCBzaWduZWQgY2hhcjogKHNpZ25lZCBjaGFyKTAsIHVuc2lnbmVkIHNob3J0OiAodW5z
aWduZWQgc2hvcnQpMCwgc2lnbmVkIHNob3J0OiAoc2lnbmVkIHNob3J0KTAsIHVuc2lnbmVk
IGludDogKHVuc2lnbmVkIGludCkwLCBzaWduZWQgaW50OiAoc2lnbmVkIGludCkwLCB1bnNp
Z25lZCBsb25nOiAodW5zaWduZWQgbG9uZykwLCBzaWduZWQgbG9uZzogKHNpZ25lZCBsb25n
KTAsIHVuc2lnbmVkIGxvbmcgbG9uZzogKHVuc2lnbmVkIGxvbmcgbG9uZykwLCBzaWduZWQg
bG9uZyBsb25nOiAoc2lnbmVkIGxvbmcgbG9uZykwLCBkZWZhdWx0OiAoKChzdHJ1Y3QgdGhy
ZWFkX2luZm8gKilnZXRfY3VycmVudCgpKS0+cHJlZW1wdF9jb3VudCkpKSAqKSYoKChzdHJ1
Y3QgdGhyZWFkX2luZm8gKilnZXRfY3VycmVudCgpKS0+cHJlZW1wdF9jb3VudCkpOyBkbyB7
IH0gd2hpbGUgKDApOyAodHlwZW9mKCgoc3RydWN0IHRocmVhZF9pbmZvICopZ2V0X2N1cnJl
bnQoKSktPnByZWVtcHRfY291bnQpKV9feDsgfSk7IH0pOwp9CgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRy
aWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB2b2xhdGlsZSBpbnQgKnByZWVtcHRfY291
bnRfcHRyKHZvaWQpCnsKIHJldHVybiAmKChzdHJ1Y3QgdGhyZWFkX2luZm8gKilnZXRfY3Vy
cmVudCgpKS0+cHJlZW1wdF9jb3VudDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9f
YWx3YXlzX2lubGluZV9fKSkgdm9pZCBwcmVlbXB0X2NvdW50X3NldChpbnQgcGMpCnsKICpw
cmVlbXB0X2NvdW50X3B0cigpID0gcGM7Cn0KIyAzNSAiLi9pbmNsdWRlL2FzbS1nZW5lcmlj
L3ByZWVtcHQuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9f
KSkgdm9pZCBzZXRfcHJlZW1wdF9uZWVkX3Jlc2NoZWQodm9pZCkKewp9CgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
X19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB2b2lkIGNsZWFyX3ByZWVtcHRf
bmVlZF9yZXNjaGVkKHZvaWQpCnsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3
YXlzX2lubGluZV9fKSkgYm9vbCB0ZXN0X3ByZWVtcHRfbmVlZF9yZXNjaGVkKHZvaWQpCnsK
IHJldHVybiBmYWxzZTsKfQoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5
c19pbmxpbmVfXykpIHZvaWQgX19wcmVlbXB0X2NvdW50X2FkZChpbnQgdmFsKQp7CiAqcHJl
ZW1wdF9jb3VudF9wdHIoKSArPSB2YWw7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChf
X2Fsd2F5c19pbmxpbmVfXykpIHZvaWQgX19wcmVlbXB0X2NvdW50X3N1YihpbnQgdmFsKQp7
CiAqcHJlZW1wdF9jb3VudF9wdHIoKSAtPSB2YWw7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0
ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIGJvb2wgX19wcmVlbXB0X2NvdW50X2RlY19hbmRf
dGVzdCh2b2lkKQp7CgoKCgoKIHJldHVybiAhLS0qcHJlZW1wdF9jb3VudF9wdHIoKSAmJiB0
ZXN0X3RpX3RocmVhZF9mbGFnKCgoc3RydWN0IHRocmVhZF9pbmZvICopZ2V0X2N1cnJlbnQo
KSksIDIpOwp9CgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5l
X18pKSBib29sIHNob3VsZF9yZXNjaGVkKGludCBwcmVlbXB0X29mZnNldCkKewogcmV0dXJu
IF9fYnVpbHRpbl9leHBlY3QoISEocHJlZW1wdF9jb3VudCgpID09IHByZWVtcHRfb2Zmc2V0
ICYmIHRlc3RfdGlfdGhyZWFkX2ZsYWcoKChzdHJ1Y3QgdGhyZWFkX2luZm8gKilnZXRfY3Vy
cmVudCgpKSwgMikpLCAwKQogICAgICAgICAgICAgICAgICAgICAgOwp9CiMgMSAiLi9hcmNo
L3Bvd2VycGMvaW5jbHVkZS9nZW5lcmF0ZWQvYXNtL3ByZWVtcHQuaCIgMgojIDc5ICIuL2lu
Y2x1ZGUvbGludXgvcHJlZW1wdC5oIiAyCiMgMzM1ICIuL2luY2x1ZGUvbGludXgvcHJlZW1w
dC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB2b2lk
IG1pZ3JhdGVfZGlzYWJsZSh2b2lkKQp7CiBfX2FzbV9fIF9fdm9sYXRpbGVfXygiIjogOiA6
Im1lbW9yeSIpOwp9CiMgMzUwICIuL2luY2x1ZGUvbGludXgvcHJlZW1wdC5oIgpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB2b2lkIG1pZ3JhdGVfZW5h
YmxlKHZvaWQpCnsKIF9fYXNtX18gX192b2xhdGlsZV9fKCIiOiA6IDoibWVtb3J5Iik7Cn0K
IyAyOCAiLi9pbmNsdWRlL2xpbnV4L3JjdXBkYXRlLmgiIDIKIyAxICIuL2luY2x1ZGUvbGlu
dXgvYm90dG9tX2hhbGYuaCIgMQojIDEwICIuL2luY2x1ZGUvbGludXgvYm90dG9tX2hhbGYu
aCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgdm9pZCBf
X2xvY2FsX2JoX2Rpc2FibGVfaXAodW5zaWduZWQgbG9uZyBpcCwgdW5zaWduZWQgaW50IGNu
dCkKewogX19wcmVlbXB0X2NvdW50X2FkZChjbnQpOwogX19hc21fXyBfX3ZvbGF0aWxlX18o
IiI6IDogOiJtZW1vcnkiKTsKfQoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGxvY2FsX2JoX2Rpc2FibGUo
dm9pZCkKewogX19sb2NhbF9iaF9kaXNhYmxlX2lwKCh7IF9fbGFiZWxfXyBfX2hlcmU7IF9f
aGVyZTogKHVuc2lnbmVkIGxvbmcpJiZfX2hlcmU7IH0pLCAoMiAqICgxVUwgPDwgKDAgKyA4
KSkpKTsKfQoKZXh0ZXJuIHZvaWQgX2xvY2FsX2JoX2VuYWJsZSh2b2lkKTsKZXh0ZXJuIHZv
aWQgX19sb2NhbF9iaF9lbmFibGVfaXAodW5zaWduZWQgbG9uZyBpcCwgdW5zaWduZWQgaW50
IGNudCk7CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBsb2NhbF9iaF9lbmFibGVfaXAodW5zaWduZWQgbG9u
ZyBpcCkKewogX19sb2NhbF9iaF9lbmFibGVfaXAoaXAsICgyICogKDFVTCA8PCAoMCArIDgp
KSkpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBsb2NhbF9iaF9lbmFibGUodm9pZCkKewogX19sb2Nh
bF9iaF9lbmFibGVfaXAoKHsgX19sYWJlbF9fIF9faGVyZTsgX19oZXJlOiAodW5zaWduZWQg
bG9uZykmJl9faGVyZTsgfSksICgyICogKDFVTCA8PCAoMCArIDgpKSkpOwp9CiMgMjkgIi4v
aW5jbHVkZS9saW51eC9yY3VwZGF0ZS5oIiAyCgoKIyAxICIuL2luY2x1ZGUvbGludXgvY3B1
bWFzay5oIiAxCiMgMTIgIi4vaW5jbHVkZS9saW51eC9jcHVtYXNrLmgiCiMgMSAiLi9pbmNs
dWRlL2xpbnV4L2JpdG1hcC5oIiAxCiMgMTIxICIuL2luY2x1ZGUvbGludXgvYml0bWFwLmgi
CmV4dGVybiB1bnNpZ25lZCBsb25nICpiaXRtYXBfYWxsb2ModW5zaWduZWQgaW50IG5iaXRz
LCBnZnBfdCBmbGFncyk7CmV4dGVybiB1bnNpZ25lZCBsb25nICpiaXRtYXBfemFsbG9jKHVu
c2lnbmVkIGludCBuYml0cywgZ2ZwX3QgZmxhZ3MpOwpleHRlcm4gdm9pZCBiaXRtYXBfZnJl
ZShjb25zdCB1bnNpZ25lZCBsb25nICpiaXRtYXApOwoKCgoKCmV4dGVybiBpbnQgX19iaXRt
YXBfZW1wdHkoY29uc3QgdW5zaWduZWQgbG9uZyAqYml0bWFwLCB1bnNpZ25lZCBpbnQgbmJp
dHMpOwpleHRlcm4gaW50IF9fYml0bWFwX2Z1bGwoY29uc3QgdW5zaWduZWQgbG9uZyAqYml0
bWFwLCB1bnNpZ25lZCBpbnQgbmJpdHMpOwpleHRlcm4gaW50IF9fYml0bWFwX2VxdWFsKGNv
bnN0IHVuc2lnbmVkIGxvbmcgKmJpdG1hcDEsCiAgICAgY29uc3QgdW5zaWduZWQgbG9uZyAq
Yml0bWFwMiwgdW5zaWduZWQgaW50IG5iaXRzKTsKZXh0ZXJuIGJvb2wgX19hdHRyaWJ1dGVf
XygoX19wdXJlX18pKSBfX2JpdG1hcF9vcl9lcXVhbChjb25zdCB1bnNpZ25lZCBsb25nICpz
cmMxLAogICAgICAgICBjb25zdCB1bnNpZ25lZCBsb25nICpzcmMyLAogICAgICAgICBjb25z
dCB1bnNpZ25lZCBsb25nICpzcmMzLAogICAgICAgICB1bnNpZ25lZCBpbnQgbmJpdHMpOwpl
eHRlcm4gdm9pZCBfX2JpdG1hcF9jb21wbGVtZW50KHVuc2lnbmVkIGxvbmcgKmRzdCwgY29u
c3QgdW5zaWduZWQgbG9uZyAqc3JjLAogICB1bnNpZ25lZCBpbnQgbmJpdHMpOwpleHRlcm4g
dm9pZCBfX2JpdG1hcF9zaGlmdF9yaWdodCh1bnNpZ25lZCBsb25nICpkc3QsIGNvbnN0IHVu
c2lnbmVkIGxvbmcgKnNyYywKICAgIHVuc2lnbmVkIGludCBzaGlmdCwgdW5zaWduZWQgaW50
IG5iaXRzKTsKZXh0ZXJuIHZvaWQgX19iaXRtYXBfc2hpZnRfbGVmdCh1bnNpZ25lZCBsb25n
ICpkc3QsIGNvbnN0IHVuc2lnbmVkIGxvbmcgKnNyYywKICAgIHVuc2lnbmVkIGludCBzaGlm
dCwgdW5zaWduZWQgaW50IG5iaXRzKTsKZXh0ZXJuIHZvaWQgYml0bWFwX2N1dCh1bnNpZ25l
ZCBsb25nICpkc3QsIGNvbnN0IHVuc2lnbmVkIGxvbmcgKnNyYywKICAgICAgICAgdW5zaWdu
ZWQgaW50IGZpcnN0LCB1bnNpZ25lZCBpbnQgY3V0LAogICAgICAgICB1bnNpZ25lZCBpbnQg
bmJpdHMpOwpleHRlcm4gaW50IF9fYml0bWFwX2FuZCh1bnNpZ25lZCBsb25nICpkc3QsIGNv
bnN0IHVuc2lnbmVkIGxvbmcgKmJpdG1hcDEsCiAgIGNvbnN0IHVuc2lnbmVkIGxvbmcgKmJp
dG1hcDIsIHVuc2lnbmVkIGludCBuYml0cyk7CmV4dGVybiB2b2lkIF9fYml0bWFwX29yKHVu
c2lnbmVkIGxvbmcgKmRzdCwgY29uc3QgdW5zaWduZWQgbG9uZyAqYml0bWFwMSwKICAgY29u
c3QgdW5zaWduZWQgbG9uZyAqYml0bWFwMiwgdW5zaWduZWQgaW50IG5iaXRzKTsKZXh0ZXJu
IHZvaWQgX19iaXRtYXBfeG9yKHVuc2lnbmVkIGxvbmcgKmRzdCwgY29uc3QgdW5zaWduZWQg
bG9uZyAqYml0bWFwMSwKICAgY29uc3QgdW5zaWduZWQgbG9uZyAqYml0bWFwMiwgdW5zaWdu
ZWQgaW50IG5iaXRzKTsKZXh0ZXJuIGludCBfX2JpdG1hcF9hbmRub3QodW5zaWduZWQgbG9u
ZyAqZHN0LCBjb25zdCB1bnNpZ25lZCBsb25nICpiaXRtYXAxLAogICBjb25zdCB1bnNpZ25l
ZCBsb25nICpiaXRtYXAyLCB1bnNpZ25lZCBpbnQgbmJpdHMpOwpleHRlcm4gdm9pZCBfX2Jp
dG1hcF9yZXBsYWNlKHVuc2lnbmVkIGxvbmcgKmRzdCwKICAgY29uc3QgdW5zaWduZWQgbG9u
ZyAqb2xkLCBjb25zdCB1bnNpZ25lZCBsb25nICpuZXcsCiAgIGNvbnN0IHVuc2lnbmVkIGxv
bmcgKm1hc2ssIHVuc2lnbmVkIGludCBuYml0cyk7CmV4dGVybiBpbnQgX19iaXRtYXBfaW50
ZXJzZWN0cyhjb25zdCB1bnNpZ25lZCBsb25nICpiaXRtYXAxLAogICBjb25zdCB1bnNpZ25l
ZCBsb25nICpiaXRtYXAyLCB1bnNpZ25lZCBpbnQgbmJpdHMpOwpleHRlcm4gaW50IF9fYml0
bWFwX3N1YnNldChjb25zdCB1bnNpZ25lZCBsb25nICpiaXRtYXAxLAogICBjb25zdCB1bnNp
Z25lZCBsb25nICpiaXRtYXAyLCB1bnNpZ25lZCBpbnQgbmJpdHMpOwpleHRlcm4gaW50IF9f
Yml0bWFwX3dlaWdodChjb25zdCB1bnNpZ25lZCBsb25nICpiaXRtYXAsIHVuc2lnbmVkIGlu
dCBuYml0cyk7CmV4dGVybiB2b2lkIF9fYml0bWFwX3NldCh1bnNpZ25lZCBsb25nICptYXAs
IHVuc2lnbmVkIGludCBzdGFydCwgaW50IGxlbik7CmV4dGVybiB2b2lkIF9fYml0bWFwX2Ns
ZWFyKHVuc2lnbmVkIGxvbmcgKm1hcCwgdW5zaWduZWQgaW50IHN0YXJ0LCBpbnQgbGVuKTsK
CmV4dGVybiB1bnNpZ25lZCBsb25nIGJpdG1hcF9maW5kX25leHRfemVyb19hcmVhX29mZih1
bnNpZ25lZCBsb25nICptYXAsCiAgICAgICAgICB1bnNpZ25lZCBsb25nIHNpemUsCiAgICAg
ICAgICB1bnNpZ25lZCBsb25nIHN0YXJ0LAogICAgICAgICAgdW5zaWduZWQgaW50IG5yLAog
ICAgICAgICAgdW5zaWduZWQgbG9uZyBhbGlnbl9tYXNrLAogICAgICAgICAgdW5zaWduZWQg
bG9uZyBhbGlnbl9vZmZzZXQpOwojIDE4NCAiLi9pbmNsdWRlL2xpbnV4L2JpdG1hcC5oIgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgdW5zaWduZWQgbG9uZwpiaXRtYXBfZmluZF9uZXh0X3plcm9fYXJlYSh1bnNp
Z25lZCBsb25nICptYXAsCiAgICAgIHVuc2lnbmVkIGxvbmcgc2l6ZSwKICAgICAgdW5zaWdu
ZWQgbG9uZyBzdGFydCwKICAgICAgdW5zaWduZWQgaW50IG5yLAogICAgICB1bnNpZ25lZCBs
b25nIGFsaWduX21hc2spCnsKIHJldHVybiBiaXRtYXBfZmluZF9uZXh0X3plcm9fYXJlYV9v
ZmYobWFwLCBzaXplLCBzdGFydCwgbnIsCiAgICAgICAgICAgYWxpZ25fbWFzaywgMCk7Cn0K
CmV4dGVybiBpbnQgYml0bWFwX3BhcnNlKGNvbnN0IGNoYXIgKmJ1ZiwgdW5zaWduZWQgaW50
IGJ1ZmxlbiwKICAgdW5zaWduZWQgbG9uZyAqZHN0LCBpbnQgbmJpdHMpOwpleHRlcm4gaW50
IGJpdG1hcF9wYXJzZV91c2VyKGNvbnN0IGNoYXIgKnVidWYsIHVuc2lnbmVkIGludCB1bGVu
LAogICB1bnNpZ25lZCBsb25nICpkc3QsIGludCBuYml0cyk7CmV4dGVybiBpbnQgYml0bWFw
X3BhcnNlbGlzdChjb25zdCBjaGFyICpidWYsIHVuc2lnbmVkIGxvbmcgKm1hc2twLAogICBp
bnQgbm1hc2tiaXRzKTsKZXh0ZXJuIGludCBiaXRtYXBfcGFyc2VsaXN0X3VzZXIoY29uc3Qg
Y2hhciAqdWJ1ZiwgdW5zaWduZWQgaW50IHVsZW4sCiAgIHVuc2lnbmVkIGxvbmcgKmRzdCwg
aW50IG5iaXRzKTsKZXh0ZXJuIHZvaWQgYml0bWFwX3JlbWFwKHVuc2lnbmVkIGxvbmcgKmRz
dCwgY29uc3QgdW5zaWduZWQgbG9uZyAqc3JjLAogIGNvbnN0IHVuc2lnbmVkIGxvbmcgKm9s
ZCwgY29uc3QgdW5zaWduZWQgbG9uZyAqbmV3LCB1bnNpZ25lZCBpbnQgbmJpdHMpOwpleHRl
cm4gaW50IGJpdG1hcF9iaXRyZW1hcChpbnQgb2xkYml0LAogIGNvbnN0IHVuc2lnbmVkIGxv
bmcgKm9sZCwgY29uc3QgdW5zaWduZWQgbG9uZyAqbmV3LCBpbnQgYml0cyk7CmV4dGVybiB2
b2lkIGJpdG1hcF9vbnRvKHVuc2lnbmVkIGxvbmcgKmRzdCwgY29uc3QgdW5zaWduZWQgbG9u
ZyAqb3JpZywKICBjb25zdCB1bnNpZ25lZCBsb25nICpyZWxtYXAsIHVuc2lnbmVkIGludCBi
aXRzKTsKZXh0ZXJuIHZvaWQgYml0bWFwX2ZvbGQodW5zaWduZWQgbG9uZyAqZHN0LCBjb25z
dCB1bnNpZ25lZCBsb25nICpvcmlnLAogIHVuc2lnbmVkIGludCBzeiwgdW5zaWduZWQgaW50
IG5iaXRzKTsKZXh0ZXJuIGludCBiaXRtYXBfZmluZF9mcmVlX3JlZ2lvbih1bnNpZ25lZCBs
b25nICpiaXRtYXAsIHVuc2lnbmVkIGludCBiaXRzLCBpbnQgb3JkZXIpOwpleHRlcm4gdm9p
ZCBiaXRtYXBfcmVsZWFzZV9yZWdpb24odW5zaWduZWQgbG9uZyAqYml0bWFwLCB1bnNpZ25l
ZCBpbnQgcG9zLCBpbnQgb3JkZXIpOwpleHRlcm4gaW50IGJpdG1hcF9hbGxvY2F0ZV9yZWdp
b24odW5zaWduZWQgbG9uZyAqYml0bWFwLCB1bnNpZ25lZCBpbnQgcG9zLCBpbnQgb3JkZXIp
OwoKCmV4dGVybiB2b2lkIGJpdG1hcF9jb3B5X2xlKHVuc2lnbmVkIGxvbmcgKmRzdCwgY29u
c3QgdW5zaWduZWQgbG9uZyAqc3JjLCB1bnNpZ25lZCBpbnQgbmJpdHMpOwoKCgpleHRlcm4g
dW5zaWduZWQgaW50IGJpdG1hcF9vcmRfdG9fcG9zKGNvbnN0IHVuc2lnbmVkIGxvbmcgKmJp
dG1hcCwgdW5zaWduZWQgaW50IG9yZCwgdW5zaWduZWQgaW50IG5iaXRzKTsKZXh0ZXJuIGlu
dCBiaXRtYXBfcHJpbnRfdG9fcGFnZWJ1Zihib29sIGxpc3QsIGNoYXIgKmJ1ZiwKICAgICAg
IGNvbnN0IHVuc2lnbmVkIGxvbmcgKm1hc2twLCBpbnQgbm1hc2tiaXRzKTsKIyAyMzUgIi4v
aW5jbHVkZS9saW51eC9iaXRtYXAuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgYml0bWFwX3plcm8odW5z
aWduZWQgbG9uZyAqZHN0LCB1bnNpZ25lZCBpbnQgbmJpdHMpCnsKIHVuc2lnbmVkIGludCBs
ZW4gPSAoKChuYml0cykgKyAoKHNpemVvZihsb25nKSAqIDgpKSAtIDEpIC8gKChzaXplb2Yo
bG9uZykgKiA4KSkpICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpOwogbWVtc2V0KGRzdCwgMCwg
bGVuKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgYml0bWFwX2ZpbGwodW5zaWduZWQgbG9uZyAqZHN0
LCB1bnNpZ25lZCBpbnQgbmJpdHMpCnsKIHVuc2lnbmVkIGludCBsZW4gPSAoKChuYml0cykg
KyAoKHNpemVvZihsb25nKSAqIDgpKSAtIDEpIC8gKChzaXplb2YobG9uZykgKiA4KSkpICog
c2l6ZW9mKHVuc2lnbmVkIGxvbmcpOwogbWVtc2V0KGRzdCwgMHhmZiwgbGVuKTsKfQoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIHZvaWQgYml0bWFwX2NvcHkodW5zaWduZWQgbG9uZyAqZHN0LCBjb25zdCB1bnNp
Z25lZCBsb25nICpzcmMsCiAgIHVuc2lnbmVkIGludCBuYml0cykKewogdW5zaWduZWQgaW50
IGxlbiA9ICgoKG5iaXRzKSArICgoc2l6ZW9mKGxvbmcpICogOCkpIC0gMSkgLyAoKHNpemVv
Zihsb25nKSAqIDgpKSkgKiBzaXplb2YodW5zaWduZWQgbG9uZyk7CiBtZW1jcHkoZHN0LCBz
cmMsIGxlbik7Cn0KCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGJpdG1hcF9jb3B5X2NsZWFyX3RhaWwo
dW5zaWduZWQgbG9uZyAqZHN0LAogIGNvbnN0IHVuc2lnbmVkIGxvbmcgKnNyYywgdW5zaWdu
ZWQgaW50IG5iaXRzKQp7CiBiaXRtYXBfY29weShkc3QsIHNyYywgbmJpdHMpOwogaWYgKG5i
aXRzICUgNjQpCiAgZHN0W25iaXRzIC8gNjRdICY9ICh+MFVMID4+ICgtKG5iaXRzKSAmICg2
NCAtIDEpKSk7Cn0KCgoKCgoKZXh0ZXJuIHZvaWQgYml0bWFwX2Zyb21fYXJyMzIodW5zaWdu
ZWQgbG9uZyAqYml0bWFwLCBjb25zdCB1MzIgKmJ1ZiwKICAgICAgIHVuc2lnbmVkIGludCBu
Yml0cyk7CmV4dGVybiB2b2lkIGJpdG1hcF90b19hcnIzMih1MzIgKmJ1ZiwgY29uc3QgdW5z
aWduZWQgbG9uZyAqYml0bWFwLAogICAgICAgdW5zaWduZWQgaW50IG5iaXRzKTsKIyAyODMg
Ii4vaW5jbHVkZS9saW51eC9iaXRtYXAuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBiaXRtYXBfYW5kKHVu
c2lnbmVkIGxvbmcgKmRzdCwgY29uc3QgdW5zaWduZWQgbG9uZyAqc3JjMSwKICAgY29uc3Qg
dW5zaWduZWQgbG9uZyAqc3JjMiwgdW5zaWduZWQgaW50IG5iaXRzKQp7CiBpZiAoKF9fYnVp
bHRpbl9jb25zdGFudF9wKG5iaXRzKSAmJiAobmJpdHMpIDw9IDY0ICYmIChuYml0cykgPiAw
KSkKICByZXR1cm4gKCpkc3QgPSAqc3JjMSAmICpzcmMyICYgKH4wVUwgPj4gKC0obmJpdHMp
ICYgKDY0IC0gMSkpKSkgIT0gMDsKIHJldHVybiBfX2JpdG1hcF9hbmQoZHN0LCBzcmMxLCBz
cmMyLCBuYml0cyk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGJpdG1hcF9vcih1bnNpZ25lZCBsb25n
ICpkc3QsIGNvbnN0IHVuc2lnbmVkIGxvbmcgKnNyYzEsCiAgIGNvbnN0IHVuc2lnbmVkIGxv
bmcgKnNyYzIsIHVuc2lnbmVkIGludCBuYml0cykKewogaWYgKChfX2J1aWx0aW5fY29uc3Rh
bnRfcChuYml0cykgJiYgKG5iaXRzKSA8PSA2NCAmJiAobmJpdHMpID4gMCkpCiAgKmRzdCA9
ICpzcmMxIHwgKnNyYzI7CiBlbHNlCiAgX19iaXRtYXBfb3IoZHN0LCBzcmMxLCBzcmMyLCBu
Yml0cyk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGJpdG1hcF94b3IodW5zaWduZWQgbG9uZyAqZHN0
LCBjb25zdCB1bnNpZ25lZCBsb25nICpzcmMxLAogICBjb25zdCB1bnNpZ25lZCBsb25nICpz
cmMyLCB1bnNpZ25lZCBpbnQgbmJpdHMpCnsKIGlmICgoX19idWlsdGluX2NvbnN0YW50X3Ao
bmJpdHMpICYmIChuYml0cykgPD0gNjQgJiYgKG5iaXRzKSA+IDApKQogICpkc3QgPSAqc3Jj
MSBeICpzcmMyOwogZWxzZQogIF9fYml0bWFwX3hvcihkc3QsIHNyYzEsIHNyYzIsIG5iaXRz
KTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIGludCBiaXRtYXBfYW5kbm90KHVuc2lnbmVkIGxvbmcgKmRzdCwg
Y29uc3QgdW5zaWduZWQgbG9uZyAqc3JjMSwKICAgY29uc3QgdW5zaWduZWQgbG9uZyAqc3Jj
MiwgdW5zaWduZWQgaW50IG5iaXRzKQp7CiBpZiAoKF9fYnVpbHRpbl9jb25zdGFudF9wKG5i
aXRzKSAmJiAobmJpdHMpIDw9IDY0ICYmIChuYml0cykgPiAwKSkKICByZXR1cm4gKCpkc3Qg
PSAqc3JjMSAmIH4oKnNyYzIpICYgKH4wVUwgPj4gKC0obmJpdHMpICYgKDY0IC0gMSkpKSkg
IT0gMDsKIHJldHVybiBfX2JpdG1hcF9hbmRub3QoZHN0LCBzcmMxLCBzcmMyLCBuYml0cyk7
Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSB2b2lkIGJpdG1hcF9jb21wbGVtZW50KHVuc2lnbmVkIGxvbmcgKmRz
dCwgY29uc3QgdW5zaWduZWQgbG9uZyAqc3JjLAogICB1bnNpZ25lZCBpbnQgbmJpdHMpCnsK
IGlmICgoX19idWlsdGluX2NvbnN0YW50X3AobmJpdHMpICYmIChuYml0cykgPD0gNjQgJiYg
KG5iaXRzKSA+IDApKQogICpkc3QgPSB+KCpzcmMpOwogZWxzZQogIF9fYml0bWFwX2NvbXBs
ZW1lbnQoZHN0LCBzcmMsIG5iaXRzKTsKfQojIDMzMyAiLi9pbmNsdWRlL2xpbnV4L2JpdG1h
cC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgaW50IGJpdG1hcF9lcXVhbChjb25zdCB1bnNpZ25lZCBsb25nICpz
cmMxLAogICBjb25zdCB1bnNpZ25lZCBsb25nICpzcmMyLCB1bnNpZ25lZCBpbnQgbmJpdHMp
CnsKIGlmICgoX19idWlsdGluX2NvbnN0YW50X3AobmJpdHMpICYmIChuYml0cykgPD0gNjQg
JiYgKG5iaXRzKSA+IDApKQogIHJldHVybiAhKCgqc3JjMSBeICpzcmMyKSAmICh+MFVMID4+
ICgtKG5iaXRzKSAmICg2NCAtIDEpKSkpOwogaWYgKF9fYnVpbHRpbl9jb25zdGFudF9wKG5i
aXRzICYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpKSAtIDEpKSAmJgogICAgICgoKG5i
aXRzKSAmICgodHlwZW9mKG5iaXRzKSkoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykpKSAt
IDEpKSA9PSAwKSkKICByZXR1cm4gIW1lbWNtcChzcmMxLCBzcmMyLCBuYml0cyAvIDgpOwog
cmV0dXJuIF9fYml0bWFwX2VxdWFsKHNyYzEsIHNyYzIsIG5iaXRzKTsKfQojIDM1MyAiLi9p
bmNsdWRlL2xpbnV4L2JpdG1hcC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBiaXRtYXBfb3JfZXF1YWwo
Y29uc3QgdW5zaWduZWQgbG9uZyAqc3JjMSwKICAgICAgIGNvbnN0IHVuc2lnbmVkIGxvbmcg
KnNyYzIsCiAgICAgICBjb25zdCB1bnNpZ25lZCBsb25nICpzcmMzLAogICAgICAgdW5zaWdu
ZWQgaW50IG5iaXRzKQp7CiBpZiAoIShfX2J1aWx0aW5fY29uc3RhbnRfcChuYml0cykgJiYg
KG5iaXRzKSA8PSA2NCAmJiAobmJpdHMpID4gMCkpCiAgcmV0dXJuIF9fYml0bWFwX29yX2Vx
dWFsKHNyYzEsIHNyYzIsIHNyYzMsIG5iaXRzKTsKCiByZXR1cm4gISgoKCpzcmMxIHwgKnNy
YzIpIF4gKnNyYzMpICYgKH4wVUwgPj4gKC0obmJpdHMpICYgKDY0IC0gMSkpKSk7Cn0KCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSBpbnQgYml0bWFwX2ludGVyc2VjdHMoY29uc3QgdW5zaWduZWQgbG9uZyAqc3Jj
MSwKICAgY29uc3QgdW5zaWduZWQgbG9uZyAqc3JjMiwgdW5zaWduZWQgaW50IG5iaXRzKQp7
CiBpZiAoKF9fYnVpbHRpbl9jb25zdGFudF9wKG5iaXRzKSAmJiAobmJpdHMpIDw9IDY0ICYm
IChuYml0cykgPiAwKSkKICByZXR1cm4gKCgqc3JjMSAmICpzcmMyKSAmICh+MFVMID4+ICgt
KG5iaXRzKSAmICg2NCAtIDEpKSkpICE9IDA7CiBlbHNlCiAgcmV0dXJuIF9fYml0bWFwX2lu
dGVyc2VjdHMoc3JjMSwgc3JjMiwgbmJpdHMpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGJpdG1hcF9z
dWJzZXQoY29uc3QgdW5zaWduZWQgbG9uZyAqc3JjMSwKICAgY29uc3QgdW5zaWduZWQgbG9u
ZyAqc3JjMiwgdW5zaWduZWQgaW50IG5iaXRzKQp7CiBpZiAoKF9fYnVpbHRpbl9jb25zdGFu
dF9wKG5iaXRzKSAmJiAobmJpdHMpIDw9IDY0ICYmIChuYml0cykgPiAwKSkKICByZXR1cm4g
ISAoKCpzcmMxICYgfigqc3JjMikpICYgKH4wVUwgPj4gKC0obmJpdHMpICYgKDY0IC0gMSkp
KSk7CiBlbHNlCiAgcmV0dXJuIF9fYml0bWFwX3N1YnNldChzcmMxLCBzcmMyLCBuYml0cyk7
Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSBpbnQgYml0bWFwX2VtcHR5KGNvbnN0IHVuc2lnbmVkIGxvbmcgKnNy
YywgdW5zaWduZWQgbmJpdHMpCnsKIGlmICgoX19idWlsdGluX2NvbnN0YW50X3AobmJpdHMp
ICYmIChuYml0cykgPD0gNjQgJiYgKG5iaXRzKSA+IDApKQogIHJldHVybiAhICgqc3JjICYg
KH4wVUwgPj4gKC0obmJpdHMpICYgKDY0IC0gMSkpKSk7CgogcmV0dXJuIGZpbmRfbmV4dF9i
aXQoKHNyYyksIChuYml0cyksIDApID09IG5iaXRzOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGJpdG1h
cF9mdWxsKGNvbnN0IHVuc2lnbmVkIGxvbmcgKnNyYywgdW5zaWduZWQgaW50IG5iaXRzKQp7
CiBpZiAoKF9fYnVpbHRpbl9jb25zdGFudF9wKG5iaXRzKSAmJiAobmJpdHMpIDw9IDY0ICYm
IChuYml0cykgPiAwKSkKICByZXR1cm4gISAofigqc3JjKSAmICh+MFVMID4+ICgtKG5iaXRz
KSAmICg2NCAtIDEpKSkpOwoKIHJldHVybiBmaW5kX25leHRfemVyb19iaXQoKHNyYyksIChu
Yml0cyksIDApID09IG5iaXRzOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdh
eXNfaW5saW5lX18pKSBpbnQgYml0bWFwX3dlaWdodChjb25zdCB1bnNpZ25lZCBsb25nICpz
cmMsIHVuc2lnbmVkIGludCBuYml0cykKewogaWYgKChfX2J1aWx0aW5fY29uc3RhbnRfcChu
Yml0cykgJiYgKG5iaXRzKSA8PSA2NCAmJiAobmJpdHMpID4gMCkpCiAgcmV0dXJuIGh3ZWln
aHRfbG9uZygqc3JjICYgKH4wVUwgPj4gKC0obmJpdHMpICYgKDY0IC0gMSkpKSk7CiByZXR1
cm4gX19iaXRtYXBfd2VpZ2h0KHNyYywgbmJpdHMpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1
dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB2b2lkIGJpdG1hcF9zZXQodW5zaWduZWQgbG9u
ZyAqbWFwLCB1bnNpZ25lZCBpbnQgc3RhcnQsCiAgdW5zaWduZWQgaW50IG5iaXRzKQp7CiBp
ZiAoX19idWlsdGluX2NvbnN0YW50X3AobmJpdHMpICYmIG5iaXRzID09IDEpCiAgX19zZXRf
Yml0KHN0YXJ0LCBtYXApOwogZWxzZSBpZiAoX19idWlsdGluX2NvbnN0YW50X3Aoc3RhcnQg
JiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykpIC0gMSkpICYmCiAgICgoKHN0YXJ0KSAm
ICgodHlwZW9mKHN0YXJ0KSkoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykpKSAtIDEpKSA9
PSAwKSAmJgogICBfX2J1aWx0aW5fY29uc3RhbnRfcChuYml0cyAmICgoOCAqIHNpemVvZih1
bnNpZ25lZCBsb25nKSkgLSAxKSkgJiYKICAgKCgobmJpdHMpICYgKCh0eXBlb2YobmJpdHMp
KSgoOCAqIHNpemVvZih1bnNpZ25lZCBsb25nKSkpIC0gMSkpID09IDApKQogIG1lbXNldCgo
Y2hhciAqKW1hcCArIHN0YXJ0IC8gOCwgMHhmZiwgbmJpdHMgLyA4KTsKIGVsc2UKICBfX2Jp
dG1hcF9zZXQobWFwLCBzdGFydCwgbmJpdHMpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVf
XygoX19hbHdheXNfaW5saW5lX18pKSB2b2lkIGJpdG1hcF9jbGVhcih1bnNpZ25lZCBsb25n
ICptYXAsIHVuc2lnbmVkIGludCBzdGFydCwKICB1bnNpZ25lZCBpbnQgbmJpdHMpCnsKIGlm
IChfX2J1aWx0aW5fY29uc3RhbnRfcChuYml0cykgJiYgbmJpdHMgPT0gMSkKICBfX2NsZWFy
X2JpdChzdGFydCwgbWFwKTsKIGVsc2UgaWYgKF9fYnVpbHRpbl9jb25zdGFudF9wKHN0YXJ0
ICYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpKSAtIDEpKSAmJgogICAoKChzdGFydCkg
JiAoKHR5cGVvZihzdGFydCkpKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpKSkgLSAxKSkg
PT0gMCkgJiYKICAgX19idWlsdGluX2NvbnN0YW50X3AobmJpdHMgJiAoKDggKiBzaXplb2Yo
dW5zaWduZWQgbG9uZykpIC0gMSkpICYmCiAgICgoKG5iaXRzKSAmICgodHlwZW9mKG5iaXRz
KSkoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykpKSAtIDEpKSA9PSAwKSkKICBtZW1zZXQo
KGNoYXIgKiltYXAgKyBzdGFydCAvIDgsIDAsIG5iaXRzIC8gOCk7CiBlbHNlCiAgX19iaXRt
YXBfY2xlYXIobWFwLCBzdGFydCwgbmJpdHMpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBiaXRtYXBf
c2hpZnRfcmlnaHQodW5zaWduZWQgbG9uZyAqZHN0LCBjb25zdCB1bnNpZ25lZCBsb25nICpz
cmMsCiAgICB1bnNpZ25lZCBpbnQgc2hpZnQsIHVuc2lnbmVkIGludCBuYml0cykKewogaWYg
KChfX2J1aWx0aW5fY29uc3RhbnRfcChuYml0cykgJiYgKG5iaXRzKSA8PSA2NCAmJiAobmJp
dHMpID4gMCkpCiAgKmRzdCA9ICgqc3JjICYgKH4wVUwgPj4gKC0obmJpdHMpICYgKDY0IC0g
MSkpKSkgPj4gc2hpZnQ7CiBlbHNlCiAgX19iaXRtYXBfc2hpZnRfcmlnaHQoZHN0LCBzcmMs
IHNoaWZ0LCBuYml0cyk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGJpdG1hcF9zaGlmdF9sZWZ0KHVu
c2lnbmVkIGxvbmcgKmRzdCwgY29uc3QgdW5zaWduZWQgbG9uZyAqc3JjLAogICAgdW5zaWdu
ZWQgaW50IHNoaWZ0LCB1bnNpZ25lZCBpbnQgbmJpdHMpCnsKIGlmICgoX19idWlsdGluX2Nv
bnN0YW50X3AobmJpdHMpICYmIChuYml0cykgPD0gNjQgJiYgKG5iaXRzKSA+IDApKQogICpk
c3QgPSAoKnNyYyA8PCBzaGlmdCkgJiAofjBVTCA+PiAoLShuYml0cykgJiAoNjQgLSAxKSkp
OwogZWxzZQogIF9fYml0bWFwX3NoaWZ0X2xlZnQoZHN0LCBzcmMsIHNoaWZ0LCBuYml0cyk7
Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSB2b2lkIGJpdG1hcF9yZXBsYWNlKHVuc2lnbmVkIGxvbmcgKmRzdCwK
ICAgICAgY29uc3QgdW5zaWduZWQgbG9uZyAqb2xkLAogICAgICBjb25zdCB1bnNpZ25lZCBs
b25nICpuZXcsCiAgICAgIGNvbnN0IHVuc2lnbmVkIGxvbmcgKm1hc2ssCiAgICAgIHVuc2ln
bmVkIGludCBuYml0cykKewogaWYgKChfX2J1aWx0aW5fY29uc3RhbnRfcChuYml0cykgJiYg
KG5iaXRzKSA8PSA2NCAmJiAobmJpdHMpID4gMCkpCiAgKmRzdCA9ICgqb2xkICYgfigqbWFz
aykpIHwgKCpuZXcgJiAqbWFzayk7CiBlbHNlCiAgX19iaXRtYXBfcmVwbGFjZShkc3QsIG9s
ZCwgbmV3LCBtYXNrLCBuYml0cyk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGJpdG1hcF9uZXh0X2Ns
ZWFyX3JlZ2lvbih1bnNpZ25lZCBsb25nICpiaXRtYXAsCiAgICAgICAgIHVuc2lnbmVkIGlu
dCAqcnMsIHVuc2lnbmVkIGludCAqcmUsCiAgICAgICAgIHVuc2lnbmVkIGludCBlbmQpCnsK
ICpycyA9IGZpbmRfbmV4dF96ZXJvX2JpdChiaXRtYXAsIGVuZCwgKnJzKTsKICpyZSA9IGZp
bmRfbmV4dF9iaXQoYml0bWFwLCBlbmQsICpycyArIDEpOwp9CgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBi
aXRtYXBfbmV4dF9zZXRfcmVnaW9uKHVuc2lnbmVkIGxvbmcgKmJpdG1hcCwKICAgICAgIHVu
c2lnbmVkIGludCAqcnMsIHVuc2lnbmVkIGludCAqcmUsCiAgICAgICB1bnNpZ25lZCBpbnQg
ZW5kKQp7CiAqcnMgPSBmaW5kX25leHRfYml0KGJpdG1hcCwgZW5kLCAqcnMpOwogKnJlID0g
ZmluZF9uZXh0X3plcm9fYml0KGJpdG1hcCwgZW5kLCAqcnMgKyAxKTsKfQojIDU0MSAiLi9p
bmNsdWRlL2xpbnV4L2JpdG1hcC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBiaXRtYXBfZnJvbV91NjQo
dW5zaWduZWQgbG9uZyAqZHN0LCB1NjQgbWFzaykKewogZHN0WzBdID0gbWFzayAmICh+MFVM
KTsKCiBpZiAoc2l6ZW9mKG1hc2spID4gc2l6ZW9mKHVuc2lnbmVkIGxvbmcpKQogIGRzdFsx
XSA9IG1hc2sgPj4gMzI7Cn0KIyA1NTcgIi4vaW5jbHVkZS9saW51eC9iaXRtYXAuaCIKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIHVuc2lnbmVkIGxvbmcgYml0bWFwX2dldF92YWx1ZTgoY29uc3QgdW5zaWduZWQg
bG9uZyAqbWFwLAogICAgICAgICAgIHVuc2lnbmVkIGxvbmcgc3RhcnQpCnsKIGNvbnN0IHNp
emVfdCBpbmRleCA9ICgoc3RhcnQpIC8gNjQpOwogY29uc3QgdW5zaWduZWQgbG9uZyBvZmZz
ZXQgPSBzdGFydCAlIDY0OwoKIHJldHVybiAobWFwW2luZGV4XSA+PiBvZmZzZXQpICYgMHhG
RjsKfQoKCgoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgYml0bWFwX3NldF92YWx1ZTgodW5zaWduZWQg
bG9uZyAqbWFwLCB1bnNpZ25lZCBsb25nIHZhbHVlLAogICAgICAgICB1bnNpZ25lZCBsb25n
IHN0YXJ0KQp7CiBjb25zdCBzaXplX3QgaW5kZXggPSAoKHN0YXJ0KSAvIDY0KTsKIGNvbnN0
IHVuc2lnbmVkIGxvbmcgb2Zmc2V0ID0gc3RhcnQgJSA2NDsKCiBtYXBbaW5kZXhdICY9IH4o
MHhGRlVMIDw8IG9mZnNldCk7CiBtYXBbaW5kZXhdIHw9IHZhbHVlIDw8IG9mZnNldDsKfQoj
IDEzICIuL2luY2x1ZGUvbGludXgvY3B1bWFzay5oIiAyCgoKCgp0eXBlZGVmIHN0cnVjdCBj
cHVtYXNrIHsgdW5zaWduZWQgbG9uZyBiaXRzWygoKDI0KSArICgoc2l6ZW9mKGxvbmcpICog
OCkpIC0gMSkgLyAoKHNpemVvZihsb25nKSAqIDgpKSldOyB9IGNwdW1hc2tfdDsKIyAzOSAi
Li9pbmNsdWRlL2xpbnV4L2NwdW1hc2suaCIKZXh0ZXJuIHVuc2lnbmVkIGludCBucl9jcHVf
aWRzOwojIDkwICIuL2luY2x1ZGUvbGludXgvY3B1bWFzay5oIgpleHRlcm4gc3RydWN0IGNw
dW1hc2sgX19jcHVfcG9zc2libGVfbWFzazsKZXh0ZXJuIHN0cnVjdCBjcHVtYXNrIF9fY3B1
X29ubGluZV9tYXNrOwpleHRlcm4gc3RydWN0IGNwdW1hc2sgX19jcHVfcHJlc2VudF9tYXNr
OwpleHRlcm4gc3RydWN0IGNwdW1hc2sgX19jcHVfYWN0aXZlX21hc2s7CgoKCgoKZXh0ZXJu
IGF0b21pY190IF9fbnVtX29ubGluZV9jcHVzOwojIDExMCAiLi9pbmNsdWRlL2xpbnV4L2Nw
dW1hc2suaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHVuc2lnbmVkIGludCBudW1fb25saW5lX2NwdXModm9pZCkK
ewogcmV0dXJuIGF0b21pY19yZWFkKCZfX251bV9vbmxpbmVfY3B1cyk7Cn0KIyAxMzIgIi4v
aW5jbHVkZS9saW51eC9jcHVtYXNrLmgiCmV4dGVybiBjcHVtYXNrX3QgY3B1c19ib290ZWRf
b25jZV9tYXNrOwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgY3B1X21heF9iaXRzX3dhcm4odW5zaWduZWQg
aW50IGNwdSwgdW5zaWduZWQgaW50IGJpdHMpCnsKCgoKfQoKCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1bnNpZ25l
ZCBpbnQgY3B1bWFza19jaGVjayh1bnNpZ25lZCBpbnQgY3B1KQp7CiBjcHVfbWF4X2JpdHNf
d2FybihjcHUsICgodW5zaWduZWQgaW50KTI0KSk7CiByZXR1cm4gY3B1Owp9CiMgMjE3ICIu
L2luY2x1ZGUvbGludXgvY3B1bWFzay5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgaW50IGNwdW1h
c2tfZmlyc3QoY29uc3Qgc3RydWN0IGNwdW1hc2sgKnNyY3ApCnsKIHJldHVybiBmaW5kX25l
eHRfYml0KCgoKHNyY3ApLT5iaXRzKSksICgoKHVuc2lnbmVkIGludCkyNCkpLCAwKTsKfQoK
CgoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIHVuc2lnbmVkIGludCBjcHVtYXNrX2xhc3QoY29uc3Qgc3RydWN0
IGNwdW1hc2sgKnNyY3ApCnsKIHJldHVybiBmaW5kX2xhc3RfYml0KCgoc3JjcCktPmJpdHMp
LCAoKHVuc2lnbmVkIGludCkyNCkpOwp9Cgp1bnNpZ25lZCBpbnQgY3B1bWFza19uZXh0KGlu
dCBuLCBjb25zdCBzdHJ1Y3QgY3B1bWFzayAqc3JjcCk7CiMgMjQyICIuL2luY2x1ZGUvbGlu
dXgvY3B1bWFzay5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgaW50IGNwdW1hc2tfbmV4dF96ZXJv
KGludCBuLCBjb25zdCBzdHJ1Y3QgY3B1bWFzayAqc3JjcCkKewoKIGlmIChuICE9IC0xKQog
IGNwdW1hc2tfY2hlY2sobik7CiByZXR1cm4gZmluZF9uZXh0X3plcm9fYml0KCgoc3JjcCkt
PmJpdHMpLCAoKHVuc2lnbmVkIGludCkyNCksIG4rMSk7Cn0KCmludCBjcHVtYXNrX25leHRf
YW5kKGludCBuLCBjb25zdCBzdHJ1Y3QgY3B1bWFzayAqLCBjb25zdCBzdHJ1Y3QgY3B1bWFz
ayAqKTsKaW50IGNwdW1hc2tfYW55X2J1dChjb25zdCBzdHJ1Y3QgY3B1bWFzayAqbWFzaywg
dW5zaWduZWQgaW50IGNwdSk7CnVuc2lnbmVkIGludCBjcHVtYXNrX2xvY2FsX3NwcmVhZCh1
bnNpZ25lZCBpbnQgaSwgaW50IG5vZGUpOwppbnQgY3B1bWFza19hbnlfYW5kX2Rpc3RyaWJ1
dGUoY29uc3Qgc3RydWN0IGNwdW1hc2sgKnNyYzFwLAogICAgICAgICAgY29uc3Qgc3RydWN0
IGNwdW1hc2sgKnNyYzJwKTsKIyAyODAgIi4vaW5jbHVkZS9saW51eC9jcHVtYXNrLmgiCmV4
dGVybiBpbnQgY3B1bWFza19uZXh0X3dyYXAoaW50IG4sIGNvbnN0IHN0cnVjdCBjcHVtYXNr
ICptYXNrLCBpbnQgc3RhcnQsIGJvb2wgd3JhcCk7CiMgMzMyICIuL2luY2x1ZGUvbGludXgv
Y3B1bWFzay5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBjcHVtYXNrX3NldF9jcHUodW5zaWduZWQgaW50
IGNwdSwgc3RydWN0IGNwdW1hc2sgKmRzdHApCnsKIHNldF9iaXQoY3B1bWFza19jaGVjayhj
cHUpLCAoKGRzdHApLT5iaXRzKSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIF9fY3B1bWFza19zZXRf
Y3B1KHVuc2lnbmVkIGludCBjcHUsIHN0cnVjdCBjcHVtYXNrICpkc3RwKQp7CiBfX3NldF9i
aXQoY3B1bWFza19jaGVjayhjcHUpLCAoKGRzdHApLT5iaXRzKSk7Cn0KCgoKCgoKCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSB2b2lkIGNwdW1hc2tfY2xlYXJfY3B1KGludCBjcHUsIHN0cnVjdCBjcHVtYXNrICpk
c3RwKQp7CiBjbGVhcl9iaXQoY3B1bWFza19jaGVjayhjcHUpLCAoKGRzdHApLT5iaXRzKSk7
Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSB2b2lkIF9fY3B1bWFza19jbGVhcl9jcHUoaW50IGNwdSwgc3RydWN0
IGNwdW1hc2sgKmRzdHApCnsKIF9fY2xlYXJfYml0KGNwdW1hc2tfY2hlY2soY3B1KSwgKChk
c3RwKS0+Yml0cykpOwp9CiMgMzY1ICIuL2luY2x1ZGUvbGludXgvY3B1bWFzay5oIgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgaW50IGNwdW1hc2tfdGVzdF9jcHUoaW50IGNwdSwgY29uc3Qgc3RydWN0IGNwdW1h
c2sgKmNwdW1hc2spCnsKIHJldHVybiB0ZXN0X2JpdChjcHVtYXNrX2NoZWNrKGNwdSksICgo
KGNwdW1hc2spKS0+Yml0cykpOwp9CiMgMzc5ICIuL2luY2x1ZGUvbGludXgvY3B1bWFzay5o
IgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgaW50IGNwdW1hc2tfdGVzdF9hbmRfc2V0X2NwdShpbnQgY3B1LCBzdHJ1
Y3QgY3B1bWFzayAqY3B1bWFzaykKewogcmV0dXJuIHRlc3RfYW5kX3NldF9iaXQoY3B1bWFz
a19jaGVjayhjcHUpLCAoKGNwdW1hc2spLT5iaXRzKSk7Cn0KIyAzOTMgIi4vaW5jbHVkZS9s
aW51eC9jcHVtYXNrLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgY3B1bWFza190ZXN0X2FuZF9jbGVhcl9j
cHUoaW50IGNwdSwgc3RydWN0IGNwdW1hc2sgKmNwdW1hc2spCnsKIHJldHVybiB0ZXN0X2Fu
ZF9jbGVhcl9iaXQoY3B1bWFza19jaGVjayhjcHUpLCAoKGNwdW1hc2spLT5iaXRzKSk7Cn0K
CgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgdm9pZCBjcHVtYXNrX3NldGFsbChzdHJ1Y3QgY3B1bWFzayAqZHN0
cCkKewogYml0bWFwX2ZpbGwoKChkc3RwKS0+Yml0cyksICgodW5zaWduZWQgaW50KTI0KSk7
Cn0KCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBjcHVtYXNrX2NsZWFyKHN0cnVjdCBjcHVtYXNrICpk
c3RwKQp7CiBiaXRtYXBfemVybygoKGRzdHApLT5iaXRzKSwgKCh1bnNpZ25lZCBpbnQpMjQp
KTsKfQojIDQyNCAiLi9pbmNsdWRlL2xpbnV4L2NwdW1hc2suaCIKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBj
cHVtYXNrX2FuZChzdHJ1Y3QgY3B1bWFzayAqZHN0cCwKICAgICAgICAgIGNvbnN0IHN0cnVj
dCBjcHVtYXNrICpzcmMxcCwKICAgICAgICAgIGNvbnN0IHN0cnVjdCBjcHVtYXNrICpzcmMy
cCkKewogcmV0dXJuIGJpdG1hcF9hbmQoKChkc3RwKS0+Yml0cyksICgoc3JjMXApLT5iaXRz
KSwKICAgICAgICAgICAoKHNyYzJwKS0+Yml0cyksICgodW5zaWduZWQgaW50KTI0KSk7Cn0K
CgoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSB2b2lkIGNwdW1hc2tfb3Ioc3RydWN0IGNwdW1hc2sgKmRzdHAs
IGNvbnN0IHN0cnVjdCBjcHVtYXNrICpzcmMxcCwKICAgICAgICAgY29uc3Qgc3RydWN0IGNw
dW1hc2sgKnNyYzJwKQp7CiBiaXRtYXBfb3IoKChkc3RwKS0+Yml0cyksICgoc3JjMXApLT5i
aXRzKSwKICAgICAgICAgICgoc3JjMnApLT5iaXRzKSwgKCh1bnNpZ25lZCBpbnQpMjQpKTsK
fQoKCgoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgY3B1bWFza194b3Ioc3RydWN0IGNwdW1hc2sgKmRz
dHAsCiAgICAgICAgICBjb25zdCBzdHJ1Y3QgY3B1bWFzayAqc3JjMXAsCiAgICAgICAgICBj
b25zdCBzdHJ1Y3QgY3B1bWFzayAqc3JjMnApCnsKIGJpdG1hcF94b3IoKChkc3RwKS0+Yml0
cyksICgoc3JjMXApLT5iaXRzKSwKICAgICAgICAgICAoKHNyYzJwKS0+Yml0cyksICgodW5z
aWduZWQgaW50KTI0KSk7Cn0KIyA0NjcgIi4vaW5jbHVkZS9saW51eC9jcHVtYXNrLmgiCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSBpbnQgY3B1bWFza19hbmRub3Qoc3RydWN0IGNwdW1hc2sgKmRzdHAsCiAgICAg
IGNvbnN0IHN0cnVjdCBjcHVtYXNrICpzcmMxcCwKICAgICAgY29uc3Qgc3RydWN0IGNwdW1h
c2sgKnNyYzJwKQp7CiByZXR1cm4gYml0bWFwX2FuZG5vdCgoKGRzdHApLT5iaXRzKSwgKChz
cmMxcCktPmJpdHMpLAogICAgICAgKChzcmMycCktPmJpdHMpLCAoKHVuc2lnbmVkIGludCky
NCkpOwp9CgoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGNwdW1hc2tfY29tcGxlbWVudChzdHJ1Y3Qg
Y3B1bWFzayAqZHN0cCwKICAgICAgICAgIGNvbnN0IHN0cnVjdCBjcHVtYXNrICpzcmNwKQp7
CiBiaXRtYXBfY29tcGxlbWVudCgoKGRzdHApLT5iaXRzKSwgKChzcmNwKS0+Yml0cyksCiAg
ICAgICAgICAgKCh1bnNpZ25lZCBpbnQpMjQpKTsKfQoKCgoKCgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBj
cHVtYXNrX2VxdWFsKGNvbnN0IHN0cnVjdCBjcHVtYXNrICpzcmMxcCwKICAgIGNvbnN0IHN0
cnVjdCBjcHVtYXNrICpzcmMycCkKewogcmV0dXJuIGJpdG1hcF9lcXVhbCgoKHNyYzFwKS0+
Yml0cyksICgoc3JjMnApLT5iaXRzKSwKICAgICAgICgodW5zaWduZWQgaW50KTI0KSk7Cn0K
CgoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSBib29sIGNwdW1hc2tfb3JfZXF1YWwoY29uc3Qgc3RydWN0IGNw
dW1hc2sgKnNyYzFwLAogICAgICAgIGNvbnN0IHN0cnVjdCBjcHVtYXNrICpzcmMycCwKICAg
ICAgICBjb25zdCBzdHJ1Y3QgY3B1bWFzayAqc3JjM3ApCnsKIHJldHVybiBiaXRtYXBfb3Jf
ZXF1YWwoKChzcmMxcCktPmJpdHMpLCAoKHNyYzJwKS0+Yml0cyksCiAgICAgICAgICAoKHNy
YzNwKS0+Yml0cyksICgodW5zaWduZWQgaW50KTI0KSk7Cn0KCgoKCgoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJv
b2wgY3B1bWFza19pbnRlcnNlY3RzKGNvbnN0IHN0cnVjdCBjcHVtYXNrICpzcmMxcCwKICAg
ICAgICAgY29uc3Qgc3RydWN0IGNwdW1hc2sgKnNyYzJwKQp7CiByZXR1cm4gYml0bWFwX2lu
dGVyc2VjdHMoKChzcmMxcCktPmJpdHMpLCAoKHNyYzJwKS0+Yml0cyksCiAgICAgICAgICAg
ICgodW5zaWduZWQgaW50KTI0KSk7Cn0KIyA1MzIgIi4vaW5jbHVkZS9saW51eC9jcHVtYXNr
LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSBpbnQgY3B1bWFza19zdWJzZXQoY29uc3Qgc3RydWN0IGNwdW1hc2sg
KnNyYzFwLAogICAgIGNvbnN0IHN0cnVjdCBjcHVtYXNrICpzcmMycCkKewogcmV0dXJuIGJp
dG1hcF9zdWJzZXQoKChzcmMxcCktPmJpdHMpLCAoKHNyYzJwKS0+Yml0cyksCiAgICAgICAg
KCh1bnNpZ25lZCBpbnQpMjQpKTsKfQoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIGNwdW1hc2tfZW1w
dHkoY29uc3Qgc3RydWN0IGNwdW1hc2sgKnNyY3ApCnsKIHJldHVybiBiaXRtYXBfZW1wdHko
KChzcmNwKS0+Yml0cyksICgodW5zaWduZWQgaW50KTI0KSk7Cn0KCgoKCgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
Ym9vbCBjcHVtYXNrX2Z1bGwoY29uc3Qgc3RydWN0IGNwdW1hc2sgKnNyY3ApCnsKIHJldHVy
biBiaXRtYXBfZnVsbCgoKHNyY3ApLT5iaXRzKSwgKCh1bnNpZ25lZCBpbnQpMjQpKTsKfQoK
CgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSB1bnNpZ25lZCBpbnQgY3B1bWFza193ZWlnaHQoY29uc3Qgc3RydWN0
IGNwdW1hc2sgKnNyY3ApCnsKIHJldHVybiBiaXRtYXBfd2VpZ2h0KCgoc3JjcCktPmJpdHMp
LCAoKHVuc2lnbmVkIGludCkyNCkpOwp9CgoKCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBjcHVtYXNr
X3NoaWZ0X3JpZ2h0KHN0cnVjdCBjcHVtYXNrICpkc3RwLAogICAgICAgICAgIGNvbnN0IHN0
cnVjdCBjcHVtYXNrICpzcmNwLCBpbnQgbikKewogYml0bWFwX3NoaWZ0X3JpZ2h0KCgoZHN0
cCktPmJpdHMpLCAoKHNyY3ApLT5iaXRzKSwgbiwKICAgICAgICAgICAgKCh1bnNpZ25lZCBp
bnQpMjQpKTsKfQoKCgoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgY3B1bWFza19zaGlmdF9sZWZ0KHN0
cnVjdCBjcHVtYXNrICpkc3RwLAogICAgICAgICAgY29uc3Qgc3RydWN0IGNwdW1hc2sgKnNy
Y3AsIGludCBuKQp7CiBiaXRtYXBfc2hpZnRfbGVmdCgoKGRzdHApLT5iaXRzKSwgKChzcmNw
KS0+Yml0cyksIG4sCiAgICAgICAgICAgKCh1bnNpZ25lZCBpbnQpMjQpKTsKfQoKCgoKCgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgdm9pZCBjcHVtYXNrX2NvcHkoc3RydWN0IGNwdW1hc2sgKmRzdHAsCiAgICBj
b25zdCBzdHJ1Y3QgY3B1bWFzayAqc3JjcCkKewogYml0bWFwX2NvcHkoKChkc3RwKS0+Yml0
cyksICgoc3JjcCktPmJpdHMpLCAoKHVuc2lnbmVkIGludCkyNCkpOwp9CiMgNjQzICIuL2lu
Y2x1ZGUvbGludXgvY3B1bWFzay5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGNwdW1hc2tfcGFyc2VfdXNl
cihjb25zdCBjaGFyICpidWYsIGludCBsZW4sCiAgICAgICAgIHN0cnVjdCBjcHVtYXNrICpk
c3RwKQp7CiByZXR1cm4gYml0bWFwX3BhcnNlX3VzZXIoYnVmLCBsZW4sICgoZHN0cCktPmJp
dHMpLCAoKHVuc2lnbmVkIGludCkyNCkpOwp9CiMgNjU3ICIuL2luY2x1ZGUvbGludXgvY3B1
bWFzay5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgaW50IGNwdW1hc2tfcGFyc2VsaXN0X3VzZXIoY29uc3QgY2hh
ciAqYnVmLCBpbnQgbGVuLAogICAgICAgICBzdHJ1Y3QgY3B1bWFzayAqZHN0cCkKewogcmV0
dXJuIGJpdG1hcF9wYXJzZWxpc3RfdXNlcihidWYsIGxlbiwgKChkc3RwKS0+Yml0cyksCiAg
ICAgICAgICgodW5zaWduZWQgaW50KTI0KSk7Cn0KIyA2NzEgIi4vaW5jbHVkZS9saW51eC9j
cHVtYXNrLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgY3B1bWFza19wYXJzZShjb25zdCBjaGFyICpidWYs
IHN0cnVjdCBjcHVtYXNrICpkc3RwKQp7CiByZXR1cm4gYml0bWFwX3BhcnNlKGJ1ZiwgKH4w
VSksICgoZHN0cCktPmJpdHMpLCAoKHVuc2lnbmVkIGludCkyNCkpOwp9CiMgNjgzICIuL2lu
Y2x1ZGUvbGludXgvY3B1bWFzay5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGNwdWxpc3RfcGFyc2UoY29u
c3QgY2hhciAqYnVmLCBzdHJ1Y3QgY3B1bWFzayAqZHN0cCkKewogcmV0dXJuIGJpdG1hcF9w
YXJzZWxpc3QoYnVmLCAoKGRzdHApLT5iaXRzKSwgKCh1bnNpZ25lZCBpbnQpMjQpKTsKfQoK
CgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIHVuc2lnbmVkIGludCBjcHVtYXNrX3NpemUodm9pZCkKewogcmV0dXJu
ICgoKCgodW5zaWduZWQgaW50KTI0KSkgKyAoKHNpemVvZihsb25nKSAqIDgpKSAtIDEpIC8g
KChzaXplb2YobG9uZykgKiA4KSkpICogc2l6ZW9mKGxvbmcpOwp9CiMgNzU2ICIuL2luY2x1
ZGUvbGludXgvY3B1bWFzay5oIgp0eXBlZGVmIHN0cnVjdCBjcHVtYXNrIGNwdW1hc2tfdmFy
X3RbMV07CgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBhbGxvY19jcHVtYXNrX3ZhcihjcHVtYXNrX3Zh
cl90ICptYXNrLCBnZnBfdCBmbGFncykKewogcmV0dXJuIHRydWU7Cn0KCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBi
b29sIGFsbG9jX2NwdW1hc2tfdmFyX25vZGUoY3B1bWFza192YXJfdCAqbWFzaywgZ2ZwX3Qg
ZmxhZ3MsCiAgICAgICBpbnQgbm9kZSkKewogcmV0dXJuIHRydWU7Cn0KCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBi
b29sIHphbGxvY19jcHVtYXNrX3ZhcihjcHVtYXNrX3Zhcl90ICptYXNrLCBnZnBfdCBmbGFn
cykKewogY3B1bWFza19jbGVhcigqbWFzayk7CiByZXR1cm4gdHJ1ZTsKfQoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IGJvb2wgemFsbG9jX2NwdW1hc2tfdmFyX25vZGUoY3B1bWFza192YXJfdCAqbWFzaywgZ2Zw
X3QgZmxhZ3MsCiAgICAgICBpbnQgbm9kZSkKewogY3B1bWFza19jbGVhcigqbWFzayk7CiBy
ZXR1cm4gdHJ1ZTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgYWxsb2NfYm9vdG1lbV9jcHVtYXNrX3Zh
cihjcHVtYXNrX3Zhcl90ICptYXNrKQp7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGZyZWVfY3B1bWFz
a192YXIoY3B1bWFza192YXJfdCBtYXNrKQp7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGZyZWVfYm9v
dG1lbV9jcHVtYXNrX3ZhcihjcHVtYXNrX3Zhcl90IG1hc2spCnsKfQoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJv
b2wgY3B1bWFza19hdmFpbGFibGUoY3B1bWFza192YXJfdCBtYXNrKQp7CiByZXR1cm4gdHJ1
ZTsKfQoKCgoKZXh0ZXJuIGNvbnN0IHVuc2lnbmVkIGxvbmcgY3B1X2FsbF9iaXRzWygoKDI0
KSArICgoc2l6ZW9mKGxvbmcpICogOCkpIC0gMSkgLyAoKHNpemVvZihsb25nKSAqIDgpKSld
OwojIDgxNiAiLi9pbmNsdWRlL2xpbnV4L2NwdW1hc2suaCIKdm9pZCBpbml0X2NwdV9wcmVz
ZW50KGNvbnN0IHN0cnVjdCBjcHVtYXNrICpzcmMpOwp2b2lkIGluaXRfY3B1X3Bvc3NpYmxl
KGNvbnN0IHN0cnVjdCBjcHVtYXNrICpzcmMpOwp2b2lkIGluaXRfY3B1X29ubGluZShjb25z
dCBzdHJ1Y3QgY3B1bWFzayAqc3JjKTsKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHJlc2V0X2NwdV9wb3Nz
aWJsZV9tYXNrKHZvaWQpCnsKIGJpdG1hcF96ZXJvKCgoJl9fY3B1X3Bvc3NpYmxlX21hc2sp
LT5iaXRzKSwgMjQpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZApzZXRfY3B1X3Bvc3NpYmxlKHVuc2ln
bmVkIGludCBjcHUsIGJvb2wgcG9zc2libGUpCnsKIGlmIChwb3NzaWJsZSkKICBjcHVtYXNr
X3NldF9jcHUoY3B1LCAmX19jcHVfcG9zc2libGVfbWFzayk7CiBlbHNlCiAgY3B1bWFza19j
bGVhcl9jcHUoY3B1LCAmX19jcHVfcG9zc2libGVfbWFzayk7Cn0KCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lk
CnNldF9jcHVfcHJlc2VudCh1bnNpZ25lZCBpbnQgY3B1LCBib29sIHByZXNlbnQpCnsKIGlm
IChwcmVzZW50KQogIGNwdW1hc2tfc2V0X2NwdShjcHUsICZfX2NwdV9wcmVzZW50X21hc2sp
OwogZWxzZQogIGNwdW1hc2tfY2xlYXJfY3B1KGNwdSwgJl9fY3B1X3ByZXNlbnRfbWFzayk7
Cn0KCnZvaWQgc2V0X2NwdV9vbmxpbmUodW5zaWduZWQgaW50IGNwdSwgYm9vbCBvbmxpbmUp
OwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIHZvaWQKc2V0X2NwdV9hY3RpdmUodW5zaWduZWQgaW50IGNwdSwgYm9v
bCBhY3RpdmUpCnsKIGlmIChhY3RpdmUpCiAgY3B1bWFza19zZXRfY3B1KGNwdSwgJl9fY3B1
X2FjdGl2ZV9tYXNrKTsKIGVsc2UKICBjcHVtYXNrX2NsZWFyX2NwdShjcHUsICZfX2NwdV9h
Y3RpdmVfbWFzayk7Cn0KIyA4NjkgIi4vaW5jbHVkZS9saW51eC9jcHVtYXNrLmgiCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBpbnQgX19jaGVja19pc19iaXRtYXAoY29uc3QgdW5zaWduZWQgbG9uZyAqYml0bWFw
KQp7CiByZXR1cm4gMTsKfQojIDg4MSAiLi9pbmNsdWRlL2xpbnV4L2NwdW1hc2suaCIKZXh0
ZXJuIGNvbnN0IHVuc2lnbmVkIGxvbmcKIGNwdV9iaXRfYml0bWFwWzY0ICsxXVsoKCgyNCkg
KyAoKHNpemVvZihsb25nKSAqIDgpKSAtIDEpIC8gKChzaXplb2YobG9uZykgKiA4KSkpXTsK
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSBjb25zdCBzdHJ1Y3QgY3B1bWFzayAqZ2V0X2NwdV9tYXNrKHVuc2lnbmVk
IGludCBjcHUpCnsKIGNvbnN0IHVuc2lnbmVkIGxvbmcgKnAgPSBjcHVfYml0X2JpdG1hcFsx
ICsgY3B1ICUgNjRdOwogcCAtPSBjcHUgLyA2NDsKIHJldHVybiAoKHN0cnVjdCBjcHVtYXNr
ICopKDEgPyAocCkgOiAodm9pZCAqKXNpemVvZihfX2NoZWNrX2lzX2JpdG1hcChwKSkpKTsK
fQojIDkxOCAiLi9pbmNsdWRlL2xpbnV4L2NwdW1hc2suaCIKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHNzaXplX3QK
Y3B1bWFwX3ByaW50X3RvX3BhZ2VidWYoYm9vbCBsaXN0LCBjaGFyICpidWYsIGNvbnN0IHN0
cnVjdCBjcHVtYXNrICptYXNrKQp7CiByZXR1cm4gYml0bWFwX3ByaW50X3RvX3BhZ2VidWYo
bGlzdCwgYnVmLCAoKG1hc2spLT5iaXRzKSwKICAgICAgICAgIG5yX2NwdV9pZHMpOwp9CiMg
MzIgIi4vaW5jbHVkZS9saW51eC9yY3VwZGF0ZS5oIiAyCgoKCgoKCnZvaWQgY2FsbF9yY3Uo
c3RydWN0IGNhbGxiYWNrX2hlYWQgKmhlYWQsIHJjdV9jYWxsYmFja190IGZ1bmMpOwp2b2lk
IHJjdV9iYXJyaWVyX3Rhc2tzKHZvaWQpOwp2b2lkIHJjdV9iYXJyaWVyX3Rhc2tzX3J1ZGUo
dm9pZCk7CnZvaWQgc3luY2hyb25pemVfcmN1KHZvaWQpOwojIDU4ICIuL2luY2x1ZGUvbGlu
dXgvcmN1cGRhdGUuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgX19yY3VfcmVhZF9sb2NrKHZvaWQpCnsK
IF9fYXNtX18gX192b2xhdGlsZV9fKCIiOiA6IDoibWVtb3J5Iik7Cn0KCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2
b2lkIF9fcmN1X3JlYWRfdW5sb2NrKHZvaWQpCnsKIF9fYXNtX18gX192b2xhdGlsZV9fKCIi
OiA6IDoibWVtb3J5Iik7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgcmN1X3ByZWVtcHRfZGVwdGgodm9p
ZCkKewogcmV0dXJuIDA7Cn0KCgoKCnZvaWQgcmN1X2luaXQodm9pZCk7CmV4dGVybiBpbnQg
cmN1X3NjaGVkdWxlcl9hY3RpdmUgX19hdHRyaWJ1dGVfXygoX19zZWN0aW9uX18oIi5kYXRh
Li5yZWFkX21vc3RseSIpKSk7CnZvaWQgcmN1X3NjaGVkX2Nsb2NrX2lycShpbnQgdXNlcik7
CnZvaWQgcmN1X3JlcG9ydF9kZWFkKHVuc2lnbmVkIGludCBjcHUpOwp2b2lkIHJjdXRyZWVf
bWlncmF0ZV9jYWxsYmFja3MoaW50IGNwdSk7CgoKdm9pZCByY3Vfc3lzcnFfc3RhcnQodm9p
ZCk7CnZvaWQgcmN1X3N5c3JxX2VuZCh2b2lkKTsKIyA5NCAiLi9pbmNsdWRlL2xpbnV4L3Jj
dXBkYXRlLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHJjdV91c2VyX2VudGVyKHZvaWQpIHsgfQpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgdm9pZCByY3VfdXNlcl9leGl0KHZvaWQpIHsgfQoKCgoKCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lk
IHJjdV9pbml0X25vaHoodm9pZCkgeyB9CiMgMTgxICIuL2luY2x1ZGUvbGludXgvcmN1cGRh
dGUuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIHZvaWQgZXhpdF90YXNrc19yY3Vfc3RhcnQodm9pZCkgeyB9CnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSB2b2lkIGV4aXRfdGFza3NfcmN1X2ZpbmlzaCh2b2lkKSB7IH0KIyAyMDQgIi4v
aW5jbHVkZS9saW51eC9yY3VwZGF0ZS5oIgojIDEgIi4vaW5jbHVkZS9saW51eC9yY3V0cmVl
LmgiIDEKIyAyMCAiLi9pbmNsdWRlL2xpbnV4L3JjdXRyZWUuaCIKdm9pZCByY3Vfc29mdGly
cV9xcyh2b2lkKTsKdm9pZCByY3Vfbm90ZV9jb250ZXh0X3N3aXRjaChib29sIHByZWVtcHQp
OwppbnQgcmN1X25lZWRzX2NwdSh1NjQgYmFzZW0sIHU2NCAqbmV4dGV2dCk7CnZvaWQgcmN1
X2NwdV9zdGFsbF9yZXNldCh2b2lkKTsKCgoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgcmN1X3ZpcnRf
bm90ZV9jb250ZXh0X3N3aXRjaChpbnQgY3B1KQp7CiByY3Vfbm90ZV9jb250ZXh0X3N3aXRj
aChmYWxzZSk7Cn0KCnZvaWQgc3luY2hyb25pemVfcmN1X2V4cGVkaXRlZCh2b2lkKTsKdm9p
ZCBrZnJlZV9jYWxsX3JjdShzdHJ1Y3QgY2FsbGJhY2tfaGVhZCAqaGVhZCwgcmN1X2NhbGxi
YWNrX3QgZnVuYyk7Cgp2b2lkIHJjdV9iYXJyaWVyKHZvaWQpOwpib29sIHJjdV9lcXNfc3Bl
Y2lhbF9zZXQoaW50IGNwdSk7CnZvaWQgcmN1X21vbWVudGFyeV9keW50aWNrX2lkbGUodm9p
ZCk7CnZvaWQga2ZyZWVfcmN1X3NjaGVkdWxlcl9ydW5uaW5nKHZvaWQpOwpib29sIHJjdV9n
cF9taWdodF9iZV9zdGFsbGVkKHZvaWQpOwp1bnNpZ25lZCBsb25nIGdldF9zdGF0ZV9zeW5j
aHJvbml6ZV9yY3Uodm9pZCk7CnZvaWQgY29uZF9zeW5jaHJvbml6ZV9yY3UodW5zaWduZWQg
bG9uZyBvbGRzdGF0ZSk7Cgp2b2lkIHJjdV9pZGxlX2VudGVyKHZvaWQpOwp2b2lkIHJjdV9p
ZGxlX2V4aXQodm9pZCk7CnZvaWQgcmN1X2lycV9lbnRlcih2b2lkKTsKdm9pZCByY3VfaXJx
X2V4aXQodm9pZCk7CnZvaWQgcmN1X2lycV9leGl0X3ByZWVtcHQodm9pZCk7CnZvaWQgcmN1
X2lycV9lbnRlcl9pcnFzb24odm9pZCk7CnZvaWQgcmN1X2lycV9leGl0X2lycXNvbih2b2lk
KTsKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSB2b2lkIHJjdV9pcnFfZXhpdF9jaGVja19wcmVlbXB0KHZvaWQp
IHsgfQoKCnZvaWQgZXhpdF9yY3Uodm9pZCk7Cgp2b2lkIHJjdV9zY2hlZHVsZXJfc3RhcnRp
bmcodm9pZCk7CmV4dGVybiBpbnQgcmN1X3NjaGVkdWxlcl9hY3RpdmUgX19hdHRyaWJ1dGVf
XygoX19zZWN0aW9uX18oIi5kYXRhLi5yZWFkX21vc3RseSIpKSk7CnZvaWQgcmN1X2VuZF9p
bmtlcm5lbF9ib290KHZvaWQpOwpib29sIHJjdV9pbmtlcm5lbF9ib290X2hhc19lbmRlZCh2
b2lkKTsKYm9vbCByY3VfaXNfd2F0Y2hpbmcodm9pZCk7CmJvb2wgX19yY3VfaXNfd2F0Y2hp
bmcodm9pZCk7Cgp2b2lkIHJjdV9hbGxfcXModm9pZCk7CgoKCmludCByY3V0cmVlX3ByZXBh
cmVfY3B1KHVuc2lnbmVkIGludCBjcHUpOwppbnQgcmN1dHJlZV9vbmxpbmVfY3B1KHVuc2ln
bmVkIGludCBjcHUpOwppbnQgcmN1dHJlZV9vZmZsaW5lX2NwdSh1bnNpZ25lZCBpbnQgY3B1
KTsKaW50IHJjdXRyZWVfZGVhZF9jcHUodW5zaWduZWQgaW50IGNwdSk7CmludCByY3V0cmVl
X2R5aW5nX2NwdSh1bnNpZ25lZCBpbnQgY3B1KTsKdm9pZCByY3VfY3B1X3N0YXJ0aW5nKHVu
c2lnbmVkIGludCBjcHUpOwojIDIwNSAiLi9pbmNsdWRlL2xpbnV4L3JjdXBkYXRlLmgiIDIK
IyAyMjUgIi4vaW5jbHVkZS9saW51eC9yY3VwZGF0ZS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBpbml0
X3JjdV9oZWFkKHN0cnVjdCBjYWxsYmFja19oZWFkICpoZWFkKSB7IH0Kc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZv
aWQgZGVzdHJveV9yY3VfaGVhZChzdHJ1Y3QgY2FsbGJhY2tfaGVhZCAqaGVhZCkgeyB9CnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSB2b2lkIGluaXRfcmN1X2hlYWRfb25fc3RhY2soc3RydWN0IGNhbGxiYWNrX2hl
YWQgKmhlYWQpIHsgfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBkZXN0cm95X3JjdV9oZWFkX29uX3N0YWNr
KHN0cnVjdCBjYWxsYmFja19oZWFkICpoZWFkKSB7IH0KCgoKCgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBy
Y3VfbG9ja2RlcF9jdXJyZW50X2NwdV9vbmxpbmUodm9pZCkgeyByZXR1cm4gdHJ1ZTsgfQoj
IDI2NCAiLi9pbmNsdWRlL2xpbnV4L3JjdXBkYXRlLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgcmN1X3Jl
YWRfbG9ja19oZWxkKHZvaWQpCnsKIHJldHVybiAxOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHJjdV9y
ZWFkX2xvY2tfYmhfaGVsZCh2b2lkKQp7CiByZXR1cm4gMTsKfQoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBy
Y3VfcmVhZF9sb2NrX3NjaGVkX2hlbGQodm9pZCkKewogcmV0dXJuICEwOwp9CgpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgaW50IHJjdV9yZWFkX2xvY2tfYW55X2hlbGQodm9pZCkKewogcmV0dXJuICEwOwp9CiMg
NjMwICIuL2luY2x1ZGUvbGludXgvcmN1cGRhdGUuaCIKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRl
X18oKF9fYWx3YXlzX2lubGluZV9fKSkgdm9pZCByY3VfcmVhZF9sb2NrKHZvaWQpCnsKIF9f
cmN1X3JlYWRfbG9jaygpOwogKHZvaWQpMDsKIGRvIHsgfSB3aGlsZSAoMCk7CiBkbyB7IH0g
d2hpbGUgKDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIDsKfQojIDY4MiAiLi9pbmNsdWRlL2xpbnV4L3JjdXBkYXRlLmgiCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2
b2lkIHJjdV9yZWFkX3VubG9jayh2b2lkKQp7CiBkbyB7IH0gd2hpbGUgKDApCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOwogKHZvaWQpMDsK
IF9fcmN1X3JlYWRfdW5sb2NrKCk7CiBkbyB7IH0gd2hpbGUgKDApOwp9CiMgNzAzICIuL2lu
Y2x1ZGUvbGludXgvcmN1cGRhdGUuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgcmN1X3JlYWRfbG9ja19i
aCh2b2lkKQp7CiBsb2NhbF9iaF9kaXNhYmxlKCk7CiAodm9pZCkwOwogZG8geyB9IHdoaWxl
ICgwKTsKIGRvIHsgfSB3aGlsZSAoMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgOwp9CgoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHJjdV9yZWFk
X3VubG9ja19iaCh2b2lkKQp7CiBkbyB7IH0gd2hpbGUgKDApCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOwogZG8geyB9IHdoaWxlICgw
KTsKICh2b2lkKTA7CiBsb2NhbF9iaF9lbmFibGUoKTsKfQojIDczOCAiLi9pbmNsdWRlL2xp
bnV4L3JjdXBkYXRlLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHJjdV9yZWFkX2xvY2tfc2NoZWQodm9p
ZCkKewogX19hc21fXyBfX3ZvbGF0aWxlX18oIiI6IDogOiJtZW1vcnkiKTsKICh2b2lkKTA7
CiBkbyB7IH0gd2hpbGUgKDApOwogZG8geyB9IHdoaWxlICgwKQogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA7Cn0KCgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHJjdV9y
ZWFkX2xvY2tfc2NoZWRfbm90cmFjZSh2b2lkKQp7CiBfX2FzbV9fIF9fdm9sYXRpbGVfXygi
IjogOiA6Im1lbW9yeSIpOwogKHZvaWQpMDsKfQoKCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCByY3Vf
cmVhZF91bmxvY2tfc2NoZWQodm9pZCkKewogZG8geyB9IHdoaWxlICgwKQogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDsKIGRvIHsg
fSB3aGlsZSAoMCk7CiAodm9pZCkwOwogX19hc21fXyBfX3ZvbGF0aWxlX18oIiI6IDogOiJt
ZW1vcnkiKTsKfQoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIHZvaWQgcmN1X3JlYWRfdW5sb2NrX3NjaGVkX25vdHJhY2Uodm9pZCkK
ewogKHZvaWQpMDsKIF9fYXNtX18gX192b2xhdGlsZV9fKCIiOiA6IDoibWVtb3J5Iik7Cn0K
IyA5MDMgIi4vaW5jbHVkZS9saW51eC9yY3VwZGF0ZS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCByY3Vf
aGVhZF9pbml0KHN0cnVjdCBjYWxsYmFja19oZWFkICpyaHApCnsKIHJocC0+ZnVuYyA9IChy
Y3VfY2FsbGJhY2tfdCl+MEw7Cn0KIyA5MjEgIi4vaW5jbHVkZS9saW51eC9yY3VwZGF0ZS5o
IgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkKCiMgOTIxICIuL2luY2x1ZGUvbGludXgvcmN1cGRhdGUuaCIKICAgICAg
ICAgICAgICBib29sCnJjdV9oZWFkX2FmdGVyX2NhbGxfcmN1KHN0cnVjdCBjYWxsYmFja19o
ZWFkICpyaHAsIHJjdV9jYWxsYmFja190IGYpCnsKIHJjdV9jYWxsYmFja190IGZ1bmMgPSAo
eyBkbyB7IGV4dGVybiB2b2lkIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzM1KHZvaWQpIF9fYXR0
cmlidXRlX18oKF9fZXJyb3JfXygiVW5zdXBwb3J0ZWQgYWNjZXNzIHNpemUgZm9yIHtSRUFE
LFdSSVRFfV9PTkNFKCkuIikpKTsgaWYgKCEoKHNpemVvZihyaHAtPmZ1bmMpID09IHNpemVv
ZihjaGFyKSB8fCBzaXplb2YocmhwLT5mdW5jKSA9PSBzaXplb2Yoc2hvcnQpIHx8IHNpemVv
ZihyaHAtPmZ1bmMpID09IHNpemVvZihpbnQpIHx8IHNpemVvZihyaHAtPmZ1bmMpID09IHNp
emVvZihsb25nKSkgfHwgc2l6ZW9mKHJocC0+ZnVuYykgPT0gc2l6ZW9mKGxvbmcgbG9uZykp
KSBfX2NvbXBpbGV0aW1lX2Fzc2VydF8zNSgpOyB9IHdoaWxlICgwKTsgKHsgdHlwZW9mKCBf
R2VuZXJpYygocmhwLT5mdW5jKSwgY2hhcjogKGNoYXIpMCwgdW5zaWduZWQgY2hhcjogKHVu
c2lnbmVkIGNoYXIpMCwgc2lnbmVkIGNoYXI6IChzaWduZWQgY2hhcikwLCB1bnNpZ25lZCBz
aG9ydDogKHVuc2lnbmVkIHNob3J0KTAsIHNpZ25lZCBzaG9ydDogKHNpZ25lZCBzaG9ydCkw
LCB1bnNpZ25lZCBpbnQ6ICh1bnNpZ25lZCBpbnQpMCwgc2lnbmVkIGludDogKHNpZ25lZCBp
bnQpMCwgdW5zaWduZWQgbG9uZzogKHVuc2lnbmVkIGxvbmcpMCwgc2lnbmVkIGxvbmc6IChz
aWduZWQgbG9uZykwLCB1bnNpZ25lZCBsb25nIGxvbmc6ICh1bnNpZ25lZCBsb25nIGxvbmcp
MCwgc2lnbmVkIGxvbmcgbG9uZzogKHNpZ25lZCBsb25nIGxvbmcpMCwgZGVmYXVsdDogKHJo
cC0+ZnVuYykpKSBfX3ggPSAoKihjb25zdCB2b2xhdGlsZSB0eXBlb2YoIF9HZW5lcmljKChy
aHAtPmZ1bmMpLCBjaGFyOiAoY2hhcikwLCB1bnNpZ25lZCBjaGFyOiAodW5zaWduZWQgY2hh
cikwLCBzaWduZWQgY2hhcjogKHNpZ25lZCBjaGFyKTAsIHVuc2lnbmVkIHNob3J0OiAodW5z
aWduZWQgc2hvcnQpMCwgc2lnbmVkIHNob3J0OiAoc2lnbmVkIHNob3J0KTAsIHVuc2lnbmVk
IGludDogKHVuc2lnbmVkIGludCkwLCBzaWduZWQgaW50OiAoc2lnbmVkIGludCkwLCB1bnNp
Z25lZCBsb25nOiAodW5zaWduZWQgbG9uZykwLCBzaWduZWQgbG9uZzogKHNpZ25lZCBsb25n
KTAsIHVuc2lnbmVkIGxvbmcgbG9uZzogKHVuc2lnbmVkIGxvbmcgbG9uZykwLCBzaWduZWQg
bG9uZyBsb25nOiAoc2lnbmVkIGxvbmcgbG9uZykwLCBkZWZhdWx0OiAocmhwLT5mdW5jKSkp
ICopJihyaHAtPmZ1bmMpKTsgZG8geyB9IHdoaWxlICgwKTsgKHR5cGVvZihyaHAtPmZ1bmMp
KV9feDsgfSk7IH0pOwoKIGlmIChmdW5jID09IGYpCiAgcmV0dXJuIHRydWU7CiAoeyBpbnQg
X19yZXRfd2Fybl9vbiA9ICEhKGZ1bmMgIT0gKHJjdV9jYWxsYmFja190KX4wTCk7IGlmIChf
X2J1aWx0aW5fZXhwZWN0KCEhKF9fcmV0X3dhcm5fb24pLCAwKSkgX19hc21fXyBfX3ZvbGF0
aWxlX18oICIxOgkiICJ0d2kgMzEsIDAsIDAiICJcbiIgIi5zZWN0aW9uIF9fYnVnX3RhYmxl
LFwiYXdcIlxuIiAiMjpcdCIgIi44Ynl0ZSIgIiAiICIxYiwgJTBcbiIgIlx0LnNob3J0ICUx
LCAlMlxuIiAiLm9yZyAyYislM1xuIiAiLnByZXZpb3VzXG4iIDogOiAiaSIgKCIuL2luY2x1
ZGUvbGludXgvcmN1cGRhdGUuaCIpLCAiaSIgKDkyOCksICJpIiAoKDEgPDwgMCkgfCAoKDEg
PDwgMSkgfCAoKDkpIDw8IDgpKSksICJpIiAoc2l6ZW9mKHN0cnVjdCBidWdfZW50cnkpKSk7
IF9fYnVpbHRpbl9leHBlY3QoISEoX19yZXRfd2Fybl9vbiksIDApOyB9KTsKIHJldHVybiBm
YWxzZTsKfQoKCmV4dGVybiBpbnQgcmN1X2V4cGVkaXRlZDsKZXh0ZXJuIGludCByY3Vfbm9y
bWFsOwojIDEyICIuL2luY2x1ZGUvbGludXgvcmN1bGlzdC5oIiAyCiMgMzEgIi4vaW5jbHVk
ZS9saW51eC9yY3VsaXN0LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIElOSVRfTElTVF9IRUFEX1JDVShz
dHJ1Y3QgbGlzdF9oZWFkICpsaXN0KQp7CiBkbyB7IGRvIHsgZXh0ZXJuIHZvaWQgX19jb21w
aWxldGltZV9hc3NlcnRfMzYodm9pZCkgX19hdHRyaWJ1dGVfXygoX19lcnJvcl9fKCJVbnN1
cHBvcnRlZCBhY2Nlc3Mgc2l6ZSBmb3Ige1JFQUQsV1JJVEV9X09OQ0UoKS4iKSkpOyBpZiAo
ISgoc2l6ZW9mKGxpc3QtPm5leHQpID09IHNpemVvZihjaGFyKSB8fCBzaXplb2YobGlzdC0+
bmV4dCkgPT0gc2l6ZW9mKHNob3J0KSB8fCBzaXplb2YobGlzdC0+bmV4dCkgPT0gc2l6ZW9m
KGludCkgfHwgc2l6ZW9mKGxpc3QtPm5leHQpID09IHNpemVvZihsb25nKSkgfHwgc2l6ZW9m
KGxpc3QtPm5leHQpID09IHNpemVvZihsb25nIGxvbmcpKSkgX19jb21waWxldGltZV9hc3Nl
cnRfMzYoKTsgfSB3aGlsZSAoMCk7IGRvIHsgKih2b2xhdGlsZSB0eXBlb2YobGlzdC0+bmV4
dCkgKikmKGxpc3QtPm5leHQpID0gKGxpc3QpOyB9IHdoaWxlICgwKTsgfSB3aGlsZSAoMCk7
CiBkbyB7IGRvIHsgZXh0ZXJuIHZvaWQgX19jb21waWxldGltZV9hc3NlcnRfMzcodm9pZCkg
X19hdHRyaWJ1dGVfXygoX19lcnJvcl9fKCJVbnN1cHBvcnRlZCBhY2Nlc3Mgc2l6ZSBmb3Ig
e1JFQUQsV1JJVEV9X09OQ0UoKS4iKSkpOyBpZiAoISgoc2l6ZW9mKGxpc3QtPnByZXYpID09
IHNpemVvZihjaGFyKSB8fCBzaXplb2YobGlzdC0+cHJldikgPT0gc2l6ZW9mKHNob3J0KSB8
fCBzaXplb2YobGlzdC0+cHJldikgPT0gc2l6ZW9mKGludCkgfHwgc2l6ZW9mKGxpc3QtPnBy
ZXYpID09IHNpemVvZihsb25nKSkgfHwgc2l6ZW9mKGxpc3QtPnByZXYpID09IHNpemVvZihs
b25nIGxvbmcpKSkgX19jb21waWxldGltZV9hc3NlcnRfMzcoKTsgfSB3aGlsZSAoMCk7IGRv
IHsgKih2b2xhdGlsZSB0eXBlb2YobGlzdC0+cHJldikgKikmKGxpc3QtPnByZXYpID0gKGxp
c3QpOyB9IHdoaWxlICgwKTsgfSB3aGlsZSAoMCk7Cn0KIyA3NyAiLi9pbmNsdWRlL2xpbnV4
L3JjdWxpc3QuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgX19saXN0X2FkZF9yY3Uoc3RydWN0IGxpc3Rf
aGVhZCAqbmV3LAogIHN0cnVjdCBsaXN0X2hlYWQgKnByZXYsIHN0cnVjdCBsaXN0X2hlYWQg
Km5leHQpCnsKIGlmICghX19saXN0X2FkZF92YWxpZChuZXcsIHByZXYsIG5leHQpKQogIHJl
dHVybjsKCiBuZXctPm5leHQgPSBuZXh0OwogbmV3LT5wcmV2ID0gcHJldjsKIGRvIHsgdWlu
dHB0cl90IF9yX2FfcF9fdiA9ICh1aW50cHRyX3QpKG5ldyk7IDsgaWYgKF9fYnVpbHRpbl9j
b25zdGFudF9wKG5ldykgJiYgKF9yX2FfcF9fdikgPT0gKHVpbnRwdHJfdCkoKHZvaWQgKikw
KSkgZG8geyBkbyB7IGV4dGVybiB2b2lkIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzM4KHZvaWQp
IF9fYXR0cmlidXRlX18oKF9fZXJyb3JfXygiVW5zdXBwb3J0ZWQgYWNjZXNzIHNpemUgZm9y
IHtSRUFELFdSSVRFfV9PTkNFKCkuIikpKTsgaWYgKCEoKHNpemVvZigoKCooKHN0cnVjdCBs
aXN0X2hlYWQgKiopKCYocHJldiktPm5leHQpKSkpKSA9PSBzaXplb2YoY2hhcikgfHwgc2l6
ZW9mKCgoKigoc3RydWN0IGxpc3RfaGVhZCAqKikoJihwcmV2KS0+bmV4dCkpKSkpID09IHNp
emVvZihzaG9ydCkgfHwgc2l6ZW9mKCgoKigoc3RydWN0IGxpc3RfaGVhZCAqKikoJihwcmV2
KS0+bmV4dCkpKSkpID09IHNpemVvZihpbnQpIHx8IHNpemVvZigoKCooKHN0cnVjdCBsaXN0
X2hlYWQgKiopKCYocHJldiktPm5leHQpKSkpKSA9PSBzaXplb2YobG9uZykpIHx8IHNpemVv
ZigoKCooKHN0cnVjdCBsaXN0X2hlYWQgKiopKCYocHJldiktPm5leHQpKSkpKSA9PSBzaXpl
b2YobG9uZyBsb25nKSkpIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzM4KCk7IH0gd2hpbGUgKDAp
OyBkbyB7ICoodm9sYXRpbGUgdHlwZW9mKCgoKigoc3RydWN0IGxpc3RfaGVhZCAqKikoJihw
cmV2KS0+bmV4dCkpKSkpICopJigoKCooKHN0cnVjdCBsaXN0X2hlYWQgKiopKCYocHJldikt
Pm5leHQpKSkpKSA9ICgodHlwZW9mKCgqKChzdHJ1Y3QgbGlzdF9oZWFkICoqKSgmKHByZXYp
LT5uZXh0KSkpKSkoX3JfYV9wX192KSk7IH0gd2hpbGUgKDApOyB9IHdoaWxlICgwKTsgZWxz
ZSBkbyB7IGRvIHsgZXh0ZXJuIHZvaWQgX19jb21waWxldGltZV9hc3NlcnRfMzkodm9pZCkg
X19hdHRyaWJ1dGVfXygoX19lcnJvcl9fKCJOZWVkIG5hdGl2ZSB3b3JkIHNpemVkIHN0b3Jl
cy9sb2FkcyBmb3IgYXRvbWljaXR5LiIpKSk7IGlmICghKChzaXplb2YoKiYoKigoc3RydWN0
IGxpc3RfaGVhZCAqKikoJihwcmV2KS0+bmV4dCkpKSkgPT0gc2l6ZW9mKGNoYXIpIHx8IHNp
emVvZigqJigqKChzdHJ1Y3QgbGlzdF9oZWFkICoqKSgmKHByZXYpLT5uZXh0KSkpKSA9PSBz
aXplb2Yoc2hvcnQpIHx8IHNpemVvZigqJigqKChzdHJ1Y3QgbGlzdF9oZWFkICoqKSgmKHBy
ZXYpLT5uZXh0KSkpKSA9PSBzaXplb2YoaW50KSB8fCBzaXplb2YoKiYoKigoc3RydWN0IGxp
c3RfaGVhZCAqKikoJihwcmV2KS0+bmV4dCkpKSkgPT0gc2l6ZW9mKGxvbmcpKSkpIF9fY29t
cGlsZXRpbWVfYXNzZXJ0XzM5KCk7IH0gd2hpbGUgKDApOyBfX2FzbV9fIF9fdm9sYXRpbGVf
XyAoImx3c3luYyIgIiAiIDogOiA6Im1lbW9yeSIpOyBkbyB7IGRvIHsgZXh0ZXJuIHZvaWQg
X19jb21waWxldGltZV9hc3NlcnRfNDAodm9pZCkgX19hdHRyaWJ1dGVfXygoX19lcnJvcl9f
KCJVbnN1cHBvcnRlZCBhY2Nlc3Mgc2l6ZSBmb3Ige1JFQUQsV1JJVEV9X09OQ0UoKS4iKSkp
OyBpZiAoISgoc2l6ZW9mKComKCooKHN0cnVjdCBsaXN0X2hlYWQgKiopKCYocHJldiktPm5l
eHQpKSkpID09IHNpemVvZihjaGFyKSB8fCBzaXplb2YoKiYoKigoc3RydWN0IGxpc3RfaGVh
ZCAqKikoJihwcmV2KS0+bmV4dCkpKSkgPT0gc2l6ZW9mKHNob3J0KSB8fCBzaXplb2YoKiYo
Kigoc3RydWN0IGxpc3RfaGVhZCAqKikoJihwcmV2KS0+bmV4dCkpKSkgPT0gc2l6ZW9mKGlu
dCkgfHwgc2l6ZW9mKComKCooKHN0cnVjdCBsaXN0X2hlYWQgKiopKCYocHJldiktPm5leHQp
KSkpID09IHNpemVvZihsb25nKSkgfHwgc2l6ZW9mKComKCooKHN0cnVjdCBsaXN0X2hlYWQg
KiopKCYocHJldiktPm5leHQpKSkpID09IHNpemVvZihsb25nIGxvbmcpKSkgX19jb21waWxl
dGltZV9hc3NlcnRfNDAoKTsgfSB3aGlsZSAoMCk7IGRvIHsgKih2b2xhdGlsZSB0eXBlb2Yo
KiYoKigoc3RydWN0IGxpc3RfaGVhZCAqKikoJihwcmV2KS0+bmV4dCkpKSkgKikmKComKCoo
KHN0cnVjdCBsaXN0X2hlYWQgKiopKCYocHJldiktPm5leHQpKSkpID0gKCh0eXBlb2YoKigo
dHlwZW9mKCgqKChzdHJ1Y3QgbGlzdF9oZWFkICoqKSgmKHByZXYpLT5uZXh0KSkpKSlfcl9h
X3BfX3YpKSAqKSgodHlwZW9mKCgqKChzdHJ1Y3QgbGlzdF9oZWFkICoqKSgmKHByZXYpLT5u
ZXh0KSkpKSlfcl9hX3BfX3YpKTsgfSB3aGlsZSAoMCk7IH0gd2hpbGUgKDApOyB9IHdoaWxl
ICgwKTsgfSB3aGlsZSAoMCk7CiBuZXh0LT5wcmV2ID0gbmV3Owp9CiMgMTA1ICIuL2luY2x1
ZGUvbGludXgvcmN1bGlzdC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBsaXN0X2FkZF9yY3Uoc3RydWN0
IGxpc3RfaGVhZCAqbmV3LCBzdHJ1Y3QgbGlzdF9oZWFkICpoZWFkKQp7CiBfX2xpc3RfYWRk
X3JjdShuZXcsIGhlYWQsIGhlYWQtPm5leHQpOwp9CiMgMTI2ICIuL2luY2x1ZGUvbGludXgv
cmN1bGlzdC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBsaXN0X2FkZF90YWlsX3JjdShzdHJ1Y3QgbGlz
dF9oZWFkICpuZXcsCiAgICAgc3RydWN0IGxpc3RfaGVhZCAqaGVhZCkKewogX19saXN0X2Fk
ZF9yY3UobmV3LCBoZWFkLT5wcmV2LCBoZWFkKTsKfQojIDE1NiAiLi9pbmNsdWRlL2xpbnV4
L3JjdWxpc3QuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgbGlzdF9kZWxfcmN1KHN0cnVjdCBsaXN0X2hl
YWQgKmVudHJ5KQp7CiBfX2xpc3RfZGVsX2VudHJ5KGVudHJ5KTsKIGVudHJ5LT5wcmV2ID0g
KCh2b2lkICopIDB4MTIyICsgKDB4NWRlYWRiZWVmMDAwMDAwMFVMKSk7Cn0KIyAxODIgIi4v
aW5jbHVkZS9saW51eC9yY3VsaXN0LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGhsaXN0X2RlbF9pbml0
X3JjdShzdHJ1Y3QgaGxpc3Rfbm9kZSAqbikKewogaWYgKCFobGlzdF91bmhhc2hlZChuKSkg
ewogIF9faGxpc3RfZGVsKG4pOwogIGRvIHsgZG8geyBleHRlcm4gdm9pZCBfX2NvbXBpbGV0
aW1lX2Fzc2VydF80MSh2b2lkKSBfX2F0dHJpYnV0ZV9fKChfX2Vycm9yX18oIlVuc3VwcG9y
dGVkIGFjY2VzcyBzaXplIGZvciB7UkVBRCxXUklURX1fT05DRSgpLiIpKSk7IGlmICghKChz
aXplb2Yobi0+cHByZXYpID09IHNpemVvZihjaGFyKSB8fCBzaXplb2Yobi0+cHByZXYpID09
IHNpemVvZihzaG9ydCkgfHwgc2l6ZW9mKG4tPnBwcmV2KSA9PSBzaXplb2YoaW50KSB8fCBz
aXplb2Yobi0+cHByZXYpID09IHNpemVvZihsb25nKSkgfHwgc2l6ZW9mKG4tPnBwcmV2KSA9
PSBzaXplb2YobG9uZyBsb25nKSkpIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzQxKCk7IH0gd2hp
bGUgKDApOyBkbyB7ICoodm9sYXRpbGUgdHlwZW9mKG4tPnBwcmV2KSAqKSYobi0+cHByZXYp
ID0gKCgodm9pZCAqKTApKTsgfSB3aGlsZSAoMCk7IH0gd2hpbGUgKDApOwogfQp9CiMgMTk4
ICIuL2luY2x1ZGUvbGludXgvcmN1bGlzdC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBsaXN0X3JlcGxh
Y2VfcmN1KHN0cnVjdCBsaXN0X2hlYWQgKm9sZCwKICAgIHN0cnVjdCBsaXN0X2hlYWQgKm5l
dykKewogbmV3LT5uZXh0ID0gb2xkLT5uZXh0OwogbmV3LT5wcmV2ID0gb2xkLT5wcmV2Owog
ZG8geyB1aW50cHRyX3QgX3JfYV9wX192ID0gKHVpbnRwdHJfdCkobmV3KTsgOyBpZiAoX19i
dWlsdGluX2NvbnN0YW50X3AobmV3KSAmJiAoX3JfYV9wX192KSA9PSAodWludHB0cl90KSgo
dm9pZCAqKTApKSBkbyB7IGRvIHsgZXh0ZXJuIHZvaWQgX19jb21waWxldGltZV9hc3NlcnRf
NDIodm9pZCkgX19hdHRyaWJ1dGVfXygoX19lcnJvcl9fKCJVbnN1cHBvcnRlZCBhY2Nlc3Mg
c2l6ZSBmb3Ige1JFQUQsV1JJVEV9X09OQ0UoKS4iKSkpOyBpZiAoISgoc2l6ZW9mKCgoKigo
c3RydWN0IGxpc3RfaGVhZCAqKikoJihuZXctPnByZXYpLT5uZXh0KSkpKSkgPT0gc2l6ZW9m
KGNoYXIpIHx8IHNpemVvZigoKCooKHN0cnVjdCBsaXN0X2hlYWQgKiopKCYobmV3LT5wcmV2
KS0+bmV4dCkpKSkpID09IHNpemVvZihzaG9ydCkgfHwgc2l6ZW9mKCgoKigoc3RydWN0IGxp
c3RfaGVhZCAqKikoJihuZXctPnByZXYpLT5uZXh0KSkpKSkgPT0gc2l6ZW9mKGludCkgfHwg
c2l6ZW9mKCgoKigoc3RydWN0IGxpc3RfaGVhZCAqKikoJihuZXctPnByZXYpLT5uZXh0KSkp
KSkgPT0gc2l6ZW9mKGxvbmcpKSB8fCBzaXplb2YoKCgqKChzdHJ1Y3QgbGlzdF9oZWFkICoq
KSgmKG5ldy0+cHJldiktPm5leHQpKSkpKSA9PSBzaXplb2YobG9uZyBsb25nKSkpIF9fY29t
cGlsZXRpbWVfYXNzZXJ0XzQyKCk7IH0gd2hpbGUgKDApOyBkbyB7ICoodm9sYXRpbGUgdHlw
ZW9mKCgoKigoc3RydWN0IGxpc3RfaGVhZCAqKikoJihuZXctPnByZXYpLT5uZXh0KSkpKSkg
KikmKCgoKigoc3RydWN0IGxpc3RfaGVhZCAqKikoJihuZXctPnByZXYpLT5uZXh0KSkpKSkg
PSAoKHR5cGVvZigoKigoc3RydWN0IGxpc3RfaGVhZCAqKikoJihuZXctPnByZXYpLT5uZXh0
KSkpKSkoX3JfYV9wX192KSk7IH0gd2hpbGUgKDApOyB9IHdoaWxlICgwKTsgZWxzZSBkbyB7
IGRvIHsgZXh0ZXJuIHZvaWQgX19jb21waWxldGltZV9hc3NlcnRfNDModm9pZCkgX19hdHRy
aWJ1dGVfXygoX19lcnJvcl9fKCJOZWVkIG5hdGl2ZSB3b3JkIHNpemVkIHN0b3Jlcy9sb2Fk
cyBmb3IgYXRvbWljaXR5LiIpKSk7IGlmICghKChzaXplb2YoKiYoKigoc3RydWN0IGxpc3Rf
aGVhZCAqKikoJihuZXctPnByZXYpLT5uZXh0KSkpKSA9PSBzaXplb2YoY2hhcikgfHwgc2l6
ZW9mKComKCooKHN0cnVjdCBsaXN0X2hlYWQgKiopKCYobmV3LT5wcmV2KS0+bmV4dCkpKSkg
PT0gc2l6ZW9mKHNob3J0KSB8fCBzaXplb2YoKiYoKigoc3RydWN0IGxpc3RfaGVhZCAqKiko
JihuZXctPnByZXYpLT5uZXh0KSkpKSA9PSBzaXplb2YoaW50KSB8fCBzaXplb2YoKiYoKigo
c3RydWN0IGxpc3RfaGVhZCAqKikoJihuZXctPnByZXYpLT5uZXh0KSkpKSA9PSBzaXplb2Yo
bG9uZykpKSkgX19jb21waWxldGltZV9hc3NlcnRfNDMoKTsgfSB3aGlsZSAoMCk7IF9fYXNt
X18gX192b2xhdGlsZV9fICgibHdzeW5jIiAiICIgOiA6IDoibWVtb3J5Iik7IGRvIHsgZG8g
eyBleHRlcm4gdm9pZCBfX2NvbXBpbGV0aW1lX2Fzc2VydF80NCh2b2lkKSBfX2F0dHJpYnV0
ZV9fKChfX2Vycm9yX18oIlVuc3VwcG9ydGVkIGFjY2VzcyBzaXplIGZvciB7UkVBRCxXUklU
RX1fT05DRSgpLiIpKSk7IGlmICghKChzaXplb2YoKiYoKigoc3RydWN0IGxpc3RfaGVhZCAq
KikoJihuZXctPnByZXYpLT5uZXh0KSkpKSA9PSBzaXplb2YoY2hhcikgfHwgc2l6ZW9mKCom
KCooKHN0cnVjdCBsaXN0X2hlYWQgKiopKCYobmV3LT5wcmV2KS0+bmV4dCkpKSkgPT0gc2l6
ZW9mKHNob3J0KSB8fCBzaXplb2YoKiYoKigoc3RydWN0IGxpc3RfaGVhZCAqKikoJihuZXct
PnByZXYpLT5uZXh0KSkpKSA9PSBzaXplb2YoaW50KSB8fCBzaXplb2YoKiYoKigoc3RydWN0
IGxpc3RfaGVhZCAqKikoJihuZXctPnByZXYpLT5uZXh0KSkpKSA9PSBzaXplb2YobG9uZykp
IHx8IHNpemVvZigqJigqKChzdHJ1Y3QgbGlzdF9oZWFkICoqKSgmKG5ldy0+cHJldiktPm5l
eHQpKSkpID09IHNpemVvZihsb25nIGxvbmcpKSkgX19jb21waWxldGltZV9hc3NlcnRfNDQo
KTsgfSB3aGlsZSAoMCk7IGRvIHsgKih2b2xhdGlsZSB0eXBlb2YoKiYoKigoc3RydWN0IGxp
c3RfaGVhZCAqKikoJihuZXctPnByZXYpLT5uZXh0KSkpKSAqKSYoKiYoKigoc3RydWN0IGxp
c3RfaGVhZCAqKikoJihuZXctPnByZXYpLT5uZXh0KSkpKSA9ICgodHlwZW9mKCooKHR5cGVv
ZigoKigoc3RydWN0IGxpc3RfaGVhZCAqKikoJihuZXctPnByZXYpLT5uZXh0KSkpKSlfcl9h
X3BfX3YpKSAqKSgodHlwZW9mKCgqKChzdHJ1Y3QgbGlzdF9oZWFkICoqKSgmKG5ldy0+cHJl
diktPm5leHQpKSkpKV9yX2FfcF9fdikpOyB9IHdoaWxlICgwKTsgfSB3aGlsZSAoMCk7IH0g
d2hpbGUgKDApOyB9IHdoaWxlICgwKTsKIG5ldy0+bmV4dC0+cHJldiA9IG5ldzsKIG9sZC0+
cHJldiA9ICgodm9pZCAqKSAweDEyMiArICgweDVkZWFkYmVlZjAwMDAwMDBVTCkpOwp9CiMg
MjI3ICIuL2luY2x1ZGUvbGludXgvcmN1bGlzdC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBfX2xpc3Rf
c3BsaWNlX2luaXRfcmN1KHN0cnVjdCBsaXN0X2hlYWQgKmxpc3QsCiAgICAgICBzdHJ1Y3Qg
bGlzdF9oZWFkICpwcmV2LAogICAgICAgc3RydWN0IGxpc3RfaGVhZCAqbmV4dCwKICAgICAg
IHZvaWQgKCpzeW5jKSh2b2lkKSkKewogc3RydWN0IGxpc3RfaGVhZCAqZmlyc3QgPSBsaXN0
LT5uZXh0Owogc3RydWN0IGxpc3RfaGVhZCAqbGFzdCA9IGxpc3QtPnByZXY7CgoKCgoKCgog
SU5JVF9MSVNUX0hFQURfUkNVKGxpc3QpOwojIDI1MCAiLi9pbmNsdWRlL2xpbnV4L3JjdWxp
c3QuaCIKIHN5bmMoKTsKIyAyNjAgIi4vaW5jbHVkZS9saW51eC9yY3VsaXN0LmgiCiBsYXN0
LT5uZXh0ID0gbmV4dDsKIGRvIHsgdWludHB0cl90IF9yX2FfcF9fdiA9ICh1aW50cHRyX3Qp
KGZpcnN0KTsgOyBpZiAoX19idWlsdGluX2NvbnN0YW50X3AoZmlyc3QpICYmIChfcl9hX3Bf
X3YpID09ICh1aW50cHRyX3QpKCh2b2lkICopMCkpIGRvIHsgZG8geyBleHRlcm4gdm9pZCBf
X2NvbXBpbGV0aW1lX2Fzc2VydF80NSh2b2lkKSBfX2F0dHJpYnV0ZV9fKChfX2Vycm9yX18o
IlVuc3VwcG9ydGVkIGFjY2VzcyBzaXplIGZvciB7UkVBRCxXUklURX1fT05DRSgpLiIpKSk7
IGlmICghKChzaXplb2YoKCgqKChzdHJ1Y3QgbGlzdF9oZWFkICoqKSgmKHByZXYpLT5uZXh0
KSkpKSkgPT0gc2l6ZW9mKGNoYXIpIHx8IHNpemVvZigoKCooKHN0cnVjdCBsaXN0X2hlYWQg
KiopKCYocHJldiktPm5leHQpKSkpKSA9PSBzaXplb2Yoc2hvcnQpIHx8IHNpemVvZigoKCoo
KHN0cnVjdCBsaXN0X2hlYWQgKiopKCYocHJldiktPm5leHQpKSkpKSA9PSBzaXplb2YoaW50
KSB8fCBzaXplb2YoKCgqKChzdHJ1Y3QgbGlzdF9oZWFkICoqKSgmKHByZXYpLT5uZXh0KSkp
KSkgPT0gc2l6ZW9mKGxvbmcpKSB8fCBzaXplb2YoKCgqKChzdHJ1Y3QgbGlzdF9oZWFkICoq
KSgmKHByZXYpLT5uZXh0KSkpKSkgPT0gc2l6ZW9mKGxvbmcgbG9uZykpKSBfX2NvbXBpbGV0
aW1lX2Fzc2VydF80NSgpOyB9IHdoaWxlICgwKTsgZG8geyAqKHZvbGF0aWxlIHR5cGVvZigo
KCooKHN0cnVjdCBsaXN0X2hlYWQgKiopKCYocHJldiktPm5leHQpKSkpKSAqKSYoKCgqKChz
dHJ1Y3QgbGlzdF9oZWFkICoqKSgmKHByZXYpLT5uZXh0KSkpKSkgPSAoKHR5cGVvZigoKigo
c3RydWN0IGxpc3RfaGVhZCAqKikoJihwcmV2KS0+bmV4dCkpKSkpKF9yX2FfcF9fdikpOyB9
IHdoaWxlICgwKTsgfSB3aGlsZSAoMCk7IGVsc2UgZG8geyBkbyB7IGV4dGVybiB2b2lkIF9f
Y29tcGlsZXRpbWVfYXNzZXJ0XzQ2KHZvaWQpIF9fYXR0cmlidXRlX18oKF9fZXJyb3JfXygi
TmVlZCBuYXRpdmUgd29yZCBzaXplZCBzdG9yZXMvbG9hZHMgZm9yIGF0b21pY2l0eS4iKSkp
OyBpZiAoISgoc2l6ZW9mKComKCooKHN0cnVjdCBsaXN0X2hlYWQgKiopKCYocHJldiktPm5l
eHQpKSkpID09IHNpemVvZihjaGFyKSB8fCBzaXplb2YoKiYoKigoc3RydWN0IGxpc3RfaGVh
ZCAqKikoJihwcmV2KS0+bmV4dCkpKSkgPT0gc2l6ZW9mKHNob3J0KSB8fCBzaXplb2YoKiYo
Kigoc3RydWN0IGxpc3RfaGVhZCAqKikoJihwcmV2KS0+bmV4dCkpKSkgPT0gc2l6ZW9mKGlu
dCkgfHwgc2l6ZW9mKComKCooKHN0cnVjdCBsaXN0X2hlYWQgKiopKCYocHJldiktPm5leHQp
KSkpID09IHNpemVvZihsb25nKSkpKSBfX2NvbXBpbGV0aW1lX2Fzc2VydF80NigpOyB9IHdo
aWxlICgwKTsgX19hc21fXyBfX3ZvbGF0aWxlX18gKCJsd3N5bmMiICIgIiA6IDogOiJtZW1v
cnkiKTsgZG8geyBkbyB7IGV4dGVybiB2b2lkIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzQ3KHZv
aWQpIF9fYXR0cmlidXRlX18oKF9fZXJyb3JfXygiVW5zdXBwb3J0ZWQgYWNjZXNzIHNpemUg
Zm9yIHtSRUFELFdSSVRFfV9PTkNFKCkuIikpKTsgaWYgKCEoKHNpemVvZigqJigqKChzdHJ1
Y3QgbGlzdF9oZWFkICoqKSgmKHByZXYpLT5uZXh0KSkpKSA9PSBzaXplb2YoY2hhcikgfHwg
c2l6ZW9mKComKCooKHN0cnVjdCBsaXN0X2hlYWQgKiopKCYocHJldiktPm5leHQpKSkpID09
IHNpemVvZihzaG9ydCkgfHwgc2l6ZW9mKComKCooKHN0cnVjdCBsaXN0X2hlYWQgKiopKCYo
cHJldiktPm5leHQpKSkpID09IHNpemVvZihpbnQpIHx8IHNpemVvZigqJigqKChzdHJ1Y3Qg
bGlzdF9oZWFkICoqKSgmKHByZXYpLT5uZXh0KSkpKSA9PSBzaXplb2YobG9uZykpIHx8IHNp
emVvZigqJigqKChzdHJ1Y3QgbGlzdF9oZWFkICoqKSgmKHByZXYpLT5uZXh0KSkpKSA9PSBz
aXplb2YobG9uZyBsb25nKSkpIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzQ3KCk7IH0gd2hpbGUg
KDApOyBkbyB7ICoodm9sYXRpbGUgdHlwZW9mKComKCooKHN0cnVjdCBsaXN0X2hlYWQgKiop
KCYocHJldiktPm5leHQpKSkpICopJigqJigqKChzdHJ1Y3QgbGlzdF9oZWFkICoqKSgmKHBy
ZXYpLT5uZXh0KSkpKSA9ICgodHlwZW9mKCooKHR5cGVvZigoKigoc3RydWN0IGxpc3RfaGVh
ZCAqKikoJihwcmV2KS0+bmV4dCkpKSkpX3JfYV9wX192KSkgKikoKHR5cGVvZigoKigoc3Ry
dWN0IGxpc3RfaGVhZCAqKikoJihwcmV2KS0+bmV4dCkpKSkpX3JfYV9wX192KSk7IH0gd2hp
bGUgKDApOyB9IHdoaWxlICgwKTsgfSB3aGlsZSAoMCk7IH0gd2hpbGUgKDApOwogZmlyc3Qt
PnByZXYgPSBwcmV2OwogbmV4dC0+cHJldiA9IGxhc3Q7Cn0KIyAyNzMgIi4vaW5jbHVkZS9s
aW51eC9yY3VsaXN0LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGxpc3Rfc3BsaWNlX2luaXRfcmN1KHN0
cnVjdCBsaXN0X2hlYWQgKmxpc3QsCiAgICAgc3RydWN0IGxpc3RfaGVhZCAqaGVhZCwKICAg
ICB2b2lkICgqc3luYykodm9pZCkpCnsKIGlmICghbGlzdF9lbXB0eShsaXN0KSkKICBfX2xp
c3Rfc3BsaWNlX2luaXRfcmN1KGxpc3QsIGhlYWQsIGhlYWQtPm5leHQsIHN5bmMpOwp9CiMg
Mjg4ICIuL2luY2x1ZGUvbGludXgvcmN1bGlzdC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBsaXN0X3Nw
bGljZV90YWlsX2luaXRfcmN1KHN0cnVjdCBsaXN0X2hlYWQgKmxpc3QsCiAgICAgICAgICBz
dHJ1Y3QgbGlzdF9oZWFkICpoZWFkLAogICAgICAgICAgdm9pZCAoKnN5bmMpKHZvaWQpKQp7
CiBpZiAoIWxpc3RfZW1wdHkobGlzdCkpCiAgX19saXN0X3NwbGljZV9pbml0X3JjdShsaXN0
LCBoZWFkLT5wcmV2LCBoZWFkLCBzeW5jKTsKfQojIDQ4MyAiLi9pbmNsdWRlL2xpbnV4L3Jj
dWxpc3QuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgaGxpc3RfZGVsX3JjdShzdHJ1Y3QgaGxpc3Rfbm9k
ZSAqbikKewogX19obGlzdF9kZWwobik7CiBkbyB7IGRvIHsgZXh0ZXJuIHZvaWQgX19jb21w
aWxldGltZV9hc3NlcnRfNDgodm9pZCkgX19hdHRyaWJ1dGVfXygoX19lcnJvcl9fKCJVbnN1
cHBvcnRlZCBhY2Nlc3Mgc2l6ZSBmb3Ige1JFQUQsV1JJVEV9X09OQ0UoKS4iKSkpOyBpZiAo
ISgoc2l6ZW9mKG4tPnBwcmV2KSA9PSBzaXplb2YoY2hhcikgfHwgc2l6ZW9mKG4tPnBwcmV2
KSA9PSBzaXplb2Yoc2hvcnQpIHx8IHNpemVvZihuLT5wcHJldikgPT0gc2l6ZW9mKGludCkg
fHwgc2l6ZW9mKG4tPnBwcmV2KSA9PSBzaXplb2YobG9uZykpIHx8IHNpemVvZihuLT5wcHJl
dikgPT0gc2l6ZW9mKGxvbmcgbG9uZykpKSBfX2NvbXBpbGV0aW1lX2Fzc2VydF80OCgpOyB9
IHdoaWxlICgwKTsgZG8geyAqKHZvbGF0aWxlIHR5cGVvZihuLT5wcHJldikgKikmKG4tPnBw
cmV2KSA9ICgoKHZvaWQgKikgMHgxMjIgKyAoMHg1ZGVhZGJlZWYwMDAwMDAwVUwpKSk7IH0g
d2hpbGUgKDApOyB9IHdoaWxlICgwKTsKfQojIDQ5NiAiLi9pbmNsdWRlL2xpbnV4L3JjdWxp
c3QuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIHZvaWQgaGxpc3RfcmVwbGFjZV9yY3Uoc3RydWN0IGhsaXN0X25v
ZGUgKm9sZCwKICAgICBzdHJ1Y3QgaGxpc3Rfbm9kZSAqbmV3KQp7CiBzdHJ1Y3QgaGxpc3Rf
bm9kZSAqbmV4dCA9IG9sZC0+bmV4dDsKCiBuZXctPm5leHQgPSBuZXh0OwogZG8geyBkbyB7
IGV4dGVybiB2b2lkIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzQ5KHZvaWQpIF9fYXR0cmlidXRl
X18oKF9fZXJyb3JfXygiVW5zdXBwb3J0ZWQgYWNjZXNzIHNpemUgZm9yIHtSRUFELFdSSVRF
fV9PTkNFKCkuIikpKTsgaWYgKCEoKHNpemVvZihuZXctPnBwcmV2KSA9PSBzaXplb2YoY2hh
cikgfHwgc2l6ZW9mKG5ldy0+cHByZXYpID09IHNpemVvZihzaG9ydCkgfHwgc2l6ZW9mKG5l
dy0+cHByZXYpID09IHNpemVvZihpbnQpIHx8IHNpemVvZihuZXctPnBwcmV2KSA9PSBzaXpl
b2YobG9uZykpIHx8IHNpemVvZihuZXctPnBwcmV2KSA9PSBzaXplb2YobG9uZyBsb25nKSkp
IF9fY29tcGlsZXRpbWVfYXNzZXJ0XzQ5KCk7IH0gd2hpbGUgKDApOyBkbyB7ICoodm9sYXRp
bGUgdHlwZW9mKG5ldy0+cHByZXYpICopJihuZXctPnBwcmV2KSA9IChvbGQtPnBwcmV2KTsg
fSB3aGlsZSAoMCk7IH0gd2hpbGUgKDApOwogZG8geyB1aW50cHRyX3QgX3JfYV9wX192ID0g
KHVpbnRwdHJfdCkobmV3KTsgOyBpZiAoX19idWlsdGluX2NvbnN0YW50X3AobmV3KSAmJiAo
X3JfYV9wX192KSA9PSAodWludHB0cl90KSgodm9pZCAqKTApKSBkbyB7IGRvIHsgZXh0ZXJu
IHZvaWQgX19jb21waWxldGltZV9hc3NlcnRfNTAodm9pZCkgX19hdHRyaWJ1dGVfXygoX19l
cnJvcl9fKCJVbnN1cHBvcnRlZCBhY2Nlc3Mgc2l6ZSBmb3Ige1JFQUQsV1JJVEV9X09OQ0Uo
KS4iKSkpOyBpZiAoISgoc2l6ZW9mKCgqKHN0cnVjdCBobGlzdF9ub2RlICoqKW5ldy0+cHBy
ZXYpKSA9PSBzaXplb2YoY2hhcikgfHwgc2l6ZW9mKCgqKHN0cnVjdCBobGlzdF9ub2RlICoq
KW5ldy0+cHByZXYpKSA9PSBzaXplb2Yoc2hvcnQpIHx8IHNpemVvZigoKihzdHJ1Y3QgaGxp
c3Rfbm9kZSAqKiluZXctPnBwcmV2KSkgPT0gc2l6ZW9mKGludCkgfHwgc2l6ZW9mKCgqKHN0
cnVjdCBobGlzdF9ub2RlICoqKW5ldy0+cHByZXYpKSA9PSBzaXplb2YobG9uZykpIHx8IHNp
emVvZigoKihzdHJ1Y3QgaGxpc3Rfbm9kZSAqKiluZXctPnBwcmV2KSkgPT0gc2l6ZW9mKGxv
bmcgbG9uZykpKSBfX2NvbXBpbGV0aW1lX2Fzc2VydF81MCgpOyB9IHdoaWxlICgwKTsgZG8g
eyAqKHZvbGF0aWxlIHR5cGVvZigoKihzdHJ1Y3QgaGxpc3Rfbm9kZSAqKiluZXctPnBwcmV2
KSkgKikmKCgqKHN0cnVjdCBobGlzdF9ub2RlICoqKW5ldy0+cHByZXYpKSA9ICgodHlwZW9m
KCooc3RydWN0IGhsaXN0X25vZGUgKiopbmV3LT5wcHJldikpKF9yX2FfcF9fdikpOyB9IHdo
aWxlICgwKTsgfSB3aGlsZSAoMCk7IGVsc2UgZG8geyBkbyB7IGV4dGVybiB2b2lkIF9fY29t
cGlsZXRpbWVfYXNzZXJ0XzUxKHZvaWQpIF9fYXR0cmlidXRlX18oKF9fZXJyb3JfXygiTmVl
ZCBuYXRpdmUgd29yZCBzaXplZCBzdG9yZXMvbG9hZHMgZm9yIGF0b21pY2l0eS4iKSkpOyBp
ZiAoISgoc2l6ZW9mKComKihzdHJ1Y3QgaGxpc3Rfbm9kZSAqKiluZXctPnBwcmV2KSA9PSBz
aXplb2YoY2hhcikgfHwgc2l6ZW9mKComKihzdHJ1Y3QgaGxpc3Rfbm9kZSAqKiluZXctPnBw
cmV2KSA9PSBzaXplb2Yoc2hvcnQpIHx8IHNpemVvZigqJiooc3RydWN0IGhsaXN0X25vZGUg
KiopbmV3LT5wcHJldikgPT0gc2l6ZW9mKGludCkgfHwgc2l6ZW9mKComKihzdHJ1Y3QgaGxp
c3Rfbm9kZSAqKiluZXctPnBwcmV2KSA9PSBzaXplb2YobG9uZykpKSkgX19jb21waWxldGlt
ZV9hc3NlcnRfNTEoKTsgfSB3aGlsZSAoMCk7IF9fYXNtX18gX192b2xhdGlsZV9fICgibHdz
eW5jIiAiICIgOiA6IDoibWVtb3J5Iik7IGRvIHsgZG8geyBleHRlcm4gdm9pZCBfX2NvbXBp
bGV0aW1lX2Fzc2VydF81Mih2b2lkKSBfX2F0dHJpYnV0ZV9fKChfX2Vycm9yX18oIlVuc3Vw
cG9ydGVkIGFjY2VzcyBzaXplIGZvciB7UkVBRCxXUklURX1fT05DRSgpLiIpKSk7IGlmICgh
KChzaXplb2YoKiYqKHN0cnVjdCBobGlzdF9ub2RlICoqKW5ldy0+cHByZXYpID09IHNpemVv
ZihjaGFyKSB8fCBzaXplb2YoKiYqKHN0cnVjdCBobGlzdF9ub2RlICoqKW5ldy0+cHByZXYp
ID09IHNpemVvZihzaG9ydCkgfHwgc2l6ZW9mKComKihzdHJ1Y3QgaGxpc3Rfbm9kZSAqKilu
ZXctPnBwcmV2KSA9PSBzaXplb2YoaW50KSB8fCBzaXplb2YoKiYqKHN0cnVjdCBobGlzdF9u
b2RlICoqKW5ldy0+cHByZXYpID09IHNpemVvZihsb25nKSkgfHwgc2l6ZW9mKComKihzdHJ1
Y3QgaGxpc3Rfbm9kZSAqKiluZXctPnBwcmV2KSA9PSBzaXplb2YobG9uZyBsb25nKSkpIF9f
Y29tcGlsZXRpbWVfYXNzZXJ0XzUyKCk7IH0gd2hpbGUgKDApOyBkbyB7ICoodm9sYXRpbGUg
dHlwZW9mKComKihzdHJ1Y3QgaGxpc3Rfbm9kZSAqKiluZXctPnBwcmV2KSAqKSYoKiYqKHN0
cnVjdCBobGlzdF9ub2RlICoqKW5ldy0+cHByZXYpID0gKCh0eXBlb2YoKigodHlwZW9mKCoo
c3RydWN0IGhsaXN0X25vZGUgKiopbmV3LT5wcHJldikpX3JfYV9wX192KSkgKikoKHR5cGVv
ZigqKHN0cnVjdCBobGlzdF9ub2RlICoqKW5ldy0+cHByZXYpKV9yX2FfcF9fdikpOyB9IHdo
aWxlICgwKTsgfSB3aGlsZSAoMCk7IH0gd2hpbGUgKDApOyB9IHdoaWxlICgwKTsKIGlmIChu
ZXh0KQogIGRvIHsgZG8geyBleHRlcm4gdm9pZCBfX2NvbXBpbGV0aW1lX2Fzc2VydF81Myh2
b2lkKSBfX2F0dHJpYnV0ZV9fKChfX2Vycm9yX18oIlVuc3VwcG9ydGVkIGFjY2VzcyBzaXpl
IGZvciB7UkVBRCxXUklURX1fT05DRSgpLiIpKSk7IGlmICghKChzaXplb2YobmV3LT5uZXh0
LT5wcHJldikgPT0gc2l6ZW9mKGNoYXIpIHx8IHNpemVvZihuZXctPm5leHQtPnBwcmV2KSA9
PSBzaXplb2Yoc2hvcnQpIHx8IHNpemVvZihuZXctPm5leHQtPnBwcmV2KSA9PSBzaXplb2Yo
aW50KSB8fCBzaXplb2YobmV3LT5uZXh0LT5wcHJldikgPT0gc2l6ZW9mKGxvbmcpKSB8fCBz
aXplb2YobmV3LT5uZXh0LT5wcHJldikgPT0gc2l6ZW9mKGxvbmcgbG9uZykpKSBfX2NvbXBp
bGV0aW1lX2Fzc2VydF81MygpOyB9IHdoaWxlICgwKTsgZG8geyAqKHZvbGF0aWxlIHR5cGVv
ZihuZXctPm5leHQtPnBwcmV2KSAqKSYobmV3LT5uZXh0LT5wcHJldikgPSAoJm5ldy0+bmV4
dCk7IH0gd2hpbGUgKDApOyB9IHdoaWxlICgwKTsKIGRvIHsgZG8geyBleHRlcm4gdm9pZCBf
X2NvbXBpbGV0aW1lX2Fzc2VydF81NCh2b2lkKSBfX2F0dHJpYnV0ZV9fKChfX2Vycm9yX18o
IlVuc3VwcG9ydGVkIGFjY2VzcyBzaXplIGZvciB7UkVBRCxXUklURX1fT05DRSgpLiIpKSk7
IGlmICghKChzaXplb2Yob2xkLT5wcHJldikgPT0gc2l6ZW9mKGNoYXIpIHx8IHNpemVvZihv
bGQtPnBwcmV2KSA9PSBzaXplb2Yoc2hvcnQpIHx8IHNpemVvZihvbGQtPnBwcmV2KSA9PSBz
aXplb2YoaW50KSB8fCBzaXplb2Yob2xkLT5wcHJldikgPT0gc2l6ZW9mKGxvbmcpKSB8fCBz
aXplb2Yob2xkLT5wcHJldikgPT0gc2l6ZW9mKGxvbmcgbG9uZykpKSBfX2NvbXBpbGV0aW1l
X2Fzc2VydF81NCgpOyB9IHdoaWxlICgwKTsgZG8geyAqKHZvbGF0aWxlIHR5cGVvZihvbGQt
PnBwcmV2KSAqKSYob2xkLT5wcHJldikgPSAoKCh2b2lkICopIDB4MTIyICsgKDB4NWRlYWRi
ZWVmMDAwMDAwMFVMKSkpOyB9IHdoaWxlICgwKTsgfSB3aGlsZSAoMCk7Cn0KIyA1MTkgIi4v
aW5jbHVkZS9saW51eC9yY3VsaXN0LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGhsaXN0c19zd2FwX2hl
YWRzX3JjdShzdHJ1Y3QgaGxpc3RfaGVhZCAqbGVmdCwgc3RydWN0IGhsaXN0X2hlYWQgKnJp
Z2h0KQp7CiBzdHJ1Y3QgaGxpc3Rfbm9kZSAqbm9kZTEgPSBsZWZ0LT5maXJzdDsKIHN0cnVj
dCBobGlzdF9ub2RlICpub2RlMiA9IHJpZ2h0LT5maXJzdDsKCiBkbyB7IHVpbnRwdHJfdCBf
cl9hX3BfX3YgPSAodWludHB0cl90KShub2RlMik7IDsgaWYgKF9fYnVpbHRpbl9jb25zdGFu
dF9wKG5vZGUyKSAmJiAoX3JfYV9wX192KSA9PSAodWludHB0cl90KSgodm9pZCAqKTApKSBk
byB7IGRvIHsgZXh0ZXJuIHZvaWQgX19jb21waWxldGltZV9hc3NlcnRfNTUodm9pZCkgX19h
dHRyaWJ1dGVfXygoX19lcnJvcl9fKCJVbnN1cHBvcnRlZCBhY2Nlc3Mgc2l6ZSBmb3Ige1JF
QUQsV1JJVEV9X09OQ0UoKS4iKSkpOyBpZiAoISgoc2l6ZW9mKChsZWZ0LT5maXJzdCkpID09
IHNpemVvZihjaGFyKSB8fCBzaXplb2YoKGxlZnQtPmZpcnN0KSkgPT0gc2l6ZW9mKHNob3J0
KSB8fCBzaXplb2YoKGxlZnQtPmZpcnN0KSkgPT0gc2l6ZW9mKGludCkgfHwgc2l6ZW9mKChs
ZWZ0LT5maXJzdCkpID09IHNpemVvZihsb25nKSkgfHwgc2l6ZW9mKChsZWZ0LT5maXJzdCkp
ID09IHNpemVvZihsb25nIGxvbmcpKSkgX19jb21waWxldGltZV9hc3NlcnRfNTUoKTsgfSB3
aGlsZSAoMCk7IGRvIHsgKih2b2xhdGlsZSB0eXBlb2YoKGxlZnQtPmZpcnN0KSkgKikmKChs
ZWZ0LT5maXJzdCkpID0gKCh0eXBlb2YobGVmdC0+Zmlyc3QpKShfcl9hX3BfX3YpKTsgfSB3
aGlsZSAoMCk7IH0gd2hpbGUgKDApOyBlbHNlIGRvIHsgZG8geyBleHRlcm4gdm9pZCBfX2Nv
bXBpbGV0aW1lX2Fzc2VydF81Nih2b2lkKSBfX2F0dHJpYnV0ZV9fKChfX2Vycm9yX18oIk5l
ZWQgbmF0aXZlIHdvcmQgc2l6ZWQgc3RvcmVzL2xvYWRzIGZvciBhdG9taWNpdHkuIikpKTsg
aWYgKCEoKHNpemVvZigqJmxlZnQtPmZpcnN0KSA9PSBzaXplb2YoY2hhcikgfHwgc2l6ZW9m
KCombGVmdC0+Zmlyc3QpID09IHNpemVvZihzaG9ydCkgfHwgc2l6ZW9mKCombGVmdC0+Zmly
c3QpID09IHNpemVvZihpbnQpIHx8IHNpemVvZigqJmxlZnQtPmZpcnN0KSA9PSBzaXplb2Yo
bG9uZykpKSkgX19jb21waWxldGltZV9hc3NlcnRfNTYoKTsgfSB3aGlsZSAoMCk7IF9fYXNt
X18gX192b2xhdGlsZV9fICgibHdzeW5jIiAiICIgOiA6IDoibWVtb3J5Iik7IGRvIHsgZG8g
eyBleHRlcm4gdm9pZCBfX2NvbXBpbGV0aW1lX2Fzc2VydF81Nyh2b2lkKSBfX2F0dHJpYnV0
ZV9fKChfX2Vycm9yX18oIlVuc3VwcG9ydGVkIGFjY2VzcyBzaXplIGZvciB7UkVBRCxXUklU
RX1fT05DRSgpLiIpKSk7IGlmICghKChzaXplb2YoKiZsZWZ0LT5maXJzdCkgPT0gc2l6ZW9m
KGNoYXIpIHx8IHNpemVvZigqJmxlZnQtPmZpcnN0KSA9PSBzaXplb2Yoc2hvcnQpIHx8IHNp
emVvZigqJmxlZnQtPmZpcnN0KSA9PSBzaXplb2YoaW50KSB8fCBzaXplb2YoKiZsZWZ0LT5m
aXJzdCkgPT0gc2l6ZW9mKGxvbmcpKSB8fCBzaXplb2YoKiZsZWZ0LT5maXJzdCkgPT0gc2l6
ZW9mKGxvbmcgbG9uZykpKSBfX2NvbXBpbGV0aW1lX2Fzc2VydF81NygpOyB9IHdoaWxlICgw
KTsgZG8geyAqKHZvbGF0aWxlIHR5cGVvZigqJmxlZnQtPmZpcnN0KSAqKSYoKiZsZWZ0LT5m
aXJzdCkgPSAoKHR5cGVvZigqKCh0eXBlb2YobGVmdC0+Zmlyc3QpKV9yX2FfcF9fdikpICop
KCh0eXBlb2YobGVmdC0+Zmlyc3QpKV9yX2FfcF9fdikpOyB9IHdoaWxlICgwKTsgfSB3aGls
ZSAoMCk7IH0gd2hpbGUgKDApOyB9IHdoaWxlICgwKTsKIGRvIHsgdWludHB0cl90IF9yX2Ff
cF9fdiA9ICh1aW50cHRyX3QpKG5vZGUxKTsgOyBpZiAoX19idWlsdGluX2NvbnN0YW50X3Ao
bm9kZTEpICYmIChfcl9hX3BfX3YpID09ICh1aW50cHRyX3QpKCh2b2lkICopMCkpIGRvIHsg
ZG8geyBleHRlcm4gdm9pZCBfX2NvbXBpbGV0aW1lX2Fzc2VydF81OCh2b2lkKSBfX2F0dHJp
YnV0ZV9fKChfX2Vycm9yX18oIlVuc3VwcG9ydGVkIGFjY2VzcyBzaXplIGZvciB7UkVBRCxX
UklURX1fT05DRSgpLiIpKSk7IGlmICghKChzaXplb2YoKHJpZ2h0LT5maXJzdCkpID09IHNp
emVvZihjaGFyKSB8fCBzaXplb2YoKHJpZ2h0LT5maXJzdCkpID09IHNpemVvZihzaG9ydCkg
fHwgc2l6ZW9mKChyaWdodC0+Zmlyc3QpKSA9PSBzaXplb2YoaW50KSB8fCBzaXplb2YoKHJp
Z2h0LT5maXJzdCkpID09IHNpemVvZihsb25nKSkgfHwgc2l6ZW9mKChyaWdodC0+Zmlyc3Qp
KSA9PSBzaXplb2YobG9uZyBsb25nKSkpIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzU4KCk7IH0g
d2hpbGUgKDApOyBkbyB7ICoodm9sYXRpbGUgdHlwZW9mKChyaWdodC0+Zmlyc3QpKSAqKSYo
KHJpZ2h0LT5maXJzdCkpID0gKCh0eXBlb2YocmlnaHQtPmZpcnN0KSkoX3JfYV9wX192KSk7
IH0gd2hpbGUgKDApOyB9IHdoaWxlICgwKTsgZWxzZSBkbyB7IGRvIHsgZXh0ZXJuIHZvaWQg
X19jb21waWxldGltZV9hc3NlcnRfNTkodm9pZCkgX19hdHRyaWJ1dGVfXygoX19lcnJvcl9f
KCJOZWVkIG5hdGl2ZSB3b3JkIHNpemVkIHN0b3Jlcy9sb2FkcyBmb3IgYXRvbWljaXR5LiIp
KSk7IGlmICghKChzaXplb2YoKiZyaWdodC0+Zmlyc3QpID09IHNpemVvZihjaGFyKSB8fCBz
aXplb2YoKiZyaWdodC0+Zmlyc3QpID09IHNpemVvZihzaG9ydCkgfHwgc2l6ZW9mKComcmln
aHQtPmZpcnN0KSA9PSBzaXplb2YoaW50KSB8fCBzaXplb2YoKiZyaWdodC0+Zmlyc3QpID09
IHNpemVvZihsb25nKSkpKSBfX2NvbXBpbGV0aW1lX2Fzc2VydF81OSgpOyB9IHdoaWxlICgw
KTsgX19hc21fXyBfX3ZvbGF0aWxlX18gKCJsd3N5bmMiICIgIiA6IDogOiJtZW1vcnkiKTsg
ZG8geyBkbyB7IGV4dGVybiB2b2lkIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzYwKHZvaWQpIF9f
YXR0cmlidXRlX18oKF9fZXJyb3JfXygiVW5zdXBwb3J0ZWQgYWNjZXNzIHNpemUgZm9yIHtS
RUFELFdSSVRFfV9PTkNFKCkuIikpKTsgaWYgKCEoKHNpemVvZigqJnJpZ2h0LT5maXJzdCkg
PT0gc2l6ZW9mKGNoYXIpIHx8IHNpemVvZigqJnJpZ2h0LT5maXJzdCkgPT0gc2l6ZW9mKHNo
b3J0KSB8fCBzaXplb2YoKiZyaWdodC0+Zmlyc3QpID09IHNpemVvZihpbnQpIHx8IHNpemVv
ZigqJnJpZ2h0LT5maXJzdCkgPT0gc2l6ZW9mKGxvbmcpKSB8fCBzaXplb2YoKiZyaWdodC0+
Zmlyc3QpID09IHNpemVvZihsb25nIGxvbmcpKSkgX19jb21waWxldGltZV9hc3NlcnRfNjAo
KTsgfSB3aGlsZSAoMCk7IGRvIHsgKih2b2xhdGlsZSB0eXBlb2YoKiZyaWdodC0+Zmlyc3Qp
ICopJigqJnJpZ2h0LT5maXJzdCkgPSAoKHR5cGVvZigqKCh0eXBlb2YocmlnaHQtPmZpcnN0
KSlfcl9hX3BfX3YpKSAqKSgodHlwZW9mKHJpZ2h0LT5maXJzdCkpX3JfYV9wX192KSk7IH0g
d2hpbGUgKDApOyB9IHdoaWxlICgwKTsgfSB3aGlsZSAoMCk7IH0gd2hpbGUgKDApOwogZG8g
eyBkbyB7IGV4dGVybiB2b2lkIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzYxKHZvaWQpIF9fYXR0
cmlidXRlX18oKF9fZXJyb3JfXygiVW5zdXBwb3J0ZWQgYWNjZXNzIHNpemUgZm9yIHtSRUFE
LFdSSVRFfV9PTkNFKCkuIikpKTsgaWYgKCEoKHNpemVvZihub2RlMi0+cHByZXYpID09IHNp
emVvZihjaGFyKSB8fCBzaXplb2Yobm9kZTItPnBwcmV2KSA9PSBzaXplb2Yoc2hvcnQpIHx8
IHNpemVvZihub2RlMi0+cHByZXYpID09IHNpemVvZihpbnQpIHx8IHNpemVvZihub2RlMi0+
cHByZXYpID09IHNpemVvZihsb25nKSkgfHwgc2l6ZW9mKG5vZGUyLT5wcHJldikgPT0gc2l6
ZW9mKGxvbmcgbG9uZykpKSBfX2NvbXBpbGV0aW1lX2Fzc2VydF82MSgpOyB9IHdoaWxlICgw
KTsgZG8geyAqKHZvbGF0aWxlIHR5cGVvZihub2RlMi0+cHByZXYpICopJihub2RlMi0+cHBy
ZXYpID0gKCZsZWZ0LT5maXJzdCk7IH0gd2hpbGUgKDApOyB9IHdoaWxlICgwKTsKIGRvIHsg
ZG8geyBleHRlcm4gdm9pZCBfX2NvbXBpbGV0aW1lX2Fzc2VydF82Mih2b2lkKSBfX2F0dHJp
YnV0ZV9fKChfX2Vycm9yX18oIlVuc3VwcG9ydGVkIGFjY2VzcyBzaXplIGZvciB7UkVBRCxX
UklURX1fT05DRSgpLiIpKSk7IGlmICghKChzaXplb2Yobm9kZTEtPnBwcmV2KSA9PSBzaXpl
b2YoY2hhcikgfHwgc2l6ZW9mKG5vZGUxLT5wcHJldikgPT0gc2l6ZW9mKHNob3J0KSB8fCBz
aXplb2Yobm9kZTEtPnBwcmV2KSA9PSBzaXplb2YoaW50KSB8fCBzaXplb2Yobm9kZTEtPnBw
cmV2KSA9PSBzaXplb2YobG9uZykpIHx8IHNpemVvZihub2RlMS0+cHByZXYpID09IHNpemVv
Zihsb25nIGxvbmcpKSkgX19jb21waWxldGltZV9hc3NlcnRfNjIoKTsgfSB3aGlsZSAoMCk7
IGRvIHsgKih2b2xhdGlsZSB0eXBlb2Yobm9kZTEtPnBwcmV2KSAqKSYobm9kZTEtPnBwcmV2
KSA9ICgmcmlnaHQtPmZpcnN0KTsgfSB3aGlsZSAoMCk7IH0gd2hpbGUgKDApOwp9CiMgNTU2
ICIuL2luY2x1ZGUvbGludXgvcmN1bGlzdC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBobGlzdF9hZGRf
aGVhZF9yY3Uoc3RydWN0IGhsaXN0X25vZGUgKm4sCiAgICAgc3RydWN0IGhsaXN0X2hlYWQg
KmgpCnsKIHN0cnVjdCBobGlzdF9ub2RlICpmaXJzdCA9IGgtPmZpcnN0OwoKIG4tPm5leHQg
PSBmaXJzdDsKIGRvIHsgZG8geyBleHRlcm4gdm9pZCBfX2NvbXBpbGV0aW1lX2Fzc2VydF82
Myh2b2lkKSBfX2F0dHJpYnV0ZV9fKChfX2Vycm9yX18oIlVuc3VwcG9ydGVkIGFjY2VzcyBz
aXplIGZvciB7UkVBRCxXUklURX1fT05DRSgpLiIpKSk7IGlmICghKChzaXplb2Yobi0+cHBy
ZXYpID09IHNpemVvZihjaGFyKSB8fCBzaXplb2Yobi0+cHByZXYpID09IHNpemVvZihzaG9y
dCkgfHwgc2l6ZW9mKG4tPnBwcmV2KSA9PSBzaXplb2YoaW50KSB8fCBzaXplb2Yobi0+cHBy
ZXYpID09IHNpemVvZihsb25nKSkgfHwgc2l6ZW9mKG4tPnBwcmV2KSA9PSBzaXplb2YobG9u
ZyBsb25nKSkpIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzYzKCk7IH0gd2hpbGUgKDApOyBkbyB7
ICoodm9sYXRpbGUgdHlwZW9mKG4tPnBwcmV2KSAqKSYobi0+cHByZXYpID0gKCZoLT5maXJz
dCk7IH0gd2hpbGUgKDApOyB9IHdoaWxlICgwKTsKIGRvIHsgdWludHB0cl90IF9yX2FfcF9f
diA9ICh1aW50cHRyX3QpKG4pOyA7IGlmIChfX2J1aWx0aW5fY29uc3RhbnRfcChuKSAmJiAo
X3JfYV9wX192KSA9PSAodWludHB0cl90KSgodm9pZCAqKTApKSBkbyB7IGRvIHsgZXh0ZXJu
IHZvaWQgX19jb21waWxldGltZV9hc3NlcnRfNjQodm9pZCkgX19hdHRyaWJ1dGVfXygoX19l
cnJvcl9fKCJVbnN1cHBvcnRlZCBhY2Nlc3Mgc2l6ZSBmb3Ige1JFQUQsV1JJVEV9X09OQ0Uo
KS4iKSkpOyBpZiAoISgoc2l6ZW9mKCgoKigoc3RydWN0IGhsaXN0X25vZGUgKiopKCYoaCkt
PmZpcnN0KSkpKSkgPT0gc2l6ZW9mKGNoYXIpIHx8IHNpemVvZigoKCooKHN0cnVjdCBobGlz
dF9ub2RlICoqKSgmKGgpLT5maXJzdCkpKSkpID09IHNpemVvZihzaG9ydCkgfHwgc2l6ZW9m
KCgoKigoc3RydWN0IGhsaXN0X25vZGUgKiopKCYoaCktPmZpcnN0KSkpKSkgPT0gc2l6ZW9m
KGludCkgfHwgc2l6ZW9mKCgoKigoc3RydWN0IGhsaXN0X25vZGUgKiopKCYoaCktPmZpcnN0
KSkpKSkgPT0gc2l6ZW9mKGxvbmcpKSB8fCBzaXplb2YoKCgqKChzdHJ1Y3QgaGxpc3Rfbm9k
ZSAqKikoJihoKS0+Zmlyc3QpKSkpKSA9PSBzaXplb2YobG9uZyBsb25nKSkpIF9fY29tcGls
ZXRpbWVfYXNzZXJ0XzY0KCk7IH0gd2hpbGUgKDApOyBkbyB7ICoodm9sYXRpbGUgdHlwZW9m
KCgoKigoc3RydWN0IGhsaXN0X25vZGUgKiopKCYoaCktPmZpcnN0KSkpKSkgKikmKCgoKigo
c3RydWN0IGhsaXN0X25vZGUgKiopKCYoaCktPmZpcnN0KSkpKSkgPSAoKHR5cGVvZigoKigo
c3RydWN0IGhsaXN0X25vZGUgKiopKCYoaCktPmZpcnN0KSkpKSkoX3JfYV9wX192KSk7IH0g
d2hpbGUgKDApOyB9IHdoaWxlICgwKTsgZWxzZSBkbyB7IGRvIHsgZXh0ZXJuIHZvaWQgX19j
b21waWxldGltZV9hc3NlcnRfNjUodm9pZCkgX19hdHRyaWJ1dGVfXygoX19lcnJvcl9fKCJO
ZWVkIG5hdGl2ZSB3b3JkIHNpemVkIHN0b3Jlcy9sb2FkcyBmb3IgYXRvbWljaXR5LiIpKSk7
IGlmICghKChzaXplb2YoKiYoKigoc3RydWN0IGhsaXN0X25vZGUgKiopKCYoaCktPmZpcnN0
KSkpKSA9PSBzaXplb2YoY2hhcikgfHwgc2l6ZW9mKComKCooKHN0cnVjdCBobGlzdF9ub2Rl
ICoqKSgmKGgpLT5maXJzdCkpKSkgPT0gc2l6ZW9mKHNob3J0KSB8fCBzaXplb2YoKiYoKigo
c3RydWN0IGhsaXN0X25vZGUgKiopKCYoaCktPmZpcnN0KSkpKSA9PSBzaXplb2YoaW50KSB8
fCBzaXplb2YoKiYoKigoc3RydWN0IGhsaXN0X25vZGUgKiopKCYoaCktPmZpcnN0KSkpKSA9
PSBzaXplb2YobG9uZykpKSkgX19jb21waWxldGltZV9hc3NlcnRfNjUoKTsgfSB3aGlsZSAo
MCk7IF9fYXNtX18gX192b2xhdGlsZV9fICgibHdzeW5jIiAiICIgOiA6IDoibWVtb3J5Iik7
IGRvIHsgZG8geyBleHRlcm4gdm9pZCBfX2NvbXBpbGV0aW1lX2Fzc2VydF82Nih2b2lkKSBf
X2F0dHJpYnV0ZV9fKChfX2Vycm9yX18oIlVuc3VwcG9ydGVkIGFjY2VzcyBzaXplIGZvciB7
UkVBRCxXUklURX1fT05DRSgpLiIpKSk7IGlmICghKChzaXplb2YoKiYoKigoc3RydWN0IGhs
aXN0X25vZGUgKiopKCYoaCktPmZpcnN0KSkpKSA9PSBzaXplb2YoY2hhcikgfHwgc2l6ZW9m
KComKCooKHN0cnVjdCBobGlzdF9ub2RlICoqKSgmKGgpLT5maXJzdCkpKSkgPT0gc2l6ZW9m
KHNob3J0KSB8fCBzaXplb2YoKiYoKigoc3RydWN0IGhsaXN0X25vZGUgKiopKCYoaCktPmZp
cnN0KSkpKSA9PSBzaXplb2YoaW50KSB8fCBzaXplb2YoKiYoKigoc3RydWN0IGhsaXN0X25v
ZGUgKiopKCYoaCktPmZpcnN0KSkpKSA9PSBzaXplb2YobG9uZykpIHx8IHNpemVvZigqJigq
KChzdHJ1Y3QgaGxpc3Rfbm9kZSAqKikoJihoKS0+Zmlyc3QpKSkpID09IHNpemVvZihsb25n
IGxvbmcpKSkgX19jb21waWxldGltZV9hc3NlcnRfNjYoKTsgfSB3aGlsZSAoMCk7IGRvIHsg
Kih2b2xhdGlsZSB0eXBlb2YoKiYoKigoc3RydWN0IGhsaXN0X25vZGUgKiopKCYoaCktPmZp
cnN0KSkpKSAqKSYoKiYoKigoc3RydWN0IGhsaXN0X25vZGUgKiopKCYoaCktPmZpcnN0KSkp
KSA9ICgodHlwZW9mKCooKHR5cGVvZigoKigoc3RydWN0IGhsaXN0X25vZGUgKiopKCYoaCkt
PmZpcnN0KSkpKSlfcl9hX3BfX3YpKSAqKSgodHlwZW9mKCgqKChzdHJ1Y3QgaGxpc3Rfbm9k
ZSAqKikoJihoKS0+Zmlyc3QpKSkpKV9yX2FfcF9fdikpOyB9IHdoaWxlICgwKTsgfSB3aGls
ZSAoMCk7IH0gd2hpbGUgKDApOyB9IHdoaWxlICgwKTsKIGlmIChmaXJzdCkKICBkbyB7IGRv
IHsgZXh0ZXJuIHZvaWQgX19jb21waWxldGltZV9hc3NlcnRfNjcodm9pZCkgX19hdHRyaWJ1
dGVfXygoX19lcnJvcl9fKCJVbnN1cHBvcnRlZCBhY2Nlc3Mgc2l6ZSBmb3Ige1JFQUQsV1JJ
VEV9X09OQ0UoKS4iKSkpOyBpZiAoISgoc2l6ZW9mKGZpcnN0LT5wcHJldikgPT0gc2l6ZW9m
KGNoYXIpIHx8IHNpemVvZihmaXJzdC0+cHByZXYpID09IHNpemVvZihzaG9ydCkgfHwgc2l6
ZW9mKGZpcnN0LT5wcHJldikgPT0gc2l6ZW9mKGludCkgfHwgc2l6ZW9mKGZpcnN0LT5wcHJl
dikgPT0gc2l6ZW9mKGxvbmcpKSB8fCBzaXplb2YoZmlyc3QtPnBwcmV2KSA9PSBzaXplb2Yo
bG9uZyBsb25nKSkpIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzY3KCk7IH0gd2hpbGUgKDApOyBk
byB7ICoodm9sYXRpbGUgdHlwZW9mKGZpcnN0LT5wcHJldikgKikmKGZpcnN0LT5wcHJldikg
PSAoJm4tPm5leHQpOyB9IHdoaWxlICgwKTsgfSB3aGlsZSAoMCk7Cn0KIyA1ODcgIi4vaW5j
bHVkZS9saW51eC9yY3VsaXN0LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGhsaXN0X2FkZF90YWlsX3Jj
dShzdHJ1Y3QgaGxpc3Rfbm9kZSAqbiwKICAgICAgICAgIHN0cnVjdCBobGlzdF9oZWFkICpo
KQp7CiBzdHJ1Y3QgaGxpc3Rfbm9kZSAqaSwgKmxhc3QgPSAoKHZvaWQgKikwKTsKCgogZm9y
IChpID0gaC0+Zmlyc3Q7IGk7IGkgPSBpLT5uZXh0KQogIGxhc3QgPSBpOwoKIGlmIChsYXN0
KSB7CiAgbi0+bmV4dCA9IGxhc3QtPm5leHQ7CiAgZG8geyBkbyB7IGV4dGVybiB2b2lkIF9f
Y29tcGlsZXRpbWVfYXNzZXJ0XzY4KHZvaWQpIF9fYXR0cmlidXRlX18oKF9fZXJyb3JfXygi
VW5zdXBwb3J0ZWQgYWNjZXNzIHNpemUgZm9yIHtSRUFELFdSSVRFfV9PTkNFKCkuIikpKTsg
aWYgKCEoKHNpemVvZihuLT5wcHJldikgPT0gc2l6ZW9mKGNoYXIpIHx8IHNpemVvZihuLT5w
cHJldikgPT0gc2l6ZW9mKHNob3J0KSB8fCBzaXplb2Yobi0+cHByZXYpID09IHNpemVvZihp
bnQpIHx8IHNpemVvZihuLT5wcHJldikgPT0gc2l6ZW9mKGxvbmcpKSB8fCBzaXplb2Yobi0+
cHByZXYpID09IHNpemVvZihsb25nIGxvbmcpKSkgX19jb21waWxldGltZV9hc3NlcnRfNjgo
KTsgfSB3aGlsZSAoMCk7IGRvIHsgKih2b2xhdGlsZSB0eXBlb2Yobi0+cHByZXYpICopJihu
LT5wcHJldikgPSAoJmxhc3QtPm5leHQpOyB9IHdoaWxlICgwKTsgfSB3aGlsZSAoMCk7CiAg
ZG8geyB1aW50cHRyX3QgX3JfYV9wX192ID0gKHVpbnRwdHJfdCkobik7IDsgaWYgKF9fYnVp
bHRpbl9jb25zdGFudF9wKG4pICYmIChfcl9hX3BfX3YpID09ICh1aW50cHRyX3QpKCh2b2lk
ICopMCkpIGRvIHsgZG8geyBleHRlcm4gdm9pZCBfX2NvbXBpbGV0aW1lX2Fzc2VydF82OSh2
b2lkKSBfX2F0dHJpYnV0ZV9fKChfX2Vycm9yX18oIlVuc3VwcG9ydGVkIGFjY2VzcyBzaXpl
IGZvciB7UkVBRCxXUklURX1fT05DRSgpLiIpKSk7IGlmICghKChzaXplb2YoKCgqKChzdHJ1
Y3QgaGxpc3Rfbm9kZSAqKikoJihsYXN0KS0+bmV4dCkpKSkpID09IHNpemVvZihjaGFyKSB8
fCBzaXplb2YoKCgqKChzdHJ1Y3QgaGxpc3Rfbm9kZSAqKikoJihsYXN0KS0+bmV4dCkpKSkp
ID09IHNpemVvZihzaG9ydCkgfHwgc2l6ZW9mKCgoKigoc3RydWN0IGhsaXN0X25vZGUgKiop
KCYobGFzdCktPm5leHQpKSkpKSA9PSBzaXplb2YoaW50KSB8fCBzaXplb2YoKCgqKChzdHJ1
Y3QgaGxpc3Rfbm9kZSAqKikoJihsYXN0KS0+bmV4dCkpKSkpID09IHNpemVvZihsb25nKSkg
fHwgc2l6ZW9mKCgoKigoc3RydWN0IGhsaXN0X25vZGUgKiopKCYobGFzdCktPm5leHQpKSkp
KSA9PSBzaXplb2YobG9uZyBsb25nKSkpIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzY5KCk7IH0g
d2hpbGUgKDApOyBkbyB7ICoodm9sYXRpbGUgdHlwZW9mKCgoKigoc3RydWN0IGhsaXN0X25v
ZGUgKiopKCYobGFzdCktPm5leHQpKSkpKSAqKSYoKCgqKChzdHJ1Y3QgaGxpc3Rfbm9kZSAq
KikoJihsYXN0KS0+bmV4dCkpKSkpID0gKCh0eXBlb2YoKCooKHN0cnVjdCBobGlzdF9ub2Rl
ICoqKSgmKGxhc3QpLT5uZXh0KSkpKSkoX3JfYV9wX192KSk7IH0gd2hpbGUgKDApOyB9IHdo
aWxlICgwKTsgZWxzZSBkbyB7IGRvIHsgZXh0ZXJuIHZvaWQgX19jb21waWxldGltZV9hc3Nl
cnRfNzAodm9pZCkgX19hdHRyaWJ1dGVfXygoX19lcnJvcl9fKCJOZWVkIG5hdGl2ZSB3b3Jk
IHNpemVkIHN0b3Jlcy9sb2FkcyBmb3IgYXRvbWljaXR5LiIpKSk7IGlmICghKChzaXplb2Yo
KiYoKigoc3RydWN0IGhsaXN0X25vZGUgKiopKCYobGFzdCktPm5leHQpKSkpID09IHNpemVv
ZihjaGFyKSB8fCBzaXplb2YoKiYoKigoc3RydWN0IGhsaXN0X25vZGUgKiopKCYobGFzdCkt
Pm5leHQpKSkpID09IHNpemVvZihzaG9ydCkgfHwgc2l6ZW9mKComKCooKHN0cnVjdCBobGlz
dF9ub2RlICoqKSgmKGxhc3QpLT5uZXh0KSkpKSA9PSBzaXplb2YoaW50KSB8fCBzaXplb2Yo
KiYoKigoc3RydWN0IGhsaXN0X25vZGUgKiopKCYobGFzdCktPm5leHQpKSkpID09IHNpemVv
Zihsb25nKSkpKSBfX2NvbXBpbGV0aW1lX2Fzc2VydF83MCgpOyB9IHdoaWxlICgwKTsgX19h
c21fXyBfX3ZvbGF0aWxlX18gKCJsd3N5bmMiICIgIiA6IDogOiJtZW1vcnkiKTsgZG8geyBk
byB7IGV4dGVybiB2b2lkIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzcxKHZvaWQpIF9fYXR0cmli
dXRlX18oKF9fZXJyb3JfXygiVW5zdXBwb3J0ZWQgYWNjZXNzIHNpemUgZm9yIHtSRUFELFdS
SVRFfV9PTkNFKCkuIikpKTsgaWYgKCEoKHNpemVvZigqJigqKChzdHJ1Y3QgaGxpc3Rfbm9k
ZSAqKikoJihsYXN0KS0+bmV4dCkpKSkgPT0gc2l6ZW9mKGNoYXIpIHx8IHNpemVvZigqJigq
KChzdHJ1Y3QgaGxpc3Rfbm9kZSAqKikoJihsYXN0KS0+bmV4dCkpKSkgPT0gc2l6ZW9mKHNo
b3J0KSB8fCBzaXplb2YoKiYoKigoc3RydWN0IGhsaXN0X25vZGUgKiopKCYobGFzdCktPm5l
eHQpKSkpID09IHNpemVvZihpbnQpIHx8IHNpemVvZigqJigqKChzdHJ1Y3QgaGxpc3Rfbm9k
ZSAqKikoJihsYXN0KS0+bmV4dCkpKSkgPT0gc2l6ZW9mKGxvbmcpKSB8fCBzaXplb2YoKiYo
Kigoc3RydWN0IGhsaXN0X25vZGUgKiopKCYobGFzdCktPm5leHQpKSkpID09IHNpemVvZihs
b25nIGxvbmcpKSkgX19jb21waWxldGltZV9hc3NlcnRfNzEoKTsgfSB3aGlsZSAoMCk7IGRv
IHsgKih2b2xhdGlsZSB0eXBlb2YoKiYoKigoc3RydWN0IGhsaXN0X25vZGUgKiopKCYobGFz
dCktPm5leHQpKSkpICopJigqJigqKChzdHJ1Y3QgaGxpc3Rfbm9kZSAqKikoJihsYXN0KS0+
bmV4dCkpKSkgPSAoKHR5cGVvZigqKCh0eXBlb2YoKCooKHN0cnVjdCBobGlzdF9ub2RlICoq
KSgmKGxhc3QpLT5uZXh0KSkpKSlfcl9hX3BfX3YpKSAqKSgodHlwZW9mKCgqKChzdHJ1Y3Qg
aGxpc3Rfbm9kZSAqKikoJihsYXN0KS0+bmV4dCkpKSkpX3JfYV9wX192KSk7IH0gd2hpbGUg
KDApOyB9IHdoaWxlICgwKTsgfSB3aGlsZSAoMCk7IH0gd2hpbGUgKDApOwogfSBlbHNlIHsK
ICBobGlzdF9hZGRfaGVhZF9yY3UobiwgaCk7CiB9Cn0KIyA2MjMgIi4vaW5jbHVkZS9saW51
eC9yY3VsaXN0LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGhsaXN0X2FkZF9iZWZvcmVfcmN1KHN0cnVj
dCBobGlzdF9ub2RlICpuLAogICAgIHN0cnVjdCBobGlzdF9ub2RlICpuZXh0KQp7CiBkbyB7
IGRvIHsgZXh0ZXJuIHZvaWQgX19jb21waWxldGltZV9hc3NlcnRfNzIodm9pZCkgX19hdHRy
aWJ1dGVfXygoX19lcnJvcl9fKCJVbnN1cHBvcnRlZCBhY2Nlc3Mgc2l6ZSBmb3Ige1JFQUQs
V1JJVEV9X09OQ0UoKS4iKSkpOyBpZiAoISgoc2l6ZW9mKG4tPnBwcmV2KSA9PSBzaXplb2Yo
Y2hhcikgfHwgc2l6ZW9mKG4tPnBwcmV2KSA9PSBzaXplb2Yoc2hvcnQpIHx8IHNpemVvZihu
LT5wcHJldikgPT0gc2l6ZW9mKGludCkgfHwgc2l6ZW9mKG4tPnBwcmV2KSA9PSBzaXplb2Yo
bG9uZykpIHx8IHNpemVvZihuLT5wcHJldikgPT0gc2l6ZW9mKGxvbmcgbG9uZykpKSBfX2Nv
bXBpbGV0aW1lX2Fzc2VydF83MigpOyB9IHdoaWxlICgwKTsgZG8geyAqKHZvbGF0aWxlIHR5
cGVvZihuLT5wcHJldikgKikmKG4tPnBwcmV2KSA9IChuZXh0LT5wcHJldik7IH0gd2hpbGUg
KDApOyB9IHdoaWxlICgwKTsKIG4tPm5leHQgPSBuZXh0OwogZG8geyB1aW50cHRyX3QgX3Jf
YV9wX192ID0gKHVpbnRwdHJfdCkobik7IDsgaWYgKF9fYnVpbHRpbl9jb25zdGFudF9wKG4p
ICYmIChfcl9hX3BfX3YpID09ICh1aW50cHRyX3QpKCh2b2lkICopMCkpIGRvIHsgZG8geyBl
eHRlcm4gdm9pZCBfX2NvbXBpbGV0aW1lX2Fzc2VydF83Myh2b2lkKSBfX2F0dHJpYnV0ZV9f
KChfX2Vycm9yX18oIlVuc3VwcG9ydGVkIGFjY2VzcyBzaXplIGZvciB7UkVBRCxXUklURX1f
T05DRSgpLiIpKSk7IGlmICghKChzaXplb2YoKCgqKChzdHJ1Y3QgaGxpc3Rfbm9kZSAqKiko
KG4pLT5wcHJldikpKSkpID09IHNpemVvZihjaGFyKSB8fCBzaXplb2YoKCgqKChzdHJ1Y3Qg
aGxpc3Rfbm9kZSAqKikoKG4pLT5wcHJldikpKSkpID09IHNpemVvZihzaG9ydCkgfHwgc2l6
ZW9mKCgoKigoc3RydWN0IGhsaXN0X25vZGUgKiopKChuKS0+cHByZXYpKSkpKSA9PSBzaXpl
b2YoaW50KSB8fCBzaXplb2YoKCgqKChzdHJ1Y3QgaGxpc3Rfbm9kZSAqKikoKG4pLT5wcHJl
dikpKSkpID09IHNpemVvZihsb25nKSkgfHwgc2l6ZW9mKCgoKigoc3RydWN0IGhsaXN0X25v
ZGUgKiopKChuKS0+cHByZXYpKSkpKSA9PSBzaXplb2YobG9uZyBsb25nKSkpIF9fY29tcGls
ZXRpbWVfYXNzZXJ0XzczKCk7IH0gd2hpbGUgKDApOyBkbyB7ICoodm9sYXRpbGUgdHlwZW9m
KCgoKigoc3RydWN0IGhsaXN0X25vZGUgKiopKChuKS0+cHByZXYpKSkpKSAqKSYoKCgqKChz
dHJ1Y3QgaGxpc3Rfbm9kZSAqKikoKG4pLT5wcHJldikpKSkpID0gKCh0eXBlb2YoKCooKHN0
cnVjdCBobGlzdF9ub2RlICoqKSgobiktPnBwcmV2KSkpKSkoX3JfYV9wX192KSk7IH0gd2hp
bGUgKDApOyB9IHdoaWxlICgwKTsgZWxzZSBkbyB7IGRvIHsgZXh0ZXJuIHZvaWQgX19jb21w
aWxldGltZV9hc3NlcnRfNzQodm9pZCkgX19hdHRyaWJ1dGVfXygoX19lcnJvcl9fKCJOZWVk
IG5hdGl2ZSB3b3JkIHNpemVkIHN0b3Jlcy9sb2FkcyBmb3IgYXRvbWljaXR5LiIpKSk7IGlm
ICghKChzaXplb2YoKiYoKigoc3RydWN0IGhsaXN0X25vZGUgKiopKChuKS0+cHByZXYpKSkp
ID09IHNpemVvZihjaGFyKSB8fCBzaXplb2YoKiYoKigoc3RydWN0IGhsaXN0X25vZGUgKiop
KChuKS0+cHByZXYpKSkpID09IHNpemVvZihzaG9ydCkgfHwgc2l6ZW9mKComKCooKHN0cnVj
dCBobGlzdF9ub2RlICoqKSgobiktPnBwcmV2KSkpKSA9PSBzaXplb2YoaW50KSB8fCBzaXpl
b2YoKiYoKigoc3RydWN0IGhsaXN0X25vZGUgKiopKChuKS0+cHByZXYpKSkpID09IHNpemVv
Zihsb25nKSkpKSBfX2NvbXBpbGV0aW1lX2Fzc2VydF83NCgpOyB9IHdoaWxlICgwKTsgX19h
c21fXyBfX3ZvbGF0aWxlX18gKCJsd3N5bmMiICIgIiA6IDogOiJtZW1vcnkiKTsgZG8geyBk
byB7IGV4dGVybiB2b2lkIF9fY29tcGlsZXRpbWVfYXNzZXJ0Xzc1KHZvaWQpIF9fYXR0cmli
dXRlX18oKF9fZXJyb3JfXygiVW5zdXBwb3J0ZWQgYWNjZXNzIHNpemUgZm9yIHtSRUFELFdS
SVRFfV9PTkNFKCkuIikpKTsgaWYgKCEoKHNpemVvZigqJigqKChzdHJ1Y3QgaGxpc3Rfbm9k
ZSAqKikoKG4pLT5wcHJldikpKSkgPT0gc2l6ZW9mKGNoYXIpIHx8IHNpemVvZigqJigqKChz
dHJ1Y3QgaGxpc3Rfbm9kZSAqKikoKG4pLT5wcHJldikpKSkgPT0gc2l6ZW9mKHNob3J0KSB8
fCBzaXplb2YoKiYoKigoc3RydWN0IGhsaXN0X25vZGUgKiopKChuKS0+cHByZXYpKSkpID09
IHNpemVvZihpbnQpIHx8IHNpemVvZigqJigqKChzdHJ1Y3QgaGxpc3Rfbm9kZSAqKikoKG4p
LT5wcHJldikpKSkgPT0gc2l6ZW9mKGxvbmcpKSB8fCBzaXplb2YoKiYoKigoc3RydWN0IGhs
aXN0X25vZGUgKiopKChuKS0+cHByZXYpKSkpID09IHNpemVvZihsb25nIGxvbmcpKSkgX19j
b21waWxldGltZV9hc3NlcnRfNzUoKTsgfSB3aGlsZSAoMCk7IGRvIHsgKih2b2xhdGlsZSB0
eXBlb2YoKiYoKigoc3RydWN0IGhsaXN0X25vZGUgKiopKChuKS0+cHByZXYpKSkpICopJigq
JigqKChzdHJ1Y3QgaGxpc3Rfbm9kZSAqKikoKG4pLT5wcHJldikpKSkgPSAoKHR5cGVvZigq
KCh0eXBlb2YoKCooKHN0cnVjdCBobGlzdF9ub2RlICoqKSgobiktPnBwcmV2KSkpKSlfcl9h
X3BfX3YpKSAqKSgodHlwZW9mKCgqKChzdHJ1Y3QgaGxpc3Rfbm9kZSAqKikoKG4pLT5wcHJl
dikpKSkpX3JfYV9wX192KSk7IH0gd2hpbGUgKDApOyB9IHdoaWxlICgwKTsgfSB3aGlsZSAo
MCk7IH0gd2hpbGUgKDApOwogZG8geyBkbyB7IGV4dGVybiB2b2lkIF9fY29tcGlsZXRpbWVf
YXNzZXJ0Xzc2KHZvaWQpIF9fYXR0cmlidXRlX18oKF9fZXJyb3JfXygiVW5zdXBwb3J0ZWQg
YWNjZXNzIHNpemUgZm9yIHtSRUFELFdSSVRFfV9PTkNFKCkuIikpKTsgaWYgKCEoKHNpemVv
ZihuZXh0LT5wcHJldikgPT0gc2l6ZW9mKGNoYXIpIHx8IHNpemVvZihuZXh0LT5wcHJldikg
PT0gc2l6ZW9mKHNob3J0KSB8fCBzaXplb2YobmV4dC0+cHByZXYpID09IHNpemVvZihpbnQp
IHx8IHNpemVvZihuZXh0LT5wcHJldikgPT0gc2l6ZW9mKGxvbmcpKSB8fCBzaXplb2YobmV4
dC0+cHByZXYpID09IHNpemVvZihsb25nIGxvbmcpKSkgX19jb21waWxldGltZV9hc3NlcnRf
NzYoKTsgfSB3aGlsZSAoMCk7IGRvIHsgKih2b2xhdGlsZSB0eXBlb2YobmV4dC0+cHByZXYp
ICopJihuZXh0LT5wcHJldikgPSAoJm4tPm5leHQpOyB9IHdoaWxlICgwKTsgfSB3aGlsZSAo
MCk7Cn0KIyA2NTAgIi4vaW5jbHVkZS9saW51eC9yY3VsaXN0LmgiCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lk
IGhsaXN0X2FkZF9iZWhpbmRfcmN1KHN0cnVjdCBobGlzdF9ub2RlICpuLAogICAgIHN0cnVj
dCBobGlzdF9ub2RlICpwcmV2KQp7CiBuLT5uZXh0ID0gcHJldi0+bmV4dDsKIGRvIHsgZG8g
eyBleHRlcm4gdm9pZCBfX2NvbXBpbGV0aW1lX2Fzc2VydF83Nyh2b2lkKSBfX2F0dHJpYnV0
ZV9fKChfX2Vycm9yX18oIlVuc3VwcG9ydGVkIGFjY2VzcyBzaXplIGZvciB7UkVBRCxXUklU
RX1fT05DRSgpLiIpKSk7IGlmICghKChzaXplb2Yobi0+cHByZXYpID09IHNpemVvZihjaGFy
KSB8fCBzaXplb2Yobi0+cHByZXYpID09IHNpemVvZihzaG9ydCkgfHwgc2l6ZW9mKG4tPnBw
cmV2KSA9PSBzaXplb2YoaW50KSB8fCBzaXplb2Yobi0+cHByZXYpID09IHNpemVvZihsb25n
KSkgfHwgc2l6ZW9mKG4tPnBwcmV2KSA9PSBzaXplb2YobG9uZyBsb25nKSkpIF9fY29tcGls
ZXRpbWVfYXNzZXJ0Xzc3KCk7IH0gd2hpbGUgKDApOyBkbyB7ICoodm9sYXRpbGUgdHlwZW9m
KG4tPnBwcmV2KSAqKSYobi0+cHByZXYpID0gKCZwcmV2LT5uZXh0KTsgfSB3aGlsZSAoMCk7
IH0gd2hpbGUgKDApOwogZG8geyB1aW50cHRyX3QgX3JfYV9wX192ID0gKHVpbnRwdHJfdCko
bik7IDsgaWYgKF9fYnVpbHRpbl9jb25zdGFudF9wKG4pICYmIChfcl9hX3BfX3YpID09ICh1
aW50cHRyX3QpKCh2b2lkICopMCkpIGRvIHsgZG8geyBleHRlcm4gdm9pZCBfX2NvbXBpbGV0
aW1lX2Fzc2VydF83OCh2b2lkKSBfX2F0dHJpYnV0ZV9fKChfX2Vycm9yX18oIlVuc3VwcG9y
dGVkIGFjY2VzcyBzaXplIGZvciB7UkVBRCxXUklURX1fT05DRSgpLiIpKSk7IGlmICghKChz
aXplb2YoKCgqKChzdHJ1Y3QgaGxpc3Rfbm9kZSAqKikoJihwcmV2KS0+bmV4dCkpKSkpID09
IHNpemVvZihjaGFyKSB8fCBzaXplb2YoKCgqKChzdHJ1Y3QgaGxpc3Rfbm9kZSAqKikoJihw
cmV2KS0+bmV4dCkpKSkpID09IHNpemVvZihzaG9ydCkgfHwgc2l6ZW9mKCgoKigoc3RydWN0
IGhsaXN0X25vZGUgKiopKCYocHJldiktPm5leHQpKSkpKSA9PSBzaXplb2YoaW50KSB8fCBz
aXplb2YoKCgqKChzdHJ1Y3QgaGxpc3Rfbm9kZSAqKikoJihwcmV2KS0+bmV4dCkpKSkpID09
IHNpemVvZihsb25nKSkgfHwgc2l6ZW9mKCgoKigoc3RydWN0IGhsaXN0X25vZGUgKiopKCYo
cHJldiktPm5leHQpKSkpKSA9PSBzaXplb2YobG9uZyBsb25nKSkpIF9fY29tcGlsZXRpbWVf
YXNzZXJ0Xzc4KCk7IH0gd2hpbGUgKDApOyBkbyB7ICoodm9sYXRpbGUgdHlwZW9mKCgoKigo
c3RydWN0IGhsaXN0X25vZGUgKiopKCYocHJldiktPm5leHQpKSkpKSAqKSYoKCgqKChzdHJ1
Y3QgaGxpc3Rfbm9kZSAqKikoJihwcmV2KS0+bmV4dCkpKSkpID0gKCh0eXBlb2YoKCooKHN0
cnVjdCBobGlzdF9ub2RlICoqKSgmKHByZXYpLT5uZXh0KSkpKSkoX3JfYV9wX192KSk7IH0g
d2hpbGUgKDApOyB9IHdoaWxlICgwKTsgZWxzZSBkbyB7IGRvIHsgZXh0ZXJuIHZvaWQgX19j
b21waWxldGltZV9hc3NlcnRfNzkodm9pZCkgX19hdHRyaWJ1dGVfXygoX19lcnJvcl9fKCJO
ZWVkIG5hdGl2ZSB3b3JkIHNpemVkIHN0b3Jlcy9sb2FkcyBmb3IgYXRvbWljaXR5LiIpKSk7
IGlmICghKChzaXplb2YoKiYoKigoc3RydWN0IGhsaXN0X25vZGUgKiopKCYocHJldiktPm5l
eHQpKSkpID09IHNpemVvZihjaGFyKSB8fCBzaXplb2YoKiYoKigoc3RydWN0IGhsaXN0X25v
ZGUgKiopKCYocHJldiktPm5leHQpKSkpID09IHNpemVvZihzaG9ydCkgfHwgc2l6ZW9mKCom
KCooKHN0cnVjdCBobGlzdF9ub2RlICoqKSgmKHByZXYpLT5uZXh0KSkpKSA9PSBzaXplb2Yo
aW50KSB8fCBzaXplb2YoKiYoKigoc3RydWN0IGhsaXN0X25vZGUgKiopKCYocHJldiktPm5l
eHQpKSkpID09IHNpemVvZihsb25nKSkpKSBfX2NvbXBpbGV0aW1lX2Fzc2VydF83OSgpOyB9
IHdoaWxlICgwKTsgX19hc21fXyBfX3ZvbGF0aWxlX18gKCJsd3N5bmMiICIgIiA6IDogOiJt
ZW1vcnkiKTsgZG8geyBkbyB7IGV4dGVybiB2b2lkIF9fY29tcGlsZXRpbWVfYXNzZXJ0Xzgw
KHZvaWQpIF9fYXR0cmlidXRlX18oKF9fZXJyb3JfXygiVW5zdXBwb3J0ZWQgYWNjZXNzIHNp
emUgZm9yIHtSRUFELFdSSVRFfV9PTkNFKCkuIikpKTsgaWYgKCEoKHNpemVvZigqJigqKChz
dHJ1Y3QgaGxpc3Rfbm9kZSAqKikoJihwcmV2KS0+bmV4dCkpKSkgPT0gc2l6ZW9mKGNoYXIp
IHx8IHNpemVvZigqJigqKChzdHJ1Y3QgaGxpc3Rfbm9kZSAqKikoJihwcmV2KS0+bmV4dCkp
KSkgPT0gc2l6ZW9mKHNob3J0KSB8fCBzaXplb2YoKiYoKigoc3RydWN0IGhsaXN0X25vZGUg
KiopKCYocHJldiktPm5leHQpKSkpID09IHNpemVvZihpbnQpIHx8IHNpemVvZigqJigqKChz
dHJ1Y3QgaGxpc3Rfbm9kZSAqKikoJihwcmV2KS0+bmV4dCkpKSkgPT0gc2l6ZW9mKGxvbmcp
KSB8fCBzaXplb2YoKiYoKigoc3RydWN0IGhsaXN0X25vZGUgKiopKCYocHJldiktPm5leHQp
KSkpID09IHNpemVvZihsb25nIGxvbmcpKSkgX19jb21waWxldGltZV9hc3NlcnRfODAoKTsg
fSB3aGlsZSAoMCk7IGRvIHsgKih2b2xhdGlsZSB0eXBlb2YoKiYoKigoc3RydWN0IGhsaXN0
X25vZGUgKiopKCYocHJldiktPm5leHQpKSkpICopJigqJigqKChzdHJ1Y3QgaGxpc3Rfbm9k
ZSAqKikoJihwcmV2KS0+bmV4dCkpKSkgPSAoKHR5cGVvZigqKCh0eXBlb2YoKCooKHN0cnVj
dCBobGlzdF9ub2RlICoqKSgmKHByZXYpLT5uZXh0KSkpKSlfcl9hX3BfX3YpKSAqKSgodHlw
ZW9mKCgqKChzdHJ1Y3QgaGxpc3Rfbm9kZSAqKikoJihwcmV2KS0+bmV4dCkpKSkpX3JfYV9w
X192KSk7IH0gd2hpbGUgKDApOyB9IHdoaWxlICgwKTsgfSB3aGlsZSAoMCk7IH0gd2hpbGUg
KDApOwogaWYgKG4tPm5leHQpCiAgZG8geyBkbyB7IGV4dGVybiB2b2lkIF9fY29tcGlsZXRp
bWVfYXNzZXJ0XzgxKHZvaWQpIF9fYXR0cmlidXRlX18oKF9fZXJyb3JfXygiVW5zdXBwb3J0
ZWQgYWNjZXNzIHNpemUgZm9yIHtSRUFELFdSSVRFfV9PTkNFKCkuIikpKTsgaWYgKCEoKHNp
emVvZihuLT5uZXh0LT5wcHJldikgPT0gc2l6ZW9mKGNoYXIpIHx8IHNpemVvZihuLT5uZXh0
LT5wcHJldikgPT0gc2l6ZW9mKHNob3J0KSB8fCBzaXplb2Yobi0+bmV4dC0+cHByZXYpID09
IHNpemVvZihpbnQpIHx8IHNpemVvZihuLT5uZXh0LT5wcHJldikgPT0gc2l6ZW9mKGxvbmcp
KSB8fCBzaXplb2Yobi0+bmV4dC0+cHByZXYpID09IHNpemVvZihsb25nIGxvbmcpKSkgX19j
b21waWxldGltZV9hc3NlcnRfODEoKTsgfSB3aGlsZSAoMCk7IGRvIHsgKih2b2xhdGlsZSB0
eXBlb2Yobi0+bmV4dC0+cHByZXYpICopJihuLT5uZXh0LT5wcHJldikgPSAoJm4tPm5leHQp
OyB9IHdoaWxlICgwKTsgfSB3aGlsZSAoMCk7Cn0KIyA2ICIuL2luY2x1ZGUvbGludXgvcGlk
LmgiIDIKIyAxICIuL2luY2x1ZGUvbGludXgvd2FpdC5oIiAxCiMgOSAiLi9pbmNsdWRlL2xp
bnV4L3dhaXQuaCIKIyAxICIuL2luY2x1ZGUvbGludXgvc3BpbmxvY2suaCIgMQojIDYwICIu
L2luY2x1ZGUvbGludXgvc3BpbmxvY2suaCIKIyAxICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRl
L2FzbS9tbWlvd2IuaCIgMQojIDE2ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9tbWlv
d2IuaCIKIyAxICIuL2luY2x1ZGUvYXNtLWdlbmVyaWMvbW1pb3diLmgiIDEKIyAzNSAiLi9p
bmNsdWRlL2FzbS1nZW5lcmljL21taW93Yi5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBtbWlvd2Jfc2V0
X3BlbmRpbmcodm9pZCkKewogc3RydWN0IG1taW93Yl9zdGF0ZSAqbXMgPSAoJmxvY2FsX3Bh
Y2EtPm1taW93Yl9zdGF0ZSk7CiBtcy0+bW1pb3diX3BlbmRpbmcgPSBtcy0+bmVzdGluZ19j
b3VudDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgbW1pb3diX3NwaW5fbG9jayh2b2lkKQp7CiBzdHJ1
Y3QgbW1pb3diX3N0YXRlICptcyA9ICgmbG9jYWxfcGFjYS0+bW1pb3diX3N0YXRlKTsKIG1z
LT5uZXN0aW5nX2NvdW50Kys7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIG1taW93Yl9zcGluX3VubG9j
ayh2b2lkKQp7CiBzdHJ1Y3QgbW1pb3diX3N0YXRlICptcyA9ICgmbG9jYWxfcGFjYS0+bW1p
b3diX3N0YXRlKTsKCiBpZiAoX19idWlsdGluX2V4cGVjdCghIShtcy0+bW1pb3diX3BlbmRp
bmcpLCAwKSkgewogIG1zLT5tbWlvd2JfcGVuZGluZyA9IDA7CiAgX19hc21fXyBfX3ZvbGF0
aWxlX18gKCJzeW5jIiA6IDogOiAibWVtb3J5Iik7CiB9CgogbXMtPm5lc3RpbmdfY291bnQt
LTsKfQojIDE3ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9tbWlvd2IuaCIgMgojIDYx
ICIuL2luY2x1ZGUvbGludXgvc3BpbmxvY2suaCIgMgojIDg5ICIuL2luY2x1ZGUvbGludXgv
c3BpbmxvY2suaCIKIyAxICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9zcGlubG9jay5o
IiAxCiMgMTggIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL3NwaW5sb2NrLmgiCiMgMSAi
Li9pbmNsdWRlL2xpbnV4L2p1bXBfbGFiZWwuaCIgMQojIDc5ICIuL2luY2x1ZGUvbGludXgv
anVtcF9sYWJlbC5oIgpleHRlcm4gYm9vbCBzdGF0aWNfa2V5X2luaXRpYWxpemVkOwojIDEx
MCAiLi9pbmNsdWRlL2xpbnV4L2p1bXBfbGFiZWwuaCIKc3RydWN0IHN0YXRpY19rZXkgewog
YXRvbWljX3QgZW5hYmxlZDsKfTsKIyAxODQgIi4vaW5jbHVkZS9saW51eC9qdW1wX2xhYmVs
LmgiCmVudW0ganVtcF9sYWJlbF90eXBlIHsKIEpVTVBfTEFCRUxfTk9QID0gMCwKIEpVTVBf
TEFCRUxfSk1QLAp9OwoKc3RydWN0IG1vZHVsZTsKIyAyNTIgIi4vaW5jbHVkZS9saW51eC9q
dW1wX2xhYmVsLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgc3RhdGljX2tleV9jb3VudChzdHJ1Y3Qgc3Rh
dGljX2tleSAqa2V5KQp7CiByZXR1cm4gYXRvbWljX3JlYWQoJmtleS0+ZW5hYmxlZCk7Cn0K
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHZvaWQganVt
cF9sYWJlbF9pbml0KHZvaWQpCnsKIHN0YXRpY19rZXlfaW5pdGlhbGl6ZWQgPSB0cnVlOwp9
CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBib29sIHN0
YXRpY19rZXlfZmFsc2Uoc3RydWN0IHN0YXRpY19rZXkgKmtleSkKewogaWYgKF9fYnVpbHRp
bl9leHBlY3QoISEoc3RhdGljX2tleV9jb3VudChrZXkpID4gMCksIDApKQogIHJldHVybiB0
cnVlOwogcmV0dXJuIGZhbHNlOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdh
eXNfaW5saW5lX18pKSBib29sIHN0YXRpY19rZXlfdHJ1ZShzdHJ1Y3Qgc3RhdGljX2tleSAq
a2V5KQp7CiBpZiAoX19idWlsdGluX2V4cGVjdCghIShzdGF0aWNfa2V5X2NvdW50KGtleSkg
PiAwKSwgMSkpCiAgcmV0dXJuIHRydWU7CiByZXR1cm4gZmFsc2U7Cn0KCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2
b2lkIHN0YXRpY19rZXlfc2xvd19pbmMoc3RydWN0IHN0YXRpY19rZXkgKmtleSkKewogKHsg
aW50IF9fcmV0X3dhcm5fb24gPSAhISghc3RhdGljX2tleV9pbml0aWFsaXplZCk7IGlmIChf
X2J1aWx0aW5fZXhwZWN0KCEhKF9fcmV0X3dhcm5fb24pLCAwKSkgZG8geyBkbyB7IH0gd2hp
bGUoMCk7IF9fd2Fybl9wcmludGsoIiVzKCk6IHN0YXRpYyBrZXkgJyVwUycgdXNlZCBiZWZv
cmUgY2FsbCB0byBqdW1wX2xhYmVsX2luaXQoKSIsIF9fZnVuY19fLCAoa2V5KSk7IF9fYXNt
X18gX192b2xhdGlsZV9fKCAiMToJIiAidHdpIDMxLCAwLCAwIiAiXG4iICIuc2VjdGlvbiBf
X2J1Z190YWJsZSxcImF3XCJcbiIgIjI6XHQiICIuOGJ5dGUiICIgIiAiMWIsICUwXG4iICJc
dC5zaG9ydCAlMSwgJTJcbiIgIi5vcmcgMmIrJTNcbiIgIi5wcmV2aW91c1xuIiA6IDogImki
ICgiLi9pbmNsdWRlL2xpbnV4L2p1bXBfbGFiZWwuaCIpLCAiaSIgKDI3OCksICJpIiAoKDEg
PDwgMCkgfCAoKDEgPDwgMykgfCAoKDkpIDw8IDgpKSksICJpIiAoc2l6ZW9mKHN0cnVjdCBi
dWdfZW50cnkpKSk7IGRvIHsgfSB3aGlsZSgwKTsgfSB3aGlsZSAoMCk7IF9fYnVpbHRpbl9l
eHBlY3QoISEoX19yZXRfd2Fybl9vbiksIDApOyB9KTsKIGF0b21pY19pbmMoJmtleS0+ZW5h
YmxlZCk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHN0YXRpY19rZXlfc2xvd19kZWMoc3RydWN0IHN0
YXRpY19rZXkgKmtleSkKewogKHsgaW50IF9fcmV0X3dhcm5fb24gPSAhISghc3RhdGljX2tl
eV9pbml0aWFsaXplZCk7IGlmIChfX2J1aWx0aW5fZXhwZWN0KCEhKF9fcmV0X3dhcm5fb24p
LCAwKSkgZG8geyBkbyB7IH0gd2hpbGUoMCk7IF9fd2Fybl9wcmludGsoIiVzKCk6IHN0YXRp
YyBrZXkgJyVwUycgdXNlZCBiZWZvcmUgY2FsbCB0byBqdW1wX2xhYmVsX2luaXQoKSIsIF9f
ZnVuY19fLCAoa2V5KSk7IF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJIiAidHdpIDMxLCAw
LCAwIiAiXG4iICIuc2VjdGlvbiBfX2J1Z190YWJsZSxcImF3XCJcbiIgIjI6XHQiICIuOGJ5
dGUiICIgIiAiMWIsICUwXG4iICJcdC5zaG9ydCAlMSwgJTJcbiIgIi5vcmcgMmIrJTNcbiIg
Ii5wcmV2aW91c1xuIiA6IDogImkiICgiLi9pbmNsdWRlL2xpbnV4L2p1bXBfbGFiZWwuaCIp
LCAiaSIgKDI4NCksICJpIiAoKDEgPDwgMCkgfCAoKDEgPDwgMykgfCAoKDkpIDw8IDgpKSks
ICJpIiAoc2l6ZW9mKHN0cnVjdCBidWdfZW50cnkpKSk7IGRvIHsgfSB3aGlsZSgwKTsgfSB3
aGlsZSAoMCk7IF9fYnVpbHRpbl9leHBlY3QoISEoX19yZXRfd2Fybl9vbiksIDApOyB9KTsK
IGF0b21pY19kZWMoJmtleS0+ZW5hYmxlZCk7Cn0KCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQganVtcF9s
YWJlbF90ZXh0X3Jlc2VydmVkKHZvaWQgKnN0YXJ0LCB2b2lkICplbmQpCnsKIHJldHVybiAw
Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgdm9pZCBqdW1wX2xhYmVsX2xvY2sodm9pZCkge30Kc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IHZvaWQganVtcF9sYWJlbF91bmxvY2sodm9pZCkge30KCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQganVtcF9s
YWJlbF9hcHBseV9ub3BzKHN0cnVjdCBtb2R1bGUgKm1vZCkKewogcmV0dXJuIDA7Cn0KCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSB2b2lkIHN0YXRpY19rZXlfZW5hYmxlKHN0cnVjdCBzdGF0aWNfa2V5ICprZXkp
CnsKICh7IGludCBfX3JldF93YXJuX29uID0gISEoIXN0YXRpY19rZXlfaW5pdGlhbGl6ZWQp
OyBpZiAoX19idWlsdGluX2V4cGVjdCghIShfX3JldF93YXJuX29uKSwgMCkpIGRvIHsgZG8g
eyB9IHdoaWxlKDApOyBfX3dhcm5fcHJpbnRrKCIlcygpOiBzdGF0aWMga2V5ICclcFMnIHVz
ZWQgYmVmb3JlIGNhbGwgdG8ganVtcF9sYWJlbF9pbml0KCkiLCBfX2Z1bmNfXywgKGtleSkp
OyBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CSIgInR3aSAzMSwgMCwgMCIgIlxuIiAiLnNl
Y3Rpb24gX19idWdfdGFibGUsXCJhd1wiXG4iICIyOlx0IiAiLjhieXRlIiAiICIgIjFiLCAl
MFxuIiAiXHQuc2hvcnQgJTEsICUyXG4iICIub3JnIDJiKyUzXG4iICIucHJldmlvdXNcbiIg
OiA6ICJpIiAoIi4vaW5jbHVkZS9saW51eC9qdW1wX2xhYmVsLmgiKSwgImkiICgzMDYpLCAi
aSIgKCgxIDw8IDApIHwgKCgxIDw8IDMpIHwgKCg5KSA8PCA4KSkpLCAiaSIgKHNpemVvZihz
dHJ1Y3QgYnVnX2VudHJ5KSkpOyBkbyB7IH0gd2hpbGUoMCk7IH0gd2hpbGUgKDApOyBfX2J1
aWx0aW5fZXhwZWN0KCEhKF9fcmV0X3dhcm5fb24pLCAwKTsgfSk7CgogaWYgKGF0b21pY19y
ZWFkKCZrZXktPmVuYWJsZWQpICE9IDApIHsKICAoeyBpbnQgX19yZXRfd2Fybl9vbiA9ICEh
KGF0b21pY19yZWFkKCZrZXktPmVuYWJsZWQpICE9IDEpOyBpZiAoX19idWlsdGluX2V4cGVj
dCghIShfX3JldF93YXJuX29uKSwgMCkpIF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJIiAi
dHdpIDMxLCAwLCAwIiAiXG4iICIuc2VjdGlvbiBfX2J1Z190YWJsZSxcImF3XCJcbiIgIjI6
XHQiICIuOGJ5dGUiICIgIiAiMWIsICUwXG4iICJcdC5zaG9ydCAlMSwgJTJcbiIgIi5vcmcg
MmIrJTNcbiIgIi5wcmV2aW91c1xuIiA6IDogImkiICgiLi9pbmNsdWRlL2xpbnV4L2p1bXBf
bGFiZWwuaCIpLCAiaSIgKDMwOSksICJpIiAoKDEgPDwgMCkgfCAoKDEgPDwgMSkgfCAoKDkp
IDw8IDgpKSksICJpIiAoc2l6ZW9mKHN0cnVjdCBidWdfZW50cnkpKSk7IF9fYnVpbHRpbl9l
eHBlY3QoISEoX19yZXRfd2Fybl9vbiksIDApOyB9KTsKICByZXR1cm47CiB9CiBhdG9taWNf
c2V0KCZrZXktPmVuYWJsZWQsIDEpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBzdGF0aWNfa2V5X2Rp
c2FibGUoc3RydWN0IHN0YXRpY19rZXkgKmtleSkKewogKHsgaW50IF9fcmV0X3dhcm5fb24g
PSAhISghc3RhdGljX2tleV9pbml0aWFsaXplZCk7IGlmIChfX2J1aWx0aW5fZXhwZWN0KCEh
KF9fcmV0X3dhcm5fb24pLCAwKSkgZG8geyBkbyB7IH0gd2hpbGUoMCk7IF9fd2Fybl9wcmlu
dGsoIiVzKCk6IHN0YXRpYyBrZXkgJyVwUycgdXNlZCBiZWZvcmUgY2FsbCB0byBqdW1wX2xh
YmVsX2luaXQoKSIsIF9fZnVuY19fLCAoa2V5KSk7IF9fYXNtX18gX192b2xhdGlsZV9fKCAi
MToJIiAidHdpIDMxLCAwLCAwIiAiXG4iICIuc2VjdGlvbiBfX2J1Z190YWJsZSxcImF3XCJc
biIgIjI6XHQiICIuOGJ5dGUiICIgIiAiMWIsICUwXG4iICJcdC5zaG9ydCAlMSwgJTJcbiIg
Ii5vcmcgMmIrJTNcbiIgIi5wcmV2aW91c1xuIiA6IDogImkiICgiLi9pbmNsdWRlL2xpbnV4
L2p1bXBfbGFiZWwuaCIpLCAiaSIgKDMxNyksICJpIiAoKDEgPDwgMCkgfCAoKDEgPDwgMykg
fCAoKDkpIDw8IDgpKSksICJpIiAoc2l6ZW9mKHN0cnVjdCBidWdfZW50cnkpKSk7IGRvIHsg
fSB3aGlsZSgwKTsgfSB3aGlsZSAoMCk7IF9fYnVpbHRpbl9leHBlY3QoISEoX19yZXRfd2Fy
bl9vbiksIDApOyB9KTsKCiBpZiAoYXRvbWljX3JlYWQoJmtleS0+ZW5hYmxlZCkgIT0gMSkg
ewogICh7IGludCBfX3JldF93YXJuX29uID0gISEoYXRvbWljX3JlYWQoJmtleS0+ZW5hYmxl
ZCkgIT0gMCk7IGlmIChfX2J1aWx0aW5fZXhwZWN0KCEhKF9fcmV0X3dhcm5fb24pLCAwKSkg
X19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgkiICJ0d2kgMzEsIDAsIDAiICJcbiIgIi5zZWN0
aW9uIF9fYnVnX3RhYmxlLFwiYXdcIlxuIiAiMjpcdCIgIi44Ynl0ZSIgIiAiICIxYiwgJTBc
biIgIlx0LnNob3J0ICUxLCAlMlxuIiAiLm9yZyAyYislM1xuIiAiLnByZXZpb3VzXG4iIDog
OiAiaSIgKCIuL2luY2x1ZGUvbGludXgvanVtcF9sYWJlbC5oIiksICJpIiAoMzIwKSwgImki
ICgoMSA8PCAwKSB8ICgoMSA8PCAxKSB8ICgoOSkgPDwgOCkpKSwgImkiIChzaXplb2Yoc3Ry
dWN0IGJ1Z19lbnRyeSkpKTsgX19idWlsdGluX2V4cGVjdCghIShfX3JldF93YXJuX29uKSwg
MCk7IH0pOwogIHJldHVybjsKIH0KIGF0b21pY19zZXQoJmtleS0+ZW5hYmxlZCwgMCk7Cn0K
IyAzNDYgIi4vaW5jbHVkZS9saW51eC9qdW1wX2xhYmVsLmgiCnN0cnVjdCBzdGF0aWNfa2V5
X3RydWUgewogc3RydWN0IHN0YXRpY19rZXkga2V5Owp9OwoKc3RydWN0IHN0YXRpY19rZXlf
ZmFsc2Ugewogc3RydWN0IHN0YXRpY19rZXkga2V5Owp9OwojIDM4NSAiLi9pbmNsdWRlL2xp
bnV4L2p1bXBfbGFiZWwuaCIKZXh0ZXJuIGJvb2wgX19fX3dyb25nX2JyYW5jaF9lcnJvcih2
b2lkKTsKIyAxOSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vc3BpbmxvY2suaCIgMgoK
CgojIDEgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2h2Y2FsbC5oIiAxCiMgNDAzICIu
L2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9odmNhbGwuaCIKbG9uZyBwbHBhcl9oY2FsbF9u
b3JldHModW5zaWduZWQgbG9uZyBvcGNvZGUsIC4uLik7CiMgNDE2ICIuL2FyY2gvcG93ZXJw
Yy9pbmNsdWRlL2FzbS9odmNhbGwuaCIKbG9uZyBwbHBhcl9oY2FsbCh1bnNpZ25lZCBsb25n
IG9wY29kZSwgdW5zaWduZWQgbG9uZyAqcmV0YnVmLCAuLi4pOwojIDQzMCAiLi9hcmNoL3Bv
d2VycGMvaW5jbHVkZS9hc20vaHZjYWxsLmgiCmxvbmcgcGxwYXJfaGNhbGxfcmF3KHVuc2ln
bmVkIGxvbmcgb3Bjb2RlLCB1bnNpZ25lZCBsb25nICpyZXRidWYsIC4uLik7CiMgNDQxICIu
L2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9odmNhbGwuaCIKbG9uZyBwbHBhcl9oY2FsbDko
dW5zaWduZWQgbG9uZyBvcGNvZGUsIHVuc2lnbmVkIGxvbmcgKnJldGJ1ZiwgLi4uKTsKbG9u
ZyBwbHBhcl9oY2FsbDlfcmF3KHVuc2lnbmVkIGxvbmcgb3Bjb2RlLCB1bnNpZ25lZCBsb25n
ICpyZXRidWYsIC4uLik7CgpzdHJ1Y3QgaHZjYWxsX21wcF9kYXRhIHsKIHVuc2lnbmVkIGxv
bmcgZW50aXRsZWRfbWVtOwogdW5zaWduZWQgbG9uZyBtYXBwZWRfbWVtOwogdW5zaWduZWQg
c2hvcnQgZ3JvdXBfbnVtOwogdW5zaWduZWQgc2hvcnQgcG9vbF9udW07CiB1bnNpZ25lZCBj
aGFyIG1lbV93ZWlnaHQ7CiB1bnNpZ25lZCBjaGFyIHVuYWxsb2NhdGVkX21lbV93ZWlnaHQ7
CiB1bnNpZ25lZCBsb25nIHVuYWxsb2NhdGVkX2VudGl0bGVtZW50OwogdW5zaWduZWQgbG9u
ZyBwb29sX3NpemU7CiBzaWduZWQgbG9uZyBsb2FuX3JlcXVlc3Q7CiB1bnNpZ25lZCBsb25n
IGJhY2tpbmdfbWVtOwp9OwoKaW50IGhfZ2V0X21wcChzdHJ1Y3QgaHZjYWxsX21wcF9kYXRh
ICopOwoKc3RydWN0IGh2Y2FsbF9tcHBfeF9kYXRhIHsKIHVuc2lnbmVkIGxvbmcgY29hbGVz
Y2VkX2J5dGVzOwogdW5zaWduZWQgbG9uZyBwb29sX2NvYWxlc2NlZF9ieXRlczsKIHVuc2ln
bmVkIGxvbmcgcG9vbF9wdXJyX2N5Y2xlczsKIHVuc2lnbmVkIGxvbmcgcG9vbF9zcHVycl9j
eWNsZXM7CiB1bnNpZ25lZCBsb25nIHJlc2VydmVkWzNdOwp9OwoKaW50IGhfZ2V0X21wcF94
KHN0cnVjdCBodmNhbGxfbXBwX3hfZGF0YSAqbXBwX3hfZGF0YSk7CgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5z
aWduZWQgaW50IGdldF9sb25nYnVzeV9tc2VjcyhpbnQgbG9uZ2J1c3lfcmMpCnsKIHN3aXRj
aCAobG9uZ2J1c3lfcmMpIHsKIGNhc2UgOTkwMDoKICByZXR1cm4gMTsKIGNhc2UgOTkwMToK
ICByZXR1cm4gMTA7CiBjYXNlIDk5MDI6CiAgcmV0dXJuIDEwMDsKIGNhc2UgOTkwMzoKICBy
ZXR1cm4gMTAwMDsKIGNhc2UgOTkwNDoKICByZXR1cm4gMTAwMDA7CiBjYXNlIDk5MDU6CiAg
cmV0dXJuIDEwMDAwMDsKIGRlZmF1bHQ6CiAgcmV0dXJuIDE7CiB9Cn0KCnN0cnVjdCBoX2Nw
dV9jaGFyX3Jlc3VsdCB7CiB1NjQgY2hhcmFjdGVyOwogdTY0IGJlaGF2aW91cjsKfTsKCgpz
dHJ1Y3QgaHZfZ3Vlc3Rfc3RhdGUgewogdTY0IHZlcnNpb247CiB1MzIgbHBpZDsKIHUzMiB2
Y3B1X3Rva2VuOwoKIHU2NCBscGNyOwogdTY0IHBjcjsKIHU2NCBhbW9yOwogdTY0IGRwZGVz
OwogdTY0IGhmc2NyOwogczY0IHRiX29mZnNldDsKIHU2NCBkYXdyMDsKIHU2NCBkYXdyeDA7
CiB1NjQgY2lhYnI7CiB1NjQgaGRlY19leHBpcnk7CiB1NjQgcHVycjsKIHU2NCBzcHVycjsK
IHU2NCBpYzsKIHU2NCB2dGI7CiB1NjQgaGRhcjsKIHU2NCBoZHNpc3I7CiB1NjQgaGVpcjsK
IHU2NCBhc2RyOwoKIHU2NCBzcnIwOwogdTY0IHNycjE7CiB1NjQgc3ByZ1s0XTsKIHU2NCBw
aWRyOwogdTY0IGNmYXI7CiB1NjQgcHByOwp9OwojIDIzICIuL2FyY2gvcG93ZXJwYy9pbmNs
dWRlL2FzbS9zcGlubG9jay5oIiAyCiMgNTAgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNt
L3NwaW5sb2NrLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVf
XykpIGludCBhcmNoX3NwaW5fdmFsdWVfdW5sb2NrZWQoYXJjaF9zcGlubG9ja190IGxvY2sp
CnsKIHJldHVybiBsb2NrLnNsb2NrID09IDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgYXJjaF9zcGlu
X2lzX2xvY2tlZChhcmNoX3NwaW5sb2NrX3QgKmxvY2spCnsKIF9fYXNtX18gX192b2xhdGls
ZV9fICgic3luYyIgOiA6IDogIm1lbW9yeSIpOwogcmV0dXJuICFhcmNoX3NwaW5fdmFsdWVf
dW5sb2NrZWQoKmxvY2spOwp9CgoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHVuc2lnbmVkIGxvbmcgX19hcmNo
X3NwaW5fdHJ5bG9jayhhcmNoX3NwaW5sb2NrX3QgKmxvY2spCnsKIHVuc2lnbmVkIGxvbmcg
dG1wLCB0b2tlbjsKCiB0b2tlbiA9ICgqKHUzMiAqKSgmbG9jYWxfcGFjYS0+bG9ja190b2tl
bikpOwogX19hc21fXyBfX3ZvbGF0aWxlX18oCiIxOgkiICIubG9uZyAweDdjMDAwMDI4IHwg
KCgoJTApICYgMHgxZikgPDwgMjEpIHwgKCgoMCkgJiAweDFmKSA8PCAxNikgfCAoKCglMikg
JiAweDFmKSA8PCAxMSkgfCAoKCgxKSAmIDB4MSkgPDwgMCkiICIgIiAiXG4JY21wd2kJCTAs
JTAsMFxuCWJuZS0JCTJmXG4Jc3R3Y3guCQklMSwwLCUyXG4JYm5lLQkJMWJcbiIKCgoKCiAi
XG4iICI5NzE6OyBpc3luYzsgOTcyOiAucHVzaHNlY3Rpb24gX19sd3N5bmNfZml4dXAsXCJh
XCI7IC5hbGlnbiAyOyA5NzM6IC44Ynl0ZSA5NzFiLTk3M2I7IC5wb3BzZWN0aW9uOzsiICIg
IgoiMjoiCiA6ICI9JnIiICh0bXApCiA6ICJyIiAodG9rZW4pLCAiciIgKCZsb2NrLT5zbG9j
aykKIDogImNyMCIsICJtZW1vcnkiKTsKCiByZXR1cm4gdG1wOwp9CgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50
IGFyY2hfc3Bpbl90cnlsb2NrKGFyY2hfc3BpbmxvY2tfdCAqbG9jaykKewogcmV0dXJuIF9f
YXJjaF9zcGluX3RyeWxvY2sobG9jaykgPT0gMDsKfQojIDEwOSAiLi9hcmNoL3Bvd2VycGMv
aW5jbHVkZS9hc20vc3BpbmxvY2suaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgc3BscGFyX3NwaW5feWll
bGQoYXJjaF9zcGlubG9ja190ICpsb2NrKSB7fTsKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgc3BscGFyX3J3
X3lpZWxkKGFyY2hfcndsb2NrX3QgKmxvY2spIHt9OwoKCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIGlzX3No
YXJlZF9wcm9jZXNzb3Iodm9pZCkKewoKCgogcmV0dXJuIGZhbHNlOwoKfQoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IHZvaWQgc3Bpbl95aWVsZChhcmNoX3NwaW5sb2NrX3QgKmxvY2spCnsKIGlmIChpc19zaGFy
ZWRfcHJvY2Vzc29yKCkpCiAgc3BscGFyX3NwaW5feWllbGQobG9jayk7CiBlbHNlCiAgX19h
c21fXyBfX3ZvbGF0aWxlX18oIiI6IDogOiJtZW1vcnkiKTsKfQoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQg
cndfeWllbGQoYXJjaF9yd2xvY2tfdCAqbG9jaykKewogaWYgKGlzX3NoYXJlZF9wcm9jZXNz
b3IoKSkKICBzcGxwYXJfcndfeWllbGQobG9jayk7CiBlbHNlCiAgX19hc21fXyBfX3ZvbGF0
aWxlX18oIiI6IDogOiJtZW1vcnkiKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgYXJjaF9zcGluX2xv
Y2soYXJjaF9zcGlubG9ja190ICpsb2NrKQp7CiB3aGlsZSAoMSkgewogIGlmIChfX2J1aWx0
aW5fZXhwZWN0KCEhKF9fYXJjaF9zcGluX3RyeWxvY2sobG9jaykgPT0gMCksIDEpKQogICBi
cmVhazsKICBkbyB7CiAgIGFzbSB2b2xhdGlsZSgib3IgMSwxLDEJICAgICAjIGxvdyBwcmlv
cml0eSIpOwogICBpZiAoaXNfc2hhcmVkX3Byb2Nlc3NvcigpKQogICAgc3BscGFyX3NwaW5f
eWllbGQobG9jayk7CiAgfSB3aGlsZSAoX19idWlsdGluX2V4cGVjdCghIShsb2NrLT5zbG9j
ayAhPSAwKSwgMCkpOwogIGFzbSB2b2xhdGlsZSgib3IgMiwyLDIJICAgICAjIG1lZGl1bSBw
cmlvcml0eSIpOwogfQp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkKdm9pZCBhcmNoX3NwaW5fbG9ja19mbGFncyhh
cmNoX3NwaW5sb2NrX3QgKmxvY2ssIHVuc2lnbmVkIGxvbmcgZmxhZ3MpCnsKIHVuc2lnbmVk
IGxvbmcgZmxhZ3NfZGlzOwoKIHdoaWxlICgxKSB7CiAgaWYgKF9fYnVpbHRpbl9leHBlY3Qo
ISEoX19hcmNoX3NwaW5fdHJ5bG9jayhsb2NrKSA9PSAwKSwgMSkpCiAgIGJyZWFrOwogIGRv
IHsgKHsgdW5zaWduZWQgbG9uZyBfX2R1bW15OyB0eXBlb2YoZmxhZ3NfZGlzKSBfX2R1bW15
MjsgKHZvaWQpKCZfX2R1bW15ID09ICZfX2R1bW15Mik7IDE7IH0pOyBmbGFnc19kaXMgPSBh
cmNoX2xvY2FsX3NhdmVfZmxhZ3MoKTsgfSB3aGlsZSAoMCk7CiAgZG8geyBkbyB7ICh7IHVu
c2lnbmVkIGxvbmcgX19kdW1teTsgdHlwZW9mKGZsYWdzKSBfX2R1bW15MjsgKHZvaWQpKCZf
X2R1bW15ID09ICZfX2R1bW15Mik7IDE7IH0pOyBhcmNoX2xvY2FsX2lycV9yZXN0b3JlKGZs
YWdzKTsgfSB3aGlsZSAoMCk7IH0gd2hpbGUgKDApOwogIGRvIHsKICAgYXNtIHZvbGF0aWxl
KCJvciAxLDEsMQkgICAgICMgbG93IHByaW9yaXR5Iik7CiAgIGlmIChpc19zaGFyZWRfcHJv
Y2Vzc29yKCkpCiAgICBzcGxwYXJfc3Bpbl95aWVsZChsb2NrKTsKICB9IHdoaWxlIChfX2J1
aWx0aW5fZXhwZWN0KCEhKGxvY2stPnNsb2NrICE9IDApLCAwKSk7CiAgYXNtIHZvbGF0aWxl
KCJvciAyLDIsMgkgICAgICMgbWVkaXVtIHByaW9yaXR5Iik7CiAgZG8geyBkbyB7ICh7IHVu
c2lnbmVkIGxvbmcgX19kdW1teTsgdHlwZW9mKGZsYWdzX2RpcykgX19kdW1teTI7ICh2b2lk
KSgmX19kdW1teSA9PSAmX19kdW1teTIpOyAxOyB9KTsgYXJjaF9sb2NhbF9pcnFfcmVzdG9y
ZShmbGFnc19kaXMpOyB9IHdoaWxlICgwKTsgfSB3aGlsZSAoMCk7CiB9Cn0KCgpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgdm9pZCBhcmNoX3NwaW5fdW5sb2NrKGFyY2hfc3BpbmxvY2tfdCAqbG9jaykKewogX19h
c21fXyBfX3ZvbGF0aWxlX18oIiMgYXJjaF9zcGluX3VubG9ja1xuXHQiCiAgICAibHdzeW5j
IiAiICIgIlxuIjogOiA6Im1lbW9yeSIpOwogbG9jay0+c2xvY2sgPSAwOwp9CiMgMjAzICIu
L2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9zcGlubG9jay5oIgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgbG9uZyBf
X2FyY2hfcmVhZF90cnlsb2NrKGFyY2hfcndsb2NrX3QgKnJ3KQp7CiBsb25nIHRtcDsKCiBf
X2FzbV9fIF9fdm9sYXRpbGVfXygKIjE6CSIgIi5sb25nIDB4N2MwMDAwMjggfCAoKCglMCkg
JiAweDFmKSA8PCAyMSkgfCAoKCgwKSAmIDB4MWYpIDw8IDE2KSB8ICgoKCUxKSAmIDB4MWYp
IDw8IDExKSB8ICgoKDEpICYgMHgxKSA8PCAwKSIgIiAiICJcbiIKICJleHRzdwklMCwlMFxu
IgoiCWFkZGljLgkJJTAsJTAsMVxuCWJsZS0JCTJmXG4iCgoiCXN0d2N4LgkJJTAsMCwlMVxu
CWJuZS0JCTFiXG4iCgogIlxuIiAiOTcxOjsgaXN5bmM7IDk3MjogLnB1c2hzZWN0aW9uIF9f
bHdzeW5jX2ZpeHVwLFwiYVwiOyAuYWxpZ24gMjsgOTczOiAuOGJ5dGUgOTcxYi05NzNiOyAu
cG9wc2VjdGlvbjs7IiAiICIKIjI6IiA6ICI9JnIiICh0bXApCiA6ICJyIiAoJnJ3LT5sb2Nr
KQogOiAiY3IwIiwgInhlciIsICJtZW1vcnkiKTsKCiByZXR1cm4gdG1wOwp9CgoKCgoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIGxvbmcgX19hcmNoX3dyaXRlX3RyeWxvY2soYXJjaF9yd2xvY2tfdCAqcncpCnsK
IGxvbmcgdG1wLCB0b2tlbjsKCiB0b2tlbiA9ICgqKHUzMiAqKSgmbG9jYWxfcGFjYS0+bG9j
a190b2tlbikpOwogX19hc21fXyBfX3ZvbGF0aWxlX18oCiIxOgkiICIubG9uZyAweDdjMDAw
MDI4IHwgKCgoJTApICYgMHgxZikgPDwgMjEpIHwgKCgoMCkgJiAweDFmKSA8PCAxNikgfCAo
KCglMikgJiAweDFmKSA8PCAxMSkgfCAoKCgxKSAmIDB4MSkgPDwgMCkiICIgIiAiXG4JY21w
d2kJCTAsJTAsMFxuCWJuZS0JCTJmXG4iCgoKIglzdHdjeC4JCSUxLDAsJTJcbglibmUtCQkx
YlxuIgoKICJcbiIgIjk3MTo7IGlzeW5jOyA5NzI6IC5wdXNoc2VjdGlvbiBfX2x3c3luY19m
aXh1cCxcImFcIjsgLmFsaWduIDI7IDk3MzogLjhieXRlIDk3MWItOTczYjsgLnBvcHNlY3Rp
b247OyIgIiAiCiIyOiIgOiAiPSZyIiAodG1wKQogOiAiciIgKHRva2VuKSwgInIiICgmcnct
PmxvY2spCiA6ICJjcjAiLCAibWVtb3J5Iik7CgogcmV0dXJuIHRtcDsKfQoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IHZvaWQgYXJjaF9yZWFkX2xvY2soYXJjaF9yd2xvY2tfdCAqcncpCnsKIHdoaWxlICgxKSB7
CiAgaWYgKF9fYnVpbHRpbl9leHBlY3QoISEoX19hcmNoX3JlYWRfdHJ5bG9jayhydykgPiAw
KSwgMSkpCiAgIGJyZWFrOwogIGRvIHsKICAgYXNtIHZvbGF0aWxlKCJvciAxLDEsMQkgICAg
ICMgbG93IHByaW9yaXR5Iik7CiAgIGlmIChpc19zaGFyZWRfcHJvY2Vzc29yKCkpCiAgICBz
cGxwYXJfcndfeWllbGQocncpOwogIH0gd2hpbGUgKF9fYnVpbHRpbl9leHBlY3QoISEocnct
PmxvY2sgPCAwKSwgMCkpOwogIGFzbSB2b2xhdGlsZSgib3IgMiwyLDIJICAgICAjIG1lZGl1
bSBwcmlvcml0eSIpOwogfQp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBhcmNoX3dyaXRlX2xvY2soYXJj
aF9yd2xvY2tfdCAqcncpCnsKIHdoaWxlICgxKSB7CiAgaWYgKF9fYnVpbHRpbl9leHBlY3Qo
ISEoX19hcmNoX3dyaXRlX3RyeWxvY2socncpID09IDApLCAxKSkKICAgYnJlYWs7CiAgZG8g
ewogICBhc20gdm9sYXRpbGUoIm9yIDEsMSwxCSAgICAgIyBsb3cgcHJpb3JpdHkiKTsKICAg
aWYgKGlzX3NoYXJlZF9wcm9jZXNzb3IoKSkKICAgIHNwbHBhcl9yd195aWVsZChydyk7CiAg
fSB3aGlsZSAoX19idWlsdGluX2V4cGVjdCghIShydy0+bG9jayAhPSAwKSwgMCkpOwogIGFz
bSB2b2xhdGlsZSgib3IgMiwyLDIJICAgICAjIG1lZGl1bSBwcmlvcml0eSIpOwogfQp9Cgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgaW50IGFyY2hfcmVhZF90cnlsb2NrKGFyY2hfcndsb2NrX3QgKnJ3KQp7CiBy
ZXR1cm4gX19hcmNoX3JlYWRfdHJ5bG9jayhydykgPiAwOwp9CgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGFy
Y2hfd3JpdGVfdHJ5bG9jayhhcmNoX3J3bG9ja190ICpydykKewogcmV0dXJuIF9fYXJjaF93
cml0ZV90cnlsb2NrKHJ3KSA9PSAwOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBhcmNoX3JlYWRfdW5s
b2NrKGFyY2hfcndsb2NrX3QgKnJ3KQp7CiBsb25nIHRtcDsKCiBfX2FzbV9fIF9fdm9sYXRp
bGVfXygKICIjIHJlYWRfdW5sb2NrXG5cdCIKICJsd3N5bmMiICIgIiAiXG4iCiIxOglsd2Fy
eAkJJTAsMCwlMVxuCWFkZGljCQklMCwlMCwtMVxuIgoKIglzdHdjeC4JCSUwLDAsJTFcbgli
bmUtCQkxYiIKCiA6ICI9JnIiKHRtcCkKIDogInIiKCZydy0+bG9jaykKIDogImNyMCIsICJ4
ZXIiLCAibWVtb3J5Iik7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGFyY2hfd3JpdGVfdW5sb2NrKGFy
Y2hfcndsb2NrX3QgKnJ3KQp7CiBfX2FzbV9fIF9fdm9sYXRpbGVfXygiIyB3cml0ZV91bmxv
Y2tcblx0IgogICAgImx3c3luYyIgIiAiICJcbiI6IDogOiJtZW1vcnkiKTsKIHJ3LT5sb2Nr
ID0gMDsKfQojIDkwICIuL2luY2x1ZGUvbGludXgvc3BpbmxvY2suaCIgMgojIDE3OSAiLi9p
bmNsdWRlL2xpbnV4L3NwaW5sb2NrLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGRvX3Jhd19zcGluX2xv
Y2socmF3X3NwaW5sb2NrX3QgKmxvY2spCnsKICh2b2lkKTA7CiBhcmNoX3NwaW5fbG9jaygm
bG9jay0+cmF3X2xvY2spOwogbW1pb3diX3NwaW5fbG9jaygpOwp9CgoKCgoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IHZvaWQKZG9fcmF3X3NwaW5fbG9ja19mbGFncyhyYXdfc3BpbmxvY2tfdCAqbG9jaywgdW5z
aWduZWQgbG9uZyAqZmxhZ3MpCnsKICh2b2lkKTA7CiBhcmNoX3NwaW5fbG9ja19mbGFncygm
bG9jay0+cmF3X2xvY2ssICpmbGFncyk7CiBtbWlvd2Jfc3Bpbl9sb2NrKCk7Cn0KCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBpbnQgZG9fcmF3X3NwaW5fdHJ5bG9jayhyYXdfc3BpbmxvY2tfdCAqbG9jaykKewog
aW50IHJldCA9IGFyY2hfc3Bpbl90cnlsb2NrKCYobG9jayktPnJhd19sb2NrKTsKCiBpZiAo
cmV0KQogIG1taW93Yl9zcGluX2xvY2soKTsKCiByZXR1cm4gcmV0Owp9CgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
dm9pZCBkb19yYXdfc3Bpbl91bmxvY2socmF3X3NwaW5sb2NrX3QgKmxvY2spCnsKIG1taW93
Yl9zcGluX3VubG9jaygpOwogYXJjaF9zcGluX3VubG9jaygmbG9jay0+cmF3X2xvY2spOwog
KHZvaWQpMDsKfQojIDMxMSAiLi9pbmNsdWRlL2xpbnV4L3NwaW5sb2NrLmgiCiMgMSAiLi9p
bmNsdWRlL2xpbnV4L3J3bG9jay5oIiAxCiMgMzEyICIuL2luY2x1ZGUvbGludXgvc3Bpbmxv
Y2suaCIgMgoKCgoKCiMgMSAiLi9pbmNsdWRlL2xpbnV4L3NwaW5sb2NrX2FwaV9zbXAuaCIg
MQojIDE4ICIuL2luY2x1ZGUvbGludXgvc3BpbmxvY2tfYXBpX3NtcC5oIgppbnQgaW5fbG9j
a19mdW5jdGlvbnModW5zaWduZWQgbG9uZyBhZGRyKTsKCgoKdm9pZCBfX2F0dHJpYnV0ZV9f
KChzZWN0aW9uKCIuc3BpbmxvY2sudGV4dCIpKSkgX3Jhd19zcGluX2xvY2socmF3X3NwaW5s
b2NrX3QgKmxvY2spIDsKdm9pZCBfX2F0dHJpYnV0ZV9fKChzZWN0aW9uKCIuc3BpbmxvY2su
dGV4dCIpKSkgX3Jhd19zcGluX2xvY2tfbmVzdGVkKHJhd19zcGlubG9ja190ICpsb2NrLCBp
bnQgc3ViY2xhc3MpCiAgICAgICAgOwp2b2lkIF9fYXR0cmlidXRlX18oKHNlY3Rpb24oIi5z
cGlubG9jay50ZXh0IikpKQpfcmF3X3NwaW5fbG9ja19uZXN0X2xvY2socmF3X3NwaW5sb2Nr
X3QgKmxvY2ssIHN0cnVjdCBsb2NrZGVwX21hcCAqbWFwKQogICAgICAgIDsKdm9pZCBfX2F0
dHJpYnV0ZV9fKChzZWN0aW9uKCIuc3BpbmxvY2sudGV4dCIpKSkgX3Jhd19zcGluX2xvY2tf
YmgocmF3X3NwaW5sb2NrX3QgKmxvY2spIDsKdm9pZCBfX2F0dHJpYnV0ZV9fKChzZWN0aW9u
KCIuc3BpbmxvY2sudGV4dCIpKSkgX3Jhd19zcGluX2xvY2tfaXJxKHJhd19zcGlubG9ja190
ICpsb2NrKQogICAgICAgIDsKCnVuc2lnbmVkIGxvbmcgX19hdHRyaWJ1dGVfXygoc2VjdGlv
bigiLnNwaW5sb2NrLnRleHQiKSkpIF9yYXdfc3Bpbl9sb2NrX2lycXNhdmUocmF3X3NwaW5s
b2NrX3QgKmxvY2spCiAgICAgICAgOwp1bnNpZ25lZCBsb25nIF9fYXR0cmlidXRlX18oKHNl
Y3Rpb24oIi5zcGlubG9jay50ZXh0IikpKQpfcmF3X3NwaW5fbG9ja19pcnFzYXZlX25lc3Rl
ZChyYXdfc3BpbmxvY2tfdCAqbG9jaywgaW50IHN1YmNsYXNzKQogICAgICAgIDsKaW50IF9f
YXR0cmlidXRlX18oKHNlY3Rpb24oIi5zcGlubG9jay50ZXh0IikpKSBfcmF3X3NwaW5fdHJ5
bG9jayhyYXdfc3BpbmxvY2tfdCAqbG9jayk7CmludCBfX2F0dHJpYnV0ZV9fKChzZWN0aW9u
KCIuc3BpbmxvY2sudGV4dCIpKSkgX3Jhd19zcGluX3RyeWxvY2tfYmgocmF3X3NwaW5sb2Nr
X3QgKmxvY2spOwp2b2lkIF9fYXR0cmlidXRlX18oKHNlY3Rpb24oIi5zcGlubG9jay50ZXh0
IikpKSBfcmF3X3NwaW5fdW5sb2NrKHJhd19zcGlubG9ja190ICpsb2NrKSA7CnZvaWQgX19h
dHRyaWJ1dGVfXygoc2VjdGlvbigiLnNwaW5sb2NrLnRleHQiKSkpIF9yYXdfc3Bpbl91bmxv
Y2tfYmgocmF3X3NwaW5sb2NrX3QgKmxvY2spIDsKdm9pZCBfX2F0dHJpYnV0ZV9fKChzZWN0
aW9uKCIuc3BpbmxvY2sudGV4dCIpKSkgX3Jhd19zcGluX3VubG9ja19pcnEocmF3X3NwaW5s
b2NrX3QgKmxvY2spIDsKdm9pZCBfX2F0dHJpYnV0ZV9fKChzZWN0aW9uKCIuc3BpbmxvY2su
dGV4dCIpKSkKX3Jhd19zcGluX3VubG9ja19pcnFyZXN0b3JlKHJhd19zcGlubG9ja190ICps
b2NrLCB1bnNpZ25lZCBsb25nIGZsYWdzKQogICAgICAgIDsKIyA4NiAiLi9pbmNsdWRlL2xp
bnV4L3NwaW5sb2NrX2FwaV9zbXAuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBfX3Jhd19zcGluX3RyeWxv
Y2socmF3X3NwaW5sb2NrX3QgKmxvY2spCnsKIF9fYXNtX18gX192b2xhdGlsZV9fKCIiOiA6
IDoibWVtb3J5Iik7CiBpZiAoZG9fcmF3X3NwaW5fdHJ5bG9jayhsb2NrKSkgewogIGRvIHsg
fSB3aGlsZSAoMCk7CiAgcmV0dXJuIDE7CiB9CiBfX2FzbV9fIF9fdm9sYXRpbGVfXygiIjog
OiA6Im1lbW9yeSIpOwogcmV0dXJuIDA7Cn0KIyAxMDQgIi4vaW5jbHVkZS9saW51eC9zcGlu
bG9ja19hcGlfc21wLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1bnNpZ25lZCBsb25nIF9fcmF3X3NwaW5fbG9j
a19pcnFzYXZlKHJhd19zcGlubG9ja190ICpsb2NrKQp7CiB1bnNpZ25lZCBsb25nIGZsYWdz
OwoKIGRvIHsgZG8geyAoeyB1bnNpZ25lZCBsb25nIF9fZHVtbXk7IHR5cGVvZihmbGFncykg
X19kdW1teTI7ICh2b2lkKSgmX19kdW1teSA9PSAmX19kdW1teTIpOyAxOyB9KTsgZmxhZ3Mg
PSBhcmNoX2xvY2FsX2lycV9zYXZlKCk7IH0gd2hpbGUgKDApOyB9IHdoaWxlICgwKTsKIF9f
YXNtX18gX192b2xhdGlsZV9fKCIiOiA6IDoibWVtb3J5Iik7CiBkbyB7IH0gd2hpbGUgKDAp
OwojIDExOSAiLi9pbmNsdWRlL2xpbnV4L3NwaW5sb2NrX2FwaV9zbXAuaCIKIGRvX3Jhd19z
cGluX2xvY2tfZmxhZ3MobG9jaywgJmZsYWdzKTsKCiByZXR1cm4gZmxhZ3M7Cn0KCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSB2b2lkIF9fcmF3X3NwaW5fbG9ja19pcnEocmF3X3NwaW5sb2NrX3QgKmxvY2spCnsK
IGRvIHsgYXJjaF9sb2NhbF9pcnFfZGlzYWJsZSgpOyB9IHdoaWxlICgwKTsKIF9fYXNtX18g
X192b2xhdGlsZV9fKCIiOiA6IDoibWVtb3J5Iik7CiBkbyB7IH0gd2hpbGUgKDApOwogZG9f
cmF3X3NwaW5fbG9jayhsb2NrKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgX19yYXdfc3Bpbl9sb2Nr
X2JoKHJhd19zcGlubG9ja190ICpsb2NrKQp7CiBfX2xvY2FsX2JoX2Rpc2FibGVfaXAoKHVu
c2lnbmVkIGxvbmcpX19idWlsdGluX3JldHVybl9hZGRyZXNzKDApLCAoKDIgKiAoMVVMIDw8
ICgwICsgOCkpKSArIDApKTsKIGRvIHsgfSB3aGlsZSAoMCk7CiBkb19yYXdfc3Bpbl9sb2Nr
KGxvY2spOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBfX3Jhd19zcGluX2xvY2socmF3X3NwaW5sb2Nr
X3QgKmxvY2spCnsKIF9fYXNtX18gX192b2xhdGlsZV9fKCIiOiA6IDoibWVtb3J5Iik7CiBk
byB7IH0gd2hpbGUgKDApOwogZG9fcmF3X3NwaW5fbG9jayhsb2NrKTsKfQoKCgpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgdm9pZCBfX3Jhd19zcGluX3VubG9jayhyYXdfc3BpbmxvY2tfdCAqbG9jaykKewogZG8g
eyB9IHdoaWxlICgwKTsKIGRvX3Jhd19zcGluX3VubG9jayhsb2NrKTsKIF9fYXNtX18gX192
b2xhdGlsZV9fKCIiOiA6IDoibWVtb3J5Iik7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIF9fcmF3X3Nw
aW5fdW5sb2NrX2lycXJlc3RvcmUocmF3X3NwaW5sb2NrX3QgKmxvY2ssCiAgICAgICAgIHVu
c2lnbmVkIGxvbmcgZmxhZ3MpCnsKIGRvIHsgfSB3aGlsZSAoMCk7CiBkb19yYXdfc3Bpbl91
bmxvY2sobG9jayk7CiBkbyB7IGRvIHsgKHsgdW5zaWduZWQgbG9uZyBfX2R1bW15OyB0eXBl
b2YoZmxhZ3MpIF9fZHVtbXkyOyAodm9pZCkoJl9fZHVtbXkgPT0gJl9fZHVtbXkyKTsgMTsg
fSk7IGFyY2hfbG9jYWxfaXJxX3Jlc3RvcmUoZmxhZ3MpOyB9IHdoaWxlICgwKTsgfSB3aGls
ZSAoMCk7CiBfX2FzbV9fIF9fdm9sYXRpbGVfXygiIjogOiA6Im1lbW9yeSIpOwp9CgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgdm9pZCBfX3Jhd19zcGluX3VubG9ja19pcnEocmF3X3NwaW5sb2NrX3QgKmxvY2sp
CnsKIGRvIHsgfSB3aGlsZSAoMCk7CiBkb19yYXdfc3Bpbl91bmxvY2sobG9jayk7CiBkbyB7
IGFyY2hfbG9jYWxfaXJxX2VuYWJsZSgpOyB9IHdoaWxlICgwKTsKIF9fYXNtX18gX192b2xh
dGlsZV9fKCIiOiA6IDoibWVtb3J5Iik7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIF9fcmF3X3NwaW5f
dW5sb2NrX2JoKHJhd19zcGlubG9ja190ICpsb2NrKQp7CiBkbyB7IH0gd2hpbGUgKDApOwog
ZG9fcmF3X3NwaW5fdW5sb2NrKGxvY2spOwogX19sb2NhbF9iaF9lbmFibGVfaXAoKHVuc2ln
bmVkIGxvbmcpX19idWlsdGluX3JldHVybl9hZGRyZXNzKDApLCAoKDIgKiAoMVVMIDw8ICgw
ICsgOCkpKSArIDApKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBfX3Jhd19zcGluX3RyeWxvY2tfYmgo
cmF3X3NwaW5sb2NrX3QgKmxvY2spCnsKIF9fbG9jYWxfYmhfZGlzYWJsZV9pcCgodW5zaWdu
ZWQgbG9uZylfX2J1aWx0aW5fcmV0dXJuX2FkZHJlc3MoMCksICgoMiAqICgxVUwgPDwgKDAg
KyA4KSkpICsgMCkpOwogaWYgKGRvX3Jhd19zcGluX3RyeWxvY2sobG9jaykpIHsKICBkbyB7
IH0gd2hpbGUgKDApOwogIHJldHVybiAxOwogfQogX19sb2NhbF9iaF9lbmFibGVfaXAoKHVu
c2lnbmVkIGxvbmcpX19idWlsdGluX3JldHVybl9hZGRyZXNzKDApLCAoKDIgKiAoMVVMIDw8
ICgwICsgOCkpKSArIDApKTsKIHJldHVybiAwOwp9CgojIDEgIi4vaW5jbHVkZS9saW51eC9y
d2xvY2tfYXBpX3NtcC5oIiAxCiMgMTggIi4vaW5jbHVkZS9saW51eC9yd2xvY2tfYXBpX3Nt
cC5oIgp2b2lkIF9fYXR0cmlidXRlX18oKHNlY3Rpb24oIi5zcGlubG9jay50ZXh0IikpKSBf
cmF3X3JlYWRfbG9jayhyd2xvY2tfdCAqbG9jaykgOwp2b2lkIF9fYXR0cmlidXRlX18oKHNl
Y3Rpb24oIi5zcGlubG9jay50ZXh0IikpKSBfcmF3X3dyaXRlX2xvY2socndsb2NrX3QgKmxv
Y2spIDsKdm9pZCBfX2F0dHJpYnV0ZV9fKChzZWN0aW9uKCIuc3BpbmxvY2sudGV4dCIpKSkg
X3Jhd19yZWFkX2xvY2tfYmgocndsb2NrX3QgKmxvY2spIDsKdm9pZCBfX2F0dHJpYnV0ZV9f
KChzZWN0aW9uKCIuc3BpbmxvY2sudGV4dCIpKSkgX3Jhd193cml0ZV9sb2NrX2JoKHJ3bG9j
a190ICpsb2NrKSA7CnZvaWQgX19hdHRyaWJ1dGVfXygoc2VjdGlvbigiLnNwaW5sb2NrLnRl
eHQiKSkpIF9yYXdfcmVhZF9sb2NrX2lycShyd2xvY2tfdCAqbG9jaykgOwp2b2lkIF9fYXR0
cmlidXRlX18oKHNlY3Rpb24oIi5zcGlubG9jay50ZXh0IikpKSBfcmF3X3dyaXRlX2xvY2tf
aXJxKHJ3bG9ja190ICpsb2NrKSA7CnVuc2lnbmVkIGxvbmcgX19hdHRyaWJ1dGVfXygoc2Vj
dGlvbigiLnNwaW5sb2NrLnRleHQiKSkpIF9yYXdfcmVhZF9sb2NrX2lycXNhdmUocndsb2Nr
X3QgKmxvY2spCiAgICAgICA7CnVuc2lnbmVkIGxvbmcgX19hdHRyaWJ1dGVfXygoc2VjdGlv
bigiLnNwaW5sb2NrLnRleHQiKSkpIF9yYXdfd3JpdGVfbG9ja19pcnFzYXZlKHJ3bG9ja190
ICpsb2NrKQogICAgICAgOwppbnQgX19hdHRyaWJ1dGVfXygoc2VjdGlvbigiLnNwaW5sb2Nr
LnRleHQiKSkpIF9yYXdfcmVhZF90cnlsb2NrKHJ3bG9ja190ICpsb2NrKTsKaW50IF9fYXR0
cmlidXRlX18oKHNlY3Rpb24oIi5zcGlubG9jay50ZXh0IikpKSBfcmF3X3dyaXRlX3RyeWxv
Y2socndsb2NrX3QgKmxvY2spOwp2b2lkIF9fYXR0cmlidXRlX18oKHNlY3Rpb24oIi5zcGlu
bG9jay50ZXh0IikpKSBfcmF3X3JlYWRfdW5sb2NrKHJ3bG9ja190ICpsb2NrKSA7CnZvaWQg
X19hdHRyaWJ1dGVfXygoc2VjdGlvbigiLnNwaW5sb2NrLnRleHQiKSkpIF9yYXdfd3JpdGVf
dW5sb2NrKHJ3bG9ja190ICpsb2NrKSA7CnZvaWQgX19hdHRyaWJ1dGVfXygoc2VjdGlvbigi
LnNwaW5sb2NrLnRleHQiKSkpIF9yYXdfcmVhZF91bmxvY2tfYmgocndsb2NrX3QgKmxvY2sp
IDsKdm9pZCBfX2F0dHJpYnV0ZV9fKChzZWN0aW9uKCIuc3BpbmxvY2sudGV4dCIpKSkgX3Jh
d193cml0ZV91bmxvY2tfYmgocndsb2NrX3QgKmxvY2spIDsKdm9pZCBfX2F0dHJpYnV0ZV9f
KChzZWN0aW9uKCIuc3BpbmxvY2sudGV4dCIpKSkgX3Jhd19yZWFkX3VubG9ja19pcnEocnds
b2NrX3QgKmxvY2spIDsKdm9pZCBfX2F0dHJpYnV0ZV9fKChzZWN0aW9uKCIuc3BpbmxvY2su
dGV4dCIpKSkgX3Jhd193cml0ZV91bmxvY2tfaXJxKHJ3bG9ja190ICpsb2NrKSA7CnZvaWQg
X19hdHRyaWJ1dGVfXygoc2VjdGlvbigiLnNwaW5sb2NrLnRleHQiKSkpCl9yYXdfcmVhZF91
bmxvY2tfaXJxcmVzdG9yZShyd2xvY2tfdCAqbG9jaywgdW5zaWduZWQgbG9uZyBmbGFncykK
ICAgICAgIDsKdm9pZCBfX2F0dHJpYnV0ZV9fKChzZWN0aW9uKCIuc3BpbmxvY2sudGV4dCIp
KSkKX3Jhd193cml0ZV91bmxvY2tfaXJxcmVzdG9yZShyd2xvY2tfdCAqbG9jaywgdW5zaWdu
ZWQgbG9uZyBmbGFncykKICAgICAgIDsKIyAxMTcgIi4vaW5jbHVkZS9saW51eC9yd2xvY2tf
YXBpX3NtcC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IF9fcmF3X3JlYWRfdHJ5bG9jayhyd2xvY2tfdCAq
bG9jaykKewogX19hc21fXyBfX3ZvbGF0aWxlX18oIiI6IDogOiJtZW1vcnkiKTsKIGlmIChh
cmNoX3JlYWRfdHJ5bG9jaygmKGxvY2spLT5yYXdfbG9jaykpIHsKICBkbyB7IH0gd2hpbGUg
KDApOwogIHJldHVybiAxOwogfQogX19hc21fXyBfX3ZvbGF0aWxlX18oIiI6IDogOiJtZW1v
cnkiKTsKIHJldHVybiAwOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IF9fcmF3X3dyaXRlX3RyeWxvY2so
cndsb2NrX3QgKmxvY2spCnsKIF9fYXNtX18gX192b2xhdGlsZV9fKCIiOiA6IDoibWVtb3J5
Iik7CiBpZiAoYXJjaF93cml0ZV90cnlsb2NrKCYobG9jayktPnJhd19sb2NrKSkgewogIGRv
IHsgfSB3aGlsZSAoMCk7CiAgcmV0dXJuIDE7CiB9CiBfX2FzbV9fIF9fdm9sYXRpbGVfXygi
IjogOiA6Im1lbW9yeSIpOwogcmV0dXJuIDA7Cn0KIyAxNDYgIi4vaW5jbHVkZS9saW51eC9y
d2xvY2tfYXBpX3NtcC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBfX3Jhd19yZWFkX2xvY2socndsb2Nr
X3QgKmxvY2spCnsKIF9fYXNtX18gX192b2xhdGlsZV9fKCIiOiA6IDoibWVtb3J5Iik7CiBk
byB7IH0gd2hpbGUgKDApOwogZG8geyh2b2lkKTA7IGFyY2hfcmVhZF9sb2NrKCYobG9jaykt
PnJhd19sb2NrKTsgfSB3aGlsZSAoMCk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1bnNpZ25lZCBsb25nIF9f
cmF3X3JlYWRfbG9ja19pcnFzYXZlKHJ3bG9ja190ICpsb2NrKQp7CiB1bnNpZ25lZCBsb25n
IGZsYWdzOwoKIGRvIHsgZG8geyAoeyB1bnNpZ25lZCBsb25nIF9fZHVtbXk7IHR5cGVvZihm
bGFncykgX19kdW1teTI7ICh2b2lkKSgmX19kdW1teSA9PSAmX19kdW1teTIpOyAxOyB9KTsg
ZmxhZ3MgPSBhcmNoX2xvY2FsX2lycV9zYXZlKCk7IH0gd2hpbGUgKDApOyB9IHdoaWxlICgw
KTsKIF9fYXNtX18gX192b2xhdGlsZV9fKCIiOiA6IDoibWVtb3J5Iik7CiBkbyB7IH0gd2hp
bGUgKDApOwogZG8geyh2b2lkKTA7IGFyY2hfcmVhZF9sb2NrKCYoKGxvY2spKS0+cmF3X2xv
Y2spOyB9IHdoaWxlICgwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICA7CiByZXR1cm4gZmxhZ3M7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIF9fcmF3X3JlYWRfbG9ja19p
cnEocndsb2NrX3QgKmxvY2spCnsKIGRvIHsgYXJjaF9sb2NhbF9pcnFfZGlzYWJsZSgpOyB9
IHdoaWxlICgwKTsKIF9fYXNtX18gX192b2xhdGlsZV9fKCIiOiA6IDoibWVtb3J5Iik7CiBk
byB7IH0gd2hpbGUgKDApOwogZG8geyh2b2lkKTA7IGFyY2hfcmVhZF9sb2NrKCYobG9jaykt
PnJhd19sb2NrKTsgfSB3aGlsZSAoMCk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIF9fcmF3X3JlYWRf
bG9ja19iaChyd2xvY2tfdCAqbG9jaykKewogX19sb2NhbF9iaF9kaXNhYmxlX2lwKCh1bnNp
Z25lZCBsb25nKV9fYnVpbHRpbl9yZXR1cm5fYWRkcmVzcygwKSwgKCgyICogKDFVTCA8PCAo
MCArIDgpKSkgKyAwKSk7CiBkbyB7IH0gd2hpbGUgKDApOwogZG8geyh2b2lkKTA7IGFyY2hf
cmVhZF9sb2NrKCYobG9jayktPnJhd19sb2NrKTsgfSB3aGlsZSAoMCk7Cn0KCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSB1bnNpZ25lZCBsb25nIF9fcmF3X3dyaXRlX2xvY2tfaXJxc2F2ZShyd2xvY2tfdCAqbG9j
aykKewogdW5zaWduZWQgbG9uZyBmbGFnczsKCiBkbyB7IGRvIHsgKHsgdW5zaWduZWQgbG9u
ZyBfX2R1bW15OyB0eXBlb2YoZmxhZ3MpIF9fZHVtbXkyOyAodm9pZCkoJl9fZHVtbXkgPT0g
Jl9fZHVtbXkyKTsgMTsgfSk7IGZsYWdzID0gYXJjaF9sb2NhbF9pcnFfc2F2ZSgpOyB9IHdo
aWxlICgwKTsgfSB3aGlsZSAoMCk7CiBfX2FzbV9fIF9fdm9sYXRpbGVfXygiIjogOiA6Im1l
bW9yeSIpOwogZG8geyB9IHdoaWxlICgwKTsKIGRvIHsodm9pZCkwOyBhcmNoX3dyaXRlX2xv
Y2soJigobG9jaykpLT5yYXdfbG9jayk7IH0gd2hpbGUgKDApCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICA7CiByZXR1cm4gZmxhZ3M7Cn0KCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2
b2lkIF9fcmF3X3dyaXRlX2xvY2tfaXJxKHJ3bG9ja190ICpsb2NrKQp7CiBkbyB7IGFyY2hf
bG9jYWxfaXJxX2Rpc2FibGUoKTsgfSB3aGlsZSAoMCk7CiBfX2FzbV9fIF9fdm9sYXRpbGVf
XygiIjogOiA6Im1lbW9yeSIpOwogZG8geyB9IHdoaWxlICgwKTsKIGRvIHsodm9pZCkwOyBh
cmNoX3dyaXRlX2xvY2soJihsb2NrKS0+cmF3X2xvY2spOyB9IHdoaWxlICgwKTsKfQoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIHZvaWQgX19yYXdfd3JpdGVfbG9ja19iaChyd2xvY2tfdCAqbG9jaykKewogX19s
b2NhbF9iaF9kaXNhYmxlX2lwKCh1bnNpZ25lZCBsb25nKV9fYnVpbHRpbl9yZXR1cm5fYWRk
cmVzcygwKSwgKCgyICogKDFVTCA8PCAoMCArIDgpKSkgKyAwKSk7CiBkbyB7IH0gd2hpbGUg
KDApOwogZG8geyh2b2lkKTA7IGFyY2hfd3JpdGVfbG9jaygmKGxvY2spLT5yYXdfbG9jayk7
IH0gd2hpbGUgKDApOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBfX3Jhd193cml0ZV9sb2NrKHJ3bG9j
a190ICpsb2NrKQp7CiBfX2FzbV9fIF9fdm9sYXRpbGVfXygiIjogOiA6Im1lbW9yeSIpOwog
ZG8geyB9IHdoaWxlICgwKTsKIGRvIHsodm9pZCkwOyBhcmNoX3dyaXRlX2xvY2soJihsb2Nr
KS0+cmF3X2xvY2spOyB9IHdoaWxlICgwKTsKfQoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBfX3Jhd193
cml0ZV91bmxvY2socndsb2NrX3QgKmxvY2spCnsKIGRvIHsgfSB3aGlsZSAoMCk7CiBkbyB7
YXJjaF93cml0ZV91bmxvY2soJihsb2NrKS0+cmF3X2xvY2spOyAodm9pZCkwOyB9IHdoaWxl
ICgwKTsKIF9fYXNtX18gX192b2xhdGlsZV9fKCIiOiA6IDoibWVtb3J5Iik7Cn0KCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSB2b2lkIF9fcmF3X3JlYWRfdW5sb2NrKHJ3bG9ja190ICpsb2NrKQp7CiBkbyB7IH0g
d2hpbGUgKDApOwogZG8ge2FyY2hfcmVhZF91bmxvY2soJihsb2NrKS0+cmF3X2xvY2spOyAo
dm9pZCkwOyB9IHdoaWxlICgwKTsKIF9fYXNtX18gX192b2xhdGlsZV9fKCIiOiA6IDoibWVt
b3J5Iik7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkCl9fcmF3X3JlYWRfdW5sb2NrX2lycXJlc3RvcmUo
cndsb2NrX3QgKmxvY2ssIHVuc2lnbmVkIGxvbmcgZmxhZ3MpCnsKIGRvIHsgfSB3aGlsZSAo
MCk7CiBkbyB7YXJjaF9yZWFkX3VubG9jaygmKGxvY2spLT5yYXdfbG9jayk7ICh2b2lkKTA7
IH0gd2hpbGUgKDApOwogZG8geyBkbyB7ICh7IHVuc2lnbmVkIGxvbmcgX19kdW1teTsgdHlw
ZW9mKGZsYWdzKSBfX2R1bW15MjsgKHZvaWQpKCZfX2R1bW15ID09ICZfX2R1bW15Mik7IDE7
IH0pOyBhcmNoX2xvY2FsX2lycV9yZXN0b3JlKGZsYWdzKTsgfSB3aGlsZSAoMCk7IH0gd2hp
bGUgKDApOwogX19hc21fXyBfX3ZvbGF0aWxlX18oIiI6IDogOiJtZW1vcnkiKTsKfQoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIHZvaWQgX19yYXdfcmVhZF91bmxvY2tfaXJxKHJ3bG9ja190ICpsb2NrKQp7CiBk
byB7IH0gd2hpbGUgKDApOwogZG8ge2FyY2hfcmVhZF91bmxvY2soJihsb2NrKS0+cmF3X2xv
Y2spOyAodm9pZCkwOyB9IHdoaWxlICgwKTsKIGRvIHsgYXJjaF9sb2NhbF9pcnFfZW5hYmxl
KCk7IH0gd2hpbGUgKDApOwogX19hc21fXyBfX3ZvbGF0aWxlX18oIiI6IDogOiJtZW1vcnki
KTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIHZvaWQgX19yYXdfcmVhZF91bmxvY2tfYmgocndsb2NrX3QgKmxv
Y2spCnsKIGRvIHsgfSB3aGlsZSAoMCk7CiBkbyB7YXJjaF9yZWFkX3VubG9jaygmKGxvY2sp
LT5yYXdfbG9jayk7ICh2b2lkKTA7IH0gd2hpbGUgKDApOwogX19sb2NhbF9iaF9lbmFibGVf
aXAoKHVuc2lnbmVkIGxvbmcpX19idWlsdGluX3JldHVybl9hZGRyZXNzKDApLCAoKDIgKiAo
MVVMIDw8ICgwICsgOCkpKSArIDApKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgX19yYXdfd3JpdGVf
dW5sb2NrX2lycXJlc3RvcmUocndsb2NrX3QgKmxvY2ssCiAgICAgICAgICB1bnNpZ25lZCBs
b25nIGZsYWdzKQp7CiBkbyB7IH0gd2hpbGUgKDApOwogZG8ge2FyY2hfd3JpdGVfdW5sb2Nr
KCYobG9jayktPnJhd19sb2NrKTsgKHZvaWQpMDsgfSB3aGlsZSAoMCk7CiBkbyB7IGRvIHsg
KHsgdW5zaWduZWQgbG9uZyBfX2R1bW15OyB0eXBlb2YoZmxhZ3MpIF9fZHVtbXkyOyAodm9p
ZCkoJl9fZHVtbXkgPT0gJl9fZHVtbXkyKTsgMTsgfSk7IGFyY2hfbG9jYWxfaXJxX3Jlc3Rv
cmUoZmxhZ3MpOyB9IHdoaWxlICgwKTsgfSB3aGlsZSAoMCk7CiBfX2FzbV9fIF9fdm9sYXRp
bGVfXygiIjogOiA6Im1lbW9yeSIpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBfX3Jhd193cml0ZV91
bmxvY2tfaXJxKHJ3bG9ja190ICpsb2NrKQp7CiBkbyB7IH0gd2hpbGUgKDApOwogZG8ge2Fy
Y2hfd3JpdGVfdW5sb2NrKCYobG9jayktPnJhd19sb2NrKTsgKHZvaWQpMDsgfSB3aGlsZSAo
MCk7CiBkbyB7IGFyY2hfbG9jYWxfaXJxX2VuYWJsZSgpOyB9IHdoaWxlICgwKTsKIF9fYXNt
X18gX192b2xhdGlsZV9fKCIiOiA6IDoibWVtb3J5Iik7Cn0KCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIF9f
cmF3X3dyaXRlX3VubG9ja19iaChyd2xvY2tfdCAqbG9jaykKewogZG8geyB9IHdoaWxlICgw
KTsKIGRvIHthcmNoX3dyaXRlX3VubG9jaygmKGxvY2spLT5yYXdfbG9jayk7ICh2b2lkKTA7
IH0gd2hpbGUgKDApOwogX19sb2NhbF9iaF9lbmFibGVfaXAoKHVuc2lnbmVkIGxvbmcpX19i
dWlsdGluX3JldHVybl9hZGRyZXNzKDApLCAoKDIgKiAoMVVMIDw8ICgwICsgOCkpKSArIDAp
KTsKfQojIDE5MSAiLi9pbmNsdWRlL2xpbnV4L3NwaW5sb2NrX2FwaV9zbXAuaCIgMgojIDMx
OCAiLi9pbmNsdWRlL2xpbnV4L3NwaW5sb2NrLmgiIDIKIyAzMjYgIi4vaW5jbHVkZS9saW51
eC9zcGlubG9jay5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5l
X18pKSByYXdfc3BpbmxvY2tfdCAqc3BpbmxvY2tfY2hlY2soc3BpbmxvY2tfdCAqbG9jaykK
ewogcmV0dXJuICZsb2NrLT5ybG9jazsKfQojIDM1MSAiLi9pbmNsdWRlL2xpbnV4L3NwaW5s
b2NrLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHZv
aWQgc3Bpbl9sb2NrKHNwaW5sb2NrX3QgKmxvY2spCnsKIF9yYXdfc3Bpbl9sb2NrKCZsb2Nr
LT5ybG9jayk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVf
XykpIHZvaWQgc3Bpbl9sb2NrX2JoKHNwaW5sb2NrX3QgKmxvY2spCnsKIF9yYXdfc3Bpbl9s
b2NrX2JoKCZsb2NrLT5ybG9jayk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fs
d2F5c19pbmxpbmVfXykpIGludCBzcGluX3RyeWxvY2soc3BpbmxvY2tfdCAqbG9jaykKewog
cmV0dXJuIChfcmF3X3NwaW5fdHJ5bG9jaygmbG9jay0+cmxvY2spKTsKfQojIDM3NiAiLi9p
bmNsdWRlL2xpbnV4L3NwaW5sb2NrLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fs
d2F5c19pbmxpbmVfXykpIHZvaWQgc3Bpbl9sb2NrX2lycShzcGlubG9ja190ICpsb2NrKQp7
CiBfcmF3X3NwaW5fbG9ja19pcnEoJmxvY2stPnJsb2NrKTsKfQojIDM5MSAiLi9pbmNsdWRl
L2xpbnV4L3NwaW5sb2NrLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19p
bmxpbmVfXykpIHZvaWQgc3Bpbl91bmxvY2soc3BpbmxvY2tfdCAqbG9jaykKewogX19yYXdf
c3Bpbl91bmxvY2soJmxvY2stPnJsb2NrKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18o
KF9fYWx3YXlzX2lubGluZV9fKSkgdm9pZCBzcGluX3VubG9ja19iaChzcGlubG9ja190ICps
b2NrKQp7CiBfcmF3X3NwaW5fdW5sb2NrX2JoKCZsb2NrLT5ybG9jayk7Cn0KCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHZvaWQgc3Bpbl91bmxvY2tf
aXJxKHNwaW5sb2NrX3QgKmxvY2spCnsKIF9fcmF3X3NwaW5fdW5sb2NrX2lycSgmbG9jay0+
cmxvY2spOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18p
KSB2b2lkIHNwaW5fdW5sb2NrX2lycXJlc3RvcmUoc3BpbmxvY2tfdCAqbG9jaywgdW5zaWdu
ZWQgbG9uZyBmbGFncykKewogZG8geyAoeyB1bnNpZ25lZCBsb25nIF9fZHVtbXk7IHR5cGVv
ZihmbGFncykgX19kdW1teTI7ICh2b2lkKSgmX19kdW1teSA9PSAmX19kdW1teTIpOyAxOyB9
KTsgX3Jhd19zcGluX3VubG9ja19pcnFyZXN0b3JlKCZsb2NrLT5ybG9jaywgZmxhZ3MpOyB9
IHdoaWxlICgwKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGlu
ZV9fKSkgaW50IHNwaW5fdHJ5bG9ja19iaChzcGlubG9ja190ICpsb2NrKQp7CiByZXR1cm4g
KF9yYXdfc3Bpbl90cnlsb2NrX2JoKCZsb2NrLT5ybG9jaykpOwp9CgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19h
dHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBpbnQgc3Bpbl90cnlsb2NrX2lycShz
cGlubG9ja190ICpsb2NrKQp7CiByZXR1cm4gKHsgZG8geyBhcmNoX2xvY2FsX2lycV9kaXNh
YmxlKCk7IH0gd2hpbGUgKDApOyAoX3Jhd19zcGluX3RyeWxvY2soJmxvY2stPnJsb2NrKSkg
PyAxIDogKHsgZG8geyBhcmNoX2xvY2FsX2lycV9lbmFibGUoKTsgfSB3aGlsZSAoMCk7IDA7
IH0pOyB9KTsKfQojIDQ0NCAiLi9pbmNsdWRlL2xpbnV4L3NwaW5sb2NrLmgiCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIGludCBzcGluX2lzX2xvY2tl
ZChzcGlubG9ja190ICpsb2NrKQp7CiByZXR1cm4gYXJjaF9zcGluX2lzX2xvY2tlZCgmKCZs
b2NrLT5ybG9jayktPnJhd19sb2NrKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9f
YWx3YXlzX2lubGluZV9fKSkgaW50IHNwaW5faXNfY29udGVuZGVkKHNwaW5sb2NrX3QgKmxv
Y2spCnsKIHJldHVybiAoKCh2b2lkKSgmbG9jay0+cmxvY2spLCAwKSk7Cn0KIyA0NjkgIi4v
aW5jbHVkZS9saW51eC9zcGlubG9jay5oIgpleHRlcm4gaW50IF9hdG9taWNfZGVjX2FuZF9s
b2NrKGF0b21pY190ICphdG9taWMsIHNwaW5sb2NrX3QgKmxvY2spOwoKCgpleHRlcm4gaW50
IF9hdG9taWNfZGVjX2FuZF9sb2NrX2lycXNhdmUoYXRvbWljX3QgKmF0b21pYywgc3Bpbmxv
Y2tfdCAqbG9jaywKICAgICB1bnNpZ25lZCBsb25nICpmbGFncyk7CgoKCmludCBfX2FsbG9j
X2J1Y2tldF9zcGlubG9ja3Moc3BpbmxvY2tfdCAqKmxvY2tzLCB1bnNpZ25lZCBpbnQgKmxv
Y2tfbWFzaywKICAgICAgICBzaXplX3QgbWF4X3NpemUsIHVuc2lnbmVkIGludCBjcHVfbXVs
dCwKICAgICAgICBnZnBfdCBnZnAsIGNvbnN0IGNoYXIgKm5hbWUsCiAgICAgICAgc3RydWN0
IGxvY2tfY2xhc3Nfa2V5ICprZXkpOwojIDQ5MyAiLi9pbmNsdWRlL2xpbnV4L3NwaW5sb2Nr
LmgiCnZvaWQgZnJlZV9idWNrZXRfc3BpbmxvY2tzKHNwaW5sb2NrX3QgKmxvY2tzKTsKIyAx
MCAiLi9pbmNsdWRlL2xpbnV4L3dhaXQuaCIgMgoKCiMgMSAiLi9pbmNsdWRlL3VhcGkvbGlu
dXgvd2FpdC5oIiAxCiMgMTMgIi4vaW5jbHVkZS9saW51eC93YWl0LmgiIDIKCnR5cGVkZWYg
c3RydWN0IHdhaXRfcXVldWVfZW50cnkgd2FpdF9xdWV1ZV9lbnRyeV90OwoKdHlwZWRlZiBp
bnQgKCp3YWl0X3F1ZXVlX2Z1bmNfdCkoc3RydWN0IHdhaXRfcXVldWVfZW50cnkgKndxX2Vu
dHJ5LCB1bnNpZ25lZCBtb2RlLCBpbnQgZmxhZ3MsIHZvaWQgKmtleSk7CmludCBkZWZhdWx0
X3dha2VfZnVuY3Rpb24oc3RydWN0IHdhaXRfcXVldWVfZW50cnkgKndxX2VudHJ5LCB1bnNp
Z25lZCBtb2RlLCBpbnQgZmxhZ3MsIHZvaWQgKmtleSk7CiMgMjggIi4vaW5jbHVkZS9saW51
eC93YWl0LmgiCnN0cnVjdCB3YWl0X3F1ZXVlX2VudHJ5IHsKIHVuc2lnbmVkIGludCBmbGFn
czsKIHZvaWQgKnByaXZhdGU7CiB3YWl0X3F1ZXVlX2Z1bmNfdCBmdW5jOwogc3RydWN0IGxp
c3RfaGVhZCBlbnRyeTsKfTsKCnN0cnVjdCB3YWl0X3F1ZXVlX2hlYWQgewogc3BpbmxvY2tf
dCBsb2NrOwogc3RydWN0IGxpc3RfaGVhZCBoZWFkOwp9Owp0eXBlZGVmIHN0cnVjdCB3YWl0
X3F1ZXVlX2hlYWQgd2FpdF9xdWV1ZV9oZWFkX3Q7CgpzdHJ1Y3QgdGFza19zdHJ1Y3Q7CiMg
NjIgIi4vaW5jbHVkZS9saW51eC93YWl0LmgiCmV4dGVybiB2b2lkIF9faW5pdF93YWl0cXVl
dWVfaGVhZChzdHJ1Y3Qgd2FpdF9xdWV1ZV9oZWFkICp3cV9oZWFkLCBjb25zdCBjaGFyICpu
YW1lLCBzdHJ1Y3QgbG9ja19jbGFzc19rZXkgKik7CiMgODAgIi4vaW5jbHVkZS9saW51eC93
YWl0LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSB2b2lkIGluaXRfd2FpdHF1ZXVlX2VudHJ5KHN0cnVjdCB3YWl0
X3F1ZXVlX2VudHJ5ICp3cV9lbnRyeSwgc3RydWN0IHRhc2tfc3RydWN0ICpwKQp7CiB3cV9l
bnRyeS0+ZmxhZ3MgPSAwOwogd3FfZW50cnktPnByaXZhdGUgPSBwOwogd3FfZW50cnktPmZ1
bmMgPSBkZWZhdWx0X3dha2VfZnVuY3Rpb247Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkCmluaXRfd2Fp
dHF1ZXVlX2Z1bmNfZW50cnkoc3RydWN0IHdhaXRfcXVldWVfZW50cnkgKndxX2VudHJ5LCB3
YWl0X3F1ZXVlX2Z1bmNfdCBmdW5jKQp7CiB3cV9lbnRyeS0+ZmxhZ3MgPSAwOwogd3FfZW50
cnktPnByaXZhdGUgPSAoKHZvaWQgKikwKTsKIHdxX2VudHJ5LT5mdW5jID0gZnVuYzsKfQoj
IDEyNSAiLi9pbmNsdWRlL2xpbnV4L3dhaXQuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCB3YWl0cXVldWVf
YWN0aXZlKHN0cnVjdCB3YWl0X3F1ZXVlX2hlYWQgKndxX2hlYWQpCnsKIHJldHVybiAhbGlz
dF9lbXB0eSgmd3FfaGVhZC0+aGVhZCk7Cn0KIyAxMzggIi4vaW5jbHVkZS9saW51eC93YWl0
LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSBib29sIHdxX2hhc19zaW5nbGVfc2xlZXBlcihzdHJ1Y3Qgd2FpdF9x
dWV1ZV9oZWFkICp3cV9oZWFkKQp7CiByZXR1cm4gbGlzdF9pc19zaW5ndWxhcigmd3FfaGVh
ZC0+aGVhZCk7Cn0KIyAxNTEgIi4vaW5jbHVkZS9saW51eC93YWl0LmgiCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBi
b29sIHdxX2hhc19zbGVlcGVyKHN0cnVjdCB3YWl0X3F1ZXVlX2hlYWQgKndxX2hlYWQpCnsK
CgoKCgoKCiBfX2FzbV9fIF9fdm9sYXRpbGVfXyAoInN5bmMiIDogOiA6ICJtZW1vcnkiKTsK
IHJldHVybiB3YWl0cXVldWVfYWN0aXZlKHdxX2hlYWQpOwp9CgpleHRlcm4gdm9pZCBhZGRf
d2FpdF9xdWV1ZShzdHJ1Y3Qgd2FpdF9xdWV1ZV9oZWFkICp3cV9oZWFkLCBzdHJ1Y3Qgd2Fp
dF9xdWV1ZV9lbnRyeSAqd3FfZW50cnkpOwpleHRlcm4gdm9pZCBhZGRfd2FpdF9xdWV1ZV9l
eGNsdXNpdmUoc3RydWN0IHdhaXRfcXVldWVfaGVhZCAqd3FfaGVhZCwgc3RydWN0IHdhaXRf
cXVldWVfZW50cnkgKndxX2VudHJ5KTsKZXh0ZXJuIHZvaWQgcmVtb3ZlX3dhaXRfcXVldWUo
c3RydWN0IHdhaXRfcXVldWVfaGVhZCAqd3FfaGVhZCwgc3RydWN0IHdhaXRfcXVldWVfZW50
cnkgKndxX2VudHJ5KTsKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIF9fYWRkX3dhaXRfcXVldWUoc3RydWN0
IHdhaXRfcXVldWVfaGVhZCAqd3FfaGVhZCwgc3RydWN0IHdhaXRfcXVldWVfZW50cnkgKndx
X2VudHJ5KQp7CiBsaXN0X2FkZCgmd3FfZW50cnktPmVudHJ5LCAmd3FfaGVhZC0+aGVhZCk7
Cn0KCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSB2b2lkCl9fYWRkX3dhaXRfcXVldWVfZXhjbHVzaXZlKHN0cnVj
dCB3YWl0X3F1ZXVlX2hlYWQgKndxX2hlYWQsIHN0cnVjdCB3YWl0X3F1ZXVlX2VudHJ5ICp3
cV9lbnRyeSkKewogd3FfZW50cnktPmZsYWdzIHw9IDB4MDE7CiBfX2FkZF93YWl0X3F1ZXVl
KHdxX2hlYWQsIHdxX2VudHJ5KTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgX19hZGRfd2FpdF9xdWV1
ZV9lbnRyeV90YWlsKHN0cnVjdCB3YWl0X3F1ZXVlX2hlYWQgKndxX2hlYWQsIHN0cnVjdCB3
YWl0X3F1ZXVlX2VudHJ5ICp3cV9lbnRyeSkKewogbGlzdF9hZGRfdGFpbCgmd3FfZW50cnkt
PmVudHJ5LCAmd3FfaGVhZC0+aGVhZCk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkCl9fYWRkX3dhaXRf
cXVldWVfZW50cnlfdGFpbF9leGNsdXNpdmUoc3RydWN0IHdhaXRfcXVldWVfaGVhZCAqd3Ff
aGVhZCwgc3RydWN0IHdhaXRfcXVldWVfZW50cnkgKndxX2VudHJ5KQp7CiB3cV9lbnRyeS0+
ZmxhZ3MgfD0gMHgwMTsKIF9fYWRkX3dhaXRfcXVldWVfZW50cnlfdGFpbCh3cV9oZWFkLCB3
cV9lbnRyeSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkCl9fcmVtb3ZlX3dhaXRfcXVldWUoc3RydWN0
IHdhaXRfcXVldWVfaGVhZCAqd3FfaGVhZCwgc3RydWN0IHdhaXRfcXVldWVfZW50cnkgKndx
X2VudHJ5KQp7CiBsaXN0X2RlbCgmd3FfZW50cnktPmVudHJ5KTsKfQoKdm9pZCBfX3dha2Vf
dXAoc3RydWN0IHdhaXRfcXVldWVfaGVhZCAqd3FfaGVhZCwgdW5zaWduZWQgaW50IG1vZGUs
IGludCBuciwgdm9pZCAqa2V5KTsKdm9pZCBfX3dha2VfdXBfbG9ja2VkX2tleShzdHJ1Y3Qg
d2FpdF9xdWV1ZV9oZWFkICp3cV9oZWFkLCB1bnNpZ25lZCBpbnQgbW9kZSwgdm9pZCAqa2V5
KTsKdm9pZCBfX3dha2VfdXBfbG9ja2VkX2tleV9ib29rbWFyayhzdHJ1Y3Qgd2FpdF9xdWV1
ZV9oZWFkICp3cV9oZWFkLAogIHVuc2lnbmVkIGludCBtb2RlLCB2b2lkICprZXksIHdhaXRf
cXVldWVfZW50cnlfdCAqYm9va21hcmspOwp2b2lkIF9fd2FrZV91cF9zeW5jX2tleShzdHJ1
Y3Qgd2FpdF9xdWV1ZV9oZWFkICp3cV9oZWFkLCB1bnNpZ25lZCBpbnQgbW9kZSwgdm9pZCAq
a2V5KTsKdm9pZCBfX3dha2VfdXBfbG9ja2VkX3N5bmNfa2V5KHN0cnVjdCB3YWl0X3F1ZXVl
X2hlYWQgKndxX2hlYWQsIHVuc2lnbmVkIGludCBtb2RlLCB2b2lkICprZXkpOwp2b2lkIF9f
d2FrZV91cF9sb2NrZWQoc3RydWN0IHdhaXRfcXVldWVfaGVhZCAqd3FfaGVhZCwgdW5zaWdu
ZWQgaW50IG1vZGUsIGludCBucik7CnZvaWQgX193YWtlX3VwX3N5bmMoc3RydWN0IHdhaXRf
cXVldWVfaGVhZCAqd3FfaGVhZCwgdW5zaWduZWQgaW50IG1vZGUpOwojIDI0OSAiLi9pbmNs
dWRlL2xpbnV4L3dhaXQuaCIKZXh0ZXJuIHZvaWQgaW5pdF93YWl0X2VudHJ5KHN0cnVjdCB3
YWl0X3F1ZXVlX2VudHJ5ICp3cV9lbnRyeSwgaW50IGZsYWdzKTsKIyA3MzMgIi4vaW5jbHVk
ZS9saW51eC93YWl0LmgiCmV4dGVybiBpbnQgZG9fd2FpdF9pbnRyKHdhaXRfcXVldWVfaGVh
ZF90ICosIHdhaXRfcXVldWVfZW50cnlfdCAqKTsKZXh0ZXJuIGludCBkb193YWl0X2ludHJf
aXJxKHdhaXRfcXVldWVfaGVhZF90ICosIHdhaXRfcXVldWVfZW50cnlfdCAqKTsKIyAxMTI3
ICIuL2luY2x1ZGUvbGludXgvd2FpdC5oIgp2b2lkIHByZXBhcmVfdG9fd2FpdChzdHJ1Y3Qg
d2FpdF9xdWV1ZV9oZWFkICp3cV9oZWFkLCBzdHJ1Y3Qgd2FpdF9xdWV1ZV9lbnRyeSAqd3Ff
ZW50cnksIGludCBzdGF0ZSk7CnZvaWQgcHJlcGFyZV90b193YWl0X2V4Y2x1c2l2ZShzdHJ1
Y3Qgd2FpdF9xdWV1ZV9oZWFkICp3cV9oZWFkLCBzdHJ1Y3Qgd2FpdF9xdWV1ZV9lbnRyeSAq
d3FfZW50cnksIGludCBzdGF0ZSk7CmxvbmcgcHJlcGFyZV90b193YWl0X2V2ZW50KHN0cnVj
dCB3YWl0X3F1ZXVlX2hlYWQgKndxX2hlYWQsIHN0cnVjdCB3YWl0X3F1ZXVlX2VudHJ5ICp3
cV9lbnRyeSwgaW50IHN0YXRlKTsKdm9pZCBmaW5pc2hfd2FpdChzdHJ1Y3Qgd2FpdF9xdWV1
ZV9oZWFkICp3cV9oZWFkLCBzdHJ1Y3Qgd2FpdF9xdWV1ZV9lbnRyeSAqd3FfZW50cnkpOwps
b25nIHdhaXRfd29rZW4oc3RydWN0IHdhaXRfcXVldWVfZW50cnkgKndxX2VudHJ5LCB1bnNp
Z25lZCBtb2RlLCBsb25nIHRpbWVvdXQpOwppbnQgd29rZW5fd2FrZV9mdW5jdGlvbihzdHJ1
Y3Qgd2FpdF9xdWV1ZV9lbnRyeSAqd3FfZW50cnksIHVuc2lnbmVkIG1vZGUsIGludCBzeW5j
LCB2b2lkICprZXkpOwppbnQgYXV0b3JlbW92ZV93YWtlX2Z1bmN0aW9uKHN0cnVjdCB3YWl0
X3F1ZXVlX2VudHJ5ICp3cV9lbnRyeSwgdW5zaWduZWQgbW9kZSwgaW50IHN5bmMsIHZvaWQg
KmtleSk7CiMgMTE1MiAiLi9pbmNsdWRlL2xpbnV4L3dhaXQuaCIKYm9vbCB0cnlfaW52b2tl
X29uX2xvY2tlZF9kb3duX3Rhc2soc3RydWN0IHRhc2tfc3RydWN0ICpwLCBib29sICgqZnVu
Yykoc3RydWN0IHRhc2tfc3RydWN0ICp0LCB2b2lkICphcmcpLCB2b2lkICphcmcpOwojIDcg
Ii4vaW5jbHVkZS9saW51eC9waWQuaCIgMgojIDEgIi4vaW5jbHVkZS9saW51eC9yZWZjb3Vu
dC5oIiAxCiMgMTAxICIuL2luY2x1ZGUvbGludXgvcmVmY291bnQuaCIKc3RydWN0IG11dGV4
OwojIDExMSAiLi9pbmNsdWRlL2xpbnV4L3JlZmNvdW50LmgiCnR5cGVkZWYgc3RydWN0IHJl
ZmNvdW50X3N0cnVjdCB7CiBhdG9taWNfdCByZWZzOwp9IHJlZmNvdW50X3Q7CgoKCgoKZW51
bSByZWZjb3VudF9zYXR1cmF0aW9uX3R5cGUgewogUkVGQ09VTlRfQUREX05PVF9aRVJPX09W
RiwKIFJFRkNPVU5UX0FERF9PVkYsCiBSRUZDT1VOVF9BRERfVUFGLAogUkVGQ09VTlRfU1VC
X1VBRiwKIFJFRkNPVU5UX0RFQ19MRUFLLAp9OwoKdm9pZCByZWZjb3VudF93YXJuX3NhdHVy
YXRlKHJlZmNvdW50X3QgKnIsIGVudW0gcmVmY291bnRfc2F0dXJhdGlvbl90eXBlIHQpOwoK
CgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgdm9pZCByZWZjb3VudF9zZXQocmVmY291bnRfdCAqciwgaW50IG4p
CnsKIGF0b21pY19zZXQoJnItPnJlZnMsIG4pOwp9CgoKCgoKCgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWdu
ZWQgaW50IHJlZmNvdW50X3JlYWQoY29uc3QgcmVmY291bnRfdCAqcikKewogcmV0dXJuIGF0
b21pY19yZWFkKCZyLT5yZWZzKTsKfQojIDE2OCAiLi9pbmNsdWRlL2xpbnV4L3JlZmNvdW50
LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkg
Ym9vbCByZWZjb3VudF9hZGRfbm90X3plcm8oaW50IGksIHJlZmNvdW50X3QgKnIpCnsKIGlu
dCBvbGQgPSByZWZjb3VudF9yZWFkKHIpOwoKIGRvIHsKICBpZiAoIW9sZCkKICAgYnJlYWs7
CiB9IHdoaWxlICghYXRvbWljX3RyeV9jbXB4Y2hnX3JlbGF4ZWQoJnItPnJlZnMsICZvbGQs
IG9sZCArIGkpKTsKCiBpZiAoX19idWlsdGluX2V4cGVjdCghIShvbGQgPCAwIHx8IG9sZCAr
IGkgPCAwKSwgMCkpCiAgcmVmY291bnRfd2Fybl9zYXR1cmF0ZShyLCBSRUZDT1VOVF9BRERf
Tk9UX1pFUk9fT1ZGKTsKCiByZXR1cm4gb2xkOwp9CiMgMTk5ICIuL2luY2x1ZGUvbGludXgv
cmVmY291bnQuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgcmVmY291bnRfYWRkKGludCBpLCByZWZjb3Vu
dF90ICpyKQp7CiBpbnQgb2xkID0gYXRvbWljX2ZldGNoX2FkZF9yZWxheGVkKGksICZyLT5y
ZWZzKTsKCiBpZiAoX19idWlsdGluX2V4cGVjdCghISghb2xkKSwgMCkpCiAgcmVmY291bnRf
d2Fybl9zYXR1cmF0ZShyLCBSRUZDT1VOVF9BRERfVUFGKTsKIGVsc2UgaWYgKF9fYnVpbHRp
bl9leHBlY3QoISEob2xkIDwgMCB8fCBvbGQgKyBpIDwgMCksIDApKQogIHJlZmNvdW50X3dh
cm5fc2F0dXJhdGUociwgUkVGQ09VTlRfQUREX09WRik7Cn0KIyAyMjIgIi4vaW5jbHVkZS9s
aW51eC9yZWZjb3VudC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX193YXJuX3VudXNl
ZF9yZXN1bHRfXykpIGJvb2wgcmVmY291bnRfaW5jX25vdF96ZXJvKHJlZmNvdW50X3QgKnIp
CnsKIHJldHVybiByZWZjb3VudF9hZGRfbm90X3plcm8oMSwgcik7Cn0KIyAyMzkgIi4vaW5j
bHVkZS9saW51eC9yZWZjb3VudC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCByZWZjb3VudF9pbmMocmVm
Y291bnRfdCAqcikKewogcmVmY291bnRfYWRkKDEsIHIpOwp9CiMgMjY0ICIuL2luY2x1ZGUv
bGludXgvcmVmY291bnQuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fd2Fybl91bnVz
ZWRfcmVzdWx0X18pKSBib29sIHJlZmNvdW50X3N1Yl9hbmRfdGVzdChpbnQgaSwgcmVmY291
bnRfdCAqcikKewogaW50IG9sZCA9IGF0b21pY19mZXRjaF9zdWJfcmVsZWFzZShpLCAmci0+
cmVmcyk7CgogaWYgKG9sZCA9PSBpKSB7CiAgX19hc21fXyBfX3ZvbGF0aWxlX18gKCJsd3N5
bmMiICIgIiA6IDogOiJtZW1vcnkiKTsKICByZXR1cm4gdHJ1ZTsKIH0KCiBpZiAoX19idWls
dGluX2V4cGVjdCghIShvbGQgPCAwIHx8IG9sZCAtIGkgPCAwKSwgMCkpCiAgcmVmY291bnRf
d2Fybl9zYXR1cmF0ZShyLCBSRUZDT1VOVF9TVUJfVUFGKTsKCiByZXR1cm4gZmFsc2U7Cn0K
IyAyOTIgIi4vaW5jbHVkZS9saW51eC9yZWZjb3VudC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1
dGVfXygoX193YXJuX3VudXNlZF9yZXN1bHRfXykpIGJvb2wgcmVmY291bnRfZGVjX2FuZF90
ZXN0KHJlZmNvdW50X3QgKnIpCnsKIHJldHVybiByZWZjb3VudF9zdWJfYW5kX3Rlc3QoMSwg
cik7Cn0KIyAzMDcgIi4vaW5jbHVkZS9saW51eC9yZWZjb3VudC5oIgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9p
ZCByZWZjb3VudF9kZWMocmVmY291bnRfdCAqcikKewogaWYgKF9fYnVpbHRpbl9leHBlY3Qo
ISEoYXRvbWljX2ZldGNoX3N1Yl9yZWxlYXNlKDEsICZyLT5yZWZzKSA8PSAxKSwgMCkpCiAg
cmVmY291bnRfd2Fybl9zYXR1cmF0ZShyLCBSRUZDT1VOVF9ERUNfTEVBSyk7Cn0KCmV4dGVy
biBfX2F0dHJpYnV0ZV9fKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkgYm9vbCByZWZjb3Vu
dF9kZWNfaWZfb25lKHJlZmNvdW50X3QgKnIpOwpleHRlcm4gX19hdHRyaWJ1dGVfXygoX193
YXJuX3VudXNlZF9yZXN1bHRfXykpIGJvb2wgcmVmY291bnRfZGVjX25vdF9vbmUocmVmY291
bnRfdCAqcik7CmV4dGVybiBfX2F0dHJpYnV0ZV9fKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9f
KSkgYm9vbCByZWZjb3VudF9kZWNfYW5kX211dGV4X2xvY2socmVmY291bnRfdCAqciwgc3Ry
dWN0IG11dGV4ICpsb2NrKTsKZXh0ZXJuIF9fYXR0cmlidXRlX18oKF9fd2Fybl91bnVzZWRf
cmVzdWx0X18pKSBib29sIHJlZmNvdW50X2RlY19hbmRfbG9jayhyZWZjb3VudF90ICpyLCBz
cGlubG9ja190ICpsb2NrKTsKZXh0ZXJuIF9fYXR0cmlidXRlX18oKF9fd2Fybl91bnVzZWRf
cmVzdWx0X18pKSBib29sIHJlZmNvdW50X2RlY19hbmRfbG9ja19pcnFzYXZlKHJlZmNvdW50
X3QgKnIsCiAgICAgICAgICAgICBzcGlubG9ja190ICpsb2NrLAogICAgICAgICAgICAgdW5z
aWduZWQgbG9uZyAqZmxhZ3MpOwojIDggIi4vaW5jbHVkZS9saW51eC9waWQuaCIgMgoKZW51
bSBwaWRfdHlwZQp7CiBQSURUWVBFX1BJRCwKIFBJRFRZUEVfVEdJRCwKIFBJRFRZUEVfUEdJ
RCwKIFBJRFRZUEVfU0lELAogUElEVFlQRV9NQVgsCn07CiMgNTQgIi4vaW5jbHVkZS9saW51
eC9waWQuaCIKc3RydWN0IHVwaWQgewogaW50IG5yOwogc3RydWN0IHBpZF9uYW1lc3BhY2Ug
Km5zOwp9OwoKc3RydWN0IHBpZAp7CiByZWZjb3VudF90IGNvdW50OwogdW5zaWduZWQgaW50
IGxldmVsOwogc3BpbmxvY2tfdCBsb2NrOwoKIHN0cnVjdCBobGlzdF9oZWFkIHRhc2tzW1BJ
RFRZUEVfTUFYXTsKIHN0cnVjdCBobGlzdF9oZWFkIGlub2RlczsKCiB3YWl0X3F1ZXVlX2hl
YWRfdCB3YWl0X3BpZGZkOwogc3RydWN0IGNhbGxiYWNrX2hlYWQgcmN1Owogc3RydWN0IHVw
aWQgbnVtYmVyc1sxXTsKfTsKCmV4dGVybiBzdHJ1Y3QgcGlkIGluaXRfc3RydWN0X3BpZDsK
CmV4dGVybiBjb25zdCBzdHJ1Y3QgZmlsZV9vcGVyYXRpb25zIHBpZGZkX2ZvcHM7CgpzdHJ1
Y3QgZmlsZTsKCmV4dGVybiBzdHJ1Y3QgcGlkICpwaWRmZF9waWQoY29uc3Qgc3RydWN0IGZp
bGUgKmZpbGUpOwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIHN0cnVjdCBwaWQgKmdldF9waWQoc3RydWN0IHBpZCAq
cGlkKQp7CiBpZiAocGlkKQogIHJlZmNvdW50X2luYygmcGlkLT5jb3VudCk7CiByZXR1cm4g
cGlkOwp9CgpleHRlcm4gdm9pZCBwdXRfcGlkKHN0cnVjdCBwaWQgKnBpZCk7CmV4dGVybiBz
dHJ1Y3QgdGFza19zdHJ1Y3QgKnBpZF90YXNrKHN0cnVjdCBwaWQgKnBpZCwgZW51bSBwaWRf
dHlwZSk7CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSBib29sIHBpZF9oYXNfdGFzayhzdHJ1Y3QgcGlkICpwaWQsIGVu
dW0gcGlkX3R5cGUgdHlwZSkKewogcmV0dXJuICFobGlzdF9lbXB0eSgmcGlkLT50YXNrc1t0
eXBlXSk7Cn0KZXh0ZXJuIHN0cnVjdCB0YXNrX3N0cnVjdCAqZ2V0X3BpZF90YXNrKHN0cnVj
dCBwaWQgKnBpZCwgZW51bSBwaWRfdHlwZSk7CgpleHRlcm4gc3RydWN0IHBpZCAqZ2V0X3Rh
c2tfcGlkKHN0cnVjdCB0YXNrX3N0cnVjdCAqdGFzaywgZW51bSBwaWRfdHlwZSB0eXBlKTsK
CgoKCmV4dGVybiB2b2lkIGF0dGFjaF9waWQoc3RydWN0IHRhc2tfc3RydWN0ICp0YXNrLCBl
bnVtIHBpZF90eXBlKTsKZXh0ZXJuIHZvaWQgZGV0YWNoX3BpZChzdHJ1Y3QgdGFza19zdHJ1
Y3QgKnRhc2ssIGVudW0gcGlkX3R5cGUpOwpleHRlcm4gdm9pZCBjaGFuZ2VfcGlkKHN0cnVj
dCB0YXNrX3N0cnVjdCAqdGFzaywgZW51bSBwaWRfdHlwZSwKICAgc3RydWN0IHBpZCAqcGlk
KTsKZXh0ZXJuIHZvaWQgZXhjaGFuZ2VfdGlkcyhzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRhc2ss
IHN0cnVjdCB0YXNrX3N0cnVjdCAqb2xkKTsKZXh0ZXJuIHZvaWQgdHJhbnNmZXJfcGlkKHN0
cnVjdCB0YXNrX3N0cnVjdCAqb2xkLCBzdHJ1Y3QgdGFza19zdHJ1Y3QgKm5ldywKICAgIGVu
dW0gcGlkX3R5cGUpOwoKc3RydWN0IHBpZF9uYW1lc3BhY2U7CmV4dGVybiBzdHJ1Y3QgcGlk
X25hbWVzcGFjZSBpbml0X3BpZF9uczsKCmV4dGVybiBpbnQgcGlkX21heDsKZXh0ZXJuIGlu
dCBwaWRfbWF4X21pbiwgcGlkX21heF9tYXg7CiMgMTI0ICIuL2luY2x1ZGUvbGludXgvcGlk
LmgiCmV4dGVybiBzdHJ1Y3QgcGlkICpmaW5kX3BpZF9ucyhpbnQgbnIsIHN0cnVjdCBwaWRf
bmFtZXNwYWNlICpucyk7CmV4dGVybiBzdHJ1Y3QgcGlkICpmaW5kX3ZwaWQoaW50IG5yKTsK
CgoKCmV4dGVybiBzdHJ1Y3QgcGlkICpmaW5kX2dldF9waWQoaW50IG5yKTsKZXh0ZXJuIHN0
cnVjdCBwaWQgKmZpbmRfZ2VfcGlkKGludCBuciwgc3RydWN0IHBpZF9uYW1lc3BhY2UgKik7
CgpleHRlcm4gc3RydWN0IHBpZCAqYWxsb2NfcGlkKHN0cnVjdCBwaWRfbmFtZXNwYWNlICpu
cywgcGlkX3QgKnNldF90aWQsCiAgICAgICAgc2l6ZV90IHNldF90aWRfc2l6ZSk7CmV4dGVy
biB2b2lkIGZyZWVfcGlkKHN0cnVjdCBwaWQgKnBpZCk7CmV4dGVybiB2b2lkIGRpc2FibGVf
cGlkX2FsbG9jYXRpb24oc3RydWN0IHBpZF9uYW1lc3BhY2UgKm5zKTsKIyAxNDggIi4vaW5j
bHVkZS9saW51eC9waWQuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHN0cnVjdCBwaWRfbmFtZXNwYWNlICpuc19v
Zl9waWQoc3RydWN0IHBpZCAqcGlkKQp7CiBzdHJ1Y3QgcGlkX25hbWVzcGFjZSAqbnMgPSAo
KHZvaWQgKikwKTsKIGlmIChwaWQpCiAgbnMgPSBwaWQtPm51bWJlcnNbcGlkLT5sZXZlbF0u
bnM7CiByZXR1cm4gbnM7Cn0KCgoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIGlzX2NoaWxkX3JlYXBl
cihzdHJ1Y3QgcGlkICpwaWQpCnsKIHJldHVybiBwaWQtPm51bWJlcnNbcGlkLT5sZXZlbF0u
bnIgPT0gMTsKfQojIDE3OCAiLi9pbmNsdWRlL2xpbnV4L3BpZC5oIgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgcGlk
X3QgcGlkX25yKHN0cnVjdCBwaWQgKnBpZCkKewogcGlkX3QgbnIgPSAwOwogaWYgKHBpZCkK
ICBuciA9IHBpZC0+bnVtYmVyc1swXS5ucjsKIHJldHVybiBucjsKfQoKcGlkX3QgcGlkX25y
X25zKHN0cnVjdCBwaWQgKnBpZCwgc3RydWN0IHBpZF9uYW1lc3BhY2UgKm5zKTsKcGlkX3Qg
cGlkX3ZucihzdHJ1Y3QgcGlkICpwaWQpOwojIDE1ICIuL2luY2x1ZGUvbGludXgvc2NoZWQu
aCIgMgojIDEgIi4vaW5jbHVkZS9saW51eC9zZW0uaCIgMQoKCgoKIyAxICIuL2luY2x1ZGUv
dWFwaS9saW51eC9zZW0uaCIgMQoKCgoKIyAxICIuL2luY2x1ZGUvbGludXgvaXBjLmgiIDEK
CgoKCgojIDEgIi4vaW5jbHVkZS9saW51eC91aWRnaWQuaCIgMQojIDE2ICIuL2luY2x1ZGUv
bGludXgvdWlkZ2lkLmgiCiMgMSAiLi9pbmNsdWRlL2xpbnV4L2hpZ2h1aWQuaCIgMQojIDM1
ICIuL2luY2x1ZGUvbGludXgvaGlnaHVpZC5oIgpleHRlcm4gaW50IG92ZXJmbG93dWlkOwpl
eHRlcm4gaW50IG92ZXJmbG93Z2lkOwoKZXh0ZXJuIHZvaWQgX19iYWRfdWlkKHZvaWQpOwpl
eHRlcm4gdm9pZCBfX2JhZF9naWQodm9pZCk7CiMgODIgIi4vaW5jbHVkZS9saW51eC9oaWdo
dWlkLmgiCmV4dGVybiBpbnQgZnNfb3ZlcmZsb3d1aWQ7CmV4dGVybiBpbnQgZnNfb3ZlcmZs
b3dnaWQ7CiMgMTcgIi4vaW5jbHVkZS9saW51eC91aWRnaWQuaCIgMgoKc3RydWN0IHVzZXJf
bmFtZXNwYWNlOwpleHRlcm4gc3RydWN0IHVzZXJfbmFtZXNwYWNlIGluaXRfdXNlcl9uczsK
CnR5cGVkZWYgc3RydWN0IHsKIHVpZF90IHZhbDsKfSBrdWlkX3Q7CgoKdHlwZWRlZiBzdHJ1
Y3QgewogZ2lkX3QgdmFsOwp9IGtnaWRfdDsKCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdWlkX3QgX19rdWlk
X3ZhbChrdWlkX3QgdWlkKQp7CiByZXR1cm4gdWlkLnZhbDsKfQoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGdpZF90
IF9fa2dpZF92YWwoa2dpZF90IGdpZCkKewogcmV0dXJuIGdpZC52YWw7Cn0KIyA2MSAiLi9p
bmNsdWRlL2xpbnV4L3VpZGdpZC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCB1aWRfZXEoa3VpZF90IGxl
ZnQsIGt1aWRfdCByaWdodCkKewogcmV0dXJuIF9fa3VpZF92YWwobGVmdCkgPT0gX19rdWlk
X3ZhbChyaWdodCk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIGdpZF9lcShrZ2lkX3QgbGVmdCwga2dp
ZF90IHJpZ2h0KQp7CiByZXR1cm4gX19rZ2lkX3ZhbChsZWZ0KSA9PSBfX2tnaWRfdmFsKHJp
Z2h0KTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgdWlkX2d0KGt1aWRfdCBsZWZ0LCBrdWlkX3Qgcmln
aHQpCnsKIHJldHVybiBfX2t1aWRfdmFsKGxlZnQpID4gX19rdWlkX3ZhbChyaWdodCk7Cn0K
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSBib29sIGdpZF9ndChrZ2lkX3QgbGVmdCwga2dpZF90IHJpZ2h0KQp7CiBy
ZXR1cm4gX19rZ2lkX3ZhbChsZWZ0KSA+IF9fa2dpZF92YWwocmlnaHQpOwp9CgpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgYm9vbCB1aWRfZ3RlKGt1aWRfdCBsZWZ0LCBrdWlkX3QgcmlnaHQpCnsKIHJldHVybiBf
X2t1aWRfdmFsKGxlZnQpID49IF9fa3VpZF92YWwocmlnaHQpOwp9CgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9v
bCBnaWRfZ3RlKGtnaWRfdCBsZWZ0LCBrZ2lkX3QgcmlnaHQpCnsKIHJldHVybiBfX2tnaWRf
dmFsKGxlZnQpID49IF9fa2dpZF92YWwocmlnaHQpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCB1aWRf
bHQoa3VpZF90IGxlZnQsIGt1aWRfdCByaWdodCkKewogcmV0dXJuIF9fa3VpZF92YWwobGVm
dCkgPCBfX2t1aWRfdmFsKHJpZ2h0KTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgZ2lkX2x0KGtnaWRf
dCBsZWZ0LCBrZ2lkX3QgcmlnaHQpCnsKIHJldHVybiBfX2tnaWRfdmFsKGxlZnQpIDwgX19r
Z2lkX3ZhbChyaWdodCk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIHVpZF9sdGUoa3VpZF90IGxlZnQs
IGt1aWRfdCByaWdodCkKewogcmV0dXJuIF9fa3VpZF92YWwobGVmdCkgPD0gX19rdWlkX3Zh
bChyaWdodCk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIGdpZF9sdGUoa2dpZF90IGxlZnQsIGtnaWRf
dCByaWdodCkKewogcmV0dXJuIF9fa2dpZF92YWwobGVmdCkgPD0gX19rZ2lkX3ZhbChyaWdo
dCk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSBib29sIHVpZF92YWxpZChrdWlkX3QgdWlkKQp7CiByZXR1cm4g
X19rdWlkX3ZhbCh1aWQpICE9ICh1aWRfdCkgLTE7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIGdpZF92
YWxpZChrZ2lkX3QgZ2lkKQp7CiByZXR1cm4gX19rZ2lkX3ZhbChnaWQpICE9IChnaWRfdCkg
LTE7Cn0KIyAxNDMgIi4vaW5jbHVkZS9saW51eC91aWRnaWQuaCIKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGt1aWRf
dCBtYWtlX2t1aWQoc3RydWN0IHVzZXJfbmFtZXNwYWNlICpmcm9tLCB1aWRfdCB1aWQpCnsK
IHJldHVybiAoa3VpZF90KXsgdWlkIH07Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBrZ2lkX3QgbWFrZV9rZ2lk
KHN0cnVjdCB1c2VyX25hbWVzcGFjZSAqZnJvbSwgZ2lkX3QgZ2lkKQp7CiByZXR1cm4gKGtn
aWRfdCl7IGdpZCB9Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdWlkX3QgZnJvbV9rdWlkKHN0cnVjdCB1c2Vy
X25hbWVzcGFjZSAqdG8sIGt1aWRfdCBrdWlkKQp7CiByZXR1cm4gX19rdWlkX3ZhbChrdWlk
KTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIGdpZF90IGZyb21fa2dpZChzdHJ1Y3QgdXNlcl9uYW1lc3BhY2Ug
KnRvLCBrZ2lkX3Qga2dpZCkKewogcmV0dXJuIF9fa2dpZF92YWwoa2dpZCk7Cn0KCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSB1aWRfdCBmcm9tX2t1aWRfbXVuZ2VkKHN0cnVjdCB1c2VyX25hbWVzcGFjZSAqdG8s
IGt1aWRfdCBrdWlkKQp7CiB1aWRfdCB1aWQgPSBmcm9tX2t1aWQodG8sIGt1aWQpOwogaWYg
KHVpZCA9PSAodWlkX3QpLTEpCiAgdWlkID0gb3ZlcmZsb3d1aWQ7CiByZXR1cm4gdWlkOwp9
CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgZ2lkX3QgZnJvbV9rZ2lkX211bmdlZChzdHJ1Y3QgdXNlcl9uYW1lc3Bh
Y2UgKnRvLCBrZ2lkX3Qga2dpZCkKewogZ2lkX3QgZ2lkID0gZnJvbV9rZ2lkKHRvLCBrZ2lk
KTsKIGlmIChnaWQgPT0gKGdpZF90KS0xKQogIGdpZCA9IG92ZXJmbG93Z2lkOwogcmV0dXJu
IGdpZDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIGJvb2wga3VpZF9oYXNfbWFwcGluZyhzdHJ1Y3QgdXNlcl9u
YW1lc3BhY2UgKm5zLCBrdWlkX3QgdWlkKQp7CiByZXR1cm4gdWlkX3ZhbGlkKHVpZCk7Cn0K
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSBib29sIGtnaWRfaGFzX21hcHBpbmcoc3RydWN0IHVzZXJfbmFtZXNwYWNl
ICpucywga2dpZF90IGdpZCkKewogcmV0dXJuIGdpZF92YWxpZChnaWQpOwp9CiMgNyAiLi9p
bmNsdWRlL2xpbnV4L2lwYy5oIiAyCiMgMSAiLi9pbmNsdWRlL2xpbnV4L3JoYXNodGFibGUt
dHlwZXMuaCIgMQojIDE0ICIuL2luY2x1ZGUvbGludXgvcmhhc2h0YWJsZS10eXBlcy5oIgoj
IDEgIi4vaW5jbHVkZS9saW51eC9tdXRleC5oIiAxCiMgMjAgIi4vaW5jbHVkZS9saW51eC9t
dXRleC5oIgojIDEgIi4vaW5jbHVkZS9saW51eC9vc3FfbG9jay5oIiAxCiMgOSAiLi9pbmNs
dWRlL2xpbnV4L29zcV9sb2NrLmgiCnN0cnVjdCBvcHRpbWlzdGljX3NwaW5fbm9kZSB7CiBz
dHJ1Y3Qgb3B0aW1pc3RpY19zcGluX25vZGUgKm5leHQsICpwcmV2OwogaW50IGxvY2tlZDsK
IGludCBjcHU7Cn07CgpzdHJ1Y3Qgb3B0aW1pc3RpY19zcGluX3F1ZXVlIHsKCgoKCiBhdG9t
aWNfdCB0YWlsOwp9OwoKCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBvc3FfbG9ja19pbml0KHN0cnVj
dCBvcHRpbWlzdGljX3NwaW5fcXVldWUgKmxvY2spCnsKIGF0b21pY19zZXQoJmxvY2stPnRh
aWwsICgwKSk7Cn0KCmV4dGVybiBib29sIG9zcV9sb2NrKHN0cnVjdCBvcHRpbWlzdGljX3Nw
aW5fcXVldWUgKmxvY2spOwpleHRlcm4gdm9pZCBvc3FfdW5sb2NrKHN0cnVjdCBvcHRpbWlz
dGljX3NwaW5fcXVldWUgKmxvY2spOwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgb3NxX2lzX2xvY2tlZChz
dHJ1Y3Qgb3B0aW1pc3RpY19zcGluX3F1ZXVlICpsb2NrKQp7CiByZXR1cm4gYXRvbWljX3Jl
YWQoJmxvY2stPnRhaWwpICE9ICgwKTsKfQojIDIxICIuL2luY2x1ZGUvbGludXgvbXV0ZXgu
aCIgMgojIDEgIi4vaW5jbHVkZS9saW51eC9kZWJ1Z19sb2Nrcy5oIiAxCiMgOSAiLi9pbmNs
dWRlL2xpbnV4L2RlYnVnX2xvY2tzLmgiCnN0cnVjdCB0YXNrX3N0cnVjdDsKCmV4dGVybiBp
bnQgZGVidWdfbG9ja3MgX19hdHRyaWJ1dGVfXygoX19zZWN0aW9uX18oIi5kYXRhLi5yZWFk
X21vc3RseSIpKSk7CmV4dGVybiBpbnQgZGVidWdfbG9ja3Nfc2lsZW50IF9fYXR0cmlidXRl
X18oKF9fc2VjdGlvbl9fKCIuZGF0YS4ucmVhZF9tb3N0bHkiKSkpOwoKCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBf
X2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIGludCBfX2RlYnVnX2xvY2tzX29m
Zih2b2lkKQp7CiByZXR1cm4gKHsgdHlwZW9mKCh7IF9fdHlwZW9mX18oKigmZGVidWdfbG9j
a3MpKSBfeF8gPSAoMCk7IChfX3R5cGVvZl9fKCooJmRlYnVnX2xvY2tzKSkpIF9feGNoZ19y
ZWxheGVkKCgmZGVidWdfbG9ja3MpLCAodW5zaWduZWQgbG9uZylfeF8sIHNpemVvZigqKCZk
ZWJ1Z19sb2NrcykpKTsgfSkpIF9fcmV0OyBfX2FzbV9fIF9fdm9sYXRpbGVfXyAoInN5bmMi
IDogOiA6ICJtZW1vcnkiKTsgX19yZXQgPSAoeyBfX3R5cGVvZl9fKCooJmRlYnVnX2xvY2tz
KSkgX3hfID0gKDApOyAoX190eXBlb2ZfXygqKCZkZWJ1Z19sb2NrcykpKSBfX3hjaGdfcmVs
YXhlZCgoJmRlYnVnX2xvY2tzKSwgKHVuc2lnbmVkIGxvbmcpX3hfLCBzaXplb2YoKigmZGVi
dWdfbG9ja3MpKSk7IH0pOyBfX2FzbV9fIF9fdm9sYXRpbGVfXyAoInN5bmMiIDogOiA6ICJt
ZW1vcnkiKTsgX19yZXQ7IH0pOwp9CgoKCgpleHRlcm4gaW50IGRlYnVnX2xvY2tzX29mZih2
b2lkKTsKIyA0OSAiLi9pbmNsdWRlL2xpbnV4L2RlYnVnX2xvY2tzLmgiCnN0cnVjdCB0YXNr
X3N0cnVjdDsKCgoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGRlYnVnX3Nob3dfYWxsX2xvY2tzKHZv
aWQpCnsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgZGVidWdfc2hvd19oZWxkX2xvY2tzKHN0cnVjdCB0
YXNrX3N0cnVjdCAqdGFzaykKewp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZApkZWJ1Z19jaGVja19ub19s
b2Nrc19mcmVlZChjb25zdCB2b2lkICpmcm9tLCB1bnNpZ25lZCBsb25nIGxlbikKewp9Cgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgdm9pZApkZWJ1Z19jaGVja19ub19sb2Nrc19oZWxkKHZvaWQpCnsKfQojIDIy
ICIuL2luY2x1ZGUvbGludXgvbXV0ZXguaCIgMgoKc3RydWN0IHd3X2FjcXVpcmVfY3R4Owoj
IDUzICIuL2luY2x1ZGUvbGludXgvbXV0ZXguaCIKc3RydWN0IG11dGV4IHsKIGF0b21pY19s
b25nX3Qgb3duZXI7CiBzcGlubG9ja190IHdhaXRfbG9jazsKCiBzdHJ1Y3Qgb3B0aW1pc3Rp
Y19zcGluX3F1ZXVlIG9zcTsKCiBzdHJ1Y3QgbGlzdF9oZWFkIHdhaXRfbGlzdDsKCgoKCgoK
fTsKCgoKCgpzdHJ1Y3QgbXV0ZXhfd2FpdGVyIHsKIHN0cnVjdCBsaXN0X2hlYWQgbGlzdDsK
IHN0cnVjdCB0YXNrX3N0cnVjdCAqdGFzazsKIHN0cnVjdCB3d19hY3F1aXJlX2N0eCAqd3df
Y3R4OwoKCgp9OwojIDkyICIuL2luY2x1ZGUvbGludXgvbXV0ZXguaCIKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZv
aWQgbXV0ZXhfZGVzdHJveShzdHJ1Y3QgbXV0ZXggKmxvY2spIHt9CiMgMTMxICIuL2luY2x1
ZGUvbGludXgvbXV0ZXguaCIKZXh0ZXJuIHZvaWQgX19tdXRleF9pbml0KHN0cnVjdCBtdXRl
eCAqbG9jaywgY29uc3QgY2hhciAqbmFtZSwKICAgIHN0cnVjdCBsb2NrX2NsYXNzX2tleSAq
a2V5KTsKCgoKCgoKCmV4dGVybiBib29sIG11dGV4X2lzX2xvY2tlZChzdHJ1Y3QgbXV0ZXgg
KmxvY2spOwojIDE2OCAiLi9pbmNsdWRlL2xpbnV4L211dGV4LmgiCmV4dGVybiB2b2lkIG11
dGV4X2xvY2soc3RydWN0IG11dGV4ICpsb2NrKTsKZXh0ZXJuIGludCBfX2F0dHJpYnV0ZV9f
KChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkgbXV0ZXhfbG9ja19pbnRlcnJ1cHRpYmxlKHN0
cnVjdCBtdXRleCAqbG9jayk7CmV4dGVybiBpbnQgX19hdHRyaWJ1dGVfXygoX193YXJuX3Vu
dXNlZF9yZXN1bHRfXykpIG11dGV4X2xvY2tfa2lsbGFibGUoc3RydWN0IG11dGV4ICpsb2Nr
KTsKZXh0ZXJuIHZvaWQgbXV0ZXhfbG9ja19pbyhzdHJ1Y3QgbXV0ZXggKmxvY2spOwojIDE4
NiAiLi9pbmNsdWRlL2xpbnV4L211dGV4LmgiCmV4dGVybiBpbnQgbXV0ZXhfdHJ5bG9jayhz
dHJ1Y3QgbXV0ZXggKmxvY2spOwpleHRlcm4gdm9pZCBtdXRleF91bmxvY2soc3RydWN0IG11
dGV4ICpsb2NrKTsKCmV4dGVybiBpbnQgYXRvbWljX2RlY19hbmRfbXV0ZXhfbG9jayhhdG9t
aWNfdCAqY250LCBzdHJ1Y3QgbXV0ZXggKmxvY2spOwoKCgoKCmVudW0gbXV0ZXhfdHJ5bG9j
a19yZWN1cnNpdmVfZW51bSB7CiBNVVRFWF9UUllMT0NLX0ZBSUxFRCA9IDAsCiBNVVRFWF9U
UllMT0NLX1NVQ0NFU1MgPSAxLAogTVVURVhfVFJZTE9DS19SRUNVUlNJVkUsCn07CiMgMjEz
ICIuL2luY2x1ZGUvbGludXgvbXV0ZXguaCIKZXh0ZXJuIF9fYXR0cmlidXRlX18oKF9fd2Fy
bl91bnVzZWRfcmVzdWx0X18pKSBlbnVtIG11dGV4X3RyeWxvY2tfcmVjdXJzaXZlX2VudW0K
bXV0ZXhfdHJ5bG9ja19yZWN1cnNpdmUoc3RydWN0IG11dGV4ICpsb2NrKTsKIyAxNSAiLi9p
bmNsdWRlL2xpbnV4L3JoYXNodGFibGUtdHlwZXMuaCIgMgojIDEgIi4vaW5jbHVkZS9saW51
eC93b3JrcXVldWUuaCIgMQojIDkgIi4vaW5jbHVkZS9saW51eC93b3JrcXVldWUuaCIKIyAx
ICIuL2luY2x1ZGUvbGludXgvdGltZXIuaCIgMQoKCgoKCiMgMSAiLi9pbmNsdWRlL2xpbnV4
L2t0aW1lLmgiIDEKIyAyNCAiLi9pbmNsdWRlL2xpbnV4L2t0aW1lLmgiCiMgMSAiLi9pbmNs
dWRlL2xpbnV4L3RpbWUuaCIgMQoKCgoKCiMgMSAiLi9pbmNsdWRlL2xpbnV4L3NlcWxvY2su
aCIgMQojIDY0ICIuL2luY2x1ZGUvbGludXgvc2VxbG9jay5oIgp0eXBlZGVmIHN0cnVjdCBz
ZXFjb3VudCB7CiB1bnNpZ25lZCBzZXF1ZW5jZTsKCgoKfSBzZXFjb3VudF90OwoKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIHZvaWQgX19zZXFjb3VudF9pbml0KHNlcWNvdW50X3QgKnMsIGNvbnN0IGNoYXIgKm5h
bWUsCiAgICAgICBzdHJ1Y3QgbG9ja19jbGFzc19rZXkgKmtleSkKewoKCgogZG8geyAodm9p
ZCkobmFtZSk7ICh2b2lkKShrZXkpOyB9IHdoaWxlICgwKTsKIHMtPnNlcXVlbmNlID0gMDsK
fQojIDEyNCAiLi9pbmNsdWRlL2xpbnV4L3NlcWxvY2suaCIKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHVuc2lnbmVk
IF9fcmVhZF9zZXFjb3VudF9iZWdpbihjb25zdCBzZXFjb3VudF90ICpzKQp7CiB1bnNpZ25l
ZCByZXQ7CgpyZXBlYXQ6CiByZXQgPSAoeyBkbyB7IGV4dGVybiB2b2lkIF9fY29tcGlsZXRp
bWVfYXNzZXJ0XzgyKHZvaWQpIF9fYXR0cmlidXRlX18oKF9fZXJyb3JfXygiVW5zdXBwb3J0
ZWQgYWNjZXNzIHNpemUgZm9yIHtSRUFELFdSSVRFfV9PTkNFKCkuIikpKTsgaWYgKCEoKHNp
emVvZihzLT5zZXF1ZW5jZSkgPT0gc2l6ZW9mKGNoYXIpIHx8IHNpemVvZihzLT5zZXF1ZW5j
ZSkgPT0gc2l6ZW9mKHNob3J0KSB8fCBzaXplb2Yocy0+c2VxdWVuY2UpID09IHNpemVvZihp
bnQpIHx8IHNpemVvZihzLT5zZXF1ZW5jZSkgPT0gc2l6ZW9mKGxvbmcpKSB8fCBzaXplb2Yo
cy0+c2VxdWVuY2UpID09IHNpemVvZihsb25nIGxvbmcpKSkgX19jb21waWxldGltZV9hc3Nl
cnRfODIoKTsgfSB3aGlsZSAoMCk7ICh7IHR5cGVvZiggX0dlbmVyaWMoKHMtPnNlcXVlbmNl
KSwgY2hhcjogKGNoYXIpMCwgdW5zaWduZWQgY2hhcjogKHVuc2lnbmVkIGNoYXIpMCwgc2ln
bmVkIGNoYXI6IChzaWduZWQgY2hhcikwLCB1bnNpZ25lZCBzaG9ydDogKHVuc2lnbmVkIHNo
b3J0KTAsIHNpZ25lZCBzaG9ydDogKHNpZ25lZCBzaG9ydCkwLCB1bnNpZ25lZCBpbnQ6ICh1
bnNpZ25lZCBpbnQpMCwgc2lnbmVkIGludDogKHNpZ25lZCBpbnQpMCwgdW5zaWduZWQgbG9u
ZzogKHVuc2lnbmVkIGxvbmcpMCwgc2lnbmVkIGxvbmc6IChzaWduZWQgbG9uZykwLCB1bnNp
Z25lZCBsb25nIGxvbmc6ICh1bnNpZ25lZCBsb25nIGxvbmcpMCwgc2lnbmVkIGxvbmcgbG9u
ZzogKHNpZ25lZCBsb25nIGxvbmcpMCwgZGVmYXVsdDogKHMtPnNlcXVlbmNlKSkpIF9feCA9
ICgqKGNvbnN0IHZvbGF0aWxlIHR5cGVvZiggX0dlbmVyaWMoKHMtPnNlcXVlbmNlKSwgY2hh
cjogKGNoYXIpMCwgdW5zaWduZWQgY2hhcjogKHVuc2lnbmVkIGNoYXIpMCwgc2lnbmVkIGNo
YXI6IChzaWduZWQgY2hhcikwLCB1bnNpZ25lZCBzaG9ydDogKHVuc2lnbmVkIHNob3J0KTAs
IHNpZ25lZCBzaG9ydDogKHNpZ25lZCBzaG9ydCkwLCB1bnNpZ25lZCBpbnQ6ICh1bnNpZ25l
ZCBpbnQpMCwgc2lnbmVkIGludDogKHNpZ25lZCBpbnQpMCwgdW5zaWduZWQgbG9uZzogKHVu
c2lnbmVkIGxvbmcpMCwgc2lnbmVkIGxvbmc6IChzaWduZWQgbG9uZykwLCB1bnNpZ25lZCBs
b25nIGxvbmc6ICh1bnNpZ25lZCBsb25nIGxvbmcpMCwgc2lnbmVkIGxvbmcgbG9uZzogKHNp
Z25lZCBsb25nIGxvbmcpMCwgZGVmYXVsdDogKHMtPnNlcXVlbmNlKSkpICopJihzLT5zZXF1
ZW5jZSkpOyBkbyB7IH0gd2hpbGUgKDApOyAodHlwZW9mKHMtPnNlcXVlbmNlKSlfX3g7IH0p
OyB9KTsKIGlmIChfX2J1aWx0aW5fZXhwZWN0KCEhKHJldCAmIDEpLCAwKSkgewogIGRvIHsg
YXNtIHZvbGF0aWxlKCJvciAxLDEsMQkgICAgICMgbG93IHByaW9yaXR5Iik7IGFzbSB2b2xh
dGlsZSgib3IgMiwyLDIJICAgICAjIG1lZGl1bSBwcmlvcml0eSIpOyBfX2FzbV9fIF9fdm9s
YXRpbGVfXygiIjogOiA6Im1lbW9yeSIpOyB9IHdoaWxlICgwKTsKICBnb3RvIHJlcGVhdDsK
IH0KIGtjc2FuX2F0b21pY19uZXh0KDEwMDApOwogcmV0dXJuIHJldDsKfQojIDE0NyAiLi9p
bmNsdWRlL2xpbnV4L3NlcWxvY2suaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHVuc2lnbmVkIHJhd19yZWFkX3Nl
cWNvdW50KGNvbnN0IHNlcWNvdW50X3QgKnMpCnsKIHVuc2lnbmVkIHJldCA9ICh7IGRvIHsg
ZXh0ZXJuIHZvaWQgX19jb21waWxldGltZV9hc3NlcnRfODModm9pZCkgX19hdHRyaWJ1dGVf
XygoX19lcnJvcl9fKCJVbnN1cHBvcnRlZCBhY2Nlc3Mgc2l6ZSBmb3Ige1JFQUQsV1JJVEV9
X09OQ0UoKS4iKSkpOyBpZiAoISgoc2l6ZW9mKHMtPnNlcXVlbmNlKSA9PSBzaXplb2YoY2hh
cikgfHwgc2l6ZW9mKHMtPnNlcXVlbmNlKSA9PSBzaXplb2Yoc2hvcnQpIHx8IHNpemVvZihz
LT5zZXF1ZW5jZSkgPT0gc2l6ZW9mKGludCkgfHwgc2l6ZW9mKHMtPnNlcXVlbmNlKSA9PSBz
aXplb2YobG9uZykpIHx8IHNpemVvZihzLT5zZXF1ZW5jZSkgPT0gc2l6ZW9mKGxvbmcgbG9u
ZykpKSBfX2NvbXBpbGV0aW1lX2Fzc2VydF84MygpOyB9IHdoaWxlICgwKTsgKHsgdHlwZW9m
KCBfR2VuZXJpYygocy0+c2VxdWVuY2UpLCBjaGFyOiAoY2hhcikwLCB1bnNpZ25lZCBjaGFy
OiAodW5zaWduZWQgY2hhcikwLCBzaWduZWQgY2hhcjogKHNpZ25lZCBjaGFyKTAsIHVuc2ln
bmVkIHNob3J0OiAodW5zaWduZWQgc2hvcnQpMCwgc2lnbmVkIHNob3J0OiAoc2lnbmVkIHNo
b3J0KTAsIHVuc2lnbmVkIGludDogKHVuc2lnbmVkIGludCkwLCBzaWduZWQgaW50OiAoc2ln
bmVkIGludCkwLCB1bnNpZ25lZCBsb25nOiAodW5zaWduZWQgbG9uZykwLCBzaWduZWQgbG9u
ZzogKHNpZ25lZCBsb25nKTAsIHVuc2lnbmVkIGxvbmcgbG9uZzogKHVuc2lnbmVkIGxvbmcg
bG9uZykwLCBzaWduZWQgbG9uZyBsb25nOiAoc2lnbmVkIGxvbmcgbG9uZykwLCBkZWZhdWx0
OiAocy0+c2VxdWVuY2UpKSkgX194ID0gKCooY29uc3Qgdm9sYXRpbGUgdHlwZW9mKCBfR2Vu
ZXJpYygocy0+c2VxdWVuY2UpLCBjaGFyOiAoY2hhcikwLCB1bnNpZ25lZCBjaGFyOiAodW5z
aWduZWQgY2hhcikwLCBzaWduZWQgY2hhcjogKHNpZ25lZCBjaGFyKTAsIHVuc2lnbmVkIHNo
b3J0OiAodW5zaWduZWQgc2hvcnQpMCwgc2lnbmVkIHNob3J0OiAoc2lnbmVkIHNob3J0KTAs
IHVuc2lnbmVkIGludDogKHVuc2lnbmVkIGludCkwLCBzaWduZWQgaW50OiAoc2lnbmVkIGlu
dCkwLCB1bnNpZ25lZCBsb25nOiAodW5zaWduZWQgbG9uZykwLCBzaWduZWQgbG9uZzogKHNp
Z25lZCBsb25nKTAsIHVuc2lnbmVkIGxvbmcgbG9uZzogKHVuc2lnbmVkIGxvbmcgbG9uZykw
LCBzaWduZWQgbG9uZyBsb25nOiAoc2lnbmVkIGxvbmcgbG9uZykwLCBkZWZhdWx0OiAocy0+
c2VxdWVuY2UpKSkgKikmKHMtPnNlcXVlbmNlKSk7IGRvIHsgfSB3aGlsZSAoMCk7ICh0eXBl
b2Yocy0+c2VxdWVuY2UpKV9feDsgfSk7IH0pOwogX19hc21fXyBfX3ZvbGF0aWxlX18gKCJs
d3N5bmMiICIgIiA6IDogOiJtZW1vcnkiKTsKIGtjc2FuX2F0b21pY19uZXh0KDEwMDApOwog
cmV0dXJuIHJldDsKfQojIDE2NCAiLi9pbmNsdWRlL2xpbnV4L3NlcWxvY2suaCIKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIHVuc2lnbmVkIHJhd19yZWFkX3NlcWNvdW50X2JlZ2luKGNvbnN0IHNlcWNvdW50X3Qg
KnMpCnsKIHVuc2lnbmVkIHJldCA9IF9fcmVhZF9zZXFjb3VudF9iZWdpbihzKTsKIF9fYXNt
X18gX192b2xhdGlsZV9fICgibHdzeW5jIiAiICIgOiA6IDoibWVtb3J5Iik7CiByZXR1cm4g
cmV0Owp9CiMgMTgwICIuL2luY2x1ZGUvbGludXgvc2VxbG9jay5oIgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5z
aWduZWQgcmVhZF9zZXFjb3VudF9iZWdpbihjb25zdCBzZXFjb3VudF90ICpzKQp7CiA7CiBy
ZXR1cm4gcmF3X3JlYWRfc2VxY291bnRfYmVnaW4ocyk7Cn0KIyAyMDAgIi4vaW5jbHVkZS9s
aW51eC9zZXFsb2NrLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1bnNpZ25lZCByYXdfc2VxY291bnRfYmVnaW4o
Y29uc3Qgc2VxY291bnRfdCAqcykKewogdW5zaWduZWQgcmV0ID0gKHsgZG8geyBleHRlcm4g
dm9pZCBfX2NvbXBpbGV0aW1lX2Fzc2VydF84NCh2b2lkKSBfX2F0dHJpYnV0ZV9fKChfX2Vy
cm9yX18oIlVuc3VwcG9ydGVkIGFjY2VzcyBzaXplIGZvciB7UkVBRCxXUklURX1fT05DRSgp
LiIpKSk7IGlmICghKChzaXplb2Yocy0+c2VxdWVuY2UpID09IHNpemVvZihjaGFyKSB8fCBz
aXplb2Yocy0+c2VxdWVuY2UpID09IHNpemVvZihzaG9ydCkgfHwgc2l6ZW9mKHMtPnNlcXVl
bmNlKSA9PSBzaXplb2YoaW50KSB8fCBzaXplb2Yocy0+c2VxdWVuY2UpID09IHNpemVvZihs
b25nKSkgfHwgc2l6ZW9mKHMtPnNlcXVlbmNlKSA9PSBzaXplb2YobG9uZyBsb25nKSkpIF9f
Y29tcGlsZXRpbWVfYXNzZXJ0Xzg0KCk7IH0gd2hpbGUgKDApOyAoeyB0eXBlb2YoIF9HZW5l
cmljKChzLT5zZXF1ZW5jZSksIGNoYXI6IChjaGFyKTAsIHVuc2lnbmVkIGNoYXI6ICh1bnNp
Z25lZCBjaGFyKTAsIHNpZ25lZCBjaGFyOiAoc2lnbmVkIGNoYXIpMCwgdW5zaWduZWQgc2hv
cnQ6ICh1bnNpZ25lZCBzaG9ydCkwLCBzaWduZWQgc2hvcnQ6IChzaWduZWQgc2hvcnQpMCwg
dW5zaWduZWQgaW50OiAodW5zaWduZWQgaW50KTAsIHNpZ25lZCBpbnQ6IChzaWduZWQgaW50
KTAsIHVuc2lnbmVkIGxvbmc6ICh1bnNpZ25lZCBsb25nKTAsIHNpZ25lZCBsb25nOiAoc2ln
bmVkIGxvbmcpMCwgdW5zaWduZWQgbG9uZyBsb25nOiAodW5zaWduZWQgbG9uZyBsb25nKTAs
IHNpZ25lZCBsb25nIGxvbmc6IChzaWduZWQgbG9uZyBsb25nKTAsIGRlZmF1bHQ6IChzLT5z
ZXF1ZW5jZSkpKSBfX3ggPSAoKihjb25zdCB2b2xhdGlsZSB0eXBlb2YoIF9HZW5lcmljKChz
LT5zZXF1ZW5jZSksIGNoYXI6IChjaGFyKTAsIHVuc2lnbmVkIGNoYXI6ICh1bnNpZ25lZCBj
aGFyKTAsIHNpZ25lZCBjaGFyOiAoc2lnbmVkIGNoYXIpMCwgdW5zaWduZWQgc2hvcnQ6ICh1
bnNpZ25lZCBzaG9ydCkwLCBzaWduZWQgc2hvcnQ6IChzaWduZWQgc2hvcnQpMCwgdW5zaWdu
ZWQgaW50OiAodW5zaWduZWQgaW50KTAsIHNpZ25lZCBpbnQ6IChzaWduZWQgaW50KTAsIHVu
c2lnbmVkIGxvbmc6ICh1bnNpZ25lZCBsb25nKTAsIHNpZ25lZCBsb25nOiAoc2lnbmVkIGxv
bmcpMCwgdW5zaWduZWQgbG9uZyBsb25nOiAodW5zaWduZWQgbG9uZyBsb25nKTAsIHNpZ25l
ZCBsb25nIGxvbmc6IChzaWduZWQgbG9uZyBsb25nKTAsIGRlZmF1bHQ6IChzLT5zZXF1ZW5j
ZSkpKSAqKSYocy0+c2VxdWVuY2UpKTsgZG8geyB9IHdoaWxlICgwKTsgKHR5cGVvZihzLT5z
ZXF1ZW5jZSkpX194OyB9KTsgfSk7CiBfX2FzbV9fIF9fdm9sYXRpbGVfXyAoImx3c3luYyIg
IiAiIDogOiA6Im1lbW9yeSIpOwoga2NzYW5fYXRvbWljX25leHQoMTAwMCk7CiByZXR1cm4g
cmV0ICYgfjE7Cn0KIyAyMjIgIi4vaW5jbHVkZS9saW51eC9zZXFsb2NrLmgiCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBpbnQgX19yZWFkX3NlcWNvdW50X3JldHJ5KGNvbnN0IHNlcWNvdW50X3QgKnMsIHVuc2ln
bmVkIHN0YXJ0KQp7CiBrY3Nhbl9hdG9taWNfbmV4dCgwKTsKIHJldHVybiBfX2J1aWx0aW5f
ZXhwZWN0KCEhKCh7IGRvIHsgZXh0ZXJuIHZvaWQgX19jb21waWxldGltZV9hc3NlcnRfODUo
dm9pZCkgX19hdHRyaWJ1dGVfXygoX19lcnJvcl9fKCJVbnN1cHBvcnRlZCBhY2Nlc3Mgc2l6
ZSBmb3Ige1JFQUQsV1JJVEV9X09OQ0UoKS4iKSkpOyBpZiAoISgoc2l6ZW9mKHMtPnNlcXVl
bmNlKSA9PSBzaXplb2YoY2hhcikgfHwgc2l6ZW9mKHMtPnNlcXVlbmNlKSA9PSBzaXplb2Yo
c2hvcnQpIHx8IHNpemVvZihzLT5zZXF1ZW5jZSkgPT0gc2l6ZW9mKGludCkgfHwgc2l6ZW9m
KHMtPnNlcXVlbmNlKSA9PSBzaXplb2YobG9uZykpIHx8IHNpemVvZihzLT5zZXF1ZW5jZSkg
PT0gc2l6ZW9mKGxvbmcgbG9uZykpKSBfX2NvbXBpbGV0aW1lX2Fzc2VydF84NSgpOyB9IHdo
aWxlICgwKTsgKHsgdHlwZW9mKCBfR2VuZXJpYygocy0+c2VxdWVuY2UpLCBjaGFyOiAoY2hh
cikwLCB1bnNpZ25lZCBjaGFyOiAodW5zaWduZWQgY2hhcikwLCBzaWduZWQgY2hhcjogKHNp
Z25lZCBjaGFyKTAsIHVuc2lnbmVkIHNob3J0OiAodW5zaWduZWQgc2hvcnQpMCwgc2lnbmVk
IHNob3J0OiAoc2lnbmVkIHNob3J0KTAsIHVuc2lnbmVkIGludDogKHVuc2lnbmVkIGludCkw
LCBzaWduZWQgaW50OiAoc2lnbmVkIGludCkwLCB1bnNpZ25lZCBsb25nOiAodW5zaWduZWQg
bG9uZykwLCBzaWduZWQgbG9uZzogKHNpZ25lZCBsb25nKTAsIHVuc2lnbmVkIGxvbmcgbG9u
ZzogKHVuc2lnbmVkIGxvbmcgbG9uZykwLCBzaWduZWQgbG9uZyBsb25nOiAoc2lnbmVkIGxv
bmcgbG9uZykwLCBkZWZhdWx0OiAocy0+c2VxdWVuY2UpKSkgX194ID0gKCooY29uc3Qgdm9s
YXRpbGUgdHlwZW9mKCBfR2VuZXJpYygocy0+c2VxdWVuY2UpLCBjaGFyOiAoY2hhcikwLCB1
bnNpZ25lZCBjaGFyOiAodW5zaWduZWQgY2hhcikwLCBzaWduZWQgY2hhcjogKHNpZ25lZCBj
aGFyKTAsIHVuc2lnbmVkIHNob3J0OiAodW5zaWduZWQgc2hvcnQpMCwgc2lnbmVkIHNob3J0
OiAoc2lnbmVkIHNob3J0KTAsIHVuc2lnbmVkIGludDogKHVuc2lnbmVkIGludCkwLCBzaWdu
ZWQgaW50OiAoc2lnbmVkIGludCkwLCB1bnNpZ25lZCBsb25nOiAodW5zaWduZWQgbG9uZykw
LCBzaWduZWQgbG9uZzogKHNpZ25lZCBsb25nKTAsIHVuc2lnbmVkIGxvbmcgbG9uZzogKHVu
c2lnbmVkIGxvbmcgbG9uZykwLCBzaWduZWQgbG9uZyBsb25nOiAoc2lnbmVkIGxvbmcgbG9u
ZykwLCBkZWZhdWx0OiAocy0+c2VxdWVuY2UpKSkgKikmKHMtPnNlcXVlbmNlKSk7IGRvIHsg
fSB3aGlsZSAoMCk7ICh0eXBlb2Yocy0+c2VxdWVuY2UpKV9feDsgfSk7IH0pICE9IHN0YXJ0
KSwgMCk7Cn0KIyAyMzggIi4vaW5jbHVkZS9saW51eC9zZXFsb2NrLmgiCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBp
bnQgcmVhZF9zZXFjb3VudF9yZXRyeShjb25zdCBzZXFjb3VudF90ICpzLCB1bnNpZ25lZCBz
dGFydCkKewogX19hc21fXyBfX3ZvbGF0aWxlX18gKCJsd3N5bmMiICIgIiA6IDogOiJtZW1v
cnkiKTsKIHJldHVybiBfX3JlYWRfc2VxY291bnRfcmV0cnkocywgc3RhcnQpOwp9CgoKCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSB2b2lkIHJhd193cml0ZV9zZXFjb3VudF9iZWdpbihzZXFjb3VudF90ICpzKQp7
CiBrY3Nhbl9uZXN0YWJsZV9hdG9taWNfYmVnaW4oKTsKIHMtPnNlcXVlbmNlKys7CiBfX2Fz
bV9fIF9fdm9sYXRpbGVfXyAoImx3c3luYyIgIiAiIDogOiA6Im1lbW9yeSIpOwp9CgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgdm9pZCByYXdfd3JpdGVfc2VxY291bnRfZW5kKHNlcWNvdW50X3QgKnMpCnsKIF9f
YXNtX18gX192b2xhdGlsZV9fICgibHdzeW5jIiAiICIgOiA6IDoibWVtb3J5Iik7CiBzLT5z
ZXF1ZW5jZSsrOwoga2NzYW5fbmVzdGFibGVfYXRvbWljX2VuZCgpOwp9CiMgMzAxICIuL2lu
Y2x1ZGUvbGludXgvc2VxbG9jay5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCByYXdfd3JpdGVfc2VxY291
bnRfYmFycmllcihzZXFjb3VudF90ICpzKQp7CiBrY3Nhbl9uZXN0YWJsZV9hdG9taWNfYmVn
aW4oKTsKIHMtPnNlcXVlbmNlKys7CiBfX2FzbV9fIF9fdm9sYXRpbGVfXyAoImx3c3luYyIg
IiAiIDogOiA6Im1lbW9yeSIpOwogcy0+c2VxdWVuY2UrKzsKIGtjc2FuX25lc3RhYmxlX2F0
b21pY19lbmQoKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCByYXdfcmVhZF9zZXFjb3VudF9sYXRjaChz
ZXFjb3VudF90ICpzKQp7CgogaW50IHNlcSA9ICh7IGRvIHsgZXh0ZXJuIHZvaWQgX19jb21w
aWxldGltZV9hc3NlcnRfODYodm9pZCkgX19hdHRyaWJ1dGVfXygoX19lcnJvcl9fKCJVbnN1
cHBvcnRlZCBhY2Nlc3Mgc2l6ZSBmb3Ige1JFQUQsV1JJVEV9X09OQ0UoKS4iKSkpOyBpZiAo
ISgoc2l6ZW9mKHMtPnNlcXVlbmNlKSA9PSBzaXplb2YoY2hhcikgfHwgc2l6ZW9mKHMtPnNl
cXVlbmNlKSA9PSBzaXplb2Yoc2hvcnQpIHx8IHNpemVvZihzLT5zZXF1ZW5jZSkgPT0gc2l6
ZW9mKGludCkgfHwgc2l6ZW9mKHMtPnNlcXVlbmNlKSA9PSBzaXplb2YobG9uZykpIHx8IHNp
emVvZihzLT5zZXF1ZW5jZSkgPT0gc2l6ZW9mKGxvbmcgbG9uZykpKSBfX2NvbXBpbGV0aW1l
X2Fzc2VydF84NigpOyB9IHdoaWxlICgwKTsgKHsgdHlwZW9mKCBfR2VuZXJpYygocy0+c2Vx
dWVuY2UpLCBjaGFyOiAoY2hhcikwLCB1bnNpZ25lZCBjaGFyOiAodW5zaWduZWQgY2hhcikw
LCBzaWduZWQgY2hhcjogKHNpZ25lZCBjaGFyKTAsIHVuc2lnbmVkIHNob3J0OiAodW5zaWdu
ZWQgc2hvcnQpMCwgc2lnbmVkIHNob3J0OiAoc2lnbmVkIHNob3J0KTAsIHVuc2lnbmVkIGlu
dDogKHVuc2lnbmVkIGludCkwLCBzaWduZWQgaW50OiAoc2lnbmVkIGludCkwLCB1bnNpZ25l
ZCBsb25nOiAodW5zaWduZWQgbG9uZykwLCBzaWduZWQgbG9uZzogKHNpZ25lZCBsb25nKTAs
IHVuc2lnbmVkIGxvbmcgbG9uZzogKHVuc2lnbmVkIGxvbmcgbG9uZykwLCBzaWduZWQgbG9u
ZyBsb25nOiAoc2lnbmVkIGxvbmcgbG9uZykwLCBkZWZhdWx0OiAocy0+c2VxdWVuY2UpKSkg
X194ID0gKCooY29uc3Qgdm9sYXRpbGUgdHlwZW9mKCBfR2VuZXJpYygocy0+c2VxdWVuY2Up
LCBjaGFyOiAoY2hhcikwLCB1bnNpZ25lZCBjaGFyOiAodW5zaWduZWQgY2hhcikwLCBzaWdu
ZWQgY2hhcjogKHNpZ25lZCBjaGFyKTAsIHVuc2lnbmVkIHNob3J0OiAodW5zaWduZWQgc2hv
cnQpMCwgc2lnbmVkIHNob3J0OiAoc2lnbmVkIHNob3J0KTAsIHVuc2lnbmVkIGludDogKHVu
c2lnbmVkIGludCkwLCBzaWduZWQgaW50OiAoc2lnbmVkIGludCkwLCB1bnNpZ25lZCBsb25n
OiAodW5zaWduZWQgbG9uZykwLCBzaWduZWQgbG9uZzogKHNpZ25lZCBsb25nKTAsIHVuc2ln
bmVkIGxvbmcgbG9uZzogKHVuc2lnbmVkIGxvbmcgbG9uZykwLCBzaWduZWQgbG9uZyBsb25n
OiAoc2lnbmVkIGxvbmcgbG9uZykwLCBkZWZhdWx0OiAocy0+c2VxdWVuY2UpKSkgKikmKHMt
PnNlcXVlbmNlKSk7IGRvIHsgfSB3aGlsZSAoMCk7ICh0eXBlb2Yocy0+c2VxdWVuY2UpKV9f
eDsgfSk7IH0pOwogcmV0dXJuIHNlcTsKfQojIDM5NCAiLi9pbmNsdWRlL2xpbnV4L3NlcWxv
Y2suaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIHZvaWQgcmF3X3dyaXRlX3NlcWNvdW50X2xhdGNoKHNlcWNvdW50
X3QgKnMpCnsKICAgICAgIF9fYXNtX18gX192b2xhdGlsZV9fICgibHdzeW5jIiAiICIgOiA6
IDoibWVtb3J5Iik7CiAgICAgICBzLT5zZXF1ZW5jZSsrOwogICAgICAgX19hc21fXyBfX3Zv
bGF0aWxlX18gKCJsd3N5bmMiICIgIiA6IDogOiJtZW1vcnkiKTsKfQoKCgoKCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSB2b2lkIHdyaXRlX3NlcWNvdW50X2JlZ2luX25lc3RlZChzZXFjb3VudF90ICpzLCBpbnQg
c3ViY2xhc3MpCnsKIHJhd193cml0ZV9zZXFjb3VudF9iZWdpbihzKTsKIGRvIHsgfSB3aGls
ZSAoMCk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHdyaXRlX3NlcWNvdW50X2JlZ2luKHNlcWNvdW50
X3QgKnMpCnsKIHdyaXRlX3NlcWNvdW50X2JlZ2luX25lc3RlZChzLCAwKTsKfQoKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIHZvaWQgd3JpdGVfc2VxY291bnRfZW5kKHNlcWNvdW50X3QgKnMpCnsKIGRvIHsgfSB3
aGlsZSAoMCk7CiByYXdfd3JpdGVfc2VxY291bnRfZW5kKHMpOwp9CiMgNDI5ICIuL2luY2x1
ZGUvbGludXgvc2VxbG9jay5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCB3cml0ZV9zZXFjb3VudF9pbnZh
bGlkYXRlKHNlcWNvdW50X3QgKnMpCnsKIF9fYXNtX18gX192b2xhdGlsZV9fICgibHdzeW5j
IiAiICIgOiA6IDoibWVtb3J5Iik7CiBrY3Nhbl9uZXN0YWJsZV9hdG9taWNfYmVnaW4oKTsK
IHMtPnNlcXVlbmNlKz0yOwoga2NzYW5fbmVzdGFibGVfYXRvbWljX2VuZCgpOwp9Cgp0eXBl
ZGVmIHN0cnVjdCB7CiBzdHJ1Y3Qgc2VxY291bnQgc2VxY291bnQ7CiBzcGlubG9ja190IGxv
Y2s7Cn0gc2VxbG9ja190OwojIDQ2NCAiLi9pbmNsdWRlL2xpbnV4L3NlcWxvY2suaCIKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIHVuc2lnbmVkIHJlYWRfc2VxYmVnaW4oY29uc3Qgc2VxbG9ja190ICpzbCkKewog
dW5zaWduZWQgcmV0ID0gcmVhZF9zZXFjb3VudF9iZWdpbigmc2wtPnNlcWNvdW50KTsKCiBr
Y3Nhbl9hdG9taWNfbmV4dCgwKTsKIGtjc2FuX2ZsYXRfYXRvbWljX2JlZ2luKCk7CiByZXR1
cm4gcmV0Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgcmVhZF9zZXFyZXRyeShjb25zdCBzZXFs
b2NrX3QgKnNsLCB1bnNpZ25lZCBzdGFydCkKewoKCgoKIGtjc2FuX2ZsYXRfYXRvbWljX2Vu
ZCgpOwoKIHJldHVybiByZWFkX3NlcWNvdW50X3JldHJ5KCZzbC0+c2VxY291bnQsIHN0YXJ0
KTsKfQoKCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCB3cml0ZV9zZXFsb2NrKHNlcWxvY2tfdCAqc2wp
CnsKIHNwaW5fbG9jaygmc2wtPmxvY2spOwogd3JpdGVfc2VxY291bnRfYmVnaW4oJnNsLT5z
ZXFjb3VudCk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHdyaXRlX3NlcXVubG9jayhzZXFsb2NrX3Qg
KnNsKQp7CiB3cml0ZV9zZXFjb3VudF9lbmQoJnNsLT5zZXFjb3VudCk7CiBzcGluX3VubG9j
aygmc2wtPmxvY2spOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCB3cml0ZV9zZXFsb2NrX2JoKHNlcWxv
Y2tfdCAqc2wpCnsKIHNwaW5fbG9ja19iaCgmc2wtPmxvY2spOwogd3JpdGVfc2VxY291bnRf
YmVnaW4oJnNsLT5zZXFjb3VudCk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHdyaXRlX3NlcXVubG9j
a19iaChzZXFsb2NrX3QgKnNsKQp7CiB3cml0ZV9zZXFjb3VudF9lbmQoJnNsLT5zZXFjb3Vu
dCk7CiBzcGluX3VubG9ja19iaCgmc2wtPmxvY2spOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCB3cml0
ZV9zZXFsb2NrX2lycShzZXFsb2NrX3QgKnNsKQp7CiBzcGluX2xvY2tfaXJxKCZzbC0+bG9j
ayk7CiB3cml0ZV9zZXFjb3VudF9iZWdpbigmc2wtPnNlcWNvdW50KTsKfQoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IHZvaWQgd3JpdGVfc2VxdW5sb2NrX2lycShzZXFsb2NrX3QgKnNsKQp7CiB3cml0ZV9zZXFj
b3VudF9lbmQoJnNsLT5zZXFjb3VudCk7CiBzcGluX3VubG9ja19pcnEoJnNsLT5sb2NrKTsK
fQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIHVuc2lnbmVkIGxvbmcgX193cml0ZV9zZXFsb2NrX2lycXNhdmUoc2Vx
bG9ja190ICpzbCkKewogdW5zaWduZWQgbG9uZyBmbGFnczsKCiBkbyB7IGRvIHsgKHsgdW5z
aWduZWQgbG9uZyBfX2R1bW15OyB0eXBlb2YoZmxhZ3MpIF9fZHVtbXkyOyAodm9pZCkoJl9f
ZHVtbXkgPT0gJl9fZHVtbXkyKTsgMTsgfSk7IGZsYWdzID0gX3Jhd19zcGluX2xvY2tfaXJx
c2F2ZShzcGlubG9ja19jaGVjaygmc2wtPmxvY2spKTsgfSB3aGlsZSAoMCk7IH0gd2hpbGUg
KDApOwogd3JpdGVfc2VxY291bnRfYmVnaW4oJnNsLT5zZXFjb3VudCk7CiByZXR1cm4gZmxh
Z3M7Cn0KCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkCndyaXRlX3NlcXVubG9ja19pcnFyZXN0b3JlKHNl
cWxvY2tfdCAqc2wsIHVuc2lnbmVkIGxvbmcgZmxhZ3MpCnsKIHdyaXRlX3NlcWNvdW50X2Vu
ZCgmc2wtPnNlcWNvdW50KTsKIHNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJnNsLT5sb2NrLCBm
bGFncyk7Cn0KCgoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgcmVhZF9zZXFsb2NrX2V4Y2woc2VxbG9j
a190ICpzbCkKewogc3Bpbl9sb2NrKCZzbC0+bG9jayk7Cn0KCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHJl
YWRfc2VxdW5sb2NrX2V4Y2woc2VxbG9ja190ICpzbCkKewogc3Bpbl91bmxvY2soJnNsLT5s
b2NrKTsKfQojIDU2OSAiLi9pbmNsdWRlL2xpbnV4L3NlcWxvY2suaCIKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZv
aWQgcmVhZF9zZXFiZWdpbl9vcl9sb2NrKHNlcWxvY2tfdCAqbG9jaywgaW50ICpzZXEpCnsK
IGlmICghKCpzZXEgJiAxKSkKICAqc2VxID0gcmVhZF9zZXFiZWdpbihsb2NrKTsKIGVsc2UK
ICByZWFkX3NlcWxvY2tfZXhjbChsb2NrKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBuZWVkX3NlcXJl
dHJ5KHNlcWxvY2tfdCAqbG9jaywgaW50IHNlcSkKewogcmV0dXJuICEoc2VxICYgMSkgJiYg
cmVhZF9zZXFyZXRyeShsb2NrLCBzZXEpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBkb25lX3NlcXJl
dHJ5KHNlcWxvY2tfdCAqbG9jaywgaW50IHNlcSkKewogaWYgKHNlcSAmIDEpCiAgcmVhZF9z
ZXF1bmxvY2tfZXhjbChsb2NrKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgcmVhZF9zZXFsb2NrX2V4
Y2xfYmgoc2VxbG9ja190ICpzbCkKewogc3Bpbl9sb2NrX2JoKCZzbC0+bG9jayk7Cn0KCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSB2b2lkIHJlYWRfc2VxdW5sb2NrX2V4Y2xfYmgoc2VxbG9ja190ICpzbCkKewog
c3Bpbl91bmxvY2tfYmgoJnNsLT5sb2NrKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgcmVhZF9zZXFs
b2NrX2V4Y2xfaXJxKHNlcWxvY2tfdCAqc2wpCnsKIHNwaW5fbG9ja19pcnEoJnNsLT5sb2Nr
KTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIHZvaWQgcmVhZF9zZXF1bmxvY2tfZXhjbF9pcnEoc2VxbG9ja190
ICpzbCkKewogc3Bpbl91bmxvY2tfaXJxKCZzbC0+bG9jayk7Cn0KCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1bnNp
Z25lZCBsb25nIF9fcmVhZF9zZXFsb2NrX2V4Y2xfaXJxc2F2ZShzZXFsb2NrX3QgKnNsKQp7
CiB1bnNpZ25lZCBsb25nIGZsYWdzOwoKIGRvIHsgZG8geyAoeyB1bnNpZ25lZCBsb25nIF9f
ZHVtbXk7IHR5cGVvZihmbGFncykgX19kdW1teTI7ICh2b2lkKSgmX19kdW1teSA9PSAmX19k
dW1teTIpOyAxOyB9KTsgZmxhZ3MgPSBfcmF3X3NwaW5fbG9ja19pcnFzYXZlKHNwaW5sb2Nr
X2NoZWNrKCZzbC0+bG9jaykpOyB9IHdoaWxlICgwKTsgfSB3aGlsZSAoMCk7CiByZXR1cm4g
ZmxhZ3M7Cn0KCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkCnJlYWRfc2VxdW5sb2NrX2V4Y2xfaXJxcmVz
dG9yZShzZXFsb2NrX3QgKnNsLCB1bnNpZ25lZCBsb25nIGZsYWdzKQp7CiBzcGluX3VubG9j
a19pcnFyZXN0b3JlKCZzbC0+bG9jaywgZmxhZ3MpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQg
bG9uZwpyZWFkX3NlcWJlZ2luX29yX2xvY2tfaXJxc2F2ZShzZXFsb2NrX3QgKmxvY2ssIGlu
dCAqc2VxKQp7CiB1bnNpZ25lZCBsb25nIGZsYWdzID0gMDsKCiBpZiAoISgqc2VxICYgMSkp
CiAgKnNlcSA9IHJlYWRfc2VxYmVnaW4obG9jayk7CiBlbHNlCiAgZG8geyBmbGFncyA9IF9f
cmVhZF9zZXFsb2NrX2V4Y2xfaXJxc2F2ZShsb2NrKTsgfSB3aGlsZSAoMCk7CgogcmV0dXJu
IGZsYWdzOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZApkb25lX3NlcXJldHJ5X2lycXJlc3RvcmUoc2Vx
bG9ja190ICpsb2NrLCBpbnQgc2VxLCB1bnNpZ25lZCBsb25nIGZsYWdzKQp7CiBpZiAoc2Vx
ICYgMSkKICByZWFkX3NlcXVubG9ja19leGNsX2lycXJlc3RvcmUobG9jaywgZmxhZ3MpOwp9
CiMgNyAiLi9pbmNsdWRlL2xpbnV4L3RpbWUuaCIgMgoKCgpleHRlcm4gc3RydWN0IHRpbWV6
b25lIHN5c190ejsKCmludCBnZXRfdGltZXNwZWM2NChzdHJ1Y3QgdGltZXNwZWM2NCAqdHMs
CiAgY29uc3Qgc3RydWN0IF9fa2VybmVsX3RpbWVzcGVjICp1dHMpOwppbnQgcHV0X3RpbWVz
cGVjNjQoY29uc3Qgc3RydWN0IHRpbWVzcGVjNjQgKnRzLAogIHN0cnVjdCBfX2tlcm5lbF90
aW1lc3BlYyAqdXRzKTsKaW50IGdldF9pdGltZXJzcGVjNjQoc3RydWN0IGl0aW1lcnNwZWM2
NCAqaXQsCiAgIGNvbnN0IHN0cnVjdCBfX2tlcm5lbF9pdGltZXJzcGVjICp1aXQpOwppbnQg
cHV0X2l0aW1lcnNwZWM2NChjb25zdCBzdHJ1Y3QgaXRpbWVyc3BlYzY0ICppdCwKICAgc3Ry
dWN0IF9fa2VybmVsX2l0aW1lcnNwZWMgKnVpdCk7CgpleHRlcm4gdGltZTY0X3QgbWt0aW1l
NjQoY29uc3QgdW5zaWduZWQgaW50IHllYXIsIGNvbnN0IHVuc2lnbmVkIGludCBtb24sCiAg
IGNvbnN0IHVuc2lnbmVkIGludCBkYXksIGNvbnN0IHVuc2lnbmVkIGludCBob3VyLAogICBj
b25zdCB1bnNpZ25lZCBpbnQgbWluLCBjb25zdCB1bnNpZ25lZCBpbnQgc2VjKTsKIyAzOSAi
Li9pbmNsdWRlL2xpbnV4L3RpbWUuaCIKZXh0ZXJuIHZvaWQgY2xlYXJfaXRpbWVyKHZvaWQp
OwoKCgoKZXh0ZXJuIGxvbmcgZG9fdXRpbWVzKGludCBkZmQsIGNvbnN0IGNoYXIgKmZpbGVu
YW1lLCBzdHJ1Y3QgdGltZXNwZWM2NCAqdGltZXMsIGludCBmbGFncyk7CgoKCgoKc3RydWN0
IHRtIHsKCgoKCiBpbnQgdG1fc2VjOwoKIGludCB0bV9taW47CgogaW50IHRtX2hvdXI7Cgog
aW50IHRtX21kYXk7CgogaW50IHRtX21vbjsKCiBsb25nIHRtX3llYXI7CgogaW50IHRtX3dk
YXk7CgogaW50IHRtX3lkYXk7Cn07Cgp2b2lkIHRpbWU2NF90b190bSh0aW1lNjRfdCB0b3Rh
bHNlY3MsIGludCBvZmZzZXQsIHN0cnVjdCB0bSAqcmVzdWx0KTsKCiMgMSAiLi9pbmNsdWRl
L2xpbnV4L3RpbWUzMi5oIiAxCiMgMTMgIi4vaW5jbHVkZS9saW51eC90aW1lMzIuaCIKIyAx
ICIuL2luY2x1ZGUvbGludXgvdGltZXguaCIgMQojIDU2ICIuL2luY2x1ZGUvbGludXgvdGlt
ZXguaCIKIyAxICIuL2luY2x1ZGUvdWFwaS9saW51eC90aW1leC5oIiAxCiMgNTYgIi4vaW5j
bHVkZS91YXBpL2xpbnV4L3RpbWV4LmgiCiMgMSAiLi9pbmNsdWRlL2xpbnV4L3RpbWUuaCIg
MQojIDU3ICIuL2luY2x1ZGUvdWFwaS9saW51eC90aW1leC5oIiAyCiMgOTcgIi4vaW5jbHVk
ZS91YXBpL2xpbnV4L3RpbWV4LmgiCnN0cnVjdCBfX2tlcm5lbF90aW1leF90aW1ldmFsIHsK
IF9fa2VybmVsX3RpbWU2NF90IHR2X3NlYzsKIGxvbmcgbG9uZyB0dl91c2VjOwp9OwoKc3Ry
dWN0IF9fa2VybmVsX3RpbWV4IHsKIHVuc2lnbmVkIGludCBtb2RlczsKIGludCA6MzI7CiBs
b25nIGxvbmcgb2Zmc2V0OwogbG9uZyBsb25nIGZyZXE7CiBsb25nIGxvbmcgbWF4ZXJyb3I7
CiBsb25nIGxvbmcgZXN0ZXJyb3I7CiBpbnQgc3RhdHVzOwogaW50IDozMjsKIGxvbmcgbG9u
ZyBjb25zdGFudDsKIGxvbmcgbG9uZyBwcmVjaXNpb247CiBsb25nIGxvbmcgdG9sZXJhbmNl
OwoKCiBzdHJ1Y3QgX19rZXJuZWxfdGltZXhfdGltZXZhbCB0aW1lOwogbG9uZyBsb25nIHRp
Y2s7CgogbG9uZyBsb25nIHBwc2ZyZXE7CiBsb25nIGxvbmcgaml0dGVyOwogaW50IHNoaWZ0
OwogaW50IDozMjsKIGxvbmcgbG9uZyBzdGFiaWw7CiBsb25nIGxvbmcgaml0Y250OwogbG9u
ZyBsb25nIGNhbGNudDsKIGxvbmcgbG9uZyBlcnJjbnQ7CiBsb25nIGxvbmcgc3RiY250OwoK
IGludCB0YWk7CgogaW50IDozMjsgaW50IDozMjsgaW50IDozMjsgaW50IDozMjsKIGludCA6
MzI7IGludCA6MzI7IGludCA6MzI7IGludCA6MzI7CiBpbnQgOjMyOyBpbnQgOjMyOyBpbnQg
OjMyOwp9OwojIDU3ICIuL2luY2x1ZGUvbGludXgvdGltZXguaCIgMgoKCgoKCgojIDEgIi4v
aW5jbHVkZS91YXBpL2xpbnV4L3BhcmFtLmgiIDEKCgoKCiMgMSAiLi9hcmNoL3Bvd2VycGMv
aW5jbHVkZS9nZW5lcmF0ZWQvdWFwaS9hc20vcGFyYW0uaCIgMQojIDEgIi4vaW5jbHVkZS9h
c20tZ2VuZXJpYy9wYXJhbS5oIiAxCgoKCgojIDEgIi4vaW5jbHVkZS91YXBpL2FzbS1nZW5l
cmljL3BhcmFtLmgiIDEKIyA2ICIuL2luY2x1ZGUvYXNtLWdlbmVyaWMvcGFyYW0uaCIgMgoj
IDEgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvZ2VuZXJhdGVkL3VhcGkvYXNtL3BhcmFtLmgi
IDIKIyA2ICIuL2luY2x1ZGUvdWFwaS9saW51eC9wYXJhbS5oIiAyCiMgNjQgIi4vaW5jbHVk
ZS9saW51eC90aW1leC5oIiAyCgojIDEgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL3Rp
bWV4LmgiIDEKIyAxNiAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vdGltZXguaCIKdHlw
ZWRlZiB1bnNpZ25lZCBsb25nIGN5Y2xlc190OwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGN5Y2xlc190IGdldF9j
eWNsZXModm9pZCkKewogaWYgKDApCiAgcmV0dXJuIDA7CgogcmV0dXJuICh7dW5zaWduZWQg
bG9uZyBydmFsOyBhc20gdm9sYXRpbGUoICI5MDoJbWZzcHIgJTAsICUyO1xuIiAiOTcxOiIg
IiAiICI5NzoJY21wd2kgJTAsMDtcbiIgIgliZXEtIDkwYjtcbiIgIjsgIiAiOTcyOiAucHVz
aHNlY3Rpb24gX19mdHJfYWx0Xzk3LFwiYVwiOyAuYWxpZ24gMjsgOTczOiIgIiAiICIiICI7
ICIgIjk3NDogLnBvcHNlY3Rpb247IC5wdXNoc2VjdGlvbiBfX2Z0cl9maXh1cCxcImFcIjsg
LmFsaWduIDM7IDk3NTogLjhieXRlICgoJTEpKTsgLjhieXRlICgoJTEpKTsgLjhieXRlIDk3
MWItOTc1YjsgLjhieXRlIDk3MmItOTc1YjsgLjhieXRlIDk3M2ItOTc1YjsgLjhieXRlIDk3
NGItOTc1YjsgLmlmZ3QgKDk3NGItIDk3M2IpLSg5NzJiLSA5NzFiKTsgLmVycm9yIFwiRmVh
dHVyZSBzZWN0aW9uIGVsc2UgY2FzZSBsYXJnZXIgdGhhbiBib2R5XCI7IC5lbmRpZjsgLnBv
cHNlY3Rpb247IiAiICIgOiAiPXIiIChydmFsKSA6ICJpIiAoMHgwMDAwMDAwMDAwODAwMDAw
VUwpLCAiaSIgKDB4MTBDKSA6ICJjcjAiKTsgcnZhbDt9KTsKfQojIDY2ICIuL2luY2x1ZGUv
bGludXgvdGltZXguaCIgMgojIDEzOSAiLi9pbmNsdWRlL2xpbnV4L3RpbWV4LmgiCmV4dGVy
biB1bnNpZ25lZCBsb25nIHRpY2tfdXNlYzsKZXh0ZXJuIHVuc2lnbmVkIGxvbmcgdGlja19u
c2VjOwojIDE1NCAiLi9pbmNsdWRlL2xpbnV4L3RpbWV4LmgiCmV4dGVybiBpbnQgZG9fYWRq
dGltZXgoc3RydWN0IF9fa2VybmVsX3RpbWV4ICopOwpleHRlcm4gaW50IGRvX2Nsb2NrX2Fk
anRpbWUoY29uc3QgY2xvY2tpZF90IHdoaWNoX2Nsb2NrLCBzdHJ1Y3QgX19rZXJuZWxfdGlt
ZXggKiBrdHgpOwoKZXh0ZXJuIHZvaWQgaGFyZHBwcyhjb25zdCBzdHJ1Y3QgdGltZXNwZWM2
NCAqLCBjb25zdCBzdHJ1Y3QgdGltZXNwZWM2NCAqKTsKCmludCByZWFkX2N1cnJlbnRfdGlt
ZXIodW5zaWduZWQgbG9uZyAqdGltZXJfdmFsKTsKdm9pZCBudHBfbm90aWZ5X2Ntb3NfdGlt
ZXIodm9pZCk7CiMgMTQgIi4vaW5jbHVkZS9saW51eC90aW1lMzIuaCIgMgoKIyAxICIuL2lu
Y2x1ZGUvdmRzby90aW1lMzIuaCIgMQoKCgoKdHlwZWRlZiBzMzIgb2xkX3RpbWUzMl90OwoK
c3RydWN0IG9sZF90aW1lc3BlYzMyIHsKIG9sZF90aW1lMzJfdCB0dl9zZWM7CiBzMzIgdHZf
bnNlYzsKfTsKCnN0cnVjdCBvbGRfdGltZXZhbDMyIHsKIG9sZF90aW1lMzJfdCB0dl9zZWM7
CiBzMzIgdHZfdXNlYzsKfTsKIyAxNiAiLi9pbmNsdWRlL2xpbnV4L3RpbWUzMi5oIiAyCgpz
dHJ1Y3Qgb2xkX2l0aW1lcnNwZWMzMiB7CiBzdHJ1Y3Qgb2xkX3RpbWVzcGVjMzIgaXRfaW50
ZXJ2YWw7CiBzdHJ1Y3Qgb2xkX3RpbWVzcGVjMzIgaXRfdmFsdWU7Cn07CgpzdHJ1Y3Qgb2xk
X3V0aW1idWYzMiB7CiBvbGRfdGltZTMyX3QgYWN0aW1lOwogb2xkX3RpbWUzMl90IG1vZHRp
bWU7Cn07CgpzdHJ1Y3Qgb2xkX3RpbWV4MzIgewogdTMyIG1vZGVzOwogczMyIG9mZnNldDsK
IHMzMiBmcmVxOwogczMyIG1heGVycm9yOwogczMyIGVzdGVycm9yOwogczMyIHN0YXR1czsK
IHMzMiBjb25zdGFudDsKIHMzMiBwcmVjaXNpb247CiBzMzIgdG9sZXJhbmNlOwogc3RydWN0
IG9sZF90aW1ldmFsMzIgdGltZTsKIHMzMiB0aWNrOwogczMyIHBwc2ZyZXE7CiBzMzIgaml0
dGVyOwogczMyIHNoaWZ0OwogczMyIHN0YWJpbDsKIHMzMiBqaXRjbnQ7CiBzMzIgY2FsY250
OwogczMyIGVycmNudDsKIHMzMiBzdGJjbnQ7CiBzMzIgdGFpOwoKIHMzMjozMjsgczMyOjMy
OyBzMzI6MzI7IHMzMjozMjsKIHMzMjozMjsgczMyOjMyOyBzMzI6MzI7IHMzMjozMjsKIHMz
MjozMjsgczMyOjMyOyBzMzI6MzI7Cn07CgpleHRlcm4gaW50IGdldF9vbGRfdGltZXNwZWMz
MihzdHJ1Y3QgdGltZXNwZWM2NCAqLCBjb25zdCB2b2lkICopOwpleHRlcm4gaW50IHB1dF9v
bGRfdGltZXNwZWMzMihjb25zdCBzdHJ1Y3QgdGltZXNwZWM2NCAqLCB2b2lkICopOwpleHRl
cm4gaW50IGdldF9vbGRfaXRpbWVyc3BlYzMyKHN0cnVjdCBpdGltZXJzcGVjNjQgKml0cywK
ICAgY29uc3Qgc3RydWN0IG9sZF9pdGltZXJzcGVjMzIgKnVpdHMpOwpleHRlcm4gaW50IHB1
dF9vbGRfaXRpbWVyc3BlYzMyKGNvbnN0IHN0cnVjdCBpdGltZXJzcGVjNjQgKml0cywKICAg
c3RydWN0IG9sZF9pdGltZXJzcGVjMzIgKnVpdHMpOwpzdHJ1Y3QgX19rZXJuZWxfdGltZXg7
CmludCBnZXRfb2xkX3RpbWV4MzIoc3RydWN0IF9fa2VybmVsX3RpbWV4ICosIGNvbnN0IHN0
cnVjdCBvbGRfdGltZXgzMiAqKTsKaW50IHB1dF9vbGRfdGltZXgzMihzdHJ1Y3Qgb2xkX3Rp
bWV4MzIgKiwgY29uc3Qgc3RydWN0IF9fa2VybmVsX3RpbWV4ICopOwoKCgoKCgoKZXh0ZXJu
IHN0cnVjdCBfX2tlcm5lbF9vbGRfdGltZXZhbCBuc190b19rZXJuZWxfb2xkX3RpbWV2YWwo
czY0IG5zZWMpOwojIDc1ICIuL2luY2x1ZGUvbGludXgvdGltZS5oIiAyCgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
Ym9vbCBpdGltZXJzcGVjNjRfdmFsaWQoY29uc3Qgc3RydWN0IGl0aW1lcnNwZWM2NCAqaXRz
KQp7CiBpZiAoIXRpbWVzcGVjNjRfdmFsaWQoJihpdHMtPml0X2ludGVydmFsKSkgfHwKICAh
dGltZXNwZWM2NF92YWxpZCgmKGl0cy0+aXRfdmFsdWUpKSkKICByZXR1cm4gZmFsc2U7Cgog
cmV0dXJuIHRydWU7Cn0KIyAxMTQgIi4vaW5jbHVkZS9saW51eC90aW1lLmgiCiMgMSAiLi9p
bmNsdWRlL3Zkc28vdGltZS5oIiAxCgoKCgoKCnN0cnVjdCB0aW1lbnNfb2Zmc2V0IHsKIHM2
NCBzZWM7CiB1NjQgbnNlYzsKfTsKIyAxMTUgIi4vaW5jbHVkZS9saW51eC90aW1lLmgiIDIK
IyAyNSAiLi9pbmNsdWRlL2xpbnV4L2t0aW1lLmgiIDIKIyAxICIuL2luY2x1ZGUvbGludXgv
amlmZmllcy5oIiAxCiMgMTEgIi4vaW5jbHVkZS9saW51eC9qaWZmaWVzLmgiCiMgMSAiLi9p
bmNsdWRlL3Zkc28vamlmZmllcy5oIiAxCgoKCgojIDEgIi4vYXJjaC9wb3dlcnBjL2luY2x1
ZGUvZ2VuZXJhdGVkL3VhcGkvYXNtL3BhcmFtLmgiIDEKIyA2ICIuL2luY2x1ZGUvdmRzby9q
aWZmaWVzLmgiIDIKIyAxMiAiLi9pbmNsdWRlL2xpbnV4L2ppZmZpZXMuaCIgMgojIDEgIi4v
YXJjaC9wb3dlcnBjL2luY2x1ZGUvZ2VuZXJhdGVkL3VhcGkvYXNtL3BhcmFtLmgiIDEKIyAx
MyAiLi9pbmNsdWRlL2xpbnV4L2ppZmZpZXMuaCIgMgojIDEgIi4vaW5jbHVkZS9nZW5lcmF0
ZWQvdGltZWNvbnN0LmgiIDEKIyAxNCAiLi9pbmNsdWRlL2xpbnV4L2ppZmZpZXMuaCIgMgoj
IDYxICIuL2luY2x1ZGUvbGludXgvamlmZmllcy5oIgpleHRlcm4gaW50IHJlZ2lzdGVyX3Jl
ZmluZWRfamlmZmllcyhsb25nIGNsb2NrX3RpY2tfcmF0ZSk7CiMgNzggIi4vaW5jbHVkZS9s
aW51eC9qaWZmaWVzLmgiCmV4dGVybiB1NjQgX19hdHRyaWJ1dGVfXygoX19hbGlnbmVkX18o
KDEgPDwgNikpLCBfX3NlY3Rpb25fXygiLmRhdGEuLmNhY2hlbGluZV9hbGlnbmVkIikpKSBq
aWZmaWVzXzY0OwpleHRlcm4gdW5zaWduZWQgbG9uZyB2b2xhdGlsZSBfX2F0dHJpYnV0ZV9f
KChfX2FsaWduZWRfXygoMSA8PCA2KSksIF9fc2VjdGlvbl9fKCIuZGF0YS4uY2FjaGVsaW5l
X2FsaWduZWQiKSkpIGppZmZpZXM7CgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdTY0IGdldF9qaWZmaWVzXzY0
KHZvaWQpCnsKIHJldHVybiAodTY0KWppZmZpZXM7Cn0KIyAxODggIi4vaW5jbHVkZS9saW51
eC9qaWZmaWVzLmgiCmV4dGVybiB1bnNpZ25lZCBsb25nIHByZXNldF9scGo7CiMgMjg5ICIu
L2luY2x1ZGUvbGludXgvamlmZmllcy5oIgpleHRlcm4gdW5zaWduZWQgaW50IGppZmZpZXNf
dG9fbXNlY3MoY29uc3QgdW5zaWduZWQgbG9uZyBqKTsKZXh0ZXJuIHVuc2lnbmVkIGludCBq
aWZmaWVzX3RvX3VzZWNzKGNvbnN0IHVuc2lnbmVkIGxvbmcgaik7CgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdTY0
IGppZmZpZXNfdG9fbnNlY3MoY29uc3QgdW5zaWduZWQgbG9uZyBqKQp7CiByZXR1cm4gKHU2
NClqaWZmaWVzX3RvX3VzZWNzKGopICogMTAwMEw7Cn0KCmV4dGVybiB1NjQgamlmZmllczY0
X3RvX25zZWNzKHU2NCBqKTsKZXh0ZXJuIHU2NCBqaWZmaWVzNjRfdG9fbXNlY3ModTY0IGop
OwoKZXh0ZXJuIHVuc2lnbmVkIGxvbmcgX19tc2Vjc190b19qaWZmaWVzKGNvbnN0IHVuc2ln
bmVkIGludCBtKTsKCgoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHVuc2lnbmVkIGxvbmcgX21zZWNzX3RvX2pp
ZmZpZXMoY29uc3QgdW5zaWduZWQgaW50IG0pCnsKIHJldHVybiAobSArICgxMDAwTCAvIDI1
MCkgLSAxKSAvICgxMDAwTCAvIDI1MCk7Cn0KIyAzNjIgIi4vaW5jbHVkZS9saW51eC9qaWZm
aWVzLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHVu
c2lnbmVkIGxvbmcgbXNlY3NfdG9famlmZmllcyhjb25zdCB1bnNpZ25lZCBpbnQgbSkKewog
aWYgKF9fYnVpbHRpbl9jb25zdGFudF9wKG0pKSB7CiAgaWYgKChpbnQpbSA8IDApCiAgIHJl
dHVybiAoKCgobG9uZykofjBVTCA+PiAxKSkgPj4gMSktMSk7CiAgcmV0dXJuIF9tc2Vjc190
b19qaWZmaWVzKG0pOwogfSBlbHNlIHsKICByZXR1cm4gX19tc2Vjc190b19qaWZmaWVzKG0p
OwogfQp9CgpleHRlcm4gdW5zaWduZWQgbG9uZyBfX3VzZWNzX3RvX2ppZmZpZXMoY29uc3Qg
dW5zaWduZWQgaW50IHUpOwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHVuc2lnbmVkIGxvbmcgX3VzZWNzX3RvX2pp
ZmZpZXMoY29uc3QgdW5zaWduZWQgaW50IHUpCnsKIHJldHVybiAodSArICgxMDAwMDAwTCAv
IDI1MCkgLSAxKSAvICgxMDAwMDAwTCAvIDI1MCk7Cn0KIyA0MDkgIi4vaW5jbHVkZS9saW51
eC9qaWZmaWVzLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVf
XykpIHVuc2lnbmVkIGxvbmcgdXNlY3NfdG9famlmZmllcyhjb25zdCB1bnNpZ25lZCBpbnQg
dSkKewogaWYgKF9fYnVpbHRpbl9jb25zdGFudF9wKHUpKSB7CiAgaWYgKHUgPiBqaWZmaWVz
X3RvX3VzZWNzKCgoKChsb25nKSh+MFVMID4+IDEpKSA+PiAxKS0xKSkpCiAgIHJldHVybiAo
KCgobG9uZykofjBVTCA+PiAxKSkgPj4gMSktMSk7CiAgcmV0dXJuIF91c2Vjc190b19qaWZm
aWVzKHUpOwogfSBlbHNlIHsKICByZXR1cm4gX191c2Vjc190b19qaWZmaWVzKHUpOwogfQp9
CgpleHRlcm4gdW5zaWduZWQgbG9uZyB0aW1lc3BlYzY0X3RvX2ppZmZpZXMoY29uc3Qgc3Ry
dWN0IHRpbWVzcGVjNjQgKnZhbHVlKTsKZXh0ZXJuIHZvaWQgamlmZmllc190b190aW1lc3Bl
YzY0KGNvbnN0IHVuc2lnbmVkIGxvbmcgamlmZmllcywKICAgICAgc3RydWN0IHRpbWVzcGVj
NjQgKnZhbHVlKTsKZXh0ZXJuIGNsb2NrX3QgamlmZmllc190b19jbG9ja190KHVuc2lnbmVk
IGxvbmcgeCk7CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBjbG9ja190IGppZmZpZXNfZGVsdGFfdG9fY2xvY2tfdChs
b25nIGRlbHRhKQp7CiByZXR1cm4gamlmZmllc190b19jbG9ja190KF9fYnVpbHRpbl9jaG9v
c2VfZXhwcigoKCEhKHNpemVvZigodHlwZW9mKDBMKSAqKTEgPT0gKHR5cGVvZihkZWx0YSkg
KikxKSkpICYmICgoc2l6ZW9mKGludCkgPT0gc2l6ZW9mKCooOCA/ICgodm9pZCAqKSgobG9u
ZykoMEwpICogMGwpKSA6IChpbnQgKik4KSkpICYmIChzaXplb2YoaW50KSA9PSBzaXplb2Yo
Kig4ID8gKCh2b2lkICopKChsb25nKShkZWx0YSkgKiAwbCkpIDogKGludCAqKTgpKSkpKSwg
KCgwTCkgPiAoZGVsdGEpID8gKDBMKSA6IChkZWx0YSkpLCAoeyB0eXBlb2YoMEwpIF9fVU5J
UVVFX0lEX19feDg3ID0gKDBMKTsgdHlwZW9mKGRlbHRhKSBfX1VOSVFVRV9JRF9fX3k4OCA9
IChkZWx0YSk7ICgoX19VTklRVUVfSURfX194ODcpID4gKF9fVU5JUVVFX0lEX19feTg4KSA/
IChfX1VOSVFVRV9JRF9fX3g4NykgOiAoX19VTklRVUVfSURfX195ODgpKTsgfSkpKTsKfQoK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIHVuc2lnbmVkIGludCBqaWZmaWVzX2RlbHRhX3RvX21zZWNzKGxvbmcgZGVs
dGEpCnsKIHJldHVybiBqaWZmaWVzX3RvX21zZWNzKF9fYnVpbHRpbl9jaG9vc2VfZXhwcigo
KCEhKHNpemVvZigodHlwZW9mKDBMKSAqKTEgPT0gKHR5cGVvZihkZWx0YSkgKikxKSkpICYm
ICgoc2l6ZW9mKGludCkgPT0gc2l6ZW9mKCooOCA/ICgodm9pZCAqKSgobG9uZykoMEwpICog
MGwpKSA6IChpbnQgKik4KSkpICYmIChzaXplb2YoaW50KSA9PSBzaXplb2YoKig4ID8gKCh2
b2lkICopKChsb25nKShkZWx0YSkgKiAwbCkpIDogKGludCAqKTgpKSkpKSwgKCgwTCkgPiAo
ZGVsdGEpID8gKDBMKSA6IChkZWx0YSkpLCAoeyB0eXBlb2YoMEwpIF9fVU5JUVVFX0lEX19f
eDg5ID0gKDBMKTsgdHlwZW9mKGRlbHRhKSBfX1VOSVFVRV9JRF9fX3k5MCA9IChkZWx0YSk7
ICgoX19VTklRVUVfSURfX194ODkpID4gKF9fVU5JUVVFX0lEX19feTkwKSA/IChfX1VOSVFV
RV9JRF9fX3g4OSkgOiAoX19VTklRVUVfSURfX195OTApKTsgfSkpKTsKfQoKZXh0ZXJuIHVu
c2lnbmVkIGxvbmcgY2xvY2tfdF90b19qaWZmaWVzKHVuc2lnbmVkIGxvbmcgeCk7CmV4dGVy
biB1NjQgamlmZmllc182NF90b19jbG9ja190KHU2NCB4KTsKZXh0ZXJuIHU2NCBuc2VjX3Rv
X2Nsb2NrX3QodTY0IHgpOwpleHRlcm4gdTY0IG5zZWNzX3RvX2ppZmZpZXM2NCh1NjQgbik7
CmV4dGVybiB1bnNpZ25lZCBsb25nIG5zZWNzX3RvX2ppZmZpZXModTY0IG4pOwojIDI2ICIu
L2luY2x1ZGUvbGludXgva3RpbWUuaCIgMgoKCnR5cGVkZWYgczY0IGt0aW1lX3Q7CiMgMzcg
Ii4vaW5jbHVkZS9saW51eC9rdGltZS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkga3RpbWVfdCBrdGltZV9zZXQo
Y29uc3QgczY0IHNlY3MsIGNvbnN0IHVuc2lnbmVkIGxvbmcgbnNlY3MpCnsKIGlmIChfX2J1
aWx0aW5fZXhwZWN0KCEhKHNlY3MgPj0gKCgoczY0KX4oKHU2NCkxIDw8IDYzKSkgLyAxMDAw
MDAwMDAwTCkpLCAwKSkKICByZXR1cm4gKChzNjQpfigodTY0KTEgPDwgNjMpKTsKCiByZXR1
cm4gc2VjcyAqIDEwMDAwMDAwMDBMICsgKHM2NCluc2VjczsKfQojIDcwICIuL2luY2x1ZGUv
bGludXgva3RpbWUuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGt0aW1lX3QgdGltZXNwZWM2NF90b19rdGltZShz
dHJ1Y3QgdGltZXNwZWM2NCB0cykKewogcmV0dXJuIGt0aW1lX3NldCh0cy50dl9zZWMsIHRz
LnR2X25zZWMpOwp9CgoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHM2NCBrdGltZV90b19ucyhjb25zdCBrdGlt
ZV90IGt0KQp7CiByZXR1cm4ga3Q7Cn0KIyA5NCAiLi9pbmNsdWRlL2xpbnV4L2t0aW1lLmgi
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSBpbnQga3RpbWVfY29tcGFyZShjb25zdCBrdGltZV90IGNtcDEsIGNvbnN0
IGt0aW1lX3QgY21wMikKewogaWYgKGNtcDEgPCBjbXAyKQogIHJldHVybiAtMTsKIGlmIChj
bXAxID4gY21wMikKICByZXR1cm4gMTsKIHJldHVybiAwOwp9CiMgMTEwICIuL2luY2x1ZGUv
bGludXgva3RpbWUuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wga3RpbWVfYWZ0ZXIoY29uc3Qga3RpbWVf
dCBjbXAxLCBjb25zdCBrdGltZV90IGNtcDIpCnsKIHJldHVybiBrdGltZV9jb21wYXJlKGNt
cDEsIGNtcDIpID4gMDsKfQojIDEyMiAiLi9pbmNsdWRlL2xpbnV4L2t0aW1lLmgiCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBib29sIGt0aW1lX2JlZm9yZShjb25zdCBrdGltZV90IGNtcDEsIGNvbnN0IGt0aW1l
X3QgY21wMikKewogcmV0dXJuIGt0aW1lX2NvbXBhcmUoY21wMSwgY21wMikgPCAwOwp9CiMg
MTQ3ICIuL2luY2x1ZGUvbGludXgva3RpbWUuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHM2NCBrdGltZV9kaXZu
cyhjb25zdCBrdGltZV90IGt0LCBzNjQgZGl2KQp7CgoKCgogKHsgaW50IF9fcmV0X3dhcm5f
b24gPSAhIShkaXYgPCAwKTsgaWYgKF9fYnVpbHRpbl9jb25zdGFudF9wKF9fcmV0X3dhcm5f
b24pKSB7IGlmIChfX3JldF93YXJuX29uKSBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CSIg
InR3aSAzMSwgMCwgMCIgIlxuIiAiLnNlY3Rpb24gX19idWdfdGFibGUsXCJhd1wiXG4iICIy
Olx0IiAiLjhieXRlIiAiICIgIjFiLCAlMFxuIiAiXHQuc2hvcnQgJTEsICUyXG4iICIub3Jn
IDJiKyUzXG4iICIucHJldmlvdXNcbiIgOiA6ICJpIiAoIi4vaW5jbHVkZS9saW51eC9rdGlt
ZS5oIiksICJpIiAoMTUzKSwgImkiICgoMSA8PCAwKSB8ICgoKDkpIDw8IDgpKSksICJpIiAo
c2l6ZW9mKHN0cnVjdCBidWdfZW50cnkpKSk7IH0gZWxzZSB7IF9fYXNtX18gX192b2xhdGls
ZV9fKCAiMToJIiAidGRuZWkiICIgIiAiICU0LCAwIiAiXG4iICIuc2VjdGlvbiBfX2J1Z190
YWJsZSxcImF3XCJcbiIgIjI6XHQiICIuOGJ5dGUiICIgIiAiMWIsICUwXG4iICJcdC5zaG9y
dCAlMSwgJTJcbiIgIi5vcmcgMmIrJTNcbiIgIi5wcmV2aW91c1xuIiA6IDogImkiICgiLi9p
bmNsdWRlL2xpbnV4L2t0aW1lLmgiKSwgImkiICgxNTMpLCAiaSIgKCgxIDw8IDApIHwgKCg5
KSA8PCA4KSksICJpIiAoc2l6ZW9mKHN0cnVjdCBidWdfZW50cnkpKSwgInIiIChfX3JldF93
YXJuX29uKSk7IH0gX19idWlsdGluX2V4cGVjdCghIShfX3JldF93YXJuX29uKSwgMCk7IH0p
OwogcmV0dXJuIGt0IC8gZGl2Owp9CgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHM2NCBrdGltZV90b191cyhjb25z
dCBrdGltZV90IGt0KQp7CiByZXR1cm4ga3RpbWVfZGl2bnMoa3QsIDEwMDBMKTsKfQoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIHM2NCBrdGltZV90b19tcyhjb25zdCBrdGltZV90IGt0KQp7CiByZXR1cm4ga3Rp
bWVfZGl2bnMoa3QsIDEwMDAwMDBMKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHM2NCBrdGltZV91c19kZWx0
YShjb25zdCBrdGltZV90IGxhdGVyLCBjb25zdCBrdGltZV90IGVhcmxpZXIpCnsKICAgICAg
IHJldHVybiBrdGltZV90b191cygoKGxhdGVyKSAtIChlYXJsaWVyKSkpOwp9CgpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgczY0IGt0aW1lX21zX2RlbHRhKGNvbnN0IGt0aW1lX3QgbGF0ZXIsIGNvbnN0IGt0aW1l
X3QgZWFybGllcikKewogcmV0dXJuIGt0aW1lX3RvX21zKCgobGF0ZXIpIC0gKGVhcmxpZXIp
KSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSBrdGltZV90IGt0aW1lX2FkZF91cyhjb25zdCBrdGltZV90IGt0
LCBjb25zdCB1NjQgdXNlYykKewogcmV0dXJuICgoa3QpICsgKHVzZWMgKiAxMDAwTCkpOwp9
CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkga3RpbWVfdCBrdGltZV9hZGRfbXMoY29uc3Qga3RpbWVfdCBrdCwgY29u
c3QgdTY0IG1zZWMpCnsKIHJldHVybiAoKGt0KSArIChtc2VjICogMTAwMDAwMEwpKTsKfQoK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIGt0aW1lX3Qga3RpbWVfc3ViX3VzKGNvbnN0IGt0aW1lX3Qga3QsIGNvbnN0
IHU2NCB1c2VjKQp7CiByZXR1cm4gKChrdCkgLSAodXNlYyAqIDEwMDBMKSk7Cn0KCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBrdGltZV90IGt0aW1lX3N1Yl9tcyhjb25zdCBrdGltZV90IGt0LCBjb25zdCB1NjQg
bXNlYykKewogcmV0dXJuICgoa3QpIC0gKG1zZWMgKiAxMDAwMDAwTCkpOwp9CgpleHRlcm4g
a3RpbWVfdCBrdGltZV9hZGRfc2FmZShjb25zdCBrdGltZV90IGxocywgY29uc3Qga3RpbWVf
dCByaHMpOwojIDIwOCAiLi9pbmNsdWRlL2xpbnV4L2t0aW1lLmgiCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkgYm9vbCBrdGltZV90b190aW1l
c3BlYzY0X2NvbmQoY29uc3Qga3RpbWVfdCBrdCwKICAgICAgICAgICAgIHN0cnVjdCB0aW1l
c3BlYzY0ICp0cykKewogaWYgKGt0KSB7CiAgKnRzID0gbnNfdG9fdGltZXNwZWM2NCgoa3Qp
KTsKICByZXR1cm4gdHJ1ZTsKIH0gZWxzZSB7CiAgcmV0dXJuIGZhbHNlOwogfQp9CgojIDEg
Ii4vaW5jbHVkZS92ZHNvL2t0aW1lLmgiIDEKIyAyMjAgIi4vaW5jbHVkZS9saW51eC9rdGlt
ZS5oIiAyCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkga3RpbWVfdCBuc190b19rdGltZSh1NjQgbnMpCnsKIHJldHVy
biBuczsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIGt0aW1lX3QgbXNfdG9fa3RpbWUodTY0IG1zKQp7CiByZXR1
cm4gbXMgKiAxMDAwMDAwTDsKfQoKIyAxICIuL2luY2x1ZGUvbGludXgvdGltZWtlZXBpbmcu
aCIgMQojIDkgIi4vaW5jbHVkZS9saW51eC90aW1la2VlcGluZy5oIgp2b2lkIHRpbWVrZWVw
aW5nX2luaXQodm9pZCk7CmV4dGVybiBpbnQgdGltZWtlZXBpbmdfc3VzcGVuZGVkOwoKCmV4
dGVybiB2b2lkIHVwZGF0ZV9wcm9jZXNzX3RpbWVzKGludCB1c2VyKTsKZXh0ZXJuIHZvaWQg
eHRpbWVfdXBkYXRlKHVuc2lnbmVkIGxvbmcgdGlja3MpOwoKCgoKZXh0ZXJuIGludCBkb19z
ZXR0aW1lb2ZkYXk2NChjb25zdCBzdHJ1Y3QgdGltZXNwZWM2NCAqdHMpOwpleHRlcm4gaW50
IGRvX3N5c19zZXR0aW1lb2ZkYXk2NChjb25zdCBzdHJ1Y3QgdGltZXNwZWM2NCAqdHYsCiAg
ICAgY29uc3Qgc3RydWN0IHRpbWV6b25lICp0eik7CiMgNDEgIi4vaW5jbHVkZS9saW51eC90
aW1la2VlcGluZy5oIgpleHRlcm4gdm9pZCBrdGltZV9nZXRfcmF3X3RzNjQoc3RydWN0IHRp
bWVzcGVjNjQgKnRzKTsKZXh0ZXJuIHZvaWQga3RpbWVfZ2V0X3RzNjQoc3RydWN0IHRpbWVz
cGVjNjQgKnRzKTsKZXh0ZXJuIHZvaWQga3RpbWVfZ2V0X3JlYWxfdHM2NChzdHJ1Y3QgdGlt
ZXNwZWM2NCAqdHYpOwpleHRlcm4gdm9pZCBrdGltZV9nZXRfY29hcnNlX3RzNjQoc3RydWN0
IHRpbWVzcGVjNjQgKnRzKTsKZXh0ZXJuIHZvaWQga3RpbWVfZ2V0X2NvYXJzZV9yZWFsX3Rz
NjQoc3RydWN0IHRpbWVzcGVjNjQgKnRzKTsKCnZvaWQgZ2V0Ym9vdHRpbWU2NChzdHJ1Y3Qg
dGltZXNwZWM2NCAqdHMpOwoKCgoKZXh0ZXJuIHRpbWU2NF90IGt0aW1lX2dldF9zZWNvbmRz
KHZvaWQpOwpleHRlcm4gdGltZTY0X3QgX19rdGltZV9nZXRfcmVhbF9zZWNvbmRzKHZvaWQp
OwpleHRlcm4gdGltZTY0X3Qga3RpbWVfZ2V0X3JlYWxfc2Vjb25kcyh2b2lkKTsKCgoKCgpl
bnVtIHRrX29mZnNldHMgewogVEtfT0ZGU19SRUFMLAogVEtfT0ZGU19CT09ULAogVEtfT0ZG
U19UQUksCiBUS19PRkZTX01BWCwKfTsKCmV4dGVybiBrdGltZV90IGt0aW1lX2dldCh2b2lk
KTsKZXh0ZXJuIGt0aW1lX3Qga3RpbWVfZ2V0X3dpdGhfb2Zmc2V0KGVudW0gdGtfb2Zmc2V0
cyBvZmZzKTsKZXh0ZXJuIGt0aW1lX3Qga3RpbWVfZ2V0X2NvYXJzZV93aXRoX29mZnNldChl
bnVtIHRrX29mZnNldHMgb2Zmcyk7CmV4dGVybiBrdGltZV90IGt0aW1lX21vbm9fdG9fYW55
KGt0aW1lX3QgdG1vbm8sIGVudW0gdGtfb2Zmc2V0cyBvZmZzKTsKZXh0ZXJuIGt0aW1lX3Qg
a3RpbWVfZ2V0X3Jhdyh2b2lkKTsKZXh0ZXJuIHUzMiBrdGltZV9nZXRfcmVzb2x1dGlvbl9u
cyh2b2lkKTsKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSBrdGltZV90IGt0aW1lX2dldF9yZWFsKHZvaWQpCnsK
IHJldHVybiBrdGltZV9nZXRfd2l0aF9vZmZzZXQoVEtfT0ZGU19SRUFMKTsKfQoKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIGt0aW1lX3Qga3RpbWVfZ2V0X2NvYXJzZV9yZWFsKHZvaWQpCnsKIHJldHVybiBrdGlt
ZV9nZXRfY29hcnNlX3dpdGhfb2Zmc2V0KFRLX09GRlNfUkVBTCk7Cn0KCgoKCgoKCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBrdGltZV90IGt0aW1lX2dldF9ib290dGltZSh2b2lkKQp7CiByZXR1cm4ga3RpbWVf
Z2V0X3dpdGhfb2Zmc2V0KFRLX09GRlNfQk9PVCk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBrdGltZV90IGt0
aW1lX2dldF9jb2Fyc2VfYm9vdHRpbWUodm9pZCkKewogcmV0dXJuIGt0aW1lX2dldF9jb2Fy
c2Vfd2l0aF9vZmZzZXQoVEtfT0ZGU19CT09UKTsKfQoKCgoKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGt0aW1lX3Qg
a3RpbWVfZ2V0X2Nsb2NrdGFpKHZvaWQpCnsKIHJldHVybiBrdGltZV9nZXRfd2l0aF9vZmZz
ZXQoVEtfT0ZGU19UQUkpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkga3RpbWVfdCBrdGltZV9nZXRfY29hcnNl
X2Nsb2NrdGFpKHZvaWQpCnsKIHJldHVybiBrdGltZV9nZXRfY29hcnNlX3dpdGhfb2Zmc2V0
KFRLX09GRlNfVEFJKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGt0aW1lX3Qga3RpbWVfZ2V0X2NvYXJzZSh2
b2lkKQp7CiBzdHJ1Y3QgdGltZXNwZWM2NCB0czsKCiBrdGltZV9nZXRfY29hcnNlX3RzNjQo
JnRzKTsKIHJldHVybiB0aW1lc3BlYzY0X3RvX2t0aW1lKHRzKTsKfQoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHU2
NCBrdGltZV9nZXRfY29hcnNlX25zKHZvaWQpCnsKIHJldHVybiBrdGltZV90b19ucyhrdGlt
ZV9nZXRfY29hcnNlKCkpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdTY0IGt0aW1lX2dldF9jb2Fyc2VfcmVh
bF9ucyh2b2lkKQp7CiByZXR1cm4ga3RpbWVfdG9fbnMoa3RpbWVfZ2V0X2NvYXJzZV9yZWFs
KCkpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgdTY0IGt0aW1lX2dldF9jb2Fyc2VfYm9vdHRpbWVfbnModm9p
ZCkKewogcmV0dXJuIGt0aW1lX3RvX25zKGt0aW1lX2dldF9jb2Fyc2VfYm9vdHRpbWUoKSk7
Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSB1NjQga3RpbWVfZ2V0X2NvYXJzZV9jbG9ja3RhaV9ucyh2b2lkKQp7
CiByZXR1cm4ga3RpbWVfdG9fbnMoa3RpbWVfZ2V0X2NvYXJzZV9jbG9ja3RhaSgpKTsKfQoK
CgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIGt0aW1lX3Qga3RpbWVfbW9ub190b19yZWFsKGt0aW1lX3QgbW9ubykK
ewogcmV0dXJuIGt0aW1lX21vbm9fdG9fYW55KG1vbm8sIFRLX09GRlNfUkVBTCk7Cn0KCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSB1NjQga3RpbWVfZ2V0X25zKHZvaWQpCnsKIHJldHVybiBrdGltZV90b19ucyhr
dGltZV9nZXQoKSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1NjQga3RpbWVfZ2V0X3JlYWxfbnModm9pZCkK
ewogcmV0dXJuIGt0aW1lX3RvX25zKGt0aW1lX2dldF9yZWFsKCkpOwp9CgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
dTY0IGt0aW1lX2dldF9ib290dGltZV9ucyh2b2lkKQp7CiByZXR1cm4ga3RpbWVfdG9fbnMo
a3RpbWVfZ2V0X2Jvb3R0aW1lKCkpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdTY0IGt0aW1lX2dldF9jbG9j
a3RhaV9ucyh2b2lkKQp7CiByZXR1cm4ga3RpbWVfdG9fbnMoa3RpbWVfZ2V0X2Nsb2NrdGFp
KCkpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgdTY0IGt0aW1lX2dldF9yYXdfbnModm9pZCkKewogcmV0dXJu
IGt0aW1lX3RvX25zKGt0aW1lX2dldF9yYXcoKSk7Cn0KCmV4dGVybiB1NjQga3RpbWVfZ2V0
X21vbm9fZmFzdF9ucyh2b2lkKTsKZXh0ZXJuIHU2NCBrdGltZV9nZXRfcmF3X2Zhc3RfbnMo
dm9pZCk7CmV4dGVybiB1NjQga3RpbWVfZ2V0X2Jvb3RfZmFzdF9ucyh2b2lkKTsKZXh0ZXJu
IHU2NCBrdGltZV9nZXRfcmVhbF9mYXN0X25zKHZvaWQpOwoKCgoKCgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9p
ZCBrdGltZV9nZXRfYm9vdHRpbWVfdHM2NChzdHJ1Y3QgdGltZXNwZWM2NCAqdHMpCnsKICp0
cyA9IG5zX3RvX3RpbWVzcGVjNjQoKGt0aW1lX2dldF9ib290dGltZSgpKSk7Cn0KCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSB2b2lkIGt0aW1lX2dldF9jb2Fyc2VfYm9vdHRpbWVfdHM2NChzdHJ1Y3QgdGltZXNw
ZWM2NCAqdHMpCnsKICp0cyA9IG5zX3RvX3RpbWVzcGVjNjQoKGt0aW1lX2dldF9jb2Fyc2Vf
Ym9vdHRpbWUoKSkpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdGltZTY0X3Qga3RpbWVfZ2V0X2Jvb3R0aW1l
X3NlY29uZHModm9pZCkKewogcmV0dXJuIGt0aW1lX2Rpdm5zKGt0aW1lX2dldF9jb2Fyc2Vf
Ym9vdHRpbWUoKSwgMTAwMDAwMDAwMEwpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBrdGltZV9nZXRf
Y2xvY2t0YWlfdHM2NChzdHJ1Y3QgdGltZXNwZWM2NCAqdHMpCnsKICp0cyA9IG5zX3RvX3Rp
bWVzcGVjNjQoKGt0aW1lX2dldF9jbG9ja3RhaSgpKSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGt0
aW1lX2dldF9jb2Fyc2VfY2xvY2t0YWlfdHM2NChzdHJ1Y3QgdGltZXNwZWM2NCAqdHMpCnsK
ICp0cyA9IG5zX3RvX3RpbWVzcGVjNjQoKGt0aW1lX2dldF9jb2Fyc2VfY2xvY2t0YWkoKSkp
Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgdGltZTY0X3Qga3RpbWVfZ2V0X2Nsb2NrdGFpX3NlY29uZHModm9p
ZCkKewogcmV0dXJuIGt0aW1lX2Rpdm5zKGt0aW1lX2dldF9jb2Fyc2VfY2xvY2t0YWkoKSwg
MTAwMDAwMDAwMEwpOwp9CgoKCgpleHRlcm4gYm9vbCB0aW1la2VlcGluZ19ydGNfc2tpcHN1
c3BlbmQodm9pZCk7CmV4dGVybiBib29sIHRpbWVrZWVwaW5nX3J0Y19za2lwcmVzdW1lKHZv
aWQpOwoKZXh0ZXJuIHZvaWQgdGltZWtlZXBpbmdfaW5qZWN0X3NsZWVwdGltZTY0KGNvbnN0
IHN0cnVjdCB0aW1lc3BlYzY0ICpkZWx0YSk7CiMgMjM0ICIuL2luY2x1ZGUvbGludXgvdGlt
ZWtlZXBpbmcuaCIKc3RydWN0IHN5c3RlbV90aW1lX3NuYXBzaG90IHsKIHU2NCBjeWNsZXM7
CiBrdGltZV90IHJlYWw7CiBrdGltZV90IHJhdzsKIHVuc2lnbmVkIGludCBjbG9ja193YXNf
c2V0X3NlcTsKIHU4IGNzX3dhc19jaGFuZ2VkX3NlcTsKfTsKIyAyNDkgIi4vaW5jbHVkZS9s
aW51eC90aW1la2VlcGluZy5oIgpzdHJ1Y3Qgc3lzdGVtX2RldmljZV9jcm9zc3RzdGFtcCB7
CiBrdGltZV90IGRldmljZTsKIGt0aW1lX3Qgc3lzX3JlYWx0aW1lOwoga3RpbWVfdCBzeXNf
bW9ub3JhdzsKfTsKIyAyNjIgIi4vaW5jbHVkZS9saW51eC90aW1la2VlcGluZy5oIgpzdHJ1
Y3Qgc3lzdGVtX2NvdW50ZXJ2YWxfdCB7CiB1NjQgY3ljbGVzOwogc3RydWN0IGNsb2Nrc291
cmNlICpjczsKfTsKCgoKCmV4dGVybiBpbnQgZ2V0X2RldmljZV9zeXN0ZW1fY3Jvc3N0c3Rh
bXAoCiAgIGludCAoKmdldF90aW1lX2ZuKShrdGltZV90ICpkZXZpY2VfdGltZSwKICAgIHN0
cnVjdCBzeXN0ZW1fY291bnRlcnZhbF90ICpzeXN0ZW1fY291bnRlcnZhbCwKICAgIHZvaWQg
KmN0eCksCiAgIHZvaWQgKmN0eCwKICAgc3RydWN0IHN5c3RlbV90aW1lX3NuYXBzaG90ICpo
aXN0b3J5LAogICBzdHJ1Y3Qgc3lzdGVtX2RldmljZV9jcm9zc3RzdGFtcCAqeHRzdGFtcCk7
CgoKCgpleHRlcm4gdm9pZCBrdGltZV9nZXRfc25hcHNob3Qoc3RydWN0IHN5c3RlbV90aW1l
X3NuYXBzaG90ICpzeXN0aW1lX3NuYXBzaG90KTsKCgoKCmV4dGVybiBpbnQgcGVyc2lzdGVu
dF9jbG9ja19pc19sb2NhbDsKCmV4dGVybiB2b2lkIHJlYWRfcGVyc2lzdGVudF9jbG9jazY0
KHN0cnVjdCB0aW1lc3BlYzY0ICp0cyk7CnZvaWQgcmVhZF9wZXJzaXN0ZW50X3dhbGxfYW5k
X2Jvb3Rfb2Zmc2V0KHN0cnVjdCB0aW1lc3BlYzY0ICp3YWxsX2Nsb2NrLAogICAgICAgc3Ry
dWN0IHRpbWVzcGVjNjQgKmJvb3Rfb2Zmc2V0KTsKZXh0ZXJuIGludCB1cGRhdGVfcGVyc2lz
dGVudF9jbG9jazY0KHN0cnVjdCB0aW1lc3BlYzY0IG5vdyk7CiMgMjMyICIuL2luY2x1ZGUv
bGludXgva3RpbWUuaCIgMgojIDEgIi4vaW5jbHVkZS9saW51eC90aW1la2VlcGluZzMyLmgi
IDEKIyA5ICIuL2luY2x1ZGUvbGludXgvdGltZWtlZXBpbmczMi5oIgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5z
aWduZWQgbG9uZyBnZXRfc2Vjb25kcyh2b2lkKQp7CiByZXR1cm4ga3RpbWVfZ2V0X3JlYWxf
c2Vjb25kcygpOwp9CiMgMjMzICIuL2luY2x1ZGUvbGludXgva3RpbWUuaCIgMgojIDcgIi4v
aW5jbHVkZS9saW51eC90aW1lci5oIiAyCgojIDEgIi4vaW5jbHVkZS9saW51eC9kZWJ1Z29i
amVjdHMuaCIgMQoKCgoKCgoKZW51bSBkZWJ1Z19vYmpfc3RhdGUgewogT0RFQlVHX1NUQVRF
X05PTkUsCiBPREVCVUdfU1RBVEVfSU5JVCwKIE9ERUJVR19TVEFURV9JTkFDVElWRSwKIE9E
RUJVR19TVEFURV9BQ1RJVkUsCiBPREVCVUdfU1RBVEVfREVTVFJPWUVELAogT0RFQlVHX1NU
QVRFX05PVEFWQUlMQUJMRSwKIE9ERUJVR19TVEFURV9NQVgsCn07CgpzdHJ1Y3QgZGVidWdf
b2JqX2Rlc2NyOwojIDI4ICIuL2luY2x1ZGUvbGludXgvZGVidWdvYmplY3RzLmgiCnN0cnVj
dCBkZWJ1Z19vYmogewogc3RydWN0IGhsaXN0X25vZGUgbm9kZTsKIGVudW0gZGVidWdfb2Jq
X3N0YXRlIHN0YXRlOwogdW5zaWduZWQgaW50IGFzdGF0ZTsKIHZvaWQgKm9iamVjdDsKIHN0
cnVjdCBkZWJ1Z19vYmpfZGVzY3IgKmRlc2NyOwp9OwojIDU1ICIuL2luY2x1ZGUvbGludXgv
ZGVidWdvYmplY3RzLmgiCnN0cnVjdCBkZWJ1Z19vYmpfZGVzY3IgewogY29uc3QgY2hhciAq
bmFtZTsKIHZvaWQgKigqZGVidWdfaGludCkodm9pZCAqYWRkcik7CiBib29sICgqaXNfc3Rh
dGljX29iamVjdCkodm9pZCAqYWRkcik7CiBib29sICgqZml4dXBfaW5pdCkodm9pZCAqYWRk
ciwgZW51bSBkZWJ1Z19vYmpfc3RhdGUgc3RhdGUpOwogYm9vbCAoKmZpeHVwX2FjdGl2YXRl
KSh2b2lkICphZGRyLCBlbnVtIGRlYnVnX29ial9zdGF0ZSBzdGF0ZSk7CiBib29sICgqZml4
dXBfZGVzdHJveSkodm9pZCAqYWRkciwgZW51bSBkZWJ1Z19vYmpfc3RhdGUgc3RhdGUpOwog
Ym9vbCAoKmZpeHVwX2ZyZWUpKHZvaWQgKmFkZHIsIGVudW0gZGVidWdfb2JqX3N0YXRlIHN0
YXRlKTsKIGJvb2wgKCpmaXh1cF9hc3NlcnRfaW5pdCkodm9pZCAqYWRkciwgZW51bSBkZWJ1
Z19vYmpfc3RhdGUgc3RhdGUpOwp9OwojIDg4ICIuL2luY2x1ZGUvbGludXgvZGVidWdvYmpl
Y3RzLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSB2b2lkCmRlYnVnX29iamVjdF9pbml0ICh2b2lkICphZGRyLCBz
dHJ1Y3QgZGVidWdfb2JqX2Rlc2NyICpkZXNjcikgeyB9CnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkCmRlYnVn
X29iamVjdF9pbml0X29uX3N0YWNrKHZvaWQgKmFkZHIsIHN0cnVjdCBkZWJ1Z19vYmpfZGVz
Y3IgKmRlc2NyKSB7IH0Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludApkZWJ1Z19vYmplY3RfYWN0aXZhdGUgKHZv
aWQgKmFkZHIsIHN0cnVjdCBkZWJ1Z19vYmpfZGVzY3IgKmRlc2NyKSB7IHJldHVybiAwOyB9
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSB2b2lkCmRlYnVnX29iamVjdF9kZWFjdGl2YXRlKHZvaWQgKmFkZHIsIHN0
cnVjdCBkZWJ1Z19vYmpfZGVzY3IgKmRlc2NyKSB7IH0Kc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQKZGVidWdf
b2JqZWN0X2Rlc3Ryb3kgKHZvaWQgKmFkZHIsIHN0cnVjdCBkZWJ1Z19vYmpfZGVzY3IgKmRl
c2NyKSB7IH0Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHZvaWQKZGVidWdfb2JqZWN0X2ZyZWUgKHZvaWQgKmFkZHIs
IHN0cnVjdCBkZWJ1Z19vYmpfZGVzY3IgKmRlc2NyKSB7IH0Kc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQKZGVi
dWdfb2JqZWN0X2Fzc2VydF9pbml0KHZvaWQgKmFkZHIsIHN0cnVjdCBkZWJ1Z19vYmpfZGVz
Y3IgKmRlc2NyKSB7IH0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGRlYnVnX29iamVjdHNfZWFybHlfaW5p
dCh2b2lkKSB7IH0Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgZGVidWdfb2JqZWN0c19tZW1faW5pdCh2b2lk
KSB7IH0KCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZApkZWJ1Z19jaGVja19ub19vYmpfZnJlZWQoY29u
c3Qgdm9pZCAqYWRkcmVzcywgdW5zaWduZWQgbG9uZyBzaXplKSB7IH0KIyA5ICIuL2luY2x1
ZGUvbGludXgvdGltZXIuaCIgMgoKCnN0cnVjdCB0aW1lcl9saXN0IHsKCgoKCiBzdHJ1Y3Qg
aGxpc3Rfbm9kZSBlbnRyeTsKIHVuc2lnbmVkIGxvbmcgZXhwaXJlczsKIHZvaWQgKCpmdW5j
dGlvbikoc3RydWN0IHRpbWVyX2xpc3QgKik7CiB1MzIgZmxhZ3M7CgoKCgp9OwojIDkwICIu
L2luY2x1ZGUvbGludXgvdGltZXIuaCIKdm9pZCBpbml0X3RpbWVyX2tleShzdHJ1Y3QgdGlt
ZXJfbGlzdCAqdGltZXIsCiAgICAgIHZvaWQgKCpmdW5jKShzdHJ1Y3QgdGltZXJfbGlzdCAq
KSwgdW5zaWduZWQgaW50IGZsYWdzLAogICAgICBjb25zdCBjaGFyICpuYW1lLCBzdHJ1Y3Qg
bG9ja19jbGFzc19rZXkgKmtleSk7CgoKCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBpbml0X3RpbWVy
X29uX3N0YWNrX2tleShzdHJ1Y3QgdGltZXJfbGlzdCAqdGltZXIsCiAgICAgICAgdm9pZCAo
KmZ1bmMpKHN0cnVjdCB0aW1lcl9saXN0ICopLAogICAgICAgIHVuc2lnbmVkIGludCBmbGFn
cywKICAgICAgICBjb25zdCBjaGFyICpuYW1lLAogICAgICAgIHN0cnVjdCBsb2NrX2NsYXNz
X2tleSAqa2V5KQp7CiBpbml0X3RpbWVyX2tleSh0aW1lciwgZnVuYywgZmxhZ3MsIG5hbWUs
IGtleSk7Cn0KIyAxNDkgIi4vaW5jbHVkZS9saW51eC90aW1lci5oIgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9p
ZCBkZXN0cm95X3RpbWVyX29uX3N0YWNrKHN0cnVjdCB0aW1lcl9saXN0ICp0aW1lcikgeyB9
CiMgMTY1ICIuL2luY2x1ZGUvbGludXgvdGltZXIuaCIKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCB0aW1lcl9w
ZW5kaW5nKGNvbnN0IHN0cnVjdCB0aW1lcl9saXN0ICogdGltZXIpCnsKIHJldHVybiAhaGxp
c3RfdW5oYXNoZWRfbG9ja2xlc3MoJnRpbWVyLT5lbnRyeSk7Cn0KCmV4dGVybiB2b2lkIGFk
ZF90aW1lcl9vbihzdHJ1Y3QgdGltZXJfbGlzdCAqdGltZXIsIGludCBjcHUpOwpleHRlcm4g
aW50IGRlbF90aW1lcihzdHJ1Y3QgdGltZXJfbGlzdCAqIHRpbWVyKTsKZXh0ZXJuIGludCBt
b2RfdGltZXIoc3RydWN0IHRpbWVyX2xpc3QgKnRpbWVyLCB1bnNpZ25lZCBsb25nIGV4cGly
ZXMpOwpleHRlcm4gaW50IG1vZF90aW1lcl9wZW5kaW5nKHN0cnVjdCB0aW1lcl9saXN0ICp0
aW1lciwgdW5zaWduZWQgbG9uZyBleHBpcmVzKTsKZXh0ZXJuIGludCB0aW1lcl9yZWR1Y2Uo
c3RydWN0IHRpbWVyX2xpc3QgKnRpbWVyLCB1bnNpZ25lZCBsb25nIGV4cGlyZXMpOwoKCgoK
CgoKZXh0ZXJuIHZvaWQgYWRkX3RpbWVyKHN0cnVjdCB0aW1lcl9saXN0ICp0aW1lcik7Cgpl
eHRlcm4gaW50IHRyeV90b19kZWxfdGltZXJfc3luYyhzdHJ1Y3QgdGltZXJfbGlzdCAqdGlt
ZXIpOwoKCiAgZXh0ZXJuIGludCBkZWxfdGltZXJfc3luYyhzdHJ1Y3QgdGltZXJfbGlzdCAq
dGltZXIpOwoKCgoKCgpleHRlcm4gdm9pZCBpbml0X3RpbWVycyh2b2lkKTsKZXh0ZXJuIHZv
aWQgcnVuX2xvY2FsX3RpbWVycyh2b2lkKTsKc3RydWN0IGhydGltZXI7CmV4dGVybiBlbnVt
IGhydGltZXJfcmVzdGFydCBpdF9yZWFsX2ZuKHN0cnVjdCBocnRpbWVyICopOwoKCnN0cnVj
dCBjdGxfdGFibGU7CgpleHRlcm4gdW5zaWduZWQgaW50IHN5c2N0bF90aW1lcl9taWdyYXRp
b247CmludCB0aW1lcl9taWdyYXRpb25faGFuZGxlcihzdHJ1Y3QgY3RsX3RhYmxlICp0YWJs
ZSwgaW50IHdyaXRlLAogICAgICAgdm9pZCAqYnVmZmVyLCBzaXplX3QgKmxlbnAsIGxvZmZf
dCAqcHBvcyk7CgoKdW5zaWduZWQgbG9uZyBfX3JvdW5kX2ppZmZpZXModW5zaWduZWQgbG9u
ZyBqLCBpbnQgY3B1KTsKdW5zaWduZWQgbG9uZyBfX3JvdW5kX2ppZmZpZXNfcmVsYXRpdmUo
dW5zaWduZWQgbG9uZyBqLCBpbnQgY3B1KTsKdW5zaWduZWQgbG9uZyByb3VuZF9qaWZmaWVz
KHVuc2lnbmVkIGxvbmcgaik7CnVuc2lnbmVkIGxvbmcgcm91bmRfamlmZmllc19yZWxhdGl2
ZSh1bnNpZ25lZCBsb25nIGopOwoKdW5zaWduZWQgbG9uZyBfX3JvdW5kX2ppZmZpZXNfdXAo
dW5zaWduZWQgbG9uZyBqLCBpbnQgY3B1KTsKdW5zaWduZWQgbG9uZyBfX3JvdW5kX2ppZmZp
ZXNfdXBfcmVsYXRpdmUodW5zaWduZWQgbG9uZyBqLCBpbnQgY3B1KTsKdW5zaWduZWQgbG9u
ZyByb3VuZF9qaWZmaWVzX3VwKHVuc2lnbmVkIGxvbmcgaik7CnVuc2lnbmVkIGxvbmcgcm91
bmRfamlmZmllc191cF9yZWxhdGl2ZSh1bnNpZ25lZCBsb25nIGopOwojIDEwICIuL2luY2x1
ZGUvbGludXgvd29ya3F1ZXVlLmgiIDIKIyAxOCAiLi9pbmNsdWRlL2xpbnV4L3dvcmtxdWV1
ZS5oIgpzdHJ1Y3Qgd29ya3F1ZXVlX3N0cnVjdDsKCnN0cnVjdCB3b3JrX3N0cnVjdDsKdHlw
ZWRlZiB2b2lkICgqd29ya19mdW5jX3QpKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yayk7CnZv
aWQgZGVsYXllZF93b3JrX3RpbWVyX2ZuKHN0cnVjdCB0aW1lcl9saXN0ICp0KTsKCgoKCgoK
CmVudW0gewogV09SS19TVFJVQ1RfUEVORElOR19CSVQgPSAwLAogV09SS19TVFJVQ1RfREVM
QVlFRF9CSVQgPSAxLAogV09SS19TVFJVQ1RfUFdRX0JJVCA9IDIsCiBXT1JLX1NUUlVDVF9M
SU5LRURfQklUID0gMywKCgoKCiBXT1JLX1NUUlVDVF9DT0xPUl9TSElGVCA9IDQsCgoKIFdP
UktfU1RSVUNUX0NPTE9SX0JJVFMgPSA0LAoKIFdPUktfU1RSVUNUX1BFTkRJTkcgPSAxIDw8
IFdPUktfU1RSVUNUX1BFTkRJTkdfQklULAogV09SS19TVFJVQ1RfREVMQVlFRCA9IDEgPDwg
V09SS19TVFJVQ1RfREVMQVlFRF9CSVQsCiBXT1JLX1NUUlVDVF9QV1EgPSAxIDw8IFdPUktf
U1RSVUNUX1BXUV9CSVQsCiBXT1JLX1NUUlVDVF9MSU5LRUQgPSAxIDw8IFdPUktfU1RSVUNU
X0xJTktFRF9CSVQsCgoKCiBXT1JLX1NUUlVDVF9TVEFUSUMgPSAwLAoKCgoKCgogV09SS19O
Ul9DT0xPUlMgPSAoMSA8PCBXT1JLX1NUUlVDVF9DT0xPUl9CSVRTKSAtIDEsCiBXT1JLX05P
X0NPTE9SID0gV09SS19OUl9DT0xPUlMsCgoKIFdPUktfQ1BVX1VOQk9VTkQgPSAyNCwKCgoK
CgoKIFdPUktfU1RSVUNUX0ZMQUdfQklUUyA9IFdPUktfU1RSVUNUX0NPTE9SX1NISUZUICsK
ICAgICAgV09SS19TVFJVQ1RfQ09MT1JfQklUUywKCgogV09SS19PRkZRX0ZMQUdfQkFTRSA9
IFdPUktfU1RSVUNUX0NPTE9SX1NISUZULAoKIF9fV09SS19PRkZRX0NBTkNFTElORyA9IFdP
UktfT0ZGUV9GTEFHX0JBU0UsCiBXT1JLX09GRlFfQ0FOQ0VMSU5HID0gKDEgPDwgX19XT1JL
X09GRlFfQ0FOQ0VMSU5HKSwKCgoKCgoKIFdPUktfT0ZGUV9GTEFHX0JJVFMgPSAxLAogV09S
S19PRkZRX1BPT0xfU0hJRlQgPSBXT1JLX09GRlFfRkxBR19CQVNFICsgV09SS19PRkZRX0ZM
QUdfQklUUywKIFdPUktfT0ZGUV9MRUZUID0gNjQgLSBXT1JLX09GRlFfUE9PTF9TSElGVCwK
IFdPUktfT0ZGUV9QT09MX0JJVFMgPSBXT1JLX09GRlFfTEVGVCA8PSAzMSA/IFdPUktfT0ZG
UV9MRUZUIDogMzEsCiBXT1JLX09GRlFfUE9PTF9OT05FID0gKDFMVSA8PCBXT1JLX09GRlFf
UE9PTF9CSVRTKSAtIDEsCgoKIFdPUktfU1RSVUNUX0ZMQUdfTUFTSyA9ICgxVUwgPDwgV09S
S19TVFJVQ1RfRkxBR19CSVRTKSAtIDEsCiBXT1JLX1NUUlVDVF9XUV9EQVRBX01BU0sgPSB+
V09SS19TVFJVQ1RfRkxBR19NQVNLLAogV09SS19TVFJVQ1RfTk9fUE9PTCA9ICh1bnNpZ25l
ZCBsb25nKVdPUktfT0ZGUV9QT09MX05PTkUgPDwgV09SS19PRkZRX1BPT0xfU0hJRlQsCgoK
IFdPUktfQlVTWV9QRU5ESU5HID0gMSA8PCAwLAogV09SS19CVVNZX1JVTk5JTkcgPSAxIDw8
IDEsCgoKIFdPUktFUl9ERVNDX0xFTiA9IDI0LAp9OwoKc3RydWN0IHdvcmtfc3RydWN0IHsK
IGF0b21pY19sb25nX3QgZGF0YTsKIHN0cnVjdCBsaXN0X2hlYWQgZW50cnk7CiB3b3JrX2Z1
bmNfdCBmdW5jOwoKCgp9OwoKCgoKCnN0cnVjdCBkZWxheWVkX3dvcmsgewogc3RydWN0IHdv
cmtfc3RydWN0IHdvcms7CiBzdHJ1Y3QgdGltZXJfbGlzdCB0aW1lcjsKCgogc3RydWN0IHdv
cmtxdWV1ZV9zdHJ1Y3QgKndxOwogaW50IGNwdTsKfTsKCnN0cnVjdCByY3Vfd29yayB7CiBz
dHJ1Y3Qgd29ya19zdHJ1Y3Qgd29yazsKIHN0cnVjdCBjYWxsYmFja19oZWFkIHJjdTsKCgog
c3RydWN0IHdvcmtxdWV1ZV9zdHJ1Y3QgKndxOwp9OwoKCgoKCgpzdHJ1Y3Qgd29ya3F1ZXVl
X2F0dHJzIHsKCgoKIGludCBuaWNlOwoKCgoKIGNwdW1hc2tfdmFyX3QgY3B1bWFzazsKIyAx
NTUgIi4vaW5jbHVkZS9saW51eC93b3JrcXVldWUuaCIKIGJvb2wgbm9fbnVtYTsKfTsKCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSBzdHJ1Y3QgZGVsYXllZF93b3JrICp0b19kZWxheWVkX3dvcmsoc3RydWN0IHdv
cmtfc3RydWN0ICp3b3JrKQp7CiByZXR1cm4gKHsgdm9pZCAqX19tcHRyID0gKHZvaWQgKiko
d29yayk7IGRvIHsgZXh0ZXJuIHZvaWQgX19jb21waWxldGltZV9hc3NlcnRfOTEodm9pZCkg
X19hdHRyaWJ1dGVfXygoX19lcnJvcl9fKCJwb2ludGVyIHR5cGUgbWlzbWF0Y2ggaW4gY29u
dGFpbmVyX29mKCkiKSkpOyBpZiAoISghKCFfX2J1aWx0aW5fdHlwZXNfY29tcGF0aWJsZV9w
KHR5cGVvZigqKHdvcmspKSwgdHlwZW9mKCgoc3RydWN0IGRlbGF5ZWRfd29yayAqKTApLT53
b3JrKSkgJiYgIV9fYnVpbHRpbl90eXBlc19jb21wYXRpYmxlX3AodHlwZW9mKCood29yaykp
LCB0eXBlb2Yodm9pZCkpKSkpIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzkxKCk7IH0gd2hpbGUg
KDApOyAoKHN0cnVjdCBkZWxheWVkX3dvcmsgKikoX19tcHRyIC0gX19idWlsdGluX29mZnNl
dG9mKHN0cnVjdCBkZWxheWVkX3dvcmssIHdvcmspKSk7IH0pOwp9CgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3Ry
dWN0IHJjdV93b3JrICp0b19yY3Vfd29yayhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCnsK
IHJldHVybiAoeyB2b2lkICpfX21wdHIgPSAodm9pZCAqKSh3b3JrKTsgZG8geyBleHRlcm4g
dm9pZCBfX2NvbXBpbGV0aW1lX2Fzc2VydF85Mih2b2lkKSBfX2F0dHJpYnV0ZV9fKChfX2Vy
cm9yX18oInBvaW50ZXIgdHlwZSBtaXNtYXRjaCBpbiBjb250YWluZXJfb2YoKSIpKSk7IGlm
ICghKCEoIV9fYnVpbHRpbl90eXBlc19jb21wYXRpYmxlX3AodHlwZW9mKCood29yaykpLCB0
eXBlb2YoKChzdHJ1Y3QgcmN1X3dvcmsgKikwKS0+d29yaykpICYmICFfX2J1aWx0aW5fdHlw
ZXNfY29tcGF0aWJsZV9wKHR5cGVvZigqKHdvcmspKSwgdHlwZW9mKHZvaWQpKSkpKSBfX2Nv
bXBpbGV0aW1lX2Fzc2VydF85MigpOyB9IHdoaWxlICgwKTsgKChzdHJ1Y3QgcmN1X3dvcmsg
KikoX19tcHRyIC0gX19idWlsdGluX29mZnNldG9mKHN0cnVjdCByY3Vfd29yaywgd29yaykp
KTsgfSk7Cn0KCnN0cnVjdCBleGVjdXRlX3dvcmsgewogc3RydWN0IHdvcmtfc3RydWN0IHdv
cms7Cn07CiMgMjE1ICIuL2luY2x1ZGUvbGludXgvd29ya3F1ZXVlLmgiCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2
b2lkIF9faW5pdF93b3JrKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaywgaW50IG9uc3RhY2sp
IHsgfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgdm9pZCBkZXN0cm95X3dvcmtfb25fc3RhY2soc3RydWN0IHdvcmtf
c3RydWN0ICp3b3JrKSB7IH0Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgZGVzdHJveV9kZWxheWVkX3dvcmtf
b25fc3RhY2soc3RydWN0IGRlbGF5ZWRfd29yayAqd29yaykgeyB9CnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1bnNp
Z25lZCBpbnQgd29ya19zdGF0aWMoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKSB7IHJldHVy
biAwOyB9CiMgMzA4ICIuL2luY2x1ZGUvbGludXgvd29ya3F1ZXVlLmgiCmVudW0gewogV1Ff
VU5CT1VORCA9IDEgPDwgMSwKIFdRX0ZSRUVaQUJMRSA9IDEgPDwgMiwKIFdRX01FTV9SRUNM
QUlNID0gMSA8PCAzLAogV1FfSElHSFBSSSA9IDEgPDwgNCwKIFdRX0NQVV9JTlRFTlNJVkUg
PSAxIDw8IDUsCiBXUV9TWVNGUyA9IDEgPDwgNiwKIyAzNDEgIi4vaW5jbHVkZS9saW51eC93
b3JrcXVldWUuaCIKIFdRX1BPV0VSX0VGRklDSUVOVCA9IDEgPDwgNywKCiBfX1dRX0RSQUlO
SU5HID0gMSA8PCAxNiwKIF9fV1FfT1JERVJFRCA9IDEgPDwgMTcsCiBfX1dRX0xFR0FDWSA9
IDEgPDwgMTgsCiBfX1dRX09SREVSRURfRVhQTElDSVQgPSAxIDw8IDE5LAoKIFdRX01BWF9B
Q1RJVkUgPSA1MTIsCiBXUV9NQVhfVU5CT1VORF9QRVJfQ1BVID0gNCwKIFdRX0RGTF9BQ1RJ
VkUgPSBXUV9NQVhfQUNUSVZFIC8gMiwKfTsKIyAzODUgIi4vaW5jbHVkZS9saW51eC93b3Jr
cXVldWUuaCIKZXh0ZXJuIHN0cnVjdCB3b3JrcXVldWVfc3RydWN0ICpzeXN0ZW1fd3E7CmV4
dGVybiBzdHJ1Y3Qgd29ya3F1ZXVlX3N0cnVjdCAqc3lzdGVtX2hpZ2hwcmlfd3E7CmV4dGVy
biBzdHJ1Y3Qgd29ya3F1ZXVlX3N0cnVjdCAqc3lzdGVtX2xvbmdfd3E7CmV4dGVybiBzdHJ1
Y3Qgd29ya3F1ZXVlX3N0cnVjdCAqc3lzdGVtX3VuYm91bmRfd3E7CmV4dGVybiBzdHJ1Y3Qg
d29ya3F1ZXVlX3N0cnVjdCAqc3lzdGVtX2ZyZWV6YWJsZV93cTsKZXh0ZXJuIHN0cnVjdCB3
b3JrcXVldWVfc3RydWN0ICpzeXN0ZW1fcG93ZXJfZWZmaWNpZW50X3dxOwpleHRlcm4gc3Ry
dWN0IHdvcmtxdWV1ZV9zdHJ1Y3QgKnN5c3RlbV9mcmVlemFibGVfcG93ZXJfZWZmaWNpZW50
X3dxOwojIDQwNyAiLi9pbmNsdWRlL2xpbnV4L3dvcmtxdWV1ZS5oIgpzdHJ1Y3Qgd29ya3F1
ZXVlX3N0cnVjdCAqYWxsb2Nfd29ya3F1ZXVlKGNvbnN0IGNoYXIgKmZtdCwKICAgICAgdW5z
aWduZWQgaW50IGZsYWdzLAogICAgICBpbnQgbWF4X2FjdGl2ZSwgLi4uKTsKIyA0MzYgIi4v
aW5jbHVkZS9saW51eC93b3JrcXVldWUuaCIKZXh0ZXJuIHZvaWQgZGVzdHJveV93b3JrcXVl
dWUoc3RydWN0IHdvcmtxdWV1ZV9zdHJ1Y3QgKndxKTsKCnN0cnVjdCB3b3JrcXVldWVfYXR0
cnMgKmFsbG9jX3dvcmtxdWV1ZV9hdHRycyh2b2lkKTsKdm9pZCBmcmVlX3dvcmtxdWV1ZV9h
dHRycyhzdHJ1Y3Qgd29ya3F1ZXVlX2F0dHJzICphdHRycyk7CmludCBhcHBseV93b3JrcXVl
dWVfYXR0cnMoc3RydWN0IHdvcmtxdWV1ZV9zdHJ1Y3QgKndxLAogICAgIGNvbnN0IHN0cnVj
dCB3b3JrcXVldWVfYXR0cnMgKmF0dHJzKTsKaW50IHdvcmtxdWV1ZV9zZXRfdW5ib3VuZF9j
cHVtYXNrKGNwdW1hc2tfdmFyX3QgY3B1bWFzayk7CgpleHRlcm4gYm9vbCBxdWV1ZV93b3Jr
X29uKGludCBjcHUsIHN0cnVjdCB3b3JrcXVldWVfc3RydWN0ICp3cSwKICAgc3RydWN0IHdv
cmtfc3RydWN0ICp3b3JrKTsKZXh0ZXJuIGJvb2wgcXVldWVfd29ya19ub2RlKGludCBub2Rl
LCBzdHJ1Y3Qgd29ya3F1ZXVlX3N0cnVjdCAqd3EsCiAgICAgICBzdHJ1Y3Qgd29ya19zdHJ1
Y3QgKndvcmspOwpleHRlcm4gYm9vbCBxdWV1ZV9kZWxheWVkX3dvcmtfb24oaW50IGNwdSwg
c3RydWN0IHdvcmtxdWV1ZV9zdHJ1Y3QgKndxLAogICBzdHJ1Y3QgZGVsYXllZF93b3JrICp3
b3JrLCB1bnNpZ25lZCBsb25nIGRlbGF5KTsKZXh0ZXJuIGJvb2wgbW9kX2RlbGF5ZWRfd29y
a19vbihpbnQgY3B1LCBzdHJ1Y3Qgd29ya3F1ZXVlX3N0cnVjdCAqd3EsCiAgIHN0cnVjdCBk
ZWxheWVkX3dvcmsgKmR3b3JrLCB1bnNpZ25lZCBsb25nIGRlbGF5KTsKZXh0ZXJuIGJvb2wg
cXVldWVfcmN1X3dvcmsoc3RydWN0IHdvcmtxdWV1ZV9zdHJ1Y3QgKndxLCBzdHJ1Y3QgcmN1
X3dvcmsgKnJ3b3JrKTsKCmV4dGVybiB2b2lkIGZsdXNoX3dvcmtxdWV1ZShzdHJ1Y3Qgd29y
a3F1ZXVlX3N0cnVjdCAqd3EpOwpleHRlcm4gdm9pZCBkcmFpbl93b3JrcXVldWUoc3RydWN0
IHdvcmtxdWV1ZV9zdHJ1Y3QgKndxKTsKCmV4dGVybiBpbnQgc2NoZWR1bGVfb25fZWFjaF9j
cHUod29ya19mdW5jX3QgZnVuYyk7CgppbnQgZXhlY3V0ZV9pbl9wcm9jZXNzX2NvbnRleHQo
d29ya19mdW5jX3QgZm4sIHN0cnVjdCBleGVjdXRlX3dvcmsgKik7CgpleHRlcm4gYm9vbCBm
bHVzaF93b3JrKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yayk7CmV4dGVybiBib29sIGNhbmNl
bF93b3JrX3N5bmMoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKTsKCmV4dGVybiBib29sIGZs
dXNoX2RlbGF5ZWRfd29yayhzdHJ1Y3QgZGVsYXllZF93b3JrICpkd29yayk7CmV4dGVybiBi
b29sIGNhbmNlbF9kZWxheWVkX3dvcmsoc3RydWN0IGRlbGF5ZWRfd29yayAqZHdvcmspOwpl
eHRlcm4gYm9vbCBjYW5jZWxfZGVsYXllZF93b3JrX3N5bmMoc3RydWN0IGRlbGF5ZWRfd29y
ayAqZHdvcmspOwoKZXh0ZXJuIGJvb2wgZmx1c2hfcmN1X3dvcmsoc3RydWN0IHJjdV93b3Jr
ICpyd29yayk7CgpleHRlcm4gdm9pZCB3b3JrcXVldWVfc2V0X21heF9hY3RpdmUoc3RydWN0
IHdvcmtxdWV1ZV9zdHJ1Y3QgKndxLAogICAgICAgICBpbnQgbWF4X2FjdGl2ZSk7CmV4dGVy
biBzdHJ1Y3Qgd29ya19zdHJ1Y3QgKmN1cnJlbnRfd29yayh2b2lkKTsKZXh0ZXJuIGJvb2wg
Y3VycmVudF9pc193b3JrcXVldWVfcmVzY3Vlcih2b2lkKTsKZXh0ZXJuIGJvb2wgd29ya3F1
ZXVlX2Nvbmdlc3RlZChpbnQgY3B1LCBzdHJ1Y3Qgd29ya3F1ZXVlX3N0cnVjdCAqd3EpOwpl
eHRlcm4gdW5zaWduZWQgaW50IHdvcmtfYnVzeShzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmsp
OwpleHRlcm4gX19hdHRyaWJ1dGVfXygoX19mb3JtYXRfXyhwcmludGYsIDEsIDIpKSkgdm9p
ZCBzZXRfd29ya2VyX2Rlc2MoY29uc3QgY2hhciAqZm10LCAuLi4pOwpleHRlcm4gdm9pZCBw
cmludF93b3JrZXJfaW5mbyhjb25zdCBjaGFyICpsb2dfbHZsLCBzdHJ1Y3QgdGFza19zdHJ1
Y3QgKnRhc2spOwpleHRlcm4gdm9pZCBzaG93X3dvcmtxdWV1ZV9zdGF0ZSh2b2lkKTsKZXh0
ZXJuIHZvaWQgd3Ffd29ya2VyX2NvbW0oY2hhciAqYnVmLCBzaXplX3Qgc2l6ZSwgc3RydWN0
IHRhc2tfc3RydWN0ICp0YXNrKTsKIyA1MDQgIi4vaW5jbHVkZS9saW51eC93b3JrcXVldWUu
aCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIGJvb2wgcXVldWVfd29yayhzdHJ1Y3Qgd29ya3F1ZXVlX3N0cnVjdCAq
d3EsCiAgICAgICAgIHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKewogcmV0dXJuIHF1ZXVl
X3dvcmtfb24oV09SS19DUFVfVU5CT1VORCwgd3EsIHdvcmspOwp9CiMgNTE4ICIuL2luY2x1
ZGUvbGludXgvd29ya3F1ZXVlLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIHF1ZXVlX2RlbGF5ZWRfd29y
ayhzdHJ1Y3Qgd29ya3F1ZXVlX3N0cnVjdCAqd3EsCiAgICAgICAgICBzdHJ1Y3QgZGVsYXll
ZF93b3JrICpkd29yaywKICAgICAgICAgIHVuc2lnbmVkIGxvbmcgZGVsYXkpCnsKIHJldHVy
biBxdWV1ZV9kZWxheWVkX3dvcmtfb24oV09SS19DUFVfVU5CT1VORCwgd3EsIGR3b3JrLCBk
ZWxheSk7Cn0KIyA1MzMgIi4vaW5jbHVkZS9saW51eC93b3JrcXVldWUuaCIKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IGJvb2wgbW9kX2RlbGF5ZWRfd29yayhzdHJ1Y3Qgd29ya3F1ZXVlX3N0cnVjdCAqd3EsCiAg
ICAgICAgc3RydWN0IGRlbGF5ZWRfd29yayAqZHdvcmssCiAgICAgICAgdW5zaWduZWQgbG9u
ZyBkZWxheSkKewogcmV0dXJuIG1vZF9kZWxheWVkX3dvcmtfb24oV09SS19DUFVfVU5CT1VO
RCwgd3EsIGR3b3JrLCBkZWxheSk7Cn0KIyA1NDcgIi4vaW5jbHVkZS9saW51eC93b3JrcXVl
dWUuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIGJvb2wgc2NoZWR1bGVfd29ya19vbihpbnQgY3B1LCBzdHJ1Y3Qg
d29ya19zdHJ1Y3QgKndvcmspCnsKIHJldHVybiBxdWV1ZV93b3JrX29uKGNwdSwgc3lzdGVt
X3dxLCB3b3JrKTsKfQojIDU2NiAiLi9pbmNsdWRlL2xpbnV4L3dvcmtxdWV1ZS5oIgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgYm9vbCBzY2hlZHVsZV93b3JrKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKewog
cmV0dXJuIHF1ZXVlX3dvcmsoc3lzdGVtX3dxLCB3b3JrKTsKfQojIDU5NSAiLi9pbmNsdWRl
L2xpbnV4L3dvcmtxdWV1ZS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBmbHVzaF9zY2hlZHVsZWRfd29y
ayh2b2lkKQp7CiBmbHVzaF93b3JrcXVldWUoc3lzdGVtX3dxKTsKfQojIDYwOSAiLi9pbmNs
dWRlL2xpbnV4L3dvcmtxdWV1ZS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBzY2hlZHVsZV9kZWxheWVk
X3dvcmtfb24oaW50IGNwdSwgc3RydWN0IGRlbGF5ZWRfd29yayAqZHdvcmssCiAgICAgICAg
IHVuc2lnbmVkIGxvbmcgZGVsYXkpCnsKIHJldHVybiBxdWV1ZV9kZWxheWVkX3dvcmtfb24o
Y3B1LCBzeXN0ZW1fd3EsIGR3b3JrLCBkZWxheSk7Cn0KIyA2MjMgIi4vaW5jbHVkZS9saW51
eC93b3JrcXVldWUuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgc2NoZWR1bGVfZGVsYXllZF93b3JrKHN0
cnVjdCBkZWxheWVkX3dvcmsgKmR3b3JrLAogICAgICB1bnNpZ25lZCBsb25nIGRlbGF5KQp7
CiByZXR1cm4gcXVldWVfZGVsYXllZF93b3JrKHN5c3RlbV93cSwgZHdvcmssIGRlbGF5KTsK
fQojIDYzOSAiLi9pbmNsdWRlL2xpbnV4L3dvcmtxdWV1ZS5oIgpsb25nIHdvcmtfb25fY3B1
KGludCBjcHUsIGxvbmcgKCpmbikodm9pZCAqKSwgdm9pZCAqYXJnKTsKbG9uZyB3b3JrX29u
X2NwdV9zYWZlKGludCBjcHUsIGxvbmcgKCpmbikodm9pZCAqKSwgdm9pZCAqYXJnKTsKIyA2
NTAgIi4vaW5jbHVkZS9saW51eC93b3JrcXVldWUuaCIKaW50IHdvcmtxdWV1ZV9zeXNmc19y
ZWdpc3RlcihzdHJ1Y3Qgd29ya3F1ZXVlX3N0cnVjdCAqd3EpOwojIDY1OSAiLi9pbmNsdWRl
L2xpbnV4L3dvcmtxdWV1ZS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCB3cV93YXRjaGRvZ190b3VjaChp
bnQgY3B1KSB7IH0KCgoKaW50IHdvcmtxdWV1ZV9wcmVwYXJlX2NwdSh1bnNpZ25lZCBpbnQg
Y3B1KTsKaW50IHdvcmtxdWV1ZV9vbmxpbmVfY3B1KHVuc2lnbmVkIGludCBjcHUpOwppbnQg
d29ya3F1ZXVlX29mZmxpbmVfY3B1KHVuc2lnbmVkIGludCBjcHUpOwoKCnZvaWQgX19hdHRy
aWJ1dGVfXygoX19zZWN0aW9uX18oIi5pbml0LnRleHQiKSkpIF9fYXR0cmlidXRlX18oKF9f
Y29sZF9fKSkgd29ya3F1ZXVlX2luaXRfZWFybHkodm9pZCk7CnZvaWQgX19hdHRyaWJ1dGVf
XygoX19zZWN0aW9uX18oIi5pbml0LnRleHQiKSkpIF9fYXR0cmlidXRlX18oKF9fY29sZF9f
KSkgd29ya3F1ZXVlX2luaXQodm9pZCk7CiMgMTYgIi4vaW5jbHVkZS9saW51eC9yaGFzaHRh
YmxlLXR5cGVzLmgiIDIKCnN0cnVjdCByaGFzaF9oZWFkIHsKIHN0cnVjdCByaGFzaF9oZWFk
ICpuZXh0Owp9OwoKc3RydWN0IHJobGlzdF9oZWFkIHsKIHN0cnVjdCByaGFzaF9oZWFkIHJo
ZWFkOwogc3RydWN0IHJobGlzdF9oZWFkICpuZXh0Owp9OwoKc3RydWN0IGJ1Y2tldF90YWJs
ZTsKCgoKCgoKc3RydWN0IHJoYXNodGFibGVfY29tcGFyZV9hcmcgewogc3RydWN0IHJoYXNo
dGFibGUgKmh0OwogY29uc3Qgdm9pZCAqa2V5Owp9OwoKdHlwZWRlZiB1MzIgKCpyaHRfaGFz
aGZuX3QpKGNvbnN0IHZvaWQgKmRhdGEsIHUzMiBsZW4sIHUzMiBzZWVkKTsKdHlwZWRlZiB1
MzIgKCpyaHRfb2JqX2hhc2hmbl90KShjb25zdCB2b2lkICpkYXRhLCB1MzIgbGVuLCB1MzIg
c2VlZCk7CnR5cGVkZWYgaW50ICgqcmh0X29ial9jbXBmbl90KShzdHJ1Y3Qgcmhhc2h0YWJs
ZV9jb21wYXJlX2FyZyAqYXJnLAogICAgICAgICAgY29uc3Qgdm9pZCAqb2JqKTsKIyA1NiAi
Li9pbmNsdWRlL2xpbnV4L3JoYXNodGFibGUtdHlwZXMuaCIKc3RydWN0IHJoYXNodGFibGVf
cGFyYW1zIHsKIHUxNiBuZWxlbV9oaW50OwogdTE2IGtleV9sZW47CiB1MTYga2V5X29mZnNl
dDsKIHUxNiBoZWFkX29mZnNldDsKIHVuc2lnbmVkIGludCBtYXhfc2l6ZTsKIHUxNiBtaW5f
c2l6ZTsKIGJvb2wgYXV0b21hdGljX3Nocmlua2luZzsKIHJodF9oYXNoZm5fdCBoYXNoZm47
CiByaHRfb2JqX2hhc2hmbl90IG9ial9oYXNoZm47CiByaHRfb2JqX2NtcGZuX3Qgb2JqX2Nt
cGZuOwp9OwojIDgxICIuL2luY2x1ZGUvbGludXgvcmhhc2h0YWJsZS10eXBlcy5oIgpzdHJ1
Y3Qgcmhhc2h0YWJsZSB7CiBzdHJ1Y3QgYnVja2V0X3RhYmxlICp0Ymw7CiB1bnNpZ25lZCBp
bnQga2V5X2xlbjsKIHVuc2lnbmVkIGludCBtYXhfZWxlbXM7CiBzdHJ1Y3Qgcmhhc2h0YWJs
ZV9wYXJhbXMgcDsKIGJvb2wgcmhsaXN0Owogc3RydWN0IHdvcmtfc3RydWN0IHJ1bl93b3Jr
Owogc3RydWN0IG11dGV4IG11dGV4Owogc3BpbmxvY2tfdCBsb2NrOwogYXRvbWljX3QgbmVs
ZW1zOwp9OwoKCgoKCnN0cnVjdCByaGx0YWJsZSB7CiBzdHJ1Y3Qgcmhhc2h0YWJsZSBodDsK
fTsKCgoKCgoKc3RydWN0IHJoYXNodGFibGVfd2Fsa2VyIHsKIHN0cnVjdCBsaXN0X2hlYWQg
bGlzdDsKIHN0cnVjdCBidWNrZXRfdGFibGUgKnRibDsKfTsKIyAxMjAgIi4vaW5jbHVkZS9s
aW51eC9yaGFzaHRhYmxlLXR5cGVzLmgiCnN0cnVjdCByaGFzaHRhYmxlX2l0ZXIgewogc3Ry
dWN0IHJoYXNodGFibGUgKmh0Owogc3RydWN0IHJoYXNoX2hlYWQgKnA7CiBzdHJ1Y3Qgcmhs
aXN0X2hlYWQgKmxpc3Q7CiBzdHJ1Y3Qgcmhhc2h0YWJsZV93YWxrZXIgd2Fsa2VyOwogdW5z
aWduZWQgaW50IHNsb3Q7CiB1bnNpZ25lZCBpbnQgc2tpcDsKIGJvb2wgZW5kX29mX3RhYmxl
Owp9OwoKaW50IHJoYXNodGFibGVfaW5pdChzdHJ1Y3Qgcmhhc2h0YWJsZSAqaHQsCiAgICAg
IGNvbnN0IHN0cnVjdCByaGFzaHRhYmxlX3BhcmFtcyAqcGFyYW1zKTsKaW50IHJobHRhYmxl
X2luaXQoc3RydWN0IHJobHRhYmxlICpobHQsCiAgICBjb25zdCBzdHJ1Y3Qgcmhhc2h0YWJs
ZV9wYXJhbXMgKnBhcmFtcyk7CiMgOCAiLi9pbmNsdWRlL2xpbnV4L2lwYy5oIiAyCiMgMSAi
Li9pbmNsdWRlL3VhcGkvbGludXgvaXBjLmgiIDEKIyAxMCAiLi9pbmNsdWRlL3VhcGkvbGlu
dXgvaXBjLmgiCnN0cnVjdCBpcGNfcGVybQp7CiBfX2tlcm5lbF9rZXlfdCBrZXk7CiBfX2tl
cm5lbF91aWRfdCB1aWQ7CiBfX2tlcm5lbF9naWRfdCBnaWQ7CiBfX2tlcm5lbF91aWRfdCBj
dWlkOwogX19rZXJuZWxfZ2lkX3QgY2dpZDsKIF9fa2VybmVsX21vZGVfdCBtb2RlOwogdW5z
aWduZWQgc2hvcnQgc2VxOwp9OwoKCiMgMSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS91YXBp
L2FzbS9pcGNidWYuaCIgMQojIDIxICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL3VhcGkvYXNt
L2lwY2J1Zi5oIgpzdHJ1Y3QgaXBjNjRfcGVybQp7CiBfX2tlcm5lbF9rZXlfdCBrZXk7CiBf
X2tlcm5lbF91aWRfdCB1aWQ7CiBfX2tlcm5lbF9naWRfdCBnaWQ7CiBfX2tlcm5lbF91aWRf
dCBjdWlkOwogX19rZXJuZWxfZ2lkX3QgY2dpZDsKIF9fa2VybmVsX21vZGVfdCBtb2RlOwog
dW5zaWduZWQgaW50IHNlcTsKIHVuc2lnbmVkIGludCBfX3BhZDE7CiB1bnNpZ25lZCBsb25n
IGxvbmcgX191bnVzZWQxOwogdW5zaWduZWQgbG9uZyBsb25nIF9fdW51c2VkMjsKfTsKIyAy
MyAiLi9pbmNsdWRlL3VhcGkvbGludXgvaXBjLmgiIDIKIyA1OCAiLi9pbmNsdWRlL3VhcGkv
bGludXgvaXBjLmgiCnN0cnVjdCBpcGNfa2x1ZGdlIHsKIHN0cnVjdCBtc2didWYgKm1zZ3A7
CiBsb25nIG1zZ3R5cDsKfTsKIyA5ICIuL2luY2x1ZGUvbGludXgvaXBjLmgiIDIKCgoKc3Ry
dWN0IGtlcm5faXBjX3Blcm0gewogc3BpbmxvY2tfdCBsb2NrOwogYm9vbCBkZWxldGVkOwog
aW50IGlkOwoga2V5X3Qga2V5Owoga3VpZF90IHVpZDsKIGtnaWRfdCBnaWQ7CiBrdWlkX3Qg
Y3VpZDsKIGtnaWRfdCBjZ2lkOwogdW1vZGVfdCBtb2RlOwogdW5zaWduZWQgbG9uZyBzZXE7
CiB2b2lkICpzZWN1cml0eTsKCiBzdHJ1Y3Qgcmhhc2hfaGVhZCBraHRub2RlOwoKIHN0cnVj
dCBjYWxsYmFja19oZWFkIHJjdTsKIHJlZmNvdW50X3QgcmVmY291bnQ7Cn0gX19hdHRyaWJ1
dGVfXygoX19hbGlnbmVkX18oKDEgPDwgNikpKSkgOwojIDYgIi4vaW5jbHVkZS91YXBpL2xp
bnV4L3NlbS5oIiAyCiMgMjUgIi4vaW5jbHVkZS91YXBpL2xpbnV4L3NlbS5oIgpzdHJ1Y3Qg
c2VtaWRfZHMgewogc3RydWN0IGlwY19wZXJtIHNlbV9wZXJtOwogX19rZXJuZWxfb2xkX3Rp
bWVfdCBzZW1fb3RpbWU7CiBfX2tlcm5lbF9vbGRfdGltZV90IHNlbV9jdGltZTsKIHN0cnVj
dCBzZW0gKnNlbV9iYXNlOwogc3RydWN0IHNlbV9xdWV1ZSAqc2VtX3BlbmRpbmc7CiBzdHJ1
Y3Qgc2VtX3F1ZXVlICoqc2VtX3BlbmRpbmdfbGFzdDsKIHN0cnVjdCBzZW1fdW5kbyAqdW5k
bzsKIHVuc2lnbmVkIHNob3J0IHNlbV9uc2VtczsKfTsKCgojIDEgIi4vYXJjaC9wb3dlcnBj
L2luY2x1ZGUvdWFwaS9hc20vc2VtYnVmLmgiIDEKIyAyMyAiLi9hcmNoL3Bvd2VycGMvaW5j
bHVkZS91YXBpL2FzbS9zZW1idWYuaCIKc3RydWN0IHNlbWlkNjRfZHMgewogc3RydWN0IGlw
YzY0X3Blcm0gc2VtX3Blcm07CgoKCgoKCiBsb25nIHNlbV9vdGltZTsKIGxvbmcgc2VtX2N0
aW1lOwoKIHVuc2lnbmVkIGxvbmcgc2VtX25zZW1zOwogdW5zaWduZWQgbG9uZyBfX3VudXNl
ZDM7CiB1bnNpZ25lZCBsb25nIF9fdW51c2VkNDsKfTsKIyAzOCAiLi9pbmNsdWRlL3VhcGkv
bGludXgvc2VtLmgiIDIKCgpzdHJ1Y3Qgc2VtYnVmIHsKIHVuc2lnbmVkIHNob3J0IHNlbV9u
dW07CiBzaG9ydCBzZW1fb3A7CiBzaG9ydCBzZW1fZmxnOwp9OwoKCnVuaW9uIHNlbXVuIHsK
IGludCB2YWw7CiBzdHJ1Y3Qgc2VtaWRfZHMgKmJ1ZjsKIHVuc2lnbmVkIHNob3J0ICphcnJh
eTsKIHN0cnVjdCBzZW1pbmZvICpfX2J1ZjsKIHZvaWQgKl9fcGFkOwp9OwoKc3RydWN0IHNl
bWluZm8gewogaW50IHNlbW1hcDsKIGludCBzZW1tbmk7CiBpbnQgc2VtbW5zOwogaW50IHNl
bW1udTsKIGludCBzZW1tc2w7CiBpbnQgc2Vtb3BtOwogaW50IHNlbXVtZTsKIGludCBzZW11
c3o7CiBpbnQgc2Vtdm14OwogaW50IHNlbWFlbTsKfTsKIyA2ICIuL2luY2x1ZGUvbGludXgv
c2VtLmgiIDIKCnN0cnVjdCB0YXNrX3N0cnVjdDsKc3RydWN0IHNlbV91bmRvX2xpc3Q7CgoK
CnN0cnVjdCBzeXN2X3NlbSB7CiBzdHJ1Y3Qgc2VtX3VuZG9fbGlzdCAqdW5kb19saXN0Owp9
OwoKZXh0ZXJuIGludCBjb3B5X3NlbXVuZG8odW5zaWduZWQgbG9uZyBjbG9uZV9mbGFncywg
c3RydWN0IHRhc2tfc3RydWN0ICp0c2spOwpleHRlcm4gdm9pZCBleGl0X3NlbShzdHJ1Y3Qg
dGFza19zdHJ1Y3QgKnRzayk7CiMgMTYgIi4vaW5jbHVkZS9saW51eC9zY2hlZC5oIiAyCiMg
MSAiLi9pbmNsdWRlL2xpbnV4L3NobS5oIiAxCgoKCgoKCiMgMSAiLi9pbmNsdWRlL3VhcGkv
bGludXgvc2htLmgiIDEKCgoKCgoKIyAxICIuL2luY2x1ZGUvdWFwaS9hc20tZ2VuZXJpYy9o
dWdldGxiX2VuY29kZS5oIiAxCiMgOCAiLi9pbmNsdWRlL3VhcGkvbGludXgvc2htLmgiIDIK
IyAyOCAiLi9pbmNsdWRlL3VhcGkvbGludXgvc2htLmgiCnN0cnVjdCBzaG1pZF9kcyB7CiBz
dHJ1Y3QgaXBjX3Blcm0gc2htX3Blcm07CiBpbnQgc2htX3NlZ3N6OwogX19rZXJuZWxfb2xk
X3RpbWVfdCBzaG1fYXRpbWU7CiBfX2tlcm5lbF9vbGRfdGltZV90IHNobV9kdGltZTsKIF9f
a2VybmVsX29sZF90aW1lX3Qgc2htX2N0aW1lOwogX19rZXJuZWxfaXBjX3BpZF90IHNobV9j
cGlkOwogX19rZXJuZWxfaXBjX3BpZF90IHNobV9scGlkOwogdW5zaWduZWQgc2hvcnQgc2ht
X25hdHRjaDsKIHVuc2lnbmVkIHNob3J0IHNobV91bnVzZWQ7CiB2b2lkICpzaG1fdW51c2Vk
MjsKIHZvaWQgKnNobV91bnVzZWQzOwp9OwoKCiMgMSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVk
ZS91YXBpL2FzbS9zaG1idWYuaCIgMQojIDIyICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL3Vh
cGkvYXNtL3NobWJ1Zi5oIgpzdHJ1Y3Qgc2htaWQ2NF9kcyB7CiBzdHJ1Y3QgaXBjNjRfcGVy
bSBzaG1fcGVybTsKCiBsb25nIHNobV9hdGltZTsKIGxvbmcgc2htX2R0aW1lOwogbG9uZyBz
aG1fY3RpbWU7CiMgMzcgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvdWFwaS9hc20vc2htYnVm
LmgiCiBzaXplX3Qgc2htX3NlZ3N6OwogX19rZXJuZWxfcGlkX3Qgc2htX2NwaWQ7CiBfX2tl
cm5lbF9waWRfdCBzaG1fbHBpZDsKIHVuc2lnbmVkIGxvbmcgc2htX25hdHRjaDsKIHVuc2ln
bmVkIGxvbmcgX191bnVzZWQ1OwogdW5zaWduZWQgbG9uZyBfX3VudXNlZDY7Cn07CgpzdHJ1
Y3Qgc2htaW5mbzY0IHsKIHVuc2lnbmVkIGxvbmcgc2htbWF4OwogdW5zaWduZWQgbG9uZyBz
aG1taW47CiB1bnNpZ25lZCBsb25nIHNobW1uaTsKIHVuc2lnbmVkIGxvbmcgc2htc2VnOwog
dW5zaWduZWQgbG9uZyBzaG1hbGw7CiB1bnNpZ25lZCBsb25nIF9fdW51c2VkMTsKIHVuc2ln
bmVkIGxvbmcgX191bnVzZWQyOwogdW5zaWduZWQgbG9uZyBfX3VudXNlZDM7CiB1bnNpZ25l
ZCBsb25nIF9fdW51c2VkNDsKfTsKIyA0NCAiLi9pbmNsdWRlL3VhcGkvbGludXgvc2htLmgi
IDIKIyA5MyAiLi9pbmNsdWRlL3VhcGkvbGludXgvc2htLmgiCnN0cnVjdCBzaG1pbmZvIHsK
IGludCBzaG1tYXg7CiBpbnQgc2htbWluOwogaW50IHNobW1uaTsKIGludCBzaG1zZWc7CiBp
bnQgc2htYWxsOwp9OwoKc3RydWN0IHNobV9pbmZvIHsKIGludCB1c2VkX2lkczsKIF9fa2Vy
bmVsX3Vsb25nX3Qgc2htX3RvdDsKIF9fa2VybmVsX3Vsb25nX3Qgc2htX3JzczsKIF9fa2Vy
bmVsX3Vsb25nX3Qgc2htX3N3cDsKIF9fa2VybmVsX3Vsb25nX3Qgc3dhcF9hdHRlbXB0czsK
IF9fa2VybmVsX3Vsb25nX3Qgc3dhcF9zdWNjZXNzZXM7Cn07CiMgOCAiLi9pbmNsdWRlL2xp
bnV4L3NobS5oIiAyCiMgMSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vc2htcGFyYW0u
aCIgMQojIDkgIi4vaW5jbHVkZS9saW51eC9zaG0uaCIgMgoKc3RydWN0IGZpbGU7CgoKc3Ry
dWN0IHN5c3Zfc2htIHsKIHN0cnVjdCBsaXN0X2hlYWQgc2htX2NsaXN0Owp9OwoKbG9uZyBk
b19zaG1hdChpbnQgc2htaWQsIGNoYXIgKnNobWFkZHIsIGludCBzaG1mbGcsIHVuc2lnbmVk
IGxvbmcgKmFkZHIsCiAgICAgICB1bnNpZ25lZCBsb25nIHNobWxiYSk7CmJvb2wgaXNfZmls
ZV9zaG1faHVnZXBhZ2VzKHN0cnVjdCBmaWxlICpmaWxlKTsKdm9pZCBleGl0X3NobShzdHJ1
Y3QgdGFza19zdHJ1Y3QgKnRhc2spOwojIDE3ICIuL2luY2x1ZGUvbGludXgvc2NoZWQuaCIg
MgojIDEgIi4vaW5jbHVkZS9saW51eC9rY292LmgiIDEKCgoKCiMgMSAiLi9pbmNsdWRlL3Vh
cGkvbGludXgva2Nvdi5oIiAxCiMgMTEgIi4vaW5jbHVkZS91YXBpL2xpbnV4L2tjb3YuaCIK
c3RydWN0IGtjb3ZfcmVtb3RlX2FyZyB7CiBfX3UzMiB0cmFjZV9tb2RlOwogX191MzIgYXJl
YV9zaXplOwogX191MzIgbnVtX2hhbmRsZXM7CiBfX3U2NCBfX2F0dHJpYnV0ZV9fKChhbGln
bmVkKDgpKSkgY29tbW9uX2hhbmRsZTsKIF9fdTY0IF9fYXR0cmlidXRlX18oKGFsaWduZWQo
OCkpKSBoYW5kbGVzWzBdOwp9OwojIDI2ICIuL2luY2x1ZGUvdWFwaS9saW51eC9rY292Lmgi
CmVudW0gewojIDM1ICIuL2luY2x1ZGUvdWFwaS9saW51eC9rY292LmgiCiBLQ09WX1RSQUNF
X1BDID0gMCwKCiBLQ09WX1RSQUNFX0NNUCA9IDEsCn07CiMgNTYgIi4vaW5jbHVkZS91YXBp
L2xpbnV4L2tjb3YuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fdTY0IGtjb3ZfcmVtb3RlX2hhbmRsZShfX3U2
NCBzdWJzeXMsIF9fdTY0IGluc3QpCnsKIGlmIChzdWJzeXMgJiB+KDB4ZmZ1bGwgPDwgNTYp
IHx8IGluc3QgJiB+KDB4ZmZmZmZmZmZ1bGwpKQogIHJldHVybiAwOwogcmV0dXJuIHN1YnN5
cyB8IGluc3Q7Cn0KIyA2ICIuL2luY2x1ZGUvbGludXgva2Nvdi5oIiAyCgpzdHJ1Y3QgdGFz
a19zdHJ1Y3Q7CiMgNTcgIi4vaW5jbHVkZS9saW51eC9rY292LmgiCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lk
IGtjb3ZfdGFza19pbml0KHN0cnVjdCB0YXNrX3N0cnVjdCAqdCkge30Kc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZv
aWQga2Nvdl90YXNrX2V4aXQoc3RydWN0IHRhc2tfc3RydWN0ICp0KSB7fQpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
dm9pZCBrY292X3ByZXBhcmVfc3dpdGNoKHN0cnVjdCB0YXNrX3N0cnVjdCAqdCkge30Kc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIHZvaWQga2Nvdl9maW5pc2hfc3dpdGNoKHN0cnVjdCB0YXNrX3N0cnVjdCAqdCkg
e30Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIHZvaWQga2Nvdl9yZW1vdGVfc3RhcnQodTY0IGhhbmRsZSkge30Kc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIHZvaWQga2Nvdl9yZW1vdGVfc3RvcCh2b2lkKSB7fQpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdTY0IGtj
b3ZfY29tbW9uX2hhbmRsZSh2b2lkKQp7CiByZXR1cm4gMDsKfQpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBr
Y292X3JlbW90ZV9zdGFydF9jb21tb24odTY0IGlkKSB7fQpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBrY292
X3JlbW90ZV9zdGFydF91c2IodTY0IGlkKSB7fQojIDE4ICIuL2luY2x1ZGUvbGludXgvc2No
ZWQuaCIgMgoKIyAxICIuL2luY2x1ZGUvbGludXgvcGxpc3QuaCIgMQojIDc5ICIuL2luY2x1
ZGUvbGludXgvcGxpc3QuaCIKc3RydWN0IHBsaXN0X2hlYWQgewogc3RydWN0IGxpc3RfaGVh
ZCBub2RlX2xpc3Q7Cn07CgpzdHJ1Y3QgcGxpc3Rfbm9kZSB7CiBpbnQgcHJpbzsKIHN0cnVj
dCBsaXN0X2hlYWQgcHJpb19saXN0Owogc3RydWN0IGxpc3RfaGVhZCBub2RlX2xpc3Q7Cn07
CiMgMTIxICIuL2luY2x1ZGUvbGludXgvcGxpc3QuaCIKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQKcGxpc3Rf
aGVhZF9pbml0KHN0cnVjdCBwbGlzdF9oZWFkICpoZWFkKQp7CiBJTklUX0xJU1RfSEVBRCgm
aGVhZC0+bm9kZV9saXN0KTsKfQoKCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBwbGlzdF9ub2RlX2lu
aXQoc3RydWN0IHBsaXN0X25vZGUgKm5vZGUsIGludCBwcmlvKQp7CiBub2RlLT5wcmlvID0g
cHJpbzsKIElOSVRfTElTVF9IRUFEKCZub2RlLT5wcmlvX2xpc3QpOwogSU5JVF9MSVNUX0hF
QUQoJm5vZGUtPm5vZGVfbGlzdCk7Cn0KCmV4dGVybiB2b2lkIHBsaXN0X2FkZChzdHJ1Y3Qg
cGxpc3Rfbm9kZSAqbm9kZSwgc3RydWN0IHBsaXN0X2hlYWQgKmhlYWQpOwpleHRlcm4gdm9p
ZCBwbGlzdF9kZWwoc3RydWN0IHBsaXN0X25vZGUgKm5vZGUsIHN0cnVjdCBwbGlzdF9oZWFk
ICpoZWFkKTsKCmV4dGVybiB2b2lkIHBsaXN0X3JlcXVldWUoc3RydWN0IHBsaXN0X25vZGUg
Km5vZGUsIHN0cnVjdCBwbGlzdF9oZWFkICpoZWFkKTsKIyAyMTAgIi4vaW5jbHVkZS9saW51
eC9wbGlzdC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHBsaXN0X2hlYWRfZW1wdHkoY29uc3Qgc3RydWN0
IHBsaXN0X2hlYWQgKmhlYWQpCnsKIHJldHVybiBsaXN0X2VtcHR5KCZoZWFkLT5ub2RlX2xp
c3QpOwp9CgoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBwbGlzdF9ub2RlX2VtcHR5KGNvbnN0IHN0cnVj
dCBwbGlzdF9ub2RlICpub2RlKQp7CiByZXR1cm4gbGlzdF9lbXB0eSgmbm9kZS0+bm9kZV9s
aXN0KTsKfQojIDI4MCAiLi9pbmNsdWRlL2xpbnV4L3BsaXN0LmgiCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1
Y3QgcGxpc3Rfbm9kZSAqcGxpc3RfZmlyc3QoY29uc3Qgc3RydWN0IHBsaXN0X2hlYWQgKmhl
YWQpCnsKIHJldHVybiAoeyB2b2lkICpfX21wdHIgPSAodm9pZCAqKShoZWFkLT5ub2RlX2xp
c3QubmV4dCk7IGRvIHsgZXh0ZXJuIHZvaWQgX19jb21waWxldGltZV9hc3NlcnRfOTModm9p
ZCkgX19hdHRyaWJ1dGVfXygoX19lcnJvcl9fKCJwb2ludGVyIHR5cGUgbWlzbWF0Y2ggaW4g
Y29udGFpbmVyX29mKCkiKSkpOyBpZiAoISghKCFfX2J1aWx0aW5fdHlwZXNfY29tcGF0aWJs
ZV9wKHR5cGVvZigqKGhlYWQtPm5vZGVfbGlzdC5uZXh0KSksIHR5cGVvZigoKHN0cnVjdCBw
bGlzdF9ub2RlICopMCktPm5vZGVfbGlzdCkpICYmICFfX2J1aWx0aW5fdHlwZXNfY29tcGF0
aWJsZV9wKHR5cGVvZigqKGhlYWQtPm5vZGVfbGlzdC5uZXh0KSksIHR5cGVvZih2b2lkKSkp
KSkgX19jb21waWxldGltZV9hc3NlcnRfOTMoKTsgfSB3aGlsZSAoMCk7ICgoc3RydWN0IHBs
aXN0X25vZGUgKikoX19tcHRyIC0gX19idWlsdGluX29mZnNldG9mKHN0cnVjdCBwbGlzdF9u
b2RlLCBub2RlX2xpc3QpKSk7IH0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICA7Cn0KCgoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3QgcGxpc3Rfbm9kZSAqcGxpc3RfbGFzdChj
b25zdCBzdHJ1Y3QgcGxpc3RfaGVhZCAqaGVhZCkKewogcmV0dXJuICh7IHZvaWQgKl9fbXB0
ciA9ICh2b2lkICopKGhlYWQtPm5vZGVfbGlzdC5wcmV2KTsgZG8geyBleHRlcm4gdm9pZCBf
X2NvbXBpbGV0aW1lX2Fzc2VydF85NCh2b2lkKSBfX2F0dHJpYnV0ZV9fKChfX2Vycm9yX18o
InBvaW50ZXIgdHlwZSBtaXNtYXRjaCBpbiBjb250YWluZXJfb2YoKSIpKSk7IGlmICghKCEo
IV9fYnVpbHRpbl90eXBlc19jb21wYXRpYmxlX3AodHlwZW9mKCooaGVhZC0+bm9kZV9saXN0
LnByZXYpKSwgdHlwZW9mKCgoc3RydWN0IHBsaXN0X25vZGUgKikwKS0+bm9kZV9saXN0KSkg
JiYgIV9fYnVpbHRpbl90eXBlc19jb21wYXRpYmxlX3AodHlwZW9mKCooaGVhZC0+bm9kZV9s
aXN0LnByZXYpKSwgdHlwZW9mKHZvaWQpKSkpKSBfX2NvbXBpbGV0aW1lX2Fzc2VydF85NCgp
OyB9IHdoaWxlICgwKTsgKChzdHJ1Y3QgcGxpc3Rfbm9kZSAqKShfX21wdHIgLSBfX2J1aWx0
aW5fb2Zmc2V0b2Yoc3RydWN0IHBsaXN0X25vZGUsIG5vZGVfbGlzdCkpKTsgfSkKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIDsKfQojIDIwICIuL2luY2x1ZGUvbGludXgv
c2NoZWQuaCIgMgojIDEgIi4vaW5jbHVkZS9saW51eC9ocnRpbWVyLmgiIDEKIyAxNSAiLi9p
bmNsdWRlL2xpbnV4L2hydGltZXIuaCIKIyAxICIuL2luY2x1ZGUvbGludXgvaHJ0aW1lcl9k
ZWZzLmgiIDEKIyAxNiAiLi9pbmNsdWRlL2xpbnV4L2hydGltZXIuaCIgMgojIDEgIi4vaW5j
bHVkZS9saW51eC9yYnRyZWUuaCIgMQojIDI0ICIuL2luY2x1ZGUvbGludXgvcmJ0cmVlLmgi
CnN0cnVjdCByYl9ub2RlIHsKIHVuc2lnbmVkIGxvbmcgX19yYl9wYXJlbnRfY29sb3I7CiBz
dHJ1Y3QgcmJfbm9kZSAqcmJfcmlnaHQ7CiBzdHJ1Y3QgcmJfbm9kZSAqcmJfbGVmdDsKfSBf
X2F0dHJpYnV0ZV9fKChhbGlnbmVkKHNpemVvZihsb25nKSkpKTsKCgpzdHJ1Y3QgcmJfcm9v
dCB7CiBzdHJ1Y3QgcmJfbm9kZSAqcmJfbm9kZTsKfTsKIyA0OSAiLi9pbmNsdWRlL2xpbnV4
L3JidHJlZS5oIgpleHRlcm4gdm9pZCByYl9pbnNlcnRfY29sb3Ioc3RydWN0IHJiX25vZGUg
Kiwgc3RydWN0IHJiX3Jvb3QgKik7CmV4dGVybiB2b2lkIHJiX2VyYXNlKHN0cnVjdCByYl9u
b2RlICosIHN0cnVjdCByYl9yb290ICopOwoKCgpleHRlcm4gc3RydWN0IHJiX25vZGUgKnJi
X25leHQoY29uc3Qgc3RydWN0IHJiX25vZGUgKik7CmV4dGVybiBzdHJ1Y3QgcmJfbm9kZSAq
cmJfcHJldihjb25zdCBzdHJ1Y3QgcmJfbm9kZSAqKTsKZXh0ZXJuIHN0cnVjdCByYl9ub2Rl
ICpyYl9maXJzdChjb25zdCBzdHJ1Y3QgcmJfcm9vdCAqKTsKZXh0ZXJuIHN0cnVjdCByYl9u
b2RlICpyYl9sYXN0KGNvbnN0IHN0cnVjdCByYl9yb290ICopOwoKCmV4dGVybiBzdHJ1Y3Qg
cmJfbm9kZSAqcmJfZmlyc3RfcG9zdG9yZGVyKGNvbnN0IHN0cnVjdCByYl9yb290ICopOwpl
eHRlcm4gc3RydWN0IHJiX25vZGUgKnJiX25leHRfcG9zdG9yZGVyKGNvbnN0IHN0cnVjdCBy
Yl9ub2RlICopOwoKCmV4dGVybiB2b2lkIHJiX3JlcGxhY2Vfbm9kZShzdHJ1Y3QgcmJfbm9k
ZSAqdmljdGltLCBzdHJ1Y3QgcmJfbm9kZSAqbmV3LAogICAgICAgc3RydWN0IHJiX3Jvb3Qg
KnJvb3QpOwpleHRlcm4gdm9pZCByYl9yZXBsYWNlX25vZGVfcmN1KHN0cnVjdCByYl9ub2Rl
ICp2aWN0aW0sIHN0cnVjdCByYl9ub2RlICpuZXcsCiAgICBzdHJ1Y3QgcmJfcm9vdCAqcm9v
dCk7CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgdm9pZCByYl9saW5rX25vZGUoc3RydWN0IHJiX25vZGUgKm5vZGUs
IHN0cnVjdCByYl9ub2RlICpwYXJlbnQsCiAgICBzdHJ1Y3QgcmJfbm9kZSAqKnJiX2xpbmsp
CnsKIG5vZGUtPl9fcmJfcGFyZW50X2NvbG9yID0gKHVuc2lnbmVkIGxvbmcpcGFyZW50Owog
bm9kZS0+cmJfbGVmdCA9IG5vZGUtPnJiX3JpZ2h0ID0gKCh2b2lkICopMCk7CgogKnJiX2xp
bmsgPSBub2RlOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCByYl9saW5rX25vZGVfcmN1KHN0cnVjdCBy
Yl9ub2RlICpub2RlLCBzdHJ1Y3QgcmJfbm9kZSAqcGFyZW50LAogICAgICAgIHN0cnVjdCBy
Yl9ub2RlICoqcmJfbGluaykKewogbm9kZS0+X19yYl9wYXJlbnRfY29sb3IgPSAodW5zaWdu
ZWQgbG9uZylwYXJlbnQ7CiBub2RlLT5yYl9sZWZ0ID0gbm9kZS0+cmJfcmlnaHQgPSAoKHZv
aWQgKikwKTsKCiBkbyB7IHVpbnRwdHJfdCBfcl9hX3BfX3YgPSAodWludHB0cl90KShub2Rl
KTsgOyBpZiAoX19idWlsdGluX2NvbnN0YW50X3Aobm9kZSkgJiYgKF9yX2FfcF9fdikgPT0g
KHVpbnRwdHJfdCkoKHZvaWQgKikwKSkgZG8geyBkbyB7IGV4dGVybiB2b2lkIF9fY29tcGls
ZXRpbWVfYXNzZXJ0Xzk1KHZvaWQpIF9fYXR0cmlidXRlX18oKF9fZXJyb3JfXygiVW5zdXBw
b3J0ZWQgYWNjZXNzIHNpemUgZm9yIHtSRUFELFdSSVRFfV9PTkNFKCkuIikpKTsgaWYgKCEo
KHNpemVvZigoKnJiX2xpbmspKSA9PSBzaXplb2YoY2hhcikgfHwgc2l6ZW9mKCgqcmJfbGlu
aykpID09IHNpemVvZihzaG9ydCkgfHwgc2l6ZW9mKCgqcmJfbGluaykpID09IHNpemVvZihp
bnQpIHx8IHNpemVvZigoKnJiX2xpbmspKSA9PSBzaXplb2YobG9uZykpIHx8IHNpemVvZigo
KnJiX2xpbmspKSA9PSBzaXplb2YobG9uZyBsb25nKSkpIF9fY29tcGlsZXRpbWVfYXNzZXJ0
Xzk1KCk7IH0gd2hpbGUgKDApOyBkbyB7ICoodm9sYXRpbGUgdHlwZW9mKCgqcmJfbGluaykp
ICopJigoKnJiX2xpbmspKSA9ICgodHlwZW9mKCpyYl9saW5rKSkoX3JfYV9wX192KSk7IH0g
d2hpbGUgKDApOyB9IHdoaWxlICgwKTsgZWxzZSBkbyB7IGRvIHsgZXh0ZXJuIHZvaWQgX19j
b21waWxldGltZV9hc3NlcnRfOTYodm9pZCkgX19hdHRyaWJ1dGVfXygoX19lcnJvcl9fKCJO
ZWVkIG5hdGl2ZSB3b3JkIHNpemVkIHN0b3Jlcy9sb2FkcyBmb3IgYXRvbWljaXR5LiIpKSk7
IGlmICghKChzaXplb2YoKiYqcmJfbGluaykgPT0gc2l6ZW9mKGNoYXIpIHx8IHNpemVvZigq
JipyYl9saW5rKSA9PSBzaXplb2Yoc2hvcnQpIHx8IHNpemVvZigqJipyYl9saW5rKSA9PSBz
aXplb2YoaW50KSB8fCBzaXplb2YoKiYqcmJfbGluaykgPT0gc2l6ZW9mKGxvbmcpKSkpIF9f
Y29tcGlsZXRpbWVfYXNzZXJ0Xzk2KCk7IH0gd2hpbGUgKDApOyBfX2FzbV9fIF9fdm9sYXRp
bGVfXyAoImx3c3luYyIgIiAiIDogOiA6Im1lbW9yeSIpOyBkbyB7IGRvIHsgZXh0ZXJuIHZv
aWQgX19jb21waWxldGltZV9hc3NlcnRfOTcodm9pZCkgX19hdHRyaWJ1dGVfXygoX19lcnJv
cl9fKCJVbnN1cHBvcnRlZCBhY2Nlc3Mgc2l6ZSBmb3Ige1JFQUQsV1JJVEV9X09OQ0UoKS4i
KSkpOyBpZiAoISgoc2l6ZW9mKComKnJiX2xpbmspID09IHNpemVvZihjaGFyKSB8fCBzaXpl
b2YoKiYqcmJfbGluaykgPT0gc2l6ZW9mKHNob3J0KSB8fCBzaXplb2YoKiYqcmJfbGluaykg
PT0gc2l6ZW9mKGludCkgfHwgc2l6ZW9mKComKnJiX2xpbmspID09IHNpemVvZihsb25nKSkg
fHwgc2l6ZW9mKComKnJiX2xpbmspID09IHNpemVvZihsb25nIGxvbmcpKSkgX19jb21waWxl
dGltZV9hc3NlcnRfOTcoKTsgfSB3aGlsZSAoMCk7IGRvIHsgKih2b2xhdGlsZSB0eXBlb2Yo
KiYqcmJfbGluaykgKikmKComKnJiX2xpbmspID0gKCh0eXBlb2YoKigodHlwZW9mKCpyYl9s
aW5rKSlfcl9hX3BfX3YpKSAqKSgodHlwZW9mKCpyYl9saW5rKSlfcl9hX3BfX3YpKTsgfSB3
aGlsZSAoMCk7IH0gd2hpbGUgKDApOyB9IHdoaWxlICgwKTsgfSB3aGlsZSAoMCk7Cn0KIyAx
MjUgIi4vaW5jbHVkZS9saW51eC9yYnRyZWUuaCIKc3RydWN0IHJiX3Jvb3RfY2FjaGVkIHsK
IHN0cnVjdCByYl9yb290IHJiX3Jvb3Q7CiBzdHJ1Y3QgcmJfbm9kZSAqcmJfbGVmdG1vc3Q7
Cn07CgoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHJiX2luc2VydF9jb2xvcl9jYWNoZWQoc3RydWN0
IHJiX25vZGUgKm5vZGUsCiAgICAgICBzdHJ1Y3QgcmJfcm9vdF9jYWNoZWQgKnJvb3QsCiAg
ICAgICBib29sIGxlZnRtb3N0KQp7CiBpZiAobGVmdG1vc3QpCiAgcm9vdC0+cmJfbGVmdG1v
c3QgPSBub2RlOwogcmJfaW5zZXJ0X2NvbG9yKG5vZGUsICZyb290LT5yYl9yb290KTsKfQoK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIHZvaWQgcmJfZXJhc2VfY2FjaGVkKHN0cnVjdCByYl9ub2RlICpub2RlLAog
ICAgICAgc3RydWN0IHJiX3Jvb3RfY2FjaGVkICpyb290KQp7CiBpZiAocm9vdC0+cmJfbGVm
dG1vc3QgPT0gbm9kZSkKICByb290LT5yYl9sZWZ0bW9zdCA9IHJiX25leHQobm9kZSk7CiBy
Yl9lcmFzZShub2RlLCAmcm9vdC0+cmJfcm9vdCk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHJiX3Jl
cGxhY2Vfbm9kZV9jYWNoZWQoc3RydWN0IHJiX25vZGUgKnZpY3RpbSwKICAgICAgIHN0cnVj
dCByYl9ub2RlICpuZXcsCiAgICAgICBzdHJ1Y3QgcmJfcm9vdF9jYWNoZWQgKnJvb3QpCnsK
IGlmIChyb290LT5yYl9sZWZ0bW9zdCA9PSB2aWN0aW0pCiAgcm9vdC0+cmJfbGVmdG1vc3Qg
PSBuZXc7CiByYl9yZXBsYWNlX25vZGUodmljdGltLCBuZXcsICZyb290LT5yYl9yb290KTsK
fQojIDE3ICIuL2luY2x1ZGUvbGludXgvaHJ0aW1lci5oIiAyCgoKIyAxICIuL2luY2x1ZGUv
bGludXgvcGVyY3B1LmgiIDEKCgoKCiMgMSAiLi9pbmNsdWRlL2xpbnV4L21tZGVidWcuaCIg
MQoKCgoKCgoKc3RydWN0IHBhZ2U7CnN0cnVjdCB2bV9hcmVhX3N0cnVjdDsKc3RydWN0IG1t
X3N0cnVjdDsKCmV4dGVybiB2b2lkIGR1bXBfcGFnZShzdHJ1Y3QgcGFnZSAqcGFnZSwgY29u
c3QgY2hhciAqcmVhc29uKTsKZXh0ZXJuIHZvaWQgX19kdW1wX3BhZ2Uoc3RydWN0IHBhZ2Ug
KnBhZ2UsIGNvbnN0IGNoYXIgKnJlYXNvbik7CnZvaWQgZHVtcF92bWEoY29uc3Qgc3RydWN0
IHZtX2FyZWFfc3RydWN0ICp2bWEpOwp2b2lkIGR1bXBfbW0oY29uc3Qgc3RydWN0IG1tX3N0
cnVjdCAqbW0pOwojIDYgIi4vaW5jbHVkZS9saW51eC9wZXJjcHUuaCIgMgoKIyAxICIuL2lu
Y2x1ZGUvbGludXgvc21wLmgiIDEKIyAxNSAiLi9pbmNsdWRlL2xpbnV4L3NtcC5oIgojIDEg
Ii4vaW5jbHVkZS9saW51eC9zbXBfdHlwZXMuaCIgMQoKCgoKIyAxICIuL2luY2x1ZGUvbGlu
dXgvbGxpc3QuaCIgMQojIDU0ICIuL2luY2x1ZGUvbGludXgvbGxpc3QuaCIKc3RydWN0IGxs
aXN0X2hlYWQgewogc3RydWN0IGxsaXN0X25vZGUgKmZpcnN0Owp9OwoKc3RydWN0IGxsaXN0
X25vZGUgewogc3RydWN0IGxsaXN0X25vZGUgKm5leHQ7Cn07CiMgNjkgIi4vaW5jbHVkZS9s
aW51eC9sbGlzdC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBpbml0X2xsaXN0X2hlYWQoc3RydWN0IGxs
aXN0X2hlYWQgKmxpc3QpCnsKIGxpc3QtPmZpcnN0ID0gKCh2b2lkICopMCk7Cn0KIyAxODcg
Ii4vaW5jbHVkZS9saW51eC9sbGlzdC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBsbGlzdF9lbXB0eShj
b25zdCBzdHJ1Y3QgbGxpc3RfaGVhZCAqaGVhZCkKewogcmV0dXJuICh7IGRvIHsgZXh0ZXJu
IHZvaWQgX19jb21waWxldGltZV9hc3NlcnRfOTgodm9pZCkgX19hdHRyaWJ1dGVfXygoX19l
cnJvcl9fKCJVbnN1cHBvcnRlZCBhY2Nlc3Mgc2l6ZSBmb3Ige1JFQUQsV1JJVEV9X09OQ0Uo
KS4iKSkpOyBpZiAoISgoc2l6ZW9mKGhlYWQtPmZpcnN0KSA9PSBzaXplb2YoY2hhcikgfHwg
c2l6ZW9mKGhlYWQtPmZpcnN0KSA9PSBzaXplb2Yoc2hvcnQpIHx8IHNpemVvZihoZWFkLT5m
aXJzdCkgPT0gc2l6ZW9mKGludCkgfHwgc2l6ZW9mKGhlYWQtPmZpcnN0KSA9PSBzaXplb2Yo
bG9uZykpIHx8IHNpemVvZihoZWFkLT5maXJzdCkgPT0gc2l6ZW9mKGxvbmcgbG9uZykpKSBf
X2NvbXBpbGV0aW1lX2Fzc2VydF85OCgpOyB9IHdoaWxlICgwKTsgKHsgdHlwZW9mKCBfR2Vu
ZXJpYygoaGVhZC0+Zmlyc3QpLCBjaGFyOiAoY2hhcikwLCB1bnNpZ25lZCBjaGFyOiAodW5z
aWduZWQgY2hhcikwLCBzaWduZWQgY2hhcjogKHNpZ25lZCBjaGFyKTAsIHVuc2lnbmVkIHNo
b3J0OiAodW5zaWduZWQgc2hvcnQpMCwgc2lnbmVkIHNob3J0OiAoc2lnbmVkIHNob3J0KTAs
IHVuc2lnbmVkIGludDogKHVuc2lnbmVkIGludCkwLCBzaWduZWQgaW50OiAoc2lnbmVkIGlu
dCkwLCB1bnNpZ25lZCBsb25nOiAodW5zaWduZWQgbG9uZykwLCBzaWduZWQgbG9uZzogKHNp
Z25lZCBsb25nKTAsIHVuc2lnbmVkIGxvbmcgbG9uZzogKHVuc2lnbmVkIGxvbmcgbG9uZykw
LCBzaWduZWQgbG9uZyBsb25nOiAoc2lnbmVkIGxvbmcgbG9uZykwLCBkZWZhdWx0OiAoaGVh
ZC0+Zmlyc3QpKSkgX194ID0gKCooY29uc3Qgdm9sYXRpbGUgdHlwZW9mKCBfR2VuZXJpYygo
aGVhZC0+Zmlyc3QpLCBjaGFyOiAoY2hhcikwLCB1bnNpZ25lZCBjaGFyOiAodW5zaWduZWQg
Y2hhcikwLCBzaWduZWQgY2hhcjogKHNpZ25lZCBjaGFyKTAsIHVuc2lnbmVkIHNob3J0OiAo
dW5zaWduZWQgc2hvcnQpMCwgc2lnbmVkIHNob3J0OiAoc2lnbmVkIHNob3J0KTAsIHVuc2ln
bmVkIGludDogKHVuc2lnbmVkIGludCkwLCBzaWduZWQgaW50OiAoc2lnbmVkIGludCkwLCB1
bnNpZ25lZCBsb25nOiAodW5zaWduZWQgbG9uZykwLCBzaWduZWQgbG9uZzogKHNpZ25lZCBs
b25nKTAsIHVuc2lnbmVkIGxvbmcgbG9uZzogKHVuc2lnbmVkIGxvbmcgbG9uZykwLCBzaWdu
ZWQgbG9uZyBsb25nOiAoc2lnbmVkIGxvbmcgbG9uZykwLCBkZWZhdWx0OiAoaGVhZC0+Zmly
c3QpKSkgKikmKGhlYWQtPmZpcnN0KSk7IGRvIHsgfSB3aGlsZSAoMCk7ICh0eXBlb2YoaGVh
ZC0+Zmlyc3QpKV9feDsgfSk7IH0pID09ICgodm9pZCAqKTApOwp9CgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3Ry
dWN0IGxsaXN0X25vZGUgKmxsaXN0X25leHQoc3RydWN0IGxsaXN0X25vZGUgKm5vZGUpCnsK
IHJldHVybiBub2RlLT5uZXh0Owp9CgpleHRlcm4gYm9vbCBsbGlzdF9hZGRfYmF0Y2goc3Ry
dWN0IGxsaXN0X25vZGUgKm5ld19maXJzdCwKICAgICAgIHN0cnVjdCBsbGlzdF9ub2RlICpu
ZXdfbGFzdCwKICAgICAgIHN0cnVjdCBsbGlzdF9oZWFkICpoZWFkKTsKCgoKCgoKCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBib29sIGxsaXN0X2FkZChzdHJ1Y3QgbGxpc3Rfbm9kZSAqbmV3LCBzdHJ1Y3QgbGxp
c3RfaGVhZCAqaGVhZCkKewogcmV0dXJuIGxsaXN0X2FkZF9iYXRjaChuZXcsIG5ldywgaGVh
ZCk7Cn0KIyAyMjAgIi4vaW5jbHVkZS9saW51eC9sbGlzdC5oIgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0
IGxsaXN0X25vZGUgKmxsaXN0X2RlbF9hbGwoc3RydWN0IGxsaXN0X2hlYWQgKmhlYWQpCnsK
IHJldHVybiAoeyB0eXBlb2YoKHsgX190eXBlb2ZfXygqKCZoZWFkLT5maXJzdCkpIF94XyA9
ICgoKHZvaWQgKikwKSk7IChfX3R5cGVvZl9fKCooJmhlYWQtPmZpcnN0KSkpIF9feGNoZ19y
ZWxheGVkKCgmaGVhZC0+Zmlyc3QpLCAodW5zaWduZWQgbG9uZylfeF8sIHNpemVvZigqKCZo
ZWFkLT5maXJzdCkpKTsgfSkpIF9fcmV0OyBfX2FzbV9fIF9fdm9sYXRpbGVfXyAoInN5bmMi
IDogOiA6ICJtZW1vcnkiKTsgX19yZXQgPSAoeyBfX3R5cGVvZl9fKCooJmhlYWQtPmZpcnN0
KSkgX3hfID0gKCgodm9pZCAqKTApKTsgKF9fdHlwZW9mX18oKigmaGVhZC0+Zmlyc3QpKSkg
X194Y2hnX3JlbGF4ZWQoKCZoZWFkLT5maXJzdCksICh1bnNpZ25lZCBsb25nKV94Xywgc2l6
ZW9mKCooJmhlYWQtPmZpcnN0KSkpOyB9KTsgX19hc21fXyBfX3ZvbGF0aWxlX18gKCJzeW5j
IiA6IDogOiAibWVtb3J5Iik7IF9fcmV0OyB9KTsKfQoKZXh0ZXJuIHN0cnVjdCBsbGlzdF9u
b2RlICpsbGlzdF9kZWxfZmlyc3Qoc3RydWN0IGxsaXN0X2hlYWQgKmhlYWQpOwoKc3RydWN0
IGxsaXN0X25vZGUgKmxsaXN0X3JldmVyc2Vfb3JkZXIoc3RydWN0IGxsaXN0X25vZGUgKmhl
YWQpOwojIDYgIi4vaW5jbHVkZS9saW51eC9zbXBfdHlwZXMuaCIgMgoKZW51bSB7CiBDU0Rf
RkxBR19MT0NLID0gMHgwMSwKCiBJUlFfV09SS19QRU5ESU5HID0gMHgwMSwKIElSUV9XT1JL
X0JVU1kgPSAweDAyLAogSVJRX1dPUktfTEFaWSA9IDB4MDQsCiBJUlFfV09SS19IQVJEX0lS
USA9IDB4MDgsCgogSVJRX1dPUktfQ0xBSU1FRCA9IChJUlFfV09SS19QRU5ESU5HIHwgSVJR
X1dPUktfQlVTWSksCgogQ1NEX1RZUEVfQVNZTkMgPSAweDAwLAogQ1NEX1RZUEVfU1lOQyA9
IDB4MTAsCiBDU0RfVFlQRV9JUlFfV09SSyA9IDB4MjAsCiBDU0RfVFlQRV9UVFdVID0gMHgz
MCwKCiBDU0RfRkxBR19UWVBFX01BU0sgPSAweEYwLAp9OwojIDU4ICIuL2luY2x1ZGUvbGlu
dXgvc21wX3R5cGVzLmgiCnN0cnVjdCBfX2NhbGxfc2luZ2xlX25vZGUgewogc3RydWN0IGxs
aXN0X25vZGUgbGxpc3Q7CiB1bmlvbiB7CiAgdW5zaWduZWQgaW50IHVfZmxhZ3M7CiAgYXRv
bWljX3QgYV9mbGFnczsKIH07Cn07CiMgMTYgIi4vaW5jbHVkZS9saW51eC9zbXAuaCIgMgoK
dHlwZWRlZiB2b2lkICgqc21wX2NhbGxfZnVuY190KSh2b2lkICppbmZvKTsKdHlwZWRlZiBi
b29sICgqc21wX2NvbmRfZnVuY190KShpbnQgY3B1LCB2b2lkICppbmZvKTsKCgoKCnN0cnVj
dCBfX2NhbGxfc2luZ2xlX2RhdGEgewogdW5pb24gewogIHN0cnVjdCBfX2NhbGxfc2luZ2xl
X25vZGUgbm9kZTsKICBzdHJ1Y3QgewogICBzdHJ1Y3QgbGxpc3Rfbm9kZSBsbGlzdDsKICAg
dW5zaWduZWQgaW50IGZsYWdzOwogIH07CiB9Owogc21wX2NhbGxfZnVuY190IGZ1bmM7CiB2
b2lkICppbmZvOwp9OwoKCnR5cGVkZWYgc3RydWN0IF9fY2FsbF9zaW5nbGVfZGF0YSBjYWxs
X3NpbmdsZV9kYXRhX3QKIF9fYXR0cmlidXRlX18oKF9fYWxpZ25lZF9fKHNpemVvZihzdHJ1
Y3QgX19jYWxsX3NpbmdsZV9kYXRhKSkpKTsKCgoKCgpleHRlcm4gdm9pZCBfX3NtcF9jYWxs
X3NpbmdsZV9xdWV1ZShpbnQgY3B1LCBzdHJ1Y3QgbGxpc3Rfbm9kZSAqbm9kZSk7CgoKZXh0
ZXJuIHVuc2lnbmVkIGludCB0b3RhbF9jcHVzOwoKaW50IHNtcF9jYWxsX2Z1bmN0aW9uX3Np
bmdsZShpbnQgY3B1aWQsIHNtcF9jYWxsX2Z1bmNfdCBmdW5jLCB2b2lkICppbmZvLAogICAg
ICAgIGludCB3YWl0KTsKCgoKCnZvaWQgb25fZWFjaF9jcHUoc21wX2NhbGxfZnVuY190IGZ1
bmMsIHZvaWQgKmluZm8sIGludCB3YWl0KTsKCgoKCgp2b2lkIG9uX2VhY2hfY3B1X21hc2so
Y29uc3Qgc3RydWN0IGNwdW1hc2sgKm1hc2ssIHNtcF9jYWxsX2Z1bmNfdCBmdW5jLAogIHZv
aWQgKmluZm8sIGJvb2wgd2FpdCk7CgoKCgoKCnZvaWQgb25fZWFjaF9jcHVfY29uZChzbXBf
Y29uZF9mdW5jX3QgY29uZF9mdW5jLCBzbXBfY2FsbF9mdW5jX3QgZnVuYywKICAgICAgICB2
b2lkICppbmZvLCBib29sIHdhaXQpOwoKdm9pZCBvbl9lYWNoX2NwdV9jb25kX21hc2soc21w
X2NvbmRfZnVuY190IGNvbmRfZnVuYywgc21wX2NhbGxfZnVuY190IGZ1bmMsCiAgICAgIHZv
aWQgKmluZm8sIGJvb2wgd2FpdCwgY29uc3Qgc3RydWN0IGNwdW1hc2sgKm1hc2spOwoKaW50
IHNtcF9jYWxsX2Z1bmN0aW9uX3NpbmdsZV9hc3luYyhpbnQgY3B1LCBjYWxsX3NpbmdsZV9k
YXRhX3QgKmNzZCk7CgoKCgoKCgojIDEgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL3Nt
cC5oIiAxCiMgMTkgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL3NtcC5oIgojIDEgIi4v
aW5jbHVkZS9saW51eC9pcnFyZXR1cm4uaCIgMQojIDExICIuL2luY2x1ZGUvbGludXgvaXJx
cmV0dXJuLmgiCmVudW0gaXJxcmV0dXJuIHsKIElSUV9OT05FID0gKDAgPDwgMCksCiBJUlFf
SEFORExFRCA9ICgxIDw8IDApLAogSVJRX1dBS0VfVEhSRUFEID0gKDEgPDwgMSksCn07Cgp0
eXBlZGVmIGVudW0gaXJxcmV0dXJuIGlycXJldHVybl90OwojIDIwICIuL2FyY2gvcG93ZXJw
Yy9pbmNsdWRlL2FzbS9zbXAuaCIgMgojIDI4ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2Fz
bS9zbXAuaCIKZXh0ZXJuIGludCBib290X2NwdWlkOwpleHRlcm4gaW50IHNwaW5uaW5nX3Nl
Y29uZGFyaWVzOwpleHRlcm4gdTMyICpjcHVfdG9fcGh5c19pZDsKCmV4dGVybiB2b2lkIGNw
dV9kaWUodm9pZCk7CmV4dGVybiBpbnQgY3B1X3RvX2NoaXBfaWQoaW50IGNwdSk7CgoKCnN0
cnVjdCBzbXBfb3BzX3Qgewogdm9pZCAoKm1lc3NhZ2VfcGFzcykoaW50IGNwdSwgaW50IG1z
Zyk7Cgogdm9pZCAoKmNhdXNlX2lwaSkoaW50IGNwdSk7CgogaW50ICgqY2F1c2Vfbm1pX2lw
aSkoaW50IGNwdSk7CiB2b2lkICgqcHJvYmUpKHZvaWQpOwogaW50ICgqa2lja19jcHUpKGlu
dCBucik7CiBpbnQgKCpwcmVwYXJlX2NwdSkoaW50IG5yKTsKIHZvaWQgKCpzZXR1cF9jcHUp
KGludCBucik7CiB2b2lkICgqYnJpbmd1cF9kb25lKSh2b2lkKTsKIHZvaWQgKCp0YWtlX3Rp
bWViYXNlKSh2b2lkKTsKIHZvaWQgKCpnaXZlX3RpbWViYXNlKSh2b2lkKTsKIGludCAoKmNw
dV9kaXNhYmxlKSh2b2lkKTsKIHZvaWQgKCpjcHVfZGllKSh1bnNpZ25lZCBpbnQgbnIpOwog
aW50ICgqY3B1X2Jvb3RhYmxlKSh1bnNpZ25lZCBpbnQgbnIpOwp9OwoKZXh0ZXJuIGludCBz
bXBfc2VuZF9ubWlfaXBpKGludCBjcHUsIHZvaWQgKCpmbikoc3RydWN0IHB0X3JlZ3MgKiks
IHU2NCBkZWxheV91cyk7CmV4dGVybiBpbnQgc21wX3NlbmRfc2FmZV9ubWlfaXBpKGludCBj
cHUsIHZvaWQgKCpmbikoc3RydWN0IHB0X3JlZ3MgKiksIHU2NCBkZWxheV91cyk7CmV4dGVy
biB2b2lkIHNtcF9zZW5kX2RlYnVnZ2VyX2JyZWFrKHZvaWQpOwpleHRlcm4gdm9pZCBzdGFy
dF9zZWNvbmRhcnlfcmVzdW1lKHZvaWQpOwpleHRlcm4gdm9pZCBzbXBfZ2VuZXJpY19naXZl
X3RpbWViYXNlKHZvaWQpOwpleHRlcm4gdm9pZCBzbXBfZ2VuZXJpY190YWtlX3RpbWViYXNl
KHZvaWQpOwoKZXh0ZXJuIF9fYXR0cmlidXRlX18oKHNlY3Rpb24oIi5kYXRhLi5wZXJjcHUi
ICIiKSkpIF9fdHlwZW9mX18odW5zaWduZWQgaW50KSBjcHVfcHZyOwojIDExMSAiLi9hcmNo
L3Bvd2VycGMvaW5jbHVkZS9hc20vc21wLmgiCmV4dGVybiBfX2F0dHJpYnV0ZV9fKChzZWN0
aW9uKCIuZGF0YS4ucGVyY3B1IiAiIikpKSBfX3R5cGVvZl9fKGNwdW1hc2tfdmFyX3QpIGNw
dV9zaWJsaW5nX21hcDsKZXh0ZXJuIF9fYXR0cmlidXRlX18oKHNlY3Rpb24oIi5kYXRhLi5w
ZXJjcHUiICIiKSkpIF9fdHlwZW9mX18oY3B1bWFza192YXJfdCkgY3B1X2wyX2NhY2hlX21h
cDsKZXh0ZXJuIF9fYXR0cmlidXRlX18oKHNlY3Rpb24oIi5kYXRhLi5wZXJjcHUiICIiKSkp
IF9fdHlwZW9mX18oY3B1bWFza192YXJfdCkgY3B1X2NvcmVfbWFwOwpleHRlcm4gX19hdHRy
aWJ1dGVfXygoc2VjdGlvbigiLmRhdGEuLnBlcmNwdSIgIiIpKSkgX190eXBlb2ZfXyhjcHVt
YXNrX3Zhcl90KSBjcHVfc21hbGxjb3JlX21hcDsKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3QgY3B1bWFz
ayAqY3B1X3NpYmxpbmdfbWFzayhpbnQgY3B1KQp7CiByZXR1cm4gKCooeyBkbyB7IGNvbnN0
IHZvaWQgKl9fdnBwX3ZlcmlmeSA9ICh0eXBlb2YoKCYoY3B1X3NpYmxpbmdfbWFwKSkgKyAw
KSkoKHZvaWQgKikwKTsgKHZvaWQpX192cHBfdmVyaWZ5OyB9IHdoaWxlICgwKTsgKHsgdW5z
aWduZWQgbG9uZyBfX3B0cjsgX19hc21fXyAoIiIgOiAiPXIiKF9fcHRyKSA6ICIwIigodHlw
ZW9mKCooKCYoY3B1X3NpYmxpbmdfbWFwKSkpKSAqKSgoJihjcHVfc2libGluZ19tYXApKSkp
KTsgKHR5cGVvZigodHlwZW9mKCooKCYoY3B1X3NpYmxpbmdfbWFwKSkpKSAqKSgoJihjcHVf
c2libGluZ19tYXApKSkpKSAoX19wdHIgKyAoKChfX3Blcl9jcHVfb2Zmc2V0WyhjcHUpXSkp
KSk7IH0pOyB9KSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3QgY3B1bWFzayAqY3B1X2NvcmVfbWFz
ayhpbnQgY3B1KQp7CiByZXR1cm4gKCooeyBkbyB7IGNvbnN0IHZvaWQgKl9fdnBwX3Zlcmlm
eSA9ICh0eXBlb2YoKCYoY3B1X2NvcmVfbWFwKSkgKyAwKSkoKHZvaWQgKikwKTsgKHZvaWQp
X192cHBfdmVyaWZ5OyB9IHdoaWxlICgwKTsgKHsgdW5zaWduZWQgbG9uZyBfX3B0cjsgX19h
c21fXyAoIiIgOiAiPXIiKF9fcHRyKSA6ICIwIigodHlwZW9mKCooKCYoY3B1X2NvcmVfbWFw
KSkpKSAqKSgoJihjcHVfY29yZV9tYXApKSkpKTsgKHR5cGVvZigodHlwZW9mKCooKCYoY3B1
X2NvcmVfbWFwKSkpKSAqKSgoJihjcHVfY29yZV9tYXApKSkpKSAoX19wdHIgKyAoKChfX3Bl
cl9jcHVfb2Zmc2V0WyhjcHUpXSkpKSk7IH0pOyB9KSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3Qg
Y3B1bWFzayAqY3B1X2wyX2NhY2hlX21hc2soaW50IGNwdSkKewogcmV0dXJuICgqKHsgZG8g
eyBjb25zdCB2b2lkICpfX3ZwcF92ZXJpZnkgPSAodHlwZW9mKCgmKGNwdV9sMl9jYWNoZV9t
YXApKSArIDApKSgodm9pZCAqKTApOyAodm9pZClfX3ZwcF92ZXJpZnk7IH0gd2hpbGUgKDAp
OyAoeyB1bnNpZ25lZCBsb25nIF9fcHRyOyBfX2FzbV9fICgiIiA6ICI9ciIoX19wdHIpIDog
IjAiKCh0eXBlb2YoKigoJihjcHVfbDJfY2FjaGVfbWFwKSkpKSAqKSgoJihjcHVfbDJfY2Fj
aGVfbWFwKSkpKSk7ICh0eXBlb2YoKHR5cGVvZigqKCgmKGNwdV9sMl9jYWNoZV9tYXApKSkp
ICopKCgmKGNwdV9sMl9jYWNoZV9tYXApKSkpKSAoX19wdHIgKyAoKChfX3Blcl9jcHVfb2Zm
c2V0WyhjcHUpXSkpKSk7IH0pOyB9KSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3QgY3B1bWFzayAq
Y3B1X3NtYWxsY29yZV9tYXNrKGludCBjcHUpCnsKIHJldHVybiAoKih7IGRvIHsgY29uc3Qg
dm9pZCAqX192cHBfdmVyaWZ5ID0gKHR5cGVvZigoJihjcHVfc21hbGxjb3JlX21hcCkpICsg
MCkpKCh2b2lkICopMCk7ICh2b2lkKV9fdnBwX3ZlcmlmeTsgfSB3aGlsZSAoMCk7ICh7IHVu
c2lnbmVkIGxvbmcgX19wdHI7IF9fYXNtX18gKCIiIDogIj1yIihfX3B0cikgOiAiMCIoKHR5
cGVvZigqKCgmKGNwdV9zbWFsbGNvcmVfbWFwKSkpKSAqKSgoJihjcHVfc21hbGxjb3JlX21h
cCkpKSkpOyAodHlwZW9mKCh0eXBlb2YoKigoJihjcHVfc21hbGxjb3JlX21hcCkpKSkgKiko
KCYoY3B1X3NtYWxsY29yZV9tYXApKSkpKSAoX19wdHIgKyAoKChfX3Blcl9jcHVfb2Zmc2V0
WyhjcHUpXSkpKSk7IH0pOyB9KSk7Cn0KCmV4dGVybiBpbnQgY3B1X3RvX2NvcmVfaWQoaW50
IGNwdSk7CiMgMTU1ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9zbXAuaCIKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIGludCBzbXBfaGFuZGxlX25taV9pcGkoc3RydWN0IHB0X3JlZ3MgKnJlZ3MpIHsgcmV0
dXJuIDA7IH0KCgoKZXh0ZXJuIGludCBzbXBfcmVxdWVzdF9tZXNzYWdlX2lwaShpbnQgdmly
cSwgaW50IG1lc3NhZ2UpOwpleHRlcm4gY29uc3QgY2hhciAqc21wX2lwaV9uYW1lW107CgoK
ZXh0ZXJuIHZvaWQgc21wX211eGVkX2lwaV9tZXNzYWdlX3Bhc3MoaW50IGNwdSwgaW50IG1z
Zyk7CmV4dGVybiB2b2lkIHNtcF9tdXhlZF9pcGlfc2V0X21lc3NhZ2UoaW50IGNwdSwgaW50
IG1zZyk7CmV4dGVybiBpcnFyZXR1cm5fdCBzbXBfaXBpX2RlbXV4KHZvaWQpOwpleHRlcm4g
aXJxcmV0dXJuX3Qgc21wX2lwaV9kZW11eF9yZWxheGVkKHZvaWQpOwoKdm9pZCBzbXBfaW5p
dF9wU2VyaWVzKHZvaWQpOwp2b2lkIHNtcF9pbml0X2NlbGwodm9pZCk7CnZvaWQgc21wX3Nl
dHVwX2NwdV9tYXBzKHZvaWQpOwoKZXh0ZXJuIGludCBfX2NwdV9kaXNhYmxlKHZvaWQpOwpl
eHRlcm4gdm9pZCBfX2NwdV9kaWUodW5zaWduZWQgaW50IGNwdSk7CiMgMTk0ICIuL2FyY2gv
cG93ZXJwYy9pbmNsdWRlL2FzbS9zbXAuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBnZXRfaGFyZF9zbXBf
cHJvY2Vzc29yX2lkKGludCBjcHUpCnsKIHJldHVybiBwYWNhX3B0cnNbY3B1XS0+aHdfY3B1
X2lkOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBzZXRfaGFyZF9zbXBfcHJvY2Vzc29yX2lkKGludCBj
cHUsIGludCBwaHlzKQp7CiBwYWNhX3B0cnNbY3B1XS0+aHdfY3B1X2lkID0gcGh5czsKfQoj
IDIyMCAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vc21wLmgiCmV4dGVybiB2b2lkIHNt
cF9yZWxlYXNlX2NwdXModm9pZCk7CgoKCgpleHRlcm4gaW50IHNtdF9lbmFibGVkX2F0X2Jv
b3Q7CgpleHRlcm4gdm9pZCBzbXBfbXBpY19wcm9iZSh2b2lkKTsKZXh0ZXJuIHZvaWQgc21w
X21waWNfc2V0dXBfY3B1KGludCBjcHUpOwpleHRlcm4gaW50IHNtcF9nZW5lcmljX2tpY2tf
Y3B1KGludCBucik7CmV4dGVybiBpbnQgc21wX2dlbmVyaWNfY3B1X2Jvb3RhYmxlKHVuc2ln
bmVkIGludCBucik7CgoKZXh0ZXJuIHZvaWQgc21wX2dlbmVyaWNfZ2l2ZV90aW1lYmFzZSh2
b2lkKTsKZXh0ZXJuIHZvaWQgc21wX2dlbmVyaWNfdGFrZV90aW1lYmFzZSh2b2lkKTsKCmV4
dGVybiBzdHJ1Y3Qgc21wX29wc190ICpzbXBfb3BzOwoKZXh0ZXJuIHZvaWQgYXJjaF9zZW5k
X2NhbGxfZnVuY3Rpb25fc2luZ2xlX2lwaShpbnQgY3B1KTsKZXh0ZXJuIHZvaWQgYXJjaF9z
ZW5kX2NhbGxfZnVuY3Rpb25faXBpX21hc2soY29uc3Qgc3RydWN0IGNwdW1hc2sgKm1hc2sp
OwoKCgoKCmV4dGVybiB2b2lkIGdlbmVyaWNfc2Vjb25kYXJ5X3NtcF9pbml0KHZvaWQpOwpl
eHRlcm4gdm9pZCBnZW5lcmljX3NlY29uZGFyeV90aHJlYWRfaW5pdCh2b2lkKTsKZXh0ZXJu
IHVuc2lnbmVkIGxvbmcgX19zZWNvbmRhcnlfaG9sZF9zcGlubG9vcDsKZXh0ZXJuIHVuc2ln
bmVkIGxvbmcgX19zZWNvbmRhcnlfaG9sZF9hY2tub3dsZWRnZTsKZXh0ZXJuIGNoYXIgX19z
ZWNvbmRhcnlfaG9sZDsKZXh0ZXJuIHVuc2lnbmVkIGludCBib290aW5nX3RocmVhZF9od2lk
OwoKZXh0ZXJuIHZvaWQgX19lYXJseV9zdGFydCh2b2lkKTsKIyA4MyAiLi9pbmNsdWRlL2xp
bnV4L3NtcC5oIiAyCiMgOTIgIi4vaW5jbHVkZS9saW51eC9zbXAuaCIKZXh0ZXJuIHZvaWQg
c21wX3NlbmRfc3RvcCh2b2lkKTsKCgoKCmV4dGVybiB2b2lkIHNtcF9zZW5kX3Jlc2NoZWR1
bGUoaW50IGNwdSk7CgoKCgoKZXh0ZXJuIHZvaWQgc21wX3ByZXBhcmVfY3B1cyh1bnNpZ25l
ZCBpbnQgbWF4X2NwdXMpOwoKCgoKZXh0ZXJuIGludCBfX2NwdV91cCh1bnNpZ25lZCBpbnQg
Y3B1bnVtLCBzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRpZGxlKTsKCgoKCmV4dGVybiB2b2lkIHNt
cF9jcHVzX2RvbmUodW5zaWduZWQgaW50IG1heF9jcHVzKTsKCgoKCnZvaWQgc21wX2NhbGxf
ZnVuY3Rpb24oc21wX2NhbGxfZnVuY190IGZ1bmMsIHZvaWQgKmluZm8sIGludCB3YWl0KTsK
dm9pZCBzbXBfY2FsbF9mdW5jdGlvbl9tYW55KGNvbnN0IHN0cnVjdCBjcHVtYXNrICptYXNr
LAogICAgICAgc21wX2NhbGxfZnVuY190IGZ1bmMsIHZvaWQgKmluZm8sIGJvb2wgd2FpdCk7
CgppbnQgc21wX2NhbGxfZnVuY3Rpb25fYW55KGNvbnN0IHN0cnVjdCBjcHVtYXNrICptYXNr
LAogICAgIHNtcF9jYWxsX2Z1bmNfdCBmdW5jLCB2b2lkICppbmZvLCBpbnQgd2FpdCk7Cgp2
b2lkIGtpY2tfYWxsX2NwdXNfc3luYyh2b2lkKTsKdm9pZCB3YWtlX3VwX2FsbF9pZGxlX2Nw
dXModm9pZCk7CgoKCgp2b2lkIF9fYXR0cmlidXRlX18oKF9fc2VjdGlvbl9fKCIuaW5pdC50
ZXh0IikpKSBfX2F0dHJpYnV0ZV9fKChfX2NvbGRfXykpIGNhbGxfZnVuY3Rpb25faW5pdCh2
b2lkKTsKdm9pZCBnZW5lcmljX3NtcF9jYWxsX2Z1bmN0aW9uX3NpbmdsZV9pbnRlcnJ1cHQo
dm9pZCk7CgoKCgoKCgp2b2lkIHNtcF9wcmVwYXJlX2Jvb3RfY3B1KHZvaWQpOwoKZXh0ZXJu
IHVuc2lnbmVkIGludCBzZXR1cF9tYXhfY3B1czsKZXh0ZXJuIHZvaWQgX19hdHRyaWJ1dGVf
XygoX19zZWN0aW9uX18oIi5pbml0LnRleHQiKSkpIF9fYXR0cmlidXRlX18oKF9fY29sZF9f
KSkgc2V0dXBfbnJfY3B1X2lkcyh2b2lkKTsKZXh0ZXJuIHZvaWQgX19hdHRyaWJ1dGVfXygo
X19zZWN0aW9uX18oIi5pbml0LnRleHQiKSkpIF9fYXR0cmlidXRlX18oKF9fY29sZF9fKSkg
c21wX2luaXQodm9pZCk7CgpleHRlcm4gaW50IF9fYm9vdF9jcHVfaWQ7CgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
aW50IGdldF9ib290X2NwdV9pZCh2b2lkKQp7CiByZXR1cm4gX19ib290X2NwdV9pZDsKfQoj
IDI0MyAiLi9pbmNsdWRlL2xpbnV4L3NtcC5oIgpleHRlcm4gdm9pZCBhcmNoX2Rpc2FibGVf
c21wX3N1cHBvcnQodm9pZCk7CgpleHRlcm4gdm9pZCBhcmNoX3RoYXdfc2Vjb25kYXJ5X2Nw
dXNfYmVnaW4odm9pZCk7CmV4dGVybiB2b2lkIGFyY2hfdGhhd19zZWNvbmRhcnlfY3B1c19l
bmQodm9pZCk7Cgp2b2lkIHNtcF9zZXR1cF9wcm9jZXNzb3JfaWQodm9pZCk7CgppbnQgc21w
X2NhbGxfb25fY3B1KHVuc2lnbmVkIGludCBjcHUsIGludCAoKmZ1bmMpKHZvaWQgKiksIHZv
aWQgKnBhciwKICAgICAgYm9vbCBwaHlzKTsKCgppbnQgc21wY2ZkX3ByZXBhcmVfY3B1KHVu
c2lnbmVkIGludCBjcHUpOwppbnQgc21wY2ZkX2RlYWRfY3B1KHVuc2lnbmVkIGludCBjcHUp
OwppbnQgc21wY2ZkX2R5aW5nX2NwdSh1bnNpZ25lZCBpbnQgY3B1KTsKIyA4ICIuL2luY2x1
ZGUvbGludXgvcGVyY3B1LmgiIDIKIyA2NSAiLi9pbmNsdWRlL2xpbnV4L3BlcmNwdS5oIgpl
eHRlcm4gdm9pZCAqcGNwdV9iYXNlX2FkZHI7CmV4dGVybiBjb25zdCB1bnNpZ25lZCBsb25n
ICpwY3B1X3VuaXRfb2Zmc2V0czsKCnN0cnVjdCBwY3B1X2dyb3VwX2luZm8gewogaW50IG5y
X3VuaXRzOwogdW5zaWduZWQgbG9uZyBiYXNlX29mZnNldDsKIHVuc2lnbmVkIGludCAqY3B1
X21hcDsKCn07CgpzdHJ1Y3QgcGNwdV9hbGxvY19pbmZvIHsKIHNpemVfdCBzdGF0aWNfc2l6
ZTsKIHNpemVfdCByZXNlcnZlZF9zaXplOwogc2l6ZV90IGR5bl9zaXplOwogc2l6ZV90IHVu
aXRfc2l6ZTsKIHNpemVfdCBhdG9tX3NpemU7CiBzaXplX3QgYWxsb2Nfc2l6ZTsKIHNpemVf
dCBfX2FpX3NpemU7CiBpbnQgbnJfZ3JvdXBzOwogc3RydWN0IHBjcHVfZ3JvdXBfaW5mbyBn
cm91cHNbXTsKfTsKCmVudW0gcGNwdV9mYyB7CiBQQ1BVX0ZDX0FVVE8sCiBQQ1BVX0ZDX0VN
QkVELAogUENQVV9GQ19QQUdFLAoKIFBDUFVfRkNfTlIsCn07CmV4dGVybiBjb25zdCBjaGFy
ICogY29uc3QgcGNwdV9mY19uYW1lc1tQQ1BVX0ZDX05SXTsKCmV4dGVybiBlbnVtIHBjcHVf
ZmMgcGNwdV9jaG9zZW5fZmM7Cgp0eXBlZGVmIHZvaWQgKiAoKnBjcHVfZmNfYWxsb2NfZm5f
dCkodW5zaWduZWQgaW50IGNwdSwgc2l6ZV90IHNpemUsCiAgICAgICAgIHNpemVfdCBhbGln
bik7CnR5cGVkZWYgdm9pZCAoKnBjcHVfZmNfZnJlZV9mbl90KSh2b2lkICpwdHIsIHNpemVf
dCBzaXplKTsKdHlwZWRlZiB2b2lkICgqcGNwdV9mY19wb3B1bGF0ZV9wdGVfZm5fdCkodW5z
aWduZWQgbG9uZyBhZGRyKTsKdHlwZWRlZiBpbnQgKHBjcHVfZmNfY3B1X2Rpc3RhbmNlX2Zu
X3QpKHVuc2lnbmVkIGludCBmcm9tLCB1bnNpZ25lZCBpbnQgdG8pOwoKZXh0ZXJuIHN0cnVj
dCBwY3B1X2FsbG9jX2luZm8gKiBfX2F0dHJpYnV0ZV9fKChfX3NlY3Rpb25fXygiLmluaXQu
dGV4dCIpKSkgX19hdHRyaWJ1dGVfXygoX19jb2xkX18pKSBwY3B1X2FsbG9jX2FsbG9jX2lu
Zm8oaW50IG5yX2dyb3VwcywKICAgICAgICAgICAgaW50IG5yX3VuaXRzKTsKZXh0ZXJuIHZv
aWQgX19hdHRyaWJ1dGVfXygoX19zZWN0aW9uX18oIi5pbml0LnRleHQiKSkpIF9fYXR0cmli
dXRlX18oKF9fY29sZF9fKSkgcGNwdV9mcmVlX2FsbG9jX2luZm8oc3RydWN0IHBjcHVfYWxs
b2NfaW5mbyAqYWkpOwoKZXh0ZXJuIHZvaWQgX19hdHRyaWJ1dGVfXygoX19zZWN0aW9uX18o
Ii5pbml0LnRleHQiKSkpIF9fYXR0cmlidXRlX18oKF9fY29sZF9fKSkgcGNwdV9zZXR1cF9m
aXJzdF9jaHVuayhjb25zdCBzdHJ1Y3QgcGNwdV9hbGxvY19pbmZvICphaSwKICAgICAgdm9p
ZCAqYmFzZV9hZGRyKTsKCgpleHRlcm4gaW50IF9fYXR0cmlidXRlX18oKF9fc2VjdGlvbl9f
KCIuaW5pdC50ZXh0IikpKSBfX2F0dHJpYnV0ZV9fKChfX2NvbGRfXykpIHBjcHVfZW1iZWRf
Zmlyc3RfY2h1bmsoc2l6ZV90IHJlc2VydmVkX3NpemUsIHNpemVfdCBkeW5fc2l6ZSwKICAg
IHNpemVfdCBhdG9tX3NpemUsCiAgICBwY3B1X2ZjX2NwdV9kaXN0YW5jZV9mbl90IGNwdV9k
aXN0YW5jZV9mbiwKICAgIHBjcHVfZmNfYWxsb2NfZm5fdCBhbGxvY19mbiwKICAgIHBjcHVf
ZmNfZnJlZV9mbl90IGZyZWVfZm4pOwojIDEyNiAiLi9pbmNsdWRlL2xpbnV4L3BlcmNwdS5o
IgpleHRlcm4gdm9pZCAqX19hbGxvY19yZXNlcnZlZF9wZXJjcHUoc2l6ZV90IHNpemUsIHNp
emVfdCBhbGlnbik7CmV4dGVybiBib29sIF9faXNfa2VybmVsX3BlcmNwdV9hZGRyZXNzKHVu
c2lnbmVkIGxvbmcgYWRkciwgdW5zaWduZWQgbG9uZyAqY2FuX2FkZHIpOwpleHRlcm4gYm9v
bCBpc19rZXJuZWxfcGVyY3B1X2FkZHJlc3ModW5zaWduZWQgbG9uZyBhZGRyKTsKCgoKCgpl
eHRlcm4gdm9pZCAqX19hbGxvY19wZXJjcHVfZ2ZwKHNpemVfdCBzaXplLCBzaXplX3QgYWxp
Z24sIGdmcF90IGdmcCk7CmV4dGVybiB2b2lkICpfX2FsbG9jX3BlcmNwdShzaXplX3Qgc2l6
ZSwgc2l6ZV90IGFsaWduKTsKZXh0ZXJuIHZvaWQgZnJlZV9wZXJjcHUodm9pZCAqX19wZGF0
YSk7CmV4dGVybiBwaHlzX2FkZHJfdCBwZXJfY3B1X3B0cl90b19waHlzKHZvaWQgKmFkZHIp
OwojIDE0NiAiLi9pbmNsdWRlL2xpbnV4L3BlcmNwdS5oIgpleHRlcm4gdW5zaWduZWQgbG9u
ZyBwY3B1X25yX3BhZ2VzKHZvaWQpOwojIDIwICIuL2luY2x1ZGUvbGludXgvaHJ0aW1lci5o
IiAyCgojIDEgIi4vaW5jbHVkZS9saW51eC90aW1lcnF1ZXVlLmgiIDEKIyA5ICIuL2luY2x1
ZGUvbGludXgvdGltZXJxdWV1ZS5oIgpzdHJ1Y3QgdGltZXJxdWV1ZV9ub2RlIHsKIHN0cnVj
dCByYl9ub2RlIG5vZGU7CiBrdGltZV90IGV4cGlyZXM7Cn07CgpzdHJ1Y3QgdGltZXJxdWV1
ZV9oZWFkIHsKIHN0cnVjdCByYl9yb290X2NhY2hlZCByYl9yb290Owp9OwoKCmV4dGVybiBi
b29sIHRpbWVycXVldWVfYWRkKHN0cnVjdCB0aW1lcnF1ZXVlX2hlYWQgKmhlYWQsCiAgICAg
IHN0cnVjdCB0aW1lcnF1ZXVlX25vZGUgKm5vZGUpOwpleHRlcm4gYm9vbCB0aW1lcnF1ZXVl
X2RlbChzdHJ1Y3QgdGltZXJxdWV1ZV9oZWFkICpoZWFkLAogICAgICBzdHJ1Y3QgdGltZXJx
dWV1ZV9ub2RlICpub2RlKTsKZXh0ZXJuIHN0cnVjdCB0aW1lcnF1ZXVlX25vZGUgKnRpbWVy
cXVldWVfaXRlcmF0ZV9uZXh0KAogICAgICBzdHJ1Y3QgdGltZXJxdWV1ZV9ub2RlICpub2Rl
KTsKIyAzMyAiLi9pbmNsdWRlL2xpbnV4L3RpbWVycXVldWUuaCIKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpCnN0cnVj
dCB0aW1lcnF1ZXVlX25vZGUgKnRpbWVycXVldWVfZ2V0bmV4dChzdHJ1Y3QgdGltZXJxdWV1
ZV9oZWFkICpoZWFkKQp7CiBzdHJ1Y3QgcmJfbm9kZSAqbGVmdG1vc3QgPSAoJmhlYWQtPnJi
X3Jvb3QpLT5yYl9sZWZ0bW9zdDsKCiByZXR1cm4gKHsgdm9pZCAqX19tcHRyID0gKHZvaWQg
KikobGVmdG1vc3QpOyBkbyB7IGV4dGVybiB2b2lkIF9fY29tcGlsZXRpbWVfYXNzZXJ0Xzk5
KHZvaWQpIF9fYXR0cmlidXRlX18oKF9fZXJyb3JfXygicG9pbnRlciB0eXBlIG1pc21hdGNo
IGluIGNvbnRhaW5lcl9vZigpIikpKTsgaWYgKCEoISghX19idWlsdGluX3R5cGVzX2NvbXBh
dGlibGVfcCh0eXBlb2YoKihsZWZ0bW9zdCkpLCB0eXBlb2YoKChzdHJ1Y3QgdGltZXJxdWV1
ZV9ub2RlICopMCktPm5vZGUpKSAmJiAhX19idWlsdGluX3R5cGVzX2NvbXBhdGlibGVfcCh0
eXBlb2YoKihsZWZ0bW9zdCkpLCB0eXBlb2Yodm9pZCkpKSkpIF9fY29tcGlsZXRpbWVfYXNz
ZXJ0Xzk5KCk7IH0gd2hpbGUgKDApOyAoKHN0cnVjdCB0aW1lcnF1ZXVlX25vZGUgKikoX19t
cHRyIC0gX19idWlsdGluX29mZnNldG9mKHN0cnVjdCB0aW1lcnF1ZXVlX25vZGUsIG5vZGUp
KSk7IH0pOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCB0aW1lcnF1ZXVlX2luaXQoc3RydWN0IHRpbWVy
cXVldWVfbm9kZSAqbm9kZSkKewogKCgmbm9kZS0+bm9kZSktPl9fcmJfcGFyZW50X2NvbG9y
ID0gKHVuc2lnbmVkIGxvbmcpKCZub2RlLT5ub2RlKSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIHRp
bWVycXVldWVfbm9kZV9xdWV1ZWQoc3RydWN0IHRpbWVycXVldWVfbm9kZSAqbm9kZSkKewog
cmV0dXJuICEoKCZub2RlLT5ub2RlKS0+X19yYl9wYXJlbnRfY29sb3IgPT0gKHVuc2lnbmVk
IGxvbmcpKCZub2RlLT5ub2RlKSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIHRpbWVycXVldWVfbm9k
ZV9leHBpcmVzKHN0cnVjdCB0aW1lcnF1ZXVlX25vZGUgKm5vZGUpCnsKIHJldHVybiBub2Rl
LT5leHBpcmVzOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCB0aW1lcnF1ZXVlX2luaXRfaGVhZChzdHJ1
Y3QgdGltZXJxdWV1ZV9oZWFkICpoZWFkKQp7CiBoZWFkLT5yYl9yb290ID0gKHN0cnVjdCBy
Yl9yb290X2NhY2hlZCkgeyB7KCh2b2lkICopMCksIH0sICgodm9pZCAqKTApIH07Cn0KIyAy
MiAiLi9pbmNsdWRlL2xpbnV4L2hydGltZXIuaCIgMgoKc3RydWN0IGhydGltZXJfY2xvY2tf
YmFzZTsKc3RydWN0IGhydGltZXJfY3B1X2Jhc2U7CiMgMzggIi4vaW5jbHVkZS9saW51eC9o
cnRpbWVyLmgiCmVudW0gaHJ0aW1lcl9tb2RlIHsKIEhSVElNRVJfTU9ERV9BQlMgPSAweDAw
LAogSFJUSU1FUl9NT0RFX1JFTCA9IDB4MDEsCiBIUlRJTUVSX01PREVfUElOTkVEID0gMHgw
MiwKIEhSVElNRVJfTU9ERV9TT0ZUID0gMHgwNCwKIEhSVElNRVJfTU9ERV9IQVJEID0gMHgw
OCwKCiBIUlRJTUVSX01PREVfQUJTX1BJTk5FRCA9IEhSVElNRVJfTU9ERV9BQlMgfCBIUlRJ
TUVSX01PREVfUElOTkVELAogSFJUSU1FUl9NT0RFX1JFTF9QSU5ORUQgPSBIUlRJTUVSX01P
REVfUkVMIHwgSFJUSU1FUl9NT0RFX1BJTk5FRCwKCiBIUlRJTUVSX01PREVfQUJTX1NPRlQg
PSBIUlRJTUVSX01PREVfQUJTIHwgSFJUSU1FUl9NT0RFX1NPRlQsCiBIUlRJTUVSX01PREVf
UkVMX1NPRlQgPSBIUlRJTUVSX01PREVfUkVMIHwgSFJUSU1FUl9NT0RFX1NPRlQsCgogSFJU
SU1FUl9NT0RFX0FCU19QSU5ORURfU09GVCA9IEhSVElNRVJfTU9ERV9BQlNfUElOTkVEIHwg
SFJUSU1FUl9NT0RFX1NPRlQsCiBIUlRJTUVSX01PREVfUkVMX1BJTk5FRF9TT0ZUID0gSFJU
SU1FUl9NT0RFX1JFTF9QSU5ORUQgfCBIUlRJTUVSX01PREVfU09GVCwKCiBIUlRJTUVSX01P
REVfQUJTX0hBUkQgPSBIUlRJTUVSX01PREVfQUJTIHwgSFJUSU1FUl9NT0RFX0hBUkQsCiBI
UlRJTUVSX01PREVfUkVMX0hBUkQgPSBIUlRJTUVSX01PREVfUkVMIHwgSFJUSU1FUl9NT0RF
X0hBUkQsCgogSFJUSU1FUl9NT0RFX0FCU19QSU5ORURfSEFSRCA9IEhSVElNRVJfTU9ERV9B
QlNfUElOTkVEIHwgSFJUSU1FUl9NT0RFX0hBUkQsCiBIUlRJTUVSX01PREVfUkVMX1BJTk5F
RF9IQVJEID0gSFJUSU1FUl9NT0RFX1JFTF9QSU5ORUQgfCBIUlRJTUVSX01PREVfSEFSRCwK
fTsKCgoKCmVudW0gaHJ0aW1lcl9yZXN0YXJ0IHsKIEhSVElNRVJfTk9SRVNUQVJULAogSFJU
SU1FUl9SRVNUQVJULAp9OwojIDExNyAiLi9pbmNsdWRlL2xpbnV4L2hydGltZXIuaCIKc3Ry
dWN0IGhydGltZXIgewogc3RydWN0IHRpbWVycXVldWVfbm9kZSBub2RlOwoga3RpbWVfdCBf
c29mdGV4cGlyZXM7CiBlbnVtIGhydGltZXJfcmVzdGFydCAoKmZ1bmN0aW9uKShzdHJ1Y3Qg
aHJ0aW1lciAqKTsKIHN0cnVjdCBocnRpbWVyX2Nsb2NrX2Jhc2UgKmJhc2U7CiB1OCBzdGF0
ZTsKIHU4IGlzX3JlbDsKIHU4IGlzX3NvZnQ7CiB1OCBpc19oYXJkOwp9OwojIDEzNSAiLi9p
bmNsdWRlL2xpbnV4L2hydGltZXIuaCIKc3RydWN0IGhydGltZXJfc2xlZXBlciB7CiBzdHJ1
Y3QgaHJ0aW1lciB0aW1lcjsKIHN0cnVjdCB0YXNrX3N0cnVjdCAqdGFzazsKfTsKIyAxNTgg
Ii4vaW5jbHVkZS9saW51eC9ocnRpbWVyLmgiCnN0cnVjdCBocnRpbWVyX2Nsb2NrX2Jhc2Ug
ewogc3RydWN0IGhydGltZXJfY3B1X2Jhc2UgKmNwdV9iYXNlOwogdW5zaWduZWQgaW50IGlu
ZGV4OwogY2xvY2tpZF90IGNsb2NraWQ7CiBzZXFjb3VudF90IHNlcTsKIHN0cnVjdCBocnRp
bWVyICpydW5uaW5nOwogc3RydWN0IHRpbWVycXVldWVfaGVhZCBhY3RpdmU7CiBrdGltZV90
ICgqZ2V0X3RpbWUpKHZvaWQpOwoga3RpbWVfdCBvZmZzZXQ7Cn0gX19hdHRyaWJ1dGVfXygo
X19hbGlnbmVkX18oKDEgPDwgNikpKSk7CgplbnVtIGhydGltZXJfYmFzZV90eXBlIHsKIEhS
VElNRVJfQkFTRV9NT05PVE9OSUMsCiBIUlRJTUVSX0JBU0VfUkVBTFRJTUUsCiBIUlRJTUVS
X0JBU0VfQk9PVFRJTUUsCiBIUlRJTUVSX0JBU0VfVEFJLAogSFJUSU1FUl9CQVNFX01PTk9U
T05JQ19TT0ZULAogSFJUSU1FUl9CQVNFX1JFQUxUSU1FX1NPRlQsCiBIUlRJTUVSX0JBU0Vf
Qk9PVFRJTUVfU09GVCwKIEhSVElNRVJfQkFTRV9UQUlfU09GVCwKIEhSVElNRVJfTUFYX0NM
T0NLX0JBU0VTLAp9OwojIDIxMyAiLi9pbmNsdWRlL2xpbnV4L2hydGltZXIuaCIKc3RydWN0
IGhydGltZXJfY3B1X2Jhc2UgewogcmF3X3NwaW5sb2NrX3QgbG9jazsKIHVuc2lnbmVkIGlu
dCBjcHU7CiB1bnNpZ25lZCBpbnQgYWN0aXZlX2Jhc2VzOwogdW5zaWduZWQgaW50IGNsb2Nr
X3dhc19zZXRfc2VxOwogdW5zaWduZWQgaW50IGhyZXNfYWN0aXZlIDogMSwKICAgICBpbl9o
cnRpcnEgOiAxLAogICAgIGhhbmdfZGV0ZWN0ZWQgOiAxLAogICAgIHNvZnRpcnFfYWN0aXZh
dGVkIDogMTsKCiB1bnNpZ25lZCBpbnQgbnJfZXZlbnRzOwogdW5zaWduZWQgc2hvcnQgbnJf
cmV0cmllczsKIHVuc2lnbmVkIHNob3J0IG5yX2hhbmdzOwogdW5zaWduZWQgaW50IG1heF9o
YW5nX3RpbWU7CgoKCgoKIGt0aW1lX3QgZXhwaXJlc19uZXh0Owogc3RydWN0IGhydGltZXIg
Km5leHRfdGltZXI7CiBrdGltZV90IHNvZnRpcnFfZXhwaXJlc19uZXh0Owogc3RydWN0IGhy
dGltZXIgKnNvZnRpcnFfbmV4dF90aW1lcjsKIHN0cnVjdCBocnRpbWVyX2Nsb2NrX2Jhc2Ug
Y2xvY2tfYmFzZVtIUlRJTUVSX01BWF9DTE9DS19CQVNFU107Cn0gX19hdHRyaWJ1dGVfXygo
X19hbGlnbmVkX18oKDEgPDwgNikpKSk7CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBocnRpbWVyX3NldF9l
eHBpcmVzKHN0cnVjdCBocnRpbWVyICp0aW1lciwga3RpbWVfdCB0aW1lKQp7CiB0aW1lci0+
bm9kZS5leHBpcmVzID0gdGltZTsKIHRpbWVyLT5fc29mdGV4cGlyZXMgPSB0aW1lOwp9Cgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgdm9pZCBocnRpbWVyX3NldF9leHBpcmVzX3JhbmdlKHN0cnVjdCBocnRpbWVy
ICp0aW1lciwga3RpbWVfdCB0aW1lLCBrdGltZV90IGRlbHRhKQp7CiB0aW1lci0+X3NvZnRl
eHBpcmVzID0gdGltZTsKIHRpbWVyLT5ub2RlLmV4cGlyZXMgPSBrdGltZV9hZGRfc2FmZSh0
aW1lLCBkZWx0YSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGhydGltZXJfc2V0X2V4cGlyZXNfcmFu
Z2VfbnMoc3RydWN0IGhydGltZXIgKnRpbWVyLCBrdGltZV90IHRpbWUsIHU2NCBkZWx0YSkK
ewogdGltZXItPl9zb2Z0ZXhwaXJlcyA9IHRpbWU7CiB0aW1lci0+bm9kZS5leHBpcmVzID0g
a3RpbWVfYWRkX3NhZmUodGltZSwgbnNfdG9fa3RpbWUoZGVsdGEpKTsKfQoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IHZvaWQgaHJ0aW1lcl9zZXRfZXhwaXJlc190djY0KHN0cnVjdCBocnRpbWVyICp0aW1lciwg
czY0IHR2NjQpCnsKIHRpbWVyLT5ub2RlLmV4cGlyZXMgPSB0djY0OwogdGltZXItPl9zb2Z0
ZXhwaXJlcyA9IHR2NjQ7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGhydGltZXJfYWRkX2V4cGlyZXMo
c3RydWN0IGhydGltZXIgKnRpbWVyLCBrdGltZV90IHRpbWUpCnsKIHRpbWVyLT5ub2RlLmV4
cGlyZXMgPSBrdGltZV9hZGRfc2FmZSh0aW1lci0+bm9kZS5leHBpcmVzLCB0aW1lKTsKIHRp
bWVyLT5fc29mdGV4cGlyZXMgPSBrdGltZV9hZGRfc2FmZSh0aW1lci0+X3NvZnRleHBpcmVz
LCB0aW1lKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgaHJ0aW1lcl9hZGRfZXhwaXJlc19ucyhzdHJ1
Y3QgaHJ0aW1lciAqdGltZXIsIHU2NCBucykKewogdGltZXItPm5vZGUuZXhwaXJlcyA9ICgo
dGltZXItPm5vZGUuZXhwaXJlcykgKyAobnMpKTsKIHRpbWVyLT5fc29mdGV4cGlyZXMgPSAo
KHRpbWVyLT5fc29mdGV4cGlyZXMpICsgKG5zKSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBrdGltZV90IGhy
dGltZXJfZ2V0X2V4cGlyZXMoY29uc3Qgc3RydWN0IGhydGltZXIgKnRpbWVyKQp7CiByZXR1
cm4gdGltZXItPm5vZGUuZXhwaXJlczsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGt0aW1lX3QgaHJ0aW1lcl9n
ZXRfc29mdGV4cGlyZXMoY29uc3Qgc3RydWN0IGhydGltZXIgKnRpbWVyKQp7CiByZXR1cm4g
dGltZXItPl9zb2Z0ZXhwaXJlczsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHM2NCBocnRpbWVyX2dldF9leHBp
cmVzX3R2NjQoY29uc3Qgc3RydWN0IGhydGltZXIgKnRpbWVyKQp7CiByZXR1cm4gdGltZXIt
Pm5vZGUuZXhwaXJlczsKfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgczY0IGhydGltZXJfZ2V0X3NvZnRleHBpcmVz
X3R2NjQoY29uc3Qgc3RydWN0IGhydGltZXIgKnRpbWVyKQp7CiByZXR1cm4gdGltZXItPl9z
b2Z0ZXhwaXJlczsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHM2NCBocnRpbWVyX2dldF9leHBpcmVzX25zKGNv
bnN0IHN0cnVjdCBocnRpbWVyICp0aW1lcikKewogcmV0dXJuIGt0aW1lX3RvX25zKHRpbWVy
LT5ub2RlLmV4cGlyZXMpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkga3RpbWVfdCBocnRpbWVyX2V4cGlyZXNf
cmVtYWluaW5nKGNvbnN0IHN0cnVjdCBocnRpbWVyICp0aW1lcikKewogcmV0dXJuICgodGlt
ZXItPm5vZGUuZXhwaXJlcykgLSAodGltZXItPmJhc2UtPmdldF90aW1lKCkpKTsKfQoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIGt0aW1lX3QgaHJ0aW1lcl9jYl9nZXRfdGltZShzdHJ1Y3QgaHJ0aW1lciAqdGlt
ZXIpCnsKIHJldHVybiB0aW1lci0+YmFzZS0+Z2V0X3RpbWUoKTsKfQoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGlu
dCBocnRpbWVyX2lzX2hyZXNfYWN0aXZlKHN0cnVjdCBocnRpbWVyICp0aW1lcikKewogcmV0
dXJuIDEgPwogIHRpbWVyLT5iYXNlLT5jcHVfYmFzZS0+aHJlc19hY3RpdmUgOiAwOwp9CgoK
c3RydWN0IGNsb2NrX2V2ZW50X2RldmljZTsKCmV4dGVybiB2b2lkIGhydGltZXJfaW50ZXJy
dXB0KHN0cnVjdCBjbG9ja19ldmVudF9kZXZpY2UgKmRldik7CgpleHRlcm4gdm9pZCBjbG9j
a193YXNfc2V0X2RlbGF5ZWQodm9pZCk7CgpleHRlcm4gdW5zaWduZWQgaW50IGhydGltZXJf
cmVzb2x1dGlvbjsKIyAzMzIgIi4vaW5jbHVkZS9saW51eC9ocnRpbWVyLmgiCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBrdGltZV90Cl9faHJ0aW1lcl9leHBpcmVzX3JlbWFpbmluZ19hZGp1c3RlZChjb25zdCBz
dHJ1Y3QgaHJ0aW1lciAqdGltZXIsIGt0aW1lX3Qgbm93KQp7CiBrdGltZV90IHJlbSA9ICgo
dGltZXItPm5vZGUuZXhwaXJlcykgLSAobm93KSk7CgoKCgoKIGlmICgwICYmIHRpbWVyLT5p
c19yZWwpCiAgcmVtIC09IGhydGltZXJfcmVzb2x1dGlvbjsKIHJldHVybiByZW07Cn0KCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSBrdGltZV90CmhydGltZXJfZXhwaXJlc19yZW1haW5pbmdfYWRqdXN0ZWQoY29u
c3Qgc3RydWN0IGhydGltZXIgKnRpbWVyKQp7CiByZXR1cm4gX19ocnRpbWVyX2V4cGlyZXNf
cmVtYWluaW5nX2FkanVzdGVkKHRpbWVyLAogICAgICAgICAgdGltZXItPmJhc2UtPmdldF90
aW1lKCkpOwp9CgpleHRlcm4gdm9pZCBjbG9ja193YXNfc2V0KHZvaWQpOwoKZXh0ZXJuIHZv
aWQgdGltZXJmZF9jbG9ja193YXNfc2V0KHZvaWQpOwoKCgpleHRlcm4gdm9pZCBocnRpbWVy
c19yZXN1bWUodm9pZCk7CgpleHRlcm4gX19hdHRyaWJ1dGVfXygoc2VjdGlvbigiLmRhdGEu
LnBlcmNwdSIgIiIpKSkgX190eXBlb2ZfXyhzdHJ1Y3QgdGlja19kZXZpY2UpIHRpY2tfY3B1
X2RldmljZTsKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGhydGltZXJfY2FuY2VsX3dhaXRfcnVubmlu
ZyhzdHJ1Y3QgaHJ0aW1lciAqdGltZXIpCnsKIGRvIHsgYXNtIHZvbGF0aWxlKCJvciAxLDEs
MQkgICAgICMgbG93IHByaW9yaXR5Iik7IGFzbSB2b2xhdGlsZSgib3IgMiwyLDIJICAgICAj
IG1lZGl1bSBwcmlvcml0eSIpOyBfX2FzbV9fIF9fdm9sYXRpbGVfXygiIjogOiA6Im1lbW9y
eSIpOyB9IHdoaWxlICgwKTsKfQoKCgoKCmV4dGVybiB2b2lkIGhydGltZXJfaW5pdChzdHJ1
Y3QgaHJ0aW1lciAqdGltZXIsIGNsb2NraWRfdCB3aGljaF9jbG9jaywKICAgIGVudW0gaHJ0
aW1lcl9tb2RlIG1vZGUpOwpleHRlcm4gdm9pZCBocnRpbWVyX2luaXRfc2xlZXBlcihzdHJ1
Y3QgaHJ0aW1lcl9zbGVlcGVyICpzbCwgY2xvY2tpZF90IGNsb2NrX2lkLAogICAgIGVudW0g
aHJ0aW1lcl9tb2RlIG1vZGUpOwojIDM4OSAiLi9pbmNsdWRlL2xpbnV4L2hydGltZXIuaCIK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIHZvaWQgaHJ0aW1lcl9pbml0X29uX3N0YWNrKHN0cnVjdCBocnRpbWVyICp0
aW1lciwKICAgICAgY2xvY2tpZF90IHdoaWNoX2Nsb2NrLAogICAgICBlbnVtIGhydGltZXJf
bW9kZSBtb2RlKQp7CiBocnRpbWVyX2luaXQodGltZXIsIHdoaWNoX2Nsb2NrLCBtb2RlKTsK
fQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIHZvaWQgaHJ0aW1lcl9pbml0X3NsZWVwZXJfb25fc3RhY2soc3RydWN0
IGhydGltZXJfc2xlZXBlciAqc2wsCiAgICAgICBjbG9ja2lkX3QgY2xvY2tfaWQsCiAgICAg
ICBlbnVtIGhydGltZXJfbW9kZSBtb2RlKQp7CiBocnRpbWVyX2luaXRfc2xlZXBlcihzbCwg
Y2xvY2tfaWQsIG1vZGUpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBkZXN0cm95X2hydGltZXJfb25f
c3RhY2soc3RydWN0IGhydGltZXIgKnRpbWVyKSB7IH0KCgoKZXh0ZXJuIHZvaWQgaHJ0aW1l
cl9zdGFydF9yYW5nZV9ucyhzdHJ1Y3QgaHJ0aW1lciAqdGltZXIsIGt0aW1lX3QgdGltLAog
ICAgICAgdTY0IHJhbmdlX25zLCBjb25zdCBlbnVtIGhydGltZXJfbW9kZSBtb2RlKTsKIyA0
MTggIi4vaW5jbHVkZS9saW51eC9ocnRpbWVyLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGhydGltZXJf
c3RhcnQoc3RydWN0IGhydGltZXIgKnRpbWVyLCBrdGltZV90IHRpbSwKICAgICBjb25zdCBl
bnVtIGhydGltZXJfbW9kZSBtb2RlKQp7CiBocnRpbWVyX3N0YXJ0X3JhbmdlX25zKHRpbWVy
LCB0aW0sIDAsIG1vZGUpOwp9CgpleHRlcm4gaW50IGhydGltZXJfY2FuY2VsKHN0cnVjdCBo
cnRpbWVyICp0aW1lcik7CmV4dGVybiBpbnQgaHJ0aW1lcl90cnlfdG9fY2FuY2VsKHN0cnVj
dCBocnRpbWVyICp0aW1lcik7CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBocnRpbWVyX3N0YXJ0X2V4cGly
ZXMoc3RydWN0IGhydGltZXIgKnRpbWVyLAogICAgICBlbnVtIGhydGltZXJfbW9kZSBtb2Rl
KQp7CiB1NjQgZGVsdGE7CiBrdGltZV90IHNvZnQsIGhhcmQ7CiBzb2Z0ID0gaHJ0aW1lcl9n
ZXRfc29mdGV4cGlyZXModGltZXIpOwogaGFyZCA9IGhydGltZXJfZ2V0X2V4cGlyZXModGlt
ZXIpOwogZGVsdGEgPSBrdGltZV90b19ucygoKGhhcmQpIC0gKHNvZnQpKSk7CiBocnRpbWVy
X3N0YXJ0X3JhbmdlX25zKHRpbWVyLCBzb2Z0LCBkZWx0YSwgbW9kZSk7Cn0KCnZvaWQgaHJ0
aW1lcl9zbGVlcGVyX3N0YXJ0X2V4cGlyZXMoc3RydWN0IGhydGltZXJfc2xlZXBlciAqc2ws
CiAgICAgICBlbnVtIGhydGltZXJfbW9kZSBtb2RlKTsKCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGhydGlt
ZXJfcmVzdGFydChzdHJ1Y3QgaHJ0aW1lciAqdGltZXIpCnsKIGhydGltZXJfc3RhcnRfZXhw
aXJlcyh0aW1lciwgSFJUSU1FUl9NT0RFX0FCUyk7Cn0KCgpleHRlcm4ga3RpbWVfdCBfX2hy
dGltZXJfZ2V0X3JlbWFpbmluZyhjb25zdCBzdHJ1Y3QgaHJ0aW1lciAqdGltZXIsIGJvb2wg
YWRqdXN0KTsKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBrdGltZV90IGhydGltZXJfZ2V0X3JlbWFpbmluZyhjb25z
dCBzdHJ1Y3QgaHJ0aW1lciAqdGltZXIpCnsKIHJldHVybiBfX2hydGltZXJfZ2V0X3JlbWFp
bmluZyh0aW1lciwgZmFsc2UpOwp9CgpleHRlcm4gdTY0IGhydGltZXJfZ2V0X25leHRfZXZl
bnQodm9pZCk7CmV4dGVybiB1NjQgaHJ0aW1lcl9uZXh0X2V2ZW50X3dpdGhvdXQoY29uc3Qg
c3RydWN0IGhydGltZXIgKmV4Y2x1ZGUpOwoKZXh0ZXJuIGJvb2wgaHJ0aW1lcl9hY3RpdmUo
Y29uc3Qgc3RydWN0IGhydGltZXIgKnRpbWVyKTsKIyA0NjcgIi4vaW5jbHVkZS9saW51eC9o
cnRpbWVyLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIGhydGltZXJfaXNfcXVldWVkKHN0cnVjdCBocnRp
bWVyICp0aW1lcikKewoKIHJldHVybiAhISgoeyBkbyB7IGV4dGVybiB2b2lkIF9fY29tcGls
ZXRpbWVfYXNzZXJ0XzEwMCh2b2lkKSBfX2F0dHJpYnV0ZV9fKChfX2Vycm9yX18oIlVuc3Vw
cG9ydGVkIGFjY2VzcyBzaXplIGZvciB7UkVBRCxXUklURX1fT05DRSgpLiIpKSk7IGlmICgh
KChzaXplb2YodGltZXItPnN0YXRlKSA9PSBzaXplb2YoY2hhcikgfHwgc2l6ZW9mKHRpbWVy
LT5zdGF0ZSkgPT0gc2l6ZW9mKHNob3J0KSB8fCBzaXplb2YodGltZXItPnN0YXRlKSA9PSBz
aXplb2YoaW50KSB8fCBzaXplb2YodGltZXItPnN0YXRlKSA9PSBzaXplb2YobG9uZykpIHx8
IHNpemVvZih0aW1lci0+c3RhdGUpID09IHNpemVvZihsb25nIGxvbmcpKSkgX19jb21waWxl
dGltZV9hc3NlcnRfMTAwKCk7IH0gd2hpbGUgKDApOyAoeyB0eXBlb2YoIF9HZW5lcmljKCh0
aW1lci0+c3RhdGUpLCBjaGFyOiAoY2hhcikwLCB1bnNpZ25lZCBjaGFyOiAodW5zaWduZWQg
Y2hhcikwLCBzaWduZWQgY2hhcjogKHNpZ25lZCBjaGFyKTAsIHVuc2lnbmVkIHNob3J0OiAo
dW5zaWduZWQgc2hvcnQpMCwgc2lnbmVkIHNob3J0OiAoc2lnbmVkIHNob3J0KTAsIHVuc2ln
bmVkIGludDogKHVuc2lnbmVkIGludCkwLCBzaWduZWQgaW50OiAoc2lnbmVkIGludCkwLCB1
bnNpZ25lZCBsb25nOiAodW5zaWduZWQgbG9uZykwLCBzaWduZWQgbG9uZzogKHNpZ25lZCBs
b25nKTAsIHVuc2lnbmVkIGxvbmcgbG9uZzogKHVuc2lnbmVkIGxvbmcgbG9uZykwLCBzaWdu
ZWQgbG9uZyBsb25nOiAoc2lnbmVkIGxvbmcgbG9uZykwLCBkZWZhdWx0OiAodGltZXItPnN0
YXRlKSkpIF9feCA9ICgqKGNvbnN0IHZvbGF0aWxlIHR5cGVvZiggX0dlbmVyaWMoKHRpbWVy
LT5zdGF0ZSksIGNoYXI6IChjaGFyKTAsIHVuc2lnbmVkIGNoYXI6ICh1bnNpZ25lZCBjaGFy
KTAsIHNpZ25lZCBjaGFyOiAoc2lnbmVkIGNoYXIpMCwgdW5zaWduZWQgc2hvcnQ6ICh1bnNp
Z25lZCBzaG9ydCkwLCBzaWduZWQgc2hvcnQ6IChzaWduZWQgc2hvcnQpMCwgdW5zaWduZWQg
aW50OiAodW5zaWduZWQgaW50KTAsIHNpZ25lZCBpbnQ6IChzaWduZWQgaW50KTAsIHVuc2ln
bmVkIGxvbmc6ICh1bnNpZ25lZCBsb25nKTAsIHNpZ25lZCBsb25nOiAoc2lnbmVkIGxvbmcp
MCwgdW5zaWduZWQgbG9uZyBsb25nOiAodW5zaWduZWQgbG9uZyBsb25nKTAsIHNpZ25lZCBs
b25nIGxvbmc6IChzaWduZWQgbG9uZyBsb25nKTAsIGRlZmF1bHQ6ICh0aW1lci0+c3RhdGUp
KSkgKikmKHRpbWVyLT5zdGF0ZSkpOyBkbyB7IH0gd2hpbGUgKDApOyAodHlwZW9mKHRpbWVy
LT5zdGF0ZSkpX194OyB9KTsgfSkgJiAweDAxKTsKfQoKCgoKCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgaHJ0
aW1lcl9jYWxsYmFja19ydW5uaW5nKHN0cnVjdCBocnRpbWVyICp0aW1lcikKewogcmV0dXJu
IHRpbWVyLT5iYXNlLT5ydW5uaW5nID09IHRpbWVyOwp9CgoKZXh0ZXJuIHU2NApocnRpbWVy
X2ZvcndhcmQoc3RydWN0IGhydGltZXIgKnRpbWVyLCBrdGltZV90IG5vdywga3RpbWVfdCBp
bnRlcnZhbCk7CiMgNTAyICIuL2luY2x1ZGUvbGludXgvaHJ0aW1lci5oIgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
dTY0IGhydGltZXJfZm9yd2FyZF9ub3coc3RydWN0IGhydGltZXIgKnRpbWVyLAogICAgICAg
ICAga3RpbWVfdCBpbnRlcnZhbCkKewogcmV0dXJuIGhydGltZXJfZm9yd2FyZCh0aW1lciwg
dGltZXItPmJhc2UtPmdldF90aW1lKCksIGludGVydmFsKTsKfQoKCgpleHRlcm4gaW50IG5h
bm9zbGVlcF9jb3B5b3V0KHN0cnVjdCByZXN0YXJ0X2Jsb2NrICosIHN0cnVjdCB0aW1lc3Bl
YzY0ICopOwpleHRlcm4gbG9uZyBocnRpbWVyX25hbm9zbGVlcChrdGltZV90IHJxdHAsIGNv
bnN0IGVudW0gaHJ0aW1lcl9tb2RlIG1vZGUsCiAgICAgICAgIGNvbnN0IGNsb2NraWRfdCBj
bG9ja2lkKTsKCmV4dGVybiBpbnQgc2NoZWR1bGVfaHJ0aW1lb3V0X3JhbmdlKGt0aW1lX3Qg
KmV4cGlyZXMsIHU2NCBkZWx0YSwKICAgICAgICBjb25zdCBlbnVtIGhydGltZXJfbW9kZSBt
b2RlKTsKZXh0ZXJuIGludCBzY2hlZHVsZV9ocnRpbWVvdXRfcmFuZ2VfY2xvY2soa3RpbWVf
dCAqZXhwaXJlcywKICAgICAgIHU2NCBkZWx0YSwKICAgICAgIGNvbnN0IGVudW0gaHJ0aW1l
cl9tb2RlIG1vZGUsCiAgICAgICBjbG9ja2lkX3QgY2xvY2tfaWQpOwpleHRlcm4gaW50IHNj
aGVkdWxlX2hydGltZW91dChrdGltZV90ICpleHBpcmVzLCBjb25zdCBlbnVtIGhydGltZXJf
bW9kZSBtb2RlKTsKCgpleHRlcm4gdm9pZCBocnRpbWVyX3J1bl9xdWV1ZXModm9pZCk7CgoK
ZXh0ZXJuIHZvaWQgX19hdHRyaWJ1dGVfXygoX19zZWN0aW9uX18oIi5pbml0LnRleHQiKSkp
IF9fYXR0cmlidXRlX18oKF9fY29sZF9fKSkgaHJ0aW1lcnNfaW5pdCh2b2lkKTsKCgpleHRl
cm4gdm9pZCBzeXNycV90aW1lcl9saXN0X3Nob3codm9pZCk7CgppbnQgaHJ0aW1lcnNfcHJl
cGFyZV9jcHUodW5zaWduZWQgaW50IGNwdSk7CiMgMjEgIi4vaW5jbHVkZS9saW51eC9zY2hl
ZC5oIiAyCiMgMSAiLi9pbmNsdWRlL2xpbnV4L3NlY2NvbXAuaCIgMQoKCgoKIyAxICIuL2lu
Y2x1ZGUvdWFwaS9saW51eC9zZWNjb21wLmgiIDEKIyA2MCAiLi9pbmNsdWRlL3VhcGkvbGlu
dXgvc2VjY29tcC5oIgpzdHJ1Y3Qgc2VjY29tcF9kYXRhIHsKIGludCBucjsKIF9fdTMyIGFy
Y2g7CiBfX3U2NCBpbnN0cnVjdGlvbl9wb2ludGVyOwogX191NjQgYXJnc1s2XTsKfTsKCnN0
cnVjdCBzZWNjb21wX25vdGlmX3NpemVzIHsKIF9fdTE2IHNlY2NvbXBfbm90aWY7CiBfX3Ux
NiBzZWNjb21wX25vdGlmX3Jlc3A7CiBfX3UxNiBzZWNjb21wX2RhdGE7Cn07CgpzdHJ1Y3Qg
c2VjY29tcF9ub3RpZiB7CiBfX3U2NCBpZDsKIF9fdTMyIHBpZDsKIF9fdTMyIGZsYWdzOwog
c3RydWN0IHNlY2NvbXBfZGF0YSBkYXRhOwp9OwojIDEwOSAiLi9pbmNsdWRlL3VhcGkvbGlu
dXgvc2VjY29tcC5oIgpzdHJ1Y3Qgc2VjY29tcF9ub3RpZl9yZXNwIHsKIF9fdTY0IGlkOwog
X19zNjQgdmFsOwogX19zMzIgZXJyb3I7CiBfX3UzMiBmbGFnczsKfTsKIyA2ICIuL2luY2x1
ZGUvbGludXgvc2VjY29tcC5oIiAyCiMgMTYgIi4vaW5jbHVkZS9saW51eC9zZWNjb21wLmgi
CiMgMSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vc2VjY29tcC5oIiAxCgoKCgojIDEg
Ii4vaW5jbHVkZS91YXBpL2xpbnV4L3VuaXN0ZC5oIiAxCgoKCgoKCgojIDEgIi4vYXJjaC9w
b3dlcnBjL2luY2x1ZGUvYXNtL3VuaXN0ZC5oIiAxCgoKCgoKCgojIDEgIi4vYXJjaC9wb3dl
cnBjL2luY2x1ZGUvdWFwaS9hc20vdW5pc3RkLmgiIDEKIyAxNiAiLi9hcmNoL3Bvd2VycGMv
aW5jbHVkZS91YXBpL2FzbS91bmlzdGQuaCIKIyAxICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRl
L2dlbmVyYXRlZC91YXBpL2FzbS91bmlzdGRfNjQuaCIgMQojIDE3ICIuL2FyY2gvcG93ZXJw
Yy9pbmNsdWRlL3VhcGkvYXNtL3VuaXN0ZC5oIiAyCiMgOSAiLi9hcmNoL3Bvd2VycGMvaW5j
bHVkZS9hc20vdW5pc3RkLmgiIDIKIyA5ICIuL2luY2x1ZGUvdWFwaS9saW51eC91bmlzdGQu
aCIgMgojIDYgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL3NlY2NvbXAuaCIgMgoKCgoj
IDEgIi4vaW5jbHVkZS9hc20tZ2VuZXJpYy9zZWNjb21wLmgiIDEKIyAzMSAiLi9pbmNsdWRl
L2FzbS1nZW5lcmljL3NlY2NvbXAuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGNvbnN0IGludCAqZ2V0X2NvbXBh
dF9tb2RlMV9zeXNjYWxscyh2b2lkKQp7CiBzdGF0aWMgY29uc3QgaW50IG1vZGUxX3N5c2Nh
bGxzXzMyW10gPSB7CiAgMywgNCwKICAxLCAxMTksCiAgMCwKIH07CiByZXR1cm4gbW9kZTFf
c3lzY2FsbHNfMzI7Cn0KIyAxMCAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vc2VjY29t
cC5oIiAyCiMgMTcgIi4vaW5jbHVkZS9saW51eC9zZWNjb21wLmgiIDIKCnN0cnVjdCBzZWNj
b21wX2ZpbHRlcjsKIyAzMCAiLi9pbmNsdWRlL2xpbnV4L3NlY2NvbXAuaCIKc3RydWN0IHNl
Y2NvbXAgewogaW50IG1vZGU7CiBzdHJ1Y3Qgc2VjY29tcF9maWx0ZXIgKmZpbHRlcjsKfTsK
CgpleHRlcm4gaW50IF9fc2VjdXJlX2NvbXB1dGluZyhjb25zdCBzdHJ1Y3Qgc2VjY29tcF9k
YXRhICpzZCk7CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgc2VjdXJlX2NvbXB1dGluZyh2b2lkKQp7CiBpZiAo
X19idWlsdGluX2V4cGVjdCghISh0ZXN0X3RpX3RocmVhZF9mbGFnKCgoc3RydWN0IHRocmVh
ZF9pbmZvICopZ2V0X2N1cnJlbnQoKSksIDEwKSksIDApKQogIHJldHVybiBfX3NlY3VyZV9j
b21wdXRpbmcoKCh2b2lkICopMCkpOwogcmV0dXJuIDA7Cn0KCgoKCmV4dGVybiBsb25nIHBy
Y3RsX2dldF9zZWNjb21wKHZvaWQpOwpleHRlcm4gbG9uZyBwcmN0bF9zZXRfc2VjY29tcCh1
bnNpZ25lZCBsb25nLCB2b2lkICopOwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBzZWNjb21wX21vZGUoc3Ry
dWN0IHNlY2NvbXAgKnMpCnsKIHJldHVybiBzLT5tb2RlOwp9CiMgODUgIi4vaW5jbHVkZS9s
aW51eC9zZWNjb21wLmgiCmV4dGVybiB2b2lkIHB1dF9zZWNjb21wX2ZpbHRlcihzdHJ1Y3Qg
dGFza19zdHJ1Y3QgKnRzayk7CmV4dGVybiB2b2lkIGdldF9zZWNjb21wX2ZpbHRlcihzdHJ1
Y3QgdGFza19zdHJ1Y3QgKnRzayk7CiMgMTA0ICIuL2luY2x1ZGUvbGludXgvc2VjY29tcC5o
IgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgbG9uZyBzZWNjb21wX2dldF9maWx0ZXIoc3RydWN0IHRhc2tfc3RydWN0
ICp0YXNrLAogICAgICAgICAgdW5zaWduZWQgbG9uZyBuLCB2b2lkICpkYXRhKQp7CiByZXR1
cm4gLTIyOwp9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBsb25nIHNlY2NvbXBfZ2V0X21ldGFkYXRhKHN0cnVjdCB0
YXNrX3N0cnVjdCAqdGFzaywKICAgICB1bnNpZ25lZCBsb25nIGZpbHRlcl9vZmYsCiAgICAg
dm9pZCAqZGF0YSkKewogcmV0dXJuIC0yMjsKfQojIDIyICIuL2luY2x1ZGUvbGludXgvc2No
ZWQuaCIgMgojIDEgIi4vaW5jbHVkZS9saW51eC9ub2RlbWFzay5oIiAxCiMgOTYgIi4vaW5j
bHVkZS9saW51eC9ub2RlbWFzay5oIgojIDEgIi4vaW5jbHVkZS9saW51eC9udW1hLmgiIDEK
IyAzMyAiLi9pbmNsdWRlL2xpbnV4L251bWEuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBudW1hX21hcF90
b19vbmxpbmVfbm9kZShpbnQgbm9kZSkKewogcmV0dXJuICgtMSk7Cn0KCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBp
bnQgcGh5c190b190YXJnZXRfbm9kZShwaHlzX2FkZHJfdCBhZGRyKQp7CiByZXR1cm4gKC0x
KTsKfQojIDk3ICIuL2luY2x1ZGUvbGludXgvbm9kZW1hc2suaCIgMgoKdHlwZWRlZiBzdHJ1
Y3QgeyB1bnNpZ25lZCBsb25nIGJpdHNbKCgoKDEgPDwgMCkpICsgKChzaXplb2YobG9uZykg
KiA4KSkgLSAxKSAvICgoc2l6ZW9mKGxvbmcpICogOCkpKV07IH0gbm9kZW1hc2tfdDsKZXh0
ZXJuIG5vZGVtYXNrX3QgX3VudXNlZF9ub2RlbWFza19hcmdfOwojIDEwOSAiLi9pbmNsdWRl
L2xpbnV4L25vZGVtYXNrLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1bnNpZ25lZCBpbnQgX19ub2RlbWFza19w
cl9udW1ub2Rlcyhjb25zdCBub2RlbWFza190ICptKQp7CiByZXR1cm4gbSA/ICgxIDw8IDAp
IDogMDsKfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgY29uc3QgdW5zaWduZWQgbG9uZyAqX19ub2RlbWFza19wcl9i
aXRzKGNvbnN0IG5vZGVtYXNrX3QgKm0pCnsKIHJldHVybiBtID8gbS0+Yml0cyA6ICgodm9p
ZCAqKTApOwp9CiMgMTI4ICIuL2luY2x1ZGUvbGludXgvbm9kZW1hc2suaCIKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgdm9pZCBfX25vZGVfc2V0KGlu
dCBub2RlLCB2b2xhdGlsZSBub2RlbWFza190ICpkc3RwKQp7CiBzZXRfYml0KG5vZGUsIGRz
dHAtPmJpdHMpOwp9CgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgX19ub2RlX2NsZWFyKGludCBub2RlLCB2
b2xhdGlsZSBub2RlbWFza190ICpkc3RwKQp7CiBjbGVhcl9iaXQobm9kZSwgZHN0cC0+Yml0
cyk7Cn0KCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBfX25vZGVzX3NldGFsbChub2RlbWFza190ICpkc3Rw
LCB1bnNpZ25lZCBpbnQgbmJpdHMpCnsKIGJpdG1hcF9maWxsKGRzdHAtPmJpdHMsIG5iaXRz
KTsKfQoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSB2b2lkIF9fbm9kZXNfY2xlYXIobm9kZW1hc2tfdCAqZHN0cCwg
dW5zaWduZWQgaW50IG5iaXRzKQp7CiBiaXRtYXBfemVybyhkc3RwLT5iaXRzLCBuYml0cyk7
Cn0KCgoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIGludCBfX25vZGVfdGVzdF9hbmRfc2V0KGludCBub2RlLCBu
b2RlbWFza190ICphZGRyKQp7CiByZXR1cm4gdGVzdF9hbmRfc2V0X2JpdChub2RlLCBhZGRy
LT5iaXRzKTsKfQoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBfX25vZGVzX2FuZChub2RlbWFza190ICpk
c3RwLCBjb25zdCBub2RlbWFza190ICpzcmMxcCwKICAgICBjb25zdCBub2RlbWFza190ICpz
cmMycCwgdW5zaWduZWQgaW50IG5iaXRzKQp7CiBiaXRtYXBfYW5kKGRzdHAtPmJpdHMsIHNy
YzFwLT5iaXRzLCBzcmMycC0+Yml0cywgbmJpdHMpOwp9CgoKCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIF9f
bm9kZXNfb3Iobm9kZW1hc2tfdCAqZHN0cCwgY29uc3Qgbm9kZW1hc2tfdCAqc3JjMXAsCiAg
ICAgY29uc3Qgbm9kZW1hc2tfdCAqc3JjMnAsIHVuc2lnbmVkIGludCBuYml0cykKewogYml0
bWFwX29yKGRzdHAtPmJpdHMsIHNyYzFwLT5iaXRzLCBzcmMycC0+Yml0cywgbmJpdHMpOwp9
CgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSB2b2lkIF9fbm9kZXNfeG9yKG5vZGVtYXNrX3QgKmRzdHAsIGNvbnN0
IG5vZGVtYXNrX3QgKnNyYzFwLAogICAgIGNvbnN0IG5vZGVtYXNrX3QgKnNyYzJwLCB1bnNp
Z25lZCBpbnQgbmJpdHMpCnsKIGJpdG1hcF94b3IoZHN0cC0+Yml0cywgc3JjMXAtPmJpdHMs
IHNyYzJwLT5iaXRzLCBuYml0cyk7Cn0KCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgX19ub2Rlc19hbmRu
b3Qobm9kZW1hc2tfdCAqZHN0cCwgY29uc3Qgbm9kZW1hc2tfdCAqc3JjMXAsCiAgICAgY29u
c3Qgbm9kZW1hc2tfdCAqc3JjMnAsIHVuc2lnbmVkIGludCBuYml0cykKewogYml0bWFwX2Fu
ZG5vdChkc3RwLT5iaXRzLCBzcmMxcC0+Yml0cywgc3JjMnAtPmJpdHMsIG5iaXRzKTsKfQoK
CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgdm9pZCBfX25vZGVzX2NvbXBsZW1lbnQobm9kZW1hc2tfdCAqZHN0cCwK
ICAgICBjb25zdCBub2RlbWFza190ICpzcmNwLCB1bnNpZ25lZCBpbnQgbmJpdHMpCnsKIGJp
dG1hcF9jb21wbGVtZW50KGRzdHAtPmJpdHMsIHNyY3AtPmJpdHMsIG5iaXRzKTsKfQoKCgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgaW50IF9fbm9kZXNfZXF1YWwoY29uc3Qgbm9kZW1hc2tfdCAqc3JjMXAsCiAg
ICAgY29uc3Qgbm9kZW1hc2tfdCAqc3JjMnAsIHVuc2lnbmVkIGludCBuYml0cykKewogcmV0
dXJuIGJpdG1hcF9lcXVhbChzcmMxcC0+Yml0cywgc3JjMnAtPmJpdHMsIG5iaXRzKTsKfQoK
CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgaW50IF9fbm9kZXNfaW50ZXJzZWN0cyhjb25zdCBub2RlbWFza190ICpz
cmMxcCwKICAgICBjb25zdCBub2RlbWFza190ICpzcmMycCwgdW5zaWduZWQgaW50IG5iaXRz
KQp7CiByZXR1cm4gYml0bWFwX2ludGVyc2VjdHMoc3JjMXAtPmJpdHMsIHNyYzJwLT5iaXRz
LCBuYml0cyk7Cn0KCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBfX25vZGVzX3N1YnNldChjb25zdCBub2Rl
bWFza190ICpzcmMxcCwKICAgICBjb25zdCBub2RlbWFza190ICpzcmMycCwgdW5zaWduZWQg
aW50IG5iaXRzKQp7CiByZXR1cm4gYml0bWFwX3N1YnNldChzcmMxcC0+Yml0cywgc3JjMnAt
PmJpdHMsIG5iaXRzKTsKfQoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgX19ub2Rlc19lbXB0eShjb25zdCBu
b2RlbWFza190ICpzcmNwLCB1bnNpZ25lZCBpbnQgbmJpdHMpCnsKIHJldHVybiBiaXRtYXBf
ZW1wdHkoc3JjcC0+Yml0cywgbmJpdHMpOwp9CgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBfX25vZGVzX2Z1
bGwoY29uc3Qgbm9kZW1hc2tfdCAqc3JjcCwgdW5zaWduZWQgaW50IG5iaXRzKQp7CiByZXR1
cm4gYml0bWFwX2Z1bGwoc3JjcC0+Yml0cywgbmJpdHMpOwp9CgoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBf
X25vZGVzX3dlaWdodChjb25zdCBub2RlbWFza190ICpzcmNwLCB1bnNpZ25lZCBpbnQgbmJp
dHMpCnsKIHJldHVybiBiaXRtYXBfd2VpZ2h0KHNyY3AtPmJpdHMsIG5iaXRzKTsKfQoKCgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgdm9pZCBfX25vZGVzX3NoaWZ0X3JpZ2h0KG5vZGVtYXNrX3QgKmRzdHAsCiAg
ICAgY29uc3Qgbm9kZW1hc2tfdCAqc3JjcCwgaW50IG4sIGludCBuYml0cykKewogYml0bWFw
X3NoaWZ0X3JpZ2h0KGRzdHAtPmJpdHMsIHNyY3AtPmJpdHMsIG4sIG5iaXRzKTsKfQoKCgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgdm9pZCBfX25vZGVzX3NoaWZ0X2xlZnQobm9kZW1hc2tfdCAqZHN0cCwKICAg
ICBjb25zdCBub2RlbWFza190ICpzcmNwLCBpbnQgbiwgaW50IG5iaXRzKQp7CiBiaXRtYXBf
c2hpZnRfbGVmdChkc3RwLT5iaXRzLCBzcmNwLT5iaXRzLCBuLCBuYml0cyk7Cn0KCgoKCgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgaW50IF9fZmlyc3Rfbm9kZShjb25zdCBub2RlbWFza190ICpzcmNwKQp7CiBy
ZXR1cm4gX19idWlsdGluX2Nob29zZV9leHByKCgoISEoc2l6ZW9mKCh0eXBlb2YoKGludCko
KDEgPDwgMCkpKSAqKTEgPT0gKHR5cGVvZigoaW50KShmaW5kX25leHRfYml0KChzcmNwLT5i
aXRzKSwgKCgxIDw8IDApKSwgMCkpKSAqKTEpKSkgJiYgKChzaXplb2YoaW50KSA9PSBzaXpl
b2YoKig4ID8gKCh2b2lkICopKChsb25nKSgoaW50KSgoMSA8PCAwKSkpICogMGwpKSA6IChp
bnQgKik4KSkpICYmIChzaXplb2YoaW50KSA9PSBzaXplb2YoKig4ID8gKCh2b2lkICopKChs
b25nKSgoaW50KShmaW5kX25leHRfYml0KChzcmNwLT5iaXRzKSwgKCgxIDw8IDApKSwgMCkp
KSAqIDBsKSkgOiAoaW50ICopOCkpKSkpLCAoKChpbnQpKCgxIDw8IDApKSkgPCAoKGludCko
ZmluZF9uZXh0X2JpdCgoc3JjcC0+Yml0cyksICgoMSA8PCAwKSksIDApKSkgPyAoKGludCko
KDEgPDwgMCkpKSA6ICgoaW50KShmaW5kX25leHRfYml0KChzcmNwLT5iaXRzKSwgKCgxIDw8
IDApKSwgMCkpKSksICh7IHR5cGVvZigoaW50KSgoMSA8PCAwKSkpIF9fVU5JUVVFX0lEX19f
eDEwMSA9ICgoaW50KSgoMSA8PCAwKSkpOyB0eXBlb2YoKGludCkoZmluZF9uZXh0X2JpdCgo
c3JjcC0+Yml0cyksICgoMSA8PCAwKSksIDApKSkgX19VTklRVUVfSURfX195MTAyID0gKChp
bnQpKGZpbmRfbmV4dF9iaXQoKHNyY3AtPmJpdHMpLCAoKDEgPDwgMCkpLCAwKSkpOyAoKF9f
VU5JUVVFX0lEX19feDEwMSkgPCAoX19VTklRVUVfSURfX195MTAyKSA/IChfX1VOSVFVRV9J
RF9fX3gxMDEpIDogKF9fVU5JUVVFX0lEX19feTEwMikpOyB9KSk7Cn0KCgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
aW50IF9fbmV4dF9ub2RlKGludCBuLCBjb25zdCBub2RlbWFza190ICpzcmNwKQp7CiByZXR1
cm4gX19idWlsdGluX2Nob29zZV9leHByKCgoISEoc2l6ZW9mKCh0eXBlb2YoKGludCkoKDEg
PDwgMCkpKSAqKTEgPT0gKHR5cGVvZigoaW50KShmaW5kX25leHRfYml0KHNyY3AtPmJpdHMs
ICgxIDw8IDApLCBuKzEpKSkgKikxKSkpICYmICgoc2l6ZW9mKGludCkgPT0gc2l6ZW9mKCoo
OCA/ICgodm9pZCAqKSgobG9uZykoKGludCkoKDEgPDwgMCkpKSAqIDBsKSkgOiAoaW50ICop
OCkpKSAmJiAoc2l6ZW9mKGludCkgPT0gc2l6ZW9mKCooOCA/ICgodm9pZCAqKSgobG9uZyko
KGludCkoZmluZF9uZXh0X2JpdChzcmNwLT5iaXRzLCAoMSA8PCAwKSwgbisxKSkpICogMGwp
KSA6IChpbnQgKik4KSkpKSksICgoKGludCkoKDEgPDwgMCkpKSA8ICgoaW50KShmaW5kX25l
eHRfYml0KHNyY3AtPmJpdHMsICgxIDw8IDApLCBuKzEpKSkgPyAoKGludCkoKDEgPDwgMCkp
KSA6ICgoaW50KShmaW5kX25leHRfYml0KHNyY3AtPmJpdHMsICgxIDw8IDApLCBuKzEpKSkp
LCAoeyB0eXBlb2YoKGludCkoKDEgPDwgMCkpKSBfX1VOSVFVRV9JRF9fX3gxMDMgPSAoKGlu
dCkoKDEgPDwgMCkpKTsgdHlwZW9mKChpbnQpKGZpbmRfbmV4dF9iaXQoc3JjcC0+Yml0cywg
KDEgPDwgMCksIG4rMSkpKSBfX1VOSVFVRV9JRF9fX3kxMDQgPSAoKGludCkoZmluZF9uZXh0
X2JpdChzcmNwLT5iaXRzLCAoMSA8PCAwKSwgbisxKSkpOyAoKF9fVU5JUVVFX0lEX19feDEw
MykgPCAoX19VTklRVUVfSURfX195MTA0KSA/IChfX1VOSVFVRV9JRF9fX3gxMDMpIDogKF9f
VU5JUVVFX0lEX19feTEwNCkpOyB9KSk7Cn0KCgoKCgoKaW50IF9fbmV4dF9ub2RlX2luKGlu
dCBub2RlLCBjb25zdCBub2RlbWFza190ICpzcmNwKTsKCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGluaXRf
bm9kZW1hc2tfb2Zfbm9kZShub2RlbWFza190ICptYXNrLCBpbnQgbm9kZSkKewogX19ub2Rl
c19jbGVhcigmKCptYXNrKSwgKDEgPDwgMCkpOwogX19ub2RlX3NldCgobm9kZSksICYoKm1h
c2spKTsKfQojIDI5OSAiLi9pbmNsdWRlL2xpbnV4L25vZGVtYXNrLmgiCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBp
bnQgX19maXJzdF91bnNldF9ub2RlKGNvbnN0IG5vZGVtYXNrX3QgKm1hc2twKQp7CiByZXR1
cm4gX19idWlsdGluX2Nob29zZV9leHByKCgoISEoc2l6ZW9mKCh0eXBlb2YoKGludCkoKDEg
PDwgMCkpKSAqKTEgPT0gKHR5cGVvZigoaW50KShmaW5kX25leHRfemVyb19iaXQoKG1hc2tw
LT5iaXRzKSwgKCgxIDw8IDApKSwgMCkpKSAqKTEpKSkgJiYgKChzaXplb2YoaW50KSA9PSBz
aXplb2YoKig4ID8gKCh2b2lkICopKChsb25nKSgoaW50KSgoMSA8PCAwKSkpICogMGwpKSA6
IChpbnQgKik4KSkpICYmIChzaXplb2YoaW50KSA9PSBzaXplb2YoKig4ID8gKCh2b2lkICop
KChsb25nKSgoaW50KShmaW5kX25leHRfemVyb19iaXQoKG1hc2twLT5iaXRzKSwgKCgxIDw8
IDApKSwgMCkpKSAqIDBsKSkgOiAoaW50ICopOCkpKSkpLCAoKChpbnQpKCgxIDw8IDApKSkg
PCAoKGludCkoZmluZF9uZXh0X3plcm9fYml0KChtYXNrcC0+Yml0cyksICgoMSA8PCAwKSks
IDApKSkgPyAoKGludCkoKDEgPDwgMCkpKSA6ICgoaW50KShmaW5kX25leHRfemVyb19iaXQo
KG1hc2twLT5iaXRzKSwgKCgxIDw8IDApKSwgMCkpKSksICh7IHR5cGVvZigoaW50KSgoMSA8
PCAwKSkpIF9fVU5JUVVFX0lEX19feDEwNSA9ICgoaW50KSgoMSA8PCAwKSkpOyB0eXBlb2Yo
KGludCkoZmluZF9uZXh0X3plcm9fYml0KChtYXNrcC0+Yml0cyksICgoMSA8PCAwKSksIDAp
KSkgX19VTklRVUVfSURfX195MTA2ID0gKChpbnQpKGZpbmRfbmV4dF96ZXJvX2JpdCgobWFz
a3AtPmJpdHMpLCAoKDEgPDwgMCkpLCAwKSkpOyAoKF9fVU5JUVVFX0lEX19feDEwNSkgPCAo
X19VTklRVUVfSURfX195MTA2KSA/IChfX1VOSVFVRV9JRF9fX3gxMDUpIDogKF9fVU5JUVVF
X0lEX19feTEwNikpOyB9KSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICA7Cn0KIyAzMzMgIi4vaW5jbHVkZS9saW51eC9ub2RlbWFzay5oIgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgaW50IF9fbm9kZW1hc2tfcGFyc2VfdXNlcihjb25zdCBjaGFyICpidWYsIGlu
dCBsZW4sCiAgICAgbm9kZW1hc2tfdCAqZHN0cCwgaW50IG5iaXRzKQp7CiByZXR1cm4gYml0
bWFwX3BhcnNlX3VzZXIoYnVmLCBsZW4sIGRzdHAtPmJpdHMsIG5iaXRzKTsKfQoKCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBpbnQgX19ub2RlbGlzdF9wYXJzZShjb25zdCBjaGFyICpidWYsIG5vZGVtYXNrX3Qg
KmRzdHAsIGludCBuYml0cykKewogcmV0dXJuIGJpdG1hcF9wYXJzZWxpc3QoYnVmLCBkc3Rw
LT5iaXRzLCBuYml0cyk7Cn0KCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBfX25vZGVfcmVtYXAoaW50IG9s
ZGJpdCwKICBjb25zdCBub2RlbWFza190ICpvbGRwLCBjb25zdCBub2RlbWFza190ICpuZXdw
LCBpbnQgbmJpdHMpCnsKIHJldHVybiBiaXRtYXBfYml0cmVtYXAob2xkYml0LCBvbGRwLT5i
aXRzLCBuZXdwLT5iaXRzLCBuYml0cyk7Cn0KCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgX19ub2Rlc19y
ZW1hcChub2RlbWFza190ICpkc3RwLCBjb25zdCBub2RlbWFza190ICpzcmNwLAogIGNvbnN0
IG5vZGVtYXNrX3QgKm9sZHAsIGNvbnN0IG5vZGVtYXNrX3QgKm5ld3AsIGludCBuYml0cykK
ewogYml0bWFwX3JlbWFwKGRzdHAtPmJpdHMsIHNyY3AtPmJpdHMsIG9sZHAtPmJpdHMsIG5l
d3AtPmJpdHMsIG5iaXRzKTsKfQoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBfX25vZGVzX29udG8obm9k
ZW1hc2tfdCAqZHN0cCwgY29uc3Qgbm9kZW1hc2tfdCAqb3JpZ3AsCiAgY29uc3Qgbm9kZW1h
c2tfdCAqcmVsbWFwcCwgaW50IG5iaXRzKQp7CiBiaXRtYXBfb250byhkc3RwLT5iaXRzLCBv
cmlncC0+Yml0cywgcmVsbWFwcC0+Yml0cywgbmJpdHMpOwp9CgoKCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lk
IF9fbm9kZXNfZm9sZChub2RlbWFza190ICpkc3RwLCBjb25zdCBub2RlbWFza190ICpvcmln
cCwKICBpbnQgc3osIGludCBuYml0cykKewogYml0bWFwX2ZvbGQoZHN0cC0+Yml0cywgb3Jp
Z3AtPmJpdHMsIHN6LCBuYml0cyk7Cn0KIyAzOTEgIi4vaW5jbHVkZS9saW51eC9ub2RlbWFz
ay5oIgplbnVtIG5vZGVfc3RhdGVzIHsKIE5fUE9TU0lCTEUsCiBOX09OTElORSwKIE5fTk9S
TUFMX01FTU9SWSwKCgoKIE5fSElHSF9NRU1PUlkgPSBOX05PUk1BTF9NRU1PUlksCgogTl9N
RU1PUlksCiBOX0NQVSwKIE5SX05PREVfU1RBVEVTCn07CgoKCgoKCmV4dGVybiBub2RlbWFz
a190IG5vZGVfc3RhdGVzW05SX05PREVfU1RBVEVTXTsKIyA0NjQgIi4vaW5jbHVkZS9saW51
eC9ub2RlbWFzay5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IG5vZGVfc3RhdGUoaW50IG5vZGUsIGVudW0g
bm9kZV9zdGF0ZXMgc3RhdGUpCnsKIHJldHVybiBub2RlID09IDA7Cn0KCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2
b2lkIG5vZGVfc2V0X3N0YXRlKGludCBub2RlLCBlbnVtIG5vZGVfc3RhdGVzIHN0YXRlKQp7
Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSB2b2lkIG5vZGVfY2xlYXJfc3RhdGUoaW50IG5vZGUsIGVudW0gbm9k
ZV9zdGF0ZXMgc3RhdGUpCnsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBudW1fbm9kZV9zdGF0ZShlbnVt
IG5vZGVfc3RhdGVzIHN0YXRlKQp7CiByZXR1cm4gMTsKfQojIDQ5OSAiLi9pbmNsdWRlL2xp
bnV4L25vZGVtYXNrLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgbm9kZV9yYW5kb20oY29uc3Qgbm9kZW1h
c2tfdCAqbWFzaykKewogcmV0dXJuIDA7Cn0KIyA1MzEgIi4vaW5jbHVkZS9saW51eC9ub2Rl
bWFzay5oIgpzdHJ1Y3Qgbm9kZW1hc2tfc2NyYXRjaCB7CiBub2RlbWFza190IG1hc2sxOwog
bm9kZW1hc2tfdCBtYXNrMjsKfTsKIyAyMyAiLi9pbmNsdWRlL2xpbnV4L3NjaGVkLmgiIDIK
CgojIDEgIi4vaW5jbHVkZS9saW51eC9yZXNvdXJjZS5oIiAxCgoKCgojIDEgIi4vaW5jbHVk
ZS91YXBpL2xpbnV4L3Jlc291cmNlLmgiIDEKIyAyNCAiLi9pbmNsdWRlL3VhcGkvbGludXgv
cmVzb3VyY2UuaCIKc3RydWN0IHJ1c2FnZSB7CiBzdHJ1Y3QgX19rZXJuZWxfb2xkX3RpbWV2
YWwgcnVfdXRpbWU7CiBzdHJ1Y3QgX19rZXJuZWxfb2xkX3RpbWV2YWwgcnVfc3RpbWU7CiBf
X2tlcm5lbF9sb25nX3QgcnVfbWF4cnNzOwogX19rZXJuZWxfbG9uZ190IHJ1X2l4cnNzOwog
X19rZXJuZWxfbG9uZ190IHJ1X2lkcnNzOwogX19rZXJuZWxfbG9uZ190IHJ1X2lzcnNzOwog
X19rZXJuZWxfbG9uZ190IHJ1X21pbmZsdDsKIF9fa2VybmVsX2xvbmdfdCBydV9tYWpmbHQ7
CiBfX2tlcm5lbF9sb25nX3QgcnVfbnN3YXA7CiBfX2tlcm5lbF9sb25nX3QgcnVfaW5ibG9j
azsKIF9fa2VybmVsX2xvbmdfdCBydV9vdWJsb2NrOwogX19rZXJuZWxfbG9uZ190IHJ1X21z
Z3NuZDsKIF9fa2VybmVsX2xvbmdfdCBydV9tc2dyY3Y7CiBfX2tlcm5lbF9sb25nX3QgcnVf
bnNpZ25hbHM7CiBfX2tlcm5lbF9sb25nX3QgcnVfbnZjc3c7CiBfX2tlcm5lbF9sb25nX3Qg
cnVfbml2Y3N3Owp9OwoKc3RydWN0IHJsaW1pdCB7CiBfX2tlcm5lbF91bG9uZ190IHJsaW1f
Y3VyOwogX19rZXJuZWxfdWxvbmdfdCBybGltX21heDsKfTsKCgoKc3RydWN0IHJsaW1pdDY0
IHsKIF9fdTY0IHJsaW1fY3VyOwogX191NjQgcmxpbV9tYXg7Cn07CiMgNzggIi4vaW5jbHVk
ZS91YXBpL2xpbnV4L3Jlc291cmNlLmgiCiMgMSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9n
ZW5lcmF0ZWQvdWFwaS9hc20vcmVzb3VyY2UuaCIgMQojIDEgIi4vaW5jbHVkZS9hc20tZ2Vu
ZXJpYy9yZXNvdXJjZS5oIiAxCgoKCgojIDEgIi4vaW5jbHVkZS91YXBpL2FzbS1nZW5lcmlj
L3Jlc291cmNlLmgiIDEKIyA2ICIuL2luY2x1ZGUvYXNtLWdlbmVyaWMvcmVzb3VyY2UuaCIg
MgojIDEgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvZ2VuZXJhdGVkL3VhcGkvYXNtL3Jlc291
cmNlLmgiIDIKIyA3OSAiLi9pbmNsdWRlL3VhcGkvbGludXgvcmVzb3VyY2UuaCIgMgojIDYg
Ii4vaW5jbHVkZS9saW51eC9yZXNvdXJjZS5oIiAyCgoKc3RydWN0IHRhc2tfc3RydWN0OwoK
dm9pZCBnZXRydXNhZ2Uoc3RydWN0IHRhc2tfc3RydWN0ICpwLCBpbnQgd2hvLCBzdHJ1Y3Qg
cnVzYWdlICpydSk7CmludCBkb19wcmxpbWl0KHN0cnVjdCB0YXNrX3N0cnVjdCAqdHNrLCB1
bnNpZ25lZCBpbnQgcmVzb3VyY2UsCiAgc3RydWN0IHJsaW1pdCAqbmV3X3JsaW0sIHN0cnVj
dCBybGltaXQgKm9sZF9ybGltKTsKIyAyNiAiLi9pbmNsdWRlL2xpbnV4L3NjaGVkLmgiIDIK
IyAxICIuL2luY2x1ZGUvbGludXgvbGF0ZW5jeXRvcC5oIiAxCiMgMTQgIi4vaW5jbHVkZS9s
aW51eC9sYXRlbmN5dG9wLmgiCnN0cnVjdCB0YXNrX3N0cnVjdDsKIyA0NiAiLi9pbmNsdWRl
L2xpbnV4L2xhdGVuY3l0b3AuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQKYWNjb3VudF9zY2hlZHVsZXJf
bGF0ZW5jeShzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRhc2ssIGludCB1c2VjcywgaW50IGludGVy
KQp7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSB2b2lkIGNsZWFyX3Rza19sYXRlbmN5X3RyYWNpbmcoc3RydWN0
IHRhc2tfc3RydWN0ICpwKQp7Cn0KIyAyNyAiLi9pbmNsdWRlL2xpbnV4L3NjaGVkLmgiIDIK
IyAxICIuL2luY2x1ZGUvbGludXgvc2NoZWQvcHJpby5oIiAxCiMgNDggIi4vaW5jbHVkZS9s
aW51eC9zY2hlZC9wcmlvLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBsb25nIG5pY2VfdG9fcmxpbWl0KGxvbmcg
bmljZSkKewogcmV0dXJuICgxOSAtIG5pY2UgKyAxKTsKfQoKCgoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGxvbmcg
cmxpbWl0X3RvX25pY2UobG9uZyBwcmlvKQp7CiByZXR1cm4gKDE5IC0gcHJpbyArIDEpOwp9
CiMgMjggIi4vaW5jbHVkZS9saW51eC9zY2hlZC5oIiAyCiMgMSAiLi9pbmNsdWRlL2xpbnV4
L3NjaGVkL3R5cGVzLmgiIDEKIyAxNyAiLi9pbmNsdWRlL2xpbnV4L3NjaGVkL3R5cGVzLmgi
CnN0cnVjdCB0YXNrX2NwdXRpbWUgewogdTY0IHN0aW1lOwogdTY0IHV0aW1lOwogdW5zaWdu
ZWQgbG9uZyBsb25nIHN1bV9leGVjX3J1bnRpbWU7Cn07CiMgMjkgIi4vaW5jbHVkZS9saW51
eC9zY2hlZC5oIiAyCiMgMSAiLi9pbmNsdWRlL2xpbnV4L3NpZ25hbF90eXBlcy5oIiAxCiMg
MTAgIi4vaW5jbHVkZS9saW51eC9zaWduYWxfdHlwZXMuaCIKIyAxICIuL2luY2x1ZGUvdWFw
aS9saW51eC9zaWduYWwuaCIgMQoKCgoKIyAxICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2Fz
bS9zaWduYWwuaCIgMQoKCgoKCiMgMSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS91YXBpL2Fz
bS9zaWduYWwuaCIgMQojIDE1ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL3VhcGkvYXNtL3Np
Z25hbC5oIgp0eXBlZGVmIHVuc2lnbmVkIGxvbmcgb2xkX3NpZ3NldF90OwoKdHlwZWRlZiBz
dHJ1Y3QgewogdW5zaWduZWQgbG9uZyBzaWdbKDY0IC8gNjQpXTsKfSBzaWdzZXRfdDsKIyA5
MiAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS91YXBpL2FzbS9zaWduYWwuaCIKIyAxICIuL2lu
Y2x1ZGUvdWFwaS9hc20tZ2VuZXJpYy9zaWduYWwtZGVmcy5oIiAxCiMgMTggIi4vaW5jbHVk
ZS91YXBpL2FzbS1nZW5lcmljL3NpZ25hbC1kZWZzLmgiCnR5cGVkZWYgdm9pZCBfX3NpZ25h
bGZuX3QoaW50KTsKdHlwZWRlZiBfX3NpZ25hbGZuX3QgKl9fc2lnaGFuZGxlcl90OwoKdHlw
ZWRlZiB2b2lkIF9fcmVzdG9yZWZuX3Qodm9pZCk7CnR5cGVkZWYgX19yZXN0b3JlZm5fdCAq
X19zaWdyZXN0b3JlX3Q7CiMgOTMgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvdWFwaS9hc20v
c2lnbmFsLmgiIDIKIyAxMTAgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvdWFwaS9hc20vc2ln
bmFsLmgiCnR5cGVkZWYgc3RydWN0IHNpZ2FsdHN0YWNrIHsKIHZvaWQgKnNzX3NwOwogaW50
IHNzX2ZsYWdzOwogc2l6ZV90IHNzX3NpemU7Cn0gc3RhY2tfdDsKIyA3ICIuL2FyY2gvcG93
ZXJwYy9pbmNsdWRlL2FzbS9zaWduYWwuaCIgMgoKCnN0cnVjdCBwdF9yZWdzOwp2b2lkIGRv
X25vdGlmeV9yZXN1bWUoc3RydWN0IHB0X3JlZ3MgKnJlZ3MsIHVuc2lnbmVkIGxvbmcgdGhy
ZWFkX2luZm9fZmxhZ3MpOwojIDYgIi4vaW5jbHVkZS91YXBpL2xpbnV4L3NpZ25hbC5oIiAy
CiMgMSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9nZW5lcmF0ZWQvdWFwaS9hc20vc2lnaW5m
by5oIiAxCiMgMSAiLi9pbmNsdWRlL3VhcGkvYXNtLWdlbmVyaWMvc2lnaW5mby5oIiAxCgoK
CgoKCgp0eXBlZGVmIHVuaW9uIHNpZ3ZhbCB7CiBpbnQgc2l2YWxfaW50Owogdm9pZCAqc2l2
YWxfcHRyOwp9IHNpZ3ZhbF90OwojIDMyICIuL2luY2x1ZGUvdWFwaS9hc20tZ2VuZXJpYy9z
aWdpbmZvLmgiCnVuaW9uIF9fc2lmaWVsZHMgewoKIHN0cnVjdCB7CiAgX19rZXJuZWxfcGlk
X3QgX3BpZDsKICBfX2tlcm5lbF91aWQzMl90IF91aWQ7CiB9IF9raWxsOwoKCiBzdHJ1Y3Qg
ewogIF9fa2VybmVsX3RpbWVyX3QgX3RpZDsKICBpbnQgX292ZXJydW47CiAgc2lndmFsX3Qg
X3NpZ3ZhbDsKICBpbnQgX3N5c19wcml2YXRlOwogfSBfdGltZXI7CgoKIHN0cnVjdCB7CiAg
X19rZXJuZWxfcGlkX3QgX3BpZDsKICBfX2tlcm5lbF91aWQzMl90IF91aWQ7CiAgc2lndmFs
X3QgX3NpZ3ZhbDsKIH0gX3J0OwoKCiBzdHJ1Y3QgewogIF9fa2VybmVsX3BpZF90IF9waWQ7
CiAgX19rZXJuZWxfdWlkMzJfdCBfdWlkOwogIGludCBfc3RhdHVzOwogIF9fa2VybmVsX2Ns
b2NrX3QgX3V0aW1lOwogIF9fa2VybmVsX2Nsb2NrX3QgX3N0aW1lOwogfSBfc2lnY2hsZDsK
Cgogc3RydWN0IHsKICB2b2lkICpfYWRkcjsKIyA3NyAiLi9pbmNsdWRlL3VhcGkvYXNtLWdl
bmVyaWMvc2lnaW5mby5oIgogIHVuaW9uIHsKCgoKCiAgIHNob3J0IF9hZGRyX2xzYjsKCiAg
IHN0cnVjdCB7CiAgICBjaGFyIF9kdW1teV9ibmRbKF9fYWxpZ25vZl9fKHZvaWQgKikgPCBz
aXplb2Yoc2hvcnQpID8gc2l6ZW9mKHNob3J0KSA6IF9fYWxpZ25vZl9fKHZvaWQgKikpXTsK
ICAgIHZvaWQgKl9sb3dlcjsKICAgIHZvaWQgKl91cHBlcjsKICAgfSBfYWRkcl9ibmQ7Cgog
ICBzdHJ1Y3QgewogICAgY2hhciBfZHVtbXlfcGtleVsoX19hbGlnbm9mX18odm9pZCAqKSA8
IHNpemVvZihzaG9ydCkgPyBzaXplb2Yoc2hvcnQpIDogX19hbGlnbm9mX18odm9pZCAqKSld
OwogICAgX191MzIgX3BrZXk7CiAgIH0gX2FkZHJfcGtleTsKICB9OwogfSBfc2lnZmF1bHQ7
CgoKIHN0cnVjdCB7CiAgbG9uZyBfYmFuZDsKICBpbnQgX2ZkOwogfSBfc2lncG9sbDsKCgog
c3RydWN0IHsKICB2b2lkICpfY2FsbF9hZGRyOwogIGludCBfc3lzY2FsbDsKICB1bnNpZ25l
ZCBpbnQgX2FyY2g7CiB9IF9zaWdzeXM7Cn07CiMgMTI5ICIuL2luY2x1ZGUvdWFwaS9hc20t
Z2VuZXJpYy9zaWdpbmZvLmgiCnR5cGVkZWYgc3RydWN0IHNpZ2luZm8gewogdW5pb24gewog
IHN0cnVjdCB7IGludCBzaV9zaWdubzsgaW50IHNpX2Vycm5vOyBpbnQgc2lfY29kZTsgdW5p
b24gX19zaWZpZWxkcyBfc2lmaWVsZHM7IH07CiAgaW50IF9zaV9wYWRbMTI4L3NpemVvZihp
bnQpXTsKIH07Cn0gc2lnaW5mb190OwojIDMyMCAiLi9pbmNsdWRlL3VhcGkvYXNtLWdlbmVy
aWMvc2lnaW5mby5oIgp0eXBlZGVmIHN0cnVjdCBzaWdldmVudCB7CiBzaWd2YWxfdCBzaWdl
dl92YWx1ZTsKIGludCBzaWdldl9zaWdubzsKIGludCBzaWdldl9ub3RpZnk7CiB1bmlvbiB7
CiAgaW50IF9wYWRbKCg2NCAtIChzaXplb2YoaW50KSAqIDIgKyBzaXplb2Yoc2lndmFsX3Qp
KSkgLyBzaXplb2YoaW50KSldOwogICBpbnQgX3RpZDsKCiAgc3RydWN0IHsKICAgdm9pZCAo
Kl9mdW5jdGlvbikoc2lndmFsX3QpOwogICB2b2lkICpfYXR0cmlidXRlOwogIH0gX3NpZ2V2
X3RocmVhZDsKIH0gX3NpZ2V2X3VuOwp9IHNpZ2V2ZW50X3Q7CiMgMSAiLi9hcmNoL3Bvd2Vy
cGMvaW5jbHVkZS9nZW5lcmF0ZWQvdWFwaS9hc20vc2lnaW5mby5oIiAyCiMgNyAiLi9pbmNs
dWRlL3VhcGkvbGludXgvc2lnbmFsLmgiIDIKIyAxMSAiLi9pbmNsdWRlL2xpbnV4L3NpZ25h
bF90eXBlcy5oIiAyCgp0eXBlZGVmIHN0cnVjdCBrZXJuZWxfc2lnaW5mbyB7CiBzdHJ1Y3Qg
eyBpbnQgc2lfc2lnbm87IGludCBzaV9lcnJubzsgaW50IHNpX2NvZGU7IHVuaW9uIF9fc2lm
aWVsZHMgX3NpZmllbGRzOyB9Owp9IGtlcm5lbF9zaWdpbmZvX3Q7CgoKCgoKc3RydWN0IHNp
Z3F1ZXVlIHsKIHN0cnVjdCBsaXN0X2hlYWQgbGlzdDsKIGludCBmbGFnczsKIGtlcm5lbF9z
aWdpbmZvX3QgaW5mbzsKIHN0cnVjdCB1c2VyX3N0cnVjdCAqdXNlcjsKfTsKCgoKCnN0cnVj
dCBzaWdwZW5kaW5nIHsKIHN0cnVjdCBsaXN0X2hlYWQgbGlzdDsKIHNpZ3NldF90IHNpZ25h
bDsKfTsKCnN0cnVjdCBzaWdhY3Rpb24gewoKIF9fc2lnaGFuZGxlcl90IHNhX2hhbmRsZXI7
CiB1bnNpZ25lZCBsb25nIHNhX2ZsYWdzOwoKCgoKCiBfX3NpZ3Jlc3RvcmVfdCBzYV9yZXN0
b3JlcjsKCiBzaWdzZXRfdCBzYV9tYXNrOwp9OwoKc3RydWN0IGtfc2lnYWN0aW9uIHsKIHN0
cnVjdCBzaWdhY3Rpb24gc2E7CgoKCn07CiMgNjUgIi4vaW5jbHVkZS9saW51eC9zaWduYWxf
dHlwZXMuaCIKc3RydWN0IGtzaWduYWwgewogc3RydWN0IGtfc2lnYWN0aW9uIGthOwoga2Vy
bmVsX3NpZ2luZm9fdCBpbmZvOwogaW50IHNpZzsKfTsKIyAzMCAiLi9pbmNsdWRlL2xpbnV4
L3NjaGVkLmgiIDIKIyAxICIuL2luY2x1ZGUvbGludXgvbW1fdHlwZXNfdGFzay5oIiAxCiMg
MzQgIi4vaW5jbHVkZS9saW51eC9tbV90eXBlc190YXNrLmgiCnN0cnVjdCB2bWFjYWNoZSB7
CiB1NjQgc2VxbnVtOwogc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWFzWygxVSA8PCAyKV07
Cn07CgoKCgoKZW51bSB7CiBNTV9GSUxFUEFHRVMsCiBNTV9BTk9OUEFHRVMsCiBNTV9TV0FQ
RU5UUywKIE1NX1NITUVNUEFHRVMsCiBOUl9NTV9DT1VOVEVSUwp9OwoKCgoKc3RydWN0IHRh
c2tfcnNzX3N0YXQgewogaW50IGV2ZW50czsKIGludCBjb3VudFtOUl9NTV9DT1VOVEVSU107
Cn07CgoKc3RydWN0IG1tX3Jzc19zdGF0IHsKIGF0b21pY19sb25nX3QgY291bnRbTlJfTU1f
Q09VTlRFUlNdOwp9OwoKc3RydWN0IHBhZ2VfZnJhZyB7CiBzdHJ1Y3QgcGFnZSAqcGFnZTsK
CiBfX3UzMiBvZmZzZXQ7CiBfX3UzMiBzaXplOwoKCgoKfTsKCgpzdHJ1Y3QgdGxiZmx1c2hf
dW5tYXBfYmF0Y2ggewojIDk3ICIuL2luY2x1ZGUvbGludXgvbW1fdHlwZXNfdGFzay5oIgp9
OwojIDMxICIuL2luY2x1ZGUvbGludXgvc2NoZWQuaCIgMgojIDEgIi4vaW5jbHVkZS9saW51
eC90YXNrX2lvX2FjY291bnRpbmcuaCIgMQojIDEyICIuL2luY2x1ZGUvbGludXgvdGFza19p
b19hY2NvdW50aW5nLmgiCnN0cnVjdCB0YXNrX2lvX2FjY291bnRpbmcgewojIDQ2ICIuL2lu
Y2x1ZGUvbGludXgvdGFza19pb19hY2NvdW50aW5nLmgiCn07CiMgMzIgIi4vaW5jbHVkZS9s
aW51eC9zY2hlZC5oIiAyCiMgMSAiLi9pbmNsdWRlL2xpbnV4L3Bvc2l4LXRpbWVycy5oIiAx
CgoKCgoKCiMgMSAiLi9pbmNsdWRlL2xpbnV4L2FsYXJtdGltZXIuaCIgMQojIDkgIi4vaW5j
bHVkZS9saW51eC9hbGFybXRpbWVyLmgiCnN0cnVjdCBydGNfZGV2aWNlOwoKZW51bSBhbGFy
bXRpbWVyX3R5cGUgewogQUxBUk1fUkVBTFRJTUUsCiBBTEFSTV9CT09UVElNRSwKCgogQUxB
Uk1fTlVNVFlQRSwKCgogQUxBUk1fUkVBTFRJTUVfRlJFRVpFUiwKIEFMQVJNX0JPT1RUSU1F
X0ZSRUVaRVIsCn07CgplbnVtIGFsYXJtdGltZXJfcmVzdGFydCB7CiBBTEFSTVRJTUVSX05P
UkVTVEFSVCwKIEFMQVJNVElNRVJfUkVTVEFSVCwKfTsKIyA0MiAiLi9pbmNsdWRlL2xpbnV4
L2FsYXJtdGltZXIuaCIKc3RydWN0IGFsYXJtIHsKIHN0cnVjdCB0aW1lcnF1ZXVlX25vZGUg
bm9kZTsKIHN0cnVjdCBocnRpbWVyIHRpbWVyOwogZW51bSBhbGFybXRpbWVyX3Jlc3RhcnQg
KCpmdW5jdGlvbikoc3RydWN0IGFsYXJtICosIGt0aW1lX3Qgbm93KTsKIGVudW0gYWxhcm10
aW1lcl90eXBlIHR5cGU7CiBpbnQgc3RhdGU7CiB2b2lkICpkYXRhOwp9OwoKdm9pZCBhbGFy
bV9pbml0KHN0cnVjdCBhbGFybSAqYWxhcm0sIGVudW0gYWxhcm10aW1lcl90eXBlIHR5cGUs
CiAgZW51bSBhbGFybXRpbWVyX3Jlc3RhcnQgKCpmdW5jdGlvbikoc3RydWN0IGFsYXJtICos
IGt0aW1lX3QpKTsKdm9pZCBhbGFybV9zdGFydChzdHJ1Y3QgYWxhcm0gKmFsYXJtLCBrdGlt
ZV90IHN0YXJ0KTsKdm9pZCBhbGFybV9zdGFydF9yZWxhdGl2ZShzdHJ1Y3QgYWxhcm0gKmFs
YXJtLCBrdGltZV90IHN0YXJ0KTsKdm9pZCBhbGFybV9yZXN0YXJ0KHN0cnVjdCBhbGFybSAq
YWxhcm0pOwppbnQgYWxhcm1fdHJ5X3RvX2NhbmNlbChzdHJ1Y3QgYWxhcm0gKmFsYXJtKTsK
aW50IGFsYXJtX2NhbmNlbChzdHJ1Y3QgYWxhcm0gKmFsYXJtKTsKCnU2NCBhbGFybV9mb3J3
YXJkKHN0cnVjdCBhbGFybSAqYWxhcm0sIGt0aW1lX3Qgbm93LCBrdGltZV90IGludGVydmFs
KTsKdTY0IGFsYXJtX2ZvcndhcmRfbm93KHN0cnVjdCBhbGFybSAqYWxhcm0sIGt0aW1lX3Qg
aW50ZXJ2YWwpOwprdGltZV90IGFsYXJtX2V4cGlyZXNfcmVtYWluaW5nKGNvbnN0IHN0cnVj
dCBhbGFybSAqYWxhcm0pOwoKCgpzdHJ1Y3QgcnRjX2RldmljZSAqYWxhcm10aW1lcl9nZXRf
cnRjZGV2KHZvaWQpOwojIDggIi4vaW5jbHVkZS9saW51eC9wb3NpeC10aW1lcnMuaCIgMgoK
CnN0cnVjdCBrZXJuZWxfc2lnaW5mbzsKc3RydWN0IHRhc2tfc3RydWN0OwojIDM4ICIuL2lu
Y2x1ZGUvbGludXgvcG9zaXgtdGltZXJzLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBjbG9ja2lkX3QgbWFrZV9w
cm9jZXNzX2NwdWNsb2NrKGNvbnN0IHVuc2lnbmVkIGludCBwaWQsCiAgY29uc3QgY2xvY2tp
ZF90IGNsb2NrKQp7CiByZXR1cm4gKCh+cGlkKSA8PCAzKSB8IGNsb2NrOwp9CnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBjbG9ja2lkX3QgbWFrZV90aHJlYWRfY3B1Y2xvY2soY29uc3QgdW5zaWduZWQgaW50IHRp
ZCwKICBjb25zdCBjbG9ja2lkX3QgY2xvY2spCnsKIHJldHVybiBtYWtlX3Byb2Nlc3NfY3B1
Y2xvY2sodGlkLCBjbG9jayB8IDQpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgY2xvY2tpZF90IGZkX3RvX2Ns
b2NraWQoY29uc3QgaW50IGZkKQp7CiByZXR1cm4gbWFrZV9wcm9jZXNzX2NwdWNsb2NrKCh1
bnNpZ25lZCBpbnQpIGZkLCAzKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBjbG9ja2lkX3RvX2ZkKGNv
bnN0IGNsb2NraWRfdCBjbGspCnsKIHJldHVybiB+KGNsayA+PiAzKTsKfQojIDY5ICIuL2lu
Y2x1ZGUvbGludXgvcG9zaXgtdGltZXJzLmgiCnN0cnVjdCBjcHVfdGltZXIgewogc3RydWN0
IHRpbWVycXVldWVfbm9kZSBub2RlOwogc3RydWN0IHRpbWVycXVldWVfaGVhZCAqaGVhZDsK
IHN0cnVjdCBwaWQgKnBpZDsKIHN0cnVjdCBsaXN0X2hlYWQgZWxpc3Q7CiBpbnQgZmlyaW5n
Owp9OwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIGJvb2wgY3B1X3RpbWVyX2VucXVldWUoc3RydWN0IHRpbWVycXVl
dWVfaGVhZCAqaGVhZCwKICAgICAgICAgc3RydWN0IGNwdV90aW1lciAqY3RtcikKewogY3Rt
ci0+aGVhZCA9IGhlYWQ7CiByZXR1cm4gdGltZXJxdWV1ZV9hZGQoaGVhZCwgJmN0bXItPm5v
ZGUpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBjcHVfdGltZXJfZGVxdWV1ZShzdHJ1Y3QgY3B1X3Rp
bWVyICpjdG1yKQp7CiBpZiAoY3Rtci0+aGVhZCkgewogIHRpbWVycXVldWVfZGVsKGN0bXIt
PmhlYWQsICZjdG1yLT5ub2RlKTsKICBjdG1yLT5oZWFkID0gKCh2b2lkICopMCk7CiB9Cn0K
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSB1NjQgY3B1X3RpbWVyX2dldGV4cGlyZXMoc3RydWN0IGNwdV90aW1lciAq
Y3RtcikKewogcmV0dXJuIGN0bXItPm5vZGUuZXhwaXJlczsKfQoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQg
Y3B1X3RpbWVyX3NldGV4cGlyZXMoc3RydWN0IGNwdV90aW1lciAqY3RtciwgdTY0IGV4cCkK
ewogY3Rtci0+bm9kZS5leHBpcmVzID0gZXhwOwp9CgoKCgoKCnN0cnVjdCBwb3NpeF9jcHV0
aW1lcl9iYXNlIHsKIHU2NCBuZXh0ZXZ0Owogc3RydWN0IHRpbWVycXVldWVfaGVhZCB0cWhl
YWQ7Cn07CiMgMTIyICIuL2luY2x1ZGUvbGludXgvcG9zaXgtdGltZXJzLmgiCnN0cnVjdCBw
b3NpeF9jcHV0aW1lcnMgewogc3RydWN0IHBvc2l4X2NwdXRpbWVyX2Jhc2UgYmFzZXNbM107
CiB1bnNpZ25lZCBpbnQgdGltZXJzX2FjdGl2ZTsKIHVuc2lnbmVkIGludCBleHBpcnlfYWN0
aXZlOwp9OwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgcG9zaXhfY3B1dGltZXJzX2luaXQoc3RydWN0IHBv
c2l4X2NwdXRpbWVycyAqcGN0KQp7CiBtZW1zZXQocGN0LCAwLCBzaXplb2YoKnBjdCkpOwog
cGN0LT5iYXNlc1swXS5uZXh0ZXZ0ID0gKCh1NjQpfjBVTEwpOwogcGN0LT5iYXNlc1sxXS5u
ZXh0ZXZ0ID0gKCh1NjQpfjBVTEwpOwogcGN0LT5iYXNlc1syXS5uZXh0ZXZ0ID0gKCh1NjQp
fjBVTEwpOwp9Cgp2b2lkIHBvc2l4X2NwdXRpbWVyc19ncm91cF9pbml0KHN0cnVjdCBwb3Np
eF9jcHV0aW1lcnMgKnBjdCwgdTY0IGNwdV9saW1pdCk7CgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBwb3Np
eF9jcHV0aW1lcnNfcnRfd2F0Y2hkb2coc3RydWN0IHBvc2l4X2NwdXRpbWVycyAqcGN0LAog
ICAgICAgICAgICB1NjQgcnVudGltZSkKewogcGN0LT5iYXNlc1syXS5uZXh0ZXZ0ID0gcnVu
dGltZTsKfQojIDE5MyAiLi9pbmNsdWRlL2xpbnV4L3Bvc2l4LXRpbWVycy5oIgpzdHJ1Y3Qg
a19pdGltZXIgewogc3RydWN0IGxpc3RfaGVhZCBsaXN0Owogc3RydWN0IGhsaXN0X25vZGUg
dF9oYXNoOwogc3BpbmxvY2tfdCBpdF9sb2NrOwogY29uc3Qgc3RydWN0IGtfY2xvY2sgKmtj
bG9jazsKIGNsb2NraWRfdCBpdF9jbG9jazsKIHRpbWVyX3QgaXRfaWQ7CiBpbnQgaXRfYWN0
aXZlOwogczY0IGl0X292ZXJydW47CiBzNjQgaXRfb3ZlcnJ1bl9sYXN0OwogaW50IGl0X3Jl
cXVldWVfcGVuZGluZzsKIGludCBpdF9zaWdldl9ub3RpZnk7CiBrdGltZV90IGl0X2ludGVy
dmFsOwogc3RydWN0IHNpZ25hbF9zdHJ1Y3QgKml0X3NpZ25hbDsKIHVuaW9uIHsKICBzdHJ1
Y3QgcGlkICppdF9waWQ7CiAgc3RydWN0IHRhc2tfc3RydWN0ICppdF9wcm9jZXNzOwogfTsK
IHN0cnVjdCBzaWdxdWV1ZSAqc2lncTsKIHVuaW9uIHsKICBzdHJ1Y3QgewogICBzdHJ1Y3Qg
aHJ0aW1lciB0aW1lcjsKICB9IHJlYWw7CiAgc3RydWN0IGNwdV90aW1lciBjcHU7CiAgc3Ry
dWN0IHsKICAgc3RydWN0IGFsYXJtIGFsYXJtdGltZXI7CiAgfSBhbGFybTsKIH0gaXQ7CiBz
dHJ1Y3QgY2FsbGJhY2tfaGVhZCByY3U7Cn07Cgp2b2lkIHJ1bl9wb3NpeF9jcHVfdGltZXJz
KHZvaWQpOwp2b2lkIHBvc2l4X2NwdV90aW1lcnNfZXhpdChzdHJ1Y3QgdGFza19zdHJ1Y3Qg
KnRhc2spOwp2b2lkIHBvc2l4X2NwdV90aW1lcnNfZXhpdF9ncm91cChzdHJ1Y3QgdGFza19z
dHJ1Y3QgKnRhc2spOwp2b2lkIHNldF9wcm9jZXNzX2NwdV90aW1lcihzdHJ1Y3QgdGFza19z
dHJ1Y3QgKnRhc2ssIHVuc2lnbmVkIGludCBjbG9ja19pZHgsCiAgICAgIHU2NCAqbmV3dmFs
LCB1NjQgKm9sZHZhbCk7Cgp2b2lkIHVwZGF0ZV9ybGltaXRfY3B1KHN0cnVjdCB0YXNrX3N0
cnVjdCAqdGFzaywgdW5zaWduZWQgbG9uZyBybGltX25ldyk7Cgp2b2lkIHBvc2l4dGltZXJf
cmVhcm0oc3RydWN0IGtlcm5lbF9zaWdpbmZvICppbmZvKTsKIyAzMyAiLi9pbmNsdWRlL2xp
bnV4L3NjaGVkLmgiIDIKIyAxICIuL2luY2x1ZGUvdWFwaS9saW51eC9yc2VxLmgiIDEKIyAx
NiAiLi9pbmNsdWRlL3VhcGkvbGludXgvcnNlcS5oIgplbnVtIHJzZXFfY3B1X2lkX3N0YXRl
IHsKIFJTRVFfQ1BVX0lEX1VOSU5JVElBTElaRUQgPSAtMSwKIFJTRVFfQ1BVX0lEX1JFR0lT
VFJBVElPTl9GQUlMRUQgPSAtMiwKfTsKCmVudW0gcnNlcV9mbGFncyB7CiBSU0VRX0ZMQUdf
VU5SRUdJU1RFUiA9ICgxIDw8IDApLAp9OwoKZW51bSByc2VxX2NzX2ZsYWdzX2JpdCB7CiBS
U0VRX0NTX0ZMQUdfTk9fUkVTVEFSVF9PTl9QUkVFTVBUX0JJVCA9IDAsCiBSU0VRX0NTX0ZM
QUdfTk9fUkVTVEFSVF9PTl9TSUdOQUxfQklUID0gMSwKIFJTRVFfQ1NfRkxBR19OT19SRVNU
QVJUX09OX01JR1JBVEVfQklUID0gMiwKfTsKCmVudW0gcnNlcV9jc19mbGFncyB7CiBSU0VR
X0NTX0ZMQUdfTk9fUkVTVEFSVF9PTl9QUkVFTVBUID0KICAoMVUgPDwgUlNFUV9DU19GTEFH
X05PX1JFU1RBUlRfT05fUFJFRU1QVF9CSVQpLAogUlNFUV9DU19GTEFHX05PX1JFU1RBUlRf
T05fU0lHTkFMID0KICAoMVUgPDwgUlNFUV9DU19GTEFHX05PX1JFU1RBUlRfT05fU0lHTkFM
X0JJVCksCiBSU0VRX0NTX0ZMQUdfTk9fUkVTVEFSVF9PTl9NSUdSQVRFID0KICAoMVUgPDwg
UlNFUV9DU19GTEFHX05PX1JFU1RBUlRfT05fTUlHUkFURV9CSVQpLAp9OwoKCgoKCgpzdHJ1
Y3QgcnNlcV9jcyB7CgogX191MzIgdmVyc2lvbjsKCiBfX3UzMiBmbGFnczsKIF9fdTY0IHN0
YXJ0X2lwOwoKIF9fdTY0IHBvc3RfY29tbWl0X29mZnNldDsKIF9fdTY0IGFib3J0X2lwOwp9
IF9fYXR0cmlidXRlX18oKGFsaWduZWQoNCAqIHNpemVvZihfX3U2NCkpKSk7CgoKCgoKCgpz
dHJ1Y3QgcnNlcSB7CiMgNzUgIi4vaW5jbHVkZS91YXBpL2xpbnV4L3JzZXEuaCIKIF9fdTMy
IGNwdV9pZF9zdGFydDsKIyA5MCAiLi9pbmNsdWRlL3VhcGkvbGludXgvcnNlcS5oIgogX191
MzIgY3B1X2lkOwojIDEwOSAiLi9pbmNsdWRlL3VhcGkvbGludXgvcnNlcS5oIgogdW5pb24g
ewogIF9fdTY0IHB0cjY0OwoKICBfX3U2NCBwdHI7CiMgMTI0ICIuL2luY2x1ZGUvdWFwaS9s
aW51eC9yc2VxLmgiCiB9IHJzZXFfY3M7CiMgMTQ0ICIuL2luY2x1ZGUvdWFwaS9saW51eC9y
c2VxLmgiCiBfX3UzMiBmbGFnczsKfSBfX2F0dHJpYnV0ZV9fKChhbGlnbmVkKDQgKiBzaXpl
b2YoX191NjQpKSkpOwojIDM0ICIuL2luY2x1ZGUvbGludXgvc2NoZWQuaCIgMgojIDEgIi4v
aW5jbHVkZS9saW51eC9rY3Nhbi5oIiAxCiMgNTUgIi4vaW5jbHVkZS9saW51eC9rY3Nhbi5o
IgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgdm9pZCBrY3Nhbl9pbml0KHZvaWQpIHsgfQojIDM1ICIuL2luY2x1ZGUv
bGludXgvc2NoZWQuaCIgMgoKCnN0cnVjdCBhdWRpdF9jb250ZXh0OwpzdHJ1Y3QgYmFja2lu
Z19kZXZfaW5mbzsKc3RydWN0IGJpb19saXN0OwpzdHJ1Y3QgYmxrX3BsdWc7CnN0cnVjdCBj
YXB0dXJlX2NvbnRyb2w7CnN0cnVjdCBjZnNfcnE7CnN0cnVjdCBmc19zdHJ1Y3Q7CnN0cnVj
dCBmdXRleF9waV9zdGF0ZTsKc3RydWN0IGlvX2NvbnRleHQ7CnN0cnVjdCBtZW1wb2xpY3k7
CnN0cnVjdCBuYW1laWRhdGE7CnN0cnVjdCBuc3Byb3h5OwpzdHJ1Y3QgcGVyZl9ldmVudF9j
b250ZXh0OwpzdHJ1Y3QgcGlkX25hbWVzcGFjZTsKc3RydWN0IHBpcGVfaW5vZGVfaW5mbzsK
c3RydWN0IHJjdV9ub2RlOwpzdHJ1Y3QgcmVjbGFpbV9zdGF0ZTsKc3RydWN0IHJvYnVzdF9s
aXN0X2hlYWQ7CnN0cnVjdCByb290X2RvbWFpbjsKc3RydWN0IHJxOwpzdHJ1Y3Qgc2NoZWRf
YXR0cjsKc3RydWN0IHNjaGVkX3BhcmFtOwpzdHJ1Y3Qgc2VxX2ZpbGU7CnN0cnVjdCBzaWdo
YW5kX3N0cnVjdDsKc3RydWN0IHNpZ25hbF9zdHJ1Y3Q7CnN0cnVjdCB0YXNrX2RlbGF5X2lu
Zm87CnN0cnVjdCB0YXNrX2dyb3VwOwojIDIxNiAiLi9pbmNsdWRlL2xpbnV4L3NjaGVkLmgi
CmV4dGVybiB2b2lkIHNjaGVkdWxlcl90aWNrKHZvaWQpOwoKCgpleHRlcm4gbG9uZyBzY2hl
ZHVsZV90aW1lb3V0KGxvbmcgdGltZW91dCk7CmV4dGVybiBsb25nIHNjaGVkdWxlX3RpbWVv
dXRfaW50ZXJydXB0aWJsZShsb25nIHRpbWVvdXQpOwpleHRlcm4gbG9uZyBzY2hlZHVsZV90
aW1lb3V0X2tpbGxhYmxlKGxvbmcgdGltZW91dCk7CmV4dGVybiBsb25nIHNjaGVkdWxlX3Rp
bWVvdXRfdW5pbnRlcnJ1cHRpYmxlKGxvbmcgdGltZW91dCk7CmV4dGVybiBsb25nIHNjaGVk
dWxlX3RpbWVvdXRfaWRsZShsb25nIHRpbWVvdXQpOwogdm9pZCBzY2hlZHVsZSh2b2lkKTsK
ZXh0ZXJuIHZvaWQgc2NoZWR1bGVfcHJlZW1wdF9kaXNhYmxlZCh2b2lkKTsKIHZvaWQgcHJl
ZW1wdF9zY2hlZHVsZV9pcnEodm9pZCk7CgpleHRlcm4gaW50IF9fYXR0cmlidXRlX18oKF9f
d2Fybl91bnVzZWRfcmVzdWx0X18pKSBpb19zY2hlZHVsZV9wcmVwYXJlKHZvaWQpOwpleHRl
cm4gdm9pZCBpb19zY2hlZHVsZV9maW5pc2goaW50IHRva2VuKTsKZXh0ZXJuIGxvbmcgaW9f
c2NoZWR1bGVfdGltZW91dChsb25nIHRpbWVvdXQpOwpleHRlcm4gdm9pZCBpb19zY2hlZHVs
ZSh2b2lkKTsKIyAyNDMgIi4vaW5jbHVkZS9saW51eC9zY2hlZC5oIgpzdHJ1Y3QgcHJldl9j
cHV0aW1lIHsKCgoKCgp9OwoKZW51bSB2dGltZV9zdGF0ZSB7CgogVlRJTUVfSU5BQ1RJVkUg
PSAwLAoKIFZUSU1FX0lETEUsCgogVlRJTUVfU1lTLAoKIFZUSU1FX1VTRVIsCgogVlRJTUVf
R1VFU1QsCn07CgpzdHJ1Y3QgdnRpbWUgewogc2VxY291bnRfdCBzZXFjb3VudDsKIHVuc2ln
bmVkIGxvbmcgbG9uZyBzdGFydHRpbWU7CiBlbnVtIHZ0aW1lX3N0YXRlIHN0YXRlOwogdW5z
aWduZWQgaW50IGNwdTsKIHU2NCB1dGltZTsKIHU2NCBzdGltZTsKIHU2NCBndGltZTsKfTsK
CgoKCgoKCmVudW0gdWNsYW1wX2lkIHsKIFVDTEFNUF9NSU4gPSAwLAogVUNMQU1QX01BWCwK
IFVDTEFNUF9DTlQKfTsKCgpleHRlcm4gc3RydWN0IHJvb3RfZG9tYWluIGRlZl9yb290X2Rv
bWFpbjsKZXh0ZXJuIHN0cnVjdCBtdXRleCBzY2hlZF9kb21haW5zX211dGV4OwoKCnN0cnVj
dCBzY2hlZF9pbmZvIHsKIyAzMTAgIi4vaW5jbHVkZS9saW51eC9zY2hlZC5oIgp9OwojIDMy
NiAiLi9pbmNsdWRlL2xpbnV4L3NjaGVkLmgiCnN0cnVjdCBsb2FkX3dlaWdodCB7CiB1bnNp
Z25lZCBsb25nIHdlaWdodDsKIHUzMiBpbnZfd2VpZ2h0Owp9OwojIDM1MyAiLi9pbmNsdWRl
L2xpbnV4L3NjaGVkLmgiCnN0cnVjdCB1dGlsX2VzdCB7CiB1bnNpZ25lZCBpbnQgZW5xdWV1
ZWQ7CiB1bnNpZ25lZCBpbnQgZXdtYTsKCn0gX19hdHRyaWJ1dGVfXygoX19hbGlnbmVkX18o
c2l6ZW9mKHU2NCkpKSk7CiMgNDA0ICIuL2luY2x1ZGUvbGludXgvc2NoZWQuaCIKc3RydWN0
IHNjaGVkX2F2ZyB7CiB1NjQgbGFzdF91cGRhdGVfdGltZTsKIHU2NCBsb2FkX3N1bTsKIHU2
NCBydW5uYWJsZV9zdW07CiB1MzIgdXRpbF9zdW07CiB1MzIgcGVyaW9kX2NvbnRyaWI7CiB1
bnNpZ25lZCBsb25nIGxvYWRfYXZnOwogdW5zaWduZWQgbG9uZyBydW5uYWJsZV9hdmc7CiB1
bnNpZ25lZCBsb25nIHV0aWxfYXZnOwogc3RydWN0IHV0aWxfZXN0IHV0aWxfZXN0Owp9IF9f
YXR0cmlidXRlX18oKF9fYWxpZ25lZF9fKCgxIDw8IDYpKSkpOwoKc3RydWN0IHNjaGVkX3N0
YXRpc3RpY3MgewojIDQ1MCAiLi9pbmNsdWRlL2xpbnV4L3NjaGVkLmgiCn07CgpzdHJ1Y3Qg
c2NoZWRfZW50aXR5IHsKCiBzdHJ1Y3QgbG9hZF93ZWlnaHQgbG9hZDsKIHN0cnVjdCByYl9u
b2RlIHJ1bl9ub2RlOwogc3RydWN0IGxpc3RfaGVhZCBncm91cF9ub2RlOwogdW5zaWduZWQg
aW50IG9uX3JxOwoKIHU2NCBleGVjX3N0YXJ0OwogdTY0IHN1bV9leGVjX3J1bnRpbWU7CiB1
NjQgdnJ1bnRpbWU7CiB1NjQgcHJldl9zdW1fZXhlY19ydW50aW1lOwoKIHU2NCBucl9taWdy
YXRpb25zOwoKIHN0cnVjdCBzY2hlZF9zdGF0aXN0aWNzIHN0YXRpc3RpY3M7CgoKIGludCBk
ZXB0aDsKIHN0cnVjdCBzY2hlZF9lbnRpdHkgKnBhcmVudDsKCiBzdHJ1Y3QgY2ZzX3JxICpj
ZnNfcnE7Cgogc3RydWN0IGNmc19ycSAqbXlfcTsKCiB1bnNpZ25lZCBsb25nIHJ1bm5hYmxl
X3dlaWdodDsKIyA0ODYgIi4vaW5jbHVkZS9saW51eC9zY2hlZC5oIgogc3RydWN0IHNjaGVk
X2F2ZyBhdmc7Cgp9OwoKc3RydWN0IHNjaGVkX3J0X2VudGl0eSB7CiBzdHJ1Y3QgbGlzdF9o
ZWFkIHJ1bl9saXN0OwogdW5zaWduZWQgbG9uZyB0aW1lb3V0OwogdW5zaWduZWQgbG9uZyB3
YXRjaGRvZ19zdGFtcDsKIHVuc2lnbmVkIGludCB0aW1lX3NsaWNlOwogdW5zaWduZWQgc2hv
cnQgb25fcnE7CiB1bnNpZ25lZCBzaG9ydCBvbl9saXN0OwoKIHN0cnVjdCBzY2hlZF9ydF9l
bnRpdHkgKmJhY2s7CgoKCgoKCgp9IDsKCnN0cnVjdCBzY2hlZF9kbF9lbnRpdHkgewogc3Ry
dWN0IHJiX25vZGUgcmJfbm9kZTsKCgoKCgoKIHU2NCBkbF9ydW50aW1lOwogdTY0IGRsX2Rl
YWRsaW5lOwogdTY0IGRsX3BlcmlvZDsKIHU2NCBkbF9idzsKIHU2NCBkbF9kZW5zaXR5OwoK
CgoKCgogczY0IHJ1bnRpbWU7CiB1NjQgZGVhZGxpbmU7CiB1bnNpZ25lZCBpbnQgZmxhZ3M7
CiMgNTU1ICIuL2luY2x1ZGUvbGludXgvc2NoZWQuaCIKIHVuc2lnbmVkIGludCBkbF90aHJv
dHRsZWQgOiAxOwogdW5zaWduZWQgaW50IGRsX2Jvb3N0ZWQgOiAxOwogdW5zaWduZWQgaW50
IGRsX3lpZWxkZWQgOiAxOwogdW5zaWduZWQgaW50IGRsX25vbl9jb250ZW5kaW5nIDogMTsK
IHVuc2lnbmVkIGludCBkbF9vdmVycnVuIDogMTsKCgoKCgogc3RydWN0IGhydGltZXIgZGxf
dGltZXI7CiMgNTc0ICIuL2luY2x1ZGUvbGludXgvc2NoZWQuaCIKIHN0cnVjdCBocnRpbWVy
IGluYWN0aXZlX3RpbWVyOwp9OwojIDYxMiAiLi9pbmNsdWRlL2xpbnV4L3NjaGVkLmgiCnVu
aW9uIHJjdV9zcGVjaWFsIHsKIHN0cnVjdCB7CiAgdTggYmxvY2tlZDsKICB1OCBuZWVkX3Fz
OwogIHU4IGV4cF9oaW50OwogIHU4IG5lZWRfbWI7CiB9IGI7CiB1MzIgczsKfTsKCmVudW0g
cGVyZl9ldmVudF90YXNrX2NvbnRleHQgewogcGVyZl9pbnZhbGlkX2NvbnRleHQgPSAtMSwK
IHBlcmZfaHdfY29udGV4dCA9IDAsCiBwZXJmX3N3X2NvbnRleHQsCiBwZXJmX25yX3Rhc2tf
Y29udGV4dHMsCn07CgpzdHJ1Y3Qgd2FrZV9xX25vZGUgewogc3RydWN0IHdha2VfcV9ub2Rl
ICpuZXh0Owp9OwoKc3RydWN0IHRhc2tfc3RydWN0IHsKCgoKCgogc3RydWN0IHRocmVhZF9p
bmZvIHRocmVhZF9pbmZvOwoKCiB2b2xhdGlsZSBsb25nIHN0YXRlOwoKCgoKCgoKIHZvaWQg
KnN0YWNrOwogcmVmY291bnRfdCB1c2FnZTsKCiB1bnNpZ25lZCBpbnQgZmxhZ3M7CiB1bnNp
Z25lZCBpbnQgcHRyYWNlOwoKCiBpbnQgb25fY3B1Owogc3RydWN0IF9fY2FsbF9zaW5nbGVf
bm9kZSB3YWtlX2VudHJ5OwoKCiB1bnNpZ25lZCBpbnQgY3B1OwoKIHVuc2lnbmVkIGludCB3
YWtlZV9mbGlwczsKIHVuc2lnbmVkIGxvbmcgd2FrZWVfZmxpcF9kZWNheV90czsKIHN0cnVj
dCB0YXNrX3N0cnVjdCAqbGFzdF93YWtlZTsKIyA2NzQgIi4vaW5jbHVkZS9saW51eC9zY2hl
ZC5oIgogaW50IHJlY2VudF91c2VkX2NwdTsKIGludCB3YWtlX2NwdTsKCiBpbnQgb25fcnE7
CgogaW50IHByaW87CiBpbnQgc3RhdGljX3ByaW87CiBpbnQgbm9ybWFsX3ByaW87CiB1bnNp
Z25lZCBpbnQgcnRfcHJpb3JpdHk7CgogY29uc3Qgc3RydWN0IHNjaGVkX2NsYXNzICpzY2hl
ZF9jbGFzczsKIHN0cnVjdCBzY2hlZF9lbnRpdHkgc2U7CiBzdHJ1Y3Qgc2NoZWRfcnRfZW50
aXR5IHJ0OwoKIHN0cnVjdCB0YXNrX2dyb3VwICpzY2hlZF90YXNrX2dyb3VwOwoKIHN0cnVj
dCBzY2hlZF9kbF9lbnRpdHkgZGw7CiMgNzA4ICIuL2luY2x1ZGUvbGludXgvc2NoZWQuaCIK
IHVuc2lnbmVkIGludCBwb2xpY3k7CiBpbnQgbnJfY3B1c19hbGxvd2VkOwogY29uc3QgY3B1
bWFza190ICpjcHVzX3B0cjsKIGNwdW1hc2tfdCBjcHVzX21hc2s7CiMgNzM2ICIuL2luY2x1
ZGUvbGludXgvc2NoZWQuaCIKIHN0cnVjdCBzY2hlZF9pbmZvIHNjaGVkX2luZm87Cgogc3Ry
dWN0IGxpc3RfaGVhZCB0YXNrczsKCiBzdHJ1Y3QgcGxpc3Rfbm9kZSBwdXNoYWJsZV90YXNr
czsKIHN0cnVjdCByYl9ub2RlIHB1c2hhYmxlX2RsX3Rhc2tzOwoKCiBzdHJ1Y3QgbW1fc3Ry
dWN0ICptbTsKIHN0cnVjdCBtbV9zdHJ1Y3QgKmFjdGl2ZV9tbTsKCgogc3RydWN0IHZtYWNh
Y2hlIHZtYWNhY2hlOwoKCiBzdHJ1Y3QgdGFza19yc3Nfc3RhdCByc3Nfc3RhdDsKCiBpbnQg
ZXhpdF9zdGF0ZTsKIGludCBleGl0X2NvZGU7CiBpbnQgZXhpdF9zaWduYWw7CgogaW50IHBk
ZWF0aF9zaWduYWw7CgogdW5zaWduZWQgbG9uZyBqb2JjdGw7CgoKIHVuc2lnbmVkIGludCBw
ZXJzb25hbGl0eTsKCgogdW5zaWduZWQgc2NoZWRfcmVzZXRfb25fZm9yazoxOwogdW5zaWdu
ZWQgc2NoZWRfY29udHJpYnV0ZXNfdG9fbG9hZDoxOwogdW5zaWduZWQgc2NoZWRfbWlncmF0
ZWQ6MTsKIHVuc2lnbmVkIHNjaGVkX3JlbW90ZV93YWtldXA6MTsKCgoKCgogdW5zaWduZWQg
OjA7CgoKCgogdW5zaWduZWQgaW5fZXhlY3ZlOjE7CiB1bnNpZ25lZCBpbl9pb3dhaXQ6MTsK
CiB1bnNpZ25lZCByZXN0b3JlX3NpZ21hc2s6MTsKCgoKCgogdW5zaWduZWQgYnJrX3JhbmRv
bWl6ZWQ6MTsKCgoKIHVuc2lnbmVkIG5vX2Nncm91cF9taWdyYXRpb246MTsKCiB1bnNpZ25l
ZCBmcm96ZW46MTsKIyA4MDQgIi4vaW5jbHVkZS9saW51eC9zY2hlZC5oIgogdW5zaWduZWQg
bG9uZyBhdG9taWNfZmxhZ3M7Cgogc3RydWN0IHJlc3RhcnRfYmxvY2sgcmVzdGFydF9ibG9j
azsKCiBwaWRfdCBwaWQ7CiBwaWRfdCB0Z2lkOwojIDgyMiAiLi9pbmNsdWRlL2xpbnV4L3Nj
aGVkLmgiCiBzdHJ1Y3QgdGFza19zdHJ1Y3QgKnJlYWxfcGFyZW50OwoKCiBzdHJ1Y3QgdGFz
a19zdHJ1Y3QgKnBhcmVudDsKCgoKCiBzdHJ1Y3QgbGlzdF9oZWFkIGNoaWxkcmVuOwogc3Ry
dWN0IGxpc3RfaGVhZCBzaWJsaW5nOwogc3RydWN0IHRhc2tfc3RydWN0ICpncm91cF9sZWFk
ZXI7CgoKCgoKCgogc3RydWN0IGxpc3RfaGVhZCBwdHJhY2VkOwogc3RydWN0IGxpc3RfaGVh
ZCBwdHJhY2VfZW50cnk7CgoKIHN0cnVjdCBwaWQgKnRocmVhZF9waWQ7CiBzdHJ1Y3QgaGxp
c3Rfbm9kZSBwaWRfbGlua3NbUElEVFlQRV9NQVhdOwogc3RydWN0IGxpc3RfaGVhZCB0aHJl
YWRfZ3JvdXA7CiBzdHJ1Y3QgbGlzdF9oZWFkIHRocmVhZF9ub2RlOwoKIHN0cnVjdCBjb21w
bGV0aW9uICp2Zm9ya19kb25lOwoKCiBpbnQgKnNldF9jaGlsZF90aWQ7CgoKIGludCAqY2xl
YXJfY2hpbGRfdGlkOwoKIHU2NCB1dGltZTsKIHU2NCBzdGltZTsKCgoKCiB1NjQgZ3RpbWU7
CiBzdHJ1Y3QgcHJldl9jcHV0aW1lIHByZXZfY3B1dGltZTsKIyA4NzMgIi4vaW5jbHVkZS9s
aW51eC9zY2hlZC5oIgogdW5zaWduZWQgbG9uZyBudmNzdzsKIHVuc2lnbmVkIGxvbmcgbml2
Y3N3OwoKCiB1NjQgc3RhcnRfdGltZTsKCgogdTY0IHN0YXJ0X2Jvb3R0aW1lOwoKCiB1bnNp
Z25lZCBsb25nIG1pbl9mbHQ7CiB1bnNpZ25lZCBsb25nIG1hal9mbHQ7CgoKIHN0cnVjdCBw
b3NpeF9jcHV0aW1lcnMgcG9zaXhfY3B1dGltZXJzOwoKCgoKIGNvbnN0IHN0cnVjdCBjcmVk
ICpwdHJhY2VyX2NyZWQ7CgoKIGNvbnN0IHN0cnVjdCBjcmVkICpyZWFsX2NyZWQ7CgoKIGNv
bnN0IHN0cnVjdCBjcmVkICpjcmVkOwoKCgogc3RydWN0IGtleSAqY2FjaGVkX3JlcXVlc3Rl
ZF9rZXk7CiMgOTEyICIuL2luY2x1ZGUvbGludXgvc2NoZWQuaCIKIGNoYXIgY29tbVsxNl07
Cgogc3RydWN0IG5hbWVpZGF0YSAqbmFtZWlkYXRhOwoKCiBzdHJ1Y3Qgc3lzdl9zZW0gc3lz
dnNlbTsKIHN0cnVjdCBzeXN2X3NobSBzeXN2c2htOwoKCiB1bnNpZ25lZCBsb25nIGxhc3Rf
c3dpdGNoX2NvdW50OwogdW5zaWduZWQgbG9uZyBsYXN0X3N3aXRjaF90aW1lOwoKCiBzdHJ1
Y3QgZnNfc3RydWN0ICpmczsKCgogc3RydWN0IGZpbGVzX3N0cnVjdCAqZmlsZXM7CgoKIHN0
cnVjdCBuc3Byb3h5ICpuc3Byb3h5OwoKCiBzdHJ1Y3Qgc2lnbmFsX3N0cnVjdCAqc2lnbmFs
Owogc3RydWN0IHNpZ2hhbmRfc3RydWN0ICpzaWdoYW5kOwogc2lnc2V0X3QgYmxvY2tlZDsK
IHNpZ3NldF90IHJlYWxfYmxvY2tlZDsKCiBzaWdzZXRfdCBzYXZlZF9zaWdtYXNrOwogc3Ry
dWN0IHNpZ3BlbmRpbmcgcGVuZGluZzsKIHVuc2lnbmVkIGxvbmcgc2FzX3NzX3NwOwogc2l6
ZV90IHNhc19zc19zaXplOwogdW5zaWduZWQgaW50IHNhc19zc19mbGFnczsKCiBzdHJ1Y3Qg
Y2FsbGJhY2tfaGVhZCAqdGFza193b3JrczsKCgoKIHN0cnVjdCBhdWRpdF9jb250ZXh0ICph
dWRpdF9jb250ZXh0OwoKIGt1aWRfdCBsb2dpbnVpZDsKIHVuc2lnbmVkIGludCBzZXNzaW9u
aWQ7Cgogc3RydWN0IHNlY2NvbXAgc2VjY29tcDsKCgogdTY0IHBhcmVudF9leGVjX2lkOwog
dTY0IHNlbGZfZXhlY19pZDsKCgogc3BpbmxvY2tfdCBhbGxvY19sb2NrOwoKCiByYXdfc3Bp
bmxvY2tfdCBwaV9sb2NrOwoKIHN0cnVjdCB3YWtlX3Ffbm9kZSB3YWtlX3E7CgoKCiBzdHJ1
Y3QgcmJfcm9vdF9jYWNoZWQgcGlfd2FpdGVyczsKCiBzdHJ1Y3QgdGFza19zdHJ1Y3QgKnBp
X3RvcF90YXNrOwoKIHN0cnVjdCBydF9tdXRleF93YWl0ZXIgKnBpX2Jsb2NrZWRfb247CiMg
MTAxOCAiLi9pbmNsdWRlL2xpbnV4L3NjaGVkLmgiCiB2b2lkICpqb3VybmFsX2luZm87CgoK
IHN0cnVjdCBiaW9fbGlzdCAqYmlvX2xpc3Q7CgoKCiBzdHJ1Y3QgYmxrX3BsdWcgKnBsdWc7
CgoKCiBzdHJ1Y3QgcmVjbGFpbV9zdGF0ZSAqcmVjbGFpbV9zdGF0ZTsKCiBzdHJ1Y3QgYmFj
a2luZ19kZXZfaW5mbyAqYmFja2luZ19kZXZfaW5mbzsKCiBzdHJ1Y3QgaW9fY29udGV4dCAq
aW9fY29udGV4dDsKCgogc3RydWN0IGNhcHR1cmVfY29udHJvbCAqY2FwdHVyZV9jb250cm9s
OwoKCiB1bnNpZ25lZCBsb25nIHB0cmFjZV9tZXNzYWdlOwoga2VybmVsX3NpZ2luZm9fdCAq
bGFzdF9zaWdpbmZvOwoKIHN0cnVjdCB0YXNrX2lvX2FjY291bnRpbmcgaW9hYzsKIyAxMDU3
ICIuL2luY2x1ZGUvbGludXgvc2NoZWQuaCIKIG5vZGVtYXNrX3QgbWVtc19hbGxvd2VkOwoK
IHNlcWNvdW50X3QgbWVtc19hbGxvd2VkX3NlcTsKIGludCBjcHVzZXRfbWVtX3NwcmVhZF9y
b3RvcjsKIGludCBjcHVzZXRfc2xhYl9zcHJlYWRfcm90b3I7CgoKCiBzdHJ1Y3QgY3NzX3Nl
dCAqY2dyb3VwczsKCiBzdHJ1Y3QgbGlzdF9oZWFkIGNnX2xpc3Q7CgoKCgoKCiBzdHJ1Y3Qg
cm9idXN0X2xpc3RfaGVhZCAqcm9idXN0X2xpc3Q7Cgogc3RydWN0IGNvbXBhdF9yb2J1c3Rf
bGlzdF9oZWFkICpjb21wYXRfcm9idXN0X2xpc3Q7Cgogc3RydWN0IGxpc3RfaGVhZCBwaV9z
dGF0ZV9saXN0Owogc3RydWN0IGZ1dGV4X3BpX3N0YXRlICpwaV9zdGF0ZV9jYWNoZTsKIHN0
cnVjdCBtdXRleCBmdXRleF9leGl0X211dGV4OwogdW5zaWduZWQgaW50IGZ1dGV4X3N0YXRl
OwoKCiBzdHJ1Y3QgcGVyZl9ldmVudF9jb250ZXh0ICpwZXJmX2V2ZW50X2N0eHBbcGVyZl9u
cl90YXNrX2NvbnRleHRzXTsKIHN0cnVjdCBtdXRleCBwZXJmX2V2ZW50X211dGV4Owogc3Ry
dWN0IGxpc3RfaGVhZCBwZXJmX2V2ZW50X2xpc3Q7CiMgMTE0OCAiLi9pbmNsdWRlL2xpbnV4
L3NjaGVkLmgiCiBzdHJ1Y3QgcnNlcSAqcnNlcTsKIHUzMiByc2VxX3NpZzsKCgoKCiB1bnNp
Z25lZCBsb25nIHJzZXFfZXZlbnRfbWFzazsKCgogc3RydWN0IHRsYmZsdXNoX3VubWFwX2Jh
dGNoIHRsYl91YmM7CgogdW5pb24gewogIHJlZmNvdW50X3QgcmN1X3VzZXJzOwogIHN0cnVj
dCBjYWxsYmFja19oZWFkIHJjdTsKIH07CgoKIHN0cnVjdCBwaXBlX2lub2RlX2luZm8gKnNw
bGljZV9waXBlOwoKIHN0cnVjdCBwYWdlX2ZyYWcgdGFza19mcmFnOwojIDExODEgIi4vaW5j
bHVkZS9saW51eC9zY2hlZC5oIgogaW50IG5yX2RpcnRpZWQ7CiBpbnQgbnJfZGlydGllZF9w
YXVzZTsKCiB1bnNpZ25lZCBsb25nIGRpcnR5X3BhdXNlZF93aGVuOwojIDExOTQgIi4vaW5j
bHVkZS9saW51eC9zY2hlZC5oIgogdTY0IHRpbWVyX3NsYWNrX25zOwogdTY0IGRlZmF1bHRf
dGltZXJfc2xhY2tfbnM7CiMgMTIyNyAiLi9pbmNsdWRlL2xpbnV4L3NjaGVkLmgiCiB1bnNp
Z25lZCBsb25nIHRyYWNlOwoKCiB1bnNpZ25lZCBsb25nIHRyYWNlX3JlY3Vyc2lvbjsKIyAx
Mjc1ICIuL2luY2x1ZGUvbGludXgvc2NoZWQuaCIKIHN0cnVjdCB1cHJvYmVfdGFzayAqdXRh
c2s7CiMgMTI4NCAiLi9pbmNsdWRlL2xpbnV4L3NjaGVkLmgiCiBpbnQgcGFnZWZhdWx0X2Rp
c2FibGVkOwoKIHN0cnVjdCB0YXNrX3N0cnVjdCAqb29tX3JlYXBlcl9saXN0OwoKCgoKCgog
cmVmY291bnRfdCBzdGFja19yZWZjb3VudDsKIyAxMzIwICIuL2luY2x1ZGUvbGludXgvc2No
ZWQuaCIKCgoKIHN0cnVjdCB0aHJlYWRfc3RydWN0IHRocmVhZDsKCgoKCgoKCn07CgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgc3RydWN0IHBpZCAqdGFza19waWQoc3RydWN0IHRhc2tfc3RydWN0ICp0YXNrKQp7
CiByZXR1cm4gdGFzay0+dGhyZWFkX3BpZDsKfQojIDEzNDkgIi4vaW5jbHVkZS9saW51eC9z
Y2hlZC5oIgpwaWRfdCBfX3Rhc2tfcGlkX25yX25zKHN0cnVjdCB0YXNrX3N0cnVjdCAqdGFz
aywgZW51bSBwaWRfdHlwZSB0eXBlLCBzdHJ1Y3QgcGlkX25hbWVzcGFjZSAqbnMpOwoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIHBpZF90IHRhc2tfcGlkX25yKHN0cnVjdCB0YXNrX3N0cnVjdCAqdHNrKQp7CiBy
ZXR1cm4gdHNrLT5waWQ7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBwaWRfdCB0YXNrX3BpZF9ucl9ucyhzdHJ1
Y3QgdGFza19zdHJ1Y3QgKnRzaywgc3RydWN0IHBpZF9uYW1lc3BhY2UgKm5zKQp7CiByZXR1
cm4gX190YXNrX3BpZF9ucl9ucyh0c2ssIFBJRFRZUEVfUElELCBucyk7Cn0KCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBwaWRfdCB0YXNrX3BpZF92bnIoc3RydWN0IHRhc2tfc3RydWN0ICp0c2spCnsKIHJldHVy
biBfX3Rhc2tfcGlkX25yX25zKHRzaywgUElEVFlQRV9QSUQsICgodm9pZCAqKTApKTsKfQoK
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSBwaWRfdCB0YXNrX3RnaWRfbnIoc3RydWN0IHRhc2tfc3RydWN0ICp0c2sp
CnsKIHJldHVybiB0c2stPnRnaWQ7Cn0KIyAxMzgyICIuL2luY2x1ZGUvbGludXgvc2NoZWQu
aCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIGludCBwaWRfYWxpdmUoY29uc3Qgc3RydWN0IHRhc2tfc3RydWN0ICpw
KQp7CiByZXR1cm4gcC0+dGhyZWFkX3BpZCAhPSAoKHZvaWQgKikwKTsKfQoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IHBpZF90IHRhc2tfcGdycF9ucl9ucyhzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRzaywgc3RydWN0
IHBpZF9uYW1lc3BhY2UgKm5zKQp7CiByZXR1cm4gX190YXNrX3BpZF9ucl9ucyh0c2ssIFBJ
RFRZUEVfUEdJRCwgbnMpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgcGlkX3QgdGFza19wZ3JwX3ZucihzdHJ1
Y3QgdGFza19zdHJ1Y3QgKnRzaykKewogcmV0dXJuIF9fdGFza19waWRfbnJfbnModHNrLCBQ
SURUWVBFX1BHSUQsICgodm9pZCAqKTApKTsKfQoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBwaWRfdCB0YXNrX3Nl
c3Npb25fbnJfbnMoc3RydWN0IHRhc2tfc3RydWN0ICp0c2ssIHN0cnVjdCBwaWRfbmFtZXNw
YWNlICpucykKewogcmV0dXJuIF9fdGFza19waWRfbnJfbnModHNrLCBQSURUWVBFX1NJRCwg
bnMpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgcGlkX3QgdGFza19zZXNzaW9uX3ZucihzdHJ1Y3QgdGFza19z
dHJ1Y3QgKnRzaykKewogcmV0dXJuIF9fdGFza19waWRfbnJfbnModHNrLCBQSURUWVBFX1NJ
RCwgKCh2b2lkICopMCkpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgcGlkX3QgdGFza190Z2lkX25yX25zKHN0
cnVjdCB0YXNrX3N0cnVjdCAqdHNrLCBzdHJ1Y3QgcGlkX25hbWVzcGFjZSAqbnMpCnsKIHJl
dHVybiBfX3Rhc2tfcGlkX25yX25zKHRzaywgUElEVFlQRV9UR0lELCBucyk7Cn0KCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBwaWRfdCB0YXNrX3RnaWRfdm5yKHN0cnVjdCB0YXNrX3N0cnVjdCAqdHNrKQp7CiBy
ZXR1cm4gX190YXNrX3BpZF9ucl9ucyh0c2ssIFBJRFRZUEVfVEdJRCwgKCh2b2lkICopMCkp
Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgcGlkX3QgdGFza19wcGlkX25yX25zKGNvbnN0IHN0cnVjdCB0YXNr
X3N0cnVjdCAqdHNrLCBzdHJ1Y3QgcGlkX25hbWVzcGFjZSAqbnMpCnsKIHBpZF90IHBpZCA9
IDA7CgogcmN1X3JlYWRfbG9jaygpOwogaWYgKHBpZF9hbGl2ZSh0c2spKQogIHBpZCA9IHRh
c2tfdGdpZF9ucl9ucygoeyB0eXBlb2YoKih0c2stPnJlYWxfcGFyZW50KSkgKl9fX19fX19f
cDEgPSAodHlwZW9mKCoodHNrLT5yZWFsX3BhcmVudCkpICopKHsgZG8geyBleHRlcm4gdm9p
ZCBfX2NvbXBpbGV0aW1lX2Fzc2VydF8xMDcodm9pZCkgX19hdHRyaWJ1dGVfXygoX19lcnJv
cl9fKCJVbnN1cHBvcnRlZCBhY2Nlc3Mgc2l6ZSBmb3Ige1JFQUQsV1JJVEV9X09OQ0UoKS4i
KSkpOyBpZiAoISgoc2l6ZW9mKCh0c2stPnJlYWxfcGFyZW50KSkgPT0gc2l6ZW9mKGNoYXIp
IHx8IHNpemVvZigodHNrLT5yZWFsX3BhcmVudCkpID09IHNpemVvZihzaG9ydCkgfHwgc2l6
ZW9mKCh0c2stPnJlYWxfcGFyZW50KSkgPT0gc2l6ZW9mKGludCkgfHwgc2l6ZW9mKCh0c2st
PnJlYWxfcGFyZW50KSkgPT0gc2l6ZW9mKGxvbmcpKSB8fCBzaXplb2YoKHRzay0+cmVhbF9w
YXJlbnQpKSA9PSBzaXplb2YobG9uZyBsb25nKSkpIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzEw
NygpOyB9IHdoaWxlICgwKTsgKHsgdHlwZW9mKCBfR2VuZXJpYygoKHRzay0+cmVhbF9wYXJl
bnQpKSwgY2hhcjogKGNoYXIpMCwgdW5zaWduZWQgY2hhcjogKHVuc2lnbmVkIGNoYXIpMCwg
c2lnbmVkIGNoYXI6IChzaWduZWQgY2hhcikwLCB1bnNpZ25lZCBzaG9ydDogKHVuc2lnbmVk
IHNob3J0KTAsIHNpZ25lZCBzaG9ydDogKHNpZ25lZCBzaG9ydCkwLCB1bnNpZ25lZCBpbnQ6
ICh1bnNpZ25lZCBpbnQpMCwgc2lnbmVkIGludDogKHNpZ25lZCBpbnQpMCwgdW5zaWduZWQg
bG9uZzogKHVuc2lnbmVkIGxvbmcpMCwgc2lnbmVkIGxvbmc6IChzaWduZWQgbG9uZykwLCB1
bnNpZ25lZCBsb25nIGxvbmc6ICh1bnNpZ25lZCBsb25nIGxvbmcpMCwgc2lnbmVkIGxvbmcg
bG9uZzogKHNpZ25lZCBsb25nIGxvbmcpMCwgZGVmYXVsdDogKCh0c2stPnJlYWxfcGFyZW50
KSkpKSBfX3ggPSAoKihjb25zdCB2b2xhdGlsZSB0eXBlb2YoIF9HZW5lcmljKCgodHNrLT5y
ZWFsX3BhcmVudCkpLCBjaGFyOiAoY2hhcikwLCB1bnNpZ25lZCBjaGFyOiAodW5zaWduZWQg
Y2hhcikwLCBzaWduZWQgY2hhcjogKHNpZ25lZCBjaGFyKTAsIHVuc2lnbmVkIHNob3J0OiAo
dW5zaWduZWQgc2hvcnQpMCwgc2lnbmVkIHNob3J0OiAoc2lnbmVkIHNob3J0KTAsIHVuc2ln
bmVkIGludDogKHVuc2lnbmVkIGludCkwLCBzaWduZWQgaW50OiAoc2lnbmVkIGludCkwLCB1
bnNpZ25lZCBsb25nOiAodW5zaWduZWQgbG9uZykwLCBzaWduZWQgbG9uZzogKHNpZ25lZCBs
b25nKTAsIHVuc2lnbmVkIGxvbmcgbG9uZzogKHVuc2lnbmVkIGxvbmcgbG9uZykwLCBzaWdu
ZWQgbG9uZyBsb25nOiAoc2lnbmVkIGxvbmcgbG9uZykwLCBkZWZhdWx0OiAoKHRzay0+cmVh
bF9wYXJlbnQpKSkpICopJigodHNrLT5yZWFsX3BhcmVudCkpKTsgZG8geyB9IHdoaWxlICgw
KTsgKHR5cGVvZigodHNrLT5yZWFsX3BhcmVudCkpKV9feDsgfSk7IH0pOyBkbyB7IH0gd2hp
bGUgKDApOyA7ICgodHlwZW9mKCoodHNrLT5yZWFsX3BhcmVudCkpICopKF9fX19fX19fcDEp
KTsgfSksIG5zKTsKIHJjdV9yZWFkX3VubG9jaygpOwoKIHJldHVybiBwaWQ7Cn0KCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBwaWRfdCB0YXNrX3BwaWRfbnIoY29uc3Qgc3RydWN0IHRhc2tfc3RydWN0ICp0c2sp
CnsKIHJldHVybiB0YXNrX3BwaWRfbnJfbnModHNrLCAmaW5pdF9waWRfbnMpOwp9CgoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIHBpZF90IHRhc2tfcGdycF9ucihzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRzaykKewog
cmV0dXJuIHRhc2tfcGdycF9ucl9ucyh0c2ssICZpbml0X3BpZF9ucyk7Cn0KCgoKCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSB1bnNpZ25lZCBpbnQgdGFza19zdGF0ZV9pbmRleChzdHJ1Y3QgdGFza19zdHJ1Y3Qg
KnRzaykKewogdW5zaWduZWQgaW50IHRza19zdGF0ZSA9ICh7IGRvIHsgZXh0ZXJuIHZvaWQg
X19jb21waWxldGltZV9hc3NlcnRfMTA4KHZvaWQpIF9fYXR0cmlidXRlX18oKF9fZXJyb3Jf
XygiVW5zdXBwb3J0ZWQgYWNjZXNzIHNpemUgZm9yIHtSRUFELFdSSVRFfV9PTkNFKCkuIikp
KTsgaWYgKCEoKHNpemVvZih0c2stPnN0YXRlKSA9PSBzaXplb2YoY2hhcikgfHwgc2l6ZW9m
KHRzay0+c3RhdGUpID09IHNpemVvZihzaG9ydCkgfHwgc2l6ZW9mKHRzay0+c3RhdGUpID09
IHNpemVvZihpbnQpIHx8IHNpemVvZih0c2stPnN0YXRlKSA9PSBzaXplb2YobG9uZykpIHx8
IHNpemVvZih0c2stPnN0YXRlKSA9PSBzaXplb2YobG9uZyBsb25nKSkpIF9fY29tcGlsZXRp
bWVfYXNzZXJ0XzEwOCgpOyB9IHdoaWxlICgwKTsgKHsgdHlwZW9mKCBfR2VuZXJpYygodHNr
LT5zdGF0ZSksIGNoYXI6IChjaGFyKTAsIHVuc2lnbmVkIGNoYXI6ICh1bnNpZ25lZCBjaGFy
KTAsIHNpZ25lZCBjaGFyOiAoc2lnbmVkIGNoYXIpMCwgdW5zaWduZWQgc2hvcnQ6ICh1bnNp
Z25lZCBzaG9ydCkwLCBzaWduZWQgc2hvcnQ6IChzaWduZWQgc2hvcnQpMCwgdW5zaWduZWQg
aW50OiAodW5zaWduZWQgaW50KTAsIHNpZ25lZCBpbnQ6IChzaWduZWQgaW50KTAsIHVuc2ln
bmVkIGxvbmc6ICh1bnNpZ25lZCBsb25nKTAsIHNpZ25lZCBsb25nOiAoc2lnbmVkIGxvbmcp
MCwgdW5zaWduZWQgbG9uZyBsb25nOiAodW5zaWduZWQgbG9uZyBsb25nKTAsIHNpZ25lZCBs
b25nIGxvbmc6IChzaWduZWQgbG9uZyBsb25nKTAsIGRlZmF1bHQ6ICh0c2stPnN0YXRlKSkp
IF9feCA9ICgqKGNvbnN0IHZvbGF0aWxlIHR5cGVvZiggX0dlbmVyaWMoKHRzay0+c3RhdGUp
LCBjaGFyOiAoY2hhcikwLCB1bnNpZ25lZCBjaGFyOiAodW5zaWduZWQgY2hhcikwLCBzaWdu
ZWQgY2hhcjogKHNpZ25lZCBjaGFyKTAsIHVuc2lnbmVkIHNob3J0OiAodW5zaWduZWQgc2hv
cnQpMCwgc2lnbmVkIHNob3J0OiAoc2lnbmVkIHNob3J0KTAsIHVuc2lnbmVkIGludDogKHVu
c2lnbmVkIGludCkwLCBzaWduZWQgaW50OiAoc2lnbmVkIGludCkwLCB1bnNpZ25lZCBsb25n
OiAodW5zaWduZWQgbG9uZykwLCBzaWduZWQgbG9uZzogKHNpZ25lZCBsb25nKTAsIHVuc2ln
bmVkIGxvbmcgbG9uZzogKHVuc2lnbmVkIGxvbmcgbG9uZykwLCBzaWduZWQgbG9uZyBsb25n
OiAoc2lnbmVkIGxvbmcgbG9uZykwLCBkZWZhdWx0OiAodHNrLT5zdGF0ZSkpKSAqKSYodHNr
LT5zdGF0ZSkpOyBkbyB7IH0gd2hpbGUgKDApOyAodHlwZW9mKHRzay0+c3RhdGUpKV9feDsg
fSk7IH0pOwogdW5zaWduZWQgaW50IHN0YXRlID0gKHRza19zdGF0ZSB8IHRzay0+ZXhpdF9z
dGF0ZSkgJiAoMHgwMDAwIHwgMHgwMDAxIHwgMHgwMDAyIHwgMHgwMDA0IHwgMHgwMDA4IHwg
MHgwMDEwIHwgMHgwMDIwIHwgMHgwMDQwKTsKCiBkbyB7IGV4dGVybiB2b2lkIF9fY29tcGls
ZXRpbWVfYXNzZXJ0XzEwOSh2b2lkKSBfX2F0dHJpYnV0ZV9fKChfX2Vycm9yX18oIkJVSUxE
X0JVR19PTiBmYWlsZWQ6ICIgIigoKCgweDAwMDAgfCAweDAwMDEgfCAweDAwMDIgfCAweDAw
MDQgfCAweDAwMDggfCAweDAwMTAgfCAweDAwMjAgfCAweDAwNDApICsgMSkgPDwgMSkpID09
IDAgfHwgKCgoKCgoMHgwMDAwIHwgMHgwMDAxIHwgMHgwMDAyIHwgMHgwMDA0IHwgMHgwMDA4
IHwgMHgwMDEwIHwgMHgwMDIwIHwgMHgwMDQwKSArIDEpIDw8IDEpKSAmICgoKCgoMHgwMDAw
IHwgMHgwMDAxIHwgMHgwMDAyIHwgMHgwMDA0IHwgMHgwMDA4IHwgMHgwMDEwIHwgMHgwMDIw
IHwgMHgwMDQwKSArIDEpIDw8IDEpKSAtIDEpKSAhPSAwKSIpKSk7IGlmICghKCEoKCgoKDB4
MDAwMCB8IDB4MDAwMSB8IDB4MDAwMiB8IDB4MDAwNCB8IDB4MDAwOCB8IDB4MDAxMCB8IDB4
MDAyMCB8IDB4MDA0MCkgKyAxKSA8PCAxKSkgPT0gMCB8fCAoKCgoKCgweDAwMDAgfCAweDAw
MDEgfCAweDAwMDIgfCAweDAwMDQgfCAweDAwMDggfCAweDAwMTAgfCAweDAwMjAgfCAweDAw
NDApICsgMSkgPDwgMSkpICYgKCgoKCgweDAwMDAgfCAweDAwMDEgfCAweDAwMDIgfCAweDAw
MDQgfCAweDAwMDggfCAweDAwMTAgfCAweDAwMjAgfCAweDAwNDApICsgMSkgPDwgMSkpIC0g
MSkpICE9IDApKSkpIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzEwOSgpOyB9IHdoaWxlICgwKTsK
CiBpZiAodHNrX3N0YXRlID09ICgweDAwMDIgfCAweDA0MDApKQogIHN0YXRlID0gKCgweDAw
MDAgfCAweDAwMDEgfCAweDAwMDIgfCAweDAwMDQgfCAweDAwMDggfCAweDAwMTAgfCAweDAw
MjAgfCAweDAwNDApICsgMSk7CgogcmV0dXJuIGZscyhzdGF0ZSk7Cn0KCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBj
aGFyIHRhc2tfaW5kZXhfdG9fY2hhcih1bnNpZ25lZCBpbnQgc3RhdGUpCnsKIHN0YXRpYyBj
b25zdCBjaGFyIHN0YXRlX2NoYXJbXSA9ICJSU0RUdFhaUEkiOwoKIGRvIHsgZXh0ZXJuIHZv
aWQgX19jb21waWxldGltZV9hc3NlcnRfMTEwKHZvaWQpIF9fYXR0cmlidXRlX18oKF9fZXJy
b3JfXygiQlVJTERfQlVHX09OIGZhaWxlZDogIiAiMSArIGlsb2cyKFRBU0tfUkVQT1JUX01B
WCkgIT0gc2l6ZW9mKHN0YXRlX2NoYXIpIC0gMSIpKSk7IGlmICghKCEoMSArICggX19idWls
dGluX2NvbnN0YW50X3AoKCgoMHgwMDAwIHwgMHgwMDAxIHwgMHgwMDAyIHwgMHgwMDA0IHwg
MHgwMDA4IHwgMHgwMDEwIHwgMHgwMDIwIHwgMHgwMDQwKSArIDEpIDw8IDEpKSA/ICggX19i
dWlsdGluX2NvbnN0YW50X3AoKCgoMHgwMDAwIHwgMHgwMDAxIHwgMHgwMDAyIHwgMHgwMDA0
IHwgMHgwMDA4IHwgMHgwMDEwIHwgMHgwMDIwIHwgMHgwMDQwKSArIDEpIDw8IDEpKSA/ICgg
KCgoKDB4MDAwMCB8IDB4MDAwMSB8IDB4MDAwMiB8IDB4MDAwNCB8IDB4MDAwOCB8IDB4MDAx
MCB8IDB4MDAyMCB8IDB4MDA0MCkgKyAxKSA8PCAxKSkgPCAyID8gMCA6ICgoKCgweDAwMDAg
fCAweDAwMDEgfCAweDAwMDIgfCAweDAwMDQgfCAweDAwMDggfCAweDAwMTAgfCAweDAwMjAg
fCAweDAwNDApICsgMSkgPDwgMSkpICYgKDFVTEwgPDwgNjMpID8gNjMgOiAoKCgoMHgwMDAw
IHwgMHgwMDAxIHwgMHgwMDAyIHwgMHgwMDA0IHwgMHgwMDA4IHwgMHgwMDEwIHwgMHgwMDIw
IHwgMHgwMDQwKSArIDEpIDw8IDEpKSAmICgxVUxMIDw8IDYyKSA/IDYyIDogKCgoKDB4MDAw
MCB8IDB4MDAwMSB8IDB4MDAwMiB8IDB4MDAwNCB8IDB4MDAwOCB8IDB4MDAxMCB8IDB4MDAy
MCB8IDB4MDA0MCkgKyAxKSA8PCAxKSkgJiAoMVVMTCA8PCA2MSkgPyA2MSA6ICgoKCgweDAw
MDAgfCAweDAwMDEgfCAweDAwMDIgfCAweDAwMDQgfCAweDAwMDggfCAweDAwMTAgfCAweDAw
MjAgfCAweDAwNDApICsgMSkgPDwgMSkpICYgKDFVTEwgPDwgNjApID8gNjAgOiAoKCgoMHgw
MDAwIHwgMHgwMDAxIHwgMHgwMDAyIHwgMHgwMDA0IHwgMHgwMDA4IHwgMHgwMDEwIHwgMHgw
MDIwIHwgMHgwMDQwKSArIDEpIDw8IDEpKSAmICgxVUxMIDw8IDU5KSA/IDU5IDogKCgoKDB4
MDAwMCB8IDB4MDAwMSB8IDB4MDAwMiB8IDB4MDAwNCB8IDB4MDAwOCB8IDB4MDAxMCB8IDB4
MDAyMCB8IDB4MDA0MCkgKyAxKSA8PCAxKSkgJiAoMVVMTCA8PCA1OCkgPyA1OCA6ICgoKCgw
eDAwMDAgfCAweDAwMDEgfCAweDAwMDIgfCAweDAwMDQgfCAweDAwMDggfCAweDAwMTAgfCAw
eDAwMjAgfCAweDAwNDApICsgMSkgPDwgMSkpICYgKDFVTEwgPDwgNTcpID8gNTcgOiAoKCgo
MHgwMDAwIHwgMHgwMDAxIHwgMHgwMDAyIHwgMHgwMDA0IHwgMHgwMDA4IHwgMHgwMDEwIHwg
MHgwMDIwIHwgMHgwMDQwKSArIDEpIDw8IDEpKSAmICgxVUxMIDw8IDU2KSA/IDU2IDogKCgo
KDB4MDAwMCB8IDB4MDAwMSB8IDB4MDAwMiB8IDB4MDAwNCB8IDB4MDAwOCB8IDB4MDAxMCB8
IDB4MDAyMCB8IDB4MDA0MCkgKyAxKSA8PCAxKSkgJiAoMVVMTCA8PCA1NSkgPyA1NSA6ICgo
KCgweDAwMDAgfCAweDAwMDEgfCAweDAwMDIgfCAweDAwMDQgfCAweDAwMDggfCAweDAwMTAg
fCAweDAwMjAgfCAweDAwNDApICsgMSkgPDwgMSkpICYgKDFVTEwgPDwgNTQpID8gNTQgOiAo
KCgoMHgwMDAwIHwgMHgwMDAxIHwgMHgwMDAyIHwgMHgwMDA0IHwgMHgwMDA4IHwgMHgwMDEw
IHwgMHgwMDIwIHwgMHgwMDQwKSArIDEpIDw8IDEpKSAmICgxVUxMIDw8IDUzKSA/IDUzIDog
KCgoKDB4MDAwMCB8IDB4MDAwMSB8IDB4MDAwMiB8IDB4MDAwNCB8IDB4MDAwOCB8IDB4MDAx
MCB8IDB4MDAyMCB8IDB4MDA0MCkgKyAxKSA8PCAxKSkgJiAoMVVMTCA8PCA1MikgPyA1MiA6
ICgoKCgweDAwMDAgfCAweDAwMDEgfCAweDAwMDIgfCAweDAwMDQgfCAweDAwMDggfCAweDAw
MTAgfCAweDAwMjAgfCAweDAwNDApICsgMSkgPDwgMSkpICYgKDFVTEwgPDwgNTEpID8gNTEg
OiAoKCgoMHgwMDAwIHwgMHgwMDAxIHwgMHgwMDAyIHwgMHgwMDA0IHwgMHgwMDA4IHwgMHgw
MDEwIHwgMHgwMDIwIHwgMHgwMDQwKSArIDEpIDw8IDEpKSAmICgxVUxMIDw8IDUwKSA/IDUw
IDogKCgoKDB4MDAwMCB8IDB4MDAwMSB8IDB4MDAwMiB8IDB4MDAwNCB8IDB4MDAwOCB8IDB4
MDAxMCB8IDB4MDAyMCB8IDB4MDA0MCkgKyAxKSA8PCAxKSkgJiAoMVVMTCA8PCA0OSkgPyA0
OSA6ICgoKCgweDAwMDAgfCAweDAwMDEgfCAweDAwMDIgfCAweDAwMDQgfCAweDAwMDggfCAw
eDAwMTAgfCAweDAwMjAgfCAweDAwNDApICsgMSkgPDwgMSkpICYgKDFVTEwgPDwgNDgpID8g
NDggOiAoKCgoMHgwMDAwIHwgMHgwMDAxIHwgMHgwMDAyIHwgMHgwMDA0IHwgMHgwMDA4IHwg
MHgwMDEwIHwgMHgwMDIwIHwgMHgwMDQwKSArIDEpIDw8IDEpKSAmICgxVUxMIDw8IDQ3KSA/
IDQ3IDogKCgoKDB4MDAwMCB8IDB4MDAwMSB8IDB4MDAwMiB8IDB4MDAwNCB8IDB4MDAwOCB8
IDB4MDAxMCB8IDB4MDAyMCB8IDB4MDA0MCkgKyAxKSA8PCAxKSkgJiAoMVVMTCA8PCA0Nikg
PyA0NiA6ICgoKCgweDAwMDAgfCAweDAwMDEgfCAweDAwMDIgfCAweDAwMDQgfCAweDAwMDgg
fCAweDAwMTAgfCAweDAwMjAgfCAweDAwNDApICsgMSkgPDwgMSkpICYgKDFVTEwgPDwgNDUp
ID8gNDUgOiAoKCgoMHgwMDAwIHwgMHgwMDAxIHwgMHgwMDAyIHwgMHgwMDA0IHwgMHgwMDA4
IHwgMHgwMDEwIHwgMHgwMDIwIHwgMHgwMDQwKSArIDEpIDw8IDEpKSAmICgxVUxMIDw8IDQ0
KSA/IDQ0IDogKCgoKDB4MDAwMCB8IDB4MDAwMSB8IDB4MDAwMiB8IDB4MDAwNCB8IDB4MDAw
OCB8IDB4MDAxMCB8IDB4MDAyMCB8IDB4MDA0MCkgKyAxKSA8PCAxKSkgJiAoMVVMTCA8PCA0
MykgPyA0MyA6ICgoKCgweDAwMDAgfCAweDAwMDEgfCAweDAwMDIgfCAweDAwMDQgfCAweDAw
MDggfCAweDAwMTAgfCAweDAwMjAgfCAweDAwNDApICsgMSkgPDwgMSkpICYgKDFVTEwgPDwg
NDIpID8gNDIgOiAoKCgoMHgwMDAwIHwgMHgwMDAxIHwgMHgwMDAyIHwgMHgwMDA0IHwgMHgw
MDA4IHwgMHgwMDEwIHwgMHgwMDIwIHwgMHgwMDQwKSArIDEpIDw8IDEpKSAmICgxVUxMIDw8
IDQxKSA/IDQxIDogKCgoKDB4MDAwMCB8IDB4MDAwMSB8IDB4MDAwMiB8IDB4MDAwNCB8IDB4
MDAwOCB8IDB4MDAxMCB8IDB4MDAyMCB8IDB4MDA0MCkgKyAxKSA8PCAxKSkgJiAoMVVMTCA8
PCA0MCkgPyA0MCA6ICgoKCgweDAwMDAgfCAweDAwMDEgfCAweDAwMDIgfCAweDAwMDQgfCAw
eDAwMDggfCAweDAwMTAgfCAweDAwMjAgfCAweDAwNDApICsgMSkgPDwgMSkpICYgKDFVTEwg
PDwgMzkpID8gMzkgOiAoKCgoMHgwMDAwIHwgMHgwMDAxIHwgMHgwMDAyIHwgMHgwMDA0IHwg
MHgwMDA4IHwgMHgwMDEwIHwgMHgwMDIwIHwgMHgwMDQwKSArIDEpIDw8IDEpKSAmICgxVUxM
IDw8IDM4KSA/IDM4IDogKCgoKDB4MDAwMCB8IDB4MDAwMSB8IDB4MDAwMiB8IDB4MDAwNCB8
IDB4MDAwOCB8IDB4MDAxMCB8IDB4MDAyMCB8IDB4MDA0MCkgKyAxKSA8PCAxKSkgJiAoMVVM
TCA8PCAzNykgPyAzNyA6ICgoKCgweDAwMDAgfCAweDAwMDEgfCAweDAwMDIgfCAweDAwMDQg
fCAweDAwMDggfCAweDAwMTAgfCAweDAwMjAgfCAweDAwNDApICsgMSkgPDwgMSkpICYgKDFV
TEwgPDwgMzYpID8gMzYgOiAoKCgoMHgwMDAwIHwgMHgwMDAxIHwgMHgwMDAyIHwgMHgwMDA0
IHwgMHgwMDA4IHwgMHgwMDEwIHwgMHgwMDIwIHwgMHgwMDQwKSArIDEpIDw8IDEpKSAmICgx
VUxMIDw8IDM1KSA/IDM1IDogKCgoKDB4MDAwMCB8IDB4MDAwMSB8IDB4MDAwMiB8IDB4MDAw
NCB8IDB4MDAwOCB8IDB4MDAxMCB8IDB4MDAyMCB8IDB4MDA0MCkgKyAxKSA8PCAxKSkgJiAo
MVVMTCA8PCAzNCkgPyAzNCA6ICgoKCgweDAwMDAgfCAweDAwMDEgfCAweDAwMDIgfCAweDAw
MDQgfCAweDAwMDggfCAweDAwMTAgfCAweDAwMjAgfCAweDAwNDApICsgMSkgPDwgMSkpICYg
KDFVTEwgPDwgMzMpID8gMzMgOiAoKCgoMHgwMDAwIHwgMHgwMDAxIHwgMHgwMDAyIHwgMHgw
MDA0IHwgMHgwMDA4IHwgMHgwMDEwIHwgMHgwMDIwIHwgMHgwMDQwKSArIDEpIDw8IDEpKSAm
ICgxVUxMIDw8IDMyKSA/IDMyIDogKCgoKDB4MDAwMCB8IDB4MDAwMSB8IDB4MDAwMiB8IDB4
MDAwNCB8IDB4MDAwOCB8IDB4MDAxMCB8IDB4MDAyMCB8IDB4MDA0MCkgKyAxKSA8PCAxKSkg
JiAoMVVMTCA8PCAzMSkgPyAzMSA6ICgoKCgweDAwMDAgfCAweDAwMDEgfCAweDAwMDIgfCAw
eDAwMDQgfCAweDAwMDggfCAweDAwMTAgfCAweDAwMjAgfCAweDAwNDApICsgMSkgPDwgMSkp
ICYgKDFVTEwgPDwgMzApID8gMzAgOiAoKCgoMHgwMDAwIHwgMHgwMDAxIHwgMHgwMDAyIHwg
MHgwMDA0IHwgMHgwMDA4IHwgMHgwMDEwIHwgMHgwMDIwIHwgMHgwMDQwKSArIDEpIDw8IDEp
KSAmICgxVUxMIDw8IDI5KSA/IDI5IDogKCgoKDB4MDAwMCB8IDB4MDAwMSB8IDB4MDAwMiB8
IDB4MDAwNCB8IDB4MDAwOCB8IDB4MDAxMCB8IDB4MDAyMCB8IDB4MDA0MCkgKyAxKSA8PCAx
KSkgJiAoMVVMTCA8PCAyOCkgPyAyOCA6ICgoKCgweDAwMDAgfCAweDAwMDEgfCAweDAwMDIg
fCAweDAwMDQgfCAweDAwMDggfCAweDAwMTAgfCAweDAwMjAgfCAweDAwNDApICsgMSkgPDwg
MSkpICYgKDFVTEwgPDwgMjcpID8gMjcgOiAoKCgoMHgwMDAwIHwgMHgwMDAxIHwgMHgwMDAy
IHwgMHgwMDA0IHwgMHgwMDA4IHwgMHgwMDEwIHwgMHgwMDIwIHwgMHgwMDQwKSArIDEpIDw8
IDEpKSAmICgxVUxMIDw8IDI2KSA/IDI2IDogKCgoKDB4MDAwMCB8IDB4MDAwMSB8IDB4MDAw
MiB8IDB4MDAwNCB8IDB4MDAwOCB8IDB4MDAxMCB8IDB4MDAyMCB8IDB4MDA0MCkgKyAxKSA8
PCAxKSkgJiAoMVVMTCA8PCAyNSkgPyAyNSA6ICgoKCgweDAwMDAgfCAweDAwMDEgfCAweDAw
MDIgfCAweDAwMDQgfCAweDAwMDggfCAweDAwMTAgfCAweDAwMjAgfCAweDAwNDApICsgMSkg
PDwgMSkpICYgKDFVTEwgPDwgMjQpID8gMjQgOiAoKCgoMHgwMDAwIHwgMHgwMDAxIHwgMHgw
MDAyIHwgMHgwMDA0IHwgMHgwMDA4IHwgMHgwMDEwIHwgMHgwMDIwIHwgMHgwMDQwKSArIDEp
IDw8IDEpKSAmICgxVUxMIDw8IDIzKSA/IDIzIDogKCgoKDB4MDAwMCB8IDB4MDAwMSB8IDB4
MDAwMiB8IDB4MDAwNCB8IDB4MDAwOCB8IDB4MDAxMCB8IDB4MDAyMCB8IDB4MDA0MCkgKyAx
KSA8PCAxKSkgJiAoMVVMTCA8PCAyMikgPyAyMiA6ICgoKCgweDAwMDAgfCAweDAwMDEgfCAw
eDAwMDIgfCAweDAwMDQgfCAweDAwMDggfCAweDAwMTAgfCAweDAwMjAgfCAweDAwNDApICsg
MSkgPDwgMSkpICYgKDFVTEwgPDwgMjEpID8gMjEgOiAoKCgoMHgwMDAwIHwgMHgwMDAxIHwg
MHgwMDAyIHwgMHgwMDA0IHwgMHgwMDA4IHwgMHgwMDEwIHwgMHgwMDIwIHwgMHgwMDQwKSAr
IDEpIDw8IDEpKSAmICgxVUxMIDw8IDIwKSA/IDIwIDogKCgoKDB4MDAwMCB8IDB4MDAwMSB8
IDB4MDAwMiB8IDB4MDAwNCB8IDB4MDAwOCB8IDB4MDAxMCB8IDB4MDAyMCB8IDB4MDA0MCkg
KyAxKSA8PCAxKSkgJiAoMVVMTCA8PCAxOSkgPyAxOSA6ICgoKCgweDAwMDAgfCAweDAwMDEg
fCAweDAwMDIgfCAweDAwMDQgfCAweDAwMDggfCAweDAwMTAgfCAweDAwMjAgfCAweDAwNDAp
ICsgMSkgPDwgMSkpICYgKDFVTEwgPDwgMTgpID8gMTggOiAoKCgoMHgwMDAwIHwgMHgwMDAx
IHwgMHgwMDAyIHwgMHgwMDA0IHwgMHgwMDA4IHwgMHgwMDEwIHwgMHgwMDIwIHwgMHgwMDQw
KSArIDEpIDw8IDEpKSAmICgxVUxMIDw8IDE3KSA/IDE3IDogKCgoKDB4MDAwMCB8IDB4MDAw
MSB8IDB4MDAwMiB8IDB4MDAwNCB8IDB4MDAwOCB8IDB4MDAxMCB8IDB4MDAyMCB8IDB4MDA0
MCkgKyAxKSA8PCAxKSkgJiAoMVVMTCA8PCAxNikgPyAxNiA6ICgoKCgweDAwMDAgfCAweDAw
MDEgfCAweDAwMDIgfCAweDAwMDQgfCAweDAwMDggfCAweDAwMTAgfCAweDAwMjAgfCAweDAw
NDApICsgMSkgPDwgMSkpICYgKDFVTEwgPDwgMTUpID8gMTUgOiAoKCgoMHgwMDAwIHwgMHgw
MDAxIHwgMHgwMDAyIHwgMHgwMDA0IHwgMHgwMDA4IHwgMHgwMDEwIHwgMHgwMDIwIHwgMHgw
MDQwKSArIDEpIDw8IDEpKSAmICgxVUxMIDw8IDE0KSA/IDE0IDogKCgoKDB4MDAwMCB8IDB4
MDAwMSB8IDB4MDAwMiB8IDB4MDAwNCB8IDB4MDAwOCB8IDB4MDAxMCB8IDB4MDAyMCB8IDB4
MDA0MCkgKyAxKSA8PCAxKSkgJiAoMVVMTCA8PCAxMykgPyAxMyA6ICgoKCgweDAwMDAgfCAw
eDAwMDEgfCAweDAwMDIgfCAweDAwMDQgfCAweDAwMDggfCAweDAwMTAgfCAweDAwMjAgfCAw
eDAwNDApICsgMSkgPDwgMSkpICYgKDFVTEwgPDwgMTIpID8gMTIgOiAoKCgoMHgwMDAwIHwg
MHgwMDAxIHwgMHgwMDAyIHwgMHgwMDA0IHwgMHgwMDA4IHwgMHgwMDEwIHwgMHgwMDIwIHwg
MHgwMDQwKSArIDEpIDw8IDEpKSAmICgxVUxMIDw8IDExKSA/IDExIDogKCgoKDB4MDAwMCB8
IDB4MDAwMSB8IDB4MDAwMiB8IDB4MDAwNCB8IDB4MDAwOCB8IDB4MDAxMCB8IDB4MDAyMCB8
IDB4MDA0MCkgKyAxKSA8PCAxKSkgJiAoMVVMTCA8PCAxMCkgPyAxMCA6ICgoKCgweDAwMDAg
fCAweDAwMDEgfCAweDAwMDIgfCAweDAwMDQgfCAweDAwMDggfCAweDAwMTAgfCAweDAwMjAg
fCAweDAwNDApICsgMSkgPDwgMSkpICYgKDFVTEwgPDwgOSkgPyA5IDogKCgoKDB4MDAwMCB8
IDB4MDAwMSB8IDB4MDAwMiB8IDB4MDAwNCB8IDB4MDAwOCB8IDB4MDAxMCB8IDB4MDAyMCB8
IDB4MDA0MCkgKyAxKSA8PCAxKSkgJiAoMVVMTCA8PCA4KSA/IDggOiAoKCgoMHgwMDAwIHwg
MHgwMDAxIHwgMHgwMDAyIHwgMHgwMDA0IHwgMHgwMDA4IHwgMHgwMDEwIHwgMHgwMDIwIHwg
MHgwMDQwKSArIDEpIDw8IDEpKSAmICgxVUxMIDw8IDcpID8gNyA6ICgoKCgweDAwMDAgfCAw
eDAwMDEgfCAweDAwMDIgfCAweDAwMDQgfCAweDAwMDggfCAweDAwMTAgfCAweDAwMjAgfCAw
eDAwNDApICsgMSkgPDwgMSkpICYgKDFVTEwgPDwgNikgPyA2IDogKCgoKDB4MDAwMCB8IDB4
MDAwMSB8IDB4MDAwMiB8IDB4MDAwNCB8IDB4MDAwOCB8IDB4MDAxMCB8IDB4MDAyMCB8IDB4
MDA0MCkgKyAxKSA8PCAxKSkgJiAoMVVMTCA8PCA1KSA/IDUgOiAoKCgoMHgwMDAwIHwgMHgw
MDAxIHwgMHgwMDAyIHwgMHgwMDA0IHwgMHgwMDA4IHwgMHgwMDEwIHwgMHgwMDIwIHwgMHgw
MDQwKSArIDEpIDw8IDEpKSAmICgxVUxMIDw8IDQpID8gNCA6ICgoKCgweDAwMDAgfCAweDAw
MDEgfCAweDAwMDIgfCAweDAwMDQgfCAweDAwMDggfCAweDAwMTAgfCAweDAwMjAgfCAweDAw
NDApICsgMSkgPDwgMSkpICYgKDFVTEwgPDwgMykgPyAzIDogKCgoKDB4MDAwMCB8IDB4MDAw
MSB8IDB4MDAwMiB8IDB4MDAwNCB8IDB4MDAwOCB8IDB4MDAxMCB8IDB4MDAyMCB8IDB4MDA0
MCkgKyAxKSA8PCAxKSkgJiAoMVVMTCA8PCAyKSA/IDIgOiAxKSA6IC0xKSA6IChzaXplb2Yo
KCgoMHgwMDAwIHwgMHgwMDAxIHwgMHgwMDAyIHwgMHgwMDA0IHwgMHgwMDA4IHwgMHgwMDEw
IHwgMHgwMDIwIHwgMHgwMDQwKSArIDEpIDw8IDEpKSA8PSA0KSA/IF9faWxvZzJfdTMyKCgo
KDB4MDAwMCB8IDB4MDAwMSB8IDB4MDAwMiB8IDB4MDAwNCB8IDB4MDAwOCB8IDB4MDAxMCB8
IDB4MDAyMCB8IDB4MDA0MCkgKyAxKSA8PCAxKSkgOiBfX2lsb2cyX3U2NCgoKCgweDAwMDAg
fCAweDAwMDEgfCAweDAwMDIgfCAweDAwMDQgfCAweDAwMDggfCAweDAwMTAgfCAweDAwMjAg
fCAweDAwNDApICsgMSkgPDwgMSkpICkgIT0gc2l6ZW9mKHN0YXRlX2NoYXIpIC0gMSkpKSBf
X2NvbXBpbGV0aW1lX2Fzc2VydF8xMTAoKTsgfSB3aGlsZSAoMCk7CgogcmV0dXJuIHN0YXRl
X2NoYXJbc3RhdGVdOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgY2hhciB0YXNrX3N0YXRlX3RvX2NoYXIoc3Ry
dWN0IHRhc2tfc3RydWN0ICp0c2spCnsKIHJldHVybiB0YXNrX2luZGV4X3RvX2NoYXIodGFz
a19zdGF0ZV9pbmRleCh0c2spKTsKfQojIDE0ODAgIi4vaW5jbHVkZS9saW51eC9zY2hlZC5o
IgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgaW50IGlzX2dsb2JhbF9pbml0KHN0cnVjdCB0YXNrX3N0cnVjdCAqdHNr
KQp7CiByZXR1cm4gdGFza190Z2lkX25yKHRzaykgPT0gMTsKfQoKZXh0ZXJuIHN0cnVjdCBw
aWQgKmNhZF9waWQ7CiMgMTU0OSAiLi9pbmNsdWRlL2xpbnV4L3NjaGVkLmgiCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBib29sIGlzX3BlcmNwdV90aHJlYWQodm9pZCkKewoKIHJldHVybiAoZ2V0X2N1cnJlbnQo
KS0+ZmxhZ3MgJiAweDA0MDAwMDAwKSAmJgogIChnZXRfY3VycmVudCgpLT5ucl9jcHVzX2Fs
bG93ZWQgPT0gMSk7CgoKCn0KIyAxNTgxICIuL2luY2x1ZGUvbGludXgvc2NoZWQuaCIKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIGJvb2wgdGFza19ub19uZXdfcHJpdnMoc3RydWN0IHRhc2tfc3RydWN0ICpwKSB7
IHJldHVybiB0ZXN0X2JpdCgwLCAmcC0+YXRvbWljX2ZsYWdzKTsgfQpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9p
ZCB0YXNrX3NldF9ub19uZXdfcHJpdnMoc3RydWN0IHRhc2tfc3RydWN0ICpwKSB7IHNldF9i
aXQoMCwgJnAtPmF0b21pY19mbGFncyk7IH0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIHRhc2tfc3ByZWFk
X3BhZ2Uoc3RydWN0IHRhc2tfc3RydWN0ICpwKSB7IHJldHVybiB0ZXN0X2JpdCgxLCAmcC0+
YXRvbWljX2ZsYWdzKTsgfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCB0YXNrX3NldF9zcHJlYWRfcGFnZShz
dHJ1Y3QgdGFza19zdHJ1Y3QgKnApIHsgc2V0X2JpdCgxLCAmcC0+YXRvbWljX2ZsYWdzKTsg
fQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgdm9pZCB0YXNrX2NsZWFyX3NwcmVhZF9wYWdlKHN0cnVjdCB0YXNrX3N0
cnVjdCAqcCkgeyBjbGVhcl9iaXQoMSwgJnAtPmF0b21pY19mbGFncyk7IH0KCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBib29sIHRhc2tfc3ByZWFkX3NsYWIoc3RydWN0IHRhc2tfc3RydWN0ICpwKSB7IHJldHVy
biB0ZXN0X2JpdCgyLCAmcC0+YXRvbWljX2ZsYWdzKTsgfQpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCB0YXNr
X3NldF9zcHJlYWRfc2xhYihzdHJ1Y3QgdGFza19zdHJ1Y3QgKnApIHsgc2V0X2JpdCgyLCAm
cC0+YXRvbWljX2ZsYWdzKTsgfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCB0YXNrX2NsZWFyX3NwcmVhZF9z
bGFiKHN0cnVjdCB0YXNrX3N0cnVjdCAqcCkgeyBjbGVhcl9iaXQoMiwgJnAtPmF0b21pY19m
bGFncyk7IH0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIHRhc2tfc3BlY19zc2JfZGlzYWJsZShzdHJ1Y3Qg
dGFza19zdHJ1Y3QgKnApIHsgcmV0dXJuIHRlc3RfYml0KDMsICZwLT5hdG9taWNfZmxhZ3Mp
OyB9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSB2b2lkIHRhc2tfc2V0X3NwZWNfc3NiX2Rpc2FibGUoc3RydWN0IHRh
c2tfc3RydWN0ICpwKSB7IHNldF9iaXQoMywgJnAtPmF0b21pY19mbGFncyk7IH0Kc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIHZvaWQgdGFza19jbGVhcl9zcGVjX3NzYl9kaXNhYmxlKHN0cnVjdCB0YXNrX3N0cnVj
dCAqcCkgeyBjbGVhcl9iaXQoMywgJnAtPmF0b21pY19mbGFncyk7IH0KCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBi
b29sIHRhc2tfc3BlY19zc2Jfbm9leGVjKHN0cnVjdCB0YXNrX3N0cnVjdCAqcCkgeyByZXR1
cm4gdGVzdF9iaXQoNywgJnAtPmF0b21pY19mbGFncyk7IH0Kc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgdGFz
a19zZXRfc3BlY19zc2Jfbm9leGVjKHN0cnVjdCB0YXNrX3N0cnVjdCAqcCkgeyBzZXRfYml0
KDcsICZwLT5hdG9taWNfZmxhZ3MpOyB9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHRhc2tfY2xlYXJfc3Bl
Y19zc2Jfbm9leGVjKHN0cnVjdCB0YXNrX3N0cnVjdCAqcCkgeyBjbGVhcl9iaXQoNywgJnAt
PmF0b21pY19mbGFncyk7IH0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIHRhc2tfc3BlY19zc2JfZm9yY2Vf
ZGlzYWJsZShzdHJ1Y3QgdGFza19zdHJ1Y3QgKnApIHsgcmV0dXJuIHRlc3RfYml0KDQsICZw
LT5hdG9taWNfZmxhZ3MpOyB9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHRhc2tfc2V0X3NwZWNfc3NiX2Zv
cmNlX2Rpc2FibGUoc3RydWN0IHRhc2tfc3RydWN0ICpwKSB7IHNldF9iaXQoNCwgJnAtPmF0
b21pY19mbGFncyk7IH0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIHRhc2tfc3BlY19pYl9kaXNhYmxlKHN0
cnVjdCB0YXNrX3N0cnVjdCAqcCkgeyByZXR1cm4gdGVzdF9iaXQoNSwgJnAtPmF0b21pY19m
bGFncyk7IH0Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgdGFza19zZXRfc3BlY19pYl9kaXNhYmxlKHN0cnVj
dCB0YXNrX3N0cnVjdCAqcCkgeyBzZXRfYml0KDUsICZwLT5hdG9taWNfZmxhZ3MpOyB9CnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSB2b2lkIHRhc2tfY2xlYXJfc3BlY19pYl9kaXNhYmxlKHN0cnVjdCB0YXNrX3N0
cnVjdCAqcCkgeyBjbGVhcl9iaXQoNSwgJnAtPmF0b21pY19mbGFncyk7IH0KCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBib29sIHRhc2tfc3BlY19pYl9mb3JjZV9kaXNhYmxlKHN0cnVjdCB0YXNrX3N0cnVjdCAq
cCkgeyByZXR1cm4gdGVzdF9iaXQoNiwgJnAtPmF0b21pY19mbGFncyk7IH0Kc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IHZvaWQgdGFza19zZXRfc3BlY19pYl9mb3JjZV9kaXNhYmxlKHN0cnVjdCB0YXNrX3N0cnVj
dCAqcCkgeyBzZXRfYml0KDYsICZwLT5hdG9taWNfZmxhZ3MpOyB9CgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9p
ZApjdXJyZW50X3Jlc3RvcmVfZmxhZ3ModW5zaWduZWQgbG9uZyBvcmlnX2ZsYWdzLCB1bnNp
Z25lZCBsb25nIGZsYWdzKQp7CiBnZXRfY3VycmVudCgpLT5mbGFncyAmPSB+ZmxhZ3M7CiBn
ZXRfY3VycmVudCgpLT5mbGFncyB8PSBvcmlnX2ZsYWdzICYgZmxhZ3M7Cn0KCmV4dGVybiBp
bnQgY3B1c2V0X2NwdW1hc2tfY2FuX3Nocmluayhjb25zdCBzdHJ1Y3QgY3B1bWFzayAqY3Vy
LCBjb25zdCBzdHJ1Y3QgY3B1bWFzayAqdHJpYWwpOwpleHRlcm4gaW50IHRhc2tfY2FuX2F0
dGFjaChzdHJ1Y3QgdGFza19zdHJ1Y3QgKnAsIGNvbnN0IHN0cnVjdCBjcHVtYXNrICpjc19j
cHVzX2FsbG93ZWQpOwoKZXh0ZXJuIHZvaWQgZG9fc2V0X2NwdXNfYWxsb3dlZChzdHJ1Y3Qg
dGFza19zdHJ1Y3QgKnAsIGNvbnN0IHN0cnVjdCBjcHVtYXNrICpuZXdfbWFzayk7CmV4dGVy
biBpbnQgc2V0X2NwdXNfYWxsb3dlZF9wdHIoc3RydWN0IHRhc2tfc3RydWN0ICpwLCBjb25z
dCBzdHJ1Y3QgY3B1bWFzayAqbmV3X21hc2spOwojIDE2MzQgIi4vaW5jbHVkZS9saW51eC9z
Y2hlZC5oIgpleHRlcm4gaW50IHlpZWxkX3RvKHN0cnVjdCB0YXNrX3N0cnVjdCAqcCwgYm9v
bCBwcmVlbXB0KTsKZXh0ZXJuIHZvaWQgc2V0X3VzZXJfbmljZShzdHJ1Y3QgdGFza19zdHJ1
Y3QgKnAsIGxvbmcgbmljZSk7CmV4dGVybiBpbnQgdGFza19wcmlvKGNvbnN0IHN0cnVjdCB0
YXNrX3N0cnVjdCAqcCk7CgoKCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHRhc2tfbmljZShjb25zdCBz
dHJ1Y3QgdGFza19zdHJ1Y3QgKnApCnsKIHJldHVybiAoKChwKS0+c3RhdGljX3ByaW8pIC0g
KDEwMCArICgxOSAtIC0yMCArIDEpIC8gMikpOwp9CgpleHRlcm4gaW50IGNhbl9uaWNlKGNv
bnN0IHN0cnVjdCB0YXNrX3N0cnVjdCAqcCwgY29uc3QgaW50IG5pY2UpOwpleHRlcm4gaW50
IHRhc2tfY3Vycihjb25zdCBzdHJ1Y3QgdGFza19zdHJ1Y3QgKnApOwpleHRlcm4gaW50IGlk
bGVfY3B1KGludCBjcHUpOwpleHRlcm4gaW50IGF2YWlsYWJsZV9pZGxlX2NwdShpbnQgY3B1
KTsKZXh0ZXJuIGludCBzY2hlZF9zZXRzY2hlZHVsZXIoc3RydWN0IHRhc2tfc3RydWN0ICos
IGludCwgY29uc3Qgc3RydWN0IHNjaGVkX3BhcmFtICopOwpleHRlcm4gaW50IHNjaGVkX3Nl
dHNjaGVkdWxlcl9ub2NoZWNrKHN0cnVjdCB0YXNrX3N0cnVjdCAqLCBpbnQsIGNvbnN0IHN0
cnVjdCBzY2hlZF9wYXJhbSAqKTsKZXh0ZXJuIGludCBzY2hlZF9zZXRhdHRyKHN0cnVjdCB0
YXNrX3N0cnVjdCAqLCBjb25zdCBzdHJ1Y3Qgc2NoZWRfYXR0ciAqKTsKZXh0ZXJuIGludCBz
Y2hlZF9zZXRhdHRyX25vY2hlY2soc3RydWN0IHRhc2tfc3RydWN0ICosIGNvbnN0IHN0cnVj
dCBzY2hlZF9hdHRyICopOwpleHRlcm4gc3RydWN0IHRhc2tfc3RydWN0ICppZGxlX3Rhc2so
aW50IGNwdSk7CgoKCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBpc19pZGxlX3Rhc2soY29uc3Qgc3Ry
dWN0IHRhc2tfc3RydWN0ICpwKQp7CiByZXR1cm4gISEocC0+ZmxhZ3MgJiAweDAwMDAwMDAy
KTsKfQoKZXh0ZXJuIHN0cnVjdCB0YXNrX3N0cnVjdCAqY3Vycl90YXNrKGludCBjcHUpOwpl
eHRlcm4gdm9pZCBpYTY0X3NldF9jdXJyX3Rhc2soaW50IGNwdSwgc3RydWN0IHRhc2tfc3Ry
dWN0ICpwKTsKCnZvaWQgeWllbGQodm9pZCk7Cgp1bmlvbiB0aHJlYWRfdW5pb24gewoKIHN0
cnVjdCB0YXNrX3N0cnVjdCB0YXNrOwoKCgoKIHVuc2lnbmVkIGxvbmcgc3RhY2tbKDEgPDwg
MTQpL3NpemVvZihsb25nKV07Cn07CgoKCgoKZXh0ZXJuIHVuc2lnbmVkIGxvbmcgaW5pdF9z
dGFja1soMSA8PCAxNCkgLyBzaXplb2YodW5zaWduZWQgbG9uZyldOwoKCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBz
dHJ1Y3QgdGhyZWFkX2luZm8gKnRhc2tfdGhyZWFkX2luZm8oc3RydWN0IHRhc2tfc3RydWN0
ICp0YXNrKQp7CiByZXR1cm4gJnRhc2stPnRocmVhZF9pbmZvOwp9CiMgMTcxMSAiLi9pbmNs
dWRlL2xpbnV4L3NjaGVkLmgiCmV4dGVybiBzdHJ1Y3QgdGFza19zdHJ1Y3QgKmZpbmRfdGFz
a19ieV92cGlkKHBpZF90IG5yKTsKZXh0ZXJuIHN0cnVjdCB0YXNrX3N0cnVjdCAqZmluZF90
YXNrX2J5X3BpZF9ucyhwaWRfdCBuciwgc3RydWN0IHBpZF9uYW1lc3BhY2UgKm5zKTsKCgoK
CmV4dGVybiBzdHJ1Y3QgdGFza19zdHJ1Y3QgKmZpbmRfZ2V0X3Rhc2tfYnlfdnBpZChwaWRf
dCBucik7CgpleHRlcm4gaW50IHdha2VfdXBfc3RhdGUoc3RydWN0IHRhc2tfc3RydWN0ICp0
c2ssIHVuc2lnbmVkIGludCBzdGF0ZSk7CmV4dGVybiBpbnQgd2FrZV91cF9wcm9jZXNzKHN0
cnVjdCB0YXNrX3N0cnVjdCAqdHNrKTsKZXh0ZXJuIHZvaWQgd2FrZV91cF9uZXdfdGFzayhz
dHJ1Y3QgdGFza19zdHJ1Y3QgKnRzayk7CgoKZXh0ZXJuIHZvaWQga2lja19wcm9jZXNzKHN0
cnVjdCB0YXNrX3N0cnVjdCAqdHNrKTsKCgoKCmV4dGVybiB2b2lkIF9fc2V0X3Rhc2tfY29t
bShzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRzaywgY29uc3QgY2hhciAqZnJvbSwgYm9vbCBleGVj
KTsKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSB2b2lkIHNldF90YXNrX2NvbW0oc3RydWN0IHRhc2tfc3RydWN0ICp0
c2ssIGNvbnN0IGNoYXIgKmZyb20pCnsKIF9fc2V0X3Rhc2tfY29tbSh0c2ssIGZyb20sIGZh
bHNlKTsKfQoKZXh0ZXJuIGNoYXIgKl9fZ2V0X3Rhc2tfY29tbShjaGFyICp0bywgc2l6ZV90
IGxlbiwgc3RydWN0IHRhc2tfc3RydWN0ICp0c2spOwoKCgoKCgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRy
aWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB2b2lkIHNjaGVkdWxlcl9pcGkodm9pZCkK
ewoKCgoKCiBkbyB7IGlmICh0ZXN0X3RpX3RocmVhZF9mbGFnKCgoc3RydWN0IHRocmVhZF9p
bmZvICopZ2V0X2N1cnJlbnQoKSksIDIpKSBzZXRfcHJlZW1wdF9uZWVkX3Jlc2NoZWQoKTsg
fSB3aGlsZSAoMCk7Cn0KZXh0ZXJuIHVuc2lnbmVkIGxvbmcgd2FpdF90YXNrX2luYWN0aXZl
KHN0cnVjdCB0YXNrX3N0cnVjdCAqLCBsb25nIG1hdGNoX3N0YXRlKTsKIyAxNzY1ICIuL2lu
Y2x1ZGUvbGludXgvc2NoZWQuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgc2V0X3Rza190aHJlYWRfZmxh
ZyhzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRzaywgaW50IGZsYWcpCnsKIHNldF90aV90aHJlYWRf
ZmxhZyh0YXNrX3RocmVhZF9pbmZvKHRzayksIGZsYWcpOwp9CgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBj
bGVhcl90c2tfdGhyZWFkX2ZsYWcoc3RydWN0IHRhc2tfc3RydWN0ICp0c2ssIGludCBmbGFn
KQp7CiBjbGVhcl90aV90aHJlYWRfZmxhZyh0YXNrX3RocmVhZF9pbmZvKHRzayksIGZsYWcp
Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgdm9pZCB1cGRhdGVfdHNrX3RocmVhZF9mbGFnKHN0cnVjdCB0YXNr
X3N0cnVjdCAqdHNrLCBpbnQgZmxhZywKICAgICAgIGJvb2wgdmFsdWUpCnsKIHVwZGF0ZV90
aV90aHJlYWRfZmxhZyh0YXNrX3RocmVhZF9pbmZvKHRzayksIGZsYWcsIHZhbHVlKTsKfQoK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIGludCB0ZXN0X2FuZF9zZXRfdHNrX3RocmVhZF9mbGFnKHN0cnVjdCB0YXNr
X3N0cnVjdCAqdHNrLCBpbnQgZmxhZykKewogcmV0dXJuIHRlc3RfYW5kX3NldF90aV90aHJl
YWRfZmxhZyh0YXNrX3RocmVhZF9pbmZvKHRzayksIGZsYWcpOwp9CgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50
IHRlc3RfYW5kX2NsZWFyX3Rza190aHJlYWRfZmxhZyhzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRz
aywgaW50IGZsYWcpCnsKIHJldHVybiB0ZXN0X2FuZF9jbGVhcl90aV90aHJlYWRfZmxhZyh0
YXNrX3RocmVhZF9pbmZvKHRzayksIGZsYWcpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHRlc3RfdHNr
X3RocmVhZF9mbGFnKHN0cnVjdCB0YXNrX3N0cnVjdCAqdHNrLCBpbnQgZmxhZykKewogcmV0
dXJuIHRlc3RfdGlfdGhyZWFkX2ZsYWcodGFza190aHJlYWRfaW5mbyh0c2spLCBmbGFnKTsK
fQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIHZvaWQgc2V0X3Rza19uZWVkX3Jlc2NoZWQoc3RydWN0IHRhc2tfc3Ry
dWN0ICp0c2spCnsKIHNldF90c2tfdGhyZWFkX2ZsYWcodHNrLDIpOwp9CgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
dm9pZCBjbGVhcl90c2tfbmVlZF9yZXNjaGVkKHN0cnVjdCB0YXNrX3N0cnVjdCAqdHNrKQp7
CiBjbGVhcl90c2tfdGhyZWFkX2ZsYWcodHNrLDIpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHRlc3Rf
dHNrX25lZWRfcmVzY2hlZChzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRzaykKewogcmV0dXJuIF9f
YnVpbHRpbl9leHBlY3QoISEodGVzdF90c2tfdGhyZWFkX2ZsYWcodHNrLDIpKSwgMCk7Cn0K
IyAxODE4ICIuL2luY2x1ZGUvbGludXgvc2NoZWQuaCIKZXh0ZXJuIGludCBfY29uZF9yZXNj
aGVkKHZvaWQpOwojIDE4MjggIi4vaW5jbHVkZS9saW51eC9zY2hlZC5oIgpleHRlcm4gaW50
IF9fY29uZF9yZXNjaGVkX2xvY2soc3BpbmxvY2tfdCAqbG9jayk7CgoKCgoKCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSB2b2lkIGNvbmRfcmVzY2hlZF9yY3Uodm9pZCkKewoKIHJjdV9yZWFkX3VubG9jaygpOwog
KHsgX19fbWlnaHRfc2xlZXAoIi4vaW5jbHVkZS9saW51eC9zY2hlZC5oIiwgMTgzOSwgMCk7
IF9jb25kX3Jlc2NoZWQoKTsgfSk7CiByY3VfcmVhZF9sb2NrKCk7Cgp9CgoKCgoKCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBpbnQgc3Bpbl9uZWVkYnJlYWsoc3BpbmxvY2tfdCAqbG9jaykKewoKCgogcmV0dXJu
IDA7Cgp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBi
b29sIG5lZWRfcmVzY2hlZCh2b2lkKQp7CiByZXR1cm4gX19idWlsdGluX2V4cGVjdCghISh0
ZXN0X3RpX3RocmVhZF9mbGFnKCgoc3RydWN0IHRocmVhZF9pbmZvICopZ2V0X2N1cnJlbnQo
KSksIDIpKSwgMCk7Cn0KCgoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHVuc2lnbmVkIGludCB0YXNrX2NwdShj
b25zdCBzdHJ1Y3QgdGFza19zdHJ1Y3QgKnApCnsKCiByZXR1cm4gKHsgZG8geyBleHRlcm4g
dm9pZCBfX2NvbXBpbGV0aW1lX2Fzc2VydF8xMTEodm9pZCkgX19hdHRyaWJ1dGVfXygoX19l
cnJvcl9fKCJVbnN1cHBvcnRlZCBhY2Nlc3Mgc2l6ZSBmb3Ige1JFQUQsV1JJVEV9X09OQ0Uo
KS4iKSkpOyBpZiAoISgoc2l6ZW9mKHAtPmNwdSkgPT0gc2l6ZW9mKGNoYXIpIHx8IHNpemVv
ZihwLT5jcHUpID09IHNpemVvZihzaG9ydCkgfHwgc2l6ZW9mKHAtPmNwdSkgPT0gc2l6ZW9m
KGludCkgfHwgc2l6ZW9mKHAtPmNwdSkgPT0gc2l6ZW9mKGxvbmcpKSB8fCBzaXplb2YocC0+
Y3B1KSA9PSBzaXplb2YobG9uZyBsb25nKSkpIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzExMSgp
OyB9IHdoaWxlICgwKTsgKHsgdHlwZW9mKCBfR2VuZXJpYygocC0+Y3B1KSwgY2hhcjogKGNo
YXIpMCwgdW5zaWduZWQgY2hhcjogKHVuc2lnbmVkIGNoYXIpMCwgc2lnbmVkIGNoYXI6IChz
aWduZWQgY2hhcikwLCB1bnNpZ25lZCBzaG9ydDogKHVuc2lnbmVkIHNob3J0KTAsIHNpZ25l
ZCBzaG9ydDogKHNpZ25lZCBzaG9ydCkwLCB1bnNpZ25lZCBpbnQ6ICh1bnNpZ25lZCBpbnQp
MCwgc2lnbmVkIGludDogKHNpZ25lZCBpbnQpMCwgdW5zaWduZWQgbG9uZzogKHVuc2lnbmVk
IGxvbmcpMCwgc2lnbmVkIGxvbmc6IChzaWduZWQgbG9uZykwLCB1bnNpZ25lZCBsb25nIGxv
bmc6ICh1bnNpZ25lZCBsb25nIGxvbmcpMCwgc2lnbmVkIGxvbmcgbG9uZzogKHNpZ25lZCBs
b25nIGxvbmcpMCwgZGVmYXVsdDogKHAtPmNwdSkpKSBfX3ggPSAoKihjb25zdCB2b2xhdGls
ZSB0eXBlb2YoIF9HZW5lcmljKChwLT5jcHUpLCBjaGFyOiAoY2hhcikwLCB1bnNpZ25lZCBj
aGFyOiAodW5zaWduZWQgY2hhcikwLCBzaWduZWQgY2hhcjogKHNpZ25lZCBjaGFyKTAsIHVu
c2lnbmVkIHNob3J0OiAodW5zaWduZWQgc2hvcnQpMCwgc2lnbmVkIHNob3J0OiAoc2lnbmVk
IHNob3J0KTAsIHVuc2lnbmVkIGludDogKHVuc2lnbmVkIGludCkwLCBzaWduZWQgaW50OiAo
c2lnbmVkIGludCkwLCB1bnNpZ25lZCBsb25nOiAodW5zaWduZWQgbG9uZykwLCBzaWduZWQg
bG9uZzogKHNpZ25lZCBsb25nKTAsIHVuc2lnbmVkIGxvbmcgbG9uZzogKHVuc2lnbmVkIGxv
bmcgbG9uZykwLCBzaWduZWQgbG9uZyBsb25nOiAoc2lnbmVkIGxvbmcgbG9uZykwLCBkZWZh
dWx0OiAocC0+Y3B1KSkpICopJihwLT5jcHUpKTsgZG8geyB9IHdoaWxlICgwKTsgKHR5cGVv
ZihwLT5jcHUpKV9feDsgfSk7IH0pOwoKCgp9CgpleHRlcm4gdm9pZCBzZXRfdGFza19jcHUo
c3RydWN0IHRhc2tfc3RydWN0ICpwLCB1bnNpZ25lZCBpbnQgY3B1KTsKIyAxOTAxICIuL2lu
Y2x1ZGUvbGludXgvc2NoZWQuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgdmNwdV9pc19wcmVlbXB0ZWQo
aW50IGNwdSkKewogcmV0dXJuIGZhbHNlOwp9CgoKZXh0ZXJuIGxvbmcgc2NoZWRfc2V0YWZm
aW5pdHkocGlkX3QgcGlkLCBjb25zdCBzdHJ1Y3QgY3B1bWFzayAqbmV3X21hc2spOwpleHRl
cm4gbG9uZyBzY2hlZF9nZXRhZmZpbml0eShwaWRfdCBwaWQsIHN0cnVjdCBjcHVtYXNrICpt
YXNrKTsKIyAxOTIwICIuL2luY2x1ZGUvbGludXgvc2NoZWQuaCIKZW51bSByc2VxX2V2ZW50
X21hc2tfYml0cyB7CiBSU0VRX0VWRU5UX1BSRUVNUFRfQklUID0gUlNFUV9DU19GTEFHX05P
X1JFU1RBUlRfT05fUFJFRU1QVF9CSVQsCiBSU0VRX0VWRU5UX1NJR05BTF9CSVQgPSBSU0VR
X0NTX0ZMQUdfTk9fUkVTVEFSVF9PTl9TSUdOQUxfQklULAogUlNFUV9FVkVOVF9NSUdSQVRF
X0JJVCA9IFJTRVFfQ1NfRkxBR19OT19SRVNUQVJUX09OX01JR1JBVEVfQklULAp9OwoKZW51
bSByc2VxX2V2ZW50X21hc2sgewogUlNFUV9FVkVOVF9QUkVFTVBUID0gKDFVIDw8IFJTRVFf
RVZFTlRfUFJFRU1QVF9CSVQpLAogUlNFUV9FVkVOVF9TSUdOQUwgPSAoMVUgPDwgUlNFUV9F
VkVOVF9TSUdOQUxfQklUKSwKIFJTRVFfRVZFTlRfTUlHUkFURSA9ICgxVSA8PCBSU0VRX0VW
RU5UX01JR1JBVEVfQklUKSwKfTsKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHJzZXFfc2V0X25vdGlmeV9y
ZXN1bWUoc3RydWN0IHRhc2tfc3RydWN0ICp0KQp7CiBpZiAodC0+cnNlcSkKICBzZXRfdHNr
X3RocmVhZF9mbGFnKHQsIDEzKTsKfQoKdm9pZCBfX3JzZXFfaGFuZGxlX25vdGlmeV9yZXN1
bWUoc3RydWN0IGtzaWduYWwgKnNpZywgc3RydWN0IHB0X3JlZ3MgKnJlZ3MpOwoKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIHZvaWQgcnNlcV9oYW5kbGVfbm90aWZ5X3Jlc3VtZShzdHJ1Y3Qga3NpZ25hbCAqa3Np
ZywKICAgICAgICAgIHN0cnVjdCBwdF9yZWdzICpyZWdzKQp7CiBpZiAoZ2V0X2N1cnJlbnQo
KS0+cnNlcSkKICBfX3JzZXFfaGFuZGxlX25vdGlmeV9yZXN1bWUoa3NpZywgcmVncyk7Cn0K
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSB2b2lkIHJzZXFfc2lnbmFsX2RlbGl2ZXIoc3RydWN0IGtzaWduYWwgKmtz
aWcsCiAgICAgICAgICAgc3RydWN0IHB0X3JlZ3MgKnJlZ3MpCnsKIF9fYXNtX18gX192b2xh
dGlsZV9fKCIiOiA6IDoibWVtb3J5Iik7CiBfX3NldF9iaXQoUlNFUV9FVkVOVF9TSUdOQUxf
QklULCAmZ2V0X2N1cnJlbnQoKS0+cnNlcV9ldmVudF9tYXNrKTsKIF9fYXNtX18gX192b2xh
dGlsZV9fKCIiOiA6IDoibWVtb3J5Iik7CiByc2VxX2hhbmRsZV9ub3RpZnlfcmVzdW1lKGtz
aWcsIHJlZ3MpOwp9CgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgcnNlcV9wcmVlbXB0KHN0cnVjdCB0YXNr
X3N0cnVjdCAqdCkKewogX19zZXRfYml0KFJTRVFfRVZFTlRfUFJFRU1QVF9CSVQsICZ0LT5y
c2VxX2V2ZW50X21hc2spOwogcnNlcV9zZXRfbm90aWZ5X3Jlc3VtZSh0KTsKfQoKCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSB2b2lkIHJzZXFfbWlncmF0ZShzdHJ1Y3QgdGFza19zdHJ1Y3QgKnQpCnsKIF9fc2V0
X2JpdChSU0VRX0VWRU5UX01JR1JBVEVfQklULCAmdC0+cnNlcV9ldmVudF9tYXNrKTsKIHJz
ZXFfc2V0X25vdGlmeV9yZXN1bWUodCk7Cn0KCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCByc2VxX2Zv
cmsoc3RydWN0IHRhc2tfc3RydWN0ICp0LCB1bnNpZ25lZCBsb25nIGNsb25lX2ZsYWdzKQp7
CiBpZiAoY2xvbmVfZmxhZ3MgJiAweDAwMDAwMTAwKSB7CiAgdC0+cnNlcSA9ICgodm9pZCAq
KTApOwogIHQtPnJzZXFfc2lnID0gMDsKICB0LT5yc2VxX2V2ZW50X21hc2sgPSAwOwogfSBl
bHNlIHsKICB0LT5yc2VxID0gZ2V0X2N1cnJlbnQoKS0+cnNlcTsKICB0LT5yc2VxX3NpZyA9
IGdldF9jdXJyZW50KCktPnJzZXFfc2lnOwogIHQtPnJzZXFfZXZlbnRfbWFzayA9IGdldF9j
dXJyZW50KCktPnJzZXFfZXZlbnRfbWFzazsKIH0KfQoKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgcnNlcV9l
eGVjdmUoc3RydWN0IHRhc2tfc3RydWN0ICp0KQp7CiB0LT5yc2VxID0gKCh2b2lkICopMCk7
CiB0LT5yc2VxX3NpZyA9IDA7CiB0LT5yc2VxX2V2ZW50X21hc2sgPSAwOwp9CiMgMjAyMiAi
Li9pbmNsdWRlL2xpbnV4L3NjaGVkLmgiCnZvaWQgX19leGl0X3VtaChzdHJ1Y3QgdGFza19z
dHJ1Y3QgKnRzayk7CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBleGl0X3VtaChzdHJ1Y3QgdGFza19zdHJ1
Y3QgKnRzaykKewogaWYgKF9fYnVpbHRpbl9leHBlY3QoISEodHNrLT5mbGFncyAmIDB4MDIw
MDAwMDApLCAwKSkKICBfX2V4aXRfdW1oKHRzayk7Cn0KCgoKCgoKCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lk
IHJzZXFfc3lzY2FsbChzdHJ1Y3QgcHRfcmVncyAqcmVncykKewp9CgoKCmNvbnN0IHN0cnVj
dCBzY2hlZF9hdmcgKnNjaGVkX3RyYWNlX2Nmc19ycV9hdmcoc3RydWN0IGNmc19ycSAqY2Zz
X3JxKTsKY2hhciAqc2NoZWRfdHJhY2VfY2ZzX3JxX3BhdGgoc3RydWN0IGNmc19ycSAqY2Zz
X3JxLCBjaGFyICpzdHIsIGludCBsZW4pOwppbnQgc2NoZWRfdHJhY2VfY2ZzX3JxX2NwdShz
dHJ1Y3QgY2ZzX3JxICpjZnNfcnEpOwoKY29uc3Qgc3RydWN0IHNjaGVkX2F2ZyAqc2NoZWRf
dHJhY2VfcnFfYXZnX3J0KHN0cnVjdCBycSAqcnEpOwpjb25zdCBzdHJ1Y3Qgc2NoZWRfYXZn
ICpzY2hlZF90cmFjZV9ycV9hdmdfZGwoc3RydWN0IHJxICpycSk7CmNvbnN0IHN0cnVjdCBz
Y2hlZF9hdmcgKnNjaGVkX3RyYWNlX3JxX2F2Z19pcnEoc3RydWN0IHJxICpycSk7CgppbnQg
c2NoZWRfdHJhY2VfcnFfY3B1KHN0cnVjdCBycSAqcnEpOwoKY29uc3Qgc3RydWN0IGNwdW1h
c2sgKnNjaGVkX3RyYWNlX3JkX3NwYW4oc3RydWN0IHJvb3RfZG9tYWluICpyZCk7CiMgMTcg
ImFyY2gvcG93ZXJwYy9rZXJuZWwvc2lnbmFsXzMyLmMiIDIKIyAxICIuL2luY2x1ZGUvbGlu
dXgvbW0uaCIgMQojIDEwICIuL2luY2x1ZGUvbGludXgvbW0uaCIKIyAxICIuL2luY2x1ZGUv
bGludXgvZ2ZwLmgiIDEKCgoKCgojIDEgIi4vaW5jbHVkZS9saW51eC9tbXpvbmUuaCIgMQoj
IDE4ICIuL2luY2x1ZGUvbGludXgvbW16b25lLmgiCiMgMSAiLi9pbmNsdWRlL2xpbnV4L3Bh
Z2VibG9jay1mbGFncy5oIiAxCiMgMTggIi4vaW5jbHVkZS9saW51eC9wYWdlYmxvY2stZmxh
Z3MuaCIKZW51bSBwYWdlYmxvY2tfYml0cyB7CiBQQl9taWdyYXRlLAogUEJfbWlncmF0ZV9l
bmQgPSBQQl9taWdyYXRlICsgMyAtIDEsCgogUEJfbWlncmF0ZV9za2lwLAoKCgoKCiBOUl9Q
QUdFQkxPQ0tfQklUUwp9OwojIDU1ICIuL2luY2x1ZGUvbGludXgvcGFnZWJsb2NrLWZsYWdz
LmgiCnN0cnVjdCBwYWdlOwoKdW5zaWduZWQgbG9uZyBnZXRfcGZuYmxvY2tfZmxhZ3NfbWFz
ayhzdHJ1Y3QgcGFnZSAqcGFnZSwKICAgIHVuc2lnbmVkIGxvbmcgcGZuLAogICAgdW5zaWdu
ZWQgbG9uZyBlbmRfYml0aWR4LAogICAgdW5zaWduZWQgbG9uZyBtYXNrKTsKCnZvaWQgc2V0
X3BmbmJsb2NrX2ZsYWdzX21hc2soc3RydWN0IHBhZ2UgKnBhZ2UsCiAgICB1bnNpZ25lZCBs
b25nIGZsYWdzLAogICAgdW5zaWduZWQgbG9uZyBwZm4sCiAgICB1bnNpZ25lZCBsb25nIGVu
ZF9iaXRpZHgsCiAgICB1bnNpZ25lZCBsb25nIG1hc2spOwojIDE5ICIuL2luY2x1ZGUvbGlu
dXgvbW16b25lLmgiIDIKIyAxICIuL2luY2x1ZGUvbGludXgvcGFnZS1mbGFncy1sYXlvdXQu
aCIgMQoKCgoKCiMgMSAiLi9pbmNsdWRlL2dlbmVyYXRlZC9ib3VuZHMuaCIgMQojIDcgIi4v
aW5jbHVkZS9saW51eC9wYWdlLWZsYWdzLWxheW91dC5oIiAyCiMgMjAgIi4vaW5jbHVkZS9s
aW51eC9tbXpvbmUuaCIgMgoKIyAxICIuL2luY2x1ZGUvbGludXgvbW1fdHlwZXMuaCIgMQoK
CgoKCgojIDEgIi4vaW5jbHVkZS9saW51eC9hdXh2ZWMuaCIgMQoKCgoKIyAxICIuL2luY2x1
ZGUvdWFwaS9saW51eC9hdXh2ZWMuaCIgMQoKCgoKIyAxICIuL2FyY2gvcG93ZXJwYy9pbmNs
dWRlL3VhcGkvYXNtL2F1eHZlYy5oIiAxCiMgNiAiLi9pbmNsdWRlL3VhcGkvbGludXgvYXV4
dmVjLmgiIDIKIyA2ICIuL2luY2x1ZGUvbGludXgvYXV4dmVjLmgiIDIKIyA4ICIuL2luY2x1
ZGUvbGludXgvbW1fdHlwZXMuaCIgMgoKCgojIDEgIi4vaW5jbHVkZS9saW51eC9yd3NlbS5o
IiAxCiMgMTggIi4vaW5jbHVkZS9saW51eC9yd3NlbS5oIgojIDEgIi4vaW5jbHVkZS9saW51
eC9lcnIuaCIgMQojIDI0ICIuL2luY2x1ZGUvbGludXgvZXJyLmgiCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lk
ICogX19hdHRyaWJ1dGVfXygoX193YXJuX3VudXNlZF9yZXN1bHRfXykpIEVSUl9QVFIobG9u
ZyBlcnJvcikKewogcmV0dXJuICh2b2lkICopIGVycm9yOwp9CgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgbG9uZyBf
X2F0dHJpYnV0ZV9fKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkgUFRSX0VSUiggY29uc3Qg
dm9pZCAqcHRyKQp7CiByZXR1cm4gKGxvbmcpIHB0cjsKfQoKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgX19h
dHRyaWJ1dGVfXygoX193YXJuX3VudXNlZF9yZXN1bHRfXykpIElTX0VSUiggY29uc3Qgdm9p
ZCAqcHRyKQp7CiByZXR1cm4gX19idWlsdGluX2V4cGVjdCghISgodW5zaWduZWQgbG9uZyko
dm9pZCAqKSgodW5zaWduZWQgbG9uZylwdHIpID49ICh1bnNpZ25lZCBsb25nKS00MDk1KSwg
MCk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSBib29sIF9fYXR0cmlidXRlX18oKF9fd2Fybl91bnVzZWRfcmVz
dWx0X18pKSBJU19FUlJfT1JfTlVMTCggY29uc3Qgdm9pZCAqcHRyKQp7CiByZXR1cm4gX19i
dWlsdGluX2V4cGVjdCghISghcHRyKSwgMCkgfHwgX19idWlsdGluX2V4cGVjdCghISgodW5z
aWduZWQgbG9uZykodm9pZCAqKSgodW5zaWduZWQgbG9uZylwdHIpID49ICh1bnNpZ25lZCBs
b25nKS00MDk1KSwgMCk7Cn0KIyA1MSAiLi9pbmNsdWRlL2xpbnV4L2Vyci5oIgpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgdm9pZCAqIF9fYXR0cmlidXRlX18oKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKSBFUlJf
Q0FTVCggY29uc3Qgdm9pZCAqcHRyKQp7CgogcmV0dXJuICh2b2lkICopIHB0cjsKfQoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIGludCBfX2F0dHJpYnV0ZV9fKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkgUFRS
X0VSUl9PUl9aRVJPKCBjb25zdCB2b2lkICpwdHIpCnsKIGlmIChJU19FUlIocHRyKSkKICBy
ZXR1cm4gUFRSX0VSUihwdHIpOwogZWxzZQogIHJldHVybiAwOwp9CiMgMTkgIi4vaW5jbHVk
ZS9saW51eC9yd3NlbS5oIiAyCiMgMzUgIi4vaW5jbHVkZS9saW51eC9yd3NlbS5oIgpzdHJ1
Y3Qgcndfc2VtYXBob3JlIHsKIGF0b21pY19sb25nX3QgY291bnQ7CgoKCgoKIGF0b21pY19s
b25nX3Qgb3duZXI7Cgogc3RydWN0IG9wdGltaXN0aWNfc3Bpbl9xdWV1ZSBvc3E7CgogcmF3
X3NwaW5sb2NrX3Qgd2FpdF9sb2NrOwogc3RydWN0IGxpc3RfaGVhZCB3YWl0X2xpc3Q7CgoK
CgoKCn07CgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIGludCByd3NlbV9pc19sb2NrZWQoc3RydWN0IHJ3X3NlbWFw
aG9yZSAqc2VtKQp7CiByZXR1cm4gYXRvbWljX2xvbmdfcmVhZCgmc2VtLT5jb3VudCkgIT0g
MDsKfQojIDEwMSAiLi9pbmNsdWRlL2xpbnV4L3J3c2VtLmgiCmV4dGVybiB2b2lkIF9faW5p
dF9yd3NlbShzdHJ1Y3Qgcndfc2VtYXBob3JlICpzZW0sIGNvbnN0IGNoYXIgKm5hbWUsCiAg
ICBzdHJ1Y3QgbG9ja19jbGFzc19rZXkgKmtleSk7CiMgMTE3ICIuL2luY2x1ZGUvbGludXgv
cndzZW0uaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIGludCByd3NlbV9pc19jb250ZW5kZWQoc3RydWN0IHJ3X3Nl
bWFwaG9yZSAqc2VtKQp7CiByZXR1cm4gIWxpc3RfZW1wdHkoJnNlbS0+d2FpdF9saXN0KTsK
fQoKCgoKZXh0ZXJuIHZvaWQgZG93bl9yZWFkKHN0cnVjdCByd19zZW1hcGhvcmUgKnNlbSk7
CmV4dGVybiBpbnQgX19hdHRyaWJ1dGVfXygoX193YXJuX3VudXNlZF9yZXN1bHRfXykpIGRv
d25fcmVhZF9raWxsYWJsZShzdHJ1Y3Qgcndfc2VtYXBob3JlICpzZW0pOwoKCgoKZXh0ZXJu
IGludCBkb3duX3JlYWRfdHJ5bG9jayhzdHJ1Y3Qgcndfc2VtYXBob3JlICpzZW0pOwoKCgoK
ZXh0ZXJuIHZvaWQgZG93bl93cml0ZShzdHJ1Y3Qgcndfc2VtYXBob3JlICpzZW0pOwpleHRl
cm4gaW50IF9fYXR0cmlidXRlX18oKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKSBkb3duX3dy
aXRlX2tpbGxhYmxlKHN0cnVjdCByd19zZW1hcGhvcmUgKnNlbSk7CgoKCgpleHRlcm4gaW50
IGRvd25fd3JpdGVfdHJ5bG9jayhzdHJ1Y3Qgcndfc2VtYXBob3JlICpzZW0pOwoKCgoKZXh0
ZXJuIHZvaWQgdXBfcmVhZChzdHJ1Y3Qgcndfc2VtYXBob3JlICpzZW0pOwoKCgoKZXh0ZXJu
IHZvaWQgdXBfd3JpdGUoc3RydWN0IHJ3X3NlbWFwaG9yZSAqc2VtKTsKCgoKCmV4dGVybiB2
b2lkIGRvd25ncmFkZV93cml0ZShzdHJ1Y3Qgcndfc2VtYXBob3JlICpzZW0pOwojIDEyICIu
L2luY2x1ZGUvbGludXgvbW1fdHlwZXMuaCIgMgojIDEgIi4vaW5jbHVkZS9saW51eC9jb21w
bGV0aW9uLmgiIDEKIyAxMiAiLi9pbmNsdWRlL2xpbnV4L2NvbXBsZXRpb24uaCIKIyAxICIu
L2luY2x1ZGUvbGludXgvc3dhaXQuaCIgMQojIDQxICIuL2luY2x1ZGUvbGludXgvc3dhaXQu
aCIKc3RydWN0IHRhc2tfc3RydWN0OwoKc3RydWN0IHN3YWl0X3F1ZXVlX2hlYWQgewogcmF3
X3NwaW5sb2NrX3QgbG9jazsKIHN0cnVjdCBsaXN0X2hlYWQgdGFza19saXN0Owp9OwoKc3Ry
dWN0IHN3YWl0X3F1ZXVlIHsKIHN0cnVjdCB0YXNrX3N0cnVjdCAqdGFzazsKIHN0cnVjdCBs
aXN0X2hlYWQgdGFza19saXN0Owp9OwojIDY5ICIuL2luY2x1ZGUvbGludXgvc3dhaXQuaCIK
ZXh0ZXJuIHZvaWQgX19pbml0X3N3YWl0X3F1ZXVlX2hlYWQoc3RydWN0IHN3YWl0X3F1ZXVl
X2hlYWQgKnEsIGNvbnN0IGNoYXIgKm5hbWUsCiAgICAgICAgc3RydWN0IGxvY2tfY2xhc3Nf
a2V5ICprZXkpOwojIDEyMSAiLi9pbmNsdWRlL2xpbnV4L3N3YWl0LmgiCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBp
bnQgc3dhaXRfYWN0aXZlKHN0cnVjdCBzd2FpdF9xdWV1ZV9oZWFkICp3cSkKewogcmV0dXJu
ICFsaXN0X2VtcHR5KCZ3cS0+dGFza19saXN0KTsKfQojIDEzNCAiLi9pbmNsdWRlL2xpbnV4
L3N3YWl0LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIHN3cV9oYXNfc2xlZXBlcihzdHJ1Y3Qgc3dhaXRf
cXVldWVfaGVhZCAqd3EpCnsKCgoKCgoKCiBfX2FzbV9fIF9fdm9sYXRpbGVfXyAoInN5bmMi
IDogOiA6ICJtZW1vcnkiKTsKIHJldHVybiBzd2FpdF9hY3RpdmUod3EpOwp9CgpleHRlcm4g
dm9pZCBzd2FrZV91cF9vbmUoc3RydWN0IHN3YWl0X3F1ZXVlX2hlYWQgKnEpOwpleHRlcm4g
dm9pZCBzd2FrZV91cF9hbGwoc3RydWN0IHN3YWl0X3F1ZXVlX2hlYWQgKnEpOwpleHRlcm4g
dm9pZCBzd2FrZV91cF9sb2NrZWQoc3RydWN0IHN3YWl0X3F1ZXVlX2hlYWQgKnEpOwoKZXh0
ZXJuIHZvaWQgcHJlcGFyZV90b19zd2FpdF9leGNsdXNpdmUoc3RydWN0IHN3YWl0X3F1ZXVl
X2hlYWQgKnEsIHN0cnVjdCBzd2FpdF9xdWV1ZSAqd2FpdCwgaW50IHN0YXRlKTsKZXh0ZXJu
IGxvbmcgcHJlcGFyZV90b19zd2FpdF9ldmVudChzdHJ1Y3Qgc3dhaXRfcXVldWVfaGVhZCAq
cSwgc3RydWN0IHN3YWl0X3F1ZXVlICp3YWl0LCBpbnQgc3RhdGUpOwoKZXh0ZXJuIHZvaWQg
X19maW5pc2hfc3dhaXQoc3RydWN0IHN3YWl0X3F1ZXVlX2hlYWQgKnEsIHN0cnVjdCBzd2Fp
dF9xdWV1ZSAqd2FpdCk7CmV4dGVybiB2b2lkIGZpbmlzaF9zd2FpdChzdHJ1Y3Qgc3dhaXRf
cXVldWVfaGVhZCAqcSwgc3RydWN0IHN3YWl0X3F1ZXVlICp3YWl0KTsKIyAxMyAiLi9pbmNs
dWRlL2xpbnV4L2NvbXBsZXRpb24uaCIgMgojIDI2ICIuL2luY2x1ZGUvbGludXgvY29tcGxl
dGlvbi5oIgpzdHJ1Y3QgY29tcGxldGlvbiB7CiB1bnNpZ25lZCBpbnQgZG9uZTsKIHN0cnVj
dCBzd2FpdF9xdWV1ZV9oZWFkIHdhaXQ7Cn07CgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGNvbXBsZXRl
X2FjcXVpcmUoc3RydWN0IGNvbXBsZXRpb24gKngpIHt9CnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGNvbXBs
ZXRlX3JlbGVhc2Uoc3RydWN0IGNvbXBsZXRpb24gKngpIHt9CiMgODUgIi4vaW5jbHVkZS9s
aW51eC9jb21wbGV0aW9uLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIF9faW5pdF9jb21wbGV0aW9uKHN0
cnVjdCBjb21wbGV0aW9uICp4KQp7CiB4LT5kb25lID0gMDsKIGRvIHsgc3RhdGljIHN0cnVj
dCBsb2NrX2NsYXNzX2tleSBfX2tleTsgX19pbml0X3N3YWl0X3F1ZXVlX2hlYWQoKCZ4LT53
YWl0KSwgIiZ4LT53YWl0IiwgJl9fa2V5KTsgfSB3aGlsZSAoMCk7Cn0KIyA5OCAiLi9pbmNs
dWRlL2xpbnV4L2NvbXBsZXRpb24uaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgcmVpbml0X2NvbXBsZXRp
b24oc3RydWN0IGNvbXBsZXRpb24gKngpCnsKIHgtPmRvbmUgPSAwOwp9CgpleHRlcm4gdm9p
ZCB3YWl0X2Zvcl9jb21wbGV0aW9uKHN0cnVjdCBjb21wbGV0aW9uICopOwpleHRlcm4gdm9p
ZCB3YWl0X2Zvcl9jb21wbGV0aW9uX2lvKHN0cnVjdCBjb21wbGV0aW9uICopOwpleHRlcm4g
aW50IHdhaXRfZm9yX2NvbXBsZXRpb25faW50ZXJydXB0aWJsZShzdHJ1Y3QgY29tcGxldGlv
biAqeCk7CmV4dGVybiBpbnQgd2FpdF9mb3JfY29tcGxldGlvbl9raWxsYWJsZShzdHJ1Y3Qg
Y29tcGxldGlvbiAqeCk7CmV4dGVybiB1bnNpZ25lZCBsb25nIHdhaXRfZm9yX2NvbXBsZXRp
b25fdGltZW91dChzdHJ1Y3QgY29tcGxldGlvbiAqeCwKICAgICAgICAgdW5zaWduZWQgbG9u
ZyB0aW1lb3V0KTsKZXh0ZXJuIHVuc2lnbmVkIGxvbmcgd2FpdF9mb3JfY29tcGxldGlvbl9p
b190aW1lb3V0KHN0cnVjdCBjb21wbGV0aW9uICp4LAogICAgICAgICAgdW5zaWduZWQgbG9u
ZyB0aW1lb3V0KTsKZXh0ZXJuIGxvbmcgd2FpdF9mb3JfY29tcGxldGlvbl9pbnRlcnJ1cHRp
YmxlX3RpbWVvdXQoCiBzdHJ1Y3QgY29tcGxldGlvbiAqeCwgdW5zaWduZWQgbG9uZyB0aW1l
b3V0KTsKZXh0ZXJuIGxvbmcgd2FpdF9mb3JfY29tcGxldGlvbl9raWxsYWJsZV90aW1lb3V0
KAogc3RydWN0IGNvbXBsZXRpb24gKngsIHVuc2lnbmVkIGxvbmcgdGltZW91dCk7CmV4dGVy
biBib29sIHRyeV93YWl0X2Zvcl9jb21wbGV0aW9uKHN0cnVjdCBjb21wbGV0aW9uICp4KTsK
ZXh0ZXJuIGJvb2wgY29tcGxldGlvbl9kb25lKHN0cnVjdCBjb21wbGV0aW9uICp4KTsKCmV4
dGVybiB2b2lkIGNvbXBsZXRlKHN0cnVjdCBjb21wbGV0aW9uICopOwpleHRlcm4gdm9pZCBj
b21wbGV0ZV9hbGwoc3RydWN0IGNvbXBsZXRpb24gKik7CiMgMTMgIi4vaW5jbHVkZS9saW51
eC9tbV90eXBlcy5oIiAyCgojIDEgIi4vaW5jbHVkZS9saW51eC91cHJvYmVzLmgiIDEKIyAx
OSAiLi9pbmNsdWRlL2xpbnV4L3Vwcm9iZXMuaCIKc3RydWN0IHZtX2FyZWFfc3RydWN0Owpz
dHJ1Y3QgbW1fc3RydWN0OwpzdHJ1Y3QgaW5vZGU7CnN0cnVjdCBub3RpZmllcl9ibG9jazsK
c3RydWN0IHBhZ2U7CgoKCgoKCmVudW0gdXByb2JlX2ZpbHRlcl9jdHggewogVVBST0JFX0ZJ
TFRFUl9SRUdJU1RFUiwKIFVQUk9CRV9GSUxURVJfVU5SRUdJU1RFUiwKIFVQUk9CRV9GSUxU
RVJfTU1BUCwKfTsKCnN0cnVjdCB1cHJvYmVfY29uc3VtZXIgewogaW50ICgqaGFuZGxlciko
c3RydWN0IHVwcm9iZV9jb25zdW1lciAqc2VsZiwgc3RydWN0IHB0X3JlZ3MgKnJlZ3MpOwog
aW50ICgqcmV0X2hhbmRsZXIpKHN0cnVjdCB1cHJvYmVfY29uc3VtZXIgKnNlbGYsCiAgICB1
bnNpZ25lZCBsb25nIGZ1bmMsCiAgICBzdHJ1Y3QgcHRfcmVncyAqcmVncyk7CiBib29sICgq
ZmlsdGVyKShzdHJ1Y3QgdXByb2JlX2NvbnN1bWVyICpzZWxmLAogICAgZW51bSB1cHJvYmVf
ZmlsdGVyX2N0eCBjdHgsCiAgICBzdHJ1Y3QgbW1fc3RydWN0ICptbSk7Cgogc3RydWN0IHVw
cm9iZV9jb25zdW1lciAqbmV4dDsKfTsKCgojIDEgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUv
YXNtL3Vwcm9iZXMuaCIgMQojIDEyICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS91cHJv
YmVzLmgiCiMgMSAiLi9pbmNsdWRlL2xpbnV4L25vdGlmaWVyLmgiIDEKIyAxNiAiLi9pbmNs
dWRlL2xpbnV4L25vdGlmaWVyLmgiCiMgMSAiLi9pbmNsdWRlL2xpbnV4L3NyY3UuaCIgMQoj
IDIyICIuL2luY2x1ZGUvbGludXgvc3JjdS5oIgojIDEgIi4vaW5jbHVkZS9saW51eC9yY3Vf
c2VnY2JsaXN0LmgiIDEKIyAyMSAiLi9pbmNsdWRlL2xpbnV4L3JjdV9zZWdjYmxpc3QuaCIK
c3RydWN0IHJjdV9jYmxpc3Qgewogc3RydWN0IGNhbGxiYWNrX2hlYWQgKmhlYWQ7CiBzdHJ1
Y3QgY2FsbGJhY2tfaGVhZCAqKnRhaWw7CiBsb25nIGxlbjsKfTsKIyA2NiAiLi9pbmNsdWRl
L2xpbnV4L3JjdV9zZWdjYmxpc3QuaCIKc3RydWN0IHJjdV9zZWdjYmxpc3Qgewogc3RydWN0
IGNhbGxiYWNrX2hlYWQgKmhlYWQ7CiBzdHJ1Y3QgY2FsbGJhY2tfaGVhZCAqKnRhaWxzWzRd
OwogdW5zaWduZWQgbG9uZyBncF9zZXFbNF07CgoKCiBsb25nIGxlbjsKCiB1OCBlbmFibGVk
OwogdTggb2ZmbG9hZGVkOwp9OwojIDIzICIuL2luY2x1ZGUvbGludXgvc3JjdS5oIiAyCgpz
dHJ1Y3Qgc3JjdV9zdHJ1Y3Q7CiMgNDEgIi4vaW5jbHVkZS9saW51eC9zcmN1LmgiCmludCBp
bml0X3NyY3Vfc3RydWN0KHN0cnVjdCBzcmN1X3N0cnVjdCAqc3NwKTsKCgoKCgoKCiMgMSAi
Li9pbmNsdWRlL2xpbnV4L3NyY3V0cmVlLmgiIDEKIyAxNCAiLi9pbmNsdWRlL2xpbnV4L3Ny
Y3V0cmVlLmgiCiMgMSAiLi9pbmNsdWRlL2xpbnV4L3JjdV9ub2RlX3RyZWUuaCIgMQojIDE1
ICIuL2luY2x1ZGUvbGludXgvc3JjdXRyZWUuaCIgMgoKCnN0cnVjdCBzcmN1X25vZGU7CnN0
cnVjdCBzcmN1X3N0cnVjdDsKCgoKCgpzdHJ1Y3Qgc3JjdV9kYXRhIHsKCiB1bnNpZ25lZCBs
b25nIHNyY3VfbG9ja19jb3VudFsyXTsKIHVuc2lnbmVkIGxvbmcgc3JjdV91bmxvY2tfY291
bnRbMl07CgoKIHNwaW5sb2NrX3QgbG9jayBfX2F0dHJpYnV0ZV9fKChfX2FsaWduZWRfXygx
IDw8ICg2KSkpKTsKIHN0cnVjdCByY3Vfc2VnY2JsaXN0IHNyY3VfY2JsaXN0OwogdW5zaWdu
ZWQgbG9uZyBzcmN1X2dwX3NlcV9uZWVkZWQ7CiB1bnNpZ25lZCBsb25nIHNyY3VfZ3Bfc2Vx
X25lZWRlZF9leHA7CiBib29sIHNyY3VfY2JsaXN0X2ludm9raW5nOwogc3RydWN0IHRpbWVy
X2xpc3QgZGVsYXlfd29yazsKIHN0cnVjdCB3b3JrX3N0cnVjdCB3b3JrOwogc3RydWN0IGNh
bGxiYWNrX2hlYWQgc3JjdV9iYXJyaWVyX2hlYWQ7CiBzdHJ1Y3Qgc3JjdV9ub2RlICpteW5v
ZGU7CiB1bnNpZ25lZCBsb25nIGdycG1hc2s7CgogaW50IGNwdTsKIHN0cnVjdCBzcmN1X3N0
cnVjdCAqc3NwOwp9OwoKCgoKc3RydWN0IHNyY3Vfbm9kZSB7CiBzcGlubG9ja190IGxvY2s7
CiB1bnNpZ25lZCBsb25nIHNyY3VfaGF2ZV9jYnNbNF07CgoKIHVuc2lnbmVkIGxvbmcgc3Jj
dV9kYXRhX2hhdmVfY2JzWzRdOwoKIHVuc2lnbmVkIGxvbmcgc3JjdV9ncF9zZXFfbmVlZGVk
X2V4cDsKIHN0cnVjdCBzcmN1X25vZGUgKnNyY3VfcGFyZW50OwogaW50IGdycGxvOwogaW50
IGdycGhpOwp9OwoKCgoKc3RydWN0IHNyY3Vfc3RydWN0IHsKIHN0cnVjdCBzcmN1X25vZGUg
bm9kZVsoMSArICgoKDI0KSArICgoMTYpKSAtIDEpIC8gKCgxNikpKSldOwogc3RydWN0IHNy
Y3Vfbm9kZSAqbGV2ZWxbMiArIDFdOwoKIHN0cnVjdCBtdXRleCBzcmN1X2NiX211dGV4Owog
c3BpbmxvY2tfdCBsb2NrOwogc3RydWN0IG11dGV4IHNyY3VfZ3BfbXV0ZXg7CiB1bnNpZ25l
ZCBpbnQgc3JjdV9pZHg7CiB1bnNpZ25lZCBsb25nIHNyY3VfZ3Bfc2VxOwogdW5zaWduZWQg
bG9uZyBzcmN1X2dwX3NlcV9uZWVkZWQ7CiB1bnNpZ25lZCBsb25nIHNyY3VfZ3Bfc2VxX25l
ZWRlZF9leHA7CiB1bnNpZ25lZCBsb25nIHNyY3VfbGFzdF9ncF9lbmQ7CiBzdHJ1Y3Qgc3Jj
dV9kYXRhICpzZGE7CiB1bnNpZ25lZCBsb25nIHNyY3VfYmFycmllcl9zZXE7CiBzdHJ1Y3Qg
bXV0ZXggc3JjdV9iYXJyaWVyX211dGV4Owogc3RydWN0IGNvbXBsZXRpb24gc3JjdV9iYXJy
aWVyX2NvbXBsZXRpb247CgogYXRvbWljX3Qgc3JjdV9iYXJyaWVyX2NwdV9jbnQ7CgoKIHN0
cnVjdCBkZWxheWVkX3dvcmsgd29yazsKCgoKfTsKIyAxMzcgIi4vaW5jbHVkZS9saW51eC9z
cmN1dHJlZS5oIgp2b2lkIHN5bmNocm9uaXplX3NyY3VfZXhwZWRpdGVkKHN0cnVjdCBzcmN1
X3N0cnVjdCAqc3NwKTsKdm9pZCBzcmN1X2JhcnJpZXIoc3RydWN0IHNyY3Vfc3RydWN0ICpz
c3ApOwp2b2lkIHNyY3VfdG9ydHVyZV9zdGF0c19wcmludChzdHJ1Y3Qgc3JjdV9zdHJ1Y3Qg
KnNzcCwgY2hhciAqdHQsIGNoYXIgKnRmKTsKIyA1MCAiLi9pbmNsdWRlL2xpbnV4L3NyY3Uu
aCIgMgoKCgoKCgoKdm9pZCBjYWxsX3NyY3Uoc3RydWN0IHNyY3Vfc3RydWN0ICpzc3AsIHN0
cnVjdCBjYWxsYmFja19oZWFkICpoZWFkLAogIHZvaWQgKCpmdW5jKShzdHJ1Y3QgY2FsbGJh
Y2tfaGVhZCAqaGVhZCkpOwp2b2lkIGNsZWFudXBfc3JjdV9zdHJ1Y3Qoc3RydWN0IHNyY3Vf
c3RydWN0ICpzc3ApOwppbnQgX19zcmN1X3JlYWRfbG9jayhzdHJ1Y3Qgc3JjdV9zdHJ1Y3Qg
KnNzcCkgOwp2b2lkIF9fc3JjdV9yZWFkX3VubG9jayhzdHJ1Y3Qgc3JjdV9zdHJ1Y3QgKnNz
cCwgaW50IGlkeCkgOwp2b2lkIHN5bmNocm9uaXplX3NyY3Uoc3RydWN0IHNyY3Vfc3RydWN0
ICpzc3ApOwojIDkxICIuL2luY2x1ZGUvbGludXgvc3JjdS5oIgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHNy
Y3VfcmVhZF9sb2NrX2hlbGQoY29uc3Qgc3RydWN0IHNyY3Vfc3RydWN0ICpzc3ApCnsKIHJl
dHVybiAxOwp9CiMgMTUwICIuL2luY2x1ZGUvbGludXgvc3JjdS5oIgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50
IHNyY3VfcmVhZF9sb2NrKHN0cnVjdCBzcmN1X3N0cnVjdCAqc3NwKQp7CiBpbnQgcmV0dmFs
OwoKIHJldHZhbCA9IF9fc3JjdV9yZWFkX2xvY2soc3NwKTsKIGRvIHsgfSB3aGlsZSAoMCk7
CiByZXR1cm4gcmV0dmFsOwp9CgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50CnNyY3VfcmVhZF9sb2NrX25vdHJhY2Uoc3RydWN0
IHNyY3Vfc3RydWN0ICpzc3ApCnsKIGludCByZXR2YWw7CgogcmV0dmFsID0gX19zcmN1X3Jl
YWRfbG9jayhzc3ApOwogcmV0dXJuIHJldHZhbDsKfQojIDE3NiAiLi9pbmNsdWRlL2xpbnV4
L3NyY3UuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgc3JjdV9yZWFkX3VubG9jayhzdHJ1Y3Qgc3JjdV9z
dHJ1Y3QgKnNzcCwgaW50IGlkeCkKCnsKICh7IGludCBfX3JldF93YXJuX29uID0gISEoaWR4
ICYgfjB4MSk7IGlmIChfX2J1aWx0aW5fZXhwZWN0KCEhKF9fcmV0X3dhcm5fb24pLCAwKSkg
X19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgkiICJ0d2kgMzEsIDAsIDAiICJcbiIgIi5zZWN0
aW9uIF9fYnVnX3RhYmxlLFwiYXdcIlxuIiAiMjpcdCIgIi44Ynl0ZSIgIiAiICIxYiwgJTBc
biIgIlx0LnNob3J0ICUxLCAlMlxuIiAiLm9yZyAyYislM1xuIiAiLnByZXZpb3VzXG4iIDog
OiAiaSIgKCIuL2luY2x1ZGUvbGludXgvc3JjdS5oIiksICJpIiAoMTc5KSwgImkiICgoMSA8
PCAwKSB8ICgoMSA8PCAxKSB8ICgoOSkgPDwgOCkpKSwgImkiIChzaXplb2Yoc3RydWN0IGJ1
Z19lbnRyeSkpKTsgX19idWlsdGluX2V4cGVjdCghIShfX3JldF93YXJuX29uKSwgMCk7IH0p
OwogZG8geyB9IHdoaWxlICgwKTsKIF9fc3JjdV9yZWFkX3VubG9jayhzc3AsIGlkeCk7Cn0K
CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSB2b2lkCnNyY3VfcmVhZF91bmxvY2tfbm90cmFjZShzdHJ1Y3Qgc3JjdV9zdHJ1Y3QgKnNz
cCwgaW50IGlkeCkKewogX19zcmN1X3JlYWRfdW5sb2NrKHNzcCwgaWR4KTsKfQojIDIwMCAi
Li9pbmNsdWRlL2xpbnV4L3NyY3UuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgc21wX21iX19hZnRlcl9z
cmN1X3JlYWRfdW5sb2NrKHZvaWQpCnsKCn0KIyAxNyAiLi9pbmNsdWRlL2xpbnV4L25vdGlm
aWVyLmgiIDIKIyA0OSAiLi9pbmNsdWRlL2xpbnV4L25vdGlmaWVyLmgiCnN0cnVjdCBub3Rp
Zmllcl9ibG9jazsKCnR5cGVkZWYgaW50ICgqbm90aWZpZXJfZm5fdCkoc3RydWN0IG5vdGlm
aWVyX2Jsb2NrICpuYiwKICAgdW5zaWduZWQgbG9uZyBhY3Rpb24sIHZvaWQgKmRhdGEpOwoK
c3RydWN0IG5vdGlmaWVyX2Jsb2NrIHsKIG5vdGlmaWVyX2ZuX3Qgbm90aWZpZXJfY2FsbDsK
IHN0cnVjdCBub3RpZmllcl9ibG9jayAqbmV4dDsKIGludCBwcmlvcml0eTsKfTsKCnN0cnVj
dCBhdG9taWNfbm90aWZpZXJfaGVhZCB7CiBzcGlubG9ja190IGxvY2s7CiBzdHJ1Y3Qgbm90
aWZpZXJfYmxvY2sgKmhlYWQ7Cn07CgpzdHJ1Y3QgYmxvY2tpbmdfbm90aWZpZXJfaGVhZCB7
CiBzdHJ1Y3Qgcndfc2VtYXBob3JlIHJ3c2VtOwogc3RydWN0IG5vdGlmaWVyX2Jsb2NrICpo
ZWFkOwp9OwoKc3RydWN0IHJhd19ub3RpZmllcl9oZWFkIHsKIHN0cnVjdCBub3RpZmllcl9i
bG9jayAqaGVhZDsKfTsKCnN0cnVjdCBzcmN1X25vdGlmaWVyX2hlYWQgewogc3RydWN0IG11
dGV4IG11dGV4Owogc3RydWN0IHNyY3Vfc3RydWN0IHNyY3U7CiBzdHJ1Y3Qgbm90aWZpZXJf
YmxvY2sgKmhlYWQ7Cn07CiMgOTMgIi4vaW5jbHVkZS9saW51eC9ub3RpZmllci5oIgpleHRl
cm4gdm9pZCBzcmN1X2luaXRfbm90aWZpZXJfaGVhZChzdHJ1Y3Qgc3JjdV9ub3RpZmllcl9o
ZWFkICpuaCk7CiMgMTQ0ICIuL2luY2x1ZGUvbGludXgvbm90aWZpZXIuaCIKZXh0ZXJuIGlu
dCBhdG9taWNfbm90aWZpZXJfY2hhaW5fcmVnaXN0ZXIoc3RydWN0IGF0b21pY19ub3RpZmll
cl9oZWFkICpuaCwKICBzdHJ1Y3Qgbm90aWZpZXJfYmxvY2sgKm5iKTsKZXh0ZXJuIGludCBi
bG9ja2luZ19ub3RpZmllcl9jaGFpbl9yZWdpc3RlcihzdHJ1Y3QgYmxvY2tpbmdfbm90aWZp
ZXJfaGVhZCAqbmgsCiAgc3RydWN0IG5vdGlmaWVyX2Jsb2NrICpuYik7CmV4dGVybiBpbnQg
cmF3X25vdGlmaWVyX2NoYWluX3JlZ2lzdGVyKHN0cnVjdCByYXdfbm90aWZpZXJfaGVhZCAq
bmgsCiAgc3RydWN0IG5vdGlmaWVyX2Jsb2NrICpuYik7CmV4dGVybiBpbnQgc3JjdV9ub3Rp
Zmllcl9jaGFpbl9yZWdpc3RlcihzdHJ1Y3Qgc3JjdV9ub3RpZmllcl9oZWFkICpuaCwKICBz
dHJ1Y3Qgbm90aWZpZXJfYmxvY2sgKm5iKTsKCmV4dGVybiBpbnQgYXRvbWljX25vdGlmaWVy
X2NoYWluX3VucmVnaXN0ZXIoc3RydWN0IGF0b21pY19ub3RpZmllcl9oZWFkICpuaCwKICBz
dHJ1Y3Qgbm90aWZpZXJfYmxvY2sgKm5iKTsKZXh0ZXJuIGludCBibG9ja2luZ19ub3RpZmll
cl9jaGFpbl91bnJlZ2lzdGVyKHN0cnVjdCBibG9ja2luZ19ub3RpZmllcl9oZWFkICpuaCwK
ICBzdHJ1Y3Qgbm90aWZpZXJfYmxvY2sgKm5iKTsKZXh0ZXJuIGludCByYXdfbm90aWZpZXJf
Y2hhaW5fdW5yZWdpc3RlcihzdHJ1Y3QgcmF3X25vdGlmaWVyX2hlYWQgKm5oLAogIHN0cnVj
dCBub3RpZmllcl9ibG9jayAqbmIpOwpleHRlcm4gaW50IHNyY3Vfbm90aWZpZXJfY2hhaW5f
dW5yZWdpc3RlcihzdHJ1Y3Qgc3JjdV9ub3RpZmllcl9oZWFkICpuaCwKICBzdHJ1Y3Qgbm90
aWZpZXJfYmxvY2sgKm5iKTsKCmV4dGVybiBpbnQgYXRvbWljX25vdGlmaWVyX2NhbGxfY2hh
aW4oc3RydWN0IGF0b21pY19ub3RpZmllcl9oZWFkICpuaCwKICB1bnNpZ25lZCBsb25nIHZh
bCwgdm9pZCAqdik7CmV4dGVybiBpbnQgX19hdG9taWNfbm90aWZpZXJfY2FsbF9jaGFpbihz
dHJ1Y3QgYXRvbWljX25vdGlmaWVyX2hlYWQgKm5oLAogdW5zaWduZWQgbG9uZyB2YWwsIHZv
aWQgKnYsIGludCBucl90b19jYWxsLCBpbnQgKm5yX2NhbGxzKTsKZXh0ZXJuIGludCBibG9j
a2luZ19ub3RpZmllcl9jYWxsX2NoYWluKHN0cnVjdCBibG9ja2luZ19ub3RpZmllcl9oZWFk
ICpuaCwKICB1bnNpZ25lZCBsb25nIHZhbCwgdm9pZCAqdik7CmV4dGVybiBpbnQgX19ibG9j
a2luZ19ub3RpZmllcl9jYWxsX2NoYWluKHN0cnVjdCBibG9ja2luZ19ub3RpZmllcl9oZWFk
ICpuaCwKIHVuc2lnbmVkIGxvbmcgdmFsLCB2b2lkICp2LCBpbnQgbnJfdG9fY2FsbCwgaW50
ICpucl9jYWxscyk7CmV4dGVybiBpbnQgcmF3X25vdGlmaWVyX2NhbGxfY2hhaW4oc3RydWN0
IHJhd19ub3RpZmllcl9oZWFkICpuaCwKICB1bnNpZ25lZCBsb25nIHZhbCwgdm9pZCAqdik7
CmV4dGVybiBpbnQgX19yYXdfbm90aWZpZXJfY2FsbF9jaGFpbihzdHJ1Y3QgcmF3X25vdGlm
aWVyX2hlYWQgKm5oLAogdW5zaWduZWQgbG9uZyB2YWwsIHZvaWQgKnYsIGludCBucl90b19j
YWxsLCBpbnQgKm5yX2NhbGxzKTsKZXh0ZXJuIGludCBzcmN1X25vdGlmaWVyX2NhbGxfY2hh
aW4oc3RydWN0IHNyY3Vfbm90aWZpZXJfaGVhZCAqbmgsCiAgdW5zaWduZWQgbG9uZyB2YWws
IHZvaWQgKnYpOwpleHRlcm4gaW50IF9fc3JjdV9ub3RpZmllcl9jYWxsX2NoYWluKHN0cnVj
dCBzcmN1X25vdGlmaWVyX2hlYWQgKm5oLAogdW5zaWduZWQgbG9uZyB2YWwsIHZvaWQgKnYs
IGludCBucl90b19jYWxsLCBpbnQgKm5yX2NhbGxzKTsKIyAxOTAgIi4vaW5jbHVkZS9saW51
eC9ub3RpZmllci5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IG5vdGlmaWVyX2Zyb21fZXJybm8oaW50IGVy
cikKewogaWYgKGVycikKICByZXR1cm4gMHg4MDAwIHwgKDB4MDAwMSAtIGVycik7CgogcmV0
dXJuIDB4MDAwMTsKfQoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgbm90aWZpZXJfdG9fZXJybm8oaW50IHJl
dCkKewogcmV0ICY9IH4weDgwMDA7CiByZXR1cm4gcmV0ID4gMHgwMDAxID8gMHgwMDAxIC0g
cmV0IDogMDsKfQojIDIzNCAiLi9pbmNsdWRlL2xpbnV4L25vdGlmaWVyLmgiCmV4dGVybiBz
dHJ1Y3QgYmxvY2tpbmdfbm90aWZpZXJfaGVhZCByZWJvb3Rfbm90aWZpZXJfbGlzdDsKIyAx
MyAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vdXByb2Jlcy5oIiAyCiMgMSAiLi9hcmNo
L3Bvd2VycGMvaW5jbHVkZS9hc20vcHJvYmVzLmgiIDEKIyAxMiAiLi9hcmNoL3Bvd2VycGMv
aW5jbHVkZS9hc20vcHJvYmVzLmgiCnR5cGVkZWYgdTMyIHBwY19vcGNvZGVfdDsKIyAzNSAi
Li9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vcHJvYmVzLmgiCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGVu
YWJsZV9zaW5nbGVfc3RlcChzdHJ1Y3QgcHRfcmVncyAqcmVncykKewogcmVncy0+bXNyIHw9
ICgoMVVMPDwoOSkpKTsKCgoKCgoKIHJlZ3MtPm1zciAmPSB+KDFVTDw8KDE3KSk7CiBhc20g
dm9sYXRpbGUoIm10c3ByICIgIjB4MTM0IiAiLCUwIiA6IDogInIiICgodW5zaWduZWQgbG9u
ZykoKHt1bnNpZ25lZCBsb25nIHJ2YWw7IGFzbSB2b2xhdGlsZSgibWZzcHIgJTAsIiAiMHgx
MzQiIDogIj1yIiAocnZhbCkpOyBydmFsO30pIHwgMHgwODAwMDAwMCB8IDB4NDAwMDAwMDAp
KSA6ICJtZW1vcnkiKTsKCgoKCn0KIyAxNCAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20v
dXByb2Jlcy5oIiAyCiMgMSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vaW5zdC5oIiAx
CiMgMTEgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2luc3QuaCIKc3RydWN0IHBwY19p
bnN0IHsKIHUzMiB2YWw7CgogdTMyIHN1ZmZpeDsKCn0gX19hdHRyaWJ1dGVfXygoX19wYWNr
ZWRfXykpOwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHUzMiBwcGNfaW5zdF92YWwoc3RydWN0IHBwY19pbnN0IHgp
CnsKIHJldHVybiB4LnZhbDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBwcGNfaW5zdF9wcmltYXJ5X29w
Y29kZShzdHJ1Y3QgcHBjX2luc3QgeCkKewogcmV0dXJuIHBwY19pbnN0X3ZhbCh4KSA+PiAy
NjsKfQoKCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgdTMyIHBwY19pbnN0X3N1ZmZpeChzdHJ1Y3QgcHBjX2lu
c3QgeCkKewogcmV0dXJuIHguc3VmZml4Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBwcGNfaW5zdF9w
cmVmaXhlZChzdHJ1Y3QgcHBjX2luc3QgeCkKewogcmV0dXJuIChwcGNfaW5zdF9wcmltYXJ5
X29wY29kZSh4KSA9PSAxKSAmJiBwcGNfaW5zdF9zdWZmaXgoeCkgIT0gMHhmZjsKfQoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIHN0cnVjdCBwcGNfaW5zdCBwcGNfaW5zdF9zd2FiKHN0cnVjdCBwcGNfaW5zdCB4
KQp7CiByZXR1cm4gKChzdHJ1Y3QgcHBjX2luc3QpeyAudmFsID0gKChfX3UzMilfX2J1aWx0
aW5fYnN3YXAzMigoX191MzIpKHBwY19pbnN0X3ZhbCh4KSkpKSwgLnN1ZmZpeCA9ICgoX191
MzIpX19idWlsdGluX2Jzd2FwMzIoKF9fdTMyKShwcGNfaW5zdF9zdWZmaXgoeCkpKSkgfSkK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDsKfQoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHN0
cnVjdCBwcGNfaW5zdCBwcGNfaW5zdF9yZWFkKGNvbnN0IHN0cnVjdCBwcGNfaW5zdCAqcHRy
KQp7CiB1MzIgdmFsLCBzdWZmaXg7CgogdmFsID0gKih1MzIgKilwdHI7CiBpZiAoKHZhbCA+
PiAyNikgPT0gMSkgewogIHN1ZmZpeCA9ICooKHUzMiAqKXB0ciArIDEpOwogIHJldHVybiAo
KHN0cnVjdCBwcGNfaW5zdCl7IC52YWwgPSAodmFsKSwgLnN1ZmZpeCA9IChzdWZmaXgpIH0p
OwogfSBlbHNlIHsKICByZXR1cm4gKChzdHJ1Y3QgcHBjX2luc3QpeyAudmFsID0gKHZhbCks
IC5zdWZmaXggPSAweGZmIH0pOwogfQp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBwcGNfaW5zdF9lcXVh
bChzdHJ1Y3QgcHBjX2luc3QgeCwgc3RydWN0IHBwY19pbnN0IHkpCnsKIHJldHVybiAqKHU2
NCAqKSZ4ID09ICoodTY0ICopJnk7Cn0KIyA5OCAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9h
c20vaW5zdC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHBwY19pbnN0X2xlbihzdHJ1Y3QgcHBjX2luc3Qg
eCkKewogcmV0dXJuIHBwY19pbnN0X3ByZWZpeGVkKHgpID8gOCA6IDQ7Cn0KCgoKCgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgc3RydWN0IHBwY19pbnN0ICpwcGNfaW5zdF9uZXh0KHZvaWQgKmxvY2F0aW9uLCBz
dHJ1Y3QgcHBjX2luc3QgKnZhbHVlKQp7CiBzdHJ1Y3QgcHBjX2luc3QgdG1wOwoKIHRtcCA9
IHBwY19pbnN0X3JlYWQodmFsdWUpOwoKIHJldHVybiBsb2NhdGlvbiArIHBwY19pbnN0X2xl
bih0bXApOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgdTY0IHBwY19pbnN0X2FzX3U2NChzdHJ1Y3QgcHBjX2lu
c3QgeCkKewoKCgogcmV0dXJuICh1NjQpcHBjX2luc3RfdmFsKHgpIDw8IDMyIHwgcHBjX2lu
c3Rfc3VmZml4KHgpOwoKfQoKaW50IHByb2JlX3VzZXJfcmVhZF9pbnN0KHN0cnVjdCBwcGNf
aW5zdCAqaW5zdCwKICAgIHN0cnVjdCBwcGNfaW5zdCAqbmlwKTsKCmludCBwcm9iZV9rZXJu
ZWxfcmVhZF9pbnN0KHN0cnVjdCBwcGNfaW5zdCAqaW5zdCwKICAgICAgc3RydWN0IHBwY19p
bnN0ICpzcmMpOwojIDE1ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS91cHJvYmVzLmgi
IDIKCnR5cGVkZWYgcHBjX29wY29kZV90IHVwcm9iZV9vcGNvZGVfdDsKIyAyNSAiLi9hcmNo
L3Bvd2VycGMvaW5jbHVkZS9hc20vdXByb2Jlcy5oIgpzdHJ1Y3QgYXJjaF91cHJvYmUgewog
dW5pb24gewogIHN0cnVjdCBwcGNfaW5zdCBpbnNuOwogIHN0cnVjdCBwcGNfaW5zdCBpeG9s
OwogfTsKfTsKCnN0cnVjdCBhcmNoX3Vwcm9iZV90YXNrIHsKIHVuc2lnbmVkIGxvbmcgc2F2
ZWRfdHJhcF9ucjsKfTsKIyA1MCAiLi9pbmNsdWRlL2xpbnV4L3Vwcm9iZXMuaCIgMgoKZW51
bSB1cHJvYmVfdGFza19zdGF0ZSB7CiBVVEFTS19SVU5OSU5HLAogVVRBU0tfU1NURVAsCiBV
VEFTS19TU1RFUF9BQ0ssCiBVVEFTS19TU1RFUF9UUkFQUEVELAp9OwoKCgoKc3RydWN0IHVw
cm9iZV90YXNrIHsKIGVudW0gdXByb2JlX3Rhc2tfc3RhdGUgc3RhdGU7CgogdW5pb24gewog
IHN0cnVjdCB7CiAgIHN0cnVjdCBhcmNoX3Vwcm9iZV90YXNrIGF1dGFzazsKICAgdW5zaWdu
ZWQgbG9uZyB2YWRkcjsKICB9OwoKICBzdHJ1Y3QgewogICBzdHJ1Y3QgY2FsbGJhY2tfaGVh
ZCBkdXBfeG9sX3dvcms7CiAgIHVuc2lnbmVkIGxvbmcgZHVwX3hvbF9hZGRyOwogIH07CiB9
OwoKIHN0cnVjdCB1cHJvYmUgKmFjdGl2ZV91cHJvYmU7CiB1bnNpZ25lZCBsb25nIHhvbF92
YWRkcjsKCiBzdHJ1Y3QgcmV0dXJuX2luc3RhbmNlICpyZXR1cm5faW5zdGFuY2VzOwogdW5z
aWduZWQgaW50IGRlcHRoOwp9OwoKc3RydWN0IHJldHVybl9pbnN0YW5jZSB7CiBzdHJ1Y3Qg
dXByb2JlICp1cHJvYmU7CiB1bnNpZ25lZCBsb25nIGZ1bmM7CiB1bnNpZ25lZCBsb25nIHN0
YWNrOwogdW5zaWduZWQgbG9uZyBvcmlnX3JldF92YWRkcjsKIGJvb2wgY2hhaW5lZDsKCiBz
dHJ1Y3QgcmV0dXJuX2luc3RhbmNlICpuZXh0Owp9OwoKZW51bSBycF9jaGVjayB7CiBSUF9D
SEVDS19DQUxMLAogUlBfQ0hFQ0tfQ0hBSU5fQ0FMTCwKIFJQX0NIRUNLX1JFVCwKfTsKCnN0
cnVjdCB4b2xfYXJlYTsKCnN0cnVjdCB1cHJvYmVzX3N0YXRlIHsKIHN0cnVjdCB4b2xfYXJl
YSAqeG9sX2FyZWE7Cn07CgpleHRlcm4gdm9pZCBfX2F0dHJpYnV0ZV9fKChfX3NlY3Rpb25f
XygiLmluaXQudGV4dCIpKSkgX19hdHRyaWJ1dGVfXygoX19jb2xkX18pKSB1cHJvYmVzX2lu
aXQodm9pZCk7CmV4dGVybiBpbnQgc2V0X3N3YnAoc3RydWN0IGFyY2hfdXByb2JlICphdXAs
IHN0cnVjdCBtbV9zdHJ1Y3QgKm1tLCB1bnNpZ25lZCBsb25nIHZhZGRyKTsKZXh0ZXJuIGlu
dCBzZXRfb3JpZ19pbnNuKHN0cnVjdCBhcmNoX3Vwcm9iZSAqYXVwLCBzdHJ1Y3QgbW1fc3Ry
dWN0ICptbSwgdW5zaWduZWQgbG9uZyB2YWRkcik7CmV4dGVybiBib29sIGlzX3N3YnBfaW5z
bih1cHJvYmVfb3Bjb2RlX3QgKmluc24pOwpleHRlcm4gYm9vbCBpc190cmFwX2luc24odXBy
b2JlX29wY29kZV90ICppbnNuKTsKZXh0ZXJuIHVuc2lnbmVkIGxvbmcgdXByb2JlX2dldF9z
d2JwX2FkZHIoc3RydWN0IHB0X3JlZ3MgKnJlZ3MpOwpleHRlcm4gdW5zaWduZWQgbG9uZyB1
cHJvYmVfZ2V0X3RyYXBfYWRkcihzdHJ1Y3QgcHRfcmVncyAqcmVncyk7CmV4dGVybiBpbnQg
dXByb2JlX3dyaXRlX29wY29kZShzdHJ1Y3QgYXJjaF91cHJvYmUgKmF1cHJvYmUsIHN0cnVj
dCBtbV9zdHJ1Y3QgKm1tLCB1bnNpZ25lZCBsb25nIHZhZGRyLCB1cHJvYmVfb3Bjb2RlX3Qp
OwpleHRlcm4gaW50IHVwcm9iZV9yZWdpc3RlcihzdHJ1Y3QgaW5vZGUgKmlub2RlLCBsb2Zm
X3Qgb2Zmc2V0LCBzdHJ1Y3QgdXByb2JlX2NvbnN1bWVyICp1Yyk7CmV4dGVybiBpbnQgdXBy
b2JlX3JlZ2lzdGVyX3JlZmN0cihzdHJ1Y3QgaW5vZGUgKmlub2RlLCBsb2ZmX3Qgb2Zmc2V0
LCBsb2ZmX3QgcmVmX2N0cl9vZmZzZXQsIHN0cnVjdCB1cHJvYmVfY29uc3VtZXIgKnVjKTsK
ZXh0ZXJuIGludCB1cHJvYmVfYXBwbHkoc3RydWN0IGlub2RlICppbm9kZSwgbG9mZl90IG9m
ZnNldCwgc3RydWN0IHVwcm9iZV9jb25zdW1lciAqdWMsIGJvb2wpOwpleHRlcm4gdm9pZCB1
cHJvYmVfdW5yZWdpc3RlcihzdHJ1Y3QgaW5vZGUgKmlub2RlLCBsb2ZmX3Qgb2Zmc2V0LCBz
dHJ1Y3QgdXByb2JlX2NvbnN1bWVyICp1Yyk7CmV4dGVybiBpbnQgdXByb2JlX21tYXAoc3Ry
dWN0IHZtX2FyZWFfc3RydWN0ICp2bWEpOwpleHRlcm4gdm9pZCB1cHJvYmVfbXVubWFwKHN0
cnVjdCB2bV9hcmVhX3N0cnVjdCAqdm1hLCB1bnNpZ25lZCBsb25nIHN0YXJ0LCB1bnNpZ25l
ZCBsb25nIGVuZCk7CmV4dGVybiB2b2lkIHVwcm9iZV9zdGFydF9kdXBfbW1hcCh2b2lkKTsK
ZXh0ZXJuIHZvaWQgdXByb2JlX2VuZF9kdXBfbW1hcCh2b2lkKTsKZXh0ZXJuIHZvaWQgdXBy
b2JlX2R1cF9tbWFwKHN0cnVjdCBtbV9zdHJ1Y3QgKm9sZG1tLCBzdHJ1Y3QgbW1fc3RydWN0
ICpuZXdtbSk7CmV4dGVybiB2b2lkIHVwcm9iZV9mcmVlX3V0YXNrKHN0cnVjdCB0YXNrX3N0
cnVjdCAqdCk7CmV4dGVybiB2b2lkIHVwcm9iZV9jb3B5X3Byb2Nlc3Moc3RydWN0IHRhc2tf
c3RydWN0ICp0LCB1bnNpZ25lZCBsb25nIGZsYWdzKTsKZXh0ZXJuIGludCB1cHJvYmVfcG9z
dF9zc3RlcF9ub3RpZmllcihzdHJ1Y3QgcHRfcmVncyAqcmVncyk7CmV4dGVybiBpbnQgdXBy
b2JlX3ByZV9zc3RlcF9ub3RpZmllcihzdHJ1Y3QgcHRfcmVncyAqcmVncyk7CmV4dGVybiB2
b2lkIHVwcm9iZV9ub3RpZnlfcmVzdW1lKHN0cnVjdCBwdF9yZWdzICpyZWdzKTsKZXh0ZXJu
IGJvb2wgdXByb2JlX2Rlbnlfc2lnbmFsKHZvaWQpOwpleHRlcm4gYm9vbCBhcmNoX3Vwcm9i
ZV9za2lwX3NzdGVwKHN0cnVjdCBhcmNoX3Vwcm9iZSAqYXVwLCBzdHJ1Y3QgcHRfcmVncyAq
cmVncyk7CmV4dGVybiB2b2lkIHVwcm9iZV9jbGVhcl9zdGF0ZShzdHJ1Y3QgbW1fc3RydWN0
ICptbSk7CmV4dGVybiBpbnQgYXJjaF91cHJvYmVfYW5hbHl6ZV9pbnNuKHN0cnVjdCBhcmNo
X3Vwcm9iZSAqYXVwLCBzdHJ1Y3QgbW1fc3RydWN0ICptbSwgdW5zaWduZWQgbG9uZyBhZGRy
KTsKZXh0ZXJuIGludCBhcmNoX3Vwcm9iZV9wcmVfeG9sKHN0cnVjdCBhcmNoX3Vwcm9iZSAq
YXVwLCBzdHJ1Y3QgcHRfcmVncyAqcmVncyk7CmV4dGVybiBpbnQgYXJjaF91cHJvYmVfcG9z
dF94b2woc3RydWN0IGFyY2hfdXByb2JlICphdXAsIHN0cnVjdCBwdF9yZWdzICpyZWdzKTsK
ZXh0ZXJuIGJvb2wgYXJjaF91cHJvYmVfeG9sX3dhc190cmFwcGVkKHN0cnVjdCB0YXNrX3N0
cnVjdCAqdHNrKTsKZXh0ZXJuIGludCBhcmNoX3Vwcm9iZV9leGNlcHRpb25fbm90aWZ5KHN0
cnVjdCBub3RpZmllcl9ibG9jayAqc2VsZiwgdW5zaWduZWQgbG9uZyB2YWwsIHZvaWQgKmRh
dGEpOwpleHRlcm4gdm9pZCBhcmNoX3Vwcm9iZV9hYm9ydF94b2woc3RydWN0IGFyY2hfdXBy
b2JlICphdXAsIHN0cnVjdCBwdF9yZWdzICpyZWdzKTsKZXh0ZXJuIHVuc2lnbmVkIGxvbmcg
YXJjaF91cmV0cHJvYmVfaGlqYWNrX3JldHVybl9hZGRyKHVuc2lnbmVkIGxvbmcgdHJhbXBv
bGluZV92YWRkciwgc3RydWN0IHB0X3JlZ3MgKnJlZ3MpOwpleHRlcm4gYm9vbCBhcmNoX3Vy
ZXRwcm9iZV9pc19hbGl2ZShzdHJ1Y3QgcmV0dXJuX2luc3RhbmNlICpyZXQsIGVudW0gcnBf
Y2hlY2sgY3R4LCBzdHJ1Y3QgcHRfcmVncyAqcmVncyk7CmV4dGVybiBib29sIGFyY2hfdXBy
b2JlX2lnbm9yZShzdHJ1Y3QgYXJjaF91cHJvYmUgKmF1cCwgc3RydWN0IHB0X3JlZ3MgKnJl
Z3MpOwpleHRlcm4gdm9pZCBhcmNoX3Vwcm9iZV9jb3B5X2l4b2woc3RydWN0IHBhZ2UgKnBh
Z2UsIHVuc2lnbmVkIGxvbmcgdmFkZHIsCiAgICAgIHZvaWQgKnNyYywgdW5zaWduZWQgbG9u
ZyBsZW4pOwojIDE1ICIuL2luY2x1ZGUvbGludXgvbW1fdHlwZXMuaCIgMgojIDI2ICIuL2lu
Y2x1ZGUvbGludXgvbW1fdHlwZXMuaCIKc3RydWN0IGFkZHJlc3Nfc3BhY2U7CnN0cnVjdCBt
ZW1fY2dyb3VwOwojIDY4ICIuL2luY2x1ZGUvbGludXgvbW1fdHlwZXMuaCIKc3RydWN0IHBh
Z2UgewogdW5zaWduZWQgbG9uZyBmbGFnczsKCgoKCgoKCiB1bmlvbiB7CiAgc3RydWN0IHsK
CgoKCgogICBzdHJ1Y3QgbGlzdF9oZWFkIGxydTsKCiAgIHN0cnVjdCBhZGRyZXNzX3NwYWNl
ICptYXBwaW5nOwogICB1bnNpZ25lZCBsb25nIGluZGV4OwoKCgoKCgogICB1bnNpZ25lZCBs
b25nIHByaXZhdGU7CiAgfTsKICBzdHJ1Y3QgewoKCgoKICAgZG1hX2FkZHJfdCBkbWFfYWRk
cjsKICB9OwogIHN0cnVjdCB7CiAgIHVuaW9uIHsKICAgIHN0cnVjdCBsaXN0X2hlYWQgc2xh
Yl9saXN0OwogICAgc3RydWN0IHsKICAgICBzdHJ1Y3QgcGFnZSAqbmV4dDsKCiAgICAgaW50
IHBhZ2VzOwogICAgIGludCBwb2JqZWN0czsKCgoKCiAgICB9OwogICB9OwogICBzdHJ1Y3Qg
a21lbV9jYWNoZSAqc2xhYl9jYWNoZTsKCiAgIHZvaWQgKmZyZWVsaXN0OwogICB1bmlvbiB7
CiAgICB2b2lkICpzX21lbTsKICAgIHVuc2lnbmVkIGxvbmcgY291bnRlcnM7CiAgICBzdHJ1
Y3QgewogICAgIHVuc2lnbmVkIGludXNlOjE2OwogICAgIHVuc2lnbmVkIG9iamVjdHM6MTU7
CiAgICAgdW5zaWduZWQgZnJvemVuOjE7CiAgICB9OwogICB9OwogIH07CiAgc3RydWN0IHsK
ICAgdW5zaWduZWQgbG9uZyBjb21wb3VuZF9oZWFkOwoKCiAgIHVuc2lnbmVkIGNoYXIgY29t
cG91bmRfZHRvcjsKICAgdW5zaWduZWQgY2hhciBjb21wb3VuZF9vcmRlcjsKICAgYXRvbWlj
X3QgY29tcG91bmRfbWFwY291bnQ7CiAgfTsKICBzdHJ1Y3QgewogICB1bnNpZ25lZCBsb25n
IF9jb21wb3VuZF9wYWRfMTsKICAgYXRvbWljX3QgaHBhZ2VfcGlubmVkX3JlZmNvdW50OwoK
ICAgc3RydWN0IGxpc3RfaGVhZCBkZWZlcnJlZF9saXN0OwogIH07CiAgc3RydWN0IHsKICAg
dW5zaWduZWQgbG9uZyBfcHRfcGFkXzE7CiAgIHBndGFibGVfdCBwbWRfaHVnZV9wdGU7CiAg
IHVuc2lnbmVkIGxvbmcgX3B0X3BhZF8yOwogICB1bmlvbiB7CiAgICBzdHJ1Y3QgbW1fc3Ry
dWN0ICpwdF9tbTsKICAgIGF0b21pY190IHB0X2ZyYWdfcmVmY291bnQ7CiAgIH07CgoKCiAg
IHNwaW5sb2NrX3QgcHRsOwoKICB9OwogIHN0cnVjdCB7CgogICBzdHJ1Y3QgZGV2X3BhZ2Vt
YXAgKnBnbWFwOwogICB2b2lkICp6b25lX2RldmljZV9kYXRhOwojIDE3MiAiLi9pbmNsdWRl
L2xpbnV4L21tX3R5cGVzLmgiCiAgfTsKCgogIHN0cnVjdCBjYWxsYmFja19oZWFkIGNhbGxi
YWNrX2hlYWQ7CiB9OwoKIHVuaW9uIHsKCgoKCiAgYXRvbWljX3QgX21hcGNvdW50OwoKCgoK
CgoKICB1bnNpZ25lZCBpbnQgcGFnZV90eXBlOwoKICB1bnNpZ25lZCBpbnQgYWN0aXZlOwog
IGludCB1bml0czsKIH07CgoKIGF0b21pY190IF9yZWZjb3VudDsKIyAyMjIgIi4vaW5jbHVk
ZS9saW51eC9tbV90eXBlcy5oIgp9IDsKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBhdG9taWNfdCAqY29tcG91bmRf
bWFwY291bnRfcHRyKHN0cnVjdCBwYWdlICpwYWdlKQp7CiByZXR1cm4gJnBhZ2VbMV0uY29t
cG91bmRfbWFwY291bnQ7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBhdG9taWNfdCAqY29tcG91bmRfcGluY291
bnRfcHRyKHN0cnVjdCBwYWdlICpwYWdlKQp7CiByZXR1cm4gJnBhZ2VbMl0uaHBhZ2VfcGlu
bmVkX3JlZmNvdW50Owp9CiMgMjQ0ICIuL2luY2x1ZGUvbGludXgvbW1fdHlwZXMuaCIKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIHZvaWQgc2V0X3BhZ2VfcHJpdmF0ZShzdHJ1Y3QgcGFnZSAqcGFnZSwgdW5zaWdu
ZWQgbG9uZyBwcml2YXRlKQp7CiBwYWdlLT5wcml2YXRlID0gcHJpdmF0ZTsKfQoKc3RydWN0
IHBhZ2VfZnJhZ19jYWNoZSB7CiB2b2lkICogdmE7CgogX191MTYgb2Zmc2V0OwogX191MTYg
c2l6ZTsKCgoKCgoKIHVuc2lnbmVkIGludCBwYWdlY250X2JpYXM7CiBib29sIHBmbWVtYWxs
b2M7Cn07Cgp0eXBlZGVmIHVuc2lnbmVkIGxvbmcgdm1fZmxhZ3NfdDsKCgoKCgoKc3RydWN0
IHZtX3JlZ2lvbiB7CiBzdHJ1Y3QgcmJfbm9kZSB2bV9yYjsKIHZtX2ZsYWdzX3Qgdm1fZmxh
Z3M7CiB1bnNpZ25lZCBsb25nIHZtX3N0YXJ0OwogdW5zaWduZWQgbG9uZyB2bV9lbmQ7CiB1
bnNpZ25lZCBsb25nIHZtX3RvcDsKIHVuc2lnbmVkIGxvbmcgdm1fcGdvZmY7CiBzdHJ1Y3Qg
ZmlsZSAqdm1fZmlsZTsKCiBpbnQgdm1fdXNhZ2U7CiBib29sIHZtX2ljYWNoZV9mbHVzaGVk
IDogMTsKCn07CiMgMjkyICIuL2luY2x1ZGUvbGludXgvbW1fdHlwZXMuaCIKc3RydWN0IHZt
X3VzZXJmYXVsdGZkX2N0eCB7fTsKIyAzMDEgIi4vaW5jbHVkZS9saW51eC9tbV90eXBlcy5o
IgpzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgewoKCiB1bnNpZ25lZCBsb25nIHZtX3N0YXJ0Owog
dW5zaWduZWQgbG9uZyB2bV9lbmQ7CgoKCiBzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnZtX25l
eHQsICp2bV9wcmV2OwoKIHN0cnVjdCByYl9ub2RlIHZtX3JiOwoKCgoKCgoKIHVuc2lnbmVk
IGxvbmcgcmJfc3VidHJlZV9nYXA7CgoKCiBzdHJ1Y3QgbW1fc3RydWN0ICp2bV9tbTsKCgoK
CgogcGdwcm90X3Qgdm1fcGFnZV9wcm90OwogdW5zaWduZWQgbG9uZyB2bV9mbGFnczsKCgoK
Cgogc3RydWN0IHsKICBzdHJ1Y3QgcmJfbm9kZSByYjsKICB1bnNpZ25lZCBsb25nIHJiX3N1
YnRyZWVfbGFzdDsKIH0gc2hhcmVkOwoKCgoKCgoKIHN0cnVjdCBsaXN0X2hlYWQgYW5vbl92
bWFfY2hhaW47Cgogc3RydWN0IGFub25fdm1hICphbm9uX3ZtYTsKCgogY29uc3Qgc3RydWN0
IHZtX29wZXJhdGlvbnNfc3RydWN0ICp2bV9vcHM7CgoKIHVuc2lnbmVkIGxvbmcgdm1fcGdv
ZmY7Cgogc3RydWN0IGZpbGUgKiB2bV9maWxlOwogdm9pZCAqIHZtX3ByaXZhdGVfZGF0YTsK
CgogYXRvbWljX2xvbmdfdCBzd2FwX3JlYWRhaGVhZF9pbmZvOwoKCgoKCgoKIHN0cnVjdCB2
bV91c2VyZmF1bHRmZF9jdHggdm1fdXNlcmZhdWx0ZmRfY3R4Owp9IDsKCnN0cnVjdCBjb3Jl
X3RocmVhZCB7CiBzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRhc2s7CiBzdHJ1Y3QgY29yZV90aHJl
YWQgKm5leHQ7Cn07CgpzdHJ1Y3QgY29yZV9zdGF0ZSB7CiBhdG9taWNfdCBucl90aHJlYWRz
Owogc3RydWN0IGNvcmVfdGhyZWFkIGR1bXBlcjsKIHN0cnVjdCBjb21wbGV0aW9uIHN0YXJ0
dXA7Cn07CgpzdHJ1Y3Qga2lvY3R4X3RhYmxlOwpzdHJ1Y3QgbW1fc3RydWN0IHsKIHN0cnVj
dCB7CiAgc3RydWN0IHZtX2FyZWFfc3RydWN0ICptbWFwOwogIHN0cnVjdCByYl9yb290IG1t
X3JiOwogIHU2NCB2bWFjYWNoZV9zZXFudW07CgogIHVuc2lnbmVkIGxvbmcgKCpnZXRfdW5t
YXBwZWRfYXJlYSkgKHN0cnVjdCBmaWxlICpmaWxwLAogICAgdW5zaWduZWQgbG9uZyBhZGRy
LCB1bnNpZ25lZCBsb25nIGxlbiwKICAgIHVuc2lnbmVkIGxvbmcgcGdvZmYsIHVuc2lnbmVk
IGxvbmcgZmxhZ3MpOwoKICB1bnNpZ25lZCBsb25nIG1tYXBfYmFzZTsKICB1bnNpZ25lZCBs
b25nIG1tYXBfbGVnYWN5X2Jhc2U7CgoKCgoKICB1bnNpZ25lZCBsb25nIHRhc2tfc2l6ZTsK
ICB1bnNpZ25lZCBsb25nIGhpZ2hlc3Rfdm1fZW5kOwogIHBnZF90ICogcGdkOwojIDQxMiAi
Li9pbmNsdWRlL2xpbnV4L21tX3R5cGVzLmgiCiAgYXRvbWljX3QgbWVtYmFycmllcl9zdGF0
ZTsKIyA0MjQgIi4vaW5jbHVkZS9saW51eC9tbV90eXBlcy5oIgogIGF0b21pY190IG1tX3Vz
ZXJzOwojIDQzMyAiLi9pbmNsdWRlL2xpbnV4L21tX3R5cGVzLmgiCiAgYXRvbWljX3QgbW1f
Y291bnQ7CgoKICBhdG9taWNfbG9uZ190IHBndGFibGVzX2J5dGVzOwoKICBpbnQgbWFwX2Nv
dW50OwoKICBzcGlubG9ja190IHBhZ2VfdGFibGVfbG9jazsKCgogIHN0cnVjdCByd19zZW1h
cGhvcmUgbW1hcF9sb2NrOwoKICBzdHJ1Y3QgbGlzdF9oZWFkIG1tbGlzdDsKCgoKCgoKICB1
bnNpZ25lZCBsb25nIGhpd2F0ZXJfcnNzOwogIHVuc2lnbmVkIGxvbmcgaGl3YXRlcl92bTsK
CiAgdW5zaWduZWQgbG9uZyB0b3RhbF92bTsKICB1bnNpZ25lZCBsb25nIGxvY2tlZF92bTsK
ICBhdG9taWM2NF90IHBpbm5lZF92bTsKICB1bnNpZ25lZCBsb25nIGRhdGFfdm07CiAgdW5z
aWduZWQgbG9uZyBleGVjX3ZtOwogIHVuc2lnbmVkIGxvbmcgc3RhY2tfdm07CiAgdW5zaWdu
ZWQgbG9uZyBkZWZfZmxhZ3M7CgogIHNwaW5sb2NrX3QgYXJnX2xvY2s7CiAgdW5zaWduZWQg
bG9uZyBzdGFydF9jb2RlLCBlbmRfY29kZSwgc3RhcnRfZGF0YSwgZW5kX2RhdGE7CiAgdW5z
aWduZWQgbG9uZyBzdGFydF9icmssIGJyaywgc3RhcnRfc3RhY2s7CiAgdW5zaWduZWQgbG9u
ZyBhcmdfc3RhcnQsIGFyZ19lbmQsIGVudl9zdGFydCwgZW52X2VuZDsKCiAgdW5zaWduZWQg
bG9uZyBzYXZlZF9hdXh2WygyKigxNCArIDIwICsgMSkpXTsKCgoKCgogIHN0cnVjdCBtbV9y
c3Nfc3RhdCByc3Nfc3RhdDsKCiAgc3RydWN0IGxpbnV4X2JpbmZtdCAqYmluZm10OwoKCiAg
bW1fY29udGV4dF90IGNvbnRleHQ7CgogIHVuc2lnbmVkIGxvbmcgZmxhZ3M7CgogIHN0cnVj
dCBjb3JlX3N0YXRlICpjb3JlX3N0YXRlOwoKCiAgc3BpbmxvY2tfdCBpb2N0eF9sb2NrOwog
IHN0cnVjdCBraW9jdHhfdGFibGUgKmlvY3R4X3RhYmxlOwojIDUwMiAiLi9pbmNsdWRlL2xp
bnV4L21tX3R5cGVzLmgiCiAgc3RydWN0IHVzZXJfbmFtZXNwYWNlICp1c2VyX25zOwoKCiAg
c3RydWN0IGZpbGUgKmV4ZV9maWxlOwojIDUzMSAiLi9pbmNsdWRlL2xpbnV4L21tX3R5cGVz
LmgiCiAgYXRvbWljX3QgdGxiX2ZsdXNoX3BlbmRpbmc7CgoKCgogIHN0cnVjdCB1cHJvYmVz
X3N0YXRlIHVwcm9iZXNfc3RhdGU7CgogIGF0b21pY19sb25nX3QgaHVnZXRsYl91c2FnZTsK
CiAgc3RydWN0IHdvcmtfc3RydWN0IGFzeW5jX3B1dF93b3JrOwogfSA7CgoKCgoKIHVuc2ln
bmVkIGxvbmcgY3B1X2JpdG1hcFtdOwp9OwoKZXh0ZXJuIHN0cnVjdCBtbV9zdHJ1Y3QgaW5p
dF9tbTsKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBtbV9pbml0X2NwdW1hc2soc3RydWN0IG1tX3N0cnVj
dCAqbW0pCnsKIHVuc2lnbmVkIGxvbmcgY3B1X2JpdG1hcCA9ICh1bnNpZ25lZCBsb25nKW1t
OwoKIGNwdV9iaXRtYXAgKz0gX19idWlsdGluX29mZnNldG9mKHN0cnVjdCBtbV9zdHJ1Y3Qs
IGNwdV9iaXRtYXApOwogY3B1bWFza19jbGVhcigoc3RydWN0IGNwdW1hc2sgKiljcHVfYml0
bWFwKTsKfQoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBjcHVtYXNrX3QgKm1tX2NwdW1hc2soc3RydWN0IG1tX3N0
cnVjdCAqbW0pCnsKIHJldHVybiAoc3RydWN0IGNwdW1hc2sgKikmbW0tPmNwdV9iaXRtYXA7
Cn0KCnN0cnVjdCBtbXVfZ2F0aGVyOwpleHRlcm4gdm9pZCB0bGJfZ2F0aGVyX21tdShzdHJ1
Y3QgbW11X2dhdGhlciAqdGxiLCBzdHJ1Y3QgbW1fc3RydWN0ICptbSwKICAgIHVuc2lnbmVk
IGxvbmcgc3RhcnQsIHVuc2lnbmVkIGxvbmcgZW5kKTsKZXh0ZXJuIHZvaWQgdGxiX2Zpbmlz
aF9tbXUoc3RydWN0IG1tdV9nYXRoZXIgKnRsYiwKICAgIHVuc2lnbmVkIGxvbmcgc3RhcnQs
IHVuc2lnbmVkIGxvbmcgZW5kKTsKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGluaXRfdGxiX2ZsdXNoX3Bl
bmRpbmcoc3RydWN0IG1tX3N0cnVjdCAqbW0pCnsKIGF0b21pY19zZXQoJm1tLT50bGJfZmx1
c2hfcGVuZGluZywgMCk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGluY190bGJfZmx1c2hfcGVuZGlu
ZyhzdHJ1Y3QgbW1fc3RydWN0ICptbSkKewogYXRvbWljX2luYygmbW0tPnRsYl9mbHVzaF9w
ZW5kaW5nKTsKIyA2MTcgIi4vaW5jbHVkZS9saW51eC9tbV90eXBlcy5oIgp9CgpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgdm9pZCBkZWNfdGxiX2ZsdXNoX3BlbmRpbmcoc3RydWN0IG1tX3N0cnVjdCAqbW0pCnsK
IyA2MjkgIi4vaW5jbHVkZS9saW51eC9tbV90eXBlcy5oIgogYXRvbWljX2RlYygmbW0tPnRs
Yl9mbHVzaF9wZW5kaW5nKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgbW1fdGxiX2ZsdXNoX3BlbmRp
bmcoc3RydWN0IG1tX3N0cnVjdCAqbW0pCnsKIyA2NDIgIi4vaW5jbHVkZS9saW51eC9tbV90
eXBlcy5oIgogcmV0dXJuIGF0b21pY19yZWFkKCZtbS0+dGxiX2ZsdXNoX3BlbmRpbmcpOwp9
CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgYm9vbCBtbV90bGJfZmx1c2hfbmVzdGVkKHN0cnVjdCBtbV9zdHJ1Y3Qg
Km1tKQp7CgoKCgoKCgogcmV0dXJuIGF0b21pY19yZWFkKCZtbS0+dGxiX2ZsdXNoX3BlbmRp
bmcpID4gMTsKfQoKc3RydWN0IHZtX2ZhdWx0OwoKCgoKCgp0eXBlZGVmIHVuc2lnbmVkIGlu
dCB2bV9mYXVsdF90OwojIDY5MSAiLi9pbmNsdWRlL2xpbnV4L21tX3R5cGVzLmgiCmVudW0g
dm1fZmF1bHRfcmVhc29uIHsKIFZNX0ZBVUxUX09PTSA9ICggdm1fZmF1bHRfdCkweDAwMDAw
MSwKIFZNX0ZBVUxUX1NJR0JVUyA9ICggdm1fZmF1bHRfdCkweDAwMDAwMiwKIFZNX0ZBVUxU
X01BSk9SID0gKCB2bV9mYXVsdF90KTB4MDAwMDA0LAogVk1fRkFVTFRfV1JJVEUgPSAoIHZt
X2ZhdWx0X3QpMHgwMDAwMDgsCiBWTV9GQVVMVF9IV1BPSVNPTiA9ICggdm1fZmF1bHRfdCkw
eDAwMDAxMCwKIFZNX0ZBVUxUX0hXUE9JU09OX0xBUkdFID0gKCB2bV9mYXVsdF90KTB4MDAw
MDIwLAogVk1fRkFVTFRfU0lHU0VHViA9ICggdm1fZmF1bHRfdCkweDAwMDA0MCwKIFZNX0ZB
VUxUX05PUEFHRSA9ICggdm1fZmF1bHRfdCkweDAwMDEwMCwKIFZNX0ZBVUxUX0xPQ0tFRCA9
ICggdm1fZmF1bHRfdCkweDAwMDIwMCwKIFZNX0ZBVUxUX1JFVFJZID0gKCB2bV9mYXVsdF90
KTB4MDAwNDAwLAogVk1fRkFVTFRfRkFMTEJBQ0sgPSAoIHZtX2ZhdWx0X3QpMHgwMDA4MDAs
CiBWTV9GQVVMVF9ET05FX0NPVyA9ICggdm1fZmF1bHRfdCkweDAwMTAwMCwKIFZNX0ZBVUxU
X05FRUREU1lOQyA9ICggdm1fZmF1bHRfdCkweDAwMjAwMCwKIFZNX0ZBVUxUX0hJTkRFWF9N
QVNLID0gKCB2bV9mYXVsdF90KTB4MGYwMDAwLAp9OwojIDczMSAiLi9pbmNsdWRlL2xpbnV4
L21tX3R5cGVzLmgiCnN0cnVjdCB2bV9zcGVjaWFsX21hcHBpbmcgewogY29uc3QgY2hhciAq
bmFtZTsKCgoKCgoKCiBzdHJ1Y3QgcGFnZSAqKnBhZ2VzOwoKCgoKCiB2bV9mYXVsdF90ICgq
ZmF1bHQpKGNvbnN0IHN0cnVjdCB2bV9zcGVjaWFsX21hcHBpbmcgKnNtLAogICAgc3RydWN0
IHZtX2FyZWFfc3RydWN0ICp2bWEsCiAgICBzdHJ1Y3Qgdm1fZmF1bHQgKnZtZik7CgogaW50
ICgqbXJlbWFwKShjb25zdCBzdHJ1Y3Qgdm1fc3BlY2lhbF9tYXBwaW5nICpzbSwKICAgICAg
IHN0cnVjdCB2bV9hcmVhX3N0cnVjdCAqbmV3X3ZtYSk7Cn07CgplbnVtIHRsYl9mbHVzaF9y
ZWFzb24gewogVExCX0ZMVVNIX09OX1RBU0tfU1dJVENILAogVExCX1JFTU9URV9TSE9PVERP
V04sCiBUTEJfTE9DQUxfU0hPT1RET1dOLAogVExCX0xPQ0FMX01NX1NIT09URE9XTiwKIFRM
Ql9SRU1PVEVfU0VORF9JUEksCiBOUl9UTEJfRkxVU0hfUkVBU09OUywKfTsKCgoKCgp0eXBl
ZGVmIHN0cnVjdCB7CiB1bnNpZ25lZCBsb25nIHZhbDsKfSBzd3BfZW50cnlfdDsKIyAyMiAi
Li9pbmNsdWRlL2xpbnV4L21tem9uZS5oIiAyCiMgMSAiLi9pbmNsdWRlL2xpbnV4L3BhZ2Ut
ZmxhZ3MuaCIgMQojIDEwNCAiLi9pbmNsdWRlL2xpbnV4L3BhZ2UtZmxhZ3MuaCIKZW51bSBw
YWdlZmxhZ3MgewogUEdfbG9ja2VkLAogUEdfcmVmZXJlbmNlZCwKIFBHX3VwdG9kYXRlLAog
UEdfZGlydHksCiBQR19scnUsCiBQR19hY3RpdmUsCiBQR193b3JraW5nc2V0LAogUEdfd2Fp
dGVycywKIFBHX2Vycm9yLAogUEdfc2xhYiwKIFBHX293bmVyX3ByaXZfMSwKIFBHX2FyY2hf
MSwKIFBHX3Jlc2VydmVkLAogUEdfcHJpdmF0ZSwKIFBHX3ByaXZhdGVfMiwKIFBHX3dyaXRl
YmFjaywKIFBHX2hlYWQsCiBQR19tYXBwZWR0b2Rpc2ssCiBQR19yZWNsYWltLAogUEdfc3dh
cGJhY2tlZCwKIFBHX3VuZXZpY3RhYmxlLAoKIFBHX21sb2NrZWQsCiMgMTM5ICIuL2luY2x1
ZGUvbGludXgvcGFnZS1mbGFncy5oIgogX19OUl9QQUdFRkxBR1MsCgoKIFBHX2NoZWNrZWQg
PSBQR19vd25lcl9wcml2XzEsCgoKIFBHX3N3YXBjYWNoZSA9IFBHX293bmVyX3ByaXZfMSwK
CgoKCgogUEdfZnNjYWNoZSA9IFBHX3ByaXZhdGVfMiwKCgoKIFBHX3Bpbm5lZCA9IFBHX293
bmVyX3ByaXZfMSwKCiBQR19zYXZlcGlubmVkID0gUEdfZGlydHksCgogUEdfZm9yZWlnbiA9
IFBHX293bmVyX3ByaXZfMSwKCiBQR194ZW5fcmVtYXBwZWQgPSBQR19vd25lcl9wcml2XzEs
CgoKIFBHX3Nsb2JfZnJlZSA9IFBHX3ByaXZhdGUsCgoKIFBHX2RvdWJsZV9tYXAgPSBQR19w
cml2YXRlXzIsCgoKIFBHX2lzb2xhdGVkID0gUEdfcmVjbGFpbSwKCgogUEdfcmVwb3J0ZWQg
PSBQR191cHRvZGF0ZSwKfTsKCgoKc3RydWN0IHBhZ2U7CgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IHBh
Z2UgKmNvbXBvdW5kX2hlYWQoc3RydWN0IHBhZ2UgKnBhZ2UpCnsKIHVuc2lnbmVkIGxvbmcg
aGVhZCA9ICh7IGRvIHsgZXh0ZXJuIHZvaWQgX19jb21waWxldGltZV9hc3NlcnRfMTEyKHZv
aWQpIF9fYXR0cmlidXRlX18oKF9fZXJyb3JfXygiVW5zdXBwb3J0ZWQgYWNjZXNzIHNpemUg
Zm9yIHtSRUFELFdSSVRFfV9PTkNFKCkuIikpKTsgaWYgKCEoKHNpemVvZihwYWdlLT5jb21w
b3VuZF9oZWFkKSA9PSBzaXplb2YoY2hhcikgfHwgc2l6ZW9mKHBhZ2UtPmNvbXBvdW5kX2hl
YWQpID09IHNpemVvZihzaG9ydCkgfHwgc2l6ZW9mKHBhZ2UtPmNvbXBvdW5kX2hlYWQpID09
IHNpemVvZihpbnQpIHx8IHNpemVvZihwYWdlLT5jb21wb3VuZF9oZWFkKSA9PSBzaXplb2Yo
bG9uZykpIHx8IHNpemVvZihwYWdlLT5jb21wb3VuZF9oZWFkKSA9PSBzaXplb2YobG9uZyBs
b25nKSkpIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzExMigpOyB9IHdoaWxlICgwKTsgKHsgdHlw
ZW9mKCBfR2VuZXJpYygocGFnZS0+Y29tcG91bmRfaGVhZCksIGNoYXI6IChjaGFyKTAsIHVu
c2lnbmVkIGNoYXI6ICh1bnNpZ25lZCBjaGFyKTAsIHNpZ25lZCBjaGFyOiAoc2lnbmVkIGNo
YXIpMCwgdW5zaWduZWQgc2hvcnQ6ICh1bnNpZ25lZCBzaG9ydCkwLCBzaWduZWQgc2hvcnQ6
IChzaWduZWQgc2hvcnQpMCwgdW5zaWduZWQgaW50OiAodW5zaWduZWQgaW50KTAsIHNpZ25l
ZCBpbnQ6IChzaWduZWQgaW50KTAsIHVuc2lnbmVkIGxvbmc6ICh1bnNpZ25lZCBsb25nKTAs
IHNpZ25lZCBsb25nOiAoc2lnbmVkIGxvbmcpMCwgdW5zaWduZWQgbG9uZyBsb25nOiAodW5z
aWduZWQgbG9uZyBsb25nKTAsIHNpZ25lZCBsb25nIGxvbmc6IChzaWduZWQgbG9uZyBsb25n
KTAsIGRlZmF1bHQ6IChwYWdlLT5jb21wb3VuZF9oZWFkKSkpIF9feCA9ICgqKGNvbnN0IHZv
bGF0aWxlIHR5cGVvZiggX0dlbmVyaWMoKHBhZ2UtPmNvbXBvdW5kX2hlYWQpLCBjaGFyOiAo
Y2hhcikwLCB1bnNpZ25lZCBjaGFyOiAodW5zaWduZWQgY2hhcikwLCBzaWduZWQgY2hhcjog
KHNpZ25lZCBjaGFyKTAsIHVuc2lnbmVkIHNob3J0OiAodW5zaWduZWQgc2hvcnQpMCwgc2ln
bmVkIHNob3J0OiAoc2lnbmVkIHNob3J0KTAsIHVuc2lnbmVkIGludDogKHVuc2lnbmVkIGlu
dCkwLCBzaWduZWQgaW50OiAoc2lnbmVkIGludCkwLCB1bnNpZ25lZCBsb25nOiAodW5zaWdu
ZWQgbG9uZykwLCBzaWduZWQgbG9uZzogKHNpZ25lZCBsb25nKTAsIHVuc2lnbmVkIGxvbmcg
bG9uZzogKHVuc2lnbmVkIGxvbmcgbG9uZykwLCBzaWduZWQgbG9uZyBsb25nOiAoc2lnbmVk
IGxvbmcgbG9uZykwLCBkZWZhdWx0OiAocGFnZS0+Y29tcG91bmRfaGVhZCkpKSAqKSYocGFn
ZS0+Y29tcG91bmRfaGVhZCkpOyBkbyB7IH0gd2hpbGUgKDApOyAodHlwZW9mKHBhZ2UtPmNv
bXBvdW5kX2hlYWQpKV9feDsgfSk7IH0pOwoKIGlmIChfX2J1aWx0aW5fZXhwZWN0KCEhKGhl
YWQgJiAxKSwgMCkpCiAgcmV0dXJuIChzdHJ1Y3QgcGFnZSAqKSAoaGVhZCAtIDEpOwogcmV0
dXJuIHBhZ2U7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVf
XykpIGludCBQYWdlVGFpbChzdHJ1Y3QgcGFnZSAqcGFnZSkKewogcmV0dXJuICh7IGRvIHsg
ZXh0ZXJuIHZvaWQgX19jb21waWxldGltZV9hc3NlcnRfMTEzKHZvaWQpIF9fYXR0cmlidXRl
X18oKF9fZXJyb3JfXygiVW5zdXBwb3J0ZWQgYWNjZXNzIHNpemUgZm9yIHtSRUFELFdSSVRF
fV9PTkNFKCkuIikpKTsgaWYgKCEoKHNpemVvZihwYWdlLT5jb21wb3VuZF9oZWFkKSA9PSBz
aXplb2YoY2hhcikgfHwgc2l6ZW9mKHBhZ2UtPmNvbXBvdW5kX2hlYWQpID09IHNpemVvZihz
aG9ydCkgfHwgc2l6ZW9mKHBhZ2UtPmNvbXBvdW5kX2hlYWQpID09IHNpemVvZihpbnQpIHx8
IHNpemVvZihwYWdlLT5jb21wb3VuZF9oZWFkKSA9PSBzaXplb2YobG9uZykpIHx8IHNpemVv
ZihwYWdlLT5jb21wb3VuZF9oZWFkKSA9PSBzaXplb2YobG9uZyBsb25nKSkpIF9fY29tcGls
ZXRpbWVfYXNzZXJ0XzExMygpOyB9IHdoaWxlICgwKTsgKHsgdHlwZW9mKCBfR2VuZXJpYygo
cGFnZS0+Y29tcG91bmRfaGVhZCksIGNoYXI6IChjaGFyKTAsIHVuc2lnbmVkIGNoYXI6ICh1
bnNpZ25lZCBjaGFyKTAsIHNpZ25lZCBjaGFyOiAoc2lnbmVkIGNoYXIpMCwgdW5zaWduZWQg
c2hvcnQ6ICh1bnNpZ25lZCBzaG9ydCkwLCBzaWduZWQgc2hvcnQ6IChzaWduZWQgc2hvcnQp
MCwgdW5zaWduZWQgaW50OiAodW5zaWduZWQgaW50KTAsIHNpZ25lZCBpbnQ6IChzaWduZWQg
aW50KTAsIHVuc2lnbmVkIGxvbmc6ICh1bnNpZ25lZCBsb25nKTAsIHNpZ25lZCBsb25nOiAo
c2lnbmVkIGxvbmcpMCwgdW5zaWduZWQgbG9uZyBsb25nOiAodW5zaWduZWQgbG9uZyBsb25n
KTAsIHNpZ25lZCBsb25nIGxvbmc6IChzaWduZWQgbG9uZyBsb25nKTAsIGRlZmF1bHQ6IChw
YWdlLT5jb21wb3VuZF9oZWFkKSkpIF9feCA9ICgqKGNvbnN0IHZvbGF0aWxlIHR5cGVvZigg
X0dlbmVyaWMoKHBhZ2UtPmNvbXBvdW5kX2hlYWQpLCBjaGFyOiAoY2hhcikwLCB1bnNpZ25l
ZCBjaGFyOiAodW5zaWduZWQgY2hhcikwLCBzaWduZWQgY2hhcjogKHNpZ25lZCBjaGFyKTAs
IHVuc2lnbmVkIHNob3J0OiAodW5zaWduZWQgc2hvcnQpMCwgc2lnbmVkIHNob3J0OiAoc2ln
bmVkIHNob3J0KTAsIHVuc2lnbmVkIGludDogKHVuc2lnbmVkIGludCkwLCBzaWduZWQgaW50
OiAoc2lnbmVkIGludCkwLCB1bnNpZ25lZCBsb25nOiAodW5zaWduZWQgbG9uZykwLCBzaWdu
ZWQgbG9uZzogKHNpZ25lZCBsb25nKTAsIHVuc2lnbmVkIGxvbmcgbG9uZzogKHVuc2lnbmVk
IGxvbmcgbG9uZykwLCBzaWduZWQgbG9uZyBsb25nOiAoc2lnbmVkIGxvbmcgbG9uZykwLCBk
ZWZhdWx0OiAocGFnZS0+Y29tcG91bmRfaGVhZCkpKSAqKSYocGFnZS0+Y29tcG91bmRfaGVh
ZCkpOyBkbyB7IH0gd2hpbGUgKDApOyAodHlwZW9mKHBhZ2UtPmNvbXBvdW5kX2hlYWQpKV9f
eDsgfSk7IH0pICYgMTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lu
bGluZV9fKSkgaW50IFBhZ2VDb21wb3VuZChzdHJ1Y3QgcGFnZSAqcGFnZSkKewogcmV0dXJu
IHRlc3RfYml0KFBHX2hlYWQsICZwYWdlLT5mbGFncykgfHwgUGFnZVRhaWwocGFnZSk7Cn0K
CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgaW50IFBhZ2VQb2lzb25lZChjb25zdCBzdHJ1Y3QgcGFnZSAqcGFnZSkK
ewogcmV0dXJuIHBhZ2UtPmZsYWdzID09IC0xbDsKfQoKCgoKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgcGFn
ZV9pbml0X3BvaXNvbihzdHJ1Y3QgcGFnZSAqcGFnZSwgc2l6ZV90IHNpemUpCnsKfQojIDMy
MCAiLi9pbmNsdWRlL2xpbnV4L3BhZ2UtZmxhZ3MuaCIKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRl
X18oKF9fYWx3YXlzX2lubGluZV9fKSkgaW50IFBhZ2VMb2NrZWQoc3RydWN0IHBhZ2UgKnBh
Z2UpIHsgcmV0dXJuIHRlc3RfYml0KFBHX2xvY2tlZCwgJih7ICgodm9pZCkoc2l6ZW9mKCgg
bG9uZykoMCAmJiBQYWdlVGFpbChwYWdlKSkpKSk7ICh7ICgodm9pZCkoc2l6ZW9mKCggbG9u
ZykoUGFnZVBvaXNvbmVkKGNvbXBvdW5kX2hlYWQocGFnZSkpKSkpKTsgY29tcG91bmRfaGVh
ZChwYWdlKTsgfSk7IH0pLT5mbGFncyk7IH0gc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9f
YWx3YXlzX2lubGluZV9fKSkgdm9pZCBfX1NldFBhZ2VMb2NrZWQoc3RydWN0IHBhZ2UgKnBh
Z2UpIHsgX19zZXRfYml0KFBHX2xvY2tlZCwgJih7ICgodm9pZCkoc2l6ZW9mKCggbG9uZyko
MSAmJiBQYWdlVGFpbChwYWdlKSkpKSk7ICh7ICgodm9pZCkoc2l6ZW9mKCggbG9uZykoUGFn
ZVBvaXNvbmVkKGNvbXBvdW5kX2hlYWQocGFnZSkpKSkpKTsgY29tcG91bmRfaGVhZChwYWdl
KTsgfSk7IH0pLT5mbGFncyk7IH0gc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlz
X2lubGluZV9fKSkgdm9pZCBfX0NsZWFyUGFnZUxvY2tlZChzdHJ1Y3QgcGFnZSAqcGFnZSkg
eyBfX2NsZWFyX2JpdChQR19sb2NrZWQsICYoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKDEg
JiYgUGFnZVRhaWwocGFnZSkpKSkpOyAoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKFBhZ2VQ
b2lzb25lZChjb21wb3VuZF9oZWFkKHBhZ2UpKSkpKSk7IGNvbXBvdW5kX2hlYWQocGFnZSk7
IH0pOyB9KS0+ZmxhZ3MpOyB9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19p
bmxpbmVfXykpIGludCBQYWdlV2FpdGVycyhzdHJ1Y3QgcGFnZSAqcGFnZSkgeyByZXR1cm4g
dGVzdF9iaXQoUEdfd2FpdGVycywgJih7ICgodm9pZCkoc2l6ZW9mKCggbG9uZykoUGFnZVRh
aWwocGFnZSkpKSkpOyAoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKFBhZ2VQb2lzb25lZChw
YWdlKSkpKSk7IHBhZ2U7IH0pOyB9KS0+ZmxhZ3MpOyB9IHN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0
ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHZvaWQgU2V0UGFnZVdhaXRlcnMoc3RydWN0IHBh
Z2UgKnBhZ2UpIHsgc2V0X2JpdChQR193YWl0ZXJzLCAmKHsgKCh2b2lkKShzaXplb2YoKCBs
b25nKShQYWdlVGFpbChwYWdlKSkpKSk7ICh7ICgodm9pZCkoc2l6ZW9mKCggbG9uZykoUGFn
ZVBvaXNvbmVkKHBhZ2UpKSkpKTsgcGFnZTsgfSk7IH0pLT5mbGFncyk7IH0gc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgdm9pZCBDbGVhclBhZ2VXYWl0
ZXJzKHN0cnVjdCBwYWdlICpwYWdlKSB7IGNsZWFyX2JpdChQR193YWl0ZXJzLCAmKHsgKCh2
b2lkKShzaXplb2YoKCBsb25nKShQYWdlVGFpbChwYWdlKSkpKSk7ICh7ICgodm9pZCkoc2l6
ZW9mKCggbG9uZykoUGFnZVBvaXNvbmVkKHBhZ2UpKSkpKTsgcGFnZTsgfSk7IH0pLT5mbGFn
cyk7IH0gc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgdm9p
ZCBfX0NsZWFyUGFnZVdhaXRlcnMoc3RydWN0IHBhZ2UgKnBhZ2UpIHsgX19jbGVhcl9iaXQo
UEdfd2FpdGVycywgJih7ICgodm9pZCkoc2l6ZW9mKCggbG9uZykoUGFnZVRhaWwocGFnZSkp
KSkpOyAoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKFBhZ2VQb2lzb25lZChwYWdlKSkpKSk7
IHBhZ2U7IH0pOyB9KS0+ZmxhZ3MpOyB9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fs
d2F5c19pbmxpbmVfXykpIGludCBQYWdlRXJyb3Ioc3RydWN0IHBhZ2UgKnBhZ2UpIHsgcmV0
dXJuIHRlc3RfYml0KFBHX2Vycm9yLCAmKHsgKCh2b2lkKShzaXplb2YoKCBsb25nKSgwICYm
IFBhZ2VUYWlsKHBhZ2UpKSkpKTsgKHsgKCh2b2lkKShzaXplb2YoKCBsb25nKShQYWdlUG9p
c29uZWQoY29tcG91bmRfaGVhZChwYWdlKSkpKSkpOyBjb21wb3VuZF9oZWFkKHBhZ2UpOyB9
KTsgfSktPmZsYWdzKTsgfSBzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5s
aW5lX18pKSB2b2lkIFNldFBhZ2VFcnJvcihzdHJ1Y3QgcGFnZSAqcGFnZSkgeyBzZXRfYml0
KFBHX2Vycm9yLCAmKHsgKCh2b2lkKShzaXplb2YoKCBsb25nKSgxICYmIFBhZ2VUYWlsKHBh
Z2UpKSkpKTsgKHsgKCh2b2lkKShzaXplb2YoKCBsb25nKShQYWdlUG9pc29uZWQoY29tcG91
bmRfaGVhZChwYWdlKSkpKSkpOyBjb21wb3VuZF9oZWFkKHBhZ2UpOyB9KTsgfSktPmZsYWdz
KTsgfSBzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB2b2lk
IENsZWFyUGFnZUVycm9yKHN0cnVjdCBwYWdlICpwYWdlKSB7IGNsZWFyX2JpdChQR19lcnJv
ciwgJih7ICgodm9pZCkoc2l6ZW9mKCggbG9uZykoMSAmJiBQYWdlVGFpbChwYWdlKSkpKSk7
ICh7ICgodm9pZCkoc2l6ZW9mKCggbG9uZykoUGFnZVBvaXNvbmVkKGNvbXBvdW5kX2hlYWQo
cGFnZSkpKSkpKTsgY29tcG91bmRfaGVhZChwYWdlKTsgfSk7IH0pLT5mbGFncyk7IH0gc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgaW50IFRlc3RDbGVh
clBhZ2VFcnJvcihzdHJ1Y3QgcGFnZSAqcGFnZSkgeyByZXR1cm4gdGVzdF9hbmRfY2xlYXJf
Yml0KFBHX2Vycm9yLCAmKHsgKCh2b2lkKShzaXplb2YoKCBsb25nKSgxICYmIFBhZ2VUYWls
KHBhZ2UpKSkpKTsgKHsgKCh2b2lkKShzaXplb2YoKCBsb25nKShQYWdlUG9pc29uZWQoY29t
cG91bmRfaGVhZChwYWdlKSkpKSkpOyBjb21wb3VuZF9oZWFkKHBhZ2UpOyB9KTsgfSktPmZs
YWdzKTsgfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBp
bnQgUGFnZVJlZmVyZW5jZWQoc3RydWN0IHBhZ2UgKnBhZ2UpIHsgcmV0dXJuIHRlc3RfYml0
KFBHX3JlZmVyZW5jZWQsICYoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKFBhZ2VQb2lzb25l
ZChjb21wb3VuZF9oZWFkKHBhZ2UpKSkpKSk7IGNvbXBvdW5kX2hlYWQocGFnZSk7IH0pLT5m
bGFncyk7IH0gc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkg
dm9pZCBTZXRQYWdlUmVmZXJlbmNlZChzdHJ1Y3QgcGFnZSAqcGFnZSkgeyBzZXRfYml0KFBH
X3JlZmVyZW5jZWQsICYoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKFBhZ2VQb2lzb25lZChj
b21wb3VuZF9oZWFkKHBhZ2UpKSkpKSk7IGNvbXBvdW5kX2hlYWQocGFnZSk7IH0pLT5mbGFn
cyk7IH0gc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgdm9p
ZCBDbGVhclBhZ2VSZWZlcmVuY2VkKHN0cnVjdCBwYWdlICpwYWdlKSB7IGNsZWFyX2JpdChQ
R19yZWZlcmVuY2VkLCAmKHsgKCh2b2lkKShzaXplb2YoKCBsb25nKShQYWdlUG9pc29uZWQo
Y29tcG91bmRfaGVhZChwYWdlKSkpKSkpOyBjb21wb3VuZF9oZWFkKHBhZ2UpOyB9KS0+Zmxh
Z3MpOyB9CiBzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBp
bnQgVGVzdENsZWFyUGFnZVJlZmVyZW5jZWQoc3RydWN0IHBhZ2UgKnBhZ2UpIHsgcmV0dXJu
IHRlc3RfYW5kX2NsZWFyX2JpdChQR19yZWZlcmVuY2VkLCAmKHsgKCh2b2lkKShzaXplb2Yo
KCBsb25nKShQYWdlUG9pc29uZWQoY29tcG91bmRfaGVhZChwYWdlKSkpKSkpOyBjb21wb3Vu
ZF9oZWFkKHBhZ2UpOyB9KS0+ZmxhZ3MpOyB9CiBzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygo
X19hbHdheXNfaW5saW5lX18pKSB2b2lkIF9fU2V0UGFnZVJlZmVyZW5jZWQoc3RydWN0IHBh
Z2UgKnBhZ2UpIHsgX19zZXRfYml0KFBHX3JlZmVyZW5jZWQsICYoeyAoKHZvaWQpKHNpemVv
ZigoIGxvbmcpKFBhZ2VQb2lzb25lZChjb21wb3VuZF9oZWFkKHBhZ2UpKSkpKSk7IGNvbXBv
dW5kX2hlYWQocGFnZSk7IH0pLT5mbGFncyk7IH0Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18o
KF9fYWx3YXlzX2lubGluZV9fKSkgaW50IFBhZ2VEaXJ0eShzdHJ1Y3QgcGFnZSAqcGFnZSkg
eyByZXR1cm4gdGVzdF9iaXQoUEdfZGlydHksICYoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcp
KFBhZ2VQb2lzb25lZChjb21wb3VuZF9oZWFkKHBhZ2UpKSkpKSk7IGNvbXBvdW5kX2hlYWQo
cGFnZSk7IH0pLT5mbGFncyk7IH0gc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlz
X2lubGluZV9fKSkgdm9pZCBTZXRQYWdlRGlydHkoc3RydWN0IHBhZ2UgKnBhZ2UpIHsgc2V0
X2JpdChQR19kaXJ0eSwgJih7ICgodm9pZCkoc2l6ZW9mKCggbG9uZykoUGFnZVBvaXNvbmVk
KGNvbXBvdW5kX2hlYWQocGFnZSkpKSkpKTsgY29tcG91bmRfaGVhZChwYWdlKTsgfSktPmZs
YWdzKTsgfSBzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB2
b2lkIENsZWFyUGFnZURpcnR5KHN0cnVjdCBwYWdlICpwYWdlKSB7IGNsZWFyX2JpdChQR19k
aXJ0eSwgJih7ICgodm9pZCkoc2l6ZW9mKCggbG9uZykoUGFnZVBvaXNvbmVkKGNvbXBvdW5k
X2hlYWQocGFnZSkpKSkpKTsgY29tcG91bmRfaGVhZChwYWdlKTsgfSktPmZsYWdzKTsgfSBz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBpbnQgVGVzdFNl
dFBhZ2VEaXJ0eShzdHJ1Y3QgcGFnZSAqcGFnZSkgeyByZXR1cm4gdGVzdF9hbmRfc2V0X2Jp
dChQR19kaXJ0eSwgJih7ICgodm9pZCkoc2l6ZW9mKCggbG9uZykoUGFnZVBvaXNvbmVkKGNv
bXBvdW5kX2hlYWQocGFnZSkpKSkpKTsgY29tcG91bmRfaGVhZChwYWdlKTsgfSktPmZsYWdz
KTsgfSBzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBpbnQg
VGVzdENsZWFyUGFnZURpcnR5KHN0cnVjdCBwYWdlICpwYWdlKSB7IHJldHVybiB0ZXN0X2Fu
ZF9jbGVhcl9iaXQoUEdfZGlydHksICYoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKFBhZ2VQ
b2lzb25lZChjb21wb3VuZF9oZWFkKHBhZ2UpKSkpKSk7IGNvbXBvdW5kX2hlYWQocGFnZSk7
IH0pLT5mbGFncyk7IH0KIHN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxp
bmVfXykpIHZvaWQgX19DbGVhclBhZ2VEaXJ0eShzdHJ1Y3QgcGFnZSAqcGFnZSkgeyBfX2Ns
ZWFyX2JpdChQR19kaXJ0eSwgJih7ICgodm9pZCkoc2l6ZW9mKCggbG9uZykoUGFnZVBvaXNv
bmVkKGNvbXBvdW5kX2hlYWQocGFnZSkpKSkpKTsgY29tcG91bmRfaGVhZChwYWdlKTsgfSkt
PmZsYWdzKTsgfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18p
KSBpbnQgUGFnZUxSVShzdHJ1Y3QgcGFnZSAqcGFnZSkgeyByZXR1cm4gdGVzdF9iaXQoUEdf
bHJ1LCAmKHsgKCh2b2lkKShzaXplb2YoKCBsb25nKShQYWdlUG9pc29uZWQoY29tcG91bmRf
aGVhZChwYWdlKSkpKSkpOyBjb21wb3VuZF9oZWFkKHBhZ2UpOyB9KS0+ZmxhZ3MpOyB9IHN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHZvaWQgU2V0UGFn
ZUxSVShzdHJ1Y3QgcGFnZSAqcGFnZSkgeyBzZXRfYml0KFBHX2xydSwgJih7ICgodm9pZCko
c2l6ZW9mKCggbG9uZykoUGFnZVBvaXNvbmVkKGNvbXBvdW5kX2hlYWQocGFnZSkpKSkpKTsg
Y29tcG91bmRfaGVhZChwYWdlKTsgfSktPmZsYWdzKTsgfSBzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1
dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB2b2lkIENsZWFyUGFnZUxSVShzdHJ1Y3QgcGFn
ZSAqcGFnZSkgeyBjbGVhcl9iaXQoUEdfbHJ1LCAmKHsgKCh2b2lkKShzaXplb2YoKCBsb25n
KShQYWdlUG9pc29uZWQoY29tcG91bmRfaGVhZChwYWdlKSkpKSkpOyBjb21wb3VuZF9oZWFk
KHBhZ2UpOyB9KS0+ZmxhZ3MpOyB9IHN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5
c19pbmxpbmVfXykpIHZvaWQgX19DbGVhclBhZ2VMUlUoc3RydWN0IHBhZ2UgKnBhZ2UpIHsg
X19jbGVhcl9iaXQoUEdfbHJ1LCAmKHsgKCh2b2lkKShzaXplb2YoKCBsb25nKShQYWdlUG9p
c29uZWQoY29tcG91bmRfaGVhZChwYWdlKSkpKSkpOyBjb21wb3VuZF9oZWFkKHBhZ2UpOyB9
KS0+ZmxhZ3MpOyB9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVf
XykpIGludCBQYWdlQWN0aXZlKHN0cnVjdCBwYWdlICpwYWdlKSB7IHJldHVybiB0ZXN0X2Jp
dChQR19hY3RpdmUsICYoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKFBhZ2VQb2lzb25lZChj
b21wb3VuZF9oZWFkKHBhZ2UpKSkpKSk7IGNvbXBvdW5kX2hlYWQocGFnZSk7IH0pLT5mbGFn
cyk7IH0gc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgdm9p
ZCBTZXRQYWdlQWN0aXZlKHN0cnVjdCBwYWdlICpwYWdlKSB7IHNldF9iaXQoUEdfYWN0aXZl
LCAmKHsgKCh2b2lkKShzaXplb2YoKCBsb25nKShQYWdlUG9pc29uZWQoY29tcG91bmRfaGVh
ZChwYWdlKSkpKSkpOyBjb21wb3VuZF9oZWFkKHBhZ2UpOyB9KS0+ZmxhZ3MpOyB9IHN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHZvaWQgQ2xlYXJQYWdl
QWN0aXZlKHN0cnVjdCBwYWdlICpwYWdlKSB7IGNsZWFyX2JpdChQR19hY3RpdmUsICYoeyAo
KHZvaWQpKHNpemVvZigoIGxvbmcpKFBhZ2VQb2lzb25lZChjb21wb3VuZF9oZWFkKHBhZ2Up
KSkpKSk7IGNvbXBvdW5kX2hlYWQocGFnZSk7IH0pLT5mbGFncyk7IH0gc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9f
YXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgdm9pZCBfX0NsZWFyUGFnZUFjdGl2
ZShzdHJ1Y3QgcGFnZSAqcGFnZSkgeyBfX2NsZWFyX2JpdChQR19hY3RpdmUsICYoeyAoKHZv
aWQpKHNpemVvZigoIGxvbmcpKFBhZ2VQb2lzb25lZChjb21wb3VuZF9oZWFkKHBhZ2UpKSkp
KSk7IGNvbXBvdW5kX2hlYWQocGFnZSk7IH0pLT5mbGFncyk7IH0KIHN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0
dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIGludCBUZXN0Q2xlYXJQYWdlQWN0aXZl
KHN0cnVjdCBwYWdlICpwYWdlKSB7IHJldHVybiB0ZXN0X2FuZF9jbGVhcl9iaXQoUEdfYWN0
aXZlLCAmKHsgKCh2b2lkKShzaXplb2YoKCBsb25nKShQYWdlUG9pc29uZWQoY29tcG91bmRf
aGVhZChwYWdlKSkpKSkpOyBjb21wb3VuZF9oZWFkKHBhZ2UpOyB9KS0+ZmxhZ3MpOyB9CnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIGludCBQYWdlV29y
a2luZ3NldChzdHJ1Y3QgcGFnZSAqcGFnZSkgeyByZXR1cm4gdGVzdF9iaXQoUEdfd29ya2lu
Z3NldCwgJih7ICgodm9pZCkoc2l6ZW9mKCggbG9uZykoUGFnZVBvaXNvbmVkKGNvbXBvdW5k
X2hlYWQocGFnZSkpKSkpKTsgY29tcG91bmRfaGVhZChwYWdlKTsgfSktPmZsYWdzKTsgfSBz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB2b2lkIFNldFBh
Z2VXb3JraW5nc2V0KHN0cnVjdCBwYWdlICpwYWdlKSB7IHNldF9iaXQoUEdfd29ya2luZ3Nl
dCwgJih7ICgodm9pZCkoc2l6ZW9mKCggbG9uZykoUGFnZVBvaXNvbmVkKGNvbXBvdW5kX2hl
YWQocGFnZSkpKSkpKTsgY29tcG91bmRfaGVhZChwYWdlKTsgfSktPmZsYWdzKTsgfSBzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB2b2lkIENsZWFyUGFn
ZVdvcmtpbmdzZXQoc3RydWN0IHBhZ2UgKnBhZ2UpIHsgY2xlYXJfYml0KFBHX3dvcmtpbmdz
ZXQsICYoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKFBhZ2VQb2lzb25lZChjb21wb3VuZF9o
ZWFkKHBhZ2UpKSkpKSk7IGNvbXBvdW5kX2hlYWQocGFnZSk7IH0pLT5mbGFncyk7IH0KIHN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIGludCBUZXN0Q2xl
YXJQYWdlV29ya2luZ3NldChzdHJ1Y3QgcGFnZSAqcGFnZSkgeyByZXR1cm4gdGVzdF9hbmRf
Y2xlYXJfYml0KFBHX3dvcmtpbmdzZXQsICYoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKFBh
Z2VQb2lzb25lZChjb21wb3VuZF9oZWFkKHBhZ2UpKSkpKSk7IGNvbXBvdW5kX2hlYWQocGFn
ZSk7IH0pLT5mbGFncyk7IH0Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lu
bGluZV9fKSkgaW50IFBhZ2VTbGFiKHN0cnVjdCBwYWdlICpwYWdlKSB7IHJldHVybiB0ZXN0
X2JpdChQR19zbGFiLCAmKHsgKCh2b2lkKShzaXplb2YoKCBsb25nKSgwICYmIFBhZ2VUYWls
KHBhZ2UpKSkpKTsgKHsgKCh2b2lkKShzaXplb2YoKCBsb25nKShQYWdlUG9pc29uZWQoY29t
cG91bmRfaGVhZChwYWdlKSkpKSkpOyBjb21wb3VuZF9oZWFkKHBhZ2UpOyB9KTsgfSktPmZs
YWdzKTsgfSBzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB2
b2lkIF9fU2V0UGFnZVNsYWIoc3RydWN0IHBhZ2UgKnBhZ2UpIHsgX19zZXRfYml0KFBHX3Ns
YWIsICYoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKDEgJiYgUGFnZVRhaWwocGFnZSkpKSkp
OyAoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKFBhZ2VQb2lzb25lZChjb21wb3VuZF9oZWFk
KHBhZ2UpKSkpKSk7IGNvbXBvdW5kX2hlYWQocGFnZSk7IH0pOyB9KS0+ZmxhZ3MpOyB9IHN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHZvaWQgX19DbGVh
clBhZ2VTbGFiKHN0cnVjdCBwYWdlICpwYWdlKSB7IF9fY2xlYXJfYml0KFBHX3NsYWIsICYo
eyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKDEgJiYgUGFnZVRhaWwocGFnZSkpKSkpOyAoeyAo
KHZvaWQpKHNpemVvZigoIGxvbmcpKFBhZ2VQb2lzb25lZChjb21wb3VuZF9oZWFkKHBhZ2Up
KSkpKSk7IGNvbXBvdW5kX2hlYWQocGFnZSk7IH0pOyB9KS0+ZmxhZ3MpOyB9CnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIGludCBQYWdlU2xvYkZyZWUo
c3RydWN0IHBhZ2UgKnBhZ2UpIHsgcmV0dXJuIHRlc3RfYml0KFBHX3Nsb2JfZnJlZSwgJih7
ICgodm9pZCkoc2l6ZW9mKCggbG9uZykoMCAmJiBQYWdlVGFpbChwYWdlKSkpKSk7ICh7ICgo
dm9pZCkoc2l6ZW9mKCggbG9uZykoUGFnZVBvaXNvbmVkKGNvbXBvdW5kX2hlYWQocGFnZSkp
KSkpKTsgY29tcG91bmRfaGVhZChwYWdlKTsgfSk7IH0pLT5mbGFncyk7IH0gc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgdm9pZCBfX1NldFBhZ2VTbG9i
RnJlZShzdHJ1Y3QgcGFnZSAqcGFnZSkgeyBfX3NldF9iaXQoUEdfc2xvYl9mcmVlLCAmKHsg
KCh2b2lkKShzaXplb2YoKCBsb25nKSgxICYmIFBhZ2VUYWlsKHBhZ2UpKSkpKTsgKHsgKCh2
b2lkKShzaXplb2YoKCBsb25nKShQYWdlUG9pc29uZWQoY29tcG91bmRfaGVhZChwYWdlKSkp
KSkpOyBjb21wb3VuZF9oZWFkKHBhZ2UpOyB9KTsgfSktPmZsYWdzKTsgfSBzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
X19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB2b2lkIF9fQ2xlYXJQYWdlU2xv
YkZyZWUoc3RydWN0IHBhZ2UgKnBhZ2UpIHsgX19jbGVhcl9iaXQoUEdfc2xvYl9mcmVlLCAm
KHsgKCh2b2lkKShzaXplb2YoKCBsb25nKSgxICYmIFBhZ2VUYWlsKHBhZ2UpKSkpKTsgKHsg
KCh2b2lkKShzaXplb2YoKCBsb25nKShQYWdlUG9pc29uZWQoY29tcG91bmRfaGVhZChwYWdl
KSkpKSkpOyBjb21wb3VuZF9oZWFkKHBhZ2UpOyB9KTsgfSktPmZsYWdzKTsgfQpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBpbnQgUGFnZUNoZWNrZWQo
c3RydWN0IHBhZ2UgKnBhZ2UpIHsgcmV0dXJuIHRlc3RfYml0KFBHX2NoZWNrZWQsICYoeyAo
KHZvaWQpKHNpemVvZigoIGxvbmcpKDAgJiYgUGFnZUNvbXBvdW5kKHBhZ2UpKSkpKTsgKHsg
KCh2b2lkKShzaXplb2YoKCBsb25nKShQYWdlUG9pc29uZWQocGFnZSkpKSkpOyBwYWdlOyB9
KTsgfSktPmZsYWdzKTsgfSBzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5s
aW5lX18pKSB2b2lkIFNldFBhZ2VDaGVja2VkKHN0cnVjdCBwYWdlICpwYWdlKSB7IHNldF9i
aXQoUEdfY2hlY2tlZCwgJih7ICgodm9pZCkoc2l6ZW9mKCggbG9uZykoMSAmJiBQYWdlQ29t
cG91bmQocGFnZSkpKSkpOyAoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKFBhZ2VQb2lzb25l
ZChwYWdlKSkpKSk7IHBhZ2U7IH0pOyB9KS0+ZmxhZ3MpOyB9IHN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJp
YnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHZvaWQgQ2xlYXJQYWdlQ2hlY2tlZChzdHJ1
Y3QgcGFnZSAqcGFnZSkgeyBjbGVhcl9iaXQoUEdfY2hlY2tlZCwgJih7ICgodm9pZCkoc2l6
ZW9mKCggbG9uZykoMSAmJiBQYWdlQ29tcG91bmQocGFnZSkpKSkpOyAoeyAoKHZvaWQpKHNp
emVvZigoIGxvbmcpKFBhZ2VQb2lzb25lZChwYWdlKSkpKSk7IHBhZ2U7IH0pOyB9KS0+Zmxh
Z3MpOyB9CgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkg
aW50IFBhZ2VQaW5uZWQoc3RydWN0IHBhZ2UgKnBhZ2UpIHsgcmV0dXJuIHRlc3RfYml0KFBH
X3Bpbm5lZCwgJih7ICgodm9pZCkoc2l6ZW9mKCggbG9uZykoMCAmJiBQYWdlQ29tcG91bmQo
cGFnZSkpKSkpOyAoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKFBhZ2VQb2lzb25lZChwYWdl
KSkpKSk7IHBhZ2U7IH0pOyB9KS0+ZmxhZ3MpOyB9IHN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9f
KChfX2Fsd2F5c19pbmxpbmVfXykpIHZvaWQgU2V0UGFnZVBpbm5lZChzdHJ1Y3QgcGFnZSAq
cGFnZSkgeyBzZXRfYml0KFBHX3Bpbm5lZCwgJih7ICgodm9pZCkoc2l6ZW9mKCggbG9uZyko
MSAmJiBQYWdlQ29tcG91bmQocGFnZSkpKSkpOyAoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcp
KFBhZ2VQb2lzb25lZChwYWdlKSkpKSk7IHBhZ2U7IH0pOyB9KS0+ZmxhZ3MpOyB9IHN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHZvaWQgQ2xlYXJQYWdl
UGlubmVkKHN0cnVjdCBwYWdlICpwYWdlKSB7IGNsZWFyX2JpdChQR19waW5uZWQsICYoeyAo
KHZvaWQpKHNpemVvZigoIGxvbmcpKDEgJiYgUGFnZUNvbXBvdW5kKHBhZ2UpKSkpKTsgKHsg
KCh2b2lkKShzaXplb2YoKCBsb25nKShQYWdlUG9pc29uZWQocGFnZSkpKSkpOyBwYWdlOyB9
KTsgfSktPmZsYWdzKTsgfQogc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lu
bGluZV9fKSkgaW50IFRlc3RTZXRQYWdlUGlubmVkKHN0cnVjdCBwYWdlICpwYWdlKSB7IHJl
dHVybiB0ZXN0X2FuZF9zZXRfYml0KFBHX3Bpbm5lZCwgJih7ICgodm9pZCkoc2l6ZW9mKCgg
bG9uZykoMSAmJiBQYWdlQ29tcG91bmQocGFnZSkpKSkpOyAoeyAoKHZvaWQpKHNpemVvZigo
IGxvbmcpKFBhZ2VQb2lzb25lZChwYWdlKSkpKSk7IHBhZ2U7IH0pOyB9KS0+ZmxhZ3MpOyB9
IHN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIGludCBUZXN0
Q2xlYXJQYWdlUGlubmVkKHN0cnVjdCBwYWdlICpwYWdlKSB7IHJldHVybiB0ZXN0X2FuZF9j
bGVhcl9iaXQoUEdfcGlubmVkLCAmKHsgKCh2b2lkKShzaXplb2YoKCBsb25nKSgxICYmIFBh
Z2VDb21wb3VuZChwYWdlKSkpKSk7ICh7ICgodm9pZCkoc2l6ZW9mKCggbG9uZykoUGFnZVBv
aXNvbmVkKHBhZ2UpKSkpKTsgcGFnZTsgfSk7IH0pLT5mbGFncyk7IH0Kc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9f
YXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgaW50IFBhZ2VTYXZlUGlubmVkKHN0
cnVjdCBwYWdlICpwYWdlKSB7IHJldHVybiB0ZXN0X2JpdChQR19zYXZlcGlubmVkLCAmKHsg
KCh2b2lkKShzaXplb2YoKCBsb25nKSgwICYmIFBhZ2VDb21wb3VuZChwYWdlKSkpKSk7ICh7
ICgodm9pZCkoc2l6ZW9mKCggbG9uZykoUGFnZVBvaXNvbmVkKHBhZ2UpKSkpKTsgcGFnZTsg
fSk7IH0pLT5mbGFncyk7IH0gc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lu
bGluZV9fKSkgdm9pZCBTZXRQYWdlU2F2ZVBpbm5lZChzdHJ1Y3QgcGFnZSAqcGFnZSkgeyBz
ZXRfYml0KFBHX3NhdmVwaW5uZWQsICYoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKDEgJiYg
UGFnZUNvbXBvdW5kKHBhZ2UpKSkpKTsgKHsgKCh2b2lkKShzaXplb2YoKCBsb25nKShQYWdl
UG9pc29uZWQocGFnZSkpKSkpOyBwYWdlOyB9KTsgfSktPmZsYWdzKTsgfSBzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
X19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB2b2lkIENsZWFyUGFnZVNhdmVQ
aW5uZWQoc3RydWN0IHBhZ2UgKnBhZ2UpIHsgY2xlYXJfYml0KFBHX3NhdmVwaW5uZWQsICYo
eyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKDEgJiYgUGFnZUNvbXBvdW5kKHBhZ2UpKSkpKTsg
KHsgKCh2b2lkKShzaXplb2YoKCBsb25nKShQYWdlUG9pc29uZWQocGFnZSkpKSkpOyBwYWdl
OyB9KTsgfSktPmZsYWdzKTsgfTsKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlz
X2lubGluZV9fKSkgaW50IFBhZ2VGb3JlaWduKHN0cnVjdCBwYWdlICpwYWdlKSB7IHJldHVy
biB0ZXN0X2JpdChQR19mb3JlaWduLCAmKHsgKCh2b2lkKShzaXplb2YoKCBsb25nKSgwICYm
IFBhZ2VDb21wb3VuZChwYWdlKSkpKSk7ICh7ICgodm9pZCkoc2l6ZW9mKCggbG9uZykoUGFn
ZVBvaXNvbmVkKHBhZ2UpKSkpKTsgcGFnZTsgfSk7IH0pLT5mbGFncyk7IH0gc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgdm9pZCBTZXRQYWdlRm9yZWln
bihzdHJ1Y3QgcGFnZSAqcGFnZSkgeyBzZXRfYml0KFBHX2ZvcmVpZ24sICYoeyAoKHZvaWQp
KHNpemVvZigoIGxvbmcpKDEgJiYgUGFnZUNvbXBvdW5kKHBhZ2UpKSkpKTsgKHsgKCh2b2lk
KShzaXplb2YoKCBsb25nKShQYWdlUG9pc29uZWQocGFnZSkpKSkpOyBwYWdlOyB9KTsgfSkt
PmZsYWdzKTsgfSBzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18p
KSB2b2lkIENsZWFyUGFnZUZvcmVpZ24oc3RydWN0IHBhZ2UgKnBhZ2UpIHsgY2xlYXJfYml0
KFBHX2ZvcmVpZ24sICYoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKDEgJiYgUGFnZUNvbXBv
dW5kKHBhZ2UpKSkpKTsgKHsgKCh2b2lkKShzaXplb2YoKCBsb25nKShQYWdlUG9pc29uZWQo
cGFnZSkpKSkpOyBwYWdlOyB9KTsgfSktPmZsYWdzKTsgfTsKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmli
dXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgaW50IFBhZ2VYZW5SZW1hcHBlZChzdHJ1Y3Qg
cGFnZSAqcGFnZSkgeyByZXR1cm4gdGVzdF9iaXQoUEdfeGVuX3JlbWFwcGVkLCAmKHsgKCh2
b2lkKShzaXplb2YoKCBsb25nKSgwICYmIFBhZ2VDb21wb3VuZChwYWdlKSkpKSk7ICh7ICgo
dm9pZCkoc2l6ZW9mKCggbG9uZykoUGFnZVBvaXNvbmVkKHBhZ2UpKSkpKTsgcGFnZTsgfSk7
IH0pLT5mbGFncyk7IH0gc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGlu
ZV9fKSkgdm9pZCBTZXRQYWdlWGVuUmVtYXBwZWQoc3RydWN0IHBhZ2UgKnBhZ2UpIHsgc2V0
X2JpdChQR194ZW5fcmVtYXBwZWQsICYoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKDEgJiYg
UGFnZUNvbXBvdW5kKHBhZ2UpKSkpKTsgKHsgKCh2b2lkKShzaXplb2YoKCBsb25nKShQYWdl
UG9pc29uZWQocGFnZSkpKSkpOyBwYWdlOyB9KTsgfSktPmZsYWdzKTsgfSBzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
X19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB2b2lkIENsZWFyUGFnZVhlblJl
bWFwcGVkKHN0cnVjdCBwYWdlICpwYWdlKSB7IGNsZWFyX2JpdChQR194ZW5fcmVtYXBwZWQs
ICYoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKDEgJiYgUGFnZUNvbXBvdW5kKHBhZ2UpKSkp
KTsgKHsgKCh2b2lkKShzaXplb2YoKCBsb25nKShQYWdlUG9pc29uZWQocGFnZSkpKSkpOyBw
YWdlOyB9KTsgfSktPmZsYWdzKTsgfQogc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3
YXlzX2lubGluZV9fKSkgaW50IFRlc3RDbGVhclBhZ2VYZW5SZW1hcHBlZChzdHJ1Y3QgcGFn
ZSAqcGFnZSkgeyByZXR1cm4gdGVzdF9hbmRfY2xlYXJfYml0KFBHX3hlbl9yZW1hcHBlZCwg
Jih7ICgodm9pZCkoc2l6ZW9mKCggbG9uZykoMSAmJiBQYWdlQ29tcG91bmQocGFnZSkpKSkp
OyAoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKFBhZ2VQb2lzb25lZChwYWdlKSkpKSk7IHBh
Z2U7IH0pOyB9KS0+ZmxhZ3MpOyB9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdh
eXNfaW5saW5lX18pKSBpbnQgUGFnZVJlc2VydmVkKHN0cnVjdCBwYWdlICpwYWdlKSB7IHJl
dHVybiB0ZXN0X2JpdChQR19yZXNlcnZlZCwgJih7ICgodm9pZCkoc2l6ZW9mKCggbG9uZyko
MCAmJiBQYWdlQ29tcG91bmQocGFnZSkpKSkpOyAoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcp
KFBhZ2VQb2lzb25lZChwYWdlKSkpKSk7IHBhZ2U7IH0pOyB9KS0+ZmxhZ3MpOyB9IHN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHZvaWQgU2V0UGFnZVJl
c2VydmVkKHN0cnVjdCBwYWdlICpwYWdlKSB7IHNldF9iaXQoUEdfcmVzZXJ2ZWQsICYoeyAo
KHZvaWQpKHNpemVvZigoIGxvbmcpKDEgJiYgUGFnZUNvbXBvdW5kKHBhZ2UpKSkpKTsgKHsg
KCh2b2lkKShzaXplb2YoKCBsb25nKShQYWdlUG9pc29uZWQocGFnZSkpKSkpOyBwYWdlOyB9
KTsgfSktPmZsYWdzKTsgfSBzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5s
aW5lX18pKSB2b2lkIENsZWFyUGFnZVJlc2VydmVkKHN0cnVjdCBwYWdlICpwYWdlKSB7IGNs
ZWFyX2JpdChQR19yZXNlcnZlZCwgJih7ICgodm9pZCkoc2l6ZW9mKCggbG9uZykoMSAmJiBQ
YWdlQ29tcG91bmQocGFnZSkpKSkpOyAoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKFBhZ2VQ
b2lzb25lZChwYWdlKSkpKSk7IHBhZ2U7IH0pOyB9KS0+ZmxhZ3MpOyB9CiBzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
X19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB2b2lkIF9fQ2xlYXJQYWdlUmVz
ZXJ2ZWQoc3RydWN0IHBhZ2UgKnBhZ2UpIHsgX19jbGVhcl9iaXQoUEdfcmVzZXJ2ZWQsICYo
eyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKDEgJiYgUGFnZUNvbXBvdW5kKHBhZ2UpKSkpKTsg
KHsgKCh2b2lkKShzaXplb2YoKCBsb25nKShQYWdlUG9pc29uZWQocGFnZSkpKSkpOyBwYWdl
OyB9KTsgfSktPmZsYWdzKTsgfQogc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlz
X2lubGluZV9fKSkgdm9pZCBfX1NldFBhZ2VSZXNlcnZlZChzdHJ1Y3QgcGFnZSAqcGFnZSkg
eyBfX3NldF9iaXQoUEdfcmVzZXJ2ZWQsICYoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKDEg
JiYgUGFnZUNvbXBvdW5kKHBhZ2UpKSkpKTsgKHsgKCh2b2lkKShzaXplb2YoKCBsb25nKShQ
YWdlUG9pc29uZWQocGFnZSkpKSkpOyBwYWdlOyB9KTsgfSktPmZsYWdzKTsgfQpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBpbnQgUGFnZVN3YXBCYWNr
ZWQoc3RydWN0IHBhZ2UgKnBhZ2UpIHsgcmV0dXJuIHRlc3RfYml0KFBHX3N3YXBiYWNrZWQs
ICYoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKDAgJiYgUGFnZVRhaWwocGFnZSkpKSkpOyAo
eyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKFBhZ2VQb2lzb25lZChjb21wb3VuZF9oZWFkKHBh
Z2UpKSkpKSk7IGNvbXBvdW5kX2hlYWQocGFnZSk7IH0pOyB9KS0+ZmxhZ3MpOyB9IHN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHZvaWQgU2V0UGFnZVN3
YXBCYWNrZWQoc3RydWN0IHBhZ2UgKnBhZ2UpIHsgc2V0X2JpdChQR19zd2FwYmFja2VkLCAm
KHsgKCh2b2lkKShzaXplb2YoKCBsb25nKSgxICYmIFBhZ2VUYWlsKHBhZ2UpKSkpKTsgKHsg
KCh2b2lkKShzaXplb2YoKCBsb25nKShQYWdlUG9pc29uZWQoY29tcG91bmRfaGVhZChwYWdl
KSkpKSkpOyBjb21wb3VuZF9oZWFkKHBhZ2UpOyB9KTsgfSktPmZsYWdzKTsgfSBzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB2b2lkIENsZWFyUGFnZVN3
YXBCYWNrZWQoc3RydWN0IHBhZ2UgKnBhZ2UpIHsgY2xlYXJfYml0KFBHX3N3YXBiYWNrZWQs
ICYoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKDEgJiYgUGFnZVRhaWwocGFnZSkpKSkpOyAo
eyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKFBhZ2VQb2lzb25lZChjb21wb3VuZF9oZWFkKHBh
Z2UpKSkpKSk7IGNvbXBvdW5kX2hlYWQocGFnZSk7IH0pOyB9KS0+ZmxhZ3MpOyB9CiBzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB2b2lkIF9fQ2xlYXJQ
YWdlU3dhcEJhY2tlZChzdHJ1Y3QgcGFnZSAqcGFnZSkgeyBfX2NsZWFyX2JpdChQR19zd2Fw
YmFja2VkLCAmKHsgKCh2b2lkKShzaXplb2YoKCBsb25nKSgxICYmIFBhZ2VUYWlsKHBhZ2Up
KSkpKTsgKHsgKCh2b2lkKShzaXplb2YoKCBsb25nKShQYWdlUG9pc29uZWQoY29tcG91bmRf
aGVhZChwYWdlKSkpKSkpOyBjb21wb3VuZF9oZWFkKHBhZ2UpOyB9KTsgfSktPmZsYWdzKTsg
fQogc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgdm9pZCBf
X1NldFBhZ2VTd2FwQmFja2VkKHN0cnVjdCBwYWdlICpwYWdlKSB7IF9fc2V0X2JpdChQR19z
d2FwYmFja2VkLCAmKHsgKCh2b2lkKShzaXplb2YoKCBsb25nKSgxICYmIFBhZ2VUYWlsKHBh
Z2UpKSkpKTsgKHsgKCh2b2lkKShzaXplb2YoKCBsb25nKShQYWdlUG9pc29uZWQoY29tcG91
bmRfaGVhZChwYWdlKSkpKSkpOyBjb21wb3VuZF9oZWFkKHBhZ2UpOyB9KTsgfSktPmZsYWdz
KTsgfQoKCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18p
KSBpbnQgUGFnZVByaXZhdGUoc3RydWN0IHBhZ2UgKnBhZ2UpIHsgcmV0dXJuIHRlc3RfYml0
KFBHX3ByaXZhdGUsICYoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKFBhZ2VQb2lzb25lZChw
YWdlKSkpKSk7IHBhZ2U7IH0pLT5mbGFncyk7IH0gc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18o
KF9fYWx3YXlzX2lubGluZV9fKSkgdm9pZCBTZXRQYWdlUHJpdmF0ZShzdHJ1Y3QgcGFnZSAq
cGFnZSkgeyBzZXRfYml0KFBHX3ByaXZhdGUsICYoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcp
KFBhZ2VQb2lzb25lZChwYWdlKSkpKSk7IHBhZ2U7IH0pLT5mbGFncyk7IH0gc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgdm9pZCBDbGVhclBhZ2VQcml2
YXRlKHN0cnVjdCBwYWdlICpwYWdlKSB7IGNsZWFyX2JpdChQR19wcml2YXRlLCAmKHsgKCh2
b2lkKShzaXplb2YoKCBsb25nKShQYWdlUG9pc29uZWQocGFnZSkpKSkpOyBwYWdlOyB9KS0+
ZmxhZ3MpOyB9IHN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykp
IHZvaWQgX19TZXRQYWdlUHJpdmF0ZShzdHJ1Y3QgcGFnZSAqcGFnZSkgeyBfX3NldF9iaXQo
UEdfcHJpdmF0ZSwgJih7ICgodm9pZCkoc2l6ZW9mKCggbG9uZykoUGFnZVBvaXNvbmVkKHBh
Z2UpKSkpKTsgcGFnZTsgfSktPmZsYWdzKTsgfQogc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18o
KF9fYWx3YXlzX2lubGluZV9fKSkgdm9pZCBfX0NsZWFyUGFnZVByaXZhdGUoc3RydWN0IHBh
Z2UgKnBhZ2UpIHsgX19jbGVhcl9iaXQoUEdfcHJpdmF0ZSwgJih7ICgodm9pZCkoc2l6ZW9m
KCggbG9uZykoUGFnZVBvaXNvbmVkKHBhZ2UpKSkpKTsgcGFnZTsgfSktPmZsYWdzKTsgfQpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBpbnQgUGFnZVBy
aXZhdGUyKHN0cnVjdCBwYWdlICpwYWdlKSB7IHJldHVybiB0ZXN0X2JpdChQR19wcml2YXRl
XzIsICYoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKFBhZ2VQb2lzb25lZChwYWdlKSkpKSk7
IHBhZ2U7IH0pLT5mbGFncyk7IH0gc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlz
X2lubGluZV9fKSkgdm9pZCBTZXRQYWdlUHJpdmF0ZTIoc3RydWN0IHBhZ2UgKnBhZ2UpIHsg
c2V0X2JpdChQR19wcml2YXRlXzIsICYoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKFBhZ2VQ
b2lzb25lZChwYWdlKSkpKSk7IHBhZ2U7IH0pLT5mbGFncyk7IH0gc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0
cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgdm9pZCBDbGVhclBhZ2VQcml2YXRlMihz
dHJ1Y3QgcGFnZSAqcGFnZSkgeyBjbGVhcl9iaXQoUEdfcHJpdmF0ZV8yLCAmKHsgKCh2b2lk
KShzaXplb2YoKCBsb25nKShQYWdlUG9pc29uZWQocGFnZSkpKSkpOyBwYWdlOyB9KS0+Zmxh
Z3MpOyB9IHN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIGlu
dCBUZXN0U2V0UGFnZVByaXZhdGUyKHN0cnVjdCBwYWdlICpwYWdlKSB7IHJldHVybiB0ZXN0
X2FuZF9zZXRfYml0KFBHX3ByaXZhdGVfMiwgJih7ICgodm9pZCkoc2l6ZW9mKCggbG9uZyko
UGFnZVBvaXNvbmVkKHBhZ2UpKSkpKTsgcGFnZTsgfSktPmZsYWdzKTsgfSBzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
X19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBpbnQgVGVzdENsZWFyUGFnZVBy
aXZhdGUyKHN0cnVjdCBwYWdlICpwYWdlKSB7IHJldHVybiB0ZXN0X2FuZF9jbGVhcl9iaXQo
UEdfcHJpdmF0ZV8yLCAmKHsgKCh2b2lkKShzaXplb2YoKCBsb25nKShQYWdlUG9pc29uZWQo
cGFnZSkpKSkpOyBwYWdlOyB9KS0+ZmxhZ3MpOyB9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9f
KChfX2Fsd2F5c19pbmxpbmVfXykpIGludCBQYWdlT3duZXJQcml2MShzdHJ1Y3QgcGFnZSAq
cGFnZSkgeyByZXR1cm4gdGVzdF9iaXQoUEdfb3duZXJfcHJpdl8xLCAmKHsgKCh2b2lkKShz
aXplb2YoKCBsb25nKShQYWdlUG9pc29uZWQocGFnZSkpKSkpOyBwYWdlOyB9KS0+ZmxhZ3Mp
OyB9IHN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHZvaWQg
U2V0UGFnZU93bmVyUHJpdjEoc3RydWN0IHBhZ2UgKnBhZ2UpIHsgc2V0X2JpdChQR19vd25l
cl9wcml2XzEsICYoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKFBhZ2VQb2lzb25lZChwYWdl
KSkpKSk7IHBhZ2U7IH0pLT5mbGFncyk7IH0gc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9f
YWx3YXlzX2lubGluZV9fKSkgdm9pZCBDbGVhclBhZ2VPd25lclByaXYxKHN0cnVjdCBwYWdl
ICpwYWdlKSB7IGNsZWFyX2JpdChQR19vd25lcl9wcml2XzEsICYoeyAoKHZvaWQpKHNpemVv
ZigoIGxvbmcpKFBhZ2VQb2lzb25lZChwYWdlKSkpKSk7IHBhZ2U7IH0pLT5mbGFncyk7IH0K
IHN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIGludCBUZXN0
Q2xlYXJQYWdlT3duZXJQcml2MShzdHJ1Y3QgcGFnZSAqcGFnZSkgeyByZXR1cm4gdGVzdF9h
bmRfY2xlYXJfYml0KFBHX293bmVyX3ByaXZfMSwgJih7ICgodm9pZCkoc2l6ZW9mKCggbG9u
ZykoUGFnZVBvaXNvbmVkKHBhZ2UpKSkpKTsgcGFnZTsgfSktPmZsYWdzKTsgfQoKCgoKCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIGludCBQYWdlV3Jp
dGViYWNrKHN0cnVjdCBwYWdlICpwYWdlKSB7IHJldHVybiB0ZXN0X2JpdChQR193cml0ZWJh
Y2ssICYoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKDAgJiYgUGFnZVRhaWwocGFnZSkpKSkp
OyAoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKFBhZ2VQb2lzb25lZChjb21wb3VuZF9oZWFk
KHBhZ2UpKSkpKSk7IGNvbXBvdW5kX2hlYWQocGFnZSk7IH0pOyB9KS0+ZmxhZ3MpOyB9CiBz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBpbnQgVGVzdFNl
dFBhZ2VXcml0ZWJhY2soc3RydWN0IHBhZ2UgKnBhZ2UpIHsgcmV0dXJuIHRlc3RfYW5kX3Nl
dF9iaXQoUEdfd3JpdGViYWNrLCAmKHsgKCh2b2lkKShzaXplb2YoKCBsb25nKSgxICYmIFBh
Z2VUYWlsKHBhZ2UpKSkpKTsgKHsgKCh2b2lkKShzaXplb2YoKCBsb25nKShQYWdlUG9pc29u
ZWQoY29tcG91bmRfaGVhZChwYWdlKSkpKSkpOyBjb21wb3VuZF9oZWFkKHBhZ2UpOyB9KTsg
fSktPmZsYWdzKTsgfSBzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5l
X18pKSBpbnQgVGVzdENsZWFyUGFnZVdyaXRlYmFjayhzdHJ1Y3QgcGFnZSAqcGFnZSkgeyBy
ZXR1cm4gdGVzdF9hbmRfY2xlYXJfYml0KFBHX3dyaXRlYmFjaywgJih7ICgodm9pZCkoc2l6
ZW9mKCggbG9uZykoMSAmJiBQYWdlVGFpbChwYWdlKSkpKSk7ICh7ICgodm9pZCkoc2l6ZW9m
KCggbG9uZykoUGFnZVBvaXNvbmVkKGNvbXBvdW5kX2hlYWQocGFnZSkpKSkpKTsgY29tcG91
bmRfaGVhZChwYWdlKTsgfSk7IH0pLT5mbGFncyk7IH0Kc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRl
X18oKF9fYWx3YXlzX2lubGluZV9fKSkgaW50IFBhZ2VNYXBwZWRUb0Rpc2soc3RydWN0IHBh
Z2UgKnBhZ2UpIHsgcmV0dXJuIHRlc3RfYml0KFBHX21hcHBlZHRvZGlzaywgJih7ICgodm9p
ZCkoc2l6ZW9mKCggbG9uZykoMCAmJiBQYWdlVGFpbChwYWdlKSkpKSk7ICh7ICgodm9pZCko
c2l6ZW9mKCggbG9uZykoUGFnZVBvaXNvbmVkKGNvbXBvdW5kX2hlYWQocGFnZSkpKSkpKTsg
Y29tcG91bmRfaGVhZChwYWdlKTsgfSk7IH0pLT5mbGFncyk7IH0gc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0
cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgdm9pZCBTZXRQYWdlTWFwcGVkVG9EaXNr
KHN0cnVjdCBwYWdlICpwYWdlKSB7IHNldF9iaXQoUEdfbWFwcGVkdG9kaXNrLCAmKHsgKCh2
b2lkKShzaXplb2YoKCBsb25nKSgxICYmIFBhZ2VUYWlsKHBhZ2UpKSkpKTsgKHsgKCh2b2lk
KShzaXplb2YoKCBsb25nKShQYWdlUG9pc29uZWQoY29tcG91bmRfaGVhZChwYWdlKSkpKSkp
OyBjb21wb3VuZF9oZWFkKHBhZ2UpOyB9KTsgfSktPmZsYWdzKTsgfSBzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19h
dHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB2b2lkIENsZWFyUGFnZU1hcHBlZFRv
RGlzayhzdHJ1Y3QgcGFnZSAqcGFnZSkgeyBjbGVhcl9iaXQoUEdfbWFwcGVkdG9kaXNrLCAm
KHsgKCh2b2lkKShzaXplb2YoKCBsb25nKSgxICYmIFBhZ2VUYWlsKHBhZ2UpKSkpKTsgKHsg
KCh2b2lkKShzaXplb2YoKCBsb25nKShQYWdlUG9pc29uZWQoY29tcG91bmRfaGVhZChwYWdl
KSkpKSkpOyBjb21wb3VuZF9oZWFkKHBhZ2UpOyB9KTsgfSktPmZsYWdzKTsgfQoKCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIGludCBQYWdlUmVjbGFp
bShzdHJ1Y3QgcGFnZSAqcGFnZSkgeyByZXR1cm4gdGVzdF9iaXQoUEdfcmVjbGFpbSwgJih7
ICgodm9pZCkoc2l6ZW9mKCggbG9uZykoMCAmJiBQYWdlVGFpbChwYWdlKSkpKSk7ICh7ICgo
dm9pZCkoc2l6ZW9mKCggbG9uZykoUGFnZVBvaXNvbmVkKGNvbXBvdW5kX2hlYWQocGFnZSkp
KSkpKTsgY29tcG91bmRfaGVhZChwYWdlKTsgfSk7IH0pLT5mbGFncyk7IH0gc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgdm9pZCBTZXRQYWdlUmVjbGFp
bShzdHJ1Y3QgcGFnZSAqcGFnZSkgeyBzZXRfYml0KFBHX3JlY2xhaW0sICYoeyAoKHZvaWQp
KHNpemVvZigoIGxvbmcpKDEgJiYgUGFnZVRhaWwocGFnZSkpKSkpOyAoeyAoKHZvaWQpKHNp
emVvZigoIGxvbmcpKFBhZ2VQb2lzb25lZChjb21wb3VuZF9oZWFkKHBhZ2UpKSkpKSk7IGNv
bXBvdW5kX2hlYWQocGFnZSk7IH0pOyB9KS0+ZmxhZ3MpOyB9IHN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJp
YnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHZvaWQgQ2xlYXJQYWdlUmVjbGFpbShzdHJ1
Y3QgcGFnZSAqcGFnZSkgeyBjbGVhcl9iaXQoUEdfcmVjbGFpbSwgJih7ICgodm9pZCkoc2l6
ZW9mKCggbG9uZykoMSAmJiBQYWdlVGFpbChwYWdlKSkpKSk7ICh7ICgodm9pZCkoc2l6ZW9m
KCggbG9uZykoUGFnZVBvaXNvbmVkKGNvbXBvdW5kX2hlYWQocGFnZSkpKSkpKTsgY29tcG91
bmRfaGVhZChwYWdlKTsgfSk7IH0pLT5mbGFncyk7IH0KIHN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0
ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIGludCBUZXN0Q2xlYXJQYWdlUmVjbGFpbShzdHJ1
Y3QgcGFnZSAqcGFnZSkgeyByZXR1cm4gdGVzdF9hbmRfY2xlYXJfYml0KFBHX3JlY2xhaW0s
ICYoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKDEgJiYgUGFnZVRhaWwocGFnZSkpKSkpOyAo
eyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKFBhZ2VQb2lzb25lZChjb21wb3VuZF9oZWFkKHBh
Z2UpKSkpKSk7IGNvbXBvdW5kX2hlYWQocGFnZSk7IH0pOyB9KS0+ZmxhZ3MpOyB9CnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIGludCBQYWdlUmVhZGFo
ZWFkKHN0cnVjdCBwYWdlICpwYWdlKSB7IHJldHVybiB0ZXN0X2JpdChQR19yZWNsYWltLCAm
KHsgKCh2b2lkKShzaXplb2YoKCBsb25nKSgwICYmIFBhZ2VDb21wb3VuZChwYWdlKSkpKSk7
ICh7ICgodm9pZCkoc2l6ZW9mKCggbG9uZykoUGFnZVBvaXNvbmVkKHBhZ2UpKSkpKTsgcGFn
ZTsgfSk7IH0pLT5mbGFncyk7IH0gc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlz
X2lubGluZV9fKSkgdm9pZCBTZXRQYWdlUmVhZGFoZWFkKHN0cnVjdCBwYWdlICpwYWdlKSB7
IHNldF9iaXQoUEdfcmVjbGFpbSwgJih7ICgodm9pZCkoc2l6ZW9mKCggbG9uZykoMSAmJiBQ
YWdlQ29tcG91bmQocGFnZSkpKSkpOyAoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKFBhZ2VQ
b2lzb25lZChwYWdlKSkpKSk7IHBhZ2U7IH0pOyB9KS0+ZmxhZ3MpOyB9IHN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBf
X2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHZvaWQgQ2xlYXJQYWdlUmVhZGFo
ZWFkKHN0cnVjdCBwYWdlICpwYWdlKSB7IGNsZWFyX2JpdChQR19yZWNsYWltLCAmKHsgKCh2
b2lkKShzaXplb2YoKCBsb25nKSgxICYmIFBhZ2VDb21wb3VuZChwYWdlKSkpKSk7ICh7ICgo
dm9pZCkoc2l6ZW9mKCggbG9uZykoUGFnZVBvaXNvbmVkKHBhZ2UpKSkpKTsgcGFnZTsgfSk7
IH0pLT5mbGFncyk7IH0KIHN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxp
bmVfXykpIGludCBUZXN0Q2xlYXJQYWdlUmVhZGFoZWFkKHN0cnVjdCBwYWdlICpwYWdlKSB7
IHJldHVybiB0ZXN0X2FuZF9jbGVhcl9iaXQoUEdfcmVjbGFpbSwgJih7ICgodm9pZCkoc2l6
ZW9mKCggbG9uZykoMSAmJiBQYWdlQ29tcG91bmQocGFnZSkpKSkpOyAoeyAoKHZvaWQpKHNp
emVvZigoIGxvbmcpKFBhZ2VQb2lzb25lZChwYWdlKSkpKSk7IHBhZ2U7IH0pOyB9KS0+Zmxh
Z3MpOyB9CiMgMzg0ICIuL2luY2x1ZGUvbGludXgvcGFnZS1mbGFncy5oIgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
aW50IFBhZ2VIaWdoTWVtKGNvbnN0IHN0cnVjdCBwYWdlICpwYWdlKSB7IHJldHVybiAwOyB9
IHN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSB2b2lkIFNldFBhZ2VIaWdoTWVtKHN0cnVjdCBwYWdlICpwYWdlKSB7IH0g
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIHZvaWQgQ2xlYXJQYWdlSGlnaE1lbShzdHJ1Y3QgcGFnZSAqcGFnZSkgeyB9
CgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIGludCBQ
YWdlU3dhcENhY2hlKHN0cnVjdCBwYWdlICpwYWdlKQp7CgoKCiByZXR1cm4gUGFnZVN3YXBC
YWNrZWQocGFnZSkgJiYgdGVzdF9iaXQoUEdfc3dhcGNhY2hlLCAmcGFnZS0+ZmxhZ3MpOwoK
fQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB2b2lkIFNl
dFBhZ2VTd2FwQ2FjaGUoc3RydWN0IHBhZ2UgKnBhZ2UpIHsgc2V0X2JpdChQR19zd2FwY2Fj
aGUsICYoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKDEgJiYgUGFnZVRhaWwocGFnZSkpKSkp
OyAoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKFBhZ2VQb2lzb25lZChjb21wb3VuZF9oZWFk
KHBhZ2UpKSkpKSk7IGNvbXBvdW5kX2hlYWQocGFnZSk7IH0pOyB9KS0+ZmxhZ3MpOyB9CnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHZvaWQgQ2xlYXJQ
YWdlU3dhcENhY2hlKHN0cnVjdCBwYWdlICpwYWdlKSB7IGNsZWFyX2JpdChQR19zd2FwY2Fj
aGUsICYoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKDEgJiYgUGFnZVRhaWwocGFnZSkpKSkp
OyAoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKFBhZ2VQb2lzb25lZChjb21wb3VuZF9oZWFk
KHBhZ2UpKSkpKSk7IGNvbXBvdW5kX2hlYWQocGFnZSk7IH0pOyB9KS0+ZmxhZ3MpOyB9CgoK
CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBpbnQgUGFn
ZVVuZXZpY3RhYmxlKHN0cnVjdCBwYWdlICpwYWdlKSB7IHJldHVybiB0ZXN0X2JpdChQR191
bmV2aWN0YWJsZSwgJih7ICgodm9pZCkoc2l6ZW9mKCggbG9uZykoUGFnZVBvaXNvbmVkKGNv
bXBvdW5kX2hlYWQocGFnZSkpKSkpKTsgY29tcG91bmRfaGVhZChwYWdlKTsgfSktPmZsYWdz
KTsgfSBzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB2b2lk
IFNldFBhZ2VVbmV2aWN0YWJsZShzdHJ1Y3QgcGFnZSAqcGFnZSkgeyBzZXRfYml0KFBHX3Vu
ZXZpY3RhYmxlLCAmKHsgKCh2b2lkKShzaXplb2YoKCBsb25nKShQYWdlUG9pc29uZWQoY29t
cG91bmRfaGVhZChwYWdlKSkpKSkpOyBjb21wb3VuZF9oZWFkKHBhZ2UpOyB9KS0+ZmxhZ3Mp
OyB9IHN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHZvaWQg
Q2xlYXJQYWdlVW5ldmljdGFibGUoc3RydWN0IHBhZ2UgKnBhZ2UpIHsgY2xlYXJfYml0KFBH
X3VuZXZpY3RhYmxlLCAmKHsgKCh2b2lkKShzaXplb2YoKCBsb25nKShQYWdlUG9pc29uZWQo
Y29tcG91bmRfaGVhZChwYWdlKSkpKSkpOyBjb21wb3VuZF9oZWFkKHBhZ2UpOyB9KS0+Zmxh
Z3MpOyB9CiBzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB2
b2lkIF9fQ2xlYXJQYWdlVW5ldmljdGFibGUoc3RydWN0IHBhZ2UgKnBhZ2UpIHsgX19jbGVh
cl9iaXQoUEdfdW5ldmljdGFibGUsICYoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKFBhZ2VQ
b2lzb25lZChjb21wb3VuZF9oZWFkKHBhZ2UpKSkpKSk7IGNvbXBvdW5kX2hlYWQocGFnZSk7
IH0pLT5mbGFncyk7IH0KIHN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxp
bmVfXykpIGludCBUZXN0Q2xlYXJQYWdlVW5ldmljdGFibGUoc3RydWN0IHBhZ2UgKnBhZ2Up
IHsgcmV0dXJuIHRlc3RfYW5kX2NsZWFyX2JpdChQR191bmV2aWN0YWJsZSwgJih7ICgodm9p
ZCkoc2l6ZW9mKCggbG9uZykoUGFnZVBvaXNvbmVkKGNvbXBvdW5kX2hlYWQocGFnZSkpKSkp
KTsgY29tcG91bmRfaGVhZChwYWdlKTsgfSktPmZsYWdzKTsgfQoKCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0
dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIGludCBQYWdlTWxvY2tlZChzdHJ1Y3Qg
cGFnZSAqcGFnZSkgeyByZXR1cm4gdGVzdF9iaXQoUEdfbWxvY2tlZCwgJih7ICgodm9pZCko
c2l6ZW9mKCggbG9uZykoMCAmJiBQYWdlVGFpbChwYWdlKSkpKSk7ICh7ICgodm9pZCkoc2l6
ZW9mKCggbG9uZykoUGFnZVBvaXNvbmVkKGNvbXBvdW5kX2hlYWQocGFnZSkpKSkpKTsgY29t
cG91bmRfaGVhZChwYWdlKTsgfSk7IH0pLT5mbGFncyk7IH0gc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmli
dXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgdm9pZCBTZXRQYWdlTWxvY2tlZChzdHJ1Y3Qg
cGFnZSAqcGFnZSkgeyBzZXRfYml0KFBHX21sb2NrZWQsICYoeyAoKHZvaWQpKHNpemVvZigo
IGxvbmcpKDEgJiYgUGFnZVRhaWwocGFnZSkpKSkpOyAoeyAoKHZvaWQpKHNpemVvZigoIGxv
bmcpKFBhZ2VQb2lzb25lZChjb21wb3VuZF9oZWFkKHBhZ2UpKSkpKSk7IGNvbXBvdW5kX2hl
YWQocGFnZSk7IH0pOyB9KS0+ZmxhZ3MpOyB9IHN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChf
X2Fsd2F5c19pbmxpbmVfXykpIHZvaWQgQ2xlYXJQYWdlTWxvY2tlZChzdHJ1Y3QgcGFnZSAq
cGFnZSkgeyBjbGVhcl9iaXQoUEdfbWxvY2tlZCwgJih7ICgodm9pZCkoc2l6ZW9mKCggbG9u
ZykoMSAmJiBQYWdlVGFpbChwYWdlKSkpKSk7ICh7ICgodm9pZCkoc2l6ZW9mKCggbG9uZyko
UGFnZVBvaXNvbmVkKGNvbXBvdW5kX2hlYWQocGFnZSkpKSkpKTsgY29tcG91bmRfaGVhZChw
YWdlKTsgfSk7IH0pLT5mbGFncyk7IH0KIHN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fs
d2F5c19pbmxpbmVfXykpIHZvaWQgX19DbGVhclBhZ2VNbG9ja2VkKHN0cnVjdCBwYWdlICpw
YWdlKSB7IF9fY2xlYXJfYml0KFBHX21sb2NrZWQsICYoeyAoKHZvaWQpKHNpemVvZigoIGxv
bmcpKDEgJiYgUGFnZVRhaWwocGFnZSkpKSkpOyAoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcp
KFBhZ2VQb2lzb25lZChjb21wb3VuZF9oZWFkKHBhZ2UpKSkpKSk7IGNvbXBvdW5kX2hlYWQo
cGFnZSk7IH0pOyB9KS0+ZmxhZ3MpOyB9CiBzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19h
bHdheXNfaW5saW5lX18pKSBpbnQgVGVzdFNldFBhZ2VNbG9ja2VkKHN0cnVjdCBwYWdlICpw
YWdlKSB7IHJldHVybiB0ZXN0X2FuZF9zZXRfYml0KFBHX21sb2NrZWQsICYoeyAoKHZvaWQp
KHNpemVvZigoIGxvbmcpKDEgJiYgUGFnZVRhaWwocGFnZSkpKSkpOyAoeyAoKHZvaWQpKHNp
emVvZigoIGxvbmcpKFBhZ2VQb2lzb25lZChjb21wb3VuZF9oZWFkKHBhZ2UpKSkpKSk7IGNv
bXBvdW5kX2hlYWQocGFnZSk7IH0pOyB9KS0+ZmxhZ3MpOyB9IHN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJp
YnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIGludCBUZXN0Q2xlYXJQYWdlTWxvY2tlZChz
dHJ1Y3QgcGFnZSAqcGFnZSkgeyByZXR1cm4gdGVzdF9hbmRfY2xlYXJfYml0KFBHX21sb2Nr
ZWQsICYoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKDEgJiYgUGFnZVRhaWwocGFnZSkpKSkp
OyAoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKFBhZ2VQb2lzb25lZChjb21wb3VuZF9oZWFk
KHBhZ2UpKSkpKSk7IGNvbXBvdW5kX2hlYWQocGFnZSk7IH0pOyB9KS0+ZmxhZ3MpOyB9CiMg
NDE4ICIuL2luY2x1ZGUvbGludXgvcGFnZS1mbGFncy5oIgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IFBhZ2VV
bmNhY2hlZChjb25zdCBzdHJ1Y3QgcGFnZSAqcGFnZSkgeyByZXR1cm4gMDsgfSBzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgdm9pZCBTZXRQYWdlVW5jYWNoZWQoc3RydWN0IHBhZ2UgKnBhZ2UpIHsgfSBzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgdm9pZCBDbGVhclBhZ2VVbmNhY2hlZChzdHJ1Y3QgcGFnZSAqcGFnZSkgeyB9CiMgNDI3
ICIuL2luY2x1ZGUvbGludXgvcGFnZS1mbGFncy5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IFBhZ2VIV1Bv
aXNvbihjb25zdCBzdHJ1Y3QgcGFnZSAqcGFnZSkgeyByZXR1cm4gMDsgfSBzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
dm9pZCBTZXRQYWdlSFdQb2lzb24oc3RydWN0IHBhZ2UgKnBhZ2UpIHsgfSBzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
dm9pZCBDbGVhclBhZ2VIV1BvaXNvbihzdHJ1Y3QgcGFnZSAqcGFnZSkgeyB9CnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBib29sIHNldF9od3BvaXNvbl9mcmVlX2J1ZGR5X3BhZ2Uoc3RydWN0IHBhZ2UgKnBhZ2Up
CnsKIHJldHVybiAwOwp9CiMgNDQ4ICIuL2luY2x1ZGUvbGludXgvcGFnZS1mbGFncy5oIgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBpbnQgUGFnZVJl
cG9ydGVkKHN0cnVjdCBwYWdlICpwYWdlKSB7IHJldHVybiB0ZXN0X2JpdChQR19yZXBvcnRl
ZCwgJih7ICgodm9pZCkoc2l6ZW9mKCggbG9uZykoMCAmJiBQYWdlQ29tcG91bmQocGFnZSkp
KSkpOyAoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKFBhZ2VQb2lzb25lZChwYWdlKSkpKSk7
IHBhZ2U7IH0pOyB9KS0+ZmxhZ3MpOyB9IHN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fs
d2F5c19pbmxpbmVfXykpIHZvaWQgX19TZXRQYWdlUmVwb3J0ZWQoc3RydWN0IHBhZ2UgKnBh
Z2UpIHsgX19zZXRfYml0KFBHX3JlcG9ydGVkLCAmKHsgKCh2b2lkKShzaXplb2YoKCBsb25n
KSgxICYmIFBhZ2VDb21wb3VuZChwYWdlKSkpKSk7ICh7ICgodm9pZCkoc2l6ZW9mKCggbG9u
ZykoUGFnZVBvaXNvbmVkKHBhZ2UpKSkpKTsgcGFnZTsgfSk7IH0pLT5mbGFncyk7IH0gc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgdm9pZCBfX0NsZWFy
UGFnZVJlcG9ydGVkKHN0cnVjdCBwYWdlICpwYWdlKSB7IF9fY2xlYXJfYml0KFBHX3JlcG9y
dGVkLCAmKHsgKCh2b2lkKShzaXplb2YoKCBsb25nKSgxICYmIFBhZ2VDb21wb3VuZChwYWdl
KSkpKSk7ICh7ICgodm9pZCkoc2l6ZW9mKCggbG9uZykoUGFnZVBvaXNvbmVkKHBhZ2UpKSkp
KTsgcGFnZTsgfSk7IH0pLT5mbGFncyk7IH0KIyA0NzIgIi4vaW5jbHVkZS9saW51eC9wYWdl
LWZsYWdzLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykp
IGludCBQYWdlTWFwcGluZ0ZsYWdzKHN0cnVjdCBwYWdlICpwYWdlKQp7CiByZXR1cm4gKCh1
bnNpZ25lZCBsb25nKXBhZ2UtPm1hcHBpbmcgJiAoMHgxIHwgMHgyKSkgIT0gMDsKfQoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgaW50IFBhZ2VBbm9u
KHN0cnVjdCBwYWdlICpwYWdlKQp7CiBwYWdlID0gY29tcG91bmRfaGVhZChwYWdlKTsKIHJl
dHVybiAoKHVuc2lnbmVkIGxvbmcpcGFnZS0+bWFwcGluZyAmIDB4MSkgIT0gMDsKfQoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgaW50IF9fUGFnZU1v
dmFibGUoc3RydWN0IHBhZ2UgKnBhZ2UpCnsKIHJldHVybiAoKHVuc2lnbmVkIGxvbmcpcGFn
ZS0+bWFwcGluZyAmICgweDEgfCAweDIpKSA9PQogICAgMHgyOwp9CiMgNTAzICIuL2luY2x1
ZGUvbGludXgvcGFnZS1mbGFncy5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IFBhZ2VLc20oY29uc3Qgc3Ry
dWN0IHBhZ2UgKnBhZ2UpIHsgcmV0dXJuIDA7IH0KCgp1NjQgc3RhYmxlX3BhZ2VfZmxhZ3Mo
c3RydWN0IHBhZ2UgKnBhZ2UpOwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBQYWdlVXB0b2RhdGUoc3RydWN0
IHBhZ2UgKnBhZ2UpCnsKIGludCByZXQ7CiBwYWdlID0gY29tcG91bmRfaGVhZChwYWdlKTsK
IHJldCA9IHRlc3RfYml0KFBHX3VwdG9kYXRlLCAmKHBhZ2UpLT5mbGFncyk7CiMgNTIxICIu
L2luY2x1ZGUvbGludXgvcGFnZS1mbGFncy5oIgogaWYgKHJldCkKICBfX2FzbV9fIF9fdm9s
YXRpbGVfXyAoImx3c3luYyIgIiAiIDogOiA6Im1lbW9yeSIpOwoKIHJldHVybiByZXQ7Cn0K
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHZvaWQgX19T
ZXRQYWdlVXB0b2RhdGUoc3RydWN0IHBhZ2UgKnBhZ2UpCnsKICgodm9pZCkoc2l6ZW9mKCgg
bG9uZykoUGFnZVRhaWwocGFnZSkpKSkpOwogX19hc21fXyBfX3ZvbGF0aWxlX18gKCJsd3N5
bmMiICIgIiA6IDogOiJtZW1vcnkiKTsKIF9fc2V0X2JpdChQR191cHRvZGF0ZSwgJnBhZ2Ut
PmZsYWdzKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9f
KSkgdm9pZCBTZXRQYWdlVXB0b2RhdGUoc3RydWN0IHBhZ2UgKnBhZ2UpCnsKICgodm9pZCko
c2l6ZW9mKCggbG9uZykoUGFnZVRhaWwocGFnZSkpKSkpOwoKCgoKCiBfX2FzbV9fIF9fdm9s
YXRpbGVfXyAoImx3c3luYyIgIiAiIDogOiA6Im1lbW9yeSIpOwogc2V0X2JpdChQR191cHRv
ZGF0ZSwgJnBhZ2UtPmZsYWdzKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3
YXlzX2lubGluZV9fKSkgdm9pZCBDbGVhclBhZ2VVcHRvZGF0ZShzdHJ1Y3QgcGFnZSAqcGFn
ZSkgeyBjbGVhcl9iaXQoUEdfdXB0b2RhdGUsICYoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcp
KDEgJiYgUGFnZVRhaWwocGFnZSkpKSkpOyAoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKFBh
Z2VQb2lzb25lZChjb21wb3VuZF9oZWFkKHBhZ2UpKSkpKSk7IGNvbXBvdW5kX2hlYWQocGFn
ZSk7IH0pOyB9KS0+ZmxhZ3MpOyB9CgppbnQgdGVzdF9jbGVhcl9wYWdlX3dyaXRlYmFjayhz
dHJ1Y3QgcGFnZSAqcGFnZSk7CmludCBfX3Rlc3Rfc2V0X3BhZ2Vfd3JpdGViYWNrKHN0cnVj
dCBwYWdlICpwYWdlLCBib29sIGtlZXBfd3JpdGUpOwoKCgoKCgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBz
ZXRfcGFnZV93cml0ZWJhY2soc3RydWN0IHBhZ2UgKnBhZ2UpCnsKIF9fdGVzdF9zZXRfcGFn
ZV93cml0ZWJhY2socGFnZSwgZmFsc2UpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBzZXRfcGFnZV93
cml0ZWJhY2tfa2VlcHdyaXRlKHN0cnVjdCBwYWdlICpwYWdlKQp7CiBfX3Rlc3Rfc2V0X3Bh
Z2Vfd3JpdGViYWNrKHBhZ2UsIHRydWUpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygo
X19hbHdheXNfaW5saW5lX18pKSBpbnQgUGFnZUhlYWQoc3RydWN0IHBhZ2UgKnBhZ2UpIHsg
cmV0dXJuIHRlc3RfYml0KFBHX2hlYWQsICYoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKFBh
Z2VQb2lzb25lZChwYWdlKSkpKSk7IHBhZ2U7IH0pLT5mbGFncyk7IH0gc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9f
YXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgdm9pZCBfX1NldFBhZ2VIZWFkKHN0
cnVjdCBwYWdlICpwYWdlKSB7IF9fc2V0X2JpdChQR19oZWFkLCAmKHsgKCh2b2lkKShzaXpl
b2YoKCBsb25nKShQYWdlUG9pc29uZWQocGFnZSkpKSkpOyBwYWdlOyB9KS0+ZmxhZ3MpOyB9
IHN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHZvaWQgX19D
bGVhclBhZ2VIZWFkKHN0cnVjdCBwYWdlICpwYWdlKSB7IF9fY2xlYXJfYml0KFBHX2hlYWQs
ICYoeyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKFBhZ2VQb2lzb25lZChwYWdlKSkpKSk7IHBh
Z2U7IH0pLT5mbGFncyk7IH0gc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lu
bGluZV9fKSkgdm9pZCBDbGVhclBhZ2VIZWFkKHN0cnVjdCBwYWdlICpwYWdlKSB7IGNsZWFy
X2JpdChQR19oZWFkLCAmKHsgKCh2b2lkKShzaXplb2YoKCBsb25nKShQYWdlUG9pc29uZWQo
cGFnZSkpKSkpOyBwYWdlOyB9KS0+ZmxhZ3MpOyB9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVf
XygoX19hbHdheXNfaW5saW5lX18pKSB2b2lkIHNldF9jb21wb3VuZF9oZWFkKHN0cnVjdCBw
YWdlICpwYWdlLCBzdHJ1Y3QgcGFnZSAqaGVhZCkKewogZG8geyBkbyB7IGV4dGVybiB2b2lk
IF9fY29tcGlsZXRpbWVfYXNzZXJ0XzExNCh2b2lkKSBfX2F0dHJpYnV0ZV9fKChfX2Vycm9y
X18oIlVuc3VwcG9ydGVkIGFjY2VzcyBzaXplIGZvciB7UkVBRCxXUklURX1fT05DRSgpLiIp
KSk7IGlmICghKChzaXplb2YocGFnZS0+Y29tcG91bmRfaGVhZCkgPT0gc2l6ZW9mKGNoYXIp
IHx8IHNpemVvZihwYWdlLT5jb21wb3VuZF9oZWFkKSA9PSBzaXplb2Yoc2hvcnQpIHx8IHNp
emVvZihwYWdlLT5jb21wb3VuZF9oZWFkKSA9PSBzaXplb2YoaW50KSB8fCBzaXplb2YocGFn
ZS0+Y29tcG91bmRfaGVhZCkgPT0gc2l6ZW9mKGxvbmcpKSB8fCBzaXplb2YocGFnZS0+Y29t
cG91bmRfaGVhZCkgPT0gc2l6ZW9mKGxvbmcgbG9uZykpKSBfX2NvbXBpbGV0aW1lX2Fzc2Vy
dF8xMTQoKTsgfSB3aGlsZSAoMCk7IGRvIHsgKih2b2xhdGlsZSB0eXBlb2YocGFnZS0+Y29t
cG91bmRfaGVhZCkgKikmKHBhZ2UtPmNvbXBvdW5kX2hlYWQpID0gKCh1bnNpZ25lZCBsb25n
KWhlYWQgKyAxKTsgfSB3aGlsZSAoMCk7IH0gd2hpbGUgKDApOwp9CgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19h
dHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB2b2lkIGNsZWFyX2NvbXBvdW5kX2hl
YWQoc3RydWN0IHBhZ2UgKnBhZ2UpCnsKIGRvIHsgZG8geyBleHRlcm4gdm9pZCBfX2NvbXBp
bGV0aW1lX2Fzc2VydF8xMTUodm9pZCkgX19hdHRyaWJ1dGVfXygoX19lcnJvcl9fKCJVbnN1
cHBvcnRlZCBhY2Nlc3Mgc2l6ZSBmb3Ige1JFQUQsV1JJVEV9X09OQ0UoKS4iKSkpOyBpZiAo
ISgoc2l6ZW9mKHBhZ2UtPmNvbXBvdW5kX2hlYWQpID09IHNpemVvZihjaGFyKSB8fCBzaXpl
b2YocGFnZS0+Y29tcG91bmRfaGVhZCkgPT0gc2l6ZW9mKHNob3J0KSB8fCBzaXplb2YocGFn
ZS0+Y29tcG91bmRfaGVhZCkgPT0gc2l6ZW9mKGludCkgfHwgc2l6ZW9mKHBhZ2UtPmNvbXBv
dW5kX2hlYWQpID09IHNpemVvZihsb25nKSkgfHwgc2l6ZW9mKHBhZ2UtPmNvbXBvdW5kX2hl
YWQpID09IHNpemVvZihsb25nIGxvbmcpKSkgX19jb21waWxldGltZV9hc3NlcnRfMTE1KCk7
IH0gd2hpbGUgKDApOyBkbyB7ICoodm9sYXRpbGUgdHlwZW9mKHBhZ2UtPmNvbXBvdW5kX2hl
YWQpICopJihwYWdlLT5jb21wb3VuZF9oZWFkKSA9ICgwKTsgfSB3aGlsZSAoMCk7IH0gd2hp
bGUgKDApOwp9CiMgNTg5ICIuL2luY2x1ZGUvbGludXgvcGFnZS1mbGFncy5oIgppbnQgUGFn
ZUh1Z2Uoc3RydWN0IHBhZ2UgKnBhZ2UpOwppbnQgUGFnZUhlYWRIdWdlKHN0cnVjdCBwYWdl
ICpwYWdlKTsKYm9vbCBwYWdlX2h1Z2VfYWN0aXZlKHN0cnVjdCBwYWdlICpwYWdlKTsKIyA3
MTcgIi4vaW5jbHVkZS9saW51eC9wYWdlLWZsYWdzLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgUGFnZVRy
YW5zSHVnZShjb25zdCBzdHJ1Y3QgcGFnZSAqcGFnZSkgeyByZXR1cm4gMDsgfQpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgaW50IFBhZ2VUcmFuc0NvbXBvdW5kKGNvbnN0IHN0cnVjdCBwYWdlICpwYWdlKSB7IHJl
dHVybiAwOyB9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgUGFnZVRyYW5zQ29tcG91bmRNYXAoY29uc3Qgc3Ry
dWN0IHBhZ2UgKnBhZ2UpIHsgcmV0dXJuIDA7IH0Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBQYWdlVHJhbnNU
YWlsKGNvbnN0IHN0cnVjdCBwYWdlICpwYWdlKSB7IHJldHVybiAwOyB9CnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBp
bnQgUGFnZURvdWJsZU1hcChjb25zdCBzdHJ1Y3QgcGFnZSAqcGFnZSkgeyByZXR1cm4gMDsg
fSBzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgdm9pZCBTZXRQYWdlRG91YmxlTWFwKHN0cnVjdCBwYWdlICpwYWdlKSB7
IH0gc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIHZvaWQgQ2xlYXJQYWdlRG91YmxlTWFwKHN0cnVjdCBwYWdlICpwYWdl
KSB7IH0KIHN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSBpbnQgVGVzdFNldFBhZ2VEb3VibGVNYXAoc3RydWN0IHBhZ2Ug
KnBhZ2UpIHsgcmV0dXJuIDA7IH0KIHN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgVGVzdENsZWFyUGFnZURvdWJs
ZU1hcChzdHJ1Y3QgcGFnZSAqcGFnZSkgeyByZXR1cm4gMDsgfQojIDc0NyAiLi9pbmNsdWRl
L2xpbnV4L3BhZ2UtZmxhZ3MuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBwYWdlX2hhc190eXBlKHN0cnVj
dCBwYWdlICpwYWdlKQp7CiByZXR1cm4gKGludClwYWdlLT5wYWdlX3R5cGUgPCAtMTI4Owp9
CiMgNzcyICIuL2luY2x1ZGUvbGludXgvcGFnZS1mbGFncy5oIgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRy
aWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBpbnQgUGFnZUJ1ZGR5KHN0cnVjdCBwYWdl
ICpwYWdlKSB7IHJldHVybiAoKHBhZ2UtPnBhZ2VfdHlwZSAmICgweGYwMDAwMDAwIHwgMHgw
MDAwMDA4MCkpID09IDB4ZjAwMDAwMDApOyB9IHN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChf
X2Fsd2F5c19pbmxpbmVfXykpIHZvaWQgX19TZXRQYWdlQnVkZHkoc3RydWN0IHBhZ2UgKnBh
Z2UpIHsgKCh2b2lkKShzaXplb2YoKCBsb25nKSghKChwYWdlLT5wYWdlX3R5cGUgJiAoMHhm
MDAwMDAwMCB8IDApKSA9PSAweGYwMDAwMDAwKSkpKSk7IHBhZ2UtPnBhZ2VfdHlwZSAmPSB+
MHgwMDAwMDA4MDsgfSBzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5l
X18pKSB2b2lkIF9fQ2xlYXJQYWdlQnVkZHkoc3RydWN0IHBhZ2UgKnBhZ2UpIHsgKCh2b2lk
KShzaXplb2YoKCBsb25nKSghUGFnZUJ1ZGR5KHBhZ2UpKSkpKTsgcGFnZS0+cGFnZV90eXBl
IHw9IDB4MDAwMDAwODA7IH0KIyA3OTEgIi4vaW5jbHVkZS9saW51eC9wYWdlLWZsYWdzLmgi
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIGludCBQYWdl
T2ZmbGluZShzdHJ1Y3QgcGFnZSAqcGFnZSkgeyByZXR1cm4gKChwYWdlLT5wYWdlX3R5cGUg
JiAoMHhmMDAwMDAwMCB8IDB4MDAwMDAxMDApKSA9PSAweGYwMDAwMDAwKTsgfSBzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB2b2lkIF9fU2V0UGFnZU9m
ZmxpbmUoc3RydWN0IHBhZ2UgKnBhZ2UpIHsgKCh2b2lkKShzaXplb2YoKCBsb25nKSghKChw
YWdlLT5wYWdlX3R5cGUgJiAoMHhmMDAwMDAwMCB8IDApKSA9PSAweGYwMDAwMDAwKSkpKSk7
IHBhZ2UtPnBhZ2VfdHlwZSAmPSB+MHgwMDAwMDEwMDsgfSBzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1
dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB2b2lkIF9fQ2xlYXJQYWdlT2ZmbGluZShzdHJ1
Y3QgcGFnZSAqcGFnZSkgeyAoKHZvaWQpKHNpemVvZigoIGxvbmcpKCFQYWdlT2ZmbGluZShw
YWdlKSkpKSk7IHBhZ2UtPnBhZ2VfdHlwZSB8PSAweDAwMDAwMTAwOyB9CgoKCgoKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgaW50IFBhZ2VLbWVtY2co
c3RydWN0IHBhZ2UgKnBhZ2UpIHsgcmV0dXJuICgocGFnZS0+cGFnZV90eXBlICYgKDB4ZjAw
MDAwMDAgfCAweDAwMDAwMjAwKSkgPT0gMHhmMDAwMDAwMCk7IH0gc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0
cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgdm9pZCBfX1NldFBhZ2VLbWVtY2coc3Ry
dWN0IHBhZ2UgKnBhZ2UpIHsgKCh2b2lkKShzaXplb2YoKCBsb25nKSghKChwYWdlLT5wYWdl
X3R5cGUgJiAoMHhmMDAwMDAwMCB8IDApKSA9PSAweGYwMDAwMDAwKSkpKSk7IHBhZ2UtPnBh
Z2VfdHlwZSAmPSB+MHgwMDAwMDIwMDsgfSBzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19h
bHdheXNfaW5saW5lX18pKSB2b2lkIF9fQ2xlYXJQYWdlS21lbWNnKHN0cnVjdCBwYWdlICpw
YWdlKSB7ICgodm9pZCkoc2l6ZW9mKCggbG9uZykoIVBhZ2VLbWVtY2cocGFnZSkpKSkpOyBw
YWdlLT5wYWdlX3R5cGUgfD0gMHgwMDAwMDIwMDsgfQoKCgoKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmli
dXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgaW50IFBhZ2VUYWJsZShzdHJ1Y3QgcGFnZSAq
cGFnZSkgeyByZXR1cm4gKChwYWdlLT5wYWdlX3R5cGUgJiAoMHhmMDAwMDAwMCB8IDB4MDAw
MDA0MDApKSA9PSAweGYwMDAwMDAwKTsgfSBzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19h
bHdheXNfaW5saW5lX18pKSB2b2lkIF9fU2V0UGFnZVRhYmxlKHN0cnVjdCBwYWdlICpwYWdl
KSB7ICgodm9pZCkoc2l6ZW9mKCggbG9uZykoISgocGFnZS0+cGFnZV90eXBlICYgKDB4ZjAw
MDAwMDAgfCAwKSkgPT0gMHhmMDAwMDAwMCkpKSkpOyBwYWdlLT5wYWdlX3R5cGUgJj0gfjB4
MDAwMDA0MDA7IH0gc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9f
KSkgdm9pZCBfX0NsZWFyUGFnZVRhYmxlKHN0cnVjdCBwYWdlICpwYWdlKSB7ICgodm9pZCko
c2l6ZW9mKCggbG9uZykoIVBhZ2VUYWJsZShwYWdlKSkpKSk7IHBhZ2UtPnBhZ2VfdHlwZSB8
PSAweDAwMDAwNDAwOyB9CgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNf
aW5saW5lX18pKSBpbnQgUGFnZUd1YXJkKHN0cnVjdCBwYWdlICpwYWdlKSB7IHJldHVybiAo
KHBhZ2UtPnBhZ2VfdHlwZSAmICgweGYwMDAwMDAwIHwgMHgwMDAwMDgwMCkpID09IDB4ZjAw
MDAwMDApOyB9IHN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykp
IHZvaWQgX19TZXRQYWdlR3VhcmQoc3RydWN0IHBhZ2UgKnBhZ2UpIHsgKCh2b2lkKShzaXpl
b2YoKCBsb25nKSghKChwYWdlLT5wYWdlX3R5cGUgJiAoMHhmMDAwMDAwMCB8IDApKSA9PSAw
eGYwMDAwMDAwKSkpKSk7IHBhZ2UtPnBhZ2VfdHlwZSAmPSB+MHgwMDAwMDgwMDsgfSBzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB2b2lkIF9fQ2xlYXJQ
YWdlR3VhcmQoc3RydWN0IHBhZ2UgKnBhZ2UpIHsgKCh2b2lkKShzaXplb2YoKCBsb25nKSgh
UGFnZUd1YXJkKHBhZ2UpKSkpKTsgcGFnZS0+cGFnZV90eXBlIHw9IDB4MDAwMDA4MDA7IH0K
CmV4dGVybiBib29sIGlzX2ZyZWVfYnVkZHlfcGFnZShzdHJ1Y3QgcGFnZSAqcGFnZSk7Cgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBpbnQgUGFnZUlz
b2xhdGVkKHN0cnVjdCBwYWdlICpwYWdlKSB7IHJldHVybiB0ZXN0X2JpdChQR19pc29sYXRl
ZCwgJih7ICgodm9pZCkoc2l6ZW9mKCggbG9uZykoUGFnZVBvaXNvbmVkKHBhZ2UpKSkpKTsg
cGFnZTsgfSktPmZsYWdzKTsgfSBzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNf
aW5saW5lX18pKSB2b2lkIF9fU2V0UGFnZUlzb2xhdGVkKHN0cnVjdCBwYWdlICpwYWdlKSB7
IF9fc2V0X2JpdChQR19pc29sYXRlZCwgJih7ICgodm9pZCkoc2l6ZW9mKCggbG9uZykoUGFn
ZVBvaXNvbmVkKHBhZ2UpKSkpKTsgcGFnZTsgfSktPmZsYWdzKTsgfSBzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19h
dHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB2b2lkIF9fQ2xlYXJQYWdlSXNvbGF0
ZWQoc3RydWN0IHBhZ2UgKnBhZ2UpIHsgX19jbGVhcl9iaXQoUEdfaXNvbGF0ZWQsICYoeyAo
KHZvaWQpKHNpemVvZigoIGxvbmcpKFBhZ2VQb2lzb25lZChwYWdlKSkpKSk7IHBhZ2U7IH0p
LT5mbGFncyk7IH07CgoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBQYWdlU2xhYlBmbWVtYWxsb2Moc3Ry
dWN0IHBhZ2UgKnBhZ2UpCnsKICgodm9pZCkoc2l6ZW9mKCggbG9uZykoIVBhZ2VTbGFiKHBh
Z2UpKSkpKTsKIHJldHVybiBQYWdlQWN0aXZlKHBhZ2UpOwp9CgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBT
ZXRQYWdlU2xhYlBmbWVtYWxsb2Moc3RydWN0IHBhZ2UgKnBhZ2UpCnsKICgodm9pZCkoc2l6
ZW9mKCggbG9uZykoIVBhZ2VTbGFiKHBhZ2UpKSkpKTsKIFNldFBhZ2VBY3RpdmUocGFnZSk7
Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSB2b2lkIF9fQ2xlYXJQYWdlU2xhYlBmbWVtYWxsb2Moc3RydWN0IHBh
Z2UgKnBhZ2UpCnsKICgodm9pZCkoc2l6ZW9mKCggbG9uZykoIVBhZ2VTbGFiKHBhZ2UpKSkp
KTsKIF9fQ2xlYXJQYWdlQWN0aXZlKHBhZ2UpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBDbGVhclBh
Z2VTbGFiUGZtZW1hbGxvYyhzdHJ1Y3QgcGFnZSAqcGFnZSkKewogKCh2b2lkKShzaXplb2Yo
KCBsb25nKSghUGFnZVNsYWIocGFnZSkpKSkpOwogQ2xlYXJQYWdlQWN0aXZlKHBhZ2UpOwp9
CiMgODc4ICIuL2luY2x1ZGUvbGludXgvcGFnZS1mbGFncy5oIgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHBh
Z2VfaGFzX3ByaXZhdGUoc3RydWN0IHBhZ2UgKnBhZ2UpCnsKIHJldHVybiAhIShwYWdlLT5m
bGFncyAmICgxVUwgPDwgUEdfcHJpdmF0ZSB8IDFVTCA8PCBQR19wcml2YXRlXzIpKTsKfQoj
IDIzICIuL2luY2x1ZGUvbGludXgvbW16b25lLmgiIDIKIyA0MSAiLi9pbmNsdWRlL2xpbnV4
L21tem9uZS5oIgplbnVtIG1pZ3JhdGV0eXBlIHsKIE1JR1JBVEVfVU5NT1ZBQkxFLAogTUlH
UkFURV9NT1ZBQkxFLAogTUlHUkFURV9SRUNMQUlNQUJMRSwKIE1JR1JBVEVfUENQVFlQRVMs
CiBNSUdSQVRFX0hJR0hBVE9NSUMgPSBNSUdSQVRFX1BDUFRZUEVTLAojIDY2ICIuL2luY2x1
ZGUvbGludXgvbW16b25lLmgiCiBNSUdSQVRFX1RZUEVTCn07CgoKZXh0ZXJuIGNvbnN0IGNo
YXIgKiBjb25zdCBtaWdyYXRldHlwZV9uYW1lc1tNSUdSQVRFX1RZUEVTXTsKIyA4MCAiLi9p
bmNsdWRlL2xpbnV4L21tem9uZS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBpc19taWdyYXRlX21vdmFi
bGUoaW50IG10KQp7CiByZXR1cm4gZmFsc2UgfHwgbXQgPT0gTUlHUkFURV9NT1ZBQkxFOwp9
CgoKCgoKZXh0ZXJuIGludCBwYWdlX2dyb3VwX2J5X21vYmlsaXR5X2Rpc2FibGVkOwojIDk4
ICIuL2luY2x1ZGUvbGludXgvbW16b25lLmgiCnN0cnVjdCBmcmVlX2FyZWEgewogc3RydWN0
IGxpc3RfaGVhZCBmcmVlX2xpc3RbTUlHUkFURV9UWVBFU107CiB1bnNpZ25lZCBsb25nIG5y
X2ZyZWU7Cn07CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IHBhZ2UgKmdldF9wYWdlX2Zyb21fZnJlZV9h
cmVhKHN0cnVjdCBmcmVlX2FyZWEgKmFyZWEsCiAgICAgICAgIGludCBtaWdyYXRldHlwZSkK
ewogcmV0dXJuICh7IHN0cnVjdCBsaXN0X2hlYWQgKmhlYWRfXyA9ICgmYXJlYS0+ZnJlZV9s
aXN0W21pZ3JhdGV0eXBlXSk7IHN0cnVjdCBsaXN0X2hlYWQgKnBvc19fID0gKHsgZG8geyBl
eHRlcm4gdm9pZCBfX2NvbXBpbGV0aW1lX2Fzc2VydF8xMTYodm9pZCkgX19hdHRyaWJ1dGVf
XygoX19lcnJvcl9fKCJVbnN1cHBvcnRlZCBhY2Nlc3Mgc2l6ZSBmb3Ige1JFQUQsV1JJVEV9
X09OQ0UoKS4iKSkpOyBpZiAoISgoc2l6ZW9mKGhlYWRfXy0+bmV4dCkgPT0gc2l6ZW9mKGNo
YXIpIHx8IHNpemVvZihoZWFkX18tPm5leHQpID09IHNpemVvZihzaG9ydCkgfHwgc2l6ZW9m
KGhlYWRfXy0+bmV4dCkgPT0gc2l6ZW9mKGludCkgfHwgc2l6ZW9mKGhlYWRfXy0+bmV4dCkg
PT0gc2l6ZW9mKGxvbmcpKSB8fCBzaXplb2YoaGVhZF9fLT5uZXh0KSA9PSBzaXplb2YobG9u
ZyBsb25nKSkpIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzExNigpOyB9IHdoaWxlICgwKTsgKHsg
dHlwZW9mKCBfR2VuZXJpYygoaGVhZF9fLT5uZXh0KSwgY2hhcjogKGNoYXIpMCwgdW5zaWdu
ZWQgY2hhcjogKHVuc2lnbmVkIGNoYXIpMCwgc2lnbmVkIGNoYXI6IChzaWduZWQgY2hhcikw
LCB1bnNpZ25lZCBzaG9ydDogKHVuc2lnbmVkIHNob3J0KTAsIHNpZ25lZCBzaG9ydDogKHNp
Z25lZCBzaG9ydCkwLCB1bnNpZ25lZCBpbnQ6ICh1bnNpZ25lZCBpbnQpMCwgc2lnbmVkIGlu
dDogKHNpZ25lZCBpbnQpMCwgdW5zaWduZWQgbG9uZzogKHVuc2lnbmVkIGxvbmcpMCwgc2ln
bmVkIGxvbmc6IChzaWduZWQgbG9uZykwLCB1bnNpZ25lZCBsb25nIGxvbmc6ICh1bnNpZ25l
ZCBsb25nIGxvbmcpMCwgc2lnbmVkIGxvbmcgbG9uZzogKHNpZ25lZCBsb25nIGxvbmcpMCwg
ZGVmYXVsdDogKGhlYWRfXy0+bmV4dCkpKSBfX3ggPSAoKihjb25zdCB2b2xhdGlsZSB0eXBl
b2YoIF9HZW5lcmljKChoZWFkX18tPm5leHQpLCBjaGFyOiAoY2hhcikwLCB1bnNpZ25lZCBj
aGFyOiAodW5zaWduZWQgY2hhcikwLCBzaWduZWQgY2hhcjogKHNpZ25lZCBjaGFyKTAsIHVu
c2lnbmVkIHNob3J0OiAodW5zaWduZWQgc2hvcnQpMCwgc2lnbmVkIHNob3J0OiAoc2lnbmVk
IHNob3J0KTAsIHVuc2lnbmVkIGludDogKHVuc2lnbmVkIGludCkwLCBzaWduZWQgaW50OiAo
c2lnbmVkIGludCkwLCB1bnNpZ25lZCBsb25nOiAodW5zaWduZWQgbG9uZykwLCBzaWduZWQg
bG9uZzogKHNpZ25lZCBsb25nKTAsIHVuc2lnbmVkIGxvbmcgbG9uZzogKHVuc2lnbmVkIGxv
bmcgbG9uZykwLCBzaWduZWQgbG9uZyBsb25nOiAoc2lnbmVkIGxvbmcgbG9uZykwLCBkZWZh
dWx0OiAoaGVhZF9fLT5uZXh0KSkpICopJihoZWFkX18tPm5leHQpKTsgZG8geyB9IHdoaWxl
ICgwKTsgKHR5cGVvZihoZWFkX18tPm5leHQpKV9feDsgfSk7IH0pOyBwb3NfXyAhPSBoZWFk
X18gPyAoeyB2b2lkICpfX21wdHIgPSAodm9pZCAqKShwb3NfXyk7IGRvIHsgZXh0ZXJuIHZv
aWQgX19jb21waWxldGltZV9hc3NlcnRfMTE3KHZvaWQpIF9fYXR0cmlidXRlX18oKF9fZXJy
b3JfXygicG9pbnRlciB0eXBlIG1pc21hdGNoIGluIGNvbnRhaW5lcl9vZigpIikpKTsgaWYg
KCEoISghX19idWlsdGluX3R5cGVzX2NvbXBhdGlibGVfcCh0eXBlb2YoKihwb3NfXykpLCB0
eXBlb2YoKChzdHJ1Y3QgcGFnZSAqKTApLT5scnUpKSAmJiAhX19idWlsdGluX3R5cGVzX2Nv
bXBhdGlibGVfcCh0eXBlb2YoKihwb3NfXykpLCB0eXBlb2Yodm9pZCkpKSkpIF9fY29tcGls
ZXRpbWVfYXNzZXJ0XzExNygpOyB9IHdoaWxlICgwKTsgKChzdHJ1Y3QgcGFnZSAqKShfX21w
dHIgLSBfX2J1aWx0aW5fb2Zmc2V0b2Yoc3RydWN0IHBhZ2UsIGxydSkpKTsgfSkgOiAoKHZv
aWQgKikwKTsgfSkKICAgICAgICAgICAgICAgICAgICAgIDsKfQoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wg
ZnJlZV9hcmVhX2VtcHR5KHN0cnVjdCBmcmVlX2FyZWEgKmFyZWEsIGludCBtaWdyYXRldHlw
ZSkKewogcmV0dXJuIGxpc3RfZW1wdHkoJmFyZWEtPmZyZWVfbGlzdFttaWdyYXRldHlwZV0p
Owp9CgpzdHJ1Y3QgcGdsaXN0X2RhdGE7CiMgMTI0ICIuL2luY2x1ZGUvbGludXgvbW16b25l
LmgiCnN0cnVjdCB6b25lX3BhZGRpbmcgewogY2hhciB4WzBdOwp9IF9fYXR0cmlidXRlX18o
KF9fYWxpZ25lZF9fKDEgPDwgKDYpKSkpOwojIDE0NiAiLi9pbmNsdWRlL2xpbnV4L21tem9u
ZS5oIgplbnVtIHpvbmVfc3RhdF9pdGVtIHsKCiBOUl9GUkVFX1BBR0VTLAogTlJfWk9ORV9M
UlVfQkFTRSwKIE5SX1pPTkVfSU5BQ1RJVkVfQU5PTiA9IE5SX1pPTkVfTFJVX0JBU0UsCiBO
Ul9aT05FX0FDVElWRV9BTk9OLAogTlJfWk9ORV9JTkFDVElWRV9GSUxFLAogTlJfWk9ORV9B
Q1RJVkVfRklMRSwKIE5SX1pPTkVfVU5FVklDVEFCTEUsCiBOUl9aT05FX1dSSVRFX1BFTkRJ
TkcsCiBOUl9NTE9DSywKIE5SX1BBR0VUQUJMRSwKIE5SX0tFUk5FTF9TVEFDS19LQiwKCgoK
CiBOUl9CT1VOQ0UsCgoKCiBOUl9GUkVFX0NNQV9QQUdFUywKIE5SX1ZNX1pPTkVfU1RBVF9J
VEVNUyB9OwoKZW51bSBub2RlX3N0YXRfaXRlbSB7CiBOUl9MUlVfQkFTRSwKIE5SX0lOQUNU
SVZFX0FOT04gPSBOUl9MUlVfQkFTRSwKIE5SX0FDVElWRV9BTk9OLAogTlJfSU5BQ1RJVkVf
RklMRSwKIE5SX0FDVElWRV9GSUxFLAogTlJfVU5FVklDVEFCTEUsCiBOUl9TTEFCX1JFQ0xB
SU1BQkxFLAogTlJfU0xBQl9VTlJFQ0xBSU1BQkxFLAogTlJfSVNPTEFURURfQU5PTiwKIE5S
X0lTT0xBVEVEX0ZJTEUsCiBXT1JLSU5HU0VUX05PREVTLAogV09SS0lOR1NFVF9SRUZBVUxU
LAogV09SS0lOR1NFVF9BQ1RJVkFURSwKIFdPUktJTkdTRVRfUkVTVE9SRSwKIFdPUktJTkdT
RVRfTk9ERVJFQ0xBSU0sCiBOUl9BTk9OX01BUFBFRCwKIE5SX0ZJTEVfTUFQUEVELAoKIE5S
X0ZJTEVfUEFHRVMsCiBOUl9GSUxFX0RJUlRZLAogTlJfV1JJVEVCQUNLLAogTlJfV1JJVEVC
QUNLX1RFTVAsCiBOUl9TSE1FTSwKIE5SX1NITUVNX1RIUFMsCiBOUl9TSE1FTV9QTURNQVBQ
RUQsCiBOUl9GSUxFX1RIUFMsCiBOUl9GSUxFX1BNRE1BUFBFRCwKIE5SX0FOT05fVEhQUywK
IE5SX1ZNU0NBTl9XUklURSwKIE5SX1ZNU0NBTl9JTU1FRElBVEUsCiBOUl9ESVJUSUVELAog
TlJfV1JJVFRFTiwKIE5SX0tFUk5FTF9NSVNDX1JFQ0xBSU1BQkxFLAogTlJfRk9MTF9QSU5f
QUNRVUlSRUQsCiBOUl9GT0xMX1BJTl9SRUxFQVNFRCwKIE5SX1ZNX05PREVfU1RBVF9JVEVN
Uwp9OwojIDIyMiAiLi9pbmNsdWRlL2xpbnV4L21tem9uZS5oIgplbnVtIGxydV9saXN0IHsK
IExSVV9JTkFDVElWRV9BTk9OID0gMCwKIExSVV9BQ1RJVkVfQU5PTiA9IDAgKyAxLAogTFJV
X0lOQUNUSVZFX0ZJTEUgPSAwICsgMiwKIExSVV9BQ1RJVkVfRklMRSA9IDAgKyAyICsgMSwK
IExSVV9VTkVWSUNUQUJMRSwKIE5SX0xSVV9MSVNUUwp9OwoKCgoKCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29s
IGlzX2ZpbGVfbHJ1KGVudW0gbHJ1X2xpc3QgbHJ1KQp7CiByZXR1cm4gKGxydSA9PSBMUlVf
SU5BQ1RJVkVfRklMRSB8fCBscnUgPT0gTFJVX0FDVElWRV9GSUxFKTsKfQoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IGJvb2wgaXNfYWN0aXZlX2xydShlbnVtIGxydV9saXN0IGxydSkKewogcmV0dXJuIChscnUg
PT0gTFJVX0FDVElWRV9BTk9OIHx8IGxydSA9PSBMUlVfQUNUSVZFX0ZJTEUpOwp9CgplbnVt
IGxydXZlY19mbGFncyB7CiBMUlVWRUNfQ09OR0VTVEVELAoKCn07CgpzdHJ1Y3QgbHJ1dmVj
IHsKIHN0cnVjdCBsaXN0X2hlYWQgbGlzdHNbTlJfTFJVX0xJU1RTXTsKCgoKCgogdW5zaWdu
ZWQgbG9uZyBhbm9uX2Nvc3Q7CiB1bnNpZ25lZCBsb25nIGZpbGVfY29zdDsKCiBhdG9taWNf
bG9uZ190IG5vbnJlc2lkZW50X2FnZTsKCiB1bnNpZ25lZCBsb25nIHJlZmF1bHRzOwoKIHVu
c2lnbmVkIGxvbmcgZmxhZ3M7CgoKCn07CiMgMjc5ICIuL2luY2x1ZGUvbGludXgvbW16b25l
LmgiCnR5cGVkZWYgdW5zaWduZWQgaXNvbGF0ZV9tb2RlX3Q7CgplbnVtIHpvbmVfd2F0ZXJt
YXJrcyB7CiBXTUFSS19NSU4sCiBXTUFSS19MT1csCiBXTUFSS19ISUdILAogTlJfV01BUksK
fTsKCgoKCgoKc3RydWN0IHBlcl9jcHVfcGFnZXMgewogaW50IGNvdW50OwogaW50IGhpZ2g7
CiBpbnQgYmF0Y2g7CgoKIHN0cnVjdCBsaXN0X2hlYWQgbGlzdHNbTUlHUkFURV9QQ1BUWVBF
U107Cn07CgpzdHJ1Y3QgcGVyX2NwdV9wYWdlc2V0IHsKIHN0cnVjdCBwZXJfY3B1X3BhZ2Vz
IHBjcDsKCgoKCgogczggc3RhdF90aHJlc2hvbGQ7CiBzOCB2bV9zdGF0X2RpZmZbTlJfVk1f
Wk9ORV9TVEFUX0lURU1TXTsKCn07CgpzdHJ1Y3QgcGVyX2NwdV9ub2Rlc3RhdCB7CiBzOCBz
dGF0X3RocmVzaG9sZDsKIHM4IHZtX25vZGVfc3RhdF9kaWZmW05SX1ZNX05PREVfU1RBVF9J
VEVNU107Cn07CgoKCmVudW0gem9uZV90eXBlIHsKIyAzNTMgIi4vaW5jbHVkZS9saW51eC9t
bXpvbmUuaCIKIFpPTkVfRE1BLAojIDM2MyAiLi9pbmNsdWRlL2xpbnV4L21tem9uZS5oIgog
Wk9ORV9OT1JNQUwsCiMgMzc1ICIuL2luY2x1ZGUvbGludXgvbW16b25lLmgiCiBaT05FX01P
VkFCTEUsCgoKCiBfX01BWF9OUl9aT05FUwoKfTsKCgoKc3RydWN0IHpvbmUgewoKCgogdW5z
aWduZWQgbG9uZyBfd2F0ZXJtYXJrW05SX1dNQVJLXTsKIHVuc2lnbmVkIGxvbmcgd2F0ZXJt
YXJrX2Jvb3N0OwoKIHVuc2lnbmVkIGxvbmcgbnJfcmVzZXJ2ZWRfaGlnaGF0b21pYzsKIyA0
MDMgIi4vaW5jbHVkZS9saW51eC9tbXpvbmUuaCIKIGxvbmcgbG93bWVtX3Jlc2VydmVbM107
CgoKCgogc3RydWN0IHBnbGlzdF9kYXRhICp6b25lX3BnZGF0Owogc3RydWN0IHBlcl9jcHVf
cGFnZXNldCAqcGFnZXNldDsKCgoKCgoKIHVuc2lnbmVkIGxvbmcgKnBhZ2VibG9ja19mbGFn
czsKCgoKIHVuc2lnbmVkIGxvbmcgem9uZV9zdGFydF9wZm47CiMgNDU3ICIuL2luY2x1ZGUv
bGludXgvbW16b25lLmgiCiBhdG9taWNfbG9uZ190IG1hbmFnZWRfcGFnZXM7CiB1bnNpZ25l
ZCBsb25nIHNwYW5uZWRfcGFnZXM7CiB1bnNpZ25lZCBsb25nIHByZXNlbnRfcGFnZXM7Cgog
Y29uc3QgY2hhciAqbmFtZTsKIyA0NzcgIi4vaW5jbHVkZS9saW51eC9tbXpvbmUuaCIKIGlu
dCBpbml0aWFsaXplZDsKCgogc3RydWN0IHpvbmVfcGFkZGluZyBfcGFkMV87CgoKIHN0cnVj
dCBmcmVlX2FyZWEgZnJlZV9hcmVhWzEzXTsKCgogdW5zaWduZWQgbG9uZyBmbGFnczsKCgog
c3BpbmxvY2tfdCBsb2NrOwoKCiBzdHJ1Y3Qgem9uZV9wYWRkaW5nIF9wYWQyXzsKCgoKCgoK
IHVuc2lnbmVkIGxvbmcgcGVyY3B1X2RyaWZ0X21hcms7CgoKCiB1bnNpZ25lZCBsb25nIGNv
bXBhY3RfY2FjaGVkX2ZyZWVfcGZuOwoKIHVuc2lnbmVkIGxvbmcgY29tcGFjdF9jYWNoZWRf
bWlncmF0ZV9wZm5bMl07CiB1bnNpZ25lZCBsb25nIGNvbXBhY3RfaW5pdF9taWdyYXRlX3Bm
bjsKIHVuc2lnbmVkIGxvbmcgY29tcGFjdF9pbml0X2ZyZWVfcGZuOwojIDUxNiAiLi9pbmNs
dWRlL2xpbnV4L21tem9uZS5oIgogdW5zaWduZWQgaW50IGNvbXBhY3RfY29uc2lkZXJlZDsK
IHVuc2lnbmVkIGludCBjb21wYWN0X2RlZmVyX3NoaWZ0OwogaW50IGNvbXBhY3Rfb3JkZXJf
ZmFpbGVkOwoKCgoKIGJvb2wgY29tcGFjdF9ibG9ja3NraXBfZmx1c2g7CgoKIGJvb2wgY29u
dGlndW91czsKCiBzdHJ1Y3Qgem9uZV9wYWRkaW5nIF9wYWQzXzsKCiBhdG9taWNfbG9uZ190
IHZtX3N0YXRbTlJfVk1fWk9ORV9TVEFUX0lURU1TXTsKIGF0b21pY19sb25nX3Qgdm1fbnVt
YV9zdGF0WzBdOwp9IF9fYXR0cmlidXRlX18oKF9fYWxpZ25lZF9fKDEgPDwgKDYpKSkpOwoK
ZW51bSBwZ2RhdF9mbGFncyB7CiBQR0RBVF9ESVJUWSwKCgoKIFBHREFUX1dSSVRFQkFDSywK
CgogUEdEQVRfUkVDTEFJTV9MT0NLRUQsCn07CgplbnVtIHpvbmVfZmxhZ3MgewogWk9ORV9C
T09TVEVEX1dBVEVSTUFSSywKCgp9OwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHVuc2lnbmVkIGxvbmcgem9uZV9t
YW5hZ2VkX3BhZ2VzKHN0cnVjdCB6b25lICp6b25lKQp7CiByZXR1cm4gKHVuc2lnbmVkIGxv
bmcpYXRvbWljX2xvbmdfcmVhZCgmem9uZS0+bWFuYWdlZF9wYWdlcyk7Cn0KCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSB1bnNpZ25lZCBsb25nIHpvbmVfZW5kX3Bmbihjb25zdCBzdHJ1Y3Qgem9uZSAqem9uZSkK
ewogcmV0dXJuIHpvbmUtPnpvbmVfc3RhcnRfcGZuICsgem9uZS0+c3Bhbm5lZF9wYWdlczsK
fQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIGJvb2wgem9uZV9zcGFuc19wZm4oY29uc3Qgc3RydWN0IHpvbmUgKnpv
bmUsIHVuc2lnbmVkIGxvbmcgcGZuKQp7CiByZXR1cm4gem9uZS0+em9uZV9zdGFydF9wZm4g
PD0gcGZuICYmIHBmbiA8IHpvbmVfZW5kX3Bmbih6b25lKTsKfQoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wg
em9uZV9pc19pbml0aWFsaXplZChzdHJ1Y3Qgem9uZSAqem9uZSkKewogcmV0dXJuIHpvbmUt
PmluaXRpYWxpemVkOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCB6b25lX2lzX2VtcHR5KHN0cnVjdCB6
b25lICp6b25lKQp7CiByZXR1cm4gem9uZS0+c3Bhbm5lZF9wYWdlcyA9PSAwOwp9CgoKCgoK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIGJvb2wgem9uZV9pbnRlcnNlY3RzKHN0cnVjdCB6b25lICp6b25lLAogIHVu
c2lnbmVkIGxvbmcgc3RhcnRfcGZuLCB1bnNpZ25lZCBsb25nIG5yX3BhZ2VzKQp7CiBpZiAo
em9uZV9pc19lbXB0eSh6b25lKSkKICByZXR1cm4gZmFsc2U7CiBpZiAoc3RhcnRfcGZuID49
IHpvbmVfZW5kX3Bmbih6b25lKSB8fAogICAgIHN0YXJ0X3BmbiArIG5yX3BhZ2VzIDw9IHpv
bmUtPnpvbmVfc3RhcnRfcGZuKQogIHJldHVybiBmYWxzZTsKCiByZXR1cm4gdHJ1ZTsKfQoj
IDYwMiAiLi9pbmNsdWRlL2xpbnV4L21tem9uZS5oIgplbnVtIHsKIFpPTkVMSVNUX0ZBTExC
QUNLLAoKCgoKCgoKIE1BWF9aT05FTElTVFMKfTsKCgoKCgpzdHJ1Y3Qgem9uZXJlZiB7CiBz
dHJ1Y3Qgem9uZSAqem9uZTsKIGludCB6b25lX2lkeDsKfTsKIyA2MzcgIi4vaW5jbHVkZS9s
aW51eC9tbXpvbmUuaCIKc3RydWN0IHpvbmVsaXN0IHsKIHN0cnVjdCB6b25lcmVmIF96b25l
cmVmc1soKDEgPDwgMCkgKiAzKSArIDFdOwp9OwoKCgpleHRlcm4gc3RydWN0IHBhZ2UgKm1l
bV9tYXA7CiMgNjYyICIuL2luY2x1ZGUvbGludXgvbW16b25lLmgiCnR5cGVkZWYgc3RydWN0
IHBnbGlzdF9kYXRhIHsKCgoKCgogc3RydWN0IHpvbmUgbm9kZV96b25lc1szXTsKCgoKCgoK
IHN0cnVjdCB6b25lbGlzdCBub2RlX3pvbmVsaXN0c1tNQVhfWk9ORUxJU1RTXTsKCiBpbnQg
bnJfem9uZXM7Cgogc3RydWN0IHBhZ2UgKm5vZGVfbWVtX21hcDsKIyA2OTkgIi4vaW5jbHVk
ZS9saW51eC9tbXpvbmUuaCIKIHVuc2lnbmVkIGxvbmcgbm9kZV9zdGFydF9wZm47CiB1bnNp
Z25lZCBsb25nIG5vZGVfcHJlc2VudF9wYWdlczsKIHVuc2lnbmVkIGxvbmcgbm9kZV9zcGFu
bmVkX3BhZ2VzOwoKIGludCBub2RlX2lkOwogd2FpdF9xdWV1ZV9oZWFkX3Qga3N3YXBkX3dh
aXQ7CiB3YWl0X3F1ZXVlX2hlYWRfdCBwZm1lbWFsbG9jX3dhaXQ7CiBzdHJ1Y3QgdGFza19z
dHJ1Y3QgKmtzd2FwZDsKCiBpbnQga3N3YXBkX29yZGVyOwogZW51bSB6b25lX3R5cGUga3N3
YXBkX2hpZ2hlc3Rfem9uZWlkeDsKCiBpbnQga3N3YXBkX2ZhaWx1cmVzOwoKCiBpbnQga2Nv
bXBhY3RkX21heF9vcmRlcjsKIGVudW0gem9uZV90eXBlIGtjb21wYWN0ZF9oaWdoZXN0X3pv
bmVpZHg7CiB3YWl0X3F1ZXVlX2hlYWRfdCBrY29tcGFjdGRfd2FpdDsKIHN0cnVjdCB0YXNr
X3N0cnVjdCAqa2NvbXBhY3RkOwoKCgoKCiB1bnNpZ25lZCBsb25nIHRvdGFscmVzZXJ2ZV9w
YWdlczsKIyA3MzQgIi4vaW5jbHVkZS9saW51eC9tbXpvbmUuaCIKIHN0cnVjdCB6b25lX3Bh
ZGRpbmcgX3BhZDFfOwogc3BpbmxvY2tfdCBscnVfbG9jazsKIyA3NTYgIi4vaW5jbHVkZS9s
aW51eC9tbXpvbmUuaCIKIHN0cnVjdCBscnV2ZWMgX19scnV2ZWM7CgogdW5zaWduZWQgbG9u
ZyBmbGFnczsKCiBzdHJ1Y3Qgem9uZV9wYWRkaW5nIF9wYWQyXzsKCgogc3RydWN0IHBlcl9j
cHVfbm9kZXN0YXQgKnBlcl9jcHVfbm9kZXN0YXRzOwogYXRvbWljX2xvbmdfdCB2bV9zdGF0
W05SX1ZNX05PREVfU1RBVF9JVEVNU107Cn0gcGdfZGF0YV90OwojIDc3OSAiLi9pbmNsdWRl
L2xpbnV4L21tem9uZS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgbG9uZyBwZ2RhdF9lbmRfcGZu
KHBnX2RhdGFfdCAqcGdkYXQpCnsKIHJldHVybiBwZ2RhdC0+bm9kZV9zdGFydF9wZm4gKyBw
Z2RhdC0+bm9kZV9zcGFubmVkX3BhZ2VzOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBwZ2RhdF9pc19l
bXB0eShwZ19kYXRhX3QgKnBnZGF0KQp7CiByZXR1cm4gIXBnZGF0LT5ub2RlX3N0YXJ0X3Bm
biAmJiAhcGdkYXQtPm5vZGVfc3Bhbm5lZF9wYWdlczsKfQoKIyAxICIuL2luY2x1ZGUvbGlu
dXgvbWVtb3J5X2hvdHBsdWcuaCIgMQoKCgoKIyAxICIuL2luY2x1ZGUvbGludXgvbW16b25l
LmgiIDEKIyA2ICIuL2luY2x1ZGUvbGludXgvbWVtb3J5X2hvdHBsdWcuaCIgMgoKCgoKc3Ry
dWN0IHBhZ2U7CnN0cnVjdCB6b25lOwpzdHJ1Y3QgcGdsaXN0X2RhdGE7CnN0cnVjdCBtZW1f
c2VjdGlvbjsKc3RydWN0IG1lbW9yeV9ibG9jazsKc3RydWN0IHJlc291cmNlOwpzdHJ1Y3Qg
dm1lbV9hbHRtYXA7CiMgMjQ3ICIuL2luY2x1ZGUvbGludXgvbWVtb3J5X2hvdHBsdWcuaCIK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIHVuc2lnbmVkIHpvbmVfc3Bhbl9zZXFiZWdpbihzdHJ1Y3Qgem9uZSAqem9u
ZSkKewogcmV0dXJuIDA7Cn0Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCB6b25lX3NwYW5fc2VxcmV0cnkoc3Ry
dWN0IHpvbmUgKnpvbmUsIHVuc2lnbmVkIGl2KQp7CiByZXR1cm4gMDsKfQpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
dm9pZCB6b25lX3NwYW5fd3JpdGVsb2NrKHN0cnVjdCB6b25lICp6b25lKSB7fQpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgdm9pZCB6b25lX3NwYW5fd3JpdGV1bmxvY2soc3RydWN0IHpvbmUgKnpvbmUpIHt9CnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSB2b2lkIHpvbmVfc2VxbG9ja19pbml0KHN0cnVjdCB6b25lICp6b25lKSB7fQoK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIGludCBtaHBfbm90aW1wbGVtZW50ZWQoY29uc3QgY2hhciAqZnVuYykKewog
cHJpbnRrKCJcMDAxIiAiNCIgIiVzKCkgY2FsbGVkLCB3aXRoIENPTkZJR19NRU1PUllfSE9U
UExVRyBkaXNhYmxlZFxuIiwgZnVuYyk7CiBkdW1wX3N0YWNrKCk7CiByZXR1cm4gLTM4Owp9
CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgdm9pZCByZWdpc3Rlcl9wYWdlX2Jvb3RtZW1faW5mb19ub2RlKHN0cnVj
dCBwZ2xpc3RfZGF0YSAqcGdkYXQpCnsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCB0cnlfb25saW5lX25v
ZGUoaW50IG5pZCkKewogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGdldF9vbmxpbmVf
bWVtcyh2b2lkKSB7fQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBwdXRfb25saW5lX21lbXModm9pZCkge30K
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSB2b2lkIG1lbV9ob3RwbHVnX2JlZ2luKHZvaWQpIHt9CnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2
b2lkIG1lbV9ob3RwbHVnX2RvbmUodm9pZCkge30KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIG1vdmFibGVf
bm9kZV9pc19lbmFibGVkKHZvaWQpCnsKIHJldHVybiBmYWxzZTsKfQojIDMxMCAiLi9pbmNs
dWRlL2xpbnV4L21lbW9yeV9ob3RwbHVnLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHBnZGF0X3Jlc2l6
ZV9sb2NrKHN0cnVjdCBwZ2xpc3RfZGF0YSAqcCwgdW5zaWduZWQgbG9uZyAqZikge30Kc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIHZvaWQgcGdkYXRfcmVzaXplX3VubG9jayhzdHJ1Y3QgcGdsaXN0X2RhdGEgKnAs
IHVuc2lnbmVkIGxvbmcgKmYpIHt9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHBnZGF0X3Jlc2l6ZV9pbml0
KHN0cnVjdCBwZ2xpc3RfZGF0YSAqcGdkYXQpIHt9CiMgMzI0ICIuL2luY2x1ZGUvbGludXgv
bWVtb3J5X2hvdHBsdWcuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgdHJ5X29mZmxpbmVfbm9kZShpbnQg
bmlkKSB7fQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIGludCBvZmZsaW5lX3BhZ2VzKHVuc2lnbmVkIGxvbmcgc3Rh
cnRfcGZuLCB1bnNpZ25lZCBsb25nIG5yX3BhZ2VzKQp7CiByZXR1cm4gLTIyOwp9CgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgaW50IHJlbW92ZV9tZW1vcnkoaW50IG5pZCwgdTY0IHN0YXJ0LCB1NjQgc2l6ZSkK
ewogcmV0dXJuIC0xNjsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgX19yZW1vdmVfbWVtb3J5KGludCBu
aWQsIHU2NCBzdGFydCwgdTY0IHNpemUpIHt9CgoKZXh0ZXJuIHZvaWQgc2V0X3pvbmVfY29u
dGlndW91cyhzdHJ1Y3Qgem9uZSAqem9uZSk7CmV4dGVybiB2b2lkIGNsZWFyX3pvbmVfY29u
dGlndW91cyhzdHJ1Y3Qgem9uZSAqem9uZSk7CgpleHRlcm4gdm9pZCBfX2F0dHJpYnV0ZV9f
KChfX3NlY3Rpb25fXygiLnJlZi50ZXh0IikpKSBfX2F0dHJpYnV0ZV9fKChfX25vaW5saW5l
X18pKSBmcmVlX2FyZWFfaW5pdF9jb3JlX2hvdHBsdWcoaW50IG5pZCk7CmV4dGVybiBpbnQg
X19hZGRfbWVtb3J5KGludCBuaWQsIHU2NCBzdGFydCwgdTY0IHNpemUpOwpleHRlcm4gaW50
IGFkZF9tZW1vcnkoaW50IG5pZCwgdTY0IHN0YXJ0LCB1NjQgc2l6ZSk7CmV4dGVybiBpbnQg
YWRkX21lbW9yeV9yZXNvdXJjZShpbnQgbmlkLCBzdHJ1Y3QgcmVzb3VyY2UgKnJlc291cmNl
KTsKZXh0ZXJuIGludCBhZGRfbWVtb3J5X2RyaXZlcl9tYW5hZ2VkKGludCBuaWQsIHU2NCBz
dGFydCwgdTY0IHNpemUsCiAgICAgICAgIGNvbnN0IGNoYXIgKnJlc291cmNlX25hbWUpOwpl
eHRlcm4gdm9pZCBtb3ZlX3Bmbl9yYW5nZV90b196b25lKHN0cnVjdCB6b25lICp6b25lLCB1
bnNpZ25lZCBsb25nIHN0YXJ0X3BmbiwKICB1bnNpZ25lZCBsb25nIG5yX3BhZ2VzLCBzdHJ1
Y3Qgdm1lbV9hbHRtYXAgKmFsdG1hcCk7CmV4dGVybiB2b2lkIHJlbW92ZV9wZm5fcmFuZ2Vf
ZnJvbV96b25lKHN0cnVjdCB6b25lICp6b25lLAogICAgICAgICAgIHVuc2lnbmVkIGxvbmcg
c3RhcnRfcGZuLAogICAgICAgICAgIHVuc2lnbmVkIGxvbmcgbnJfcGFnZXMpOwpleHRlcm4g
Ym9vbCBpc19tZW1ibG9ja19vZmZsaW5lZChzdHJ1Y3QgbWVtb3J5X2Jsb2NrICptZW0pOwpl
eHRlcm4gaW50IHNwYXJzZV9hZGRfc2VjdGlvbihpbnQgbmlkLCB1bnNpZ25lZCBsb25nIHBm
biwKICB1bnNpZ25lZCBsb25nIG5yX3BhZ2VzLCBzdHJ1Y3Qgdm1lbV9hbHRtYXAgKmFsdG1h
cCk7CmV4dGVybiB2b2lkIHNwYXJzZV9yZW1vdmVfc2VjdGlvbihzdHJ1Y3QgbWVtX3NlY3Rp
b24gKm1zLAogIHVuc2lnbmVkIGxvbmcgcGZuLCB1bnNpZ25lZCBsb25nIG5yX3BhZ2VzLAog
IHVuc2lnbmVkIGxvbmcgbWFwX29mZnNldCwgc3RydWN0IHZtZW1fYWx0bWFwICphbHRtYXAp
OwpleHRlcm4gc3RydWN0IHBhZ2UgKnNwYXJzZV9kZWNvZGVfbWVtX21hcCh1bnNpZ25lZCBs
b25nIGNvZGVkX21lbV9tYXAsCiAgICAgICB1bnNpZ25lZCBsb25nIHBudW0pOwpleHRlcm4g
Ym9vbCBhbGxvd19vbmxpbmVfcGZuX3JhbmdlKGludCBuaWQsIHVuc2lnbmVkIGxvbmcgcGZu
LCB1bnNpZ25lZCBsb25nIG5yX3BhZ2VzLAogIGludCBvbmxpbmVfdHlwZSk7CmV4dGVybiBz
dHJ1Y3Qgem9uZSAqem9uZV9mb3JfcGZuX3JhbmdlKGludCBvbmxpbmVfdHlwZSwgaW50IG5p
ZCwgdW5zaWduZWQgc3RhcnRfcGZuLAogIHVuc2lnbmVkIGxvbmcgbnJfcGFnZXMpOwojIDc5
MCAiLi9pbmNsdWRlL2xpbnV4L21tem9uZS5oIiAyCgp2b2lkIGJ1aWxkX2FsbF96b25lbGlz
dHMocGdfZGF0YV90ICpwZ2RhdCk7CnZvaWQgd2FrZXVwX2tzd2FwZChzdHJ1Y3Qgem9uZSAq
em9uZSwgZ2ZwX3QgZ2ZwX21hc2ssIGludCBvcmRlciwKICAgICBlbnVtIHpvbmVfdHlwZSBo
aWdoZXN0X3pvbmVpZHgpOwpib29sIF9fem9uZV93YXRlcm1hcmtfb2soc3RydWN0IHpvbmUg
KnosIHVuc2lnbmVkIGludCBvcmRlciwgdW5zaWduZWQgbG9uZyBtYXJrLAogICAgaW50IGhp
Z2hlc3Rfem9uZWlkeCwgdW5zaWduZWQgaW50IGFsbG9jX2ZsYWdzLAogICAgbG9uZyBmcmVl
X3BhZ2VzKTsKYm9vbCB6b25lX3dhdGVybWFya19vayhzdHJ1Y3Qgem9uZSAqeiwgdW5zaWdu
ZWQgaW50IG9yZGVyLAogIHVuc2lnbmVkIGxvbmcgbWFyaywgaW50IGhpZ2hlc3Rfem9uZWlk
eCwKICB1bnNpZ25lZCBpbnQgYWxsb2NfZmxhZ3MpOwpib29sIHpvbmVfd2F0ZXJtYXJrX29r
X3NhZmUoc3RydWN0IHpvbmUgKnosIHVuc2lnbmVkIGludCBvcmRlciwKICB1bnNpZ25lZCBs
b25nIG1hcmssIGludCBoaWdoZXN0X3pvbmVpZHgpOwplbnVtIG1lbW1hcF9jb250ZXh0IHsK
IE1FTU1BUF9FQVJMWSwKIE1FTU1BUF9IT1RQTFVHLAp9OwpleHRlcm4gdm9pZCBpbml0X2N1
cnJlbnRseV9lbXB0eV96b25lKHN0cnVjdCB6b25lICp6b25lLCB1bnNpZ25lZCBsb25nIHN0
YXJ0X3BmbiwKICAgICAgICAgdW5zaWduZWQgbG9uZyBzaXplKTsKCmV4dGVybiB2b2lkIGxy
dXZlY19pbml0KHN0cnVjdCBscnV2ZWMgKmxydXZlYyk7CgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IHBn
bGlzdF9kYXRhICpscnV2ZWNfcGdkYXQoc3RydWN0IGxydXZlYyAqbHJ1dmVjKQp7CgoKCiBy
ZXR1cm4gKHsgdm9pZCAqX19tcHRyID0gKHZvaWQgKikobHJ1dmVjKTsgZG8geyBleHRlcm4g
dm9pZCBfX2NvbXBpbGV0aW1lX2Fzc2VydF8xMTgodm9pZCkgX19hdHRyaWJ1dGVfXygoX19l
cnJvcl9fKCJwb2ludGVyIHR5cGUgbWlzbWF0Y2ggaW4gY29udGFpbmVyX29mKCkiKSkpOyBp
ZiAoISghKCFfX2J1aWx0aW5fdHlwZXNfY29tcGF0aWJsZV9wKHR5cGVvZigqKGxydXZlYykp
LCB0eXBlb2YoKChzdHJ1Y3QgcGdsaXN0X2RhdGEgKikwKS0+X19scnV2ZWMpKSAmJiAhX19i
dWlsdGluX3R5cGVzX2NvbXBhdGlibGVfcCh0eXBlb2YoKihscnV2ZWMpKSwgdHlwZW9mKHZv
aWQpKSkpKSBfX2NvbXBpbGV0aW1lX2Fzc2VydF8xMTgoKTsgfSB3aGlsZSAoMCk7ICgoc3Ry
dWN0IHBnbGlzdF9kYXRhICopKF9fbXB0ciAtIF9fYnVpbHRpbl9vZmZzZXRvZihzdHJ1Y3Qg
cGdsaXN0X2RhdGEsIF9fbHJ1dmVjKSkpOyB9KTsKCn0KCmV4dGVybiB1bnNpZ25lZCBsb25n
IGxydXZlY19scnVfc2l6ZShzdHJ1Y3QgbHJ1dmVjICpscnV2ZWMsIGVudW0gbHJ1X2xpc3Qg
bHJ1LCBpbnQgem9uZV9pZHgpOwoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgbWVtb3J5X3ByZXNlbnQo
aW50IG5pZCwgdW5zaWduZWQgbG9uZyBzdGFydCwgdW5zaWduZWQgbG9uZyBlbmQpIHt9CgoK
CgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIHZvaWQgbWVtYmxvY2tzX3ByZXNlbnQodm9pZCkge30KCgoKCgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgaW50IGxvY2FsX21lbW9yeV9ub2RlKGludCBub2RlX2lkKSB7IHJldHVybiBub2Rl
X2lkOyB9OwojIDg1MSAiLi9pbmNsdWRlL2xpbnV4L21tem9uZS5oIgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9v
bCBtYW5hZ2VkX3pvbmUoc3RydWN0IHpvbmUgKnpvbmUpCnsKIHJldHVybiB6b25lX21hbmFn
ZWRfcGFnZXMoem9uZSk7Cn0KCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBwb3B1bGF0ZWRfem9uZShzdHJ1
Y3Qgem9uZSAqem9uZSkKewogcmV0dXJuIHpvbmUtPnByZXNlbnRfcGFnZXM7Cn0KIyA4NzMg
Ii4vaW5jbHVkZS9saW51eC9tbXpvbmUuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCB6b25lX3RvX25pZChz
dHJ1Y3Qgem9uZSAqem9uZSkKewogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHpvbmVf
c2V0X25pZChzdHJ1Y3Qgem9uZSAqem9uZSwgaW50IG5pZCkge30KCgpleHRlcm4gaW50IG1v
dmFibGVfem9uZTsKIyA4OTQgIi4vaW5jbHVkZS9saW51eC9tbXpvbmUuaCIKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IGludCBpc19oaWdobWVtX2lkeChlbnVtIHpvbmVfdHlwZSBpZHgpCnsKCgoKCiByZXR1cm4g
MDsKCn0KCgoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgaXNfaGlnaG1lbShzdHJ1Y3Qgem9uZSAqem9u
ZSkKewoKCgogcmV0dXJuIDA7Cgp9CgoKc3RydWN0IGN0bF90YWJsZTsKCmludCBtaW5fZnJl
ZV9rYnl0ZXNfc3lzY3RsX2hhbmRsZXIoc3RydWN0IGN0bF90YWJsZSAqLCBpbnQsIHZvaWQg
Kiwgc2l6ZV90ICosCiAgbG9mZl90ICopOwppbnQgd2F0ZXJtYXJrX3NjYWxlX2ZhY3Rvcl9z
eXNjdGxfaGFuZGxlcihzdHJ1Y3QgY3RsX3RhYmxlICosIGludCwgdm9pZCAqLAogIHNpemVf
dCAqLCBsb2ZmX3QgKik7CmV4dGVybiBpbnQgc3lzY3RsX2xvd21lbV9yZXNlcnZlX3JhdGlv
WzNdOwppbnQgbG93bWVtX3Jlc2VydmVfcmF0aW9fc3lzY3RsX2hhbmRsZXIoc3RydWN0IGN0
bF90YWJsZSAqLCBpbnQsIHZvaWQgKiwKICBzaXplX3QgKiwgbG9mZl90ICopOwppbnQgcGVy
Y3B1X3BhZ2VsaXN0X2ZyYWN0aW9uX3N5c2N0bF9oYW5kbGVyKHN0cnVjdCBjdGxfdGFibGUg
KiwgaW50LAogIHZvaWQgKiwgc2l6ZV90ICosIGxvZmZfdCAqKTsKaW50IHN5c2N0bF9taW5f
dW5tYXBwZWRfcmF0aW9fc3lzY3RsX2hhbmRsZXIoc3RydWN0IGN0bF90YWJsZSAqLCBpbnQs
CiAgdm9pZCAqLCBzaXplX3QgKiwgbG9mZl90ICopOwppbnQgc3lzY3RsX21pbl9zbGFiX3Jh
dGlvX3N5c2N0bF9oYW5kbGVyKHN0cnVjdCBjdGxfdGFibGUgKiwgaW50LAogIHZvaWQgKiwg
c2l6ZV90ICosIGxvZmZfdCAqKTsKaW50IG51bWFfem9uZWxpc3Rfb3JkZXJfaGFuZGxlcihz
dHJ1Y3QgY3RsX3RhYmxlICosIGludCwKICB2b2lkICosIHNpemVfdCAqLCBsb2ZmX3QgKik7
CmV4dGVybiBpbnQgcGVyY3B1X3BhZ2VsaXN0X2ZyYWN0aW9uOwpleHRlcm4gY2hhciBudW1h
X3pvbmVsaXN0X29yZGVyW107CgoKCgpleHRlcm4gc3RydWN0IHBnbGlzdF9kYXRhIGNvbnRp
Z19wYWdlX2RhdGE7CiMgOTUzICIuL2luY2x1ZGUvbGludXgvbW16b25lLmgiCmV4dGVybiBz
dHJ1Y3QgcGdsaXN0X2RhdGEgKmZpcnN0X29ubGluZV9wZ2RhdCh2b2lkKTsKZXh0ZXJuIHN0
cnVjdCBwZ2xpc3RfZGF0YSAqbmV4dF9vbmxpbmVfcGdkYXQoc3RydWN0IHBnbGlzdF9kYXRh
ICpwZ2RhdCk7CmV4dGVybiBzdHJ1Y3Qgem9uZSAqbmV4dF96b25lKHN0cnVjdCB6b25lICp6
b25lKTsKIyA5ODUgIi4vaW5jbHVkZS9saW51eC9tbXpvbmUuaCIKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHN0cnVj
dCB6b25lICp6b25lbGlzdF96b25lKHN0cnVjdCB6b25lcmVmICp6b25lcmVmKQp7CiByZXR1
cm4gem9uZXJlZi0+em9uZTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCB6b25lbGlzdF96b25lX2lkeChz
dHJ1Y3Qgem9uZXJlZiAqem9uZXJlZikKewogcmV0dXJuIHpvbmVyZWYtPnpvbmVfaWR4Owp9
CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgaW50IHpvbmVsaXN0X25vZGVfaWR4KHN0cnVjdCB6b25lcmVmICp6b25l
cmVmKQp7CiByZXR1cm4gem9uZV90b19uaWQoem9uZXJlZi0+em9uZSk7Cn0KCnN0cnVjdCB6
b25lcmVmICpfX25leHRfem9uZXNfem9uZWxpc3Qoc3RydWN0IHpvbmVyZWYgKnosCiAgICAg
ZW51bSB6b25lX3R5cGUgaGlnaGVzdF96b25laWR4LAogICAgIG5vZGVtYXNrX3QgKm5vZGVz
KTsKIyAxMDE2ICIuL2luY2x1ZGUvbGludXgvbW16b25lLmgiCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJp
YnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHN0cnVjdCB6b25lcmVmICpuZXh0X3pvbmVz
X3pvbmVsaXN0KHN0cnVjdCB6b25lcmVmICp6LAogICAgIGVudW0gem9uZV90eXBlIGhpZ2hl
c3Rfem9uZWlkeCwKICAgICBub2RlbWFza190ICpub2RlcykKewogaWYgKF9fYnVpbHRpbl9l
eHBlY3QoISEoIW5vZGVzICYmIHpvbmVsaXN0X3pvbmVfaWR4KHopIDw9IGhpZ2hlc3Rfem9u
ZWlkeCksIDEpKQogIHJldHVybiB6OwogcmV0dXJuIF9fbmV4dF96b25lc196b25lbGlzdCh6
LCBoaWdoZXN0X3pvbmVpZHgsIG5vZGVzKTsKfQojIDEwNDEgIi4vaW5jbHVkZS9saW51eC9t
bXpvbmUuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHN0cnVjdCB6b25lcmVmICpmaXJzdF96b25lc196b25lbGlz
dChzdHJ1Y3Qgem9uZWxpc3QgKnpvbmVsaXN0LAogICAgIGVudW0gem9uZV90eXBlIGhpZ2hl
c3Rfem9uZWlkeCwKICAgICBub2RlbWFza190ICpub2RlcykKewogcmV0dXJuIG5leHRfem9u
ZXNfem9uZWxpc3Qoem9uZWxpc3QtPl96b25lcmVmcywKICAgICAgIGhpZ2hlc3Rfem9uZWlk
eCwgbm9kZXMpOwp9CiMgMTM4MCAiLi9pbmNsdWRlL2xpbnV4L21tem9uZS5oIgpzdHJ1Y3Qg
bW1pbml0X3Bmbm5pZF9jYWNoZSB7CiB1bnNpZ25lZCBsb25nIGxhc3Rfc3RhcnQ7CiB1bnNp
Z25lZCBsb25nIGxhc3RfZW5kOwogaW50IGxhc3RfbmlkOwp9OwoKCgoKCnZvaWQgbWVtb3J5
X3ByZXNlbnQoaW50IG5pZCwgdW5zaWduZWQgbG9uZyBzdGFydCwgdW5zaWduZWQgbG9uZyBl
bmQpOwojIDE0MjggIi4vaW5jbHVkZS9saW51eC9tbXpvbmUuaCIKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wg
bWVtbWFwX3ZhbGlkX3dpdGhpbih1bnNpZ25lZCBsb25nIHBmbiwKICAgICBzdHJ1Y3QgcGFn
ZSAqcGFnZSwgc3RydWN0IHpvbmUgKnpvbmUpCnsKIHJldHVybiB0cnVlOwp9CiMgNyAiLi9p
bmNsdWRlL2xpbnV4L2dmcC5oIiAyCgoKIyAxICIuL2luY2x1ZGUvbGludXgvdG9wb2xvZ3ku
aCIgMQojIDMwICIuL2luY2x1ZGUvbGludXgvdG9wb2xvZ3kuaCIKIyAxICIuL2luY2x1ZGUv
bGludXgvYXJjaF90b3BvbG9neS5oIiAxCiMgMTEgIi4vaW5jbHVkZS9saW51eC9hcmNoX3Rv
cG9sb2d5LmgiCnZvaWQgdG9wb2xvZ3lfbm9ybWFsaXplX2NwdV9zY2FsZSh2b2lkKTsKaW50
IHRvcG9sb2d5X3VwZGF0ZV9jcHVfdG9wb2xvZ3kodm9pZCk7CgpzdHJ1Y3QgZGV2aWNlX25v
ZGU7CmJvb2wgdG9wb2xvZ3lfcGFyc2VfY3B1X2NhcGFjaXR5KHN0cnVjdCBkZXZpY2Vfbm9k
ZSAqY3B1X25vZGUsIGludCBjcHUpOwoKZXh0ZXJuIF9fYXR0cmlidXRlX18oKHNlY3Rpb24o
Ii5kYXRhLi5wZXJjcHUiICIiKSkpIF9fdHlwZW9mX18odW5zaWduZWQgbG9uZykgY3B1X3Nj
YWxlOwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIHVuc2lnbmVkIGxvbmcgdG9wb2xvZ3lfZ2V0X2NwdV9zY2FsZShp
bnQgY3B1KQp7CiByZXR1cm4gKCooeyBkbyB7IGNvbnN0IHZvaWQgKl9fdnBwX3ZlcmlmeSA9
ICh0eXBlb2YoKCYoY3B1X3NjYWxlKSkgKyAwKSkoKHZvaWQgKikwKTsgKHZvaWQpX192cHBf
dmVyaWZ5OyB9IHdoaWxlICgwKTsgKHsgdW5zaWduZWQgbG9uZyBfX3B0cjsgX19hc21fXyAo
IiIgOiAiPXIiKF9fcHRyKSA6ICIwIigodHlwZW9mKCooKCYoY3B1X3NjYWxlKSkpKSAqKSgo
JihjcHVfc2NhbGUpKSkpKTsgKHR5cGVvZigodHlwZW9mKCooKCYoY3B1X3NjYWxlKSkpKSAq
KSgoJihjcHVfc2NhbGUpKSkpKSAoX19wdHIgKyAoKChfX3Blcl9jcHVfb2Zmc2V0WyhjcHUp
XSkpKSk7IH0pOyB9KSk7Cn0KCnZvaWQgdG9wb2xvZ3lfc2V0X2NwdV9zY2FsZSh1bnNpZ25l
ZCBpbnQgY3B1LCB1bnNpZ25lZCBsb25nIGNhcGFjaXR5KTsKCmV4dGVybiBfX2F0dHJpYnV0
ZV9fKChzZWN0aW9uKCIuZGF0YS4ucGVyY3B1IiAiIikpKSBfX3R5cGVvZl9fKHVuc2lnbmVk
IGxvbmcpIGZyZXFfc2NhbGU7CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgbG9uZyB0b3BvbG9neV9n
ZXRfZnJlcV9zY2FsZShpbnQgY3B1KQp7CiByZXR1cm4gKCooeyBkbyB7IGNvbnN0IHZvaWQg
Kl9fdnBwX3ZlcmlmeSA9ICh0eXBlb2YoKCYoZnJlcV9zY2FsZSkpICsgMCkpKCh2b2lkICop
MCk7ICh2b2lkKV9fdnBwX3ZlcmlmeTsgfSB3aGlsZSAoMCk7ICh7IHVuc2lnbmVkIGxvbmcg
X19wdHI7IF9fYXNtX18gKCIiIDogIj1yIihfX3B0cikgOiAiMCIoKHR5cGVvZigqKCgmKGZy
ZXFfc2NhbGUpKSkpICopKCgmKGZyZXFfc2NhbGUpKSkpKTsgKHR5cGVvZigodHlwZW9mKCoo
KCYoZnJlcV9zY2FsZSkpKSkgKikoKCYoZnJlcV9zY2FsZSkpKSkpIChfX3B0ciArICgoKF9f
cGVyX2NwdV9vZmZzZXRbKGNwdSldKSkpKTsgfSk7IH0pKTsKfQoKYm9vbCBhcmNoX2ZyZXFf
Y291bnRlcnNfYXZhaWxhYmxlKHN0cnVjdCBjcHVtYXNrICpjcHVzKTsKCmV4dGVybiBfX2F0
dHJpYnV0ZV9fKChzZWN0aW9uKCIuZGF0YS4ucGVyY3B1IiAiIikpKSBfX3R5cGVvZl9fKHVu
c2lnbmVkIGxvbmcpIHRoZXJtYWxfcHJlc3N1cmU7CgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgbG9u
ZyB0b3BvbG9neV9nZXRfdGhlcm1hbF9wcmVzc3VyZShpbnQgY3B1KQp7CiByZXR1cm4gKCoo
eyBkbyB7IGNvbnN0IHZvaWQgKl9fdnBwX3ZlcmlmeSA9ICh0eXBlb2YoKCYodGhlcm1hbF9w
cmVzc3VyZSkpICsgMCkpKCh2b2lkICopMCk7ICh2b2lkKV9fdnBwX3ZlcmlmeTsgfSB3aGls
ZSAoMCk7ICh7IHVuc2lnbmVkIGxvbmcgX19wdHI7IF9fYXNtX18gKCIiIDogIj1yIihfX3B0
cikgOiAiMCIoKHR5cGVvZigqKCgmKHRoZXJtYWxfcHJlc3N1cmUpKSkpICopKCgmKHRoZXJt
YWxfcHJlc3N1cmUpKSkpKTsgKHR5cGVvZigodHlwZW9mKCooKCYodGhlcm1hbF9wcmVzc3Vy
ZSkpKSkgKikoKCYodGhlcm1hbF9wcmVzc3VyZSkpKSkpIChfX3B0ciArICgoKF9fcGVyX2Nw
dV9vZmZzZXRbKGNwdSldKSkpKTsgfSk7IH0pKTsKfQoKdm9pZCBhcmNoX3NldF90aGVybWFs
X3ByZXNzdXJlKHN0cnVjdCBjcHVtYXNrICpjcHVzLAogICAgICAgICAgdW5zaWduZWQgbG9u
ZyB0aF9wcmVzc3VyZSk7CgpzdHJ1Y3QgY3B1X3RvcG9sb2d5IHsKIGludCB0aHJlYWRfaWQ7
CiBpbnQgY29yZV9pZDsKIGludCBwYWNrYWdlX2lkOwogaW50IGxsY19pZDsKIGNwdW1hc2tf
dCB0aHJlYWRfc2libGluZzsKIGNwdW1hc2tfdCBjb3JlX3NpYmxpbmc7CiBjcHVtYXNrX3Qg
bGxjX3NpYmxpbmc7Cn07CiMgMzEgIi4vaW5jbHVkZS9saW51eC90b3BvbG9neS5oIiAyCgoK
CgoKIyAxICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS90b3BvbG9neS5oIiAxCgoKCgoK
CnN0cnVjdCBkZXZpY2U7CnN0cnVjdCBkZXZpY2Vfbm9kZTsKIyA2NyAiLi9hcmNoL3Bvd2Vy
cGMvaW5jbHVkZS9hc20vdG9wb2xvZ3kuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBlYXJseV9jcHVfdG9f
bm9kZShpbnQgY3B1KSB7IHJldHVybiAwOyB9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBkdW1wX251bWFf
Y3B1X3RvcG9sb2d5KHZvaWQpIHt9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHN5c2ZzX2FkZF9kZXZpY2Vf
dG9fbm9kZShzdHJ1Y3QgZGV2aWNlICpkZXYsIGludCBuaWQpCnsKIHJldHVybiAwOwp9Cgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgdm9pZCBzeXNmc19yZW1vdmVfZGV2aWNlX2Zyb21fbm9kZShzdHJ1Y3QgZGV2
aWNlICpkZXYsCiAgICAgIGludCBuaWQpCnsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBudW1hX3VwZGF0
ZV9jcHVfdG9wb2xvZ3koYm9vbCBjcHVzX2xvY2tlZCkKewogcmV0dXJuIDA7Cn0KCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSB2b2lkIHVwZGF0ZV9udW1hX2NwdV9sb29rdXBfdGFibGUodW5zaWduZWQgaW50IGNw
dSwgaW50IG5vZGUpIHt9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGNwdV9kaXN0YW5jZShfX2JlMzIgKmNw
dTFfYXNzb2MsIF9fYmUzMiAqY3B1Ml9hc3NvYykKewogcmV0dXJuIDA7Cn0KIyAxMDIgIi4v
YXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL3RvcG9sb2d5LmgiCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgc3Rh
cnRfdG9wb2xvZ3lfdXBkYXRlKHZvaWQpCnsKIHJldHVybiAwOwp9CnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQg
c3RvcF90b3BvbG9neV91cGRhdGUodm9pZCkKewogcmV0dXJuIDA7Cn0Kc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGlu
dCBwcnJuX2lzX2VuYWJsZWQodm9pZCkKewogcmV0dXJuIDA7Cn0Kc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBm
aW5kX2FuZF9vbmxpbmVfY3B1X25pZChpbnQgY3B1KQp7CiByZXR1cm4gMDsKfQpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgaW50IHRpbWVkX3RvcG9sb2d5X3VwZGF0ZShpbnQgbnNlY3MpCnsKIHJldHVybiAwOwp9
CgoKCiMgMSAiLi9pbmNsdWRlL2FzbS1nZW5lcmljL3RvcG9sb2d5LmgiIDEKIyAxMjYgIi4v
YXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL3RvcG9sb2d5LmgiIDIKIyAxNDQgIi4vYXJjaC9w
b3dlcnBjL2luY2x1ZGUvYXNtL3RvcG9sb2d5LmgiCmludCBkbHBhcl9jcHVfcmVhZGQoaW50
IGNwdSk7CiMgMzcgIi4vaW5jbHVkZS9saW51eC90b3BvbG9neS5oIiAyCiMgNDYgIi4vaW5j
bHVkZS9saW51eC90b3BvbG9neS5oIgppbnQgYXJjaF91cGRhdGVfY3B1X3RvcG9sb2d5KHZv
aWQpOwojIDc1ICIuL2luY2x1ZGUvbGludXgvdG9wb2xvZ3kuaCIKZXh0ZXJuIGludCBfX2F0
dHJpYnV0ZV9fKChfX3NlY3Rpb25fXygiLmRhdGEuLnJlYWRfbW9zdGx5IikpKSBub2RlX3Jl
Y2xhaW1fZGlzdGFuY2U7CiMgMTE3ICIuL2luY2x1ZGUvbGludXgvdG9wb2xvZ3kuaCIKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIGludCBudW1hX25vZGVfaWQodm9pZCkKewogcmV0dXJuICgodm9pZCkoKGxvY2Fs
X3BhY2EtPnBhY2FfaW5kZXgpKSwwKTsKfQojIDE2NyAiLi9pbmNsdWRlL2xpbnV4L3RvcG9s
b2d5LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSBpbnQgbnVtYV9tZW1faWQodm9pZCkKewogcmV0dXJuIG51bWFf
bm9kZV9pZCgpOwp9CiMgMjA4ICIuL2luY2x1ZGUvbGludXgvdG9wb2xvZ3kuaCIKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIGNvbnN0IHN0cnVjdCBjcHVtYXNrICpjcHVfY3B1X21hc2soaW50IGNwdSkKewogcmV0
dXJuICgodm9pZCkoKCh2b2lkKShjcHUpLDApKSwgKChjb25zdCBzdHJ1Y3QgY3B1bWFzayAq
KSZfX2NwdV9vbmxpbmVfbWFzaykpOwp9CiMgMTAgIi4vaW5jbHVkZS9saW51eC9nZnAuaCIg
MgoKc3RydWN0IHZtX2FyZWFfc3RydWN0OwojIDMxNSAiLi9pbmNsdWRlL2xpbnV4L2dmcC5o
IgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgaW50IGdmcF9taWdyYXRldHlwZShjb25zdCBnZnBfdCBnZnBfZmxhZ3Mp
CnsKICgodm9pZCkoc2l6ZW9mKCggbG9uZykoKGdmcF9mbGFncyAmICgoKCBnZnBfdCkweDEw
dSl8KCggZ2ZwX3QpMHgwOHUpKSkgPT0gKCgoIGdmcF90KTB4MTB1KXwoKCBnZnBfdCkweDA4
dSkpKSkpKTsKIGRvIHsgZXh0ZXJuIHZvaWQgX19jb21waWxldGltZV9hc3NlcnRfMTE5KHZv
aWQpIF9fYXR0cmlidXRlX18oKF9fZXJyb3JfXygiQlVJTERfQlVHX09OIGZhaWxlZDogIiAi
KDFVTCA8PCBHRlBfTU9WQUJMRV9TSElGVCkgIT0gX19fR0ZQX01PVkFCTEUiKSkpOyBpZiAo
ISghKCgxVUwgPDwgMykgIT0gMHgwOHUpKSkgX19jb21waWxldGltZV9hc3NlcnRfMTE5KCk7
IH0gd2hpbGUgKDApOwogZG8geyBleHRlcm4gdm9pZCBfX2NvbXBpbGV0aW1lX2Fzc2VydF8x
MjAodm9pZCkgX19hdHRyaWJ1dGVfXygoX19lcnJvcl9fKCJCVUlMRF9CVUdfT04gZmFpbGVk
OiAiICIoX19fR0ZQX01PVkFCTEUgPj4gR0ZQX01PVkFCTEVfU0hJRlQpICE9IE1JR1JBVEVf
TU9WQUJMRSIpKSk7IGlmICghKCEoKDB4MDh1ID4+IDMpICE9IE1JR1JBVEVfTU9WQUJMRSkp
KSBfX2NvbXBpbGV0aW1lX2Fzc2VydF8xMjAoKTsgfSB3aGlsZSAoMCk7CgogaWYgKF9fYnVp
bHRpbl9leHBlY3QoISEocGFnZV9ncm91cF9ieV9tb2JpbGl0eV9kaXNhYmxlZCksIDApKQog
IHJldHVybiBNSUdSQVRFX1VOTU9WQUJMRTsKCgogcmV0dXJuIChnZnBfZmxhZ3MgJiAoKCgg
Z2ZwX3QpMHgxMHUpfCgoIGdmcF90KTB4MDh1KSkpID4+IDM7Cn0KCgoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJv
b2wgZ2ZwZmxhZ3NfYWxsb3dfYmxvY2tpbmcoY29uc3QgZ2ZwX3QgZ2ZwX2ZsYWdzKQp7CiBy
ZXR1cm4gISEoZ2ZwX2ZsYWdzICYgKCggZ2ZwX3QpMHg0MDB1KSk7Cn0KIyAzNTIgIi4vaW5j
bHVkZS9saW51eC9nZnAuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgZ2ZwZmxhZ3Nfbm9ybWFsX2NvbnRl
eHQoY29uc3QgZ2ZwX3QgZ2ZwX2ZsYWdzKQp7CiByZXR1cm4gKGdmcF9mbGFncyAmICgoKCBn
ZnBfdCkweDQwMHUpIHwgKCggZ2ZwX3QpMHgyMDAwMHUpKSkgPT0KICAoKCBnZnBfdCkweDQw
MHUpOwp9CiMgNDQ4ICIuL2luY2x1ZGUvbGludXgvZ2ZwLmgiCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBlbnVtIHpv
bmVfdHlwZSBnZnBfem9uZShnZnBfdCBmbGFncykKewogZW51bSB6b25lX3R5cGUgejsKIGlu
dCBiaXQgPSAoIGludCkgKGZsYWdzICYgKCgoIGdmcF90KTB4MDF1KXwoKCBnZnBfdCkweDAy
dSl8KCggZ2ZwX3QpMHgwNHUpfCgoIGdmcF90KTB4MDh1KSkpOwoKIHogPSAoKCAoWk9ORV9O
T1JNQUwgPDwgMCAqIDIpIHwgKFpPTkVfRE1BIDw8IDB4MDF1ICogMikgfCAoWk9ORV9OT1JN
QUwgPDwgMHgwMnUgKiAyKSB8IChaT05FX05PUk1BTCA8PCAweDA0dSAqIDIpIHwgKFpPTkVf
Tk9STUFMIDw8IDB4MDh1ICogMikgfCAoWk9ORV9ETUEgPDwgKDB4MDh1IHwgMHgwMXUpICog
MikgfCAoWk9ORV9NT1ZBQkxFIDw8ICgweDA4dSB8IDB4MDJ1KSAqIDIpIHwgKFpPTkVfTk9S
TUFMIDw8ICgweDA4dSB8IDB4MDR1KSAqIDIpKSA+PiAoYml0ICogMikpICYKICAgICAgKCgx
IDw8IDIpIC0gMSk7CiAoKHZvaWQpKHNpemVvZigoIGxvbmcpKCgoIDEgPDwgKDB4MDF1IHwg
MHgwMnUpIHwgMSA8PCAoMHgwMXUgfCAweDA0dSkgfCAxIDw8ICgweDA0dSB8IDB4MDJ1KSB8
IDEgPDwgKDB4MDF1IHwgMHgwNHUgfCAweDAydSkgfCAxIDw8ICgweDA4dSB8IDB4MDJ1IHwg
MHgwMXUpIHwgMSA8PCAoMHgwOHUgfCAweDA0dSB8IDB4MDF1KSB8IDEgPDwgKDB4MDh1IHwg
MHgwNHUgfCAweDAydSkgfCAxIDw8ICgweDA4dSB8IDB4MDR1IHwgMHgwMXUgfCAweDAydSkg
KSA+PiBiaXQpICYgMSkpKSk7CiByZXR1cm4gejsKfQojIDQ2NiAiLi9pbmNsdWRlL2xpbnV4
L2dmcC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgaW50IGdmcF96b25lbGlzdChnZnBfdCBmbGFncykKewoKCgoK
IHJldHVybiBaT05FTElTVF9GQUxMQkFDSzsKfQojIDQ4NCAiLi9pbmNsdWRlL2xpbnV4L2dm
cC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgc3RydWN0IHpvbmVsaXN0ICpub2RlX3pvbmVsaXN0KGludCBuaWQs
IGdmcF90IGZsYWdzKQp7CiByZXR1cm4gKCZjb250aWdfcGFnZV9kYXRhKS0+bm9kZV96b25l
bGlzdHMgKyBnZnBfem9uZWxpc3QoZmxhZ3MpOwp9CgoKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgYXJjaF9m
cmVlX3BhZ2Uoc3RydWN0IHBhZ2UgKnBhZ2UsIGludCBvcmRlcikgeyB9CgoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IHZvaWQgYXJjaF9hbGxvY19wYWdlKHN0cnVjdCBwYWdlICpwYWdlLCBpbnQgb3JkZXIpIHsg
fQoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSBpbnQgYXJjaF9tYWtlX3BhZ2VfYWNjZXNzaWJsZShzdHJ1Y3QgcGFn
ZSAqcGFnZSkKewogcmV0dXJuIDA7Cn0KCgpzdHJ1Y3QgcGFnZSAqCl9fYWxsb2NfcGFnZXNf
bm9kZW1hc2soZ2ZwX3QgZ2ZwX21hc2ssIHVuc2lnbmVkIGludCBvcmRlciwgaW50IHByZWZl
cnJlZF9uaWQsCiAgICAgICBub2RlbWFza190ICpub2RlbWFzayk7CgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3Ry
dWN0IHBhZ2UgKgpfX2FsbG9jX3BhZ2VzKGdmcF90IGdmcF9tYXNrLCB1bnNpZ25lZCBpbnQg
b3JkZXIsIGludCBwcmVmZXJyZWRfbmlkKQp7CiByZXR1cm4gX19hbGxvY19wYWdlc19ub2Rl
bWFzayhnZnBfbWFzaywgb3JkZXIsIHByZWZlcnJlZF9uaWQsICgodm9pZCAqKTApKTsKfQoK
CgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSBzdHJ1Y3QgcGFnZSAqCl9fYWxsb2NfcGFnZXNfbm9kZShpbnQgbmlk
LCBnZnBfdCBnZnBfbWFzaywgdW5zaWduZWQgaW50IG9yZGVyKQp7CiAoKHZvaWQpKHNpemVv
ZigoIGxvbmcpKG5pZCA8IDAgfHwgbmlkID49ICgxIDw8IDApKSkpKTsKICgodm9pZCkoc2l6
ZW9mKCggbG9uZykoKGdmcF9tYXNrICYgKCggZ2ZwX3QpMHgyMDAwMDB1KSkgJiYgIW5vZGVf
c3RhdGUoKG5pZCksIE5fT05MSU5FKSkpKSk7CgogcmV0dXJuIF9fYWxsb2NfcGFnZXMoZ2Zw
X21hc2ssIG9yZGVyLCBuaWQpOwp9CgoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3QgcGFnZSAqYWxs
b2NfcGFnZXNfbm9kZShpbnQgbmlkLCBnZnBfdCBnZnBfbWFzaywKICAgICAgdW5zaWduZWQg
aW50IG9yZGVyKQp7CiBpZiAobmlkID09ICgtMSkpCiAgbmlkID0gbnVtYV9tZW1faWQoKTsK
CiByZXR1cm4gX19hbGxvY19wYWdlc19ub2RlKG5pZCwgZ2ZwX21hc2ssIG9yZGVyKTsKfQoj
IDU2NiAiLi9pbmNsdWRlL2xpbnV4L2dmcC5oIgpleHRlcm4gdW5zaWduZWQgbG9uZyBfX2dl
dF9mcmVlX3BhZ2VzKGdmcF90IGdmcF9tYXNrLCB1bnNpZ25lZCBpbnQgb3JkZXIpOwpleHRl
cm4gdW5zaWduZWQgbG9uZyBnZXRfemVyb2VkX3BhZ2UoZ2ZwX3QgZ2ZwX21hc2spOwoKdm9p
ZCAqYWxsb2NfcGFnZXNfZXhhY3Qoc2l6ZV90IHNpemUsIGdmcF90IGdmcF9tYXNrKTsKdm9p
ZCBmcmVlX3BhZ2VzX2V4YWN0KHZvaWQgKnZpcnQsIHNpemVfdCBzaXplKTsKdm9pZCAqIF9f
YXR0cmlidXRlX18oKF9fc2VjdGlvbl9fKCIubWVtaW5pdC50ZXh0IikpKSBfX2F0dHJpYnV0
ZV9fKChfX2NvbGRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgYWxsb2NfcGFnZXNfZXhhY3RfbmlkKGludCBuaWQsIHNpemVfdCBzaXplLCBnZnBf
dCBnZnBfbWFzayk7CgoKCgoKCgpleHRlcm4gdm9pZCBfX2ZyZWVfcGFnZXMoc3RydWN0IHBh
Z2UgKnBhZ2UsIHVuc2lnbmVkIGludCBvcmRlcik7CmV4dGVybiB2b2lkIGZyZWVfcGFnZXMo
dW5zaWduZWQgbG9uZyBhZGRyLCB1bnNpZ25lZCBpbnQgb3JkZXIpOwpleHRlcm4gdm9pZCBm
cmVlX3VucmVmX3BhZ2Uoc3RydWN0IHBhZ2UgKnBhZ2UpOwpleHRlcm4gdm9pZCBmcmVlX3Vu
cmVmX3BhZ2VfbGlzdChzdHJ1Y3QgbGlzdF9oZWFkICpsaXN0KTsKCnN0cnVjdCBwYWdlX2Zy
YWdfY2FjaGU7CmV4dGVybiB2b2lkIF9fcGFnZV9mcmFnX2NhY2hlX2RyYWluKHN0cnVjdCBw
YWdlICpwYWdlLCB1bnNpZ25lZCBpbnQgY291bnQpOwpleHRlcm4gdm9pZCAqcGFnZV9mcmFn
X2FsbG9jKHN0cnVjdCBwYWdlX2ZyYWdfY2FjaGUgKm5jLAogICAgICAgIHVuc2lnbmVkIGlu
dCBmcmFnc3osIGdmcF90IGdmcF9tYXNrKTsKZXh0ZXJuIHZvaWQgcGFnZV9mcmFnX2ZyZWUo
dm9pZCAqYWRkcik7CgoKCgp2b2lkIHBhZ2VfYWxsb2NfaW5pdCh2b2lkKTsKdm9pZCBkcmFp
bl96b25lX3BhZ2VzKHN0cnVjdCB6b25lICp6b25lLCBzdHJ1Y3QgcGVyX2NwdV9wYWdlcyAq
cGNwKTsKdm9pZCBkcmFpbl9hbGxfcGFnZXMoc3RydWN0IHpvbmUgKnpvbmUpOwp2b2lkIGRy
YWluX2xvY2FsX3BhZ2VzKHN0cnVjdCB6b25lICp6b25lKTsKCnZvaWQgcGFnZV9hbGxvY19p
bml0X2xhdGUodm9pZCk7CiMgNjA3ICIuL2luY2x1ZGUvbGludXgvZ2ZwLmgiCmV4dGVybiBn
ZnBfdCBnZnBfYWxsb3dlZF9tYXNrOwoKCmJvb2wgZ2ZwX3BmbWVtYWxsb2NfYWxsb3dlZChn
ZnBfdCBnZnBfbWFzayk7CgpleHRlcm4gdm9pZCBwbV9yZXN0cmljdF9nZnBfbWFzayh2b2lk
KTsKZXh0ZXJuIHZvaWQgcG1fcmVzdG9yZV9nZnBfbWFzayh2b2lkKTsKCgoKCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBib29sIHBtX3N1c3BlbmRlZF9zdG9yYWdlKHZvaWQpCnsKIHJldHVybiBmYWxzZTsKfQoj
IDYzMSAiLi9pbmNsdWRlL2xpbnV4L2dmcC5oIgp2b2lkIGZyZWVfY29udGlnX3JhbmdlKHVu
c2lnbmVkIGxvbmcgcGZuLCB1bnNpZ25lZCBpbnQgbnJfcGFnZXMpOwojIDExICIuL2luY2x1
ZGUvbGludXgvbW0uaCIgMgoKCgoKCgoKIyAxICIuL2luY2x1ZGUvbGludXgvbW1hcF9sb2Nr
LmgiIDEKIyA5ICIuL2luY2x1ZGUvbGludXgvbW1hcF9sb2NrLmgiCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lk
IG1tYXBfaW5pdF9sb2NrKHN0cnVjdCBtbV9zdHJ1Y3QgKm1tKQp7CiBkbyB7IHN0YXRpYyBz
dHJ1Y3QgbG9ja19jbGFzc19rZXkgX19rZXk7IF9faW5pdF9yd3NlbSgoJm1tLT5tbWFwX2xv
Y2spLCAiJm1tLT5tbWFwX2xvY2siLCAmX19rZXkpOyB9IHdoaWxlICgwKTsKfQoKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIHZvaWQgbW1hcF93cml0ZV9sb2NrKHN0cnVjdCBtbV9zdHJ1Y3QgKm1tKQp7CiBkb3du
X3dyaXRlKCZtbS0+bW1hcF9sb2NrKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgbW1hcF93cml0ZV9s
b2NrX25lc3RlZChzdHJ1Y3QgbW1fc3RydWN0ICptbSwgaW50IHN1YmNsYXNzKQp7CiBkb3du
X3dyaXRlKCZtbS0+bW1hcF9sb2NrKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBtbWFwX3dyaXRlX2xv
Y2tfa2lsbGFibGUoc3RydWN0IG1tX3N0cnVjdCAqbW0pCnsKIHJldHVybiBkb3duX3dyaXRl
X2tpbGxhYmxlKCZtbS0+bW1hcF9sb2NrKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgbW1hcF93cml0
ZV90cnlsb2NrKHN0cnVjdCBtbV9zdHJ1Y3QgKm1tKQp7CiByZXR1cm4gZG93bl93cml0ZV90
cnlsb2NrKCZtbS0+bW1hcF9sb2NrKSAhPSAwOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBtbWFwX3dy
aXRlX3VubG9jayhzdHJ1Y3QgbW1fc3RydWN0ICptbSkKewogdXBfd3JpdGUoJm1tLT5tbWFw
X2xvY2spOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBtbWFwX3dyaXRlX2Rvd25ncmFkZShzdHJ1Y3Qg
bW1fc3RydWN0ICptbSkKewogZG93bmdyYWRlX3dyaXRlKCZtbS0+bW1hcF9sb2NrKTsKfQoK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIHZvaWQgbW1hcF9yZWFkX2xvY2soc3RydWN0IG1tX3N0cnVjdCAqbW0pCnsK
IGRvd25fcmVhZCgmbW0tPm1tYXBfbG9jayk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgbW1hcF9yZWFk
X2xvY2tfa2lsbGFibGUoc3RydWN0IG1tX3N0cnVjdCAqbW0pCnsKIHJldHVybiBkb3duX3Jl
YWRfa2lsbGFibGUoJm1tLT5tbWFwX2xvY2spOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBtbWFwX3Jl
YWRfdHJ5bG9jayhzdHJ1Y3QgbW1fc3RydWN0ICptbSkKewogcmV0dXJuIGRvd25fcmVhZF90
cnlsb2NrKCZtbS0+bW1hcF9sb2NrKSAhPSAwOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBtbWFwX3Jl
YWRfdW5sb2NrKHN0cnVjdCBtbV9zdHJ1Y3QgKm1tKQp7CiB1cF9yZWFkKCZtbS0+bW1hcF9s
b2NrKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgbW1hcF9yZWFkX3RyeWxvY2tfbm9uX293bmVyKHN0
cnVjdCBtbV9zdHJ1Y3QgKm1tKQp7CiBpZiAoZG93bl9yZWFkX3RyeWxvY2soJm1tLT5tbWFw
X2xvY2spKSB7CiAgZG8geyB9IHdoaWxlICgwKTsKICByZXR1cm4gdHJ1ZTsKIH0KIHJldHVy
biBmYWxzZTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgbW1hcF9yZWFkX3VubG9ja19ub25fb3duZXIo
c3RydWN0IG1tX3N0cnVjdCAqbW0pCnsKIHVwX3JlYWQoJm1tLT5tbWFwX2xvY2spOwp9Cgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgdm9pZCBtbWFwX2Fzc2VydF9sb2NrZWQoc3RydWN0IG1tX3N0cnVjdCAqbW0p
CnsKIGRvIHsgKHZvaWQpKCZtbS0+bW1hcF9sb2NrKTsgfSB3aGlsZSAoMCk7CiAoKHZvaWQp
KHNpemVvZigoIGxvbmcpKCFyd3NlbV9pc19sb2NrZWQoJm1tLT5tbWFwX2xvY2spKSkpKTsK
fQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIHZvaWQgbW1hcF9hc3NlcnRfd3JpdGVfbG9ja2VkKHN0cnVjdCBtbV9z
dHJ1Y3QgKm1tKQp7CiBkbyB7ICh2b2lkKSgmbW0tPm1tYXBfbG9jayk7IH0gd2hpbGUgKDAp
OwogKCh2b2lkKShzaXplb2YoKCBsb25nKSghcndzZW1faXNfbG9ja2VkKCZtbS0+bW1hcF9s
b2NrKSkpKSk7Cn0KIyAxOSAiLi9pbmNsdWRlL2xpbnV4L21tLmgiIDIKIyAxICIuL2luY2x1
ZGUvbGludXgvcmFuZ2UuaCIgMQoKCgoKc3RydWN0IHJhbmdlIHsKIHU2NCBzdGFydDsKIHU2
NCBlbmQ7Cn07CgppbnQgYWRkX3JhbmdlKHN0cnVjdCByYW5nZSAqcmFuZ2UsIGludCBheiwg
aW50IG5yX3JhbmdlLAogIHU2NCBzdGFydCwgdTY0IGVuZCk7CgoKaW50IGFkZF9yYW5nZV93
aXRoX21lcmdlKHN0cnVjdCByYW5nZSAqcmFuZ2UsIGludCBheiwgaW50IG5yX3JhbmdlLAog
ICAgdTY0IHN0YXJ0LCB1NjQgZW5kKTsKCnZvaWQgc3VidHJhY3RfcmFuZ2Uoc3RydWN0IHJh
bmdlICpyYW5nZSwgaW50IGF6LCB1NjQgc3RhcnQsIHU2NCBlbmQpOwoKaW50IGNsZWFuX3Nv
cnRfcmFuZ2Uoc3RydWN0IHJhbmdlICpyYW5nZSwgaW50IGF6KTsKCnZvaWQgc29ydF9yYW5n
ZShzdHJ1Y3QgcmFuZ2UgKnJhbmdlLCBpbnQgbnJfcmFuZ2UpOwoKCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSByZXNv
dXJjZV9zaXplX3QgY2FwX3Jlc291cmNlKHU2NCB2YWwpCnsKIGlmICh2YWwgPiAoKHJlc291
cmNlX3NpemVfdCl+MCkpCiAgcmV0dXJuICgocmVzb3VyY2Vfc2l6ZV90KX4wKTsKCiByZXR1
cm4gdmFsOwp9CiMgMjAgIi4vaW5jbHVkZS9saW51eC9tbS5oIiAyCgojIDEgIi4vaW5jbHVk
ZS9saW51eC9wZXJjcHUtcmVmY291bnQuaCIgMQojIDU5ICIuL2luY2x1ZGUvbGludXgvcGVy
Y3B1LXJlZmNvdW50LmgiCnN0cnVjdCBwZXJjcHVfcmVmOwp0eXBlZGVmIHZvaWQgKHBlcmNw
dV9yZWZfZnVuY190KShzdHJ1Y3QgcGVyY3B1X3JlZiAqKTsKCgplbnVtIHsKIF9fUEVSQ1BV
X1JFRl9BVE9NSUMgPSAxTFUgPDwgMCwKIF9fUEVSQ1BVX1JFRl9ERUFEID0gMUxVIDw8IDEs
CiBfX1BFUkNQVV9SRUZfQVRPTUlDX0RFQUQgPSBfX1BFUkNQVV9SRUZfQVRPTUlDIHwgX19Q
RVJDUFVfUkVGX0RFQUQsCgogX19QRVJDUFVfUkVGX0ZMQUdfQklUUyA9IDIsCn07CgoKZW51
bSB7CgoKCgoKCgogUEVSQ1BVX1JFRl9JTklUX0FUT01JQyA9IDEgPDwgMCwKCgoKCgoKIFBF
UkNQVV9SRUZfSU5JVF9ERUFEID0gMSA8PCAxLAoKCgoKIFBFUkNQVV9SRUZfQUxMT1dfUkVJ
TklUID0gMSA8PCAyLAp9OwoKc3RydWN0IHBlcmNwdV9yZWYgewogYXRvbWljX2xvbmdfdCBj
b3VudDsKCgoKCiB1bnNpZ25lZCBsb25nIHBlcmNwdV9jb3VudF9wdHI7CiBwZXJjcHVfcmVm
X2Z1bmNfdCAqcmVsZWFzZTsKIHBlcmNwdV9yZWZfZnVuY190ICpjb25maXJtX3N3aXRjaDsK
IGJvb2wgZm9yY2VfYXRvbWljOjE7CiBib29sIGFsbG93X3JlaW5pdDoxOwogc3RydWN0IGNh
bGxiYWNrX2hlYWQgcmN1Owp9OwoKaW50IF9fYXR0cmlidXRlX18oKF9fd2Fybl91bnVzZWRf
cmVzdWx0X18pKSBwZXJjcHVfcmVmX2luaXQoc3RydWN0IHBlcmNwdV9yZWYgKnJlZiwKICAg
ICBwZXJjcHVfcmVmX2Z1bmNfdCAqcmVsZWFzZSwgdW5zaWduZWQgaW50IGZsYWdzLAogICAg
IGdmcF90IGdmcCk7CnZvaWQgcGVyY3B1X3JlZl9leGl0KHN0cnVjdCBwZXJjcHVfcmVmICpy
ZWYpOwp2b2lkIHBlcmNwdV9yZWZfc3dpdGNoX3RvX2F0b21pYyhzdHJ1Y3QgcGVyY3B1X3Jl
ZiAqcmVmLAogICAgIHBlcmNwdV9yZWZfZnVuY190ICpjb25maXJtX3N3aXRjaCk7CnZvaWQg
cGVyY3B1X3JlZl9zd2l0Y2hfdG9fYXRvbWljX3N5bmMoc3RydWN0IHBlcmNwdV9yZWYgKnJl
Zik7CnZvaWQgcGVyY3B1X3JlZl9zd2l0Y2hfdG9fcGVyY3B1KHN0cnVjdCBwZXJjcHVfcmVm
ICpyZWYpOwp2b2lkIHBlcmNwdV9yZWZfa2lsbF9hbmRfY29uZmlybShzdHJ1Y3QgcGVyY3B1
X3JlZiAqcmVmLAogICAgIHBlcmNwdV9yZWZfZnVuY190ICpjb25maXJtX2tpbGwpOwp2b2lk
IHBlcmNwdV9yZWZfcmVzdXJyZWN0KHN0cnVjdCBwZXJjcHVfcmVmICpyZWYpOwp2b2lkIHBl
cmNwdV9yZWZfcmVpbml0KHN0cnVjdCBwZXJjcHVfcmVmICpyZWYpOwojIDEzNCAiLi9pbmNs
dWRlL2xpbnV4L3BlcmNwdS1yZWZjb3VudC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBwZXJjcHVfcmVm
X2tpbGwoc3RydWN0IHBlcmNwdV9yZWYgKnJlZikKewogcGVyY3B1X3JlZl9raWxsX2FuZF9j
b25maXJtKHJlZiwgKCh2b2lkICopMCkpOwp9CgoKCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBfX3Jl
Zl9pc19wZXJjcHUoc3RydWN0IHBlcmNwdV9yZWYgKnJlZiwKICAgICAgIHVuc2lnbmVkIGxv
bmcgKipwZXJjcHVfY291bnRwKQp7CiB1bnNpZ25lZCBsb25nIHBlcmNwdV9wdHI7CiMgMTYx
ICIuL2luY2x1ZGUvbGludXgvcGVyY3B1LXJlZmNvdW50LmgiCiBwZXJjcHVfcHRyID0gKHsg
ZG8geyBleHRlcm4gdm9pZCBfX2NvbXBpbGV0aW1lX2Fzc2VydF8xMjEodm9pZCkgX19hdHRy
aWJ1dGVfXygoX19lcnJvcl9fKCJVbnN1cHBvcnRlZCBhY2Nlc3Mgc2l6ZSBmb3Ige1JFQUQs
V1JJVEV9X09OQ0UoKS4iKSkpOyBpZiAoISgoc2l6ZW9mKHJlZi0+cGVyY3B1X2NvdW50X3B0
cikgPT0gc2l6ZW9mKGNoYXIpIHx8IHNpemVvZihyZWYtPnBlcmNwdV9jb3VudF9wdHIpID09
IHNpemVvZihzaG9ydCkgfHwgc2l6ZW9mKHJlZi0+cGVyY3B1X2NvdW50X3B0cikgPT0gc2l6
ZW9mKGludCkgfHwgc2l6ZW9mKHJlZi0+cGVyY3B1X2NvdW50X3B0cikgPT0gc2l6ZW9mKGxv
bmcpKSB8fCBzaXplb2YocmVmLT5wZXJjcHVfY291bnRfcHRyKSA9PSBzaXplb2YobG9uZyBs
b25nKSkpIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzEyMSgpOyB9IHdoaWxlICgwKTsgKHsgdHlw
ZW9mKCBfR2VuZXJpYygocmVmLT5wZXJjcHVfY291bnRfcHRyKSwgY2hhcjogKGNoYXIpMCwg
dW5zaWduZWQgY2hhcjogKHVuc2lnbmVkIGNoYXIpMCwgc2lnbmVkIGNoYXI6IChzaWduZWQg
Y2hhcikwLCB1bnNpZ25lZCBzaG9ydDogKHVuc2lnbmVkIHNob3J0KTAsIHNpZ25lZCBzaG9y
dDogKHNpZ25lZCBzaG9ydCkwLCB1bnNpZ25lZCBpbnQ6ICh1bnNpZ25lZCBpbnQpMCwgc2ln
bmVkIGludDogKHNpZ25lZCBpbnQpMCwgdW5zaWduZWQgbG9uZzogKHVuc2lnbmVkIGxvbmcp
MCwgc2lnbmVkIGxvbmc6IChzaWduZWQgbG9uZykwLCB1bnNpZ25lZCBsb25nIGxvbmc6ICh1
bnNpZ25lZCBsb25nIGxvbmcpMCwgc2lnbmVkIGxvbmcgbG9uZzogKHNpZ25lZCBsb25nIGxv
bmcpMCwgZGVmYXVsdDogKHJlZi0+cGVyY3B1X2NvdW50X3B0cikpKSBfX3ggPSAoKihjb25z
dCB2b2xhdGlsZSB0eXBlb2YoIF9HZW5lcmljKChyZWYtPnBlcmNwdV9jb3VudF9wdHIpLCBj
aGFyOiAoY2hhcikwLCB1bnNpZ25lZCBjaGFyOiAodW5zaWduZWQgY2hhcikwLCBzaWduZWQg
Y2hhcjogKHNpZ25lZCBjaGFyKTAsIHVuc2lnbmVkIHNob3J0OiAodW5zaWduZWQgc2hvcnQp
MCwgc2lnbmVkIHNob3J0OiAoc2lnbmVkIHNob3J0KTAsIHVuc2lnbmVkIGludDogKHVuc2ln
bmVkIGludCkwLCBzaWduZWQgaW50OiAoc2lnbmVkIGludCkwLCB1bnNpZ25lZCBsb25nOiAo
dW5zaWduZWQgbG9uZykwLCBzaWduZWQgbG9uZzogKHNpZ25lZCBsb25nKTAsIHVuc2lnbmVk
IGxvbmcgbG9uZzogKHVuc2lnbmVkIGxvbmcgbG9uZykwLCBzaWduZWQgbG9uZyBsb25nOiAo
c2lnbmVkIGxvbmcgbG9uZykwLCBkZWZhdWx0OiAocmVmLT5wZXJjcHVfY291bnRfcHRyKSkp
ICopJihyZWYtPnBlcmNwdV9jb3VudF9wdHIpKTsgZG8geyB9IHdoaWxlICgwKTsgKHR5cGVv
ZihyZWYtPnBlcmNwdV9jb3VudF9wdHIpKV9feDsgfSk7IH0pOwoKCgoKCgoKIGlmIChfX2J1
aWx0aW5fZXhwZWN0KCEhKHBlcmNwdV9wdHIgJiBfX1BFUkNQVV9SRUZfQVRPTUlDX0RFQUQp
LCAwKSkKICByZXR1cm4gZmFsc2U7CgogKnBlcmNwdV9jb3VudHAgPSAodW5zaWduZWQgbG9u
ZyAqKXBlcmNwdV9wdHI7CiByZXR1cm4gdHJ1ZTsKfQojIDE4NSAiLi9pbmNsdWRlL2xpbnV4
L3BlcmNwdS1yZWZjb3VudC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBwZXJjcHVfcmVmX2dldF9tYW55
KHN0cnVjdCBwZXJjcHVfcmVmICpyZWYsIHVuc2lnbmVkIGxvbmcgbnIpCnsKIHVuc2lnbmVk
IGxvbmcgKnBlcmNwdV9jb3VudDsKCiByY3VfcmVhZF9sb2NrKCk7CgogaWYgKF9fcmVmX2lz
X3BlcmNwdShyZWYsICZwZXJjcHVfY291bnQpKQogIGRvIHsgZG8geyBjb25zdCB2b2lkICpf
X3ZwcF92ZXJpZnkgPSAodHlwZW9mKCgmKCpwZXJjcHVfY291bnQpKSArIDApKSgodm9pZCAq
KTApOyAodm9pZClfX3ZwcF92ZXJpZnk7IH0gd2hpbGUgKDApOyBzd2l0Y2goc2l6ZW9mKCpw
ZXJjcHVfY291bnQpKSB7IGNhc2UgMTogZG8geyB1bnNpZ25lZCBsb25nIF9fZmxhZ3M7IGRv
IHsgKHsgdW5zaWduZWQgbG9uZyBfX2R1bW15OyB0eXBlb2YoX19mbGFncykgX19kdW1teTI7
ICh2b2lkKSgmX19kdW1teSA9PSAmX19kdW1teTIpOyAxOyB9KTsgX19mbGFncyA9IGFyY2hf
bG9jYWxfaXJxX3NhdmUoKTsgfSB3aGlsZSAoMCk7IGRvIHsgKih7IGRvIHsgY29uc3Qgdm9p
ZCAqX192cHBfdmVyaWZ5ID0gKHR5cGVvZigoJigqcGVyY3B1X2NvdW50KSkgKyAwKSkoKHZv
aWQgKikwKTsgKHZvaWQpX192cHBfdmVyaWZ5OyB9IHdoaWxlICgwKTsgKHsgdW5zaWduZWQg
bG9uZyBfX3B0cjsgX19hc21fXyAoIiIgOiAiPXIiKF9fcHRyKSA6ICIwIigodHlwZW9mKCoo
JigqcGVyY3B1X2NvdW50KSkpICopKCYoKnBlcmNwdV9jb3VudCkpKSk7ICh0eXBlb2YoKHR5
cGVvZigqKCYoKnBlcmNwdV9jb3VudCkpKSAqKSgmKCpwZXJjcHVfY291bnQpKSkpIChfX3B0
ciArICgobG9jYWxfcGFjYS0+ZGF0YV9vZmZzZXQpKSk7IH0pOyB9KSArPSBucjsgfSB3aGls
ZSAoMCk7IGRvIHsgKHsgdW5zaWduZWQgbG9uZyBfX2R1bW15OyB0eXBlb2YoX19mbGFncykg
X19kdW1teTI7ICh2b2lkKSgmX19kdW1teSA9PSAmX19kdW1teTIpOyAxOyB9KTsgYXJjaF9s
b2NhbF9pcnFfcmVzdG9yZShfX2ZsYWdzKTsgfSB3aGlsZSAoMCk7IH0gd2hpbGUgKDApO2Jy
ZWFrOyBjYXNlIDI6IGRvIHsgdW5zaWduZWQgbG9uZyBfX2ZsYWdzOyBkbyB7ICh7IHVuc2ln
bmVkIGxvbmcgX19kdW1teTsgdHlwZW9mKF9fZmxhZ3MpIF9fZHVtbXkyOyAodm9pZCkoJl9f
ZHVtbXkgPT0gJl9fZHVtbXkyKTsgMTsgfSk7IF9fZmxhZ3MgPSBhcmNoX2xvY2FsX2lycV9z
YXZlKCk7IH0gd2hpbGUgKDApOyBkbyB7ICooeyBkbyB7IGNvbnN0IHZvaWQgKl9fdnBwX3Zl
cmlmeSA9ICh0eXBlb2YoKCYoKnBlcmNwdV9jb3VudCkpICsgMCkpKCh2b2lkICopMCk7ICh2
b2lkKV9fdnBwX3ZlcmlmeTsgfSB3aGlsZSAoMCk7ICh7IHVuc2lnbmVkIGxvbmcgX19wdHI7
IF9fYXNtX18gKCIiIDogIj1yIihfX3B0cikgOiAiMCIoKHR5cGVvZigqKCYoKnBlcmNwdV9j
b3VudCkpKSAqKSgmKCpwZXJjcHVfY291bnQpKSkpOyAodHlwZW9mKCh0eXBlb2YoKigmKCpw
ZXJjcHVfY291bnQpKSkgKikoJigqcGVyY3B1X2NvdW50KSkpKSAoX19wdHIgKyAoKGxvY2Fs
X3BhY2EtPmRhdGFfb2Zmc2V0KSkpOyB9KTsgfSkgKz0gbnI7IH0gd2hpbGUgKDApOyBkbyB7
ICh7IHVuc2lnbmVkIGxvbmcgX19kdW1teTsgdHlwZW9mKF9fZmxhZ3MpIF9fZHVtbXkyOyAo
dm9pZCkoJl9fZHVtbXkgPT0gJl9fZHVtbXkyKTsgMTsgfSk7IGFyY2hfbG9jYWxfaXJxX3Jl
c3RvcmUoX19mbGFncyk7IH0gd2hpbGUgKDApOyB9IHdoaWxlICgwKTticmVhazsgY2FzZSA0
OiBkbyB7IHVuc2lnbmVkIGxvbmcgX19mbGFnczsgZG8geyAoeyB1bnNpZ25lZCBsb25nIF9f
ZHVtbXk7IHR5cGVvZihfX2ZsYWdzKSBfX2R1bW15MjsgKHZvaWQpKCZfX2R1bW15ID09ICZf
X2R1bW15Mik7IDE7IH0pOyBfX2ZsYWdzID0gYXJjaF9sb2NhbF9pcnFfc2F2ZSgpOyB9IHdo
aWxlICgwKTsgZG8geyAqKHsgZG8geyBjb25zdCB2b2lkICpfX3ZwcF92ZXJpZnkgPSAodHlw
ZW9mKCgmKCpwZXJjcHVfY291bnQpKSArIDApKSgodm9pZCAqKTApOyAodm9pZClfX3ZwcF92
ZXJpZnk7IH0gd2hpbGUgKDApOyAoeyB1bnNpZ25lZCBsb25nIF9fcHRyOyBfX2FzbV9fICgi
IiA6ICI9ciIoX19wdHIpIDogIjAiKCh0eXBlb2YoKigmKCpwZXJjcHVfY291bnQpKSkgKiko
JigqcGVyY3B1X2NvdW50KSkpKTsgKHR5cGVvZigodHlwZW9mKCooJigqcGVyY3B1X2NvdW50
KSkpICopKCYoKnBlcmNwdV9jb3VudCkpKSkgKF9fcHRyICsgKChsb2NhbF9wYWNhLT5kYXRh
X29mZnNldCkpKTsgfSk7IH0pICs9IG5yOyB9IHdoaWxlICgwKTsgZG8geyAoeyB1bnNpZ25l
ZCBsb25nIF9fZHVtbXk7IHR5cGVvZihfX2ZsYWdzKSBfX2R1bW15MjsgKHZvaWQpKCZfX2R1
bW15ID09ICZfX2R1bW15Mik7IDE7IH0pOyBhcmNoX2xvY2FsX2lycV9yZXN0b3JlKF9fZmxh
Z3MpOyB9IHdoaWxlICgwKTsgfSB3aGlsZSAoMCk7YnJlYWs7IGNhc2UgODogZG8geyB1bnNp
Z25lZCBsb25nIF9fZmxhZ3M7IGRvIHsgKHsgdW5zaWduZWQgbG9uZyBfX2R1bW15OyB0eXBl
b2YoX19mbGFncykgX19kdW1teTI7ICh2b2lkKSgmX19kdW1teSA9PSAmX19kdW1teTIpOyAx
OyB9KTsgX19mbGFncyA9IGFyY2hfbG9jYWxfaXJxX3NhdmUoKTsgfSB3aGlsZSAoMCk7IGRv
IHsgKih7IGRvIHsgY29uc3Qgdm9pZCAqX192cHBfdmVyaWZ5ID0gKHR5cGVvZigoJigqcGVy
Y3B1X2NvdW50KSkgKyAwKSkoKHZvaWQgKikwKTsgKHZvaWQpX192cHBfdmVyaWZ5OyB9IHdo
aWxlICgwKTsgKHsgdW5zaWduZWQgbG9uZyBfX3B0cjsgX19hc21fXyAoIiIgOiAiPXIiKF9f
cHRyKSA6ICIwIigodHlwZW9mKCooJigqcGVyY3B1X2NvdW50KSkpICopKCYoKnBlcmNwdV9j
b3VudCkpKSk7ICh0eXBlb2YoKHR5cGVvZigqKCYoKnBlcmNwdV9jb3VudCkpKSAqKSgmKCpw
ZXJjcHVfY291bnQpKSkpIChfX3B0ciArICgobG9jYWxfcGFjYS0+ZGF0YV9vZmZzZXQpKSk7
IH0pOyB9KSArPSBucjsgfSB3aGlsZSAoMCk7IGRvIHsgKHsgdW5zaWduZWQgbG9uZyBfX2R1
bW15OyB0eXBlb2YoX19mbGFncykgX19kdW1teTI7ICh2b2lkKSgmX19kdW1teSA9PSAmX19k
dW1teTIpOyAxOyB9KTsgYXJjaF9sb2NhbF9pcnFfcmVzdG9yZShfX2ZsYWdzKTsgfSB3aGls
ZSAoMCk7IH0gd2hpbGUgKDApO2JyZWFrOyBkZWZhdWx0OiBfX2JhZF9zaXplX2NhbGxfcGFy
YW1ldGVyKCk7YnJlYWs7IH0gfSB3aGlsZSAoMCk7CiBlbHNlCiAgYXRvbWljX2xvbmdfYWRk
KG5yLCAmcmVmLT5jb3VudCk7CgogcmN1X3JlYWRfdW5sb2NrKCk7Cn0KIyAyMDcgIi4vaW5j
bHVkZS9saW51eC9wZXJjcHUtcmVmY291bnQuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgcGVyY3B1X3Jl
Zl9nZXQoc3RydWN0IHBlcmNwdV9yZWYgKnJlZikKewogcGVyY3B1X3JlZl9nZXRfbWFueShy
ZWYsIDEpOwp9CiMgMjIyICIuL2luY2x1ZGUvbGludXgvcGVyY3B1LXJlZmNvdW50LmgiCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSBib29sIHBlcmNwdV9yZWZfdHJ5Z2V0X21hbnkoc3RydWN0IHBlcmNwdV9yZWYg
KnJlZiwKICAgICAgIHVuc2lnbmVkIGxvbmcgbnIpCnsKIHVuc2lnbmVkIGxvbmcgKnBlcmNw
dV9jb3VudDsKIGJvb2wgcmV0OwoKIHJjdV9yZWFkX2xvY2soKTsKCiBpZiAoX19yZWZfaXNf
cGVyY3B1KHJlZiwgJnBlcmNwdV9jb3VudCkpIHsKICBkbyB7IGRvIHsgY29uc3Qgdm9pZCAq
X192cHBfdmVyaWZ5ID0gKHR5cGVvZigoJigqcGVyY3B1X2NvdW50KSkgKyAwKSkoKHZvaWQg
KikwKTsgKHZvaWQpX192cHBfdmVyaWZ5OyB9IHdoaWxlICgwKTsgc3dpdGNoKHNpemVvZigq
cGVyY3B1X2NvdW50KSkgeyBjYXNlIDE6IGRvIHsgdW5zaWduZWQgbG9uZyBfX2ZsYWdzOyBk
byB7ICh7IHVuc2lnbmVkIGxvbmcgX19kdW1teTsgdHlwZW9mKF9fZmxhZ3MpIF9fZHVtbXky
OyAodm9pZCkoJl9fZHVtbXkgPT0gJl9fZHVtbXkyKTsgMTsgfSk7IF9fZmxhZ3MgPSBhcmNo
X2xvY2FsX2lycV9zYXZlKCk7IH0gd2hpbGUgKDApOyBkbyB7ICooeyBkbyB7IGNvbnN0IHZv
aWQgKl9fdnBwX3ZlcmlmeSA9ICh0eXBlb2YoKCYoKnBlcmNwdV9jb3VudCkpICsgMCkpKCh2
b2lkICopMCk7ICh2b2lkKV9fdnBwX3ZlcmlmeTsgfSB3aGlsZSAoMCk7ICh7IHVuc2lnbmVk
IGxvbmcgX19wdHI7IF9fYXNtX18gKCIiIDogIj1yIihfX3B0cikgOiAiMCIoKHR5cGVvZigq
KCYoKnBlcmNwdV9jb3VudCkpKSAqKSgmKCpwZXJjcHVfY291bnQpKSkpOyAodHlwZW9mKCh0
eXBlb2YoKigmKCpwZXJjcHVfY291bnQpKSkgKikoJigqcGVyY3B1X2NvdW50KSkpKSAoX19w
dHIgKyAoKGxvY2FsX3BhY2EtPmRhdGFfb2Zmc2V0KSkpOyB9KTsgfSkgKz0gbnI7IH0gd2hp
bGUgKDApOyBkbyB7ICh7IHVuc2lnbmVkIGxvbmcgX19kdW1teTsgdHlwZW9mKF9fZmxhZ3Mp
IF9fZHVtbXkyOyAodm9pZCkoJl9fZHVtbXkgPT0gJl9fZHVtbXkyKTsgMTsgfSk7IGFyY2hf
bG9jYWxfaXJxX3Jlc3RvcmUoX19mbGFncyk7IH0gd2hpbGUgKDApOyB9IHdoaWxlICgwKTti
cmVhazsgY2FzZSAyOiBkbyB7IHVuc2lnbmVkIGxvbmcgX19mbGFnczsgZG8geyAoeyB1bnNp
Z25lZCBsb25nIF9fZHVtbXk7IHR5cGVvZihfX2ZsYWdzKSBfX2R1bW15MjsgKHZvaWQpKCZf
X2R1bW15ID09ICZfX2R1bW15Mik7IDE7IH0pOyBfX2ZsYWdzID0gYXJjaF9sb2NhbF9pcnFf
c2F2ZSgpOyB9IHdoaWxlICgwKTsgZG8geyAqKHsgZG8geyBjb25zdCB2b2lkICpfX3ZwcF92
ZXJpZnkgPSAodHlwZW9mKCgmKCpwZXJjcHVfY291bnQpKSArIDApKSgodm9pZCAqKTApOyAo
dm9pZClfX3ZwcF92ZXJpZnk7IH0gd2hpbGUgKDApOyAoeyB1bnNpZ25lZCBsb25nIF9fcHRy
OyBfX2FzbV9fICgiIiA6ICI9ciIoX19wdHIpIDogIjAiKCh0eXBlb2YoKigmKCpwZXJjcHVf
Y291bnQpKSkgKikoJigqcGVyY3B1X2NvdW50KSkpKTsgKHR5cGVvZigodHlwZW9mKCooJigq
cGVyY3B1X2NvdW50KSkpICopKCYoKnBlcmNwdV9jb3VudCkpKSkgKF9fcHRyICsgKChsb2Nh
bF9wYWNhLT5kYXRhX29mZnNldCkpKTsgfSk7IH0pICs9IG5yOyB9IHdoaWxlICgwKTsgZG8g
eyAoeyB1bnNpZ25lZCBsb25nIF9fZHVtbXk7IHR5cGVvZihfX2ZsYWdzKSBfX2R1bW15Mjsg
KHZvaWQpKCZfX2R1bW15ID09ICZfX2R1bW15Mik7IDE7IH0pOyBhcmNoX2xvY2FsX2lycV9y
ZXN0b3JlKF9fZmxhZ3MpOyB9IHdoaWxlICgwKTsgfSB3aGlsZSAoMCk7YnJlYWs7IGNhc2Ug
NDogZG8geyB1bnNpZ25lZCBsb25nIF9fZmxhZ3M7IGRvIHsgKHsgdW5zaWduZWQgbG9uZyBf
X2R1bW15OyB0eXBlb2YoX19mbGFncykgX19kdW1teTI7ICh2b2lkKSgmX19kdW1teSA9PSAm
X19kdW1teTIpOyAxOyB9KTsgX19mbGFncyA9IGFyY2hfbG9jYWxfaXJxX3NhdmUoKTsgfSB3
aGlsZSAoMCk7IGRvIHsgKih7IGRvIHsgY29uc3Qgdm9pZCAqX192cHBfdmVyaWZ5ID0gKHR5
cGVvZigoJigqcGVyY3B1X2NvdW50KSkgKyAwKSkoKHZvaWQgKikwKTsgKHZvaWQpX192cHBf
dmVyaWZ5OyB9IHdoaWxlICgwKTsgKHsgdW5zaWduZWQgbG9uZyBfX3B0cjsgX19hc21fXyAo
IiIgOiAiPXIiKF9fcHRyKSA6ICIwIigodHlwZW9mKCooJigqcGVyY3B1X2NvdW50KSkpICop
KCYoKnBlcmNwdV9jb3VudCkpKSk7ICh0eXBlb2YoKHR5cGVvZigqKCYoKnBlcmNwdV9jb3Vu
dCkpKSAqKSgmKCpwZXJjcHVfY291bnQpKSkpIChfX3B0ciArICgobG9jYWxfcGFjYS0+ZGF0
YV9vZmZzZXQpKSk7IH0pOyB9KSArPSBucjsgfSB3aGlsZSAoMCk7IGRvIHsgKHsgdW5zaWdu
ZWQgbG9uZyBfX2R1bW15OyB0eXBlb2YoX19mbGFncykgX19kdW1teTI7ICh2b2lkKSgmX19k
dW1teSA9PSAmX19kdW1teTIpOyAxOyB9KTsgYXJjaF9sb2NhbF9pcnFfcmVzdG9yZShfX2Zs
YWdzKTsgfSB3aGlsZSAoMCk7IH0gd2hpbGUgKDApO2JyZWFrOyBjYXNlIDg6IGRvIHsgdW5z
aWduZWQgbG9uZyBfX2ZsYWdzOyBkbyB7ICh7IHVuc2lnbmVkIGxvbmcgX19kdW1teTsgdHlw
ZW9mKF9fZmxhZ3MpIF9fZHVtbXkyOyAodm9pZCkoJl9fZHVtbXkgPT0gJl9fZHVtbXkyKTsg
MTsgfSk7IF9fZmxhZ3MgPSBhcmNoX2xvY2FsX2lycV9zYXZlKCk7IH0gd2hpbGUgKDApOyBk
byB7ICooeyBkbyB7IGNvbnN0IHZvaWQgKl9fdnBwX3ZlcmlmeSA9ICh0eXBlb2YoKCYoKnBl
cmNwdV9jb3VudCkpICsgMCkpKCh2b2lkICopMCk7ICh2b2lkKV9fdnBwX3ZlcmlmeTsgfSB3
aGlsZSAoMCk7ICh7IHVuc2lnbmVkIGxvbmcgX19wdHI7IF9fYXNtX18gKCIiIDogIj1yIihf
X3B0cikgOiAiMCIoKHR5cGVvZigqKCYoKnBlcmNwdV9jb3VudCkpKSAqKSgmKCpwZXJjcHVf
Y291bnQpKSkpOyAodHlwZW9mKCh0eXBlb2YoKigmKCpwZXJjcHVfY291bnQpKSkgKikoJigq
cGVyY3B1X2NvdW50KSkpKSAoX19wdHIgKyAoKGxvY2FsX3BhY2EtPmRhdGFfb2Zmc2V0KSkp
OyB9KTsgfSkgKz0gbnI7IH0gd2hpbGUgKDApOyBkbyB7ICh7IHVuc2lnbmVkIGxvbmcgX19k
dW1teTsgdHlwZW9mKF9fZmxhZ3MpIF9fZHVtbXkyOyAodm9pZCkoJl9fZHVtbXkgPT0gJl9f
ZHVtbXkyKTsgMTsgfSk7IGFyY2hfbG9jYWxfaXJxX3Jlc3RvcmUoX19mbGFncyk7IH0gd2hp
bGUgKDApOyB9IHdoaWxlICgwKTticmVhazsgZGVmYXVsdDogX19iYWRfc2l6ZV9jYWxsX3Bh
cmFtZXRlcigpO2JyZWFrOyB9IH0gd2hpbGUgKDApOwogIHJldCA9IHRydWU7CiB9IGVsc2Ug
ewogIHJldCA9IGF0b21pY19sb25nX2FkZF91bmxlc3MoJnJlZi0+Y291bnQsIG5yLCAwKTsK
IH0KCiByY3VfcmVhZF91bmxvY2soKTsKCiByZXR1cm4gcmV0Owp9CiMgMjUxICIuL2luY2x1
ZGUvbGludXgvcGVyY3B1LXJlZmNvdW50LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIHBlcmNwdV9yZWZf
dHJ5Z2V0KHN0cnVjdCBwZXJjcHVfcmVmICpyZWYpCnsKIHJldHVybiBwZXJjcHVfcmVmX3Ry
eWdldF9tYW55KHJlZiwgMSk7Cn0KIyAyNzEgIi4vaW5jbHVkZS9saW51eC9wZXJjcHUtcmVm
Y291bnQuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgcGVyY3B1X3JlZl90cnlnZXRfbGl2ZShzdHJ1Y3Qg
cGVyY3B1X3JlZiAqcmVmKQp7CiB1bnNpZ25lZCBsb25nICpwZXJjcHVfY291bnQ7CiBib29s
IHJldCA9IGZhbHNlOwoKIHJjdV9yZWFkX2xvY2soKTsKCiBpZiAoX19yZWZfaXNfcGVyY3B1
KHJlZiwgJnBlcmNwdV9jb3VudCkpIHsKICBkbyB7IGRvIHsgY29uc3Qgdm9pZCAqX192cHBf
dmVyaWZ5ID0gKHR5cGVvZigoJigqcGVyY3B1X2NvdW50KSkgKyAwKSkoKHZvaWQgKikwKTsg
KHZvaWQpX192cHBfdmVyaWZ5OyB9IHdoaWxlICgwKTsgc3dpdGNoKHNpemVvZigqcGVyY3B1
X2NvdW50KSkgeyBjYXNlIDE6IGRvIHsgdW5zaWduZWQgbG9uZyBfX2ZsYWdzOyBkbyB7ICh7
IHVuc2lnbmVkIGxvbmcgX19kdW1teTsgdHlwZW9mKF9fZmxhZ3MpIF9fZHVtbXkyOyAodm9p
ZCkoJl9fZHVtbXkgPT0gJl9fZHVtbXkyKTsgMTsgfSk7IF9fZmxhZ3MgPSBhcmNoX2xvY2Fs
X2lycV9zYXZlKCk7IH0gd2hpbGUgKDApOyBkbyB7ICooeyBkbyB7IGNvbnN0IHZvaWQgKl9f
dnBwX3ZlcmlmeSA9ICh0eXBlb2YoKCYoKnBlcmNwdV9jb3VudCkpICsgMCkpKCh2b2lkICop
MCk7ICh2b2lkKV9fdnBwX3ZlcmlmeTsgfSB3aGlsZSAoMCk7ICh7IHVuc2lnbmVkIGxvbmcg
X19wdHI7IF9fYXNtX18gKCIiIDogIj1yIihfX3B0cikgOiAiMCIoKHR5cGVvZigqKCYoKnBl
cmNwdV9jb3VudCkpKSAqKSgmKCpwZXJjcHVfY291bnQpKSkpOyAodHlwZW9mKCh0eXBlb2Yo
KigmKCpwZXJjcHVfY291bnQpKSkgKikoJigqcGVyY3B1X2NvdW50KSkpKSAoX19wdHIgKyAo
KGxvY2FsX3BhY2EtPmRhdGFfb2Zmc2V0KSkpOyB9KTsgfSkgKz0gMTsgfSB3aGlsZSAoMCk7
IGRvIHsgKHsgdW5zaWduZWQgbG9uZyBfX2R1bW15OyB0eXBlb2YoX19mbGFncykgX19kdW1t
eTI7ICh2b2lkKSgmX19kdW1teSA9PSAmX19kdW1teTIpOyAxOyB9KTsgYXJjaF9sb2NhbF9p
cnFfcmVzdG9yZShfX2ZsYWdzKTsgfSB3aGlsZSAoMCk7IH0gd2hpbGUgKDApO2JyZWFrOyBj
YXNlIDI6IGRvIHsgdW5zaWduZWQgbG9uZyBfX2ZsYWdzOyBkbyB7ICh7IHVuc2lnbmVkIGxv
bmcgX19kdW1teTsgdHlwZW9mKF9fZmxhZ3MpIF9fZHVtbXkyOyAodm9pZCkoJl9fZHVtbXkg
PT0gJl9fZHVtbXkyKTsgMTsgfSk7IF9fZmxhZ3MgPSBhcmNoX2xvY2FsX2lycV9zYXZlKCk7
IH0gd2hpbGUgKDApOyBkbyB7ICooeyBkbyB7IGNvbnN0IHZvaWQgKl9fdnBwX3ZlcmlmeSA9
ICh0eXBlb2YoKCYoKnBlcmNwdV9jb3VudCkpICsgMCkpKCh2b2lkICopMCk7ICh2b2lkKV9f
dnBwX3ZlcmlmeTsgfSB3aGlsZSAoMCk7ICh7IHVuc2lnbmVkIGxvbmcgX19wdHI7IF9fYXNt
X18gKCIiIDogIj1yIihfX3B0cikgOiAiMCIoKHR5cGVvZigqKCYoKnBlcmNwdV9jb3VudCkp
KSAqKSgmKCpwZXJjcHVfY291bnQpKSkpOyAodHlwZW9mKCh0eXBlb2YoKigmKCpwZXJjcHVf
Y291bnQpKSkgKikoJigqcGVyY3B1X2NvdW50KSkpKSAoX19wdHIgKyAoKGxvY2FsX3BhY2Et
PmRhdGFfb2Zmc2V0KSkpOyB9KTsgfSkgKz0gMTsgfSB3aGlsZSAoMCk7IGRvIHsgKHsgdW5z
aWduZWQgbG9uZyBfX2R1bW15OyB0eXBlb2YoX19mbGFncykgX19kdW1teTI7ICh2b2lkKSgm
X19kdW1teSA9PSAmX19kdW1teTIpOyAxOyB9KTsgYXJjaF9sb2NhbF9pcnFfcmVzdG9yZShf
X2ZsYWdzKTsgfSB3aGlsZSAoMCk7IH0gd2hpbGUgKDApO2JyZWFrOyBjYXNlIDQ6IGRvIHsg
dW5zaWduZWQgbG9uZyBfX2ZsYWdzOyBkbyB7ICh7IHVuc2lnbmVkIGxvbmcgX19kdW1teTsg
dHlwZW9mKF9fZmxhZ3MpIF9fZHVtbXkyOyAodm9pZCkoJl9fZHVtbXkgPT0gJl9fZHVtbXky
KTsgMTsgfSk7IF9fZmxhZ3MgPSBhcmNoX2xvY2FsX2lycV9zYXZlKCk7IH0gd2hpbGUgKDAp
OyBkbyB7ICooeyBkbyB7IGNvbnN0IHZvaWQgKl9fdnBwX3ZlcmlmeSA9ICh0eXBlb2YoKCYo
KnBlcmNwdV9jb3VudCkpICsgMCkpKCh2b2lkICopMCk7ICh2b2lkKV9fdnBwX3ZlcmlmeTsg
fSB3aGlsZSAoMCk7ICh7IHVuc2lnbmVkIGxvbmcgX19wdHI7IF9fYXNtX18gKCIiIDogIj1y
IihfX3B0cikgOiAiMCIoKHR5cGVvZigqKCYoKnBlcmNwdV9jb3VudCkpKSAqKSgmKCpwZXJj
cHVfY291bnQpKSkpOyAodHlwZW9mKCh0eXBlb2YoKigmKCpwZXJjcHVfY291bnQpKSkgKiko
JigqcGVyY3B1X2NvdW50KSkpKSAoX19wdHIgKyAoKGxvY2FsX3BhY2EtPmRhdGFfb2Zmc2V0
KSkpOyB9KTsgfSkgKz0gMTsgfSB3aGlsZSAoMCk7IGRvIHsgKHsgdW5zaWduZWQgbG9uZyBf
X2R1bW15OyB0eXBlb2YoX19mbGFncykgX19kdW1teTI7ICh2b2lkKSgmX19kdW1teSA9PSAm
X19kdW1teTIpOyAxOyB9KTsgYXJjaF9sb2NhbF9pcnFfcmVzdG9yZShfX2ZsYWdzKTsgfSB3
aGlsZSAoMCk7IH0gd2hpbGUgKDApO2JyZWFrOyBjYXNlIDg6IGRvIHsgdW5zaWduZWQgbG9u
ZyBfX2ZsYWdzOyBkbyB7ICh7IHVuc2lnbmVkIGxvbmcgX19kdW1teTsgdHlwZW9mKF9fZmxh
Z3MpIF9fZHVtbXkyOyAodm9pZCkoJl9fZHVtbXkgPT0gJl9fZHVtbXkyKTsgMTsgfSk7IF9f
ZmxhZ3MgPSBhcmNoX2xvY2FsX2lycV9zYXZlKCk7IH0gd2hpbGUgKDApOyBkbyB7ICooeyBk
byB7IGNvbnN0IHZvaWQgKl9fdnBwX3ZlcmlmeSA9ICh0eXBlb2YoKCYoKnBlcmNwdV9jb3Vu
dCkpICsgMCkpKCh2b2lkICopMCk7ICh2b2lkKV9fdnBwX3ZlcmlmeTsgfSB3aGlsZSAoMCk7
ICh7IHVuc2lnbmVkIGxvbmcgX19wdHI7IF9fYXNtX18gKCIiIDogIj1yIihfX3B0cikgOiAi
MCIoKHR5cGVvZigqKCYoKnBlcmNwdV9jb3VudCkpKSAqKSgmKCpwZXJjcHVfY291bnQpKSkp
OyAodHlwZW9mKCh0eXBlb2YoKigmKCpwZXJjcHVfY291bnQpKSkgKikoJigqcGVyY3B1X2Nv
dW50KSkpKSAoX19wdHIgKyAoKGxvY2FsX3BhY2EtPmRhdGFfb2Zmc2V0KSkpOyB9KTsgfSkg
Kz0gMTsgfSB3aGlsZSAoMCk7IGRvIHsgKHsgdW5zaWduZWQgbG9uZyBfX2R1bW15OyB0eXBl
b2YoX19mbGFncykgX19kdW1teTI7ICh2b2lkKSgmX19kdW1teSA9PSAmX19kdW1teTIpOyAx
OyB9KTsgYXJjaF9sb2NhbF9pcnFfcmVzdG9yZShfX2ZsYWdzKTsgfSB3aGlsZSAoMCk7IH0g
d2hpbGUgKDApO2JyZWFrOyBkZWZhdWx0OiBfX2JhZF9zaXplX2NhbGxfcGFyYW1ldGVyKCk7
YnJlYWs7IH0gfSB3aGlsZSAoMCk7CiAgcmV0ID0gdHJ1ZTsKIH0gZWxzZSBpZiAoIShyZWYt
PnBlcmNwdV9jb3VudF9wdHIgJiBfX1BFUkNQVV9SRUZfREVBRCkpIHsKICByZXQgPSBhdG9t
aWNfbG9uZ19pbmNfbm90X3plcm8oJnJlZi0+Y291bnQpOwogfQoKIHJjdV9yZWFkX3VubG9j
aygpOwoKIHJldHVybiByZXQ7Cn0KIyAzMDAgIi4vaW5jbHVkZS9saW51eC9wZXJjcHUtcmVm
Y291bnQuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgcGVyY3B1X3JlZl9wdXRfbWFueShzdHJ1Y3QgcGVy
Y3B1X3JlZiAqcmVmLCB1bnNpZ25lZCBsb25nIG5yKQp7CiB1bnNpZ25lZCBsb25nICpwZXJj
cHVfY291bnQ7CgogcmN1X3JlYWRfbG9jaygpOwoKIGlmIChfX3JlZl9pc19wZXJjcHUocmVm
LCAmcGVyY3B1X2NvdW50KSkKICBkbyB7IGRvIHsgY29uc3Qgdm9pZCAqX192cHBfdmVyaWZ5
ID0gKHR5cGVvZigoJigqcGVyY3B1X2NvdW50KSkgKyAwKSkoKHZvaWQgKikwKTsgKHZvaWQp
X192cHBfdmVyaWZ5OyB9IHdoaWxlICgwKTsgc3dpdGNoKHNpemVvZigqcGVyY3B1X2NvdW50
KSkgeyBjYXNlIDE6IGRvIHsgdW5zaWduZWQgbG9uZyBfX2ZsYWdzOyBkbyB7ICh7IHVuc2ln
bmVkIGxvbmcgX19kdW1teTsgdHlwZW9mKF9fZmxhZ3MpIF9fZHVtbXkyOyAodm9pZCkoJl9f
ZHVtbXkgPT0gJl9fZHVtbXkyKTsgMTsgfSk7IF9fZmxhZ3MgPSBhcmNoX2xvY2FsX2lycV9z
YXZlKCk7IH0gd2hpbGUgKDApOyBkbyB7ICooeyBkbyB7IGNvbnN0IHZvaWQgKl9fdnBwX3Zl
cmlmeSA9ICh0eXBlb2YoKCYoKnBlcmNwdV9jb3VudCkpICsgMCkpKCh2b2lkICopMCk7ICh2
b2lkKV9fdnBwX3ZlcmlmeTsgfSB3aGlsZSAoMCk7ICh7IHVuc2lnbmVkIGxvbmcgX19wdHI7
IF9fYXNtX18gKCIiIDogIj1yIihfX3B0cikgOiAiMCIoKHR5cGVvZigqKCYoKnBlcmNwdV9j
b3VudCkpKSAqKSgmKCpwZXJjcHVfY291bnQpKSkpOyAodHlwZW9mKCh0eXBlb2YoKigmKCpw
ZXJjcHVfY291bnQpKSkgKikoJigqcGVyY3B1X2NvdW50KSkpKSAoX19wdHIgKyAoKGxvY2Fs
X3BhY2EtPmRhdGFfb2Zmc2V0KSkpOyB9KTsgfSkgKz0gLSh0eXBlb2YoKnBlcmNwdV9jb3Vu
dCkpKG5yKTsgfSB3aGlsZSAoMCk7IGRvIHsgKHsgdW5zaWduZWQgbG9uZyBfX2R1bW15OyB0
eXBlb2YoX19mbGFncykgX19kdW1teTI7ICh2b2lkKSgmX19kdW1teSA9PSAmX19kdW1teTIp
OyAxOyB9KTsgYXJjaF9sb2NhbF9pcnFfcmVzdG9yZShfX2ZsYWdzKTsgfSB3aGlsZSAoMCk7
IH0gd2hpbGUgKDApO2JyZWFrOyBjYXNlIDI6IGRvIHsgdW5zaWduZWQgbG9uZyBfX2ZsYWdz
OyBkbyB7ICh7IHVuc2lnbmVkIGxvbmcgX19kdW1teTsgdHlwZW9mKF9fZmxhZ3MpIF9fZHVt
bXkyOyAodm9pZCkoJl9fZHVtbXkgPT0gJl9fZHVtbXkyKTsgMTsgfSk7IF9fZmxhZ3MgPSBh
cmNoX2xvY2FsX2lycV9zYXZlKCk7IH0gd2hpbGUgKDApOyBkbyB7ICooeyBkbyB7IGNvbnN0
IHZvaWQgKl9fdnBwX3ZlcmlmeSA9ICh0eXBlb2YoKCYoKnBlcmNwdV9jb3VudCkpICsgMCkp
KCh2b2lkICopMCk7ICh2b2lkKV9fdnBwX3ZlcmlmeTsgfSB3aGlsZSAoMCk7ICh7IHVuc2ln
bmVkIGxvbmcgX19wdHI7IF9fYXNtX18gKCIiIDogIj1yIihfX3B0cikgOiAiMCIoKHR5cGVv
ZigqKCYoKnBlcmNwdV9jb3VudCkpKSAqKSgmKCpwZXJjcHVfY291bnQpKSkpOyAodHlwZW9m
KCh0eXBlb2YoKigmKCpwZXJjcHVfY291bnQpKSkgKikoJigqcGVyY3B1X2NvdW50KSkpKSAo
X19wdHIgKyAoKGxvY2FsX3BhY2EtPmRhdGFfb2Zmc2V0KSkpOyB9KTsgfSkgKz0gLSh0eXBl
b2YoKnBlcmNwdV9jb3VudCkpKG5yKTsgfSB3aGlsZSAoMCk7IGRvIHsgKHsgdW5zaWduZWQg
bG9uZyBfX2R1bW15OyB0eXBlb2YoX19mbGFncykgX19kdW1teTI7ICh2b2lkKSgmX19kdW1t
eSA9PSAmX19kdW1teTIpOyAxOyB9KTsgYXJjaF9sb2NhbF9pcnFfcmVzdG9yZShfX2ZsYWdz
KTsgfSB3aGlsZSAoMCk7IH0gd2hpbGUgKDApO2JyZWFrOyBjYXNlIDQ6IGRvIHsgdW5zaWdu
ZWQgbG9uZyBfX2ZsYWdzOyBkbyB7ICh7IHVuc2lnbmVkIGxvbmcgX19kdW1teTsgdHlwZW9m
KF9fZmxhZ3MpIF9fZHVtbXkyOyAodm9pZCkoJl9fZHVtbXkgPT0gJl9fZHVtbXkyKTsgMTsg
fSk7IF9fZmxhZ3MgPSBhcmNoX2xvY2FsX2lycV9zYXZlKCk7IH0gd2hpbGUgKDApOyBkbyB7
ICooeyBkbyB7IGNvbnN0IHZvaWQgKl9fdnBwX3ZlcmlmeSA9ICh0eXBlb2YoKCYoKnBlcmNw
dV9jb3VudCkpICsgMCkpKCh2b2lkICopMCk7ICh2b2lkKV9fdnBwX3ZlcmlmeTsgfSB3aGls
ZSAoMCk7ICh7IHVuc2lnbmVkIGxvbmcgX19wdHI7IF9fYXNtX18gKCIiIDogIj1yIihfX3B0
cikgOiAiMCIoKHR5cGVvZigqKCYoKnBlcmNwdV9jb3VudCkpKSAqKSgmKCpwZXJjcHVfY291
bnQpKSkpOyAodHlwZW9mKCh0eXBlb2YoKigmKCpwZXJjcHVfY291bnQpKSkgKikoJigqcGVy
Y3B1X2NvdW50KSkpKSAoX19wdHIgKyAoKGxvY2FsX3BhY2EtPmRhdGFfb2Zmc2V0KSkpOyB9
KTsgfSkgKz0gLSh0eXBlb2YoKnBlcmNwdV9jb3VudCkpKG5yKTsgfSB3aGlsZSAoMCk7IGRv
IHsgKHsgdW5zaWduZWQgbG9uZyBfX2R1bW15OyB0eXBlb2YoX19mbGFncykgX19kdW1teTI7
ICh2b2lkKSgmX19kdW1teSA9PSAmX19kdW1teTIpOyAxOyB9KTsgYXJjaF9sb2NhbF9pcnFf
cmVzdG9yZShfX2ZsYWdzKTsgfSB3aGlsZSAoMCk7IH0gd2hpbGUgKDApO2JyZWFrOyBjYXNl
IDg6IGRvIHsgdW5zaWduZWQgbG9uZyBfX2ZsYWdzOyBkbyB7ICh7IHVuc2lnbmVkIGxvbmcg
X19kdW1teTsgdHlwZW9mKF9fZmxhZ3MpIF9fZHVtbXkyOyAodm9pZCkoJl9fZHVtbXkgPT0g
Jl9fZHVtbXkyKTsgMTsgfSk7IF9fZmxhZ3MgPSBhcmNoX2xvY2FsX2lycV9zYXZlKCk7IH0g
d2hpbGUgKDApOyBkbyB7ICooeyBkbyB7IGNvbnN0IHZvaWQgKl9fdnBwX3ZlcmlmeSA9ICh0
eXBlb2YoKCYoKnBlcmNwdV9jb3VudCkpICsgMCkpKCh2b2lkICopMCk7ICh2b2lkKV9fdnBw
X3ZlcmlmeTsgfSB3aGlsZSAoMCk7ICh7IHVuc2lnbmVkIGxvbmcgX19wdHI7IF9fYXNtX18g
KCIiIDogIj1yIihfX3B0cikgOiAiMCIoKHR5cGVvZigqKCYoKnBlcmNwdV9jb3VudCkpKSAq
KSgmKCpwZXJjcHVfY291bnQpKSkpOyAodHlwZW9mKCh0eXBlb2YoKigmKCpwZXJjcHVfY291
bnQpKSkgKikoJigqcGVyY3B1X2NvdW50KSkpKSAoX19wdHIgKyAoKGxvY2FsX3BhY2EtPmRh
dGFfb2Zmc2V0KSkpOyB9KTsgfSkgKz0gLSh0eXBlb2YoKnBlcmNwdV9jb3VudCkpKG5yKTsg
fSB3aGlsZSAoMCk7IGRvIHsgKHsgdW5zaWduZWQgbG9uZyBfX2R1bW15OyB0eXBlb2YoX19m
bGFncykgX19kdW1teTI7ICh2b2lkKSgmX19kdW1teSA9PSAmX19kdW1teTIpOyAxOyB9KTsg
YXJjaF9sb2NhbF9pcnFfcmVzdG9yZShfX2ZsYWdzKTsgfSB3aGlsZSAoMCk7IH0gd2hpbGUg
KDApO2JyZWFrOyBkZWZhdWx0OiBfX2JhZF9zaXplX2NhbGxfcGFyYW1ldGVyKCk7YnJlYWs7
IH0gfSB3aGlsZSAoMCk7CiBlbHNlIGlmIChfX2J1aWx0aW5fZXhwZWN0KCEhKGF0b21pY19s
b25nX3N1Yl9hbmRfdGVzdChuciwgJnJlZi0+Y291bnQpKSwgMCkpCiAgcmVmLT5yZWxlYXNl
KHJlZik7CgogcmN1X3JlYWRfdW5sb2NrKCk7Cn0KIyAzMjMgIi4vaW5jbHVkZS9saW51eC9w
ZXJjcHUtcmVmY291bnQuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgcGVyY3B1X3JlZl9wdXQoc3RydWN0
IHBlcmNwdV9yZWYgKnJlZikKewogcGVyY3B1X3JlZl9wdXRfbWFueShyZWYsIDEpOwp9CiMg
MzM3ICIuL2luY2x1ZGUvbGludXgvcGVyY3B1LXJlZmNvdW50LmgiCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29s
IHBlcmNwdV9yZWZfaXNfZHlpbmcoc3RydWN0IHBlcmNwdV9yZWYgKnJlZikKewogcmV0dXJu
IHJlZi0+cGVyY3B1X2NvdW50X3B0ciAmIF9fUEVSQ1BVX1JFRl9ERUFEOwp9CiMgMzUwICIu
L2luY2x1ZGUvbGludXgvcGVyY3B1LXJlZmNvdW50LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIHBlcmNw
dV9yZWZfaXNfemVybyhzdHJ1Y3QgcGVyY3B1X3JlZiAqcmVmKQp7CiB1bnNpZ25lZCBsb25n
ICpwZXJjcHVfY291bnQ7CgogaWYgKF9fcmVmX2lzX3BlcmNwdShyZWYsICZwZXJjcHVfY291
bnQpKQogIHJldHVybiBmYWxzZTsKIHJldHVybiAhYXRvbWljX2xvbmdfcmVhZCgmcmVmLT5j
b3VudCk7Cn0KIyAyMiAiLi9pbmNsdWRlL2xpbnV4L21tLmgiIDIKIyAxICIuL2luY2x1ZGUv
bGludXgvYml0X3NwaW5sb2NrLmgiIDEKIyAxNiAiLi9pbmNsdWRlL2xpbnV4L2JpdF9zcGlu
bG9jay5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBiaXRfc3Bpbl9sb2NrKGludCBiaXRudW0sIHVuc2ln
bmVkIGxvbmcgKmFkZHIpCnsKCgoKCgoKCiBfX2FzbV9fIF9fdm9sYXRpbGVfXygiIjogOiA6
Im1lbW9yeSIpOwoKIHdoaWxlIChfX2J1aWx0aW5fZXhwZWN0KCEhKHRlc3RfYW5kX3NldF9i
aXRfbG9jayhiaXRudW0sIGFkZHIpKSwgMCkpIHsKICBfX2FzbV9fIF9fdm9sYXRpbGVfXygi
IjogOiA6Im1lbW9yeSIpOwogIGRvIHsKICAgZG8geyBhc20gdm9sYXRpbGUoIm9yIDEsMSwx
CSAgICAgIyBsb3cgcHJpb3JpdHkiKTsgYXNtIHZvbGF0aWxlKCJvciAyLDIsMgkgICAgICMg
bWVkaXVtIHByaW9yaXR5Iik7IF9fYXNtX18gX192b2xhdGlsZV9fKCIiOiA6IDoibWVtb3J5
Iik7IH0gd2hpbGUgKDApOwogIH0gd2hpbGUgKHRlc3RfYml0KGJpdG51bSwgYWRkcikpOwog
IF9fYXNtX18gX192b2xhdGlsZV9fKCIiOiA6IDoibWVtb3J5Iik7CiB9CgogKHZvaWQpMDsK
fQoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIGludCBiaXRfc3Bpbl90cnlsb2NrKGludCBiaXRudW0sIHVuc2ln
bmVkIGxvbmcgKmFkZHIpCnsKIF9fYXNtX18gX192b2xhdGlsZV9fKCIiOiA6IDoibWVtb3J5
Iik7CgogaWYgKF9fYnVpbHRpbl9leHBlY3QoISEodGVzdF9hbmRfc2V0X2JpdF9sb2NrKGJp
dG51bSwgYWRkcikpLCAwKSkgewogIF9fYXNtX18gX192b2xhdGlsZV9fKCIiOiA6IDoibWVt
b3J5Iik7CiAgcmV0dXJuIDA7CiB9CgogKHZvaWQpMDsKIHJldHVybiAxOwp9CgoKCgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgdm9pZCBiaXRfc3Bpbl91bmxvY2soaW50IGJpdG51bSwgdW5zaWduZWQgbG9uZyAq
YWRkcikKewoKCgoKIGNsZWFyX2JpdF91bmxvY2soYml0bnVtLCBhZGRyKTsKCiBfX2FzbV9f
IF9fdm9sYXRpbGVfXygiIjogOiA6Im1lbW9yeSIpOwogKHZvaWQpMDsKfQoKCgoKCgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgdm9pZCBfX2JpdF9zcGluX3VubG9jayhpbnQgYml0bnVtLCB1bnNpZ25lZCBsb25n
ICphZGRyKQp7CgoKCgogX19jbGVhcl9iaXRfdW5sb2NrKGJpdG51bSwgYWRkcik7CgogX19h
c21fXyBfX3ZvbGF0aWxlX18oIiI6IDogOiJtZW1vcnkiKTsKICh2b2lkKTA7Cn0KCgoKCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSBpbnQgYml0X3NwaW5faXNfbG9ja2VkKGludCBiaXRudW0sIHVuc2lnbmVkIGxv
bmcgKmFkZHIpCnsKCiByZXR1cm4gdGVzdF9iaXQoYml0bnVtLCBhZGRyKTsKCgoKCgp9CiMg
MjMgIi4vaW5jbHVkZS9saW51eC9tbS5oIiAyCiMgMSAiLi9pbmNsdWRlL2xpbnV4L3Nocmlu
a2VyLmgiIDEKIyAxMiAiLi9pbmNsdWRlL2xpbnV4L3Nocmlua2VyLmgiCnN0cnVjdCBzaHJp
bmtfY29udHJvbCB7CiBnZnBfdCBnZnBfbWFzazsKCgogaW50IG5pZDsKCgoKCgoKIHVuc2ln
bmVkIGxvbmcgbnJfdG9fc2NhbjsKCgoKCgoKIHVuc2lnbmVkIGxvbmcgbnJfc2Nhbm5lZDsK
Cgogc3RydWN0IG1lbV9jZ3JvdXAgKm1lbWNnOwp9OwojIDYwICIuL2luY2x1ZGUvbGludXgv
c2hyaW5rZXIuaCIKc3RydWN0IHNocmlua2VyIHsKIHVuc2lnbmVkIGxvbmcgKCpjb3VudF9v
YmplY3RzKShzdHJ1Y3Qgc2hyaW5rZXIgKiwKICAgICAgICAgICBzdHJ1Y3Qgc2hyaW5rX2Nv
bnRyb2wgKnNjKTsKIHVuc2lnbmVkIGxvbmcgKCpzY2FuX29iamVjdHMpKHN0cnVjdCBzaHJp
bmtlciAqLAogICAgICAgICAgc3RydWN0IHNocmlua19jb250cm9sICpzYyk7CgogbG9uZyBi
YXRjaDsKIGludCBzZWVrczsKIHVuc2lnbmVkIGZsYWdzOwoKCiBzdHJ1Y3QgbGlzdF9oZWFk
IGxpc3Q7CgoKCgoKIGF0b21pY19sb25nX3QgKm5yX2RlZmVycmVkOwp9OwojIDkwICIuL2lu
Y2x1ZGUvbGludXgvc2hyaW5rZXIuaCIKZXh0ZXJuIGludCBwcmVhbGxvY19zaHJpbmtlcihz
dHJ1Y3Qgc2hyaW5rZXIgKnNocmlua2VyKTsKZXh0ZXJuIHZvaWQgcmVnaXN0ZXJfc2hyaW5r
ZXJfcHJlcGFyZWQoc3RydWN0IHNocmlua2VyICpzaHJpbmtlcik7CmV4dGVybiBpbnQgcmVn
aXN0ZXJfc2hyaW5rZXIoc3RydWN0IHNocmlua2VyICpzaHJpbmtlcik7CmV4dGVybiB2b2lk
IHVucmVnaXN0ZXJfc2hyaW5rZXIoc3RydWN0IHNocmlua2VyICpzaHJpbmtlcik7CmV4dGVy
biB2b2lkIGZyZWVfcHJlYWxsb2NlZF9zaHJpbmtlcihzdHJ1Y3Qgc2hyaW5rZXIgKnNocmlu
a2VyKTsKIyAyNCAiLi9pbmNsdWRlL2xpbnV4L21tLmgiIDIKCiMgMSAiLi9pbmNsdWRlL2xp
bnV4L3BhZ2VfZXh0LmgiIDEKCgoKCgojIDEgIi4vaW5jbHVkZS9saW51eC9zdGFja3RyYWNl
LmgiIDEKCgoKCgoKCnN0cnVjdCB0YXNrX3N0cnVjdDsKc3RydWN0IHB0X3JlZ3M7CgoKdm9p
ZCBzdGFja190cmFjZV9wcmludChjb25zdCB1bnNpZ25lZCBsb25nICp0cmFjZSwgdW5zaWdu
ZWQgaW50IG5yX2VudHJpZXMsCiAgICAgICAgIGludCBzcGFjZXMpOwppbnQgc3RhY2tfdHJh
Y2Vfc25wcmludChjaGFyICpidWYsIHNpemVfdCBzaXplLCBjb25zdCB1bnNpZ25lZCBsb25n
ICplbnRyaWVzLAogICB1bnNpZ25lZCBpbnQgbnJfZW50cmllcywgaW50IHNwYWNlcyk7CnVu
c2lnbmVkIGludCBzdGFja190cmFjZV9zYXZlKHVuc2lnbmVkIGxvbmcgKnN0b3JlLCB1bnNp
Z25lZCBpbnQgc2l6ZSwKICAgICAgICAgdW5zaWduZWQgaW50IHNraXBucik7CnVuc2lnbmVk
IGludCBzdGFja190cmFjZV9zYXZlX3RzayhzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRhc2ssCiAg
ICAgIHVuc2lnbmVkIGxvbmcgKnN0b3JlLCB1bnNpZ25lZCBpbnQgc2l6ZSwKICAgICAgdW5z
aWduZWQgaW50IHNraXBucik7CnVuc2lnbmVkIGludCBzdGFja190cmFjZV9zYXZlX3JlZ3Mo
c3RydWN0IHB0X3JlZ3MgKnJlZ3MsIHVuc2lnbmVkIGxvbmcgKnN0b3JlLAogICAgICAgdW5z
aWduZWQgaW50IHNpemUsIHVuc2lnbmVkIGludCBza2lwbnIpOwp1bnNpZ25lZCBpbnQgc3Rh
Y2tfdHJhY2Vfc2F2ZV91c2VyKHVuc2lnbmVkIGxvbmcgKnN0b3JlLCB1bnNpZ25lZCBpbnQg
c2l6ZSk7CiMgNjQgIi4vaW5jbHVkZS9saW51eC9zdGFja3RyYWNlLmgiCnN0cnVjdCBzdGFj
a190cmFjZSB7CiB1bnNpZ25lZCBpbnQgbnJfZW50cmllcywgbWF4X2VudHJpZXM7CiB1bnNp
Z25lZCBsb25nICplbnRyaWVzOwogdW5zaWduZWQgaW50IHNraXA7Cn07CgpleHRlcm4gdm9p
ZCBzYXZlX3N0YWNrX3RyYWNlKHN0cnVjdCBzdGFja190cmFjZSAqdHJhY2UpOwpleHRlcm4g
dm9pZCBzYXZlX3N0YWNrX3RyYWNlX3JlZ3Moc3RydWN0IHB0X3JlZ3MgKnJlZ3MsCiAgICAg
IHN0cnVjdCBzdGFja190cmFjZSAqdHJhY2UpOwpleHRlcm4gdm9pZCBzYXZlX3N0YWNrX3Ry
YWNlX3RzayhzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRzaywKICAgIHN0cnVjdCBzdGFja190cmFj
ZSAqdHJhY2UpOwpleHRlcm4gaW50IHNhdmVfc3RhY2tfdHJhY2VfdHNrX3JlbGlhYmxlKHN0
cnVjdCB0YXNrX3N0cnVjdCAqdHNrLAogICAgICBzdHJ1Y3Qgc3RhY2tfdHJhY2UgKnRyYWNl
KTsKZXh0ZXJuIHZvaWQgc2F2ZV9zdGFja190cmFjZV91c2VyKHN0cnVjdCBzdGFja190cmFj
ZSAqdHJhY2UpOwoKCgoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBzdGFja190cmFjZV9zYXZlX3Rza19y
ZWxpYWJsZShzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRzaywKICAgICAgdW5zaWduZWQgbG9uZyAq
c3RvcmUsCiAgICAgIHVuc2lnbmVkIGludCBzaXplKQp7CiByZXR1cm4gLTM4Owp9CiMgNyAi
Li9pbmNsdWRlL2xpbnV4L3BhZ2VfZXh0LmgiIDIKIyAxICIuL2luY2x1ZGUvbGludXgvc3Rh
Y2tkZXBvdC5oIiAxCiMgMTQgIi4vaW5jbHVkZS9saW51eC9zdGFja2RlcG90LmgiCnR5cGVk
ZWYgdTMyIGRlcG90X3N0YWNrX2hhbmRsZV90OwoKZGVwb3Rfc3RhY2tfaGFuZGxlX3Qgc3Rh
Y2tfZGVwb3Rfc2F2ZSh1bnNpZ25lZCBsb25nICplbnRyaWVzLAogICAgICAgICAgdW5zaWdu
ZWQgaW50IG5yX2VudHJpZXMsIGdmcF90IGdmcF9mbGFncyk7Cgp1bnNpZ25lZCBpbnQgc3Rh
Y2tfZGVwb3RfZmV0Y2goZGVwb3Rfc3RhY2tfaGFuZGxlX3QgaGFuZGxlLAogICAgICAgICAg
dW5zaWduZWQgbG9uZyAqKmVudHJpZXMpOwoKdW5zaWduZWQgaW50IGZpbHRlcl9pcnFfc3Rh
Y2tzKHVuc2lnbmVkIGxvbmcgKmVudHJpZXMsIHVuc2lnbmVkIGludCBucl9lbnRyaWVzKTsK
IyA4ICIuL2luY2x1ZGUvbGludXgvcGFnZV9leHQuaCIgMgoKc3RydWN0IHBnbGlzdF9kYXRh
OwpzdHJ1Y3QgcGFnZV9leHRfb3BlcmF0aW9ucyB7CiBzaXplX3Qgb2Zmc2V0Owogc2l6ZV90
IHNpemU7CiBib29sICgqbmVlZCkodm9pZCk7CiB2b2lkICgqaW5pdCkodm9pZCk7Cn07CiMg
NjQgIi4vaW5jbHVkZS9saW51eC9wYWdlX2V4dC5oIgpzdHJ1Y3QgcGFnZV9leHQ7CgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgdm9pZCBwZ2RhdF9wYWdlX2V4dF9pbml0KHN0cnVjdCBwZ2xpc3RfZGF0YSAqcGdk
YXQpCnsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHN0cnVjdCBwYWdlX2V4dCAqbG9va3VwX3BhZ2VfZXh0KGNv
bnN0IHN0cnVjdCBwYWdlICpwYWdlKQp7CiByZXR1cm4gKCh2b2lkICopMCk7Cn0KCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSB2b2lkIHBhZ2VfZXh0X2luaXQodm9pZCkKewp9CgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBwYWdl
X2V4dF9pbml0X2ZsYXRtZW0odm9pZCkKewp9CiMgMjYgIi4vaW5jbHVkZS9saW51eC9tbS5o
IiAyCgojIDEgIi4vaW5jbHVkZS9saW51eC9wYWdlX3JlZi5oIiAxCgoKCgoKCgojIDEgIi4v
aW5jbHVkZS9saW51eC90cmFjZXBvaW50LWRlZnMuaCIgMQojIDEyICIuL2luY2x1ZGUvbGlu
dXgvdHJhY2Vwb2ludC1kZWZzLmgiCiMgMSAiLi9pbmNsdWRlL2xpbnV4L3N0YXRpY19rZXku
aCIgMQojIDEzICIuL2luY2x1ZGUvbGludXgvdHJhY2Vwb2ludC1kZWZzLmgiIDIKCnN0cnVj
dCB0cmFjZV9wcmludF9mbGFncyB7CiB1bnNpZ25lZCBsb25nIG1hc2s7CiBjb25zdCBjaGFy
ICpuYW1lOwp9OwoKc3RydWN0IHRyYWNlX3ByaW50X2ZsYWdzX3U2NCB7CiB1bnNpZ25lZCBs
b25nIGxvbmcgbWFzazsKIGNvbnN0IGNoYXIgKm5hbWU7Cn07CgpzdHJ1Y3QgdHJhY2Vwb2lu
dF9mdW5jIHsKIHZvaWQgKmZ1bmM7CiB2b2lkICpkYXRhOwogaW50IHByaW87Cn07CgpzdHJ1
Y3QgdHJhY2Vwb2ludCB7CiBjb25zdCBjaGFyICpuYW1lOwogc3RydWN0IHN0YXRpY19rZXkg
a2V5OwogaW50ICgqcmVnZnVuYykodm9pZCk7CiB2b2lkICgqdW5yZWdmdW5jKSh2b2lkKTsK
IHN0cnVjdCB0cmFjZXBvaW50X2Z1bmMgKmZ1bmNzOwp9OwoKCgoKdHlwZWRlZiBzdHJ1Y3Qg
dHJhY2Vwb2ludCAqIGNvbnN0IHRyYWNlcG9pbnRfcHRyX3Q7CgoKc3RydWN0IGJwZl9yYXdf
ZXZlbnRfbWFwIHsKIHN0cnVjdCB0cmFjZXBvaW50ICp0cDsKIHZvaWQgKmJwZl9mdW5jOwog
dTMyIG51bV9hcmdzOwogdTMyIHdyaXRhYmxlX3NpemU7Cn0gX19hdHRyaWJ1dGVfXygoX19h
bGlnbmVkX18oMzIpKSk7CiMgOSAiLi9pbmNsdWRlL2xpbnV4L3BhZ2VfcmVmLmgiIDIKCmV4
dGVybiBzdHJ1Y3QgdHJhY2Vwb2ludCBfX3RyYWNlcG9pbnRfcGFnZV9yZWZfc2V0OwpleHRl
cm4gc3RydWN0IHRyYWNlcG9pbnQgX190cmFjZXBvaW50X3BhZ2VfcmVmX21vZDsKZXh0ZXJu
IHN0cnVjdCB0cmFjZXBvaW50IF9fdHJhY2Vwb2ludF9wYWdlX3JlZl9tb2RfYW5kX3Rlc3Q7
CmV4dGVybiBzdHJ1Y3QgdHJhY2Vwb2ludCBfX3RyYWNlcG9pbnRfcGFnZV9yZWZfbW9kX2Fu
ZF9yZXR1cm47CmV4dGVybiBzdHJ1Y3QgdHJhY2Vwb2ludCBfX3RyYWNlcG9pbnRfcGFnZV9y
ZWZfbW9kX3VubGVzczsKZXh0ZXJuIHN0cnVjdCB0cmFjZXBvaW50IF9fdHJhY2Vwb2ludF9w
YWdlX3JlZl9mcmVlemU7CmV4dGVybiBzdHJ1Y3QgdHJhY2Vwb2ludCBfX3RyYWNlcG9pbnRf
cGFnZV9yZWZfdW5mcmVlemU7CiMgNDEgIi4vaW5jbHVkZS9saW51eC9wYWdlX3JlZi5oIgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgdm9pZCBfX3BhZ2VfcmVmX3NldChzdHJ1Y3QgcGFnZSAqcGFnZSwgaW50IHYp
CnsKfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgdm9pZCBfX3BhZ2VfcmVmX21vZChzdHJ1Y3QgcGFnZSAqcGFnZSwg
aW50IHYpCnsKfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBfX3BhZ2VfcmVmX21vZF9hbmRfdGVzdChzdHJ1
Y3QgcGFnZSAqcGFnZSwgaW50IHYsIGludCByZXQpCnsKfQpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBfX3Bh
Z2VfcmVmX21vZF9hbmRfcmV0dXJuKHN0cnVjdCBwYWdlICpwYWdlLCBpbnQgdiwgaW50IHJl
dCkKewp9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSB2b2lkIF9fcGFnZV9yZWZfbW9kX3VubGVzcyhzdHJ1Y3QgcGFn
ZSAqcGFnZSwgaW50IHYsIGludCB1KQp7Cn0Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgX19wYWdlX3JlZl9m
cmVlemUoc3RydWN0IHBhZ2UgKnBhZ2UsIGludCB2LCBpbnQgcmV0KQp7Cn0Kc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IHZvaWQgX19wYWdlX3JlZl91bmZyZWV6ZShzdHJ1Y3QgcGFnZSAqcGFnZSwgaW50IHYpCnsK
fQoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgaW50IHBhZ2VfcmVmX2NvdW50KHN0cnVjdCBwYWdlICpwYWdlKQp7
CiByZXR1cm4gYXRvbWljX3JlYWQoJnBhZ2UtPl9yZWZjb3VudCk7Cn0KCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBp
bnQgcGFnZV9jb3VudChzdHJ1Y3QgcGFnZSAqcGFnZSkKewogcmV0dXJuIGF0b21pY19yZWFk
KCZjb21wb3VuZF9oZWFkKHBhZ2UpLT5fcmVmY291bnQpOwp9CgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBz
ZXRfcGFnZV9jb3VudChzdHJ1Y3QgcGFnZSAqcGFnZSwgaW50IHYpCnsKIGF0b21pY19zZXQo
JnBhZ2UtPl9yZWZjb3VudCwgdik7CiBpZiAoZmFsc2UpCiAgX19wYWdlX3JlZl9zZXQocGFn
ZSwgdik7Cn0KCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBpbml0X3BhZ2VfY291bnQoc3RydWN0IHBh
Z2UgKnBhZ2UpCnsKIHNldF9wYWdlX2NvdW50KHBhZ2UsIDEpOwp9CgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9p
ZCBwYWdlX3JlZl9hZGQoc3RydWN0IHBhZ2UgKnBhZ2UsIGludCBucikKewogYXRvbWljX2Fk
ZChuciwgJnBhZ2UtPl9yZWZjb3VudCk7CiBpZiAoZmFsc2UpCiAgX19wYWdlX3JlZl9tb2Qo
cGFnZSwgbnIpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBwYWdlX3JlZl9zdWIoc3RydWN0IHBhZ2Ug
KnBhZ2UsIGludCBucikKewogYXRvbWljX3N1YihuciwgJnBhZ2UtPl9yZWZjb3VudCk7CiBp
ZiAoZmFsc2UpCiAgX19wYWdlX3JlZl9tb2QocGFnZSwgLW5yKTsKfQoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGlu
dCBwYWdlX3JlZl9zdWJfcmV0dXJuKHN0cnVjdCBwYWdlICpwYWdlLCBpbnQgbnIpCnsKIGlu
dCByZXQgPSBhdG9taWNfc3ViX3JldHVybihuciwgJnBhZ2UtPl9yZWZjb3VudCk7CgogaWYg
KGZhbHNlKQogIF9fcGFnZV9yZWZfbW9kX2FuZF9yZXR1cm4ocGFnZSwgLW5yLCByZXQpOwog
cmV0dXJuIHJldDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgcGFnZV9yZWZfaW5jKHN0cnVjdCBwYWdl
ICpwYWdlKQp7CiBhdG9taWNfaW5jKCZwYWdlLT5fcmVmY291bnQpOwogaWYgKGZhbHNlKQog
IF9fcGFnZV9yZWZfbW9kKHBhZ2UsIDEpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBwYWdlX3JlZl9k
ZWMoc3RydWN0IHBhZ2UgKnBhZ2UpCnsKIGF0b21pY19kZWMoJnBhZ2UtPl9yZWZjb3VudCk7
CiBpZiAoZmFsc2UpCiAgX19wYWdlX3JlZl9tb2QocGFnZSwgLTEpOwp9CgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
aW50IHBhZ2VfcmVmX3N1Yl9hbmRfdGVzdChzdHJ1Y3QgcGFnZSAqcGFnZSwgaW50IG5yKQp7
CiBpbnQgcmV0ID0gYXRvbWljX3N1Yl9hbmRfdGVzdChuciwgJnBhZ2UtPl9yZWZjb3VudCk7
CgogaWYgKGZhbHNlKQogIF9fcGFnZV9yZWZfbW9kX2FuZF90ZXN0KHBhZ2UsIC1uciwgcmV0
KTsKIHJldHVybiByZXQ7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgcGFnZV9yZWZfaW5jX3JldHVybihz
dHJ1Y3QgcGFnZSAqcGFnZSkKewogaW50IHJldCA9IGF0b21pY19pbmNfcmV0dXJuKCZwYWdl
LT5fcmVmY291bnQpOwoKIGlmIChmYWxzZSkKICBfX3BhZ2VfcmVmX21vZF9hbmRfcmV0dXJu
KHBhZ2UsIDEsIHJldCk7CiByZXR1cm4gcmV0Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHBhZ2VfcmVm
X2RlY19hbmRfdGVzdChzdHJ1Y3QgcGFnZSAqcGFnZSkKewogaW50IHJldCA9IGF0b21pY19k
ZWNfYW5kX3Rlc3QoJnBhZ2UtPl9yZWZjb3VudCk7CgogaWYgKGZhbHNlKQogIF9fcGFnZV9y
ZWZfbW9kX2FuZF90ZXN0KHBhZ2UsIC0xLCByZXQpOwogcmV0dXJuIHJldDsKfQoKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIGludCBwYWdlX3JlZl9kZWNfcmV0dXJuKHN0cnVjdCBwYWdlICpwYWdlKQp7CiBpbnQg
cmV0ID0gYXRvbWljX2RlY19yZXR1cm4oJnBhZ2UtPl9yZWZjb3VudCk7CgogaWYgKGZhbHNl
KQogIF9fcGFnZV9yZWZfbW9kX2FuZF9yZXR1cm4ocGFnZSwgLTEsIHJldCk7CiByZXR1cm4g
cmV0Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgaW50IHBhZ2VfcmVmX2FkZF91bmxlc3Moc3RydWN0IHBhZ2Ug
KnBhZ2UsIGludCBuciwgaW50IHUpCnsKIGludCByZXQgPSBhdG9taWNfYWRkX3VubGVzcygm
cGFnZS0+X3JlZmNvdW50LCBuciwgdSk7CgogaWYgKGZhbHNlKQogIF9fcGFnZV9yZWZfbW9k
X3VubGVzcyhwYWdlLCBuciwgcmV0KTsKIHJldHVybiByZXQ7Cn0KCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQg
cGFnZV9yZWZfZnJlZXplKHN0cnVjdCBwYWdlICpwYWdlLCBpbnQgY291bnQpCnsKIGludCBy
ZXQgPSBfX2J1aWx0aW5fZXhwZWN0KCEhKCgoeyBfX3R5cGVvZl9fKCooJigoJnBhZ2UtPl9y
ZWZjb3VudCktPmNvdW50ZXIpKSkgX29fID0gKChjb3VudCkpOyBfX3R5cGVvZl9fKCooJigo
JnBhZ2UtPl9yZWZjb3VudCktPmNvdW50ZXIpKSkgX25fID0gKCgwKSk7IChfX3R5cGVvZl9f
KCooJigoJnBhZ2UtPl9yZWZjb3VudCktPmNvdW50ZXIpKSkpIF9fY21weGNoZygoJigoJnBh
Z2UtPl9yZWZjb3VudCktPmNvdW50ZXIpKSwgKHVuc2lnbmVkIGxvbmcpX29fLCAodW5zaWdu
ZWQgbG9uZylfbl8sIHNpemVvZigqKCYoKCZwYWdlLT5fcmVmY291bnQpLT5jb3VudGVyKSkp
KTsgfSkpID09IGNvdW50KSwgMSk7CgogaWYgKGZhbHNlKQogIF9fcGFnZV9yZWZfZnJlZXpl
KHBhZ2UsIGNvdW50LCByZXQpOwogcmV0dXJuIHJldDsKfQoKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgcGFn
ZV9yZWZfdW5mcmVlemUoc3RydWN0IHBhZ2UgKnBhZ2UsIGludCBjb3VudCkKewogKCh2b2lk
KShzaXplb2YoKCBsb25nKShwYWdlX2NvdW50KHBhZ2UpICE9IDApKSkpOwogKCh2b2lkKShz
aXplb2YoKCBsb25nKShjb3VudCA9PSAwKSkpKTsKCiBhdG9taWNfc2V0X3JlbGVhc2UoJnBh
Z2UtPl9yZWZjb3VudCwgY291bnQpOwogaWYgKGZhbHNlKQogIF9fcGFnZV9yZWZfdW5mcmVl
emUocGFnZSwgY291bnQpOwp9CiMgMjggIi4vaW5jbHVkZS9saW51eC9tbS5oIiAyCiMgMSAi
Li9pbmNsdWRlL2xpbnV4L21lbXJlbWFwLmgiIDEKCgoKIyAxICIuL2luY2x1ZGUvbGludXgv
aW9wb3J0LmgiIDEKIyAyMCAiLi9pbmNsdWRlL2xpbnV4L2lvcG9ydC5oIgpzdHJ1Y3QgcmVz
b3VyY2UgewogcmVzb3VyY2Vfc2l6ZV90IHN0YXJ0OwogcmVzb3VyY2Vfc2l6ZV90IGVuZDsK
IGNvbnN0IGNoYXIgKm5hbWU7CiB1bnNpZ25lZCBsb25nIGZsYWdzOwogdW5zaWduZWQgbG9u
ZyBkZXNjOwogc3RydWN0IHJlc291cmNlICpwYXJlbnQsICpzaWJsaW5nLCAqY2hpbGQ7Cn07
CiMgMTI5ICIuL2luY2x1ZGUvbGludXgvaW9wb3J0LmgiCmVudW0gewogSU9SRVNfREVTQ19O
T05FID0gMCwKIElPUkVTX0RFU0NfQ1JBU0hfS0VSTkVMID0gMSwKIElPUkVTX0RFU0NfQUNQ
SV9UQUJMRVMgPSAyLAogSU9SRVNfREVTQ19BQ1BJX05WX1NUT1JBR0UgPSAzLAogSU9SRVNf
REVTQ19QRVJTSVNURU5UX01FTU9SWSA9IDQsCiBJT1JFU19ERVNDX1BFUlNJU1RFTlRfTUVN
T1JZX0xFR0FDWSA9IDUsCiBJT1JFU19ERVNDX0RFVklDRV9QUklWQVRFX01FTU9SWSA9IDYs
CiBJT1JFU19ERVNDX1JFU0VSVkVEID0gNywKIElPUkVTX0RFU0NfU09GVF9SRVNFUlZFRCA9
IDgsCn07CgoKCgplbnVtIHsKIElPUkVTX01BUF9TWVNURU1fUkFNID0gKCgoKDFVTCkpKSA8
PCAoMCkpLAogSU9SRVNfTUFQX0VOQ1JZUFRFRCA9ICgoKCgxVUwpKSkgPDwgKDEpKSwKfTsK
IyAxODAgIi4vaW5jbHVkZS9saW51eC9pb3BvcnQuaCIKZXh0ZXJuIHN0cnVjdCByZXNvdXJj
ZSBpb3BvcnRfcmVzb3VyY2U7CmV4dGVybiBzdHJ1Y3QgcmVzb3VyY2UgaW9tZW1fcmVzb3Vy
Y2U7CgpleHRlcm4gc3RydWN0IHJlc291cmNlICpyZXF1ZXN0X3Jlc291cmNlX2NvbmZsaWN0
KHN0cnVjdCByZXNvdXJjZSAqcm9vdCwgc3RydWN0IHJlc291cmNlICpuZXcpOwpleHRlcm4g
aW50IHJlcXVlc3RfcmVzb3VyY2Uoc3RydWN0IHJlc291cmNlICpyb290LCBzdHJ1Y3QgcmVz
b3VyY2UgKm5ldyk7CmV4dGVybiBpbnQgcmVsZWFzZV9yZXNvdXJjZShzdHJ1Y3QgcmVzb3Vy
Y2UgKm5ldyk7CnZvaWQgcmVsZWFzZV9jaGlsZF9yZXNvdXJjZXMoc3RydWN0IHJlc291cmNl
ICpuZXcpOwpleHRlcm4gdm9pZCByZXNlcnZlX3JlZ2lvbl93aXRoX3NwbGl0KHN0cnVjdCBy
ZXNvdXJjZSAqcm9vdCwKICAgICAgICByZXNvdXJjZV9zaXplX3Qgc3RhcnQsIHJlc291cmNl
X3NpemVfdCBlbmQsCiAgICAgICAgY29uc3QgY2hhciAqbmFtZSk7CmV4dGVybiBzdHJ1Y3Qg
cmVzb3VyY2UgKmluc2VydF9yZXNvdXJjZV9jb25mbGljdChzdHJ1Y3QgcmVzb3VyY2UgKnBh
cmVudCwgc3RydWN0IHJlc291cmNlICpuZXcpOwpleHRlcm4gaW50IGluc2VydF9yZXNvdXJj
ZShzdHJ1Y3QgcmVzb3VyY2UgKnBhcmVudCwgc3RydWN0IHJlc291cmNlICpuZXcpOwpleHRl
cm4gdm9pZCBpbnNlcnRfcmVzb3VyY2VfZXhwYW5kX3RvX2ZpdChzdHJ1Y3QgcmVzb3VyY2Ug
KnJvb3QsIHN0cnVjdCByZXNvdXJjZSAqbmV3KTsKZXh0ZXJuIGludCByZW1vdmVfcmVzb3Vy
Y2Uoc3RydWN0IHJlc291cmNlICpvbGQpOwpleHRlcm4gdm9pZCBhcmNoX3JlbW92ZV9yZXNl
cnZhdGlvbnMoc3RydWN0IHJlc291cmNlICphdmFpbCk7CmV4dGVybiBpbnQgYWxsb2NhdGVf
cmVzb3VyY2Uoc3RydWN0IHJlc291cmNlICpyb290LCBzdHJ1Y3QgcmVzb3VyY2UgKm5ldywK
ICAgICAgICByZXNvdXJjZV9zaXplX3Qgc2l6ZSwgcmVzb3VyY2Vfc2l6ZV90IG1pbiwKICAg
ICAgICByZXNvdXJjZV9zaXplX3QgbWF4LCByZXNvdXJjZV9zaXplX3QgYWxpZ24sCiAgICAg
ICAgcmVzb3VyY2Vfc2l6ZV90ICgqYWxpZ25mKSh2b2lkICosCiAgICAgICAgICAgICBjb25z
dCBzdHJ1Y3QgcmVzb3VyY2UgKiwKICAgICAgICAgICAgIHJlc291cmNlX3NpemVfdCwKICAg
ICAgICAgICAgIHJlc291cmNlX3NpemVfdCksCiAgICAgICAgdm9pZCAqYWxpZ25mX2RhdGEp
OwpzdHJ1Y3QgcmVzb3VyY2UgKmxvb2t1cF9yZXNvdXJjZShzdHJ1Y3QgcmVzb3VyY2UgKnJv
b3QsIHJlc291cmNlX3NpemVfdCBzdGFydCk7CmludCBhZGp1c3RfcmVzb3VyY2Uoc3RydWN0
IHJlc291cmNlICpyZXMsIHJlc291cmNlX3NpemVfdCBzdGFydCwKICAgICAgcmVzb3VyY2Vf
c2l6ZV90IHNpemUpOwpyZXNvdXJjZV9zaXplX3QgcmVzb3VyY2VfYWxpZ25tZW50KHN0cnVj
dCByZXNvdXJjZSAqcmVzKTsKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHJlc291cmNlX3NpemVfdCByZXNvdXJjZV9z
aXplKGNvbnN0IHN0cnVjdCByZXNvdXJjZSAqcmVzKQp7CiByZXR1cm4gcmVzLT5lbmQgLSBy
ZXMtPnN0YXJ0ICsgMTsKfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgbG9uZyByZXNvdXJjZV90eXBl
KGNvbnN0IHN0cnVjdCByZXNvdXJjZSAqcmVzKQp7CiByZXR1cm4gcmVzLT5mbGFncyAmIDB4
MDAwMDFmMDA7Cn0Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIHVuc2lnbmVkIGxvbmcgcmVzb3VyY2VfZXh0X3R5cGUo
Y29uc3Qgc3RydWN0IHJlc291cmNlICpyZXMpCnsKIHJldHVybiByZXMtPmZsYWdzICYgMHgw
MTAwMDAwMDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgcmVzb3VyY2VfY29udGFpbnMoc3RydWN0IHJl
c291cmNlICpyMSwgc3RydWN0IHJlc291cmNlICpyMikKewogaWYgKHJlc291cmNlX3R5cGUo
cjEpICE9IHJlc291cmNlX3R5cGUocjIpKQogIHJldHVybiBmYWxzZTsKIGlmIChyMS0+Zmxh
Z3MgJiAweDIwMDAwMDAwIHx8IHIyLT5mbGFncyAmIDB4MjAwMDAwMDApCiAgcmV0dXJuIGZh
bHNlOwogcmV0dXJuIHIxLT5zdGFydCA8PSByMi0+c3RhcnQgJiYgcjEtPmVuZCA+PSByMi0+
ZW5kOwp9CiMgMjM5ICIuL2luY2x1ZGUvbGludXgvaW9wb3J0LmgiCmV4dGVybiBzdHJ1Y3Qg
cmVzb3VyY2UgKiBfX3JlcXVlc3RfcmVnaW9uKHN0cnVjdCByZXNvdXJjZSAqLAogICAgIHJl
c291cmNlX3NpemVfdCBzdGFydCwKICAgICByZXNvdXJjZV9zaXplX3QgbiwKICAgICBjb25z
dCBjaGFyICpuYW1lLCBpbnQgZmxhZ3MpOwoKCgoKCmV4dGVybiB2b2lkIF9fcmVsZWFzZV9y
ZWdpb24oc3RydWN0IHJlc291cmNlICosIHJlc291cmNlX3NpemVfdCwKICAgIHJlc291cmNl
X3NpemVfdCk7CgoKCgoKCnN0cnVjdCBkZXZpY2U7CgpleHRlcm4gaW50IGRldm1fcmVxdWVz
dF9yZXNvdXJjZShzdHJ1Y3QgZGV2aWNlICpkZXYsIHN0cnVjdCByZXNvdXJjZSAqcm9vdCwK
ICAgICBzdHJ1Y3QgcmVzb3VyY2UgKm5ldyk7CmV4dGVybiB2b2lkIGRldm1fcmVsZWFzZV9y
ZXNvdXJjZShzdHJ1Y3QgZGV2aWNlICpkZXYsIHN0cnVjdCByZXNvdXJjZSAqbmV3KTsKCgoK
CgoKZXh0ZXJuIHN0cnVjdCByZXNvdXJjZSAqIF9fZGV2bV9yZXF1ZXN0X3JlZ2lvbihzdHJ1
Y3QgZGV2aWNlICpkZXYsCiAgICBzdHJ1Y3QgcmVzb3VyY2UgKnBhcmVudCwgcmVzb3VyY2Vf
c2l6ZV90IHN0YXJ0LAogICAgcmVzb3VyY2Vfc2l6ZV90IG4sIGNvbnN0IGNoYXIgKm5hbWUp
OwoKCgoKCgpleHRlcm4gdm9pZCBfX2Rldm1fcmVsZWFzZV9yZWdpb24oc3RydWN0IGRldmlj
ZSAqZGV2LCBzdHJ1Y3QgcmVzb3VyY2UgKnBhcmVudCwKICAgICAgcmVzb3VyY2Vfc2l6ZV90
IHN0YXJ0LCByZXNvdXJjZV9zaXplX3Qgbik7CmV4dGVybiBpbnQgaW9tZW1fbWFwX3Nhbml0
eV9jaGVjayhyZXNvdXJjZV9zaXplX3QgYWRkciwgdW5zaWduZWQgbG9uZyBzaXplKTsKZXh0
ZXJuIGJvb2wgaW9tZW1faXNfZXhjbHVzaXZlKHU2NCBhZGRyKTsKCmV4dGVybiBpbnQKd2Fs
a19zeXN0ZW1fcmFtX3JhbmdlKHVuc2lnbmVkIGxvbmcgc3RhcnRfcGZuLCB1bnNpZ25lZCBs
b25nIG5yX3BhZ2VzLAogIHZvaWQgKmFyZywgaW50ICgqZnVuYykodW5zaWduZWQgbG9uZywg
dW5zaWduZWQgbG9uZywgdm9pZCAqKSk7CmV4dGVybiBpbnQKd2Fsa19tZW1fcmVzKHU2NCBz
dGFydCwgdTY0IGVuZCwgdm9pZCAqYXJnLAogICAgICBpbnQgKCpmdW5jKShzdHJ1Y3QgcmVz
b3VyY2UgKiwgdm9pZCAqKSk7CmV4dGVybiBpbnQKd2Fsa19zeXN0ZW1fcmFtX3Jlcyh1NjQg
c3RhcnQsIHU2NCBlbmQsIHZvaWQgKmFyZywKICAgICAgaW50ICgqZnVuYykoc3RydWN0IHJl
c291cmNlICosIHZvaWQgKikpOwpleHRlcm4gaW50CndhbGtfaW9tZW1fcmVzX2Rlc2ModW5z
aWduZWQgbG9uZyBkZXNjLCB1bnNpZ25lZCBsb25nIGZsYWdzLCB1NjQgc3RhcnQsIHU2NCBl
bmQsCiAgICAgIHZvaWQgKmFyZywgaW50ICgqZnVuYykoc3RydWN0IHJlc291cmNlICosIHZv
aWQgKikpOwoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIHJlc291cmNlX292ZXJsYXBzKHN0cnVjdCByZXNv
dXJjZSAqcjEsIHN0cnVjdCByZXNvdXJjZSAqcjIpCnsKICAgICAgIHJldHVybiAocjEtPnN0
YXJ0IDw9IHIyLT5lbmQgJiYgcjEtPmVuZCA+PSByMi0+c3RhcnQpOwp9CgpzdHJ1Y3QgcmVz
b3VyY2UgKmRldm1fcmVxdWVzdF9mcmVlX21lbV9yZWdpb24oc3RydWN0IGRldmljZSAqZGV2
LAogIHN0cnVjdCByZXNvdXJjZSAqYmFzZSwgdW5zaWduZWQgbG9uZyBzaXplKTsKc3RydWN0
IHJlc291cmNlICpyZXF1ZXN0X2ZyZWVfbWVtX3JlZ2lvbihzdHJ1Y3QgcmVzb3VyY2UgKmJh
c2UsCiAgdW5zaWduZWQgbG9uZyBzaXplLCBjb25zdCBjaGFyICpuYW1lKTsKCgoKCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSB2b2lkIHJldm9rZV9kZXZtZW0oc3RydWN0IHJlc291cmNlICpyZXMpIHsgfTsKIyA1
ICIuL2luY2x1ZGUvbGludXgvbWVtcmVtYXAuaCIgMgoKCnN0cnVjdCByZXNvdXJjZTsKc3Ry
dWN0IGRldmljZTsKIyAxOCAiLi9pbmNsdWRlL2xpbnV4L21lbXJlbWFwLmgiCnN0cnVjdCB2
bWVtX2FsdG1hcCB7CiBjb25zdCB1bnNpZ25lZCBsb25nIGJhc2VfcGZuOwogY29uc3QgdW5z
aWduZWQgbG9uZyBlbmRfcGZuOwogY29uc3QgdW5zaWduZWQgbG9uZyByZXNlcnZlOwogdW5z
aWduZWQgbG9uZyBmcmVlOwogdW5zaWduZWQgbG9uZyBhbGlnbjsKIHVuc2lnbmVkIGxvbmcg
YWxsb2M7Cn07CiMgNTkgIi4vaW5jbHVkZS9saW51eC9tZW1yZW1hcC5oIgplbnVtIG1lbW9y
eV90eXBlIHsKCiBNRU1PUllfREVWSUNFX1BSSVZBVEUgPSAxLAogTUVNT1JZX0RFVklDRV9G
U19EQVgsCiBNRU1PUllfREVWSUNFX0RFVkRBWCwKIE1FTU9SWV9ERVZJQ0VfUENJX1AyUERN
QSwKfTsKCnN0cnVjdCBkZXZfcGFnZW1hcF9vcHMgewoKCgoKCiB2b2lkICgqcGFnZV9mcmVl
KShzdHJ1Y3QgcGFnZSAqcGFnZSk7CgoKCgogdm9pZCAoKmtpbGwpKHN0cnVjdCBkZXZfcGFn
ZW1hcCAqcGdtYXApOwoKCgoKIHZvaWQgKCpjbGVhbnVwKShzdHJ1Y3QgZGV2X3BhZ2VtYXAg
KnBnbWFwKTsKCgoKCgogdm1fZmF1bHRfdCAoKm1pZ3JhdGVfdG9fcmFtKShzdHJ1Y3Qgdm1f
ZmF1bHQgKnZtZik7Cn07CiMgMTA4ICIuL2luY2x1ZGUvbGludXgvbWVtcmVtYXAuaCIKc3Ry
dWN0IGRldl9wYWdlbWFwIHsKIHN0cnVjdCB2bWVtX2FsdG1hcCBhbHRtYXA7CiBzdHJ1Y3Qg
cmVzb3VyY2UgcmVzOwogc3RydWN0IHBlcmNwdV9yZWYgKnJlZjsKIHN0cnVjdCBwZXJjcHVf
cmVmIGludGVybmFsX3JlZjsKIHN0cnVjdCBjb21wbGV0aW9uIGRvbmU7CiBlbnVtIG1lbW9y
eV90eXBlIHR5cGU7CiB1bnNpZ25lZCBpbnQgZmxhZ3M7CiBjb25zdCBzdHJ1Y3QgZGV2X3Bh
Z2VtYXBfb3BzICpvcHM7CiB2b2lkICpvd25lcjsKfTsKCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3Qgdm1l
bV9hbHRtYXAgKnBnbWFwX2FsdG1hcChzdHJ1Y3QgZGV2X3BhZ2VtYXAgKnBnbWFwKQp7CiBp
ZiAocGdtYXAtPmZsYWdzICYgKDEgPDwgMCkpCiAgcmV0dXJuICZwZ21hcC0+YWx0bWFwOwog
cmV0dXJuICgodm9pZCAqKTApOwp9CiMgMTM5ICIuL2luY2x1ZGUvbGludXgvbWVtcmVtYXAu
aCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIHZvaWQgKmRldm1fbWVtcmVtYXBfcGFnZXMoc3RydWN0IGRldmljZSAq
ZGV2LAogIHN0cnVjdCBkZXZfcGFnZW1hcCAqcGdtYXApCnsKCgoKCgogKHsgaW50IF9fcmV0
X3dhcm5fb24gPSAhISgxKTsgaWYgKF9fYnVpbHRpbl9leHBlY3QoISEoX19yZXRfd2Fybl9v
biksIDApKSBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CSIgInR3aSAzMSwgMCwgMCIgIlxu
IiAiLnNlY3Rpb24gX19idWdfdGFibGUsXCJhd1wiXG4iICIyOlx0IiAiLjhieXRlIiAiICIg
IjFiLCAlMFxuIiAiXHQuc2hvcnQgJTEsICUyXG4iICIub3JnIDJiKyUzXG4iICIucHJldmlv
dXNcbiIgOiA6ICJpIiAoIi4vaW5jbHVkZS9saW51eC9tZW1yZW1hcC5oIiksICJpIiAoMTQ3
KSwgImkiICgoMSA8PCAwKSB8ICgoMSA8PCAxKSB8ICgoOSkgPDwgOCkpKSwgImkiIChzaXpl
b2Yoc3RydWN0IGJ1Z19lbnRyeSkpKTsgX19idWlsdGluX2V4cGVjdCghIShfX3JldF93YXJu
X29uKSwgMCk7IH0pOwogcmV0dXJuIEVSUl9QVFIoLTYpOwp9CgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBk
ZXZtX21lbXVubWFwX3BhZ2VzKHN0cnVjdCBkZXZpY2UgKmRldiwKICBzdHJ1Y3QgZGV2X3Bh
Z2VtYXAgKnBnbWFwKQp7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3QgZGV2X3BhZ2VtYXAgKmdldF9k
ZXZfcGFnZW1hcCh1bnNpZ25lZCBsb25nIHBmbiwKICBzdHJ1Y3QgZGV2X3BhZ2VtYXAgKnBn
bWFwKQp7CiByZXR1cm4gKCh2b2lkICopMCk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1bnNpZ25lZCBsb25n
IHZtZW1fYWx0bWFwX29mZnNldChzdHJ1Y3Qgdm1lbV9hbHRtYXAgKmFsdG1hcCkKewogcmV0
dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHZtZW1fYWx0bWFwX2ZyZWUoc3RydWN0IHZtZW1f
YWx0bWFwICphbHRtYXAsCiAgdW5zaWduZWQgbG9uZyBucl9wZm5zKQp7Cn0KCgpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgdW5zaWduZWQgbG9uZyBtZW1yZW1hcF9jb21wYXRfYWxpZ24odm9pZCkKewogcmV0dXJu
ICgxVUwgPDwgMTIpOwp9CgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgcHV0X2Rldl9wYWdlbWFwKHN0cnVj
dCBkZXZfcGFnZW1hcCAqcGdtYXApCnsKIGlmIChwZ21hcCkKICBwZXJjcHVfcmVmX3B1dChw
Z21hcC0+cmVmKTsKfQojIDI5ICIuL2luY2x1ZGUvbGludXgvbW0uaCIgMgojIDEgIi4vaW5j
bHVkZS9saW51eC9vdmVyZmxvdy5oIiAxCiMgMjUzICIuL2luY2x1ZGUvbGludXgvb3ZlcmZs
b3cuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fd2Fybl91bnVzZWRfcmVzdWx0X18p
KSBzaXplX3QgYXJyYXlfc2l6ZShzaXplX3QgYSwgc2l6ZV90IGIpCnsKIHNpemVfdCBieXRl
czsKCiBpZiAoX19idWlsdGluX2Nob29zZV9leHByKCgoKHR5cGVvZihhKSkoLTEpKSA8ICh0
eXBlb2YoYSkpMSksICh7IHR5cGVvZihhKSBfX2EgPSAoYSk7IHR5cGVvZihiKSBfX2IgPSAo
Yik7IHR5cGVvZigmYnl0ZXMpIF9fZCA9ICgmYnl0ZXMpOyB0eXBlb2YoYSkgX190bWF4ID0g
KCh0eXBlb2YoYSkpKCgoKHR5cGVvZihhKSkxIDw8ICg4KnNpemVvZih0eXBlb2YoYSkpIC0g
MSAtICgoKHR5cGVvZihhKSkoLTEpKSA8ICh0eXBlb2YoYSkpMSkpKSAtIDEpICsgKCh0eXBl
b2YoYSkpMSA8PCAoOCpzaXplb2YodHlwZW9mKGEpKSAtIDEgLSAoKCh0eXBlb2YoYSkpKC0x
KSkgPCAodHlwZW9mKGEpKTEpKSkpKTsgdHlwZW9mKGEpIF9fdG1pbiA9ICgodHlwZW9mKGEp
KSgodHlwZW9mKGEpKS0oKHR5cGVvZihhKSkoKCgodHlwZW9mKGEpKTEgPDwgKDgqc2l6ZW9m
KHR5cGVvZihhKSkgLSAxIC0gKCgodHlwZW9mKGEpKSgtMSkpIDwgKHR5cGVvZihhKSkxKSkp
IC0gMSkgKyAoKHR5cGVvZihhKSkxIDw8ICg4KnNpemVvZih0eXBlb2YoYSkpIC0gMSAtICgo
KHR5cGVvZihhKSkoLTEpKSA8ICh0eXBlb2YoYSkpMSkpKSkpLSh0eXBlb2YoYSkpMSkpOyAo
dm9pZCkgKCZfX2EgPT0gJl9fYik7ICh2b2lkKSAoJl9fYSA9PSBfX2QpOyAqX19kID0gKHU2
NClfX2EgKiAodTY0KV9fYjsgKF9fYiA+IDAgJiYgKF9fYSA+IF9fdG1heC9fX2IgfHwgX19h
IDwgX190bWluL19fYikpIHx8IChfX2IgPCAodHlwZW9mKF9fYikpLTEgJiYgKF9fYSA+IF9f
dG1pbi9fX2IgfHwgX19hIDwgX190bWF4L19fYikpIHx8IChfX2IgPT0gKHR5cGVvZihfX2Ip
KS0xICYmIF9fYSA9PSBfX3RtaW4pOyB9KSwgKHsgdHlwZW9mKGEpIF9fYSA9IChhKTsgdHlw
ZW9mKGIpIF9fYiA9IChiKTsgdHlwZW9mKCZieXRlcykgX19kID0gKCZieXRlcyk7ICh2b2lk
KSAoJl9fYSA9PSAmX19iKTsgKHZvaWQpICgmX19hID09IF9fZCk7ICpfX2QgPSBfX2EgKiBf
X2I7IF9fYnVpbHRpbl9jb25zdGFudF9wKF9fYikgPyBfX2IgPiAwICYmIF9fYSA+ICgodHlw
ZW9mKF9fYSkpKCgoKHR5cGVvZihfX2EpKTEgPDwgKDgqc2l6ZW9mKHR5cGVvZihfX2EpKSAt
IDEgLSAoKCh0eXBlb2YoX19hKSkoLTEpKSA8ICh0eXBlb2YoX19hKSkxKSkpIC0gMSkgKyAo
KHR5cGVvZihfX2EpKTEgPDwgKDgqc2l6ZW9mKHR5cGVvZihfX2EpKSAtIDEgLSAoKCh0eXBl
b2YoX19hKSkoLTEpKSA8ICh0eXBlb2YoX19hKSkxKSkpKSkgLyBfX2IgOiBfX2EgPiAwICYm
IF9fYiA+ICgodHlwZW9mKF9fYikpKCgoKHR5cGVvZihfX2IpKTEgPDwgKDgqc2l6ZW9mKHR5
cGVvZihfX2IpKSAtIDEgLSAoKCh0eXBlb2YoX19iKSkoLTEpKSA8ICh0eXBlb2YoX19iKSkx
KSkpIC0gMSkgKyAoKHR5cGVvZihfX2IpKTEgPDwgKDgqc2l6ZW9mKHR5cGVvZihfX2IpKSAt
IDEgLSAoKCh0eXBlb2YoX19iKSkoLTEpKSA8ICh0eXBlb2YoX19iKSkxKSkpKSkgLyBfX2E7
IH0pKSkKICByZXR1cm4gKH4oc2l6ZV90KTApOwoKIHJldHVybiBieXRlczsKfQojIDI3NSAi
Li9pbmNsdWRlL2xpbnV4L292ZXJmbG93LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkgc2l6ZV90IGFycmF5M19zaXplKHNpemVfdCBhLCBz
aXplX3QgYiwgc2l6ZV90IGMpCnsKIHNpemVfdCBieXRlczsKCiBpZiAoX19idWlsdGluX2No
b29zZV9leHByKCgoKHR5cGVvZihhKSkoLTEpKSA8ICh0eXBlb2YoYSkpMSksICh7IHR5cGVv
ZihhKSBfX2EgPSAoYSk7IHR5cGVvZihiKSBfX2IgPSAoYik7IHR5cGVvZigmYnl0ZXMpIF9f
ZCA9ICgmYnl0ZXMpOyB0eXBlb2YoYSkgX190bWF4ID0gKCh0eXBlb2YoYSkpKCgoKHR5cGVv
ZihhKSkxIDw8ICg4KnNpemVvZih0eXBlb2YoYSkpIC0gMSAtICgoKHR5cGVvZihhKSkoLTEp
KSA8ICh0eXBlb2YoYSkpMSkpKSAtIDEpICsgKCh0eXBlb2YoYSkpMSA8PCAoOCpzaXplb2Yo
dHlwZW9mKGEpKSAtIDEgLSAoKCh0eXBlb2YoYSkpKC0xKSkgPCAodHlwZW9mKGEpKTEpKSkp
KTsgdHlwZW9mKGEpIF9fdG1pbiA9ICgodHlwZW9mKGEpKSgodHlwZW9mKGEpKS0oKHR5cGVv
ZihhKSkoKCgodHlwZW9mKGEpKTEgPDwgKDgqc2l6ZW9mKHR5cGVvZihhKSkgLSAxIC0gKCgo
dHlwZW9mKGEpKSgtMSkpIDwgKHR5cGVvZihhKSkxKSkpIC0gMSkgKyAoKHR5cGVvZihhKSkx
IDw8ICg4KnNpemVvZih0eXBlb2YoYSkpIC0gMSAtICgoKHR5cGVvZihhKSkoLTEpKSA8ICh0
eXBlb2YoYSkpMSkpKSkpLSh0eXBlb2YoYSkpMSkpOyAodm9pZCkgKCZfX2EgPT0gJl9fYik7
ICh2b2lkKSAoJl9fYSA9PSBfX2QpOyAqX19kID0gKHU2NClfX2EgKiAodTY0KV9fYjsgKF9f
YiA+IDAgJiYgKF9fYSA+IF9fdG1heC9fX2IgfHwgX19hIDwgX190bWluL19fYikpIHx8IChf
X2IgPCAodHlwZW9mKF9fYikpLTEgJiYgKF9fYSA+IF9fdG1pbi9fX2IgfHwgX19hIDwgX190
bWF4L19fYikpIHx8IChfX2IgPT0gKHR5cGVvZihfX2IpKS0xICYmIF9fYSA9PSBfX3RtaW4p
OyB9KSwgKHsgdHlwZW9mKGEpIF9fYSA9IChhKTsgdHlwZW9mKGIpIF9fYiA9IChiKTsgdHlw
ZW9mKCZieXRlcykgX19kID0gKCZieXRlcyk7ICh2b2lkKSAoJl9fYSA9PSAmX19iKTsgKHZv
aWQpICgmX19hID09IF9fZCk7ICpfX2QgPSBfX2EgKiBfX2I7IF9fYnVpbHRpbl9jb25zdGFu
dF9wKF9fYikgPyBfX2IgPiAwICYmIF9fYSA+ICgodHlwZW9mKF9fYSkpKCgoKHR5cGVvZihf
X2EpKTEgPDwgKDgqc2l6ZW9mKHR5cGVvZihfX2EpKSAtIDEgLSAoKCh0eXBlb2YoX19hKSko
LTEpKSA8ICh0eXBlb2YoX19hKSkxKSkpIC0gMSkgKyAoKHR5cGVvZihfX2EpKTEgPDwgKDgq
c2l6ZW9mKHR5cGVvZihfX2EpKSAtIDEgLSAoKCh0eXBlb2YoX19hKSkoLTEpKSA8ICh0eXBl
b2YoX19hKSkxKSkpKSkgLyBfX2IgOiBfX2EgPiAwICYmIF9fYiA+ICgodHlwZW9mKF9fYikp
KCgoKHR5cGVvZihfX2IpKTEgPDwgKDgqc2l6ZW9mKHR5cGVvZihfX2IpKSAtIDEgLSAoKCh0
eXBlb2YoX19iKSkoLTEpKSA8ICh0eXBlb2YoX19iKSkxKSkpIC0gMSkgKyAoKHR5cGVvZihf
X2IpKTEgPDwgKDgqc2l6ZW9mKHR5cGVvZihfX2IpKSAtIDEgLSAoKCh0eXBlb2YoX19iKSko
LTEpKSA8ICh0eXBlb2YoX19iKSkxKSkpKSkgLyBfX2E7IH0pKSkKICByZXR1cm4gKH4oc2l6
ZV90KTApOwogaWYgKF9fYnVpbHRpbl9jaG9vc2VfZXhwcigoKCh0eXBlb2YoYnl0ZXMpKSgt
MSkpIDwgKHR5cGVvZihieXRlcykpMSksICh7IHR5cGVvZihieXRlcykgX19hID0gKGJ5dGVz
KTsgdHlwZW9mKGMpIF9fYiA9IChjKTsgdHlwZW9mKCZieXRlcykgX19kID0gKCZieXRlcyk7
IHR5cGVvZihieXRlcykgX190bWF4ID0gKCh0eXBlb2YoYnl0ZXMpKSgoKCh0eXBlb2YoYnl0
ZXMpKTEgPDwgKDgqc2l6ZW9mKHR5cGVvZihieXRlcykpIC0gMSAtICgoKHR5cGVvZihieXRl
cykpKC0xKSkgPCAodHlwZW9mKGJ5dGVzKSkxKSkpIC0gMSkgKyAoKHR5cGVvZihieXRlcykp
MSA8PCAoOCpzaXplb2YodHlwZW9mKGJ5dGVzKSkgLSAxIC0gKCgodHlwZW9mKGJ5dGVzKSko
LTEpKSA8ICh0eXBlb2YoYnl0ZXMpKTEpKSkpKTsgdHlwZW9mKGJ5dGVzKSBfX3RtaW4gPSAo
KHR5cGVvZihieXRlcykpKCh0eXBlb2YoYnl0ZXMpKS0oKHR5cGVvZihieXRlcykpKCgoKHR5
cGVvZihieXRlcykpMSA8PCAoOCpzaXplb2YodHlwZW9mKGJ5dGVzKSkgLSAxIC0gKCgodHlw
ZW9mKGJ5dGVzKSkoLTEpKSA8ICh0eXBlb2YoYnl0ZXMpKTEpKSkgLSAxKSArICgodHlwZW9m
KGJ5dGVzKSkxIDw8ICg4KnNpemVvZih0eXBlb2YoYnl0ZXMpKSAtIDEgLSAoKCh0eXBlb2Yo
Ynl0ZXMpKSgtMSkpIDwgKHR5cGVvZihieXRlcykpMSkpKSkpLSh0eXBlb2YoYnl0ZXMpKTEp
KTsgKHZvaWQpICgmX19hID09ICZfX2IpOyAodm9pZCkgKCZfX2EgPT0gX19kKTsgKl9fZCA9
ICh1NjQpX19hICogKHU2NClfX2I7IChfX2IgPiAwICYmIChfX2EgPiBfX3RtYXgvX19iIHx8
IF9fYSA8IF9fdG1pbi9fX2IpKSB8fCAoX19iIDwgKHR5cGVvZihfX2IpKS0xICYmIChfX2Eg
PiBfX3RtaW4vX19iIHx8IF9fYSA8IF9fdG1heC9fX2IpKSB8fCAoX19iID09ICh0eXBlb2Yo
X19iKSktMSAmJiBfX2EgPT0gX190bWluKTsgfSksICh7IHR5cGVvZihieXRlcykgX19hID0g
KGJ5dGVzKTsgdHlwZW9mKGMpIF9fYiA9IChjKTsgdHlwZW9mKCZieXRlcykgX19kID0gKCZi
eXRlcyk7ICh2b2lkKSAoJl9fYSA9PSAmX19iKTsgKHZvaWQpICgmX19hID09IF9fZCk7ICpf
X2QgPSBfX2EgKiBfX2I7IF9fYnVpbHRpbl9jb25zdGFudF9wKF9fYikgPyBfX2IgPiAwICYm
IF9fYSA+ICgodHlwZW9mKF9fYSkpKCgoKHR5cGVvZihfX2EpKTEgPDwgKDgqc2l6ZW9mKHR5
cGVvZihfX2EpKSAtIDEgLSAoKCh0eXBlb2YoX19hKSkoLTEpKSA8ICh0eXBlb2YoX19hKSkx
KSkpIC0gMSkgKyAoKHR5cGVvZihfX2EpKTEgPDwgKDgqc2l6ZW9mKHR5cGVvZihfX2EpKSAt
IDEgLSAoKCh0eXBlb2YoX19hKSkoLTEpKSA8ICh0eXBlb2YoX19hKSkxKSkpKSkgLyBfX2Ig
OiBfX2EgPiAwICYmIF9fYiA+ICgodHlwZW9mKF9fYikpKCgoKHR5cGVvZihfX2IpKTEgPDwg
KDgqc2l6ZW9mKHR5cGVvZihfX2IpKSAtIDEgLSAoKCh0eXBlb2YoX19iKSkoLTEpKSA8ICh0
eXBlb2YoX19iKSkxKSkpIC0gMSkgKyAoKHR5cGVvZihfX2IpKTEgPDwgKDgqc2l6ZW9mKHR5
cGVvZihfX2IpKSAtIDEgLSAoKCh0eXBlb2YoX19iKSkoLTEpKSA8ICh0eXBlb2YoX19iKSkx
KSkpKSkgLyBfX2E7IH0pKSkKICByZXR1cm4gKH4oc2l6ZV90KTApOwoKIHJldHVybiBieXRl
czsKfQoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX3dhcm5fdW51c2VkX3Jlc3Vs
dF9fKSkgc2l6ZV90IF9fYWJfY19zaXplKHNpemVfdCBhLCBzaXplX3QgYiwgc2l6ZV90IGMp
CnsKIHNpemVfdCBieXRlczsKCiBpZiAoX19idWlsdGluX2Nob29zZV9leHByKCgoKHR5cGVv
ZihhKSkoLTEpKSA8ICh0eXBlb2YoYSkpMSksICh7IHR5cGVvZihhKSBfX2EgPSAoYSk7IHR5
cGVvZihiKSBfX2IgPSAoYik7IHR5cGVvZigmYnl0ZXMpIF9fZCA9ICgmYnl0ZXMpOyB0eXBl
b2YoYSkgX190bWF4ID0gKCh0eXBlb2YoYSkpKCgoKHR5cGVvZihhKSkxIDw8ICg4KnNpemVv
Zih0eXBlb2YoYSkpIC0gMSAtICgoKHR5cGVvZihhKSkoLTEpKSA8ICh0eXBlb2YoYSkpMSkp
KSAtIDEpICsgKCh0eXBlb2YoYSkpMSA8PCAoOCpzaXplb2YodHlwZW9mKGEpKSAtIDEgLSAo
KCh0eXBlb2YoYSkpKC0xKSkgPCAodHlwZW9mKGEpKTEpKSkpKTsgdHlwZW9mKGEpIF9fdG1p
biA9ICgodHlwZW9mKGEpKSgodHlwZW9mKGEpKS0oKHR5cGVvZihhKSkoKCgodHlwZW9mKGEp
KTEgPDwgKDgqc2l6ZW9mKHR5cGVvZihhKSkgLSAxIC0gKCgodHlwZW9mKGEpKSgtMSkpIDwg
KHR5cGVvZihhKSkxKSkpIC0gMSkgKyAoKHR5cGVvZihhKSkxIDw8ICg4KnNpemVvZih0eXBl
b2YoYSkpIC0gMSAtICgoKHR5cGVvZihhKSkoLTEpKSA8ICh0eXBlb2YoYSkpMSkpKSkpLSh0
eXBlb2YoYSkpMSkpOyAodm9pZCkgKCZfX2EgPT0gJl9fYik7ICh2b2lkKSAoJl9fYSA9PSBf
X2QpOyAqX19kID0gKHU2NClfX2EgKiAodTY0KV9fYjsgKF9fYiA+IDAgJiYgKF9fYSA+IF9f
dG1heC9fX2IgfHwgX19hIDwgX190bWluL19fYikpIHx8IChfX2IgPCAodHlwZW9mKF9fYikp
LTEgJiYgKF9fYSA+IF9fdG1pbi9fX2IgfHwgX19hIDwgX190bWF4L19fYikpIHx8IChfX2Ig
PT0gKHR5cGVvZihfX2IpKS0xICYmIF9fYSA9PSBfX3RtaW4pOyB9KSwgKHsgdHlwZW9mKGEp
IF9fYSA9IChhKTsgdHlwZW9mKGIpIF9fYiA9IChiKTsgdHlwZW9mKCZieXRlcykgX19kID0g
KCZieXRlcyk7ICh2b2lkKSAoJl9fYSA9PSAmX19iKTsgKHZvaWQpICgmX19hID09IF9fZCk7
ICpfX2QgPSBfX2EgKiBfX2I7IF9fYnVpbHRpbl9jb25zdGFudF9wKF9fYikgPyBfX2IgPiAw
ICYmIF9fYSA+ICgodHlwZW9mKF9fYSkpKCgoKHR5cGVvZihfX2EpKTEgPDwgKDgqc2l6ZW9m
KHR5cGVvZihfX2EpKSAtIDEgLSAoKCh0eXBlb2YoX19hKSkoLTEpKSA8ICh0eXBlb2YoX19h
KSkxKSkpIC0gMSkgKyAoKHR5cGVvZihfX2EpKTEgPDwgKDgqc2l6ZW9mKHR5cGVvZihfX2Ep
KSAtIDEgLSAoKCh0eXBlb2YoX19hKSkoLTEpKSA8ICh0eXBlb2YoX19hKSkxKSkpKSkgLyBf
X2IgOiBfX2EgPiAwICYmIF9fYiA+ICgodHlwZW9mKF9fYikpKCgoKHR5cGVvZihfX2IpKTEg
PDwgKDgqc2l6ZW9mKHR5cGVvZihfX2IpKSAtIDEgLSAoKCh0eXBlb2YoX19iKSkoLTEpKSA8
ICh0eXBlb2YoX19iKSkxKSkpIC0gMSkgKyAoKHR5cGVvZihfX2IpKTEgPDwgKDgqc2l6ZW9m
KHR5cGVvZihfX2IpKSAtIDEgLSAoKCh0eXBlb2YoX19iKSkoLTEpKSA8ICh0eXBlb2YoX19i
KSkxKSkpKSkgLyBfX2E7IH0pKSkKICByZXR1cm4gKH4oc2l6ZV90KTApOwogaWYgKF9fYnVp
bHRpbl9jaG9vc2VfZXhwcigoKCh0eXBlb2YoYnl0ZXMpKSgtMSkpIDwgKHR5cGVvZihieXRl
cykpMSksICh7IHR5cGVvZihieXRlcykgX19hID0gKGJ5dGVzKTsgdHlwZW9mKGMpIF9fYiA9
IChjKTsgdHlwZW9mKCZieXRlcykgX19kID0gKCZieXRlcyk7ICh2b2lkKSAoJl9fYSA9PSAm
X19iKTsgKHZvaWQpICgmX19hID09IF9fZCk7ICpfX2QgPSAodTY0KV9fYSArICh1NjQpX19i
OyAoKCh+KF9fYSBeIF9fYikpICYgKCpfX2QgXiBfX2EpKSAmICgodHlwZW9mKF9fYSkpKCh0
eXBlb2YoX19hKSktKCh0eXBlb2YoX19hKSkoKCgodHlwZW9mKF9fYSkpMSA8PCAoOCpzaXpl
b2YodHlwZW9mKF9fYSkpIC0gMSAtICgoKHR5cGVvZihfX2EpKSgtMSkpIDwgKHR5cGVvZihf
X2EpKTEpKSkgLSAxKSArICgodHlwZW9mKF9fYSkpMSA8PCAoOCpzaXplb2YodHlwZW9mKF9f
YSkpIC0gMSAtICgoKHR5cGVvZihfX2EpKSgtMSkpIDwgKHR5cGVvZihfX2EpKTEpKSkpKS0o
dHlwZW9mKF9fYSkpMSkpKSAhPSAwOyB9KSwgKHsgdHlwZW9mKGJ5dGVzKSBfX2EgPSAoYnl0
ZXMpOyB0eXBlb2YoYykgX19iID0gKGMpOyB0eXBlb2YoJmJ5dGVzKSBfX2QgPSAoJmJ5dGVz
KTsgKHZvaWQpICgmX19hID09ICZfX2IpOyAodm9pZCkgKCZfX2EgPT0gX19kKTsgKl9fZCA9
IF9fYSArIF9fYjsgKl9fZCA8IF9fYTsgfSkpKQogIHJldHVybiAofihzaXplX3QpMCk7Cgog
cmV0dXJuIGJ5dGVzOwp9CiMgMzAgIi4vaW5jbHVkZS9saW51eC9tbS5oIiAyCiMgMSAiLi9p
bmNsdWRlL2xpbnV4L3NpemVzLmgiIDEKIyAzMSAiLi9pbmNsdWRlL2xpbnV4L21tLmgiIDIK
CiMgMSAiLi9pbmNsdWRlL2xpbnV4L3BndGFibGUuaCIgMQoKCgoKCiMgMSAiLi9hcmNoL3Bv
d2VycGMvaW5jbHVkZS9hc20vcGd0YWJsZS5oIiAxCiMgMTEgIi4vYXJjaC9wb3dlcnBjL2lu
Y2x1ZGUvYXNtL3BndGFibGUuaCIKIyAxICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS90
bGJmbHVzaC5oIiAxCgoKCgoKCgojIDEgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL25v
aGFzaC90bGJmbHVzaC5oIiAxCiMgMjcgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL25v
aGFzaC90bGJmbHVzaC5oIgpzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3Q7CnN0cnVjdCBtbV9zdHJ1
Y3Q7CgoKCmV4dGVybiB2b2lkIGZsdXNoX3RsYl9yYW5nZShzdHJ1Y3Qgdm1fYXJlYV9zdHJ1
Y3QgKnZtYSwgdW5zaWduZWQgbG9uZyBzdGFydCwKICAgICAgIHVuc2lnbmVkIGxvbmcgZW5k
KTsKZXh0ZXJuIHZvaWQgZmx1c2hfdGxiX2tlcm5lbF9yYW5nZSh1bnNpZ25lZCBsb25nIHN0
YXJ0LCB1bnNpZ25lZCBsb25nIGVuZCk7CgpleHRlcm4gdm9pZCBsb2NhbF9mbHVzaF90bGJf
bW0oc3RydWN0IG1tX3N0cnVjdCAqbW0pOwpleHRlcm4gdm9pZCBsb2NhbF9mbHVzaF90bGJf
cGFnZShzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnZtYSwgdW5zaWduZWQgbG9uZyB2bWFkZHIp
OwoKZXh0ZXJuIHZvaWQgX19sb2NhbF9mbHVzaF90bGJfcGFnZShzdHJ1Y3QgbW1fc3RydWN0
ICptbSwgdW5zaWduZWQgbG9uZyB2bWFkZHIsCiAgICAgICBpbnQgdHNpemUsIGludCBpbmQp
OwoKCmV4dGVybiB2b2lkIGZsdXNoX3RsYl9tbShzdHJ1Y3QgbW1fc3RydWN0ICptbSk7CmV4
dGVybiB2b2lkIGZsdXNoX3RsYl9wYWdlKHN0cnVjdCB2bV9hcmVhX3N0cnVjdCAqdm1hLCB1
bnNpZ25lZCBsb25nIHZtYWRkcik7CmV4dGVybiB2b2lkIF9fZmx1c2hfdGxiX3BhZ2Uoc3Ry
dWN0IG1tX3N0cnVjdCAqbW0sIHVuc2lnbmVkIGxvbmcgdm1hZGRyLAogICAgICAgIGludCB0
c2l6ZSwgaW50IGluZCk7CiMgOSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vdGxiZmx1
c2guaCIgMgojIDEyICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9wZ3RhYmxlLmgiIDIK
CnN0cnVjdCBtbV9zdHJ1Y3Q7CgoKCgoKCiMgMSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9h
c20vbm9oYXNoL3BndGFibGUuaCIgMQoKCgoKCiMgMSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVk
ZS9hc20vbm9oYXNoLzY0L3BndGFibGUuaCIgMQojIDkgIi4vYXJjaC9wb3dlcnBjL2luY2x1
ZGUvYXNtL25vaGFzaC82NC9wZ3RhYmxlLmgiCiMgMSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVk
ZS9hc20vbm9oYXNoLzY0L3BndGFibGUtNGsuaCIgMQoKCgoKIyAxICIuL2luY2x1ZGUvYXNt
LWdlbmVyaWMvcGd0YWJsZS1ub3A0ZC5oIiAxCiMgOSAiLi9pbmNsdWRlL2FzbS1nZW5lcmlj
L3BndGFibGUtbm9wNGQuaCIKdHlwZWRlZiBzdHJ1Y3QgeyBwZ2RfdCBwZ2Q7IH0gcDRkX3Q7
CiMgMjIgIi4vaW5jbHVkZS9hc20tZ2VuZXJpYy9wZ3RhYmxlLW5vcDRkLmgiCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBpbnQgcGdkX25vbmUocGdkX3QgcGdkKSB7IHJldHVybiAwOyB9CnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQg
cGdkX2JhZChwZ2RfdCBwZ2QpIHsgcmV0dXJuIDA7IH0Kc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBwZ2RfcHJl
c2VudChwZ2RfdCBwZ2QpIHsgcmV0dXJuIDE7IH0Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgcGdkX2NsZWFy
KHBnZF90ICpwZ2QpIHsgfQojIDM2ICIuL2luY2x1ZGUvYXNtLWdlbmVyaWMvcGd0YWJsZS1u
b3A0ZC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgcDRkX3QgKnA0ZF9vZmZzZXQocGdkX3QgKnBnZCwgdW5zaWdu
ZWQgbG9uZyBhZGRyZXNzKQp7CiByZXR1cm4gKHA0ZF90ICopcGdkOwp9CiMgNiAiLi9hcmNo
L3Bvd2VycGMvaW5jbHVkZS9hc20vbm9oYXNoLzY0L3BndGFibGUtNGsuaCIgMgojIDYzICIu
L2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9ub2hhc2gvNjQvcGd0YWJsZS00ay5oIgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgdm9pZCBwNGRfY2xlYXIocDRkX3QgKnA0ZHApCnsKICpwNGRwID0gKChwNGRfdCkg
eyAoKHBnZF90KSB7ICgwKSB9KSB9KTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHB0ZV90IHA0ZF9wdGUocDRk
X3QgcDRkKQp7CiByZXR1cm4gKChwdGVfdCkgeyAoKHBnZF92YWwoKHA0ZCkucGdkKSkpIH0p
Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgcDRkX3QgcHRlX3A0ZChwdGVfdCBwdGUpCnsKIHJldHVybiAoKHA0
ZF90KSB7ICgocGdkX3QpIHsgKHB0ZV92YWwocHRlKSkgfSkgfSk7Cn0KZXh0ZXJuIHN0cnVj
dCBwYWdlICpwNGRfcGFnZShwNGRfdCBwNGQpOwojIDEwICIuL2FyY2gvcG93ZXJwYy9pbmNs
dWRlL2FzbS9ub2hhc2gvNjQvcGd0YWJsZS5oIiAyCiMgODMgIi4vYXJjaC9wb3dlcnBjL2lu
Y2x1ZGUvYXNtL25vaGFzaC82NC9wZ3RhYmxlLmgiCiMgMSAiLi9hcmNoL3Bvd2VycGMvaW5j
bHVkZS9hc20vbm9oYXNoL3B0ZS1ib29rM2UuaCIgMQojIDEwMyAiLi9hcmNoL3Bvd2VycGMv
aW5jbHVkZS9hc20vbm9oYXNoL3B0ZS1ib29rM2UuaCIKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHB0ZV90IHB0ZV9t
a3ByaXZpbGVnZWQocHRlX3QgcHRlKQp7CiByZXR1cm4gKChwdGVfdCkgeyAoKHB0ZV92YWwo
cHRlKSAmIH4oMHgwMDAwMDggfCAweDAwMDAwNCkpIHwgKDB4MDAwMDA0KSkgfSk7Cn0KCgoK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIHB0ZV90IHB0ZV9ta3VzZXIocHRlX3QgcHRlKQp7CiByZXR1cm4gKChwdGVf
dCkgeyAoKHB0ZV92YWwocHRlKSAmIH4oMHgwMDAwMDQpKSB8ICgweDAwMDAwOCB8IDB4MDAw
MDA0KSkgfSk7Cn0KIyA4NCAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vbm9oYXNoLzY0
L3BndGFibGUuaCIgMgojIDEwMCAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vbm9oYXNo
LzY0L3BndGFibGUuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHB0ZV90IHB0ZV9ta3dyaXRlKHB0ZV90IHB0ZSkK
ewogcmV0dXJuICgocHRlX3QpIHsgKHB0ZV92YWwocHRlKSB8ICgweDAwMDAxMCB8IDB4MDAw
MDIwKSkgfSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSBwdGVfdCBwdGVfbWtkaXJ0eShwdGVfdCBwdGUpCnsK
IHJldHVybiAoKHB0ZV90KSB7IChwdGVfdmFsKHB0ZSkgfCAweDAwMTAwMCkgfSk7Cn0KCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSBwdGVfdCBwdGVfbWt5b3VuZyhwdGVfdCBwdGUpCnsKIHJldHVybiAoKHB0ZV90
KSB7IChwdGVfdmFsKHB0ZSkgfCAweDA0MDAwMCkgfSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBwdGVfdCBw
dGVfd3Jwcm90ZWN0KHB0ZV90IHB0ZSkKewogcmV0dXJuICgocHRlX3QpIHsgKHB0ZV92YWwo
cHRlKSAmIH4oMHgwMDAwMTAgfCAweDAwMDAyMCkpIH0pOwp9CgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgcHRlX3Qg
cHRlX21rZXhlYyhwdGVfdCBwdGUpCnsKIHJldHVybiAoKHB0ZV90KSB7IChwdGVfdmFsKHB0
ZSkgfCAweDAwMDA4MCkgfSk7Cn0KCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHBtZF9zZXQocG1kX3Qg
KnBtZHAsIHVuc2lnbmVkIGxvbmcgdmFsKQp7CiAqcG1kcCA9ICgocG1kX3QpIHsgKHZhbCkg
fSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSB2b2lkIHBtZF9jbGVhcihwbWRfdCAqcG1kcCkKewogKnBtZHAg
PSAoKHBtZF90KSB7ICgwKSB9KTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHB0ZV90IHBtZF9wdGUocG1kX3Qg
cG1kKQp7CiByZXR1cm4gKChwdGVfdCkgeyAocG1kX3ZhbChwbWQpKSB9KTsKfQoKCgoKCgpl
eHRlcm4gc3RydWN0IHBhZ2UgKnBtZF9wYWdlKHBtZF90IHBtZCk7CgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9p
ZCBwdWRfc2V0KHB1ZF90ICpwdWRwLCB1bnNpZ25lZCBsb25nIHZhbCkKewogKnB1ZHAgPSAo
KHB1ZF90KSB7ICh2YWwpIH0pOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBwdWRfY2xlYXIocHVkX3Qg
KnB1ZHApCnsKICpwdWRwID0gKChwdWRfdCkgeyAoMCkgfSk7Cn0KCgoKCgoKCmV4dGVybiBz
dHJ1Y3QgcGFnZSAqcHVkX3BhZ2UocHVkX3QgcHVkKTsKCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBwdGVfdCBwdWRf
cHRlKHB1ZF90IHB1ZCkKewogcmV0dXJuICgocHRlX3QpIHsgKHB1ZF92YWwocHVkKSkgfSk7
Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSBwdWRfdCBwdGVfcHVkKHB0ZV90IHB0ZSkKewogcmV0dXJuICgocHVk
X3QpIHsgKHB0ZV92YWwocHRlKSkgfSk7Cn0KCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgcDRkX3NldChw
NGRfdCAqcDRkcCwgdW5zaWduZWQgbG9uZyB2YWwpCnsKICpwNGRwID0gKChwNGRfdCkgeyAo
KHBnZF90KSB7ICh2YWwpIH0pIH0pOwp9CgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHVuc2lnbmVkIGxvbmcgcHRl
X3VwZGF0ZShzdHJ1Y3QgbW1fc3RydWN0ICptbSwKICAgICAgICAgICB1bnNpZ25lZCBsb25n
IGFkZHIsCiAgICAgICAgICAgcHRlX3QgKnB0ZXAsIHVuc2lnbmVkIGxvbmcgY2xyLAogICAg
ICAgICAgIHVuc2lnbmVkIGxvbmcgc2V0LAogICAgICAgICAgIGludCBodWdlKQp7CiB1bnNp
Z25lZCBsb25nIG9sZCA9IHB0ZV92YWwoKnB0ZXApOwogKnB0ZXAgPSAoKHB0ZV90KSB7ICgo
b2xkICYgfmNscikgfCBzZXQpIH0pOwoKCiBpZiAoIWh1Z2UpCiAgYXNzZXJ0X3B0ZV9sb2Nr
ZWQobW0sIGFkZHIpOwoKIHJldHVybiBvbGQ7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgcHRlX3lvdW5n
KHB0ZV90IHB0ZSkKewogcmV0dXJuIHB0ZV92YWwocHRlKSAmIDB4MDQwMDAwOwp9CgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgaW50IF9fcHRlcF90ZXN0X2FuZF9jbGVhcl95b3VuZyhzdHJ1Y3QgbW1fc3RydWN0
ICptbSwKICAgICAgICAgICB1bnNpZ25lZCBsb25nIGFkZHIsIHB0ZV90ICpwdGVwKQp7CiB1
bnNpZ25lZCBsb25nIG9sZDsKCiBpZiAocHRlX3lvdW5nKCpwdGVwKSkKICByZXR1cm4gMDsK
IG9sZCA9IHB0ZV91cGRhdGUobW0sIGFkZHIsIHB0ZXAsIDB4MDQwMDAwLCAwLCAwKTsKIHJl
dHVybiAob2xkICYgMHgwNDAwMDApICE9IDA7Cn0KIyAyMjYgIi4vYXJjaC9wb3dlcnBjL2lu
Y2x1ZGUvYXNtL25vaGFzaC82NC9wZ3RhYmxlLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHB0ZXBfc2V0
X3dycHJvdGVjdChzdHJ1Y3QgbW1fc3RydWN0ICptbSwgdW5zaWduZWQgbG9uZyBhZGRyLAog
ICAgICAgICAgcHRlX3QgKnB0ZXApCnsKCiBpZiAoKHB0ZV92YWwoKnB0ZXApICYgKDB4MDAw
MDEwIHwgMHgwMDAwMjApKSA9PSAwKQogIHJldHVybjsKCiBwdGVfdXBkYXRlKG1tLCBhZGRy
LCBwdGVwLCAoMHgwMDAwMTAgfCAweDAwMDAyMCksIDAsIDApOwp9CgoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZv
aWQgaHVnZV9wdGVwX3NldF93cnByb3RlY3Qoc3RydWN0IG1tX3N0cnVjdCAqbW0sCiAgICAg
ICAgdW5zaWduZWQgbG9uZyBhZGRyLCBwdGVfdCAqcHRlcCkKewogaWYgKChwdGVfdmFsKCpw
dGVwKSAmICgweDAwMDAxMCB8IDB4MDAwMDIwKSkgPT0gMCkKICByZXR1cm47CgogcHRlX3Vw
ZGF0ZShtbSwgYWRkciwgcHRlcCwgKDB4MDAwMDEwIHwgMHgwMDAwMjApLCAwLCAxKTsKfQoj
IDI1NSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vbm9oYXNoLzY0L3BndGFibGUuaCIK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIHB0ZV90IHB0ZXBfZ2V0X2FuZF9jbGVhcihzdHJ1Y3QgbW1fc3RydWN0ICpt
bSwKICAgICAgICAgICB1bnNpZ25lZCBsb25nIGFkZHIsIHB0ZV90ICpwdGVwKQp7CiB1bnNp
Z25lZCBsb25nIG9sZCA9IHB0ZV91cGRhdGUobW0sIGFkZHIsIHB0ZXAsIH4wVUwsIDAsIDAp
OwogcmV0dXJuICgocHRlX3QpIHsgKG9sZCkgfSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHB0ZV9j
bGVhcihzdHJ1Y3QgbW1fc3RydWN0ICptbSwgdW5zaWduZWQgbG9uZyBhZGRyLAogICAgICAg
IHB0ZV90ICogcHRlcCkKewogcHRlX3VwZGF0ZShtbSwgYWRkciwgcHRlcCwgfjBVTCwgMCwg
MCk7Cn0KCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgX19wdGVwX3NldF9hY2Nlc3NfZmxhZ3Moc3RydWN0
IHZtX2FyZWFfc3RydWN0ICp2bWEsCiAgICAgICAgcHRlX3QgKnB0ZXAsIHB0ZV90IGVudHJ5
LAogICAgICAgIHVuc2lnbmVkIGxvbmcgYWRkcmVzcywKICAgICAgICBpbnQgcHNpemUpCnsK
IHVuc2lnbmVkIGxvbmcgYml0cyA9IHB0ZV92YWwoZW50cnkpICYKICAoMHgwMDEwMDAgfCAw
eDA0MDAwMCB8ICgweDAwMDAxMCB8IDB4MDAwMDIwKSB8IDB4MDAwMDgwKTsKCiB1bnNpZ25l
ZCBsb25nIG9sZCA9IHB0ZV92YWwoKnB0ZXApOwogKnB0ZXAgPSAoKHB0ZV90KSB7IChvbGQg
fCBiaXRzKSB9KTsKCiBmbHVzaF90bGJfcGFnZSh2bWEsIGFkZHJlc3MpOwp9CiMgMzEwICIu
L2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9ub2hhc2gvNjQvcGd0YWJsZS5oIgppbnQgbWFw
X2tlcm5lbF9wYWdlKHVuc2lnbmVkIGxvbmcgZWEsIHVuc2lnbmVkIGxvbmcgcGEsIHBncHJv
dF90IHByb3QpOwpleHRlcm4gaW50IF9fYXR0cmlidXRlX18oKF9fc2VjdGlvbl9fKCIubWVt
aW5pdC50ZXh0IikpKSBfX2F0dHJpYnV0ZV9fKChfX2NvbGRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm1lbW1hcF9jcmVhdGVfbWFwcGluZyh1
bnNpZ25lZCBsb25nIHN0YXJ0LAogICAgICAgICB1bnNpZ25lZCBsb25nIHBhZ2Vfc2l6ZSwK
ICAgICAgICAgdW5zaWduZWQgbG9uZyBwaHlzKTsKZXh0ZXJuIHZvaWQgdm1lbW1hcF9yZW1v
dmVfbWFwcGluZyh1bnNpZ25lZCBsb25nIHN0YXJ0LAogICAgICAgdW5zaWduZWQgbG9uZyBw
YWdlX3NpemUpOwojIDcgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL25vaGFzaC9wZ3Rh
YmxlLmgiIDIKIyA0MyAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vbm9oYXNoL3BndGFi
bGUuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIGludCBwdGVfd3JpdGUocHRlX3QgcHRlKQp7CiByZXR1cm4gcHRl
X3ZhbChwdGUpICYgKDB4MDAwMDEwIHwgMHgwMDAwMjApOwp9CgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHB0
ZV9yZWFkKHB0ZV90IHB0ZSkgeyByZXR1cm4gMTsgfQpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHB0ZV9kaXJ0
eShwdGVfdCBwdGUpIHsgcmV0dXJuIHB0ZV92YWwocHRlKSAmIDB4MDAxMDAwOyB9CnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBpbnQgcHRlX3NwZWNpYWwocHRlX3QgcHRlKSB7IHJldHVybiBwdGVfdmFsKHB0ZSkg
JiAweDAwMjAwMDsgfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHB0ZV9ub25lKHB0ZV90IHB0ZSkgeyByZXR1
cm4gKHB0ZV92YWwocHRlKSAmIH4wKSA9PSAwOyB9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIHB0ZV9oYXNo
cHRlKHB0ZV90IHB0ZSkgeyByZXR1cm4gZmFsc2U7IH0Kc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgcHRlX2Np
KHB0ZV90IHB0ZSkgeyByZXR1cm4gcHRlX3ZhbChwdGUpICYgMHg0MDAwMDA7IH0Kc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIGJvb2wgcHRlX2V4ZWMocHRlX3QgcHRlKSB7IHJldHVybiBwdGVfdmFsKHB0ZSkgJiAw
eDAwMDA4MDsgfQojIDczICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9ub2hhc2gvcGd0
YWJsZS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgaW50IHB0ZV9wcmVzZW50KHB0ZV90IHB0ZSkKewogcmV0dXJu
IHB0ZV92YWwocHRlKSAmIDB4MDAwMDAxOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBwdGVfaHdfdmFs
aWQocHRlX3QgcHRlKQp7CiByZXR1cm4gcHRlX3ZhbChwdGUpICYgMHgwMDAwMDE7Cn0KCgoK
CgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSBib29sIHB0ZV91c2VyKHB0ZV90IHB0ZSkKewogcmV0dXJuIChwdGVf
dmFsKHB0ZSkgJiAoMHgwMDAwMDggfCAweDAwMDAwNCkpID09ICgweDAwMDAwOCB8IDB4MDAw
MDA0KTsKfQoKCgoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgcHRlX2FjY2Vzc19wZXJtaXR0ZWQocHRl
X3QgcHRlLCBib29sIHdyaXRlKQp7CgoKCgogaWYgKCFwdGVfcHJlc2VudChwdGUpIHx8ICFw
dGVfdXNlcihwdGUpIHx8ICFwdGVfcmVhZChwdGUpKQogIHJldHVybiBmYWxzZTsKCiBpZiAo
d3JpdGUgJiYgIXB0ZV93cml0ZShwdGUpKQogIHJldHVybiBmYWxzZTsKCiByZXR1cm4gdHJ1
ZTsKfQoKCgoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIHB0ZV90IHBmbl9wdGUodW5zaWduZWQgbG9uZyBwZm4s
IHBncHJvdF90IHBncHJvdCkgewogcmV0dXJuICgocHRlX3QpIHsgKCgocHRlX2Jhc2ljX3Qp
KHBmbikgPDwgKDI0KSkgfCAoKHBncHJvdCkucGdwcm90KSkgfSkKICAgICAgICAgICAgICAg
ICAgICAgICAgICA7IH0Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHVuc2lnbmVkIGxvbmcgcHRlX3BmbihwdGVfdCBw
dGUpIHsKIHJldHVybiBwdGVfdmFsKHB0ZSkgPj4gKDI0KTsgfQoKCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBwdGVf
dCBwdGVfZXhwcm90ZWN0KHB0ZV90IHB0ZSkKewogcmV0dXJuICgocHRlX3QpIHsgKHB0ZV92
YWwocHRlKSAmIH4weDAwMDA4MCkgfSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBwdGVfdCBwdGVfbWtjbGVh
bihwdGVfdCBwdGUpCnsKIHJldHVybiAoKHB0ZV90KSB7IChwdGVfdmFsKHB0ZSkgJiB+MHgw
MDEwMDApIH0pOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgcHRlX3QgcHRlX21rb2xkKHB0ZV90IHB0ZSkKewog
cmV0dXJuICgocHRlX3QpIHsgKHB0ZV92YWwocHRlKSAmIH4weDA0MDAwMCkgfSk7Cn0KCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSBwdGVfdCBwdGVfbWtwdGUocHRlX3QgcHRlKQp7CiByZXR1cm4gcHRlOwp9Cgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgcHRlX3QgcHRlX21rc3BlY2lhbChwdGVfdCBwdGUpCnsKIHJldHVybiAoKHB0
ZV90KSB7IChwdGVfdmFsKHB0ZSkgfCAweDAwMjAwMCkgfSk7Cn0KCgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgcHRl
X3QgcHRlX21raHVnZShwdGVfdCBwdGUpCnsKIHJldHVybiAoKHB0ZV90KSB7IChwdGVfdmFs
KHB0ZSkpIH0pOwp9CiMgMTc0ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9ub2hhc2gv
cGd0YWJsZS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgcHRlX3QgcHRlX21vZGlmeShwdGVfdCBwdGUsIHBncHJv
dF90IG5ld3Byb3QpCnsKIHJldHVybiAoKHB0ZV90KSB7ICgocHRlX3ZhbChwdGUpICYgKCh+
KCgxVUwgPDwgKDI0KSkgLSAxKSkgfCAweDAwMTAwMCB8IDB4MDQwMDAwIHwgMHgwMDIwMDAp
KSB8ICgobmV3cHJvdCkucGdwcm90KSkgfSk7Cn0KCgoKCmV4dGVybiB2b2lkIHNldF9wdGVf
YXQoc3RydWN0IG1tX3N0cnVjdCAqbW0sIHVuc2lnbmVkIGxvbmcgYWRkciwgcHRlX3QgKnB0
ZXAsCiAgICAgICAgIHB0ZV90IHB0ZSk7CgoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIF9fc2V0X3B0
ZV9hdChzdHJ1Y3QgbW1fc3RydWN0ICptbSwgdW5zaWduZWQgbG9uZyBhZGRyLAogICAgcHRl
X3QgKnB0ZXAsIHB0ZV90IHB0ZSwgaW50IHBlcmNwdSkKewoKCgoKCiBpZiAoMCAmJiAxICYm
ICFwZXJjcHUpIHsKICBfX2FzbV9fIF9fdm9sYXRpbGVfXygiCQkJc3R3JVUwJVgwICUyLCUw
XG4JCQllaWVpb1xuCQkJc3R3JVUwJVgwICVMMiwlMSIKCgoKICA6ICI9bSIgKCpwdGVwKSwg
Ij1tIiAoKigodW5zaWduZWQgY2hhciAqKXB0ZXArNCkpCiAgOiAiciIgKHB0ZSkgOiAibWVt
b3J5Iik7CiAgcmV0dXJuOwogfQoKCgoKCgogKnB0ZXAgPSBwdGU7CiMgMjIyICIuL2FyY2gv
cG93ZXJwYy9pbmNsdWRlL2FzbS9ub2hhc2gvcGd0YWJsZS5oIgogaWYgKDEgJiYgKChhZGRy
KSA+PSAweDgwMDAwMDAwMDAwMDAwMDB1bCkpCiAgX19hc21fXyBfX3ZvbGF0aWxlX18gKCJz
eW5jIiA6IDogOiAibWVtb3J5Iik7Cn0KCgoKZXh0ZXJuIGludCBwdGVwX3NldF9hY2Nlc3Nf
ZmxhZ3Moc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEsIHVuc2lnbmVkIGxvbmcgYWRkcmVz
cywKICAgICBwdGVfdCAqcHRlcCwgcHRlX3QgZW50cnksIGludCBkaXJ0eSk7CiMgMjU5ICIu
L2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9ub2hhc2gvcGd0YWJsZS5oIgpzdHJ1Y3QgZmls
ZTsKZXh0ZXJuIHBncHJvdF90IHBoeXNfbWVtX2FjY2Vzc19wcm90KHN0cnVjdCBmaWxlICpm
aWxlLCB1bnNpZ25lZCBsb25nIHBmbiwKICAgICAgICAgdW5zaWduZWQgbG9uZyBzaXplLCBw
Z3Byb3RfdCB2bWFfcHJvdCk7CgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgaHVnZXBkX29rKGh1Z2VwZF90
IGhwZCkKewoKCgoKIHJldHVybiAoaHBkX3ZhbChocGQpICYmIChocGRfdmFsKGhwZCkgJiAw
eDgwMDAwMDAwMDAwMDAwMDBVTCkgPT0gMCk7Cgp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHBtZF9odWdl
KHBtZF90IHBtZCkKewogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgcHVkX2h1Z2UocHVk
X3QgcHVkKQp7CiByZXR1cm4gMDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBwZ2RfaHVnZShwZ2RfdCBw
Z2QpCnsKIHJldHVybiAwOwp9CiMgMzAxICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9u
b2hhc2gvcGd0YWJsZS5oIgp2b2lkIHVwZGF0ZV9tbXVfY2FjaGUoc3RydWN0IHZtX2FyZWFf
c3RydWN0ICp2bWEsIHVuc2lnbmVkIGxvbmcgYWRkcmVzcywgcHRlX3QgKnB0ZXApOwojIDIx
ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9wZ3RhYmxlLmgiIDIKIyA1MiAiLi9hcmNo
L3Bvd2VycGMvaW5jbHVkZS9hc20vcGd0YWJsZS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgcGdwcm90X3QgcHRl
X3BncHJvdChwdGVfdCBwdGUpCnsKIHVuc2lnbmVkIGxvbmcgcHRlX2ZsYWdzOwoKIHB0ZV9m
bGFncyA9IHB0ZV92YWwocHRlKSAmIH4ofigoMVVMIDw8ICgyNCkpIC0gMSkpOwogcmV0dXJu
ICgocGdwcm90X3QpIHsgKHB0ZV9mbGFncykgfSk7Cn0KIyA3MSAiLi9hcmNoL3Bvd2VycGMv
aW5jbHVkZS9hc20vcGd0YWJsZS5oIgpleHRlcm4gdW5zaWduZWQgbG9uZyBlbXB0eV96ZXJv
X3BhZ2VbXTsKCgpleHRlcm4gcGdkX3Qgc3dhcHBlcl9wZ19kaXJbXTsKCmV4dGVybiB2b2lk
IHBhZ2luZ19pbml0KHZvaWQpOwoKZXh0ZXJuIHVuc2lnbmVkIGxvbmcgaW9yZW1hcF9ib3Q7
CiMgOTIgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL3BndGFibGUuaCIKdW5zaWduZWQg
bG9uZyB2bWFsbG9jX3RvX3BoeXModm9pZCAqdm1hbGxvY19hZGRyKTsKCnZvaWQgcGd0YWJs
ZV9jYWNoZV9hZGQodW5zaWduZWQgaW50IHNoaWZ0KTsKCnB0ZV90ICplYXJseV9wdGVfYWxs
b2Nfa2VybmVsKHBtZF90ICpwbWRwLCB1bnNpZ25lZCBsb25nIHZhKTsKCgoKCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSB2b2lkIG1hcmtfaW5pdG1lbV9ueCh2b2lkKSB7IH0KIyAxMjMgIi4vYXJjaC9wb3dlcnBj
L2luY2x1ZGUvYXNtL3BndGFibGUuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgKnB0ZV9mcmFnX2dldCht
bV9jb250ZXh0X3QgKmN0eCkKewogcmV0dXJuICgodm9pZCAqKTApOwp9CgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
dm9pZCBwdGVfZnJhZ19zZXQobW1fY29udGV4dF90ICpjdHgsIHZvaWQgKnApCnsKfQoKCgoK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIGJvb2wgcG1kX2lzX2xlYWYocG1kX3QgcG1kKQp7CiByZXR1cm4gZmFsc2U7
Cn0KCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSBib29sIHB1ZF9pc19sZWFmKHB1ZF90IHB1ZCkKewogcmV0dXJu
IGZhbHNlOwp9CgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBwNGRfaXNfbGVhZihwNGRfdCBwNGQpCnsK
IHJldHVybiBmYWxzZTsKfQoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgaXNfaW9yZW1hcF9hZGRyKGNv
bnN0IHZvaWQgKngpCnsKIHVuc2lnbmVkIGxvbmcgYWRkciA9ICh1bnNpZ25lZCBsb25nKXg7
CgogcmV0dXJuIGFkZHIgPj0gKCgoMHg4MDAwMDAwMDAwMDAwMDAwVUwgKyAoMHgwMDAwMTAw
MDAwMDAwMDAwVUwgPj4gMSkpICsgMHg4MDAwMDAwMHVsKSkgJiYgYWRkciA8ICgweDgwMDAw
MDAwMDAwMDAwMDBVTCArIDB4MDAwMDEwMDAwMDAwMDAwMFVMKTsKfQojIDcgIi4vaW5jbHVk
ZS9saW51eC9wZ3RhYmxlLmgiIDIKCgoKCgoKCiMgMSAiLi9pbmNsdWRlL2FzbS1nZW5lcmlj
L3BndGFibGVfdWZmZC5oIiAxCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdh
eXNfaW5saW5lX18pKSBpbnQgcHRlX3VmZmRfd3AocHRlX3QgcHRlKQp7CiByZXR1cm4gMDsK
fQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgaW50IHBt
ZF91ZmZkX3dwKHBtZF90IHBtZCkKewogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJp
YnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHB0ZV90IHB0ZV9ta3VmZmRfd3AocHRlX3Qg
cHRlKQp7CiByZXR1cm4gcHRlOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdh
eXNfaW5saW5lX18pKSBwbWRfdCBwbWRfbWt1ZmZkX3dwKHBtZF90IHBtZCkKewogcmV0dXJu
IHBtZDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkg
cHRlX3QgcHRlX2NsZWFyX3VmZmRfd3AocHRlX3QgcHRlKQp7CiByZXR1cm4gcHRlOwp9Cgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBwbWRfdCBwbWRf
Y2xlYXJfdWZmZF93cChwbWRfdCBwbWQpCnsKIHJldHVybiBwbWQ7Cn0KCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBf
X2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHB0ZV90IHB0ZV9zd3BfbWt1ZmZk
X3dwKHB0ZV90IHB0ZSkKewogcmV0dXJuIHB0ZTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRl
X18oKF9fYWx3YXlzX2lubGluZV9fKSkgaW50IHB0ZV9zd3BfdWZmZF93cChwdGVfdCBwdGUp
CnsKIHJldHVybiAwOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5s
aW5lX18pKSBwdGVfdCBwdGVfc3dwX2NsZWFyX3VmZmRfd3AocHRlX3QgcHRlKQp7CiByZXR1
cm4gcHRlOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgcG1kX3QgcG1kX3N3cF9ta3VmZmRfd3AocG1kX3QgcG1k
KQp7CiByZXR1cm4gcG1kOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHBtZF9zd3BfdWZmZF93cChwbWRf
dCBwbWQpCnsKIHJldHVybiAwOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgcG1kX3QgcG1kX3N3cF9jbGVhcl91
ZmZkX3dwKHBtZF90IHBtZCkKewogcmV0dXJuIHBtZDsKfQojIDE1ICIuL2luY2x1ZGUvbGlu
dXgvcGd0YWJsZS5oIiAyCiMgNDMgIi4vaW5jbHVkZS9saW51eC9wZ3RhYmxlLmgiCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSB1bnNpZ25lZCBsb25nIHB0ZV9pbmRleCh1bnNpZ25lZCBsb25nIGFkZHJlc3MpCnsK
IHJldHVybiAoYWRkcmVzcyA+PiAxMikgJiAoKDEgPDwgOSkgLSAxKTsKfQoKCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSB1bnNpZ25lZCBsb25nIHBtZF9pbmRleCh1bnNpZ25lZCBsb25nIGFkZHJlc3MpCnsKIHJl
dHVybiAoYWRkcmVzcyA+PiAoMTIgKyA5KSkgJiAoKDEgPDwgNykgLSAxKTsKfQoKCgoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIHVuc2lnbmVkIGxvbmcgcHVkX2luZGV4KHVuc2lnbmVkIGxvbmcgYWRkcmVzcykK
ewogcmV0dXJuIChhZGRyZXNzID4+ICgoMTIgKyA5KSArIDcpKSAmICgoMSA8PCA5KSAtIDEp
Owp9CiMgNzAgIi4vaW5jbHVkZS9saW51eC9wZ3RhYmxlLmgiCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBwdGVfdCAq
cHRlX29mZnNldF9rZXJuZWwocG1kX3QgKnBtZCwgdW5zaWduZWQgbG9uZyBhZGRyZXNzKQp7
CiByZXR1cm4gKHB0ZV90ICopKHBtZF92YWwoKnBtZCkgJiB+MCkgKyBwdGVfaW5kZXgoYWRk
cmVzcyk7Cn0KIyA4OSAiLi9pbmNsdWRlL2xpbnV4L3BndGFibGUuaCIKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHBt
ZF90ICpwbWRfb2Zmc2V0KHB1ZF90ICpwdWQsIHVuc2lnbmVkIGxvbmcgYWRkcmVzcykKewog
cmV0dXJuIChwbWRfdCAqKShwdWRfdmFsKCpwdWQpICYgfjApICsgcG1kX2luZGV4KGFkZHJl
c3MpOwp9CgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgcHVkX3QgKnB1ZF9vZmZzZXQocDRkX3QgKnA0ZCwgdW5z
aWduZWQgbG9uZyBhZGRyZXNzKQp7CiByZXR1cm4gKHB1ZF90ICopKChwZ2RfdmFsKCgqcDRk
KS5wZ2QpKSAmIH4wKSArIHB1ZF9pbmRleChhZGRyZXNzKTsKfQoKCgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgcGdk
X3QgKnBnZF9vZmZzZXRfcGdkKHBnZF90ICpwZ2QsIHVuc2lnbmVkIGxvbmcgYWRkcmVzcykK
ewogcmV0dXJuIChwZ2QgKyAoKChhZGRyZXNzKSA+PiAoKCgxMiArIDkpICsgNykgKyA5KSkg
JiAoKDEgPDwgOSkgLSAxKSkpOwp9OwojIDEyOSAiLi9pbmNsdWRlL2xpbnV4L3BndGFibGUu
aCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIHBtZF90ICpwbWRfb2ZmKHN0cnVjdCBtbV9zdHJ1Y3QgKm1tLCB1bnNp
Z25lZCBsb25nIHZhKQp7CiByZXR1cm4gcG1kX29mZnNldChwdWRfb2Zmc2V0KHA0ZF9vZmZz
ZXQocGdkX29mZnNldF9wZ2QoKG1tKS0+cGdkLCAodmEpKSwgdmEpLCB2YSksIHZhKTsKfQoK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIHBtZF90ICpwbWRfb2ZmX2sodW5zaWduZWQgbG9uZyB2YSkKewogcmV0dXJu
IHBtZF9vZmZzZXQocHVkX29mZnNldChwNGRfb2Zmc2V0KHBnZF9vZmZzZXRfcGdkKCgmaW5p
dF9tbSktPnBnZCwgKCh2YSkpKSwgdmEpLCB2YSksIHZhKTsKfQoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHB0ZV90
ICp2aXJ0X3RvX2twdGUodW5zaWduZWQgbG9uZyB2YWRkcikKewogcG1kX3QgKnBtZCA9IHBt
ZF9vZmZfayh2YWRkcik7CgogcmV0dXJuICghcG1kX3ZhbCgqcG1kKSkgPyAoKHZvaWQgKikw
KSA6IHB0ZV9vZmZzZXRfa2VybmVsKHBtZCwgdmFkZHIpOwp9CiMgMTYxICIuL2luY2x1ZGUv
bGludXgvcGd0YWJsZS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHBtZHBfc2V0X2FjY2Vzc19mbGFncyhz
dHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnZtYSwKICAgICB1bnNpZ25lZCBsb25nIGFkZHJlc3Ms
IHBtZF90ICpwbWRwLAogICAgIHBtZF90IGVudHJ5LCBpbnQgZGlydHkpCnsKIGRvIHsgZXh0
ZXJuIHZvaWQgX19jb21waWxldGltZV9hc3NlcnRfMTIyKHZvaWQpIF9fYXR0cmlidXRlX18o
KF9fZXJyb3JfXygiQlVJTERfQlVHIGZhaWxlZCIpKSk7IGlmICghKCEoMSkpKSBfX2NvbXBp
bGV0aW1lX2Fzc2VydF8xMjIoKTsgfSB3aGlsZSAoMCk7CiByZXR1cm4gMDsKfQpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgaW50IHB1ZHBfc2V0X2FjY2Vzc19mbGFncyhzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnZt
YSwKICAgICB1bnNpZ25lZCBsb25nIGFkZHJlc3MsIHB1ZF90ICpwdWRwLAogICAgIHB1ZF90
IGVudHJ5LCBpbnQgZGlydHkpCnsKIGRvIHsgZXh0ZXJuIHZvaWQgX19jb21waWxldGltZV9h
c3NlcnRfMTIzKHZvaWQpIF9fYXR0cmlidXRlX18oKF9fZXJyb3JfXygiQlVJTERfQlVHIGZh
aWxlZCIpKSk7IGlmICghKCEoMSkpKSBfX2NvbXBpbGV0aW1lX2Fzc2VydF8xMjMoKTsgfSB3
aGlsZSAoMCk7CiByZXR1cm4gMDsKfQojIDIwOCAiLi9pbmNsdWRlL2xpbnV4L3BndGFibGUu
aCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIGludCBwbWRwX3Rlc3RfYW5kX2NsZWFyX3lvdW5nKHN0cnVjdCB2bV9h
cmVhX3N0cnVjdCAqdm1hLAogICAgICAgICB1bnNpZ25lZCBsb25nIGFkZHJlc3MsCiAgICAg
ICAgIHBtZF90ICpwbWRwKQp7CiBkbyB7IGV4dGVybiB2b2lkIF9fY29tcGlsZXRpbWVfYXNz
ZXJ0XzEyNCh2b2lkKSBfX2F0dHJpYnV0ZV9fKChfX2Vycm9yX18oIkJVSUxEX0JVRyBmYWls
ZWQiKSkpOyBpZiAoISghKDEpKSkgX19jb21waWxldGltZV9hc3NlcnRfMTI0KCk7IH0gd2hp
bGUgKDApOwogcmV0dXJuIDA7Cn0KIyAyMzIgIi4vaW5jbHVkZS9saW51eC9wZ3RhYmxlLmgi
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSBpbnQgcG1kcF9jbGVhcl9mbHVzaF95b3VuZyhzdHJ1Y3Qgdm1fYXJlYV9z
dHJ1Y3QgKnZtYSwKICAgICAgdW5zaWduZWQgbG9uZyBhZGRyZXNzLCBwbWRfdCAqcG1kcCkK
ewogZG8geyBleHRlcm4gdm9pZCBfX2NvbXBpbGV0aW1lX2Fzc2VydF8xMjUodm9pZCkgX19h
dHRyaWJ1dGVfXygoX19lcnJvcl9fKCJCVUlMRF9CVUcgZmFpbGVkIikpKTsgaWYgKCEoISgx
KSkpIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzEyNSgpOyB9IHdoaWxlICgwKTsKIHJldHVybiAw
Owp9CiMgMjUzICIuL2luY2x1ZGUvbGludXgvcGd0YWJsZS5oIgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgcHRlX3Qg
cHRlcF9nZXQocHRlX3QgKnB0ZXApCnsKIHJldHVybiAoeyBkbyB7IGV4dGVybiB2b2lkIF9f
Y29tcGlsZXRpbWVfYXNzZXJ0XzEyNih2b2lkKSBfX2F0dHJpYnV0ZV9fKChfX2Vycm9yX18o
IlVuc3VwcG9ydGVkIGFjY2VzcyBzaXplIGZvciB7UkVBRCxXUklURX1fT05DRSgpLiIpKSk7
IGlmICghKChzaXplb2YoKnB0ZXApID09IHNpemVvZihjaGFyKSB8fCBzaXplb2YoKnB0ZXAp
ID09IHNpemVvZihzaG9ydCkgfHwgc2l6ZW9mKCpwdGVwKSA9PSBzaXplb2YoaW50KSB8fCBz
aXplb2YoKnB0ZXApID09IHNpemVvZihsb25nKSkgfHwgc2l6ZW9mKCpwdGVwKSA9PSBzaXpl
b2YobG9uZyBsb25nKSkpIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzEyNigpOyB9IHdoaWxlICgw
KTsgKHsgdHlwZW9mKCBfR2VuZXJpYygoKnB0ZXApLCBjaGFyOiAoY2hhcikwLCB1bnNpZ25l
ZCBjaGFyOiAodW5zaWduZWQgY2hhcikwLCBzaWduZWQgY2hhcjogKHNpZ25lZCBjaGFyKTAs
IHVuc2lnbmVkIHNob3J0OiAodW5zaWduZWQgc2hvcnQpMCwgc2lnbmVkIHNob3J0OiAoc2ln
bmVkIHNob3J0KTAsIHVuc2lnbmVkIGludDogKHVuc2lnbmVkIGludCkwLCBzaWduZWQgaW50
OiAoc2lnbmVkIGludCkwLCB1bnNpZ25lZCBsb25nOiAodW5zaWduZWQgbG9uZykwLCBzaWdu
ZWQgbG9uZzogKHNpZ25lZCBsb25nKTAsIHVuc2lnbmVkIGxvbmcgbG9uZzogKHVuc2lnbmVk
IGxvbmcgbG9uZykwLCBzaWduZWQgbG9uZyBsb25nOiAoc2lnbmVkIGxvbmcgbG9uZykwLCBk
ZWZhdWx0OiAoKnB0ZXApKSkgX194ID0gKCooY29uc3Qgdm9sYXRpbGUgdHlwZW9mKCBfR2Vu
ZXJpYygoKnB0ZXApLCBjaGFyOiAoY2hhcikwLCB1bnNpZ25lZCBjaGFyOiAodW5zaWduZWQg
Y2hhcikwLCBzaWduZWQgY2hhcjogKHNpZ25lZCBjaGFyKTAsIHVuc2lnbmVkIHNob3J0OiAo
dW5zaWduZWQgc2hvcnQpMCwgc2lnbmVkIHNob3J0OiAoc2lnbmVkIHNob3J0KTAsIHVuc2ln
bmVkIGludDogKHVuc2lnbmVkIGludCkwLCBzaWduZWQgaW50OiAoc2lnbmVkIGludCkwLCB1
bnNpZ25lZCBsb25nOiAodW5zaWduZWQgbG9uZykwLCBzaWduZWQgbG9uZzogKHNpZ25lZCBs
b25nKTAsIHVuc2lnbmVkIGxvbmcgbG9uZzogKHVuc2lnbmVkIGxvbmcgbG9uZykwLCBzaWdu
ZWQgbG9uZyBsb25nOiAoc2lnbmVkIGxvbmcgbG9uZykwLCBkZWZhdWx0OiAoKnB0ZXApKSkg
KikmKCpwdGVwKSk7IGRvIHsgfSB3aGlsZSAoMCk7ICh0eXBlb2YoKnB0ZXApKV9feDsgfSk7
IH0pOwp9CiMgMzA0ICIuL2luY2x1ZGUvbGludXgvcGd0YWJsZS5oIgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgcHRl
X3QgcHRlcF9nZXRfYW5kX2NsZWFyX2Z1bGwoc3RydWN0IG1tX3N0cnVjdCAqbW0sCiAgICAg
ICAgIHVuc2lnbmVkIGxvbmcgYWRkcmVzcywgcHRlX3QgKnB0ZXAsCiAgICAgICAgIGludCBm
dWxsKQp7CiBwdGVfdCBwdGU7CiBwdGUgPSBwdGVwX2dldF9hbmRfY2xlYXIobW0sIGFkZHJl
c3MsIHB0ZXApOwogcmV0dXJuIHB0ZTsKfQojIDMyNCAiLi9pbmNsdWRlL2xpbnV4L3BndGFi
bGUuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIHZvaWQgdXBkYXRlX21tdV90bGIoc3RydWN0IHZtX2FyZWFfc3Ry
dWN0ICp2bWEsCiAgICB1bnNpZ25lZCBsb25nIGFkZHJlc3MsIHB0ZV90ICpwdGVwKQp7Cn0K
IyAzMzcgIi4vaW5jbHVkZS9saW51eC9wZ3RhYmxlLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHB0ZV9j
bGVhcl9ub3RfcHJlc2VudF9mdWxsKHN0cnVjdCBtbV9zdHJ1Y3QgKm1tLAogICAgICAgICAg
IHVuc2lnbmVkIGxvbmcgYWRkcmVzcywKICAgICAgICAgICBwdGVfdCAqcHRlcCwKICAgICAg
ICAgICBpbnQgZnVsbCkKewogcHRlX2NsZWFyKG1tLCBhZGRyZXNzLCBwdGVwKTsKfQoKCgpl
eHRlcm4gcHRlX3QgcHRlcF9jbGVhcl9mbHVzaChzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnZt
YSwKICAgICAgICAgdW5zaWduZWQgbG9uZyBhZGRyZXNzLAogICAgICAgICBwdGVfdCAqcHRl
cCk7CgoKCmV4dGVybiBwbWRfdCBwbWRwX2h1Z2VfY2xlYXJfZmx1c2goc3RydWN0IHZtX2Fy
ZWFfc3RydWN0ICp2bWEsCiAgICAgICAgIHVuc2lnbmVkIGxvbmcgYWRkcmVzcywKICAgICAg
ICAgcG1kX3QgKnBtZHApOwpleHRlcm4gcHVkX3QgcHVkcF9odWdlX2NsZWFyX2ZsdXNoKHN0
cnVjdCB2bV9hcmVhX3N0cnVjdCAqdm1hLAogICAgICAgICB1bnNpZ25lZCBsb25nIGFkZHJl
c3MsCiAgICAgICAgIHB1ZF90ICpwdWRwKTsKIyAzNzkgIi4vaW5jbHVkZS9saW51eC9wZ3Rh
YmxlLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSBwdGVfdCBwdGVfc3dfbWt5b3VuZyhwdGVfdCBwdGUpCnsKIHJl
dHVybiBwdGU7Cn0KIyA0MTkgIi4vaW5jbHVkZS9saW51eC9wZ3RhYmxlLmgiCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSB2b2lkIHBtZHBfc2V0X3dycHJvdGVjdChzdHJ1Y3QgbW1fc3RydWN0ICptbSwKICAgICAg
ICAgIHVuc2lnbmVkIGxvbmcgYWRkcmVzcywgcG1kX3QgKnBtZHApCnsKIGRvIHsgZXh0ZXJu
IHZvaWQgX19jb21waWxldGltZV9hc3NlcnRfMTI3KHZvaWQpIF9fYXR0cmlidXRlX18oKF9f
ZXJyb3JfXygiQlVJTERfQlVHIGZhaWxlZCIpKSk7IGlmICghKCEoMSkpKSBfX2NvbXBpbGV0
aW1lX2Fzc2VydF8xMjcoKTsgfSB3aGlsZSAoMCk7Cn0KIyA0MzYgIi4vaW5jbHVkZS9saW51
eC9wZ3RhYmxlLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHB1ZHBfc2V0X3dycHJvdGVjdChzdHJ1Y3Qg
bW1fc3RydWN0ICptbSwKICAgICAgICAgIHVuc2lnbmVkIGxvbmcgYWRkcmVzcywgcHVkX3Qg
KnB1ZHApCnsKIGRvIHsgZXh0ZXJuIHZvaWQgX19jb21waWxldGltZV9hc3NlcnRfMTI4KHZv
aWQpIF9fYXR0cmlidXRlX18oKF9fZXJyb3JfXygiQlVJTERfQlVHIGZhaWxlZCIpKSk7IGlm
ICghKCEoMSkpKSBfX2NvbXBpbGV0aW1lX2Fzc2VydF8xMjgoKTsgfSB3aGlsZSAoMCk7Cn0K
IyA0NDkgIi4vaW5jbHVkZS9saW51eC9wZ3RhYmxlLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBwbWRfdCBwbWRw
X2NvbGxhcHNlX2ZsdXNoKHN0cnVjdCB2bV9hcmVhX3N0cnVjdCAqdm1hLAogICAgIHVuc2ln
bmVkIGxvbmcgYWRkcmVzcywKICAgICBwbWRfdCAqcG1kcCkKewogZG8geyBleHRlcm4gdm9p
ZCBfX2NvbXBpbGV0aW1lX2Fzc2VydF8xMjkodm9pZCkgX19hdHRyaWJ1dGVfXygoX19lcnJv
cl9fKCJCVUlMRF9CVUcgZmFpbGVkIikpKTsgaWYgKCEoISgxKSkpIF9fY29tcGlsZXRpbWVf
YXNzZXJ0XzEyOSgpOyB9IHdoaWxlICgwKTsKIHJldHVybiAqcG1kcDsKfQoKCgoKCmV4dGVy
biB2b2lkIHBndGFibGVfdHJhbnNfaHVnZV9kZXBvc2l0KHN0cnVjdCBtbV9zdHJ1Y3QgKm1t
LCBwbWRfdCAqcG1kcCwKICAgICAgICAgICBwZ3RhYmxlX3QgcGd0YWJsZSk7CgoKCmV4dGVy
biBwZ3RhYmxlX3QgcGd0YWJsZV90cmFuc19odWdlX3dpdGhkcmF3KHN0cnVjdCBtbV9zdHJ1
Y3QgKm1tLCBwbWRfdCAqcG1kcCk7CiMgNDg1ICIuL2luY2x1ZGUvbGludXgvcGd0YWJsZS5o
IgpleHRlcm4gcG1kX3QgcG1kcF9pbnZhbGlkYXRlKHN0cnVjdCB2bV9hcmVhX3N0cnVjdCAq
dm1hLCB1bnNpZ25lZCBsb25nIGFkZHJlc3MsCiAgICAgICBwbWRfdCAqcG1kcCk7CiMgNTAz
ICIuL2luY2x1ZGUvbGludXgvcGd0YWJsZS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHB0ZV91bnVzZWQo
cHRlX3QgcHRlKQp7CiByZXR1cm4gMDsKfQojIDUzNSAiLi9pbmNsdWRlL2xpbnV4L3BndGFi
bGUuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIGludCBwbWRfc2FtZShwbWRfdCBwbWRfYSwgcG1kX3QgcG1kX2Ip
CnsKIHJldHVybiBwbWRfdmFsKHBtZF9hKSA9PSBwbWRfdmFsKHBtZF9iKTsKfQoKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIGludCBwdWRfc2FtZShwdWRfdCBwdWRfYSwgcHVkX3QgcHVkX2IpCnsKIHJldHVybiBw
dWRfdmFsKHB1ZF9hKSA9PSBwdWRfdmFsKHB1ZF9iKTsKfQoKCgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHA0
ZF9zYW1lKHA0ZF90IHA0ZF9hLCBwNGRfdCBwNGRfYikKewogcmV0dXJuIChwZ2RfdmFsKChw
NGRfYSkucGdkKSkgPT0gKHBnZF92YWwoKHA0ZF9iKS5wZ2QpKTsKfQoKCgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
aW50IHBnZF9zYW1lKHBnZF90IHBnZF9hLCBwZ2RfdCBwZ2RfYikKewogcmV0dXJuIHBnZF92
YWwocGdkX2EpID09IHBnZF92YWwocGdkX2IpOwp9CiMgNjA3ICIuL2luY2x1ZGUvbGludXgv
cGd0YWJsZS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBhcmNoX2RvX3N3YXBfcGFnZShzdHJ1Y3QgbW1f
c3RydWN0ICptbSwKICAgICAgICAgc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEsCiAgICAg
ICAgIHVuc2lnbmVkIGxvbmcgYWRkciwKICAgICAgICAgcHRlX3QgcHRlLCBwdGVfdCBvbGRw
dGUpCnsKCn0KIyA2MjUgIi4vaW5jbHVkZS9saW51eC9wZ3RhYmxlLmgiCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBp
bnQgYXJjaF91bm1hcF9vbmUoc3RydWN0IG1tX3N0cnVjdCAqbW0sCiAgICAgIHN0cnVjdCB2
bV9hcmVhX3N0cnVjdCAqdm1hLAogICAgICB1bnNpZ25lZCBsb25nIGFkZHIsCiAgICAgIHB0
ZV90IG9yaWdfcHRlKQp7CiByZXR1cm4gMDsKfQojIDY3MiAiLi9pbmNsdWRlL2xpbnV4L3Bn
dGFibGUuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHBncHJvdF90IHBncHJvdF9tb2RpZnkocGdwcm90X3Qgb2xk
cHJvdCwgcGdwcm90X3QgbmV3cHJvdCkKewogaWYgKCgob2xkcHJvdCkucGdwcm90KSA9PSAo
KCgoKHBncHJvdF90KSB7ICgoKChvbGRwcm90KS5wZ3Byb3QpICYgfigweDIwMDAwMCB8IDB4
MTAwMDAwIHwgMHg0MDAwMDAgfCAweDgwMDAwMCkpIHwgMHg0MDAwMDAgfCAweDEwMDAwMCkg
fSkpKS5wZ3Byb3QpKQogIG5ld3Byb3QgPSAoKChwZ3Byb3RfdCkgeyAoKCgobmV3cHJvdCku
cGdwcm90KSAmIH4oMHgyMDAwMDAgfCAweDEwMDAwMCB8IDB4NDAwMDAwIHwgMHg4MDAwMDAp
KSB8IDB4NDAwMDAwIHwgMHgxMDAwMDApIH0pKTsKIGlmICgoKG9sZHByb3QpLnBncHJvdCkg
PT0gKCgoKChwZ3Byb3RfdCkgeyAoKCgob2xkcHJvdCkucGdwcm90KSAmIH4oMHgyMDAwMDAg
fCAweDEwMDAwMCB8IDB4NDAwMDAwIHwgMHg4MDAwMDApKSB8IDB4NDAwMDAwKSB9KSkpLnBn
cHJvdCkpCiAgbmV3cHJvdCA9ICgoKHBncHJvdF90KSB7ICgoKChuZXdwcm90KS5wZ3Byb3Qp
ICYgfigweDIwMDAwMCB8IDB4MTAwMDAwIHwgMHg0MDAwMDAgfCAweDgwMDAwMCkpIHwgMHg0
MDAwMDApIH0pKTsKIGlmICgoKG9sZHByb3QpLnBncHJvdCkgPT0gKCgoKChwZ3Byb3RfdCkg
eyAoKCgob2xkcHJvdCkucGdwcm90KSAmIH4oMHgyMDAwMDAgfCAweDEwMDAwMCB8IDB4NDAw
MDAwIHwgMHg4MDAwMDApKSB8IDB4NDAwMDAwIHwgMHgxMDAwMDApIH0pKSkucGdwcm90KSkK
ICBuZXdwcm90ID0gKCgocGdwcm90X3QpIHsgKCgoKG5ld3Byb3QpLnBncHJvdCkgJiB+KDB4
MjAwMDAwIHwgMHgxMDAwMDAgfCAweDQwMDAwMCB8IDB4ODAwMDAwKSkgfCAweDQwMDAwMCB8
IDB4MTAwMDAwKSB9KSk7CiByZXR1cm4gbmV3cHJvdDsKfQojIDcyMSAiLi9pbmNsdWRlL2xp
bnV4L3BndGFibGUuaCIKdm9pZCBwZ2RfY2xlYXJfYmFkKHBnZF90ICopOwojIDczMCAiLi9p
bmNsdWRlL2xpbnV4L3BndGFibGUuaCIKdm9pZCBwdWRfY2xlYXJfYmFkKHB1ZF90ICopOwoK
CgoKdm9pZCBwbWRfY2xlYXJfYmFkKHBtZF90ICopOwoKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBwZ2Rfbm9u
ZV9vcl9jbGVhcl9iYWQocGdkX3QgKnBnZCkKewogaWYgKHBnZF9ub25lKCpwZ2QpKQogIHJl
dHVybiAxOwogaWYgKF9fYnVpbHRpbl9leHBlY3QoISEocGdkX2JhZCgqcGdkKSksIDApKSB7
CiAgcGdkX2NsZWFyX2JhZChwZ2QpOwogIHJldHVybiAxOwogfQogcmV0dXJuIDA7Cn0KCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSBpbnQgcDRkX25vbmVfb3JfY2xlYXJfYmFkKHA0ZF90ICpwNGQpCnsKIGlmICgo
IShwZ2RfdmFsKCgqcDRkKS5wZ2QpKSkpCiAgcmV0dXJuIDE7CiBpZiAoX19idWlsdGluX2V4
cGVjdCghISgoKHBnZF92YWwoKCpwNGQpLnBnZCkpID09IDApKSwgMCkpIHsKICBkbyB7IH0g
d2hpbGUgKDApOwogIHJldHVybiAxOwogfQogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQg
cHVkX25vbmVfb3JfY2xlYXJfYmFkKHB1ZF90ICpwdWQpCnsKIGlmICgoIXB1ZF92YWwoKnB1
ZCkpKQogIHJldHVybiAxOwogaWYgKF9fYnVpbHRpbl9leHBlY3QoISEoKCEoKHB1ZF92YWwo
KnB1ZCkpID49IDB4ODAwMDAwMDAwMDAwMDAwMHVsKSB8fCAocHVkX3ZhbCgqcHVkKSAmICgo
c2l6ZW9mKHBtZF90KSA8PCA3KS0xKSkpKSwgMCkpIHsKICBwdWRfY2xlYXJfYmFkKHB1ZCk7
CiAgcmV0dXJuIDE7CiB9CiByZXR1cm4gMDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBwbWRfbm9uZV9v
cl9jbGVhcl9iYWQocG1kX3QgKnBtZCkKewogaWYgKCghcG1kX3ZhbCgqcG1kKSkpCiAgcmV0
dXJuIDE7CiBpZiAoX19idWlsdGluX2V4cGVjdCghISgoISgocG1kX3ZhbCgqcG1kKSkgPj0g
MHg4MDAwMDAwMDAwMDAwMDAwdWwpIHx8IChwbWRfdmFsKCpwbWQpICYgKChzaXplb2YocHRl
X3QpIDw8IDkpLTEpKSkpLCAwKSkgewogIHBtZF9jbGVhcl9iYWQocG1kKTsKICByZXR1cm4g
MTsKIH0KIHJldHVybiAwOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgcHRlX3QgX19wdGVwX21vZGlmeV9wcm90
X3N0YXJ0KHN0cnVjdCB2bV9hcmVhX3N0cnVjdCAqdm1hLAogICAgICAgICAgdW5zaWduZWQg
bG9uZyBhZGRyLAogICAgICAgICAgcHRlX3QgKnB0ZXApCnsKCgoKCgogcmV0dXJuIHB0ZXBf
Z2V0X2FuZF9jbGVhcih2bWEtPnZtX21tLCBhZGRyLCBwdGVwKTsKfQoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZv
aWQgX19wdGVwX21vZGlmeV9wcm90X2NvbW1pdChzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnZt
YSwKICAgICAgICAgIHVuc2lnbmVkIGxvbmcgYWRkciwKICAgICAgICAgIHB0ZV90ICpwdGVw
LCBwdGVfdCBwdGUpCnsKCgoKCiBzZXRfcHRlX2F0KHZtYS0+dm1fbW0sIGFkZHIsIHB0ZXAs
IHB0ZSk7Cn0KIyA4MTkgIi4vaW5jbHVkZS9saW51eC9wZ3RhYmxlLmgiCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBw
dGVfdCBwdGVwX21vZGlmeV9wcm90X3N0YXJ0KHN0cnVjdCB2bV9hcmVhX3N0cnVjdCAqdm1h
LAogICAgICAgIHVuc2lnbmVkIGxvbmcgYWRkciwKICAgICAgICBwdGVfdCAqcHRlcCkKewog
cmV0dXJuIF9fcHRlcF9tb2RpZnlfcHJvdF9zdGFydCh2bWEsIGFkZHIsIHB0ZXApOwp9CgoK
CgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIHZvaWQgcHRlcF9tb2RpZnlfcHJvdF9jb21taXQoc3RydWN0IHZtX2Fy
ZWFfc3RydWN0ICp2bWEsCiAgICAgICAgdW5zaWduZWQgbG9uZyBhZGRyLAogICAgICAgIHB0
ZV90ICpwdGVwLCBwdGVfdCBvbGRfcHRlLCBwdGVfdCBwdGUpCnsKIF9fcHRlcF9tb2RpZnlf
cHJvdF9jb21taXQodm1hLCBhZGRyLCBwdGVwLCBwdGUpOwp9CiMgOTA1ICIuL2luY2x1ZGUv
bGludXgvcGd0YWJsZS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHB0ZV9zb2Z0X2RpcnR5KHB0ZV90IHB0
ZSkKewogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgcG1kX3NvZnRfZGlydHkocG1kX3Qg
cG1kKQp7CiByZXR1cm4gMDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHB0ZV90IHB0ZV9ta3NvZnRfZGlydHko
cHRlX3QgcHRlKQp7CiByZXR1cm4gcHRlOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgcG1kX3QgcG1kX21rc29m
dF9kaXJ0eShwbWRfdCBwbWQpCnsKIHJldHVybiBwbWQ7Cn0KCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBwdGVfdCBw
dGVfY2xlYXJfc29mdF9kaXJ0eShwdGVfdCBwdGUpCnsKIHJldHVybiBwdGU7Cn0KCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBwbWRfdCBwbWRfY2xlYXJfc29mdF9kaXJ0eShwbWRfdCBwbWQpCnsKIHJldHVybiBw
bWQ7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSBwdGVfdCBwdGVfc3dwX21rc29mdF9kaXJ0eShwdGVfdCBwdGUp
CnsKIHJldHVybiBwdGU7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgcHRlX3N3cF9zb2Z0X2RpcnR5KHB0
ZV90IHB0ZSkKewogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBwdGVfdCBwdGVfc3dwX2NsZWFy
X3NvZnRfZGlydHkocHRlX3QgcHRlKQp7CiByZXR1cm4gcHRlOwp9CgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgcG1k
X3QgcG1kX3N3cF9ta3NvZnRfZGlydHkocG1kX3QgcG1kKQp7CiByZXR1cm4gcG1kOwp9Cgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgaW50IHBtZF9zd3Bfc29mdF9kaXJ0eShwbWRfdCBwbWQpCnsKIHJldHVybiAw
Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgcG1kX3QgcG1kX3N3cF9jbGVhcl9zb2Z0X2RpcnR5KHBtZF90IHBt
ZCkKewogcmV0dXJuIHBtZDsKfQojIDk3NyAiLi9pbmNsdWRlL2xpbnV4L3BndGFibGUuaCIK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIGludCB0cmFja19wZm5fcmVtYXAoc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2
bWEsIHBncHJvdF90ICpwcm90LAogICAgICB1bnNpZ25lZCBsb25nIHBmbiwgdW5zaWduZWQg
bG9uZyBhZGRyLAogICAgICB1bnNpZ25lZCBsb25nIHNpemUpCnsKIHJldHVybiAwOwp9CgoK
CgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIHZvaWQgdHJhY2tfcGZuX2luc2VydChzdHJ1Y3Qgdm1fYXJlYV9zdHJ1
Y3QgKnZtYSwgcGdwcm90X3QgKnByb3QsCiAgICAgICAgcGZuX3QgcGZuKQp7Cn0KCgoKCgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgaW50IHRyYWNrX3Bmbl9jb3B5KHN0cnVjdCB2bV9hcmVhX3N0cnVjdCAqdm1h
KQp7CiByZXR1cm4gMDsKfQoKCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCB1bnRyYWNrX3BmbihzdHJ1
Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnZtYSwKICAgICAgICAgIHVuc2lnbmVkIGxvbmcgcGZuLCB1
bnNpZ25lZCBsb25nIHNpemUpCnsKfQoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgdW50cmFja19wZm5f
bW92ZWQoc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEpCnsKfQojIDEwNDEgIi4vaW5jbHVk
ZS9saW51eC9wZ3RhYmxlLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgaXNfemVyb19wZm4odW5zaWduZWQg
bG9uZyBwZm4pCnsKIGV4dGVybiB1bnNpZ25lZCBsb25nIHplcm9fcGZuOwogcmV0dXJuIHBm
biA9PSB6ZXJvX3BmbjsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHVuc2lnbmVkIGxvbmcgbXlfemVyb19wZm4o
dW5zaWduZWQgbG9uZyBhZGRyKQp7CiBleHRlcm4gdW5zaWduZWQgbG9uZyB6ZXJvX3BmbjsK
IHJldHVybiB6ZXJvX3BmbjsKfQoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgcG1kX3RyYW5zX2h1Z2Uo
cG1kX3QgcG1kKQp7CiByZXR1cm4gMDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBwbWRfd3JpdGUocG1k
X3QgcG1kKQp7CiBkbyB7IF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJIiAidHdpIDMxLCAw
LCAwIiAiXG4iICIuc2VjdGlvbiBfX2J1Z190YWJsZSxcImF3XCJcbiIgIjI6XHQiICIuOGJ5
dGUiICIgIiAiMWIsICUwXG4iICJcdC5zaG9ydCAlMSwgJTJcbiIgIi5vcmcgMmIrJTNcbiIg
Ii5wcmV2aW91c1xuIiA6IDogImkiICgiLi9pbmNsdWRlL2xpbnV4L3BndGFibGUuaCIpLCAi
aSIgKDEwNjQpLCAiaSIgKDApLCAiaSIgKHNpemVvZihzdHJ1Y3QgYnVnX2VudHJ5KSkpOyBk
byB7IDsgYXNtIHZvbGF0aWxlKCIiKTsgX19idWlsdGluX3VucmVhY2hhYmxlKCk7IH0gd2hp
bGUgKDApOyB9IHdoaWxlICgwKTsKIHJldHVybiAwOwp9CiMgMTA3OSAiLi9pbmNsdWRlL2xp
bnV4L3BndGFibGUuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBwbWRfZGV2bWFwKHBtZF90IHBtZCkKewog
cmV0dXJuIDA7Cn0Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBwdWRfZGV2bWFwKHB1ZF90IHB1ZCkKewogcmV0
dXJuIDA7Cn0Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIGludCBwZ2RfZGV2bWFwKHBnZF90IHBnZCkKewogcmV0dXJu
IDA7Cn0KCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHB1ZF90cmFuc19odWdlKHB1ZF90IHB1ZCkKewog
cmV0dXJuIDA7Cn0KCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBwdWRfbm9uZV9vcl90cmFuc19odWdlX29y
X2Rldl9vcl9jbGVhcl9iYWQocHVkX3QgKnB1ZCkKewogcHVkX3QgcHVkdmFsID0gKHsgZG8g
eyBleHRlcm4gdm9pZCBfX2NvbXBpbGV0aW1lX2Fzc2VydF8xMzAodm9pZCkgX19hdHRyaWJ1
dGVfXygoX19lcnJvcl9fKCJVbnN1cHBvcnRlZCBhY2Nlc3Mgc2l6ZSBmb3Ige1JFQUQsV1JJ
VEV9X09OQ0UoKS4iKSkpOyBpZiAoISgoc2l6ZW9mKCpwdWQpID09IHNpemVvZihjaGFyKSB8
fCBzaXplb2YoKnB1ZCkgPT0gc2l6ZW9mKHNob3J0KSB8fCBzaXplb2YoKnB1ZCkgPT0gc2l6
ZW9mKGludCkgfHwgc2l6ZW9mKCpwdWQpID09IHNpemVvZihsb25nKSkgfHwgc2l6ZW9mKCpw
dWQpID09IHNpemVvZihsb25nIGxvbmcpKSkgX19jb21waWxldGltZV9hc3NlcnRfMTMwKCk7
IH0gd2hpbGUgKDApOyAoeyB0eXBlb2YoIF9HZW5lcmljKCgqcHVkKSwgY2hhcjogKGNoYXIp
MCwgdW5zaWduZWQgY2hhcjogKHVuc2lnbmVkIGNoYXIpMCwgc2lnbmVkIGNoYXI6IChzaWdu
ZWQgY2hhcikwLCB1bnNpZ25lZCBzaG9ydDogKHVuc2lnbmVkIHNob3J0KTAsIHNpZ25lZCBz
aG9ydDogKHNpZ25lZCBzaG9ydCkwLCB1bnNpZ25lZCBpbnQ6ICh1bnNpZ25lZCBpbnQpMCwg
c2lnbmVkIGludDogKHNpZ25lZCBpbnQpMCwgdW5zaWduZWQgbG9uZzogKHVuc2lnbmVkIGxv
bmcpMCwgc2lnbmVkIGxvbmc6IChzaWduZWQgbG9uZykwLCB1bnNpZ25lZCBsb25nIGxvbmc6
ICh1bnNpZ25lZCBsb25nIGxvbmcpMCwgc2lnbmVkIGxvbmcgbG9uZzogKHNpZ25lZCBsb25n
IGxvbmcpMCwgZGVmYXVsdDogKCpwdWQpKSkgX194ID0gKCooY29uc3Qgdm9sYXRpbGUgdHlw
ZW9mKCBfR2VuZXJpYygoKnB1ZCksIGNoYXI6IChjaGFyKTAsIHVuc2lnbmVkIGNoYXI6ICh1
bnNpZ25lZCBjaGFyKTAsIHNpZ25lZCBjaGFyOiAoc2lnbmVkIGNoYXIpMCwgdW5zaWduZWQg
c2hvcnQ6ICh1bnNpZ25lZCBzaG9ydCkwLCBzaWduZWQgc2hvcnQ6IChzaWduZWQgc2hvcnQp
MCwgdW5zaWduZWQgaW50OiAodW5zaWduZWQgaW50KTAsIHNpZ25lZCBpbnQ6IChzaWduZWQg
aW50KTAsIHVuc2lnbmVkIGxvbmc6ICh1bnNpZ25lZCBsb25nKTAsIHNpZ25lZCBsb25nOiAo
c2lnbmVkIGxvbmcpMCwgdW5zaWduZWQgbG9uZyBsb25nOiAodW5zaWduZWQgbG9uZyBsb25n
KTAsIHNpZ25lZCBsb25nIGxvbmc6IChzaWduZWQgbG9uZyBsb25nKTAsIGRlZmF1bHQ6ICgq
cHVkKSkpICopJigqcHVkKSk7IGRvIHsgfSB3aGlsZSAoMCk7ICh0eXBlb2YoKnB1ZCkpX194
OyB9KTsgfSk7CgogaWYgKCghcHVkX3ZhbChwdWR2YWwpKSB8fCBwdWRfdHJhbnNfaHVnZShw
dWR2YWwpIHx8IHB1ZF9kZXZtYXAocHVkdmFsKSkKICByZXR1cm4gMTsKIGlmIChfX2J1aWx0
aW5fZXhwZWN0KCEhKCghKChwdWRfdmFsKHB1ZHZhbCkpID49IDB4ODAwMDAwMDAwMDAwMDAw
MHVsKSB8fCAocHVkX3ZhbChwdWR2YWwpICYgKChzaXplb2YocG1kX3QpIDw8IDcpLTEpKSkp
LCAwKSkgewogIHB1ZF9jbGVhcl9iYWQocHVkKTsKICByZXR1cm4gMTsKIH0KIHJldHVybiAw
Owp9CgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIGludCBwdWRfdHJhbnNfdW5zdGFibGUocHVkX3QgKnB1ZCkKewoK
CgoKIHJldHVybiAwOwoKfQoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBwbWRfdCBwbWRfcmVhZF9hdG9taWMocG1k
X3QgKnBtZHApCnsKCgoKCgogcmV0dXJuICpwbWRwOwp9CiMgMTE2MyAiLi9pbmNsdWRlL2xp
bnV4L3BndGFibGUuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBwbWRfbm9uZV9vcl90cmFuc19odWdlX29y
X2NsZWFyX2JhZChwbWRfdCAqcG1kKQp7CiBwbWRfdCBwbWR2YWwgPSBwbWRfcmVhZF9hdG9t
aWMocG1kKTsKIyAxMTk4ICIuL2luY2x1ZGUvbGludXgvcGd0YWJsZS5oIgogaWYgKCghcG1k
X3ZhbChwbWR2YWwpKSB8fCBwbWRfdHJhbnNfaHVnZShwbWR2YWwpIHx8CiAgKDAgJiYgISgh
KCFwbWRfdmFsKHBtZHZhbCkpKSkpCiAgcmV0dXJuIDE7CiBpZiAoX19idWlsdGluX2V4cGVj
dCghISgoISgocG1kX3ZhbChwbWR2YWwpKSA+PSAweDgwMDAwMDAwMDAwMDAwMDB1bCkgfHwg
KHBtZF92YWwocG1kdmFsKSAmICgoc2l6ZW9mKHB0ZV90KSA8PCA5KS0xKSkpKSwgMCkpIHsK
ICBwbWRfY2xlYXJfYmFkKHBtZCk7CiAgcmV0dXJuIDE7CiB9CiByZXR1cm4gMDsKfQojIDEy
MjAgIi4vaW5jbHVkZS9saW51eC9wZ3RhYmxlLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgcG1kX3RyYW5z
X3Vuc3RhYmxlKHBtZF90ICpwbWQpCnsKCgoKIHJldHVybiAwOwoKfQojIDEyMzggIi4vaW5j
bHVkZS9saW51eC9wZ3RhYmxlLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgcHRlX3Byb3Rub25lKHB0ZV90
IHB0ZSkKewogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgcG1kX3Byb3Rub25lKHBtZF90
IHBtZCkKewogcmV0dXJuIDA7Cn0KIyAxMjc1ICIuL2luY2x1ZGUvbGludXgvcGd0YWJsZS5o
IgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgaW50IHA0ZF9zZXRfaHVnZShwNGRfdCAqcDRkLCBwaHlzX2FkZHJfdCBh
ZGRyLCBwZ3Byb3RfdCBwcm90KQp7CiByZXR1cm4gMDsKfQpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHB1ZF9z
ZXRfaHVnZShwdWRfdCAqcHVkLCBwaHlzX2FkZHJfdCBhZGRyLCBwZ3Byb3RfdCBwcm90KQp7
CiByZXR1cm4gMDsKfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHBtZF9zZXRfaHVnZShwbWRfdCAqcG1kLCBw
aHlzX2FkZHJfdCBhZGRyLCBwZ3Byb3RfdCBwcm90KQp7CiByZXR1cm4gMDsKfQpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgaW50IHA0ZF9jbGVhcl9odWdlKHA0ZF90ICpwNGQpCnsKIHJldHVybiAwOwp9CnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBpbnQgcHVkX2NsZWFyX2h1Z2UocHVkX3QgKnB1ZCkKewogcmV0dXJuIDA7Cn0Kc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIGludCBwbWRfY2xlYXJfaHVnZShwbWRfdCAqcG1kKQp7CiByZXR1cm4gMDsKfQpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgaW50IHA0ZF9mcmVlX3B1ZF9wYWdlKHA0ZF90ICpwNGQsIHVuc2lnbmVkIGxv
bmcgYWRkcikKewogcmV0dXJuIDA7Cn0Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBwdWRfZnJlZV9wbWRfcGFn
ZShwdWRfdCAqcHVkLCB1bnNpZ25lZCBsb25nIGFkZHIpCnsKIHJldHVybiAwOwp9CnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBpbnQgcG1kX2ZyZWVfcHRlX3BhZ2UocG1kX3QgKnBtZCwgdW5zaWduZWQgbG9uZyBh
ZGRyKQp7CiByZXR1cm4gMDsKfQojIDEzMzIgIi4vaW5jbHVkZS9saW51eC9wZ3RhYmxlLmgi
CnN0cnVjdCBmaWxlOwppbnQgcGh5c19tZW1fYWNjZXNzX3Byb3RfYWxsb3dlZChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdW5zaWduZWQgbG9uZyBwZm4sCiAgIHVuc2lnbmVkIGxvbmcgc2l6ZSwg
cGdwcm90X3QgKnZtYV9wcm90KTsKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBpbml0X2VzcGZpeF9ic3Ao
dm9pZCkgeyB9CgoKZXh0ZXJuIHZvaWQgX19hdHRyaWJ1dGVfXygoX19zZWN0aW9uX18oIi5p
bml0LnRleHQiKSkpIF9fYXR0cmlidXRlX18oKF9fY29sZF9fKSkgcGd0YWJsZV9jYWNoZV9p
bml0KHZvaWQpOwoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIHBmbl9tb2RpZnlfYWxsb3dlZCh1bnNpZ25l
ZCBsb25nIHBmbiwgcGdwcm90X3QgcHJvdCkKewogcmV0dXJuIHRydWU7Cn0KCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBib29sIGFyY2hfaGFzX3Bmbl9tb2RpZnlfY2hlY2sodm9pZCkKewogcmV0dXJuIGZhbHNl
Owp9CiMgMTM5MyAiLi9pbmNsdWRlL2xpbnV4L3BndGFibGUuaCIKdHlwZWRlZiB1bnNpZ25l
ZCBpbnQgcGd0YmxfbW9kX21hc2s7CiMgMzMgIi4vaW5jbHVkZS9saW51eC9tbS5oIiAyCgpz
dHJ1Y3QgbWVtcG9saWN5OwpzdHJ1Y3QgYW5vbl92bWE7CnN0cnVjdCBhbm9uX3ZtYV9jaGFp
bjsKc3RydWN0IGZpbGVfcmFfc3RhdGU7CnN0cnVjdCB1c2VyX3N0cnVjdDsKc3RydWN0IHdy
aXRlYmFja19jb250cm9sOwpzdHJ1Y3QgYmRpX3dyaXRlYmFjazsKCnZvaWQgaW5pdF9tbV9p
bnRlcm5hbHModm9pZCk7CgoKZXh0ZXJuIHVuc2lnbmVkIGxvbmcgbWF4X21hcG5yOwoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIHZvaWQgc2V0X21heF9tYXBucih1bnNpZ25lZCBsb25nIGxpbWl0KQp7CiBtYXhf
bWFwbnIgPSBsaW1pdDsKfQoKCgoKZXh0ZXJuIGF0b21pY19sb25nX3QgX3RvdGFscmFtX3Bh
Z2VzOwpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgbG9uZyB0b3RhbHJhbV9wYWdlcyh2b2lkKQp7CiBy
ZXR1cm4gKHVuc2lnbmVkIGxvbmcpYXRvbWljX2xvbmdfcmVhZCgmX3RvdGFscmFtX3BhZ2Vz
KTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIHZvaWQgdG90YWxyYW1fcGFnZXNfaW5jKHZvaWQpCnsKIGF0b21p
Y19sb25nX2luYygmX3RvdGFscmFtX3BhZ2VzKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgdG90YWxy
YW1fcGFnZXNfZGVjKHZvaWQpCnsKIGF0b21pY19sb25nX2RlYygmX3RvdGFscmFtX3BhZ2Vz
KTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIHZvaWQgdG90YWxyYW1fcGFnZXNfYWRkKGxvbmcgY291bnQpCnsK
IGF0b21pY19sb25nX2FkZChjb3VudCwgJl90b3RhbHJhbV9wYWdlcyk7Cn0KCmV4dGVybiB2
b2lkICogaGlnaF9tZW1vcnk7CmV4dGVybiBpbnQgcGFnZV9jbHVzdGVyOwoKCmV4dGVybiBp
bnQgc3lzY3RsX2xlZ2FjeV92YV9sYXlvdXQ7CgoKCgoKZXh0ZXJuIGNvbnN0IGludCBtbWFw
X3JuZF9iaXRzX21pbjsKZXh0ZXJuIGNvbnN0IGludCBtbWFwX3JuZF9iaXRzX21heDsKZXh0
ZXJuIGludCBtbWFwX3JuZF9iaXRzIF9fYXR0cmlidXRlX18oKF9fc2VjdGlvbl9fKCIuZGF0
YS4ucmVhZF9tb3N0bHkiKSkpOwoKCmV4dGVybiBjb25zdCBpbnQgbW1hcF9ybmRfY29tcGF0
X2JpdHNfbWluOwpleHRlcm4gY29uc3QgaW50IG1tYXBfcm5kX2NvbXBhdF9iaXRzX21heDsK
ZXh0ZXJuIGludCBtbWFwX3JuZF9jb21wYXRfYml0cyBfX2F0dHJpYnV0ZV9fKChfX3NlY3Rp
b25fXygiLmRhdGEuLnJlYWRfbW9zdGx5IikpKTsKIyAxNDcgIi4vaW5jbHVkZS9saW51eC9t
bS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgdm9pZCBfX21tX3plcm9fc3RydWN0X3BhZ2Uoc3RydWN0IHBhZ2Ug
KnBhZ2UpCnsKIHVuc2lnbmVkIGxvbmcgKl9wcCA9ICh2b2lkICopcGFnZTsKCgogZG8geyBl
eHRlcm4gdm9pZCBfX2NvbXBpbGV0aW1lX2Fzc2VydF8xMzEodm9pZCkgX19hdHRyaWJ1dGVf
XygoX19lcnJvcl9fKCJCVUlMRF9CVUdfT04gZmFpbGVkOiAiICJzaXplb2Yoc3RydWN0IHBh
Z2UpICYgNyIpKSk7IGlmICghKCEoc2l6ZW9mKHN0cnVjdCBwYWdlKSAmIDcpKSkgX19jb21w
aWxldGltZV9hc3NlcnRfMTMxKCk7IH0gd2hpbGUgKDApOwogZG8geyBleHRlcm4gdm9pZCBf
X2NvbXBpbGV0aW1lX2Fzc2VydF8xMzIodm9pZCkgX19hdHRyaWJ1dGVfXygoX19lcnJvcl9f
KCJCVUlMRF9CVUdfT04gZmFpbGVkOiAiICJzaXplb2Yoc3RydWN0IHBhZ2UpIDwgNTYiKSkp
OyBpZiAoISghKHNpemVvZihzdHJ1Y3QgcGFnZSkgPCA1NikpKSBfX2NvbXBpbGV0aW1lX2Fz
c2VydF8xMzIoKTsgfSB3aGlsZSAoMCk7CiBkbyB7IGV4dGVybiB2b2lkIF9fY29tcGlsZXRp
bWVfYXNzZXJ0XzEzMyh2b2lkKSBfX2F0dHJpYnV0ZV9fKChfX2Vycm9yX18oIkJVSUxEX0JV
R19PTiBmYWlsZWQ6ICIgInNpemVvZihzdHJ1Y3QgcGFnZSkgPiA4MCIpKSk7IGlmICghKCEo
c2l6ZW9mKHN0cnVjdCBwYWdlKSA+IDgwKSkpIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzEzMygp
OyB9IHdoaWxlICgwKTsKCiBzd2l0Y2ggKHNpemVvZihzdHJ1Y3QgcGFnZSkpIHsKIGNhc2Ug
ODA6CiAgX3BwWzldID0gMDsKIGNhc2UgNzI6CiAgX3BwWzhdID0gMDsKIGNhc2UgNjQ6CiAg
X3BwWzddID0gMDsKIGNhc2UgNTY6CiAgX3BwWzZdID0gMDsKICBfcHBbNV0gPSAwOwogIF9w
cFs0XSA9IDA7CiAgX3BwWzNdID0gMDsKICBfcHBbMl0gPSAwOwogIF9wcFsxXSA9IDA7CiAg
X3BwWzBdID0gMDsKIH0KfQojIDE5NiAiLi9pbmNsdWRlL2xpbnV4L21tLmgiCmV4dGVybiBp
bnQgc3lzY3RsX21heF9tYXBfY291bnQ7CgpleHRlcm4gdW5zaWduZWQgbG9uZyBzeXNjdGxf
dXNlcl9yZXNlcnZlX2tieXRlczsKZXh0ZXJuIHVuc2lnbmVkIGxvbmcgc3lzY3RsX2FkbWlu
X3Jlc2VydmVfa2J5dGVzOwoKZXh0ZXJuIGludCBzeXNjdGxfb3ZlcmNvbW1pdF9tZW1vcnk7
CmV4dGVybiBpbnQgc3lzY3RsX292ZXJjb21taXRfcmF0aW87CmV4dGVybiB1bnNpZ25lZCBs
b25nIHN5c2N0bF9vdmVyY29tbWl0X2tieXRlczsKCmludCBvdmVyY29tbWl0X3JhdGlvX2hh
bmRsZXIoc3RydWN0IGN0bF90YWJsZSAqLCBpbnQsIHZvaWQgKiwgc2l6ZV90ICosCiAgbG9m
Zl90ICopOwppbnQgb3ZlcmNvbW1pdF9rYnl0ZXNfaGFuZGxlcihzdHJ1Y3QgY3RsX3RhYmxl
ICosIGludCwgdm9pZCAqLCBzaXplX3QgKiwKICBsb2ZmX3QgKik7CiMgMjI5ICIuL2luY2x1
ZGUvbGludXgvbW0uaCIKc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bV9hcmVhX2FsbG9jKHN0
cnVjdCBtbV9zdHJ1Y3QgKik7CnN0cnVjdCB2bV9hcmVhX3N0cnVjdCAqdm1fYXJlYV9kdXAo
c3RydWN0IHZtX2FyZWFfc3RydWN0ICopOwp2b2lkIHZtX2FyZWFfZnJlZShzdHJ1Y3Qgdm1f
YXJlYV9zdHJ1Y3QgKik7CiMgMzk3ICIuL2luY2x1ZGUvbGludXgvbW0uaCIKZXh0ZXJuIHBn
cHJvdF90IHByb3RlY3Rpb25fbWFwWzE2XTsKIyA0NjMgIi4vaW5jbHVkZS9saW51eC9tbS5o
IgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgYm9vbCBmYXVsdF9mbGFnX2FsbG93X3JldHJ5X2ZpcnN0KHVuc2lnbmVk
IGludCBmbGFncykKewogcmV0dXJuIChmbGFncyAmIDB4MDQpICYmCiAgICAgKCEoZmxhZ3Mg
JiAweDIwKSk7Cn0KIyA0OTEgIi4vaW5jbHVkZS9saW51eC9tbS5oIgpzdHJ1Y3Qgdm1fZmF1
bHQgewogc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWE7CiB1bnNpZ25lZCBpbnQgZmxhZ3M7
CiBnZnBfdCBnZnBfbWFzazsKIHVuc2lnbmVkIGxvbmcgcGdvZmY7CiB1bnNpZ25lZCBsb25n
IGFkZHJlc3M7CiBwbWRfdCAqcG1kOwoKIHB1ZF90ICpwdWQ7CgoKIHB0ZV90IG9yaWdfcHRl
OwoKIHN0cnVjdCBwYWdlICpjb3dfcGFnZTsKIHN0cnVjdCBwYWdlICpwYWdlOwoKCgoKCiBw
dGVfdCAqcHRlOwoKCgogc3BpbmxvY2tfdCAqcHRsOwoKCgogcGd0YWJsZV90IHByZWFsbG9j
X3B0ZTsKCgoKCgoKfTsKCgplbnVtIHBhZ2VfZW50cnlfc2l6ZSB7CiBQRV9TSVpFX1BURSA9
IDAsCiBQRV9TSVpFX1BNRCwKIFBFX1NJWkVfUFVELAp9OwoKCgoKCgpzdHJ1Y3Qgdm1fb3Bl
cmF0aW9uc19zdHJ1Y3Qgewogdm9pZCAoKm9wZW4pKHN0cnVjdCB2bV9hcmVhX3N0cnVjdCAq
IGFyZWEpOwogdm9pZCAoKmNsb3NlKShzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKiBhcmVhKTsK
IGludCAoKnNwbGl0KShzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKiBhcmVhLCB1bnNpZ25lZCBs
b25nIGFkZHIpOwogaW50ICgqbXJlbWFwKShzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKiBhcmVh
KTsKIHZtX2ZhdWx0X3QgKCpmYXVsdCkoc3RydWN0IHZtX2ZhdWx0ICp2bWYpOwogdm1fZmF1
bHRfdCAoKmh1Z2VfZmF1bHQpKHN0cnVjdCB2bV9mYXVsdCAqdm1mLAogICBlbnVtIHBhZ2Vf
ZW50cnlfc2l6ZSBwZV9zaXplKTsKIHZvaWQgKCptYXBfcGFnZXMpKHN0cnVjdCB2bV9mYXVs
dCAqdm1mLAogICB1bnNpZ25lZCBsb25nIHN0YXJ0X3Bnb2ZmLCB1bnNpZ25lZCBsb25nIGVu
ZF9wZ29mZik7CiB1bnNpZ25lZCBsb25nICgqcGFnZXNpemUpKHN0cnVjdCB2bV9hcmVhX3N0
cnVjdCAqIGFyZWEpOwoKCgogdm1fZmF1bHRfdCAoKnBhZ2VfbWt3cml0ZSkoc3RydWN0IHZt
X2ZhdWx0ICp2bWYpOwoKCiB2bV9mYXVsdF90ICgqcGZuX21rd3JpdGUpKHN0cnVjdCB2bV9m
YXVsdCAqdm1mKTsKCgoKCiBpbnQgKCphY2Nlc3MpKHN0cnVjdCB2bV9hcmVhX3N0cnVjdCAq
dm1hLCB1bnNpZ25lZCBsb25nIGFkZHIsCiAgICAgICAgdm9pZCAqYnVmLCBpbnQgbGVuLCBp
bnQgd3JpdGUpOwoKCgoKIGNvbnN0IGNoYXIgKigqbmFtZSkoc3RydWN0IHZtX2FyZWFfc3Ry
dWN0ICp2bWEpOwojIDU5OCAiLi9pbmNsdWRlL2xpbnV4L21tLmgiCiBzdHJ1Y3QgcGFnZSAq
KCpmaW5kX3NwZWNpYWxfcGFnZSkoc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEsCiAgICAg
ICB1bnNpZ25lZCBsb25nIGFkZHIpOwp9OwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgdm1hX2luaXQoc3Ry
dWN0IHZtX2FyZWFfc3RydWN0ICp2bWEsIHN0cnVjdCBtbV9zdHJ1Y3QgKm1tKQp7CiBzdGF0
aWMgY29uc3Qgc3RydWN0IHZtX29wZXJhdGlvbnNfc3RydWN0IGR1bW15X3ZtX29wcyA9IHt9
OwoKIG1lbXNldCh2bWEsIDAsIHNpemVvZigqdm1hKSk7CiB2bWEtPnZtX21tID0gbW07CiB2
bWEtPnZtX29wcyA9ICZkdW1teV92bV9vcHM7CiBJTklUX0xJU1RfSEVBRCgmdm1hLT5hbm9u
X3ZtYV9jaGFpbik7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHZtYV9zZXRfYW5vbnltb3VzKHN0cnVj
dCB2bV9hcmVhX3N0cnVjdCAqdm1hKQp7CiB2bWEtPnZtX29wcyA9ICgodm9pZCAqKTApOwp9
CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgYm9vbCB2bWFfaXNfYW5vbnltb3VzKHN0cnVjdCB2bV9hcmVhX3N0cnVj
dCAqdm1hKQp7CiByZXR1cm4gIXZtYS0+dm1fb3BzOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCB2bWFf
aXNfdGVtcG9yYXJ5X3N0YWNrKHN0cnVjdCB2bV9hcmVhX3N0cnVjdCAqdm1hKQp7CiBpbnQg
bWF5YmVfc3RhY2sgPSB2bWEtPnZtX2ZsYWdzICYgKDB4MDAwMDAxMDAgfCAweDAwMDAwMDAw
KTsKCiBpZiAoIW1heWJlX3N0YWNrKQogIHJldHVybiBmYWxzZTsKCiBpZiAoKHZtYS0+dm1f
ZmxhZ3MgJiAoMHgwMDAxMDAwMCB8IDB4MDAwMDgwMDApKSA9PQogICAgICAoMHgwMDAxMDAw
MCB8IDB4MDAwMDgwMDApKQogIHJldHVybiB0cnVlOwoKIHJldHVybiBmYWxzZTsKfQoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIGJvb2wgdm1hX2lzX2ZvcmVpZ24oc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEp
CnsKIGlmICghZ2V0X2N1cnJlbnQoKS0+bW0pCiAgcmV0dXJuIHRydWU7CgogaWYgKGdldF9j
dXJyZW50KCktPm1tICE9IHZtYS0+dm1fbW0pCiAgcmV0dXJuIHRydWU7CgogcmV0dXJuIGZh
bHNlOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgYm9vbCB2bWFfaXNfYWNjZXNzaWJsZShzdHJ1Y3Qgdm1fYXJl
YV9zdHJ1Y3QgKnZtYSkKewogcmV0dXJuIHZtYS0+dm1fZmxhZ3MgJiAoMHgwMDAwMDAwMSB8
IDB4MDAwMDAwMDIgfCAweDAwMDAwMDA0KTsKfQoKCgoKCgpib29sIHZtYV9pc19zaG1lbShz
dHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnZtYSk7CgoKCgppbnQgdm1hX2lzX3N0YWNrX2Zvcl9j
dXJyZW50KHN0cnVjdCB2bV9hcmVhX3N0cnVjdCAqdm1hKTsKCgoKCnN0cnVjdCBtbXVfZ2F0
aGVyOwpzdHJ1Y3QgaW5vZGU7CgoKCgoKCiMgMSAiLi9pbmNsdWRlL2xpbnV4L2h1Z2VfbW0u
aCIgMQoKCgoKIyAxICIuL2luY2x1ZGUvbGludXgvc2NoZWQvY29yZWR1bXAuaCIgMQojIDE3
ICIuL2luY2x1ZGUvbGludXgvc2NoZWQvY29yZWR1bXAuaCIKZXh0ZXJuIHZvaWQgc2V0X2R1
bXBhYmxlKHN0cnVjdCBtbV9zdHJ1Y3QgKm1tLCBpbnQgdmFsdWUpOwoKCgoKCgpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgaW50IF9fZ2V0X2R1bXBhYmxlKHVuc2lnbmVkIGxvbmcgbW1fZmxhZ3MpCnsKIHJldHVy
biBtbV9mbGFncyAmICgoMSA8PCAyKSAtIDEpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGdldF9kdW1w
YWJsZShzdHJ1Y3QgbW1fc3RydWN0ICptbSkKewogcmV0dXJuIF9fZ2V0X2R1bXBhYmxlKG1t
LT5mbGFncyk7Cn0KIyA2ICIuL2luY2x1ZGUvbGludXgvaHVnZV9tbS5oIiAyCgoKIyAxICIu
L2luY2x1ZGUvbGludXgvZnMuaCIgMQoKCgoKCiMgMSAiLi9pbmNsdWRlL2xpbnV4L3dhaXRf
Yml0LmgiIDEKIyAxMCAiLi9pbmNsdWRlL2xpbnV4L3dhaXRfYml0LmgiCnN0cnVjdCB3YWl0
X2JpdF9rZXkgewogdm9pZCAqZmxhZ3M7CiBpbnQgYml0X25yOwogdW5zaWduZWQgbG9uZyB0
aW1lb3V0Owp9OwoKc3RydWN0IHdhaXRfYml0X3F1ZXVlX2VudHJ5IHsKIHN0cnVjdCB3YWl0
X2JpdF9rZXkga2V5Owogc3RydWN0IHdhaXRfcXVldWVfZW50cnkgd3FfZW50cnk7Cn07CgoK
Cgp0eXBlZGVmIGludCB3YWl0X2JpdF9hY3Rpb25fZihzdHJ1Y3Qgd2FpdF9iaXRfa2V5ICpr
ZXksIGludCBtb2RlKTsKCnZvaWQgX193YWtlX3VwX2JpdChzdHJ1Y3Qgd2FpdF9xdWV1ZV9o
ZWFkICp3cV9oZWFkLCB2b2lkICp3b3JkLCBpbnQgYml0KTsKaW50IF9fd2FpdF9vbl9iaXQo
c3RydWN0IHdhaXRfcXVldWVfaGVhZCAqd3FfaGVhZCwgc3RydWN0IHdhaXRfYml0X3F1ZXVl
X2VudHJ5ICp3YnFfZW50cnksIHdhaXRfYml0X2FjdGlvbl9mICphY3Rpb24sIHVuc2lnbmVk
IGludCBtb2RlKTsKaW50IF9fd2FpdF9vbl9iaXRfbG9jayhzdHJ1Y3Qgd2FpdF9xdWV1ZV9o
ZWFkICp3cV9oZWFkLCBzdHJ1Y3Qgd2FpdF9iaXRfcXVldWVfZW50cnkgKndicV9lbnRyeSwg
d2FpdF9iaXRfYWN0aW9uX2YgKmFjdGlvbiwgdW5zaWduZWQgaW50IG1vZGUpOwp2b2lkIHdh
a2VfdXBfYml0KHZvaWQgKndvcmQsIGludCBiaXQpOwppbnQgb3V0X29mX2xpbmVfd2FpdF9v
bl9iaXQodm9pZCAqd29yZCwgaW50LCB3YWl0X2JpdF9hY3Rpb25fZiAqYWN0aW9uLCB1bnNp
Z25lZCBpbnQgbW9kZSk7CmludCBvdXRfb2ZfbGluZV93YWl0X29uX2JpdF90aW1lb3V0KHZv
aWQgKndvcmQsIGludCwgd2FpdF9iaXRfYWN0aW9uX2YgKmFjdGlvbiwgdW5zaWduZWQgaW50
IG1vZGUsIHVuc2lnbmVkIGxvbmcgdGltZW91dCk7CmludCBvdXRfb2ZfbGluZV93YWl0X29u
X2JpdF9sb2NrKHZvaWQgKndvcmQsIGludCwgd2FpdF9iaXRfYWN0aW9uX2YgKmFjdGlvbiwg
dW5zaWduZWQgaW50IG1vZGUpOwpzdHJ1Y3Qgd2FpdF9xdWV1ZV9oZWFkICpiaXRfd2FpdHF1
ZXVlKHZvaWQgKndvcmQsIGludCBiaXQpOwpleHRlcm4gdm9pZCBfX2F0dHJpYnV0ZV9fKChf
X3NlY3Rpb25fXygiLmluaXQudGV4dCIpKSkgX19hdHRyaWJ1dGVfXygoX19jb2xkX18pKSB3
YWl0X2JpdF9pbml0KHZvaWQpOwoKaW50IHdha2VfYml0X2Z1bmN0aW9uKHN0cnVjdCB3YWl0
X3F1ZXVlX2VudHJ5ICp3cV9lbnRyeSwgdW5zaWduZWQgbW9kZSwgaW50IHN5bmMsIHZvaWQg
KmtleSk7CiMgNDkgIi4vaW5jbHVkZS9saW51eC93YWl0X2JpdC5oIgpleHRlcm4gaW50IGJp
dF93YWl0KHN0cnVjdCB3YWl0X2JpdF9rZXkgKmtleSwgaW50IG1vZGUpOwpleHRlcm4gaW50
IGJpdF93YWl0X2lvKHN0cnVjdCB3YWl0X2JpdF9rZXkgKmtleSwgaW50IG1vZGUpOwpleHRl
cm4gaW50IGJpdF93YWl0X3RpbWVvdXQoc3RydWN0IHdhaXRfYml0X2tleSAqa2V5LCBpbnQg
bW9kZSk7CmV4dGVybiBpbnQgYml0X3dhaXRfaW9fdGltZW91dChzdHJ1Y3Qgd2FpdF9iaXRf
a2V5ICprZXksIGludCBtb2RlKTsKIyA3MCAiLi9pbmNsdWRlL2xpbnV4L3dhaXRfYml0Lmgi
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSBpbnQKd2FpdF9vbl9iaXQodW5zaWduZWQgbG9uZyAqd29yZCwgaW50IGJp
dCwgdW5zaWduZWQgbW9kZSkKewogZG8geyBkbyB7IH0gd2hpbGUgKDApOyB9IHdoaWxlICgw
KTsKIGlmICghdGVzdF9iaXQoYml0LCB3b3JkKSkKICByZXR1cm4gMDsKIHJldHVybiBvdXRf
b2ZfbGluZV93YWl0X29uX2JpdCh3b3JkLCBiaXQsCiAgICAgICAgICAgYml0X3dhaXQsCiAg
ICAgICAgICAgbW9kZSk7Cn0KIyA5NSAiLi9pbmNsdWRlL2xpbnV4L3dhaXRfYml0LmgiCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSBpbnQKd2FpdF9vbl9iaXRfaW8odW5zaWduZWQgbG9uZyAqd29yZCwgaW50IGJp
dCwgdW5zaWduZWQgbW9kZSkKewogZG8geyBkbyB7IH0gd2hpbGUgKDApOyB9IHdoaWxlICgw
KTsKIGlmICghdGVzdF9iaXQoYml0LCB3b3JkKSkKICByZXR1cm4gMDsKIHJldHVybiBvdXRf
b2ZfbGluZV93YWl0X29uX2JpdCh3b3JkLCBiaXQsCiAgICAgICAgICAgYml0X3dhaXRfaW8s
CiAgICAgICAgICAgbW9kZSk7Cn0KIyAxMjEgIi4vaW5jbHVkZS9saW51eC93YWl0X2JpdC5o
IgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgaW50CndhaXRfb25fYml0X3RpbWVvdXQodW5zaWduZWQgbG9uZyAqd29y
ZCwgaW50IGJpdCwgdW5zaWduZWQgbW9kZSwKICAgICAgdW5zaWduZWQgbG9uZyB0aW1lb3V0
KQp7CiBkbyB7IGRvIHsgfSB3aGlsZSAoMCk7IH0gd2hpbGUgKDApOwogaWYgKCF0ZXN0X2Jp
dChiaXQsIHdvcmQpKQogIHJldHVybiAwOwogcmV0dXJuIG91dF9vZl9saW5lX3dhaXRfb25f
Yml0X3RpbWVvdXQod29yZCwgYml0LAogICAgICAgICAgICBiaXRfd2FpdF90aW1lb3V0LAog
ICAgICAgICAgICBtb2RlLCB0aW1lb3V0KTsKfQojIDE0OSAiLi9pbmNsdWRlL2xpbnV4L3dh
aXRfYml0LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQKd2FpdF9vbl9iaXRfYWN0aW9uKHVuc2lnbmVkIGxv
bmcgKndvcmQsIGludCBiaXQsIHdhaXRfYml0X2FjdGlvbl9mICphY3Rpb24sCiAgICAgdW5z
aWduZWQgbW9kZSkKewogZG8geyBkbyB7IH0gd2hpbGUgKDApOyB9IHdoaWxlICgwKTsKIGlm
ICghdGVzdF9iaXQoYml0LCB3b3JkKSkKICByZXR1cm4gMDsKIHJldHVybiBvdXRfb2ZfbGlu
ZV93YWl0X29uX2JpdCh3b3JkLCBiaXQsIGFjdGlvbiwgbW9kZSk7Cn0KIyAxNzggIi4vaW5j
bHVkZS9saW51eC93YWl0X2JpdC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50CndhaXRfb25fYml0X2xvY2so
dW5zaWduZWQgbG9uZyAqd29yZCwgaW50IGJpdCwgdW5zaWduZWQgbW9kZSkKewogZG8geyBk
byB7IH0gd2hpbGUgKDApOyB9IHdoaWxlICgwKTsKIGlmICghdGVzdF9hbmRfc2V0X2JpdChi
aXQsIHdvcmQpKQogIHJldHVybiAwOwogcmV0dXJuIG91dF9vZl9saW5lX3dhaXRfb25fYml0
X2xvY2sod29yZCwgYml0LCBiaXRfd2FpdCwgbW9kZSk7Cn0KIyAyMDIgIi4vaW5jbHVkZS9s
aW51eC93YWl0X2JpdC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50CndhaXRfb25fYml0X2xvY2tfaW8odW5z
aWduZWQgbG9uZyAqd29yZCwgaW50IGJpdCwgdW5zaWduZWQgbW9kZSkKewogZG8geyBkbyB7
IH0gd2hpbGUgKDApOyB9IHdoaWxlICgwKTsKIGlmICghdGVzdF9hbmRfc2V0X2JpdChiaXQs
IHdvcmQpKQogIHJldHVybiAwOwogcmV0dXJuIG91dF9vZl9saW5lX3dhaXRfb25fYml0X2xv
Y2sod29yZCwgYml0LCBiaXRfd2FpdF9pbywgbW9kZSk7Cn0KIyAyMjggIi4vaW5jbHVkZS9s
aW51eC93YWl0X2JpdC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50CndhaXRfb25fYml0X2xvY2tfYWN0aW9u
KHVuc2lnbmVkIGxvbmcgKndvcmQsIGludCBiaXQsIHdhaXRfYml0X2FjdGlvbl9mICphY3Rp
b24sCiAgIHVuc2lnbmVkIG1vZGUpCnsKIGRvIHsgZG8geyB9IHdoaWxlICgwKTsgfSB3aGls
ZSAoMCk7CiBpZiAoIXRlc3RfYW5kX3NldF9iaXQoYml0LCB3b3JkKSkKICByZXR1cm4gMDsK
IHJldHVybiBvdXRfb2ZfbGluZV93YWl0X29uX2JpdF9sb2NrKHdvcmQsIGJpdCwgYWN0aW9u
LCBtb2RlKTsKfQoKZXh0ZXJuIHZvaWQgaW5pdF93YWl0X3Zhcl9lbnRyeShzdHJ1Y3Qgd2Fp
dF9iaXRfcXVldWVfZW50cnkgKndicV9lbnRyeSwgdm9pZCAqdmFyLCBpbnQgZmxhZ3MpOwpl
eHRlcm4gdm9pZCB3YWtlX3VwX3Zhcih2b2lkICp2YXIpOwpleHRlcm4gd2FpdF9xdWV1ZV9o
ZWFkX3QgKl9fdmFyX3dhaXRxdWV1ZSh2b2lkICpwKTsKIyAzMzAgIi4vaW5jbHVkZS9saW51
eC93YWl0X2JpdC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBjbGVhcl9hbmRfd2FrZV91cF9iaXQoaW50
IGJpdCwgdm9pZCAqd29yZCkKewogY2xlYXJfYml0X3VubG9jayhiaXQsIHdvcmQpOwoKIF9f
YXNtX18gX192b2xhdGlsZV9fICgic3luYyIgOiA6IDogIm1lbW9yeSIpOwogd2FrZV91cF9i
aXQod29yZCwgYml0KTsKfQojIDcgIi4vaW5jbHVkZS9saW51eC9mcy5oIiAyCiMgMSAiLi9p
bmNsdWRlL2xpbnV4L2tkZXZfdC5oIiAxCgoKCgojIDEgIi4vaW5jbHVkZS91YXBpL2xpbnV4
L2tkZXZfdC5oIiAxCiMgNiAiLi9pbmNsdWRlL2xpbnV4L2tkZXZfdC5oIiAyCiMgMjQgIi4v
aW5jbHVkZS9saW51eC9rZGV2X3QuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgb2xkX3ZhbGlkX2Rldihk
ZXZfdCBkZXYpCnsKIHJldHVybiAoKHVuc2lnbmVkIGludCkgKChkZXYpID4+IDIwKSkgPCAy
NTYgJiYgKCh1bnNpZ25lZCBpbnQpICgoZGV2KSAmICgoMVUgPDwgMjApIC0gMSkpKSA8IDI1
NjsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIHUxNiBvbGRfZW5jb2RlX2RldihkZXZfdCBkZXYpCnsKIHJldHVy
biAoKCh1bnNpZ25lZCBpbnQpICgoZGV2KSA+PiAyMCkpIDw8IDgpIHwgKCh1bnNpZ25lZCBp
bnQpICgoZGV2KSAmICgoMVUgPDwgMjApIC0gMSkpKTsKfQoKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGRldl90IG9s
ZF9kZWNvZGVfZGV2KHUxNiB2YWwpCnsKIHJldHVybiAoKCgodmFsID4+IDgpICYgMjU1KSA8
PCAyMCkgfCAodmFsICYgMjU1KSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1MzIgbmV3X2VuY29kZV9kZXYo
ZGV2X3QgZGV2KQp7CiB1bnNpZ25lZCBtYWpvciA9ICgodW5zaWduZWQgaW50KSAoKGRldikg
Pj4gMjApKTsKIHVuc2lnbmVkIG1pbm9yID0gKCh1bnNpZ25lZCBpbnQpICgoZGV2KSAmICgo
MVUgPDwgMjApIC0gMSkpKTsKIHJldHVybiAobWlub3IgJiAweGZmKSB8IChtYWpvciA8PCA4
KSB8ICgobWlub3IgJiB+MHhmZikgPDwgMTIpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgZGV2X3QgbmV3X2Rl
Y29kZV9kZXYodTMyIGRldikKewogdW5zaWduZWQgbWFqb3IgPSAoZGV2ICYgMHhmZmYwMCkg
Pj4gODsKIHVuc2lnbmVkIG1pbm9yID0gKGRldiAmIDB4ZmYpIHwgKChkZXYgPj4gMTIpICYg
MHhmZmYwMCk7CiByZXR1cm4gKCgobWFqb3IpIDw8IDIwKSB8IChtaW5vcikpOwp9CgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgdTY0IGh1Z2VfZW5jb2RlX2RldihkZXZfdCBkZXYpCnsKIHJldHVybiBuZXdfZW5j
b2RlX2RldihkZXYpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgZGV2X3QgaHVnZV9kZWNvZGVfZGV2KHU2NCBk
ZXYpCnsKIHJldHVybiBuZXdfZGVjb2RlX2RldihkZXYpOwp9CgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHN5
c3ZfdmFsaWRfZGV2KGRldl90IGRldikKewogcmV0dXJuICgodW5zaWduZWQgaW50KSAoKGRl
dikgPj4gMjApKSA8ICgxPDwxNCkgJiYgKCh1bnNpZ25lZCBpbnQpICgoZGV2KSAmICgoMVUg
PDwgMjApIC0gMSkpKSA8ICgxPDwxOCk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1MzIgc3lzdl9lbmNvZGVf
ZGV2KGRldl90IGRldikKewogcmV0dXJuICgodW5zaWduZWQgaW50KSAoKGRldikgJiAoKDFV
IDw8IDIwKSAtIDEpKSkgfCAoKCh1bnNpZ25lZCBpbnQpICgoZGV2KSA+PiAyMCkpIDw8IDE4
KTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIHVuc2lnbmVkIHN5c3ZfbWFqb3IodTMyIGRldikKewogcmV0dXJu
IChkZXYgPj4gMTgpICYgMHgzZmZmOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgc3lzdl9taW5v
cih1MzIgZGV2KQp7CiByZXR1cm4gZGV2ICYgMHgzZmZmZjsKfQojIDggIi4vaW5jbHVkZS9s
aW51eC9mcy5oIiAyCiMgMSAiLi9pbmNsdWRlL2xpbnV4L2RjYWNoZS5oIiAxCgoKCgoKCgoj
IDEgIi4vaW5jbHVkZS9saW51eC9yY3VsaXN0X2JsLmgiIDEKCgoKCgoKCiMgMSAiLi9pbmNs
dWRlL2xpbnV4L2xpc3RfYmwuaCIgMQojIDM0ICIuL2luY2x1ZGUvbGludXgvbGlzdF9ibC5o
IgpzdHJ1Y3QgaGxpc3RfYmxfaGVhZCB7CiBzdHJ1Y3QgaGxpc3RfYmxfbm9kZSAqZmlyc3Q7
Cn07CgpzdHJ1Y3QgaGxpc3RfYmxfbm9kZSB7CiBzdHJ1Y3QgaGxpc3RfYmxfbm9kZSAqbmV4
dCwgKipwcHJldjsKfTsKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgSU5JVF9ITElTVF9CTF9OT0RFKHN0
cnVjdCBobGlzdF9ibF9ub2RlICpoKQp7CiBoLT5uZXh0ID0gKCh2b2lkICopMCk7CiBoLT5w
cHJldiA9ICgodm9pZCAqKTApOwp9CgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIGhsaXN0X2JsX3VuaGFz
aGVkKGNvbnN0IHN0cnVjdCBobGlzdF9ibF9ub2RlICpoKQp7CiByZXR1cm4gIWgtPnBwcmV2
Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgc3RydWN0IGhsaXN0X2JsX25vZGUgKmhsaXN0X2JsX2ZpcnN0KHN0
cnVjdCBobGlzdF9ibF9oZWFkICpoKQp7CiByZXR1cm4gKHN0cnVjdCBobGlzdF9ibF9ub2Rl
ICopCiAgKCh1bnNpZ25lZCBsb25nKWgtPmZpcnN0ICYgfjFVTCk7Cn0KCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2
b2lkIGhsaXN0X2JsX3NldF9maXJzdChzdHJ1Y3QgaGxpc3RfYmxfaGVhZCAqaCwKICAgICBz
dHJ1Y3QgaGxpc3RfYmxfbm9kZSAqbikKewogOwoKICAgICAgICAgICAgICAgICAgICAgICAg
OwogaC0+Zmlyc3QgPSAoc3RydWN0IGhsaXN0X2JsX25vZGUgKikoKHVuc2lnbmVkIGxvbmcp
biB8IDFVTCk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIGhsaXN0X2JsX2VtcHR5KGNvbnN0IHN0cnVj
dCBobGlzdF9ibF9oZWFkICpoKQp7CiByZXR1cm4gISgodW5zaWduZWQgbG9uZykoeyBkbyB7
IGV4dGVybiB2b2lkIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzEzNCh2b2lkKSBfX2F0dHJpYnV0
ZV9fKChfX2Vycm9yX18oIlVuc3VwcG9ydGVkIGFjY2VzcyBzaXplIGZvciB7UkVBRCxXUklU
RX1fT05DRSgpLiIpKSk7IGlmICghKChzaXplb2YoaC0+Zmlyc3QpID09IHNpemVvZihjaGFy
KSB8fCBzaXplb2YoaC0+Zmlyc3QpID09IHNpemVvZihzaG9ydCkgfHwgc2l6ZW9mKGgtPmZp
cnN0KSA9PSBzaXplb2YoaW50KSB8fCBzaXplb2YoaC0+Zmlyc3QpID09IHNpemVvZihsb25n
KSkgfHwgc2l6ZW9mKGgtPmZpcnN0KSA9PSBzaXplb2YobG9uZyBsb25nKSkpIF9fY29tcGls
ZXRpbWVfYXNzZXJ0XzEzNCgpOyB9IHdoaWxlICgwKTsgKHsgdHlwZW9mKCBfR2VuZXJpYygo
aC0+Zmlyc3QpLCBjaGFyOiAoY2hhcikwLCB1bnNpZ25lZCBjaGFyOiAodW5zaWduZWQgY2hh
cikwLCBzaWduZWQgY2hhcjogKHNpZ25lZCBjaGFyKTAsIHVuc2lnbmVkIHNob3J0OiAodW5z
aWduZWQgc2hvcnQpMCwgc2lnbmVkIHNob3J0OiAoc2lnbmVkIHNob3J0KTAsIHVuc2lnbmVk
IGludDogKHVuc2lnbmVkIGludCkwLCBzaWduZWQgaW50OiAoc2lnbmVkIGludCkwLCB1bnNp
Z25lZCBsb25nOiAodW5zaWduZWQgbG9uZykwLCBzaWduZWQgbG9uZzogKHNpZ25lZCBsb25n
KTAsIHVuc2lnbmVkIGxvbmcgbG9uZzogKHVuc2lnbmVkIGxvbmcgbG9uZykwLCBzaWduZWQg
bG9uZyBsb25nOiAoc2lnbmVkIGxvbmcgbG9uZykwLCBkZWZhdWx0OiAoaC0+Zmlyc3QpKSkg
X194ID0gKCooY29uc3Qgdm9sYXRpbGUgdHlwZW9mKCBfR2VuZXJpYygoaC0+Zmlyc3QpLCBj
aGFyOiAoY2hhcikwLCB1bnNpZ25lZCBjaGFyOiAodW5zaWduZWQgY2hhcikwLCBzaWduZWQg
Y2hhcjogKHNpZ25lZCBjaGFyKTAsIHVuc2lnbmVkIHNob3J0OiAodW5zaWduZWQgc2hvcnQp
MCwgc2lnbmVkIHNob3J0OiAoc2lnbmVkIHNob3J0KTAsIHVuc2lnbmVkIGludDogKHVuc2ln
bmVkIGludCkwLCBzaWduZWQgaW50OiAoc2lnbmVkIGludCkwLCB1bnNpZ25lZCBsb25nOiAo
dW5zaWduZWQgbG9uZykwLCBzaWduZWQgbG9uZzogKHNpZ25lZCBsb25nKTAsIHVuc2lnbmVk
IGxvbmcgbG9uZzogKHVuc2lnbmVkIGxvbmcgbG9uZykwLCBzaWduZWQgbG9uZyBsb25nOiAo
c2lnbmVkIGxvbmcgbG9uZykwLCBkZWZhdWx0OiAoaC0+Zmlyc3QpKSkgKikmKGgtPmZpcnN0
KSk7IGRvIHsgfSB3aGlsZSAoMCk7ICh0eXBlb2YoaC0+Zmlyc3QpKV9feDsgfSk7IH0pICYg
fjFVTCk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGhsaXN0X2JsX2FkZF9oZWFkKHN0cnVjdCBobGlz
dF9ibF9ub2RlICpuLAogICAgIHN0cnVjdCBobGlzdF9ibF9oZWFkICpoKQp7CiBzdHJ1Y3Qg
aGxpc3RfYmxfbm9kZSAqZmlyc3QgPSBobGlzdF9ibF9maXJzdChoKTsKCiBuLT5uZXh0ID0g
Zmlyc3Q7CiBpZiAoZmlyc3QpCiAgZmlyc3QtPnBwcmV2ID0gJm4tPm5leHQ7CiBuLT5wcHJl
diA9ICZoLT5maXJzdDsKIGhsaXN0X2JsX3NldF9maXJzdChoLCBuKTsKfQoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IHZvaWQgaGxpc3RfYmxfYWRkX2JlZm9yZShzdHJ1Y3QgaGxpc3RfYmxfbm9kZSAqbiwKICAg
ICAgICAgICBzdHJ1Y3QgaGxpc3RfYmxfbm9kZSAqbmV4dCkKewogc3RydWN0IGhsaXN0X2Js
X25vZGUgKipwcHJldiA9IG5leHQtPnBwcmV2OwoKIG4tPnBwcmV2ID0gcHByZXY7CiBuLT5u
ZXh0ID0gbmV4dDsKIG5leHQtPnBwcmV2ID0gJm4tPm5leHQ7CgoKIGRvIHsgZG8geyBleHRl
cm4gdm9pZCBfX2NvbXBpbGV0aW1lX2Fzc2VydF8xMzUodm9pZCkgX19hdHRyaWJ1dGVfXygo
X19lcnJvcl9fKCJVbnN1cHBvcnRlZCBhY2Nlc3Mgc2l6ZSBmb3Ige1JFQUQsV1JJVEV9X09O
Q0UoKS4iKSkpOyBpZiAoISgoc2l6ZW9mKCpwcHJldikgPT0gc2l6ZW9mKGNoYXIpIHx8IHNp
emVvZigqcHByZXYpID09IHNpemVvZihzaG9ydCkgfHwgc2l6ZW9mKCpwcHJldikgPT0gc2l6
ZW9mKGludCkgfHwgc2l6ZW9mKCpwcHJldikgPT0gc2l6ZW9mKGxvbmcpKSB8fCBzaXplb2Yo
KnBwcmV2KSA9PSBzaXplb2YobG9uZyBsb25nKSkpIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzEz
NSgpOyB9IHdoaWxlICgwKTsgZG8geyAqKHZvbGF0aWxlIHR5cGVvZigqcHByZXYpICopJigq
cHByZXYpID0gKChzdHJ1Y3QgaGxpc3RfYmxfbm9kZSAqKSAoKHVpbnRwdHJfdCluIHwgKCh1
aW50cHRyX3QpKnBwcmV2ICYgMVVMKSkpOyB9IHdoaWxlICgwKTsgfSB3aGlsZSAoMCkKCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBobGlzdF9ibF9hZGRfYmVoaW5kKHN0cnVjdCBobGlz
dF9ibF9ub2RlICpuLAogICAgICAgICAgIHN0cnVjdCBobGlzdF9ibF9ub2RlICpwcmV2KQp7
CiBuLT5uZXh0ID0gcHJldi0+bmV4dDsKIG4tPnBwcmV2ID0gJnByZXYtPm5leHQ7CiBwcmV2
LT5uZXh0ID0gbjsKCiBpZiAobi0+bmV4dCkKICBuLT5uZXh0LT5wcHJldiA9ICZuLT5uZXh0
Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgdm9pZCBfX2hsaXN0X2JsX2RlbChzdHJ1Y3QgaGxpc3RfYmxfbm9k
ZSAqbikKewogc3RydWN0IGhsaXN0X2JsX25vZGUgKm5leHQgPSBuLT5uZXh0Owogc3RydWN0
IGhsaXN0X2JsX25vZGUgKipwcHJldiA9IG4tPnBwcmV2OwoKIDsKCgogZG8geyBkbyB7IGV4
dGVybiB2b2lkIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzEzNih2b2lkKSBfX2F0dHJpYnV0ZV9f
KChfX2Vycm9yX18oIlVuc3VwcG9ydGVkIGFjY2VzcyBzaXplIGZvciB7UkVBRCxXUklURX1f
T05DRSgpLiIpKSk7IGlmICghKChzaXplb2YoKnBwcmV2KSA9PSBzaXplb2YoY2hhcikgfHwg
c2l6ZW9mKCpwcHJldikgPT0gc2l6ZW9mKHNob3J0KSB8fCBzaXplb2YoKnBwcmV2KSA9PSBz
aXplb2YoaW50KSB8fCBzaXplb2YoKnBwcmV2KSA9PSBzaXplb2YobG9uZykpIHx8IHNpemVv
ZigqcHByZXYpID09IHNpemVvZihsb25nIGxvbmcpKSkgX19jb21waWxldGltZV9hc3NlcnRf
MTM2KCk7IH0gd2hpbGUgKDApOyBkbyB7ICoodm9sYXRpbGUgdHlwZW9mKCpwcHJldikgKikm
KCpwcHJldikgPSAoKHN0cnVjdCBobGlzdF9ibF9ub2RlICopICgodW5zaWduZWQgbG9uZylu
ZXh0IHwgKCh1bnNpZ25lZCBsb25nKSpwcHJldiAmIDFVTCkpKTsgfSB3aGlsZSAoMCk7IH0g
d2hpbGUgKDApCgoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgOwogaWYgKG5leHQpCiAgbmV4dC0+cHByZXYgPSBwcHJldjsKfQoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IHZvaWQgaGxpc3RfYmxfZGVsKHN0cnVjdCBobGlzdF9ibF9ub2RlICpuKQp7CiBfX2hsaXN0
X2JsX2RlbChuKTsKIG4tPm5leHQgPSAoKHZvaWQgKikgMHgxMDAgKyAoMHg1ZGVhZGJlZWYw
MDAwMDAwVUwpKTsKIG4tPnBwcmV2ID0gKCh2b2lkICopIDB4MTIyICsgKDB4NWRlYWRiZWVm
MDAwMDAwMFVMKSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGhsaXN0X2JsX2RlbF9pbml0KHN0cnVj
dCBobGlzdF9ibF9ub2RlICpuKQp7CiBpZiAoIWhsaXN0X2JsX3VuaGFzaGVkKG4pKSB7CiAg
X19obGlzdF9ibF9kZWwobik7CiAgSU5JVF9ITElTVF9CTF9OT0RFKG4pOwogfQp9CgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgdm9pZCBobGlzdF9ibF9sb2NrKHN0cnVjdCBobGlzdF9ibF9oZWFkICpiKQp7CiBi
aXRfc3Bpbl9sb2NrKDAsICh1bnNpZ25lZCBsb25nICopYik7Cn0KCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lk
IGhsaXN0X2JsX3VubG9jayhzdHJ1Y3QgaGxpc3RfYmxfaGVhZCAqYikKewogX19iaXRfc3Bp
bl91bmxvY2soMCwgKHVuc2lnbmVkIGxvbmcgKiliKTsKfQoKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgaGxp
c3RfYmxfaXNfbG9ja2VkKHN0cnVjdCBobGlzdF9ibF9oZWFkICpiKQp7CiByZXR1cm4gYml0
X3NwaW5faXNfbG9ja2VkKDAsICh1bnNpZ25lZCBsb25nICopYik7Cn0KIyA5ICIuL2luY2x1
ZGUvbGludXgvcmN1bGlzdF9ibC5oIiAyCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgaGxpc3RfYmxfc2V0
X2ZpcnN0X3JjdShzdHJ1Y3QgaGxpc3RfYmxfaGVhZCAqaCwKICAgICBzdHJ1Y3QgaGxpc3Rf
Ymxfbm9kZSAqbikKewogOwoKICAgICAgICAgICAgICAgICAgICAgICAgOwogZG8geyB1aW50
cHRyX3QgX3JfYV9wX192ID0gKHVpbnRwdHJfdCkoKHN0cnVjdCBobGlzdF9ibF9ub2RlICop
KCh1bnNpZ25lZCBsb25nKW4gfCAxVUwpKTsgOyBpZiAoX19idWlsdGluX2NvbnN0YW50X3Ao
KHN0cnVjdCBobGlzdF9ibF9ub2RlICopKCh1bnNpZ25lZCBsb25nKW4gfCAxVUwpKSAmJiAo
X3JfYV9wX192KSA9PSAodWludHB0cl90KSgodm9pZCAqKTApKSBkbyB7IGRvIHsgZXh0ZXJu
IHZvaWQgX19jb21waWxldGltZV9hc3NlcnRfMTM3KHZvaWQpIF9fYXR0cmlidXRlX18oKF9f
ZXJyb3JfXygiVW5zdXBwb3J0ZWQgYWNjZXNzIHNpemUgZm9yIHtSRUFELFdSSVRFfV9PTkNF
KCkuIikpKTsgaWYgKCEoKHNpemVvZigoaC0+Zmlyc3QpKSA9PSBzaXplb2YoY2hhcikgfHwg
c2l6ZW9mKChoLT5maXJzdCkpID09IHNpemVvZihzaG9ydCkgfHwgc2l6ZW9mKChoLT5maXJz
dCkpID09IHNpemVvZihpbnQpIHx8IHNpemVvZigoaC0+Zmlyc3QpKSA9PSBzaXplb2YobG9u
ZykpIHx8IHNpemVvZigoaC0+Zmlyc3QpKSA9PSBzaXplb2YobG9uZyBsb25nKSkpIF9fY29t
cGlsZXRpbWVfYXNzZXJ0XzEzNygpOyB9IHdoaWxlICgwKTsgZG8geyAqKHZvbGF0aWxlIHR5
cGVvZigoaC0+Zmlyc3QpKSAqKSYoKGgtPmZpcnN0KSkgPSAoKHR5cGVvZihoLT5maXJzdCkp
KF9yX2FfcF9fdikpOyB9IHdoaWxlICgwKTsgfSB3aGlsZSAoMCk7IGVsc2UgZG8geyBkbyB7
IGV4dGVybiB2b2lkIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzEzOCh2b2lkKSBfX2F0dHJpYnV0
ZV9fKChfX2Vycm9yX18oIk5lZWQgbmF0aXZlIHdvcmQgc2l6ZWQgc3RvcmVzL2xvYWRzIGZv
ciBhdG9taWNpdHkuIikpKTsgaWYgKCEoKHNpemVvZigqJmgtPmZpcnN0KSA9PSBzaXplb2Yo
Y2hhcikgfHwgc2l6ZW9mKComaC0+Zmlyc3QpID09IHNpemVvZihzaG9ydCkgfHwgc2l6ZW9m
KComaC0+Zmlyc3QpID09IHNpemVvZihpbnQpIHx8IHNpemVvZigqJmgtPmZpcnN0KSA9PSBz
aXplb2YobG9uZykpKSkgX19jb21waWxldGltZV9hc3NlcnRfMTM4KCk7IH0gd2hpbGUgKDAp
OyBfX2FzbV9fIF9fdm9sYXRpbGVfXyAoImx3c3luYyIgIiAiIDogOiA6Im1lbW9yeSIpOyBk
byB7IGRvIHsgZXh0ZXJuIHZvaWQgX19jb21waWxldGltZV9hc3NlcnRfMTM5KHZvaWQpIF9f
YXR0cmlidXRlX18oKF9fZXJyb3JfXygiVW5zdXBwb3J0ZWQgYWNjZXNzIHNpemUgZm9yIHtS
RUFELFdSSVRFfV9PTkNFKCkuIikpKTsgaWYgKCEoKHNpemVvZigqJmgtPmZpcnN0KSA9PSBz
aXplb2YoY2hhcikgfHwgc2l6ZW9mKComaC0+Zmlyc3QpID09IHNpemVvZihzaG9ydCkgfHwg
c2l6ZW9mKComaC0+Zmlyc3QpID09IHNpemVvZihpbnQpIHx8IHNpemVvZigqJmgtPmZpcnN0
KSA9PSBzaXplb2YobG9uZykpIHx8IHNpemVvZigqJmgtPmZpcnN0KSA9PSBzaXplb2YobG9u
ZyBsb25nKSkpIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzEzOSgpOyB9IHdoaWxlICgwKTsgZG8g
eyAqKHZvbGF0aWxlIHR5cGVvZigqJmgtPmZpcnN0KSAqKSYoKiZoLT5maXJzdCkgPSAoKHR5
cGVvZigqKCh0eXBlb2YoaC0+Zmlyc3QpKV9yX2FfcF9fdikpICopKCh0eXBlb2YoaC0+Zmly
c3QpKV9yX2FfcF9fdikpOyB9IHdoaWxlICgwKTsgfSB3aGlsZSAoMCk7IH0gd2hpbGUgKDAp
OyB9IHdoaWxlICgwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IGhsaXN0X2Js
X25vZGUgKmhsaXN0X2JsX2ZpcnN0X3JjdShzdHJ1Y3QgaGxpc3RfYmxfaGVhZCAqaCkKewog
cmV0dXJuIChzdHJ1Y3QgaGxpc3RfYmxfbm9kZSAqKQogICgodW5zaWduZWQgbG9uZykoeyB0
eXBlb2YoKihoLT5maXJzdCkpICpfX19fX19fX3AxID0gKHR5cGVvZigqKGgtPmZpcnN0KSkg
KikoeyBkbyB7IGV4dGVybiB2b2lkIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzE0MCh2b2lkKSBf
X2F0dHJpYnV0ZV9fKChfX2Vycm9yX18oIlVuc3VwcG9ydGVkIGFjY2VzcyBzaXplIGZvciB7
UkVBRCxXUklURX1fT05DRSgpLiIpKSk7IGlmICghKChzaXplb2YoKGgtPmZpcnN0KSkgPT0g
c2l6ZW9mKGNoYXIpIHx8IHNpemVvZigoaC0+Zmlyc3QpKSA9PSBzaXplb2Yoc2hvcnQpIHx8
IHNpemVvZigoaC0+Zmlyc3QpKSA9PSBzaXplb2YoaW50KSB8fCBzaXplb2YoKGgtPmZpcnN0
KSkgPT0gc2l6ZW9mKGxvbmcpKSB8fCBzaXplb2YoKGgtPmZpcnN0KSkgPT0gc2l6ZW9mKGxv
bmcgbG9uZykpKSBfX2NvbXBpbGV0aW1lX2Fzc2VydF8xNDAoKTsgfSB3aGlsZSAoMCk7ICh7
IHR5cGVvZiggX0dlbmVyaWMoKChoLT5maXJzdCkpLCBjaGFyOiAoY2hhcikwLCB1bnNpZ25l
ZCBjaGFyOiAodW5zaWduZWQgY2hhcikwLCBzaWduZWQgY2hhcjogKHNpZ25lZCBjaGFyKTAs
IHVuc2lnbmVkIHNob3J0OiAodW5zaWduZWQgc2hvcnQpMCwgc2lnbmVkIHNob3J0OiAoc2ln
bmVkIHNob3J0KTAsIHVuc2lnbmVkIGludDogKHVuc2lnbmVkIGludCkwLCBzaWduZWQgaW50
OiAoc2lnbmVkIGludCkwLCB1bnNpZ25lZCBsb25nOiAodW5zaWduZWQgbG9uZykwLCBzaWdu
ZWQgbG9uZzogKHNpZ25lZCBsb25nKTAsIHVuc2lnbmVkIGxvbmcgbG9uZzogKHVuc2lnbmVk
IGxvbmcgbG9uZykwLCBzaWduZWQgbG9uZyBsb25nOiAoc2lnbmVkIGxvbmcgbG9uZykwLCBk
ZWZhdWx0OiAoKGgtPmZpcnN0KSkpKSBfX3ggPSAoKihjb25zdCB2b2xhdGlsZSB0eXBlb2Yo
IF9HZW5lcmljKCgoaC0+Zmlyc3QpKSwgY2hhcjogKGNoYXIpMCwgdW5zaWduZWQgY2hhcjog
KHVuc2lnbmVkIGNoYXIpMCwgc2lnbmVkIGNoYXI6IChzaWduZWQgY2hhcikwLCB1bnNpZ25l
ZCBzaG9ydDogKHVuc2lnbmVkIHNob3J0KTAsIHNpZ25lZCBzaG9ydDogKHNpZ25lZCBzaG9y
dCkwLCB1bnNpZ25lZCBpbnQ6ICh1bnNpZ25lZCBpbnQpMCwgc2lnbmVkIGludDogKHNpZ25l
ZCBpbnQpMCwgdW5zaWduZWQgbG9uZzogKHVuc2lnbmVkIGxvbmcpMCwgc2lnbmVkIGxvbmc6
IChzaWduZWQgbG9uZykwLCB1bnNpZ25lZCBsb25nIGxvbmc6ICh1bnNpZ25lZCBsb25nIGxv
bmcpMCwgc2lnbmVkIGxvbmcgbG9uZzogKHNpZ25lZCBsb25nIGxvbmcpMCwgZGVmYXVsdDog
KChoLT5maXJzdCkpKSkgKikmKChoLT5maXJzdCkpKTsgZG8geyB9IHdoaWxlICgwKTsgKHR5
cGVvZigoaC0+Zmlyc3QpKSlfX3g7IH0pOyB9KTsgZG8geyB9IHdoaWxlICgwKTsgOyAoKHR5
cGVvZigqKGgtPmZpcnN0KSkgKikoX19fX19fX19wMSkpOyB9KSAmIH4xVUwpOwp9CiMgNDYg
Ii4vaW5jbHVkZS9saW51eC9yY3VsaXN0X2JsLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGhsaXN0X2Js
X2RlbF9yY3Uoc3RydWN0IGhsaXN0X2JsX25vZGUgKm4pCnsKIF9faGxpc3RfYmxfZGVsKG4p
Owogbi0+cHByZXYgPSAoKHZvaWQgKikgMHgxMjIgKyAoMHg1ZGVhZGJlZWYwMDAwMDAwVUwp
KTsKfQojIDcxICIuL2luY2x1ZGUvbGludXgvcmN1bGlzdF9ibC5oIgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9p
ZCBobGlzdF9ibF9hZGRfaGVhZF9yY3Uoc3RydWN0IGhsaXN0X2JsX25vZGUgKm4sCiAgICAg
c3RydWN0IGhsaXN0X2JsX2hlYWQgKmgpCnsKIHN0cnVjdCBobGlzdF9ibF9ub2RlICpmaXJz
dDsKCgogZmlyc3QgPSBobGlzdF9ibF9maXJzdChoKTsKCiBuLT5uZXh0ID0gZmlyc3Q7CiBp
ZiAoZmlyc3QpCiAgZmlyc3QtPnBwcmV2ID0gJm4tPm5leHQ7CiBuLT5wcHJldiA9ICZoLT5m
aXJzdDsKCgogaGxpc3RfYmxfc2V0X2ZpcnN0X3JjdShoLCBuKTsKfQojIDkgIi4vaW5jbHVk
ZS9saW51eC9kY2FjaGUuaCIgMgoKCgoKIyAxICIuL2luY2x1ZGUvbGludXgvbG9ja3JlZi5o
IiAxCiMgMjUgIi4vaW5jbHVkZS9saW51eC9sb2NrcmVmLmgiCnN0cnVjdCBsb2NrcmVmIHsK
IHVuaW9uIHsKCiAgX191NjQgX19hdHRyaWJ1dGVfXygoYWxpZ25lZCg4KSkpIGxvY2tfY291
bnQ7CgogIHN0cnVjdCB7CiAgIHNwaW5sb2NrX3QgbG9jazsKICAgaW50IGNvdW50OwogIH07
CiB9Owp9OwoKZXh0ZXJuIHZvaWQgbG9ja3JlZl9nZXQoc3RydWN0IGxvY2tyZWYgKik7CmV4
dGVybiBpbnQgbG9ja3JlZl9wdXRfcmV0dXJuKHN0cnVjdCBsb2NrcmVmICopOwpleHRlcm4g
aW50IGxvY2tyZWZfZ2V0X25vdF96ZXJvKHN0cnVjdCBsb2NrcmVmICopOwpleHRlcm4gaW50
IGxvY2tyZWZfcHV0X25vdF96ZXJvKHN0cnVjdCBsb2NrcmVmICopOwpleHRlcm4gaW50IGxv
Y2tyZWZfZ2V0X29yX2xvY2soc3RydWN0IGxvY2tyZWYgKik7CmV4dGVybiBpbnQgbG9ja3Jl
Zl9wdXRfb3JfbG9jayhzdHJ1Y3QgbG9ja3JlZiAqKTsKCmV4dGVybiB2b2lkIGxvY2tyZWZf
bWFya19kZWFkKHN0cnVjdCBsb2NrcmVmICopOwpleHRlcm4gaW50IGxvY2tyZWZfZ2V0X25v
dF9kZWFkKHN0cnVjdCBsb2NrcmVmICopOwoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIF9fbG9ja3JlZl9p
c19kZWFkKGNvbnN0IHN0cnVjdCBsb2NrcmVmICpsKQp7CiByZXR1cm4gKChpbnQpbC0+Y291
bnQgPCAwKTsKfQojIDE0ICIuL2luY2x1ZGUvbGludXgvZGNhY2hlLmgiIDIKIyAxICIuL2lu
Y2x1ZGUvbGludXgvc3RyaW5naGFzaC5oIiAxCgoKCgoKCiMgMSAiLi9pbmNsdWRlL2xpbnV4
L2hhc2guaCIgMQojIDYwICIuL2luY2x1ZGUvbGludXgvaGFzaC5oIgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdTMy
IF9faGFzaF8zMl9nZW5lcmljKHUzMiB2YWwpCnsKIHJldHVybiB2YWwgKiAweDYxQzg4NjQ3
Owp9CgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgdTMyIGhhc2hfMzJfZ2VuZXJpYyh1MzIgdmFsLCB1bnNpZ25l
ZCBpbnQgYml0cykKewoKIHJldHVybiBfX2hhc2hfMzJfZ2VuZXJpYyh2YWwpID4+ICgzMiAt
IGJpdHMpOwp9CgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5l
X18pKSB1MzIgaGFzaF82NF9nZW5lcmljKHU2NCB2YWwsIHVuc2lnbmVkIGludCBiaXRzKQp7
CgoKIHJldHVybiB2YWwgKiAweDYxQzg4NjQ2ODBCNTgzRUJ1bGwgPj4gKDY0IC0gYml0cyk7
CgoKCgp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgdTMyIGhhc2hfcHRyKGNvbnN0IHZvaWQgKnB0ciwgdW5zaWdu
ZWQgaW50IGJpdHMpCnsKIHJldHVybiBoYXNoXzY0X2dlbmVyaWMoKHVuc2lnbmVkIGxvbmcp
cHRyLCBiaXRzKTsKfQoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1MzIgaGFzaDMyX3B0cihjb25zdCB2b2lkICpw
dHIpCnsKIHVuc2lnbmVkIGxvbmcgdmFsID0gKHVuc2lnbmVkIGxvbmcpcHRyOwoKCiB2YWwg
Xj0gKHZhbCA+PiAzMik7CgogcmV0dXJuICh1MzIpdmFsOwp9CiMgOCAiLi9pbmNsdWRlL2xp
bnV4L3N0cmluZ2hhc2guaCIgMgojIDQyICIuL2luY2x1ZGUvbGludXgvc3RyaW5naGFzaC5o
IgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgdW5zaWduZWQgbG9uZwpwYXJ0aWFsX25hbWVfaGFzaCh1bnNpZ25lZCBs
b25nIGMsIHVuc2lnbmVkIGxvbmcgcHJldmhhc2gpCnsKIHJldHVybiAocHJldmhhc2ggKyAo
YyA8PCA0KSArIChjID4+IDQpKSAqIDExOwp9CgoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1bnNpZ25lZCBp
bnQgZW5kX25hbWVfaGFzaCh1bnNpZ25lZCBsb25nIGhhc2gpCnsKIHJldHVybiBoYXNoXzY0
X2dlbmVyaWMoaGFzaCwgMzIpOwp9CiMgNjYgIi4vaW5jbHVkZS9saW51eC9zdHJpbmdoYXNo
LmgiCmV4dGVybiB1bnNpZ25lZCBpbnQgX19hdHRyaWJ1dGVfXygoX19wdXJlX18pKSBmdWxs
X25hbWVfaGFzaChjb25zdCB2b2lkICpzYWx0LCBjb25zdCBjaGFyICosIHVuc2lnbmVkIGlu
dCk7CiMgNzcgIi4vaW5jbHVkZS9saW51eC9zdHJpbmdoYXNoLmgiCmV4dGVybiB1NjQgX19h
dHRyaWJ1dGVfXygoX19wdXJlX18pKSBoYXNobGVuX3N0cmluZyhjb25zdCB2b2lkICpzYWx0
LCBjb25zdCBjaGFyICpuYW1lKTsKIyAxNSAiLi9pbmNsdWRlL2xpbnV4L2RjYWNoZS5oIiAy
CgoKc3RydWN0IHBhdGg7CnN0cnVjdCB2ZnNtb3VudDsKIyA0NyAiLi9pbmNsdWRlL2xpbnV4
L2RjYWNoZS5oIgpzdHJ1Y3QgcXN0ciB7CiB1bmlvbiB7CiAgc3RydWN0IHsKICAgdTMyIGxl
bjsgdTMyIGhhc2g7CiAgfTsKICB1NjQgaGFzaF9sZW47CiB9OwogY29uc3QgdW5zaWduZWQg
Y2hhciAqbmFtZTsKfTsKCgoKZXh0ZXJuIGNvbnN0IHN0cnVjdCBxc3RyIGVtcHR5X25hbWU7
CmV4dGVybiBjb25zdCBzdHJ1Y3QgcXN0ciBzbGFzaF9uYW1lOwoKc3RydWN0IGRlbnRyeV9z
dGF0X3QgewogbG9uZyBucl9kZW50cnk7CiBsb25nIG5yX3VudXNlZDsKIGxvbmcgYWdlX2xp
bWl0OwogbG9uZyB3YW50X3BhZ2VzOwogbG9uZyBucl9uZWdhdGl2ZTsKIGxvbmcgZHVtbXk7
Cn07CmV4dGVybiBzdHJ1Y3QgZGVudHJ5X3N0YXRfdCBkZW50cnlfc3RhdDsKIyA4OSAiLi9p
bmNsdWRlL2xpbnV4L2RjYWNoZS5oIgpzdHJ1Y3QgZGVudHJ5IHsKCiB1bnNpZ25lZCBpbnQg
ZF9mbGFnczsKIHNlcWNvdW50X3QgZF9zZXE7CiBzdHJ1Y3QgaGxpc3RfYmxfbm9kZSBkX2hh
c2g7CiBzdHJ1Y3QgZGVudHJ5ICpkX3BhcmVudDsKIHN0cnVjdCBxc3RyIGRfbmFtZTsKIHN0
cnVjdCBpbm9kZSAqZF9pbm9kZTsKCiB1bnNpZ25lZCBjaGFyIGRfaW5hbWVbMzJdOwoKCiBz
dHJ1Y3QgbG9ja3JlZiBkX2xvY2tyZWY7CiBjb25zdCBzdHJ1Y3QgZGVudHJ5X29wZXJhdGlv
bnMgKmRfb3A7CiBzdHJ1Y3Qgc3VwZXJfYmxvY2sgKmRfc2I7CiB1bnNpZ25lZCBsb25nIGRf
dGltZTsKIHZvaWQgKmRfZnNkYXRhOwoKIHVuaW9uIHsKICBzdHJ1Y3QgbGlzdF9oZWFkIGRf
bHJ1OwogIHdhaXRfcXVldWVfaGVhZF90ICpkX3dhaXQ7CiB9Owogc3RydWN0IGxpc3RfaGVh
ZCBkX2NoaWxkOwogc3RydWN0IGxpc3RfaGVhZCBkX3N1YmRpcnM7CgoKCiB1bmlvbiB7CiAg
c3RydWN0IGhsaXN0X25vZGUgZF9hbGlhczsKICBzdHJ1Y3QgaGxpc3RfYmxfbm9kZSBkX2lu
X2xvb2t1cF9oYXNoOwogICBzdHJ1Y3QgY2FsbGJhY2tfaGVhZCBkX3JjdTsKIH0gZF91Owp9
IDsKCgoKCgoKCmVudW0gZGVudHJ5X2RfbG9ja19jbGFzcwp7CiBERU5UUllfRF9MT0NLX05P
Uk1BTCwKIERFTlRSWV9EX0xPQ0tfTkVTVEVECn07CgpzdHJ1Y3QgZGVudHJ5X29wZXJhdGlv
bnMgewogaW50ICgqZF9yZXZhbGlkYXRlKShzdHJ1Y3QgZGVudHJ5ICosIHVuc2lnbmVkIGlu
dCk7CiBpbnQgKCpkX3dlYWtfcmV2YWxpZGF0ZSkoc3RydWN0IGRlbnRyeSAqLCB1bnNpZ25l
ZCBpbnQpOwogaW50ICgqZF9oYXNoKShjb25zdCBzdHJ1Y3QgZGVudHJ5ICosIHN0cnVjdCBx
c3RyICopOwogaW50ICgqZF9jb21wYXJlKShjb25zdCBzdHJ1Y3QgZGVudHJ5ICosCiAgIHVu
c2lnbmVkIGludCwgY29uc3QgY2hhciAqLCBjb25zdCBzdHJ1Y3QgcXN0ciAqKTsKIGludCAo
KmRfZGVsZXRlKShjb25zdCBzdHJ1Y3QgZGVudHJ5ICopOwogaW50ICgqZF9pbml0KShzdHJ1
Y3QgZGVudHJ5ICopOwogdm9pZCAoKmRfcmVsZWFzZSkoc3RydWN0IGRlbnRyeSAqKTsKIHZv
aWQgKCpkX3BydW5lKShzdHJ1Y3QgZGVudHJ5ICopOwogdm9pZCAoKmRfaXB1dCkoc3RydWN0
IGRlbnRyeSAqLCBzdHJ1Y3QgaW5vZGUgKik7CiBjaGFyICooKmRfZG5hbWUpKHN0cnVjdCBk
ZW50cnkgKiwgY2hhciAqLCBpbnQpOwogc3RydWN0IHZmc21vdW50ICooKmRfYXV0b21vdW50
KShzdHJ1Y3QgcGF0aCAqKTsKIGludCAoKmRfbWFuYWdlKShjb25zdCBzdHJ1Y3QgcGF0aCAq
LCBib29sKTsKIHN0cnVjdCBkZW50cnkgKigqZF9yZWFsKShzdHJ1Y3QgZGVudHJ5ICosIGNv
bnN0IHN0cnVjdCBpbm9kZSAqKTsKfSBfX2F0dHJpYnV0ZV9fKChfX2FsaWduZWRfXygoMSA8
PCA2KSkpKTsKIyAyMjMgIi4vaW5jbHVkZS9saW51eC9kY2FjaGUuaCIKZXh0ZXJuIHNlcWxv
Y2tfdCByZW5hbWVfbG9jazsKCgoKCmV4dGVybiB2b2lkIGRfaW5zdGFudGlhdGUoc3RydWN0
IGRlbnRyeSAqLCBzdHJ1Y3QgaW5vZGUgKik7CmV4dGVybiB2b2lkIGRfaW5zdGFudGlhdGVf
bmV3KHN0cnVjdCBkZW50cnkgKiwgc3RydWN0IGlub2RlICopOwpleHRlcm4gc3RydWN0IGRl
bnRyeSAqIGRfaW5zdGFudGlhdGVfdW5pcXVlKHN0cnVjdCBkZW50cnkgKiwgc3RydWN0IGlu
b2RlICopOwpleHRlcm4gc3RydWN0IGRlbnRyeSAqIGRfaW5zdGFudGlhdGVfYW5vbihzdHJ1
Y3QgZGVudHJ5ICosIHN0cnVjdCBpbm9kZSAqKTsKZXh0ZXJuIHZvaWQgX19kX2Ryb3Aoc3Ry
dWN0IGRlbnRyeSAqZGVudHJ5KTsKZXh0ZXJuIHZvaWQgZF9kcm9wKHN0cnVjdCBkZW50cnkg
KmRlbnRyeSk7CmV4dGVybiB2b2lkIGRfZGVsZXRlKHN0cnVjdCBkZW50cnkgKik7CmV4dGVy
biB2b2lkIGRfc2V0X2Rfb3Aoc3RydWN0IGRlbnRyeSAqZGVudHJ5LCBjb25zdCBzdHJ1Y3Qg
ZGVudHJ5X29wZXJhdGlvbnMgKm9wKTsKCgpleHRlcm4gc3RydWN0IGRlbnRyeSAqIGRfYWxs
b2Moc3RydWN0IGRlbnRyeSAqLCBjb25zdCBzdHJ1Y3QgcXN0ciAqKTsKZXh0ZXJuIHN0cnVj
dCBkZW50cnkgKiBkX2FsbG9jX2Fub24oc3RydWN0IHN1cGVyX2Jsb2NrICopOwpleHRlcm4g
c3RydWN0IGRlbnRyeSAqIGRfYWxsb2NfcGFyYWxsZWwoc3RydWN0IGRlbnRyeSAqLCBjb25z
dCBzdHJ1Y3QgcXN0ciAqLAogICAgIHdhaXRfcXVldWVfaGVhZF90ICopOwpleHRlcm4gc3Ry
dWN0IGRlbnRyeSAqIGRfc3BsaWNlX2FsaWFzKHN0cnVjdCBpbm9kZSAqLCBzdHJ1Y3QgZGVu
dHJ5ICopOwpleHRlcm4gc3RydWN0IGRlbnRyeSAqIGRfYWRkX2NpKHN0cnVjdCBkZW50cnkg
Kiwgc3RydWN0IGlub2RlICosIHN0cnVjdCBxc3RyICopOwpleHRlcm4gc3RydWN0IGRlbnRy
eSAqIGRfZXhhY3RfYWxpYXMoc3RydWN0IGRlbnRyeSAqLCBzdHJ1Y3QgaW5vZGUgKik7CmV4
dGVybiBzdHJ1Y3QgZGVudHJ5ICpkX2ZpbmRfYW55X2FsaWFzKHN0cnVjdCBpbm9kZSAqaW5v
ZGUpOwpleHRlcm4gc3RydWN0IGRlbnRyeSAqIGRfb2J0YWluX2FsaWFzKHN0cnVjdCBpbm9k
ZSAqKTsKZXh0ZXJuIHN0cnVjdCBkZW50cnkgKiBkX29idGFpbl9yb290KHN0cnVjdCBpbm9k
ZSAqKTsKZXh0ZXJuIHZvaWQgc2hyaW5rX2RjYWNoZV9zYihzdHJ1Y3Qgc3VwZXJfYmxvY2sg
Kik7CmV4dGVybiB2b2lkIHNocmlua19kY2FjaGVfcGFyZW50KHN0cnVjdCBkZW50cnkgKik7
CmV4dGVybiB2b2lkIHNocmlua19kY2FjaGVfZm9yX3Vtb3VudChzdHJ1Y3Qgc3VwZXJfYmxv
Y2sgKik7CmV4dGVybiB2b2lkIGRfaW52YWxpZGF0ZShzdHJ1Y3QgZGVudHJ5ICopOwoKCmV4
dGVybiBzdHJ1Y3QgZGVudHJ5ICogZF9tYWtlX3Jvb3Qoc3RydWN0IGlub2RlICopOwoKCmV4
dGVybiB2b2lkIGRfZ2Vub2NpZGUoc3RydWN0IGRlbnRyeSAqKTsKCmV4dGVybiB2b2lkIGRf
dG1wZmlsZShzdHJ1Y3QgZGVudHJ5ICosIHN0cnVjdCBpbm9kZSAqKTsKCmV4dGVybiBzdHJ1
Y3QgZGVudHJ5ICpkX2ZpbmRfYWxpYXMoc3RydWN0IGlub2RlICopOwpleHRlcm4gdm9pZCBk
X3BydW5lX2FsaWFzZXMoc3RydWN0IGlub2RlICopOwoKCmV4dGVybiBpbnQgcGF0aF9oYXNf
c3VibW91bnRzKGNvbnN0IHN0cnVjdCBwYXRoICopOwoKCgoKZXh0ZXJuIHZvaWQgZF9yZWhh
c2goc3RydWN0IGRlbnRyeSAqKTsKCmV4dGVybiB2b2lkIGRfYWRkKHN0cnVjdCBkZW50cnkg
Kiwgc3RydWN0IGlub2RlICopOwoKCmV4dGVybiB2b2lkIGRfbW92ZShzdHJ1Y3QgZGVudHJ5
ICosIHN0cnVjdCBkZW50cnkgKik7CmV4dGVybiB2b2lkIGRfZXhjaGFuZ2Uoc3RydWN0IGRl
bnRyeSAqLCBzdHJ1Y3QgZGVudHJ5ICopOwpleHRlcm4gc3RydWN0IGRlbnRyeSAqZF9hbmNl
c3RvcihzdHJ1Y3QgZGVudHJ5ICosIHN0cnVjdCBkZW50cnkgKik7CgoKZXh0ZXJuIHN0cnVj
dCBkZW50cnkgKmRfbG9va3VwKGNvbnN0IHN0cnVjdCBkZW50cnkgKiwgY29uc3Qgc3RydWN0
IHFzdHIgKik7CmV4dGVybiBzdHJ1Y3QgZGVudHJ5ICpkX2hhc2hfYW5kX2xvb2t1cChzdHJ1
Y3QgZGVudHJ5ICosIHN0cnVjdCBxc3RyICopOwpleHRlcm4gc3RydWN0IGRlbnRyeSAqX19k
X2xvb2t1cChjb25zdCBzdHJ1Y3QgZGVudHJ5ICosIGNvbnN0IHN0cnVjdCBxc3RyICopOwpl
eHRlcm4gc3RydWN0IGRlbnRyeSAqX19kX2xvb2t1cF9yY3UoY29uc3Qgc3RydWN0IGRlbnRy
eSAqcGFyZW50LAogICAgY29uc3Qgc3RydWN0IHFzdHIgKm5hbWUsIHVuc2lnbmVkICpzZXEp
OwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIHVuc2lnbmVkIGRfY291bnQoY29uc3Qgc3RydWN0IGRlbnRyeSAqZGVu
dHJ5KQp7CiByZXR1cm4gZGVudHJ5LT5kX2xvY2tyZWYuY291bnQ7Cn0KCgoKCmV4dGVybiBf
X2F0dHJpYnV0ZV9fKChfX2Zvcm1hdF9fKHByaW50ZiwgNCwgNSkpKQpjaGFyICpkeW5hbWlj
X2RuYW1lKHN0cnVjdCBkZW50cnkgKiwgY2hhciAqLCBpbnQsIGNvbnN0IGNoYXIgKiwgLi4u
KTsKCmV4dGVybiBjaGFyICpfX2RfcGF0aChjb25zdCBzdHJ1Y3QgcGF0aCAqLCBjb25zdCBz
dHJ1Y3QgcGF0aCAqLCBjaGFyICosIGludCk7CmV4dGVybiBjaGFyICpkX2Fic29sdXRlX3Bh
dGgoY29uc3Qgc3RydWN0IHBhdGggKiwgY2hhciAqLCBpbnQpOwpleHRlcm4gY2hhciAqZF9w
YXRoKGNvbnN0IHN0cnVjdCBwYXRoICosIGNoYXIgKiwgaW50KTsKZXh0ZXJuIGNoYXIgKmRl
bnRyeV9wYXRoX3JhdyhzdHJ1Y3QgZGVudHJ5ICosIGNoYXIgKiwgaW50KTsKZXh0ZXJuIGNo
YXIgKmRlbnRyeV9wYXRoKHN0cnVjdCBkZW50cnkgKiwgY2hhciAqLCBpbnQpOwojIDMxMyAi
Li9pbmNsdWRlL2xpbnV4L2RjYWNoZS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IGRlbnRyeSAqZGdl
dF9kbG9jayhzdHJ1Y3QgZGVudHJ5ICpkZW50cnkpCnsKIGlmIChkZW50cnkpCiAgZGVudHJ5
LT5kX2xvY2tyZWYuY291bnQrKzsKIHJldHVybiBkZW50cnk7Cn0KCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1
Y3QgZGVudHJ5ICpkZ2V0KHN0cnVjdCBkZW50cnkgKmRlbnRyeSkKewogaWYgKGRlbnRyeSkK
ICBsb2NrcmVmX2dldCgmZGVudHJ5LT5kX2xvY2tyZWYpOwogcmV0dXJuIGRlbnRyeTsKfQoK
ZXh0ZXJuIHN0cnVjdCBkZW50cnkgKmRnZXRfcGFyZW50KHN0cnVjdCBkZW50cnkgKmRlbnRy
eSk7CiMgMzM2ICIuL2luY2x1ZGUvbGludXgvZGNhY2hlLmgiCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgZF91
bmhhc2hlZChjb25zdCBzdHJ1Y3QgZGVudHJ5ICpkZW50cnkpCnsKIHJldHVybiBobGlzdF9i
bF91bmhhc2hlZCgmZGVudHJ5LT5kX2hhc2gpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGRfdW5saW5r
ZWQoY29uc3Qgc3RydWN0IGRlbnRyeSAqZGVudHJ5KQp7CiByZXR1cm4gZF91bmhhc2hlZChk
ZW50cnkpICYmICEoKGRlbnRyeSkgPT0gKGRlbnRyeSktPmRfcGFyZW50KTsKfQoKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIGludCBjYW50X21vdW50KGNvbnN0IHN0cnVjdCBkZW50cnkgKmRlbnRyeSkKewogcmV0
dXJuIChkZW50cnktPmRfZmxhZ3MgJiAweDAwMDAwMTAwKTsKfQoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQg
ZG9udF9tb3VudChzdHJ1Y3QgZGVudHJ5ICpkZW50cnkpCnsKIHNwaW5fbG9jaygmZGVudHJ5
LT5kX2xvY2tyZWYubG9jayk7CiBkZW50cnktPmRfZmxhZ3MgfD0gMHgwMDAwMDEwMDsKIHNw
aW5fdW5sb2NrKCZkZW50cnktPmRfbG9ja3JlZi5sb2NrKTsKfQoKZXh0ZXJuIHZvaWQgX19k
X2xvb2t1cF9kb25lKHN0cnVjdCBkZW50cnkgKik7CgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGRfaW5fbG9v
a3VwKGNvbnN0IHN0cnVjdCBkZW50cnkgKmRlbnRyeSkKewogcmV0dXJuIGRlbnRyeS0+ZF9m
bGFncyAmIDB4MTAwMDAwMDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGRfbG9va3VwX2RvbmUoc3Ry
dWN0IGRlbnRyeSAqZGVudHJ5KQp7CiBpZiAoX19idWlsdGluX2V4cGVjdCghIShkX2luX2xv
b2t1cChkZW50cnkpKSwgMCkpIHsKICBzcGluX2xvY2soJmRlbnRyeS0+ZF9sb2NrcmVmLmxv
Y2spOwogIF9fZF9sb29rdXBfZG9uZShkZW50cnkpOwogIHNwaW5fdW5sb2NrKCZkZW50cnkt
PmRfbG9ja3JlZi5sb2NrKTsKIH0KfQoKZXh0ZXJuIHZvaWQgZHB1dChzdHJ1Y3QgZGVudHJ5
ICopOwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIGJvb2wgZF9tYW5hZ2VkKGNvbnN0IHN0cnVjdCBkZW50cnkgKmRl
bnRyeSkKewogcmV0dXJuIGRlbnRyeS0+ZF9mbGFncyAmICgweDAwMDEwMDAwfDB4MDAwMjAw
MDB8MHgwMDA0MDAwMCk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIGRfbW91bnRwb2ludChjb25zdCBz
dHJ1Y3QgZGVudHJ5ICpkZW50cnkpCnsKIHJldHVybiBkZW50cnktPmRfZmxhZ3MgJiAweDAw
MDEwMDAwOwp9CgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgX19kX2VudHJ5X3R5cGUoY29uc3Qg
c3RydWN0IGRlbnRyeSAqZGVudHJ5KQp7CiByZXR1cm4gZGVudHJ5LT5kX2ZsYWdzICYgMHgw
MDcwMDAwMDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgZF9pc19taXNzKGNvbnN0IHN0cnVjdCBkZW50
cnkgKmRlbnRyeSkKewogcmV0dXJuIF9fZF9lbnRyeV90eXBlKGRlbnRyeSkgPT0gMHgwMDAw
MDAwMDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgZF9pc193aGl0ZW91dChjb25zdCBzdHJ1Y3QgZGVu
dHJ5ICpkZW50cnkpCnsKIHJldHVybiBfX2RfZW50cnlfdHlwZShkZW50cnkpID09IDB4MDAx
MDAwMDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIGRfY2FuX2xvb2t1cChjb25zdCBzdHJ1Y3QgZGVu
dHJ5ICpkZW50cnkpCnsKIHJldHVybiBfX2RfZW50cnlfdHlwZShkZW50cnkpID09IDB4MDAy
MDAwMDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIGRfaXNfYXV0b2Rpcihjb25zdCBzdHJ1Y3QgZGVu
dHJ5ICpkZW50cnkpCnsKIHJldHVybiBfX2RfZW50cnlfdHlwZShkZW50cnkpID09IDB4MDAz
MDAwMDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIGRfaXNfZGlyKGNvbnN0IHN0cnVjdCBkZW50cnkg
KmRlbnRyeSkKewogcmV0dXJuIGRfY2FuX2xvb2t1cChkZW50cnkpIHx8IGRfaXNfYXV0b2Rp
cihkZW50cnkpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBkX2lzX3N5bWxpbmsoY29uc3Qgc3RydWN0
IGRlbnRyeSAqZGVudHJ5KQp7CiByZXR1cm4gX19kX2VudHJ5X3R5cGUoZGVudHJ5KSA9PSAw
eDAwNjAwMDAwOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBkX2lzX3JlZyhjb25zdCBzdHJ1Y3QgZGVu
dHJ5ICpkZW50cnkpCnsKIHJldHVybiBfX2RfZW50cnlfdHlwZShkZW50cnkpID09IDB4MDA0
MDAwMDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIGRfaXNfc3BlY2lhbChjb25zdCBzdHJ1Y3QgZGVu
dHJ5ICpkZW50cnkpCnsKIHJldHVybiBfX2RfZW50cnlfdHlwZShkZW50cnkpID09IDB4MDA1
MDAwMDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIGRfaXNfZmlsZShjb25zdCBzdHJ1Y3QgZGVudHJ5
ICpkZW50cnkpCnsKIHJldHVybiBkX2lzX3JlZyhkZW50cnkpIHx8IGRfaXNfc3BlY2lhbChk
ZW50cnkpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBkX2lzX25lZ2F0aXZlKGNvbnN0IHN0cnVjdCBk
ZW50cnkgKmRlbnRyeSkKewoKIHJldHVybiBkX2lzX21pc3MoZGVudHJ5KTsKfQoKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIGJvb2wgZF9mbGFnc19uZWdhdGl2ZSh1bnNpZ25lZCBmbGFncykKewogcmV0dXJuIChm
bGFncyAmIDB4MDA3MDAwMDApID09IDB4MDAwMDAwMDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIGRf
aXNfcG9zaXRpdmUoY29uc3Qgc3RydWN0IGRlbnRyeSAqZGVudHJ5KQp7CiByZXR1cm4gIWRf
aXNfbmVnYXRpdmUoZGVudHJ5KTsKfQojIDQ3MCAiLi9pbmNsdWRlL2xpbnV4L2RjYWNoZS5o
IgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgYm9vbCBkX3JlYWxseV9pc19uZWdhdGl2ZShjb25zdCBzdHJ1Y3QgZGVu
dHJ5ICpkZW50cnkpCnsKIHJldHVybiBkZW50cnktPmRfaW5vZGUgPT0gKCh2b2lkICopMCk7
Cn0KIyA0ODggIi4vaW5jbHVkZS9saW51eC9kY2FjaGUuaCIKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgZF9y
ZWFsbHlfaXNfcG9zaXRpdmUoY29uc3Qgc3RydWN0IGRlbnRyeSAqZGVudHJ5KQp7CiByZXR1
cm4gZGVudHJ5LT5kX2lub2RlICE9ICgodm9pZCAqKTApOwp9CgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHNp
bXBsZV9wb3NpdGl2ZShjb25zdCBzdHJ1Y3QgZGVudHJ5ICpkZW50cnkpCnsKIHJldHVybiBk
X3JlYWxseV9pc19wb3NpdGl2ZShkZW50cnkpICYmICFkX3VuaGFzaGVkKGRlbnRyeSk7Cn0K
CmV4dGVybiB2b2lkIGRfc2V0X2ZhbGx0aHJ1KHN0cnVjdCBkZW50cnkgKmRlbnRyeSk7Cgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgYm9vbCBkX2lzX2ZhbGx0aHJ1KGNvbnN0IHN0cnVjdCBkZW50cnkgKmRlbnRy
eSkKewogcmV0dXJuIGRlbnRyeS0+ZF9mbGFncyAmIDB4MDEwMDAwMDA7Cn0KCgpleHRlcm4g
aW50IHN5c2N0bF92ZnNfY2FjaGVfcHJlc3N1cmU7CgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgbG9u
ZyB2ZnNfcHJlc3N1cmVfcmF0aW8odW5zaWduZWQgbG9uZyB2YWwpCnsKIHJldHVybiAoIHsg
dHlwZW9mKHZhbCkgcXVvdCA9ICh2YWwpIC8gKDEwMCk7IHR5cGVvZih2YWwpIHJlbSA9ICh2
YWwpICUgKDEwMCk7IChxdW90ICogKHN5c2N0bF92ZnNfY2FjaGVfcHJlc3N1cmUpKSArICgo
cmVtICogKHN5c2N0bF92ZnNfY2FjaGVfcHJlc3N1cmUpKSAvICgxMDApKTsgfSApOwp9CiMg
NTIwICIuL2luY2x1ZGUvbGludXgvZGNhY2hlLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3QgaW5vZGUg
KmRfaW5vZGUoY29uc3Qgc3RydWN0IGRlbnRyeSAqZGVudHJ5KQp7CiByZXR1cm4gZGVudHJ5
LT5kX2lub2RlOwp9CiMgNTMyICIuL2luY2x1ZGUvbGludXgvZGNhY2hlLmgiCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBzdHJ1Y3QgaW5vZGUgKmRfaW5vZGVfcmN1KGNvbnN0IHN0cnVjdCBkZW50cnkgKmRlbnRy
eSkKewogcmV0dXJuICh7IGRvIHsgZXh0ZXJuIHZvaWQgX19jb21waWxldGltZV9hc3NlcnRf
MTQxKHZvaWQpIF9fYXR0cmlidXRlX18oKF9fZXJyb3JfXygiVW5zdXBwb3J0ZWQgYWNjZXNz
IHNpemUgZm9yIHtSRUFELFdSSVRFfV9PTkNFKCkuIikpKTsgaWYgKCEoKHNpemVvZihkZW50
cnktPmRfaW5vZGUpID09IHNpemVvZihjaGFyKSB8fCBzaXplb2YoZGVudHJ5LT5kX2lub2Rl
KSA9PSBzaXplb2Yoc2hvcnQpIHx8IHNpemVvZihkZW50cnktPmRfaW5vZGUpID09IHNpemVv
ZihpbnQpIHx8IHNpemVvZihkZW50cnktPmRfaW5vZGUpID09IHNpemVvZihsb25nKSkgfHwg
c2l6ZW9mKGRlbnRyeS0+ZF9pbm9kZSkgPT0gc2l6ZW9mKGxvbmcgbG9uZykpKSBfX2NvbXBp
bGV0aW1lX2Fzc2VydF8xNDEoKTsgfSB3aGlsZSAoMCk7ICh7IHR5cGVvZiggX0dlbmVyaWMo
KGRlbnRyeS0+ZF9pbm9kZSksIGNoYXI6IChjaGFyKTAsIHVuc2lnbmVkIGNoYXI6ICh1bnNp
Z25lZCBjaGFyKTAsIHNpZ25lZCBjaGFyOiAoc2lnbmVkIGNoYXIpMCwgdW5zaWduZWQgc2hv
cnQ6ICh1bnNpZ25lZCBzaG9ydCkwLCBzaWduZWQgc2hvcnQ6IChzaWduZWQgc2hvcnQpMCwg
dW5zaWduZWQgaW50OiAodW5zaWduZWQgaW50KTAsIHNpZ25lZCBpbnQ6IChzaWduZWQgaW50
KTAsIHVuc2lnbmVkIGxvbmc6ICh1bnNpZ25lZCBsb25nKTAsIHNpZ25lZCBsb25nOiAoc2ln
bmVkIGxvbmcpMCwgdW5zaWduZWQgbG9uZyBsb25nOiAodW5zaWduZWQgbG9uZyBsb25nKTAs
IHNpZ25lZCBsb25nIGxvbmc6IChzaWduZWQgbG9uZyBsb25nKTAsIGRlZmF1bHQ6IChkZW50
cnktPmRfaW5vZGUpKSkgX194ID0gKCooY29uc3Qgdm9sYXRpbGUgdHlwZW9mKCBfR2VuZXJp
YygoZGVudHJ5LT5kX2lub2RlKSwgY2hhcjogKGNoYXIpMCwgdW5zaWduZWQgY2hhcjogKHVu
c2lnbmVkIGNoYXIpMCwgc2lnbmVkIGNoYXI6IChzaWduZWQgY2hhcikwLCB1bnNpZ25lZCBz
aG9ydDogKHVuc2lnbmVkIHNob3J0KTAsIHNpZ25lZCBzaG9ydDogKHNpZ25lZCBzaG9ydCkw
LCB1bnNpZ25lZCBpbnQ6ICh1bnNpZ25lZCBpbnQpMCwgc2lnbmVkIGludDogKHNpZ25lZCBp
bnQpMCwgdW5zaWduZWQgbG9uZzogKHVuc2lnbmVkIGxvbmcpMCwgc2lnbmVkIGxvbmc6IChz
aWduZWQgbG9uZykwLCB1bnNpZ25lZCBsb25nIGxvbmc6ICh1bnNpZ25lZCBsb25nIGxvbmcp
MCwgc2lnbmVkIGxvbmcgbG9uZzogKHNpZ25lZCBsb25nIGxvbmcpMCwgZGVmYXVsdDogKGRl
bnRyeS0+ZF9pbm9kZSkpKSAqKSYoZGVudHJ5LT5kX2lub2RlKSk7IGRvIHsgfSB3aGlsZSAo
MCk7ICh0eXBlb2YoZGVudHJ5LT5kX2lub2RlKSlfX3g7IH0pOyB9KTsKfQojIDU0NyAiLi9p
bmNsdWRlL2xpbnV4L2RjYWNoZS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IGlub2RlICpkX2JhY2tp
bmdfaW5vZGUoY29uc3Qgc3RydWN0IGRlbnRyeSAqdXBwZXIpCnsKIHN0cnVjdCBpbm9kZSAq
aW5vZGUgPSB1cHBlci0+ZF9pbm9kZTsKCiByZXR1cm4gaW5vZGU7Cn0KIyA1NjQgIi4vaW5j
bHVkZS9saW51eC9kY2FjaGUuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHN0cnVjdCBkZW50cnkgKmRfYmFja2lu
Z19kZW50cnkoc3RydWN0IGRlbnRyeSAqdXBwZXIpCnsKIHJldHVybiB1cHBlcjsKfQojIDU3
OSAiLi9pbmNsdWRlL2xpbnV4L2RjYWNoZS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IGRlbnRyeSAq
ZF9yZWFsKHN0cnVjdCBkZW50cnkgKmRlbnRyeSwKICAgICAgICBjb25zdCBzdHJ1Y3QgaW5v
ZGUgKmlub2RlKQp7CiBpZiAoX19idWlsdGluX2V4cGVjdCghIShkZW50cnktPmRfZmxhZ3Mg
JiAweDA0MDAwMDAwKSwgMCkpCiAgcmV0dXJuIGRlbnRyeS0+ZF9vcC0+ZF9yZWFsKGRlbnRy
eSwgaW5vZGUpOwogZWxzZQogIHJldHVybiBkZW50cnk7Cn0KIyA1OTUgIi4vaW5jbHVkZS9s
aW51eC9kY2FjaGUuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHN0cnVjdCBpbm9kZSAqZF9yZWFsX2lub2RlKGNv
bnN0IHN0cnVjdCBkZW50cnkgKmRlbnRyeSkKewoKIHJldHVybiBkX2JhY2tpbmdfaW5vZGUo
ZF9yZWFsKChzdHJ1Y3QgZGVudHJ5ICopIGRlbnRyeSwgKCh2b2lkICopMCkpKTsKfQoKc3Ry
dWN0IG5hbWVfc25hcHNob3Qgewogc3RydWN0IHFzdHIgbmFtZTsKIHVuc2lnbmVkIGNoYXIg
aW5saW5lX25hbWVbMzJdOwp9Owp2b2lkIHRha2VfZGVudHJ5X25hbWVfc25hcHNob3Qoc3Ry
dWN0IG5hbWVfc25hcHNob3QgKiwgc3RydWN0IGRlbnRyeSAqKTsKdm9pZCByZWxlYXNlX2Rl
bnRyeV9uYW1lX3NuYXBzaG90KHN0cnVjdCBuYW1lX3NuYXBzaG90ICopOwojIDkgIi4vaW5j
bHVkZS9saW51eC9mcy5oIiAyCiMgMSAiLi9pbmNsdWRlL2xpbnV4L3BhdGguaCIgMQoKCgoK
c3RydWN0IGRlbnRyeTsKc3RydWN0IHZmc21vdW50OwoKc3RydWN0IHBhdGggewogc3RydWN0
IHZmc21vdW50ICptbnQ7CiBzdHJ1Y3QgZGVudHJ5ICpkZW50cnk7Cn0gOwoKZXh0ZXJuIHZv
aWQgcGF0aF9nZXQoY29uc3Qgc3RydWN0IHBhdGggKik7CmV4dGVybiB2b2lkIHBhdGhfcHV0
KGNvbnN0IHN0cnVjdCBwYXRoICopOwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBwYXRoX2VxdWFsKGNvbnN0
IHN0cnVjdCBwYXRoICpwYXRoMSwgY29uc3Qgc3RydWN0IHBhdGggKnBhdGgyKQp7CiByZXR1
cm4gcGF0aDEtPm1udCA9PSBwYXRoMi0+bW50ICYmIHBhdGgxLT5kZW50cnkgPT0gcGF0aDIt
PmRlbnRyeTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgcGF0aF9wdXRfaW5pdChzdHJ1Y3QgcGF0aCAq
cGF0aCkKewogcGF0aF9wdXQocGF0aCk7CiAqcGF0aCA9IChzdHJ1Y3QgcGF0aCkgeyB9Owp9
CiMgMTAgIi4vaW5jbHVkZS9saW51eC9mcy5oIiAyCiMgMSAiLi9pbmNsdWRlL2xpbnV4L3N0
YXQuaCIgMQoKCgoKCiMgMSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS91YXBpL2FzbS9zdGF0
LmgiIDEKIyAzMCAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS91YXBpL2FzbS9zdGF0LmgiCnN0
cnVjdCBzdGF0IHsKIHVuc2lnbmVkIGxvbmcgc3RfZGV2OwogaW5vX3Qgc3RfaW5vOwoKIHVu
c2lnbmVkIGxvbmcgc3Rfbmxpbms7CiBtb2RlX3Qgc3RfbW9kZTsKCgoKCiB1aWRfdCBzdF91
aWQ7CiBnaWRfdCBzdF9naWQ7CiB1bnNpZ25lZCBsb25nIHN0X3JkZXY7CiBsb25nIHN0X3Np
emU7CiB1bnNpZ25lZCBsb25nIHN0X2Jsa3NpemU7CiB1bnNpZ25lZCBsb25nIHN0X2Jsb2Nr
czsKIHVuc2lnbmVkIGxvbmcgc3RfYXRpbWU7CiB1bnNpZ25lZCBsb25nIHN0X2F0aW1lX25z
ZWM7CiB1bnNpZ25lZCBsb25nIHN0X210aW1lOwogdW5zaWduZWQgbG9uZyBzdF9tdGltZV9u
c2VjOwogdW5zaWduZWQgbG9uZyBzdF9jdGltZTsKIHVuc2lnbmVkIGxvbmcgc3RfY3RpbWVf
bnNlYzsKIHVuc2lnbmVkIGxvbmcgX191bnVzZWQ0OwogdW5zaWduZWQgbG9uZyBfX3VudXNl
ZDU7CgogdW5zaWduZWQgbG9uZyBfX3VudXNlZDY7Cgp9OwoKCnN0cnVjdCBzdGF0NjQgewog
dW5zaWduZWQgbG9uZyBsb25nIHN0X2RldjsKIHVuc2lnbmVkIGxvbmcgbG9uZyBzdF9pbm87
CiB1bnNpZ25lZCBpbnQgc3RfbW9kZTsKIHVuc2lnbmVkIGludCBzdF9ubGluazsKIHVuc2ln
bmVkIGludCBzdF91aWQ7CiB1bnNpZ25lZCBpbnQgc3RfZ2lkOwogdW5zaWduZWQgbG9uZyBs
b25nIHN0X3JkZXY7CiB1bnNpZ25lZCBzaG9ydCBfX3BhZDI7CiBsb25nIGxvbmcgc3Rfc2l6
ZTsKIGludCBzdF9ibGtzaXplOwogbG9uZyBsb25nIHN0X2Jsb2NrczsKIGludCBzdF9hdGlt
ZTsKIHVuc2lnbmVkIGludCBzdF9hdGltZV9uc2VjOwogaW50IHN0X210aW1lOwogdW5zaWdu
ZWQgaW50IHN0X210aW1lX25zZWM7CiBpbnQgc3RfY3RpbWU7CiB1bnNpZ25lZCBpbnQgc3Rf
Y3RpbWVfbnNlYzsKIHVuc2lnbmVkIGludCBfX3VudXNlZDQ7CiB1bnNpZ25lZCBpbnQgX191
bnVzZWQ1Owp9OwojIDcgIi4vaW5jbHVkZS9saW51eC9zdGF0LmgiIDIKIyAxICIuL2luY2x1
ZGUvdWFwaS9saW51eC9zdGF0LmgiIDEKIyA1NiAiLi9pbmNsdWRlL3VhcGkvbGludXgvc3Rh
dC5oIgpzdHJ1Y3Qgc3RhdHhfdGltZXN0YW1wIHsKIF9fczY0IHR2X3NlYzsKIF9fdTMyIHR2
X25zZWM7CiBfX3MzMiBfX3Jlc2VydmVkOwp9OwojIDk5ICIuL2luY2x1ZGUvdWFwaS9saW51
eC9zdGF0LmgiCnN0cnVjdCBzdGF0eCB7CgogX191MzIgc3R4X21hc2s7CiBfX3UzMiBzdHhf
Ymxrc2l6ZTsKIF9fdTY0IHN0eF9hdHRyaWJ1dGVzOwoKIF9fdTMyIHN0eF9ubGluazsKIF9f
dTMyIHN0eF91aWQ7CiBfX3UzMiBzdHhfZ2lkOwogX191MTYgc3R4X21vZGU7CiBfX3UxNiBf
X3NwYXJlMFsxXTsKCiBfX3U2NCBzdHhfaW5vOwogX191NjQgc3R4X3NpemU7CiBfX3U2NCBz
dHhfYmxvY2tzOwogX191NjQgc3R4X2F0dHJpYnV0ZXNfbWFzazsKCiBzdHJ1Y3Qgc3RhdHhf
dGltZXN0YW1wIHN0eF9hdGltZTsKIHN0cnVjdCBzdGF0eF90aW1lc3RhbXAgc3R4X2J0aW1l
Owogc3RydWN0IHN0YXR4X3RpbWVzdGFtcCBzdHhfY3RpbWU7CiBzdHJ1Y3Qgc3RhdHhfdGlt
ZXN0YW1wIHN0eF9tdGltZTsKCiBfX3UzMiBzdHhfcmRldl9tYWpvcjsKIF9fdTMyIHN0eF9y
ZGV2X21pbm9yOwogX191MzIgc3R4X2Rldl9tYWpvcjsKIF9fdTMyIHN0eF9kZXZfbWlub3I7
CgogX191NjQgc3R4X21udF9pZDsKIF9fdTY0IF9fc3BhcmUyOwoKIF9fdTY0IF9fc3BhcmUz
WzEyXTsKCn07CiMgOCAiLi9pbmNsdWRlL2xpbnV4L3N0YXQuaCIgMgojIDI0ICIuL2luY2x1
ZGUvbGludXgvc3RhdC5oIgpzdHJ1Y3Qga3N0YXQgewogdTMyIHJlc3VsdF9tYXNrOwogdW1v
ZGVfdCBtb2RlOwogdW5zaWduZWQgaW50IG5saW5rOwogdWludDMyX3QgYmxrc2l6ZTsKIHU2
NCBhdHRyaWJ1dGVzOwogdTY0IGF0dHJpYnV0ZXNfbWFzazsKIyAzOSAiLi9pbmNsdWRlL2xp
bnV4L3N0YXQuaCIKIHU2NCBpbm87CiBkZXZfdCBkZXY7CiBkZXZfdCByZGV2Owoga3VpZF90
IHVpZDsKIGtnaWRfdCBnaWQ7CiBsb2ZmX3Qgc2l6ZTsKIHN0cnVjdCB0aW1lc3BlYzY0IGF0
aW1lOwogc3RydWN0IHRpbWVzcGVjNjQgbXRpbWU7CiBzdHJ1Y3QgdGltZXNwZWM2NCBjdGlt
ZTsKIHN0cnVjdCB0aW1lc3BlYzY0IGJ0aW1lOwogdTY0IGJsb2NrczsKIHU2NCBtbnRfaWQ7
Cn07CiMgMTEgIi4vaW5jbHVkZS9saW51eC9mcy5oIiAyCgoKIyAxICIuL2luY2x1ZGUvbGlu
dXgvbGlzdF9scnUuaCIgMQojIDE1ICIuL2luY2x1ZGUvbGludXgvbGlzdF9scnUuaCIKc3Ry
dWN0IG1lbV9jZ3JvdXA7CgoKZW51bSBscnVfc3RhdHVzIHsKIExSVV9SRU1PVkVELAogTFJV
X1JFTU9WRURfUkVUUlksCgogTFJVX1JPVEFURSwKIExSVV9TS0lQLAogTFJVX1JFVFJZLAoK
fTsKCnN0cnVjdCBsaXN0X2xydV9vbmUgewogc3RydWN0IGxpc3RfaGVhZCBsaXN0OwoKIGxv
bmcgbnJfaXRlbXM7Cn07CgpzdHJ1Y3QgbGlzdF9scnVfbWVtY2cgewogc3RydWN0IGNhbGxi
YWNrX2hlYWQgcmN1OwoKIHN0cnVjdCBsaXN0X2xydV9vbmUgKmxydVtdOwp9OwoKc3RydWN0
IGxpc3RfbHJ1X25vZGUgewoKIHNwaW5sb2NrX3QgbG9jazsKCiBzdHJ1Y3QgbGlzdF9scnVf
b25lIGxydTsKCgoKCiBsb25nIG5yX2l0ZW1zOwp9IF9fYXR0cmlidXRlX18oKF9fYWxpZ25l
ZF9fKCgxIDw8IDYpKSkpOwoKc3RydWN0IGxpc3RfbHJ1IHsKIHN0cnVjdCBsaXN0X2xydV9u
b2RlICpub2RlOwoKCgoKCn07Cgp2b2lkIGxpc3RfbHJ1X2Rlc3Ryb3koc3RydWN0IGxpc3Rf
bHJ1ICpscnUpOwppbnQgX19saXN0X2xydV9pbml0KHN0cnVjdCBsaXN0X2xydSAqbHJ1LCBi
b29sIG1lbWNnX2F3YXJlLAogICAgICBzdHJ1Y3QgbG9ja19jbGFzc19rZXkgKmtleSwgc3Ry
dWN0IHNocmlua2VyICpzaHJpbmtlcik7CiMgNzIgIi4vaW5jbHVkZS9saW51eC9saXN0X2xy
dS5oIgppbnQgbWVtY2dfdXBkYXRlX2FsbF9saXN0X2xydXMoaW50IG51bV9tZW1jZ3MpOwp2
b2lkIG1lbWNnX2RyYWluX2FsbF9saXN0X2xydXMoaW50IHNyY19pZHgsIHN0cnVjdCBtZW1f
Y2dyb3VwICpkc3RfbWVtY2cpOwojIDkxICIuL2luY2x1ZGUvbGludXgvbGlzdF9scnUuaCIK
Ym9vbCBsaXN0X2xydV9hZGQoc3RydWN0IGxpc3RfbHJ1ICpscnUsIHN0cnVjdCBsaXN0X2hl
YWQgKml0ZW0pOwojIDEwNCAiLi9pbmNsdWRlL2xpbnV4L2xpc3RfbHJ1LmgiCmJvb2wgbGlz
dF9scnVfZGVsKHN0cnVjdCBsaXN0X2xydSAqbHJ1LCBzdHJ1Y3QgbGlzdF9oZWFkICppdGVt
KTsKIyAxMTYgIi4vaW5jbHVkZS9saW51eC9saXN0X2xydS5oIgp1bnNpZ25lZCBsb25nIGxp
c3RfbHJ1X2NvdW50X29uZShzdHJ1Y3QgbGlzdF9scnUgKmxydSwKICAgICBpbnQgbmlkLCBz
dHJ1Y3QgbWVtX2Nncm91cCAqbWVtY2cpOwp1bnNpZ25lZCBsb25nIGxpc3RfbHJ1X2NvdW50
X25vZGUoc3RydWN0IGxpc3RfbHJ1ICpscnUsIGludCBuaWQpOwoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHVuc2ln
bmVkIGxvbmcgbGlzdF9scnVfc2hyaW5rX2NvdW50KHN0cnVjdCBsaXN0X2xydSAqbHJ1LAog
ICAgICAgIHN0cnVjdCBzaHJpbmtfY29udHJvbCAqc2MpCnsKIHJldHVybiBsaXN0X2xydV9j
b3VudF9vbmUobHJ1LCBzYy0+bmlkLCBzYy0+bWVtY2cpOwp9CgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWdu
ZWQgbG9uZyBsaXN0X2xydV9jb3VudChzdHJ1Y3QgbGlzdF9scnUgKmxydSkKewogbG9uZyBj
b3VudCA9IDA7CiBpbnQgbmlkOwoKIGZvciAoIChuaWQpID0gMDsgKG5pZCkgPT0gMDsgKG5p
ZCkgPSAxKQogIGNvdW50ICs9IGxpc3RfbHJ1X2NvdW50X25vZGUobHJ1LCBuaWQpOwoKIHJl
dHVybiBjb3VudDsKfQoKdm9pZCBsaXN0X2xydV9pc29sYXRlKHN0cnVjdCBsaXN0X2xydV9v
bmUgKmxpc3QsIHN0cnVjdCBsaXN0X2hlYWQgKml0ZW0pOwp2b2lkIGxpc3RfbHJ1X2lzb2xh
dGVfbW92ZShzdHJ1Y3QgbGlzdF9scnVfb25lICpsaXN0LCBzdHJ1Y3QgbGlzdF9oZWFkICpp
dGVtLAogICAgICBzdHJ1Y3QgbGlzdF9oZWFkICpoZWFkKTsKCnR5cGVkZWYgZW51bSBscnVf
c3RhdHVzICgqbGlzdF9scnVfd2Fsa19jYikoc3RydWN0IGxpc3RfaGVhZCAqaXRlbSwKICBz
dHJ1Y3QgbGlzdF9scnVfb25lICpsaXN0LCBzcGlubG9ja190ICpsb2NrLCB2b2lkICpjYl9h
cmcpOwojIDE2NiAiLi9pbmNsdWRlL2xpbnV4L2xpc3RfbHJ1LmgiCnVuc2lnbmVkIGxvbmcg
bGlzdF9scnVfd2Fsa19vbmUoc3RydWN0IGxpc3RfbHJ1ICpscnUsCiAgICBpbnQgbmlkLCBz
dHJ1Y3QgbWVtX2Nncm91cCAqbWVtY2csCiAgICBsaXN0X2xydV93YWxrX2NiIGlzb2xhdGUs
IHZvaWQgKmNiX2FyZywKICAgIHVuc2lnbmVkIGxvbmcgKm5yX3RvX3dhbGspOwojIDE4MyAi
Li9pbmNsdWRlL2xpbnV4L2xpc3RfbHJ1LmgiCnVuc2lnbmVkIGxvbmcgbGlzdF9scnVfd2Fs
a19vbmVfaXJxKHN0cnVjdCBsaXN0X2xydSAqbHJ1LAogICAgICAgIGludCBuaWQsIHN0cnVj
dCBtZW1fY2dyb3VwICptZW1jZywKICAgICAgICBsaXN0X2xydV93YWxrX2NiIGlzb2xhdGUs
IHZvaWQgKmNiX2FyZywKICAgICAgICB1bnNpZ25lZCBsb25nICpucl90b193YWxrKTsKdW5z
aWduZWQgbG9uZyBsaXN0X2xydV93YWxrX25vZGUoc3RydWN0IGxpc3RfbHJ1ICpscnUsIGlu
dCBuaWQsCiAgICAgbGlzdF9scnVfd2Fsa19jYiBpc29sYXRlLCB2b2lkICpjYl9hcmcsCiAg
ICAgdW5zaWduZWQgbG9uZyAqbnJfdG9fd2Fsayk7CgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgbG9u
ZwpsaXN0X2xydV9zaHJpbmtfd2FsayhzdHJ1Y3QgbGlzdF9scnUgKmxydSwgc3RydWN0IHNo
cmlua19jb250cm9sICpzYywKICAgICAgIGxpc3RfbHJ1X3dhbGtfY2IgaXNvbGF0ZSwgdm9p
ZCAqY2JfYXJnKQp7CiByZXR1cm4gbGlzdF9scnVfd2Fsa19vbmUobHJ1LCBzYy0+bmlkLCBz
Yy0+bWVtY2csIGlzb2xhdGUsIGNiX2FyZywKICAgICAmc2MtPm5yX3RvX3NjYW4pOwp9Cgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgdW5zaWduZWQgbG9uZwpsaXN0X2xydV9zaHJpbmtfd2Fsa19pcnEoc3RydWN0
IGxpc3RfbHJ1ICpscnUsIHN0cnVjdCBzaHJpbmtfY29udHJvbCAqc2MsCiAgICBsaXN0X2xy
dV93YWxrX2NiIGlzb2xhdGUsIHZvaWQgKmNiX2FyZykKewogcmV0dXJuIGxpc3RfbHJ1X3dh
bGtfb25lX2lycShscnUsIHNjLT5uaWQsIHNjLT5tZW1jZywgaXNvbGF0ZSwgY2JfYXJnLAog
ICAgICAgICAmc2MtPm5yX3RvX3NjYW4pOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgbG9uZwps
aXN0X2xydV93YWxrKHN0cnVjdCBsaXN0X2xydSAqbHJ1LCBsaXN0X2xydV93YWxrX2NiIGlz
b2xhdGUsCiAgICAgICB2b2lkICpjYl9hcmcsIHVuc2lnbmVkIGxvbmcgbnJfdG9fd2FsaykK
ewogbG9uZyBpc29sYXRlZCA9IDA7CiBpbnQgbmlkOwoKIGZvciAoIChuaWQpID0gMDsgKG5p
ZCkgPT0gMDsgKG5pZCkgPSAxKSB7CiAgaXNvbGF0ZWQgKz0gbGlzdF9scnVfd2Fsa19ub2Rl
KGxydSwgbmlkLCBpc29sYXRlLAogICAgICAgICAgICBjYl9hcmcsICZucl90b193YWxrKTsK
ICBpZiAobnJfdG9fd2FsayA8PSAwKQogICBicmVhazsKIH0KIHJldHVybiBpc29sYXRlZDsK
fQojIDE0ICIuL2luY2x1ZGUvbGludXgvZnMuaCIgMgoKIyAxICIuL2luY2x1ZGUvbGludXgv
cmFkaXgtdHJlZS5oIiAxCiMgMTggIi4vaW5jbHVkZS9saW51eC9yYWRpeC10cmVlLmgiCiMg
MSAiLi9pbmNsdWRlL2xpbnV4L3hhcnJheS5oIiAxCiMgMTUgIi4vaW5jbHVkZS9saW51eC94
YXJyYXkuaCIKIyAxICIuL2luY2x1ZGUvbGludXgva2NvbmZpZy5oIiAxCiMgMTYgIi4vaW5j
bHVkZS9saW51eC94YXJyYXkuaCIgMgojIDUyICIuL2luY2x1ZGUvbGludXgveGFycmF5Lmgi
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSB2b2lkICp4YV9ta192YWx1ZSh1bnNpZ25lZCBsb25nIHYpCnsKICh7IGlu
dCBfX3JldF93YXJuX29uID0gISEoKGxvbmcpdiA8IDApOyBpZiAoX19idWlsdGluX2NvbnN0
YW50X3AoX19yZXRfd2Fybl9vbikpIHsgaWYgKF9fcmV0X3dhcm5fb24pIF9fYXNtX18gX192
b2xhdGlsZV9fKCAiMToJIiAidHdpIDMxLCAwLCAwIiAiXG4iICIuc2VjdGlvbiBfX2J1Z190
YWJsZSxcImF3XCJcbiIgIjI6XHQiICIuOGJ5dGUiICIgIiAiMWIsICUwXG4iICJcdC5zaG9y
dCAlMSwgJTJcbiIgIi5vcmcgMmIrJTNcbiIgIi5wcmV2aW91c1xuIiA6IDogImkiICgiLi9p
bmNsdWRlL2xpbnV4L3hhcnJheS5oIiksICJpIiAoNTQpLCAiaSIgKCgxIDw8IDApIHwgKCgo
OSkgPDwgOCkpKSwgImkiIChzaXplb2Yoc3RydWN0IGJ1Z19lbnRyeSkpKTsgfSBlbHNlIHsg
X19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgkiICJ0ZG5laSIgIiAiICIgJTQsIDAiICJcbiIg
Ii5zZWN0aW9uIF9fYnVnX3RhYmxlLFwiYXdcIlxuIiAiMjpcdCIgIi44Ynl0ZSIgIiAiICIx
YiwgJTBcbiIgIlx0LnNob3J0ICUxLCAlMlxuIiAiLm9yZyAyYislM1xuIiAiLnByZXZpb3Vz
XG4iIDogOiAiaSIgKCIuL2luY2x1ZGUvbGludXgveGFycmF5LmgiKSwgImkiICg1NCksICJp
IiAoKDEgPDwgMCkgfCAoKDkpIDw8IDgpKSwgImkiIChzaXplb2Yoc3RydWN0IGJ1Z19lbnRy
eSkpLCAiciIgKF9fcmV0X3dhcm5fb24pKTsgfSBfX2J1aWx0aW5fZXhwZWN0KCEhKF9fcmV0
X3dhcm5fb24pLCAwKTsgfSk7CiByZXR1cm4gKHZvaWQgKikoKHYgPDwgMSkgfCAxKTsKfQoj
IDY1ICIuL2luY2x1ZGUvbGludXgveGFycmF5LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1bnNpZ25lZCBsb25n
IHhhX3RvX3ZhbHVlKGNvbnN0IHZvaWQgKmVudHJ5KQp7CiByZXR1cm4gKHVuc2lnbmVkIGxv
bmcpZW50cnkgPj4gMTsKfQojIDc3ICIuL2luY2x1ZGUvbGludXgveGFycmF5LmgiCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBib29sIHhhX2lzX3ZhbHVlKGNvbnN0IHZvaWQgKmVudHJ5KQp7CiByZXR1cm4gKHVu
c2lnbmVkIGxvbmcpZW50cnkgJiAxOwp9CiMgOTUgIi4vaW5jbHVkZS9saW51eC94YXJyYXku
aCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIHZvaWQgKnhhX3RhZ19wb2ludGVyKHZvaWQgKnAsIHVuc2lnbmVkIGxv
bmcgdGFnKQp7CiByZXR1cm4gKHZvaWQgKikoKHVuc2lnbmVkIGxvbmcpcCB8IHRhZyk7Cn0K
IyAxMTAgIi4vaW5jbHVkZS9saW51eC94YXJyYXkuaCIKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgKnhhX3Vu
dGFnX3BvaW50ZXIodm9pZCAqZW50cnkpCnsKIHJldHVybiAodm9pZCAqKSgodW5zaWduZWQg
bG9uZyllbnRyeSAmIH4zVUwpOwp9CiMgMTI1ICIuL2luY2x1ZGUvbGludXgveGFycmF5Lmgi
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSB1bnNpZ25lZCBpbnQgeGFfcG9pbnRlcl90YWcodm9pZCAqZW50cnkpCnsK
IHJldHVybiAodW5zaWduZWQgbG9uZyllbnRyeSAmIDNVTDsKfQojIDE0MyAiLi9pbmNsdWRl
L2xpbnV4L3hhcnJheS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCAqeGFfbWtfaW50ZXJuYWwodW5zaWdu
ZWQgbG9uZyB2KQp7CiByZXR1cm4gKHZvaWQgKikoKHYgPDwgMikgfCAyKTsKfQojIDE1NSAi
Li9pbmNsdWRlL2xpbnV4L3hhcnJheS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgbG9uZyB4YV90
b19pbnRlcm5hbChjb25zdCB2b2lkICplbnRyeSkKewogcmV0dXJuICh1bnNpZ25lZCBsb25n
KWVudHJ5ID4+IDI7Cn0KIyAxNjcgIi4vaW5jbHVkZS9saW51eC94YXJyYXkuaCIKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIGJvb2wgeGFfaXNfaW50ZXJuYWwoY29uc3Qgdm9pZCAqZW50cnkpCnsKIHJldHVybiAo
KHVuc2lnbmVkIGxvbmcpZW50cnkgJiAzKSA9PSAyOwp9CiMgMTgzICIuL2luY2x1ZGUvbGlu
dXgveGFycmF5LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIHhhX2lzX3plcm8oY29uc3Qgdm9pZCAqZW50
cnkpCnsKIHJldHVybiBfX2J1aWx0aW5fZXhwZWN0KCEhKGVudHJ5ID09IHhhX21rX2ludGVy
bmFsKDI1NykpLCAwKTsKfQojIDE5OSAiLi9pbmNsdWRlL2xpbnV4L3hhcnJheS5oIgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgYm9vbCB4YV9pc19lcnIoY29uc3Qgdm9pZCAqZW50cnkpCnsKIHJldHVybiBfX2J1
aWx0aW5fZXhwZWN0KCEhKHhhX2lzX2ludGVybmFsKGVudHJ5KSAmJiBlbnRyeSA+PSB4YV9t
a19pbnRlcm5hbCgtNDA5NSkpLCAwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICA7Cn0KIyAyMTcgIi4vaW5jbHVkZS9saW51eC94YXJyYXkuaCIKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IGludCB4YV9lcnIodm9pZCAqZW50cnkpCnsKCiBpZiAoeGFfaXNfZXJyKGVudHJ5KSkKICBy
ZXR1cm4gKGxvbmcpZW50cnkgPj4gMjsKIHJldHVybiAwOwp9CiMgMjM2ICIuL2luY2x1ZGUv
bGludXgveGFycmF5LmgiCnN0cnVjdCB4YV9saW1pdCB7CiB1MzIgbWF4OwogdTMyIG1pbjsK
fTsKCgoKCgoKdHlwZWRlZiB1bnNpZ25lZCB4YV9tYXJrX3Q7CgoKCgoKCgplbnVtIHhhX2xv
Y2tfdHlwZSB7CiBYQV9MT0NLX0lSUSA9IDEsCiBYQV9MT0NLX0JIID0gMiwKfTsKIyAyOTIg
Ii4vaW5jbHVkZS9saW51eC94YXJyYXkuaCIKc3RydWN0IHhhcnJheSB7CiBzcGlubG9ja190
IHhhX2xvY2s7CgogZ2ZwX3QgeGFfZmxhZ3M7CiB2b2lkICogeGFfaGVhZDsKfTsKIyAzNDcg
Ii4vaW5jbHVkZS9saW51eC94YXJyYXkuaCIKdm9pZCAqeGFfbG9hZChzdHJ1Y3QgeGFycmF5
ICosIHVuc2lnbmVkIGxvbmcgaW5kZXgpOwp2b2lkICp4YV9zdG9yZShzdHJ1Y3QgeGFycmF5
ICosIHVuc2lnbmVkIGxvbmcgaW5kZXgsIHZvaWQgKmVudHJ5LCBnZnBfdCk7CnZvaWQgKnhh
X2VyYXNlKHN0cnVjdCB4YXJyYXkgKiwgdW5zaWduZWQgbG9uZyBpbmRleCk7CnZvaWQgKnhh
X3N0b3JlX3JhbmdlKHN0cnVjdCB4YXJyYXkgKiwgdW5zaWduZWQgbG9uZyBmaXJzdCwgdW5z
aWduZWQgbG9uZyBsYXN0LAogICB2b2lkICplbnRyeSwgZ2ZwX3QpOwpib29sIHhhX2dldF9t
YXJrKHN0cnVjdCB4YXJyYXkgKiwgdW5zaWduZWQgbG9uZyBpbmRleCwgeGFfbWFya190KTsK
dm9pZCB4YV9zZXRfbWFyayhzdHJ1Y3QgeGFycmF5ICosIHVuc2lnbmVkIGxvbmcgaW5kZXgs
IHhhX21hcmtfdCk7CnZvaWQgeGFfY2xlYXJfbWFyayhzdHJ1Y3QgeGFycmF5ICosIHVuc2ln
bmVkIGxvbmcgaW5kZXgsIHhhX21hcmtfdCk7CnZvaWQgKnhhX2ZpbmQoc3RydWN0IHhhcnJh
eSAqeGEsIHVuc2lnbmVkIGxvbmcgKmluZGV4LAogIHVuc2lnbmVkIGxvbmcgbWF4LCB4YV9t
YXJrX3QpIF9fYXR0cmlidXRlX18oKG5vbm51bGwoMikpKTsKdm9pZCAqeGFfZmluZF9hZnRl
cihzdHJ1Y3QgeGFycmF5ICp4YSwgdW5zaWduZWQgbG9uZyAqaW5kZXgsCiAgdW5zaWduZWQg
bG9uZyBtYXgsIHhhX21hcmtfdCkgX19hdHRyaWJ1dGVfXygobm9ubnVsbCgyKSkpOwp1bnNp
Z25lZCBpbnQgeGFfZXh0cmFjdChzdHJ1Y3QgeGFycmF5ICosIHZvaWQgKipkc3QsIHVuc2ln
bmVkIGxvbmcgc3RhcnQsCiAgdW5zaWduZWQgbG9uZyBtYXgsIHVuc2lnbmVkIGludCBuLCB4
YV9tYXJrX3QpOwp2b2lkIHhhX2Rlc3Ryb3koc3RydWN0IHhhcnJheSAqKTsKIyAzNzQgIi4v
aW5jbHVkZS9saW51eC94YXJyYXkuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgeGFfaW5pdF9mbGFncyhz
dHJ1Y3QgeGFycmF5ICp4YSwgZ2ZwX3QgZmxhZ3MpCnsKIGRvIHsgc3BpbmxvY2tfY2hlY2so
JnhhLT54YV9sb2NrKTsgKigmeGEtPnhhX2xvY2spID0gKHNwaW5sb2NrX3QpIHsgeyAucmxv
Y2sgPSB7IC5yYXdfbG9jayA9IHsgMCB9LCB9IH0gfTsgfSB3aGlsZSAoMCk7CiB4YS0+eGFf
ZmxhZ3MgPSBmbGFnczsKIHhhLT54YV9oZWFkID0gKCh2b2lkICopMCk7Cn0KIyAzODkgIi4v
aW5jbHVkZS9saW51eC94YXJyYXkuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgeGFfaW5pdChzdHJ1Y3Qg
eGFycmF5ICp4YSkKewogeGFfaW5pdF9mbGFncyh4YSwgMCk7Cn0KIyA0MDEgIi4vaW5jbHVk
ZS9saW51eC94YXJyYXkuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgeGFfZW1wdHkoY29uc3Qgc3RydWN0
IHhhcnJheSAqeGEpCnsKIHJldHVybiB4YS0+eGFfaGVhZCA9PSAoKHZvaWQgKikwKTsKfQoj
IDQxNCAiLi9pbmNsdWRlL2xpbnV4L3hhcnJheS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCB4YV9tYXJr
ZWQoY29uc3Qgc3RydWN0IHhhcnJheSAqeGEsIHhhX21hcmtfdCBtYXJrKQp7CiByZXR1cm4g
eGEtPnhhX2ZsYWdzICYgKCggZ2ZwX3QpKCgxVSA8PCAoMjMgKyAwKSkgPDwgKCB1bnNpZ25l
ZCkobWFyaykpKTsKfQojIDU1NCAiLi9pbmNsdWRlL2xpbnV4L3hhcnJheS5oIgp2b2lkICpf
X3hhX2VyYXNlKHN0cnVjdCB4YXJyYXkgKiwgdW5zaWduZWQgbG9uZyBpbmRleCk7CnZvaWQg
Kl9feGFfc3RvcmUoc3RydWN0IHhhcnJheSAqLCB1bnNpZ25lZCBsb25nIGluZGV4LCB2b2lk
ICplbnRyeSwgZ2ZwX3QpOwp2b2lkICpfX3hhX2NtcHhjaGcoc3RydWN0IHhhcnJheSAqLCB1
bnNpZ25lZCBsb25nIGluZGV4LCB2b2lkICpvbGQsCiAgdm9pZCAqZW50cnksIGdmcF90KTsK
aW50IF9fYXR0cmlidXRlX18oKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKSBfX3hhX2luc2Vy
dChzdHJ1Y3QgeGFycmF5ICosIHVuc2lnbmVkIGxvbmcgaW5kZXgsCiAgdm9pZCAqZW50cnks
IGdmcF90KTsKaW50IF9fYXR0cmlidXRlX18oKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKSBf
X3hhX2FsbG9jKHN0cnVjdCB4YXJyYXkgKiwgdTMyICppZCwgdm9pZCAqZW50cnksCiAgc3Ry
dWN0IHhhX2xpbWl0LCBnZnBfdCk7CmludCBfX2F0dHJpYnV0ZV9fKChfX3dhcm5fdW51c2Vk
X3Jlc3VsdF9fKSkgX194YV9hbGxvY19jeWNsaWMoc3RydWN0IHhhcnJheSAqLCB1MzIgKmlk
LCB2b2lkICplbnRyeSwKICBzdHJ1Y3QgeGFfbGltaXQsIHUzMiAqbmV4dCwgZ2ZwX3QpOwp2
b2lkIF9feGFfc2V0X21hcmsoc3RydWN0IHhhcnJheSAqLCB1bnNpZ25lZCBsb25nIGluZGV4
LCB4YV9tYXJrX3QpOwp2b2lkIF9feGFfY2xlYXJfbWFyayhzdHJ1Y3QgeGFycmF5ICosIHVu
c2lnbmVkIGxvbmcgaW5kZXgsIHhhX21hcmtfdCk7CiMgNTgxICIuL2luY2x1ZGUvbGludXgv
eGFycmF5LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkICp4YV9zdG9yZV9iaChzdHJ1Y3QgeGFycmF5ICp4
YSwgdW5zaWduZWQgbG9uZyBpbmRleCwKICB2b2lkICplbnRyeSwgZ2ZwX3QgZ2ZwKQp7CiB2
b2lkICpjdXJyOwoKIHNwaW5fbG9ja19iaCgmKHhhKS0+eGFfbG9jayk7CiBjdXJyID0gX194
YV9zdG9yZSh4YSwgaW5kZXgsIGVudHJ5LCBnZnApOwogc3Bpbl91bmxvY2tfYmgoJih4YSkt
PnhhX2xvY2spOwoKIHJldHVybiBjdXJyOwp9CiMgNjA3ICIuL2luY2x1ZGUvbGludXgveGFy
cmF5LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSB2b2lkICp4YV9zdG9yZV9pcnEoc3RydWN0IHhhcnJheSAqeGEs
IHVuc2lnbmVkIGxvbmcgaW5kZXgsCiAgdm9pZCAqZW50cnksIGdmcF90IGdmcCkKewogdm9p
ZCAqY3VycjsKCiBzcGluX2xvY2tfaXJxKCYoeGEpLT54YV9sb2NrKTsKIGN1cnIgPSBfX3hh
X3N0b3JlKHhhLCBpbmRleCwgZW50cnksIGdmcCk7CiBzcGluX3VubG9ja19pcnEoJih4YSkt
PnhhX2xvY2spOwoKIHJldHVybiBjdXJyOwp9CiMgNjMyICIuL2luY2x1ZGUvbGludXgveGFy
cmF5LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSB2b2lkICp4YV9lcmFzZV9iaChzdHJ1Y3QgeGFycmF5ICp4YSwg
dW5zaWduZWQgbG9uZyBpbmRleCkKewogdm9pZCAqZW50cnk7Cgogc3Bpbl9sb2NrX2JoKCYo
eGEpLT54YV9sb2NrKTsKIGVudHJ5ID0gX194YV9lcmFzZSh4YSwgaW5kZXgpOwogc3Bpbl91
bmxvY2tfYmgoJih4YSktPnhhX2xvY2spOwoKIHJldHVybiBlbnRyeTsKfQojIDY1NiAiLi9p
bmNsdWRlL2xpbnV4L3hhcnJheS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCAqeGFfZXJhc2VfaXJxKHN0
cnVjdCB4YXJyYXkgKnhhLCB1bnNpZ25lZCBsb25nIGluZGV4KQp7CiB2b2lkICplbnRyeTsK
CiBzcGluX2xvY2tfaXJxKCYoeGEpLT54YV9sb2NrKTsKIGVudHJ5ID0gX194YV9lcmFzZSh4
YSwgaW5kZXgpOwogc3Bpbl91bmxvY2tfaXJxKCYoeGEpLT54YV9sb2NrKTsKCiByZXR1cm4g
ZW50cnk7Cn0KIyA2ODIgIi4vaW5jbHVkZS9saW51eC94YXJyYXkuaCIKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZv
aWQgKnhhX2NtcHhjaGcoc3RydWN0IHhhcnJheSAqeGEsIHVuc2lnbmVkIGxvbmcgaW5kZXgs
CiAgIHZvaWQgKm9sZCwgdm9pZCAqZW50cnksIGdmcF90IGdmcCkKewogdm9pZCAqY3VycjsK
CiBzcGluX2xvY2soJih4YSktPnhhX2xvY2spOwogY3VyciA9IF9feGFfY21weGNoZyh4YSwg
aW5kZXgsIG9sZCwgZW50cnksIGdmcCk7CiBzcGluX3VubG9jaygmKHhhKS0+eGFfbG9jayk7
CgogcmV0dXJuIGN1cnI7Cn0KIyA3MDkgIi4vaW5jbHVkZS9saW51eC94YXJyYXkuaCIKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIHZvaWQgKnhhX2NtcHhjaGdfYmgoc3RydWN0IHhhcnJheSAqeGEsIHVuc2lnbmVk
IGxvbmcgaW5kZXgsCiAgIHZvaWQgKm9sZCwgdm9pZCAqZW50cnksIGdmcF90IGdmcCkKewog
dm9pZCAqY3VycjsKCiBzcGluX2xvY2tfYmgoJih4YSktPnhhX2xvY2spOwogY3VyciA9IF9f
eGFfY21weGNoZyh4YSwgaW5kZXgsIG9sZCwgZW50cnksIGdmcCk7CiBzcGluX3VubG9ja19i
aCgmKHhhKS0+eGFfbG9jayk7CgogcmV0dXJuIGN1cnI7Cn0KIyA3MzYgIi4vaW5jbHVkZS9s
aW51eC94YXJyYXkuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgKnhhX2NtcHhjaGdfaXJxKHN0cnVjdCB4
YXJyYXkgKnhhLCB1bnNpZ25lZCBsb25nIGluZGV4LAogICB2b2lkICpvbGQsIHZvaWQgKmVu
dHJ5LCBnZnBfdCBnZnApCnsKIHZvaWQgKmN1cnI7Cgogc3Bpbl9sb2NrX2lycSgmKHhhKS0+
eGFfbG9jayk7CiBjdXJyID0gX194YV9jbXB4Y2hnKHhhLCBpbmRleCwgb2xkLCBlbnRyeSwg
Z2ZwKTsKIHNwaW5fdW5sb2NrX2lycSgmKHhhKS0+eGFfbG9jayk7CgogcmV0dXJuIGN1cnI7
Cn0KIyA3NjUgIi4vaW5jbHVkZS9saW51eC94YXJyYXkuaCIKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBfX2F0
dHJpYnV0ZV9fKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkgeGFfaW5zZXJ0KHN0cnVjdCB4
YXJyYXkgKnhhLAogIHVuc2lnbmVkIGxvbmcgaW5kZXgsIHZvaWQgKmVudHJ5LCBnZnBfdCBn
ZnApCnsKIGludCBlcnI7Cgogc3Bpbl9sb2NrKCYoeGEpLT54YV9sb2NrKTsKIGVyciA9IF9f
eGFfaW5zZXJ0KHhhLCBpbmRleCwgZW50cnksIGdmcCk7CiBzcGluX3VubG9jaygmKHhhKS0+
eGFfbG9jayk7CgogcmV0dXJuIGVycjsKfQojIDc5NCAiLi9pbmNsdWRlL2xpbnV4L3hhcnJh
eS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgaW50IF9fYXR0cmlidXRlX18oKF9fd2Fybl91bnVzZWRfcmVzdWx0
X18pKSB4YV9pbnNlcnRfYmgoc3RydWN0IHhhcnJheSAqeGEsCiAgdW5zaWduZWQgbG9uZyBp
bmRleCwgdm9pZCAqZW50cnksIGdmcF90IGdmcCkKewogaW50IGVycjsKCiBzcGluX2xvY2tf
YmgoJih4YSktPnhhX2xvY2spOwogZXJyID0gX194YV9pbnNlcnQoeGEsIGluZGV4LCBlbnRy
eSwgZ2ZwKTsKIHNwaW5fdW5sb2NrX2JoKCYoeGEpLT54YV9sb2NrKTsKCiByZXR1cm4gZXJy
Owp9CiMgODIzICIuL2luY2x1ZGUvbGludXgveGFycmF5LmgiCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgX19h
dHRyaWJ1dGVfXygoX193YXJuX3VudXNlZF9yZXN1bHRfXykpIHhhX2luc2VydF9pcnEoc3Ry
dWN0IHhhcnJheSAqeGEsCiAgdW5zaWduZWQgbG9uZyBpbmRleCwgdm9pZCAqZW50cnksIGdm
cF90IGdmcCkKewogaW50IGVycjsKCiBzcGluX2xvY2tfaXJxKCYoeGEpLT54YV9sb2NrKTsK
IGVyciA9IF9feGFfaW5zZXJ0KHhhLCBpbmRleCwgZW50cnksIGdmcCk7CiBzcGluX3VubG9j
a19pcnEoJih4YSktPnhhX2xvY2spOwoKIHJldHVybiBlcnI7Cn0KIyA4NTIgIi4vaW5jbHVk
ZS9saW51eC94YXJyYXkuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fd2Fybl91bnVz
ZWRfcmVzdWx0X18pKSBpbnQgeGFfYWxsb2Moc3RydWN0IHhhcnJheSAqeGEsIHUzMiAqaWQs
CiAgdm9pZCAqZW50cnksIHN0cnVjdCB4YV9saW1pdCBsaW1pdCwgZ2ZwX3QgZ2ZwKQp7CiBp
bnQgZXJyOwoKIHNwaW5fbG9jaygmKHhhKS0+eGFfbG9jayk7CiBlcnIgPSBfX3hhX2FsbG9j
KHhhLCBpZCwgZW50cnksIGxpbWl0LCBnZnApOwogc3Bpbl91bmxvY2soJih4YSktPnhhX2xv
Y2spOwoKIHJldHVybiBlcnI7Cn0KIyA4ODEgIi4vaW5jbHVkZS9saW51eC94YXJyYXkuaCIK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIGludCBfX2F0dHJpYnV0ZV9fKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkg
eGFfYWxsb2NfYmgoc3RydWN0IHhhcnJheSAqeGEsIHUzMiAqaWQsCiAgdm9pZCAqZW50cnks
IHN0cnVjdCB4YV9saW1pdCBsaW1pdCwgZ2ZwX3QgZ2ZwKQp7CiBpbnQgZXJyOwoKIHNwaW5f
bG9ja19iaCgmKHhhKS0+eGFfbG9jayk7CiBlcnIgPSBfX3hhX2FsbG9jKHhhLCBpZCwgZW50
cnksIGxpbWl0LCBnZnApOwogc3Bpbl91bmxvY2tfYmgoJih4YSktPnhhX2xvY2spOwoKIHJl
dHVybiBlcnI7Cn0KIyA5MTAgIi4vaW5jbHVkZS9saW51eC94YXJyYXkuaCIKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IGludCBfX2F0dHJpYnV0ZV9fKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkgeGFfYWxsb2Nf
aXJxKHN0cnVjdCB4YXJyYXkgKnhhLCB1MzIgKmlkLAogIHZvaWQgKmVudHJ5LCBzdHJ1Y3Qg
eGFfbGltaXQgbGltaXQsIGdmcF90IGdmcCkKewogaW50IGVycjsKCiBzcGluX2xvY2tfaXJx
KCYoeGEpLT54YV9sb2NrKTsKIGVyciA9IF9feGFfYWxsb2MoeGEsIGlkLCBlbnRyeSwgbGlt
aXQsIGdmcCk7CiBzcGluX3VubG9ja19pcnEoJih4YSktPnhhX2xvY2spOwoKIHJldHVybiBl
cnI7Cn0KIyA5NDMgIi4vaW5jbHVkZS9saW51eC94YXJyYXkuaCIKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCB4
YV9hbGxvY19jeWNsaWMoc3RydWN0IHhhcnJheSAqeGEsIHUzMiAqaWQsIHZvaWQgKmVudHJ5
LAogIHN0cnVjdCB4YV9saW1pdCBsaW1pdCwgdTMyICpuZXh0LCBnZnBfdCBnZnApCnsKIGlu
dCBlcnI7Cgogc3Bpbl9sb2NrKCYoeGEpLT54YV9sb2NrKTsKIGVyciA9IF9feGFfYWxsb2Nf
Y3ljbGljKHhhLCBpZCwgZW50cnksIGxpbWl0LCBuZXh0LCBnZnApOwogc3Bpbl91bmxvY2so
Jih4YSktPnhhX2xvY2spOwoKIHJldHVybiBlcnI7Cn0KIyA5NzYgIi4vaW5jbHVkZS9saW51
eC94YXJyYXkuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIGludCB4YV9hbGxvY19jeWNsaWNfYmgoc3RydWN0IHhh
cnJheSAqeGEsIHUzMiAqaWQsIHZvaWQgKmVudHJ5LAogIHN0cnVjdCB4YV9saW1pdCBsaW1p
dCwgdTMyICpuZXh0LCBnZnBfdCBnZnApCnsKIGludCBlcnI7Cgogc3Bpbl9sb2NrX2JoKCYo
eGEpLT54YV9sb2NrKTsKIGVyciA9IF9feGFfYWxsb2NfY3ljbGljKHhhLCBpZCwgZW50cnks
IGxpbWl0LCBuZXh0LCBnZnApOwogc3Bpbl91bmxvY2tfYmgoJih4YSktPnhhX2xvY2spOwoK
IHJldHVybiBlcnI7Cn0KIyAxMDA5ICIuL2luY2x1ZGUvbGludXgveGFycmF5LmgiCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBpbnQgeGFfYWxsb2NfY3ljbGljX2lycShzdHJ1Y3QgeGFycmF5ICp4YSwgdTMyICpp
ZCwgdm9pZCAqZW50cnksCiAgc3RydWN0IHhhX2xpbWl0IGxpbWl0LCB1MzIgKm5leHQsIGdm
cF90IGdmcCkKewogaW50IGVycjsKCiBzcGluX2xvY2tfaXJxKCYoeGEpLT54YV9sb2NrKTsK
IGVyciA9IF9feGFfYWxsb2NfY3ljbGljKHhhLCBpZCwgZW50cnksIGxpbWl0LCBuZXh0LCBn
ZnApOwogc3Bpbl91bmxvY2tfaXJxKCYoeGEpLT54YV9sb2NrKTsKCiByZXR1cm4gZXJyOwp9
CiMgMTAzOSAiLi9pbmNsdWRlL2xpbnV4L3hhcnJheS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1
dGVfXygoX193YXJuX3VudXNlZF9yZXN1bHRfXykpCmludCB4YV9yZXNlcnZlKHN0cnVjdCB4
YXJyYXkgKnhhLCB1bnNpZ25lZCBsb25nIGluZGV4LCBnZnBfdCBnZnApCnsKIHJldHVybiB4
YV9lcnIoeGFfY21weGNoZyh4YSwgaW5kZXgsICgodm9pZCAqKTApLCB4YV9ta19pbnRlcm5h
bCgyNTcpLCBnZnApKTsKfQojIDEwNTcgIi4vaW5jbHVkZS9saW51eC94YXJyYXkuaCIKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIF9fYXR0cmlidXRlX18oKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKQppbnQgeGFf
cmVzZXJ2ZV9iaChzdHJ1Y3QgeGFycmF5ICp4YSwgdW5zaWduZWQgbG9uZyBpbmRleCwgZ2Zw
X3QgZ2ZwKQp7CiByZXR1cm4geGFfZXJyKHhhX2NtcHhjaGdfYmgoeGEsIGluZGV4LCAoKHZv
aWQgKikwKSwgeGFfbWtfaW50ZXJuYWwoMjU3KSwgZ2ZwKSk7Cn0KIyAxMDc1ICIuL2luY2x1
ZGUvbGludXgveGFycmF5LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX3dhcm5fdW51
c2VkX3Jlc3VsdF9fKSkKaW50IHhhX3Jlc2VydmVfaXJxKHN0cnVjdCB4YXJyYXkgKnhhLCB1
bnNpZ25lZCBsb25nIGluZGV4LCBnZnBfdCBnZnApCnsKIHJldHVybiB4YV9lcnIoeGFfY21w
eGNoZ19pcnEoeGEsIGluZGV4LCAoKHZvaWQgKikwKSwgeGFfbWtfaW50ZXJuYWwoMjU3KSwg
Z2ZwKSk7Cn0KIyAxMDkwICIuL2luY2x1ZGUvbGludXgveGFycmF5LmgiCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2
b2lkIHhhX3JlbGVhc2Uoc3RydWN0IHhhcnJheSAqeGEsIHVuc2lnbmVkIGxvbmcgaW5kZXgp
CnsKIHhhX2NtcHhjaGcoeGEsIGluZGV4LCB4YV9ta19pbnRlcm5hbCgyNTcpLCAoKHZvaWQg
KikwKSwgMCk7Cn0KIyAxMTIyICIuL2luY2x1ZGUvbGludXgveGFycmF5LmgiCnN0cnVjdCB4
YV9ub2RlIHsKIHVuc2lnbmVkIGNoYXIgc2hpZnQ7CiB1bnNpZ25lZCBjaGFyIG9mZnNldDsK
IHVuc2lnbmVkIGNoYXIgY291bnQ7CiB1bnNpZ25lZCBjaGFyIG5yX3ZhbHVlczsKIHN0cnVj
dCB4YV9ub2RlICpwYXJlbnQ7CiBzdHJ1Y3QgeGFycmF5ICphcnJheTsKIHVuaW9uIHsKICBz
dHJ1Y3QgbGlzdF9oZWFkIHByaXZhdGVfbGlzdDsKICBzdHJ1Y3QgY2FsbGJhY2tfaGVhZCBj
YWxsYmFja19oZWFkOwogfTsKIHZvaWQgKnNsb3RzWygxVUwgPDwgKDAgPyA0IDogNikpXTsK
IHVuaW9uIHsKICB1bnNpZ25lZCBsb25nIHRhZ3NbM11bKCgoKDFVTCA8PCAoMCA/IDQgOiA2
KSkpICsgKDY0KSAtIDEpIC8gKDY0KSldOwogIHVuc2lnbmVkIGxvbmcgbWFya3NbM11bKCgo
KDFVTCA8PCAoMCA/IDQgOiA2KSkpICsgKDY0KSAtIDEpIC8gKDY0KSldOwogfTsKfTsKCnZv
aWQgeGFfZHVtcChjb25zdCBzdHJ1Y3QgeGFycmF5ICopOwp2b2lkIHhhX2R1bXBfbm9kZShj
b25zdCBzdHJ1Y3QgeGFfbm9kZSAqKTsKIyAxMTYyICIuL2luY2x1ZGUvbGludXgveGFycmF5
LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSB2b2lkICp4YV9oZWFkKGNvbnN0IHN0cnVjdCB4YXJyYXkgKnhhKQp7
CiByZXR1cm4gKHsgdHlwZW9mKCooeGEtPnhhX2hlYWQpKSAqX19fX19fX19wMSA9ICh0eXBl
b2YoKih4YS0+eGFfaGVhZCkpICopKHsgZG8geyBleHRlcm4gdm9pZCBfX2NvbXBpbGV0aW1l
X2Fzc2VydF8xNDIodm9pZCkgX19hdHRyaWJ1dGVfXygoX19lcnJvcl9fKCJVbnN1cHBvcnRl
ZCBhY2Nlc3Mgc2l6ZSBmb3Ige1JFQUQsV1JJVEV9X09OQ0UoKS4iKSkpOyBpZiAoISgoc2l6
ZW9mKCh4YS0+eGFfaGVhZCkpID09IHNpemVvZihjaGFyKSB8fCBzaXplb2YoKHhhLT54YV9o
ZWFkKSkgPT0gc2l6ZW9mKHNob3J0KSB8fCBzaXplb2YoKHhhLT54YV9oZWFkKSkgPT0gc2l6
ZW9mKGludCkgfHwgc2l6ZW9mKCh4YS0+eGFfaGVhZCkpID09IHNpemVvZihsb25nKSkgfHwg
c2l6ZW9mKCh4YS0+eGFfaGVhZCkpID09IHNpemVvZihsb25nIGxvbmcpKSkgX19jb21waWxl
dGltZV9hc3NlcnRfMTQyKCk7IH0gd2hpbGUgKDApOyAoeyB0eXBlb2YoIF9HZW5lcmljKCgo
eGEtPnhhX2hlYWQpKSwgY2hhcjogKGNoYXIpMCwgdW5zaWduZWQgY2hhcjogKHVuc2lnbmVk
IGNoYXIpMCwgc2lnbmVkIGNoYXI6IChzaWduZWQgY2hhcikwLCB1bnNpZ25lZCBzaG9ydDog
KHVuc2lnbmVkIHNob3J0KTAsIHNpZ25lZCBzaG9ydDogKHNpZ25lZCBzaG9ydCkwLCB1bnNp
Z25lZCBpbnQ6ICh1bnNpZ25lZCBpbnQpMCwgc2lnbmVkIGludDogKHNpZ25lZCBpbnQpMCwg
dW5zaWduZWQgbG9uZzogKHVuc2lnbmVkIGxvbmcpMCwgc2lnbmVkIGxvbmc6IChzaWduZWQg
bG9uZykwLCB1bnNpZ25lZCBsb25nIGxvbmc6ICh1bnNpZ25lZCBsb25nIGxvbmcpMCwgc2ln
bmVkIGxvbmcgbG9uZzogKHNpZ25lZCBsb25nIGxvbmcpMCwgZGVmYXVsdDogKCh4YS0+eGFf
aGVhZCkpKSkgX194ID0gKCooY29uc3Qgdm9sYXRpbGUgdHlwZW9mKCBfR2VuZXJpYygoKHhh
LT54YV9oZWFkKSksIGNoYXI6IChjaGFyKTAsIHVuc2lnbmVkIGNoYXI6ICh1bnNpZ25lZCBj
aGFyKTAsIHNpZ25lZCBjaGFyOiAoc2lnbmVkIGNoYXIpMCwgdW5zaWduZWQgc2hvcnQ6ICh1
bnNpZ25lZCBzaG9ydCkwLCBzaWduZWQgc2hvcnQ6IChzaWduZWQgc2hvcnQpMCwgdW5zaWdu
ZWQgaW50OiAodW5zaWduZWQgaW50KTAsIHNpZ25lZCBpbnQ6IChzaWduZWQgaW50KTAsIHVu
c2lnbmVkIGxvbmc6ICh1bnNpZ25lZCBsb25nKTAsIHNpZ25lZCBsb25nOiAoc2lnbmVkIGxv
bmcpMCwgdW5zaWduZWQgbG9uZyBsb25nOiAodW5zaWduZWQgbG9uZyBsb25nKTAsIHNpZ25l
ZCBsb25nIGxvbmc6IChzaWduZWQgbG9uZyBsb25nKTAsIGRlZmF1bHQ6ICgoeGEtPnhhX2hl
YWQpKSkpICopJigoeGEtPnhhX2hlYWQpKSk7IGRvIHsgfSB3aGlsZSAoMCk7ICh0eXBlb2Yo
KHhhLT54YV9oZWFkKSkpX194OyB9KTsgfSk7IGRvIHsgfSB3aGlsZSAoMCk7IDsgKCh0eXBl
b2YoKih4YS0+eGFfaGVhZCkpICopKF9fX19fX19fcDEpKTsgfSkKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgOwp9CgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgKnhhX2hlYWRfbG9j
a2VkKGNvbnN0IHN0cnVjdCB4YXJyYXkgKnhhKQp7CiByZXR1cm4gKHsgZG8geyB9IHdoaWxl
ICgwKTsgOyAoKHR5cGVvZigqKHhhLT54YV9oZWFkKSkgKikoKHhhLT54YV9oZWFkKSkpOyB9
KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA7Cn0KCgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
dm9pZCAqeGFfZW50cnkoY29uc3Qgc3RydWN0IHhhcnJheSAqeGEsCiAgICBjb25zdCBzdHJ1
Y3QgeGFfbm9kZSAqbm9kZSwgdW5zaWduZWQgaW50IG9mZnNldCkKewogZG8geyB9IHdoaWxl
ICgwKTsKIHJldHVybiAoeyB0eXBlb2YoKihub2RlLT5zbG90c1tvZmZzZXRdKSkgKl9fX19f
X19fcDEgPSAodHlwZW9mKCoobm9kZS0+c2xvdHNbb2Zmc2V0XSkpICopKHsgZG8geyBleHRl
cm4gdm9pZCBfX2NvbXBpbGV0aW1lX2Fzc2VydF8xNDModm9pZCkgX19hdHRyaWJ1dGVfXygo
X19lcnJvcl9fKCJVbnN1cHBvcnRlZCBhY2Nlc3Mgc2l6ZSBmb3Ige1JFQUQsV1JJVEV9X09O
Q0UoKS4iKSkpOyBpZiAoISgoc2l6ZW9mKChub2RlLT5zbG90c1tvZmZzZXRdKSkgPT0gc2l6
ZW9mKGNoYXIpIHx8IHNpemVvZigobm9kZS0+c2xvdHNbb2Zmc2V0XSkpID09IHNpemVvZihz
aG9ydCkgfHwgc2l6ZW9mKChub2RlLT5zbG90c1tvZmZzZXRdKSkgPT0gc2l6ZW9mKGludCkg
fHwgc2l6ZW9mKChub2RlLT5zbG90c1tvZmZzZXRdKSkgPT0gc2l6ZW9mKGxvbmcpKSB8fCBz
aXplb2YoKG5vZGUtPnNsb3RzW29mZnNldF0pKSA9PSBzaXplb2YobG9uZyBsb25nKSkpIF9f
Y29tcGlsZXRpbWVfYXNzZXJ0XzE0MygpOyB9IHdoaWxlICgwKTsgKHsgdHlwZW9mKCBfR2Vu
ZXJpYygoKG5vZGUtPnNsb3RzW29mZnNldF0pKSwgY2hhcjogKGNoYXIpMCwgdW5zaWduZWQg
Y2hhcjogKHVuc2lnbmVkIGNoYXIpMCwgc2lnbmVkIGNoYXI6IChzaWduZWQgY2hhcikwLCB1
bnNpZ25lZCBzaG9ydDogKHVuc2lnbmVkIHNob3J0KTAsIHNpZ25lZCBzaG9ydDogKHNpZ25l
ZCBzaG9ydCkwLCB1bnNpZ25lZCBpbnQ6ICh1bnNpZ25lZCBpbnQpMCwgc2lnbmVkIGludDog
KHNpZ25lZCBpbnQpMCwgdW5zaWduZWQgbG9uZzogKHVuc2lnbmVkIGxvbmcpMCwgc2lnbmVk
IGxvbmc6IChzaWduZWQgbG9uZykwLCB1bnNpZ25lZCBsb25nIGxvbmc6ICh1bnNpZ25lZCBs
b25nIGxvbmcpMCwgc2lnbmVkIGxvbmcgbG9uZzogKHNpZ25lZCBsb25nIGxvbmcpMCwgZGVm
YXVsdDogKChub2RlLT5zbG90c1tvZmZzZXRdKSkpKSBfX3ggPSAoKihjb25zdCB2b2xhdGls
ZSB0eXBlb2YoIF9HZW5lcmljKCgobm9kZS0+c2xvdHNbb2Zmc2V0XSkpLCBjaGFyOiAoY2hh
cikwLCB1bnNpZ25lZCBjaGFyOiAodW5zaWduZWQgY2hhcikwLCBzaWduZWQgY2hhcjogKHNp
Z25lZCBjaGFyKTAsIHVuc2lnbmVkIHNob3J0OiAodW5zaWduZWQgc2hvcnQpMCwgc2lnbmVk
IHNob3J0OiAoc2lnbmVkIHNob3J0KTAsIHVuc2lnbmVkIGludDogKHVuc2lnbmVkIGludCkw
LCBzaWduZWQgaW50OiAoc2lnbmVkIGludCkwLCB1bnNpZ25lZCBsb25nOiAodW5zaWduZWQg
bG9uZykwLCBzaWduZWQgbG9uZzogKHNpZ25lZCBsb25nKTAsIHVuc2lnbmVkIGxvbmcgbG9u
ZzogKHVuc2lnbmVkIGxvbmcgbG9uZykwLCBzaWduZWQgbG9uZyBsb25nOiAoc2lnbmVkIGxv
bmcgbG9uZykwLCBkZWZhdWx0OiAoKG5vZGUtPnNsb3RzW29mZnNldF0pKSkpICopJigobm9k
ZS0+c2xvdHNbb2Zmc2V0XSkpKTsgZG8geyB9IHdoaWxlICgwKTsgKHR5cGVvZigobm9kZS0+
c2xvdHNbb2Zmc2V0XSkpKV9feDsgfSk7IH0pOyBkbyB7IH0gd2hpbGUgKDApOyA7ICgodHlw
ZW9mKCoobm9kZS0+c2xvdHNbb2Zmc2V0XSkpICopKF9fX19fX19fcDEpKTsgfSkKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOwp9CgoKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgKnhh
X2VudHJ5X2xvY2tlZChjb25zdCBzdHJ1Y3QgeGFycmF5ICp4YSwKICAgIGNvbnN0IHN0cnVj
dCB4YV9ub2RlICpub2RlLCB1bnNpZ25lZCBpbnQgb2Zmc2V0KQp7CiBkbyB7IH0gd2hpbGUg
KDApOwogcmV0dXJuICh7IGRvIHsgfSB3aGlsZSAoMCk7IDsgKCh0eXBlb2YoKihub2RlLT5z
bG90c1tvZmZzZXRdKSkgKikoKG5vZGUtPnNsb3RzW29mZnNldF0pKSk7IH0pCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIDsKfQoKCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3QgeGFf
bm9kZSAqeGFfcGFyZW50KGNvbnN0IHN0cnVjdCB4YXJyYXkgKnhhLAogICAgIGNvbnN0IHN0
cnVjdCB4YV9ub2RlICpub2RlKQp7CiByZXR1cm4gKHsgdHlwZW9mKCoobm9kZS0+cGFyZW50
KSkgKl9fX19fX19fcDEgPSAodHlwZW9mKCoobm9kZS0+cGFyZW50KSkgKikoeyBkbyB7IGV4
dGVybiB2b2lkIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzE0NCh2b2lkKSBfX2F0dHJpYnV0ZV9f
KChfX2Vycm9yX18oIlVuc3VwcG9ydGVkIGFjY2VzcyBzaXplIGZvciB7UkVBRCxXUklURX1f
T05DRSgpLiIpKSk7IGlmICghKChzaXplb2YoKG5vZGUtPnBhcmVudCkpID09IHNpemVvZihj
aGFyKSB8fCBzaXplb2YoKG5vZGUtPnBhcmVudCkpID09IHNpemVvZihzaG9ydCkgfHwgc2l6
ZW9mKChub2RlLT5wYXJlbnQpKSA9PSBzaXplb2YoaW50KSB8fCBzaXplb2YoKG5vZGUtPnBh
cmVudCkpID09IHNpemVvZihsb25nKSkgfHwgc2l6ZW9mKChub2RlLT5wYXJlbnQpKSA9PSBz
aXplb2YobG9uZyBsb25nKSkpIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzE0NCgpOyB9IHdoaWxl
ICgwKTsgKHsgdHlwZW9mKCBfR2VuZXJpYygoKG5vZGUtPnBhcmVudCkpLCBjaGFyOiAoY2hh
cikwLCB1bnNpZ25lZCBjaGFyOiAodW5zaWduZWQgY2hhcikwLCBzaWduZWQgY2hhcjogKHNp
Z25lZCBjaGFyKTAsIHVuc2lnbmVkIHNob3J0OiAodW5zaWduZWQgc2hvcnQpMCwgc2lnbmVk
IHNob3J0OiAoc2lnbmVkIHNob3J0KTAsIHVuc2lnbmVkIGludDogKHVuc2lnbmVkIGludCkw
LCBzaWduZWQgaW50OiAoc2lnbmVkIGludCkwLCB1bnNpZ25lZCBsb25nOiAodW5zaWduZWQg
bG9uZykwLCBzaWduZWQgbG9uZzogKHNpZ25lZCBsb25nKTAsIHVuc2lnbmVkIGxvbmcgbG9u
ZzogKHVuc2lnbmVkIGxvbmcgbG9uZykwLCBzaWduZWQgbG9uZyBsb25nOiAoc2lnbmVkIGxv
bmcgbG9uZykwLCBkZWZhdWx0OiAoKG5vZGUtPnBhcmVudCkpKSkgX194ID0gKCooY29uc3Qg
dm9sYXRpbGUgdHlwZW9mKCBfR2VuZXJpYygoKG5vZGUtPnBhcmVudCkpLCBjaGFyOiAoY2hh
cikwLCB1bnNpZ25lZCBjaGFyOiAodW5zaWduZWQgY2hhcikwLCBzaWduZWQgY2hhcjogKHNp
Z25lZCBjaGFyKTAsIHVuc2lnbmVkIHNob3J0OiAodW5zaWduZWQgc2hvcnQpMCwgc2lnbmVk
IHNob3J0OiAoc2lnbmVkIHNob3J0KTAsIHVuc2lnbmVkIGludDogKHVuc2lnbmVkIGludCkw
LCBzaWduZWQgaW50OiAoc2lnbmVkIGludCkwLCB1bnNpZ25lZCBsb25nOiAodW5zaWduZWQg
bG9uZykwLCBzaWduZWQgbG9uZzogKHNpZ25lZCBsb25nKTAsIHVuc2lnbmVkIGxvbmcgbG9u
ZzogKHVuc2lnbmVkIGxvbmcgbG9uZykwLCBzaWduZWQgbG9uZyBsb25nOiAoc2lnbmVkIGxv
bmcgbG9uZykwLCBkZWZhdWx0OiAoKG5vZGUtPnBhcmVudCkpKSkgKikmKChub2RlLT5wYXJl
bnQpKSk7IGRvIHsgfSB3aGlsZSAoMCk7ICh0eXBlb2YoKG5vZGUtPnBhcmVudCkpKV9feDsg
fSk7IH0pOyBkbyB7IH0gd2hpbGUgKDApOyA7ICgodHlwZW9mKCoobm9kZS0+cGFyZW50KSkg
KikoX19fX19fX19wMSkpOyB9KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICA7Cn0KCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IHhhX25vZGUgKnhhX3BhcmVudF9sb2NrZWQoY29u
c3Qgc3RydWN0IHhhcnJheSAqeGEsCiAgICAgY29uc3Qgc3RydWN0IHhhX25vZGUgKm5vZGUp
CnsKIHJldHVybiAoeyBkbyB7IH0gd2hpbGUgKDApOyA7ICgodHlwZW9mKCoobm9kZS0+cGFy
ZW50KSkgKikoKG5vZGUtPnBhcmVudCkpKTsgfSkKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgOwp9CgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgKnhhX21rX25vZGUoY29uc3Qgc3Ry
dWN0IHhhX25vZGUgKm5vZGUpCnsKIHJldHVybiAodm9pZCAqKSgodW5zaWduZWQgbG9uZylu
b2RlIHwgMik7Cn0KCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IHhhX25vZGUgKnhhX3RvX25vZGUoY29u
c3Qgdm9pZCAqZW50cnkpCnsKIHJldHVybiAoc3RydWN0IHhhX25vZGUgKikoKHVuc2lnbmVk
IGxvbmcpZW50cnkgLSAyKTsKfQoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIHhhX2lzX25vZGUoY29uc3Qg
dm9pZCAqZW50cnkpCnsKIHJldHVybiB4YV9pc19pbnRlcm5hbChlbnRyeSkgJiYgKHVuc2ln
bmVkIGxvbmcpZW50cnkgPiA0MDk2Owp9CgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgKnhhX21rX3NpYmxp
bmcodW5zaWduZWQgaW50IG9mZnNldCkKewogcmV0dXJuIHhhX21rX2ludGVybmFsKG9mZnNl
dCk7Cn0KCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgbG9uZyB4YV90b19zaWJsaW5nKGNvbnN0IHZv
aWQgKmVudHJ5KQp7CiByZXR1cm4geGFfdG9faW50ZXJuYWwoZW50cnkpOwp9CgoKCgoKCgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgYm9vbCB4YV9pc19zaWJsaW5nKGNvbnN0IHZvaWQgKmVudHJ5KQp7CiByZXR1
cm4gMCAmJiB4YV9pc19pbnRlcm5hbChlbnRyeSkgJiYKICAoZW50cnkgPCB4YV9ta19zaWJs
aW5nKCgxVUwgPDwgKDAgPyA0IDogNikpIC0gMSkpOwp9CiMgMTI1OSAiLi9pbmNsdWRlL2xp
bnV4L3hhcnJheS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCB4YV9pc19yZXRyeShjb25zdCB2b2lkICpl
bnRyeSkKewogcmV0dXJuIF9fYnVpbHRpbl9leHBlY3QoISEoZW50cnkgPT0geGFfbWtfaW50
ZXJuYWwoMjU2KSksIDApOwp9CgoKCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCB4YV9pc19hZHZhbmNl
ZChjb25zdCB2b2lkICplbnRyeSkKewogcmV0dXJuIHhhX2lzX2ludGVybmFsKGVudHJ5KSAm
JiAoZW50cnkgPD0geGFfbWtfaW50ZXJuYWwoMjU2KSk7Cn0KIyAxMjg3ICIuL2luY2x1ZGUv
bGludXgveGFycmF5LmgiCnR5cGVkZWYgdm9pZCAoKnhhX3VwZGF0ZV9ub2RlX3QpKHN0cnVj
dCB4YV9ub2RlICpub2RlKTsKIyAxMzA2ICIuL2luY2x1ZGUvbGludXgveGFycmF5LmgiCnN0
cnVjdCB4YV9zdGF0ZSB7CiBzdHJ1Y3QgeGFycmF5ICp4YTsKIHVuc2lnbmVkIGxvbmcgeGFf
aW5kZXg7CiB1bnNpZ25lZCBjaGFyIHhhX3NoaWZ0OwogdW5zaWduZWQgY2hhciB4YV9zaWJz
OwogdW5zaWduZWQgY2hhciB4YV9vZmZzZXQ7CiB1bnNpZ25lZCBjaGFyIHhhX3BhZDsKIHN0
cnVjdCB4YV9ub2RlICp4YV9ub2RlOwogc3RydWN0IHhhX25vZGUgKnhhX2FsbG9jOwogeGFf
dXBkYXRlX25vZGVfdCB4YV91cGRhdGU7Cn07CiMgMTM4NSAiLi9pbmNsdWRlL2xpbnV4L3hh
cnJheS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgaW50IHhhc19lcnJvcihjb25zdCBzdHJ1Y3QgeGFfc3RhdGUg
KnhhcykKewogcmV0dXJuIHhhX2Vycih4YXMtPnhhX25vZGUpOwp9CiMgMTM5OSAiLi9pbmNs
dWRlL2xpbnV4L3hhcnJheS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCB4YXNfc2V0X2VycihzdHJ1Y3Qg
eGFfc3RhdGUgKnhhcywgbG9uZyBlcnIpCnsKIHhhcy0+eGFfbm9kZSA9ICgoc3RydWN0IHhh
X25vZGUgKikoKCh1bnNpZ25lZCBsb25nKWVyciA8PCAyKSB8IDJVTCkpOwp9CgoKCgoKCgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgYm9vbCB4YXNfaW52YWxpZChjb25zdCBzdHJ1Y3QgeGFfc3RhdGUgKnhhcykK
ewogcmV0dXJuICh1bnNpZ25lZCBsb25nKXhhcy0+eGFfbm9kZSAmIDM7Cn0KCgoKCgoKCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSBib29sIHhhc192YWxpZChjb25zdCBzdHJ1Y3QgeGFfc3RhdGUgKnhhcykKewog
cmV0dXJuICF4YXNfaW52YWxpZCh4YXMpOwp9CgoKCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCB4YXNf
aXNfbm9kZShjb25zdCBzdHJ1Y3QgeGFfc3RhdGUgKnhhcykKewogcmV0dXJuIHhhc192YWxp
ZCh4YXMpICYmIHhhcy0+eGFfbm9kZTsKfQoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIHhhc19ub3Rfbm9k
ZShzdHJ1Y3QgeGFfbm9kZSAqbm9kZSkKewogcmV0dXJuICgodW5zaWduZWQgbG9uZylub2Rl
ICYgMykgfHwgIW5vZGU7Cn0KCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCB4YXNfZnJvemVuKHN0cnVjdCB4
YV9ub2RlICpub2RlKQp7CiByZXR1cm4gKHVuc2lnbmVkIGxvbmcpbm9kZSAmIDI7Cn0KCgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgYm9vbCB4YXNfdG9wKHN0cnVjdCB4YV9ub2RlICpub2RlKQp7CiByZXR1cm4g
bm9kZSA8PSAoKHN0cnVjdCB4YV9ub2RlICopM1VMKTsKfQojIDE0NjUgIi4vaW5jbHVkZS9s
aW51eC94YXJyYXkuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgeGFzX3Jlc2V0KHN0cnVjdCB4YV9zdGF0
ZSAqeGFzKQp7CiB4YXMtPnhhX25vZGUgPSAoKHN0cnVjdCB4YV9ub2RlICopM1VMKTsKfQoj
IDE0ODIgIi4vaW5jbHVkZS9saW51eC94YXJyYXkuaCIKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgeGFzX3Jl
dHJ5KHN0cnVjdCB4YV9zdGF0ZSAqeGFzLCBjb25zdCB2b2lkICplbnRyeSkKewogaWYgKHhh
X2lzX3plcm8oZW50cnkpKQogIHJldHVybiB0cnVlOwogaWYgKCF4YV9pc19yZXRyeShlbnRy
eSkpCiAgcmV0dXJuIGZhbHNlOwogeGFzX3Jlc2V0KHhhcyk7CiByZXR1cm4gdHJ1ZTsKfQoK
dm9pZCAqeGFzX2xvYWQoc3RydWN0IHhhX3N0YXRlICopOwp2b2lkICp4YXNfc3RvcmUoc3Ry
dWN0IHhhX3N0YXRlICosIHZvaWQgKmVudHJ5KTsKdm9pZCAqeGFzX2ZpbmQoc3RydWN0IHhh
X3N0YXRlICosIHVuc2lnbmVkIGxvbmcgbWF4KTsKdm9pZCAqeGFzX2ZpbmRfY29uZmxpY3Qo
c3RydWN0IHhhX3N0YXRlICopOwoKYm9vbCB4YXNfZ2V0X21hcmsoY29uc3Qgc3RydWN0IHhh
X3N0YXRlICosIHhhX21hcmtfdCk7CnZvaWQgeGFzX3NldF9tYXJrKGNvbnN0IHN0cnVjdCB4
YV9zdGF0ZSAqLCB4YV9tYXJrX3QpOwp2b2lkIHhhc19jbGVhcl9tYXJrKGNvbnN0IHN0cnVj
dCB4YV9zdGF0ZSAqLCB4YV9tYXJrX3QpOwp2b2lkICp4YXNfZmluZF9tYXJrZWQoc3RydWN0
IHhhX3N0YXRlICosIHVuc2lnbmVkIGxvbmcgbWF4LCB4YV9tYXJrX3QpOwp2b2lkIHhhc19p
bml0X21hcmtzKGNvbnN0IHN0cnVjdCB4YV9zdGF0ZSAqKTsKCmJvb2wgeGFzX25vbWVtKHN0
cnVjdCB4YV9zdGF0ZSAqLCBnZnBfdCk7CnZvaWQgeGFzX3BhdXNlKHN0cnVjdCB4YV9zdGF0
ZSAqKTsKCnZvaWQgeGFzX2NyZWF0ZV9yYW5nZShzdHJ1Y3QgeGFfc3RhdGUgKik7CiMgMTUy
MiAiLi9pbmNsdWRlL2xpbnV4L3hhcnJheS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCAqeGFzX3JlbG9h
ZChzdHJ1Y3QgeGFfc3RhdGUgKnhhcykKewogc3RydWN0IHhhX25vZGUgKm5vZGUgPSB4YXMt
PnhhX25vZGU7CgogaWYgKG5vZGUpCiAgcmV0dXJuIHhhX2VudHJ5KHhhcy0+eGEsIG5vZGUs
IHhhcy0+eGFfb2Zmc2V0KTsKIHJldHVybiB4YV9oZWFkKHhhcy0+eGEpOwp9CiMgMTU0MCAi
Li9pbmNsdWRlL2xpbnV4L3hhcnJheS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCB4YXNfc2V0KHN0cnVj
dCB4YV9zdGF0ZSAqeGFzLCB1bnNpZ25lZCBsb25nIGluZGV4KQp7CiB4YXMtPnhhX2luZGV4
ID0gaW5kZXg7CiB4YXMtPnhhX25vZGUgPSAoKHN0cnVjdCB4YV9ub2RlICopM1VMKTsKfQoK
CgoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIHZvaWQgeGFzX3NldF9vcmRlcihzdHJ1Y3QgeGFfc3RhdGUgKnhh
cywgdW5zaWduZWQgbG9uZyBpbmRleCwKICAgICB1bnNpZ25lZCBpbnQgb3JkZXIpCnsKCgoK
CgoKIGRvIHsgaWYgKF9fYnVpbHRpbl9jb25zdGFudF9wKG9yZGVyID4gMCkpIHsgaWYgKG9y
ZGVyID4gMCkgZG8geyBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CSIgInR3aSAzMSwgMCwg
MCIgIlxuIiAiLnNlY3Rpb24gX19idWdfdGFibGUsXCJhd1wiXG4iICIyOlx0IiAiLjhieXRl
IiAiICIgIjFiLCAlMFxuIiAiXHQuc2hvcnQgJTEsICUyXG4iICIub3JnIDJiKyUzXG4iICIu
cHJldmlvdXNcbiIgOiA6ICJpIiAoIi4vaW5jbHVkZS9saW51eC94YXJyYXkuaCIpLCAiaSIg
KDE1NjEpLCAiaSIgKDApLCAiaSIgKHNpemVvZihzdHJ1Y3QgYnVnX2VudHJ5KSkpOyBkbyB7
IDsgYXNtIHZvbGF0aWxlKCIiKTsgX19idWlsdGluX3VucmVhY2hhYmxlKCk7IH0gd2hpbGUg
KDApOyB9IHdoaWxlICgwKTsgfSBlbHNlIHsgX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgki
ICJ0ZG5laSIgIiAiICIgJTQsIDAiICJcbiIgIi5zZWN0aW9uIF9fYnVnX3RhYmxlLFwiYXdc
IlxuIiAiMjpcdCIgIi44Ynl0ZSIgIiAiICIxYiwgJTBcbiIgIlx0LnNob3J0ICUxLCAlMlxu
IiAiLm9yZyAyYislM1xuIiAiLnByZXZpb3VzXG4iIDogOiAiaSIgKCIuL2luY2x1ZGUvbGlu
dXgveGFycmF5LmgiKSwgImkiICgxNTYxKSwgImkiICgwKSwgImkiIChzaXplb2Yoc3RydWN0
IGJ1Z19lbnRyeSkpLCAiciIgKCggbG9uZykob3JkZXIgPiAwKSkpOyB9IH0gd2hpbGUgKDAp
OwogeGFzX3NldCh4YXMsIGluZGV4KTsKCn0KIyAxNTc0ICIuL2luY2x1ZGUvbGludXgveGFy
cmF5LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSB2b2lkIHhhc19zZXRfdXBkYXRlKHN0cnVjdCB4YV9zdGF0ZSAq
eGFzLCB4YV91cGRhdGVfbm9kZV90IHVwZGF0ZSkKewogeGFzLT54YV91cGRhdGUgPSB1cGRh
dGU7Cn0KIyAxNTkwICIuL2luY2x1ZGUvbGludXgveGFycmF5LmgiCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lk
ICp4YXNfbmV4dF9lbnRyeShzdHJ1Y3QgeGFfc3RhdGUgKnhhcywgdW5zaWduZWQgbG9uZyBt
YXgpCnsKIHN0cnVjdCB4YV9ub2RlICpub2RlID0geGFzLT54YV9ub2RlOwogdm9pZCAqZW50
cnk7CgogaWYgKF9fYnVpbHRpbl9leHBlY3QoISEoeGFzX25vdF9ub2RlKG5vZGUpIHx8IG5v
ZGUtPnNoaWZ0IHx8IHhhcy0+eGFfb2Zmc2V0ICE9ICh4YXMtPnhhX2luZGV4ICYgKCgxVUwg
PDwgKDAgPyA0IDogNikpIC0gMSkpKSwgMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICApCiAgcmV0dXJuIHhhc19maW5kKHhhcywgbWF4
KTsKCiBkbyB7CiAgaWYgKF9fYnVpbHRpbl9leHBlY3QoISEoeGFzLT54YV9pbmRleCA+PSBt
YXgpLCAwKSkKICAgcmV0dXJuIHhhc19maW5kKHhhcywgbWF4KTsKICBpZiAoX19idWlsdGlu
X2V4cGVjdCghISh4YXMtPnhhX29mZnNldCA9PSAoKDFVTCA8PCAoMCA/IDQgOiA2KSkgLSAx
KSksIDApKQogICByZXR1cm4geGFzX2ZpbmQoeGFzLCBtYXgpOwogIGVudHJ5ID0geGFfZW50
cnkoeGFzLT54YSwgbm9kZSwgeGFzLT54YV9vZmZzZXQgKyAxKTsKICBpZiAoX19idWlsdGlu
X2V4cGVjdCghISh4YV9pc19pbnRlcm5hbChlbnRyeSkpLCAwKSkKICAgcmV0dXJuIHhhc19m
aW5kKHhhcywgbWF4KTsKICB4YXMtPnhhX29mZnNldCsrOwogIHhhcy0+eGFfaW5kZXgrKzsK
IH0gd2hpbGUgKCFlbnRyeSk7CgogcmV0dXJuIGVudHJ5Owp9CgoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHVuc2ln
bmVkIGludCB4YXNfZmluZF9jaHVuayhzdHJ1Y3QgeGFfc3RhdGUgKnhhcywgYm9vbCBhZHZh
bmNlLAogIHhhX21hcmtfdCBtYXJrKQp7CiB1bnNpZ25lZCBsb25nICphZGRyID0geGFzLT54
YV9ub2RlLT5tYXJrc1soIHVuc2lnbmVkKW1hcmtdOwogdW5zaWduZWQgaW50IG9mZnNldCA9
IHhhcy0+eGFfb2Zmc2V0OwoKIGlmIChhZHZhbmNlKQogIG9mZnNldCsrOwogaWYgKCgxVUwg
PDwgKDAgPyA0IDogNikpID09IDY0KSB7CiAgaWYgKG9mZnNldCA8ICgxVUwgPDwgKDAgPyA0
IDogNikpKSB7CiAgIHVuc2lnbmVkIGxvbmcgZGF0YSA9ICphZGRyICYgKH4wVUwgPDwgb2Zm
c2V0KTsKICAgaWYgKGRhdGEpCiAgICByZXR1cm4gX19mZnMoZGF0YSk7CiAgfQogIHJldHVy
biAoMVVMIDw8ICgwID8gNCA6IDYpKTsKIH0KCiByZXR1cm4gZmluZF9uZXh0X2JpdChhZGRy
LCAoMVVMIDw8ICgwID8gNCA6IDYpKSwgb2Zmc2V0KTsKfQojIDE2NDcgIi4vaW5jbHVkZS9s
aW51eC94YXJyYXkuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgKnhhc19uZXh0X21hcmtlZChzdHJ1Y3Qg
eGFfc3RhdGUgKnhhcywgdW5zaWduZWQgbG9uZyBtYXgsCiAgICAgICAgeGFfbWFya190IG1h
cmspCnsKIHN0cnVjdCB4YV9ub2RlICpub2RlID0geGFzLT54YV9ub2RlOwogdm9pZCAqZW50
cnk7CiB1bnNpZ25lZCBpbnQgb2Zmc2V0OwoKIGlmIChfX2J1aWx0aW5fZXhwZWN0KCEhKHhh
c19ub3Rfbm9kZShub2RlKSB8fCBub2RlLT5zaGlmdCksIDApKQogIHJldHVybiB4YXNfZmlu
ZF9tYXJrZWQoeGFzLCBtYXgsIG1hcmspOwogb2Zmc2V0ID0geGFzX2ZpbmRfY2h1bmsoeGFz
LCB0cnVlLCBtYXJrKTsKIHhhcy0+eGFfb2Zmc2V0ID0gb2Zmc2V0OwogeGFzLT54YV9pbmRl
eCA9ICh4YXMtPnhhX2luZGV4ICYgfigoMVVMIDw8ICgwID8gNCA6IDYpKSAtIDEpKSArIG9m
ZnNldDsKIGlmICh4YXMtPnhhX2luZGV4ID4gbWF4KQogIHJldHVybiAoKHZvaWQgKikwKTsK
IGlmIChvZmZzZXQgPT0gKDFVTCA8PCAoMCA/IDQgOiA2KSkpCiAgcmV0dXJuIHhhc19maW5k
X21hcmtlZCh4YXMsIG1heCwgbWFyayk7CiBlbnRyeSA9IHhhX2VudHJ5KHhhcy0+eGEsIG5v
ZGUsIG9mZnNldCk7CiBpZiAoIWVudHJ5KQogIHJldHVybiB4YXNfZmluZF9tYXJrZWQoeGFz
LCBtYXgsIG1hcmspOwogcmV0dXJuIGVudHJ5Owp9CgoKCgoKZW51bSB7CiBYQV9DSEVDS19T
Q0hFRCA9IDQwOTYsCn07CiMgMTcyOCAiLi9pbmNsdWRlL2xpbnV4L3hhcnJheS5oIgp2b2lk
ICpfX3hhc19uZXh0KHN0cnVjdCB4YV9zdGF0ZSAqKTsKdm9pZCAqX194YXNfcHJldihzdHJ1
Y3QgeGFfc3RhdGUgKik7CiMgMTc0NyAiLi9pbmNsdWRlL2xpbnV4L3hhcnJheS5oIgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgdm9pZCAqeGFzX3ByZXYoc3RydWN0IHhhX3N0YXRlICp4YXMpCnsKIHN0cnVjdCB4
YV9ub2RlICpub2RlID0geGFzLT54YV9ub2RlOwoKIGlmIChfX2J1aWx0aW5fZXhwZWN0KCEh
KHhhc19ub3Rfbm9kZShub2RlKSB8fCBub2RlLT5zaGlmdCB8fCB4YXMtPnhhX29mZnNldCA9
PSAwKSwgMCkKICAgICAgICAgICAgICAgICAgICAgICAgKQogIHJldHVybiBfX3hhc19wcmV2
KHhhcyk7CgogeGFzLT54YV9pbmRleC0tOwogeGFzLT54YV9vZmZzZXQtLTsKIHJldHVybiB4
YV9lbnRyeSh4YXMtPnhhLCBub2RlLCB4YXMtPnhhX29mZnNldCk7Cn0KIyAxNzc2ICIuL2lu
Y2x1ZGUvbGludXgveGFycmF5LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkICp4YXNfbmV4dChzdHJ1Y3Qg
eGFfc3RhdGUgKnhhcykKewogc3RydWN0IHhhX25vZGUgKm5vZGUgPSB4YXMtPnhhX25vZGU7
CgogaWYgKF9fYnVpbHRpbl9leHBlY3QoISEoeGFzX25vdF9ub2RlKG5vZGUpIHx8IG5vZGUt
PnNoaWZ0IHx8IHhhcy0+eGFfb2Zmc2V0ID09ICgoMVVMIDw8ICgwID8gNCA6IDYpKSAtIDEp
KSwgMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKQogIHJldHVybiBf
X3hhc19uZXh0KHhhcyk7CgogeGFzLT54YV9pbmRleCsrOwogeGFzLT54YV9vZmZzZXQrKzsK
IHJldHVybiB4YV9lbnRyeSh4YXMtPnhhLCBub2RlLCB4YXMtPnhhX29mZnNldCk7Cn0KIyAx
OSAiLi9pbmNsdWRlL2xpbnV4L3JhZGl4LXRyZWUuaCIgMgojIDEgIi4vaW5jbHVkZS9saW51
eC9sb2NhbF9sb2NrLmgiIDEKCgoKCiMgMSAiLi9pbmNsdWRlL2xpbnV4L2xvY2FsX2xvY2tf
aW50ZXJuYWwuaCIgMQojIDkgIi4vaW5jbHVkZS9saW51eC9sb2NhbF9sb2NrX2ludGVybmFs
LmgiCnR5cGVkZWYgc3RydWN0IHsKCgoKCn0gbG9jYWxfbG9ja190OwojIDUyICIuL2luY2x1
ZGUvbGludXgvbG9jYWxfbG9ja19pbnRlcm5hbC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBsb2NhbF9s
b2NrX2FjcXVpcmUobG9jYWxfbG9ja190ICpsKSB7IH0Kc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgbG9jYWxf
bG9ja19yZWxlYXNlKGxvY2FsX2xvY2tfdCAqbCkgeyB9CiMgNiAiLi9pbmNsdWRlL2xpbnV4
L2xvY2FsX2xvY2suaCIgMgojIDIwICIuL2luY2x1ZGUvbGludXgvcmFkaXgtdHJlZS5oIiAy
CgoKCgoKc3RydWN0IHJhZGl4X3RyZWVfcHJlbG9hZCB7CiBsb2NhbF9sb2NrX3QgbG9jazsK
IHVuc2lnbmVkIG5yOwoKIHN0cnVjdCB4YV9ub2RlICpub2RlczsKfTsKZXh0ZXJuIF9fYXR0
cmlidXRlX18oKHNlY3Rpb24oIi5kYXRhLi5wZXJjcHUiICIiKSkpIF9fdHlwZW9mX18oc3Ry
dWN0IHJhZGl4X3RyZWVfcHJlbG9hZCkgcmFkaXhfdHJlZV9wcmVsb2FkczsKIyA1MiAiLi9p
bmNsdWRlL2xpbnV4L3JhZGl4LXRyZWUuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgcmFkaXhfdHJlZV9p
c19pbnRlcm5hbF9ub2RlKHZvaWQgKnB0cikKewogcmV0dXJuICgodW5zaWduZWQgbG9uZylw
dHIgJiAzVUwpID09CiAgICAyVUw7Cn0KIyA4MyAiLi9pbmNsdWRlL2xpbnV4L3JhZGl4LXRy
ZWUuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIGJvb2wgcmFkaXhfdHJlZV9lbXB0eShjb25zdCBzdHJ1Y3QgeGFy
cmF5ICpyb290KQp7CiByZXR1cm4gcm9vdC0+eGFfaGVhZCA9PSAoKHZvaWQgKikwKTsKfQoj
IDEwMyAiLi9pbmNsdWRlL2xpbnV4L3JhZGl4LXRyZWUuaCIKc3RydWN0IHJhZGl4X3RyZWVf
aXRlciB7CiB1bnNpZ25lZCBsb25nIGluZGV4OwogdW5zaWduZWQgbG9uZyBuZXh0X2luZGV4
OwogdW5zaWduZWQgbG9uZyB0YWdzOwogc3RydWN0IHhhX25vZGUgKm5vZGU7Cn07CiMgMTc0
ICIuL2luY2x1ZGUvbGludXgvcmFkaXgtdHJlZS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCAqcmFkaXhf
dHJlZV9kZXJlZl9zbG90KHZvaWQgKipzbG90KQp7CiByZXR1cm4gKHsgdHlwZW9mKCooKnNs
b3QpKSAqX19fX19fX19wMSA9ICh0eXBlb2YoKigqc2xvdCkpICopKHsgZG8geyBleHRlcm4g
dm9pZCBfX2NvbXBpbGV0aW1lX2Fzc2VydF8xNDUodm9pZCkgX19hdHRyaWJ1dGVfXygoX19l
cnJvcl9fKCJVbnN1cHBvcnRlZCBhY2Nlc3Mgc2l6ZSBmb3Ige1JFQUQsV1JJVEV9X09OQ0Uo
KS4iKSkpOyBpZiAoISgoc2l6ZW9mKCgqc2xvdCkpID09IHNpemVvZihjaGFyKSB8fCBzaXpl
b2YoKCpzbG90KSkgPT0gc2l6ZW9mKHNob3J0KSB8fCBzaXplb2YoKCpzbG90KSkgPT0gc2l6
ZW9mKGludCkgfHwgc2l6ZW9mKCgqc2xvdCkpID09IHNpemVvZihsb25nKSkgfHwgc2l6ZW9m
KCgqc2xvdCkpID09IHNpemVvZihsb25nIGxvbmcpKSkgX19jb21waWxldGltZV9hc3NlcnRf
MTQ1KCk7IH0gd2hpbGUgKDApOyAoeyB0eXBlb2YoIF9HZW5lcmljKCgoKnNsb3QpKSwgY2hh
cjogKGNoYXIpMCwgdW5zaWduZWQgY2hhcjogKHVuc2lnbmVkIGNoYXIpMCwgc2lnbmVkIGNo
YXI6IChzaWduZWQgY2hhcikwLCB1bnNpZ25lZCBzaG9ydDogKHVuc2lnbmVkIHNob3J0KTAs
IHNpZ25lZCBzaG9ydDogKHNpZ25lZCBzaG9ydCkwLCB1bnNpZ25lZCBpbnQ6ICh1bnNpZ25l
ZCBpbnQpMCwgc2lnbmVkIGludDogKHNpZ25lZCBpbnQpMCwgdW5zaWduZWQgbG9uZzogKHVu
c2lnbmVkIGxvbmcpMCwgc2lnbmVkIGxvbmc6IChzaWduZWQgbG9uZykwLCB1bnNpZ25lZCBs
b25nIGxvbmc6ICh1bnNpZ25lZCBsb25nIGxvbmcpMCwgc2lnbmVkIGxvbmcgbG9uZzogKHNp
Z25lZCBsb25nIGxvbmcpMCwgZGVmYXVsdDogKCgqc2xvdCkpKSkgX194ID0gKCooY29uc3Qg
dm9sYXRpbGUgdHlwZW9mKCBfR2VuZXJpYygoKCpzbG90KSksIGNoYXI6IChjaGFyKTAsIHVu
c2lnbmVkIGNoYXI6ICh1bnNpZ25lZCBjaGFyKTAsIHNpZ25lZCBjaGFyOiAoc2lnbmVkIGNo
YXIpMCwgdW5zaWduZWQgc2hvcnQ6ICh1bnNpZ25lZCBzaG9ydCkwLCBzaWduZWQgc2hvcnQ6
IChzaWduZWQgc2hvcnQpMCwgdW5zaWduZWQgaW50OiAodW5zaWduZWQgaW50KTAsIHNpZ25l
ZCBpbnQ6IChzaWduZWQgaW50KTAsIHVuc2lnbmVkIGxvbmc6ICh1bnNpZ25lZCBsb25nKTAs
IHNpZ25lZCBsb25nOiAoc2lnbmVkIGxvbmcpMCwgdW5zaWduZWQgbG9uZyBsb25nOiAodW5z
aWduZWQgbG9uZyBsb25nKTAsIHNpZ25lZCBsb25nIGxvbmc6IChzaWduZWQgbG9uZyBsb25n
KTAsIGRlZmF1bHQ6ICgoKnNsb3QpKSkpICopJigoKnNsb3QpKSk7IGRvIHsgfSB3aGlsZSAo
MCk7ICh0eXBlb2YoKCpzbG90KSkpX194OyB9KTsgfSk7IGRvIHsgfSB3aGlsZSAoMCk7IDsg
KCh0eXBlb2YoKigqc2xvdCkpICopKF9fX19fX19fcDEpKTsgfSk7Cn0KIyAxODggIi4vaW5j
bHVkZS9saW51eC9yYWRpeC10cmVlLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkICpyYWRpeF90cmVlX2Rl
cmVmX3Nsb3RfcHJvdGVjdGVkKHZvaWQgKipzbG90LAogICAgICAgc3BpbmxvY2tfdCAqdHJl
ZWxvY2spCnsKIHJldHVybiAoeyBkbyB7IH0gd2hpbGUgKDApOyA7ICgodHlwZW9mKCooKnNs
b3QpKSAqKSgoKnNsb3QpKSk7IH0pOwp9CiMgMjAxICIuL2luY2x1ZGUvbGludXgvcmFkaXgt
dHJlZS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgaW50IHJhZGl4X3RyZWVfZGVyZWZfcmV0cnkodm9pZCAqYXJn
KQp7CiByZXR1cm4gX19idWlsdGluX2V4cGVjdCghIShyYWRpeF90cmVlX2lzX2ludGVybmFs
X25vZGUoYXJnKSksIDApOwp9CgoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgcmFkaXhfdHJlZV9leGNl
cHRpb24odm9pZCAqYXJnKQp7CiByZXR1cm4gX19idWlsdGluX2V4cGVjdCghISgodW5zaWdu
ZWQgbG9uZylhcmcgJiAzVUwpLCAwKTsKfQoKaW50IHJhZGl4X3RyZWVfaW5zZXJ0KHN0cnVj
dCB4YXJyYXkgKiwgdW5zaWduZWQgbG9uZyBpbmRleCwKICAgdm9pZCAqKTsKdm9pZCAqX19y
YWRpeF90cmVlX2xvb2t1cChjb25zdCBzdHJ1Y3QgeGFycmF5ICosIHVuc2lnbmVkIGxvbmcg
aW5kZXgsCiAgICAgc3RydWN0IHhhX25vZGUgKipub2RlcCwgdm9pZCAqKipzbG90cCk7CnZv
aWQgKnJhZGl4X3RyZWVfbG9va3VwKGNvbnN0IHN0cnVjdCB4YXJyYXkgKiwgdW5zaWduZWQg
bG9uZyk7CnZvaWQgKipyYWRpeF90cmVlX2xvb2t1cF9zbG90KGNvbnN0IHN0cnVjdCB4YXJy
YXkgKiwKICAgICB1bnNpZ25lZCBsb25nIGluZGV4KTsKdm9pZCBfX3JhZGl4X3RyZWVfcmVw
bGFjZShzdHJ1Y3QgeGFycmF5ICosIHN0cnVjdCB4YV9ub2RlICosCiAgICAgdm9pZCAqKnNs
b3QsIHZvaWQgKmVudHJ5KTsKdm9pZCByYWRpeF90cmVlX2l0ZXJfcmVwbGFjZShzdHJ1Y3Qg
eGFycmF5ICosCiAgY29uc3Qgc3RydWN0IHJhZGl4X3RyZWVfaXRlciAqLCB2b2lkICoqc2xv
dCwgdm9pZCAqZW50cnkpOwp2b2lkIHJhZGl4X3RyZWVfcmVwbGFjZV9zbG90KHN0cnVjdCB4
YXJyYXkgKiwKICAgICAgICB2b2lkICoqc2xvdCwgdm9pZCAqZW50cnkpOwp2b2lkIHJhZGl4
X3RyZWVfaXRlcl9kZWxldGUoc3RydWN0IHhhcnJheSAqLAogICBzdHJ1Y3QgcmFkaXhfdHJl
ZV9pdGVyICppdGVyLCB2b2lkICoqc2xvdCk7CnZvaWQgKnJhZGl4X3RyZWVfZGVsZXRlX2l0
ZW0oc3RydWN0IHhhcnJheSAqLCB1bnNpZ25lZCBsb25nLCB2b2lkICopOwp2b2lkICpyYWRp
eF90cmVlX2RlbGV0ZShzdHJ1Y3QgeGFycmF5ICosIHVuc2lnbmVkIGxvbmcpOwp1bnNpZ25l
ZCBpbnQgcmFkaXhfdHJlZV9nYW5nX2xvb2t1cChjb25zdCBzdHJ1Y3QgeGFycmF5ICosCiAg
IHZvaWQgKipyZXN1bHRzLCB1bnNpZ25lZCBsb25nIGZpcnN0X2luZGV4LAogICB1bnNpZ25l
ZCBpbnQgbWF4X2l0ZW1zKTsKaW50IHJhZGl4X3RyZWVfcHJlbG9hZChnZnBfdCBnZnBfbWFz
ayk7CmludCByYWRpeF90cmVlX21heWJlX3ByZWxvYWQoZ2ZwX3QgZ2ZwX21hc2spOwp2b2lk
IHJhZGl4X3RyZWVfaW5pdCh2b2lkKTsKdm9pZCAqcmFkaXhfdHJlZV90YWdfc2V0KHN0cnVj
dCB4YXJyYXkgKiwKICAgdW5zaWduZWQgbG9uZyBpbmRleCwgdW5zaWduZWQgaW50IHRhZyk7
CnZvaWQgKnJhZGl4X3RyZWVfdGFnX2NsZWFyKHN0cnVjdCB4YXJyYXkgKiwKICAgdW5zaWdu
ZWQgbG9uZyBpbmRleCwgdW5zaWduZWQgaW50IHRhZyk7CmludCByYWRpeF90cmVlX3RhZ19n
ZXQoY29uc3Qgc3RydWN0IHhhcnJheSAqLAogICB1bnNpZ25lZCBsb25nIGluZGV4LCB1bnNp
Z25lZCBpbnQgdGFnKTsKdm9pZCByYWRpeF90cmVlX2l0ZXJfdGFnX2NsZWFyKHN0cnVjdCB4
YXJyYXkgKiwKICBjb25zdCBzdHJ1Y3QgcmFkaXhfdHJlZV9pdGVyICppdGVyLCB1bnNpZ25l
ZCBpbnQgdGFnKTsKdW5zaWduZWQgaW50IHJhZGl4X3RyZWVfZ2FuZ19sb29rdXBfdGFnKGNv
bnN0IHN0cnVjdCB4YXJyYXkgKiwKICB2b2lkICoqcmVzdWx0cywgdW5zaWduZWQgbG9uZyBm
aXJzdF9pbmRleCwKICB1bnNpZ25lZCBpbnQgbWF4X2l0ZW1zLCB1bnNpZ25lZCBpbnQgdGFn
KTsKdW5zaWduZWQgaW50IHJhZGl4X3RyZWVfZ2FuZ19sb29rdXBfdGFnX3Nsb3QoY29uc3Qg
c3RydWN0IHhhcnJheSAqLAogIHZvaWQgKioqcmVzdWx0cywgdW5zaWduZWQgbG9uZyBmaXJz
dF9pbmRleCwKICB1bnNpZ25lZCBpbnQgbWF4X2l0ZW1zLCB1bnNpZ25lZCBpbnQgdGFnKTsK
aW50IHJhZGl4X3RyZWVfdGFnZ2VkKGNvbnN0IHN0cnVjdCB4YXJyYXkgKiwgdW5zaWduZWQg
aW50IHRhZyk7CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCByYWRpeF90cmVlX3ByZWxvYWRfZW5kKHZvaWQp
CnsKIGRvIHsgbG9jYWxfbG9ja19yZWxlYXNlKCh7IGRvIHsgY29uc3Qgdm9pZCAqX192cHBf
dmVyaWZ5ID0gKHR5cGVvZigoJnJhZGl4X3RyZWVfcHJlbG9hZHMubG9jaykgKyAwKSkoKHZv
aWQgKikwKTsgKHZvaWQpX192cHBfdmVyaWZ5OyB9IHdoaWxlICgwKTsgKHsgdW5zaWduZWQg
bG9uZyBfX3B0cjsgX19hc21fXyAoIiIgOiAiPXIiKF9fcHRyKSA6ICIwIigodHlwZW9mKCoo
JnJhZGl4X3RyZWVfcHJlbG9hZHMubG9jaykpICopKCZyYWRpeF90cmVlX3ByZWxvYWRzLmxv
Y2spKSk7ICh0eXBlb2YoKHR5cGVvZigqKCZyYWRpeF90cmVlX3ByZWxvYWRzLmxvY2spKSAq
KSgmcmFkaXhfdHJlZV9wcmVsb2Fkcy5sb2NrKSkpIChfX3B0ciArICgobG9jYWxfcGFjYS0+
ZGF0YV9vZmZzZXQpKSk7IH0pOyB9KSk7IF9fYXNtX18gX192b2xhdGlsZV9fKCIiOiA6IDoi
bWVtb3J5Iik7IH0gd2hpbGUgKDApOwp9Cgp2b2lkICoqaWRyX2dldF9mcmVlKHN0cnVjdCB4
YXJyYXkgKnJvb3QsCiAgICAgICAgIHN0cnVjdCByYWRpeF90cmVlX2l0ZXIgKml0ZXIsIGdm
cF90IGdmcCwKICAgICAgICAgdW5zaWduZWQgbG9uZyBtYXgpOwoKZW51bSB7CiBSQURJWF9U
UkVFX0lURVJfVEFHX01BU0sgPSAweDBmLAogUkFESVhfVFJFRV9JVEVSX1RBR0dFRCA9IDB4
MTAsCiBSQURJWF9UUkVFX0lURVJfQ09OVElHID0gMHgyMCwKfTsKIyAyNzcgIi4vaW5jbHVk
ZS9saW51eC9yYWRpeC10cmVlLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5
c19pbmxpbmVfXykpIHZvaWQgKioKcmFkaXhfdHJlZV9pdGVyX2luaXQoc3RydWN0IHJhZGl4
X3RyZWVfaXRlciAqaXRlciwgdW5zaWduZWQgbG9uZyBzdGFydCkKewojIDI4OCAiLi9pbmNs
dWRlL2xpbnV4L3JhZGl4LXRyZWUuaCIKIGl0ZXItPmluZGV4ID0gMDsKIGl0ZXItPm5leHRf
aW5kZXggPSBzdGFydDsKIHJldHVybiAoKHZvaWQgKikwKTsKfQojIDMwNiAiLi9pbmNsdWRl
L2xpbnV4L3JhZGl4LXRyZWUuaCIKdm9pZCAqKnJhZGl4X3RyZWVfbmV4dF9jaHVuayhjb25z
dCBzdHJ1Y3QgeGFycmF5ICosCiAgICAgICAgc3RydWN0IHJhZGl4X3RyZWVfaXRlciAqaXRl
ciwgdW5zaWduZWQgZmxhZ3MpOwojIDMxOSAiLi9pbmNsdWRlL2xpbnV4L3JhZGl4LXRyZWUu
aCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIHZvaWQgKioKcmFkaXhfdHJlZV9pdGVyX2xvb2t1cChjb25zdCBzdHJ1
Y3QgeGFycmF5ICpyb290LAogICBzdHJ1Y3QgcmFkaXhfdHJlZV9pdGVyICppdGVyLCB1bnNp
Z25lZCBsb25nIGluZGV4KQp7CiByYWRpeF90cmVlX2l0ZXJfaW5pdChpdGVyLCBpbmRleCk7
CiByZXR1cm4gcmFkaXhfdHJlZV9uZXh0X2NodW5rKHJvb3QsIGl0ZXIsIFJBRElYX1RSRUVf
SVRFUl9DT05USUcpOwp9CiMgMzM2ICIuL2luY2x1ZGUvbGludXgvcmFkaXgtdHJlZS5oIgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX193YXJuX3VudXNlZF9yZXN1bHRfXykpCnZvaWQg
KipyYWRpeF90cmVlX2l0ZXJfcmV0cnkoc3RydWN0IHJhZGl4X3RyZWVfaXRlciAqaXRlcikK
ewogaXRlci0+bmV4dF9pbmRleCA9IGl0ZXItPmluZGV4OwogaXRlci0+dGFncyA9IDA7CiBy
ZXR1cm4gKCh2b2lkICopMCk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1bnNpZ25lZCBsb25nCl9fcmFkaXhf
dHJlZV9pdGVyX2FkZChzdHJ1Y3QgcmFkaXhfdHJlZV9pdGVyICppdGVyLCB1bnNpZ25lZCBs
b25nIHNsb3RzKQp7CiByZXR1cm4gaXRlci0+aW5kZXggKyBzbG90czsKfQojIDM2MCAiLi9p
bmNsdWRlL2xpbnV4L3JhZGl4LXRyZWUuaCIKdm9pZCAqKl9fYXR0cmlidXRlX18oKF9fd2Fy
bl91bnVzZWRfcmVzdWx0X18pKSByYWRpeF90cmVlX2l0ZXJfcmVzdW1lKHZvaWQgKipzbG90
LAogICAgIHN0cnVjdCByYWRpeF90cmVlX2l0ZXIgKml0ZXIpOwoKCgoKCgoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgbG9uZwpyYWRpeF90cmVlX2No
dW5rX3NpemUoc3RydWN0IHJhZGl4X3RyZWVfaXRlciAqaXRlcikKewogcmV0dXJuIGl0ZXIt
Pm5leHRfaW5kZXggLSBpdGVyLT5pbmRleDsKfQojIDM5NCAiLi9pbmNsdWRlL2xpbnV4L3Jh
ZGl4LXRyZWUuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9f
KSkgdm9pZCAqKnJhZGl4X3RyZWVfbmV4dF9zbG90KHZvaWQgKipzbG90LAogICAgc3RydWN0
IHJhZGl4X3RyZWVfaXRlciAqaXRlciwgdW5zaWduZWQgZmxhZ3MpCnsKIGlmIChmbGFncyAm
IFJBRElYX1RSRUVfSVRFUl9UQUdHRUQpIHsKICBpdGVyLT50YWdzID4+PSAxOwogIGlmIChf
X2J1aWx0aW5fZXhwZWN0KCEhKCFpdGVyLT50YWdzKSwgMCkpCiAgIHJldHVybiAoKHZvaWQg
KikwKTsKICBpZiAoX19idWlsdGluX2V4cGVjdCghIShpdGVyLT50YWdzICYgMXVsKSwgMSkp
IHsKICAgaXRlci0+aW5kZXggPSBfX3JhZGl4X3RyZWVfaXRlcl9hZGQoaXRlciwgMSk7CiAg
IHNsb3QrKzsKICAgZ290byBmb3VuZDsKICB9CiAgaWYgKCEoZmxhZ3MgJiBSQURJWF9UUkVF
X0lURVJfQ09OVElHKSkgewogICB1bnNpZ25lZCBvZmZzZXQgPSBfX2ZmcyhpdGVyLT50YWdz
KTsKCiAgIGl0ZXItPnRhZ3MgPj49IG9mZnNldCsrOwogICBpdGVyLT5pbmRleCA9IF9fcmFk
aXhfdHJlZV9pdGVyX2FkZChpdGVyLCBvZmZzZXQpOwogICBzbG90ICs9IG9mZnNldDsKICAg
Z290byBmb3VuZDsKICB9CiB9IGVsc2UgewogIGxvbmcgY291bnQgPSByYWRpeF90cmVlX2No
dW5rX3NpemUoaXRlcik7CgogIHdoaWxlICgtLWNvdW50ID4gMCkgewogICBzbG90Kys7CiAg
IGl0ZXItPmluZGV4ID0gX19yYWRpeF90cmVlX2l0ZXJfYWRkKGl0ZXIsIDEpOwoKICAgaWYg
KF9fYnVpbHRpbl9leHBlY3QoISEoKnNsb3QpLCAxKSkKICAgIGdvdG8gZm91bmQ7CiAgIGlm
IChmbGFncyAmIFJBRElYX1RSRUVfSVRFUl9DT05USUcpIHsKCiAgICBpdGVyLT5uZXh0X2lu
ZGV4ID0gMDsKICAgIGJyZWFrOwogICB9CiAgfQogfQogcmV0dXJuICgodm9pZCAqKTApOwoK
IGZvdW5kOgogcmV0dXJuIHNsb3Q7Cn0KIyAxNiAiLi9pbmNsdWRlL2xpbnV4L2ZzLmgiIDIK
IyAyNCAiLi9pbmNsdWRlL2xpbnV4L2ZzLmgiCiMgMSAiLi9pbmNsdWRlL2xpbnV4L2NhcGFi
aWxpdHkuaCIgMQojIDE2ICIuL2luY2x1ZGUvbGludXgvY2FwYWJpbGl0eS5oIgojIDEgIi4v
aW5jbHVkZS91YXBpL2xpbnV4L2NhcGFiaWxpdHkuaCIgMQojIDM5ICIuL2luY2x1ZGUvdWFw
aS9saW51eC9jYXBhYmlsaXR5LmgiCnR5cGVkZWYgc3RydWN0IF9fdXNlcl9jYXBfaGVhZGVy
X3N0cnVjdCB7CiBfX3UzMiB2ZXJzaW9uOwogaW50IHBpZDsKfSAqY2FwX3VzZXJfaGVhZGVy
X3Q7Cgp0eXBlZGVmIHN0cnVjdCBfX3VzZXJfY2FwX2RhdGFfc3RydWN0IHsKICAgICAgICBf
X3UzMiBlZmZlY3RpdmU7CiAgICAgICAgX191MzIgcGVybWl0dGVkOwogICAgICAgIF9fdTMy
IGluaGVyaXRhYmxlOwp9ICpjYXBfdXNlcl9kYXRhX3Q7CiMgNzIgIi4vaW5jbHVkZS91YXBp
L2xpbnV4L2NhcGFiaWxpdHkuaCIKc3RydWN0IHZmc19jYXBfZGF0YSB7CiBfX2xlMzIgbWFn
aWNfZXRjOwogc3RydWN0IHsKICBfX2xlMzIgcGVybWl0dGVkOwogIF9fbGUzMiBpbmhlcml0
YWJsZTsKIH0gZGF0YVsyXTsKfTsKCgoKCnN0cnVjdCB2ZnNfbnNfY2FwX2RhdGEgewogX19s
ZTMyIG1hZ2ljX2V0YzsKIHN0cnVjdCB7CiAgX19sZTMyIHBlcm1pdHRlZDsKICBfX2xlMzIg
aW5oZXJpdGFibGU7CiB9IGRhdGFbMl07CiBfX2xlMzIgcm9vdGlkOwp9OwojIDE3ICIuL2lu
Y2x1ZGUvbGludXgvY2FwYWJpbGl0eS5oIiAyCgoKCgoKZXh0ZXJuIGludCBmaWxlX2NhcHNf
ZW5hYmxlZDsKCnR5cGVkZWYgc3RydWN0IGtlcm5lbF9jYXBfc3RydWN0IHsKIF9fdTMyIGNh
cFsyXTsKfSBrZXJuZWxfY2FwX3Q7CgoKc3RydWN0IGNwdV92ZnNfY2FwX2RhdGEgewogX191
MzIgbWFnaWNfZXRjOwoga2VybmVsX2NhcF90IHBlcm1pdHRlZDsKIGtlcm5lbF9jYXBfdCBp
bmhlcml0YWJsZTsKIGt1aWRfdCByb290aWQ7Cn07CgoKCgoKc3RydWN0IGZpbGU7CnN0cnVj
dCBpbm9kZTsKc3RydWN0IGRlbnRyeTsKc3RydWN0IHRhc2tfc3RydWN0OwpzdHJ1Y3QgdXNl
cl9uYW1lc3BhY2U7CgpleHRlcm4gY29uc3Qga2VybmVsX2NhcF90IF9fY2FwX2VtcHR5X3Nl
dDsKZXh0ZXJuIGNvbnN0IGtlcm5lbF9jYXBfdCBfX2NhcF9pbml0X2VmZl9zZXQ7CiMgMTE4
ICIuL2luY2x1ZGUvbGludXgvY2FwYWJpbGl0eS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkga2VybmVsX2NhcF90
IGNhcF9jb21iaW5lKGNvbnN0IGtlcm5lbF9jYXBfdCBhLAogICAgICAgICAgIGNvbnN0IGtl
cm5lbF9jYXBfdCBiKQp7CiBrZXJuZWxfY2FwX3QgZGVzdDsKIGRvIHsgdW5zaWduZWQgX19j
YXBpOyBmb3IgKF9fY2FwaSA9IDA7IF9fY2FwaSA8IDI7ICsrX19jYXBpKSB7IGRlc3QuY2Fw
W19fY2FwaV0gPSBhLmNhcFtfX2NhcGldIHwgYi5jYXBbX19jYXBpXTsgfSB9IHdoaWxlICgw
KTsKIHJldHVybiBkZXN0Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkga2VybmVsX2NhcF90IGNhcF9pbnRlcnNl
Y3QoY29uc3Qga2VybmVsX2NhcF90IGEsCiAgICAgIGNvbnN0IGtlcm5lbF9jYXBfdCBiKQp7
CiBrZXJuZWxfY2FwX3QgZGVzdDsKIGRvIHsgdW5zaWduZWQgX19jYXBpOyBmb3IgKF9fY2Fw
aSA9IDA7IF9fY2FwaSA8IDI7ICsrX19jYXBpKSB7IGRlc3QuY2FwW19fY2FwaV0gPSBhLmNh
cFtfX2NhcGldICYgYi5jYXBbX19jYXBpXTsgfSB9IHdoaWxlICgwKTsKIHJldHVybiBkZXN0
Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkga2VybmVsX2NhcF90IGNhcF9kcm9wKGNvbnN0IGtlcm5lbF9jYXBf
dCBhLAogICAgICAgIGNvbnN0IGtlcm5lbF9jYXBfdCBkcm9wKQp7CiBrZXJuZWxfY2FwX3Qg
ZGVzdDsKIGRvIHsgdW5zaWduZWQgX19jYXBpOyBmb3IgKF9fY2FwaSA9IDA7IF9fY2FwaSA8
IDI7ICsrX19jYXBpKSB7IGRlc3QuY2FwW19fY2FwaV0gPSBhLmNhcFtfX2NhcGldICZ+IGRy
b3AuY2FwW19fY2FwaV07IH0gfSB3aGlsZSAoMCk7CiByZXR1cm4gZGVzdDsKfQoKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIGtlcm5lbF9jYXBfdCBjYXBfaW52ZXJ0KGNvbnN0IGtlcm5lbF9jYXBfdCBjKQp7CiBr
ZXJuZWxfY2FwX3QgZGVzdDsKIGRvIHsgdW5zaWduZWQgX19jYXBpOyBmb3IgKF9fY2FwaSA9
IDA7IF9fY2FwaSA8IDI7ICsrX19jYXBpKSB7IGRlc3QuY2FwW19fY2FwaV0gPSB+IGMuY2Fw
W19fY2FwaV07IH0gfSB3aGlsZSAoMCk7CiByZXR1cm4gZGVzdDsKfQoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJv
b2wgY2FwX2lzY2xlYXIoY29uc3Qga2VybmVsX2NhcF90IGEpCnsKIHVuc2lnbmVkIF9fY2Fw
aTsKIGZvciAoX19jYXBpID0gMDsgX19jYXBpIDwgMjsgKytfX2NhcGkpIHsKICBpZiAoYS5j
YXBbX19jYXBpXSAhPSAwKQogICByZXR1cm4gZmFsc2U7CiB9CiByZXR1cm4gdHJ1ZTsKfQoj
IDE2NiAiLi9pbmNsdWRlL2xpbnV4L2NhcGFiaWxpdHkuaCIKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgY2Fw
X2lzc3Vic2V0KGNvbnN0IGtlcm5lbF9jYXBfdCBhLCBjb25zdCBrZXJuZWxfY2FwX3Qgc2V0
KQp7CiBrZXJuZWxfY2FwX3QgZGVzdDsKIGRlc3QgPSBjYXBfZHJvcChhLCBzZXQpOwogcmV0
dXJuIGNhcF9pc2NsZWFyKGRlc3QpOwp9CgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBrZXJuZWxfY2FwX3QgY2Fw
X2Ryb3BfZnNfc2V0KGNvbnN0IGtlcm5lbF9jYXBfdCBhKQp7CiBjb25zdCBrZXJuZWxfY2Fw
X3QgX19jYXBfZnNfc2V0ID0gKChrZXJuZWxfY2FwX3Qpe3sgKCgxIDw8ICgoMCkgJiAzMSkp
IHwgKDEgPDwgKCgyNykgJiAzMSkpIHwgKDEgPDwgKCgxKSAmIDMxKSkgfCAoMSA8PCAoKDIp
ICYgMzEpKSB8ICgxIDw8ICgoMykgJiAzMSkpIHwgKDEgPDwgKCg0KSAmIDMxKSkpIHwgKDEg
PDwgKCg5KSAmIDMxKSksICgoMSA8PCAoKDMyKSAmIDMxKSkpIH0gfSk7CiByZXR1cm4gY2Fw
X2Ryb3AoYSwgX19jYXBfZnNfc2V0KTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGtlcm5lbF9jYXBfdCBjYXBf
cmFpc2VfZnNfc2V0KGNvbnN0IGtlcm5lbF9jYXBfdCBhLAogICAgICAgICBjb25zdCBrZXJu
ZWxfY2FwX3QgcGVybWl0dGVkKQp7CiBjb25zdCBrZXJuZWxfY2FwX3QgX19jYXBfZnNfc2V0
ID0gKChrZXJuZWxfY2FwX3Qpe3sgKCgxIDw8ICgoMCkgJiAzMSkpIHwgKDEgPDwgKCgyNykg
JiAzMSkpIHwgKDEgPDwgKCgxKSAmIDMxKSkgfCAoMSA8PCAoKDIpICYgMzEpKSB8ICgxIDw8
ICgoMykgJiAzMSkpIHwgKDEgPDwgKCg0KSAmIDMxKSkpIHwgKDEgPDwgKCg5KSAmIDMxKSks
ICgoMSA8PCAoKDMyKSAmIDMxKSkpIH0gfSk7CiByZXR1cm4gY2FwX2NvbWJpbmUoYSwKICAg
ICAgY2FwX2ludGVyc2VjdChwZXJtaXR0ZWQsIF9fY2FwX2ZzX3NldCkpOwp9CgpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkga2VybmVsX2NhcF90IGNhcF9kcm9wX25mc2Rfc2V0KGNvbnN0IGtlcm5lbF9jYXBfdCBh
KQp7CiBjb25zdCBrZXJuZWxfY2FwX3QgX19jYXBfZnNfc2V0ID0gKChrZXJuZWxfY2FwX3Qp
e3sgKCgxIDw8ICgoMCkgJiAzMSkpIHwgKDEgPDwgKCgyNykgJiAzMSkpIHwgKDEgPDwgKCgx
KSAmIDMxKSkgfCAoMSA8PCAoKDIpICYgMzEpKSB8ICgxIDw8ICgoMykgJiAzMSkpIHwgKDEg
PDwgKCg0KSAmIDMxKSkpIHwgKDEgPDwgKCgyNCkgJiAzMSkpLCAoKDEgPDwgKCgzMikgJiAz
MSkpKSB9IH0pOwogcmV0dXJuIGNhcF9kcm9wKGEsIF9fY2FwX2ZzX3NldCk7Cn0KCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBrZXJuZWxfY2FwX3QgY2FwX3JhaXNlX25mc2Rfc2V0KGNvbnN0IGtlcm5lbF9jYXBf
dCBhLAogICAgICAgICAgIGNvbnN0IGtlcm5lbF9jYXBfdCBwZXJtaXR0ZWQpCnsKIGNvbnN0
IGtlcm5lbF9jYXBfdCBfX2NhcF9uZnNkX3NldCA9ICgoa2VybmVsX2NhcF90KXt7ICgoMSA8
PCAoKDApICYgMzEpKSB8ICgxIDw8ICgoMjcpICYgMzEpKSB8ICgxIDw8ICgoMSkgJiAzMSkp
IHwgKDEgPDwgKCgyKSAmIDMxKSkgfCAoMSA8PCAoKDMpICYgMzEpKSB8ICgxIDw8ICgoNCkg
JiAzMSkpKSB8ICgxIDw8ICgoMjQpICYgMzEpKSwgKCgxIDw8ICgoMzIpICYgMzEpKSkgfSB9
KTsKIHJldHVybiBjYXBfY29tYmluZShhLAogICAgICBjYXBfaW50ZXJzZWN0KHBlcm1pdHRl
ZCwgX19jYXBfbmZzZF9zZXQpKTsKfQoKCmV4dGVybiBib29sIGhhc19jYXBhYmlsaXR5KHN0
cnVjdCB0YXNrX3N0cnVjdCAqdCwgaW50IGNhcCk7CmV4dGVybiBib29sIGhhc19uc19jYXBh
YmlsaXR5KHN0cnVjdCB0YXNrX3N0cnVjdCAqdCwKICAgICAgICAgc3RydWN0IHVzZXJfbmFt
ZXNwYWNlICpucywgaW50IGNhcCk7CmV4dGVybiBib29sIGhhc19jYXBhYmlsaXR5X25vYXVk
aXQoc3RydWN0IHRhc2tfc3RydWN0ICp0LCBpbnQgY2FwKTsKZXh0ZXJuIGJvb2wgaGFzX25z
X2NhcGFiaWxpdHlfbm9hdWRpdChzdHJ1Y3QgdGFza19zdHJ1Y3QgKnQsCiAgICAgICAgICBz
dHJ1Y3QgdXNlcl9uYW1lc3BhY2UgKm5zLCBpbnQgY2FwKTsKZXh0ZXJuIGJvb2wgY2FwYWJs
ZShpbnQgY2FwKTsKZXh0ZXJuIGJvb2wgbnNfY2FwYWJsZShzdHJ1Y3QgdXNlcl9uYW1lc3Bh
Y2UgKm5zLCBpbnQgY2FwKTsKZXh0ZXJuIGJvb2wgbnNfY2FwYWJsZV9ub2F1ZGl0KHN0cnVj
dCB1c2VyX25hbWVzcGFjZSAqbnMsIGludCBjYXApOwpleHRlcm4gYm9vbCBuc19jYXBhYmxl
X3NldGlkKHN0cnVjdCB1c2VyX25hbWVzcGFjZSAqbnMsIGludCBjYXApOwojIDI1MCAiLi9p
bmNsdWRlL2xpbnV4L2NhcGFiaWxpdHkuaCIKZXh0ZXJuIGJvb2wgcHJpdmlsZWdlZF93cnRf
aW5vZGVfdWlkZ2lkKHN0cnVjdCB1c2VyX25hbWVzcGFjZSAqbnMsIGNvbnN0IHN0cnVjdCBp
bm9kZSAqaW5vZGUpOwpleHRlcm4gYm9vbCBjYXBhYmxlX3dydF9pbm9kZV91aWRnaWQoY29u
c3Qgc3RydWN0IGlub2RlICppbm9kZSwgaW50IGNhcCk7CmV4dGVybiBib29sIGZpbGVfbnNf
Y2FwYWJsZShjb25zdCBzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHVzZXJfbmFtZXNwYWNl
ICpucywgaW50IGNhcCk7CmV4dGVybiBib29sIHB0cmFjZXJfY2FwYWJsZShzdHJ1Y3QgdGFz
a19zdHJ1Y3QgKnRzaywgc3RydWN0IHVzZXJfbmFtZXNwYWNlICpucyk7CnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBi
b29sIHBlcmZtb25fY2FwYWJsZSh2b2lkKQp7CiByZXR1cm4gY2FwYWJsZSgzOCkgfHwgY2Fw
YWJsZSgyMSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIGJwZl9jYXBhYmxlKHZvaWQpCnsKIHJldHVy
biBjYXBhYmxlKDM5KSB8fCBjYXBhYmxlKDIxKTsKfQoKCmV4dGVybiBpbnQgZ2V0X3Zmc19j
YXBzX2Zyb21fZGlzayhjb25zdCBzdHJ1Y3QgZGVudHJ5ICpkZW50cnksIHN0cnVjdCBjcHVf
dmZzX2NhcF9kYXRhICpjcHVfY2Fwcyk7CgpleHRlcm4gaW50IGNhcF9jb252ZXJ0X25zY2Fw
KHN0cnVjdCBkZW50cnkgKmRlbnRyeSwgdm9pZCAqKml2YWx1ZSwgc2l6ZV90IHNpemUpOwoj
IDI1ICIuL2luY2x1ZGUvbGludXgvZnMuaCIgMgojIDEgIi4vaW5jbHVkZS9saW51eC9zZW1h
cGhvcmUuaCIgMQojIDE1ICIuL2luY2x1ZGUvbGludXgvc2VtYXBob3JlLmgiCnN0cnVjdCBz
ZW1hcGhvcmUgewogcmF3X3NwaW5sb2NrX3QgbG9jazsKIHVuc2lnbmVkIGludCBjb3VudDsK
IHN0cnVjdCBsaXN0X2hlYWQgd2FpdF9saXN0Owp9OwojIDMxICIuL2luY2x1ZGUvbGludXgv
c2VtYXBob3JlLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHNlbWFfaW5pdChzdHJ1Y3Qgc2VtYXBob3Jl
ICpzZW0sIGludCB2YWwpCnsKIHN0YXRpYyBzdHJ1Y3QgbG9ja19jbGFzc19rZXkgX19rZXk7
CiAqc2VtID0gKHN0cnVjdCBzZW1hcGhvcmUpIHsgLmxvY2sgPSAocmF3X3NwaW5sb2NrX3Qp
IHsgLnJhd19sb2NrID0geyAwIH0sIH0sIC5jb3VudCA9IHZhbCwgLndhaXRfbGlzdCA9IHsg
JigoKnNlbSkud2FpdF9saXN0KSwgJigoKnNlbSkud2FpdF9saXN0KSB9LCB9OwogZG8geyAo
dm9pZCkoInNlbWFwaG9yZS0+bG9jayIpOyAodm9pZCkoJl9fa2V5KTsgfSB3aGlsZSAoMCk7
Cn0KCmV4dGVybiB2b2lkIGRvd24oc3RydWN0IHNlbWFwaG9yZSAqc2VtKTsKZXh0ZXJuIGlu
dCBfX2F0dHJpYnV0ZV9fKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkgZG93bl9pbnRlcnJ1
cHRpYmxlKHN0cnVjdCBzZW1hcGhvcmUgKnNlbSk7CmV4dGVybiBpbnQgX19hdHRyaWJ1dGVf
XygoX193YXJuX3VudXNlZF9yZXN1bHRfXykpIGRvd25fa2lsbGFibGUoc3RydWN0IHNlbWFw
aG9yZSAqc2VtKTsKZXh0ZXJuIGludCBfX2F0dHJpYnV0ZV9fKChfX3dhcm5fdW51c2VkX3Jl
c3VsdF9fKSkgZG93bl90cnlsb2NrKHN0cnVjdCBzZW1hcGhvcmUgKnNlbSk7CmV4dGVybiBp
bnQgX19hdHRyaWJ1dGVfXygoX193YXJuX3VudXNlZF9yZXN1bHRfXykpIGRvd25fdGltZW91
dChzdHJ1Y3Qgc2VtYXBob3JlICpzZW0sIGxvbmcgamlmZmllcyk7CmV4dGVybiB2b2lkIHVw
KHN0cnVjdCBzZW1hcGhvcmUgKnNlbSk7CiMgMjYgIi4vaW5jbHVkZS9saW51eC9mcy5oIiAy
CiMgMSAiLi9pbmNsdWRlL2xpbnV4L2ZjbnRsLmgiIDEKCgoKCgojIDEgIi4vaW5jbHVkZS91
YXBpL2xpbnV4L2ZjbnRsLmgiIDEKCgoKCiMgMSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS91
YXBpL2FzbS9mY250bC5oIiAxCiMgMTAgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvdWFwaS9h
c20vZmNudGwuaCIKIyAxICIuL2luY2x1ZGUvdWFwaS9hc20tZ2VuZXJpYy9mY250bC5oIiAx
CiMgMTU2ICIuL2luY2x1ZGUvdWFwaS9hc20tZ2VuZXJpYy9mY250bC5oIgpzdHJ1Y3QgZl9v
d25lcl9leCB7CiBpbnQgdHlwZTsKIF9fa2VybmVsX3BpZF90IHBpZDsKfTsKIyAxOTYgIi4v
aW5jbHVkZS91YXBpL2FzbS1nZW5lcmljL2ZjbnRsLmgiCnN0cnVjdCBmbG9jayB7CiBzaG9y
dCBsX3R5cGU7CiBzaG9ydCBsX3doZW5jZTsKIF9fa2VybmVsX29mZl90IGxfc3RhcnQ7CiBf
X2tlcm5lbF9vZmZfdCBsX2xlbjsKIF9fa2VybmVsX3BpZF90IGxfcGlkOwoKfTsKCgoKCgoK
CnN0cnVjdCBmbG9jazY0IHsKIHNob3J0IGxfdHlwZTsKIHNob3J0IGxfd2hlbmNlOwogX19r
ZXJuZWxfbG9mZl90IGxfc3RhcnQ7CiBfX2tlcm5lbF9sb2ZmX3QgbF9sZW47CiBfX2tlcm5l
bF9waWRfdCBsX3BpZDsKCn07CiMgMTEgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvdWFwaS9h
c20vZmNudGwuaCIgMgojIDYgIi4vaW5jbHVkZS91YXBpL2xpbnV4L2ZjbnRsLmgiIDIKIyAx
ICIuL2luY2x1ZGUvdWFwaS9saW51eC9vcGVuYXQyLmgiIDEKIyAxOSAiLi9pbmNsdWRlL3Vh
cGkvbGludXgvb3BlbmF0Mi5oIgpzdHJ1Y3Qgb3Blbl9ob3cgewogX191NjQgZmxhZ3M7CiBf
X3U2NCBtb2RlOwogX191NjQgcmVzb2x2ZTsKfTsKIyA3ICIuL2luY2x1ZGUvdWFwaS9saW51
eC9mY250bC5oIiAyCiMgNyAiLi9pbmNsdWRlL2xpbnV4L2ZjbnRsLmgiIDIKIyAyNyAiLi9p
bmNsdWRlL2xpbnV4L2ZzLmgiIDIKCgoKIyAxICIuL2luY2x1ZGUvbGludXgvbWlncmF0ZV9t
b2RlLmgiIDEKIyAxNSAiLi9pbmNsdWRlL2xpbnV4L21pZ3JhdGVfbW9kZS5oIgplbnVtIG1p
Z3JhdGVfbW9kZSB7CiBNSUdSQVRFX0FTWU5DLAogTUlHUkFURV9TWU5DX0xJR0hULAogTUlH
UkFURV9TWU5DLAogTUlHUkFURV9TWU5DX05PX0NPUFksCn07CiMgMzEgIi4vaW5jbHVkZS9s
aW51eC9mcy5oIiAyCgoKIyAxICIuL2luY2x1ZGUvbGludXgvcGVyY3B1LXJ3c2VtLmgiIDEK
CgoKCgoKIyAxICIuL2luY2x1ZGUvbGludXgvcmN1d2FpdC5oIiAxCgoKCgoKIyAxICIuL2lu
Y2x1ZGUvbGludXgvc2NoZWQvc2lnbmFsLmgiIDEKCgoKCgojIDEgIi4vaW5jbHVkZS9saW51
eC9zaWduYWwuaCIgMQojIDkgIi4vaW5jbHVkZS9saW51eC9zaWduYWwuaCIKc3RydWN0IHRh
c2tfc3RydWN0OwoKCmV4dGVybiBpbnQgcHJpbnRfZmF0YWxfc2lnbmFsczsKCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSB2b2lkIGNvcHlfc2lnaW5mbyhrZXJuZWxfc2lnaW5mb190ICp0bywKICAgIGNvbnN0IGtl
cm5lbF9zaWdpbmZvX3QgKmZyb20pCnsKIG1lbWNweSh0bywgZnJvbSwgc2l6ZW9mKCp0bykp
Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgdm9pZCBjbGVhcl9zaWdpbmZvKGtlcm5lbF9zaWdpbmZvX3QgKmlu
Zm8pCnsKIG1lbXNldChpbmZvLCAwLCBzaXplb2YoKmluZm8pKTsKfQoKCgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
dm9pZCBjb3B5X3NpZ2luZm9fdG9fZXh0ZXJuYWwoc2lnaW5mb190ICp0bywKICAgICAgICAg
Y29uc3Qga2VybmVsX3NpZ2luZm9fdCAqZnJvbSkKewogbWVtY3B5KHRvLCBmcm9tLCBzaXpl
b2YoKmZyb20pKTsKIG1lbXNldCgoKGNoYXIgKil0bykgKyBzaXplb2Yoc3RydWN0IGtlcm5l
bF9zaWdpbmZvKSwgMCwKICAoc2l6ZW9mKHN0cnVjdCBzaWdpbmZvKSAtIHNpemVvZihzdHJ1
Y3Qga2VybmVsX3NpZ2luZm8pKSk7Cn0KCmludCBjb3B5X3NpZ2luZm9fdG9fdXNlcihzaWdp
bmZvX3QgKnRvLCBjb25zdCBrZXJuZWxfc2lnaW5mb190ICpmcm9tKTsKaW50IGNvcHlfc2ln
aW5mb19mcm9tX3VzZXIoa2VybmVsX3NpZ2luZm9fdCAqdG8sIGNvbnN0IHNpZ2luZm9fdCAq
ZnJvbSk7CgplbnVtIHNpZ2luZm9fbGF5b3V0IHsKIFNJTF9LSUxMLAogU0lMX1RJTUVSLAog
U0lMX1BPTEwsCiBTSUxfRkFVTFQsCiBTSUxfRkFVTFRfTUNFRVJSLAogU0lMX0ZBVUxUX0JO
REVSUiwKIFNJTF9GQVVMVF9QS1VFUlIsCiBTSUxfQ0hMRCwKIFNJTF9SVCwKIFNJTF9TWVMs
Cn07CgplbnVtIHNpZ2luZm9fbGF5b3V0IHNpZ2luZm9fbGF5b3V0KHVuc2lnbmVkIHNpZywg
aW50IHNpX2NvZGUpOwojIDYyICIuL2luY2x1ZGUvbGludXgvc2lnbmFsLmgiCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSB2b2lkIHNpZ2FkZHNldChzaWdzZXRfdCAqc2V0LCBpbnQgX3NpZykKewogdW5zaWduZWQg
bG9uZyBzaWcgPSBfc2lnIC0gMTsKIGlmICgoNjQgLyA2NCkgPT0gMSkKICBzZXQtPnNpZ1sw
XSB8PSAxVUwgPDwgc2lnOwogZWxzZQogIHNldC0+c2lnW3NpZyAvIDY0XSB8PSAxVUwgPDwg
KHNpZyAlIDY0KTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgc2lnZGVsc2V0KHNpZ3NldF90ICpzZXQs
IGludCBfc2lnKQp7CiB1bnNpZ25lZCBsb25nIHNpZyA9IF9zaWcgLSAxOwogaWYgKCg2NCAv
IDY0KSA9PSAxKQogIHNldC0+c2lnWzBdICY9IH4oMVVMIDw8IHNpZyk7CiBlbHNlCiAgc2V0
LT5zaWdbc2lnIC8gNjRdICY9IH4oMVVMIDw8IChzaWcgJSA2NCkpOwp9CgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
aW50IHNpZ2lzbWVtYmVyKHNpZ3NldF90ICpzZXQsIGludCBfc2lnKQp7CiB1bnNpZ25lZCBs
b25nIHNpZyA9IF9zaWcgLSAxOwogaWYgKCg2NCAvIDY0KSA9PSAxKQogIHJldHVybiAxICYg
KHNldC0+c2lnWzBdID4+IHNpZyk7CiBlbHNlCiAgcmV0dXJuIDEgJiAoc2V0LT5zaWdbc2ln
IC8gNjRdID4+IChzaWcgJSA2NCkpOwp9CgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgc2lnaXNlbXB0eXNl
dChzaWdzZXRfdCAqc2V0KQp7CiBzd2l0Y2ggKCg2NCAvIDY0KSkgewogY2FzZSA0OgogIHJl
dHVybiAoc2V0LT5zaWdbM10gfCBzZXQtPnNpZ1syXSB8CiAgIHNldC0+c2lnWzFdIHwgc2V0
LT5zaWdbMF0pID09IDA7CiBjYXNlIDI6CiAgcmV0dXJuIChzZXQtPnNpZ1sxXSB8IHNldC0+
c2lnWzBdKSA9PSAwOwogY2FzZSAxOgogIHJldHVybiBzZXQtPnNpZ1swXSA9PSAwOwogZGVm
YXVsdDoKICBkbyB7IGV4dGVybiB2b2lkIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzE0Nih2b2lk
KSBfX2F0dHJpYnV0ZV9fKChfX2Vycm9yX18oIkJVSUxEX0JVRyBmYWlsZWQiKSkpOyBpZiAo
ISghKDEpKSkgX19jb21waWxldGltZV9hc3NlcnRfMTQ2KCk7IH0gd2hpbGUgKDApOwogIHJl
dHVybiAwOwogfQp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHNpZ2VxdWFsc2V0cyhjb25zdCBzaWdzZXRf
dCAqc2V0MSwgY29uc3Qgc2lnc2V0X3QgKnNldDIpCnsKIHN3aXRjaCAoKDY0IC8gNjQpKSB7
CiBjYXNlIDQ6CiAgcmV0dXJuIChzZXQxLT5zaWdbM10gPT0gc2V0Mi0+c2lnWzNdKSAmJgog
ICAoc2V0MS0+c2lnWzJdID09IHNldDItPnNpZ1syXSkgJiYKICAgKHNldDEtPnNpZ1sxXSA9
PSBzZXQyLT5zaWdbMV0pICYmCiAgIChzZXQxLT5zaWdbMF0gPT0gc2V0Mi0+c2lnWzBdKTsK
IGNhc2UgMjoKICByZXR1cm4gKHNldDEtPnNpZ1sxXSA9PSBzZXQyLT5zaWdbMV0pICYmCiAg
IChzZXQxLT5zaWdbMF0gPT0gc2V0Mi0+c2lnWzBdKTsKIGNhc2UgMToKICByZXR1cm4gc2V0
MS0+c2lnWzBdID09IHNldDItPnNpZ1swXTsKIH0KIHJldHVybiAwOwp9CiMgMTU1ICIuL2lu
Y2x1ZGUvbGludXgvc2lnbmFsLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHNpZ29yc2V0cyhzaWdzZXRf
dCAqciwgY29uc3Qgc2lnc2V0X3QgKmEsIGNvbnN0IHNpZ3NldF90ICpiKSB7IHVuc2lnbmVk
IGxvbmcgYTAsIGExLCBhMiwgYTMsIGIwLCBiMSwgYjIsIGIzOyBzd2l0Y2ggKCg2NCAvIDY0
KSkgeyBjYXNlIDQ6IGEzID0gYS0+c2lnWzNdOyBhMiA9IGEtPnNpZ1syXTsgYjMgPSBiLT5z
aWdbM107IGIyID0gYi0+c2lnWzJdOyByLT5zaWdbM10gPSAoKGEzKSB8IChiMykpOyByLT5z
aWdbMl0gPSAoKGEyKSB8IChiMikpOyBjYXNlIDI6IGExID0gYS0+c2lnWzFdOyBiMSA9IGIt
PnNpZ1sxXTsgci0+c2lnWzFdID0gKChhMSkgfCAoYjEpKTsgY2FzZSAxOiBhMCA9IGEtPnNp
Z1swXTsgYjAgPSBiLT5zaWdbMF07IHItPnNpZ1swXSA9ICgoYTApIHwgKGIwKSk7IGJyZWFr
OyBkZWZhdWx0OiBkbyB7IGV4dGVybiB2b2lkIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzE0Nyh2
b2lkKSBfX2F0dHJpYnV0ZV9fKChfX2Vycm9yX18oIkJVSUxEX0JVRyBmYWlsZWQiKSkpOyBp
ZiAoISghKDEpKSkgX19jb21waWxldGltZV9hc3NlcnRfMTQ3KCk7IH0gd2hpbGUgKDApOyB9
IH0KCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgdm9pZCBzaWdhbmRzZXRzKHNpZ3NldF90ICpyLCBjb25zdCBzaWdz
ZXRfdCAqYSwgY29uc3Qgc2lnc2V0X3QgKmIpIHsgdW5zaWduZWQgbG9uZyBhMCwgYTEsIGEy
LCBhMywgYjAsIGIxLCBiMiwgYjM7IHN3aXRjaCAoKDY0IC8gNjQpKSB7IGNhc2UgNDogYTMg
PSBhLT5zaWdbM107IGEyID0gYS0+c2lnWzJdOyBiMyA9IGItPnNpZ1szXTsgYjIgPSBiLT5z
aWdbMl07IHItPnNpZ1szXSA9ICgoYTMpICYgKGIzKSk7IHItPnNpZ1syXSA9ICgoYTIpICYg
KGIyKSk7IGNhc2UgMjogYTEgPSBhLT5zaWdbMV07IGIxID0gYi0+c2lnWzFdOyByLT5zaWdb
MV0gPSAoKGExKSAmIChiMSkpOyBjYXNlIDE6IGEwID0gYS0+c2lnWzBdOyBiMCA9IGItPnNp
Z1swXTsgci0+c2lnWzBdID0gKChhMCkgJiAoYjApKTsgYnJlYWs7IGRlZmF1bHQ6IGRvIHsg
ZXh0ZXJuIHZvaWQgX19jb21waWxldGltZV9hc3NlcnRfMTQ4KHZvaWQpIF9fYXR0cmlidXRl
X18oKF9fZXJyb3JfXygiQlVJTERfQlVHIGZhaWxlZCIpKSk7IGlmICghKCEoMSkpKSBfX2Nv
bXBpbGV0aW1lX2Fzc2VydF8xNDgoKTsgfSB3aGlsZSAoMCk7IH0gfQoKCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2
b2lkIHNpZ2FuZG5zZXRzKHNpZ3NldF90ICpyLCBjb25zdCBzaWdzZXRfdCAqYSwgY29uc3Qg
c2lnc2V0X3QgKmIpIHsgdW5zaWduZWQgbG9uZyBhMCwgYTEsIGEyLCBhMywgYjAsIGIxLCBi
MiwgYjM7IHN3aXRjaCAoKDY0IC8gNjQpKSB7IGNhc2UgNDogYTMgPSBhLT5zaWdbM107IGEy
ID0gYS0+c2lnWzJdOyBiMyA9IGItPnNpZ1szXTsgYjIgPSBiLT5zaWdbMl07IHItPnNpZ1sz
XSA9ICgoYTMpICYgfihiMykpOyByLT5zaWdbMl0gPSAoKGEyKSAmIH4oYjIpKTsgY2FzZSAy
OiBhMSA9IGEtPnNpZ1sxXTsgYjEgPSBiLT5zaWdbMV07IHItPnNpZ1sxXSA9ICgoYTEpICYg
fihiMSkpOyBjYXNlIDE6IGEwID0gYS0+c2lnWzBdOyBiMCA9IGItPnNpZ1swXTsgci0+c2ln
WzBdID0gKChhMCkgJiB+KGIwKSk7IGJyZWFrOyBkZWZhdWx0OiBkbyB7IGV4dGVybiB2b2lk
IF9fY29tcGlsZXRpbWVfYXNzZXJ0XzE0OSh2b2lkKSBfX2F0dHJpYnV0ZV9fKChfX2Vycm9y
X18oIkJVSUxEX0JVRyBmYWlsZWQiKSkpOyBpZiAoISghKDEpKSkgX19jb21waWxldGltZV9h
c3NlcnRfMTQ5KCk7IH0gd2hpbGUgKDApOyB9IH0KIyAxODUgIi4vaW5jbHVkZS9saW51eC9z
aWduYWwuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgc2lnbm90c2V0KHNpZ3NldF90ICpzZXQpIHsgc3dp
dGNoICgoNjQgLyA2NCkpIHsgY2FzZSA0OiBzZXQtPnNpZ1szXSA9ICh+KHNldC0+c2lnWzNd
KSk7IHNldC0+c2lnWzJdID0gKH4oc2V0LT5zaWdbMl0pKTsgY2FzZSAyOiBzZXQtPnNpZ1sx
XSA9ICh+KHNldC0+c2lnWzFdKSk7IGNhc2UgMTogc2V0LT5zaWdbMF0gPSAofihzZXQtPnNp
Z1swXSkpOyBicmVhazsgZGVmYXVsdDogZG8geyBleHRlcm4gdm9pZCBfX2NvbXBpbGV0aW1l
X2Fzc2VydF8xNTAodm9pZCkgX19hdHRyaWJ1dGVfXygoX19lcnJvcl9fKCJCVUlMRF9CVUcg
ZmFpbGVkIikpKTsgaWYgKCEoISgxKSkpIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzE1MCgpOyB9
IHdoaWxlICgwKTsgfSB9CgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBzaWdlbXB0eXNldChzaWdzZXRf
dCAqc2V0KQp7CiBzd2l0Y2ggKCg2NCAvIDY0KSkgewogZGVmYXVsdDoKICBtZW1zZXQoc2V0
LCAwLCBzaXplb2Yoc2lnc2V0X3QpKTsKICBicmVhazsKIGNhc2UgMjogc2V0LT5zaWdbMV0g
PSAwOwoKIGNhc2UgMTogc2V0LT5zaWdbMF0gPSAwOwogIGJyZWFrOwogfQp9CgpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgdm9pZCBzaWdmaWxsc2V0KHNpZ3NldF90ICpzZXQpCnsKIHN3aXRjaCAoKDY0IC8gNjQp
KSB7CiBkZWZhdWx0OgogIG1lbXNldChzZXQsIC0xLCBzaXplb2Yoc2lnc2V0X3QpKTsKICBi
cmVhazsKIGNhc2UgMjogc2V0LT5zaWdbMV0gPSAtMTsKCiBjYXNlIDE6IHNldC0+c2lnWzBd
ID0gLTE7CiAgYnJlYWs7CiB9Cn0KCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgc2lnYWRkc2V0bWFzayhz
aWdzZXRfdCAqc2V0LCB1bnNpZ25lZCBsb25nIG1hc2spCnsKIHNldC0+c2lnWzBdIHw9IG1h
c2s7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSB2b2lkIHNpZ2RlbHNldG1hc2soc2lnc2V0X3QgKnNldCwgdW5z
aWduZWQgbG9uZyBtYXNrKQp7CiBzZXQtPnNpZ1swXSAmPSB+bWFzazsKfQoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IGludCBzaWd0ZXN0c2V0bWFzayhzaWdzZXRfdCAqc2V0LCB1bnNpZ25lZCBsb25nIG1hc2sp
CnsKIHJldHVybiAoc2V0LT5zaWdbMF0gJiBtYXNrKSAhPSAwOwp9CgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9p
ZCBzaWdpbml0c2V0KHNpZ3NldF90ICpzZXQsIHVuc2lnbmVkIGxvbmcgbWFzaykKewogc2V0
LT5zaWdbMF0gPSBtYXNrOwogc3dpdGNoICgoNjQgLyA2NCkpIHsKIGRlZmF1bHQ6CiAgbWVt
c2V0KCZzZXQtPnNpZ1sxXSwgMCwgc2l6ZW9mKGxvbmcpKigoNjQgLyA2NCktMSkpOwogIGJy
ZWFrOwogY2FzZSAyOiBzZXQtPnNpZ1sxXSA9IDA7CiBjYXNlIDE6IDsKIH0KfQoKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIHZvaWQgc2lnaW5pdHNldGludihzaWdzZXRfdCAqc2V0LCB1bnNpZ25lZCBsb25nIG1h
c2spCnsKIHNldC0+c2lnWzBdID0gfm1hc2s7CiBzd2l0Y2ggKCg2NCAvIDY0KSkgewogZGVm
YXVsdDoKICBtZW1zZXQoJnNldC0+c2lnWzFdLCAtMSwgc2l6ZW9mKGxvbmcpKigoNjQgLyA2
NCktMSkpOwogIGJyZWFrOwogY2FzZSAyOiBzZXQtPnNpZ1sxXSA9IC0xOwogY2FzZSAxOiA7
CiB9Cn0KCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgaW5pdF9zaWdwZW5kaW5nKHN0cnVjdCBzaWdwZW5k
aW5nICpzaWcpCnsKIHNpZ2VtcHR5c2V0KCZzaWctPnNpZ25hbCk7CiBJTklUX0xJU1RfSEVB
RCgmc2lnLT5saXN0KTsKfQoKZXh0ZXJuIHZvaWQgZmx1c2hfc2lncXVldWUoc3RydWN0IHNp
Z3BlbmRpbmcgKnF1ZXVlKTsKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHZhbGlkX3NpZ25hbCh1bnNpZ25l
ZCBsb25nIHNpZykKewogcmV0dXJuIHNpZyA8PSA2NCA/IDEgOiAwOwp9CgpzdHJ1Y3QgdGlt
ZXNwZWM7CnN0cnVjdCBwdF9yZWdzOwplbnVtIHBpZF90eXBlOwoKZXh0ZXJuIGludCBuZXh0
X3NpZ25hbChzdHJ1Y3Qgc2lncGVuZGluZyAqcGVuZGluZywgc2lnc2V0X3QgKm1hc2spOwpl
eHRlcm4gaW50IGRvX3NlbmRfc2lnX2luZm8oaW50IHNpZywgc3RydWN0IGtlcm5lbF9zaWdp
bmZvICppbmZvLAogICAgc3RydWN0IHRhc2tfc3RydWN0ICpwLCBlbnVtIHBpZF90eXBlIHR5
cGUpOwpleHRlcm4gaW50IGdyb3VwX3NlbmRfc2lnX2luZm8oaW50IHNpZywgc3RydWN0IGtl
cm5lbF9zaWdpbmZvICppbmZvLAogICAgICAgICAgc3RydWN0IHRhc2tfc3RydWN0ICpwLCBl
bnVtIHBpZF90eXBlIHR5cGUpOwpleHRlcm4gaW50IF9fZ3JvdXBfc2VuZF9zaWdfaW5mbyhp
bnQsIHN0cnVjdCBrZXJuZWxfc2lnaW5mbyAqLCBzdHJ1Y3QgdGFza19zdHJ1Y3QgKik7CmV4
dGVybiBpbnQgc2lncHJvY21hc2soaW50LCBzaWdzZXRfdCAqLCBzaWdzZXRfdCAqKTsKZXh0
ZXJuIHZvaWQgc2V0X2N1cnJlbnRfYmxvY2tlZChzaWdzZXRfdCAqKTsKZXh0ZXJuIHZvaWQg
X19zZXRfY3VycmVudF9ibG9ja2VkKGNvbnN0IHNpZ3NldF90ICopOwpleHRlcm4gaW50IHNo
b3dfdW5oYW5kbGVkX3NpZ25hbHM7CgpleHRlcm4gYm9vbCBnZXRfc2lnbmFsKHN0cnVjdCBr
c2lnbmFsICprc2lnKTsKZXh0ZXJuIHZvaWQgc2lnbmFsX3NldHVwX2RvbmUoaW50IGZhaWxl
ZCwgc3RydWN0IGtzaWduYWwgKmtzaWcsIGludCBzdGVwcGluZyk7CmV4dGVybiB2b2lkIGV4
aXRfc2lnbmFscyhzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRzayk7CmV4dGVybiB2b2lkIGtlcm5l
bF9zaWdhY3Rpb24oaW50LCBfX3NpZ2hhbmRsZXJfdCk7CgoKCgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBh
bGxvd19zaWduYWwoaW50IHNpZykKewoKCgoKCiBrZXJuZWxfc2lnYWN0aW9uKHNpZywgKCgg
X19zaWdoYW5kbGVyX3QpMikpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBhbGxvd19rZXJuZWxfc2ln
bmFsKGludCBzaWcpCnsKCgoKCgoga2VybmVsX3NpZ2FjdGlvbihzaWcsICgoIF9fc2lnaGFu
ZGxlcl90KTMpKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgZGlzYWxsb3dfc2lnbmFsKGludCBzaWcp
CnsKIGtlcm5lbF9zaWdhY3Rpb24oc2lnLCAoKCBfX3NpZ2hhbmRsZXJfdCkxKSk7Cn0KCmV4
dGVybiBzdHJ1Y3Qga21lbV9jYWNoZSAqc2lnaGFuZF9jYWNoZXA7CgpleHRlcm4gYm9vbCB1
bmhhbmRsZWRfc2lnbmFsKHN0cnVjdCB0YXNrX3N0cnVjdCAqdHNrLCBpbnQgc2lnKTsKIyA0
NTAgIi4vaW5jbHVkZS9saW51eC9zaWduYWwuaCIKdm9pZCBzaWduYWxzX2luaXQodm9pZCk7
CgppbnQgcmVzdG9yZV9hbHRzdGFjayhjb25zdCBzdGFja190ICopOwppbnQgX19zYXZlX2Fs
dHN0YWNrKHN0YWNrX3QgKiwgdW5zaWduZWQgbG9uZyk7CiMgNDY2ICIuL2luY2x1ZGUvbGlu
dXgvc2lnbmFsLmgiCnN0cnVjdCBzZXFfZmlsZTsKZXh0ZXJuIHZvaWQgcmVuZGVyX3NpZ3Nl
dF90KHN0cnVjdCBzZXFfZmlsZSAqLCBjb25zdCBjaGFyICosIHNpZ3NldF90ICopOwojIDcg
Ii4vaW5jbHVkZS9saW51eC9zY2hlZC9zaWduYWwuaCIgMgoKIyAxICIuL2luY2x1ZGUvbGlu
dXgvc2NoZWQvam9iY3RsLmgiIDEKCgoKCgoKc3RydWN0IHRhc2tfc3RydWN0OwojIDM1ICIu
L2luY2x1ZGUvbGludXgvc2NoZWQvam9iY3RsLmgiCmV4dGVybiBib29sIHRhc2tfc2V0X2pv
YmN0bF9wZW5kaW5nKHN0cnVjdCB0YXNrX3N0cnVjdCAqdGFzaywgdW5zaWduZWQgbG9uZyBt
YXNrKTsKZXh0ZXJuIHZvaWQgdGFza19jbGVhcl9qb2JjdGxfdHJhcHBpbmcoc3RydWN0IHRh
c2tfc3RydWN0ICp0YXNrKTsKZXh0ZXJuIHZvaWQgdGFza19jbGVhcl9qb2JjdGxfcGVuZGlu
ZyhzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRhc2ssIHVuc2lnbmVkIGxvbmcgbWFzayk7CiMgOSAi
Li9pbmNsdWRlL2xpbnV4L3NjaGVkL3NpZ25hbC5oIiAyCiMgMSAiLi9pbmNsdWRlL2xpbnV4
L3NjaGVkL3Rhc2suaCIgMQojIDExICIuL2luY2x1ZGUvbGludXgvc2NoZWQvdGFzay5oIgoj
IDEgIi4vaW5jbHVkZS9saW51eC91YWNjZXNzLmgiIDEKIyAxMSAiLi9pbmNsdWRlL2xpbnV4
L3VhY2Nlc3MuaCIKIyAxICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS91YWNjZXNzLmgi
IDEKCgoKCiMgMSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vcHBjX2FzbS5oIiAxCiMg
MTEgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL3BwY19hc20uaCIKIyAxICIuL2FyY2gv
cG93ZXJwYy9pbmNsdWRlL2FzbS9maXJtd2FyZS5oIiAxCiMgNTggIi4vYXJjaC9wb3dlcnBj
L2luY2x1ZGUvYXNtL2Zpcm13YXJlLmgiCmVudW0gewoKIEZXX0ZFQVRVUkVfUFNFUklFU19Q
T1NTSUJMRSA9IDB4MDAwMDAwMDAwMDAwMDAwMVVMIHwgMHgwMDAwMDAwMDAwMDAwMDAyVUwg
fAogIDB4MDAwMDAwMDAwMDAwMDAwNFVMIHwgMHgwMDAwMDAwMDAwMDAwMDA4VUwgfCAweDAw
MDAwMDAwMDAwMDAwMTBVTCB8CiAgMHgwMDAwMDAwMDAwMDAwMDIwVUwgfCAweDAwMDAwMDAw
MDAwMDAwNDBVTCB8IDB4MDAwMDAwMDAwMDAwMDA4MFVMIHwKICAweDAwMDAwMDAwMDAwMDAx
MDBVTCB8IDB4MDAwMDAwMDAwMDAwMDIwMFVMIHwgMHgwMDAwMDAwMDAwMDAwNDAwVUwgfAog
IDB4MDAwMDAwMDAwMDAwMDgwMFVMIHwgMHgwMDAwMDAwMDAwMDAxMDAwVUwgfCAweDAwMDAw
MDAwMDAwMDIwMDBVTCB8CiAgMHgwMDAwMDAwMDAwMDA0MDAwVUwgfCAweDAwMDAwMDAwMDAw
MDgwMDBVTCB8IDB4MDAwMDAwMDAwMDAxMDAwMFVMIHwKICAweDAwMDAwMDAwMDAwMjAwMDBV
TCB8IDB4MDAwMDAwMDAwMDA0MDAwMFVMIHwKICAweDAwMDAwMDAwMDAwODAwMDBVTCB8IDB4
MDAwMDAwODAwMDAwMDAwMFVMIHwKICAweDAwMDAwMDAwMDAxMDAwMDBVTCB8IDB4MDAwMDAw
MDAwMDQwMDAwMFVMIHwKICAweDAwMDAwMDAwMDIwMDAwMDBVTCB8IDB4MDAwMDAwMDAwNDAw
MDAwMFVMIHwgMHgwMDAwMDAwMDA4MDAwMDAwVUwgfAogIDB4MDAwMDAwMDA0MDAwMDAwMFVM
IHwgMHgwMDAwMDAwMDgwMDAwMDAwVUwgfAogIDB4MDAwMDAwMDEwMDAwMDAwMFVMIHwgMHgw
MDAwMDAwMjAwMDAwMDAwVUwgfAogIDB4MDAwMDAwMDAwMTAwMDAwMFVMIHwgMHgwMDAwMDAw
NDAwMDAwMDAwVUwgfAogIDB4MDAwMDAwMDgwMDAwMDAwMFVMIHwgMHgwMDAwMDAxMDAwMDAw
MDAwVUwgfAogIDB4MDAwMDAwMjAwMDAwMDAwMFVMIHwgMHgwMDAwMDA0MDAwMDAwMDAwVUws
CiBGV19GRUFUVVJFX1BTRVJJRVNfQUxXQVlTID0gMCwKIEZXX0ZFQVRVUkVfUE9XRVJOVl9Q
T1NTSUJMRSA9IDB4MDAwMDAwMDAxMDAwMDAwMFVMIHwgMHgwMDAwMDA0MDAwMDAwMDAwVUws
CiBGV19GRUFUVVJFX1BPV0VSTlZfQUxXQVlTID0gMCwKIEZXX0ZFQVRVUkVfUFMzX1BPU1NJ
QkxFID0gMHgwMDAwMDAwMDAwNDAwMDAwVUwgfCAweDAwMDAwMDAwMDA4MDAwMDBVTCwKIEZX
X0ZFQVRVUkVfUFMzX0FMV0FZUyA9IDB4MDAwMDAwMDAwMDQwMDAwMFVMIHwgMHgwMDAwMDAw
MDAwODAwMDAwVUwsCiBGV19GRUFUVVJFX05BVElWRV9QT1NTSUJMRSA9IDAsCiBGV19GRUFU
VVJFX05BVElWRV9BTFdBWVMgPSAwLAogRldfRkVBVFVSRV9QT1NTSUJMRSA9CiMgOTUgIi4v
YXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2Zpcm13YXJlLmgiCiAgMCwKIEZXX0ZFQVRVUkVf
QUxXQVlTID0KIyAxMDkgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2Zpcm13YXJlLmgi
CiAgRldfRkVBVFVSRV9QT1NTSUJMRSwKCgoKCgp9OwoKCgoKZXh0ZXJuIHVuc2lnbmVkIGxv
bmcgcG93ZXJwY19maXJtd2FyZV9mZWF0dXJlczsKCgoKCgpleHRlcm4gdm9pZCBzeXN0ZW1f
cmVzZXRfZndubWkodm9pZCk7CmV4dGVybiB2b2lkIG1hY2hpbmVfY2hlY2tfZndubWkodm9p
ZCk7CgoKZXh0ZXJuIGludCBmd25taV9hY3RpdmU7CmV4dGVybiBpbnQgaWJtX25taV9pbnRl
cmxvY2tfdG9rZW47CgpleHRlcm4gdW5zaWduZWQgaW50IF9fc3RhcnRfX19md19mdHJfZml4
dXAsIF9fc3RvcF9fX2Z3X2Z0cl9maXh1cDsKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHBzZXJpZXNf
cHJvYmVfZndfZmVhdHVyZXModm9pZCkgeyB9OwojIDEyICIuL2FyY2gvcG93ZXJwYy9pbmNs
dWRlL2FzbS9wcGNfYXNtLmgiIDIKIyA2ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS91
YWNjZXNzLmgiIDIKCgojIDEgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2V4dGFibGUu
aCIgMQojIDIwICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9leHRhYmxlLmgiCnN0cnVj
dCBleGNlcHRpb25fdGFibGVfZW50cnkgewogaW50IGluc247CiBpbnQgZml4dXA7Cn07Cgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgdW5zaWduZWQgbG9uZyBleHRhYmxlX2ZpeHVwKGNvbnN0IHN0cnVjdCBleGNl
cHRpb25fdGFibGVfZW50cnkgKngpCnsKIHJldHVybiAodW5zaWduZWQgbG9uZykmeC0+Zml4
dXAgKyB4LT5maXh1cDsKfQojIDkgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL3VhY2Nl
c3MuaCIgMgojIDEgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2t1cC5oIiAxCiMgMTgg
Ii4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2t1cC5oIgojIDEgIi4vYXJjaC9wb3dlcnBj
L2luY2x1ZGUvYXNtL2Jvb2szcy82NC9rdXAtcmFkaXguaCIgMQojIDE2OSAiLi9hcmNoL3Bv
d2VycGMvaW5jbHVkZS9hc20vYm9vazNzLzY0L2t1cC1yYWRpeC5oIgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9p
ZCBrdWFwX3Jlc3RvcmVfYW1yKHN0cnVjdCBwdF9yZWdzICpyZWdzLCB1bnNpZ25lZCBsb25n
IGFtcikKewp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBrdWFwX2NoZWNrX2Ftcih2b2lkKQp7Cn0KCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSB1bnNpZ25lZCBsb25nIGt1YXBfZ2V0X2FuZF9jaGVja19hbXIodm9pZCkKewog
cmV0dXJuIDA7Cn0KIyAxOSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20va3VwLmgiIDIK
IyA0NCAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20va3VwLmgiCnZvaWQgc2V0dXBfa3Vw
KHZvaWQpOwoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgc2V0dXBfa3VlcChib29sIGRpc2FibGVkKSB7
IH0KCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBzZXR1cF9rdWFwKGJvb2wgZGlzYWJsZWQpIHsgfQpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgdm9pZCBhbGxvd191c2VyX2FjY2Vzcyh2b2lkICp0bywgY29uc3Qgdm9pZCAq
ZnJvbSwKICAgICAgICAgdW5zaWduZWQgbG9uZyBzaXplLCB1bnNpZ25lZCBsb25nIGRpcikg
eyB9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSB2b2lkIHByZXZlbnRfdXNlcl9hY2Nlc3Modm9pZCAqdG8sIGNvbnN0
IHZvaWQgKmZyb20sCiAgICAgICAgICAgdW5zaWduZWQgbG9uZyBzaXplLCB1bnNpZ25lZCBs
b25nIGRpcikgeyB9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1bnNpZ25lZCBsb25nIHByZXZlbnRfdXNlcl9hY2Nl
c3NfcmV0dXJuKHZvaWQpIHsgcmV0dXJuIDBVTDsgfQpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCByZXN0b3Jl
X3VzZXJfYWNjZXNzKHVuc2lnbmVkIGxvbmcgZmxhZ3MpIHsgfQpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkKCiMgNjIg
Ii4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2t1cC5oIgogICAgICAgICAgICAgIGJvb2wK
YmFkX2t1YXBfZmF1bHQoc3RydWN0IHB0X3JlZ3MgKnJlZ3MsIHVuc2lnbmVkIGxvbmcgYWRk
cmVzcywgYm9vbCBpc193cml0ZSkKewogcmV0dXJuIGZhbHNlOwp9CgoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZv
aWQgYWxsb3dfcmVhZF9mcm9tX3VzZXIoY29uc3Qgdm9pZCAqZnJvbSwgdW5zaWduZWQgbG9u
ZyBzaXplKQp7CiBhbGxvd191c2VyX2FjY2VzcygoKHZvaWQgKikwKSwgZnJvbSwgc2l6ZSwg
MSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSB2b2lkIGFsbG93X3dyaXRlX3RvX3VzZXIodm9pZCAqdG8sIHVu
c2lnbmVkIGxvbmcgc2l6ZSkKewogYWxsb3dfdXNlcl9hY2Nlc3ModG8sICgodm9pZCAqKTAp
LCBzaXplLCAyKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgYWxsb3dfcmVhZF93cml0ZV91c2VyKHZv
aWQgKnRvLCBjb25zdCB2b2lkICpmcm9tLAogICAgICB1bnNpZ25lZCBsb25nIHNpemUpCnsK
IGFsbG93X3VzZXJfYWNjZXNzKHRvLCBmcm9tLCBzaXplLCAoMSB8IDIpKTsKfQoKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIHZvaWQgcHJldmVudF9yZWFkX2Zyb21fdXNlcihjb25zdCB2b2lkICpmcm9tLCB1bnNp
Z25lZCBsb25nIHNpemUpCnsKIHByZXZlbnRfdXNlcl9hY2Nlc3MoKCh2b2lkICopMCksIGZy
b20sIHNpemUsIDEpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBwcmV2ZW50X3dyaXRlX3RvX3VzZXIo
dm9pZCAqdG8sIHVuc2lnbmVkIGxvbmcgc2l6ZSkKewogcHJldmVudF91c2VyX2FjY2Vzcyh0
bywgKCh2b2lkICopMCksIHNpemUsIDIpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBwcmV2ZW50X3Jl
YWRfd3JpdGVfdXNlcih2b2lkICp0bywgY29uc3Qgdm9pZCAqZnJvbSwKICAgICAgICB1bnNp
Z25lZCBsb25nIHNpemUpCnsKIHByZXZlbnRfdXNlcl9hY2Nlc3ModG8sIGZyb20sIHNpemUs
ICgxIHwgMikpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBwcmV2ZW50X2N1cnJlbnRfYWNjZXNzX3Vz
ZXIodm9pZCkKewogcHJldmVudF91c2VyX2FjY2VzcygoKHZvaWQgKikwKSwgKCh2b2lkICop
MCksIH4wVUwsICg0IHwgOCkpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBwcmV2ZW50X2N1cnJlbnRf
cmVhZF9mcm9tX3VzZXIodm9pZCkKewogcHJldmVudF91c2VyX2FjY2VzcygoKHZvaWQgKikw
KSwgKCh2b2lkICopMCksIH4wVUwsIDQpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBwcmV2ZW50X2N1
cnJlbnRfd3JpdGVfdG9fdXNlcih2b2lkKQp7CiBwcmV2ZW50X3VzZXJfYWNjZXNzKCgodm9p
ZCAqKTApLCAoKHZvaWQgKikwKSwgfjBVTCwgOCk7Cn0KIyAxMCAiLi9hcmNoL3Bvd2VycGMv
aW5jbHVkZS9hc20vdWFjY2Vzcy5oIiAyCiMgMzQgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUv
YXNtL3VhY2Nlc3MuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgc2V0X2ZzKG1tX3NlZ21lbnRfdCBmcykK
ewogZ2V0X2N1cnJlbnQoKS0+dGhyZWFkLmFkZHJfbGltaXQgPSBmczsKCiBzZXRfdGlfdGhy
ZWFkX2ZsYWcoKChzdHJ1Y3QgdGhyZWFkX2luZm8gKilnZXRfY3VycmVudCgpKSwgMyk7Cn0K
IyAxNTMgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL3VhY2Nlc3MuaCIKZXh0ZXJuIGxv
bmcgX19wdXRfdXNlcl9iYWQodm9pZCk7CiMgMjk5ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRl
L2FzbS91YWNjZXNzLmgiCmV4dGVybiBsb25nIF9fZ2V0X3VzZXJfYmFkKHZvaWQpOwojIDQz
NiAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vdWFjY2Vzcy5oIgpleHRlcm4gdW5zaWdu
ZWQgbG9uZyBfX2NvcHlfdG9mcm9tX3VzZXIodm9pZCAqdG8sCiAgY29uc3Qgdm9pZCAqZnJv
bSwgdW5zaWduZWQgbG9uZyBzaXplKTsKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgbG9uZwpyYXdf
Y29weV9pbl91c2VyKHZvaWQgKnRvLCBjb25zdCB2b2lkICpmcm9tLCB1bnNpZ25lZCBsb25n
IG4pCnsKIHVuc2lnbmVkIGxvbmcgcmV0OwoKIGFzbSAoIjk1MzogLnB1c2hzZWN0aW9uIF9f
YmFycmllcl9ub3NwZWNfZml4dXAsXCJhXCI7IC5hbGlnbiAyOyA5NTQ6IC44Ynl0ZSA5NTNi
LTk1NGI7IC5wb3BzZWN0aW9uOzsgbm9wOyBub3AiICIgIiA6OjogIm1lbW9yeSIpOwogYWxs
b3dfcmVhZF93cml0ZV91c2VyKHRvLCBmcm9tLCBuKTsKIHJldCA9IF9fY29weV90b2Zyb21f
dXNlcih0bywgZnJvbSwgbik7CiBwcmV2ZW50X3JlYWRfd3JpdGVfdXNlcih0bywgZnJvbSwg
bik7CiByZXR1cm4gcmV0Owp9CgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHVuc2lnbmVkIGxvbmcgcmF3X2NvcHlf
ZnJvbV91c2VyKHZvaWQgKnRvLAogIGNvbnN0IHZvaWQgKmZyb20sIHVuc2lnbmVkIGxvbmcg
bikKewogdW5zaWduZWQgbG9uZyByZXQ7CiBpZiAoX19idWlsdGluX2NvbnN0YW50X3Aobikg
JiYgKG4gPD0gOCkpIHsKICByZXQgPSAxOwoKICBzd2l0Y2ggKG4pIHsKICBjYXNlIDE6CiAg
IGFzbSAoIjk1MzogLnB1c2hzZWN0aW9uIF9fYmFycmllcl9ub3NwZWNfZml4dXAsXCJhXCI7
IC5hbGlnbiAyOyA5NTQ6IC44Ynl0ZSA5NTNiLTk1NGI7IC5wb3BzZWN0aW9uOzsgbm9wOyBu
b3AiICIgIiA6OjogIm1lbW9yeSIpOwogICBkbyB7IGFsbG93X3JlYWRfZnJvbV91c2VyKGZy
b20sIDEpOyBkbyB7IHJldCA9IDA7ICh2b2lkKTA7IGlmICgxID4gc2l6ZW9mKCoodTggKil0
bykpICgqKHU4ICopdG8pID0gX19nZXRfdXNlcl9iYWQoKTsgc3dpdGNoICgxKSB7IGNhc2Ug
MTogX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgkiImxieiIiJVUyJVgyICUxLCAlMgkjIGdl
dF91c2VyXG4iICIyOlxuIiAiLnNlY3Rpb24gLmZpeHVwLFwiYXhcIlxuIiAiMzoJbGkgJTAs
JTNcbiIgIglsaSAlMSwwXG4iICIJYiAyYlxuIiAiLnByZXZpb3VzXG4iICIuc2VjdGlvbiBf
X2V4X3RhYmxlLFwiYVwiOyIgIiAiICIuYmFsaWduIDQ7IiAiICIgIi5sb25nICgxYikgLSAu
IDsiICIgIiAiLmxvbmcgKDNiKSAtIC4gOyIgIiAiICIucHJldmlvdXMiICIgIiA6ICI9ciIg
KHJldCksICI9ciIgKCoodTggKil0bykgOiAibTw+IiAoKih1OCAqKWZyb20pLCAiaSIgKC0x
NCksICIwIiAocmV0KSk7IGJyZWFrOyBjYXNlIDI6IF9fYXNtX18gX192b2xhdGlsZV9fKCAi
MToJIiJsaHoiIiVVMiVYMiAlMSwgJTIJIyBnZXRfdXNlclxuIiAiMjpcbiIgIi5zZWN0aW9u
IC5maXh1cCxcImF4XCJcbiIgIjM6CWxpICUwLCUzXG4iICIJbGkgJTEsMFxuIiAiCWIgMmJc
biIgIi5wcmV2aW91c1xuIiAiLnNlY3Rpb24gX19leF90YWJsZSxcImFcIjsiICIgIiAiLmJh
bGlnbiA0OyIgIiAiICIubG9uZyAoMWIpIC0gLiA7IiAiICIgIi5sb25nICgzYikgLSAuIDsi
ICIgIiAiLnByZXZpb3VzIiAiICIgOiAiPXIiIChyZXQpLCAiPXIiICgqKHU4ICopdG8pIDog
Im08PiIgKCoodTE2ICopZnJvbSksICJpIiAoLTE0KSwgIjAiIChyZXQpKTsgYnJlYWs7IGNh
c2UgNDogX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgkiImx3eiIiJVUyJVgyICUxLCAlMgkj
IGdldF91c2VyXG4iICIyOlxuIiAiLnNlY3Rpb24gLmZpeHVwLFwiYXhcIlxuIiAiMzoJbGkg
JTAsJTNcbiIgIglsaSAlMSwwXG4iICIJYiAyYlxuIiAiLnByZXZpb3VzXG4iICIuc2VjdGlv
biBfX2V4X3RhYmxlLFwiYVwiOyIgIiAiICIuYmFsaWduIDQ7IiAiICIgIi5sb25nICgxYikg
LSAuIDsiICIgIiAiLmxvbmcgKDNiKSAtIC4gOyIgIiAiICIucHJldmlvdXMiICIgIiA6ICI9
ciIgKHJldCksICI9ciIgKCoodTggKil0bykgOiAibTw+IiAoKih1MzIgKilmcm9tKSwgImki
ICgtMTQpLCAiMCIgKHJldCkpOyBicmVhazsgY2FzZSA4OiBfX2FzbV9fIF9fdm9sYXRpbGVf
XyggIjE6CSIibGQiIiVVMiVYMiAlMSwgJTIJIyBnZXRfdXNlclxuIiAiMjpcbiIgIi5zZWN0
aW9uIC5maXh1cCxcImF4XCJcbiIgIjM6CWxpICUwLCUzXG4iICIJbGkgJTEsMFxuIiAiCWIg
MmJcbiIgIi5wcmV2aW91c1xuIiAiLnNlY3Rpb24gX19leF90YWJsZSxcImFcIjsiICIgIiAi
LmJhbGlnbiA0OyIgIiAiICIubG9uZyAoMWIpIC0gLiA7IiAiICIgIi5sb25nICgzYikgLSAu
IDsiICIgIiAiLnByZXZpb3VzIiAiICIgOiAiPXIiIChyZXQpLCAiPXIiICgqKHU4ICopdG8p
IDogIm08PiIgKCoodTY0ICopZnJvbSksICJpIiAoLTE0KSwgIjAiIChyZXQpKTsgYnJlYWs7
IGRlZmF1bHQ6ICgqKHU4ICopdG8pID0gX19nZXRfdXNlcl9iYWQoKTsgfSB9IHdoaWxlICgw
KTsgcHJldmVudF9yZWFkX2Zyb21fdXNlcihmcm9tLCAxKTsgfSB3aGlsZSAoMCk7CiAgIGJy
ZWFrOwogIGNhc2UgMjoKICAgYXNtICgiOTUzOiAucHVzaHNlY3Rpb24gX19iYXJyaWVyX25v
c3BlY19maXh1cCxcImFcIjsgLmFsaWduIDI7IDk1NDogLjhieXRlIDk1M2ItOTU0YjsgLnBv
cHNlY3Rpb247OyBub3A7IG5vcCIgIiAiIDo6OiAibWVtb3J5Iik7CiAgIGRvIHsgYWxsb3df
cmVhZF9mcm9tX3VzZXIoZnJvbSwgMik7IGRvIHsgcmV0ID0gMDsgKHZvaWQpMDsgaWYgKDIg
PiBzaXplb2YoKih1MTYgKil0bykpICgqKHUxNiAqKXRvKSA9IF9fZ2V0X3VzZXJfYmFkKCk7
IHN3aXRjaCAoMikgeyBjYXNlIDE6IF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJIiJsYnoi
IiVVMiVYMiAlMSwgJTIJIyBnZXRfdXNlclxuIiAiMjpcbiIgIi5zZWN0aW9uIC5maXh1cCxc
ImF4XCJcbiIgIjM6CWxpICUwLCUzXG4iICIJbGkgJTEsMFxuIiAiCWIgMmJcbiIgIi5wcmV2
aW91c1xuIiAiLnNlY3Rpb24gX19leF90YWJsZSxcImFcIjsiICIgIiAiLmJhbGlnbiA0OyIg
IiAiICIubG9uZyAoMWIpIC0gLiA7IiAiICIgIi5sb25nICgzYikgLSAuIDsiICIgIiAiLnBy
ZXZpb3VzIiAiICIgOiAiPXIiIChyZXQpLCAiPXIiICgqKHUxNiAqKXRvKSA6ICJtPD4iICgq
KHU4ICopZnJvbSksICJpIiAoLTE0KSwgIjAiIChyZXQpKTsgYnJlYWs7IGNhc2UgMjogX19h
c21fXyBfX3ZvbGF0aWxlX18oICIxOgkiImxoeiIiJVUyJVgyICUxLCAlMgkjIGdldF91c2Vy
XG4iICIyOlxuIiAiLnNlY3Rpb24gLmZpeHVwLFwiYXhcIlxuIiAiMzoJbGkgJTAsJTNcbiIg
IglsaSAlMSwwXG4iICIJYiAyYlxuIiAiLnByZXZpb3VzXG4iICIuc2VjdGlvbiBfX2V4X3Rh
YmxlLFwiYVwiOyIgIiAiICIuYmFsaWduIDQ7IiAiICIgIi5sb25nICgxYikgLSAuIDsiICIg
IiAiLmxvbmcgKDNiKSAtIC4gOyIgIiAiICIucHJldmlvdXMiICIgIiA6ICI9ciIgKHJldCks
ICI9ciIgKCoodTE2ICopdG8pIDogIm08PiIgKCoodTE2ICopZnJvbSksICJpIiAoLTE0KSwg
IjAiIChyZXQpKTsgYnJlYWs7IGNhc2UgNDogX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgki
Imx3eiIiJVUyJVgyICUxLCAlMgkjIGdldF91c2VyXG4iICIyOlxuIiAiLnNlY3Rpb24gLmZp
eHVwLFwiYXhcIlxuIiAiMzoJbGkgJTAsJTNcbiIgIglsaSAlMSwwXG4iICIJYiAyYlxuIiAi
LnByZXZpb3VzXG4iICIuc2VjdGlvbiBfX2V4X3RhYmxlLFwiYVwiOyIgIiAiICIuYmFsaWdu
IDQ7IiAiICIgIi5sb25nICgxYikgLSAuIDsiICIgIiAiLmxvbmcgKDNiKSAtIC4gOyIgIiAi
ICIucHJldmlvdXMiICIgIiA6ICI9ciIgKHJldCksICI9ciIgKCoodTE2ICopdG8pIDogIm08
PiIgKCoodTMyICopZnJvbSksICJpIiAoLTE0KSwgIjAiIChyZXQpKTsgYnJlYWs7IGNhc2Ug
ODogX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgkiImxkIiIlVTIlWDIgJTEsICUyCSMgZ2V0
X3VzZXJcbiIgIjI6XG4iICIuc2VjdGlvbiAuZml4dXAsXCJheFwiXG4iICIzOglsaSAlMCwl
M1xuIiAiCWxpICUxLDBcbiIgIgliIDJiXG4iICIucHJldmlvdXNcbiIgIi5zZWN0aW9uIF9f
ZXhfdGFibGUsXCJhXCI7IiAiICIgIi5iYWxpZ24gNDsiICIgIiAiLmxvbmcgKDFiKSAtIC4g
OyIgIiAiICIubG9uZyAoM2IpIC0gLiA7IiAiICIgIi5wcmV2aW91cyIgIiAiIDogIj1yIiAo
cmV0KSwgIj1yIiAoKih1MTYgKil0bykgOiAibTw+IiAoKih1NjQgKilmcm9tKSwgImkiICgt
MTQpLCAiMCIgKHJldCkpOyBicmVhazsgZGVmYXVsdDogKCoodTE2ICopdG8pID0gX19nZXRf
dXNlcl9iYWQoKTsgfSB9IHdoaWxlICgwKTsgcHJldmVudF9yZWFkX2Zyb21fdXNlcihmcm9t
LCAyKTsgfSB3aGlsZSAoMCk7CiAgIGJyZWFrOwogIGNhc2UgNDoKICAgYXNtICgiOTUzOiAu
cHVzaHNlY3Rpb24gX19iYXJyaWVyX25vc3BlY19maXh1cCxcImFcIjsgLmFsaWduIDI7IDk1
NDogLjhieXRlIDk1M2ItOTU0YjsgLnBvcHNlY3Rpb247OyBub3A7IG5vcCIgIiAiIDo6OiAi
bWVtb3J5Iik7CiAgIGRvIHsgYWxsb3dfcmVhZF9mcm9tX3VzZXIoZnJvbSwgNCk7IGRvIHsg
cmV0ID0gMDsgKHZvaWQpMDsgaWYgKDQgPiBzaXplb2YoKih1MzIgKil0bykpICgqKHUzMiAq
KXRvKSA9IF9fZ2V0X3VzZXJfYmFkKCk7IHN3aXRjaCAoNCkgeyBjYXNlIDE6IF9fYXNtX18g
X192b2xhdGlsZV9fKCAiMToJIiJsYnoiIiVVMiVYMiAlMSwgJTIJIyBnZXRfdXNlclxuIiAi
MjpcbiIgIi5zZWN0aW9uIC5maXh1cCxcImF4XCJcbiIgIjM6CWxpICUwLCUzXG4iICIJbGkg
JTEsMFxuIiAiCWIgMmJcbiIgIi5wcmV2aW91c1xuIiAiLnNlY3Rpb24gX19leF90YWJsZSxc
ImFcIjsiICIgIiAiLmJhbGlnbiA0OyIgIiAiICIubG9uZyAoMWIpIC0gLiA7IiAiICIgIi5s
b25nICgzYikgLSAuIDsiICIgIiAiLnByZXZpb3VzIiAiICIgOiAiPXIiIChyZXQpLCAiPXIi
ICgqKHUzMiAqKXRvKSA6ICJtPD4iICgqKHU4ICopZnJvbSksICJpIiAoLTE0KSwgIjAiIChy
ZXQpKTsgYnJlYWs7IGNhc2UgMjogX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgkiImxoeiIi
JVUyJVgyICUxLCAlMgkjIGdldF91c2VyXG4iICIyOlxuIiAiLnNlY3Rpb24gLmZpeHVwLFwi
YXhcIlxuIiAiMzoJbGkgJTAsJTNcbiIgIglsaSAlMSwwXG4iICIJYiAyYlxuIiAiLnByZXZp
b3VzXG4iICIuc2VjdGlvbiBfX2V4X3RhYmxlLFwiYVwiOyIgIiAiICIuYmFsaWduIDQ7IiAi
ICIgIi5sb25nICgxYikgLSAuIDsiICIgIiAiLmxvbmcgKDNiKSAtIC4gOyIgIiAiICIucHJl
dmlvdXMiICIgIiA6ICI9ciIgKHJldCksICI9ciIgKCoodTMyICopdG8pIDogIm08PiIgKCoo
dTE2ICopZnJvbSksICJpIiAoLTE0KSwgIjAiIChyZXQpKTsgYnJlYWs7IGNhc2UgNDogX19h
c21fXyBfX3ZvbGF0aWxlX18oICIxOgkiImx3eiIiJVUyJVgyICUxLCAlMgkjIGdldF91c2Vy
XG4iICIyOlxuIiAiLnNlY3Rpb24gLmZpeHVwLFwiYXhcIlxuIiAiMzoJbGkgJTAsJTNcbiIg
IglsaSAlMSwwXG4iICIJYiAyYlxuIiAiLnByZXZpb3VzXG4iICIuc2VjdGlvbiBfX2V4X3Rh
YmxlLFwiYVwiOyIgIiAiICIuYmFsaWduIDQ7IiAiICIgIi5sb25nICgxYikgLSAuIDsiICIg
IiAiLmxvbmcgKDNiKSAtIC4gOyIgIiAiICIucHJldmlvdXMiICIgIiA6ICI9ciIgKHJldCks
ICI9ciIgKCoodTMyICopdG8pIDogIm08PiIgKCoodTMyICopZnJvbSksICJpIiAoLTE0KSwg
IjAiIChyZXQpKTsgYnJlYWs7IGNhc2UgODogX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgki
ImxkIiIlVTIlWDIgJTEsICUyCSMgZ2V0X3VzZXJcbiIgIjI6XG4iICIuc2VjdGlvbiAuZml4
dXAsXCJheFwiXG4iICIzOglsaSAlMCwlM1xuIiAiCWxpICUxLDBcbiIgIgliIDJiXG4iICIu
cHJldmlvdXNcbiIgIi5zZWN0aW9uIF9fZXhfdGFibGUsXCJhXCI7IiAiICIgIi5iYWxpZ24g
NDsiICIgIiAiLmxvbmcgKDFiKSAtIC4gOyIgIiAiICIubG9uZyAoM2IpIC0gLiA7IiAiICIg
Ii5wcmV2aW91cyIgIiAiIDogIj1yIiAocmV0KSwgIj1yIiAoKih1MzIgKil0bykgOiAibTw+
IiAoKih1NjQgKilmcm9tKSwgImkiICgtMTQpLCAiMCIgKHJldCkpOyBicmVhazsgZGVmYXVs
dDogKCoodTMyICopdG8pID0gX19nZXRfdXNlcl9iYWQoKTsgfSB9IHdoaWxlICgwKTsgcHJl
dmVudF9yZWFkX2Zyb21fdXNlcihmcm9tLCA0KTsgfSB3aGlsZSAoMCk7CiAgIGJyZWFrOwog
IGNhc2UgODoKICAgYXNtICgiOTUzOiAucHVzaHNlY3Rpb24gX19iYXJyaWVyX25vc3BlY19m
aXh1cCxcImFcIjsgLmFsaWduIDI7IDk1NDogLjhieXRlIDk1M2ItOTU0YjsgLnBvcHNlY3Rp
b247OyBub3A7IG5vcCIgIiAiIDo6OiAibWVtb3J5Iik7CiAgIGRvIHsgYWxsb3dfcmVhZF9m
cm9tX3VzZXIoZnJvbSwgOCk7IGRvIHsgcmV0ID0gMDsgKHZvaWQpMDsgaWYgKDggPiBzaXpl
b2YoKih1NjQgKil0bykpICgqKHU2NCAqKXRvKSA9IF9fZ2V0X3VzZXJfYmFkKCk7IHN3aXRj
aCAoOCkgeyBjYXNlIDE6IF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJIiJsYnoiIiVVMiVY
MiAlMSwgJTIJIyBnZXRfdXNlclxuIiAiMjpcbiIgIi5zZWN0aW9uIC5maXh1cCxcImF4XCJc
biIgIjM6CWxpICUwLCUzXG4iICIJbGkgJTEsMFxuIiAiCWIgMmJcbiIgIi5wcmV2aW91c1xu
IiAiLnNlY3Rpb24gX19leF90YWJsZSxcImFcIjsiICIgIiAiLmJhbGlnbiA0OyIgIiAiICIu
bG9uZyAoMWIpIC0gLiA7IiAiICIgIi5sb25nICgzYikgLSAuIDsiICIgIiAiLnByZXZpb3Vz
IiAiICIgOiAiPXIiIChyZXQpLCAiPXIiICgqKHU2NCAqKXRvKSA6ICJtPD4iICgqKHU4ICop
ZnJvbSksICJpIiAoLTE0KSwgIjAiIChyZXQpKTsgYnJlYWs7IGNhc2UgMjogX19hc21fXyBf
X3ZvbGF0aWxlX18oICIxOgkiImxoeiIiJVUyJVgyICUxLCAlMgkjIGdldF91c2VyXG4iICIy
OlxuIiAiLnNlY3Rpb24gLmZpeHVwLFwiYXhcIlxuIiAiMzoJbGkgJTAsJTNcbiIgIglsaSAl
MSwwXG4iICIJYiAyYlxuIiAiLnByZXZpb3VzXG4iICIuc2VjdGlvbiBfX2V4X3RhYmxlLFwi
YVwiOyIgIiAiICIuYmFsaWduIDQ7IiAiICIgIi5sb25nICgxYikgLSAuIDsiICIgIiAiLmxv
bmcgKDNiKSAtIC4gOyIgIiAiICIucHJldmlvdXMiICIgIiA6ICI9ciIgKHJldCksICI9ciIg
KCoodTY0ICopdG8pIDogIm08PiIgKCoodTE2ICopZnJvbSksICJpIiAoLTE0KSwgIjAiIChy
ZXQpKTsgYnJlYWs7IGNhc2UgNDogX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgkiImx3eiIi
JVUyJVgyICUxLCAlMgkjIGdldF91c2VyXG4iICIyOlxuIiAiLnNlY3Rpb24gLmZpeHVwLFwi
YXhcIlxuIiAiMzoJbGkgJTAsJTNcbiIgIglsaSAlMSwwXG4iICIJYiAyYlxuIiAiLnByZXZp
b3VzXG4iICIuc2VjdGlvbiBfX2V4X3RhYmxlLFwiYVwiOyIgIiAiICIuYmFsaWduIDQ7IiAi
ICIgIi5sb25nICgxYikgLSAuIDsiICIgIiAiLmxvbmcgKDNiKSAtIC4gOyIgIiAiICIucHJl
dmlvdXMiICIgIiA6ICI9ciIgKHJldCksICI9ciIgKCoodTY0ICopdG8pIDogIm08PiIgKCoo
dTMyICopZnJvbSksICJpIiAoLTE0KSwgIjAiIChyZXQpKTsgYnJlYWs7IGNhc2UgODogX19h
c21fXyBfX3ZvbGF0aWxlX18oICIxOgkiImxkIiIlVTIlWDIgJTEsICUyCSMgZ2V0X3VzZXJc
biIgIjI6XG4iICIuc2VjdGlvbiAuZml4dXAsXCJheFwiXG4iICIzOglsaSAlMCwlM1xuIiAi
CWxpICUxLDBcbiIgIgliIDJiXG4iICIucHJldmlvdXNcbiIgIi5zZWN0aW9uIF9fZXhfdGFi
bGUsXCJhXCI7IiAiICIgIi5iYWxpZ24gNDsiICIgIiAiLmxvbmcgKDFiKSAtIC4gOyIgIiAi
ICIubG9uZyAoM2IpIC0gLiA7IiAiICIgIi5wcmV2aW91cyIgIiAiIDogIj1yIiAocmV0KSwg
Ij1yIiAoKih1NjQgKil0bykgOiAibTw+IiAoKih1NjQgKilmcm9tKSwgImkiICgtMTQpLCAi
MCIgKHJldCkpOyBicmVhazsgZGVmYXVsdDogKCoodTY0ICopdG8pID0gX19nZXRfdXNlcl9i
YWQoKTsgfSB9IHdoaWxlICgwKTsgcHJldmVudF9yZWFkX2Zyb21fdXNlcihmcm9tLCA4KTsg
fSB3aGlsZSAoMCk7CiAgIGJyZWFrOwogIH0KICBpZiAocmV0ID09IDApCiAgIHJldHVybiAw
OwogfQoKIGFzbSAoIjk1MzogLnB1c2hzZWN0aW9uIF9fYmFycmllcl9ub3NwZWNfZml4dXAs
XCJhXCI7IC5hbGlnbiAyOyA5NTQ6IC44Ynl0ZSA5NTNiLTk1NGI7IC5wb3BzZWN0aW9uOzsg
bm9wOyBub3AiICIgIiA6OjogIm1lbW9yeSIpOwogYWxsb3dfcmVhZF9mcm9tX3VzZXIoZnJv
bSwgbik7CiByZXQgPSBfX2NvcHlfdG9mcm9tX3VzZXIoKCB2b2lkICopdG8sIGZyb20sIG4p
OwogcHJldmVudF9yZWFkX2Zyb21fdXNlcihmcm9tLCBuKTsKIHJldHVybiByZXQ7Cn0KCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSB1bnNpZ25lZCBsb25nCnJhd19jb3B5X3RvX3VzZXJfYWxsb3dlZCh2b2lkICp0
bywgY29uc3Qgdm9pZCAqZnJvbSwgdW5zaWduZWQgbG9uZyBuKQp7CiBpZiAoX19idWlsdGlu
X2NvbnN0YW50X3AobikgJiYgKG4gPD0gOCkpIHsKICB1bnNpZ25lZCBsb25nIHJldCA9IDE7
CgogIHN3aXRjaCAobikgewogIGNhc2UgMToKICAgZG8geyByZXQgPSAwOyBzd2l0Y2ggKDEp
IHsgY2FzZSAxOiBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CSIgInN0YiIgIiVVMiVYMiAl
MSwlMgkjIHB1dF91c2VyXG4iICIyOlxuIiAiLnNlY3Rpb24gLmZpeHVwLFwiYXhcIlxuIiAi
MzoJbGkgJTAsJTNcbiIgIgliIDJiXG4iICIucHJldmlvdXNcbiIgIi5zZWN0aW9uIF9fZXhf
dGFibGUsXCJhXCI7IiAiICIgIi5iYWxpZ24gNDsiICIgIiAiLmxvbmcgKDFiKSAtIC4gOyIg
IiAiICIubG9uZyAoM2IpIC0gLiA7IiAiICIgIi5wcmV2aW91cyIgIiAiIDogIj1yIiAocmV0
KSA6ICJyIiAoKih1OCAqKWZyb20pLCAibTw+IiAoKih1OCAqKXRvKSwgImkiICgtMTQpLCAi
MCIgKHJldCkpOyBicmVhazsgY2FzZSAyOiBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CSIg
InN0aCIgIiVVMiVYMiAlMSwlMgkjIHB1dF91c2VyXG4iICIyOlxuIiAiLnNlY3Rpb24gLmZp
eHVwLFwiYXhcIlxuIiAiMzoJbGkgJTAsJTNcbiIgIgliIDJiXG4iICIucHJldmlvdXNcbiIg
Ii5zZWN0aW9uIF9fZXhfdGFibGUsXCJhXCI7IiAiICIgIi5iYWxpZ24gNDsiICIgIiAiLmxv
bmcgKDFiKSAtIC4gOyIgIiAiICIubG9uZyAoM2IpIC0gLiA7IiAiICIgIi5wcmV2aW91cyIg
IiAiIDogIj1yIiAocmV0KSA6ICJyIiAoKih1OCAqKWZyb20pLCAibTw+IiAoKih1OCAqKXRv
KSwgImkiICgtMTQpLCAiMCIgKHJldCkpOyBicmVhazsgY2FzZSA0OiBfX2FzbV9fIF9fdm9s
YXRpbGVfXyggIjE6CSIgInN0dyIgIiVVMiVYMiAlMSwlMgkjIHB1dF91c2VyXG4iICIyOlxu
IiAiLnNlY3Rpb24gLmZpeHVwLFwiYXhcIlxuIiAiMzoJbGkgJTAsJTNcbiIgIgliIDJiXG4i
ICIucHJldmlvdXNcbiIgIi5zZWN0aW9uIF9fZXhfdGFibGUsXCJhXCI7IiAiICIgIi5iYWxp
Z24gNDsiICIgIiAiLmxvbmcgKDFiKSAtIC4gOyIgIiAiICIubG9uZyAoM2IpIC0gLiA7IiAi
ICIgIi5wcmV2aW91cyIgIiAiIDogIj1yIiAocmV0KSA6ICJyIiAoKih1OCAqKWZyb20pLCAi
bTw+IiAoKih1OCAqKXRvKSwgImkiICgtMTQpLCAiMCIgKHJldCkpOyBicmVhazsgY2FzZSA4
OiBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CSIgInN0ZCIgIiVVMiVYMiAlMSwlMgkjIHB1
dF91c2VyXG4iICIyOlxuIiAiLnNlY3Rpb24gLmZpeHVwLFwiYXhcIlxuIiAiMzoJbGkgJTAs
JTNcbiIgIgliIDJiXG4iICIucHJldmlvdXNcbiIgIi5zZWN0aW9uIF9fZXhfdGFibGUsXCJh
XCI7IiAiICIgIi5iYWxpZ24gNDsiICIgIiAiLmxvbmcgKDFiKSAtIC4gOyIgIiAiICIubG9u
ZyAoM2IpIC0gLiA7IiAiICIgIi5wcmV2aW91cyIgIiAiIDogIj1yIiAocmV0KSA6ICJyIiAo
Kih1OCAqKWZyb20pLCAibTw+IiAoKih1OCAqKXRvKSwgImkiICgtMTQpLCAiMCIgKHJldCkp
OyBicmVhazsgZGVmYXVsdDogX19wdXRfdXNlcl9iYWQoKTsgfSB9IHdoaWxlICgwKTsKICAg
YnJlYWs7CiAgY2FzZSAyOgogICBkbyB7IHJldCA9IDA7IHN3aXRjaCAoMikgeyBjYXNlIDE6
IF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJIiAic3RiIiAiJVUyJVgyICUxLCUyCSMgcHV0
X3VzZXJcbiIgIjI6XG4iICIuc2VjdGlvbiAuZml4dXAsXCJheFwiXG4iICIzOglsaSAlMCwl
M1xuIiAiCWIgMmJcbiIgIi5wcmV2aW91c1xuIiAiLnNlY3Rpb24gX19leF90YWJsZSxcImFc
IjsiICIgIiAiLmJhbGlnbiA0OyIgIiAiICIubG9uZyAoMWIpIC0gLiA7IiAiICIgIi5sb25n
ICgzYikgLSAuIDsiICIgIiAiLnByZXZpb3VzIiAiICIgOiAiPXIiIChyZXQpIDogInIiICgq
KHUxNiAqKWZyb20pLCAibTw+IiAoKih1MTYgKil0byksICJpIiAoLTE0KSwgIjAiIChyZXQp
KTsgYnJlYWs7IGNhc2UgMjogX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgkiICJzdGgiICIl
VTIlWDIgJTEsJTIJIyBwdXRfdXNlclxuIiAiMjpcbiIgIi5zZWN0aW9uIC5maXh1cCxcImF4
XCJcbiIgIjM6CWxpICUwLCUzXG4iICIJYiAyYlxuIiAiLnByZXZpb3VzXG4iICIuc2VjdGlv
biBfX2V4X3RhYmxlLFwiYVwiOyIgIiAiICIuYmFsaWduIDQ7IiAiICIgIi5sb25nICgxYikg
LSAuIDsiICIgIiAiLmxvbmcgKDNiKSAtIC4gOyIgIiAiICIucHJldmlvdXMiICIgIiA6ICI9
ciIgKHJldCkgOiAiciIgKCoodTE2ICopZnJvbSksICJtPD4iICgqKHUxNiAqKXRvKSwgImki
ICgtMTQpLCAiMCIgKHJldCkpOyBicmVhazsgY2FzZSA0OiBfX2FzbV9fIF9fdm9sYXRpbGVf
XyggIjE6CSIgInN0dyIgIiVVMiVYMiAlMSwlMgkjIHB1dF91c2VyXG4iICIyOlxuIiAiLnNl
Y3Rpb24gLmZpeHVwLFwiYXhcIlxuIiAiMzoJbGkgJTAsJTNcbiIgIgliIDJiXG4iICIucHJl
dmlvdXNcbiIgIi5zZWN0aW9uIF9fZXhfdGFibGUsXCJhXCI7IiAiICIgIi5iYWxpZ24gNDsi
ICIgIiAiLmxvbmcgKDFiKSAtIC4gOyIgIiAiICIubG9uZyAoM2IpIC0gLiA7IiAiICIgIi5w
cmV2aW91cyIgIiAiIDogIj1yIiAocmV0KSA6ICJyIiAoKih1MTYgKilmcm9tKSwgIm08PiIg
KCoodTE2ICopdG8pLCAiaSIgKC0xNCksICIwIiAocmV0KSk7IGJyZWFrOyBjYXNlIDg6IF9f
YXNtX18gX192b2xhdGlsZV9fKCAiMToJIiAic3RkIiAiJVUyJVgyICUxLCUyCSMgcHV0X3Vz
ZXJcbiIgIjI6XG4iICIuc2VjdGlvbiAuZml4dXAsXCJheFwiXG4iICIzOglsaSAlMCwlM1xu
IiAiCWIgMmJcbiIgIi5wcmV2aW91c1xuIiAiLnNlY3Rpb24gX19leF90YWJsZSxcImFcIjsi
ICIgIiAiLmJhbGlnbiA0OyIgIiAiICIubG9uZyAoMWIpIC0gLiA7IiAiICIgIi5sb25nICgz
YikgLSAuIDsiICIgIiAiLnByZXZpb3VzIiAiICIgOiAiPXIiIChyZXQpIDogInIiICgqKHUx
NiAqKWZyb20pLCAibTw+IiAoKih1MTYgKil0byksICJpIiAoLTE0KSwgIjAiIChyZXQpKTsg
YnJlYWs7IGRlZmF1bHQ6IF9fcHV0X3VzZXJfYmFkKCk7IH0gfSB3aGlsZSAoMCk7CiAgIGJy
ZWFrOwogIGNhc2UgNDoKICAgZG8geyByZXQgPSAwOyBzd2l0Y2ggKDQpIHsgY2FzZSAxOiBf
X2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CSIgInN0YiIgIiVVMiVYMiAlMSwlMgkjIHB1dF91
c2VyXG4iICIyOlxuIiAiLnNlY3Rpb24gLmZpeHVwLFwiYXhcIlxuIiAiMzoJbGkgJTAsJTNc
biIgIgliIDJiXG4iICIucHJldmlvdXNcbiIgIi5zZWN0aW9uIF9fZXhfdGFibGUsXCJhXCI7
IiAiICIgIi5iYWxpZ24gNDsiICIgIiAiLmxvbmcgKDFiKSAtIC4gOyIgIiAiICIubG9uZyAo
M2IpIC0gLiA7IiAiICIgIi5wcmV2aW91cyIgIiAiIDogIj1yIiAocmV0KSA6ICJyIiAoKih1
MzIgKilmcm9tKSwgIm08PiIgKCoodTMyICopdG8pLCAiaSIgKC0xNCksICIwIiAocmV0KSk7
IGJyZWFrOyBjYXNlIDI6IF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJIiAic3RoIiAiJVUy
JVgyICUxLCUyCSMgcHV0X3VzZXJcbiIgIjI6XG4iICIuc2VjdGlvbiAuZml4dXAsXCJheFwi
XG4iICIzOglsaSAlMCwlM1xuIiAiCWIgMmJcbiIgIi5wcmV2aW91c1xuIiAiLnNlY3Rpb24g
X19leF90YWJsZSxcImFcIjsiICIgIiAiLmJhbGlnbiA0OyIgIiAiICIubG9uZyAoMWIpIC0g
LiA7IiAiICIgIi5sb25nICgzYikgLSAuIDsiICIgIiAiLnByZXZpb3VzIiAiICIgOiAiPXIi
IChyZXQpIDogInIiICgqKHUzMiAqKWZyb20pLCAibTw+IiAoKih1MzIgKil0byksICJpIiAo
LTE0KSwgIjAiIChyZXQpKTsgYnJlYWs7IGNhc2UgNDogX19hc21fXyBfX3ZvbGF0aWxlX18o
ICIxOgkiICJzdHciICIlVTIlWDIgJTEsJTIJIyBwdXRfdXNlclxuIiAiMjpcbiIgIi5zZWN0
aW9uIC5maXh1cCxcImF4XCJcbiIgIjM6CWxpICUwLCUzXG4iICIJYiAyYlxuIiAiLnByZXZp
b3VzXG4iICIuc2VjdGlvbiBfX2V4X3RhYmxlLFwiYVwiOyIgIiAiICIuYmFsaWduIDQ7IiAi
ICIgIi5sb25nICgxYikgLSAuIDsiICIgIiAiLmxvbmcgKDNiKSAtIC4gOyIgIiAiICIucHJl
dmlvdXMiICIgIiA6ICI9ciIgKHJldCkgOiAiciIgKCoodTMyICopZnJvbSksICJtPD4iICgq
KHUzMiAqKXRvKSwgImkiICgtMTQpLCAiMCIgKHJldCkpOyBicmVhazsgY2FzZSA4OiBfX2Fz
bV9fIF9fdm9sYXRpbGVfXyggIjE6CSIgInN0ZCIgIiVVMiVYMiAlMSwlMgkjIHB1dF91c2Vy
XG4iICIyOlxuIiAiLnNlY3Rpb24gLmZpeHVwLFwiYXhcIlxuIiAiMzoJbGkgJTAsJTNcbiIg
IgliIDJiXG4iICIucHJldmlvdXNcbiIgIi5zZWN0aW9uIF9fZXhfdGFibGUsXCJhXCI7IiAi
ICIgIi5iYWxpZ24gNDsiICIgIiAiLmxvbmcgKDFiKSAtIC4gOyIgIiAiICIubG9uZyAoM2Ip
IC0gLiA7IiAiICIgIi5wcmV2aW91cyIgIiAiIDogIj1yIiAocmV0KSA6ICJyIiAoKih1MzIg
Kilmcm9tKSwgIm08PiIgKCoodTMyICopdG8pLCAiaSIgKC0xNCksICIwIiAocmV0KSk7IGJy
ZWFrOyBkZWZhdWx0OiBfX3B1dF91c2VyX2JhZCgpOyB9IH0gd2hpbGUgKDApOwogICBicmVh
azsKICBjYXNlIDg6CiAgIGRvIHsgcmV0ID0gMDsgc3dpdGNoICg4KSB7IGNhc2UgMTogX19h
c21fXyBfX3ZvbGF0aWxlX18oICIxOgkiICJzdGIiICIlVTIlWDIgJTEsJTIJIyBwdXRfdXNl
clxuIiAiMjpcbiIgIi5zZWN0aW9uIC5maXh1cCxcImF4XCJcbiIgIjM6CWxpICUwLCUzXG4i
ICIJYiAyYlxuIiAiLnByZXZpb3VzXG4iICIuc2VjdGlvbiBfX2V4X3RhYmxlLFwiYVwiOyIg
IiAiICIuYmFsaWduIDQ7IiAiICIgIi5sb25nICgxYikgLSAuIDsiICIgIiAiLmxvbmcgKDNi
KSAtIC4gOyIgIiAiICIucHJldmlvdXMiICIgIiA6ICI9ciIgKHJldCkgOiAiciIgKCoodTY0
ICopZnJvbSksICJtPD4iICgqKHU2NCAqKXRvKSwgImkiICgtMTQpLCAiMCIgKHJldCkpOyBi
cmVhazsgY2FzZSAyOiBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CSIgInN0aCIgIiVVMiVY
MiAlMSwlMgkjIHB1dF91c2VyXG4iICIyOlxuIiAiLnNlY3Rpb24gLmZpeHVwLFwiYXhcIlxu
IiAiMzoJbGkgJTAsJTNcbiIgIgliIDJiXG4iICIucHJldmlvdXNcbiIgIi5zZWN0aW9uIF9f
ZXhfdGFibGUsXCJhXCI7IiAiICIgIi5iYWxpZ24gNDsiICIgIiAiLmxvbmcgKDFiKSAtIC4g
OyIgIiAiICIubG9uZyAoM2IpIC0gLiA7IiAiICIgIi5wcmV2aW91cyIgIiAiIDogIj1yIiAo
cmV0KSA6ICJyIiAoKih1NjQgKilmcm9tKSwgIm08PiIgKCoodTY0ICopdG8pLCAiaSIgKC0x
NCksICIwIiAocmV0KSk7IGJyZWFrOyBjYXNlIDQ6IF9fYXNtX18gX192b2xhdGlsZV9fKCAi
MToJIiAic3R3IiAiJVUyJVgyICUxLCUyCSMgcHV0X3VzZXJcbiIgIjI6XG4iICIuc2VjdGlv
biAuZml4dXAsXCJheFwiXG4iICIzOglsaSAlMCwlM1xuIiAiCWIgMmJcbiIgIi5wcmV2aW91
c1xuIiAiLnNlY3Rpb24gX19leF90YWJsZSxcImFcIjsiICIgIiAiLmJhbGlnbiA0OyIgIiAi
ICIubG9uZyAoMWIpIC0gLiA7IiAiICIgIi5sb25nICgzYikgLSAuIDsiICIgIiAiLnByZXZp
b3VzIiAiICIgOiAiPXIiIChyZXQpIDogInIiICgqKHU2NCAqKWZyb20pLCAibTw+IiAoKih1
NjQgKil0byksICJpIiAoLTE0KSwgIjAiIChyZXQpKTsgYnJlYWs7IGNhc2UgODogX19hc21f
XyBfX3ZvbGF0aWxlX18oICIxOgkiICJzdGQiICIlVTIlWDIgJTEsJTIJIyBwdXRfdXNlclxu
IiAiMjpcbiIgIi5zZWN0aW9uIC5maXh1cCxcImF4XCJcbiIgIjM6CWxpICUwLCUzXG4iICIJ
YiAyYlxuIiAiLnByZXZpb3VzXG4iICIuc2VjdGlvbiBfX2V4X3RhYmxlLFwiYVwiOyIgIiAi
ICIuYmFsaWduIDQ7IiAiICIgIi5sb25nICgxYikgLSAuIDsiICIgIiAiLmxvbmcgKDNiKSAt
IC4gOyIgIiAiICIucHJldmlvdXMiICIgIiA6ICI9ciIgKHJldCkgOiAiciIgKCoodTY0ICop
ZnJvbSksICJtPD4iICgqKHU2NCAqKXRvKSwgImkiICgtMTQpLCAiMCIgKHJldCkpOyBicmVh
azsgZGVmYXVsdDogX19wdXRfdXNlcl9iYWQoKTsgfSB9IHdoaWxlICgwKTsKICAgYnJlYWs7
CiAgfQogIGlmIChyZXQgPT0gMCkKICAgcmV0dXJuIDA7CiB9CgogcmV0dXJuIF9fY29weV90
b2Zyb21fdXNlcih0bywgKCBjb25zdCB2b2lkICopZnJvbSwgbik7Cn0KCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1
bnNpZ25lZCBsb25nCnJhd19jb3B5X3RvX3VzZXIodm9pZCAqdG8sIGNvbnN0IHZvaWQgKmZy
b20sIHVuc2lnbmVkIGxvbmcgbikKewogdW5zaWduZWQgbG9uZyByZXQ7CgogYWxsb3dfd3Jp
dGVfdG9fdXNlcih0bywgbik7CiByZXQgPSByYXdfY29weV90b191c2VyX2FsbG93ZWQodG8s
IGZyb20sIG4pOwogcHJldmVudF93cml0ZV90b191c2VyKHRvLCBuKTsKIHJldHVybiByZXQ7
Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHVuc2ln
bmVkIGxvbmcgX19hdHRyaWJ1dGVfXygoX193YXJuX3VudXNlZF9yZXN1bHRfXykpCmNvcHlf
dG9fdXNlcl9tY3NhZmUodm9pZCAqdG8sIGNvbnN0IHZvaWQgKmZyb20sIHVuc2lnbmVkIGxv
bmcgbikKewogaWYgKF9fYnVpbHRpbl9leHBlY3QoISEoY2hlY2tfY29weV9zaXplKGZyb20s
IG4sIHRydWUpKSwgMSkpIHsKICBpZiAoKCh2b2lkKTAsICgoKCggdW5zaWduZWQgbG9uZyko
dG8pKSA8PSAoKGdldF9jdXJyZW50KCktPnRocmVhZC5hZGRyX2xpbWl0KSkuc2VnKSAmJiAo
KChuKSkgPD0gKChnZXRfY3VycmVudCgpLT50aHJlYWQuYWRkcl9saW1pdCkpLnNlZykpKSkg
ewogICBhbGxvd193cml0ZV90b191c2VyKHRvLCBuKTsKICAgbiA9IG1lbWNweV9tY3NhZmUo
KHZvaWQgKil0bywgZnJvbSwgbik7CiAgIHByZXZlbnRfd3JpdGVfdG9fdXNlcih0bywgbik7
CiAgfQogfQoKIHJldHVybiBuOwp9Cgp1bnNpZ25lZCBsb25nIF9fYXJjaF9jbGVhcl91c2Vy
KHZvaWQgKmFkZHIsIHVuc2lnbmVkIGxvbmcgc2l6ZSk7CgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQg
bG9uZyBjbGVhcl91c2VyKHZvaWQgKmFkZHIsIHVuc2lnbmVkIGxvbmcgc2l6ZSkKewogdW5z
aWduZWQgbG9uZyByZXQgPSBzaXplOwogbWlnaHRfZmF1bHQoKTsKIGlmIChfX2J1aWx0aW5f
ZXhwZWN0KCEhKCgodm9pZCkwLCAoKCgoIHVuc2lnbmVkIGxvbmcpKGFkZHIpKSA8PSAoKGdl
dF9jdXJyZW50KCktPnRocmVhZC5hZGRyX2xpbWl0KSkuc2VnKSAmJiAoKChzaXplKSkgPD0g
KChnZXRfY3VycmVudCgpLT50aHJlYWQuYWRkcl9saW1pdCkpLnNlZykpKSksIDEpKSB7CiAg
YWxsb3dfd3JpdGVfdG9fdXNlcihhZGRyLCBzaXplKTsKICByZXQgPSBfX2FyY2hfY2xlYXJf
dXNlcihhZGRyLCBzaXplKTsKICBwcmV2ZW50X3dyaXRlX3RvX3VzZXIoYWRkciwgc2l6ZSk7
CiB9CiByZXR1cm4gcmV0Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgbG9uZyBfX2NsZWFyX3Vz
ZXIodm9pZCAqYWRkciwgdW5zaWduZWQgbG9uZyBzaXplKQp7CiByZXR1cm4gY2xlYXJfdXNl
cihhZGRyLCBzaXplKTsKfQoKZXh0ZXJuIGxvbmcgc3RybmNweV9mcm9tX3VzZXIoY2hhciAq
ZHN0LCBjb25zdCBjaGFyICpzcmMsIGxvbmcgY291bnQpOwpleHRlcm4gX19hdHRyaWJ1dGVf
XygoX193YXJuX3VudXNlZF9yZXN1bHRfXykpIGxvbmcgc3Rybmxlbl91c2VyKGNvbnN0IGNo
YXIgKnN0ciwgbG9uZyBuKTsKCmV4dGVybiBsb25nIF9fY29weV9mcm9tX3VzZXJfZmx1c2hj
YWNoZSh2b2lkICpkc3QsIGNvbnN0IHZvaWQgKnNyYywKICB1bnNpZ25lZCBzaXplKTsKZXh0
ZXJuIHZvaWQgbWVtY3B5X3BhZ2VfZmx1c2hjYWNoZShjaGFyICp0bywgc3RydWN0IHBhZ2Ug
KnBhZ2UsIHNpemVfdCBvZmZzZXQsCiAgICAgIHNpemVfdCBsZW4pOwoKc3RhdGljIF9fYXR0
cmlidXRlX18oKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKSBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIHVzZXJfYWNjZXNz
X2JlZ2luKGNvbnN0IHZvaWQgKnB0ciwgc2l6ZV90IGxlbikKewogaWYgKF9fYnVpbHRpbl9l
eHBlY3QoISEoISgodm9pZCkwLCAoKCgoIHVuc2lnbmVkIGxvbmcpKHB0cikpIDw9ICgoZ2V0
X2N1cnJlbnQoKS0+dGhyZWFkLmFkZHJfbGltaXQpKS5zZWcpICYmICgoKGxlbikpIDw9ICgo
Z2V0X2N1cnJlbnQoKS0+dGhyZWFkLmFkZHJfbGltaXQpKS5zZWcpKSkpLCAwKSkKICByZXR1
cm4gZmFsc2U7CiBhbGxvd19yZWFkX3dyaXRlX3VzZXIoKHZvaWQgKilwdHIsIHB0ciwgbGVu
KTsKIHJldHVybiB0cnVlOwp9CgoKCgoKc3RhdGljIF9fYXR0cmlidXRlX18oKF9fd2Fybl91
bnVzZWRfcmVzdWx0X18pKSBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKQoKIyA1ODAgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNt
L3VhY2Nlc3MuaCIKICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9vbAp1c2VyX3JlYWRf
YWNjZXNzX2JlZ2luKGNvbnN0IHZvaWQgKnB0ciwgc2l6ZV90IGxlbikKewogaWYgKF9fYnVp
bHRpbl9leHBlY3QoISEoISgodm9pZCkwLCAoKCgoIHVuc2lnbmVkIGxvbmcpKHB0cikpIDw9
ICgoZ2V0X2N1cnJlbnQoKS0+dGhyZWFkLmFkZHJfbGltaXQpKS5zZWcpICYmICgoKGxlbikp
IDw9ICgoZ2V0X2N1cnJlbnQoKS0+dGhyZWFkLmFkZHJfbGltaXQpKS5zZWcpKSkpLCAwKSkK
ICByZXR1cm4gZmFsc2U7CiBhbGxvd19yZWFkX2Zyb21fdXNlcihwdHIsIGxlbik7CiByZXR1
cm4gdHJ1ZTsKfQoKCgpzdGF0aWMgX19hdHRyaWJ1dGVfXygoX193YXJuX3VudXNlZF9yZXN1
bHRfXykpIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpCgojIDU5MSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vdWFjY2Vzcy5o
IgogICAgICAgICAgICAgICAgICAgICAgICAgICBib29sCnVzZXJfd3JpdGVfYWNjZXNzX2Jl
Z2luKGNvbnN0IHZvaWQgKnB0ciwgc2l6ZV90IGxlbikKewogaWYgKF9fYnVpbHRpbl9leHBl
Y3QoISEoISgodm9pZCkwLCAoKCgoIHVuc2lnbmVkIGxvbmcpKHB0cikpIDw9ICgoZ2V0X2N1
cnJlbnQoKS0+dGhyZWFkLmFkZHJfbGltaXQpKS5zZWcpICYmICgoKGxlbikpIDw9ICgoZ2V0
X2N1cnJlbnQoKS0+dGhyZWFkLmFkZHJfbGltaXQpKS5zZWcpKSkpLCAwKSkKICByZXR1cm4g
ZmFsc2U7CiBhbGxvd193cml0ZV90b191c2VyKCh2b2lkICopcHRyLCBsZW4pOwogcmV0dXJu
IHRydWU7Cn0KIyAxMiAiLi9pbmNsdWRlL2xpbnV4L3VhY2Nlc3MuaCIgMgojIDU4ICIuL2lu
Y2x1ZGUvbGludXgvdWFjY2Vzcy5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdh
eXNfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkg
dW5zaWduZWQgbG9uZwpfX2NvcHlfZnJvbV91c2VyX2luYXRvbWljKHZvaWQgKnRvLCBjb25z
dCB2b2lkICpmcm9tLCB1bnNpZ25lZCBsb25nIG4pCnsKIGluc3RydW1lbnRfY29weV9mcm9t
X3VzZXIodG8sIGZyb20sIG4pOwogY2hlY2tfb2JqZWN0X3NpemUodG8sIG4sIGZhbHNlKTsK
IHJldHVybiByYXdfY29weV9mcm9tX3VzZXIodG8sIGZyb20sIG4pOwp9CgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
X19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3dh
cm5fdW51c2VkX3Jlc3VsdF9fKSkgdW5zaWduZWQgbG9uZwpfX2NvcHlfZnJvbV91c2VyKHZv
aWQgKnRvLCBjb25zdCB2b2lkICpmcm9tLCB1bnNpZ25lZCBsb25nIG4pCnsKIG1pZ2h0X2Zh
dWx0KCk7CiBpbnN0cnVtZW50X2NvcHlfZnJvbV91c2VyKHRvLCBmcm9tLCBuKTsKIGNoZWNr
X29iamVjdF9zaXplKHRvLCBuLCBmYWxzZSk7CiByZXR1cm4gcmF3X2NvcHlfZnJvbV91c2Vy
KHRvLCBmcm9tLCBuKTsKfQojIDg4ICIuL2luY2x1ZGUvbGludXgvdWFjY2Vzcy5oIgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkgdW5zaWduZWQgbG9uZwpfX2NvcHlfdG9fdXNl
cl9pbmF0b21pYyh2b2lkICp0bywgY29uc3Qgdm9pZCAqZnJvbSwgdW5zaWduZWQgbG9uZyBu
KQp7CiBpbnN0cnVtZW50X2NvcHlfdG9fdXNlcih0bywgZnJvbSwgbik7CiBjaGVja19vYmpl
Y3Rfc2l6ZShmcm9tLCBuLCB0cnVlKTsKIHJldHVybiByYXdfY29weV90b191c2VyKHRvLCBm
cm9tLCBuKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX193YXJuX3VudXNlZF9yZXN1bHRfXykpIHVuc2lnbmVkIGxv
bmcKX19jb3B5X3RvX3VzZXIodm9pZCAqdG8sIGNvbnN0IHZvaWQgKmZyb20sIHVuc2lnbmVk
IGxvbmcgbikKewogbWlnaHRfZmF1bHQoKTsKIGluc3RydW1lbnRfY29weV90b191c2VyKHRv
LCBmcm9tLCBuKTsKIGNoZWNrX29iamVjdF9zaXplKGZyb20sIG4sIHRydWUpOwogcmV0dXJu
IHJhd19jb3B5X3RvX3VzZXIodG8sIGZyb20sIG4pOwp9CiMgMTIwICIuL2luY2x1ZGUvbGlu
dXgvdWFjY2Vzcy5oIgpleHRlcm4gX19hdHRyaWJ1dGVfXygoX193YXJuX3VudXNlZF9yZXN1
bHRfXykpIHVuc2lnbmVkIGxvbmcKX2NvcHlfZnJvbV91c2VyKHZvaWQgKiwgY29uc3Qgdm9p
ZCAqLCB1bnNpZ25lZCBsb25nKTsKIyAxMzYgIi4vaW5jbHVkZS9saW51eC91YWNjZXNzLmgi
CmV4dGVybiBfX2F0dHJpYnV0ZV9fKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkgdW5zaWdu
ZWQgbG9uZwpfY29weV90b191c2VyKHZvaWQgKiwgY29uc3Qgdm9pZCAqLCB1bnNpZ25lZCBs
b25nKTsKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB1
bnNpZ25lZCBsb25nIF9fYXR0cmlidXRlX18oKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKQpj
b3B5X2Zyb21fdXNlcih2b2lkICp0bywgY29uc3Qgdm9pZCAqZnJvbSwgdW5zaWduZWQgbG9u
ZyBuKQp7CiBpZiAoX19idWlsdGluX2V4cGVjdCghIShjaGVja19jb3B5X3NpemUodG8sIG4s
IGZhbHNlKSksIDEpKQogIG4gPSBfY29weV9mcm9tX3VzZXIodG8sIGZyb20sIG4pOwogcmV0
dXJuIG47Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykp
IHVuc2lnbmVkIGxvbmcgX19hdHRyaWJ1dGVfXygoX193YXJuX3VudXNlZF9yZXN1bHRfXykp
CmNvcHlfdG9fdXNlcih2b2lkICp0bywgY29uc3Qgdm9pZCAqZnJvbSwgdW5zaWduZWQgbG9u
ZyBuKQp7CiBpZiAoX19idWlsdGluX2V4cGVjdCghIShjaGVja19jb3B5X3NpemUoZnJvbSwg
biwgdHJ1ZSkpLCAxKSkKICBuID0gX2NvcHlfdG9fdXNlcih0bywgZnJvbSwgbik7CiByZXR1
cm4gbjsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkg
dW5zaWduZWQgbG9uZyBfX2F0dHJpYnV0ZV9fKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkK
Y29weV9pbl91c2VyKHZvaWQgKnRvLCBjb25zdCB2b2lkICpmcm9tLCB1bnNpZ25lZCBsb25n
IG4pCnsKIG1pZ2h0X2ZhdWx0KCk7CiBpZiAoKCh2b2lkKTAsICgoKCggdW5zaWduZWQgbG9u
ZykodG8pKSA8PSAoKGdldF9jdXJyZW50KCktPnRocmVhZC5hZGRyX2xpbWl0KSkuc2VnKSAm
JiAoKChuKSkgPD0gKChnZXRfY3VycmVudCgpLT50aHJlYWQuYWRkcl9saW1pdCkpLnNlZykp
KSAmJiAoKHZvaWQpMCwgKCgoKCB1bnNpZ25lZCBsb25nKShmcm9tKSkgPD0gKChnZXRfY3Vy
cmVudCgpLT50aHJlYWQuYWRkcl9saW1pdCkpLnNlZykgJiYgKCgobikpIDw9ICgoZ2V0X2N1
cnJlbnQoKS0+dGhyZWFkLmFkZHJfbGltaXQpKS5zZWcpKSkpCiAgbiA9IHJhd19jb3B5X2lu
X3VzZXIodG8sIGZyb20sIG4pOwogcmV0dXJuIG47Cn0KCgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1
dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB2b2lkIHBhZ2VmYXVsdF9kaXNhYmxlZF9pbmMo
dm9pZCkKewogZ2V0X2N1cnJlbnQoKS0+cGFnZWZhdWx0X2Rpc2FibGVkKys7Cn0KCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHZvaWQgcGFnZWZhdWx0
X2Rpc2FibGVkX2RlYyh2b2lkKQp7CiBnZXRfY3VycmVudCgpLT5wYWdlZmF1bHRfZGlzYWJs
ZWQtLTsKfQojIDE4MyAiLi9pbmNsdWRlL2xpbnV4L3VhY2Nlc3MuaCIKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZv
aWQgcGFnZWZhdWx0X2Rpc2FibGUodm9pZCkKewogcGFnZWZhdWx0X2Rpc2FibGVkX2luYygp
OwoKCgoKIF9fYXNtX18gX192b2xhdGlsZV9fKCIiOiA6IDoibWVtb3J5Iik7Cn0KCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSB2b2lkIHBhZ2VmYXVsdF9lbmFibGUodm9pZCkKewoKCgoKIF9fYXNtX18gX192b2xh
dGlsZV9fKCIiOiA6IDoibWVtb3J5Iik7CiBwYWdlZmF1bHRfZGlzYWJsZWRfZGVjKCk7Cn0K
CgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSBib29sIHBhZ2VmYXVsdF9kaXNhYmxlZCh2b2lkKQp7CiByZXR1cm4g
Z2V0X2N1cnJlbnQoKS0+cGFnZWZhdWx0X2Rpc2FibGVkICE9IDA7Cn0KIyAyMjUgIi4vaW5j
bHVkZS9saW51eC91YWNjZXNzLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX3dhcm5f
dW51c2VkX3Jlc3VsdF9fKSkgdW5zaWduZWQgbG9uZwpfX2NvcHlfZnJvbV91c2VyX2luYXRv
bWljX25vY2FjaGUodm9pZCAqdG8sIGNvbnN0IHZvaWQgKmZyb20sCiAgICAgIHVuc2lnbmVk
IGxvbmcgbikKewogcmV0dXJuIF9fY29weV9mcm9tX3VzZXJfaW5hdG9taWModG8sIGZyb20s
IG4pOwp9CgoKCmV4dGVybiBfX2F0dHJpYnV0ZV9fKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9f
KSkgaW50IGNoZWNrX3plcm9lZF91c2VyKGNvbnN0IHZvaWQgKmZyb20sIHNpemVfdCBzaXpl
KTsKIyAyODMgIi4vaW5jbHVkZS9saW51eC91YWNjZXNzLmgiCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJp
YnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fd2Fybl91bnVz
ZWRfcmVzdWx0X18pKSBpbnQKY29weV9zdHJ1Y3RfZnJvbV91c2VyKHZvaWQgKmRzdCwgc2l6
ZV90IGtzaXplLCBjb25zdCB2b2lkICpzcmMsCiAgICAgICAgc2l6ZV90IHVzaXplKQp7CiBz
aXplX3Qgc2l6ZSA9IF9fYnVpbHRpbl9jaG9vc2VfZXhwcigoKCEhKHNpemVvZigodHlwZW9m
KGtzaXplKSAqKTEgPT0gKHR5cGVvZih1c2l6ZSkgKikxKSkpICYmICgoc2l6ZW9mKGludCkg
PT0gc2l6ZW9mKCooOCA/ICgodm9pZCAqKSgobG9uZykoa3NpemUpICogMGwpKSA6IChpbnQg
Kik4KSkpICYmIChzaXplb2YoaW50KSA9PSBzaXplb2YoKig4ID8gKCh2b2lkICopKChsb25n
KSh1c2l6ZSkgKiAwbCkpIDogKGludCAqKTgpKSkpKSwgKChrc2l6ZSkgPCAodXNpemUpID8g
KGtzaXplKSA6ICh1c2l6ZSkpLCAoeyB0eXBlb2Yoa3NpemUpIF9fVU5JUVVFX0lEX19feDE1
MSA9IChrc2l6ZSk7IHR5cGVvZih1c2l6ZSkgX19VTklRVUVfSURfX195MTUyID0gKHVzaXpl
KTsgKChfX1VOSVFVRV9JRF9fX3gxNTEpIDwgKF9fVU5JUVVFX0lEX19feTE1MikgPyAoX19V
TklRVUVfSURfX194MTUxKSA6IChfX1VOSVFVRV9JRF9fX3kxNTIpKTsgfSkpOwogc2l6ZV90
IHJlc3QgPSBfX2J1aWx0aW5fY2hvb3NlX2V4cHIoKCghIShzaXplb2YoKHR5cGVvZihrc2l6
ZSkgKikxID09ICh0eXBlb2YodXNpemUpICopMSkpKSAmJiAoKHNpemVvZihpbnQpID09IHNp
emVvZigqKDggPyAoKHZvaWQgKikoKGxvbmcpKGtzaXplKSAqIDBsKSkgOiAoaW50ICopOCkp
KSAmJiAoc2l6ZW9mKGludCkgPT0gc2l6ZW9mKCooOCA/ICgodm9pZCAqKSgobG9uZykodXNp
emUpICogMGwpKSA6IChpbnQgKik4KSkpKSksICgoa3NpemUpID4gKHVzaXplKSA/IChrc2l6
ZSkgOiAodXNpemUpKSwgKHsgdHlwZW9mKGtzaXplKSBfX1VOSVFVRV9JRF9fX3gxNTMgPSAo
a3NpemUpOyB0eXBlb2YodXNpemUpIF9fVU5JUVVFX0lEX19feTE1NCA9ICh1c2l6ZSk7ICgo
X19VTklRVUVfSURfX194MTUzKSA+IChfX1VOSVFVRV9JRF9fX3kxNTQpID8gKF9fVU5JUVVF
X0lEX19feDE1MykgOiAoX19VTklRVUVfSURfX195MTU0KSk7IH0pKSAtIHNpemU7CgoKIGlm
ICh1c2l6ZSA8IGtzaXplKSB7CiAgbWVtc2V0KGRzdCArIHNpemUsIDAsIHJlc3QpOwogfSBl
bHNlIGlmICh1c2l6ZSA+IGtzaXplKSB7CiAgaW50IHJldCA9IGNoZWNrX3plcm9lZF91c2Vy
KHNyYyArIHNpemUsIHJlc3QpOwogIGlmIChyZXQgPD0gMCkKICAgcmV0dXJuIHJldCA/OiAt
NzsKIH0KCiBpZiAoY29weV9mcm9tX3VzZXIoZHN0LCBzcmMsIHNpemUpKQogIHJldHVybiAt
MTQ7CiByZXR1cm4gMDsKfQoKYm9vbCBjb3B5X2Zyb21fa2VybmVsX25vZmF1bHRfYWxsb3dl
ZChjb25zdCB2b2lkICp1bnNhZmVfc3JjLCBzaXplX3Qgc2l6ZSk7Cgpsb25nIGNvcHlfZnJv
bV9rZXJuZWxfbm9mYXVsdCh2b2lkICpkc3QsIGNvbnN0IHZvaWQgKnNyYywgc2l6ZV90IHNp
emUpOwpsb25nIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
Y29weV90b19rZXJuZWxfbm9mYXVsdCh2b2lkICpkc3QsIGNvbnN0IHZvaWQgKnNyYywgc2l6
ZV90IHNpemUpOwoKbG9uZyBjb3B5X2Zyb21fdXNlcl9ub2ZhdWx0KHZvaWQgKmRzdCwgY29u
c3Qgdm9pZCAqc3JjLCBzaXplX3Qgc2l6ZSk7CmxvbmcgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSBjb3B5X3RvX3VzZXJfbm9mYXVsdCh2b2lkICpkc3Qs
IGNvbnN0IHZvaWQgKnNyYywKICBzaXplX3Qgc2l6ZSk7Cgpsb25nIHN0cm5jcHlfZnJvbV9r
ZXJuZWxfbm9mYXVsdChjaGFyICpkc3QsIGNvbnN0IHZvaWQgKnVuc2FmZV9hZGRyLAogIGxv
bmcgY291bnQpOwoKbG9uZyBzdHJuY3B5X2Zyb21fdXNlcl9ub2ZhdWx0KGNoYXIgKmRzdCwg
Y29uc3Qgdm9pZCAqdW5zYWZlX2FkZHIsCiAgbG9uZyBjb3VudCk7Cmxvbmcgc3Rybmxlbl91
c2VyX25vZmF1bHQoY29uc3Qgdm9pZCAqdW5zYWZlX2FkZHIsIGxvbmcgY291bnQpOwojIDEy
ICIuL2luY2x1ZGUvbGludXgvc2NoZWQvdGFzay5oIiAyCgpzdHJ1Y3QgdGFza19zdHJ1Y3Q7
CnN0cnVjdCBydXNhZ2U7CnVuaW9uIHRocmVhZF91bmlvbjsKc3RydWN0IGNzc19zZXQ7CgoK
CgpzdHJ1Y3Qga2VybmVsX2Nsb25lX2FyZ3MgewogdTY0IGZsYWdzOwogaW50ICpwaWRmZDsK
IGludCAqY2hpbGRfdGlkOwogaW50ICpwYXJlbnRfdGlkOwogaW50IGV4aXRfc2lnbmFsOwog
dW5zaWduZWQgbG9uZyBzdGFjazsKIHVuc2lnbmVkIGxvbmcgc3RhY2tfc2l6ZTsKIHVuc2ln
bmVkIGxvbmcgdGxzOwogcGlkX3QgKnNldF90aWQ7Cgogc2l6ZV90IHNldF90aWRfc2l6ZTsK
IGludCBjZ3JvdXA7CiBzdHJ1Y3QgY2dyb3VwICpjZ3JwOwogc3RydWN0IGNzc19zZXQgKmNz
ZXQ7Cn07CgoKCgoKCgpleHRlcm4gcndsb2NrX3QgdGFza2xpc3RfbG9jazsKZXh0ZXJuIHNw
aW5sb2NrX3QgbW1saXN0X2xvY2s7CgpleHRlcm4gdW5pb24gdGhyZWFkX3VuaW9uIGluaXRf
dGhyZWFkX3VuaW9uOwpleHRlcm4gc3RydWN0IHRhc2tfc3RydWN0IGluaXRfdGFzazsKCgoK
CgpleHRlcm4gdm9pZCBzY2hlZHVsZV90YWlsKHN0cnVjdCB0YXNrX3N0cnVjdCAqcHJldik7
CmV4dGVybiB2b2lkIGluaXRfaWRsZShzdHJ1Y3QgdGFza19zdHJ1Y3QgKmlkbGUsIGludCBj
cHUpOwoKZXh0ZXJuIGludCBzY2hlZF9mb3JrKHVuc2lnbmVkIGxvbmcgY2xvbmVfZmxhZ3Ms
IHN0cnVjdCB0YXNrX3N0cnVjdCAqcCk7CmV4dGVybiB2b2lkIHNjaGVkX2RlYWQoc3RydWN0
IHRhc2tfc3RydWN0ICpwKTsKCnZvaWQgX19hdHRyaWJ1dGVfXygoX19ub3JldHVybl9fKSkg
ZG9fdGFza19kZWFkKHZvaWQpOwoKZXh0ZXJuIHZvaWQgcHJvY19jYWNoZXNfaW5pdCh2b2lk
KTsKCmV4dGVybiB2b2lkIGZvcmtfaW5pdCh2b2lkKTsKCmV4dGVybiB2b2lkIHJlbGVhc2Vf
dGFzayhzdHJ1Y3QgdGFza19zdHJ1Y3QgKiBwKTsKCgpleHRlcm4gaW50IGNvcHlfdGhyZWFk
X3Rscyh1bnNpZ25lZCBsb25nLCB1bnNpZ25lZCBsb25nLCB1bnNpZ25lZCBsb25nLAogICBz
dHJ1Y3QgdGFza19zdHJ1Y3QgKiwgdW5zaWduZWQgbG9uZyk7CiMgODQgIi4vaW5jbHVkZS9s
aW51eC9zY2hlZC90YXNrLmgiCmV4dGVybiB2b2lkIGZsdXNoX3RocmVhZCh2b2lkKTsKCgoK
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSB2b2lkIGV4aXRfdGhyZWFkKHN0cnVjdCB0YXNrX3N0cnVjdCAqdHNrKQp7
Cn0KCmV4dGVybiB2b2lkIGRvX2dyb3VwX2V4aXQoaW50KTsKCmV4dGVybiB2b2lkIGV4aXRf
ZmlsZXMoc3RydWN0IHRhc2tfc3RydWN0ICopOwpleHRlcm4gdm9pZCBleGl0X2l0aW1lcnMo
c3RydWN0IHNpZ25hbF9zdHJ1Y3QgKik7CgpleHRlcm4gbG9uZyBfZG9fZm9yayhzdHJ1Y3Qg
a2VybmVsX2Nsb25lX2FyZ3MgKmthcmdzKTsKZXh0ZXJuIGJvb2wgbGVnYWN5X2Nsb25lX2Fy
Z3NfdmFsaWQoY29uc3Qgc3RydWN0IGtlcm5lbF9jbG9uZV9hcmdzICprYXJncyk7CmV4dGVy
biBsb25nIGRvX2ZvcmsodW5zaWduZWQgbG9uZywgdW5zaWduZWQgbG9uZywgdW5zaWduZWQg
bG9uZywgaW50ICosIGludCAqKTsKc3RydWN0IHRhc2tfc3RydWN0ICpmb3JrX2lkbGUoaW50
KTsKc3RydWN0IG1tX3N0cnVjdCAqY29weV9pbml0X21tKHZvaWQpOwpleHRlcm4gcGlkX3Qg
a2VybmVsX3RocmVhZChpbnQgKCpmbikodm9pZCAqKSwgdm9pZCAqYXJnLCB1bnNpZ25lZCBs
b25nIGZsYWdzKTsKZXh0ZXJuIGxvbmcga2VybmVsX3dhaXQ0KHBpZF90LCBpbnQgKiwgaW50
LCBzdHJ1Y3QgcnVzYWdlICopOwoKZXh0ZXJuIHZvaWQgZnJlZV90YXNrKHN0cnVjdCB0YXNr
X3N0cnVjdCAqdHNrKTsKCgoKZXh0ZXJuIHZvaWQgc2NoZWRfZXhlYyh2b2lkKTsKCgoKCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSBzdHJ1Y3QgdGFza19zdHJ1Y3QgKmdldF90YXNrX3N0cnVjdChzdHJ1Y3QgdGFz
a19zdHJ1Y3QgKnQpCnsKIHJlZmNvdW50X2luYygmdC0+dXNhZ2UpOwogcmV0dXJuIHQ7Cn0K
CmV4dGVybiB2b2lkIF9fcHV0X3Rhc2tfc3RydWN0KHN0cnVjdCB0YXNrX3N0cnVjdCAqdCk7
CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgdm9pZCBwdXRfdGFza19zdHJ1Y3Qoc3RydWN0IHRhc2tfc3RydWN0ICp0
KQp7CiBpZiAocmVmY291bnRfZGVjX2FuZF90ZXN0KCZ0LT51c2FnZSkpCiAgX19wdXRfdGFz
a19zdHJ1Y3QodCk7Cn0KCnZvaWQgcHV0X3Rhc2tfc3RydWN0X3JjdV91c2VyKHN0cnVjdCB0
YXNrX3N0cnVjdCAqdGFzayk7CiMgMTQyICIuL2luY2x1ZGUvbGludXgvc2NoZWQvdGFzay5o
IgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgdm9pZCBhcmNoX3RocmVhZF9zdHJ1Y3Rfd2hpdGVsaXN0KHVuc2lnbmVk
IGxvbmcgKm9mZnNldCwKICAgICAgdW5zaWduZWQgbG9uZyAqc2l6ZSkKewogKm9mZnNldCA9
IDA7CgogKnNpemUgPSAoc2l6ZW9mKHN0cnVjdCB0YXNrX3N0cnVjdCkpIC0gX19idWlsdGlu
X29mZnNldG9mKHN0cnVjdCB0YXNrX3N0cnVjdCwgdGhyZWFkKTsKfQojIDE1NyAiLi9pbmNs
dWRlL2xpbnV4L3NjaGVkL3Rhc2suaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHN0cnVjdCB2bV9zdHJ1Y3QgKnRh
c2tfc3RhY2tfdm1fYXJlYShjb25zdCBzdHJ1Y3QgdGFza19zdHJ1Y3QgKnQpCnsKIHJldHVy
biAoKHZvaWQgKikwKTsKfQojIDE3MyAiLi9pbmNsdWRlL2xpbnV4L3NjaGVkL3Rhc2suaCIK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIHZvaWQgdGFza19sb2NrKHN0cnVjdCB0YXNrX3N0cnVjdCAqcCkKewogc3Bp
bl9sb2NrKCZwLT5hbGxvY19sb2NrKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgdGFza191bmxvY2so
c3RydWN0IHRhc2tfc3RydWN0ICpwKQp7CiBzcGluX3VubG9jaygmcC0+YWxsb2NfbG9jayk7
Cn0KIyAxMCAiLi9pbmNsdWRlL2xpbnV4L3NjaGVkL3NpZ25hbC5oIiAyCiMgMSAiLi9pbmNs
dWRlL2xpbnV4L2NyZWQuaCIgMQojIDEzICIuL2luY2x1ZGUvbGludXgvY3JlZC5oIgojIDEg
Ii4vaW5jbHVkZS9saW51eC9rZXkuaCIgMQojIDE3ICIuL2luY2x1ZGUvbGludXgva2V5Lmgi
CiMgMSAiLi9pbmNsdWRlL2xpbnV4L3N5c2N0bC5oIiAxCiMgMzAgIi4vaW5jbHVkZS9saW51
eC9zeXNjdGwuaCIKIyAxICIuL2luY2x1ZGUvdWFwaS9saW51eC9zeXNjdGwuaCIgMQojIDM1
ICIuL2luY2x1ZGUvdWFwaS9saW51eC9zeXNjdGwuaCIKc3RydWN0IF9fc3lzY3RsX2FyZ3Mg
ewogaW50ICpuYW1lOwogaW50IG5sZW47CiB2b2lkICpvbGR2YWw7CiBzaXplX3QgKm9sZGxl
bnA7CiB2b2lkICpuZXd2YWw7CiBzaXplX3QgbmV3bGVuOwogdW5zaWduZWQgbG9uZyBfX3Vu
dXNlZFs0XTsKfTsKCgoKCgplbnVtCnsKIENUTF9LRVJOPTEsCiBDVExfVk09MiwKIENUTF9O
RVQ9MywKIENUTF9QUk9DPTQsCiBDVExfRlM9NSwKIENUTF9ERUJVRz02LAogQ1RMX0RFVj03
LAogQ1RMX0JVUz04LAogQ1RMX0FCST05LAogQ1RMX0NQVT0xMCwKIENUTF9BUkxBTj0yNTQs
CiBDVExfUzM5MERCRj01Njc3LAogQ1RMX1NVTlJQQz03MjQ5LAogQ1RMX1BNPTk4OTksCiBD
VExfRlJWPTk4OTgsCn07CgoKZW51bQp7CiBDVExfQlVTX0lTQT0xCn07CgoKZW51bQp7CiBJ
Tk9USUZZX01BWF9VU0VSX0lOU1RBTkNFUz0xLAogSU5PVElGWV9NQVhfVVNFUl9XQVRDSEVT
PTIsCiBJTk9USUZZX01BWF9RVUVVRURfRVZFTlRTPTMKfTsKCgplbnVtCnsKIEtFUk5fT1NU
WVBFPTEsCiBLRVJOX09TUkVMRUFTRT0yLAogS0VSTl9PU1JFVj0zLAogS0VSTl9WRVJTSU9O
PTQsCiBLRVJOX1NFQ1VSRU1BU0s9NSwKIEtFUk5fUFJPRj02LAogS0VSTl9OT0RFTkFNRT03
LAogS0VSTl9ET01BSU5OQU1FPTgsCgogS0VSTl9QQU5JQz0xNSwKIEtFUk5fUkVBTFJPT1RE
RVY9MTYsCgogS0VSTl9TUEFSQ19SRUJPT1Q9MjEsCiBLRVJOX0NUTEFMVERFTD0yMiwKIEtF
Uk5fUFJJTlRLPTIzLAogS0VSTl9OQU1FVFJBTlM9MjQsCiBLRVJOX1BQQ19IVEFCUkVDTEFJ
TT0yNSwKIEtFUk5fUFBDX1pFUk9QQUdFRD0yNiwKIEtFUk5fUFBDX1BPV0VSU0FWRV9OQVA9
MjcsCiBLRVJOX01PRFBST0JFPTI4LAogS0VSTl9TR19CSUdfQlVGRj0yOSwKIEtFUk5fQUND
VD0zMCwKIEtFUk5fUFBDX0wyQ1I9MzEsCgogS0VSTl9SVFNJR05SPTMyLAogS0VSTl9SVFNJ
R01BWD0zMywKCiBLRVJOX1NITU1BWD0zNCwKIEtFUk5fTVNHTUFYPTM1LAogS0VSTl9NU0dN
TkI9MzYsCiBLRVJOX01TR1BPT0w9MzcsCiBLRVJOX1NZU1JRPTM4LAogS0VSTl9NQVhfVEhS
RUFEUz0zOSwKICBLRVJOX1JBTkRPTT00MCwKICBLRVJOX1NITUFMTD00MSwKICBLRVJOX01T
R01OST00MiwKICBLRVJOX1NFTT00MywKICBLRVJOX1NQQVJDX1NUT1BfQT00NCwKICBLRVJO
X1NITU1OST00NSwKIEtFUk5fT1ZFUkZMT1dVSUQ9NDYsCiBLRVJOX09WRVJGTE9XR0lEPTQ3
LAogS0VSTl9TSE1QQVRIPTQ4LAogS0VSTl9IT1RQTFVHPTQ5LAogS0VSTl9JRUVFX0VNVUxB
VElPTl9XQVJOSU5HUz01MCwKIEtFUk5fUzM5MF9VU0VSX0RFQlVHX0xPR0dJTkc9NTEsCiBL
RVJOX0NPUkVfVVNFU19QSUQ9NTIsCiBLRVJOX1RBSU5URUQ9NTMsCiBLRVJOX0NBRFBJRD01
NCwKIEtFUk5fUElETUFYPTU1LAogICBLRVJOX0NPUkVfUEFUVEVSTj01NiwKIEtFUk5fUEFO
SUNfT05fT09QUz01NywKIEtFUk5fSFBQQV9QV1JTVz01OCwKIEtFUk5fSFBQQV9VTkFMSUdO
RUQ9NTksCiBLRVJOX1BSSU5US19SQVRFTElNSVQ9NjAsCiBLRVJOX1BSSU5US19SQVRFTElN
SVRfQlVSU1Q9NjEsCiBLRVJOX1BUWT02MiwKIEtFUk5fTkdST1VQU19NQVg9NjMsCiBLRVJO
X1NQQVJDX1NDT05TX1BXUk9GRj02NCwKIEtFUk5fSFpfVElNRVI9NjUsCiBLRVJOX1VOS05P
V05fTk1JX1BBTklDPTY2LAogS0VSTl9CT09UTE9BREVSX1RZUEU9NjcsCiBLRVJOX1JBTkRP
TUlaRT02OCwKIEtFUk5fU0VUVUlEX0RVTVBBQkxFPTY5LAogS0VSTl9TUElOX1JFVFJZPTcw
LAogS0VSTl9BQ1BJX1ZJREVPX0ZMQUdTPTcxLAogS0VSTl9JQTY0X1VOQUxJR05FRD03MiwK
IEtFUk5fQ09NUEFUX0xPRz03MywKIEtFUk5fTUFYX0xPQ0tfREVQVEg9NzQsCiBLRVJOX05N
SV9XQVRDSERPRz03NSwKIEtFUk5fUEFOSUNfT05fTk1JPTc2LAogS0VSTl9QQU5JQ19PTl9X
QVJOPTc3LAogS0VSTl9QQU5JQ19QUklOVD03OCwKfTsKCgoKCmVudW0KewogVk1fVU5VU0VE
MT0xLAogVk1fVU5VU0VEMj0yLAogVk1fVU5VU0VEMz0zLAogVk1fVU5VU0VEND00LAogVk1f
T1ZFUkNPTU1JVF9NRU1PUlk9NSwKIFZNX1VOVVNFRDU9NiwKIFZNX1VOVVNFRDc9NywKIFZN
X1VOVVNFRDg9OCwKIFZNX1VOVVNFRDk9OSwKIFZNX1BBR0VfQ0xVU1RFUj0xMCwKIFZNX0RJ
UlRZX0JBQ0tHUk9VTkQ9MTEsCiBWTV9ESVJUWV9SQVRJTz0xMiwKIFZNX0RJUlRZX1dCX0NT
PTEzLAogVk1fRElSVFlfRVhQSVJFX0NTPTE0LAogVk1fTlJfUERGTFVTSF9USFJFQURTPTE1
LAogVk1fT1ZFUkNPTU1JVF9SQVRJTz0xNiwKIFZNX1BBR0VCVUY9MTcsCiBWTV9IVUdFVExC
X1BBR0VTPTE4LAogVk1fU1dBUFBJTkVTUz0xOSwKIFZNX0xPV01FTV9SRVNFUlZFX1JBVElP
PTIwLAogVk1fTUlOX0ZSRUVfS0JZVEVTPTIxLAogVk1fTUFYX01BUF9DT1VOVD0yMiwKIFZN
X0xBUFRPUF9NT0RFPTIzLAogVk1fQkxPQ0tfRFVNUD0yNCwKIFZNX0hVR0VUTEJfR1JPVVA9
MjUsCiBWTV9WRlNfQ0FDSEVfUFJFU1NVUkU9MjYsCiBWTV9MRUdBQ1lfVkFfTEFZT1VUPTI3
LAogVk1fU1dBUF9UT0tFTl9USU1FT1VUPTI4LAogVk1fRFJPUF9QQUdFQ0FDSEU9MjksCiBW
TV9QRVJDUFVfUEFHRUxJU1RfRlJBQ1RJT049MzAsCiBWTV9aT05FX1JFQ0xBSU1fTU9ERT0z
MSwKIFZNX01JTl9VTk1BUFBFRD0zMiwKIFZNX1BBTklDX09OX09PTT0zMywKIFZNX1ZEU09f
RU5BQkxFRD0zNCwKIFZNX01JTl9TTEFCPTM1LAp9OwoKCgplbnVtCnsKIE5FVF9DT1JFPTEs
CiBORVRfRVRIRVI9MiwKIE5FVF84MDI9MywKIE5FVF9VTklYPTQsCiBORVRfSVBWND01LAog
TkVUX0lQWD02LAogTkVUX0FUQUxLPTcsCiBORVRfTkVUUk9NPTgsCiBORVRfQVgyNT05LAog
TkVUX0JSSURHRT0xMCwKIE5FVF9ST1NFPTExLAogTkVUX0lQVjY9MTIsCiBORVRfWDI1PTEz
LAogTkVUX1RSPTE0LAogTkVUX0RFQ05FVD0xNSwKIE5FVF9FQ09ORVQ9MTYsCiBORVRfU0NU
UD0xNywKIE5FVF9MTEM9MTgsCiBORVRfTkVURklMVEVSPTE5LAogTkVUX0RDQ1A9MjAsCiBO
RVRfSVJEQT00MTIsCn07CgoKZW51bQp7CiBSQU5ET01fUE9PTFNJWkU9MSwKIFJBTkRPTV9F
TlRST1BZX0NPVU5UPTIsCiBSQU5ET01fUkVBRF9USFJFU0g9MywKIFJBTkRPTV9XUklURV9U
SFJFU0g9NCwKIFJBTkRPTV9CT09UX0lEPTUsCiBSQU5ET01fVVVJRD02Cn07CgoKZW51bQp7
CiBQVFlfTUFYPTEsCiBQVFlfTlI9Mgp9OwoKCmVudW0KewogQlVTX0lTQV9NRU1fQkFTRT0x
LAogQlVTX0lTQV9QT1JUX0JBU0U9MiwKIEJVU19JU0FfUE9SVF9TSElGVD0zCn07CgoKZW51
bQp7CiBORVRfQ09SRV9XTUVNX01BWD0xLAogTkVUX0NPUkVfUk1FTV9NQVg9MiwKIE5FVF9D
T1JFX1dNRU1fREVGQVVMVD0zLAogTkVUX0NPUkVfUk1FTV9ERUZBVUxUPTQsCgogTkVUX0NP
UkVfTUFYX0JBQ0tMT0c9NiwKIE5FVF9DT1JFX0ZBU1RST1VURT03LAogTkVUX0NPUkVfTVNH
X0NPU1Q9OCwKIE5FVF9DT1JFX01TR19CVVJTVD05LAogTkVUX0NPUkVfT1BUTUVNX01BWD0x
MCwKIE5FVF9DT1JFX0hPVF9MSVNUX0xFTkdUSD0xMSwKIE5FVF9DT1JFX0RJVkVSVF9WRVJT
SU9OPTEyLAogTkVUX0NPUkVfTk9fQ09OR19USFJFU0g9MTMsCiBORVRfQ09SRV9OT19DT05H
PTE0LAogTkVUX0NPUkVfTE9fQ09ORz0xNSwKIE5FVF9DT1JFX01PRF9DT05HPTE2LAogTkVU
X0NPUkVfREVWX1dFSUdIVD0xNywKIE5FVF9DT1JFX1NPTUFYQ09OTj0xOCwKIE5FVF9DT1JF
X0JVREdFVD0xOSwKIE5FVF9DT1JFX0FFVkVOVF9FVElNRT0yMCwKIE5FVF9DT1JFX0FFVkVO
VF9SU0VRVEg9MjEsCiBORVRfQ09SRV9XQVJOSU5HUz0yMiwKfTsKCgoKCgoKCmVudW0Kewog
TkVUX1VOSVhfREVTVFJPWV9ERUxBWT0xLAogTkVUX1VOSVhfREVMRVRFX0RFTEFZPTIsCiBO
RVRfVU5JWF9NQVhfREdSQU1fUUxFTj0zLAp9OwoKCmVudW0KewogTkVUX05GX0NPTk5UUkFD
S19NQVg9MSwKIE5FVF9ORl9DT05OVFJBQ0tfVENQX1RJTUVPVVRfU1lOX1NFTlQ9MiwKIE5F
VF9ORl9DT05OVFJBQ0tfVENQX1RJTUVPVVRfU1lOX1JFQ1Y9MywKIE5FVF9ORl9DT05OVFJB
Q0tfVENQX1RJTUVPVVRfRVNUQUJMSVNIRUQ9NCwKIE5FVF9ORl9DT05OVFJBQ0tfVENQX1RJ
TUVPVVRfRklOX1dBSVQ9NSwKIE5FVF9ORl9DT05OVFJBQ0tfVENQX1RJTUVPVVRfQ0xPU0Vf
V0FJVD02LAogTkVUX05GX0NPTk5UUkFDS19UQ1BfVElNRU9VVF9MQVNUX0FDSz03LAogTkVU
X05GX0NPTk5UUkFDS19UQ1BfVElNRU9VVF9USU1FX1dBSVQ9OCwKIE5FVF9ORl9DT05OVFJB
Q0tfVENQX1RJTUVPVVRfQ0xPU0U9OSwKIE5FVF9ORl9DT05OVFJBQ0tfVURQX1RJTUVPVVQ9
MTAsCiBORVRfTkZfQ09OTlRSQUNLX1VEUF9USU1FT1VUX1NUUkVBTT0xMSwKIE5FVF9ORl9D
T05OVFJBQ0tfSUNNUF9USU1FT1VUPTEyLAogTkVUX05GX0NPTk5UUkFDS19HRU5FUklDX1RJ
TUVPVVQ9MTMsCiBORVRfTkZfQ09OTlRSQUNLX0JVQ0tFVFM9MTQsCiBORVRfTkZfQ09OTlRS
QUNLX0xPR19JTlZBTElEPTE1LAogTkVUX05GX0NPTk5UUkFDS19UQ1BfVElNRU9VVF9NQVhf
UkVUUkFOUz0xNiwKIE5FVF9ORl9DT05OVFJBQ0tfVENQX0xPT1NFPTE3LAogTkVUX05GX0NP
Tk5UUkFDS19UQ1BfQkVfTElCRVJBTD0xOCwKIE5FVF9ORl9DT05OVFJBQ0tfVENQX01BWF9S
RVRSQU5TPTE5LAogTkVUX05GX0NPTk5UUkFDS19TQ1RQX1RJTUVPVVRfQ0xPU0VEPTIwLAog
TkVUX05GX0NPTk5UUkFDS19TQ1RQX1RJTUVPVVRfQ09PS0lFX1dBSVQ9MjEsCiBORVRfTkZf
Q09OTlRSQUNLX1NDVFBfVElNRU9VVF9DT09LSUVfRUNIT0VEPTIyLAogTkVUX05GX0NPTk5U
UkFDS19TQ1RQX1RJTUVPVVRfRVNUQUJMSVNIRUQ9MjMsCiBORVRfTkZfQ09OTlRSQUNLX1ND
VFBfVElNRU9VVF9TSFVURE9XTl9TRU5UPTI0LAogTkVUX05GX0NPTk5UUkFDS19TQ1RQX1RJ
TUVPVVRfU0hVVERPV05fUkVDRD0yNSwKIE5FVF9ORl9DT05OVFJBQ0tfU0NUUF9USU1FT1VU
X1NIVVRET1dOX0FDS19TRU5UPTI2LAogTkVUX05GX0NPTk5UUkFDS19DT1VOVD0yNywKIE5F
VF9ORl9DT05OVFJBQ0tfSUNNUFY2X1RJTUVPVVQ9MjgsCiBORVRfTkZfQ09OTlRSQUNLX0ZS
QUc2X1RJTUVPVVQ9MjksCiBORVRfTkZfQ09OTlRSQUNLX0ZSQUc2X0xPV19USFJFU0g9MzAs
CiBORVRfTkZfQ09OTlRSQUNLX0ZSQUc2X0hJR0hfVEhSRVNIPTMxLAogTkVUX05GX0NPTk5U
UkFDS19DSEVDS1NVTT0zMiwKfTsKCgplbnVtCnsKCiBORVRfSVBWNF9GT1JXQVJEPTgsCiBO
RVRfSVBWNF9EWU5BRERSPTksCgogTkVUX0lQVjRfQ09ORj0xNiwKIE5FVF9JUFY0X05FSUdI
PTE3LAogTkVUX0lQVjRfUk9VVEU9MTgsCiBORVRfSVBWNF9GSUJfSEFTSD0xOSwKIE5FVF9J
UFY0X05FVEZJTFRFUj0yMCwKCiBORVRfSVBWNF9UQ1BfVElNRVNUQU1QUz0zMywKIE5FVF9J
UFY0X1RDUF9XSU5ET1dfU0NBTElORz0zNCwKIE5FVF9JUFY0X1RDUF9TQUNLPTM1LAogTkVU
X0lQVjRfVENQX1JFVFJBTlNfQ09MTEFQU0U9MzYsCiBORVRfSVBWNF9ERUZBVUxUX1RUTD0z
NywKIE5FVF9JUFY0X0FVVE9DT05GSUc9MzgsCiBORVRfSVBWNF9OT19QTVRVX0RJU0M9Mzks
CiBORVRfSVBWNF9UQ1BfU1lOX1JFVFJJRVM9NDAsCiBORVRfSVBWNF9JUEZSQUdfSElHSF9U
SFJFU0g9NDEsCiBORVRfSVBWNF9JUEZSQUdfTE9XX1RIUkVTSD00MiwKIE5FVF9JUFY0X0lQ
RlJBR19USU1FPTQzLAogTkVUX0lQVjRfVENQX01BWF9LQV9QUk9CRVM9NDQsCiBORVRfSVBW
NF9UQ1BfS0VFUEFMSVZFX1RJTUU9NDUsCiBORVRfSVBWNF9UQ1BfS0VFUEFMSVZFX1BST0JF
Uz00NiwKIE5FVF9JUFY0X1RDUF9SRVRSSUVTMT00NywKIE5FVF9JUFY0X1RDUF9SRVRSSUVT
Mj00OCwKIE5FVF9JUFY0X1RDUF9GSU5fVElNRU9VVD00OSwKIE5FVF9JUFY0X0lQX01BU1Ff
REVCVUc9NTAsCiBORVRfVENQX1NZTkNPT0tJRVM9NTEsCiBORVRfVENQX1NURFVSRz01MiwK
IE5FVF9UQ1BfUkZDMTMzNz01MywKIE5FVF9UQ1BfU1lOX1RBSUxEUk9QPTU0LAogTkVUX1RD
UF9NQVhfU1lOX0JBQ0tMT0c9NTUsCiBORVRfSVBWNF9MT0NBTF9QT1JUX1JBTkdFPTU2LAog
TkVUX0lQVjRfSUNNUF9FQ0hPX0lHTk9SRV9BTEw9NTcsCiBORVRfSVBWNF9JQ01QX0VDSE9f
SUdOT1JFX0JST0FEQ0FTVFM9NTgsCiBORVRfSVBWNF9JQ01QX1NPVVJDRVFVRU5DSF9SQVRF
PTU5LAogTkVUX0lQVjRfSUNNUF9ERVNUVU5SRUFDSF9SQVRFPTYwLAogTkVUX0lQVjRfSUNN
UF9USU1FRVhDRUVEX1JBVEU9NjEsCiBORVRfSVBWNF9JQ01QX1BBUkFNUFJPQl9SQVRFPTYy
LAogTkVUX0lQVjRfSUNNUF9FQ0hPUkVQTFlfUkFURT02MywKIE5FVF9JUFY0X0lDTVBfSUdO
T1JFX0JPR1VTX0VSUk9SX1JFU1BPTlNFUz02NCwKIE5FVF9JUFY0X0lHTVBfTUFYX01FTUJF
UlNISVBTPTY1LAogTkVUX1RDUF9UV19SRUNZQ0xFPTY2LAogTkVUX0lQVjRfQUxXQVlTX0RF
RlJBRz02NywKIE5FVF9JUFY0X1RDUF9LRUVQQUxJVkVfSU5UVkw9NjgsCiBORVRfSVBWNF9J
TkVUX1BFRVJfVEhSRVNIT0xEPTY5LAogTkVUX0lQVjRfSU5FVF9QRUVSX01JTlRUTD03MCwK
IE5FVF9JUFY0X0lORVRfUEVFUl9NQVhUVEw9NzEsCiBORVRfSVBWNF9JTkVUX1BFRVJfR0Nf
TUlOVElNRT03MiwKIE5FVF9JUFY0X0lORVRfUEVFUl9HQ19NQVhUSU1FPTczLAogTkVUX1RD
UF9PUlBIQU5fUkVUUklFUz03NCwKIE5FVF9UQ1BfQUJPUlRfT05fT1ZFUkZMT1c9NzUsCiBO
RVRfVENQX1NZTkFDS19SRVRSSUVTPTc2LAogTkVUX1RDUF9NQVhfT1JQSEFOUz03NywKIE5F
VF9UQ1BfTUFYX1RXX0JVQ0tFVFM9NzgsCiBORVRfVENQX0ZBQ0s9NzksCiBORVRfVENQX1JF
T1JERVJJTkc9ODAsCiBORVRfVENQX0VDTj04MSwKIE5FVF9UQ1BfRFNBQ0s9ODIsCiBORVRf
VENQX01FTT04MywKIE5FVF9UQ1BfV01FTT04NCwKIE5FVF9UQ1BfUk1FTT04NSwKIE5FVF9U
Q1BfQVBQX1dJTj04NiwKIE5FVF9UQ1BfQURWX1dJTl9TQ0FMRT04NywKIE5FVF9JUFY0X05P
TkxPQ0FMX0JJTkQ9ODgsCiBORVRfSVBWNF9JQ01QX1JBVEVMSU1JVD04OSwKIE5FVF9JUFY0
X0lDTVBfUkFURU1BU0s9OTAsCiBORVRfVENQX1RXX1JFVVNFPTkxLAogTkVUX1RDUF9GUlRP
PTkyLAogTkVUX1RDUF9MT1dfTEFURU5DWT05MywKIE5FVF9JUFY0X0lQRlJBR19TRUNSRVRf
SU5URVJWQUw9OTQsCiBORVRfSVBWNF9JR01QX01BWF9NU0Y9OTYsCiBORVRfVENQX05PX01F
VFJJQ1NfU0FWRT05NywKIE5FVF9UQ1BfREVGQVVMVF9XSU5fU0NBTEU9MTA1LAogTkVUX1RD
UF9NT0RFUkFURV9SQ1ZCVUY9MTA2LAogTkVUX1RDUF9UU09fV0lOX0RJVklTT1I9MTA3LAog
TkVUX1RDUF9CSUNfQkVUQT0xMDgsCiBORVRfSVBWNF9JQ01QX0VSUk9SU19VU0VfSU5CT1VO
RF9JRkFERFI9MTA5LAogTkVUX1RDUF9DT05HX0NPTlRST0w9MTEwLAogTkVUX1RDUF9BQkM9
MTExLAogTkVUX0lQVjRfSVBGUkFHX01BWF9ESVNUPTExMiwKICBORVRfVENQX01UVV9QUk9C
SU5HPTExMywKIE5FVF9UQ1BfQkFTRV9NU1M9MTE0LAogTkVUX0lQVjRfVENQX1dPUktBUk9V
TkRfU0lHTkVEX1dJTkRPV1M9MTE1LAogTkVUX1RDUF9ETUFfQ09QWUJSRUFLPTExNiwKIE5F
VF9UQ1BfU0xPV19TVEFSVF9BRlRFUl9JRExFPTExNywKIE5FVF9DSVBTT1Y0X0NBQ0hFX0VO
QUJMRT0xMTgsCiBORVRfQ0lQU09WNF9DQUNIRV9CVUNLRVRfU0laRT0xMTksCiBORVRfQ0lQ
U09WNF9SQk1fT1BURk1UPTEyMCwKIE5FVF9DSVBTT1Y0X1JCTV9TVFJJQ1RWQUxJRD0xMjEs
CiBORVRfVENQX0FWQUlMX0NPTkdfQ09OVFJPTD0xMjIsCiBORVRfVENQX0FMTE9XRURfQ09O
R19DT05UUk9MPTEyMywKIE5FVF9UQ1BfTUFYX1NTVEhSRVNIPTEyNCwKIE5FVF9UQ1BfRlJU
T19SRVNQT05TRT0xMjUsCn07CgplbnVtIHsKIE5FVF9JUFY0X1JPVVRFX0ZMVVNIPTEsCiBO
RVRfSVBWNF9ST1VURV9NSU5fREVMQVk9MiwKIE5FVF9JUFY0X1JPVVRFX01BWF9ERUxBWT0z
LAogTkVUX0lQVjRfUk9VVEVfR0NfVEhSRVNIPTQsCiBORVRfSVBWNF9ST1VURV9NQVhfU0la
RT01LAogTkVUX0lQVjRfUk9VVEVfR0NfTUlOX0lOVEVSVkFMPTYsCiBORVRfSVBWNF9ST1VU
RV9HQ19USU1FT1VUPTcsCiBORVRfSVBWNF9ST1VURV9HQ19JTlRFUlZBTD04LAogTkVUX0lQ
VjRfUk9VVEVfUkVESVJFQ1RfTE9BRD05LAogTkVUX0lQVjRfUk9VVEVfUkVESVJFQ1RfTlVN
QkVSPTEwLAogTkVUX0lQVjRfUk9VVEVfUkVESVJFQ1RfU0lMRU5DRT0xMSwKIE5FVF9JUFY0
X1JPVVRFX0VSUk9SX0NPU1Q9MTIsCiBORVRfSVBWNF9ST1VURV9FUlJPUl9CVVJTVD0xMywK
IE5FVF9JUFY0X1JPVVRFX0dDX0VMQVNUSUNJVFk9MTQsCiBORVRfSVBWNF9ST1VURV9NVFVf
RVhQSVJFUz0xNSwKIE5FVF9JUFY0X1JPVVRFX01JTl9QTVRVPTE2LAogTkVUX0lQVjRfUk9V
VEVfTUlOX0FEVk1TUz0xNywKIE5FVF9JUFY0X1JPVVRFX1NFQ1JFVF9JTlRFUlZBTD0xOCwK
IE5FVF9JUFY0X1JPVVRFX0dDX01JTl9JTlRFUlZBTF9NUz0xOSwKfTsKCmVudW0KewogTkVU
X1BST1RPX0NPTkZfQUxMPS0yLAogTkVUX1BST1RPX0NPTkZfREVGQVVMVD0tMwoKCn07Cgpl
bnVtCnsKIE5FVF9JUFY0X0NPTkZfRk9SV0FSRElORz0xLAogTkVUX0lQVjRfQ09ORl9NQ19G
T1JXQVJESU5HPTIsCiBORVRfSVBWNF9DT05GX1BST1hZX0FSUD0zLAogTkVUX0lQVjRfQ09O
Rl9BQ0NFUFRfUkVESVJFQ1RTPTQsCiBORVRfSVBWNF9DT05GX1NFQ1VSRV9SRURJUkVDVFM9
NSwKIE5FVF9JUFY0X0NPTkZfU0VORF9SRURJUkVDVFM9NiwKIE5FVF9JUFY0X0NPTkZfU0hB
UkVEX01FRElBPTcsCiBORVRfSVBWNF9DT05GX1JQX0ZJTFRFUj04LAogTkVUX0lQVjRfQ09O
Rl9BQ0NFUFRfU09VUkNFX1JPVVRFPTksCiBORVRfSVBWNF9DT05GX0JPT1RQX1JFTEFZPTEw
LAogTkVUX0lQVjRfQ09ORl9MT0dfTUFSVElBTlM9MTEsCiBORVRfSVBWNF9DT05GX1RBRz0x
MiwKIE5FVF9JUFY0X0NPTkZfQVJQRklMVEVSPTEzLAogTkVUX0lQVjRfQ09ORl9NRURJVU1f
SUQ9MTQsCiBORVRfSVBWNF9DT05GX05PWEZSTT0xNSwKIE5FVF9JUFY0X0NPTkZfTk9QT0xJ
Q1k9MTYsCiBORVRfSVBWNF9DT05GX0ZPUkNFX0lHTVBfVkVSU0lPTj0xNywKIE5FVF9JUFY0
X0NPTkZfQVJQX0FOTk9VTkNFPTE4LAogTkVUX0lQVjRfQ09ORl9BUlBfSUdOT1JFPTE5LAog
TkVUX0lQVjRfQ09ORl9QUk9NT1RFX1NFQ09OREFSSUVTPTIwLAogTkVUX0lQVjRfQ09ORl9B
UlBfQUNDRVBUPTIxLAogTkVUX0lQVjRfQ09ORl9BUlBfTk9USUZZPTIyLAp9OwoKCmVudW0K
ewogTkVUX0lQVjRfTkZfQ09OTlRSQUNLX01BWD0xLAogTkVUX0lQVjRfTkZfQ09OTlRSQUNL
X1RDUF9USU1FT1VUX1NZTl9TRU5UPTIsCiBORVRfSVBWNF9ORl9DT05OVFJBQ0tfVENQX1RJ
TUVPVVRfU1lOX1JFQ1Y9MywKIE5FVF9JUFY0X05GX0NPTk5UUkFDS19UQ1BfVElNRU9VVF9F
U1RBQkxJU0hFRD00LAogTkVUX0lQVjRfTkZfQ09OTlRSQUNLX1RDUF9USU1FT1VUX0ZJTl9X
QUlUPTUsCiBORVRfSVBWNF9ORl9DT05OVFJBQ0tfVENQX1RJTUVPVVRfQ0xPU0VfV0FJVD02
LAogTkVUX0lQVjRfTkZfQ09OTlRSQUNLX1RDUF9USU1FT1VUX0xBU1RfQUNLPTcsCiBORVRf
SVBWNF9ORl9DT05OVFJBQ0tfVENQX1RJTUVPVVRfVElNRV9XQUlUPTgsCiBORVRfSVBWNF9O
Rl9DT05OVFJBQ0tfVENQX1RJTUVPVVRfQ0xPU0U9OSwKIE5FVF9JUFY0X05GX0NPTk5UUkFD
S19VRFBfVElNRU9VVD0xMCwKIE5FVF9JUFY0X05GX0NPTk5UUkFDS19VRFBfVElNRU9VVF9T
VFJFQU09MTEsCiBORVRfSVBWNF9ORl9DT05OVFJBQ0tfSUNNUF9USU1FT1VUPTEyLAogTkVU
X0lQVjRfTkZfQ09OTlRSQUNLX0dFTkVSSUNfVElNRU9VVD0xMywKIE5FVF9JUFY0X05GX0NP
Tk5UUkFDS19CVUNLRVRTPTE0LAogTkVUX0lQVjRfTkZfQ09OTlRSQUNLX0xPR19JTlZBTElE
PTE1LAogTkVUX0lQVjRfTkZfQ09OTlRSQUNLX1RDUF9USU1FT1VUX01BWF9SRVRSQU5TPTE2
LAogTkVUX0lQVjRfTkZfQ09OTlRSQUNLX1RDUF9MT09TRT0xNywKIE5FVF9JUFY0X05GX0NP
Tk5UUkFDS19UQ1BfQkVfTElCRVJBTD0xOCwKIE5FVF9JUFY0X05GX0NPTk5UUkFDS19UQ1Bf
TUFYX1JFVFJBTlM9MTksCiAgTkVUX0lQVjRfTkZfQ09OTlRSQUNLX1NDVFBfVElNRU9VVF9D
TE9TRUQ9MjAsCiAgTkVUX0lQVjRfTkZfQ09OTlRSQUNLX1NDVFBfVElNRU9VVF9DT09LSUVf
V0FJVD0yMSwKICBORVRfSVBWNF9ORl9DT05OVFJBQ0tfU0NUUF9USU1FT1VUX0NPT0tJRV9F
Q0hPRUQ9MjIsCiAgTkVUX0lQVjRfTkZfQ09OTlRSQUNLX1NDVFBfVElNRU9VVF9FU1RBQkxJ
U0hFRD0yMywKICBORVRfSVBWNF9ORl9DT05OVFJBQ0tfU0NUUF9USU1FT1VUX1NIVVRET1dO
X1NFTlQ9MjQsCiAgTkVUX0lQVjRfTkZfQ09OTlRSQUNLX1NDVFBfVElNRU9VVF9TSFVURE9X
Tl9SRUNEPTI1LAogIE5FVF9JUFY0X05GX0NPTk5UUkFDS19TQ1RQX1RJTUVPVVRfU0hVVERP
V05fQUNLX1NFTlQ9MjYsCiBORVRfSVBWNF9ORl9DT05OVFJBQ0tfQ09VTlQ9MjcsCiBORVRf
SVBWNF9ORl9DT05OVFJBQ0tfQ0hFQ0tTVU09MjgsCn07CgoKZW51bSB7CiBORVRfSVBWNl9D
T05GPTE2LAogTkVUX0lQVjZfTkVJR0g9MTcsCiBORVRfSVBWNl9ST1VURT0xOCwKIE5FVF9J
UFY2X0lDTVA9MTksCiBORVRfSVBWNl9CSU5EVjZPTkxZPTIwLAogTkVUX0lQVjZfSVA2RlJB
R19ISUdIX1RIUkVTSD0yMSwKIE5FVF9JUFY2X0lQNkZSQUdfTE9XX1RIUkVTSD0yMiwKIE5F
VF9JUFY2X0lQNkZSQUdfVElNRT0yMywKIE5FVF9JUFY2X0lQNkZSQUdfU0VDUkVUX0lOVEVS
VkFMPTI0LAogTkVUX0lQVjZfTUxEX01BWF9NU0Y9MjUsCn07CgplbnVtIHsKIE5FVF9JUFY2
X1JPVVRFX0ZMVVNIPTEsCiBORVRfSVBWNl9ST1VURV9HQ19USFJFU0g9MiwKIE5FVF9JUFY2
X1JPVVRFX01BWF9TSVpFPTMsCiBORVRfSVBWNl9ST1VURV9HQ19NSU5fSU5URVJWQUw9NCwK
IE5FVF9JUFY2X1JPVVRFX0dDX1RJTUVPVVQ9NSwKIE5FVF9JUFY2X1JPVVRFX0dDX0lOVEVS
VkFMPTYsCiBORVRfSVBWNl9ST1VURV9HQ19FTEFTVElDSVRZPTcsCiBORVRfSVBWNl9ST1VU
RV9NVFVfRVhQSVJFUz04LAogTkVUX0lQVjZfUk9VVEVfTUlOX0FEVk1TUz05LAogTkVUX0lQ
VjZfUk9VVEVfR0NfTUlOX0lOVEVSVkFMX01TPTEwCn07CgplbnVtIHsKIE5FVF9JUFY2X0ZP
UldBUkRJTkc9MSwKIE5FVF9JUFY2X0hPUF9MSU1JVD0yLAogTkVUX0lQVjZfTVRVPTMsCiBO
RVRfSVBWNl9BQ0NFUFRfUkE9NCwKIE5FVF9JUFY2X0FDQ0VQVF9SRURJUkVDVFM9NSwKIE5F
VF9JUFY2X0FVVE9DT05GPTYsCiBORVRfSVBWNl9EQURfVFJBTlNNSVRTPTcsCiBORVRfSVBW
Nl9SVFJfU09MSUNJVFM9OCwKIE5FVF9JUFY2X1JUUl9TT0xJQ0lUX0lOVEVSVkFMPTksCiBO
RVRfSVBWNl9SVFJfU09MSUNJVF9ERUxBWT0xMCwKIE5FVF9JUFY2X1VTRV9URU1QQUREUj0x
MSwKIE5FVF9JUFY2X1RFTVBfVkFMSURfTEZUPTEyLAogTkVUX0lQVjZfVEVNUF9QUkVGRVJF
RF9MRlQ9MTMsCiBORVRfSVBWNl9SRUdFTl9NQVhfUkVUUlk9MTQsCiBORVRfSVBWNl9NQVhf
REVTWU5DX0ZBQ1RPUj0xNSwKIE5FVF9JUFY2X01BWF9BRERSRVNTRVM9MTYsCiBORVRfSVBW
Nl9GT1JDRV9NTERfVkVSU0lPTj0xNywKIE5FVF9JUFY2X0FDQ0VQVF9SQV9ERUZSVFI9MTgs
CiBORVRfSVBWNl9BQ0NFUFRfUkFfUElORk89MTksCiBORVRfSVBWNl9BQ0NFUFRfUkFfUlRS
X1BSRUY9MjAsCiBORVRfSVBWNl9SVFJfUFJPQkVfSU5URVJWQUw9MjEsCiBORVRfSVBWNl9B
Q0NFUFRfUkFfUlRfSU5GT19NQVhfUExFTj0yMiwKIE5FVF9JUFY2X1BST1hZX05EUD0yMywK
IE5FVF9JUFY2X0FDQ0VQVF9TT1VSQ0VfUk9VVEU9MjUsCiBORVRfSVBWNl9BQ0NFUFRfUkFf
RlJPTV9MT0NBTD0yNiwKIE5FVF9JUFY2X0FDQ0VQVF9SQV9SVF9JTkZPX01JTl9QTEVOPTI3
LAogX19ORVRfSVBWNl9NQVgKfTsKCgplbnVtIHsKIE5FVF9JUFY2X0lDTVBfUkFURUxJTUlU
ID0gMSwKIE5FVF9JUFY2X0lDTVBfRUNIT19JR05PUkVfQUxMID0gMgp9OwoKCmVudW0gewog
TkVUX05FSUdIX01DQVNUX1NPTElDSVQ9MSwKIE5FVF9ORUlHSF9VQ0FTVF9TT0xJQ0lUPTIs
CiBORVRfTkVJR0hfQVBQX1NPTElDSVQ9MywKIE5FVF9ORUlHSF9SRVRSQU5TX1RJTUU9NCwK
IE5FVF9ORUlHSF9SRUFDSEFCTEVfVElNRT01LAogTkVUX05FSUdIX0RFTEFZX1BST0JFX1RJ
TUU9NiwKIE5FVF9ORUlHSF9HQ19TVEFMRV9USU1FPTcsCiBORVRfTkVJR0hfVU5SRVNfUUxF
Tj04LAogTkVUX05FSUdIX1BST1hZX1FMRU49OSwKIE5FVF9ORUlHSF9BTllDQVNUX0RFTEFZ
PTEwLAogTkVUX05FSUdIX1BST1hZX0RFTEFZPTExLAogTkVUX05FSUdIX0xPQ0tUSU1FPTEy
LAogTkVUX05FSUdIX0dDX0lOVEVSVkFMPTEzLAogTkVUX05FSUdIX0dDX1RIUkVTSDE9MTQs
CiBORVRfTkVJR0hfR0NfVEhSRVNIMj0xNSwKIE5FVF9ORUlHSF9HQ19USFJFU0gzPTE2LAog
TkVUX05FSUdIX1JFVFJBTlNfVElNRV9NUz0xNywKIE5FVF9ORUlHSF9SRUFDSEFCTEVfVElN
RV9NUz0xOCwKfTsKCgplbnVtIHsKIE5FVF9EQ0NQX0RFRkFVTFQ9MSwKfTsKCgplbnVtIHsK
IE5FVF9JUFhfUFBST1BfQlJPQURDQVNUSU5HPTEsCiBORVRfSVBYX0ZPUldBUkRJTkc9Mgp9
OwoKCmVudW0gewogTkVUX0xMQzI9MSwKIE5FVF9MTENfU1RBVElPTj0yLAp9OwoKCmVudW0g
ewogTkVUX0xMQzJfVElNRU9VVD0xLAp9OwoKCmVudW0gewogTkVUX0xMQ19TVEFUSU9OX0FD
S19USU1FT1VUPTEsCn07CgoKZW51bSB7CiBORVRfTExDMl9BQ0tfVElNRU9VVD0xLAogTkVU
X0xMQzJfUF9USU1FT1VUPTIsCiBORVRfTExDMl9SRUpfVElNRU9VVD0zLAogTkVUX0xMQzJf
QlVTWV9USU1FT1VUPTQsCn07CgoKZW51bSB7CiBORVRfQVRBTEtfQUFSUF9FWFBJUllfVElN
RT0xLAogTkVUX0FUQUxLX0FBUlBfVElDS19USU1FPTIsCiBORVRfQVRBTEtfQUFSUF9SRVRS
QU5TTUlUX0xJTUlUPTMsCiBORVRfQVRBTEtfQUFSUF9SRVNPTFZFX1RJTUU9NAp9OwoKCgpl
bnVtIHsKIE5FVF9ORVRST01fREVGQVVMVF9QQVRIX1FVQUxJVFk9MSwKIE5FVF9ORVRST01f
T0JTT0xFU0NFTkNFX0NPVU5UX0lOSVRJQUxJU0VSPTIsCiBORVRfTkVUUk9NX05FVFdPUktf
VFRMX0lOSVRJQUxJU0VSPTMsCiBORVRfTkVUUk9NX1RSQU5TUE9SVF9USU1FT1VUPTQsCiBO
RVRfTkVUUk9NX1RSQU5TUE9SVF9NQVhJTVVNX1RSSUVTPTUsCiBORVRfTkVUUk9NX1RSQU5T
UE9SVF9BQ0tOT1dMRURHRV9ERUxBWT02LAogTkVUX05FVFJPTV9UUkFOU1BPUlRfQlVTWV9E
RUxBWT03LAogTkVUX05FVFJPTV9UUkFOU1BPUlRfUkVRVUVTVEVEX1dJTkRPV19TSVpFPTgs
CiBORVRfTkVUUk9NX1RSQU5TUE9SVF9OT19BQ1RJVklUWV9USU1FT1VUPTksCiBORVRfTkVU
Uk9NX1JPVVRJTkdfQ09OVFJPTD0xMCwKIE5FVF9ORVRST01fTElOS19GQUlMU19DT1VOVD0x
MSwKIE5FVF9ORVRST01fUkVTRVQ9MTIKfTsKCgplbnVtIHsKIE5FVF9BWDI1X0lQX0RFRkFV
TFRfTU9ERT0xLAogTkVUX0FYMjVfREVGQVVMVF9NT0RFPTIsCiBORVRfQVgyNV9CQUNLT0ZG
X1RZUEU9MywKIE5FVF9BWDI1X0NPTk5FQ1RfTU9ERT00LAogTkVUX0FYMjVfU1RBTkRBUkRf
V0lORE9XPTUsCiBORVRfQVgyNV9FWFRFTkRFRF9XSU5ET1c9NiwKIE5FVF9BWDI1X1QxX1RJ
TUVPVVQ9NywKIE5FVF9BWDI1X1QyX1RJTUVPVVQ9OCwKIE5FVF9BWDI1X1QzX1RJTUVPVVQ9
OSwKIE5FVF9BWDI1X0lETEVfVElNRU9VVD0xMCwKIE5FVF9BWDI1X04yPTExLAogTkVUX0FY
MjVfUEFDTEVOPTEyLAogTkVUX0FYMjVfUFJPVE9DT0w9MTMsCiBORVRfQVgyNV9EQU1BX1NM
QVZFX1RJTUVPVVQ9MTQKfTsKCgplbnVtIHsKIE5FVF9ST1NFX1JFU1RBUlRfUkVRVUVTVF9U
SU1FT1VUPTEsCiBORVRfUk9TRV9DQUxMX1JFUVVFU1RfVElNRU9VVD0yLAogTkVUX1JPU0Vf
UkVTRVRfUkVRVUVTVF9USU1FT1VUPTMsCiBORVRfUk9TRV9DTEVBUl9SRVFVRVNUX1RJTUVP
VVQ9NCwKIE5FVF9ST1NFX0FDS19IT0xEX0JBQ0tfVElNRU9VVD01LAogTkVUX1JPU0VfUk9V
VElOR19DT05UUk9MPTYsCiBORVRfUk9TRV9MSU5LX0ZBSUxfVElNRU9VVD03LAogTkVUX1JP
U0VfTUFYX1ZDUz04LAogTkVUX1JPU0VfV0lORE9XX1NJWkU9OSwKIE5FVF9ST1NFX05PX0FD
VElWSVRZX1RJTUVPVVQ9MTAKfTsKCgplbnVtIHsKIE5FVF9YMjVfUkVTVEFSVF9SRVFVRVNU
X1RJTUVPVVQ9MSwKIE5FVF9YMjVfQ0FMTF9SRVFVRVNUX1RJTUVPVVQ9MiwKIE5FVF9YMjVf
UkVTRVRfUkVRVUVTVF9USU1FT1VUPTMsCiBORVRfWDI1X0NMRUFSX1JFUVVFU1RfVElNRU9V
VD00LAogTkVUX1gyNV9BQ0tfSE9MRF9CQUNLX1RJTUVPVVQ9NSwKIE5FVF9YMjVfRk9SV0FS
RD02Cn07CgoKZW51bQp7CiBORVRfVFJfUklGX1RJTUVPVVQ9MQp9OwoKCmVudW0gewogTkVU
X0RFQ05FVF9OT0RFX1RZUEUgPSAxLAogTkVUX0RFQ05FVF9OT0RFX0FERFJFU1MgPSAyLAog
TkVUX0RFQ05FVF9OT0RFX05BTUUgPSAzLAogTkVUX0RFQ05FVF9ERUZBVUxUX0RFVklDRSA9
IDQsCiBORVRfREVDTkVUX1RJTUVfV0FJVCA9IDUsCiBORVRfREVDTkVUX0ROX0NPVU5UID0g
NiwKIE5FVF9ERUNORVRfRElfQ09VTlQgPSA3LAogTkVUX0RFQ05FVF9EUl9DT1VOVCA9IDgs
CiBORVRfREVDTkVUX0RTVF9HQ19JTlRFUlZBTCA9IDksCiBORVRfREVDTkVUX0NPTkYgPSAx
MCwKIE5FVF9ERUNORVRfTk9fRkNfTUFYX0NXTkQgPSAxMSwKIE5FVF9ERUNORVRfTUVNID0g
MTIsCiBORVRfREVDTkVUX1JNRU0gPSAxMywKIE5FVF9ERUNORVRfV01FTSA9IDE0LAogTkVU
X0RFQ05FVF9ERUJVR19MRVZFTCA9IDI1NQp9OwoKCmVudW0gewogTkVUX0RFQ05FVF9DT05G
X0xPT1BCQUNLID0gLTIsCiBORVRfREVDTkVUX0NPTkZfRERDTVAgPSAtMywKIE5FVF9ERUNO
RVRfQ09ORl9QUFAgPSAtNCwKIE5FVF9ERUNORVRfQ09ORl9YMjUgPSAtNSwKIE5FVF9ERUNO
RVRfQ09ORl9HUkUgPSAtNiwKIE5FVF9ERUNORVRfQ09ORl9FVEhFUiA9IC03CgoKfTsKCgpl
bnVtIHsKIE5FVF9ERUNORVRfQ09ORl9ERVZfUFJJT1JJVFkgPSAxLAogTkVUX0RFQ05FVF9D
T05GX0RFVl9UMSA9IDIsCiBORVRfREVDTkVUX0NPTkZfREVWX1QyID0gMywKIE5FVF9ERUNO
RVRfQ09ORl9ERVZfVDMgPSA0LAogTkVUX0RFQ05FVF9DT05GX0RFVl9GT1JXQVJESU5HID0g
NSwKIE5FVF9ERUNORVRfQ09ORl9ERVZfQkxLU0laRSA9IDYsCiBORVRfREVDTkVUX0NPTkZf
REVWX1NUQVRFID0gNwp9OwoKCmVudW0gewogTkVUX1NDVFBfUlRPX0lOSVRJQUwgPSAxLAog
TkVUX1NDVFBfUlRPX01JTiA9IDIsCiBORVRfU0NUUF9SVE9fTUFYID0gMywKIE5FVF9TQ1RQ
X1JUT19BTFBIQSA9IDQsCiBORVRfU0NUUF9SVE9fQkVUQSA9IDUsCiBORVRfU0NUUF9WQUxJ
RF9DT09LSUVfTElGRSA9IDYsCiBORVRfU0NUUF9BU1NPQ0lBVElPTl9NQVhfUkVUUkFOUyA9
IDcsCiBORVRfU0NUUF9QQVRIX01BWF9SRVRSQU5TID0gOCwKIE5FVF9TQ1RQX01BWF9JTklU
X1JFVFJBTlNNSVRTID0gOSwKIE5FVF9TQ1RQX0hCX0lOVEVSVkFMID0gMTAsCiBORVRfU0NU
UF9QUkVTRVJWRV9FTkFCTEUgPSAxMSwKIE5FVF9TQ1RQX01BWF9CVVJTVCA9IDEyLAogTkVU
X1NDVFBfQURESVBfRU5BQkxFID0gMTMsCiBORVRfU0NUUF9QUlNDVFBfRU5BQkxFID0gMTQs
CiBORVRfU0NUUF9TTkRCVUZfUE9MSUNZID0gMTUsCiBORVRfU0NUUF9TQUNLX1RJTUVPVVQg
PSAxNiwKIE5FVF9TQ1RQX1JDVkJVRl9QT0xJQ1kgPSAxNywKfTsKCgplbnVtIHsKIE5FVF9C
UklER0VfTkZfQ0FMTF9BUlBUQUJMRVMgPSAxLAogTkVUX0JSSURHRV9ORl9DQUxMX0lQVEFC
TEVTID0gMiwKIE5FVF9CUklER0VfTkZfQ0FMTF9JUDZUQUJMRVMgPSAzLAogTkVUX0JSSURH
RV9ORl9GSUxURVJfVkxBTl9UQUdHRUQgPSA0LAogTkVUX0JSSURHRV9ORl9GSUxURVJfUFBQ
T0VfVEFHR0VEID0gNSwKfTsKCgoKZW51bQp7CiBGU19OUklOT0RFPTEsCiBGU19TVEFUSU5P
REU9MiwKIEZTX01BWElOT0RFPTMsCiBGU19OUkRRVU9UPTQsCiBGU19NQVhEUVVPVD01LAog
RlNfTlJGSUxFPTYsCiBGU19NQVhGSUxFPTcsCiBGU19ERU5UUlk9OCwKIEZTX05SU1VQRVI9
OSwKIEZTX01BWFNVUEVSPTEwLAogRlNfT1ZFUkZMT1dVSUQ9MTEsCiBGU19PVkVSRkxPV0dJ
RD0xMiwKIEZTX0xFQVNFUz0xMywKIEZTX0RJUl9OT1RJRlk9MTQsCiBGU19MRUFTRV9USU1F
PTE1LAogRlNfRFFTVEFUUz0xNiwKIEZTX1hGUz0xNywKIEZTX0FJT19OUj0xOCwKIEZTX0FJ
T19NQVhfTlI9MTksCiBGU19JTk9USUZZPTIwLAogRlNfT0NGUzI9OTg4LAp9OwoKCmVudW0g
ewogRlNfRFFfTE9PS1VQUyA9IDEsCiBGU19EUV9EUk9QUyA9IDIsCiBGU19EUV9SRUFEUyA9
IDMsCiBGU19EUV9XUklURVMgPSA0LAogRlNfRFFfQ0FDSEVfSElUUyA9IDUsCiBGU19EUV9B
TExPQ0FURUQgPSA2LAogRlNfRFFfRlJFRSA9IDcsCiBGU19EUV9TWU5DUyA9IDgsCiBGU19E
UV9XQVJOSU5HUyA9IDksCn07CgoKCgplbnVtIHsKIERFVl9DRFJPTT0xLAogREVWX0hXTU9O
PTIsCiBERVZfUEFSUE9SVD0zLAogREVWX1JBSUQ9NCwKIERFVl9NQUNfSElEPTUsCiBERVZf
U0NTST02LAogREVWX0lQTUk9NywKfTsKCgplbnVtIHsKIERFVl9DRFJPTV9JTkZPPTEsCiBE
RVZfQ0RST01fQVVUT0NMT1NFPTIsCiBERVZfQ0RST01fQVVUT0VKRUNUPTMsCiBERVZfQ0RS
T01fREVCVUc9NCwKIERFVl9DRFJPTV9MT0NLPTUsCiBERVZfQ0RST01fQ0hFQ0tfTUVESUE9
Ngp9OwoKCmVudW0gewogREVWX1BBUlBPUlRfREVGQVVMVD0tMwp9OwoKCmVudW0gewogREVW
X1JBSURfU1BFRURfTElNSVRfTUlOPTEsCiBERVZfUkFJRF9TUEVFRF9MSU1JVF9NQVg9Mgp9
OwoKCmVudW0gewogREVWX1BBUlBPUlRfREVGQVVMVF9USU1FU0xJQ0U9MSwKIERFVl9QQVJQ
T1JUX0RFRkFVTFRfU1BJTlRJTUU9Mgp9OwoKCmVudW0gewogREVWX1BBUlBPUlRfU1BJTlRJ
TUU9MSwKIERFVl9QQVJQT1JUX0JBU0VfQUREUj0yLAogREVWX1BBUlBPUlRfSVJRPTMsCiBE
RVZfUEFSUE9SVF9ETUE9NCwKIERFVl9QQVJQT1JUX01PREVTPTUsCiBERVZfUEFSUE9SVF9E
RVZJQ0VTPTYsCiBERVZfUEFSUE9SVF9BVVRPUFJPQkU9MTYKfTsKCgplbnVtIHsKIERFVl9Q
QVJQT1JUX0RFVklDRVNfQUNUSVZFPS0zLAp9OwoKCmVudW0gewogREVWX1BBUlBPUlRfREVW
SUNFX1RJTUVTTElDRT0xLAp9OwoKCmVudW0gewogREVWX01BQ19ISURfS0VZQk9BUkRfU0VO
RFNfTElOVVhfS0VZQ09ERVM9MSwKIERFVl9NQUNfSElEX0tFWUJPQVJEX0xPQ0tfS0VZQ09E
RVM9MiwKIERFVl9NQUNfSElEX01PVVNFX0JVVFRPTl9FTVVMQVRJT049MywKIERFVl9NQUNf
SElEX01PVVNFX0JVVFRPTjJfS0VZQ09ERT00LAogREVWX01BQ19ISURfTU9VU0VfQlVUVE9O
M19LRVlDT0RFPTUsCiBERVZfTUFDX0hJRF9BREJfTU9VU0VfU0VORFNfS0VZQ09ERVM9Ngp9
OwoKCmVudW0gewogREVWX1NDU0lfTE9HR0lOR19MRVZFTD0xLAp9OwoKCmVudW0gewogREVW
X0lQTUlfUE9XRVJPRkZfUE9XRVJDWUNMRT0xLAp9OwoKCmVudW0KewogQUJJX0RFRkhBTkRM
RVJfQ09GRj0xLAogQUJJX0RFRkhBTkRMRVJfRUxGPTIsCiBBQklfREVGSEFORExFUl9MQ0FM
TDc9MywKIEFCSV9ERUZIQU5ETEVSX0xJQkNTTz00LAogQUJJX1RSQUNFPTUsCiBBQklfRkFL
RV9VVFNOQU1FPTYsCn07CiMgMzEgIi4vaW5jbHVkZS9saW51eC9zeXNjdGwuaCIgMgoKCnN0
cnVjdCBjb21wbGV0aW9uOwpzdHJ1Y3QgY3RsX3RhYmxlOwpzdHJ1Y3QgbnNwcm94eTsKc3Ry
dWN0IGN0bF90YWJsZV9yb290OwpzdHJ1Y3QgY3RsX3RhYmxlX2hlYWRlcjsKc3RydWN0IGN0
bF9kaXI7CgoKCgoKCmV4dGVybiBjb25zdCBpbnQgc3lzY3RsX3ZhbHNbXTsKCnR5cGVkZWYg
aW50IHByb2NfaGFuZGxlcihzdHJ1Y3QgY3RsX3RhYmxlICpjdGwsIGludCB3cml0ZSwgdm9p
ZCAqYnVmZmVyLAogIHNpemVfdCAqbGVucCwgbG9mZl90ICpwcG9zKTsKCmludCBwcm9jX2Rv
c3RyaW5nKHN0cnVjdCBjdGxfdGFibGUgKiwgaW50LCB2b2lkICosIHNpemVfdCAqLCBsb2Zm
X3QgKik7CmludCBwcm9jX2RvaW50dmVjKHN0cnVjdCBjdGxfdGFibGUgKiwgaW50LCB2b2lk
ICosIHNpemVfdCAqLCBsb2ZmX3QgKik7CmludCBwcm9jX2RvdWludHZlYyhzdHJ1Y3QgY3Rs
X3RhYmxlICosIGludCwgdm9pZCAqLCBzaXplX3QgKiwgbG9mZl90ICopOwppbnQgcHJvY19k
b2ludHZlY19taW5tYXgoc3RydWN0IGN0bF90YWJsZSAqLCBpbnQsIHZvaWQgKiwgc2l6ZV90
ICosIGxvZmZfdCAqKTsKaW50IHByb2NfZG91aW50dmVjX21pbm1heChzdHJ1Y3QgY3RsX3Rh
YmxlICp0YWJsZSwgaW50IHdyaXRlLCB2b2lkICpidWZmZXIsCiAgc2l6ZV90ICpsZW5wLCBs
b2ZmX3QgKnBwb3MpOwppbnQgcHJvY19kb2ludHZlY19qaWZmaWVzKHN0cnVjdCBjdGxfdGFi
bGUgKiwgaW50LCB2b2lkICosIHNpemVfdCAqLCBsb2ZmX3QgKik7CmludCBwcm9jX2RvaW50
dmVjX3VzZXJoel9qaWZmaWVzKHN0cnVjdCBjdGxfdGFibGUgKiwgaW50LCB2b2lkICosIHNp
emVfdCAqLAogIGxvZmZfdCAqKTsKaW50IHByb2NfZG9pbnR2ZWNfbXNfamlmZmllcyhzdHJ1
Y3QgY3RsX3RhYmxlICosIGludCwgdm9pZCAqLCBzaXplX3QgKiwKICBsb2ZmX3QgKik7Cmlu
dCBwcm9jX2RvdWxvbmd2ZWNfbWlubWF4KHN0cnVjdCBjdGxfdGFibGUgKiwgaW50LCB2b2lk
ICosIHNpemVfdCAqLCBsb2ZmX3QgKik7CmludCBwcm9jX2RvdWxvbmd2ZWNfbXNfamlmZmll
c19taW5tYXgoc3RydWN0IGN0bF90YWJsZSAqdGFibGUsIGludCwgdm9pZCAqLAogIHNpemVf
dCAqLCBsb2ZmX3QgKik7CmludCBwcm9jX2RvX2xhcmdlX2JpdG1hcChzdHJ1Y3QgY3RsX3Rh
YmxlICosIGludCwgdm9pZCAqLCBzaXplX3QgKiwgbG9mZl90ICopOwppbnQgcHJvY19kb19z
dGF0aWNfa2V5KHN0cnVjdCBjdGxfdGFibGUgKnRhYmxlLCBpbnQgd3JpdGUsIHZvaWQgKmJ1
ZmZlciwKICBzaXplX3QgKmxlbnAsIGxvZmZfdCAqcHBvcyk7CiMgOTYgIi4vaW5jbHVkZS9s
aW51eC9zeXNjdGwuaCIKc3RydWN0IGN0bF90YWJsZV9wb2xsIHsKIGF0b21pY190IGV2ZW50
Owogd2FpdF9xdWV1ZV9oZWFkX3Qgd2FpdDsKfTsKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkICpwcm9jX3N5
c19wb2xsX2V2ZW50KHN0cnVjdCBjdGxfdGFibGVfcG9sbCAqcG9sbCkKewogcmV0dXJuICh2
b2lkICopKHVuc2lnbmVkIGxvbmcpYXRvbWljX3JlYWQoJnBvbGwtPmV2ZW50KTsKfQojIDEx
NCAiLi9pbmNsdWRlL2xpbnV4L3N5c2N0bC5oIgpzdHJ1Y3QgY3RsX3RhYmxlIHsKIGNvbnN0
IGNoYXIgKnByb2NuYW1lOwogdm9pZCAqZGF0YTsKIGludCBtYXhsZW47CiB1bW9kZV90IG1v
ZGU7CiBzdHJ1Y3QgY3RsX3RhYmxlICpjaGlsZDsKIHByb2NfaGFuZGxlciAqcHJvY19oYW5k
bGVyOwogc3RydWN0IGN0bF90YWJsZV9wb2xsICpwb2xsOwogdm9pZCAqZXh0cmExOwogdm9p
ZCAqZXh0cmEyOwp9IDsKCnN0cnVjdCBjdGxfbm9kZSB7CiBzdHJ1Y3QgcmJfbm9kZSBub2Rl
Owogc3RydWN0IGN0bF90YWJsZV9oZWFkZXIgKmhlYWRlcjsKfTsKCgoKc3RydWN0IGN0bF90
YWJsZV9oZWFkZXIgewogdW5pb24gewogIHN0cnVjdCB7CiAgIHN0cnVjdCBjdGxfdGFibGUg
KmN0bF90YWJsZTsKICAgaW50IHVzZWQ7CiAgIGludCBjb3VudDsKICAgaW50IG5yZWc7CiAg
fTsKICBzdHJ1Y3QgY2FsbGJhY2tfaGVhZCByY3U7CiB9Owogc3RydWN0IGNvbXBsZXRpb24g
KnVucmVnaXN0ZXJpbmc7CiBzdHJ1Y3QgY3RsX3RhYmxlICpjdGxfdGFibGVfYXJnOwogc3Ry
dWN0IGN0bF90YWJsZV9yb290ICpyb290Owogc3RydWN0IGN0bF90YWJsZV9zZXQgKnNldDsK
IHN0cnVjdCBjdGxfZGlyICpwYXJlbnQ7CiBzdHJ1Y3QgY3RsX25vZGUgKm5vZGU7CiBzdHJ1
Y3QgaGxpc3RfaGVhZCBpbm9kZXM7Cn07CgpzdHJ1Y3QgY3RsX2RpciB7Cgogc3RydWN0IGN0
bF90YWJsZV9oZWFkZXIgaGVhZGVyOwogc3RydWN0IHJiX3Jvb3Qgcm9vdDsKfTsKCnN0cnVj
dCBjdGxfdGFibGVfc2V0IHsKIGludCAoKmlzX3NlZW4pKHN0cnVjdCBjdGxfdGFibGVfc2V0
ICopOwogc3RydWN0IGN0bF9kaXIgZGlyOwp9OwoKc3RydWN0IGN0bF90YWJsZV9yb290IHsK
IHN0cnVjdCBjdGxfdGFibGVfc2V0IGRlZmF1bHRfc2V0Owogc3RydWN0IGN0bF90YWJsZV9z
ZXQgKigqbG9va3VwKShzdHJ1Y3QgY3RsX3RhYmxlX3Jvb3QgKnJvb3QpOwogdm9pZCAoKnNl
dF9vd25lcnNoaXApKHN0cnVjdCBjdGxfdGFibGVfaGVhZGVyICpoZWFkLAogICAgICAgICBz
dHJ1Y3QgY3RsX3RhYmxlICp0YWJsZSwKICAgICAgICAga3VpZF90ICp1aWQsIGtnaWRfdCAq
Z2lkKTsKIGludCAoKnBlcm1pc3Npb25zKShzdHJ1Y3QgY3RsX3RhYmxlX2hlYWRlciAqaGVh
ZCwgc3RydWN0IGN0bF90YWJsZSAqdGFibGUpOwp9OwoKCnN0cnVjdCBjdGxfcGF0aCB7CiBj
b25zdCBjaGFyICpwcm9jbmFtZTsKfTsKCgoKdm9pZCBwcm9jX3N5c19wb2xsX25vdGlmeShz
dHJ1Y3QgY3RsX3RhYmxlX3BvbGwgKnBvbGwpOwoKZXh0ZXJuIHZvaWQgc2V0dXBfc3lzY3Rs
X3NldChzdHJ1Y3QgY3RsX3RhYmxlX3NldCAqcCwKIHN0cnVjdCBjdGxfdGFibGVfcm9vdCAq
cm9vdCwKIGludCAoKmlzX3NlZW4pKHN0cnVjdCBjdGxfdGFibGVfc2V0ICopKTsKZXh0ZXJu
IHZvaWQgcmV0aXJlX3N5c2N0bF9zZXQoc3RydWN0IGN0bF90YWJsZV9zZXQgKnNldCk7Cgpz
dHJ1Y3QgY3RsX3RhYmxlX2hlYWRlciAqX19yZWdpc3Rlcl9zeXNjdGxfdGFibGUoCiBzdHJ1
Y3QgY3RsX3RhYmxlX3NldCAqc2V0LAogY29uc3QgY2hhciAqcGF0aCwgc3RydWN0IGN0bF90
YWJsZSAqdGFibGUpOwpzdHJ1Y3QgY3RsX3RhYmxlX2hlYWRlciAqX19yZWdpc3Rlcl9zeXNj
dGxfcGF0aHMoCiBzdHJ1Y3QgY3RsX3RhYmxlX3NldCAqc2V0LAogY29uc3Qgc3RydWN0IGN0
bF9wYXRoICpwYXRoLCBzdHJ1Y3QgY3RsX3RhYmxlICp0YWJsZSk7CnN0cnVjdCBjdGxfdGFi
bGVfaGVhZGVyICpyZWdpc3Rlcl9zeXNjdGwoY29uc3QgY2hhciAqcGF0aCwgc3RydWN0IGN0
bF90YWJsZSAqdGFibGUpOwpzdHJ1Y3QgY3RsX3RhYmxlX2hlYWRlciAqcmVnaXN0ZXJfc3lz
Y3RsX3RhYmxlKHN0cnVjdCBjdGxfdGFibGUgKiB0YWJsZSk7CnN0cnVjdCBjdGxfdGFibGVf
aGVhZGVyICpyZWdpc3Rlcl9zeXNjdGxfcGF0aHMoY29uc3Qgc3RydWN0IGN0bF9wYXRoICpw
YXRoLAogICAgICBzdHJ1Y3QgY3RsX3RhYmxlICp0YWJsZSk7Cgp2b2lkIHVucmVnaXN0ZXJf
c3lzY3RsX3RhYmxlKHN0cnVjdCBjdGxfdGFibGVfaGVhZGVyICogdGFibGUpOwoKZXh0ZXJu
IGludCBzeXNjdGxfaW5pdCh2b2lkKTsKdm9pZCBkb19zeXNjdGxfYXJncyh2b2lkKTsKCmV4
dGVybiBpbnQgcHdyc3dfZW5hYmxlZDsKZXh0ZXJuIGludCB1bmFsaWduZWRfZW5hYmxlZDsK
ZXh0ZXJuIGludCB1bmFsaWduZWRfZHVtcF9zdGFjazsKZXh0ZXJuIGludCBub191bmFsaWdu
ZWRfd2FybmluZzsKCmV4dGVybiBzdHJ1Y3QgY3RsX3RhYmxlIHN5c2N0bF9tb3VudF9wb2lu
dFtdOwpleHRlcm4gc3RydWN0IGN0bF90YWJsZSByYW5kb21fdGFibGVbXTsKZXh0ZXJuIHN0
cnVjdCBjdGxfdGFibGUgZmlybXdhcmVfY29uZmlnX3RhYmxlW107CmV4dGVybiBzdHJ1Y3Qg
Y3RsX3RhYmxlIGVwb2xsX3RhYmxlW107CiMgMjQ0ICIuL2luY2x1ZGUvbGludXgvc3lzY3Rs
LmgiCmludCBzeXNjdGxfbWF4X3RocmVhZHMoc3RydWN0IGN0bF90YWJsZSAqdGFibGUsIGlu
dCB3cml0ZSwgdm9pZCAqYnVmZmVyLAogIHNpemVfdCAqbGVucCwgbG9mZl90ICpwcG9zKTsK
IyAxOCAiLi9pbmNsdWRlL2xpbnV4L2tleS5oIiAyCgoKIyAxICIuL2luY2x1ZGUvbGludXgv
YXNzb2NfYXJyYXkuaCIgMQojIDIyICIuL2luY2x1ZGUvbGludXgvYXNzb2NfYXJyYXkuaCIK
c3RydWN0IGFzc29jX2FycmF5IHsKIHN0cnVjdCBhc3NvY19hcnJheV9wdHIgKnJvb3Q7CiB1
bnNpZ25lZCBsb25nIG5yX2xlYXZlc19vbl90cmVlOwp9OwoKCgoKc3RydWN0IGFzc29jX2Fy
cmF5X29wcyB7CgogdW5zaWduZWQgbG9uZyAoKmdldF9rZXlfY2h1bmspKGNvbnN0IHZvaWQg
KmluZGV4X2tleSwgaW50IGxldmVsKTsKCgogdW5zaWduZWQgbG9uZyAoKmdldF9vYmplY3Rf
a2V5X2NodW5rKShjb25zdCB2b2lkICpvYmplY3QsIGludCBsZXZlbCk7CgoKIGJvb2wgKCpj
b21wYXJlX29iamVjdCkoY29uc3Qgdm9pZCAqb2JqZWN0LCBjb25zdCB2b2lkICppbmRleF9r
ZXkpOwoKCgoKIGludCAoKmRpZmZfb2JqZWN0cykoY29uc3Qgdm9pZCAqb2JqZWN0LCBjb25z
dCB2b2lkICppbmRleF9rZXkpOwoKCiB2b2lkICgqZnJlZV9vYmplY3QpKHZvaWQgKm9iamVj
dCk7Cn07CgoKCgpzdHJ1Y3QgYXNzb2NfYXJyYXlfZWRpdDsKCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGFz
c29jX2FycmF5X2luaXQoc3RydWN0IGFzc29jX2FycmF5ICphcnJheSkKewogYXJyYXktPnJv
b3QgPSAoKHZvaWQgKikwKTsKIGFycmF5LT5ucl9sZWF2ZXNfb25fdHJlZSA9IDA7Cn0KCmV4
dGVybiBpbnQgYXNzb2NfYXJyYXlfaXRlcmF0ZShjb25zdCBzdHJ1Y3QgYXNzb2NfYXJyYXkg
KmFycmF5LAogICAgICAgICAgaW50ICgqaXRlcmF0b3IpKGNvbnN0IHZvaWQgKm9iamVjdCwK
ICAgICAgICAgICAgdm9pZCAqaXRlcmF0b3JfZGF0YSksCiAgICAgICAgICB2b2lkICppdGVy
YXRvcl9kYXRhKTsKZXh0ZXJuIHZvaWQgKmFzc29jX2FycmF5X2ZpbmQoY29uc3Qgc3RydWN0
IGFzc29jX2FycmF5ICphcnJheSwKICAgICAgICAgY29uc3Qgc3RydWN0IGFzc29jX2FycmF5
X29wcyAqb3BzLAogICAgICAgICBjb25zdCB2b2lkICppbmRleF9rZXkpOwpleHRlcm4gdm9p
ZCBhc3NvY19hcnJheV9kZXN0cm95KHN0cnVjdCBhc3NvY19hcnJheSAqYXJyYXksCiAgICBj
b25zdCBzdHJ1Y3QgYXNzb2NfYXJyYXlfb3BzICpvcHMpOwpleHRlcm4gc3RydWN0IGFzc29j
X2FycmF5X2VkaXQgKmFzc29jX2FycmF5X2luc2VydChzdHJ1Y3QgYXNzb2NfYXJyYXkgKmFy
cmF5LAogICAgICAgICBjb25zdCBzdHJ1Y3QgYXNzb2NfYXJyYXlfb3BzICpvcHMsCiAgICAg
ICAgIGNvbnN0IHZvaWQgKmluZGV4X2tleSwKICAgICAgICAgdm9pZCAqb2JqZWN0KTsKZXh0
ZXJuIHZvaWQgYXNzb2NfYXJyYXlfaW5zZXJ0X3NldF9vYmplY3Qoc3RydWN0IGFzc29jX2Fy
cmF5X2VkaXQgKmVkaXQsCiAgICAgICB2b2lkICpvYmplY3QpOwpleHRlcm4gc3RydWN0IGFz
c29jX2FycmF5X2VkaXQgKmFzc29jX2FycmF5X2RlbGV0ZShzdHJ1Y3QgYXNzb2NfYXJyYXkg
KmFycmF5LAogICAgICAgICBjb25zdCBzdHJ1Y3QgYXNzb2NfYXJyYXlfb3BzICpvcHMsCiAg
ICAgICAgIGNvbnN0IHZvaWQgKmluZGV4X2tleSk7CmV4dGVybiBzdHJ1Y3QgYXNzb2NfYXJy
YXlfZWRpdCAqYXNzb2NfYXJyYXlfY2xlYXIoc3RydWN0IGFzc29jX2FycmF5ICphcnJheSwK
ICAgICAgICBjb25zdCBzdHJ1Y3QgYXNzb2NfYXJyYXlfb3BzICpvcHMpOwpleHRlcm4gdm9p
ZCBhc3NvY19hcnJheV9hcHBseV9lZGl0KHN0cnVjdCBhc3NvY19hcnJheV9lZGl0ICplZGl0
KTsKZXh0ZXJuIHZvaWQgYXNzb2NfYXJyYXlfY2FuY2VsX2VkaXQoc3RydWN0IGFzc29jX2Fy
cmF5X2VkaXQgKmVkaXQpOwpleHRlcm4gaW50IGFzc29jX2FycmF5X2djKHN0cnVjdCBhc3Nv
Y19hcnJheSAqYXJyYXksCiAgICAgY29uc3Qgc3RydWN0IGFzc29jX2FycmF5X29wcyAqb3Bz
LAogICAgIGJvb2wgKCppdGVyYXRvcikodm9pZCAqb2JqZWN0LCB2b2lkICppdGVyYXRvcl9k
YXRhKSwKICAgICB2b2lkICppdGVyYXRvcl9kYXRhKTsKIyAyMSAiLi9pbmNsdWRlL2xpbnV4
L2tleS5oIiAyCgoKCgoKCgp0eXBlZGVmIGludDMyX3Qga2V5X3NlcmlhbF90OwoKCnR5cGVk
ZWYgdWludDMyX3Qga2V5X3Blcm1fdDsKCnN0cnVjdCBrZXk7CnN0cnVjdCBuZXQ7CiMgNzcg
Ii4vaW5jbHVkZS9saW51eC9rZXkuaCIKZW51bSBrZXlfbmVlZF9wZXJtIHsKIEtFWV9ORUVE
X1VOU1BFQ0lGSUVELAogS0VZX05FRURfVklFVywKIEtFWV9ORUVEX1JFQUQsCiBLRVlfTkVF
RF9XUklURSwKIEtFWV9ORUVEX1NFQVJDSCwKIEtFWV9ORUVEX0xJTkssCiBLRVlfTkVFRF9T
RVRBVFRSLAogS0VZX05FRURfVU5MSU5LLAogS0VZX1NZU0FETUlOX09WRVJSSURFLAogS0VZ
X0FVVEhUT0tFTl9PVkVSUklERSwKIEtFWV9ERUZFUl9QRVJNX0NIRUNLLAp9OwoKc3RydWN0
IHNlcV9maWxlOwpzdHJ1Y3QgdXNlcl9zdHJ1Y3Q7CnN0cnVjdCBzaWduYWxfc3RydWN0Owpz
dHJ1Y3QgY3JlZDsKCnN0cnVjdCBrZXlfdHlwZTsKc3RydWN0IGtleV9vd25lcjsKc3RydWN0
IGtleV90YWc7CnN0cnVjdCBrZXlyaW5nX2xpc3Q7CnN0cnVjdCBrZXlyaW5nX25hbWU7Cgpz
dHJ1Y3Qga2V5X3RhZyB7CiBzdHJ1Y3QgY2FsbGJhY2tfaGVhZCByY3U7CiByZWZjb3VudF90
IHVzYWdlOwogYm9vbCByZW1vdmVkOwp9OwoKc3RydWN0IGtleXJpbmdfaW5kZXhfa2V5IHsK
CiB1bnNpZ25lZCBsb25nIGhhc2g7CiB1bmlvbiB7CiAgc3RydWN0IHsKCgoKCiAgIGNoYXIg
ZGVzY1tzaXplb2YobG9uZykgLSAyXTsKICAgdTE2IGRlc2NfbGVuOwoKICB9OwogIHVuc2ln
bmVkIGxvbmcgeDsKIH07CiBzdHJ1Y3Qga2V5X3R5cGUgKnR5cGU7CiBzdHJ1Y3Qga2V5X3Rh
ZyAqZG9tYWluX3RhZzsKIGNvbnN0IGNoYXIgKmRlc2NyaXB0aW9uOwp9OwoKdW5pb24ga2V5
X3BheWxvYWQgewogdm9pZCAqcmN1X2RhdGEwOwogdm9pZCAqZGF0YVs0XTsKfTsKIyAxNDcg
Ii4vaW5jbHVkZS9saW51eC9rZXkuaCIKdHlwZWRlZiBzdHJ1Y3QgX19rZXlfcmVmZXJlbmNl
X3dpdGhfYXR0cmlidXRlcyAqa2V5X3JlZl90OwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGtleV9yZWZfdCBtYWtl
X2tleV9yZWYoY29uc3Qgc3RydWN0IGtleSAqa2V5LAogICAgICAgICBib29sIHBvc3Nlc3Np
b24pCnsKIHJldHVybiAoa2V5X3JlZl90KSAoKHVuc2lnbmVkIGxvbmcpIGtleSB8IHBvc3Nl
c3Npb24pOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IGtleSAqa2V5X3JlZl90b19wdHIoY29uc3Qg
a2V5X3JlZl90IGtleV9yZWYpCnsKIHJldHVybiAoc3RydWN0IGtleSAqKSAoKHVuc2lnbmVk
IGxvbmcpIGtleV9yZWYgJiB+MVVMKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgaXNfa2V5X3Bvc3Nl
c3NlZChjb25zdCBrZXlfcmVmX3Qga2V5X3JlZikKewogcmV0dXJuICh1bnNpZ25lZCBsb25n
KSBrZXlfcmVmICYgMVVMOwp9Cgp0eXBlZGVmIGludCAoKmtleV9yZXN0cmljdF9saW5rX2Z1
bmNfdCkoc3RydWN0IGtleSAqZGVzdF9rZXlyaW5nLAogICAgIGNvbnN0IHN0cnVjdCBrZXlf
dHlwZSAqdHlwZSwKICAgICBjb25zdCB1bmlvbiBrZXlfcGF5bG9hZCAqcGF5bG9hZCwKICAg
ICBzdHJ1Y3Qga2V5ICpyZXN0cmljdGlvbl9rZXkpOwoKc3RydWN0IGtleV9yZXN0cmljdGlv
biB7CiBrZXlfcmVzdHJpY3RfbGlua19mdW5jX3QgY2hlY2s7CiBzdHJ1Y3Qga2V5ICprZXk7
CiBzdHJ1Y3Qga2V5X3R5cGUgKmtleXR5cGU7Cn07CgplbnVtIGtleV9zdGF0ZSB7CiBLRVlf
SVNfVU5JTlNUQU5USUFURUQsCiBLRVlfSVNfUE9TSVRJVkUsCn07CiMgMTg5ICIuL2luY2x1
ZGUvbGludXgva2V5LmgiCnN0cnVjdCBrZXkgewogcmVmY291bnRfdCB1c2FnZTsKIGtleV9z
ZXJpYWxfdCBzZXJpYWw7CiB1bmlvbiB7CiAgc3RydWN0IGxpc3RfaGVhZCBncmF2ZXlhcmRf
bGluazsKICBzdHJ1Y3QgcmJfbm9kZSBzZXJpYWxfbm9kZTsKIH07CgoKCiBzdHJ1Y3Qgcndf
c2VtYXBob3JlIHNlbTsKIHN0cnVjdCBrZXlfdXNlciAqdXNlcjsKIHZvaWQgKnNlY3VyaXR5
OwogdW5pb24gewogIHRpbWU2NF90IGV4cGlyeTsKICB0aW1lNjRfdCByZXZva2VkX2F0Owog
fTsKIHRpbWU2NF90IGxhc3RfdXNlZF9hdDsKIGt1aWRfdCB1aWQ7CiBrZ2lkX3QgZ2lkOwog
a2V5X3Blcm1fdCBwZXJtOwogdW5zaWduZWQgc2hvcnQgcXVvdGFsZW47CiB1bnNpZ25lZCBz
aG9ydCBkYXRhbGVuOwoKCgogc2hvcnQgc3RhdGU7CgoKCgoKCiB1bnNpZ25lZCBsb25nIGZs
YWdzOwojIDIzOSAiLi9pbmNsdWRlL2xpbnV4L2tleS5oIgogdW5pb24gewogIHN0cnVjdCBr
ZXlyaW5nX2luZGV4X2tleSBpbmRleF9rZXk7CiAgc3RydWN0IHsKICAgdW5zaWduZWQgbG9u
ZyBoYXNoOwogICB1bnNpZ25lZCBsb25nIGxlbl9kZXNjOwogICBzdHJ1Y3Qga2V5X3R5cGUg
KnR5cGU7CiAgIHN0cnVjdCBrZXlfdGFnICpkb21haW5fdGFnOwogICBjaGFyICpkZXNjcmlw
dGlvbjsKICB9OwogfTsKCgoKCgogdW5pb24gewogIHVuaW9uIGtleV9wYXlsb2FkIHBheWxv
YWQ7CiAgc3RydWN0IHsKCiAgIHN0cnVjdCBsaXN0X2hlYWQgbmFtZV9saW5rOwogICBzdHJ1
Y3QgYXNzb2NfYXJyYXkga2V5czsKICB9OwogfTsKIyAyNzQgIi4vaW5jbHVkZS9saW51eC9r
ZXkuaCIKIHN0cnVjdCBrZXlfcmVzdHJpY3Rpb24gKnJlc3RyaWN0X2xpbms7Cn07CgpleHRl
cm4gc3RydWN0IGtleSAqa2V5X2FsbG9jKHN0cnVjdCBrZXlfdHlwZSAqdHlwZSwKICAgICAg
ICBjb25zdCBjaGFyICpkZXNjLAogICAgICAgIGt1aWRfdCB1aWQsIGtnaWRfdCBnaWQsCiAg
ICAgICAgY29uc3Qgc3RydWN0IGNyZWQgKmNyZWQsCiAgICAgICAga2V5X3Blcm1fdCBwZXJt
LAogICAgICAgIHVuc2lnbmVkIGxvbmcgZmxhZ3MsCiAgICAgICAgc3RydWN0IGtleV9yZXN0
cmljdGlvbiAqcmVzdHJpY3RfbGluayk7CiMgMjkzICIuL2luY2x1ZGUvbGludXgva2V5Lmgi
CmV4dGVybiB2b2lkIGtleV9yZXZva2Uoc3RydWN0IGtleSAqa2V5KTsKZXh0ZXJuIHZvaWQg
a2V5X2ludmFsaWRhdGUoc3RydWN0IGtleSAqa2V5KTsKZXh0ZXJuIHZvaWQga2V5X3B1dChz
dHJ1Y3Qga2V5ICprZXkpOwpleHRlcm4gYm9vbCBrZXlfcHV0X3RhZyhzdHJ1Y3Qga2V5X3Rh
ZyAqdGFnKTsKZXh0ZXJuIHZvaWQga2V5X3JlbW92ZV9kb21haW4oc3RydWN0IGtleV90YWcg
KmRvbWFpbl90YWcpOwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHN0cnVjdCBrZXkgKl9fa2V5X2dldChzdHJ1Y3Qg
a2V5ICprZXkpCnsKIHJlZmNvdW50X2luYygma2V5LT51c2FnZSk7CiByZXR1cm4ga2V5Owp9
CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgc3RydWN0IGtleSAqa2V5X2dldChzdHJ1Y3Qga2V5ICprZXkpCnsKIHJl
dHVybiBrZXkgPyBfX2tleV9nZXQoa2V5KSA6IGtleTsKfQoKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQga2V5
X3JlZl9wdXQoa2V5X3JlZl90IGtleV9yZWYpCnsKIGtleV9wdXQoa2V5X3JlZl90b19wdHIo
a2V5X3JlZikpOwp9CgpleHRlcm4gc3RydWN0IGtleSAqcmVxdWVzdF9rZXlfdGFnKHN0cnVj
dCBrZXlfdHlwZSAqdHlwZSwKICAgICAgIGNvbnN0IGNoYXIgKmRlc2NyaXB0aW9uLAogICAg
ICAgc3RydWN0IGtleV90YWcgKmRvbWFpbl90YWcsCiAgICAgICBjb25zdCBjaGFyICpjYWxs
b3V0X2luZm8pOwoKZXh0ZXJuIHN0cnVjdCBrZXkgKnJlcXVlc3Rfa2V5X3JjdShzdHJ1Y3Qg
a2V5X3R5cGUgKnR5cGUsCiAgICAgICBjb25zdCBjaGFyICpkZXNjcmlwdGlvbiwKICAgICAg
IHN0cnVjdCBrZXlfdGFnICpkb21haW5fdGFnKTsKCmV4dGVybiBzdHJ1Y3Qga2V5ICpyZXF1
ZXN0X2tleV93aXRoX2F1eGRhdGEoc3RydWN0IGtleV90eXBlICp0eXBlLAogICAgICAgICBj
b25zdCBjaGFyICpkZXNjcmlwdGlvbiwKICAgICAgICAgc3RydWN0IGtleV90YWcgKmRvbWFp
bl90YWcsCiAgICAgICAgIGNvbnN0IHZvaWQgKmNhbGxvdXRfaW5mbywKICAgICAgICAgc2l6
ZV90IGNhbGxvdXRfbGVuLAogICAgICAgICB2b2lkICphdXgpOwojIDMzOSAiLi9pbmNsdWRl
L2xpbnV4L2tleS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IGtleSAqcmVxdWVzdF9rZXkoc3RydWN0
IGtleV90eXBlICp0eXBlLAogICAgICAgICAgY29uc3QgY2hhciAqZGVzY3JpcHRpb24sCiAg
ICAgICAgICBjb25zdCBjaGFyICpjYWxsb3V0X2luZm8pCnsKIHJldHVybiByZXF1ZXN0X2tl
eV90YWcodHlwZSwgZGVzY3JpcHRpb24sICgodm9pZCAqKTApLCBjYWxsb3V0X2luZm8pOwp9
CiMgMzc4ICIuL2luY2x1ZGUvbGludXgva2V5LmgiCmV4dGVybiBpbnQgd2FpdF9mb3Jfa2V5
X2NvbnN0cnVjdGlvbihzdHJ1Y3Qga2V5ICprZXksIGJvb2wgaW50cik7CgpleHRlcm4gaW50
IGtleV92YWxpZGF0ZShjb25zdCBzdHJ1Y3Qga2V5ICprZXkpOwoKZXh0ZXJuIGtleV9yZWZf
dCBrZXlfY3JlYXRlX29yX3VwZGF0ZShrZXlfcmVmX3Qga2V5cmluZywKICAgICAgICAgIGNv
bnN0IGNoYXIgKnR5cGUsCiAgICAgICAgICBjb25zdCBjaGFyICpkZXNjcmlwdGlvbiwKICAg
ICAgICAgIGNvbnN0IHZvaWQgKnBheWxvYWQsCiAgICAgICAgICBzaXplX3QgcGxlbiwKICAg
ICAgICAgIGtleV9wZXJtX3QgcGVybSwKICAgICAgICAgIHVuc2lnbmVkIGxvbmcgZmxhZ3Mp
OwoKZXh0ZXJuIGludCBrZXlfdXBkYXRlKGtleV9yZWZfdCBrZXksCiAgICAgICAgY29uc3Qg
dm9pZCAqcGF5bG9hZCwKICAgICAgICBzaXplX3QgcGxlbik7CgpleHRlcm4gaW50IGtleV9s
aW5rKHN0cnVjdCBrZXkgKmtleXJpbmcsCiAgICAgIHN0cnVjdCBrZXkgKmtleSk7CgpleHRl
cm4gaW50IGtleV9tb3ZlKHN0cnVjdCBrZXkgKmtleSwKICAgICAgc3RydWN0IGtleSAqZnJv
bV9rZXlyaW5nLAogICAgICBzdHJ1Y3Qga2V5ICp0b19rZXlyaW5nLAogICAgICB1bnNpZ25l
ZCBpbnQgZmxhZ3MpOwoKZXh0ZXJuIGludCBrZXlfdW5saW5rKHN0cnVjdCBrZXkgKmtleXJp
bmcsCiAgICAgICAgc3RydWN0IGtleSAqa2V5KTsKCmV4dGVybiBzdHJ1Y3Qga2V5ICprZXly
aW5nX2FsbG9jKGNvbnN0IGNoYXIgKmRlc2NyaXB0aW9uLCBrdWlkX3QgdWlkLCBrZ2lkX3Qg
Z2lkLAogICAgIGNvbnN0IHN0cnVjdCBjcmVkICpjcmVkLAogICAgIGtleV9wZXJtX3QgcGVy
bSwKICAgICB1bnNpZ25lZCBsb25nIGZsYWdzLAogICAgIHN0cnVjdCBrZXlfcmVzdHJpY3Rp
b24gKnJlc3RyaWN0X2xpbmssCiAgICAgc3RydWN0IGtleSAqZGVzdCk7CgpleHRlcm4gaW50
IHJlc3RyaWN0X2xpbmtfcmVqZWN0KHN0cnVjdCBrZXkgKmtleXJpbmcsCiAgICBjb25zdCBz
dHJ1Y3Qga2V5X3R5cGUgKnR5cGUsCiAgICBjb25zdCB1bmlvbiBrZXlfcGF5bG9hZCAqcGF5
bG9hZCwKICAgIHN0cnVjdCBrZXkgKnJlc3RyaWN0aW9uX2tleSk7CgpleHRlcm4gaW50IGtl
eXJpbmdfY2xlYXIoc3RydWN0IGtleSAqa2V5cmluZyk7CgpleHRlcm4ga2V5X3JlZl90IGtl
eXJpbmdfc2VhcmNoKGtleV9yZWZfdCBrZXlyaW5nLAogICAgc3RydWN0IGtleV90eXBlICp0
eXBlLAogICAgY29uc3QgY2hhciAqZGVzY3JpcHRpb24sCiAgICBib29sIHJlY3Vyc2UpOwoK
ZXh0ZXJuIGludCBrZXlyaW5nX2FkZF9rZXkoc3RydWN0IGtleSAqa2V5cmluZywKICAgICAg
c3RydWN0IGtleSAqa2V5KTsKCmV4dGVybiBpbnQga2V5cmluZ19yZXN0cmljdChrZXlfcmVm
X3Qga2V5cmluZywgY29uc3QgY2hhciAqdHlwZSwKICAgICAgIGNvbnN0IGNoYXIgKnJlc3Ry
aWN0aW9uKTsKCmV4dGVybiBzdHJ1Y3Qga2V5ICprZXlfbG9va3VwKGtleV9zZXJpYWxfdCBp
ZCk7CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkga2V5X3NlcmlhbF90IGtleV9zZXJpYWwoY29uc3Qgc3RydWN0IGtl
eSAqa2V5KQp7CiByZXR1cm4ga2V5ID8ga2V5LT5zZXJpYWwgOiAwOwp9CgpleHRlcm4gdm9p
ZCBrZXlfc2V0X3RpbWVvdXQoc3RydWN0IGtleSAqLCB1bnNpZ25lZCk7CgpleHRlcm4ga2V5
X3JlZl90IGxvb2t1cF91c2VyX2tleShrZXlfc2VyaWFsX3QgaWQsIHVuc2lnbmVkIGxvbmcg
ZmxhZ3MsCiAgICAgZW51bSBrZXlfbmVlZF9wZXJtIG5lZWRfcGVybSk7CmV4dGVybiB2b2lk
IGtleV9mcmVlX3VzZXJfbnMoc3RydWN0IHVzZXJfbmFtZXNwYWNlICopOwoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IHNob3J0IGtleV9yZWFkX3N0YXRlKGNvbnN0IHN0cnVjdCBrZXkgKmtleSkKewoKIHJldHVy
biAoeyB0eXBlb2YoKiZrZXktPnN0YXRlKSBfX19wMSA9ICh7IGRvIHsgZXh0ZXJuIHZvaWQg
X19jb21waWxldGltZV9hc3NlcnRfMTU1KHZvaWQpIF9fYXR0cmlidXRlX18oKF9fZXJyb3Jf
XygiVW5zdXBwb3J0ZWQgYWNjZXNzIHNpemUgZm9yIHtSRUFELFdSSVRFfV9PTkNFKCkuIikp
KTsgaWYgKCEoKHNpemVvZigqJmtleS0+c3RhdGUpID09IHNpemVvZihjaGFyKSB8fCBzaXpl
b2YoKiZrZXktPnN0YXRlKSA9PSBzaXplb2Yoc2hvcnQpIHx8IHNpemVvZigqJmtleS0+c3Rh
dGUpID09IHNpemVvZihpbnQpIHx8IHNpemVvZigqJmtleS0+c3RhdGUpID09IHNpemVvZihs
b25nKSkgfHwgc2l6ZW9mKComa2V5LT5zdGF0ZSkgPT0gc2l6ZW9mKGxvbmcgbG9uZykpKSBf
X2NvbXBpbGV0aW1lX2Fzc2VydF8xNTUoKTsgfSB3aGlsZSAoMCk7ICh7IHR5cGVvZiggX0dl
bmVyaWMoKComa2V5LT5zdGF0ZSksIGNoYXI6IChjaGFyKTAsIHVuc2lnbmVkIGNoYXI6ICh1
bnNpZ25lZCBjaGFyKTAsIHNpZ25lZCBjaGFyOiAoc2lnbmVkIGNoYXIpMCwgdW5zaWduZWQg
c2hvcnQ6ICh1bnNpZ25lZCBzaG9ydCkwLCBzaWduZWQgc2hvcnQ6IChzaWduZWQgc2hvcnQp
MCwgdW5zaWduZWQgaW50OiAodW5zaWduZWQgaW50KTAsIHNpZ25lZCBpbnQ6IChzaWduZWQg
aW50KTAsIHVuc2lnbmVkIGxvbmc6ICh1bnNpZ25lZCBsb25nKTAsIHNpZ25lZCBsb25nOiAo
c2lnbmVkIGxvbmcpMCwgdW5zaWduZWQgbG9uZyBsb25nOiAodW5zaWduZWQgbG9uZyBsb25n
KTAsIHNpZ25lZCBsb25nIGxvbmc6IChzaWduZWQgbG9uZyBsb25nKTAsIGRlZmF1bHQ6ICgq
JmtleS0+c3RhdGUpKSkgX194ID0gKCooY29uc3Qgdm9sYXRpbGUgdHlwZW9mKCBfR2VuZXJp
YygoKiZrZXktPnN0YXRlKSwgY2hhcjogKGNoYXIpMCwgdW5zaWduZWQgY2hhcjogKHVuc2ln
bmVkIGNoYXIpMCwgc2lnbmVkIGNoYXI6IChzaWduZWQgY2hhcikwLCB1bnNpZ25lZCBzaG9y
dDogKHVuc2lnbmVkIHNob3J0KTAsIHNpZ25lZCBzaG9ydDogKHNpZ25lZCBzaG9ydCkwLCB1
bnNpZ25lZCBpbnQ6ICh1bnNpZ25lZCBpbnQpMCwgc2lnbmVkIGludDogKHNpZ25lZCBpbnQp
MCwgdW5zaWduZWQgbG9uZzogKHVuc2lnbmVkIGxvbmcpMCwgc2lnbmVkIGxvbmc6IChzaWdu
ZWQgbG9uZykwLCB1bnNpZ25lZCBsb25nIGxvbmc6ICh1bnNpZ25lZCBsb25nIGxvbmcpMCwg
c2lnbmVkIGxvbmcgbG9uZzogKHNpZ25lZCBsb25nIGxvbmcpMCwgZGVmYXVsdDogKComa2V5
LT5zdGF0ZSkpKSAqKSYoKiZrZXktPnN0YXRlKSk7IGRvIHsgfSB3aGlsZSAoMCk7ICh0eXBl
b2YoKiZrZXktPnN0YXRlKSlfX3g7IH0pOyB9KTsgZG8geyBleHRlcm4gdm9pZCBfX2NvbXBp
bGV0aW1lX2Fzc2VydF8xNTYodm9pZCkgX19hdHRyaWJ1dGVfXygoX19lcnJvcl9fKCJOZWVk
IG5hdGl2ZSB3b3JkIHNpemVkIHN0b3Jlcy9sb2FkcyBmb3IgYXRvbWljaXR5LiIpKSk7IGlm
ICghKChzaXplb2YoKiZrZXktPnN0YXRlKSA9PSBzaXplb2YoY2hhcikgfHwgc2l6ZW9mKCom
a2V5LT5zdGF0ZSkgPT0gc2l6ZW9mKHNob3J0KSB8fCBzaXplb2YoKiZrZXktPnN0YXRlKSA9
PSBzaXplb2YoaW50KSB8fCBzaXplb2YoKiZrZXktPnN0YXRlKSA9PSBzaXplb2YobG9uZykp
KSkgX19jb21waWxldGltZV9hc3NlcnRfMTU2KCk7IH0gd2hpbGUgKDApOyBfX2FzbV9fIF9f
dm9sYXRpbGVfXyAoImx3c3luYyIgIiAiIDogOiA6Im1lbW9yeSIpOyBfX19wMTsgfSk7Cn0K
IyA0NTYgIi4vaW5jbHVkZS9saW51eC9rZXkuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wga2V5X2lzX3Bv
c2l0aXZlKGNvbnN0IHN0cnVjdCBrZXkgKmtleSkKewogcmV0dXJuIGtleV9yZWFkX3N0YXRl
KGtleSkgPT0gS0VZX0lTX1BPU0lUSVZFOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBrZXlfaXNfbmVn
YXRpdmUoY29uc3Qgc3RydWN0IGtleSAqa2V5KQp7CiByZXR1cm4ga2V5X3JlYWRfc3RhdGUo
a2V5KSA8IDA7Cn0KIyA0NzkgIi4vaW5jbHVkZS9saW51eC9rZXkuaCIKZXh0ZXJuIHN0cnVj
dCBjdGxfdGFibGUga2V5X3N5c2N0bHNbXTsKCgoKCmV4dGVybiBpbnQgaW5zdGFsbF90aHJl
YWRfa2V5cmluZ190b19jcmVkKHN0cnVjdCBjcmVkICpjcmVkKTsKZXh0ZXJuIHZvaWQga2V5
X2ZzdWlkX2NoYW5nZWQoc3RydWN0IGNyZWQgKm5ld19jcmVkKTsKZXh0ZXJuIHZvaWQga2V5
X2ZzZ2lkX2NoYW5nZWQoc3RydWN0IGNyZWQgKm5ld19jcmVkKTsKZXh0ZXJuIHZvaWQga2V5
X2luaXQodm9pZCk7CiMgMTQgIi4vaW5jbHVkZS9saW51eC9jcmVkLmgiIDIKCgoKIyAxICIu
L2luY2x1ZGUvbGludXgvc2NoZWQvdXNlci5oIiAxCgoKCgoKCgojIDEgIi4vaW5jbHVkZS9s
aW51eC9yYXRlbGltaXQuaCIgMQojIDE1ICIuL2luY2x1ZGUvbGludXgvcmF0ZWxpbWl0Lmgi
CnN0cnVjdCByYXRlbGltaXRfc3RhdGUgewogcmF3X3NwaW5sb2NrX3QgbG9jazsKCiBpbnQg
aW50ZXJ2YWw7CiBpbnQgYnVyc3Q7CiBpbnQgcHJpbnRlZDsKIGludCBtaXNzZWQ7CiB1bnNp
Z25lZCBsb25nIGJlZ2luOwogdW5zaWduZWQgbG9uZyBmbGFnczsKfTsKIyA0MCAiLi9pbmNs
dWRlL2xpbnV4L3JhdGVsaW1pdC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCByYXRlbGltaXRfc3RhdGVf
aW5pdChzdHJ1Y3QgcmF0ZWxpbWl0X3N0YXRlICpycywKICAgICBpbnQgaW50ZXJ2YWwsIGlu
dCBidXJzdCkKewogbWVtc2V0KHJzLCAwLCBzaXplb2YoKnJzKSk7CgogZG8geyAqKCZycy0+
bG9jaykgPSAocmF3X3NwaW5sb2NrX3QpIHsgLnJhd19sb2NrID0geyAwIH0sIH07IH0gd2hp
bGUgKDApOwogcnMtPmludGVydmFsID0gaW50ZXJ2YWw7CiBycy0+YnVyc3QgPSBidXJzdDsK
fQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIHZvaWQgcmF0ZWxpbWl0X2RlZmF1bHRfaW5pdChzdHJ1Y3QgcmF0ZWxp
bWl0X3N0YXRlICpycykKewogcmV0dXJuIHJhdGVsaW1pdF9zdGF0ZV9pbml0KHJzLCAoNSAq
IDI1MCksCiAgICAgMTApOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCByYXRlbGltaXRfc3RhdGVfZXhp
dChzdHJ1Y3QgcmF0ZWxpbWl0X3N0YXRlICpycykKewogaWYgKCEocnMtPmZsYWdzICYgKCgo
KDFVTCkpKSA8PCAoMCkpKSkKICByZXR1cm47CgogaWYgKHJzLT5taXNzZWQpIHsKICBwcmlu
dGsoIlwwMDEiICI0IiAiJXM6ICVkIG91dHB1dCBsaW5lcyBzdXBwcmVzc2VkIGR1ZSB0byBy
YXRlbGltaXRpbmdcbiIsIGdldF9jdXJyZW50KCktPmNvbW0sIHJzLT5taXNzZWQpCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgOwogIHJzLT5taXNzZWQgPSAwOwogfQp9CgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgdm9pZApyYXRlbGltaXRfc2V0X2ZsYWdzKHN0cnVjdCByYXRlbGltaXRfc3RhdGUg
KnJzLCB1bnNpZ25lZCBsb25nIGZsYWdzKQp7CiBycy0+ZmxhZ3MgPSBmbGFnczsKfQoKZXh0
ZXJuIHN0cnVjdCByYXRlbGltaXRfc3RhdGUgcHJpbnRrX3JhdGVsaW1pdF9zdGF0ZTsKCmV4
dGVybiBpbnQgX19fcmF0ZWxpbWl0KHN0cnVjdCByYXRlbGltaXRfc3RhdGUgKnJzLCBjb25z
dCBjaGFyICpmdW5jKTsKIyA5ICIuL2luY2x1ZGUvbGludXgvc2NoZWQvdXNlci5oIiAyCgoK
CgpzdHJ1Y3QgdXNlcl9zdHJ1Y3QgewogcmVmY291bnRfdCBfX2NvdW50OwogYXRvbWljX3Qg
cHJvY2Vzc2VzOwogYXRvbWljX3Qgc2lncGVuZGluZzsKCgoKCiBhdG9taWNfbG9uZ190IGVw
b2xsX3dhdGNoZXM7CgoKCiB1bnNpZ25lZCBsb25nIG1xX2J5dGVzOwoKIHVuc2lnbmVkIGxv
bmcgbG9ja2VkX3NobTsKIHVuc2lnbmVkIGxvbmcgdW5peF9pbmZsaWdodDsKIGF0b21pY19s
b25nX3QgcGlwZV9idWZzOwoKCiBzdHJ1Y3QgaGxpc3Rfbm9kZSB1aWRoYXNoX25vZGU7CiBr
dWlkX3QgdWlkOwoKCgogYXRvbWljX2xvbmdfdCBsb2NrZWRfdm07CgoKCiBzdHJ1Y3QgcmF0
ZWxpbWl0X3N0YXRlIHJhdGVsaW1pdDsKfTsKCmV4dGVybiBpbnQgdWlkc19zeXNmc19pbml0
KHZvaWQpOwoKZXh0ZXJuIHN0cnVjdCB1c2VyX3N0cnVjdCAqZmluZF91c2VyKGt1aWRfdCk7
CgpleHRlcm4gc3RydWN0IHVzZXJfc3RydWN0IHJvb3RfdXNlcjsKCgoKCmV4dGVybiBzdHJ1
Y3QgdXNlcl9zdHJ1Y3QgKiBhbGxvY191aWQoa3VpZF90KTsKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHN0cnVjdCB1
c2VyX3N0cnVjdCAqZ2V0X3VpZChzdHJ1Y3QgdXNlcl9zdHJ1Y3QgKnUpCnsKIHJlZmNvdW50
X2luYygmdS0+X19jb3VudCk7CiByZXR1cm4gdTsKfQpleHRlcm4gdm9pZCBmcmVlX3VpZChz
dHJ1Y3QgdXNlcl9zdHJ1Y3QgKik7CiMgMTggIi4vaW5jbHVkZS9saW51eC9jcmVkLmgiIDIK
CnN0cnVjdCBjcmVkOwpzdHJ1Y3QgaW5vZGU7CgoKCgpzdHJ1Y3QgZ3JvdXBfaW5mbyB7CiBh
dG9taWNfdCB1c2FnZTsKIGludCBuZ3JvdXBzOwoga2dpZF90IGdpZFswXTsKfSA7CiMgNDAg
Ii4vaW5jbHVkZS9saW51eC9jcmVkLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3QgZ3JvdXBfaW5mbyAq
Z2V0X2dyb3VwX2luZm8oc3RydWN0IGdyb3VwX2luZm8gKmdpKQp7CiBhdG9taWNfaW5jKCZn
aS0+dXNhZ2UpOwogcmV0dXJuIGdpOwp9CiMgNTYgIi4vaW5jbHVkZS9saW51eC9jcmVkLmgi
CmV4dGVybiBzdHJ1Y3QgZ3JvdXBfaW5mbyBpbml0X2dyb3VwczsKCmV4dGVybiBzdHJ1Y3Qg
Z3JvdXBfaW5mbyAqZ3JvdXBzX2FsbG9jKGludCk7CmV4dGVybiB2b2lkIGdyb3Vwc19mcmVl
KHN0cnVjdCBncm91cF9pbmZvICopOwoKZXh0ZXJuIGludCBpbl9ncm91cF9wKGtnaWRfdCk7
CmV4dGVybiBpbnQgaW5fZWdyb3VwX3Aoa2dpZF90KTsKZXh0ZXJuIGludCBncm91cHNfc2Vh
cmNoKGNvbnN0IHN0cnVjdCBncm91cF9pbmZvICosIGtnaWRfdCk7CgpleHRlcm4gaW50IHNl
dF9jdXJyZW50X2dyb3VwcyhzdHJ1Y3QgZ3JvdXBfaW5mbyAqKTsKZXh0ZXJuIHZvaWQgc2V0
X2dyb3VwcyhzdHJ1Y3QgY3JlZCAqLCBzdHJ1Y3QgZ3JvdXBfaW5mbyAqKTsKZXh0ZXJuIGJv
b2wgbWF5X3NldGdyb3Vwcyh2b2lkKTsKZXh0ZXJuIHZvaWQgZ3JvdXBzX3NvcnQoc3RydWN0
IGdyb3VwX2luZm8gKik7CiMgMTExICIuL2luY2x1ZGUvbGludXgvY3JlZC5oIgpzdHJ1Y3Qg
Y3JlZCB7CiBhdG9taWNfdCB1c2FnZTsKCgoKCgoKCiBrdWlkX3QgdWlkOwoga2dpZF90IGdp
ZDsKIGt1aWRfdCBzdWlkOwoga2dpZF90IHNnaWQ7CiBrdWlkX3QgZXVpZDsKIGtnaWRfdCBl
Z2lkOwoga3VpZF90IGZzdWlkOwoga2dpZF90IGZzZ2lkOwogdW5zaWduZWQgc2VjdXJlYml0
czsKIGtlcm5lbF9jYXBfdCBjYXBfaW5oZXJpdGFibGU7CiBrZXJuZWxfY2FwX3QgY2FwX3Bl
cm1pdHRlZDsKIGtlcm5lbF9jYXBfdCBjYXBfZWZmZWN0aXZlOwoga2VybmVsX2NhcF90IGNh
cF9ic2V0Owoga2VybmVsX2NhcF90IGNhcF9hbWJpZW50OwoKIHVuc2lnbmVkIGNoYXIgaml0
X2tleXJpbmc7Cgogc3RydWN0IGtleSAqc2Vzc2lvbl9rZXlyaW5nOwogc3RydWN0IGtleSAq
cHJvY2Vzc19rZXlyaW5nOwogc3RydWN0IGtleSAqdGhyZWFkX2tleXJpbmc7CiBzdHJ1Y3Qg
a2V5ICpyZXF1ZXN0X2tleV9hdXRoOwoKCgoKIHN0cnVjdCB1c2VyX3N0cnVjdCAqdXNlcjsK
IHN0cnVjdCB1c2VyX25hbWVzcGFjZSAqdXNlcl9uczsKIHN0cnVjdCBncm91cF9pbmZvICpn
cm91cF9pbmZvOwoKIHVuaW9uIHsKICBpbnQgbm9uX3JjdTsKICBzdHJ1Y3QgY2FsbGJhY2tf
aGVhZCByY3U7CiB9Owp9IDsKCmV4dGVybiB2b2lkIF9fcHV0X2NyZWQoc3RydWN0IGNyZWQg
Kik7CmV4dGVybiB2b2lkIGV4aXRfY3JlZHMoc3RydWN0IHRhc2tfc3RydWN0ICopOwpleHRl
cm4gaW50IGNvcHlfY3JlZHMoc3RydWN0IHRhc2tfc3RydWN0ICosIHVuc2lnbmVkIGxvbmcp
OwpleHRlcm4gY29uc3Qgc3RydWN0IGNyZWQgKmdldF90YXNrX2NyZWQoc3RydWN0IHRhc2tf
c3RydWN0ICopOwpleHRlcm4gc3RydWN0IGNyZWQgKmNyZWRfYWxsb2NfYmxhbmsodm9pZCk7
CmV4dGVybiBzdHJ1Y3QgY3JlZCAqcHJlcGFyZV9jcmVkcyh2b2lkKTsKZXh0ZXJuIHN0cnVj
dCBjcmVkICpwcmVwYXJlX2V4ZWNfY3JlZHModm9pZCk7CmV4dGVybiBpbnQgY29tbWl0X2Ny
ZWRzKHN0cnVjdCBjcmVkICopOwpleHRlcm4gdm9pZCBhYm9ydF9jcmVkcyhzdHJ1Y3QgY3Jl
ZCAqKTsKZXh0ZXJuIGNvbnN0IHN0cnVjdCBjcmVkICpvdmVycmlkZV9jcmVkcyhjb25zdCBz
dHJ1Y3QgY3JlZCAqKTsKZXh0ZXJuIHZvaWQgcmV2ZXJ0X2NyZWRzKGNvbnN0IHN0cnVjdCBj
cmVkICopOwpleHRlcm4gc3RydWN0IGNyZWQgKnByZXBhcmVfa2VybmVsX2NyZWQoc3RydWN0
IHRhc2tfc3RydWN0ICopOwpleHRlcm4gaW50IGNoYW5nZV9jcmVhdGVfZmlsZXNfYXMoc3Ry
dWN0IGNyZWQgKiwgc3RydWN0IGlub2RlICopOwpleHRlcm4gaW50IHNldF9zZWN1cml0eV9v
dmVycmlkZShzdHJ1Y3QgY3JlZCAqLCB1MzIpOwpleHRlcm4gaW50IHNldF9zZWN1cml0eV9v
dmVycmlkZV9mcm9tX2N0eChzdHJ1Y3QgY3JlZCAqLCBjb25zdCBjaGFyICopOwpleHRlcm4g
aW50IHNldF9jcmVhdGVfZmlsZXNfYXMoc3RydWN0IGNyZWQgKiwgc3RydWN0IGlub2RlICop
OwpleHRlcm4gaW50IGNyZWRfZnNjbXAoY29uc3Qgc3RydWN0IGNyZWQgKiwgY29uc3Qgc3Ry
dWN0IGNyZWQgKik7CmV4dGVybiB2b2lkIF9fYXR0cmlidXRlX18oKF9fc2VjdGlvbl9fKCIu
aW5pdC50ZXh0IikpKSBfX2F0dHJpYnV0ZV9fKChfX2NvbGRfXykpIGNyZWRfaW5pdCh2b2lk
KTsKIyAyMDMgIi4vaW5jbHVkZS9saW51eC9jcmVkLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHZhbGlk
YXRlX2NyZWRzKGNvbnN0IHN0cnVjdCBjcmVkICpjcmVkKQp7Cn0Kc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQg
dmFsaWRhdGVfY3JlZHNfZm9yX2RvX2V4aXQoc3RydWN0IHRhc2tfc3RydWN0ICp0c2spCnsK
fQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgdm9pZCB2YWxpZGF0ZV9wcm9jZXNzX2NyZWRzKHZvaWQpCnsKfQoKCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSBib29sIGNhcF9hbWJpZW50X2ludmFyaWFudF9vayhjb25zdCBzdHJ1Y3QgY3Jl
ZCAqY3JlZCkKewogcmV0dXJuIGNhcF9pc3N1YnNldChjcmVkLT5jYXBfYW1iaWVudCwKICAg
ICAgIGNhcF9pbnRlcnNlY3QoY3JlZC0+Y2FwX3Blcm1pdHRlZCwKICAgICAgIGNyZWQtPmNh
cF9pbmhlcml0YWJsZSkpOwp9CiMgMjI4ICIuL2luY2x1ZGUvbGludXgvY3JlZC5oIgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgc3RydWN0IGNyZWQgKmdldF9uZXdfY3JlZChzdHJ1Y3QgY3JlZCAqY3JlZCkKewog
YXRvbWljX2luYygmY3JlZC0+dXNhZ2UpOwogcmV0dXJuIGNyZWQ7Cn0KIyAyNDcgIi4vaW5j
bHVkZS9saW51eC9jcmVkLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBjb25zdCBzdHJ1Y3QgY3JlZCAqZ2V0X2Ny
ZWQoY29uc3Qgc3RydWN0IGNyZWQgKmNyZWQpCnsKIHN0cnVjdCBjcmVkICpub25jb25zdF9j
cmVkID0gKHN0cnVjdCBjcmVkICopIGNyZWQ7CiBpZiAoIWNyZWQpCiAgcmV0dXJuIGNyZWQ7
CiB2YWxpZGF0ZV9jcmVkcyhjcmVkKTsKIG5vbmNvbnN0X2NyZWQtPm5vbl9yY3UgPSAwOwog
cmV0dXJuIGdldF9uZXdfY3JlZChub25jb25zdF9jcmVkKTsKfQoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGNvbnN0
IHN0cnVjdCBjcmVkICpnZXRfY3JlZF9yY3UoY29uc3Qgc3RydWN0IGNyZWQgKmNyZWQpCnsK
IHN0cnVjdCBjcmVkICpub25jb25zdF9jcmVkID0gKHN0cnVjdCBjcmVkICopIGNyZWQ7CiBp
ZiAoIWNyZWQpCiAgcmV0dXJuICgodm9pZCAqKTApOwogaWYgKCFhdG9taWNfaW5jX25vdF96
ZXJvKCgmbm9uY29uc3RfY3JlZC0+dXNhZ2UpKSkKICByZXR1cm4gKCh2b2lkICopMCk7CiB2
YWxpZGF0ZV9jcmVkcyhjcmVkKTsKIG5vbmNvbnN0X2NyZWQtPm5vbl9yY3UgPSAwOwogcmV0
dXJuIGNyZWQ7Cn0KIyAyODAgIi4vaW5jbHVkZS9saW51eC9jcmVkLmgiCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2
b2lkIHB1dF9jcmVkKGNvbnN0IHN0cnVjdCBjcmVkICpfY3JlZCkKewogc3RydWN0IGNyZWQg
KmNyZWQgPSAoc3RydWN0IGNyZWQgKikgX2NyZWQ7CgogaWYgKGNyZWQpIHsKICB2YWxpZGF0
ZV9jcmVkcyhjcmVkKTsKICBpZiAoYXRvbWljX2RlY19hbmRfdGVzdCgmKGNyZWQpLT51c2Fn
ZSkpCiAgIF9fcHV0X2NyZWQoY3JlZCk7CiB9Cn0KIyAzOTAgIi4vaW5jbHVkZS9saW51eC9j
cmVkLmgiCmV4dGVybiBzdHJ1Y3QgdXNlcl9uYW1lc3BhY2UgaW5pdF91c2VyX25zOwoKCgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgc3RydWN0IHVzZXJfbmFtZXNwYWNlICpjdXJyZW50X3VzZXJfbnModm9pZCkK
ewogcmV0dXJuICZpbml0X3VzZXJfbnM7Cn0KIyAxMSAiLi9pbmNsdWRlL2xpbnV4L3NjaGVk
L3NpZ25hbC5oIiAyCiMgMjAgIi4vaW5jbHVkZS9saW51eC9zY2hlZC9zaWduYWwuaCIKc3Ry
dWN0IHNpZ2hhbmRfc3RydWN0IHsKIHNwaW5sb2NrX3Qgc2lnbG9jazsKIHJlZmNvdW50X3Qg
Y291bnQ7CiB3YWl0X3F1ZXVlX2hlYWRfdCBzaWduYWxmZF93cWg7CiBzdHJ1Y3Qga19zaWdh
Y3Rpb24gYWN0aW9uWzY0XTsKfTsKCgoKCnN0cnVjdCBwYWNjdF9zdHJ1Y3QgewogaW50IGFj
X2ZsYWc7CiBsb25nIGFjX2V4aXRjb2RlOwogdW5zaWduZWQgbG9uZyBhY19tZW07CiB1NjQg
YWNfdXRpbWUsIGFjX3N0aW1lOwogdW5zaWduZWQgbG9uZyBhY19taW5mbHQsIGFjX21hamZs
dDsKfTsKCnN0cnVjdCBjcHVfaXRpbWVyIHsKIHU2NCBleHBpcmVzOwogdTY0IGluY3I7Cn07
CgoKCgoKc3RydWN0IHRhc2tfY3B1dGltZV9hdG9taWMgewogYXRvbWljNjRfdCB1dGltZTsK
IGF0b21pYzY0X3Qgc3RpbWU7CiBhdG9taWM2NF90IHN1bV9leGVjX3J1bnRpbWU7Cn07CiMg
NjYgIi4vaW5jbHVkZS9saW51eC9zY2hlZC9zaWduYWwuaCIKc3RydWN0IHRocmVhZF9ncm91
cF9jcHV0aW1lciB7CiBzdHJ1Y3QgdGFza19jcHV0aW1lX2F0b21pYyBjcHV0aW1lX2F0b21p
YzsKfTsKCnN0cnVjdCBtdWx0aXByb2Nlc3Nfc2lnbmFscyB7CiBzaWdzZXRfdCBzaWduYWw7
CiBzdHJ1Y3QgaGxpc3Rfbm9kZSBub2RlOwp9OwojIDgyICIuL2luY2x1ZGUvbGludXgvc2No
ZWQvc2lnbmFsLmgiCnN0cnVjdCBzaWduYWxfc3RydWN0IHsKIHJlZmNvdW50X3Qgc2lnY250
OwogYXRvbWljX3QgbGl2ZTsKIGludCBucl90aHJlYWRzOwogc3RydWN0IGxpc3RfaGVhZCB0
aHJlYWRfaGVhZDsKCiB3YWl0X3F1ZXVlX2hlYWRfdCB3YWl0X2NobGRleGl0OwoKCiBzdHJ1
Y3QgdGFza19zdHJ1Y3QgKmN1cnJfdGFyZ2V0OwoKCiBzdHJ1Y3Qgc2lncGVuZGluZyBzaGFy
ZWRfcGVuZGluZzsKCgogc3RydWN0IGhsaXN0X2hlYWQgbXVsdGlwcm9jZXNzOwoKCiBpbnQg
Z3JvdXBfZXhpdF9jb2RlOwoKCgoKCiBpbnQgbm90aWZ5X2NvdW50Owogc3RydWN0IHRhc2tf
c3RydWN0ICpncm91cF9leGl0X3Rhc2s7CgoKIGludCBncm91cF9zdG9wX2NvdW50OwogdW5z
aWduZWQgaW50IGZsYWdzOwojIDEyMiAiLi9pbmNsdWRlL2xpbnV4L3NjaGVkL3NpZ25hbC5o
IgogdW5zaWduZWQgaW50IGlzX2NoaWxkX3N1YnJlYXBlcjoxOwogdW5zaWduZWQgaW50IGhh
c19jaGlsZF9zdWJyZWFwZXI6MTsKCgoKCiBpbnQgcG9zaXhfdGltZXJfaWQ7CiBzdHJ1Y3Qg
bGlzdF9oZWFkIHBvc2l4X3RpbWVyczsKCgogc3RydWN0IGhydGltZXIgcmVhbF90aW1lcjsK
IGt0aW1lX3QgaXRfcmVhbF9pbmNyOwoKCgoKCgogc3RydWN0IGNwdV9pdGltZXIgaXRbMl07
CgoKCgoKIHN0cnVjdCB0aHJlYWRfZ3JvdXBfY3B1dGltZXIgY3B1dGltZXI7CgoKCiBzdHJ1
Y3QgcG9zaXhfY3B1dGltZXJzIHBvc2l4X2NwdXRpbWVyczsKCgogc3RydWN0IHBpZCAqcGlk
c1tQSURUWVBFX01BWF07CgoKCgoKIHN0cnVjdCBwaWQgKnR0eV9vbGRfcGdycDsKCgogaW50
IGxlYWRlcjsKCiBzdHJ1Y3QgdHR5X3N0cnVjdCAqdHR5OwojIDE3NSAiLi9pbmNsdWRlL2xp
bnV4L3NjaGVkL3NpZ25hbC5oIgogc2VxbG9ja190IHN0YXRzX2xvY2s7CiB1NjQgdXRpbWUs
IHN0aW1lLCBjdXRpbWUsIGNzdGltZTsKIHU2NCBndGltZTsKIHU2NCBjZ3RpbWU7CiBzdHJ1
Y3QgcHJldl9jcHV0aW1lIHByZXZfY3B1dGltZTsKIHVuc2lnbmVkIGxvbmcgbnZjc3csIG5p
dmNzdywgY252Y3N3LCBjbml2Y3N3OwogdW5zaWduZWQgbG9uZyBtaW5fZmx0LCBtYWpfZmx0
LCBjbWluX2ZsdCwgY21hal9mbHQ7CiB1bnNpZ25lZCBsb25nIGluYmxvY2ssIG91YmxvY2ss
IGNpbmJsb2NrLCBjb3VibG9jazsKIHVuc2lnbmVkIGxvbmcgbWF4cnNzLCBjbWF4cnNzOwog
c3RydWN0IHRhc2tfaW9fYWNjb3VudGluZyBpb2FjOwoKCgoKCgoKIHVuc2lnbmVkIGxvbmcg
bG9uZyBzdW1fc2NoZWRfcnVudGltZTsKIyAyMDMgIi4vaW5jbHVkZS9saW51eC9zY2hlZC9z
aWduYWwuaCIKIHN0cnVjdCBybGltaXQgcmxpbVsxNl07CgoKIHN0cnVjdCBwYWNjdF9zdHJ1
Y3QgcGFjY3Q7CgoKCgoKIHVuc2lnbmVkIGF1ZGl0X3R0eTsKIHN0cnVjdCB0dHlfYXVkaXRf
YnVmICp0dHlfYXVkaXRfYnVmOwoKCgoKCgogYm9vbCBvb21fZmxhZ19vcmlnaW47CiBzaG9y
dCBvb21fc2NvcmVfYWRqOwogc2hvcnQgb29tX3Njb3JlX2Fkal9taW47Cgogc3RydWN0IG1t
X3N0cnVjdCAqb29tX21tOwoKCiBzdHJ1Y3QgbXV0ZXggY3JlZF9ndWFyZF9tdXRleDsKCgoK
Cgogc3RydWN0IG11dGV4IGV4ZWNfdXBkYXRlX211dGV4OwoKCgp9IDsKIyAyNTggIi4vaW5j
bHVkZS9saW51eC9zY2hlZC9zaWduYWwuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgc2lnbmFsX3NldF9z
dG9wX2ZsYWdzKHN0cnVjdCBzaWduYWxfc3RydWN0ICpzaWcsCiAgICAgIHVuc2lnbmVkIGlu
dCBmbGFncykKewogKHsgaW50IF9fcmV0X3dhcm5fb24gPSAhIShzaWctPmZsYWdzICYgKDB4
MDAwMDAwMDR8MHgwMDAwMDAwOCkpOyBpZiAoX19idWlsdGluX2NvbnN0YW50X3AoX19yZXRf
d2Fybl9vbikpIHsgaWYgKF9fcmV0X3dhcm5fb24pIF9fYXNtX18gX192b2xhdGlsZV9fKCAi
MToJIiAidHdpIDMxLCAwLCAwIiAiXG4iICIuc2VjdGlvbiBfX2J1Z190YWJsZSxcImF3XCJc
biIgIjI6XHQiICIuOGJ5dGUiICIgIiAiMWIsICUwXG4iICJcdC5zaG9ydCAlMSwgJTJcbiIg
Ii5vcmcgMmIrJTNcbiIgIi5wcmV2aW91c1xuIiA6IDogImkiICgiLi9pbmNsdWRlL2xpbnV4
L3NjaGVkL3NpZ25hbC5oIiksICJpIiAoMjYxKSwgImkiICgoMSA8PCAwKSB8ICgoKDkpIDw8
IDgpKSksICJpIiAoc2l6ZW9mKHN0cnVjdCBidWdfZW50cnkpKSk7IH0gZWxzZSB7IF9fYXNt
X18gX192b2xhdGlsZV9fKCAiMToJIiAidGRuZWkiICIgIiAiICU0LCAwIiAiXG4iICIuc2Vj
dGlvbiBfX2J1Z190YWJsZSxcImF3XCJcbiIgIjI6XHQiICIuOGJ5dGUiICIgIiAiMWIsICUw
XG4iICJcdC5zaG9ydCAlMSwgJTJcbiIgIi5vcmcgMmIrJTNcbiIgIi5wcmV2aW91c1xuIiA6
IDogImkiICgiLi9pbmNsdWRlL2xpbnV4L3NjaGVkL3NpZ25hbC5oIiksICJpIiAoMjYxKSwg
ImkiICgoMSA8PCAwKSB8ICgoOSkgPDwgOCkpLCAiaSIgKHNpemVvZihzdHJ1Y3QgYnVnX2Vu
dHJ5KSksICJyIiAoX19yZXRfd2Fybl9vbikpOyB9IF9fYnVpbHRpbl9leHBlY3QoISEoX19y
ZXRfd2Fybl9vbiksIDApOyB9KTsKIHNpZy0+ZmxhZ3MgPSAoc2lnLT5mbGFncyAmIH4oKDB4
MDAwMDAwMTB8MHgwMDAwMDAyMCkgfCAweDAwMDAwMDAxIHwgMHgwMDAwMDAwMikpIHwgZmxh
Z3M7Cn0KCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgaW50IHNpZ25hbF9ncm91cF9leGl0KGNvbnN0IHN0cnVjdCBz
aWduYWxfc3RydWN0ICpzaWcpCnsKIHJldHVybiAoc2lnLT5mbGFncyAmIDB4MDAwMDAwMDQp
IHx8CiAgKHNpZy0+Z3JvdXBfZXhpdF90YXNrICE9ICgodm9pZCAqKTApKTsKfQoKZXh0ZXJu
IHZvaWQgZmx1c2hfc2lnbmFscyhzdHJ1Y3QgdGFza19zdHJ1Y3QgKik7CmV4dGVybiB2b2lk
IGlnbm9yZV9zaWduYWxzKHN0cnVjdCB0YXNrX3N0cnVjdCAqKTsKZXh0ZXJuIHZvaWQgZmx1
c2hfc2lnbmFsX2hhbmRsZXJzKHN0cnVjdCB0YXNrX3N0cnVjdCAqLCBpbnQgZm9yY2VfZGVm
YXVsdCk7CmV4dGVybiBpbnQgZGVxdWV1ZV9zaWduYWwoc3RydWN0IHRhc2tfc3RydWN0ICp0
YXNrLAogICAgIHNpZ3NldF90ICptYXNrLCBrZXJuZWxfc2lnaW5mb190ICppbmZvKTsKCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSBpbnQga2VybmVsX2RlcXVldWVfc2lnbmFsKHZvaWQpCnsKIHN0cnVjdCB0YXNr
X3N0cnVjdCAqdGFzayA9IGdldF9jdXJyZW50KCk7CiBrZXJuZWxfc2lnaW5mb190IF9faW5m
bzsKIGludCByZXQ7Cgogc3Bpbl9sb2NrX2lycSgmdGFzay0+c2lnaGFuZC0+c2lnbG9jayk7
CiByZXQgPSBkZXF1ZXVlX3NpZ25hbCh0YXNrLCAmdGFzay0+YmxvY2tlZCwgJl9faW5mbyk7
CiBzcGluX3VubG9ja19pcnEoJnRhc2stPnNpZ2hhbmQtPnNpZ2xvY2spOwoKIHJldHVybiBy
ZXQ7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSB2b2lkIGtlcm5lbF9zaWduYWxfc3RvcCh2b2lkKQp7CiBzcGlu
X2xvY2tfaXJxKCZnZXRfY3VycmVudCgpLT5zaWdoYW5kLT5zaWdsb2NrKTsKIGlmIChnZXRf
Y3VycmVudCgpLT5qb2JjdGwgJiAoMVVMIDw8IDE2KSkKICBkbyB7IHVuc2lnbmVkIGxvbmcg
ZmxhZ3M7IGRvIHsgKHsgdW5zaWduZWQgbG9uZyBfX2R1bW15OyB0eXBlb2YoZmxhZ3MpIF9f
ZHVtbXkyOyAodm9pZCkoJl9fZHVtbXkgPT0gJl9fZHVtbXkyKTsgMTsgfSk7IGZsYWdzID0g
X3Jhd19zcGluX2xvY2tfaXJxc2F2ZSgmZ2V0X2N1cnJlbnQoKS0+cGlfbG9jayk7IH0gd2hp
bGUgKDApOyBnZXRfY3VycmVudCgpLT5zdGF0ZSA9ICgoMHgwMTAwIHwgMHgwMDA0KSk7IGRv
IHsgKHsgdW5zaWduZWQgbG9uZyBfX2R1bW15OyB0eXBlb2YoZmxhZ3MpIF9fZHVtbXkyOyAo
dm9pZCkoJl9fZHVtbXkgPT0gJl9fZHVtbXkyKTsgMTsgfSk7IF9yYXdfc3Bpbl91bmxvY2tf
aXJxcmVzdG9yZSgmZ2V0X2N1cnJlbnQoKS0+cGlfbG9jaywgZmxhZ3MpOyB9IHdoaWxlICgw
KTsgfSB3aGlsZSAoMCk7CiBzcGluX3VubG9ja19pcnEoJmdldF9jdXJyZW50KCktPnNpZ2hh
bmQtPnNpZ2xvY2spOwoKIHNjaGVkdWxlKCk7Cn0KIyAzMTEgIi4vaW5jbHVkZS9saW51eC9z
Y2hlZC9zaWduYWwuaCIKaW50IGZvcmNlX3NpZ19mYXVsdF90b190YXNrKGludCBzaWcsIGlu
dCBjb2RlLCB2b2lkICphZGRyCgoKICwgc3RydWN0IHRhc2tfc3RydWN0ICp0KTsKaW50IGZv
cmNlX3NpZ19mYXVsdChpbnQgc2lnLCBpbnQgY29kZSwgdm9pZCAqYWRkcgoKICk7CmludCBz
ZW5kX3NpZ19mYXVsdChpbnQgc2lnLCBpbnQgY29kZSwgdm9pZCAqYWRkcgoKCiAsIHN0cnVj
dCB0YXNrX3N0cnVjdCAqdCk7CgppbnQgZm9yY2Vfc2lnX21jZWVycihpbnQgY29kZSwgdm9p
ZCAqLCBzaG9ydCk7CmludCBzZW5kX3NpZ19tY2VlcnIoaW50IGNvZGUsIHZvaWQgKiwgc2hv
cnQsIHN0cnVjdCB0YXNrX3N0cnVjdCAqKTsKCmludCBmb3JjZV9zaWdfYm5kZXJyKHZvaWQg
KmFkZHIsIHZvaWQgKmxvd2VyLCB2b2lkICp1cHBlcik7CmludCBmb3JjZV9zaWdfcGt1ZXJy
KHZvaWQgKmFkZHIsIHUzMiBwa2V5KTsKCmludCBmb3JjZV9zaWdfcHRyYWNlX2Vycm5vX3Ry
YXAoaW50IGVycm5vLCB2b2lkICphZGRyKTsKCmV4dGVybiBpbnQgc2VuZF9zaWdfaW5mbyhp
bnQsIHN0cnVjdCBrZXJuZWxfc2lnaW5mbyAqLCBzdHJ1Y3QgdGFza19zdHJ1Y3QgKik7CmV4
dGVybiB2b2lkIGZvcmNlX3NpZ3NlZ3YoaW50IHNpZyk7CmV4dGVybiBpbnQgZm9yY2Vfc2ln
X2luZm8oc3RydWN0IGtlcm5lbF9zaWdpbmZvICopOwpleHRlcm4gaW50IF9fa2lsbF9wZ3Jw
X2luZm8oaW50IHNpZywgc3RydWN0IGtlcm5lbF9zaWdpbmZvICppbmZvLCBzdHJ1Y3QgcGlk
ICpwZ3JwKTsKZXh0ZXJuIGludCBraWxsX3BpZF9pbmZvKGludCBzaWcsIHN0cnVjdCBrZXJu
ZWxfc2lnaW5mbyAqaW5mbywgc3RydWN0IHBpZCAqcGlkKTsKZXh0ZXJuIGludCBraWxsX3Bp
ZF91c2JfYXN5bmNpbyhpbnQgc2lnLCBpbnQgZXJybm8sIHNpZ3ZhbF90IGFkZHIsIHN0cnVj
dCBwaWQgKiwKICAgIGNvbnN0IHN0cnVjdCBjcmVkICopOwpleHRlcm4gaW50IGtpbGxfcGdy
cChzdHJ1Y3QgcGlkICpwaWQsIGludCBzaWcsIGludCBwcml2KTsKZXh0ZXJuIGludCBraWxs
X3BpZChzdHJ1Y3QgcGlkICpwaWQsIGludCBzaWcsIGludCBwcml2KTsKZXh0ZXJuIF9fYXR0
cmlidXRlX18oKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKSBib29sIGRvX25vdGlmeV9wYXJl
bnQoc3RydWN0IHRhc2tfc3RydWN0ICosIGludCk7CmV4dGVybiB2b2lkIF9fd2FrZV91cF9w
YXJlbnQoc3RydWN0IHRhc2tfc3RydWN0ICpwLCBzdHJ1Y3QgdGFza19zdHJ1Y3QgKnBhcmVu
dCk7CmV4dGVybiB2b2lkIGZvcmNlX3NpZyhpbnQpOwpleHRlcm4gaW50IHNlbmRfc2lnKGlu
dCwgc3RydWN0IHRhc2tfc3RydWN0ICosIGludCk7CmV4dGVybiBpbnQgemFwX290aGVyX3Ro
cmVhZHMoc3RydWN0IHRhc2tfc3RydWN0ICpwKTsKZXh0ZXJuIHN0cnVjdCBzaWdxdWV1ZSAq
c2lncXVldWVfYWxsb2Modm9pZCk7CmV4dGVybiB2b2lkIHNpZ3F1ZXVlX2ZyZWUoc3RydWN0
IHNpZ3F1ZXVlICopOwpleHRlcm4gaW50IHNlbmRfc2lncXVldWUoc3RydWN0IHNpZ3F1ZXVl
ICosIHN0cnVjdCBwaWQgKiwgZW51bSBwaWRfdHlwZSk7CmV4dGVybiBpbnQgZG9fc2lnYWN0
aW9uKGludCwgc3RydWN0IGtfc2lnYWN0aW9uICosIHN0cnVjdCBrX3NpZ2FjdGlvbiAqKTsK
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSBpbnQgcmVzdGFydF9zeXNjYWxsKHZvaWQpCnsKIHNldF90c2tfdGhyZWFk
X2ZsYWcoZ2V0X2N1cnJlbnQoKSwgMSk7CiByZXR1cm4gLTUxMzsKfQoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGlu
dCBzaWduYWxfcGVuZGluZyhzdHJ1Y3QgdGFza19zdHJ1Y3QgKnApCnsKIHJldHVybiBfX2J1
aWx0aW5fZXhwZWN0KCEhKHRlc3RfdHNrX3RocmVhZF9mbGFnKHAsMSkpLCAwKTsKfQoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIGludCBfX2ZhdGFsX3NpZ25hbF9wZW5kaW5nKHN0cnVjdCB0YXNrX3N0cnVjdCAq
cCkKewogcmV0dXJuIF9fYnVpbHRpbl9leHBlY3QoISEoc2lnaXNtZW1iZXIoJnAtPnBlbmRp
bmcuc2lnbmFsLCA5KSksIDApOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGZhdGFsX3NpZ25hbF9wZW5k
aW5nKHN0cnVjdCB0YXNrX3N0cnVjdCAqcCkKewogcmV0dXJuIHNpZ25hbF9wZW5kaW5nKHAp
ICYmIF9fZmF0YWxfc2lnbmFsX3BlbmRpbmcocCk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgc2lnbmFs
X3BlbmRpbmdfc3RhdGUobG9uZyBzdGF0ZSwgc3RydWN0IHRhc2tfc3RydWN0ICpwKQp7CiBp
ZiAoIShzdGF0ZSAmICgweDAwMDEgfCAweDAxMDApKSkKICByZXR1cm4gMDsKIGlmICghc2ln
bmFsX3BlbmRpbmcocCkpCiAgcmV0dXJuIDA7CgogcmV0dXJuIChzdGF0ZSAmIDB4MDAwMSkg
fHwgX19mYXRhbF9zaWduYWxfcGVuZGluZyhwKTsKfQoKCgoKCgoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wg
ZmF1bHRfc2lnbmFsX3BlbmRpbmcodm1fZmF1bHRfdCBmYXVsdF9mbGFncywKICAgICBzdHJ1
Y3QgcHRfcmVncyAqcmVncykKewogcmV0dXJuIF9fYnVpbHRpbl9leHBlY3QoISEoKGZhdWx0
X2ZsYWdzICYgVk1fRkFVTFRfUkVUUlkpICYmIChmYXRhbF9zaWduYWxfcGVuZGluZyhnZXRf
Y3VycmVudCgpKSB8fCAoKCgoKHJlZ3MpLT5tc3IpID4+IDE0KSAmIDB4MSkgJiYgc2lnbmFs
X3BlbmRpbmcoZ2V0X2N1cnJlbnQoKSkpKSksIDApCgogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIDsKfQoKCgoKCgoKZXh0ZXJuIHZvaWQgcmVj
YWxjX3NpZ3BlbmRpbmdfYW5kX3dha2Uoc3RydWN0IHRhc2tfc3RydWN0ICp0KTsKZXh0ZXJu
IHZvaWQgcmVjYWxjX3NpZ3BlbmRpbmcodm9pZCk7CmV4dGVybiB2b2lkIGNhbGN1bGF0ZV9z
aWdwZW5kaW5nKHZvaWQpOwoKZXh0ZXJuIHZvaWQgc2lnbmFsX3dha2VfdXBfc3RhdGUoc3Ry
dWN0IHRhc2tfc3RydWN0ICp0LCB1bnNpZ25lZCBpbnQgc3RhdGUpOwoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZv
aWQgc2lnbmFsX3dha2VfdXAoc3RydWN0IHRhc2tfc3RydWN0ICp0LCBib29sIHJlc3VtZSkK
ewogc2lnbmFsX3dha2VfdXBfc3RhdGUodCwgcmVzdW1lID8gMHgwMTAwIDogMCk7Cn0Kc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIHZvaWQgcHRyYWNlX3NpZ25hbF93YWtlX3VwKHN0cnVjdCB0YXNrX3N0cnVjdCAq
dCwgYm9vbCByZXN1bWUpCnsKIHNpZ25hbF93YWtlX3VwX3N0YXRlKHQsIHJlc3VtZSA/IDB4
MDAwOCA6IDApOwp9Cgp2b2lkIHRhc2tfam9pbl9ncm91cF9zdG9wKHN0cnVjdCB0YXNrX3N0
cnVjdCAqdGFzayk7CiMgNDY1ICIuL2luY2x1ZGUvbGludXgvc2NoZWQvc2lnbmFsLmgiCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSB2b2lkIHNldF9yZXN0b3JlX3NpZ21hc2sodm9pZCkKewogZ2V0X2N1cnJlbnQo
KS0+cmVzdG9yZV9zaWdtYXNrID0gdHJ1ZTsKfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBjbGVhcl90c2tf
cmVzdG9yZV9zaWdtYXNrKHN0cnVjdCB0YXNrX3N0cnVjdCAqdGFzaykKewogdGFzay0+cmVz
dG9yZV9zaWdtYXNrID0gZmFsc2U7Cn0Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgY2xlYXJfcmVzdG9yZV9z
aWdtYXNrKHZvaWQpCnsKIGdldF9jdXJyZW50KCktPnJlc3RvcmVfc2lnbWFzayA9IGZhbHNl
Owp9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSBib29sIHRlc3RfcmVzdG9yZV9zaWdtYXNrKHZvaWQpCnsKIHJldHVy
biBnZXRfY3VycmVudCgpLT5yZXN0b3JlX3NpZ21hc2s7Cn0Kc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgdGVz
dF90c2tfcmVzdG9yZV9zaWdtYXNrKHN0cnVjdCB0YXNrX3N0cnVjdCAqdGFzaykKewogcmV0
dXJuIHRhc2stPnJlc3RvcmVfc2lnbWFzazsKfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCB0ZXN0X2FuZF9j
bGVhcl9yZXN0b3JlX3NpZ21hc2sodm9pZCkKewogaWYgKCFnZXRfY3VycmVudCgpLT5yZXN0
b3JlX3NpZ21hc2spCiAgcmV0dXJuIGZhbHNlOwogZ2V0X2N1cnJlbnQoKS0+cmVzdG9yZV9z
aWdtYXNrID0gZmFsc2U7CiByZXR1cm4gdHJ1ZTsKfQoKCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHJlc3Rv
cmVfc2F2ZWRfc2lnbWFzayh2b2lkKQp7CiBpZiAodGVzdF9hbmRfY2xlYXJfcmVzdG9yZV9z
aWdtYXNrKCkpCiAgX19zZXRfY3VycmVudF9ibG9ja2VkKCZnZXRfY3VycmVudCgpLT5zYXZl
ZF9zaWdtYXNrKTsKfQoKZXh0ZXJuIGludCBzZXRfdXNlcl9zaWdtYXNrKGNvbnN0IHNpZ3Nl
dF90ICp1bWFzaywgc2l6ZV90IHNpZ3NldHNpemUpOwoKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgcmVzdG9y
ZV9zYXZlZF9zaWdtYXNrX3VubGVzcyhib29sIGludGVycnVwdGVkKQp7CiBpZiAoaW50ZXJy
dXB0ZWQpCiAgKHsgaW50IF9fcmV0X3dhcm5fb24gPSAhISghdGVzdF90aV90aHJlYWRfZmxh
ZygoKHN0cnVjdCB0aHJlYWRfaW5mbyAqKWdldF9jdXJyZW50KCkpLCAxKSk7IGlmIChfX2J1
aWx0aW5fY29uc3RhbnRfcChfX3JldF93YXJuX29uKSkgeyBpZiAoX19yZXRfd2Fybl9vbikg
X19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgkiICJ0d2kgMzEsIDAsIDAiICJcbiIgIi5zZWN0
aW9uIF9fYnVnX3RhYmxlLFwiYXdcIlxuIiAiMjpcdCIgIi44Ynl0ZSIgIiAiICIxYiwgJTBc
biIgIlx0LnNob3J0ICUxLCAlMlxuIiAiLm9yZyAyYislM1xuIiAiLnByZXZpb3VzXG4iIDog
OiAiaSIgKCIuL2luY2x1ZGUvbGludXgvc2NoZWQvc2lnbmFsLmgiKSwgImkiICg1MDUpLCAi
aSIgKCgxIDw8IDApIHwgKCgoOSkgPDwgOCkpKSwgImkiIChzaXplb2Yoc3RydWN0IGJ1Z19l
bnRyeSkpKTsgfSBlbHNlIHsgX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgkiICJ0ZG5laSIg
IiAiICIgJTQsIDAiICJcbiIgIi5zZWN0aW9uIF9fYnVnX3RhYmxlLFwiYXdcIlxuIiAiMjpc
dCIgIi44Ynl0ZSIgIiAiICIxYiwgJTBcbiIgIlx0LnNob3J0ICUxLCAlMlxuIiAiLm9yZyAy
YislM1xuIiAiLnByZXZpb3VzXG4iIDogOiAiaSIgKCIuL2luY2x1ZGUvbGludXgvc2NoZWQv
c2lnbmFsLmgiKSwgImkiICg1MDUpLCAiaSIgKCgxIDw8IDApIHwgKCg5KSA8PCA4KSksICJp
IiAoc2l6ZW9mKHN0cnVjdCBidWdfZW50cnkpKSwgInIiIChfX3JldF93YXJuX29uKSk7IH0g
X19idWlsdGluX2V4cGVjdCghIShfX3JldF93YXJuX29uKSwgMCk7IH0pOwogZWxzZQogIHJl
c3RvcmVfc2F2ZWRfc2lnbWFzaygpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc2lnc2V0X3QgKnNpZ21hc2tf
dG9fc2F2ZSh2b2lkKQp7CiBzaWdzZXRfdCAqcmVzID0gJmdldF9jdXJyZW50KCktPmJsb2Nr
ZWQ7CiBpZiAoX19idWlsdGluX2V4cGVjdCghISh0ZXN0X3Jlc3RvcmVfc2lnbWFzaygpKSwg
MCkpCiAgcmVzID0gJmdldF9jdXJyZW50KCktPnNhdmVkX3NpZ21hc2s7CiByZXR1cm4gcmVz
Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgaW50IGtpbGxfY2FkX3BpZChpbnQgc2lnLCBpbnQgcHJpdikKewog
cmV0dXJuIGtpbGxfcGlkKGNhZF9waWQsIHNpZywgcHJpdik7Cn0KIyA1MzAgIi4vaW5jbHVk
ZS9saW51eC9zY2hlZC9zaWduYWwuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBvbl9zaWdfc3RhY2sodW5z
aWduZWQgbG9uZyBzcCkKewojIDU0MSAiLi9pbmNsdWRlL2xpbnV4L3NjaGVkL3NpZ25hbC5o
IgogaWYgKGdldF9jdXJyZW50KCktPnNhc19zc19mbGFncyAmICgxVSA8PCAzMSkpCiAgcmV0
dXJuIDA7CgoKCgoKIHJldHVybiBzcCA+IGdldF9jdXJyZW50KCktPnNhc19zc19zcCAmJgog
IHNwIC0gZ2V0X2N1cnJlbnQoKS0+c2FzX3NzX3NwIDw9IGdldF9jdXJyZW50KCktPnNhc19z
c19zaXplOwoKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBzYXNfc3NfZmxhZ3ModW5zaWduZWQgbG9uZyBz
cCkKewogaWYgKCFnZXRfY3VycmVudCgpLT5zYXNfc3Nfc2l6ZSkKICByZXR1cm4gMjsKCiBy
ZXR1cm4gb25fc2lnX3N0YWNrKHNwKSA/IDEgOiAwOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBzYXNf
c3NfcmVzZXQoc3RydWN0IHRhc2tfc3RydWN0ICpwKQp7CiBwLT5zYXNfc3Nfc3AgPSAwOwog
cC0+c2FzX3NzX3NpemUgPSAwOwogcC0+c2FzX3NzX2ZsYWdzID0gMjsKfQoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IHVuc2lnbmVkIGxvbmcgc2lnc3AodW5zaWduZWQgbG9uZyBzcCwgc3RydWN0IGtzaWduYWwg
KmtzaWcpCnsKIGlmIChfX2J1aWx0aW5fZXhwZWN0KCEhKChrc2lnLT5rYS5zYS5zYV9mbGFn
cyAmIDB4MDgwMDAwMDBVKSksIDApICYmICEgc2FzX3NzX2ZsYWdzKHNwKSkKCgoKICByZXR1
cm4gZ2V0X2N1cnJlbnQoKS0+c2FzX3NzX3NwICsgZ2V0X2N1cnJlbnQoKS0+c2FzX3NzX3Np
emU7CgogcmV0dXJuIHNwOwp9CgpleHRlcm4gdm9pZCBfX2NsZWFudXBfc2lnaGFuZChzdHJ1
Y3Qgc2lnaGFuZF9zdHJ1Y3QgKik7CmV4dGVybiB2b2lkIGZsdXNoX2l0aW1lcl9zaWduYWxz
KHZvaWQpOwojIDU5MSAiLi9pbmNsdWRlL2xpbnV4L3NjaGVkL3NpZ25hbC5oIgpleHRlcm4g
Ym9vbCBjdXJyZW50X2lzX3NpbmdsZV90aHJlYWRlZCh2b2lkKTsKIyA2MTMgIi4vaW5jbHVk
ZS9saW51eC9zY2hlZC9zaWduYWwuaCIKdHlwZWRlZiBpbnQgKCpwcm9jX3Zpc2l0b3IpKHN0
cnVjdCB0YXNrX3N0cnVjdCAqcCwgdm9pZCAqZGF0YSk7CnZvaWQgd2Fsa19wcm9jZXNzX3Ry
ZWUoc3RydWN0IHRhc2tfc3RydWN0ICp0b3AsIHByb2NfdmlzaXRvciwgdm9pZCAqKTsKCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKQpzdHJ1Y3QgcGlkICp0YXNrX3BpZF90eXBlKHN0cnVjdCB0YXNrX3N0cnVjdCAq
dGFzaywgZW51bSBwaWRfdHlwZSB0eXBlKQp7CiBzdHJ1Y3QgcGlkICpwaWQ7CiBpZiAodHlw
ZSA9PSBQSURUWVBFX1BJRCkKICBwaWQgPSB0YXNrX3BpZCh0YXNrKTsKIGVsc2UKICBwaWQg
PSB0YXNrLT5zaWduYWwtPnBpZHNbdHlwZV07CiByZXR1cm4gcGlkOwp9CgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
c3RydWN0IHBpZCAqdGFza190Z2lkKHN0cnVjdCB0YXNrX3N0cnVjdCAqdGFzaykKewogcmV0
dXJuIHRhc2stPnNpZ25hbC0+cGlkc1tQSURUWVBFX1RHSURdOwp9CgoKCgoKCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBzdHJ1Y3QgcGlkICp0YXNrX3BncnAoc3RydWN0IHRhc2tfc3RydWN0ICp0YXNrKQp7CiBy
ZXR1cm4gdGFzay0+c2lnbmFsLT5waWRzW1BJRFRZUEVfUEdJRF07Cn0KCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBz
dHJ1Y3QgcGlkICp0YXNrX3Nlc3Npb24oc3RydWN0IHRhc2tfc3RydWN0ICp0YXNrKQp7CiBy
ZXR1cm4gdGFzay0+c2lnbmFsLT5waWRzW1BJRFRZUEVfU0lEXTsKfQoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGlu
dCBnZXRfbnJfdGhyZWFkcyhzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRhc2spCnsKIHJldHVybiB0
YXNrLT5zaWduYWwtPm5yX3RocmVhZHM7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIHRocmVhZF9ncm91
cF9sZWFkZXIoc3RydWN0IHRhc2tfc3RydWN0ICpwKQp7CiByZXR1cm4gcC0+ZXhpdF9zaWdu
YWwgPj0gMDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpCmJvb2wgc2FtZV90aHJlYWRfZ3JvdXAoc3RydWN0IHRh
c2tfc3RydWN0ICpwMSwgc3RydWN0IHRhc2tfc3RydWN0ICpwMikKewogcmV0dXJuIHAxLT5z
aWduYWwgPT0gcDItPnNpZ25hbDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHN0cnVjdCB0YXNrX3N0cnVjdCAq
bmV4dF90aHJlYWQoY29uc3Qgc3RydWN0IHRhc2tfc3RydWN0ICpwKQp7CiByZXR1cm4gKHsg
dm9pZCAqX19tcHRyID0gKHZvaWQgKikoKHsgZG8geyBleHRlcm4gdm9pZCBfX2NvbXBpbGV0
aW1lX2Fzc2VydF8xNTcodm9pZCkgX19hdHRyaWJ1dGVfXygoX19lcnJvcl9fKCJVbnN1cHBv
cnRlZCBhY2Nlc3Mgc2l6ZSBmb3Ige1JFQUQsV1JJVEV9X09OQ0UoKS4iKSkpOyBpZiAoISgo
c2l6ZW9mKHAtPnRocmVhZF9ncm91cC5uZXh0KSA9PSBzaXplb2YoY2hhcikgfHwgc2l6ZW9m
KHAtPnRocmVhZF9ncm91cC5uZXh0KSA9PSBzaXplb2Yoc2hvcnQpIHx8IHNpemVvZihwLT50
aHJlYWRfZ3JvdXAubmV4dCkgPT0gc2l6ZW9mKGludCkgfHwgc2l6ZW9mKHAtPnRocmVhZF9n
cm91cC5uZXh0KSA9PSBzaXplb2YobG9uZykpIHx8IHNpemVvZihwLT50aHJlYWRfZ3JvdXAu
bmV4dCkgPT0gc2l6ZW9mKGxvbmcgbG9uZykpKSBfX2NvbXBpbGV0aW1lX2Fzc2VydF8xNTco
KTsgfSB3aGlsZSAoMCk7ICh7IHR5cGVvZiggX0dlbmVyaWMoKHAtPnRocmVhZF9ncm91cC5u
ZXh0KSwgY2hhcjogKGNoYXIpMCwgdW5zaWduZWQgY2hhcjogKHVuc2lnbmVkIGNoYXIpMCwg
c2lnbmVkIGNoYXI6IChzaWduZWQgY2hhcikwLCB1bnNpZ25lZCBzaG9ydDogKHVuc2lnbmVk
IHNob3J0KTAsIHNpZ25lZCBzaG9ydDogKHNpZ25lZCBzaG9ydCkwLCB1bnNpZ25lZCBpbnQ6
ICh1bnNpZ25lZCBpbnQpMCwgc2lnbmVkIGludDogKHNpZ25lZCBpbnQpMCwgdW5zaWduZWQg
bG9uZzogKHVuc2lnbmVkIGxvbmcpMCwgc2lnbmVkIGxvbmc6IChzaWduZWQgbG9uZykwLCB1
bnNpZ25lZCBsb25nIGxvbmc6ICh1bnNpZ25lZCBsb25nIGxvbmcpMCwgc2lnbmVkIGxvbmcg
bG9uZzogKHNpZ25lZCBsb25nIGxvbmcpMCwgZGVmYXVsdDogKHAtPnRocmVhZF9ncm91cC5u
ZXh0KSkpIF9feCA9ICgqKGNvbnN0IHZvbGF0aWxlIHR5cGVvZiggX0dlbmVyaWMoKHAtPnRo
cmVhZF9ncm91cC5uZXh0KSwgY2hhcjogKGNoYXIpMCwgdW5zaWduZWQgY2hhcjogKHVuc2ln
bmVkIGNoYXIpMCwgc2lnbmVkIGNoYXI6IChzaWduZWQgY2hhcikwLCB1bnNpZ25lZCBzaG9y
dDogKHVuc2lnbmVkIHNob3J0KTAsIHNpZ25lZCBzaG9ydDogKHNpZ25lZCBzaG9ydCkwLCB1
bnNpZ25lZCBpbnQ6ICh1bnNpZ25lZCBpbnQpMCwgc2lnbmVkIGludDogKHNpZ25lZCBpbnQp
MCwgdW5zaWduZWQgbG9uZzogKHVuc2lnbmVkIGxvbmcpMCwgc2lnbmVkIGxvbmc6IChzaWdu
ZWQgbG9uZykwLCB1bnNpZ25lZCBsb25nIGxvbmc6ICh1bnNpZ25lZCBsb25nIGxvbmcpMCwg
c2lnbmVkIGxvbmcgbG9uZzogKHNpZ25lZCBsb25nIGxvbmcpMCwgZGVmYXVsdDogKHAtPnRo
cmVhZF9ncm91cC5uZXh0KSkpICopJihwLT50aHJlYWRfZ3JvdXAubmV4dCkpOyBkbyB7IH0g
d2hpbGUgKDApOyAodHlwZW9mKHAtPnRocmVhZF9ncm91cC5uZXh0KSlfX3g7IH0pOyB9KSk7
IGRvIHsgZXh0ZXJuIHZvaWQgX19jb21waWxldGltZV9hc3NlcnRfMTU4KHZvaWQpIF9fYXR0
cmlidXRlX18oKF9fZXJyb3JfXygicG9pbnRlciB0eXBlIG1pc21hdGNoIGluIGNvbnRhaW5l
cl9vZigpIikpKTsgaWYgKCEoISghX19idWlsdGluX3R5cGVzX2NvbXBhdGlibGVfcCh0eXBl
b2YoKigoeyBkbyB7IGV4dGVybiB2b2lkIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzE1Nyh2b2lk
KSBfX2F0dHJpYnV0ZV9fKChfX2Vycm9yX18oIlVuc3VwcG9ydGVkIGFjY2VzcyBzaXplIGZv
ciB7UkVBRCxXUklURX1fT05DRSgpLiIpKSk7IGlmICghKChzaXplb2YocC0+dGhyZWFkX2dy
b3VwLm5leHQpID09IHNpemVvZihjaGFyKSB8fCBzaXplb2YocC0+dGhyZWFkX2dyb3VwLm5l
eHQpID09IHNpemVvZihzaG9ydCkgfHwgc2l6ZW9mKHAtPnRocmVhZF9ncm91cC5uZXh0KSA9
PSBzaXplb2YoaW50KSB8fCBzaXplb2YocC0+dGhyZWFkX2dyb3VwLm5leHQpID09IHNpemVv
Zihsb25nKSkgfHwgc2l6ZW9mKHAtPnRocmVhZF9ncm91cC5uZXh0KSA9PSBzaXplb2YobG9u
ZyBsb25nKSkpIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzE1NygpOyB9IHdoaWxlICgwKTsgKHsg
dHlwZW9mKCBfR2VuZXJpYygocC0+dGhyZWFkX2dyb3VwLm5leHQpLCBjaGFyOiAoY2hhcikw
LCB1bnNpZ25lZCBjaGFyOiAodW5zaWduZWQgY2hhcikwLCBzaWduZWQgY2hhcjogKHNpZ25l
ZCBjaGFyKTAsIHVuc2lnbmVkIHNob3J0OiAodW5zaWduZWQgc2hvcnQpMCwgc2lnbmVkIHNo
b3J0OiAoc2lnbmVkIHNob3J0KTAsIHVuc2lnbmVkIGludDogKHVuc2lnbmVkIGludCkwLCBz
aWduZWQgaW50OiAoc2lnbmVkIGludCkwLCB1bnNpZ25lZCBsb25nOiAodW5zaWduZWQgbG9u
ZykwLCBzaWduZWQgbG9uZzogKHNpZ25lZCBsb25nKTAsIHVuc2lnbmVkIGxvbmcgbG9uZzog
KHVuc2lnbmVkIGxvbmcgbG9uZykwLCBzaWduZWQgbG9uZyBsb25nOiAoc2lnbmVkIGxvbmcg
bG9uZykwLCBkZWZhdWx0OiAocC0+dGhyZWFkX2dyb3VwLm5leHQpKSkgX194ID0gKCooY29u
c3Qgdm9sYXRpbGUgdHlwZW9mKCBfR2VuZXJpYygocC0+dGhyZWFkX2dyb3VwLm5leHQpLCBj
aGFyOiAoY2hhcikwLCB1bnNpZ25lZCBjaGFyOiAodW5zaWduZWQgY2hhcikwLCBzaWduZWQg
Y2hhcjogKHNpZ25lZCBjaGFyKTAsIHVuc2lnbmVkIHNob3J0OiAodW5zaWduZWQgc2hvcnQp
MCwgc2lnbmVkIHNob3J0OiAoc2lnbmVkIHNob3J0KTAsIHVuc2lnbmVkIGludDogKHVuc2ln
bmVkIGludCkwLCBzaWduZWQgaW50OiAoc2lnbmVkIGludCkwLCB1bnNpZ25lZCBsb25nOiAo
dW5zaWduZWQgbG9uZykwLCBzaWduZWQgbG9uZzogKHNpZ25lZCBsb25nKTAsIHVuc2lnbmVk
IGxvbmcgbG9uZzogKHVuc2lnbmVkIGxvbmcgbG9uZykwLCBzaWduZWQgbG9uZyBsb25nOiAo
c2lnbmVkIGxvbmcgbG9uZykwLCBkZWZhdWx0OiAocC0+dGhyZWFkX2dyb3VwLm5leHQpKSkg
KikmKHAtPnRocmVhZF9ncm91cC5uZXh0KSk7IGRvIHsgfSB3aGlsZSAoMCk7ICh0eXBlb2Yo
cC0+dGhyZWFkX2dyb3VwLm5leHQpKV9feDsgfSk7IH0pKSksIHR5cGVvZigoKHN0cnVjdCB0
YXNrX3N0cnVjdCAqKTApLT50aHJlYWRfZ3JvdXApKSAmJiAhX19idWlsdGluX3R5cGVzX2Nv
bXBhdGlibGVfcCh0eXBlb2YoKigoeyBkbyB7IGV4dGVybiB2b2lkIF9fY29tcGlsZXRpbWVf
YXNzZXJ0XzE1Nyh2b2lkKSBfX2F0dHJpYnV0ZV9fKChfX2Vycm9yX18oIlVuc3VwcG9ydGVk
IGFjY2VzcyBzaXplIGZvciB7UkVBRCxXUklURX1fT05DRSgpLiIpKSk7IGlmICghKChzaXpl
b2YocC0+dGhyZWFkX2dyb3VwLm5leHQpID09IHNpemVvZihjaGFyKSB8fCBzaXplb2YocC0+
dGhyZWFkX2dyb3VwLm5leHQpID09IHNpemVvZihzaG9ydCkgfHwgc2l6ZW9mKHAtPnRocmVh
ZF9ncm91cC5uZXh0KSA9PSBzaXplb2YoaW50KSB8fCBzaXplb2YocC0+dGhyZWFkX2dyb3Vw
Lm5leHQpID09IHNpemVvZihsb25nKSkgfHwgc2l6ZW9mKHAtPnRocmVhZF9ncm91cC5uZXh0
KSA9PSBzaXplb2YobG9uZyBsb25nKSkpIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzE1NygpOyB9
IHdoaWxlICgwKTsgKHsgdHlwZW9mKCBfR2VuZXJpYygocC0+dGhyZWFkX2dyb3VwLm5leHQp
LCBjaGFyOiAoY2hhcikwLCB1bnNpZ25lZCBjaGFyOiAodW5zaWduZWQgY2hhcikwLCBzaWdu
ZWQgY2hhcjogKHNpZ25lZCBjaGFyKTAsIHVuc2lnbmVkIHNob3J0OiAodW5zaWduZWQgc2hv
cnQpMCwgc2lnbmVkIHNob3J0OiAoc2lnbmVkIHNob3J0KTAsIHVuc2lnbmVkIGludDogKHVu
c2lnbmVkIGludCkwLCBzaWduZWQgaW50OiAoc2lnbmVkIGludCkwLCB1bnNpZ25lZCBsb25n
OiAodW5zaWduZWQgbG9uZykwLCBzaWduZWQgbG9uZzogKHNpZ25lZCBsb25nKTAsIHVuc2ln
bmVkIGxvbmcgbG9uZzogKHVuc2lnbmVkIGxvbmcgbG9uZykwLCBzaWduZWQgbG9uZyBsb25n
OiAoc2lnbmVkIGxvbmcgbG9uZykwLCBkZWZhdWx0OiAocC0+dGhyZWFkX2dyb3VwLm5leHQp
KSkgX194ID0gKCooY29uc3Qgdm9sYXRpbGUgdHlwZW9mKCBfR2VuZXJpYygocC0+dGhyZWFk
X2dyb3VwLm5leHQpLCBjaGFyOiAoY2hhcikwLCB1bnNpZ25lZCBjaGFyOiAodW5zaWduZWQg
Y2hhcikwLCBzaWduZWQgY2hhcjogKHNpZ25lZCBjaGFyKTAsIHVuc2lnbmVkIHNob3J0OiAo
dW5zaWduZWQgc2hvcnQpMCwgc2lnbmVkIHNob3J0OiAoc2lnbmVkIHNob3J0KTAsIHVuc2ln
bmVkIGludDogKHVuc2lnbmVkIGludCkwLCBzaWduZWQgaW50OiAoc2lnbmVkIGludCkwLCB1
bnNpZ25lZCBsb25nOiAodW5zaWduZWQgbG9uZykwLCBzaWduZWQgbG9uZzogKHNpZ25lZCBs
b25nKTAsIHVuc2lnbmVkIGxvbmcgbG9uZzogKHVuc2lnbmVkIGxvbmcgbG9uZykwLCBzaWdu
ZWQgbG9uZyBsb25nOiAoc2lnbmVkIGxvbmcgbG9uZykwLCBkZWZhdWx0OiAocC0+dGhyZWFk
X2dyb3VwLm5leHQpKSkgKikmKHAtPnRocmVhZF9ncm91cC5uZXh0KSk7IGRvIHsgfSB3aGls
ZSAoMCk7ICh0eXBlb2YocC0+dGhyZWFkX2dyb3VwLm5leHQpKV9feDsgfSk7IH0pKSksIHR5
cGVvZih2b2lkKSkpKSkgX19jb21waWxldGltZV9hc3NlcnRfMTU4KCk7IH0gd2hpbGUgKDAp
OyAoKHN0cnVjdCB0YXNrX3N0cnVjdCAqKShfX21wdHIgLSBfX2J1aWx0aW5fb2Zmc2V0b2Yo
c3RydWN0IHRhc2tfc3RydWN0LCB0aHJlYWRfZ3JvdXApKSk7IH0pCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCB0aHJlYWRf
Z3JvdXBfZW1wdHkoc3RydWN0IHRhc2tfc3RydWN0ICpwKQp7CiByZXR1cm4gbGlzdF9lbXB0
eSgmcC0+dGhyZWFkX2dyb3VwKTsKfQoKCgoKZXh0ZXJuIHN0cnVjdCBzaWdoYW5kX3N0cnVj
dCAqX19sb2NrX3Rhc2tfc2lnaGFuZChzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRhc2ssCiAgICAg
ICB1bnNpZ25lZCBsb25nICpmbGFncyk7CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IHNpZ2hhbmRfc3Ry
dWN0ICpsb2NrX3Rhc2tfc2lnaGFuZChzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRhc2ssCiAgICAg
ICAgICAgICB1bnNpZ25lZCBsb25nICpmbGFncykKewogc3RydWN0IHNpZ2hhbmRfc3RydWN0
ICpyZXQ7CgogcmV0ID0gX19sb2NrX3Rhc2tfc2lnaGFuZCh0YXNrLCBmbGFncyk7CiAodm9p
ZCkocmV0KTsKIHJldHVybiByZXQ7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHVubG9ja190YXNrX3Np
Z2hhbmQoc3RydWN0IHRhc2tfc3RydWN0ICp0YXNrLAogICAgICB1bnNpZ25lZCBsb25nICpm
bGFncykKewogc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmdGFzay0+c2lnaGFuZC0+c2lnbG9j
aywgKmZsYWdzKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHVuc2lnbmVkIGxvbmcgdGFza19ybGltaXQoY29u
c3Qgc3RydWN0IHRhc2tfc3RydWN0ICp0YXNrLAogIHVuc2lnbmVkIGludCBsaW1pdCkKewog
cmV0dXJuICh7IGRvIHsgZXh0ZXJuIHZvaWQgX19jb21waWxldGltZV9hc3NlcnRfMTU5KHZv
aWQpIF9fYXR0cmlidXRlX18oKF9fZXJyb3JfXygiVW5zdXBwb3J0ZWQgYWNjZXNzIHNpemUg
Zm9yIHtSRUFELFdSSVRFfV9PTkNFKCkuIikpKTsgaWYgKCEoKHNpemVvZih0YXNrLT5zaWdu
YWwtPnJsaW1bbGltaXRdLnJsaW1fY3VyKSA9PSBzaXplb2YoY2hhcikgfHwgc2l6ZW9mKHRh
c2stPnNpZ25hbC0+cmxpbVtsaW1pdF0ucmxpbV9jdXIpID09IHNpemVvZihzaG9ydCkgfHwg
c2l6ZW9mKHRhc2stPnNpZ25hbC0+cmxpbVtsaW1pdF0ucmxpbV9jdXIpID09IHNpemVvZihp
bnQpIHx8IHNpemVvZih0YXNrLT5zaWduYWwtPnJsaW1bbGltaXRdLnJsaW1fY3VyKSA9PSBz
aXplb2YobG9uZykpIHx8IHNpemVvZih0YXNrLT5zaWduYWwtPnJsaW1bbGltaXRdLnJsaW1f
Y3VyKSA9PSBzaXplb2YobG9uZyBsb25nKSkpIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzE1OSgp
OyB9IHdoaWxlICgwKTsgKHsgdHlwZW9mKCBfR2VuZXJpYygodGFzay0+c2lnbmFsLT5ybGlt
W2xpbWl0XS5ybGltX2N1ciksIGNoYXI6IChjaGFyKTAsIHVuc2lnbmVkIGNoYXI6ICh1bnNp
Z25lZCBjaGFyKTAsIHNpZ25lZCBjaGFyOiAoc2lnbmVkIGNoYXIpMCwgdW5zaWduZWQgc2hv
cnQ6ICh1bnNpZ25lZCBzaG9ydCkwLCBzaWduZWQgc2hvcnQ6IChzaWduZWQgc2hvcnQpMCwg
dW5zaWduZWQgaW50OiAodW5zaWduZWQgaW50KTAsIHNpZ25lZCBpbnQ6IChzaWduZWQgaW50
KTAsIHVuc2lnbmVkIGxvbmc6ICh1bnNpZ25lZCBsb25nKTAsIHNpZ25lZCBsb25nOiAoc2ln
bmVkIGxvbmcpMCwgdW5zaWduZWQgbG9uZyBsb25nOiAodW5zaWduZWQgbG9uZyBsb25nKTAs
IHNpZ25lZCBsb25nIGxvbmc6IChzaWduZWQgbG9uZyBsb25nKTAsIGRlZmF1bHQ6ICh0YXNr
LT5zaWduYWwtPnJsaW1bbGltaXRdLnJsaW1fY3VyKSkpIF9feCA9ICgqKGNvbnN0IHZvbGF0
aWxlIHR5cGVvZiggX0dlbmVyaWMoKHRhc2stPnNpZ25hbC0+cmxpbVtsaW1pdF0ucmxpbV9j
dXIpLCBjaGFyOiAoY2hhcikwLCB1bnNpZ25lZCBjaGFyOiAodW5zaWduZWQgY2hhcikwLCBz
aWduZWQgY2hhcjogKHNpZ25lZCBjaGFyKTAsIHVuc2lnbmVkIHNob3J0OiAodW5zaWduZWQg
c2hvcnQpMCwgc2lnbmVkIHNob3J0OiAoc2lnbmVkIHNob3J0KTAsIHVuc2lnbmVkIGludDog
KHVuc2lnbmVkIGludCkwLCBzaWduZWQgaW50OiAoc2lnbmVkIGludCkwLCB1bnNpZ25lZCBs
b25nOiAodW5zaWduZWQgbG9uZykwLCBzaWduZWQgbG9uZzogKHNpZ25lZCBsb25nKTAsIHVu
c2lnbmVkIGxvbmcgbG9uZzogKHVuc2lnbmVkIGxvbmcgbG9uZykwLCBzaWduZWQgbG9uZyBs
b25nOiAoc2lnbmVkIGxvbmcgbG9uZykwLCBkZWZhdWx0OiAodGFzay0+c2lnbmFsLT5ybGlt
W2xpbWl0XS5ybGltX2N1cikpKSAqKSYodGFzay0+c2lnbmFsLT5ybGltW2xpbWl0XS5ybGlt
X2N1cikpOyBkbyB7IH0gd2hpbGUgKDApOyAodHlwZW9mKHRhc2stPnNpZ25hbC0+cmxpbVts
aW1pdF0ucmxpbV9jdXIpKV9feDsgfSk7IH0pOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgbG9u
ZyB0YXNrX3JsaW1pdF9tYXgoY29uc3Qgc3RydWN0IHRhc2tfc3RydWN0ICp0YXNrLAogIHVu
c2lnbmVkIGludCBsaW1pdCkKewogcmV0dXJuICh7IGRvIHsgZXh0ZXJuIHZvaWQgX19jb21w
aWxldGltZV9hc3NlcnRfMTYwKHZvaWQpIF9fYXR0cmlidXRlX18oKF9fZXJyb3JfXygiVW5z
dXBwb3J0ZWQgYWNjZXNzIHNpemUgZm9yIHtSRUFELFdSSVRFfV9PTkNFKCkuIikpKTsgaWYg
KCEoKHNpemVvZih0YXNrLT5zaWduYWwtPnJsaW1bbGltaXRdLnJsaW1fbWF4KSA9PSBzaXpl
b2YoY2hhcikgfHwgc2l6ZW9mKHRhc2stPnNpZ25hbC0+cmxpbVtsaW1pdF0ucmxpbV9tYXgp
ID09IHNpemVvZihzaG9ydCkgfHwgc2l6ZW9mKHRhc2stPnNpZ25hbC0+cmxpbVtsaW1pdF0u
cmxpbV9tYXgpID09IHNpemVvZihpbnQpIHx8IHNpemVvZih0YXNrLT5zaWduYWwtPnJsaW1b
bGltaXRdLnJsaW1fbWF4KSA9PSBzaXplb2YobG9uZykpIHx8IHNpemVvZih0YXNrLT5zaWdu
YWwtPnJsaW1bbGltaXRdLnJsaW1fbWF4KSA9PSBzaXplb2YobG9uZyBsb25nKSkpIF9fY29t
cGlsZXRpbWVfYXNzZXJ0XzE2MCgpOyB9IHdoaWxlICgwKTsgKHsgdHlwZW9mKCBfR2VuZXJp
YygodGFzay0+c2lnbmFsLT5ybGltW2xpbWl0XS5ybGltX21heCksIGNoYXI6IChjaGFyKTAs
IHVuc2lnbmVkIGNoYXI6ICh1bnNpZ25lZCBjaGFyKTAsIHNpZ25lZCBjaGFyOiAoc2lnbmVk
IGNoYXIpMCwgdW5zaWduZWQgc2hvcnQ6ICh1bnNpZ25lZCBzaG9ydCkwLCBzaWduZWQgc2hv
cnQ6IChzaWduZWQgc2hvcnQpMCwgdW5zaWduZWQgaW50OiAodW5zaWduZWQgaW50KTAsIHNp
Z25lZCBpbnQ6IChzaWduZWQgaW50KTAsIHVuc2lnbmVkIGxvbmc6ICh1bnNpZ25lZCBsb25n
KTAsIHNpZ25lZCBsb25nOiAoc2lnbmVkIGxvbmcpMCwgdW5zaWduZWQgbG9uZyBsb25nOiAo
dW5zaWduZWQgbG9uZyBsb25nKTAsIHNpZ25lZCBsb25nIGxvbmc6IChzaWduZWQgbG9uZyBs
b25nKTAsIGRlZmF1bHQ6ICh0YXNrLT5zaWduYWwtPnJsaW1bbGltaXRdLnJsaW1fbWF4KSkp
IF9feCA9ICgqKGNvbnN0IHZvbGF0aWxlIHR5cGVvZiggX0dlbmVyaWMoKHRhc2stPnNpZ25h
bC0+cmxpbVtsaW1pdF0ucmxpbV9tYXgpLCBjaGFyOiAoY2hhcikwLCB1bnNpZ25lZCBjaGFy
OiAodW5zaWduZWQgY2hhcikwLCBzaWduZWQgY2hhcjogKHNpZ25lZCBjaGFyKTAsIHVuc2ln
bmVkIHNob3J0OiAodW5zaWduZWQgc2hvcnQpMCwgc2lnbmVkIHNob3J0OiAoc2lnbmVkIHNo
b3J0KTAsIHVuc2lnbmVkIGludDogKHVuc2lnbmVkIGludCkwLCBzaWduZWQgaW50OiAoc2ln
bmVkIGludCkwLCB1bnNpZ25lZCBsb25nOiAodW5zaWduZWQgbG9uZykwLCBzaWduZWQgbG9u
ZzogKHNpZ25lZCBsb25nKTAsIHVuc2lnbmVkIGxvbmcgbG9uZzogKHVuc2lnbmVkIGxvbmcg
bG9uZykwLCBzaWduZWQgbG9uZyBsb25nOiAoc2lnbmVkIGxvbmcgbG9uZykwLCBkZWZhdWx0
OiAodGFzay0+c2lnbmFsLT5ybGltW2xpbWl0XS5ybGltX21heCkpKSAqKSYodGFzay0+c2ln
bmFsLT5ybGltW2xpbWl0XS5ybGltX21heCkpOyBkbyB7IH0gd2hpbGUgKDApOyAodHlwZW9m
KHRhc2stPnNpZ25hbC0+cmxpbVtsaW1pdF0ucmxpbV9tYXgpKV9feDsgfSk7IH0pOwp9Cgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgdW5zaWduZWQgbG9uZyBybGltaXQodW5zaWduZWQgaW50IGxpbWl0KQp7CiBy
ZXR1cm4gdGFza19ybGltaXQoZ2V0X2N1cnJlbnQoKSwgbGltaXQpOwp9CgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
dW5zaWduZWQgbG9uZyBybGltaXRfbWF4KHVuc2lnbmVkIGludCBsaW1pdCkKewogcmV0dXJu
IHRhc2tfcmxpbWl0X21heChnZXRfY3VycmVudCgpLCBsaW1pdCk7Cn0KIyA3ICIuL2luY2x1
ZGUvbGludXgvcmN1d2FpdC5oIiAyCiMgMTYgIi4vaW5jbHVkZS9saW51eC9yY3V3YWl0Lmgi
CnN0cnVjdCByY3V3YWl0IHsKIHN0cnVjdCB0YXNrX3N0cnVjdCAqdGFzazsKfTsKCgoKCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSB2b2lkIHJjdXdhaXRfaW5pdChzdHJ1Y3QgcmN1d2FpdCAqdykKewogdy0+dGFz
ayA9ICgodm9pZCAqKTApOwp9CgoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCByY3V3YWl0X2FjdGl2ZShz
dHJ1Y3QgcmN1d2FpdCAqdykKewogcmV0dXJuICEhKHsgdHlwZW9mKCoody0+dGFzaykpICpf
X19fX19fX19wMSA9ICh0eXBlb2YoKih3LT50YXNrKSkgKikoeyBkbyB7IGV4dGVybiB2b2lk
IF9fY29tcGlsZXRpbWVfYXNzZXJ0XzE2MSh2b2lkKSBfX2F0dHJpYnV0ZV9fKChfX2Vycm9y
X18oIlVuc3VwcG9ydGVkIGFjY2VzcyBzaXplIGZvciB7UkVBRCxXUklURX1fT05DRSgpLiIp
KSk7IGlmICghKChzaXplb2YoKHctPnRhc2spKSA9PSBzaXplb2YoY2hhcikgfHwgc2l6ZW9m
KCh3LT50YXNrKSkgPT0gc2l6ZW9mKHNob3J0KSB8fCBzaXplb2YoKHctPnRhc2spKSA9PSBz
aXplb2YoaW50KSB8fCBzaXplb2YoKHctPnRhc2spKSA9PSBzaXplb2YobG9uZykpIHx8IHNp
emVvZigody0+dGFzaykpID09IHNpemVvZihsb25nIGxvbmcpKSkgX19jb21waWxldGltZV9h
c3NlcnRfMTYxKCk7IH0gd2hpbGUgKDApOyAoeyB0eXBlb2YoIF9HZW5lcmljKCgody0+dGFz
aykpLCBjaGFyOiAoY2hhcikwLCB1bnNpZ25lZCBjaGFyOiAodW5zaWduZWQgY2hhcikwLCBz
aWduZWQgY2hhcjogKHNpZ25lZCBjaGFyKTAsIHVuc2lnbmVkIHNob3J0OiAodW5zaWduZWQg
c2hvcnQpMCwgc2lnbmVkIHNob3J0OiAoc2lnbmVkIHNob3J0KTAsIHVuc2lnbmVkIGludDog
KHVuc2lnbmVkIGludCkwLCBzaWduZWQgaW50OiAoc2lnbmVkIGludCkwLCB1bnNpZ25lZCBs
b25nOiAodW5zaWduZWQgbG9uZykwLCBzaWduZWQgbG9uZzogKHNpZ25lZCBsb25nKTAsIHVu
c2lnbmVkIGxvbmcgbG9uZzogKHVuc2lnbmVkIGxvbmcgbG9uZykwLCBzaWduZWQgbG9uZyBs
b25nOiAoc2lnbmVkIGxvbmcgbG9uZykwLCBkZWZhdWx0OiAoKHctPnRhc2spKSkpIF9feCA9
ICgqKGNvbnN0IHZvbGF0aWxlIHR5cGVvZiggX0dlbmVyaWMoKCh3LT50YXNrKSksIGNoYXI6
IChjaGFyKTAsIHVuc2lnbmVkIGNoYXI6ICh1bnNpZ25lZCBjaGFyKTAsIHNpZ25lZCBjaGFy
OiAoc2lnbmVkIGNoYXIpMCwgdW5zaWduZWQgc2hvcnQ6ICh1bnNpZ25lZCBzaG9ydCkwLCBz
aWduZWQgc2hvcnQ6IChzaWduZWQgc2hvcnQpMCwgdW5zaWduZWQgaW50OiAodW5zaWduZWQg
aW50KTAsIHNpZ25lZCBpbnQ6IChzaWduZWQgaW50KTAsIHVuc2lnbmVkIGxvbmc6ICh1bnNp
Z25lZCBsb25nKTAsIHNpZ25lZCBsb25nOiAoc2lnbmVkIGxvbmcpMCwgdW5zaWduZWQgbG9u
ZyBsb25nOiAodW5zaWduZWQgbG9uZyBsb25nKTAsIHNpZ25lZCBsb25nIGxvbmc6IChzaWdu
ZWQgbG9uZyBsb25nKTAsIGRlZmF1bHQ6ICgody0+dGFzaykpKSkgKikmKCh3LT50YXNrKSkp
OyBkbyB7IH0gd2hpbGUgKDApOyAodHlwZW9mKCh3LT50YXNrKSkpX194OyB9KTsgfSk7IDsg
KCh0eXBlb2YoKih3LT50YXNrKSkgKikoX19fX19fX19fcDEpKTsgfSk7Cn0KCmV4dGVybiBp
bnQgcmN1d2FpdF93YWtlX3VwKHN0cnVjdCByY3V3YWl0ICp3KTsKCgoKCgoKCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSB2b2lkIHByZXBhcmVfdG9fcmN1d2FpdChzdHJ1Y3QgcmN1d2FpdCAqdykKewogZG8geyB1
aW50cHRyX3QgX3JfYV9wX192ID0gKHVpbnRwdHJfdCkoZ2V0X2N1cnJlbnQoKSk7IDsgaWYg
KF9fYnVpbHRpbl9jb25zdGFudF9wKGdldF9jdXJyZW50KCkpICYmIChfcl9hX3BfX3YpID09
ICh1aW50cHRyX3QpKCh2b2lkICopMCkpIGRvIHsgZG8geyBleHRlcm4gdm9pZCBfX2NvbXBp
bGV0aW1lX2Fzc2VydF8xNjIodm9pZCkgX19hdHRyaWJ1dGVfXygoX19lcnJvcl9fKCJVbnN1
cHBvcnRlZCBhY2Nlc3Mgc2l6ZSBmb3Ige1JFQUQsV1JJVEV9X09OQ0UoKS4iKSkpOyBpZiAo
ISgoc2l6ZW9mKCh3LT50YXNrKSkgPT0gc2l6ZW9mKGNoYXIpIHx8IHNpemVvZigody0+dGFz
aykpID09IHNpemVvZihzaG9ydCkgfHwgc2l6ZW9mKCh3LT50YXNrKSkgPT0gc2l6ZW9mKGlu
dCkgfHwgc2l6ZW9mKCh3LT50YXNrKSkgPT0gc2l6ZW9mKGxvbmcpKSB8fCBzaXplb2YoKHct
PnRhc2spKSA9PSBzaXplb2YobG9uZyBsb25nKSkpIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzE2
MigpOyB9IHdoaWxlICgwKTsgZG8geyAqKHZvbGF0aWxlIHR5cGVvZigody0+dGFzaykpICop
Jigody0+dGFzaykpID0gKCh0eXBlb2Yody0+dGFzaykpKF9yX2FfcF9fdikpOyB9IHdoaWxl
ICgwKTsgfSB3aGlsZSAoMCk7IGVsc2UgZG8geyBkbyB7IGV4dGVybiB2b2lkIF9fY29tcGls
ZXRpbWVfYXNzZXJ0XzE2Myh2b2lkKSBfX2F0dHJpYnV0ZV9fKChfX2Vycm9yX18oIk5lZWQg
bmF0aXZlIHdvcmQgc2l6ZWQgc3RvcmVzL2xvYWRzIGZvciBhdG9taWNpdHkuIikpKTsgaWYg
KCEoKHNpemVvZigqJnctPnRhc2spID09IHNpemVvZihjaGFyKSB8fCBzaXplb2YoKiZ3LT50
YXNrKSA9PSBzaXplb2Yoc2hvcnQpIHx8IHNpemVvZigqJnctPnRhc2spID09IHNpemVvZihp
bnQpIHx8IHNpemVvZigqJnctPnRhc2spID09IHNpemVvZihsb25nKSkpKSBfX2NvbXBpbGV0
aW1lX2Fzc2VydF8xNjMoKTsgfSB3aGlsZSAoMCk7IF9fYXNtX18gX192b2xhdGlsZV9fICgi
bHdzeW5jIiAiICIgOiA6IDoibWVtb3J5Iik7IGRvIHsgZG8geyBleHRlcm4gdm9pZCBfX2Nv
bXBpbGV0aW1lX2Fzc2VydF8xNjQodm9pZCkgX19hdHRyaWJ1dGVfXygoX19lcnJvcl9fKCJV
bnN1cHBvcnRlZCBhY2Nlc3Mgc2l6ZSBmb3Ige1JFQUQsV1JJVEV9X09OQ0UoKS4iKSkpOyBp
ZiAoISgoc2l6ZW9mKComdy0+dGFzaykgPT0gc2l6ZW9mKGNoYXIpIHx8IHNpemVvZigqJnct
PnRhc2spID09IHNpemVvZihzaG9ydCkgfHwgc2l6ZW9mKComdy0+dGFzaykgPT0gc2l6ZW9m
KGludCkgfHwgc2l6ZW9mKComdy0+dGFzaykgPT0gc2l6ZW9mKGxvbmcpKSB8fCBzaXplb2Yo
KiZ3LT50YXNrKSA9PSBzaXplb2YobG9uZyBsb25nKSkpIF9fY29tcGlsZXRpbWVfYXNzZXJ0
XzE2NCgpOyB9IHdoaWxlICgwKTsgZG8geyAqKHZvbGF0aWxlIHR5cGVvZigqJnctPnRhc2sp
ICopJigqJnctPnRhc2spID0gKCh0eXBlb2YoKigodHlwZW9mKHctPnRhc2spKV9yX2FfcF9f
dikpICopKCh0eXBlb2Yody0+dGFzaykpX3JfYV9wX192KSk7IH0gd2hpbGUgKDApOyB9IHdo
aWxlICgwKTsgfSB3aGlsZSAoMCk7IH0gd2hpbGUgKDApOwp9CgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBm
aW5pc2hfcmN1d2FpdChzdHJ1Y3QgcmN1d2FpdCAqdykKewogICAgICAgIGRvIHsgdWludHB0
cl90IF9yX2FfcF9fdiA9ICh1aW50cHRyX3QpKCgodm9pZCAqKTApKTsgOyBpZiAoX19idWls
dGluX2NvbnN0YW50X3AoKCh2b2lkICopMCkpICYmIChfcl9hX3BfX3YpID09ICh1aW50cHRy
X3QpKCh2b2lkICopMCkpIGRvIHsgZG8geyBleHRlcm4gdm9pZCBfX2NvbXBpbGV0aW1lX2Fz
c2VydF8xNjUodm9pZCkgX19hdHRyaWJ1dGVfXygoX19lcnJvcl9fKCJVbnN1cHBvcnRlZCBh
Y2Nlc3Mgc2l6ZSBmb3Ige1JFQUQsV1JJVEV9X09OQ0UoKS4iKSkpOyBpZiAoISgoc2l6ZW9m
KCh3LT50YXNrKSkgPT0gc2l6ZW9mKGNoYXIpIHx8IHNpemVvZigody0+dGFzaykpID09IHNp
emVvZihzaG9ydCkgfHwgc2l6ZW9mKCh3LT50YXNrKSkgPT0gc2l6ZW9mKGludCkgfHwgc2l6
ZW9mKCh3LT50YXNrKSkgPT0gc2l6ZW9mKGxvbmcpKSB8fCBzaXplb2YoKHctPnRhc2spKSA9
PSBzaXplb2YobG9uZyBsb25nKSkpIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzE2NSgpOyB9IHdo
aWxlICgwKTsgZG8geyAqKHZvbGF0aWxlIHR5cGVvZigody0+dGFzaykpICopJigody0+dGFz
aykpID0gKCh0eXBlb2Yody0+dGFzaykpKF9yX2FfcF9fdikpOyB9IHdoaWxlICgwKTsgfSB3
aGlsZSAoMCk7IGVsc2UgZG8geyBkbyB7IGV4dGVybiB2b2lkIF9fY29tcGlsZXRpbWVfYXNz
ZXJ0XzE2Nih2b2lkKSBfX2F0dHJpYnV0ZV9fKChfX2Vycm9yX18oIk5lZWQgbmF0aXZlIHdv
cmQgc2l6ZWQgc3RvcmVzL2xvYWRzIGZvciBhdG9taWNpdHkuIikpKTsgaWYgKCEoKHNpemVv
ZigqJnctPnRhc2spID09IHNpemVvZihjaGFyKSB8fCBzaXplb2YoKiZ3LT50YXNrKSA9PSBz
aXplb2Yoc2hvcnQpIHx8IHNpemVvZigqJnctPnRhc2spID09IHNpemVvZihpbnQpIHx8IHNp
emVvZigqJnctPnRhc2spID09IHNpemVvZihsb25nKSkpKSBfX2NvbXBpbGV0aW1lX2Fzc2Vy
dF8xNjYoKTsgfSB3aGlsZSAoMCk7IF9fYXNtX18gX192b2xhdGlsZV9fICgibHdzeW5jIiAi
ICIgOiA6IDoibWVtb3J5Iik7IGRvIHsgZG8geyBleHRlcm4gdm9pZCBfX2NvbXBpbGV0aW1l
X2Fzc2VydF8xNjcodm9pZCkgX19hdHRyaWJ1dGVfXygoX19lcnJvcl9fKCJVbnN1cHBvcnRl
ZCBhY2Nlc3Mgc2l6ZSBmb3Ige1JFQUQsV1JJVEV9X09OQ0UoKS4iKSkpOyBpZiAoISgoc2l6
ZW9mKComdy0+dGFzaykgPT0gc2l6ZW9mKGNoYXIpIHx8IHNpemVvZigqJnctPnRhc2spID09
IHNpemVvZihzaG9ydCkgfHwgc2l6ZW9mKComdy0+dGFzaykgPT0gc2l6ZW9mKGludCkgfHwg
c2l6ZW9mKComdy0+dGFzaykgPT0gc2l6ZW9mKGxvbmcpKSB8fCBzaXplb2YoKiZ3LT50YXNr
KSA9PSBzaXplb2YobG9uZyBsb25nKSkpIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzE2NygpOyB9
IHdoaWxlICgwKTsgZG8geyAqKHZvbGF0aWxlIHR5cGVvZigqJnctPnRhc2spICopJigqJnct
PnRhc2spID0gKCh0eXBlb2YoKigodHlwZW9mKHctPnRhc2spKV9yX2FfcF9fdikpICopKCh0
eXBlb2Yody0+dGFzaykpX3JfYV9wX192KSk7IH0gd2hpbGUgKDApOyB9IHdoaWxlICgwKTsg
fSB3aGlsZSAoMCk7IH0gd2hpbGUgKDApOwogZ2V0X2N1cnJlbnQoKS0+c3RhdGUgPSAoMHgw
MDAwKTsKfQojIDggIi4vaW5jbHVkZS9saW51eC9wZXJjcHUtcndzZW0uaCIgMgoKIyAxICIu
L2luY2x1ZGUvbGludXgvcmN1X3N5bmMuaCIgMQojIDE3ICIuL2luY2x1ZGUvbGludXgvcmN1
X3N5bmMuaCIKc3RydWN0IHJjdV9zeW5jIHsKIGludCBncF9zdGF0ZTsKIGludCBncF9jb3Vu
dDsKIHdhaXRfcXVldWVfaGVhZF90IGdwX3dhaXQ7Cgogc3RydWN0IGNhbGxiYWNrX2hlYWQg
Y2JfaGVhZDsKfTsKIyAzMiAiLi9pbmNsdWRlL2xpbnV4L3JjdV9zeW5jLmgiCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBib29sIHJjdV9zeW5jX2lzX2lkbGUoc3RydWN0IHJjdV9zeW5jICpyc3ApCnsKIGRvIHsg
fSB3aGlsZSAoMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
OwogcmV0dXJuICEoeyBkbyB7IGV4dGVybiB2b2lkIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzE2
OCh2b2lkKSBfX2F0dHJpYnV0ZV9fKChfX2Vycm9yX18oIlVuc3VwcG9ydGVkIGFjY2VzcyBz
aXplIGZvciB7UkVBRCxXUklURX1fT05DRSgpLiIpKSk7IGlmICghKChzaXplb2YocnNwLT5n
cF9zdGF0ZSkgPT0gc2l6ZW9mKGNoYXIpIHx8IHNpemVvZihyc3AtPmdwX3N0YXRlKSA9PSBz
aXplb2Yoc2hvcnQpIHx8IHNpemVvZihyc3AtPmdwX3N0YXRlKSA9PSBzaXplb2YoaW50KSB8
fCBzaXplb2YocnNwLT5ncF9zdGF0ZSkgPT0gc2l6ZW9mKGxvbmcpKSB8fCBzaXplb2YocnNw
LT5ncF9zdGF0ZSkgPT0gc2l6ZW9mKGxvbmcgbG9uZykpKSBfX2NvbXBpbGV0aW1lX2Fzc2Vy
dF8xNjgoKTsgfSB3aGlsZSAoMCk7ICh7IHR5cGVvZiggX0dlbmVyaWMoKHJzcC0+Z3Bfc3Rh
dGUpLCBjaGFyOiAoY2hhcikwLCB1bnNpZ25lZCBjaGFyOiAodW5zaWduZWQgY2hhcikwLCBz
aWduZWQgY2hhcjogKHNpZ25lZCBjaGFyKTAsIHVuc2lnbmVkIHNob3J0OiAodW5zaWduZWQg
c2hvcnQpMCwgc2lnbmVkIHNob3J0OiAoc2lnbmVkIHNob3J0KTAsIHVuc2lnbmVkIGludDog
KHVuc2lnbmVkIGludCkwLCBzaWduZWQgaW50OiAoc2lnbmVkIGludCkwLCB1bnNpZ25lZCBs
b25nOiAodW5zaWduZWQgbG9uZykwLCBzaWduZWQgbG9uZzogKHNpZ25lZCBsb25nKTAsIHVu
c2lnbmVkIGxvbmcgbG9uZzogKHVuc2lnbmVkIGxvbmcgbG9uZykwLCBzaWduZWQgbG9uZyBs
b25nOiAoc2lnbmVkIGxvbmcgbG9uZykwLCBkZWZhdWx0OiAocnNwLT5ncF9zdGF0ZSkpKSBf
X3ggPSAoKihjb25zdCB2b2xhdGlsZSB0eXBlb2YoIF9HZW5lcmljKChyc3AtPmdwX3N0YXRl
KSwgY2hhcjogKGNoYXIpMCwgdW5zaWduZWQgY2hhcjogKHVuc2lnbmVkIGNoYXIpMCwgc2ln
bmVkIGNoYXI6IChzaWduZWQgY2hhcikwLCB1bnNpZ25lZCBzaG9ydDogKHVuc2lnbmVkIHNo
b3J0KTAsIHNpZ25lZCBzaG9ydDogKHNpZ25lZCBzaG9ydCkwLCB1bnNpZ25lZCBpbnQ6ICh1
bnNpZ25lZCBpbnQpMCwgc2lnbmVkIGludDogKHNpZ25lZCBpbnQpMCwgdW5zaWduZWQgbG9u
ZzogKHVuc2lnbmVkIGxvbmcpMCwgc2lnbmVkIGxvbmc6IChzaWduZWQgbG9uZykwLCB1bnNp
Z25lZCBsb25nIGxvbmc6ICh1bnNpZ25lZCBsb25nIGxvbmcpMCwgc2lnbmVkIGxvbmcgbG9u
ZzogKHNpZ25lZCBsb25nIGxvbmcpMCwgZGVmYXVsdDogKHJzcC0+Z3Bfc3RhdGUpKSkgKikm
KHJzcC0+Z3Bfc3RhdGUpKTsgZG8geyB9IHdoaWxlICgwKTsgKHR5cGVvZihyc3AtPmdwX3N0
YXRlKSlfX3g7IH0pOyB9KTsKfQoKZXh0ZXJuIHZvaWQgcmN1X3N5bmNfaW5pdChzdHJ1Y3Qg
cmN1X3N5bmMgKik7CmV4dGVybiB2b2lkIHJjdV9zeW5jX2VudGVyX3N0YXJ0KHN0cnVjdCBy
Y3Vfc3luYyAqKTsKZXh0ZXJuIHZvaWQgcmN1X3N5bmNfZW50ZXIoc3RydWN0IHJjdV9zeW5j
ICopOwpleHRlcm4gdm9pZCByY3Vfc3luY19leGl0KHN0cnVjdCByY3Vfc3luYyAqKTsKZXh0
ZXJuIHZvaWQgcmN1X3N5bmNfZHRvcihzdHJ1Y3QgcmN1X3N5bmMgKik7CiMgMTAgIi4vaW5j
bHVkZS9saW51eC9wZXJjcHUtcndzZW0uaCIgMgoKCnN0cnVjdCBwZXJjcHVfcndfc2VtYXBo
b3JlIHsKIHN0cnVjdCByY3Vfc3luYyByc3M7CiB1bnNpZ25lZCBpbnQgKnJlYWRfY291bnQ7
CiBzdHJ1Y3QgcmN1d2FpdCB3cml0ZXI7CiB3YWl0X3F1ZXVlX2hlYWRfdCB3YWl0ZXJzOwog
YXRvbWljX3QgYmxvY2s7CgoKCn07CiMgNDUgIi4vaW5jbHVkZS9saW51eC9wZXJjcHUtcndz
ZW0uaCIKZXh0ZXJuIGJvb2wgX19wZXJjcHVfZG93bl9yZWFkKHN0cnVjdCBwZXJjcHVfcndf
c2VtYXBob3JlICosIGJvb2wpOwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgcGVyY3B1X2Rvd25fcmVhZChz
dHJ1Y3QgcGVyY3B1X3J3X3NlbWFwaG9yZSAqc2VtKQp7CiBkbyB7IGRvIHsgfSB3aGlsZSAo
MCk7IH0gd2hpbGUgKDApOwoKIGRvIHsgfSB3aGlsZSAoMCk7CgogX19hc21fXyBfX3ZvbGF0
aWxlX18oIiI6IDogOiJtZW1vcnkiKTsKIyA2MiAiLi9pbmNsdWRlL2xpbnV4L3BlcmNwdS1y
d3NlbS5oIgogaWYgKF9fYnVpbHRpbl9leHBlY3QoISEocmN1X3N5bmNfaXNfaWRsZSgmc2Vt
LT5yc3MpKSwgMSkpCiAgKHsgX190aGlzX2NwdV9wcmVlbXB0X2NoZWNrKCJhZGQiKTsgZG8g
eyBkbyB7IGNvbnN0IHZvaWQgKl9fdnBwX3ZlcmlmeSA9ICh0eXBlb2YoKCYoKnNlbS0+cmVh
ZF9jb3VudCkpICsgMCkpKCh2b2lkICopMCk7ICh2b2lkKV9fdnBwX3ZlcmlmeTsgfSB3aGls
ZSAoMCk7IHN3aXRjaChzaXplb2YoKnNlbS0+cmVhZF9jb3VudCkpIHsgY2FzZSAxOiBkbyB7
ICooeyBkbyB7IGNvbnN0IHZvaWQgKl9fdnBwX3ZlcmlmeSA9ICh0eXBlb2YoKCYoKnNlbS0+
cmVhZF9jb3VudCkpICsgMCkpKCh2b2lkICopMCk7ICh2b2lkKV9fdnBwX3ZlcmlmeTsgfSB3
aGlsZSAoMCk7ICh7IHVuc2lnbmVkIGxvbmcgX19wdHI7IF9fYXNtX18gKCIiIDogIj1yIihf
X3B0cikgOiAiMCIoKHR5cGVvZigqKCYoKnNlbS0+cmVhZF9jb3VudCkpKSAqKSgmKCpzZW0t
PnJlYWRfY291bnQpKSkpOyAodHlwZW9mKCh0eXBlb2YoKigmKCpzZW0tPnJlYWRfY291bnQp
KSkgKikoJigqc2VtLT5yZWFkX2NvdW50KSkpKSAoX19wdHIgKyAoKGxvY2FsX3BhY2EtPmRh
dGFfb2Zmc2V0KSkpOyB9KTsgfSkgKz0gMTsgfSB3aGlsZSAoMCk7YnJlYWs7IGNhc2UgMjog
ZG8geyAqKHsgZG8geyBjb25zdCB2b2lkICpfX3ZwcF92ZXJpZnkgPSAodHlwZW9mKCgmKCpz
ZW0tPnJlYWRfY291bnQpKSArIDApKSgodm9pZCAqKTApOyAodm9pZClfX3ZwcF92ZXJpZnk7
IH0gd2hpbGUgKDApOyAoeyB1bnNpZ25lZCBsb25nIF9fcHRyOyBfX2FzbV9fICgiIiA6ICI9
ciIoX19wdHIpIDogIjAiKCh0eXBlb2YoKigmKCpzZW0tPnJlYWRfY291bnQpKSkgKikoJigq
c2VtLT5yZWFkX2NvdW50KSkpKTsgKHR5cGVvZigodHlwZW9mKCooJigqc2VtLT5yZWFkX2Nv
dW50KSkpICopKCYoKnNlbS0+cmVhZF9jb3VudCkpKSkgKF9fcHRyICsgKChsb2NhbF9wYWNh
LT5kYXRhX29mZnNldCkpKTsgfSk7IH0pICs9IDE7IH0gd2hpbGUgKDApO2JyZWFrOyBjYXNl
IDQ6IGRvIHsgKih7IGRvIHsgY29uc3Qgdm9pZCAqX192cHBfdmVyaWZ5ID0gKHR5cGVvZigo
Jigqc2VtLT5yZWFkX2NvdW50KSkgKyAwKSkoKHZvaWQgKikwKTsgKHZvaWQpX192cHBfdmVy
aWZ5OyB9IHdoaWxlICgwKTsgKHsgdW5zaWduZWQgbG9uZyBfX3B0cjsgX19hc21fXyAoIiIg
OiAiPXIiKF9fcHRyKSA6ICIwIigodHlwZW9mKCooJigqc2VtLT5yZWFkX2NvdW50KSkpICop
KCYoKnNlbS0+cmVhZF9jb3VudCkpKSk7ICh0eXBlb2YoKHR5cGVvZigqKCYoKnNlbS0+cmVh
ZF9jb3VudCkpKSAqKSgmKCpzZW0tPnJlYWRfY291bnQpKSkpIChfX3B0ciArICgobG9jYWxf
cGFjYS0+ZGF0YV9vZmZzZXQpKSk7IH0pOyB9KSArPSAxOyB9IHdoaWxlICgwKTticmVhazsg
Y2FzZSA4OiBkbyB7ICooeyBkbyB7IGNvbnN0IHZvaWQgKl9fdnBwX3ZlcmlmeSA9ICh0eXBl
b2YoKCYoKnNlbS0+cmVhZF9jb3VudCkpICsgMCkpKCh2b2lkICopMCk7ICh2b2lkKV9fdnBw
X3ZlcmlmeTsgfSB3aGlsZSAoMCk7ICh7IHVuc2lnbmVkIGxvbmcgX19wdHI7IF9fYXNtX18g
KCIiIDogIj1yIihfX3B0cikgOiAiMCIoKHR5cGVvZigqKCYoKnNlbS0+cmVhZF9jb3VudCkp
KSAqKSgmKCpzZW0tPnJlYWRfY291bnQpKSkpOyAodHlwZW9mKCh0eXBlb2YoKigmKCpzZW0t
PnJlYWRfY291bnQpKSkgKikoJigqc2VtLT5yZWFkX2NvdW50KSkpKSAoX19wdHIgKyAoKGxv
Y2FsX3BhY2EtPmRhdGFfb2Zmc2V0KSkpOyB9KTsgfSkgKz0gMTsgfSB3aGlsZSAoMCk7YnJl
YWs7IGRlZmF1bHQ6IF9fYmFkX3NpemVfY2FsbF9wYXJhbWV0ZXIoKTticmVhazsgfSB9IHdo
aWxlICgwKTsgfSk7CiBlbHNlCiAgX19wZXJjcHVfZG93bl9yZWFkKHNlbSwgZmFsc2UpOwoK
CgoKIF9fYXNtX18gX192b2xhdGlsZV9fKCIiOiA6IDoibWVtb3J5Iik7Cn0KCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBib29sIHBlcmNwdV9kb3duX3JlYWRfdHJ5bG9jayhzdHJ1Y3QgcGVyY3B1X3J3X3NlbWFw
aG9yZSAqc2VtKQp7CiBib29sIHJldCA9IHRydWU7CgogX19hc21fXyBfX3ZvbGF0aWxlX18o
IiI6IDogOiJtZW1vcnkiKTsKCgoKIGlmIChfX2J1aWx0aW5fZXhwZWN0KCEhKHJjdV9zeW5j
X2lzX2lkbGUoJnNlbS0+cnNzKSksIDEpKQogICh7IF9fdGhpc19jcHVfcHJlZW1wdF9jaGVj
aygiYWRkIik7IGRvIHsgZG8geyBjb25zdCB2b2lkICpfX3ZwcF92ZXJpZnkgPSAodHlwZW9m
KCgmKCpzZW0tPnJlYWRfY291bnQpKSArIDApKSgodm9pZCAqKTApOyAodm9pZClfX3ZwcF92
ZXJpZnk7IH0gd2hpbGUgKDApOyBzd2l0Y2goc2l6ZW9mKCpzZW0tPnJlYWRfY291bnQpKSB7
IGNhc2UgMTogZG8geyAqKHsgZG8geyBjb25zdCB2b2lkICpfX3ZwcF92ZXJpZnkgPSAodHlw
ZW9mKCgmKCpzZW0tPnJlYWRfY291bnQpKSArIDApKSgodm9pZCAqKTApOyAodm9pZClfX3Zw
cF92ZXJpZnk7IH0gd2hpbGUgKDApOyAoeyB1bnNpZ25lZCBsb25nIF9fcHRyOyBfX2FzbV9f
ICgiIiA6ICI9ciIoX19wdHIpIDogIjAiKCh0eXBlb2YoKigmKCpzZW0tPnJlYWRfY291bnQp
KSkgKikoJigqc2VtLT5yZWFkX2NvdW50KSkpKTsgKHR5cGVvZigodHlwZW9mKCooJigqc2Vt
LT5yZWFkX2NvdW50KSkpICopKCYoKnNlbS0+cmVhZF9jb3VudCkpKSkgKF9fcHRyICsgKChs
b2NhbF9wYWNhLT5kYXRhX29mZnNldCkpKTsgfSk7IH0pICs9IDE7IH0gd2hpbGUgKDApO2Jy
ZWFrOyBjYXNlIDI6IGRvIHsgKih7IGRvIHsgY29uc3Qgdm9pZCAqX192cHBfdmVyaWZ5ID0g
KHR5cGVvZigoJigqc2VtLT5yZWFkX2NvdW50KSkgKyAwKSkoKHZvaWQgKikwKTsgKHZvaWQp
X192cHBfdmVyaWZ5OyB9IHdoaWxlICgwKTsgKHsgdW5zaWduZWQgbG9uZyBfX3B0cjsgX19h
c21fXyAoIiIgOiAiPXIiKF9fcHRyKSA6ICIwIigodHlwZW9mKCooJigqc2VtLT5yZWFkX2Nv
dW50KSkpICopKCYoKnNlbS0+cmVhZF9jb3VudCkpKSk7ICh0eXBlb2YoKHR5cGVvZigqKCYo
KnNlbS0+cmVhZF9jb3VudCkpKSAqKSgmKCpzZW0tPnJlYWRfY291bnQpKSkpIChfX3B0ciAr
ICgobG9jYWxfcGFjYS0+ZGF0YV9vZmZzZXQpKSk7IH0pOyB9KSArPSAxOyB9IHdoaWxlICgw
KTticmVhazsgY2FzZSA0OiBkbyB7ICooeyBkbyB7IGNvbnN0IHZvaWQgKl9fdnBwX3Zlcmlm
eSA9ICh0eXBlb2YoKCYoKnNlbS0+cmVhZF9jb3VudCkpICsgMCkpKCh2b2lkICopMCk7ICh2
b2lkKV9fdnBwX3ZlcmlmeTsgfSB3aGlsZSAoMCk7ICh7IHVuc2lnbmVkIGxvbmcgX19wdHI7
IF9fYXNtX18gKCIiIDogIj1yIihfX3B0cikgOiAiMCIoKHR5cGVvZigqKCYoKnNlbS0+cmVh
ZF9jb3VudCkpKSAqKSgmKCpzZW0tPnJlYWRfY291bnQpKSkpOyAodHlwZW9mKCh0eXBlb2Yo
KigmKCpzZW0tPnJlYWRfY291bnQpKSkgKikoJigqc2VtLT5yZWFkX2NvdW50KSkpKSAoX19w
dHIgKyAoKGxvY2FsX3BhY2EtPmRhdGFfb2Zmc2V0KSkpOyB9KTsgfSkgKz0gMTsgfSB3aGls
ZSAoMCk7YnJlYWs7IGNhc2UgODogZG8geyAqKHsgZG8geyBjb25zdCB2b2lkICpfX3ZwcF92
ZXJpZnkgPSAodHlwZW9mKCgmKCpzZW0tPnJlYWRfY291bnQpKSArIDApKSgodm9pZCAqKTAp
OyAodm9pZClfX3ZwcF92ZXJpZnk7IH0gd2hpbGUgKDApOyAoeyB1bnNpZ25lZCBsb25nIF9f
cHRyOyBfX2FzbV9fICgiIiA6ICI9ciIoX19wdHIpIDogIjAiKCh0eXBlb2YoKigmKCpzZW0t
PnJlYWRfY291bnQpKSkgKikoJigqc2VtLT5yZWFkX2NvdW50KSkpKTsgKHR5cGVvZigodHlw
ZW9mKCooJigqc2VtLT5yZWFkX2NvdW50KSkpICopKCYoKnNlbS0+cmVhZF9jb3VudCkpKSkg
KF9fcHRyICsgKChsb2NhbF9wYWNhLT5kYXRhX29mZnNldCkpKTsgfSk7IH0pICs9IDE7IH0g
d2hpbGUgKDApO2JyZWFrOyBkZWZhdWx0OiBfX2JhZF9zaXplX2NhbGxfcGFyYW1ldGVyKCk7
YnJlYWs7IH0gfSB3aGlsZSAoMCk7IH0pOwogZWxzZQogIHJldCA9IF9fcGVyY3B1X2Rvd25f
cmVhZChzZW0sIHRydWUpOwogX19hc21fXyBfX3ZvbGF0aWxlX18oIiI6IDogOiJtZW1vcnki
KTsKCgoKCgogaWYgKHJldCkKICBkbyB7IH0gd2hpbGUgKDApOwoKIHJldHVybiByZXQ7Cn0K
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSB2b2lkIHBlcmNwdV91cF9yZWFkKHN0cnVjdCBwZXJjcHVfcndfc2VtYXBo
b3JlICpzZW0pCnsKIGRvIHsgfSB3aGlsZSAoMCk7CgogX19hc21fXyBfX3ZvbGF0aWxlX18o
IiI6IDogOiJtZW1vcnkiKTsKCgoKIGlmIChfX2J1aWx0aW5fZXhwZWN0KCEhKHJjdV9zeW5j
X2lzX2lkbGUoJnNlbS0+cnNzKSksIDEpKSB7CiAgKHsgX190aGlzX2NwdV9wcmVlbXB0X2No
ZWNrKCJhZGQiKTsgZG8geyBkbyB7IGNvbnN0IHZvaWQgKl9fdnBwX3ZlcmlmeSA9ICh0eXBl
b2YoKCYoKnNlbS0+cmVhZF9jb3VudCkpICsgMCkpKCh2b2lkICopMCk7ICh2b2lkKV9fdnBw
X3ZlcmlmeTsgfSB3aGlsZSAoMCk7IHN3aXRjaChzaXplb2YoKnNlbS0+cmVhZF9jb3VudCkp
IHsgY2FzZSAxOiBkbyB7ICooeyBkbyB7IGNvbnN0IHZvaWQgKl9fdnBwX3ZlcmlmeSA9ICh0
eXBlb2YoKCYoKnNlbS0+cmVhZF9jb3VudCkpICsgMCkpKCh2b2lkICopMCk7ICh2b2lkKV9f
dnBwX3ZlcmlmeTsgfSB3aGlsZSAoMCk7ICh7IHVuc2lnbmVkIGxvbmcgX19wdHI7IF9fYXNt
X18gKCIiIDogIj1yIihfX3B0cikgOiAiMCIoKHR5cGVvZigqKCYoKnNlbS0+cmVhZF9jb3Vu
dCkpKSAqKSgmKCpzZW0tPnJlYWRfY291bnQpKSkpOyAodHlwZW9mKCh0eXBlb2YoKigmKCpz
ZW0tPnJlYWRfY291bnQpKSkgKikoJigqc2VtLT5yZWFkX2NvdW50KSkpKSAoX19wdHIgKyAo
KGxvY2FsX3BhY2EtPmRhdGFfb2Zmc2V0KSkpOyB9KTsgfSkgKz0gLSh0eXBlb2YoKnNlbS0+
cmVhZF9jb3VudCkpKDEpOyB9IHdoaWxlICgwKTticmVhazsgY2FzZSAyOiBkbyB7ICooeyBk
byB7IGNvbnN0IHZvaWQgKl9fdnBwX3ZlcmlmeSA9ICh0eXBlb2YoKCYoKnNlbS0+cmVhZF9j
b3VudCkpICsgMCkpKCh2b2lkICopMCk7ICh2b2lkKV9fdnBwX3ZlcmlmeTsgfSB3aGlsZSAo
MCk7ICh7IHVuc2lnbmVkIGxvbmcgX19wdHI7IF9fYXNtX18gKCIiIDogIj1yIihfX3B0cikg
OiAiMCIoKHR5cGVvZigqKCYoKnNlbS0+cmVhZF9jb3VudCkpKSAqKSgmKCpzZW0tPnJlYWRf
Y291bnQpKSkpOyAodHlwZW9mKCh0eXBlb2YoKigmKCpzZW0tPnJlYWRfY291bnQpKSkgKiko
Jigqc2VtLT5yZWFkX2NvdW50KSkpKSAoX19wdHIgKyAoKGxvY2FsX3BhY2EtPmRhdGFfb2Zm
c2V0KSkpOyB9KTsgfSkgKz0gLSh0eXBlb2YoKnNlbS0+cmVhZF9jb3VudCkpKDEpOyB9IHdo
aWxlICgwKTticmVhazsgY2FzZSA0OiBkbyB7ICooeyBkbyB7IGNvbnN0IHZvaWQgKl9fdnBw
X3ZlcmlmeSA9ICh0eXBlb2YoKCYoKnNlbS0+cmVhZF9jb3VudCkpICsgMCkpKCh2b2lkICop
MCk7ICh2b2lkKV9fdnBwX3ZlcmlmeTsgfSB3aGlsZSAoMCk7ICh7IHVuc2lnbmVkIGxvbmcg
X19wdHI7IF9fYXNtX18gKCIiIDogIj1yIihfX3B0cikgOiAiMCIoKHR5cGVvZigqKCYoKnNl
bS0+cmVhZF9jb3VudCkpKSAqKSgmKCpzZW0tPnJlYWRfY291bnQpKSkpOyAodHlwZW9mKCh0
eXBlb2YoKigmKCpzZW0tPnJlYWRfY291bnQpKSkgKikoJigqc2VtLT5yZWFkX2NvdW50KSkp
KSAoX19wdHIgKyAoKGxvY2FsX3BhY2EtPmRhdGFfb2Zmc2V0KSkpOyB9KTsgfSkgKz0gLSh0
eXBlb2YoKnNlbS0+cmVhZF9jb3VudCkpKDEpOyB9IHdoaWxlICgwKTticmVhazsgY2FzZSA4
OiBkbyB7ICooeyBkbyB7IGNvbnN0IHZvaWQgKl9fdnBwX3ZlcmlmeSA9ICh0eXBlb2YoKCYo
KnNlbS0+cmVhZF9jb3VudCkpICsgMCkpKCh2b2lkICopMCk7ICh2b2lkKV9fdnBwX3Zlcmlm
eTsgfSB3aGlsZSAoMCk7ICh7IHVuc2lnbmVkIGxvbmcgX19wdHI7IF9fYXNtX18gKCIiIDog
Ij1yIihfX3B0cikgOiAiMCIoKHR5cGVvZigqKCYoKnNlbS0+cmVhZF9jb3VudCkpKSAqKSgm
KCpzZW0tPnJlYWRfY291bnQpKSkpOyAodHlwZW9mKCh0eXBlb2YoKigmKCpzZW0tPnJlYWRf
Y291bnQpKSkgKikoJigqc2VtLT5yZWFkX2NvdW50KSkpKSAoX19wdHIgKyAoKGxvY2FsX3Bh
Y2EtPmRhdGFfb2Zmc2V0KSkpOyB9KTsgfSkgKz0gLSh0eXBlb2YoKnNlbS0+cmVhZF9jb3Vu
dCkpKDEpOyB9IHdoaWxlICgwKTticmVhazsgZGVmYXVsdDogX19iYWRfc2l6ZV9jYWxsX3Bh
cmFtZXRlcigpO2JyZWFrOyB9IH0gd2hpbGUgKDApOyB9KTsKIH0gZWxzZSB7CgoKCgogIF9f
YXNtX18gX192b2xhdGlsZV9fICgic3luYyIgOiA6IDogIm1lbW9yeSIpOwoKCgoKCiAgKHsg
X190aGlzX2NwdV9wcmVlbXB0X2NoZWNrKCJhZGQiKTsgZG8geyBkbyB7IGNvbnN0IHZvaWQg
Kl9fdnBwX3ZlcmlmeSA9ICh0eXBlb2YoKCYoKnNlbS0+cmVhZF9jb3VudCkpICsgMCkpKCh2
b2lkICopMCk7ICh2b2lkKV9fdnBwX3ZlcmlmeTsgfSB3aGlsZSAoMCk7IHN3aXRjaChzaXpl
b2YoKnNlbS0+cmVhZF9jb3VudCkpIHsgY2FzZSAxOiBkbyB7ICooeyBkbyB7IGNvbnN0IHZv
aWQgKl9fdnBwX3ZlcmlmeSA9ICh0eXBlb2YoKCYoKnNlbS0+cmVhZF9jb3VudCkpICsgMCkp
KCh2b2lkICopMCk7ICh2b2lkKV9fdnBwX3ZlcmlmeTsgfSB3aGlsZSAoMCk7ICh7IHVuc2ln
bmVkIGxvbmcgX19wdHI7IF9fYXNtX18gKCIiIDogIj1yIihfX3B0cikgOiAiMCIoKHR5cGVv
ZigqKCYoKnNlbS0+cmVhZF9jb3VudCkpKSAqKSgmKCpzZW0tPnJlYWRfY291bnQpKSkpOyAo
dHlwZW9mKCh0eXBlb2YoKigmKCpzZW0tPnJlYWRfY291bnQpKSkgKikoJigqc2VtLT5yZWFk
X2NvdW50KSkpKSAoX19wdHIgKyAoKGxvY2FsX3BhY2EtPmRhdGFfb2Zmc2V0KSkpOyB9KTsg
fSkgKz0gLSh0eXBlb2YoKnNlbS0+cmVhZF9jb3VudCkpKDEpOyB9IHdoaWxlICgwKTticmVh
azsgY2FzZSAyOiBkbyB7ICooeyBkbyB7IGNvbnN0IHZvaWQgKl9fdnBwX3ZlcmlmeSA9ICh0
eXBlb2YoKCYoKnNlbS0+cmVhZF9jb3VudCkpICsgMCkpKCh2b2lkICopMCk7ICh2b2lkKV9f
dnBwX3ZlcmlmeTsgfSB3aGlsZSAoMCk7ICh7IHVuc2lnbmVkIGxvbmcgX19wdHI7IF9fYXNt
X18gKCIiIDogIj1yIihfX3B0cikgOiAiMCIoKHR5cGVvZigqKCYoKnNlbS0+cmVhZF9jb3Vu
dCkpKSAqKSgmKCpzZW0tPnJlYWRfY291bnQpKSkpOyAodHlwZW9mKCh0eXBlb2YoKigmKCpz
ZW0tPnJlYWRfY291bnQpKSkgKikoJigqc2VtLT5yZWFkX2NvdW50KSkpKSAoX19wdHIgKyAo
KGxvY2FsX3BhY2EtPmRhdGFfb2Zmc2V0KSkpOyB9KTsgfSkgKz0gLSh0eXBlb2YoKnNlbS0+
cmVhZF9jb3VudCkpKDEpOyB9IHdoaWxlICgwKTticmVhazsgY2FzZSA0OiBkbyB7ICooeyBk
byB7IGNvbnN0IHZvaWQgKl9fdnBwX3ZlcmlmeSA9ICh0eXBlb2YoKCYoKnNlbS0+cmVhZF9j
b3VudCkpICsgMCkpKCh2b2lkICopMCk7ICh2b2lkKV9fdnBwX3ZlcmlmeTsgfSB3aGlsZSAo
MCk7ICh7IHVuc2lnbmVkIGxvbmcgX19wdHI7IF9fYXNtX18gKCIiIDogIj1yIihfX3B0cikg
OiAiMCIoKHR5cGVvZigqKCYoKnNlbS0+cmVhZF9jb3VudCkpKSAqKSgmKCpzZW0tPnJlYWRf
Y291bnQpKSkpOyAodHlwZW9mKCh0eXBlb2YoKigmKCpzZW0tPnJlYWRfY291bnQpKSkgKiko
Jigqc2VtLT5yZWFkX2NvdW50KSkpKSAoX19wdHIgKyAoKGxvY2FsX3BhY2EtPmRhdGFfb2Zm
c2V0KSkpOyB9KTsgfSkgKz0gLSh0eXBlb2YoKnNlbS0+cmVhZF9jb3VudCkpKDEpOyB9IHdo
aWxlICgwKTticmVhazsgY2FzZSA4OiBkbyB7ICooeyBkbyB7IGNvbnN0IHZvaWQgKl9fdnBw
X3ZlcmlmeSA9ICh0eXBlb2YoKCYoKnNlbS0+cmVhZF9jb3VudCkpICsgMCkpKCh2b2lkICop
MCk7ICh2b2lkKV9fdnBwX3ZlcmlmeTsgfSB3aGlsZSAoMCk7ICh7IHVuc2lnbmVkIGxvbmcg
X19wdHI7IF9fYXNtX18gKCIiIDogIj1yIihfX3B0cikgOiAiMCIoKHR5cGVvZigqKCYoKnNl
bS0+cmVhZF9jb3VudCkpKSAqKSgmKCpzZW0tPnJlYWRfY291bnQpKSkpOyAodHlwZW9mKCh0
eXBlb2YoKigmKCpzZW0tPnJlYWRfY291bnQpKSkgKikoJigqc2VtLT5yZWFkX2NvdW50KSkp
KSAoX19wdHIgKyAoKGxvY2FsX3BhY2EtPmRhdGFfb2Zmc2V0KSkpOyB9KTsgfSkgKz0gLSh0
eXBlb2YoKnNlbS0+cmVhZF9jb3VudCkpKDEpOyB9IHdoaWxlICgwKTticmVhazsgZGVmYXVs
dDogX19iYWRfc2l6ZV9jYWxsX3BhcmFtZXRlcigpO2JyZWFrOyB9IH0gd2hpbGUgKDApOyB9
KTsKICByY3V3YWl0X3dha2VfdXAoJnNlbS0+d3JpdGVyKTsKIH0KIF9fYXNtX18gX192b2xh
dGlsZV9fKCIiOiA6IDoibWVtb3J5Iik7Cn0KCmV4dGVybiB2b2lkIHBlcmNwdV9kb3duX3dy
aXRlKHN0cnVjdCBwZXJjcHVfcndfc2VtYXBob3JlICopOwpleHRlcm4gdm9pZCBwZXJjcHVf
dXBfd3JpdGUoc3RydWN0IHBlcmNwdV9yd19zZW1hcGhvcmUgKik7CgpleHRlcm4gaW50IF9f
cGVyY3B1X2luaXRfcndzZW0oc3RydWN0IHBlcmNwdV9yd19zZW1hcGhvcmUgKiwKICAgIGNv
bnN0IGNoYXIgKiwgc3RydWN0IGxvY2tfY2xhc3Nfa2V5ICopOwoKZXh0ZXJuIHZvaWQgcGVy
Y3B1X2ZyZWVfcndzZW0oc3RydWN0IHBlcmNwdV9yd19zZW1hcGhvcmUgKik7CiMgMTQxICIu
L2luY2x1ZGUvbGludXgvcGVyY3B1LXJ3c2VtLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHBlcmNwdV9y
d3NlbV9yZWxlYXNlKHN0cnVjdCBwZXJjcHVfcndfc2VtYXBob3JlICpzZW0sCiAgICAgYm9v
bCByZWFkLCB1bnNpZ25lZCBsb25nIGlwKQp7CiBkbyB7IH0gd2hpbGUgKDApOwp9CgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgdm9pZCBwZXJjcHVfcndzZW1fYWNxdWlyZShzdHJ1Y3QgcGVyY3B1X3J3X3NlbWFw
aG9yZSAqc2VtLAogICAgIGJvb2wgcmVhZCwgdW5zaWduZWQgbG9uZyBpcCkKewogZG8geyB9
IHdoaWxlICgwKTsKfQojIDM0ICIuL2luY2x1ZGUvbGludXgvZnMuaCIgMgoKIyAxICIuL2lu
Y2x1ZGUvbGludXgvZGVsYXllZF9jYWxsLmgiIDEKIyAxMCAiLi9pbmNsdWRlL2xpbnV4L2Rl
bGF5ZWRfY2FsbC5oIgpzdHJ1Y3QgZGVsYXllZF9jYWxsIHsKIHZvaWQgKCpmbikodm9pZCAq
KTsKIHZvaWQgKmFyZzsKfTsKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHNldF9kZWxheWVkX2NhbGwo
c3RydWN0IGRlbGF5ZWRfY2FsbCAqY2FsbCwKICB2b2lkICgqZm4pKHZvaWQgKiksIHZvaWQg
KmFyZykKewogY2FsbC0+Zm4gPSBmbjsKIGNhbGwtPmFyZyA9IGFyZzsKfQoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IHZvaWQgZG9fZGVsYXllZF9jYWxsKHN0cnVjdCBkZWxheWVkX2NhbGwgKmNhbGwpCnsKIGlm
IChjYWxsLT5mbikKICBjYWxsLT5mbihjYWxsLT5hcmcpOwp9CgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBj
bGVhcl9kZWxheWVkX2NhbGwoc3RydWN0IGRlbGF5ZWRfY2FsbCAqY2FsbCkKewogY2FsbC0+
Zm4gPSAoKHZvaWQgKikwKTsKfQojIDM2ICIuL2luY2x1ZGUvbGludXgvZnMuaCIgMgojIDEg
Ii4vaW5jbHVkZS9saW51eC91dWlkLmgiIDEKIyAxMSAiLi9pbmNsdWRlL2xpbnV4L3V1aWQu
aCIKIyAxICIuL2luY2x1ZGUvdWFwaS9saW51eC91dWlkLmgiIDEKIyAyMyAiLi9pbmNsdWRl
L3VhcGkvbGludXgvdXVpZC5oIgp0eXBlZGVmIHN0cnVjdCB7CiBfX3U4IGJbMTZdOwp9IGd1
aWRfdDsKIyAzNSAiLi9pbmNsdWRlL3VhcGkvbGludXgvdXVpZC5oIgp0eXBlZGVmIGd1aWRf
dCB1dWlkX2xlOwojIDEyICIuL2luY2x1ZGUvbGludXgvdXVpZC5oIiAyCgoKCgp0eXBlZGVm
IHN0cnVjdCB7CiBfX3U4IGJbMTZdOwp9IHV1aWRfdDsKIyAzMyAiLi9pbmNsdWRlL2xpbnV4
L3V1aWQuaCIKZXh0ZXJuIGNvbnN0IGd1aWRfdCBndWlkX251bGw7CmV4dGVybiBjb25zdCB1
dWlkX3QgdXVpZF9udWxsOwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgZ3VpZF9lcXVhbChjb25zdCBndWlk
X3QgKnUxLCBjb25zdCBndWlkX3QgKnUyKQp7CiByZXR1cm4gbWVtY21wKHUxLCB1Miwgc2l6
ZW9mKGd1aWRfdCkpID09IDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGd1aWRfY29weShndWlkX3Qg
KmRzdCwgY29uc3QgZ3VpZF90ICpzcmMpCnsKIG1lbWNweShkc3QsIHNyYywgc2l6ZW9mKGd1
aWRfdCkpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBpbXBvcnRfZ3VpZChndWlkX3QgKmRzdCwgY29u
c3QgX191OCAqc3JjKQp7CiBtZW1jcHkoZHN0LCBzcmMsIHNpemVvZihndWlkX3QpKTsKfQoK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIHZvaWQgZXhwb3J0X2d1aWQoX191OCAqZHN0LCBjb25zdCBndWlkX3QgKnNy
YykKewogbWVtY3B5KGRzdCwgc3JjLCBzaXplb2YoZ3VpZF90KSk7Cn0KCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBi
b29sIGd1aWRfaXNfbnVsbChjb25zdCBndWlkX3QgKmd1aWQpCnsKIHJldHVybiBndWlkX2Vx
dWFsKGd1aWQsICZndWlkX251bGwpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCB1dWlkX2VxdWFsKGNv
bnN0IHV1aWRfdCAqdTEsIGNvbnN0IHV1aWRfdCAqdTIpCnsKIHJldHVybiBtZW1jbXAodTEs
IHUyLCBzaXplb2YodXVpZF90KSkgPT0gMDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgdXVpZF9jb3B5
KHV1aWRfdCAqZHN0LCBjb25zdCB1dWlkX3QgKnNyYykKewogbWVtY3B5KGRzdCwgc3JjLCBz
aXplb2YodXVpZF90KSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGltcG9ydF91dWlkKHV1aWRfdCAq
ZHN0LCBjb25zdCBfX3U4ICpzcmMpCnsKIG1lbWNweShkc3QsIHNyYywgc2l6ZW9mKHV1aWRf
dCkpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBleHBvcnRfdXVpZChfX3U4ICpkc3QsIGNvbnN0IHV1
aWRfdCAqc3JjKQp7CiBtZW1jcHkoZHN0LCBzcmMsIHNpemVvZih1dWlkX3QpKTsKfQoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIGJvb2wgdXVpZF9pc19udWxsKGNvbnN0IHV1aWRfdCAqdXVpZCkKewogcmV0dXJu
IHV1aWRfZXF1YWwodXVpZCwgJnV1aWRfbnVsbCk7Cn0KCnZvaWQgZ2VuZXJhdGVfcmFuZG9t
X3V1aWQodW5zaWduZWQgY2hhciB1dWlkWzE2XSk7CnZvaWQgZ2VuZXJhdGVfcmFuZG9tX2d1
aWQodW5zaWduZWQgY2hhciBndWlkWzE2XSk7CgpleHRlcm4gdm9pZCBndWlkX2dlbihndWlk
X3QgKnUpOwpleHRlcm4gdm9pZCB1dWlkX2dlbih1dWlkX3QgKnUpOwoKYm9vbCBfX2F0dHJp
YnV0ZV9fKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkgdXVpZF9pc192YWxpZChjb25zdCBj
aGFyICp1dWlkKTsKCmV4dGVybiBjb25zdCB1OCBndWlkX2luZGV4WzE2XTsKZXh0ZXJuIGNv
bnN0IHU4IHV1aWRfaW5kZXhbMTZdOwoKaW50IGd1aWRfcGFyc2UoY29uc3QgY2hhciAqdXVp
ZCwgZ3VpZF90ICp1KTsKaW50IHV1aWRfcGFyc2UoY29uc3QgY2hhciAqdXVpZCwgdXVpZF90
ICp1KTsKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgdXVpZF9sZV9jbXAoY29uc3QgZ3VpZF90IHUxLCBj
b25zdCBndWlkX3QgdTIpCnsKIHJldHVybiBtZW1jbXAoJnUxLCAmdTIsIHNpemVvZihndWlk
X3QpKTsKfQojIDM3ICIuL2luY2x1ZGUvbGludXgvZnMuaCIgMgojIDEgIi4vaW5jbHVkZS9s
aW51eC9lcnJzZXEuaCIgMQoKCgoKCgoKdHlwZWRlZiB1MzIgZXJyc2VxX3Q7CgplcnJzZXFf
dCBlcnJzZXFfc2V0KGVycnNlcV90ICplc2VxLCBpbnQgZXJyKTsKZXJyc2VxX3QgZXJyc2Vx
X3NhbXBsZShlcnJzZXFfdCAqZXNlcSk7CmludCBlcnJzZXFfY2hlY2soZXJyc2VxX3QgKmVz
ZXEsIGVycnNlcV90IHNpbmNlKTsKaW50IGVycnNlcV9jaGVja19hbmRfYWR2YW5jZShlcnJz
ZXFfdCAqZXNlcSwgZXJyc2VxX3QgKnNpbmNlKTsKIyAzOCAiLi9pbmNsdWRlL2xpbnV4L2Zz
LmgiIDIKIyAxICIuL2luY2x1ZGUvbGludXgvaW9wcmlvLmgiIDEKCgoKCgojIDEgIi4vaW5j
bHVkZS9saW51eC9zY2hlZC9ydC5oIiAxCgoKCgoKCnN0cnVjdCB0YXNrX3N0cnVjdDsKCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSBpbnQgcnRfcHJpbyhpbnQgcHJpbykKewogaWYgKF9fYnVpbHRpbl9leHBlY3Qo
ISEocHJpbyA8IDEwMCksIDApKQogIHJldHVybiAxOwogcmV0dXJuIDA7Cn0KCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBpbnQgcnRfdGFzayhzdHJ1Y3QgdGFza19zdHJ1Y3QgKnApCnsKIHJldHVybiBydF9wcmlv
KHAtPnByaW8pOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCB0YXNrX2lzX3JlYWx0aW1lKHN0cnVjdCB0
YXNrX3N0cnVjdCAqdHNrKQp7CiBpbnQgcG9saWN5ID0gdHNrLT5wb2xpY3k7CgogaWYgKHBv
bGljeSA9PSAxIHx8IHBvbGljeSA9PSAyKQogIHJldHVybiB0cnVlOwogaWYgKHBvbGljeSA9
PSA2KQogIHJldHVybiB0cnVlOwogcmV0dXJuIGZhbHNlOwp9CgoKCgoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHN0
cnVjdCB0YXNrX3N0cnVjdCAqcnRfbXV0ZXhfZ2V0X3RvcF90YXNrKHN0cnVjdCB0YXNrX3N0
cnVjdCAqcCkKewogcmV0dXJuIHAtPnBpX3RvcF90YXNrOwp9CmV4dGVybiB2b2lkIHJ0X211
dGV4X3NldHByaW8oc3RydWN0IHRhc2tfc3RydWN0ICpwLCBzdHJ1Y3QgdGFza19zdHJ1Y3Qg
KnBpX3Rhc2spOwpleHRlcm4gdm9pZCBydF9tdXRleF9hZGp1c3RfcGkoc3RydWN0IHRhc2tf
c3RydWN0ICpwKTsKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgdHNrX2lzX3BpX2Jsb2NrZWQoc3RydWN0IHRh
c2tfc3RydWN0ICp0c2spCnsKIHJldHVybiB0c2stPnBpX2Jsb2NrZWRfb24gIT0gKCh2b2lk
ICopMCk7Cn0KIyA1OCAiLi9pbmNsdWRlL2xpbnV4L3NjaGVkL3J0LmgiCmV4dGVybiB2b2lk
IG5vcm1hbGl6ZV9ydF90YXNrcyh2b2lkKTsKIyA3ICIuL2luY2x1ZGUvbGludXgvaW9wcmlv
LmgiIDIKIyAxICIuL2luY2x1ZGUvbGludXgvaW9jb250ZXh0LmgiIDEKIyA5ICIuL2luY2x1
ZGUvbGludXgvaW9jb250ZXh0LmgiCmVudW0gewogSUNRX0VYSVRFRCA9IDEgPDwgMiwKIElD
UV9ERVNUUk9ZRUQgPSAxIDw8IDMsCn07CiMgNzMgIi4vaW5jbHVkZS9saW51eC9pb2NvbnRl
eHQuaCIKc3RydWN0IGlvX2NxIHsKIHN0cnVjdCByZXF1ZXN0X3F1ZXVlICpxOwogc3RydWN0
IGlvX2NvbnRleHQgKmlvYzsKCgoKCgoKCiB1bmlvbiB7CiAgc3RydWN0IGxpc3RfaGVhZCBx
X25vZGU7CiAgc3RydWN0IGttZW1fY2FjaGUgKl9fcmN1X2ljcV9jYWNoZTsKIH07CiB1bmlv
biB7CiAgc3RydWN0IGhsaXN0X25vZGUgaW9jX25vZGU7CiAgc3RydWN0IGNhbGxiYWNrX2hl
YWQgX19yY3VfaGVhZDsKIH07CgogdW5zaWduZWQgaW50IGZsYWdzOwp9OwoKCgoKCnN0cnVj
dCBpb19jb250ZXh0IHsKIGF0b21pY19sb25nX3QgcmVmY291bnQ7CiBhdG9taWNfdCBhY3Rp
dmVfcmVmOwogYXRvbWljX3QgbnJfdGFza3M7CgoKIHNwaW5sb2NrX3QgbG9jazsKCiB1bnNp
Z25lZCBzaG9ydCBpb3ByaW87CgoKCgogaW50IG5yX2JhdGNoX3JlcXVlc3RzOwogdW5zaWdu
ZWQgbG9uZyBsYXN0X3dhaXRlZDsKCiBzdHJ1Y3QgeGFycmF5IGljcV90cmVlOwogc3RydWN0
IGlvX2NxICppY3FfaGludDsKIHN0cnVjdCBobGlzdF9oZWFkIGljcV9saXN0OwoKIHN0cnVj
dCB3b3JrX3N0cnVjdCByZWxlYXNlX3dvcms7Cn07CiMgMTMwICIuL2luY2x1ZGUvbGludXgv
aW9jb250ZXh0LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGdldF9pb19jb250ZXh0X2FjdGl2ZShzdHJ1
Y3QgaW9fY29udGV4dCAqaW9jKQp7CiAoeyBpbnQgX19yZXRfd2Fybl9vbiA9ICEhKGF0b21p
Y19sb25nX3JlYWQoJmlvYy0+cmVmY291bnQpIDw9IDApOyBpZiAoX19idWlsdGluX2V4cGVj
dCghIShfX3JldF93YXJuX29uKSwgMCkpIF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJIiAi
dHdpIDMxLCAwLCAwIiAiXG4iICIuc2VjdGlvbiBfX2J1Z190YWJsZSxcImF3XCJcbiIgIjI6
XHQiICIuOGJ5dGUiICIgIiAiMWIsICUwXG4iICJcdC5zaG9ydCAlMSwgJTJcbiIgIi5vcmcg
MmIrJTNcbiIgIi5wcmV2aW91c1xuIiA6IDogImkiICgiLi9pbmNsdWRlL2xpbnV4L2lvY29u
dGV4dC5oIiksICJpIiAoMTMyKSwgImkiICgoMSA8PCAwKSB8ICgoMSA8PCAxKSB8ICgoOSkg
PDwgOCkpKSwgImkiIChzaXplb2Yoc3RydWN0IGJ1Z19lbnRyeSkpKTsgX19idWlsdGluX2V4
cGVjdCghIShfX3JldF93YXJuX29uKSwgMCk7IH0pOwogKHsgaW50IF9fcmV0X3dhcm5fb24g
PSAhIShhdG9taWNfcmVhZCgmaW9jLT5hY3RpdmVfcmVmKSA8PSAwKTsgaWYgKF9fYnVpbHRp
bl9leHBlY3QoISEoX19yZXRfd2Fybl9vbiksIDApKSBfX2FzbV9fIF9fdm9sYXRpbGVfXygg
IjE6CSIgInR3aSAzMSwgMCwgMCIgIlxuIiAiLnNlY3Rpb24gX19idWdfdGFibGUsXCJhd1wi
XG4iICIyOlx0IiAiLjhieXRlIiAiICIgIjFiLCAlMFxuIiAiXHQuc2hvcnQgJTEsICUyXG4i
ICIub3JnIDJiKyUzXG4iICIucHJldmlvdXNcbiIgOiA6ICJpIiAoIi4vaW5jbHVkZS9saW51
eC9pb2NvbnRleHQuaCIpLCAiaSIgKDEzMyksICJpIiAoKDEgPDwgMCkgfCAoKDEgPDwgMSkg
fCAoKDkpIDw8IDgpKSksICJpIiAoc2l6ZW9mKHN0cnVjdCBidWdfZW50cnkpKSk7IF9fYnVp
bHRpbl9leHBlY3QoISEoX19yZXRfd2Fybl9vbiksIDApOyB9KTsKIGF0b21pY19sb25nX2lu
YygmaW9jLT5yZWZjb3VudCk7CiBhdG9taWNfaW5jKCZpb2MtPmFjdGl2ZV9yZWYpOwp9Cgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgdm9pZCBpb2NfdGFza19saW5rKHN0cnVjdCBpb19jb250ZXh0ICppb2MpCnsK
IGdldF9pb19jb250ZXh0X2FjdGl2ZShpb2MpOwoKICh7IGludCBfX3JldF93YXJuX29uID0g
ISEoYXRvbWljX3JlYWQoJmlvYy0+bnJfdGFza3MpIDw9IDApOyBpZiAoX19idWlsdGluX2V4
cGVjdCghIShfX3JldF93YXJuX29uKSwgMCkpIF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJ
IiAidHdpIDMxLCAwLCAwIiAiXG4iICIuc2VjdGlvbiBfX2J1Z190YWJsZSxcImF3XCJcbiIg
IjI6XHQiICIuOGJ5dGUiICIgIiAiMWIsICUwXG4iICJcdC5zaG9ydCAlMSwgJTJcbiIgIi5v
cmcgMmIrJTNcbiIgIi5wcmV2aW91c1xuIiA6IDogImkiICgiLi9pbmNsdWRlL2xpbnV4L2lv
Y29udGV4dC5oIiksICJpIiAoMTQyKSwgImkiICgoMSA8PCAwKSB8ICgoMSA8PCAxKSB8ICgo
OSkgPDwgOCkpKSwgImkiIChzaXplb2Yoc3RydWN0IGJ1Z19lbnRyeSkpKTsgX19idWlsdGlu
X2V4cGVjdCghIShfX3JldF93YXJuX29uKSwgMCk7IH0pOwogYXRvbWljX2luYygmaW9jLT5u
cl90YXNrcyk7Cn0KCnN0cnVjdCB0YXNrX3N0cnVjdDsKCnZvaWQgcHV0X2lvX2NvbnRleHQo
c3RydWN0IGlvX2NvbnRleHQgKmlvYyk7CnZvaWQgcHV0X2lvX2NvbnRleHRfYWN0aXZlKHN0
cnVjdCBpb19jb250ZXh0ICppb2MpOwp2b2lkIGV4aXRfaW9fY29udGV4dChzdHJ1Y3QgdGFz
a19zdHJ1Y3QgKnRhc2spOwpzdHJ1Y3QgaW9fY29udGV4dCAqZ2V0X3Rhc2tfaW9fY29udGV4
dChzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRhc2ssCiAgICAgICAgICAgZ2ZwX3QgZ2ZwX2ZsYWdz
LCBpbnQgbm9kZSk7CiMgOCAiLi9pbmNsdWRlL2xpbnV4L2lvcHJpby5oIiAyCiMgMjcgIi4v
aW5jbHVkZS9saW51eC9pb3ByaW8uaCIKZW51bSB7CiBJT1BSSU9fQ0xBU1NfTk9ORSwKIElP
UFJJT19DTEFTU19SVCwKIElPUFJJT19DTEFTU19CRSwKIElPUFJJT19DTEFTU19JRExFLAp9
OwoKCgoKCgplbnVtIHsKIElPUFJJT19XSE9fUFJPQ0VTUyA9IDEsCiBJT1BSSU9fV0hPX1BH
UlAsCiBJT1BSSU9fV0hPX1VTRVIsCn07CiMgNTQgIi4vaW5jbHVkZS9saW51eC9pb3ByaW8u
aCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIGludCB0YXNrX25pY2VfaW9wcmlvKHN0cnVjdCB0YXNrX3N0cnVjdCAq
dGFzaykKewogcmV0dXJuICh0YXNrX25pY2UodGFzaykgKyAyMCkgLyA1Owp9CgoKCgoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIGludCB0YXNrX25pY2VfaW9jbGFzcyhzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRhc2sp
CnsKIGlmICh0YXNrLT5wb2xpY3kgPT0gNSkKICByZXR1cm4gSU9QUklPX0NMQVNTX0lETEU7
CiBlbHNlIGlmICh0YXNrX2lzX3JlYWx0aW1lKHRhc2spKQogIHJldHVybiBJT1BSSU9fQ0xB
U1NfUlQ7CiBlbHNlCiAgcmV0dXJuIElPUFJJT19DTEFTU19CRTsKfQoKCgoKCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBpbnQgZ2V0X2N1cnJlbnRfaW9wcmlvKHZvaWQpCnsKIHN0cnVjdCBpb19jb250ZXh0ICpp
b2MgPSBnZXRfY3VycmVudCgpLT5pb19jb250ZXh0OwoKIGlmIChpb2MpCiAgcmV0dXJuIGlv
Yy0+aW9wcmlvOwogcmV0dXJuICgoKElPUFJJT19DTEFTU19OT05FKSA8PCAoMTMpKSB8IDAp
Owp9CgoKCgpleHRlcm4gaW50IGlvcHJpb19iZXN0KHVuc2lnbmVkIHNob3J0IGFwcmlvLCB1
bnNpZ25lZCBzaG9ydCBicHJpbyk7CgpleHRlcm4gaW50IHNldF90YXNrX2lvcHJpbyhzdHJ1
Y3QgdGFza19zdHJ1Y3QgKnRhc2ssIGludCBpb3ByaW8pOwoKCmV4dGVybiBpbnQgaW9wcmlv
X2NoZWNrX2NhcChpbnQgaW9wcmlvKTsKIyAzOSAiLi9pbmNsdWRlL2xpbnV4L2ZzLmgiIDIK
IyAxICIuL2luY2x1ZGUvbGludXgvZnNfdHlwZXMuaCIgMQojIDcxICIuL2luY2x1ZGUvbGlu
dXgvZnNfdHlwZXMuaCIKZXh0ZXJuIHVuc2lnbmVkIGNoYXIgZnNfZnR5cGVfdG9fZHR5cGUo
dW5zaWduZWQgaW50IGZpbGV0eXBlKTsKZXh0ZXJuIHVuc2lnbmVkIGNoYXIgZnNfdW1vZGVf
dG9fZnR5cGUodW1vZGVfdCBtb2RlKTsKZXh0ZXJuIHVuc2lnbmVkIGNoYXIgZnNfdW1vZGVf
dG9fZHR5cGUodW1vZGVfdCBtb2RlKTsKIyA0MCAiLi9pbmNsdWRlL2xpbnV4L2ZzLmgiIDIK
CgoKCiMgMSAiLi9pbmNsdWRlL3VhcGkvbGludXgvZnMuaCIgMQojIDE0ICIuL2luY2x1ZGUv
dWFwaS9saW51eC9mcy5oIgojIDEgIi4vaW5jbHVkZS91YXBpL2xpbnV4L2lvY3RsLmgiIDEK
CgoKCiMgMSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS91YXBpL2FzbS9pb2N0bC5oIiAxCiMg
MTIgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvdWFwaS9hc20vaW9jdGwuaCIKIyAxICIuL2lu
Y2x1ZGUvYXNtLWdlbmVyaWMvaW9jdGwuaCIgMQoKCgoKIyAxICIuL2luY2x1ZGUvdWFwaS9h
c20tZ2VuZXJpYy9pb2N0bC5oIiAxCiMgNiAiLi9pbmNsdWRlL2FzbS1nZW5lcmljL2lvY3Rs
LmgiIDIKCgoKCgpleHRlcm4gdW5zaWduZWQgaW50IF9faW52YWxpZF9zaXplX2FyZ3VtZW50
X2Zvcl9JT0M7CiMgMTMgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvdWFwaS9hc20vaW9jdGwu
aCIgMgojIDYgIi4vaW5jbHVkZS91YXBpL2xpbnV4L2lvY3RsLmgiIDIKIyAxNSAiLi9pbmNs
dWRlL3VhcGkvbGludXgvZnMuaCIgMgojIDU0ICIuL2luY2x1ZGUvdWFwaS9saW51eC9mcy5o
IgpzdHJ1Y3QgZmlsZV9jbG9uZV9yYW5nZSB7CiBfX3M2NCBzcmNfZmQ7CiBfX3U2NCBzcmNf
b2Zmc2V0OwogX191NjQgc3JjX2xlbmd0aDsKIF9fdTY0IGRlc3Rfb2Zmc2V0Owp9OwoKc3Ry
dWN0IGZzdHJpbV9yYW5nZSB7CiBfX3U2NCBzdGFydDsKIF9fdTY0IGxlbjsKIF9fdTY0IG1p
bmxlbjsKfTsKCgoKCgoKc3RydWN0IGZpbGVfZGVkdXBlX3JhbmdlX2luZm8gewogX19zNjQg
ZGVzdF9mZDsKIF9fdTY0IGRlc3Rfb2Zmc2V0OwogX191NjQgYnl0ZXNfZGVkdXBlZDsKCgoK
CgoKIF9fczMyIHN0YXR1czsKIF9fdTMyIHJlc2VydmVkOwp9OwoKCnN0cnVjdCBmaWxlX2Rl
ZHVwZV9yYW5nZSB7CiBfX3U2NCBzcmNfb2Zmc2V0OwogX191NjQgc3JjX2xlbmd0aDsKIF9f
dTE2IGRlc3RfY291bnQ7CiBfX3UxNiByZXNlcnZlZDE7CiBfX3UzMiByZXNlcnZlZDI7CiBz
dHJ1Y3QgZmlsZV9kZWR1cGVfcmFuZ2VfaW5mbyBpbmZvWzBdOwp9OwoKCnN0cnVjdCBmaWxl
c19zdGF0X3N0cnVjdCB7CiB1bnNpZ25lZCBsb25nIG5yX2ZpbGVzOwogdW5zaWduZWQgbG9u
ZyBucl9mcmVlX2ZpbGVzOwogdW5zaWduZWQgbG9uZyBtYXhfZmlsZXM7Cn07CgpzdHJ1Y3Qg
aW5vZGVzX3N0YXRfdCB7CiBsb25nIG5yX2lub2RlczsKIGxvbmcgbnJfdW51c2VkOwogbG9u
ZyBkdW1teVs1XTsKfTsKCgoKCgoKCnN0cnVjdCBmc3hhdHRyIHsKIF9fdTMyIGZzeF94Zmxh
Z3M7CiBfX3UzMiBmc3hfZXh0c2l6ZTsKIF9fdTMyIGZzeF9uZXh0ZW50czsKIF9fdTMyIGZz
eF9wcm9qaWQ7CiBfX3UzMiBmc3hfY293ZXh0c2l6ZTsKIHVuc2lnbmVkIGNoYXIgZnN4X3Bh
ZFs4XTsKfTsKIyAyODYgIi4vaW5jbHVkZS91YXBpL2xpbnV4L2ZzLmgiCnR5cGVkZWYgaW50
IF9fa2VybmVsX3J3Zl90OwojIDQ1ICIuL2luY2x1ZGUvbGludXgvZnMuaCIgMgoKc3RydWN0
IGJhY2tpbmdfZGV2X2luZm87CnN0cnVjdCBiZGlfd3JpdGViYWNrOwpzdHJ1Y3QgYmlvOwpz
dHJ1Y3QgZXhwb3J0X29wZXJhdGlvbnM7CnN0cnVjdCBmaWVtYXBfZXh0ZW50X2luZm87CnN0
cnVjdCBoZF9nZW9tZXRyeTsKc3RydWN0IGlvdmVjOwpzdHJ1Y3Qga2lvY2I7CnN0cnVjdCBr
b2JqZWN0OwpzdHJ1Y3QgcGlwZV9pbm9kZV9pbmZvOwpzdHJ1Y3QgcG9sbF90YWJsZV9zdHJ1
Y3Q7CnN0cnVjdCBrc3RhdGZzOwpzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3Q7CnN0cnVjdCB2ZnNt
b3VudDsKc3RydWN0IGNyZWQ7CnN0cnVjdCBzd2FwX2luZm9fc3RydWN0OwpzdHJ1Y3Qgc2Vx
X2ZpbGU7CnN0cnVjdCB3b3JrcXVldWVfc3RydWN0OwpzdHJ1Y3QgaW92X2l0ZXI7CnN0cnVj
dCBmc2NyeXB0X2luZm87CnN0cnVjdCBmc2NyeXB0X29wZXJhdGlvbnM7CnN0cnVjdCBmc3Zl
cml0eV9pbmZvOwpzdHJ1Y3QgZnN2ZXJpdHlfb3BlcmF0aW9uczsKc3RydWN0IGZzX2NvbnRl
eHQ7CnN0cnVjdCBmc19wYXJhbWV0ZXJfc3BlYzsKCmV4dGVybiB2b2lkIF9fYXR0cmlidXRl
X18oKF9fc2VjdGlvbl9fKCIuaW5pdC50ZXh0IikpKSBfX2F0dHJpYnV0ZV9fKChfX2NvbGRf
XykpIGlub2RlX2luaXQodm9pZCk7CmV4dGVybiB2b2lkIF9fYXR0cmlidXRlX18oKF9fc2Vj
dGlvbl9fKCIuaW5pdC50ZXh0IikpKSBfX2F0dHJpYnV0ZV9fKChfX2NvbGRfXykpIGlub2Rl
X2luaXRfZWFybHkodm9pZCk7CmV4dGVybiB2b2lkIF9fYXR0cmlidXRlX18oKF9fc2VjdGlv
bl9fKCIuaW5pdC50ZXh0IikpKSBfX2F0dHJpYnV0ZV9fKChfX2NvbGRfXykpIGZpbGVzX2lu
aXQodm9pZCk7CmV4dGVybiB2b2lkIF9fYXR0cmlidXRlX18oKF9fc2VjdGlvbl9fKCIuaW5p
dC50ZXh0IikpKSBfX2F0dHJpYnV0ZV9fKChfX2NvbGRfXykpIGZpbGVzX21heGZpbGVzX2lu
aXQodm9pZCk7CgpleHRlcm4gc3RydWN0IGZpbGVzX3N0YXRfc3RydWN0IGZpbGVzX3N0YXQ7
CmV4dGVybiB1bnNpZ25lZCBsb25nIGdldF9tYXhfZmlsZXModm9pZCk7CmV4dGVybiB1bnNp
Z25lZCBpbnQgc3lzY3RsX25yX29wZW47CmV4dGVybiBzdHJ1Y3QgaW5vZGVzX3N0YXRfdCBp
bm9kZXNfc3RhdDsKZXh0ZXJuIGludCBsZWFzZXNfZW5hYmxlLCBsZWFzZV9icmVha190aW1l
OwpleHRlcm4gaW50IHN5c2N0bF9wcm90ZWN0ZWRfc3ltbGlua3M7CmV4dGVybiBpbnQgc3lz
Y3RsX3Byb3RlY3RlZF9oYXJkbGlua3M7CmV4dGVybiBpbnQgc3lzY3RsX3Byb3RlY3RlZF9m
aWZvczsKZXh0ZXJuIGludCBzeXNjdGxfcHJvdGVjdGVkX3JlZ3VsYXI7Cgp0eXBlZGVmIF9f
a2VybmVsX3J3Zl90IHJ3Zl90OwoKc3RydWN0IGJ1ZmZlcl9oZWFkOwp0eXBlZGVmIGludCAo
Z2V0X2Jsb2NrX3QpKHN0cnVjdCBpbm9kZSAqaW5vZGUsIHNlY3Rvcl90IGlibG9jaywKICAg
c3RydWN0IGJ1ZmZlcl9oZWFkICpiaF9yZXN1bHQsIGludCBjcmVhdGUpOwp0eXBlZGVmIGlu
dCAoZGlvX2lvZG9uZV90KShzdHJ1Y3Qga2lvY2IgKmlvY2IsIGxvZmZfdCBvZmZzZXQsCiAg
IHNzaXplX3QgYnl0ZXMsIHZvaWQgKnByaXZhdGUpOwojIDIyNCAiLi9pbmNsdWRlL2xpbnV4
L2ZzLmgiCnN0cnVjdCBpYXR0ciB7CiB1bnNpZ25lZCBpbnQgaWFfdmFsaWQ7CiB1bW9kZV90
IGlhX21vZGU7CiBrdWlkX3QgaWFfdWlkOwoga2dpZF90IGlhX2dpZDsKIGxvZmZfdCBpYV9z
aXplOwogc3RydWN0IHRpbWVzcGVjNjQgaWFfYXRpbWU7CiBzdHJ1Y3QgdGltZXNwZWM2NCBp
YV9tdGltZTsKIHN0cnVjdCB0aW1lc3BlYzY0IGlhX2N0aW1lOwoKCgoKCgogc3RydWN0IGZp
bGUgKmlhX2ZpbGU7Cn07CgoKCgojIDEgIi4vaW5jbHVkZS9saW51eC9xdW90YS5oIiAxCiMg
NDAgIi4vaW5jbHVkZS9saW51eC9xdW90YS5oIgojIDEgIi4vaW5jbHVkZS9saW51eC9wZXJj
cHVfY291bnRlci5oIiAxCiMgMjAgIi4vaW5jbHVkZS9saW51eC9wZXJjcHVfY291bnRlci5o
IgpzdHJ1Y3QgcGVyY3B1X2NvdW50ZXIgewogcmF3X3NwaW5sb2NrX3QgbG9jazsKIHM2NCBj
b3VudDsKCgoKIHMzMiAqY291bnRlcnM7Cn07CgpleHRlcm4gaW50IHBlcmNwdV9jb3VudGVy
X2JhdGNoOwoKaW50IF9fcGVyY3B1X2NvdW50ZXJfaW5pdChzdHJ1Y3QgcGVyY3B1X2NvdW50
ZXIgKmZiYywgczY0IGFtb3VudCwgZ2ZwX3QgZ2ZwLAogICAgIHN0cnVjdCBsb2NrX2NsYXNz
X2tleSAqa2V5KTsKIyA0MSAiLi9pbmNsdWRlL2xpbnV4L3BlcmNwdV9jb3VudGVyLmgiCnZv
aWQgcGVyY3B1X2NvdW50ZXJfZGVzdHJveShzdHJ1Y3QgcGVyY3B1X2NvdW50ZXIgKmZiYyk7
CnZvaWQgcGVyY3B1X2NvdW50ZXJfc2V0KHN0cnVjdCBwZXJjcHVfY291bnRlciAqZmJjLCBz
NjQgYW1vdW50KTsKdm9pZCBwZXJjcHVfY291bnRlcl9hZGRfYmF0Y2goc3RydWN0IHBlcmNw
dV9jb3VudGVyICpmYmMsIHM2NCBhbW91bnQsCiAgICAgICAgIHMzMiBiYXRjaCk7CnM2NCBf
X3BlcmNwdV9jb3VudGVyX3N1bShzdHJ1Y3QgcGVyY3B1X2NvdW50ZXIgKmZiYyk7CmludCBf
X3BlcmNwdV9jb3VudGVyX2NvbXBhcmUoc3RydWN0IHBlcmNwdV9jb3VudGVyICpmYmMsIHM2
NCByaHMsIHMzMiBiYXRjaCk7CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHBlcmNwdV9jb3VudGVyX2NvbXBh
cmUoc3RydWN0IHBlcmNwdV9jb3VudGVyICpmYmMsIHM2NCByaHMpCnsKIHJldHVybiBfX3Bl
cmNwdV9jb3VudGVyX2NvbXBhcmUoZmJjLCByaHMsIHBlcmNwdV9jb3VudGVyX2JhdGNoKTsK
fQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIHZvaWQgcGVyY3B1X2NvdW50ZXJfYWRkKHN0cnVjdCBwZXJjcHVfY291
bnRlciAqZmJjLCBzNjQgYW1vdW50KQp7CiBwZXJjcHVfY291bnRlcl9hZGRfYmF0Y2goZmJj
LCBhbW91bnQsIHBlcmNwdV9jb3VudGVyX2JhdGNoKTsKfQoKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHM2NCBwZXJj
cHVfY291bnRlcl9zdW1fcG9zaXRpdmUoc3RydWN0IHBlcmNwdV9jb3VudGVyICpmYmMpCnsK
IHM2NCByZXQgPSBfX3BlcmNwdV9jb3VudGVyX3N1bShmYmMpOwogcmV0dXJuIHJldCA8IDAg
PyAwIDogcmV0Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgczY0IHBlcmNwdV9jb3VudGVyX3N1bShzdHJ1Y3Qg
cGVyY3B1X2NvdW50ZXIgKmZiYykKewogcmV0dXJuIF9fcGVyY3B1X2NvdW50ZXJfc3VtKGZi
Yyk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSBzNjQgcGVyY3B1X2NvdW50ZXJfcmVhZChzdHJ1Y3QgcGVyY3B1
X2NvdW50ZXIgKmZiYykKewogcmV0dXJuIGZiYy0+Y291bnQ7Cn0KCgoKCgoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IHM2NCBwZXJjcHVfY291bnRlcl9yZWFkX3Bvc2l0aXZlKHN0cnVjdCBwZXJjcHVfY291bnRl
ciAqZmJjKQp7CgogczY0IHJldCA9ICh7IGRvIHsgZXh0ZXJuIHZvaWQgX19jb21waWxldGlt
ZV9hc3NlcnRfMTY5KHZvaWQpIF9fYXR0cmlidXRlX18oKF9fZXJyb3JfXygiVW5zdXBwb3J0
ZWQgYWNjZXNzIHNpemUgZm9yIHtSRUFELFdSSVRFfV9PTkNFKCkuIikpKTsgaWYgKCEoKHNp
emVvZihmYmMtPmNvdW50KSA9PSBzaXplb2YoY2hhcikgfHwgc2l6ZW9mKGZiYy0+Y291bnQp
ID09IHNpemVvZihzaG9ydCkgfHwgc2l6ZW9mKGZiYy0+Y291bnQpID09IHNpemVvZihpbnQp
IHx8IHNpemVvZihmYmMtPmNvdW50KSA9PSBzaXplb2YobG9uZykpIHx8IHNpemVvZihmYmMt
PmNvdW50KSA9PSBzaXplb2YobG9uZyBsb25nKSkpIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzE2
OSgpOyB9IHdoaWxlICgwKTsgKHsgdHlwZW9mKCBfR2VuZXJpYygoZmJjLT5jb3VudCksIGNo
YXI6IChjaGFyKTAsIHVuc2lnbmVkIGNoYXI6ICh1bnNpZ25lZCBjaGFyKTAsIHNpZ25lZCBj
aGFyOiAoc2lnbmVkIGNoYXIpMCwgdW5zaWduZWQgc2hvcnQ6ICh1bnNpZ25lZCBzaG9ydCkw
LCBzaWduZWQgc2hvcnQ6IChzaWduZWQgc2hvcnQpMCwgdW5zaWduZWQgaW50OiAodW5zaWdu
ZWQgaW50KTAsIHNpZ25lZCBpbnQ6IChzaWduZWQgaW50KTAsIHVuc2lnbmVkIGxvbmc6ICh1
bnNpZ25lZCBsb25nKTAsIHNpZ25lZCBsb25nOiAoc2lnbmVkIGxvbmcpMCwgdW5zaWduZWQg
bG9uZyBsb25nOiAodW5zaWduZWQgbG9uZyBsb25nKTAsIHNpZ25lZCBsb25nIGxvbmc6IChz
aWduZWQgbG9uZyBsb25nKTAsIGRlZmF1bHQ6IChmYmMtPmNvdW50KSkpIF9feCA9ICgqKGNv
bnN0IHZvbGF0aWxlIHR5cGVvZiggX0dlbmVyaWMoKGZiYy0+Y291bnQpLCBjaGFyOiAoY2hh
cikwLCB1bnNpZ25lZCBjaGFyOiAodW5zaWduZWQgY2hhcikwLCBzaWduZWQgY2hhcjogKHNp
Z25lZCBjaGFyKTAsIHVuc2lnbmVkIHNob3J0OiAodW5zaWduZWQgc2hvcnQpMCwgc2lnbmVk
IHNob3J0OiAoc2lnbmVkIHNob3J0KTAsIHVuc2lnbmVkIGludDogKHVuc2lnbmVkIGludCkw
LCBzaWduZWQgaW50OiAoc2lnbmVkIGludCkwLCB1bnNpZ25lZCBsb25nOiAodW5zaWduZWQg
bG9uZykwLCBzaWduZWQgbG9uZzogKHNpZ25lZCBsb25nKTAsIHVuc2lnbmVkIGxvbmcgbG9u
ZzogKHVuc2lnbmVkIGxvbmcgbG9uZykwLCBzaWduZWQgbG9uZyBsb25nOiAoc2lnbmVkIGxv
bmcgbG9uZykwLCBkZWZhdWx0OiAoZmJjLT5jb3VudCkpKSAqKSYoZmJjLT5jb3VudCkpOyBk
byB7IH0gd2hpbGUgKDApOyAodHlwZW9mKGZiYy0+Y291bnQpKV9feDsgfSk7IH0pOwoKIGlm
IChyZXQgPj0gMCkKICByZXR1cm4gcmV0OwogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29s
IHBlcmNwdV9jb3VudGVyX2luaXRpYWxpemVkKHN0cnVjdCBwZXJjcHVfY291bnRlciAqZmJj
KQp7CiByZXR1cm4gKGZiYy0+Y291bnRlcnMgIT0gKCh2b2lkICopMCkpOwp9CiMgMTc3ICIu
L2luY2x1ZGUvbGludXgvcGVyY3B1X2NvdW50ZXIuaCIKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgcGVyY3B1
X2NvdW50ZXJfaW5jKHN0cnVjdCBwZXJjcHVfY291bnRlciAqZmJjKQp7CiBwZXJjcHVfY291
bnRlcl9hZGQoZmJjLCAxKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgcGVyY3B1X2NvdW50ZXJfZGVj
KHN0cnVjdCBwZXJjcHVfY291bnRlciAqZmJjKQp7CiBwZXJjcHVfY291bnRlcl9hZGQoZmJj
LCAtMSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHBlcmNwdV9jb3VudGVyX3N1YihzdHJ1Y3QgcGVy
Y3B1X2NvdW50ZXIgKmZiYywgczY0IGFtb3VudCkKewogcGVyY3B1X2NvdW50ZXJfYWRkKGZi
YywgLWFtb3VudCk7Cn0KIyA0MSAiLi9pbmNsdWRlL2xpbnV4L3F1b3RhLmgiIDIKCiMgMSAi
Li9pbmNsdWRlL3VhcGkvbGludXgvZHFibGtfeGZzLmgiIDEKIyA1MyAiLi9pbmNsdWRlL3Vh
cGkvbGludXgvZHFibGtfeGZzLmgiCnR5cGVkZWYgc3RydWN0IGZzX2Rpc2tfcXVvdGEgewog
X19zOCBkX3ZlcnNpb247CiBfX3M4IGRfZmxhZ3M7CiBfX3UxNiBkX2ZpZWxkbWFzazsKIF9f
dTMyIGRfaWQ7CiBfX3U2NCBkX2Jsa19oYXJkbGltaXQ7CiBfX3U2NCBkX2Jsa19zb2Z0bGlt
aXQ7CiBfX3U2NCBkX2lub19oYXJkbGltaXQ7CiBfX3U2NCBkX2lub19zb2Z0bGltaXQ7CiBf
X3U2NCBkX2Jjb3VudDsKIF9fdTY0IGRfaWNvdW50OwogX19zMzIgZF9pdGltZXI7CgogX19z
MzIgZF9idGltZXI7CiBfX3UxNiBkX2l3YXJuczsKIF9fdTE2IGRfYndhcm5zOwogX19zMzIg
ZF9wYWRkaW5nMjsKIF9fdTY0IGRfcnRiX2hhcmRsaW1pdDsKIF9fdTY0IGRfcnRiX3NvZnRs
aW1pdDsKIF9fdTY0IGRfcnRiY291bnQ7CiBfX3MzMiBkX3J0YnRpbWVyOwogX191MTYgZF9y
dGJ3YXJuczsKIF9fczE2IGRfcGFkZGluZzM7CiBjaGFyIGRfcGFkZGluZzRbOF07Cn0gZnNf
ZGlza19xdW90YV90OwojIDE0OSAiLi9pbmNsdWRlL3VhcGkvbGludXgvZHFibGtfeGZzLmgi
CnR5cGVkZWYgc3RydWN0IGZzX3FmaWxlc3RhdCB7CiBfX3U2NCBxZnNfaW5vOwogX191NjQg
cWZzX25ibGtzOwogX191MzIgcWZzX25leHRlbnRzOwp9IGZzX3FmaWxlc3RhdF90OwoKdHlw
ZWRlZiBzdHJ1Y3QgZnNfcXVvdGFfc3RhdCB7CiBfX3M4IHFzX3ZlcnNpb247CiBfX3UxNiBx
c19mbGFnczsKIF9fczggcXNfcGFkOwogZnNfcWZpbGVzdGF0X3QgcXNfdXF1b3RhOwogZnNf
cWZpbGVzdGF0X3QgcXNfZ3F1b3RhOwogX191MzIgcXNfaW5jb3JlZHFzOwogX19zMzIgcXNf
YnRpbWVsaW1pdDsKIF9fczMyIHFzX2l0aW1lbGltaXQ7CiBfX3MzMiBxc19ydGJ0aW1lbGlt
aXQ7CiBfX3UxNiBxc19id2FybmxpbWl0OwogX191MTYgcXNfaXdhcm5saW1pdDsKfSBmc19x
dW90YV9zdGF0X3Q7CiMgMTkyICIuL2luY2x1ZGUvdWFwaS9saW51eC9kcWJsa194ZnMuaCIK
c3RydWN0IGZzX3FmaWxlc3RhdHYgewogX191NjQgcWZzX2lubzsKIF9fdTY0IHFmc19uYmxr
czsKIF9fdTMyIHFmc19uZXh0ZW50czsKIF9fdTMyIHFmc19wYWQ7Cn07CgpzdHJ1Y3QgZnNf
cXVvdGFfc3RhdHYgewogX19zOCBxc192ZXJzaW9uOwogX191OCBxc19wYWQxOwogX191MTYg
cXNfZmxhZ3M7CiBfX3UzMiBxc19pbmNvcmVkcXM7CiBzdHJ1Y3QgZnNfcWZpbGVzdGF0diBx
c191cXVvdGE7CiBzdHJ1Y3QgZnNfcWZpbGVzdGF0diBxc19ncXVvdGE7CiBzdHJ1Y3QgZnNf
cWZpbGVzdGF0diBxc19wcXVvdGE7CiBfX3MzMiBxc19idGltZWxpbWl0OwogX19zMzIgcXNf
aXRpbWVsaW1pdDsKIF9fczMyIHFzX3J0YnRpbWVsaW1pdDsKIF9fdTE2IHFzX2J3YXJubGlt
aXQ7CiBfX3UxNiBxc19pd2FybmxpbWl0OwogX191NjQgcXNfcGFkMls4XTsKfTsKIyA0MyAi
Li9pbmNsdWRlL2xpbnV4L3F1b3RhLmgiIDIKIyAxICIuL2luY2x1ZGUvbGludXgvZHFibGtf
djEuaCIgMQojIDQ0ICIuL2luY2x1ZGUvbGludXgvcXVvdGEuaCIgMgojIDEgIi4vaW5jbHVk
ZS9saW51eC9kcWJsa192Mi5oIiAxCiMgOSAiLi9pbmNsdWRlL2xpbnV4L2RxYmxrX3YyLmgi
CiMgMSAiLi9pbmNsdWRlL2xpbnV4L2RxYmxrX3F0cmVlLmgiIDEKIyAxOCAiLi9pbmNsdWRl
L2xpbnV4L2RxYmxrX3F0cmVlLmgiCnN0cnVjdCBkcXVvdDsKc3RydWN0IGtxaWQ7CgoKc3Ry
dWN0IHF0cmVlX2ZtdF9vcGVyYXRpb25zIHsKIHZvaWQgKCptZW0yZGlza19kcWJsaykodm9p
ZCAqZGlzaywgc3RydWN0IGRxdW90ICpkcXVvdCk7CiB2b2lkICgqZGlzazJtZW1fZHFibGsp
KHN0cnVjdCBkcXVvdCAqZHF1b3QsIHZvaWQgKmRpc2spOwogaW50ICgqaXNfaWQpKHZvaWQg
KmRpc2ssIHN0cnVjdCBkcXVvdCAqZHF1b3QpOwp9OwoKCnN0cnVjdCBxdHJlZV9tZW1fZHFp
bmZvIHsKIHN0cnVjdCBzdXBlcl9ibG9jayAqZHFpX3NiOwogaW50IGRxaV90eXBlOwogdW5z
aWduZWQgaW50IGRxaV9ibG9ja3M7CiB1bnNpZ25lZCBpbnQgZHFpX2ZyZWVfYmxrOwogdW5z
aWduZWQgaW50IGRxaV9mcmVlX2VudHJ5OwogdW5zaWduZWQgaW50IGRxaV9ibG9ja3NpemVf
Yml0czsKIHVuc2lnbmVkIGludCBkcWlfZW50cnlfc2l6ZTsKIHVuc2lnbmVkIGludCBkcWlf
dXNhYmxlX2JzOwogdW5zaWduZWQgaW50IGRxaV9xdHJlZV9kZXB0aDsKIGNvbnN0IHN0cnVj
dCBxdHJlZV9mbXRfb3BlcmF0aW9ucyAqZHFpX29wczsKfTsKCmludCBxdHJlZV93cml0ZV9k
cXVvdChzdHJ1Y3QgcXRyZWVfbWVtX2RxaW5mbyAqaW5mbywgc3RydWN0IGRxdW90ICpkcXVv
dCk7CmludCBxdHJlZV9yZWFkX2RxdW90KHN0cnVjdCBxdHJlZV9tZW1fZHFpbmZvICppbmZv
LCBzdHJ1Y3QgZHF1b3QgKmRxdW90KTsKaW50IHF0cmVlX2RlbGV0ZV9kcXVvdChzdHJ1Y3Qg
cXRyZWVfbWVtX2RxaW5mbyAqaW5mbywgc3RydWN0IGRxdW90ICpkcXVvdCk7CmludCBxdHJl
ZV9yZWxlYXNlX2RxdW90KHN0cnVjdCBxdHJlZV9tZW1fZHFpbmZvICppbmZvLCBzdHJ1Y3Qg
ZHF1b3QgKmRxdW90KTsKaW50IHF0cmVlX2VudHJ5X3VudXNlZChzdHJ1Y3QgcXRyZWVfbWVt
X2RxaW5mbyAqaW5mbywgY2hhciAqZGlzayk7CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgcXRyZWVfZGVwdGgo
c3RydWN0IHF0cmVlX21lbV9kcWluZm8gKmluZm8pCnsKIHVuc2lnbmVkIGludCBlcGIgPSBp
bmZvLT5kcWlfdXNhYmxlX2JzID4+IDI7CiB1bnNpZ25lZCBsb25nIGxvbmcgZW50cmllcyA9
IGVwYjsKIGludCBpOwoKIGZvciAoaSA9IDE7IGVudHJpZXMgPCAoMVVMTCA8PCAzMik7IGkr
KykKICBlbnRyaWVzICo9IGVwYjsKIHJldHVybiBpOwp9CmludCBxdHJlZV9nZXRfbmV4dF9p
ZChzdHJ1Y3QgcXRyZWVfbWVtX2RxaW5mbyAqaW5mbywgc3RydWN0IGtxaWQgKnFpZCk7CiMg
MTAgIi4vaW5jbHVkZS9saW51eC9kcWJsa192Mi5oIiAyCiMgNDUgIi4vaW5jbHVkZS9saW51
eC9xdW90YS5oIiAyCgoKCiMgMSAiLi9pbmNsdWRlL2xpbnV4L3Byb2ppZC5oIiAxCiMgMTcg
Ii4vaW5jbHVkZS9saW51eC9wcm9qaWQuaCIKc3RydWN0IHVzZXJfbmFtZXNwYWNlOwpleHRl
cm4gc3RydWN0IHVzZXJfbmFtZXNwYWNlIGluaXRfdXNlcl9uczsKCnR5cGVkZWYgX19rZXJu
ZWxfdWlkMzJfdCBwcm9qaWRfdDsKCnR5cGVkZWYgc3RydWN0IHsKIHByb2ppZF90IHZhbDsK
fSBrcHJvamlkX3Q7CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgcHJvamlkX3QgX19rcHJvamlkX3ZhbChrcHJvamlk
X3QgcHJvamlkKQp7CiByZXR1cm4gcHJvamlkLnZhbDsKfQoKCgoKCgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9v
bCBwcm9qaWRfZXEoa3Byb2ppZF90IGxlZnQsIGtwcm9qaWRfdCByaWdodCkKewogcmV0dXJu
IF9fa3Byb2ppZF92YWwobGVmdCkgPT0gX19rcHJvamlkX3ZhbChyaWdodCk7Cn0KCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBib29sIHByb2ppZF9sdChrcHJvamlkX3QgbGVmdCwga3Byb2ppZF90IHJpZ2h0KQp7
CiByZXR1cm4gX19rcHJvamlkX3ZhbChsZWZ0KSA8IF9fa3Byb2ppZF92YWwocmlnaHQpOwp9
CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgYm9vbCBwcm9qaWRfdmFsaWQoa3Byb2ppZF90IHByb2ppZCkKewogcmV0
dXJuICFwcm9qaWRfZXEocHJvamlkLCAoa3Byb2ppZF90KXsgLTEgfSk7Cn0KIyA2NSAiLi9p
bmNsdWRlL2xpbnV4L3Byb2ppZC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkga3Byb2ppZF90IG1ha2Vfa3Byb2pp
ZChzdHJ1Y3QgdXNlcl9uYW1lc3BhY2UgKmZyb20sIHByb2ppZF90IHByb2ppZCkKewogcmV0
dXJuIChrcHJvamlkX3QpeyBwcm9qaWQgfTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHByb2ppZF90IGZyb21f
a3Byb2ppZChzdHJ1Y3QgdXNlcl9uYW1lc3BhY2UgKnRvLCBrcHJvamlkX3Qga3Byb2ppZCkK
ewogcmV0dXJuIF9fa3Byb2ppZF92YWwoa3Byb2ppZCk7Cn0KCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBwcm9qaWRf
dCBmcm9tX2twcm9qaWRfbXVuZ2VkKHN0cnVjdCB1c2VyX25hbWVzcGFjZSAqdG8sIGtwcm9q
aWRfdCBrcHJvamlkKQp7CiBwcm9qaWRfdCBwcm9qaWQgPSBmcm9tX2twcm9qaWQodG8sIGtw
cm9qaWQpOwogaWYgKHByb2ppZCA9PSAocHJvamlkX3QpLTEpCiAgcHJvamlkID0gNjU1MzQ7
CiByZXR1cm4gcHJvamlkOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBrcHJvamlkX2hhc19tYXBwaW5n
KHN0cnVjdCB1c2VyX25hbWVzcGFjZSAqbnMsIGtwcm9qaWRfdCBwcm9qaWQpCnsKIHJldHVy
biB0cnVlOwp9CiMgNDkgIi4vaW5jbHVkZS9saW51eC9xdW90YS5oIiAyCiMgMSAiLi9pbmNs
dWRlL3VhcGkvbGludXgvcXVvdGEuaCIgMQojIDkwICIuL2luY2x1ZGUvdWFwaS9saW51eC9x
dW90YS5oIgplbnVtIHsKIFFJRl9CTElNSVRTX0IgPSAwLAogUUlGX1NQQUNFX0IsCiBRSUZf
SUxJTUlUU19CLAogUUlGX0lOT0RFU19CLAogUUlGX0JUSU1FX0IsCiBRSUZfSVRJTUVfQiwK
fTsKIyAxMTAgIi4vaW5jbHVkZS91YXBpL2xpbnV4L3F1b3RhLmgiCnN0cnVjdCBpZl9kcWJs
ayB7CiBfX3U2NCBkcWJfYmhhcmRsaW1pdDsKIF9fdTY0IGRxYl9ic29mdGxpbWl0OwogX191
NjQgZHFiX2N1cnNwYWNlOwogX191NjQgZHFiX2loYXJkbGltaXQ7CiBfX3U2NCBkcWJfaXNv
ZnRsaW1pdDsKIF9fdTY0IGRxYl9jdXJpbm9kZXM7CiBfX3U2NCBkcWJfYnRpbWU7CiBfX3U2
NCBkcWJfaXRpbWU7CiBfX3UzMiBkcWJfdmFsaWQ7Cn07CgpzdHJ1Y3QgaWZfbmV4dGRxYmxr
IHsKIF9fdTY0IGRxYl9iaGFyZGxpbWl0OwogX191NjQgZHFiX2Jzb2Z0bGltaXQ7CiBfX3U2
NCBkcWJfY3Vyc3BhY2U7CiBfX3U2NCBkcWJfaWhhcmRsaW1pdDsKIF9fdTY0IGRxYl9pc29m
dGxpbWl0OwogX191NjQgZHFiX2N1cmlub2RlczsKIF9fdTY0IGRxYl9idGltZTsKIF9fdTY0
IGRxYl9pdGltZTsKIF9fdTMyIGRxYl92YWxpZDsKIF9fdTMyIGRxYl9pZDsKfTsKIyAxNDQg
Ii4vaW5jbHVkZS91YXBpL2xpbnV4L3F1b3RhLmgiCmVudW0gewogRFFGX1JPT1RfU1FVQVNI
X0IgPSAwLAogRFFGX1NZU19GSUxFX0IgPSAxNiwKCiBEUUZfUFJJVkFURQp9OwoKCgoKCgpz
dHJ1Y3QgaWZfZHFpbmZvIHsKIF9fdTY0IGRxaV9iZ3JhY2U7CiBfX3U2NCBkcWlfaWdyYWNl
OwogX191MzIgZHFpX2ZsYWdzOwogX191MzIgZHFpX3ZhbGlkOwp9OwojIDE3OCAiLi9pbmNs
dWRlL3VhcGkvbGludXgvcXVvdGEuaCIKZW51bSB7CiBRVU9UQV9OTF9DX1VOU1BFQywKIFFV
T1RBX05MX0NfV0FSTklORywKIF9fUVVPVEFfTkxfQ19NQVgsCn07CgoKZW51bSB7CiBRVU9U
QV9OTF9BX1VOU1BFQywKIFFVT1RBX05MX0FfUVRZUEUsCiBRVU9UQV9OTF9BX0VYQ0VTU19J
RCwKIFFVT1RBX05MX0FfV0FSTklORywKIFFVT1RBX05MX0FfREVWX01BSk9SLAogUVVPVEFf
TkxfQV9ERVZfTUlOT1IsCiBRVU9UQV9OTF9BX0NBVVNFRF9JRCwKIFFVT1RBX05MX0FfUEFE
LAogX19RVU9UQV9OTF9BX01BWCwKfTsKIyA1MCAiLi9pbmNsdWRlL2xpbnV4L3F1b3RhLmgi
IDIKCgoKCmVudW0gcXVvdGFfdHlwZSB7CiBVU1JRVU9UQSA9IDAsCiBHUlBRVU9UQSA9IDEs
CiBQUkpRVU9UQSA9IDIsCn07CgoKCgoKCnR5cGVkZWYgX19rZXJuZWxfdWlkMzJfdCBxaWRf
dDsKdHlwZWRlZiBsb25nIGxvbmcgcXNpemVfdDsKCnN0cnVjdCBrcWlkIHsKIHVuaW9uIHsK
ICBrdWlkX3QgdWlkOwogIGtnaWRfdCBnaWQ7CiAga3Byb2ppZF90IHByb2ppZDsKIH07CiBl
bnVtIHF1b3RhX3R5cGUgdHlwZTsKfTsKCmV4dGVybiBib29sIHFpZF9lcShzdHJ1Y3Qga3Fp
ZCBsZWZ0LCBzdHJ1Y3Qga3FpZCByaWdodCk7CmV4dGVybiBib29sIHFpZF9sdChzdHJ1Y3Qg
a3FpZCBsZWZ0LCBzdHJ1Y3Qga3FpZCByaWdodCk7CmV4dGVybiBxaWRfdCBmcm9tX2txaWQo
c3RydWN0IHVzZXJfbmFtZXNwYWNlICp0bywgc3RydWN0IGtxaWQgcWlkKTsKZXh0ZXJuIHFp
ZF90IGZyb21fa3FpZF9tdW5nZWQoc3RydWN0IHVzZXJfbmFtZXNwYWNlICp0bywgc3RydWN0
IGtxaWQgcWlkKTsKZXh0ZXJuIGJvb2wgcWlkX3ZhbGlkKHN0cnVjdCBrcWlkIHFpZCk7CiMg
OTcgIi4vaW5jbHVkZS9saW51eC9xdW90YS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IGtxaWQgbWFr
ZV9rcWlkKHN0cnVjdCB1c2VyX25hbWVzcGFjZSAqZnJvbSwKICAgICAgICBlbnVtIHF1b3Rh
X3R5cGUgdHlwZSwgcWlkX3QgcWlkKQp7CiBzdHJ1Y3Qga3FpZCBrcWlkOwoKIGtxaWQudHlw
ZSA9IHR5cGU7CiBzd2l0Y2ggKHR5cGUpIHsKIGNhc2UgVVNSUVVPVEE6CiAga3FpZC51aWQg
PSBtYWtlX2t1aWQoZnJvbSwgcWlkKTsKICBicmVhazsKIGNhc2UgR1JQUVVPVEE6CiAga3Fp
ZC5naWQgPSBtYWtlX2tnaWQoZnJvbSwgcWlkKTsKICBicmVhazsKIGNhc2UgUFJKUVVPVEE6
CiAga3FpZC5wcm9qaWQgPSBtYWtlX2twcm9qaWQoZnJvbSwgcWlkKTsKICBicmVhazsKIGRl
ZmF1bHQ6CiAgZG8geyBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CSIgInR3aSAzMSwgMCwg
MCIgIlxuIiAiLnNlY3Rpb24gX19idWdfdGFibGUsXCJhd1wiXG4iICIyOlx0IiAiLjhieXRl
IiAiICIgIjFiLCAlMFxuIiAiXHQuc2hvcnQgJTEsICUyXG4iICIub3JnIDJiKyUzXG4iICIu
cHJldmlvdXNcbiIgOiA6ICJpIiAoIi4vaW5jbHVkZS9saW51eC9xdW90YS5oIiksICJpIiAo
MTE0KSwgImkiICgwKSwgImkiIChzaXplb2Yoc3RydWN0IGJ1Z19lbnRyeSkpKTsgZG8geyA7
IGFzbSB2b2xhdGlsZSgiIik7IF9fYnVpbHRpbl91bnJlYWNoYWJsZSgpOyB9IHdoaWxlICgw
KTsgfSB3aGlsZSAoMCk7CiB9CiByZXR1cm4ga3FpZDsKfQoKCgoKCgoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHN0
cnVjdCBrcWlkIG1ha2Vfa3FpZF9pbnZhbGlkKGVudW0gcXVvdGFfdHlwZSB0eXBlKQp7CiBz
dHJ1Y3Qga3FpZCBrcWlkOwoKIGtxaWQudHlwZSA9IHR5cGU7CiBzd2l0Y2ggKHR5cGUpIHsK
IGNhc2UgVVNSUVVPVEE6CiAga3FpZC51aWQgPSAoa3VpZF90KXsgLTEgfTsKICBicmVhazsK
IGNhc2UgR1JQUVVPVEE6CiAga3FpZC5naWQgPSAoa2dpZF90KXsgLTEgfTsKICBicmVhazsK
IGNhc2UgUFJKUVVPVEE6CiAga3FpZC5wcm9qaWQgPSAoa3Byb2ppZF90KXsgLTEgfTsKICBi
cmVhazsKIGRlZmF1bHQ6CiAgZG8geyBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CSIgInR3
aSAzMSwgMCwgMCIgIlxuIiAiLnNlY3Rpb24gX19idWdfdGFibGUsXCJhd1wiXG4iICIyOlx0
IiAiLjhieXRlIiAiICIgIjFiLCAlMFxuIiAiXHQuc2hvcnQgJTEsICUyXG4iICIub3JnIDJi
KyUzXG4iICIucHJldmlvdXNcbiIgOiA6ICJpIiAoIi4vaW5jbHVkZS9saW51eC9xdW90YS5o
IiksICJpIiAoMTQxKSwgImkiICgwKSwgImkiIChzaXplb2Yoc3RydWN0IGJ1Z19lbnRyeSkp
KTsgZG8geyA7IGFzbSB2b2xhdGlsZSgiIik7IF9fYnVpbHRpbl91bnJlYWNoYWJsZSgpOyB9
IHdoaWxlICgwKTsgfSB3aGlsZSAoMCk7CiB9CiByZXR1cm4ga3FpZDsKfQoKCgoKCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBzdHJ1Y3Qga3FpZCBtYWtlX2txaWRfdWlkKGt1aWRfdCB1aWQpCnsKIHN0cnVjdCBr
cWlkIGtxaWQ7CiBrcWlkLnR5cGUgPSBVU1JRVU9UQTsKIGtxaWQudWlkID0gdWlkOwogcmV0
dXJuIGtxaWQ7Cn0KCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IGtxaWQgbWFrZV9rcWlkX2dpZChr
Z2lkX3QgZ2lkKQp7CiBzdHJ1Y3Qga3FpZCBrcWlkOwoga3FpZC50eXBlID0gR1JQUVVPVEE7
CiBrcWlkLmdpZCA9IGdpZDsKIHJldHVybiBrcWlkOwp9CgoKCgoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHN0cnVj
dCBrcWlkIG1ha2Vfa3FpZF9wcm9qaWQoa3Byb2ppZF90IHByb2ppZCkKewogc3RydWN0IGtx
aWQga3FpZDsKIGtxaWQudHlwZSA9IFBSSlFVT1RBOwoga3FpZC5wcm9qaWQgPSBwcm9qaWQ7
CiByZXR1cm4ga3FpZDsKfQoKCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBxaWRfaGFzX21hcHBpbmco
c3RydWN0IHVzZXJfbmFtZXNwYWNlICpucywgc3RydWN0IGtxaWQgcWlkKQp7CiByZXR1cm4g
ZnJvbV9rcWlkKG5zLCBxaWQpICE9IChxaWRfdCkgLTE7Cn0KCgpleHRlcm4gc3BpbmxvY2tf
dCBkcV9kYXRhX2xvY2s7CiMgMjA1ICIuL2luY2x1ZGUvbGludXgvcXVvdGEuaCIKc3RydWN0
IG1lbV9kcWJsayB7CiBxc2l6ZV90IGRxYl9iaGFyZGxpbWl0OwogcXNpemVfdCBkcWJfYnNv
ZnRsaW1pdDsKIHFzaXplX3QgZHFiX2N1cnNwYWNlOwogcXNpemVfdCBkcWJfcnN2c3BhY2U7
CiBxc2l6ZV90IGRxYl9paGFyZGxpbWl0OwogcXNpemVfdCBkcWJfaXNvZnRsaW1pdDsKIHFz
aXplX3QgZHFiX2N1cmlub2RlczsKIHRpbWU2NF90IGRxYl9idGltZTsKIHRpbWU2NF90IGRx
Yl9pdGltZTsKfTsKCgoKCnN0cnVjdCBxdW90YV9mb3JtYXRfdHlwZTsKCnN0cnVjdCBtZW1f
ZHFpbmZvIHsKIHN0cnVjdCBxdW90YV9mb3JtYXRfdHlwZSAqZHFpX2Zvcm1hdDsKIGludCBk
cWlfZm10X2lkOwoKIHN0cnVjdCBsaXN0X2hlYWQgZHFpX2RpcnR5X2xpc3Q7CiB1bnNpZ25l
ZCBsb25nIGRxaV9mbGFnczsKIHVuc2lnbmVkIGludCBkcWlfYmdyYWNlOwogdW5zaWduZWQg
aW50IGRxaV9pZ3JhY2U7CiBxc2l6ZV90IGRxaV9tYXhfc3BjX2xpbWl0OwogcXNpemVfdCBk
cWlfbWF4X2lub19saW1pdDsKIHZvaWQgKmRxaV9wcml2Owp9OwoKc3RydWN0IHN1cGVyX2Js
b2NrOwoKCgoKCgplbnVtIHsKIERRRl9JTkZPX0RJUlRZX0IgPSBEUUZfUFJJVkFURSwKfTsK
CgpleHRlcm4gdm9pZCBtYXJrX2luZm9fZGlydHkoc3RydWN0IHN1cGVyX2Jsb2NrICpzYiwg
aW50IHR5cGUpOwpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGluZm9fZGlydHkoc3RydWN0IG1lbV9kcWluZm8g
KmluZm8pCnsKIHJldHVybiB0ZXN0X2JpdChEUUZfSU5GT19ESVJUWV9CLCAmaW5mby0+ZHFp
X2ZsYWdzKTsKfQoKZW51bSB7CiBEUVNUX0xPT0tVUFMsCiBEUVNUX0RST1BTLAogRFFTVF9S
RUFEUywKIERRU1RfV1JJVEVTLAogRFFTVF9DQUNIRV9ISVRTLAogRFFTVF9BTExPQ19EUVVP
VFMsCiBEUVNUX0ZSRUVfRFFVT1RTLAogRFFTVF9TWU5DUywKIF9EUVNUX0RRU1RBVF9MQVNU
Cn07CgpzdHJ1Y3QgZHFzdGF0cyB7CiB1bnNpZ25lZCBsb25nIHN0YXRbX0RRU1RfRFFTVEFU
X0xBU1RdOwogc3RydWN0IHBlcmNwdV9jb3VudGVyIGNvdW50ZXJbX0RRU1RfRFFTVEFUX0xB
U1RdOwp9OwoKZXh0ZXJuIHN0cnVjdCBkcXN0YXRzIGRxc3RhdHM7CgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9p
ZCBkcXN0YXRzX2luYyh1bnNpZ25lZCBpbnQgdHlwZSkKewogcGVyY3B1X2NvdW50ZXJfaW5j
KCZkcXN0YXRzLmNvdW50ZXJbdHlwZV0pOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBkcXN0YXRzX2Rl
Yyh1bnNpZ25lZCBpbnQgdHlwZSkKewogcGVyY3B1X2NvdW50ZXJfZGVjKCZkcXN0YXRzLmNv
dW50ZXJbdHlwZV0pOwp9CiMgMjk0ICIuL2luY2x1ZGUvbGludXgvcXVvdGEuaCIKc3RydWN0
IGRxdW90IHsKIHN0cnVjdCBobGlzdF9ub2RlIGRxX2hhc2g7CiBzdHJ1Y3QgbGlzdF9oZWFk
IGRxX2ludXNlOwogc3RydWN0IGxpc3RfaGVhZCBkcV9mcmVlOwogc3RydWN0IGxpc3RfaGVh
ZCBkcV9kaXJ0eTsKIHN0cnVjdCBtdXRleCBkcV9sb2NrOwogc3BpbmxvY2tfdCBkcV9kcWJf
bG9jazsKIGF0b21pY190IGRxX2NvdW50Owogc3RydWN0IHN1cGVyX2Jsb2NrICpkcV9zYjsK
IHN0cnVjdCBrcWlkIGRxX2lkOwogbG9mZl90IGRxX29mZjsKIHVuc2lnbmVkIGxvbmcgZHFf
ZmxhZ3M7CiBzdHJ1Y3QgbWVtX2RxYmxrIGRxX2RxYjsKfTsKCgpzdHJ1Y3QgcXVvdGFfZm9y
bWF0X29wcyB7CiBpbnQgKCpjaGVja19xdW90YV9maWxlKShzdHJ1Y3Qgc3VwZXJfYmxvY2sg
KnNiLCBpbnQgdHlwZSk7CiBpbnQgKCpyZWFkX2ZpbGVfaW5mbykoc3RydWN0IHN1cGVyX2Js
b2NrICpzYiwgaW50IHR5cGUpOwogaW50ICgqd3JpdGVfZmlsZV9pbmZvKShzdHJ1Y3Qgc3Vw
ZXJfYmxvY2sgKnNiLCBpbnQgdHlwZSk7CiBpbnQgKCpmcmVlX2ZpbGVfaW5mbykoc3RydWN0
IHN1cGVyX2Jsb2NrICpzYiwgaW50IHR5cGUpOwogaW50ICgqcmVhZF9kcWJsaykoc3RydWN0
IGRxdW90ICpkcXVvdCk7CiBpbnQgKCpjb21taXRfZHFibGspKHN0cnVjdCBkcXVvdCAqZHF1
b3QpOwogaW50ICgqcmVsZWFzZV9kcWJsaykoc3RydWN0IGRxdW90ICpkcXVvdCk7CiBpbnQg
KCpnZXRfbmV4dF9pZCkoc3RydWN0IHN1cGVyX2Jsb2NrICpzYiwgc3RydWN0IGtxaWQgKnFp
ZCk7Cn07CgoKc3RydWN0IGRxdW90X29wZXJhdGlvbnMgewogaW50ICgqd3JpdGVfZHF1b3Qp
IChzdHJ1Y3QgZHF1b3QgKik7CiBzdHJ1Y3QgZHF1b3QgKigqYWxsb2NfZHF1b3QpKHN0cnVj
dCBzdXBlcl9ibG9jayAqLCBpbnQpOwogdm9pZCAoKmRlc3Ryb3lfZHF1b3QpKHN0cnVjdCBk
cXVvdCAqKTsKIGludCAoKmFjcXVpcmVfZHF1b3QpIChzdHJ1Y3QgZHF1b3QgKik7CiBpbnQg
KCpyZWxlYXNlX2RxdW90KSAoc3RydWN0IGRxdW90ICopOwogaW50ICgqbWFya19kaXJ0eSkg
KHN0cnVjdCBkcXVvdCAqKTsKIGludCAoKndyaXRlX2luZm8pIChzdHJ1Y3Qgc3VwZXJfYmxv
Y2sgKiwgaW50KTsKCgogcXNpemVfdCAqKCpnZXRfcmVzZXJ2ZWRfc3BhY2UpIChzdHJ1Y3Qg
aW5vZGUgKik7CiBpbnQgKCpnZXRfcHJvamlkKSAoc3RydWN0IGlub2RlICosIGtwcm9qaWRf
dCAqKTsKCiBpbnQgKCpnZXRfaW5vZGVfdXNhZ2UpIChzdHJ1Y3QgaW5vZGUgKiwgcXNpemVf
dCAqKTsKCiBpbnQgKCpnZXRfbmV4dF9pZCkgKHN0cnVjdCBzdXBlcl9ibG9jayAqc2IsIHN0
cnVjdCBrcWlkICpxaWQpOwp9OwoKc3RydWN0IHBhdGg7CgoKc3RydWN0IHFjX2RxYmxrIHsK
IGludCBkX2ZpZWxkbWFzazsKIHU2NCBkX3NwY19oYXJkbGltaXQ7CiB1NjQgZF9zcGNfc29m
dGxpbWl0OwogdTY0IGRfaW5vX2hhcmRsaW1pdDsKIHU2NCBkX2lub19zb2Z0bGltaXQ7CiB1
NjQgZF9zcGFjZTsKIHU2NCBkX2lub19jb3VudDsKIHM2NCBkX2lub190aW1lcjsKCiBzNjQg
ZF9zcGNfdGltZXI7CiBpbnQgZF9pbm9fd2FybnM7CiBpbnQgZF9zcGNfd2FybnM7CiB1NjQg
ZF9ydF9zcGNfaGFyZGxpbWl0OwogdTY0IGRfcnRfc3BjX3NvZnRsaW1pdDsKIHU2NCBkX3J0
X3NwYWNlOwogczY0IGRfcnRfc3BjX3RpbWVyOwogaW50IGRfcnRfc3BjX3dhcm5zOwp9Owoj
IDM5NSAiLi9pbmNsdWRlL2xpbnV4L3F1b3RhLmgiCnN0cnVjdCBxY190eXBlX3N0YXRlIHsK
IHVuc2lnbmVkIGludCBmbGFnczsKIHVuc2lnbmVkIGludCBzcGNfdGltZWxpbWl0OwoKIHVu
c2lnbmVkIGludCBpbm9fdGltZWxpbWl0OwogdW5zaWduZWQgaW50IHJ0X3NwY190aW1lbGlt
aXQ7CiB1bnNpZ25lZCBpbnQgc3BjX3dhcm5saW1pdDsKIHVuc2lnbmVkIGludCBpbm9fd2Fy
bmxpbWl0OwogdW5zaWduZWQgaW50IHJ0X3NwY193YXJubGltaXQ7CiB1bnNpZ25lZCBsb25n
IGxvbmcgaW5vOwogYmxrY250X3QgYmxvY2tzOwogYmxrY250X3QgbmV4dGVudHM7Cn07Cgpz
dHJ1Y3QgcWNfc3RhdGUgewogdW5zaWduZWQgaW50IHNfaW5jb3JlZHFzOwogc3RydWN0IHFj
X3R5cGVfc3RhdGUgc19zdGF0ZVszXTsKfTsKCgpzdHJ1Y3QgcWNfaW5mbyB7CiBpbnQgaV9m
aWVsZG1hc2s7CiB1bnNpZ25lZCBpbnQgaV9mbGFnczsKIHVuc2lnbmVkIGludCBpX3NwY190
aW1lbGltaXQ7CgogdW5zaWduZWQgaW50IGlfaW5vX3RpbWVsaW1pdDsKIHVuc2lnbmVkIGlu
dCBpX3J0X3NwY190aW1lbGltaXQ7CiB1bnNpZ25lZCBpbnQgaV9zcGNfd2FybmxpbWl0Owog
dW5zaWduZWQgaW50IGlfaW5vX3dhcm5saW1pdDsKIHVuc2lnbmVkIGludCBpX3J0X3NwY193
YXJubGltaXQ7Cn07CgoKc3RydWN0IHF1b3RhY3RsX29wcyB7CiBpbnQgKCpxdW90YV9vbiko
c3RydWN0IHN1cGVyX2Jsb2NrICosIGludCwgaW50LCBjb25zdCBzdHJ1Y3QgcGF0aCAqKTsK
IGludCAoKnF1b3RhX29mZikoc3RydWN0IHN1cGVyX2Jsb2NrICosIGludCk7CiBpbnQgKCpx
dW90YV9lbmFibGUpKHN0cnVjdCBzdXBlcl9ibG9jayAqLCB1bnNpZ25lZCBpbnQpOwogaW50
ICgqcXVvdGFfZGlzYWJsZSkoc3RydWN0IHN1cGVyX2Jsb2NrICosIHVuc2lnbmVkIGludCk7
CiBpbnQgKCpxdW90YV9zeW5jKShzdHJ1Y3Qgc3VwZXJfYmxvY2sgKiwgaW50KTsKIGludCAo
KnNldF9pbmZvKShzdHJ1Y3Qgc3VwZXJfYmxvY2sgKiwgaW50LCBzdHJ1Y3QgcWNfaW5mbyAq
KTsKIGludCAoKmdldF9kcWJsaykoc3RydWN0IHN1cGVyX2Jsb2NrICosIHN0cnVjdCBrcWlk
LCBzdHJ1Y3QgcWNfZHFibGsgKik7CiBpbnQgKCpnZXRfbmV4dGRxYmxrKShzdHJ1Y3Qgc3Vw
ZXJfYmxvY2sgKiwgc3RydWN0IGtxaWQgKiwKICAgICAgICBzdHJ1Y3QgcWNfZHFibGsgKik7
CiBpbnQgKCpzZXRfZHFibGspKHN0cnVjdCBzdXBlcl9ibG9jayAqLCBzdHJ1Y3Qga3FpZCwg
c3RydWN0IHFjX2RxYmxrICopOwogaW50ICgqZ2V0X3N0YXRlKShzdHJ1Y3Qgc3VwZXJfYmxv
Y2sgKiwgc3RydWN0IHFjX3N0YXRlICopOwogaW50ICgqcm1feHF1b3RhKShzdHJ1Y3Qgc3Vw
ZXJfYmxvY2sgKiwgdW5zaWduZWQgaW50KTsKfTsKCnN0cnVjdCBxdW90YV9mb3JtYXRfdHlw
ZSB7CiBpbnQgcWZfZm10X2lkOwogY29uc3Qgc3RydWN0IHF1b3RhX2Zvcm1hdF9vcHMgKnFm
X29wczsKIHN0cnVjdCBtb2R1bGUgKnFmX293bmVyOwogc3RydWN0IHF1b3RhX2Zvcm1hdF90
eXBlICpxZl9uZXh0Owp9OwojIDQ2MyAiLi9pbmNsdWRlL2xpbnV4L3F1b3RhLmgiCmVudW0g
ewogX0RRVU9UX1VTQUdFX0VOQUJMRUQgPSAwLAogX0RRVU9UX0xJTUlUU19FTkFCTEVELAog
X0RRVU9UX1NVU1BFTkRFRCwKCgogX0RRVU9UX1NUQVRFX0ZMQUdTCn07CiMgNDkwICIuL2lu
Y2x1ZGUvbGludXgvcXVvdGEuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHVuc2lnbmVkIGludCBkcXVvdF9zdGF0
ZV9mbGFnKHVuc2lnbmVkIGludCBmbGFncywgaW50IHR5cGUpCnsKIHJldHVybiBmbGFncyA8
PCB0eXBlOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgaW50IGRxdW90X2dlbmVyaWNfZmxhZyh1
bnNpZ25lZCBpbnQgZmxhZ3MsIGludCB0eXBlKQp7CiByZXR1cm4gKGZsYWdzID4+IHR5cGUp
ICYgKCgxIDw8IF9EUVVPVF9VU0FHRV9FTkFCTEVEICogMykgfCAoMSA8PCBfRFFVT1RfTElN
SVRTX0VOQUJMRUQgKiAzKSB8ICgxIDw8IF9EUVVPVF9TVVNQRU5ERUQgKiAzKSk7Cn0KCgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB1bnNpZ25lZCBk
cXVvdF9zdGF0ZV90eXBlcyh1bnNpZ25lZCBmbGFncywgdW5zaWduZWQgZmxhZykKewogZG8g
eyBleHRlcm4gdm9pZCBfX2NvbXBpbGV0aW1lX2Fzc2VydF8xNzAodm9pZCkgX19hdHRyaWJ1
dGVfXygoX19lcnJvcl9fKCJCVUlMRF9CVUdfT04gZmFpbGVkOiAiICIoZmxhZykgPT0gMCB8
fCAoKChmbGFnKSAmICgoZmxhZykgLSAxKSkgIT0gMCkiKSkpOyBpZiAoISghKChmbGFnKSA9
PSAwIHx8ICgoKGZsYWcpICYgKChmbGFnKSAtIDEpKSAhPSAwKSkpKSBfX2NvbXBpbGV0aW1l
X2Fzc2VydF8xNzAoKTsgfSB3aGlsZSAoMCk7CiByZXR1cm4gKGZsYWdzIC8gZmxhZykgJiAo
KDEgPDwgMykgLSAxKTsKfQoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHF1b3RhX3NlbmRfd2Fybmlu
ZyhzdHJ1Y3Qga3FpZCBxaWQsIGRldl90IGRldiwKICAgICAgICAgIGNvbnN0IGNoYXIgd2Fy
bnR5cGUpCnsKIHJldHVybjsKfQoKCnN0cnVjdCBxdW90YV9pbmZvIHsKIHVuc2lnbmVkIGlu
dCBmbGFnczsKIHN0cnVjdCByd19zZW1hcGhvcmUgZHFpb19zZW07CiBzdHJ1Y3QgaW5vZGUg
KmZpbGVzWzNdOwogc3RydWN0IG1lbV9kcWluZm8gaW5mb1szXTsKIGNvbnN0IHN0cnVjdCBx
dW90YV9mb3JtYXRfb3BzICpvcHNbM107Cn07CgppbnQgcmVnaXN0ZXJfcXVvdGFfZm9ybWF0
KHN0cnVjdCBxdW90YV9mb3JtYXRfdHlwZSAqZm10KTsKdm9pZCB1bnJlZ2lzdGVyX3F1b3Rh
X2Zvcm1hdChzdHJ1Y3QgcXVvdGFfZm9ybWF0X3R5cGUgKmZtdCk7CgpzdHJ1Y3QgcXVvdGFf
bW9kdWxlX25hbWUgewogaW50IHFtX2ZtdF9pZDsKIGNoYXIgKnFtX21vZF9uYW1lOwp9Owoj
IDI0NiAiLi9pbmNsdWRlL2xpbnV4L2ZzLmgiIDIKIyAyNzkgIi4vaW5jbHVkZS9saW51eC9m
cy5oIgplbnVtIHBvc2l0aXZlX2FvcF9yZXR1cm5zIHsKIEFPUF9XUklURVBBR0VfQUNUSVZB
VEUgPSAweDgwMDAwLAogQU9QX1RSVU5DQVRFRF9QQUdFID0gMHg4MDAwMSwKfTsKIyAyOTIg
Ii4vaW5jbHVkZS9saW51eC9mcy5oIgpzdHJ1Y3QgcGFnZTsKc3RydWN0IGFkZHJlc3Nfc3Bh
Y2U7CnN0cnVjdCB3cml0ZWJhY2tfY29udHJvbDsKc3RydWN0IHJlYWRhaGVhZF9jb250cm9s
OwoKCgoKCmVudW0gcndfaGludCB7CiBXUklURV9MSUZFX05PVF9TRVQgPSAwLAogV1JJVEVf
TElGRV9OT05FID0gMSwKIFdSSVRFX0xJRkVfU0hPUlQgPSAyLAogV1JJVEVfTElGRV9NRURJ
VU0gPSAzLAogV1JJVEVfTElGRV9MT05HID0gNCwKIFdSSVRFX0xJRkVfRVhUUkVNRSA9IDUs
Cn07CiMgMzE5ICIuL2luY2x1ZGUvbGludXgvZnMuaCIKc3RydWN0IGtpb2NiIHsKIHN0cnVj
dCBmaWxlICpraV9maWxwOwoKCgoKIGxvZmZfdCBraV9wb3M7CiB2b2lkICgqa2lfY29tcGxl
dGUpKHN0cnVjdCBraW9jYiAqaW9jYiwgbG9uZyByZXQsIGxvbmcgcmV0Mik7CiB2b2lkICpw
cml2YXRlOwogaW50IGtpX2ZsYWdzOwogdTE2IGtpX2hpbnQ7CiB1MTYga2lfaW9wcmlvOwog
dW5zaWduZWQgaW50IGtpX2Nvb2tpZTsKCgp9OwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgaXNfc3luY19r
aW9jYihzdHJ1Y3Qga2lvY2IgKmtpb2NiKQp7CiByZXR1cm4ga2lvY2ItPmtpX2NvbXBsZXRl
ID09ICgodm9pZCAqKTApOwp9CiMgMzUwICIuL2luY2x1ZGUvbGludXgvZnMuaCIKdHlwZWRl
ZiBzdHJ1Y3Qgewogc2l6ZV90IHdyaXR0ZW47CiBzaXplX3QgY291bnQ7CiB1bmlvbiB7CiAg
Y2hhciAqYnVmOwogIHZvaWQgKmRhdGE7CiB9IGFyZzsKIGludCBlcnJvcjsKfSByZWFkX2Rl
c2NyaXB0b3JfdDsKCnR5cGVkZWYgaW50ICgqcmVhZF9hY3Rvcl90KShyZWFkX2Rlc2NyaXB0
b3JfdCAqLCBzdHJ1Y3QgcGFnZSAqLAogIHVuc2lnbmVkIGxvbmcsIHVuc2lnbmVkIGxvbmcp
OwoKc3RydWN0IGFkZHJlc3Nfc3BhY2Vfb3BlcmF0aW9ucyB7CiBpbnQgKCp3cml0ZXBhZ2Up
KHN0cnVjdCBwYWdlICpwYWdlLCBzdHJ1Y3Qgd3JpdGViYWNrX2NvbnRyb2wgKndiYyk7CiBp
bnQgKCpyZWFkcGFnZSkoc3RydWN0IGZpbGUgKiwgc3RydWN0IHBhZ2UgKik7CgoKIGludCAo
KndyaXRlcGFnZXMpKHN0cnVjdCBhZGRyZXNzX3NwYWNlICosIHN0cnVjdCB3cml0ZWJhY2tf
Y29udHJvbCAqKTsKCgogaW50ICgqc2V0X3BhZ2VfZGlydHkpKHN0cnVjdCBwYWdlICpwYWdl
KTsKCgoKCgogaW50ICgqcmVhZHBhZ2VzKShzdHJ1Y3QgZmlsZSAqZmlscCwgc3RydWN0IGFk
ZHJlc3Nfc3BhY2UgKm1hcHBpbmcsCiAgIHN0cnVjdCBsaXN0X2hlYWQgKnBhZ2VzLCB1bnNp
Z25lZCBucl9wYWdlcyk7CiB2b2lkICgqcmVhZGFoZWFkKShzdHJ1Y3QgcmVhZGFoZWFkX2Nv
bnRyb2wgKik7CgogaW50ICgqd3JpdGVfYmVnaW4pKHN0cnVjdCBmaWxlICosIHN0cnVjdCBh
ZGRyZXNzX3NwYWNlICptYXBwaW5nLAogICAgbG9mZl90IHBvcywgdW5zaWduZWQgbGVuLCB1
bnNpZ25lZCBmbGFncywKICAgIHN0cnVjdCBwYWdlICoqcGFnZXAsIHZvaWQgKipmc2RhdGEp
OwogaW50ICgqd3JpdGVfZW5kKShzdHJ1Y3QgZmlsZSAqLCBzdHJ1Y3QgYWRkcmVzc19zcGFj
ZSAqbWFwcGluZywKICAgIGxvZmZfdCBwb3MsIHVuc2lnbmVkIGxlbiwgdW5zaWduZWQgY29w
aWVkLAogICAgc3RydWN0IHBhZ2UgKnBhZ2UsIHZvaWQgKmZzZGF0YSk7CgoKIHNlY3Rvcl90
ICgqYm1hcCkoc3RydWN0IGFkZHJlc3Nfc3BhY2UgKiwgc2VjdG9yX3QpOwogdm9pZCAoKmlu
dmFsaWRhdGVwYWdlKSAoc3RydWN0IHBhZ2UgKiwgdW5zaWduZWQgaW50LCB1bnNpZ25lZCBp
bnQpOwogaW50ICgqcmVsZWFzZXBhZ2UpIChzdHJ1Y3QgcGFnZSAqLCBnZnBfdCk7CiB2b2lk
ICgqZnJlZXBhZ2UpKHN0cnVjdCBwYWdlICopOwogc3NpemVfdCAoKmRpcmVjdF9JTykoc3Ry
dWN0IGtpb2NiICosIHN0cnVjdCBpb3ZfaXRlciAqaXRlcik7CgoKCgogaW50ICgqbWlncmF0
ZXBhZ2UpIChzdHJ1Y3QgYWRkcmVzc19zcGFjZSAqLAogICBzdHJ1Y3QgcGFnZSAqLCBzdHJ1
Y3QgcGFnZSAqLCBlbnVtIG1pZ3JhdGVfbW9kZSk7CiBib29sICgqaXNvbGF0ZV9wYWdlKShz
dHJ1Y3QgcGFnZSAqLCBpc29sYXRlX21vZGVfdCk7CiB2b2lkICgqcHV0YmFja19wYWdlKShz
dHJ1Y3QgcGFnZSAqKTsKIGludCAoKmxhdW5kZXJfcGFnZSkgKHN0cnVjdCBwYWdlICopOwog
aW50ICgqaXNfcGFydGlhbGx5X3VwdG9kYXRlKSAoc3RydWN0IHBhZ2UgKiwgdW5zaWduZWQg
bG9uZywKICAgICB1bnNpZ25lZCBsb25nKTsKIHZvaWQgKCppc19kaXJ0eV93cml0ZWJhY2sp
IChzdHJ1Y3QgcGFnZSAqLCBib29sICosIGJvb2wgKik7CiBpbnQgKCplcnJvcl9yZW1vdmVf
cGFnZSkoc3RydWN0IGFkZHJlc3Nfc3BhY2UgKiwgc3RydWN0IHBhZ2UgKik7CgoKIGludCAo
KnN3YXBfYWN0aXZhdGUpKHN0cnVjdCBzd2FwX2luZm9fc3RydWN0ICpzaXMsIHN0cnVjdCBm
aWxlICpmaWxlLAogICAgc2VjdG9yX3QgKnNwYW4pOwogdm9pZCAoKnN3YXBfZGVhY3RpdmF0
ZSkoc3RydWN0IGZpbGUgKmZpbGUpOwp9OwoKZXh0ZXJuIGNvbnN0IHN0cnVjdCBhZGRyZXNz
X3NwYWNlX29wZXJhdGlvbnMgZW1wdHlfYW9wczsKCgoKCgppbnQgcGFnZWNhY2hlX3dyaXRl
X2JlZ2luKHN0cnVjdCBmaWxlICosIHN0cnVjdCBhZGRyZXNzX3NwYWNlICptYXBwaW5nLAog
ICAgbG9mZl90IHBvcywgdW5zaWduZWQgbGVuLCB1bnNpZ25lZCBmbGFncywKICAgIHN0cnVj
dCBwYWdlICoqcGFnZXAsIHZvaWQgKipmc2RhdGEpOwoKaW50IHBhZ2VjYWNoZV93cml0ZV9l
bmQoc3RydWN0IGZpbGUgKiwgc3RydWN0IGFkZHJlc3Nfc3BhY2UgKm1hcHBpbmcsCiAgICBs
b2ZmX3QgcG9zLCB1bnNpZ25lZCBsZW4sIHVuc2lnbmVkIGNvcGllZCwKICAgIHN0cnVjdCBw
YWdlICpwYWdlLCB2b2lkICpmc2RhdGEpOwojIDQ0NyAiLi9pbmNsdWRlL2xpbnV4L2ZzLmgi
CnN0cnVjdCBhZGRyZXNzX3NwYWNlIHsKIHN0cnVjdCBpbm9kZSAqaG9zdDsKIHN0cnVjdCB4
YXJyYXkgaV9wYWdlczsKIGdmcF90IGdmcF9tYXNrOwogYXRvbWljX3QgaV9tbWFwX3dyaXRh
YmxlOwoKCgoKIHN0cnVjdCByYl9yb290X2NhY2hlZCBpX21tYXA7CiBzdHJ1Y3Qgcndfc2Vt
YXBob3JlIGlfbW1hcF9yd3NlbTsKIHVuc2lnbmVkIGxvbmcgbnJwYWdlczsKIHVuc2lnbmVk
IGxvbmcgbnJleGNlcHRpb25hbDsKIHVuc2lnbmVkIGxvbmcgd3JpdGViYWNrX2luZGV4Owog
Y29uc3Qgc3RydWN0IGFkZHJlc3Nfc3BhY2Vfb3BlcmF0aW9ucyAqYV9vcHM7CiB1bnNpZ25l
ZCBsb25nIGZsYWdzOwogZXJyc2VxX3Qgd2JfZXJyOwogc3BpbmxvY2tfdCBwcml2YXRlX2xv
Y2s7CiBzdHJ1Y3QgbGlzdF9oZWFkIHByaXZhdGVfbGlzdDsKIHZvaWQgKnByaXZhdGVfZGF0
YTsKfSBfX2F0dHJpYnV0ZV9fKChhbGlnbmVkKHNpemVvZihsb25nKSkpKSA7CgoKCgoKc3Ry
dWN0IHJlcXVlc3RfcXVldWU7CgpzdHJ1Y3QgYmxvY2tfZGV2aWNlIHsKIGRldl90IGJkX2Rl
djsKIGludCBiZF9vcGVuZXJzOwogc3RydWN0IGlub2RlICogYmRfaW5vZGU7CiBzdHJ1Y3Qg
c3VwZXJfYmxvY2sgKiBiZF9zdXBlcjsKIHN0cnVjdCBtdXRleCBiZF9tdXRleDsKIHZvaWQg
KiBiZF9jbGFpbWluZzsKIHZvaWQgKiBiZF9ob2xkZXI7CiBpbnQgYmRfaG9sZGVyczsKIGJv
b2wgYmRfd3JpdGVfaG9sZGVyOwoKIHN0cnVjdCBsaXN0X2hlYWQgYmRfaG9sZGVyX2Rpc2tz
OwoKIHN0cnVjdCBibG9ja19kZXZpY2UgKiBiZF9jb250YWluczsKIHVuc2lnbmVkIGJkX2Js
b2NrX3NpemU7CiB1OCBiZF9wYXJ0bm87CiBzdHJ1Y3QgaGRfc3RydWN0ICogYmRfcGFydDsK
CiB1bnNpZ25lZCBiZF9wYXJ0X2NvdW50OwogaW50IGJkX2ludmFsaWRhdGVkOwogc3RydWN0
IGdlbmRpc2sgKiBiZF9kaXNrOwogc3RydWN0IHJlcXVlc3RfcXVldWUgKiBiZF9xdWV1ZTsK
IHN0cnVjdCBiYWNraW5nX2Rldl9pbmZvICpiZF9iZGk7CiBzdHJ1Y3QgbGlzdF9oZWFkIGJk
X2xpc3Q7CgoKCgoKCiB1bnNpZ25lZCBsb25nIGJkX3ByaXZhdGU7CgoKIGludCBiZF9mc2Zy
ZWV6ZV9jb3VudDsKCiBzdHJ1Y3QgbXV0ZXggYmRfZnNmcmVlemVfbXV0ZXg7Cn0gOwojIDUy
MSAiLi9pbmNsdWRlL2xpbnV4L2ZzLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIG1hcHBpbmdfdGFnZ2Vk
KHN0cnVjdCBhZGRyZXNzX3NwYWNlICptYXBwaW5nLCB4YV9tYXJrX3QgdGFnKQp7CiByZXR1
cm4geGFfbWFya2VkKCZtYXBwaW5nLT5pX3BhZ2VzLCB0YWcpOwp9CgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9p
ZCBpX21tYXBfbG9ja193cml0ZShzdHJ1Y3QgYWRkcmVzc19zcGFjZSAqbWFwcGluZykKewog
ZG93bl93cml0ZSgmbWFwcGluZy0+aV9tbWFwX3J3c2VtKTsKfQoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBp
X21tYXBfdHJ5bG9ja193cml0ZShzdHJ1Y3QgYWRkcmVzc19zcGFjZSAqbWFwcGluZykKewog
cmV0dXJuIGRvd25fd3JpdGVfdHJ5bG9jaygmbWFwcGluZy0+aV9tbWFwX3J3c2VtKTsKfQoK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIHZvaWQgaV9tbWFwX3VubG9ja193cml0ZShzdHJ1Y3QgYWRkcmVzc19zcGFj
ZSAqbWFwcGluZykKewogdXBfd3JpdGUoJm1hcHBpbmctPmlfbW1hcF9yd3NlbSk7Cn0KCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSB2b2lkIGlfbW1hcF9sb2NrX3JlYWQoc3RydWN0IGFkZHJlc3Nfc3BhY2UgKm1h
cHBpbmcpCnsKIGRvd25fcmVhZCgmbWFwcGluZy0+aV9tbWFwX3J3c2VtKTsKfQoKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIHZvaWQgaV9tbWFwX3VubG9ja19yZWFkKHN0cnVjdCBhZGRyZXNzX3NwYWNlICptYXBw
aW5nKQp7CiB1cF9yZWFkKCZtYXBwaW5nLT5pX21tYXBfcndzZW0pOwp9CgoKCgpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgaW50IG1hcHBpbmdfbWFwcGVkKHN0cnVjdCBhZGRyZXNzX3NwYWNlICptYXBwaW5nKQp7
CiByZXR1cm4gISgoeyBkbyB7IGV4dGVybiB2b2lkIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzE3
MSh2b2lkKSBfX2F0dHJpYnV0ZV9fKChfX2Vycm9yX18oIlVuc3VwcG9ydGVkIGFjY2VzcyBz
aXplIGZvciB7UkVBRCxXUklURX1fT05DRSgpLiIpKSk7IGlmICghKChzaXplb2YoKCZtYXBw
aW5nLT5pX21tYXAucmJfcm9vdCktPnJiX25vZGUpID09IHNpemVvZihjaGFyKSB8fCBzaXpl
b2YoKCZtYXBwaW5nLT5pX21tYXAucmJfcm9vdCktPnJiX25vZGUpID09IHNpemVvZihzaG9y
dCkgfHwgc2l6ZW9mKCgmbWFwcGluZy0+aV9tbWFwLnJiX3Jvb3QpLT5yYl9ub2RlKSA9PSBz
aXplb2YoaW50KSB8fCBzaXplb2YoKCZtYXBwaW5nLT5pX21tYXAucmJfcm9vdCktPnJiX25v
ZGUpID09IHNpemVvZihsb25nKSkgfHwgc2l6ZW9mKCgmbWFwcGluZy0+aV9tbWFwLnJiX3Jv
b3QpLT5yYl9ub2RlKSA9PSBzaXplb2YobG9uZyBsb25nKSkpIF9fY29tcGlsZXRpbWVfYXNz
ZXJ0XzE3MSgpOyB9IHdoaWxlICgwKTsgKHsgdHlwZW9mKCBfR2VuZXJpYygoKCZtYXBwaW5n
LT5pX21tYXAucmJfcm9vdCktPnJiX25vZGUpLCBjaGFyOiAoY2hhcikwLCB1bnNpZ25lZCBj
aGFyOiAodW5zaWduZWQgY2hhcikwLCBzaWduZWQgY2hhcjogKHNpZ25lZCBjaGFyKTAsIHVu
c2lnbmVkIHNob3J0OiAodW5zaWduZWQgc2hvcnQpMCwgc2lnbmVkIHNob3J0OiAoc2lnbmVk
IHNob3J0KTAsIHVuc2lnbmVkIGludDogKHVuc2lnbmVkIGludCkwLCBzaWduZWQgaW50OiAo
c2lnbmVkIGludCkwLCB1bnNpZ25lZCBsb25nOiAodW5zaWduZWQgbG9uZykwLCBzaWduZWQg
bG9uZzogKHNpZ25lZCBsb25nKTAsIHVuc2lnbmVkIGxvbmcgbG9uZzogKHVuc2lnbmVkIGxv
bmcgbG9uZykwLCBzaWduZWQgbG9uZyBsb25nOiAoc2lnbmVkIGxvbmcgbG9uZykwLCBkZWZh
dWx0OiAoKCZtYXBwaW5nLT5pX21tYXAucmJfcm9vdCktPnJiX25vZGUpKSkgX194ID0gKCoo
Y29uc3Qgdm9sYXRpbGUgdHlwZW9mKCBfR2VuZXJpYygoKCZtYXBwaW5nLT5pX21tYXAucmJf
cm9vdCktPnJiX25vZGUpLCBjaGFyOiAoY2hhcikwLCB1bnNpZ25lZCBjaGFyOiAodW5zaWdu
ZWQgY2hhcikwLCBzaWduZWQgY2hhcjogKHNpZ25lZCBjaGFyKTAsIHVuc2lnbmVkIHNob3J0
OiAodW5zaWduZWQgc2hvcnQpMCwgc2lnbmVkIHNob3J0OiAoc2lnbmVkIHNob3J0KTAsIHVu
c2lnbmVkIGludDogKHVuc2lnbmVkIGludCkwLCBzaWduZWQgaW50OiAoc2lnbmVkIGludCkw
LCB1bnNpZ25lZCBsb25nOiAodW5zaWduZWQgbG9uZykwLCBzaWduZWQgbG9uZzogKHNpZ25l
ZCBsb25nKTAsIHVuc2lnbmVkIGxvbmcgbG9uZzogKHVuc2lnbmVkIGxvbmcgbG9uZykwLCBz
aWduZWQgbG9uZyBsb25nOiAoc2lnbmVkIGxvbmcgbG9uZykwLCBkZWZhdWx0OiAoKCZtYXBw
aW5nLT5pX21tYXAucmJfcm9vdCktPnJiX25vZGUpKSkgKikmKCgmbWFwcGluZy0+aV9tbWFw
LnJiX3Jvb3QpLT5yYl9ub2RlKSk7IGRvIHsgfSB3aGlsZSAoMCk7ICh0eXBlb2YoKCZtYXBw
aW5nLT5pX21tYXAucmJfcm9vdCktPnJiX25vZGUpKV9feDsgfSk7IH0pID09ICgodm9pZCAq
KTApKTsKfQojIDU2OCAiLi9pbmNsdWRlL2xpbnV4L2ZzLmgiCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgbWFw
cGluZ193cml0YWJseV9tYXBwZWQoc3RydWN0IGFkZHJlc3Nfc3BhY2UgKm1hcHBpbmcpCnsK
IHJldHVybiBhdG9taWNfcmVhZCgmbWFwcGluZy0+aV9tbWFwX3dyaXRhYmxlKSA+IDA7Cn0K
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSBpbnQgbWFwcGluZ19tYXBfd3JpdGFibGUoc3RydWN0IGFkZHJlc3Nfc3Bh
Y2UgKm1hcHBpbmcpCnsKIHJldHVybiBhdG9taWNfaW5jX3VubGVzc19uZWdhdGl2ZSgmbWFw
cGluZy0+aV9tbWFwX3dyaXRhYmxlKSA/CiAgMCA6IC0xOwp9CgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBt
YXBwaW5nX3VubWFwX3dyaXRhYmxlKHN0cnVjdCBhZGRyZXNzX3NwYWNlICptYXBwaW5nKQp7
CiBhdG9taWNfZGVjKCZtYXBwaW5nLT5pX21tYXBfd3JpdGFibGUpOwp9CgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
aW50IG1hcHBpbmdfZGVueV93cml0YWJsZShzdHJ1Y3QgYWRkcmVzc19zcGFjZSAqbWFwcGlu
ZykKewogcmV0dXJuIGF0b21pY19kZWNfdW5sZXNzX3Bvc2l0aXZlKCZtYXBwaW5nLT5pX21t
YXBfd3JpdGFibGUpID8KICAwIDogLTE2Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBtYXBwaW5nX2Fs
bG93X3dyaXRhYmxlKHN0cnVjdCBhZGRyZXNzX3NwYWNlICptYXBwaW5nKQp7CiBhdG9taWNf
aW5jKCZtYXBwaW5nLT5pX21tYXBfd3JpdGFibGUpOwp9CiMgNjA2ICIuL2luY2x1ZGUvbGlu
dXgvZnMuaCIKc3RydWN0IHBvc2l4X2FjbDsKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHN0cnVjdCBwb3NpeF9h
Y2wgKgp1bmNhY2hlZF9hY2xfc2VudGluZWwoc3RydWN0IHRhc2tfc3RydWN0ICp0YXNrKQp7
CiByZXR1cm4gKHZvaWQgKil0YXNrICsgMTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpCgojIDYxNiAiLi9pbmNs
dWRlL2xpbnV4L2ZzLmgiCiAgICAgICAgICAgICAgYm9vbAppc191bmNhY2hlZF9hY2woc3Ry
dWN0IHBvc2l4X2FjbCAqYWNsKQp7CiByZXR1cm4gKGxvbmcpYWNsICYgMTsKfQoKCgoKCgoK
c3RydWN0IGZzbm90aWZ5X21hcmtfY29ubmVjdG9yOwoKCgoKCgpzdHJ1Y3QgaW5vZGUgewog
dW1vZGVfdCBpX21vZGU7CiB1bnNpZ25lZCBzaG9ydCBpX29wZmxhZ3M7CiBrdWlkX3QgaV91
aWQ7CiBrZ2lkX3QgaV9naWQ7CiB1bnNpZ25lZCBpbnQgaV9mbGFnczsKCgoKCgoKIGNvbnN0
IHN0cnVjdCBpbm9kZV9vcGVyYXRpb25zICppX29wOwogc3RydWN0IHN1cGVyX2Jsb2NrICpp
X3NiOwogc3RydWN0IGFkZHJlc3Nfc3BhY2UgKmlfbWFwcGluZzsKCgoKCgoKIHVuc2lnbmVk
IGxvbmcgaV9pbm87CgoKCgoKCgogdW5pb24gewogIGNvbnN0IHVuc2lnbmVkIGludCBpX25s
aW5rOwogIHVuc2lnbmVkIGludCBfX2lfbmxpbms7CiB9OwogZGV2X3QgaV9yZGV2OwogbG9m
Zl90IGlfc2l6ZTsKIHN0cnVjdCB0aW1lc3BlYzY0IGlfYXRpbWU7CiBzdHJ1Y3QgdGltZXNw
ZWM2NCBpX210aW1lOwogc3RydWN0IHRpbWVzcGVjNjQgaV9jdGltZTsKIHNwaW5sb2NrX3Qg
aV9sb2NrOwogdW5zaWduZWQgc2hvcnQgaV9ieXRlczsKIHU4IGlfYmxrYml0czsKIHU4IGlf
d3JpdGVfaGludDsKIGJsa2NudF90IGlfYmxvY2tzOwoKCgoKCgogdW5zaWduZWQgbG9uZyBp
X3N0YXRlOwogc3RydWN0IHJ3X3NlbWFwaG9yZSBpX3J3c2VtOwoKIHVuc2lnbmVkIGxvbmcg
ZGlydGllZF93aGVuOwogdW5zaWduZWQgbG9uZyBkaXJ0aWVkX3RpbWVfd2hlbjsKCiBzdHJ1
Y3QgaGxpc3Rfbm9kZSBpX2hhc2g7CiBzdHJ1Y3QgbGlzdF9oZWFkIGlfaW9fbGlzdDsKIyA3
MDAgIi4vaW5jbHVkZS9saW51eC9mcy5oIgogc3RydWN0IGxpc3RfaGVhZCBpX2xydTsKIHN0
cnVjdCBsaXN0X2hlYWQgaV9zYl9saXN0Owogc3RydWN0IGxpc3RfaGVhZCBpX3diX2xpc3Q7
CiB1bmlvbiB7CiAgc3RydWN0IGhsaXN0X2hlYWQgaV9kZW50cnk7CiAgc3RydWN0IGNhbGxi
YWNrX2hlYWQgaV9yY3U7CiB9OwogYXRvbWljNjRfdCBpX3ZlcnNpb247CiBhdG9taWM2NF90
IGlfc2VxdWVuY2U7CiBhdG9taWNfdCBpX2NvdW50OwogYXRvbWljX3QgaV9kaW9fY291bnQ7
CiBhdG9taWNfdCBpX3dyaXRlY291bnQ7CgogYXRvbWljX3QgaV9yZWFkY291bnQ7CgogdW5p
b24gewogIGNvbnN0IHN0cnVjdCBmaWxlX29wZXJhdGlvbnMgKmlfZm9wOwogIHZvaWQgKCpm
cmVlX2lub2RlKShzdHJ1Y3QgaW5vZGUgKik7CiB9Owogc3RydWN0IGZpbGVfbG9ja19jb250
ZXh0ICppX2ZsY3R4Owogc3RydWN0IGFkZHJlc3Nfc3BhY2UgaV9kYXRhOwogc3RydWN0IGxp
c3RfaGVhZCBpX2RldmljZXM7CiB1bmlvbiB7CiAgc3RydWN0IHBpcGVfaW5vZGVfaW5mbyAq
aV9waXBlOwogIHN0cnVjdCBibG9ja19kZXZpY2UgKmlfYmRldjsKICBzdHJ1Y3QgY2RldiAq
aV9jZGV2OwogIGNoYXIgKmlfbGluazsKICB1bnNpZ25lZCBpX2Rpcl9zZXE7CiB9OwoKIF9f
dTMyIGlfZ2VuZXJhdGlvbjsKCgogX191MzIgaV9mc25vdGlmeV9tYXNrOwogc3RydWN0IGZz
bm90aWZ5X21hcmtfY29ubmVjdG9yICppX2Zzbm90aWZ5X21hcmtzOwojIDc0NSAiLi9pbmNs
dWRlL2xpbnV4L2ZzLmgiCiB2b2lkICppX3ByaXZhdGU7Cn0gOwoKc3RydWN0IHRpbWVzcGVj
NjQgdGltZXN0YW1wX3RydW5jYXRlKHN0cnVjdCB0aW1lc3BlYzY0IHQsIHN0cnVjdCBpbm9k
ZSAqaW5vZGUpOwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIHVuc2lnbmVkIGludCBpX2Jsb2Nrc2l6ZShjb25zdCBz
dHJ1Y3QgaW5vZGUgKm5vZGUpCnsKIHJldHVybiAoMSA8PCBub2RlLT5pX2Jsa2JpdHMpOwp9
CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgaW50IGlub2RlX3VuaGFzaGVkKHN0cnVjdCBpbm9kZSAqaW5vZGUpCnsK
IHJldHVybiBobGlzdF91bmhhc2hlZCgmaW5vZGUtPmlfaGFzaCk7Cn0KCgoKCgoKCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSB2b2lkIGlub2RlX2Zha2VfaGFzaChzdHJ1Y3QgaW5vZGUgKmlub2RlKQp7CiBobGlz
dF9hZGRfZmFrZSgmaW5vZGUtPmlfaGFzaCk7Cn0KIyA3ODcgIi4vaW5jbHVkZS9saW51eC9m
cy5oIgplbnVtIGlub2RlX2lfbXV0ZXhfbG9ja19jbGFzcwp7CiBJX01VVEVYX05PUk1BTCwK
IElfTVVURVhfUEFSRU5ULAogSV9NVVRFWF9DSElMRCwKIElfTVVURVhfWEFUVFIsCiBJX01V
VEVYX05PTkRJUjIsCiBJX01VVEVYX1BBUkVOVDIsCn07CgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBpbm9k
ZV9sb2NrKHN0cnVjdCBpbm9kZSAqaW5vZGUpCnsKIGRvd25fd3JpdGUoJmlub2RlLT5pX3J3
c2VtKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgaW5vZGVfdW5sb2NrKHN0cnVjdCBpbm9kZSAqaW5v
ZGUpCnsKIHVwX3dyaXRlKCZpbm9kZS0+aV9yd3NlbSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGlu
b2RlX2xvY2tfc2hhcmVkKHN0cnVjdCBpbm9kZSAqaW5vZGUpCnsKIGRvd25fcmVhZCgmaW5v
ZGUtPmlfcndzZW0pOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBpbm9kZV91bmxvY2tfc2hhcmVkKHN0
cnVjdCBpbm9kZSAqaW5vZGUpCnsKIHVwX3JlYWQoJmlub2RlLT5pX3J3c2VtKTsKfQoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIGludCBpbm9kZV90cnlsb2NrKHN0cnVjdCBpbm9kZSAqaW5vZGUpCnsKIHJldHVy
biBkb3duX3dyaXRlX3RyeWxvY2soJmlub2RlLT5pX3J3c2VtKTsKfQoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGlu
dCBpbm9kZV90cnlsb2NrX3NoYXJlZChzdHJ1Y3QgaW5vZGUgKmlub2RlKQp7CiByZXR1cm4g
ZG93bl9yZWFkX3RyeWxvY2soJmlub2RlLT5pX3J3c2VtKTsKfQoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBp
bm9kZV9pc19sb2NrZWQoc3RydWN0IGlub2RlICppbm9kZSkKewogcmV0dXJuIHJ3c2VtX2lz
X2xvY2tlZCgmaW5vZGUtPmlfcndzZW0pOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBpbm9kZV9sb2Nr
X25lc3RlZChzdHJ1Y3QgaW5vZGUgKmlub2RlLCB1bnNpZ25lZCBzdWJjbGFzcykKewogZG93
bl93cml0ZSgmaW5vZGUtPmlfcndzZW0pOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBpbm9kZV9sb2Nr
X3NoYXJlZF9uZXN0ZWQoc3RydWN0IGlub2RlICppbm9kZSwgdW5zaWduZWQgc3ViY2xhc3Mp
CnsKIGRvd25fcmVhZCgmaW5vZGUtPmlfcndzZW0pOwp9Cgp2b2lkIGxvY2tfdHdvX25vbmRp
cmVjdG9yaWVzKHN0cnVjdCBpbm9kZSAqLCBzdHJ1Y3QgaW5vZGUqKTsKdm9pZCB1bmxvY2tf
dHdvX25vbmRpcmVjdG9yaWVzKHN0cnVjdCBpbm9kZSAqLCBzdHJ1Y3QgaW5vZGUqKTsKIyA4
NTUgIi4vaW5jbHVkZS9saW51eC9mcy5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgbG9mZl90IGlfc2l6ZV9yZWFk
KGNvbnN0IHN0cnVjdCBpbm9kZSAqaW5vZGUpCnsKIyA4NzQgIi4vaW5jbHVkZS9saW51eC9m
cy5oIgogcmV0dXJuIGlub2RlLT5pX3NpemU7Cgp9CgoKCgoKCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGlf
c2l6ZV93cml0ZShzdHJ1Y3QgaW5vZGUgKmlub2RlLCBsb2ZmX3QgaV9zaXplKQp7CiMgODk2
ICIuL2luY2x1ZGUvbGludXgvZnMuaCIKIGlub2RlLT5pX3NpemUgPSBpX3NpemU7Cgp9Cgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgdW5zaWduZWQgaW1pbm9yKGNvbnN0IHN0cnVjdCBpbm9kZSAqaW5vZGUpCnsK
IHJldHVybiAoKHVuc2lnbmVkIGludCkgKChpbm9kZS0+aV9yZGV2KSAmICgoMVUgPDwgMjAp
IC0gMSkpKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIHVuc2lnbmVkIGltYWpvcihjb25zdCBzdHJ1Y3QgaW5v
ZGUgKmlub2RlKQp7CiByZXR1cm4gKCh1bnNpZ25lZCBpbnQpICgoaW5vZGUtPmlfcmRldikg
Pj4gMjApKTsKfQoKZXh0ZXJuIHN0cnVjdCBibG9ja19kZXZpY2UgKklfQkRFVihzdHJ1Y3Qg
aW5vZGUgKmlub2RlKTsKCnN0cnVjdCBmb3duX3N0cnVjdCB7CiByd2xvY2tfdCBsb2NrOwog
c3RydWN0IHBpZCAqcGlkOwogZW51bSBwaWRfdHlwZSBwaWRfdHlwZTsKIGt1aWRfdCB1aWQs
IGV1aWQ7CiBpbnQgc2lnbnVtOwp9OwoKCgoKc3RydWN0IGZpbGVfcmFfc3RhdGUgewogdW5z
aWduZWQgbG9uZyBzdGFydDsKIHVuc2lnbmVkIGludCBzaXplOwogdW5zaWduZWQgaW50IGFz
eW5jX3NpemU7CgoKIHVuc2lnbmVkIGludCByYV9wYWdlczsKIHVuc2lnbmVkIGludCBtbWFw
X21pc3M7CiBsb2ZmX3QgcHJldl9wb3M7Cn07CgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHJhX2hhc19p
bmRleChzdHJ1Y3QgZmlsZV9yYV9zdGF0ZSAqcmEsIHVuc2lnbmVkIGxvbmcgaW5kZXgpCnsK
IHJldHVybiAoaW5kZXggPj0gcmEtPnN0YXJ0ICYmCiAgaW5kZXggPCByYS0+c3RhcnQgKyBy
YS0+c2l6ZSk7Cn0KCnN0cnVjdCBmaWxlIHsKIHVuaW9uIHsKICBzdHJ1Y3QgbGxpc3Rfbm9k
ZSBmdV9sbGlzdDsKICBzdHJ1Y3QgY2FsbGJhY2tfaGVhZCBmdV9yY3VoZWFkOwogfSBmX3U7
CiBzdHJ1Y3QgcGF0aCBmX3BhdGg7CiBzdHJ1Y3QgaW5vZGUgKmZfaW5vZGU7CiBjb25zdCBz
dHJ1Y3QgZmlsZV9vcGVyYXRpb25zICpmX29wOwoKCgoKCiBzcGlubG9ja190IGZfbG9jazsK
IGVudW0gcndfaGludCBmX3dyaXRlX2hpbnQ7CiBhdG9taWNfbG9uZ190IGZfY291bnQ7CiB1
bnNpZ25lZCBpbnQgZl9mbGFnczsKIGZtb2RlX3QgZl9tb2RlOwogc3RydWN0IG11dGV4IGZf
cG9zX2xvY2s7CiBsb2ZmX3QgZl9wb3M7CiBzdHJ1Y3QgZm93bl9zdHJ1Y3QgZl9vd25lcjsK
IGNvbnN0IHN0cnVjdCBjcmVkICpmX2NyZWQ7CiBzdHJ1Y3QgZmlsZV9yYV9zdGF0ZSBmX3Jh
OwoKIHU2NCBmX3ZlcnNpb247CgoKCgogdm9pZCAqcHJpdmF0ZV9kYXRhOwoKCgogc3RydWN0
IGxpc3RfaGVhZCBmX2VwX2xpbmtzOwogc3RydWN0IGxpc3RfaGVhZCBmX3RmaWxlX2xsaW5r
OwoKIHN0cnVjdCBhZGRyZXNzX3NwYWNlICpmX21hcHBpbmc7CiBlcnJzZXFfdCBmX3diX2Vy
cjsKIGVycnNlcV90IGZfc2JfZXJyOwp9CiAgX19hdHRyaWJ1dGVfXygoYWxpZ25lZCg0KSkp
OwoKc3RydWN0IGZpbGVfaGFuZGxlIHsKIF9fdTMyIGhhbmRsZV9ieXRlczsKIGludCBoYW5k
bGVfdHlwZTsKCiB1bnNpZ25lZCBjaGFyIGZfaGFuZGxlW107Cn07CgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3Ry
dWN0IGZpbGUgKmdldF9maWxlKHN0cnVjdCBmaWxlICpmKQp7CiBhdG9taWNfbG9uZ19pbmMo
JmYtPmZfY291bnQpOwogcmV0dXJuIGY7Cn0KIyAxMDM0ICIuL2luY2x1ZGUvbGludXgvZnMu
aCIKdHlwZWRlZiB2b2lkICpmbF9vd25lcl90OwoKc3RydWN0IGZpbGVfbG9jazsKCnN0cnVj
dCBmaWxlX2xvY2tfb3BlcmF0aW9ucyB7CiB2b2lkICgqZmxfY29weV9sb2NrKShzdHJ1Y3Qg
ZmlsZV9sb2NrICosIHN0cnVjdCBmaWxlX2xvY2sgKik7CiB2b2lkICgqZmxfcmVsZWFzZV9w
cml2YXRlKShzdHJ1Y3QgZmlsZV9sb2NrICopOwp9OwoKc3RydWN0IGxvY2tfbWFuYWdlcl9v
cGVyYXRpb25zIHsKIGZsX293bmVyX3QgKCpsbV9nZXRfb3duZXIpKGZsX293bmVyX3QpOwog
dm9pZCAoKmxtX3B1dF9vd25lcikoZmxfb3duZXJfdCk7CiB2b2lkICgqbG1fbm90aWZ5KShz
dHJ1Y3QgZmlsZV9sb2NrICopOwogaW50ICgqbG1fZ3JhbnQpKHN0cnVjdCBmaWxlX2xvY2sg
KiwgaW50KTsKIGJvb2wgKCpsbV9icmVhaykoc3RydWN0IGZpbGVfbG9jayAqKTsKIGludCAo
KmxtX2NoYW5nZSkoc3RydWN0IGZpbGVfbG9jayAqLCBpbnQsIHN0cnVjdCBsaXN0X2hlYWQg
Kik7CiB2b2lkICgqbG1fc2V0dXApKHN0cnVjdCBmaWxlX2xvY2sgKiwgdm9pZCAqKik7CiBi
b29sICgqbG1fYnJlYWtlcl9vd25zX2xlYXNlKShzdHJ1Y3QgZmlsZV9sb2NrICopOwp9OwoK
c3RydWN0IGxvY2tfbWFuYWdlciB7CiBzdHJ1Y3QgbGlzdF9oZWFkIGxpc3Q7CgoKCgogYm9v
bCBibG9ja19vcGVuczsKfTsKCnN0cnVjdCBuZXQ7CnZvaWQgbG9ja3Nfc3RhcnRfZ3JhY2Uo
c3RydWN0IG5ldCAqLCBzdHJ1Y3QgbG9ja19tYW5hZ2VyICopOwp2b2lkIGxvY2tzX2VuZF9n
cmFjZShzdHJ1Y3QgbG9ja19tYW5hZ2VyICopOwpib29sIGxvY2tzX2luX2dyYWNlKHN0cnVj
dCBuZXQgKik7CmJvb2wgb3BlbnNfaW5fZ3JhY2Uoc3RydWN0IG5ldCAqKTsKCgojIDEgIi4v
aW5jbHVkZS9saW51eC9uZnNfZnNfaS5oIiAxCgoKCgpzdHJ1Y3QgbmxtX2xvY2tvd25lcjsK
CgoKCnN0cnVjdCBuZnNfbG9ja19pbmZvIHsKIHUzMiBzdGF0ZTsKIHN0cnVjdCBubG1fbG9j
a293bmVyICpvd25lcjsKIHN0cnVjdCBsaXN0X2hlYWQgbGlzdDsKfTsKCnN0cnVjdCBuZnM0
X2xvY2tfc3RhdGU7CnN0cnVjdCBuZnM0X2xvY2tfaW5mbyB7CiBzdHJ1Y3QgbmZzNF9sb2Nr
X3N0YXRlICpvd25lcjsKfTsKIyAxMDcxICIuL2luY2x1ZGUvbGludXgvZnMuaCIgMgojIDEw
ODkgIi4vaW5jbHVkZS9saW51eC9mcy5oIgpzdHJ1Y3QgZmlsZV9sb2NrIHsKIHN0cnVjdCBm
aWxlX2xvY2sgKmZsX2Jsb2NrZXI7CiBzdHJ1Y3QgbGlzdF9oZWFkIGZsX2xpc3Q7CiBzdHJ1
Y3QgaGxpc3Rfbm9kZSBmbF9saW5rOwogc3RydWN0IGxpc3RfaGVhZCBmbF9ibG9ja2VkX3Jl
cXVlc3RzOwoKCiBzdHJ1Y3QgbGlzdF9oZWFkIGZsX2Jsb2NrZWRfbWVtYmVyOwoKCiBmbF9v
d25lcl90IGZsX293bmVyOwogdW5zaWduZWQgaW50IGZsX2ZsYWdzOwogdW5zaWduZWQgY2hh
ciBmbF90eXBlOwogdW5zaWduZWQgaW50IGZsX3BpZDsKIGludCBmbF9saW5rX2NwdTsKIHdh
aXRfcXVldWVfaGVhZF90IGZsX3dhaXQ7CiBzdHJ1Y3QgZmlsZSAqZmxfZmlsZTsKIGxvZmZf
dCBmbF9zdGFydDsKIGxvZmZfdCBmbF9lbmQ7Cgogc3RydWN0IGZhc3luY19zdHJ1Y3QgKiBm
bF9mYXN5bmM7CgogdW5zaWduZWQgbG9uZyBmbF9icmVha190aW1lOwogdW5zaWduZWQgbG9u
ZyBmbF9kb3duZ3JhZGVfdGltZTsKCiBjb25zdCBzdHJ1Y3QgZmlsZV9sb2NrX29wZXJhdGlv
bnMgKmZsX29wczsKIGNvbnN0IHN0cnVjdCBsb2NrX21hbmFnZXJfb3BlcmF0aW9ucyAqZmxf
bG1vcHM7CiB1bmlvbiB7CiAgc3RydWN0IG5mc19sb2NrX2luZm8gbmZzX2ZsOwogIHN0cnVj
dCBuZnM0X2xvY2tfaW5mbyBuZnM0X2ZsOwogIHN0cnVjdCB7CiAgIHN0cnVjdCBsaXN0X2hl
YWQgbGluazsKICAgaW50IHN0YXRlOwogICB1bnNpZ25lZCBpbnQgZGVidWdfaWQ7CiAgfSBh
ZnM7CiB9IGZsX3U7Cn0gOwoKc3RydWN0IGZpbGVfbG9ja19jb250ZXh0IHsKIHNwaW5sb2Nr
X3QgZmxjX2xvY2s7CiBzdHJ1Y3QgbGlzdF9oZWFkIGZsY19mbG9jazsKIHN0cnVjdCBsaXN0
X2hlYWQgZmxjX3Bvc2l4Owogc3RydWN0IGxpc3RfaGVhZCBmbGNfbGVhc2U7Cn07CiMgMTE0
MSAiLi9pbmNsdWRlL2xpbnV4L2ZzLmgiCmV4dGVybiB2b2lkIHNlbmRfc2lnaW8oc3RydWN0
IGZvd25fc3RydWN0ICpmb3duLCBpbnQgZmQsIGludCBiYW5kKTsKCgoKCmV4dGVybiBpbnQg
ZmNudGxfZ2V0bGsoc3RydWN0IGZpbGUgKiwgdW5zaWduZWQgaW50LCBzdHJ1Y3QgZmxvY2sg
Kik7CmV4dGVybiBpbnQgZmNudGxfc2V0bGsodW5zaWduZWQgaW50LCBzdHJ1Y3QgZmlsZSAq
LCB1bnNpZ25lZCBpbnQsCiAgIHN0cnVjdCBmbG9jayAqKTsKCgoKCgoKCmV4dGVybiBpbnQg
ZmNudGxfc2V0bGVhc2UodW5zaWduZWQgaW50IGZkLCBzdHJ1Y3QgZmlsZSAqZmlscCwgbG9u
ZyBhcmcpOwpleHRlcm4gaW50IGZjbnRsX2dldGxlYXNlKHN0cnVjdCBmaWxlICpmaWxwKTsK
Cgp2b2lkIGxvY2tzX2ZyZWVfbG9ja19jb250ZXh0KHN0cnVjdCBpbm9kZSAqaW5vZGUpOwp2
b2lkIGxvY2tzX2ZyZWVfbG9jayhzdHJ1Y3QgZmlsZV9sb2NrICpmbCk7CmV4dGVybiB2b2lk
IGxvY2tzX2luaXRfbG9jayhzdHJ1Y3QgZmlsZV9sb2NrICopOwpleHRlcm4gc3RydWN0IGZp
bGVfbG9jayAqIGxvY2tzX2FsbG9jX2xvY2sodm9pZCk7CmV4dGVybiB2b2lkIGxvY2tzX2Nv
cHlfbG9jayhzdHJ1Y3QgZmlsZV9sb2NrICosIHN0cnVjdCBmaWxlX2xvY2sgKik7CmV4dGVy
biB2b2lkIGxvY2tzX2NvcHlfY29uZmxvY2soc3RydWN0IGZpbGVfbG9jayAqLCBzdHJ1Y3Qg
ZmlsZV9sb2NrICopOwpleHRlcm4gdm9pZCBsb2Nrc19yZW1vdmVfcG9zaXgoc3RydWN0IGZp
bGUgKiwgZmxfb3duZXJfdCk7CmV4dGVybiB2b2lkIGxvY2tzX3JlbW92ZV9maWxlKHN0cnVj
dCBmaWxlICopOwpleHRlcm4gdm9pZCBsb2Nrc19yZWxlYXNlX3ByaXZhdGUoc3RydWN0IGZp
bGVfbG9jayAqKTsKZXh0ZXJuIHZvaWQgcG9zaXhfdGVzdF9sb2NrKHN0cnVjdCBmaWxlICos
IHN0cnVjdCBmaWxlX2xvY2sgKik7CmV4dGVybiBpbnQgcG9zaXhfbG9ja19maWxlKHN0cnVj
dCBmaWxlICosIHN0cnVjdCBmaWxlX2xvY2sgKiwgc3RydWN0IGZpbGVfbG9jayAqKTsKZXh0
ZXJuIGludCBsb2Nrc19kZWxldGVfYmxvY2soc3RydWN0IGZpbGVfbG9jayAqKTsKZXh0ZXJu
IGludCB2ZnNfdGVzdF9sb2NrKHN0cnVjdCBmaWxlICosIHN0cnVjdCBmaWxlX2xvY2sgKik7
CmV4dGVybiBpbnQgdmZzX2xvY2tfZmlsZShzdHJ1Y3QgZmlsZSAqLCB1bnNpZ25lZCBpbnQs
IHN0cnVjdCBmaWxlX2xvY2sgKiwgc3RydWN0IGZpbGVfbG9jayAqKTsKZXh0ZXJuIGludCB2
ZnNfY2FuY2VsX2xvY2soc3RydWN0IGZpbGUgKmZpbHAsIHN0cnVjdCBmaWxlX2xvY2sgKmZs
KTsKZXh0ZXJuIGludCBsb2Nrc19sb2NrX2lub2RlX3dhaXQoc3RydWN0IGlub2RlICppbm9k
ZSwgc3RydWN0IGZpbGVfbG9jayAqZmwpOwpleHRlcm4gaW50IF9fYnJlYWtfbGVhc2Uoc3Ry
dWN0IGlub2RlICppbm9kZSwgdW5zaWduZWQgaW50IGZsYWdzLCB1bnNpZ25lZCBpbnQgdHlw
ZSk7CmV4dGVybiB2b2lkIGxlYXNlX2dldF9tdGltZShzdHJ1Y3QgaW5vZGUgKiwgc3RydWN0
IHRpbWVzcGVjNjQgKnRpbWUpOwpleHRlcm4gaW50IGdlbmVyaWNfc2V0bGVhc2Uoc3RydWN0
IGZpbGUgKiwgbG9uZywgc3RydWN0IGZpbGVfbG9jayAqKiwgdm9pZCAqKnByaXYpOwpleHRl
cm4gaW50IHZmc19zZXRsZWFzZShzdHJ1Y3QgZmlsZSAqLCBsb25nLCBzdHJ1Y3QgZmlsZV9s
b2NrICoqLCB2b2lkICoqKTsKZXh0ZXJuIGludCBsZWFzZV9tb2RpZnkoc3RydWN0IGZpbGVf
bG9jayAqLCBpbnQsIHN0cnVjdCBsaXN0X2hlYWQgKik7CgpzdHJ1Y3Qgbm90aWZpZXJfYmxv
Y2s7CmV4dGVybiBpbnQgbGVhc2VfcmVnaXN0ZXJfbm90aWZpZXIoc3RydWN0IG5vdGlmaWVy
X2Jsb2NrICopOwpleHRlcm4gdm9pZCBsZWFzZV91bnJlZ2lzdGVyX25vdGlmaWVyKHN0cnVj
dCBub3RpZmllcl9ibG9jayAqKTsKCnN0cnVjdCBmaWxlc19zdHJ1Y3Q7CmV4dGVybiB2b2lk
IHNob3dfZmRfbG9ja3Moc3RydWN0IHNlcV9maWxlICpmLAogICAgc3RydWN0IGZpbGUgKmZp
bHAsIHN0cnVjdCBmaWxlc19zdHJ1Y3QgKmZpbGVzKTsKIyAxMzI2ICIuL2luY2x1ZGUvbGlu
dXgvZnMuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHN0cnVjdCBpbm9kZSAqZmlsZV9pbm9kZShjb25zdCBzdHJ1
Y3QgZmlsZSAqZikKewogcmV0dXJuIGYtPmZfaW5vZGU7Cn0KCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3Qg
ZGVudHJ5ICpmaWxlX2RlbnRyeShjb25zdCBzdHJ1Y3QgZmlsZSAqZmlsZSkKewogcmV0dXJu
IGRfcmVhbChmaWxlLT5mX3BhdGguZGVudHJ5LCBmaWxlX2lub2RlKGZpbGUpKTsKfQoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIGludCBsb2Nrc19sb2NrX2ZpbGVfd2FpdChzdHJ1Y3QgZmlsZSAqZmlscCwgc3Ry
dWN0IGZpbGVfbG9jayAqZmwpCnsKIHJldHVybiBsb2Nrc19sb2NrX2lub2RlX3dhaXQoZmls
ZV9pbm9kZShmaWxwKSwgZmwpOwp9CgpzdHJ1Y3QgZmFzeW5jX3N0cnVjdCB7CiByd2xvY2tf
dCBmYV9sb2NrOwogaW50IG1hZ2ljOwogaW50IGZhX2ZkOwogc3RydWN0IGZhc3luY19zdHJ1
Y3QgKmZhX25leHQ7CiBzdHJ1Y3QgZmlsZSAqZmFfZmlsZTsKIHN0cnVjdCBjYWxsYmFja19o
ZWFkIGZhX3JjdTsKfTsKCgoKCmV4dGVybiBpbnQgZmFzeW5jX2hlbHBlcihpbnQsIHN0cnVj
dCBmaWxlICosIGludCwgc3RydWN0IGZhc3luY19zdHJ1Y3QgKiopOwpleHRlcm4gc3RydWN0
IGZhc3luY19zdHJ1Y3QgKmZhc3luY19pbnNlcnRfZW50cnkoaW50LCBzdHJ1Y3QgZmlsZSAq
LCBzdHJ1Y3QgZmFzeW5jX3N0cnVjdCAqKiwgc3RydWN0IGZhc3luY19zdHJ1Y3QgKik7CmV4
dGVybiBpbnQgZmFzeW5jX3JlbW92ZV9lbnRyeShzdHJ1Y3QgZmlsZSAqLCBzdHJ1Y3QgZmFz
eW5jX3N0cnVjdCAqKik7CmV4dGVybiBzdHJ1Y3QgZmFzeW5jX3N0cnVjdCAqZmFzeW5jX2Fs
bG9jKHZvaWQpOwpleHRlcm4gdm9pZCBmYXN5bmNfZnJlZShzdHJ1Y3QgZmFzeW5jX3N0cnVj
dCAqKTsKCgpleHRlcm4gdm9pZCBraWxsX2Zhc3luYyhzdHJ1Y3QgZmFzeW5jX3N0cnVjdCAq
KiwgaW50LCBpbnQpOwoKZXh0ZXJuIHZvaWQgX19mX3NldG93bihzdHJ1Y3QgZmlsZSAqZmls
cCwgc3RydWN0IHBpZCAqLCBlbnVtIHBpZF90eXBlLCBpbnQgZm9yY2UpOwpleHRlcm4gaW50
IGZfc2V0b3duKHN0cnVjdCBmaWxlICpmaWxwLCB1bnNpZ25lZCBsb25nIGFyZywgaW50IGZv
cmNlKTsKZXh0ZXJuIHZvaWQgZl9kZWxvd24oc3RydWN0IGZpbGUgKmZpbHApOwpleHRlcm4g
cGlkX3QgZl9nZXRvd24oc3RydWN0IGZpbGUgKmZpbHApOwpleHRlcm4gaW50IHNlbmRfc2ln
dXJnKHN0cnVjdCBmb3duX3N0cnVjdCAqZm93bik7CiMgMTQxOSAiLi9pbmNsdWRlL2xpbnV4
L2ZzLmgiCmVudW0gewogU0JfVU5GUk9aRU4gPSAwLAogU0JfRlJFRVpFX1dSSVRFID0gMSwK
IFNCX0ZSRUVaRV9QQUdFRkFVTFQgPSAyLAogU0JfRlJFRVpFX0ZTID0gMywKCiBTQl9GUkVF
WkVfQ09NUExFVEUgPSA0LAp9OwoKCgpzdHJ1Y3Qgc2Jfd3JpdGVycyB7CiBpbnQgZnJvemVu
Owogd2FpdF9xdWV1ZV9oZWFkX3Qgd2FpdF91bmZyb3plbjsKIHN0cnVjdCBwZXJjcHVfcndf
c2VtYXBob3JlIHJ3X3NlbVsoU0JfRlJFRVpFX0NPTVBMRVRFIC0gMSldOwp9OwoKc3RydWN0
IHN1cGVyX2Jsb2NrIHsKIHN0cnVjdCBsaXN0X2hlYWQgc19saXN0OwogZGV2X3Qgc19kZXY7
CiB1bnNpZ25lZCBjaGFyIHNfYmxvY2tzaXplX2JpdHM7CiB1bnNpZ25lZCBsb25nIHNfYmxv
Y2tzaXplOwogbG9mZl90IHNfbWF4Ynl0ZXM7CiBzdHJ1Y3QgZmlsZV9zeXN0ZW1fdHlwZSAq
c190eXBlOwogY29uc3Qgc3RydWN0IHN1cGVyX29wZXJhdGlvbnMgKnNfb3A7CiBjb25zdCBz
dHJ1Y3QgZHF1b3Rfb3BlcmF0aW9ucyAqZHFfb3A7CiBjb25zdCBzdHJ1Y3QgcXVvdGFjdGxf
b3BzICpzX3Fjb3A7CiBjb25zdCBzdHJ1Y3QgZXhwb3J0X29wZXJhdGlvbnMgKnNfZXhwb3J0
X29wOwogdW5zaWduZWQgbG9uZyBzX2ZsYWdzOwogdW5zaWduZWQgbG9uZyBzX2lmbGFnczsK
IHVuc2lnbmVkIGxvbmcgc19tYWdpYzsKIHN0cnVjdCBkZW50cnkgKnNfcm9vdDsKIHN0cnVj
dCByd19zZW1hcGhvcmUgc191bW91bnQ7CiBpbnQgc19jb3VudDsKIGF0b21pY190IHNfYWN0
aXZlOwoKCgogY29uc3Qgc3RydWN0IHhhdHRyX2hhbmRsZXIgKipzX3hhdHRyOwoKCgoKCgoK
IHN0cnVjdCBobGlzdF9ibF9oZWFkIHNfcm9vdHM7CiBzdHJ1Y3QgbGlzdF9oZWFkIHNfbW91
bnRzOwogc3RydWN0IGJsb2NrX2RldmljZSAqc19iZGV2Owogc3RydWN0IGJhY2tpbmdfZGV2
X2luZm8gKnNfYmRpOwogc3RydWN0IG10ZF9pbmZvICpzX210ZDsKIHN0cnVjdCBobGlzdF9u
b2RlIHNfaW5zdGFuY2VzOwogdW5zaWduZWQgaW50IHNfcXVvdGFfdHlwZXM7CiBzdHJ1Y3Qg
cXVvdGFfaW5mbyBzX2RxdW90OwoKIHN0cnVjdCBzYl93cml0ZXJzIHNfd3JpdGVyczsKCgoK
CgoKIHZvaWQgKnNfZnNfaW5mbzsKCgogdTMyIHNfdGltZV9ncmFuOwoKIHRpbWU2NF90IHNf
dGltZV9taW47CiB0aW1lNjRfdCBzX3RpbWVfbWF4OwoKIF9fdTMyIHNfZnNub3RpZnlfbWFz
azsKIHN0cnVjdCBmc25vdGlmeV9tYXJrX2Nvbm5lY3RvciAqc19mc25vdGlmeV9tYXJrczsK
CgogY2hhciBzX2lkWzMyXTsKIHV1aWRfdCBzX3V1aWQ7CgogdW5zaWduZWQgaW50IHNfbWF4
X2xpbmtzOwogZm1vZGVfdCBzX21vZGU7CgoKCgoKIHN0cnVjdCBtdXRleCBzX3Zmc19yZW5h
bWVfbXV0ZXg7CgoKCgoKIGNvbnN0IGNoYXIgKnNfc3VidHlwZTsKCiBjb25zdCBzdHJ1Y3Qg
ZGVudHJ5X29wZXJhdGlvbnMgKnNfZF9vcDsKCgoKCiBpbnQgY2xlYW5jYWNoZV9wb29saWQ7
Cgogc3RydWN0IHNocmlua2VyIHNfc2hyaW5rOwoKCiBhdG9taWNfbG9uZ190IHNfcmVtb3Zl
X2NvdW50OwoKCiBhdG9taWNfbG9uZ190IHNfZnNub3RpZnlfaW5vZGVfcmVmczsKCgogaW50
IHNfcmVhZG9ubHlfcmVtb3VudDsKCgogZXJyc2VxX3Qgc193Yl9lcnI7CgoKIHN0cnVjdCB3
b3JrcXVldWVfc3RydWN0ICpzX2Rpb19kb25lX3dxOwogc3RydWN0IGhsaXN0X2hlYWQgc19w
aW5zOwoKCgoKCgogc3RydWN0IHVzZXJfbmFtZXNwYWNlICpzX3VzZXJfbnM7CgoKCgoKCiBz
dHJ1Y3QgbGlzdF9scnUgc19kZW50cnlfbHJ1Owogc3RydWN0IGxpc3RfbHJ1IHNfaW5vZGVf
bHJ1Owogc3RydWN0IGNhbGxiYWNrX2hlYWQgcmN1Owogc3RydWN0IHdvcmtfc3RydWN0IGRl
c3Ryb3lfd29yazsKCiBzdHJ1Y3QgbXV0ZXggc19zeW5jX2xvY2s7CgoKCgogaW50IHNfc3Rh
Y2tfZGVwdGg7CgoKIHNwaW5sb2NrX3Qgc19pbm9kZV9saXN0X2xvY2sgX19hdHRyaWJ1dGVf
XygoX19hbGlnbmVkX18oKDEgPDwgNikpKSk7CiBzdHJ1Y3QgbGlzdF9oZWFkIHNfaW5vZGVz
OwoKIHNwaW5sb2NrX3Qgc19pbm9kZV93Ymxpc3RfbG9jazsKIHN0cnVjdCBsaXN0X2hlYWQg
c19pbm9kZXNfd2I7Cn0gOwoKCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdWlkX3QgaV91aWRfcmVhZChjb25z
dCBzdHJ1Y3QgaW5vZGUgKmlub2RlKQp7CiByZXR1cm4gZnJvbV9rdWlkKGlub2RlLT5pX3Ni
LT5zX3VzZXJfbnMsIGlub2RlLT5pX3VpZCk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBnaWRfdCBpX2dpZF9y
ZWFkKGNvbnN0IHN0cnVjdCBpbm9kZSAqaW5vZGUpCnsKIHJldHVybiBmcm9tX2tnaWQoaW5v
ZGUtPmlfc2ItPnNfdXNlcl9ucywgaW5vZGUtPmlfZ2lkKTsKfQoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQg
aV91aWRfd3JpdGUoc3RydWN0IGlub2RlICppbm9kZSwgdWlkX3QgdWlkKQp7CiBpbm9kZS0+
aV91aWQgPSBtYWtlX2t1aWQoaW5vZGUtPmlfc2ItPnNfdXNlcl9ucywgdWlkKTsKfQoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIHZvaWQgaV9naWRfd3JpdGUoc3RydWN0IGlub2RlICppbm9kZSwgZ2lkX3QgZ2lk
KQp7CiBpbm9kZS0+aV9naWQgPSBtYWtlX2tnaWQoaW5vZGUtPmlfc2ItPnNfdXNlcl9ucywg
Z2lkKTsKfQoKZXh0ZXJuIHN0cnVjdCB0aW1lc3BlYzY0IGN1cnJlbnRfdGltZShzdHJ1Y3Qg
aW5vZGUgKmlub2RlKTsKCgoKCgp2b2lkIF9fc2JfZW5kX3dyaXRlKHN0cnVjdCBzdXBlcl9i
bG9jayAqc2IsIGludCBsZXZlbCk7CmludCBfX3NiX3N0YXJ0X3dyaXRlKHN0cnVjdCBzdXBl
cl9ibG9jayAqc2IsIGludCBsZXZlbCwgYm9vbCB3YWl0KTsKIyAxNjE0ICIuL2luY2x1ZGUv
bGludXgvZnMuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgc2JfZW5kX3dyaXRlKHN0cnVjdCBzdXBlcl9i
bG9jayAqc2IpCnsKIF9fc2JfZW5kX3dyaXRlKHNiLCBTQl9GUkVFWkVfV1JJVEUpOwp9CiMg
MTYyNiAiLi9pbmNsdWRlL2xpbnV4L2ZzLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHNiX2VuZF9wYWdl
ZmF1bHQoc3RydWN0IHN1cGVyX2Jsb2NrICpzYikKewogX19zYl9lbmRfd3JpdGUoc2IsIFNC
X0ZSRUVaRV9QQUdFRkFVTFQpOwp9CiMgMTYzOCAiLi9pbmNsdWRlL2xpbnV4L2ZzLmgiCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSB2b2lkIHNiX2VuZF9pbnR3cml0ZShzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiKQp7
CiBfX3NiX2VuZF93cml0ZShzYiwgU0JfRlJFRVpFX0ZTKTsKfQojIDE2NjIgIi4vaW5jbHVk
ZS9saW51eC9mcy5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBzYl9zdGFydF93cml0ZShzdHJ1Y3Qgc3Vw
ZXJfYmxvY2sgKnNiKQp7CiBfX3NiX3N0YXJ0X3dyaXRlKHNiLCBTQl9GUkVFWkVfV1JJVEUs
IHRydWUpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHNiX3N0YXJ0X3dyaXRlX3RyeWxvY2soc3RydWN0
IHN1cGVyX2Jsb2NrICpzYikKewogcmV0dXJuIF9fc2Jfc3RhcnRfd3JpdGUoc2IsIFNCX0ZS
RUVaRV9XUklURSwgZmFsc2UpOwp9CiMgMTY5MSAiLi9pbmNsdWRlL2xpbnV4L2ZzLmgiCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSB2b2lkIHNiX3N0YXJ0X3BhZ2VmYXVsdChzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNi
KQp7CiBfX3NiX3N0YXJ0X3dyaXRlKHNiLCBTQl9GUkVFWkVfUEFHRUZBVUxULCB0cnVlKTsK
fQojIDE3MDkgIi4vaW5jbHVkZS9saW51eC9mcy5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBzYl9zdGFy
dF9pbnR3cml0ZShzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiKQp7CiBfX3NiX3N0YXJ0X3dyaXRl
KHNiLCBTQl9GUkVFWkVfRlMsIHRydWUpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHNiX3N0YXJ0X2lu
dHdyaXRlX3RyeWxvY2soc3RydWN0IHN1cGVyX2Jsb2NrICpzYikKewogcmV0dXJuIF9fc2Jf
c3RhcnRfd3JpdGUoc2IsIFNCX0ZSRUVaRV9GUywgZmFsc2UpOwp9CgoKZXh0ZXJuIGJvb2wg
aW5vZGVfb3duZXJfb3JfY2FwYWJsZShjb25zdCBzdHJ1Y3QgaW5vZGUgKmlub2RlKTsKCgoK
CmV4dGVybiBpbnQgdmZzX2NyZWF0ZShzdHJ1Y3QgaW5vZGUgKiwgc3RydWN0IGRlbnRyeSAq
LCB1bW9kZV90LCBib29sKTsKZXh0ZXJuIGludCB2ZnNfbWtkaXIoc3RydWN0IGlub2RlICos
IHN0cnVjdCBkZW50cnkgKiwgdW1vZGVfdCk7CmV4dGVybiBpbnQgdmZzX21rbm9kKHN0cnVj
dCBpbm9kZSAqLCBzdHJ1Y3QgZGVudHJ5ICosIHVtb2RlX3QsIGRldl90KTsKZXh0ZXJuIGlu
dCB2ZnNfc3ltbGluayhzdHJ1Y3QgaW5vZGUgKiwgc3RydWN0IGRlbnRyeSAqLCBjb25zdCBj
aGFyICopOwpleHRlcm4gaW50IHZmc19saW5rKHN0cnVjdCBkZW50cnkgKiwgc3RydWN0IGlu
b2RlICosIHN0cnVjdCBkZW50cnkgKiwgc3RydWN0IGlub2RlICoqKTsKZXh0ZXJuIGludCB2
ZnNfcm1kaXIoc3RydWN0IGlub2RlICosIHN0cnVjdCBkZW50cnkgKik7CmV4dGVybiBpbnQg
dmZzX3VubGluayhzdHJ1Y3QgaW5vZGUgKiwgc3RydWN0IGRlbnRyeSAqLCBzdHJ1Y3QgaW5v
ZGUgKiopOwpleHRlcm4gaW50IHZmc19yZW5hbWUoc3RydWN0IGlub2RlICosIHN0cnVjdCBk
ZW50cnkgKiwgc3RydWN0IGlub2RlICosIHN0cnVjdCBkZW50cnkgKiwgc3RydWN0IGlub2Rl
ICoqLCB1bnNpZ25lZCBpbnQpOwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCB2ZnNfd2hpdGVvdXQoc3RydWN0
IGlub2RlICpkaXIsIHN0cnVjdCBkZW50cnkgKmRlbnRyeSkKewogcmV0dXJuIHZmc19ta25v
ZChkaXIsIGRlbnRyeSwgMDAyMDAwMCB8IDAsIDApOwp9CgpleHRlcm4gc3RydWN0IGRlbnRy
eSAqdmZzX3RtcGZpbGUoc3RydWN0IGRlbnRyeSAqZGVudHJ5LCB1bW9kZV90IG1vZGUsCiAg
ICAgIGludCBvcGVuX2ZsYWcpOwoKaW50IHZmc19ta29iaihzdHJ1Y3QgZGVudHJ5ICosIHVt
b2RlX3QsCiAgaW50ICgqZikoc3RydWN0IGRlbnRyeSAqLCB1bW9kZV90LCB2b2lkICopLAog
IHZvaWQgKik7CgpleHRlcm4gbG9uZyB2ZnNfaW9jdGwoc3RydWN0IGZpbGUgKmZpbGUsIHVu
c2lnbmVkIGludCBjbWQsIHVuc2lnbmVkIGxvbmcgYXJnKTsKCgpleHRlcm4gbG9uZyBjb21w
YXRfcHRyX2lvY3RsKHN0cnVjdCBmaWxlICpmaWxlLCB1bnNpZ25lZCBpbnQgY21kLAogICAg
IHVuc2lnbmVkIGxvbmcgYXJnKTsKCgoKCgoKCmV4dGVybiB2b2lkIGlub2RlX2luaXRfb3du
ZXIoc3RydWN0IGlub2RlICppbm9kZSwgY29uc3Qgc3RydWN0IGlub2RlICpkaXIsCiAgIHVt
b2RlX3QgbW9kZSk7CmV4dGVybiBib29sIG1heV9vcGVuX2Rldihjb25zdCBzdHJ1Y3QgcGF0
aCAqcGF0aCk7CgoKCgoKCgpzdHJ1Y3QgZGlyX2NvbnRleHQ7CnR5cGVkZWYgaW50ICgqZmls
bGRpcl90KShzdHJ1Y3QgZGlyX2NvbnRleHQgKiwgY29uc3QgY2hhciAqLCBpbnQsIGxvZmZf
dCwgdTY0LAogICAgdW5zaWduZWQpOwoKc3RydWN0IGRpcl9jb250ZXh0IHsKIGZpbGxkaXJf
dCBhY3RvcjsKIGxvZmZfdCBwb3M7Cn07CgpzdHJ1Y3QgYmxvY2tfZGV2aWNlX29wZXJhdGlv
bnM7CiMgMTgyNCAiLi9pbmNsdWRlL2xpbnV4L2ZzLmgiCnN0cnVjdCBpb3ZfaXRlcjsKCnN0
cnVjdCBmaWxlX29wZXJhdGlvbnMgewogc3RydWN0IG1vZHVsZSAqb3duZXI7CiBsb2ZmX3Qg
KCpsbHNlZWspIChzdHJ1Y3QgZmlsZSAqLCBsb2ZmX3QsIGludCk7CiBzc2l6ZV90ICgqcmVh
ZCkgKHN0cnVjdCBmaWxlICosIGNoYXIgKiwgc2l6ZV90LCBsb2ZmX3QgKik7CiBzc2l6ZV90
ICgqd3JpdGUpIChzdHJ1Y3QgZmlsZSAqLCBjb25zdCBjaGFyICosIHNpemVfdCwgbG9mZl90
ICopOwogc3NpemVfdCAoKnJlYWRfaXRlcikgKHN0cnVjdCBraW9jYiAqLCBzdHJ1Y3QgaW92
X2l0ZXIgKik7CiBzc2l6ZV90ICgqd3JpdGVfaXRlcikgKHN0cnVjdCBraW9jYiAqLCBzdHJ1
Y3QgaW92X2l0ZXIgKik7CiBpbnQgKCppb3BvbGwpKHN0cnVjdCBraW9jYiAqa2lvY2IsIGJv
b2wgc3Bpbik7CiBpbnQgKCppdGVyYXRlKSAoc3RydWN0IGZpbGUgKiwgc3RydWN0IGRpcl9j
b250ZXh0ICopOwogaW50ICgqaXRlcmF0ZV9zaGFyZWQpIChzdHJ1Y3QgZmlsZSAqLCBzdHJ1
Y3QgZGlyX2NvbnRleHQgKik7CiBfX3BvbGxfdCAoKnBvbGwpIChzdHJ1Y3QgZmlsZSAqLCBz
dHJ1Y3QgcG9sbF90YWJsZV9zdHJ1Y3QgKik7CiBsb25nICgqdW5sb2NrZWRfaW9jdGwpIChz
dHJ1Y3QgZmlsZSAqLCB1bnNpZ25lZCBpbnQsIHVuc2lnbmVkIGxvbmcpOwogbG9uZyAoKmNv
bXBhdF9pb2N0bCkgKHN0cnVjdCBmaWxlICosIHVuc2lnbmVkIGludCwgdW5zaWduZWQgbG9u
Zyk7CiBpbnQgKCptbWFwKSAoc3RydWN0IGZpbGUgKiwgc3RydWN0IHZtX2FyZWFfc3RydWN0
ICopOwogdW5zaWduZWQgbG9uZyBtbWFwX3N1cHBvcnRlZF9mbGFnczsKIGludCAoKm9wZW4p
IChzdHJ1Y3QgaW5vZGUgKiwgc3RydWN0IGZpbGUgKik7CiBpbnQgKCpmbHVzaCkgKHN0cnVj
dCBmaWxlICosIGZsX293bmVyX3QgaWQpOwogaW50ICgqcmVsZWFzZSkgKHN0cnVjdCBpbm9k
ZSAqLCBzdHJ1Y3QgZmlsZSAqKTsKIGludCAoKmZzeW5jKSAoc3RydWN0IGZpbGUgKiwgbG9m
Zl90LCBsb2ZmX3QsIGludCBkYXRhc3luYyk7CiBpbnQgKCpmYXN5bmMpIChpbnQsIHN0cnVj
dCBmaWxlICosIGludCk7CiBpbnQgKCpsb2NrKSAoc3RydWN0IGZpbGUgKiwgaW50LCBzdHJ1
Y3QgZmlsZV9sb2NrICopOwogc3NpemVfdCAoKnNlbmRwYWdlKSAoc3RydWN0IGZpbGUgKiwg
c3RydWN0IHBhZ2UgKiwgaW50LCBzaXplX3QsIGxvZmZfdCAqLCBpbnQpOwogdW5zaWduZWQg
bG9uZyAoKmdldF91bm1hcHBlZF9hcmVhKShzdHJ1Y3QgZmlsZSAqLCB1bnNpZ25lZCBsb25n
LCB1bnNpZ25lZCBsb25nLCB1bnNpZ25lZCBsb25nLCB1bnNpZ25lZCBsb25nKTsKIGludCAo
KmNoZWNrX2ZsYWdzKShpbnQpOwogaW50ICgqZmxvY2spIChzdHJ1Y3QgZmlsZSAqLCBpbnQs
IHN0cnVjdCBmaWxlX2xvY2sgKik7CiBzc2l6ZV90ICgqc3BsaWNlX3dyaXRlKShzdHJ1Y3Qg
cGlwZV9pbm9kZV9pbmZvICosIHN0cnVjdCBmaWxlICosIGxvZmZfdCAqLCBzaXplX3QsIHVu
c2lnbmVkIGludCk7CiBzc2l6ZV90ICgqc3BsaWNlX3JlYWQpKHN0cnVjdCBmaWxlICosIGxv
ZmZfdCAqLCBzdHJ1Y3QgcGlwZV9pbm9kZV9pbmZvICosIHNpemVfdCwgdW5zaWduZWQgaW50
KTsKIGludCAoKnNldGxlYXNlKShzdHJ1Y3QgZmlsZSAqLCBsb25nLCBzdHJ1Y3QgZmlsZV9s
b2NrICoqLCB2b2lkICoqKTsKIGxvbmcgKCpmYWxsb2NhdGUpKHN0cnVjdCBmaWxlICpmaWxl
LCBpbnQgbW9kZSwgbG9mZl90IG9mZnNldCwKICAgICBsb2ZmX3QgbGVuKTsKIHZvaWQgKCpz
aG93X2ZkaW5mbykoc3RydWN0IHNlcV9maWxlICptLCBzdHJ1Y3QgZmlsZSAqZik7CgoKCiBz
c2l6ZV90ICgqY29weV9maWxlX3JhbmdlKShzdHJ1Y3QgZmlsZSAqLCBsb2ZmX3QsIHN0cnVj
dCBmaWxlICosCiAgIGxvZmZfdCwgc2l6ZV90LCB1bnNpZ25lZCBpbnQpOwogbG9mZl90ICgq
cmVtYXBfZmlsZV9yYW5nZSkoc3RydWN0IGZpbGUgKmZpbGVfaW4sIGxvZmZfdCBwb3NfaW4s
CiAgICAgICBzdHJ1Y3QgZmlsZSAqZmlsZV9vdXQsIGxvZmZfdCBwb3Nfb3V0LAogICAgICAg
bG9mZl90IGxlbiwgdW5zaWduZWQgaW50IHJlbWFwX2ZsYWdzKTsKIGludCAoKmZhZHZpc2Up
KHN0cnVjdCBmaWxlICosIGxvZmZfdCwgbG9mZl90LCBpbnQpOwp9IDsKCnN0cnVjdCBpbm9k
ZV9vcGVyYXRpb25zIHsKIHN0cnVjdCBkZW50cnkgKiAoKmxvb2t1cCkgKHN0cnVjdCBpbm9k
ZSAqLHN0cnVjdCBkZW50cnkgKiwgdW5zaWduZWQgaW50KTsKIGNvbnN0IGNoYXIgKiAoKmdl
dF9saW5rKSAoc3RydWN0IGRlbnRyeSAqLCBzdHJ1Y3QgaW5vZGUgKiwgc3RydWN0IGRlbGF5
ZWRfY2FsbCAqKTsKIGludCAoKnBlcm1pc3Npb24pIChzdHJ1Y3QgaW5vZGUgKiwgaW50KTsK
IHN0cnVjdCBwb3NpeF9hY2wgKiAoKmdldF9hY2wpKHN0cnVjdCBpbm9kZSAqLCBpbnQpOwoK
IGludCAoKnJlYWRsaW5rKSAoc3RydWN0IGRlbnRyeSAqLCBjaGFyICosaW50KTsKCiBpbnQg
KCpjcmVhdGUpIChzdHJ1Y3QgaW5vZGUgKixzdHJ1Y3QgZGVudHJ5ICosIHVtb2RlX3QsIGJv
b2wpOwogaW50ICgqbGluaykgKHN0cnVjdCBkZW50cnkgKixzdHJ1Y3QgaW5vZGUgKixzdHJ1
Y3QgZGVudHJ5ICopOwogaW50ICgqdW5saW5rKSAoc3RydWN0IGlub2RlICosc3RydWN0IGRl
bnRyeSAqKTsKIGludCAoKnN5bWxpbmspIChzdHJ1Y3QgaW5vZGUgKixzdHJ1Y3QgZGVudHJ5
ICosY29uc3QgY2hhciAqKTsKIGludCAoKm1rZGlyKSAoc3RydWN0IGlub2RlICosc3RydWN0
IGRlbnRyeSAqLHVtb2RlX3QpOwogaW50ICgqcm1kaXIpIChzdHJ1Y3QgaW5vZGUgKixzdHJ1
Y3QgZGVudHJ5ICopOwogaW50ICgqbWtub2QpIChzdHJ1Y3QgaW5vZGUgKixzdHJ1Y3QgZGVu
dHJ5ICosdW1vZGVfdCxkZXZfdCk7CiBpbnQgKCpyZW5hbWUpIChzdHJ1Y3QgaW5vZGUgKiwg
c3RydWN0IGRlbnRyeSAqLAogICBzdHJ1Y3QgaW5vZGUgKiwgc3RydWN0IGRlbnRyeSAqLCB1
bnNpZ25lZCBpbnQpOwogaW50ICgqc2V0YXR0cikgKHN0cnVjdCBkZW50cnkgKiwgc3RydWN0
IGlhdHRyICopOwogaW50ICgqZ2V0YXR0cikgKGNvbnN0IHN0cnVjdCBwYXRoICosIHN0cnVj
dCBrc3RhdCAqLCB1MzIsIHVuc2lnbmVkIGludCk7CiBzc2l6ZV90ICgqbGlzdHhhdHRyKSAo
c3RydWN0IGRlbnRyeSAqLCBjaGFyICosIHNpemVfdCk7CiBpbnQgKCpmaWVtYXApKHN0cnVj
dCBpbm9kZSAqLCBzdHJ1Y3QgZmllbWFwX2V4dGVudF9pbmZvICosIHU2NCBzdGFydCwKICAg
ICAgICB1NjQgbGVuKTsKIGludCAoKnVwZGF0ZV90aW1lKShzdHJ1Y3QgaW5vZGUgKiwgc3Ry
dWN0IHRpbWVzcGVjNjQgKiwgaW50KTsKIGludCAoKmF0b21pY19vcGVuKShzdHJ1Y3QgaW5v
ZGUgKiwgc3RydWN0IGRlbnRyeSAqLAogICAgICBzdHJ1Y3QgZmlsZSAqLCB1bnNpZ25lZCBv
cGVuX2ZsYWcsCiAgICAgIHVtb2RlX3QgY3JlYXRlX21vZGUpOwogaW50ICgqdG1wZmlsZSkg
KHN0cnVjdCBpbm9kZSAqLCBzdHJ1Y3QgZGVudHJ5ICosIHVtb2RlX3QpOwogaW50ICgqc2V0
X2FjbCkoc3RydWN0IGlub2RlICosIHN0cnVjdCBwb3NpeF9hY2wgKiwgaW50KTsKfSBfX2F0
dHJpYnV0ZV9fKChfX2FsaWduZWRfXygoMSA8PCA2KSkpKTsKCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzc2l6ZV90
IGNhbGxfcmVhZF9pdGVyKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3Qga2lvY2IgKmtpbywK
ICAgICAgICAgc3RydWN0IGlvdl9pdGVyICppdGVyKQp7CiByZXR1cm4gZmlsZS0+Zl9vcC0+
cmVhZF9pdGVyKGtpbywgaXRlcik7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzc2l6ZV90IGNhbGxfd3JpdGVf
aXRlcihzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IGtpb2NiICpraW8sCiAgICAgICAgICBz
dHJ1Y3QgaW92X2l0ZXIgKml0ZXIpCnsKIHJldHVybiBmaWxlLT5mX29wLT53cml0ZV9pdGVy
KGtpbywgaXRlcik7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgY2FsbF9tbWFwKHN0cnVjdCBmaWxlICpm
aWxlLCBzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnZtYSkKewogcmV0dXJuIGZpbGUtPmZfb3At
Pm1tYXAoZmlsZSwgdm1hKTsKfQoKc3NpemVfdCByd19jb3B5X2NoZWNrX3V2ZWN0b3IoaW50
IHR5cGUsIGNvbnN0IHN0cnVjdCBpb3ZlYyAqIHV2ZWN0b3IsCiAgICAgICAgIHVuc2lnbmVk
IGxvbmcgbnJfc2VncywgdW5zaWduZWQgbG9uZyBmYXN0X3NlZ3MsCiAgICAgICAgIHN0cnVj
dCBpb3ZlYyAqZmFzdF9wb2ludGVyLAogICAgICAgICBzdHJ1Y3QgaW92ZWMgKipyZXRfcG9p
bnRlcik7CgpleHRlcm4gc3NpemVfdCBfX3Zmc19yZWFkKHN0cnVjdCBmaWxlICosIGNoYXIg
Kiwgc2l6ZV90LCBsb2ZmX3QgKik7CmV4dGVybiBzc2l6ZV90IHZmc19yZWFkKHN0cnVjdCBm
aWxlICosIGNoYXIgKiwgc2l6ZV90LCBsb2ZmX3QgKik7CmV4dGVybiBzc2l6ZV90IHZmc193
cml0ZShzdHJ1Y3QgZmlsZSAqLCBjb25zdCBjaGFyICosIHNpemVfdCwgbG9mZl90ICopOwpl
eHRlcm4gc3NpemVfdCB2ZnNfcmVhZHYoc3RydWN0IGZpbGUgKiwgY29uc3Qgc3RydWN0IGlv
dmVjICosCiAgdW5zaWduZWQgbG9uZywgbG9mZl90ICosIHJ3Zl90KTsKZXh0ZXJuIHNzaXpl
X3QgdmZzX2NvcHlfZmlsZV9yYW5nZShzdHJ1Y3QgZmlsZSAqLCBsb2ZmX3QgLCBzdHJ1Y3Qg
ZmlsZSAqLAogICAgICAgbG9mZl90LCBzaXplX3QsIHVuc2lnbmVkIGludCk7CmV4dGVybiBz
c2l6ZV90IGdlbmVyaWNfY29weV9maWxlX3JhbmdlKHN0cnVjdCBmaWxlICpmaWxlX2luLCBs
b2ZmX3QgcG9zX2luLAogICAgICAgICAgIHN0cnVjdCBmaWxlICpmaWxlX291dCwgbG9mZl90
IHBvc19vdXQsCiAgICAgICAgICAgc2l6ZV90IGxlbiwgdW5zaWduZWQgaW50IGZsYWdzKTsK
ZXh0ZXJuIGludCBnZW5lcmljX3JlbWFwX2ZpbGVfcmFuZ2VfcHJlcChzdHJ1Y3QgZmlsZSAq
ZmlsZV9pbiwgbG9mZl90IHBvc19pbiwKICAgICAgc3RydWN0IGZpbGUgKmZpbGVfb3V0LCBs
b2ZmX3QgcG9zX291dCwKICAgICAgbG9mZl90ICpjb3VudCwKICAgICAgdW5zaWduZWQgaW50
IHJlbWFwX2ZsYWdzKTsKZXh0ZXJuIGxvZmZfdCBkb19jbG9uZV9maWxlX3JhbmdlKHN0cnVj
dCBmaWxlICpmaWxlX2luLCBsb2ZmX3QgcG9zX2luLAogICAgICBzdHJ1Y3QgZmlsZSAqZmls
ZV9vdXQsIGxvZmZfdCBwb3Nfb3V0LAogICAgICBsb2ZmX3QgbGVuLCB1bnNpZ25lZCBpbnQg
cmVtYXBfZmxhZ3MpOwpleHRlcm4gbG9mZl90IHZmc19jbG9uZV9maWxlX3JhbmdlKHN0cnVj
dCBmaWxlICpmaWxlX2luLCBsb2ZmX3QgcG9zX2luLAogICAgICAgc3RydWN0IGZpbGUgKmZp
bGVfb3V0LCBsb2ZmX3QgcG9zX291dCwKICAgICAgIGxvZmZfdCBsZW4sIHVuc2lnbmVkIGlu
dCByZW1hcF9mbGFncyk7CmV4dGVybiBpbnQgdmZzX2RlZHVwZV9maWxlX3JhbmdlKHN0cnVj
dCBmaWxlICpmaWxlLAogICAgIHN0cnVjdCBmaWxlX2RlZHVwZV9yYW5nZSAqc2FtZSk7CmV4
dGVybiBsb2ZmX3QgdmZzX2RlZHVwZV9maWxlX3JhbmdlX29uZShzdHJ1Y3QgZmlsZSAqc3Jj
X2ZpbGUsIGxvZmZfdCBzcmNfcG9zLAogICAgIHN0cnVjdCBmaWxlICpkc3RfZmlsZSwgbG9m
Zl90IGRzdF9wb3MsCiAgICAgbG9mZl90IGxlbiwgdW5zaWduZWQgaW50IHJlbWFwX2ZsYWdz
KTsKCgpzdHJ1Y3Qgc3VwZXJfb3BlcmF0aW9ucyB7CiAgICBzdHJ1Y3QgaW5vZGUgKigqYWxs
b2NfaW5vZGUpKHN0cnVjdCBzdXBlcl9ibG9jayAqc2IpOwogdm9pZCAoKmRlc3Ryb3lfaW5v
ZGUpKHN0cnVjdCBpbm9kZSAqKTsKIHZvaWQgKCpmcmVlX2lub2RlKShzdHJ1Y3QgaW5vZGUg
Kik7CgogICAgdm9pZCAoKmRpcnR5X2lub2RlKSAoc3RydWN0IGlub2RlICosIGludCBmbGFn
cyk7CiBpbnQgKCp3cml0ZV9pbm9kZSkgKHN0cnVjdCBpbm9kZSAqLCBzdHJ1Y3Qgd3JpdGVi
YWNrX2NvbnRyb2wgKndiYyk7CiBpbnQgKCpkcm9wX2lub2RlKSAoc3RydWN0IGlub2RlICop
Owogdm9pZCAoKmV2aWN0X2lub2RlKSAoc3RydWN0IGlub2RlICopOwogdm9pZCAoKnB1dF9z
dXBlcikgKHN0cnVjdCBzdXBlcl9ibG9jayAqKTsKIGludCAoKnN5bmNfZnMpKHN0cnVjdCBz
dXBlcl9ibG9jayAqc2IsIGludCB3YWl0KTsKIGludCAoKmZyZWV6ZV9zdXBlcikgKHN0cnVj
dCBzdXBlcl9ibG9jayAqKTsKIGludCAoKmZyZWV6ZV9mcykgKHN0cnVjdCBzdXBlcl9ibG9j
ayAqKTsKIGludCAoKnRoYXdfc3VwZXIpIChzdHJ1Y3Qgc3VwZXJfYmxvY2sgKik7CiBpbnQg
KCp1bmZyZWV6ZV9mcykgKHN0cnVjdCBzdXBlcl9ibG9jayAqKTsKIGludCAoKnN0YXRmcykg
KHN0cnVjdCBkZW50cnkgKiwgc3RydWN0IGtzdGF0ZnMgKik7CiBpbnQgKCpyZW1vdW50X2Zz
KSAoc3RydWN0IHN1cGVyX2Jsb2NrICosIGludCAqLCBjaGFyICopOwogdm9pZCAoKnVtb3Vu
dF9iZWdpbikgKHN0cnVjdCBzdXBlcl9ibG9jayAqKTsKCiBpbnQgKCpzaG93X29wdGlvbnMp
KHN0cnVjdCBzZXFfZmlsZSAqLCBzdHJ1Y3QgZGVudHJ5ICopOwogaW50ICgqc2hvd19kZXZu
YW1lKShzdHJ1Y3Qgc2VxX2ZpbGUgKiwgc3RydWN0IGRlbnRyeSAqKTsKIGludCAoKnNob3df
cGF0aCkoc3RydWN0IHNlcV9maWxlICosIHN0cnVjdCBkZW50cnkgKik7CiBpbnQgKCpzaG93
X3N0YXRzKShzdHJ1Y3Qgc2VxX2ZpbGUgKiwgc3RydWN0IGRlbnRyeSAqKTsKCgoKCgogaW50
ICgqYmRldl90cnlfdG9fZnJlZV9wYWdlKShzdHJ1Y3Qgc3VwZXJfYmxvY2sqLCBzdHJ1Y3Qg
cGFnZSosIGdmcF90KTsKIGxvbmcgKCpucl9jYWNoZWRfb2JqZWN0cykoc3RydWN0IHN1cGVy
X2Jsb2NrICosCiAgICAgIHN0cnVjdCBzaHJpbmtfY29udHJvbCAqKTsKIGxvbmcgKCpmcmVl
X2NhY2hlZF9vYmplY3RzKShzdHJ1Y3Qgc3VwZXJfYmxvY2sgKiwKICAgICAgICBzdHJ1Y3Qg
c2hyaW5rX2NvbnRyb2wgKik7Cn07CiMgMjAyMiAiLi9pbmNsdWRlL2xpbnV4L2ZzLmgiCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSBib29sIHNiX3Jkb25seShjb25zdCBzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiKSB7
IHJldHVybiBzYi0+c19mbGFncyAmIDE7IH0KIyAyMDUyICIuL2luY2x1ZGUvbGludXgvZnMu
aCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIGJvb2wgSEFTX1VOTUFQUEVEX0lEKHN0cnVjdCBpbm9kZSAqaW5vZGUp
CnsKIHJldHVybiAhdWlkX3ZhbGlkKGlub2RlLT5pX3VpZCkgfHwgIWdpZF92YWxpZChpbm9k
ZS0+aV9naWQpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgZW51bSByd19oaW50IGZpbGVfd3JpdGVfaGludChz
dHJ1Y3QgZmlsZSAqZmlsZSkKewogaWYgKGZpbGUtPmZfd3JpdGVfaGludCAhPSBXUklURV9M
SUZFX05PVF9TRVQpCiAgcmV0dXJuIGZpbGUtPmZfd3JpdGVfaGludDsKCiByZXR1cm4gZmls
ZV9pbm9kZShmaWxlKS0+aV93cml0ZV9oaW50Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGlvY2JfZmxh
Z3Moc3RydWN0IGZpbGUgKmZpbGUpOwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHUxNiBraV9oaW50X3ZhbGlkYXRl
KGVudW0gcndfaGludCBoaW50KQp7CiB0eXBlb2YoKChzdHJ1Y3Qga2lvY2IgKikwKS0+a2lf
aGludCkgbWF4X2hpbnQgPSAtMTsKCiBpZiAoaGludCA8PSBtYXhfaGludCkKICByZXR1cm4g
aGludDsKIHJldHVybiAwOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBpbml0X3N5bmNfa2lvY2Ioc3Ry
dWN0IGtpb2NiICpraW9jYiwgc3RydWN0IGZpbGUgKmZpbHApCnsKICpraW9jYiA9IChzdHJ1
Y3Qga2lvY2IpIHsKICAua2lfZmlscCA9IGZpbHAsCiAgLmtpX2ZsYWdzID0gaW9jYl9mbGFn
cyhmaWxwKSwKICAua2lfaGludCA9IGtpX2hpbnRfdmFsaWRhdGUoZmlsZV93cml0ZV9oaW50
KGZpbHApKSwKICAua2lfaW9wcmlvID0gZ2V0X2N1cnJlbnRfaW9wcmlvKCksCiB9Owp9Cgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgdm9pZCBraW9jYl9jbG9uZShzdHJ1Y3Qga2lvY2IgKmtpb2NiLCBzdHJ1Y3Qg
a2lvY2IgKmtpb2NiX3NyYywKICAgICAgICAgIHN0cnVjdCBmaWxlICpmaWxwKQp7CiAqa2lv
Y2IgPSAoc3RydWN0IGtpb2NiKSB7CiAgLmtpX2ZpbHAgPSBmaWxwLAogIC5raV9mbGFncyA9
IGtpb2NiX3NyYy0+a2lfZmxhZ3MsCiAgLmtpX2hpbnQgPSBraW9jYl9zcmMtPmtpX2hpbnQs
CiAgLmtpX2lvcHJpbyA9IGtpb2NiX3NyYy0+a2lfaW9wcmlvLAogIC5raV9wb3MgPSBraW9j
Yl9zcmMtPmtpX3BvcywKIH07Cn0KIyAyMTg5ICIuL2luY2x1ZGUvbGludXgvZnMuaCIKZXh0
ZXJuIHZvaWQgX19tYXJrX2lub2RlX2RpcnR5KHN0cnVjdCBpbm9kZSAqLCBpbnQpOwpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgdm9pZCBtYXJrX2lub2RlX2RpcnR5KHN0cnVjdCBpbm9kZSAqaW5vZGUpCnsKIF9f
bWFya19pbm9kZV9kaXJ0eShpbm9kZSwgKCgoMSA8PCAwKSB8ICgxIDw8IDEpKSB8ICgxIDw8
IDIpKSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIG1hcmtfaW5vZGVfZGlydHlfc3luYyhzdHJ1Y3Qg
aW5vZGUgKmlub2RlKQp7CiBfX21hcmtfaW5vZGVfZGlydHkoaW5vZGUsICgxIDw8IDApKTsK
fQoKZXh0ZXJuIHZvaWQgaW5jX25saW5rKHN0cnVjdCBpbm9kZSAqaW5vZGUpOwpleHRlcm4g
dm9pZCBkcm9wX25saW5rKHN0cnVjdCBpbm9kZSAqaW5vZGUpOwpleHRlcm4gdm9pZCBjbGVh
cl9ubGluayhzdHJ1Y3QgaW5vZGUgKmlub2RlKTsKZXh0ZXJuIHZvaWQgc2V0X25saW5rKHN0
cnVjdCBpbm9kZSAqaW5vZGUsIHVuc2lnbmVkIGludCBubGluayk7CgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9p
ZCBpbm9kZV9pbmNfbGlua19jb3VudChzdHJ1Y3QgaW5vZGUgKmlub2RlKQp7CiBpbmNfbmxp
bmsoaW5vZGUpOwogbWFya19pbm9kZV9kaXJ0eShpbm9kZSk7Cn0KCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lk
IGlub2RlX2RlY19saW5rX2NvdW50KHN0cnVjdCBpbm9kZSAqaW5vZGUpCnsKIGRyb3Bfbmxp
bmsoaW5vZGUpOwogbWFya19pbm9kZV9kaXJ0eShpbm9kZSk7Cn0KCmVudW0gZmlsZV90aW1l
X2ZsYWdzIHsKIFNfQVRJTUUgPSAxLAogU19NVElNRSA9IDIsCiBTX0NUSU1FID0gNCwKIFNf
VkVSU0lPTiA9IDgsCn07CgpleHRlcm4gYm9vbCBhdGltZV9uZWVkc191cGRhdGUoY29uc3Qg
c3RydWN0IHBhdGggKiwgc3RydWN0IGlub2RlICopOwpleHRlcm4gdm9pZCB0b3VjaF9hdGlt
ZShjb25zdCBzdHJ1Y3QgcGF0aCAqKTsKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgZmlsZV9hY2Nlc3NlZChz
dHJ1Y3QgZmlsZSAqZmlsZSkKewogaWYgKCEoZmlsZS0+Zl9mbGFncyAmIDAxMDAwMDAwKSkK
ICB0b3VjaF9hdGltZSgmZmlsZS0+Zl9wYXRoKTsKfQoKZXh0ZXJuIGludCBmaWxlX21vZGlm
aWVkKHN0cnVjdCBmaWxlICpmaWxlKTsKCmludCBzeW5jX2lub2RlKHN0cnVjdCBpbm9kZSAq
aW5vZGUsIHN0cnVjdCB3cml0ZWJhY2tfY29udHJvbCAqd2JjKTsKaW50IHN5bmNfaW5vZGVf
bWV0YWRhdGEoc3RydWN0IGlub2RlICppbm9kZSwgaW50IHdhaXQpOwoKc3RydWN0IGZpbGVf
c3lzdGVtX3R5cGUgewogY29uc3QgY2hhciAqbmFtZTsKIGludCBmc19mbGFnczsKCgoKCgoK
IGludCAoKmluaXRfZnNfY29udGV4dCkoc3RydWN0IGZzX2NvbnRleHQgKik7CiBjb25zdCBz
dHJ1Y3QgZnNfcGFyYW1ldGVyX3NwZWMgKnBhcmFtZXRlcnM7CiBzdHJ1Y3QgZGVudHJ5ICoo
Km1vdW50KSAoc3RydWN0IGZpbGVfc3lzdGVtX3R5cGUgKiwgaW50LAogICAgICAgICBjb25z
dCBjaGFyICosIHZvaWQgKik7CiB2b2lkICgqa2lsbF9zYikgKHN0cnVjdCBzdXBlcl9ibG9j
ayAqKTsKIHN0cnVjdCBtb2R1bGUgKm93bmVyOwogc3RydWN0IGZpbGVfc3lzdGVtX3R5cGUg
KiBuZXh0Owogc3RydWN0IGhsaXN0X2hlYWQgZnNfc3VwZXJzOwoKIHN0cnVjdCBsb2NrX2Ns
YXNzX2tleSBzX2xvY2tfa2V5Owogc3RydWN0IGxvY2tfY2xhc3Nfa2V5IHNfdW1vdW50X2tl
eTsKIHN0cnVjdCBsb2NrX2NsYXNzX2tleSBzX3Zmc19yZW5hbWVfa2V5Owogc3RydWN0IGxv
Y2tfY2xhc3Nfa2V5IHNfd3JpdGVyc19rZXlbKFNCX0ZSRUVaRV9DT01QTEVURSAtIDEpXTsK
CiBzdHJ1Y3QgbG9ja19jbGFzc19rZXkgaV9sb2NrX2tleTsKIHN0cnVjdCBsb2NrX2NsYXNz
X2tleSBpX211dGV4X2tleTsKIHN0cnVjdCBsb2NrX2NsYXNzX2tleSBpX211dGV4X2Rpcl9r
ZXk7Cn07CgoKCgpleHRlcm4gc3RydWN0IGRlbnRyeSAqbW91bnRfYmRldihzdHJ1Y3QgZmls
ZV9zeXN0ZW1fdHlwZSAqZnNfdHlwZSwKIGludCBmbGFncywgY29uc3QgY2hhciAqZGV2X25h
bWUsIHZvaWQgKmRhdGEsCiBpbnQgKCpmaWxsX3N1cGVyKShzdHJ1Y3Qgc3VwZXJfYmxvY2sg
Kiwgdm9pZCAqLCBpbnQpKTsKIyAyMjc5ICIuL2luY2x1ZGUvbGludXgvZnMuaCIKZXh0ZXJu
IHN0cnVjdCBkZW50cnkgKm1vdW50X3NpbmdsZShzdHJ1Y3QgZmlsZV9zeXN0ZW1fdHlwZSAq
ZnNfdHlwZSwKIGludCBmbGFncywgdm9pZCAqZGF0YSwKIGludCAoKmZpbGxfc3VwZXIpKHN0
cnVjdCBzdXBlcl9ibG9jayAqLCB2b2lkICosIGludCkpOwpleHRlcm4gc3RydWN0IGRlbnRy
eSAqbW91bnRfbm9kZXYoc3RydWN0IGZpbGVfc3lzdGVtX3R5cGUgKmZzX3R5cGUsCiBpbnQg
ZmxhZ3MsIHZvaWQgKmRhdGEsCiBpbnQgKCpmaWxsX3N1cGVyKShzdHJ1Y3Qgc3VwZXJfYmxv
Y2sgKiwgdm9pZCAqLCBpbnQpKTsKZXh0ZXJuIHN0cnVjdCBkZW50cnkgKm1vdW50X3N1YnRy
ZWUoc3RydWN0IHZmc21vdW50ICptbnQsIGNvbnN0IGNoYXIgKnBhdGgpOwp2b2lkIGdlbmVy
aWNfc2h1dGRvd25fc3VwZXIoc3RydWN0IHN1cGVyX2Jsb2NrICpzYik7Cgp2b2lkIGtpbGxf
YmxvY2tfc3VwZXIoc3RydWN0IHN1cGVyX2Jsb2NrICpzYik7CgoKCgoKCnZvaWQga2lsbF9h
bm9uX3N1cGVyKHN0cnVjdCBzdXBlcl9ibG9jayAqc2IpOwp2b2lkIGtpbGxfbGl0dGVyX3N1
cGVyKHN0cnVjdCBzdXBlcl9ibG9jayAqc2IpOwp2b2lkIGRlYWN0aXZhdGVfc3VwZXIoc3Ry
dWN0IHN1cGVyX2Jsb2NrICpzYik7CnZvaWQgZGVhY3RpdmF0ZV9sb2NrZWRfc3VwZXIoc3Ry
dWN0IHN1cGVyX2Jsb2NrICpzYik7CmludCBzZXRfYW5vbl9zdXBlcihzdHJ1Y3Qgc3VwZXJf
YmxvY2sgKnMsIHZvaWQgKmRhdGEpOwppbnQgc2V0X2Fub25fc3VwZXJfZmMoc3RydWN0IHN1
cGVyX2Jsb2NrICpzLCBzdHJ1Y3QgZnNfY29udGV4dCAqZmMpOwppbnQgZ2V0X2Fub25fYmRl
dihkZXZfdCAqKTsKdm9pZCBmcmVlX2Fub25fYmRldihkZXZfdCk7CnN0cnVjdCBzdXBlcl9i
bG9jayAqc2dldF9mYyhzdHJ1Y3QgZnNfY29udGV4dCAqZmMsCiAgICAgICBpbnQgKCp0ZXN0
KShzdHJ1Y3Qgc3VwZXJfYmxvY2sgKiwgc3RydWN0IGZzX2NvbnRleHQgKiksCiAgICAgICBp
bnQgKCpzZXQpKHN0cnVjdCBzdXBlcl9ibG9jayAqLCBzdHJ1Y3QgZnNfY29udGV4dCAqKSk7
CnN0cnVjdCBzdXBlcl9ibG9jayAqc2dldChzdHJ1Y3QgZmlsZV9zeXN0ZW1fdHlwZSAqdHlw
ZSwKICAgaW50ICgqdGVzdCkoc3RydWN0IHN1cGVyX2Jsb2NrICosdm9pZCAqKSwKICAgaW50
ICgqc2V0KShzdHJ1Y3Qgc3VwZXJfYmxvY2sgKix2b2lkICopLAogICBpbnQgZmxhZ3MsIHZv
aWQgKmRhdGEpOwojIDIzMjggIi4vaW5jbHVkZS9saW51eC9mcy5oIgpleHRlcm4gaW50IHJl
Z2lzdGVyX2ZpbGVzeXN0ZW0oc3RydWN0IGZpbGVfc3lzdGVtX3R5cGUgKik7CmV4dGVybiBp
bnQgdW5yZWdpc3Rlcl9maWxlc3lzdGVtKHN0cnVjdCBmaWxlX3N5c3RlbV90eXBlICopOwpl
eHRlcm4gc3RydWN0IHZmc21vdW50ICprZXJuX21vdW50KHN0cnVjdCBmaWxlX3N5c3RlbV90
eXBlICopOwpleHRlcm4gdm9pZCBrZXJuX3VubW91bnQoc3RydWN0IHZmc21vdW50ICptbnQp
OwpleHRlcm4gaW50IG1heV91bW91bnRfdHJlZShzdHJ1Y3QgdmZzbW91bnQgKik7CmV4dGVy
biBpbnQgbWF5X3Vtb3VudChzdHJ1Y3QgdmZzbW91bnQgKik7CmV4dGVybiBsb25nIGRvX21v
dW50KGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLAogICAgICAgY29uc3QgY2hhciAqLCB1
bnNpZ25lZCBsb25nLCB2b2lkICopOwpleHRlcm4gc3RydWN0IHZmc21vdW50ICpjb2xsZWN0
X21vdW50cyhjb25zdCBzdHJ1Y3QgcGF0aCAqKTsKZXh0ZXJuIHZvaWQgZHJvcF9jb2xsZWN0
ZWRfbW91bnRzKHN0cnVjdCB2ZnNtb3VudCAqKTsKZXh0ZXJuIGludCBpdGVyYXRlX21vdW50
cyhpbnQgKCopKHN0cnVjdCB2ZnNtb3VudCAqLCB2b2lkICopLCB2b2lkICosCiAgICAgc3Ry
dWN0IHZmc21vdW50ICopOwpleHRlcm4gaW50IHZmc19zdGF0ZnMoY29uc3Qgc3RydWN0IHBh
dGggKiwgc3RydWN0IGtzdGF0ZnMgKik7CmV4dGVybiBpbnQgdXNlcl9zdGF0ZnMoY29uc3Qg
Y2hhciAqLCBzdHJ1Y3Qga3N0YXRmcyAqKTsKZXh0ZXJuIGludCBmZF9zdGF0ZnMoaW50LCBz
dHJ1Y3Qga3N0YXRmcyAqKTsKZXh0ZXJuIGludCBmcmVlemVfc3VwZXIoc3RydWN0IHN1cGVy
X2Jsb2NrICpzdXBlcik7CmV4dGVybiBpbnQgdGhhd19zdXBlcihzdHJ1Y3Qgc3VwZXJfYmxv
Y2sgKnN1cGVyKTsKZXh0ZXJuIGJvb2wgb3VyX21udChzdHJ1Y3QgdmZzbW91bnQgKm1udCk7
CmV4dGVybiBfX2F0dHJpYnV0ZV9fKChfX2Zvcm1hdF9fKHByaW50ZiwgMiwgMykpKQppbnQg
c3VwZXJfc2V0dXBfYmRpX25hbWUoc3RydWN0IHN1cGVyX2Jsb2NrICpzYiwgY2hhciAqZm10
LCAuLi4pOwpleHRlcm4gaW50IHN1cGVyX3NldHVwX2JkaShzdHJ1Y3Qgc3VwZXJfYmxvY2sg
KnNiKTsKCmV4dGVybiBpbnQgY3VycmVudF91bWFzayh2b2lkKTsKCmV4dGVybiB2b2lkIGlo
b2xkKHN0cnVjdCBpbm9kZSAqIGlub2RlKTsKZXh0ZXJuIHZvaWQgaXB1dChzdHJ1Y3QgaW5v
ZGUgKik7CmV4dGVybiBpbnQgZ2VuZXJpY191cGRhdGVfdGltZShzdHJ1Y3QgaW5vZGUgKiwg
c3RydWN0IHRpbWVzcGVjNjQgKiwgaW50KTsKCgpleHRlcm4gc3RydWN0IGtvYmplY3QgKmZz
X2tvYmo7CgoKCgpleHRlcm4gaW50IGxvY2tzX21hbmRhdG9yeV9sb2NrZWQoc3RydWN0IGZp
bGUgKik7CmV4dGVybiBpbnQgbG9ja3NfbWFuZGF0b3J5X2FyZWEoc3RydWN0IGlub2RlICos
IHN0cnVjdCBmaWxlICosIGxvZmZfdCwgbG9mZl90LCB1bnNpZ25lZCBjaGFyKTsKCgoKCgoK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIGludCBfX21hbmRhdG9yeV9sb2NrKHN0cnVjdCBpbm9kZSAqaW5vKQp7CiBy
ZXR1cm4gKGluby0+aV9tb2RlICYgKDAwMDIwMDAgfCAwMDAxMCkpID09IDAwMDIwMDA7Cn0K
CgoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIGludCBtYW5kYXRvcnlfbG9jayhzdHJ1Y3QgaW5vZGUgKmlubykK
ewogcmV0dXJuICgoaW5vKS0+aV9zYi0+c19mbGFncyAmICg2NCkpICYmIF9fbWFuZGF0b3J5
X2xvY2soaW5vKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBsb2Nrc192ZXJpZnlfbG9ja2VkKHN0cnVj
dCBmaWxlICpmaWxlKQp7CiBpZiAobWFuZGF0b3J5X2xvY2soZmlsZV9pbm9kZShmaWxlKSkp
CiAgcmV0dXJuIGxvY2tzX21hbmRhdG9yeV9sb2NrZWQoZmlsZSk7CiByZXR1cm4gMDsKfQoK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIGludCBsb2Nrc192ZXJpZnlfdHJ1bmNhdGUoc3RydWN0IGlub2RlICppbm9k
ZSwKICAgICAgICBzdHJ1Y3QgZmlsZSAqZiwKICAgICAgICBsb2ZmX3Qgc2l6ZSkKewogaWYg
KCFpbm9kZS0+aV9mbGN0eCB8fCAhbWFuZGF0b3J5X2xvY2soaW5vZGUpKQogIHJldHVybiAw
OwoKIGlmIChzaXplIDwgaW5vZGUtPmlfc2l6ZSkgewogIHJldHVybiBsb2Nrc19tYW5kYXRv
cnlfYXJlYShpbm9kZSwgZiwgc2l6ZSwgaW5vZGUtPmlfc2l6ZSAtIDEsCiAgICAxKTsKIH0g
ZWxzZSB7CiAgcmV0dXJuIGxvY2tzX21hbmRhdG9yeV9hcmVhKGlub2RlLCBmLCBpbm9kZS0+
aV9zaXplLCBzaXplIC0gMSwKICAgIDEpOwogfQp9CiMgMjQ0NiAiLi9pbmNsdWRlL2xpbnV4
L2ZzLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSBpbnQgYnJlYWtfbGVhc2Uoc3RydWN0IGlub2RlICppbm9kZSwg
dW5zaWduZWQgaW50IG1vZGUpCnsKCgoKCgoKIF9fYXNtX18gX192b2xhdGlsZV9fICgic3lu
YyIgOiA6IDogIm1lbW9yeSIpOwogaWYgKGlub2RlLT5pX2ZsY3R4ICYmICFsaXN0X2VtcHR5
X2NhcmVmdWwoJmlub2RlLT5pX2ZsY3R4LT5mbGNfbGVhc2UpKQogIHJldHVybiBfX2JyZWFr
X2xlYXNlKGlub2RlLCBtb2RlLCAzMik7CiByZXR1cm4gMDsKfQoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBi
cmVha19kZWxlZyhzdHJ1Y3QgaW5vZGUgKmlub2RlLCB1bnNpZ25lZCBpbnQgbW9kZSkKewoK
CgoKCgogX19hc21fXyBfX3ZvbGF0aWxlX18gKCJzeW5jIiA6IDogOiAibWVtb3J5Iik7CiBp
ZiAoaW5vZGUtPmlfZmxjdHggJiYgIWxpc3RfZW1wdHlfY2FyZWZ1bCgmaW5vZGUtPmlfZmxj
dHgtPmZsY19sZWFzZSkpCiAgcmV0dXJuIF9fYnJlYWtfbGVhc2UoaW5vZGUsIG1vZGUsIDQp
OwogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgdHJ5X2JyZWFrX2RlbGVnKHN0cnVjdCBp
bm9kZSAqaW5vZGUsIHN0cnVjdCBpbm9kZSAqKmRlbGVnYXRlZF9pbm9kZSkKewogaW50IHJl
dDsKCiByZXQgPSBicmVha19kZWxlZyhpbm9kZSwgMDAwMDAwMDF8MDAwMDQwMDApOwogaWYg
KHJldCA9PSAtMTEgJiYgZGVsZWdhdGVkX2lub2RlKSB7CiAgKmRlbGVnYXRlZF9pbm9kZSA9
IGlub2RlOwogIGlob2xkKGlub2RlKTsKIH0KIHJldHVybiByZXQ7Cn0KCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBp
bnQgYnJlYWtfZGVsZWdfd2FpdChzdHJ1Y3QgaW5vZGUgKipkZWxlZ2F0ZWRfaW5vZGUpCnsK
IGludCByZXQ7CgogcmV0ID0gYnJlYWtfZGVsZWcoKmRlbGVnYXRlZF9pbm9kZSwgMDAwMDAw
MDEpOwogaXB1dCgqZGVsZWdhdGVkX2lub2RlKTsKICpkZWxlZ2F0ZWRfaW5vZGUgPSAoKHZv
aWQgKikwKTsKIHJldHVybiByZXQ7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgYnJlYWtfbGF5b3V0KHN0
cnVjdCBpbm9kZSAqaW5vZGUsIGJvb2wgd2FpdCkKewogX19hc21fXyBfX3ZvbGF0aWxlX18g
KCJzeW5jIiA6IDogOiAibWVtb3J5Iik7CiBpZiAoaW5vZGUtPmlfZmxjdHggJiYgIWxpc3Rf
ZW1wdHlfY2FyZWZ1bCgmaW5vZGUtPmlfZmxjdHgtPmZsY19sZWFzZSkpCiAgcmV0dXJuIF9f
YnJlYWtfbGVhc2UoaW5vZGUsCiAgICB3YWl0ID8gMDAwMDAwMDEgOiAwMDAwMDAwMSB8IDAw
MDA0MDAwLAogICAgMjA0OCk7CiByZXR1cm4gMDsKfQojIDI1MzYgIi4vaW5jbHVkZS9saW51
eC9mcy5oIgpzdHJ1Y3QgYXVkaXRfbmFtZXM7CnN0cnVjdCBmaWxlbmFtZSB7CiBjb25zdCBj
aGFyICpuYW1lOwogY29uc3QgY2hhciAqdXB0cjsKIGludCByZWZjbnQ7CiBzdHJ1Y3QgYXVk
aXRfbmFtZXMgKmFuYW1lOwogY29uc3QgY2hhciBpbmFtZVtdOwp9OwpfU3RhdGljX2Fzc2Vy
dChfX2J1aWx0aW5fb2Zmc2V0b2Yoc3RydWN0IGZpbGVuYW1lLCBpbmFtZSkgJSBzaXplb2Yo
bG9uZykgPT0gMCwgIm9mZnNldG9mKHN0cnVjdCBmaWxlbmFtZSwgaW5hbWUpICUgc2l6ZW9m
KGxvbmcpID09IDAiKTsKCmV4dGVybiBsb25nIHZmc190cnVuY2F0ZShjb25zdCBzdHJ1Y3Qg
cGF0aCAqLCBsb2ZmX3QpOwpleHRlcm4gaW50IGRvX3RydW5jYXRlKHN0cnVjdCBkZW50cnkg
KiwgbG9mZl90IHN0YXJ0LCB1bnNpZ25lZCBpbnQgdGltZV9hdHRycywKICAgICAgICAgc3Ry
dWN0IGZpbGUgKmZpbHApOwpleHRlcm4gaW50IHZmc19mYWxsb2NhdGUoc3RydWN0IGZpbGUg
KmZpbGUsIGludCBtb2RlLCBsb2ZmX3Qgb2Zmc2V0LAogICBsb2ZmX3QgbGVuKTsKZXh0ZXJu
IGxvbmcgZG9fc3lzX29wZW4oaW50IGRmZCwgY29uc3QgY2hhciAqZmlsZW5hbWUsIGludCBm
bGFncywKICAgdW1vZGVfdCBtb2RlKTsKZXh0ZXJuIHN0cnVjdCBmaWxlICpmaWxlX29wZW5f
bmFtZShzdHJ1Y3QgZmlsZW5hbWUgKiwgaW50LCB1bW9kZV90KTsKZXh0ZXJuIHN0cnVjdCBm
aWxlICpmaWxwX29wZW4oY29uc3QgY2hhciAqLCBpbnQsIHVtb2RlX3QpOwpleHRlcm4gc3Ry
dWN0IGZpbGUgKmZpbGVfb3Blbl9yb290KHN0cnVjdCBkZW50cnkgKiwgc3RydWN0IHZmc21v
dW50ICosCiAgICAgICBjb25zdCBjaGFyICosIGludCwgdW1vZGVfdCk7CmV4dGVybiBzdHJ1
Y3QgZmlsZSAqIGRlbnRyeV9vcGVuKGNvbnN0IHN0cnVjdCBwYXRoICosIGludCwgY29uc3Qg
c3RydWN0IGNyZWQgKik7CmV4dGVybiBzdHJ1Y3QgZmlsZSAqIG9wZW5fd2l0aF9mYWtlX3Bh
dGgoY29uc3Qgc3RydWN0IHBhdGggKiwgaW50LAogICAgICBzdHJ1Y3QgaW5vZGUqLCBjb25z
dCBzdHJ1Y3QgY3JlZCAqKTsKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHN0cnVjdCBmaWxlICpmaWxlX2Nsb25lX29w
ZW4oc3RydWN0IGZpbGUgKmZpbGUpCnsKIHJldHVybiBkZW50cnlfb3BlbigmZmlsZS0+Zl9w
YXRoLCBmaWxlLT5mX2ZsYWdzLCBmaWxlLT5mX2NyZWQpOwp9CmV4dGVybiBpbnQgZmlscF9j
bG9zZShzdHJ1Y3QgZmlsZSAqLCBmbF9vd25lcl90IGlkKTsKCmV4dGVybiBzdHJ1Y3QgZmls
ZW5hbWUgKmdldG5hbWVfZmxhZ3MoY29uc3QgY2hhciAqLCBpbnQsIGludCAqKTsKZXh0ZXJu
IHN0cnVjdCBmaWxlbmFtZSAqZ2V0bmFtZShjb25zdCBjaGFyICopOwpleHRlcm4gc3RydWN0
IGZpbGVuYW1lICpnZXRuYW1lX2tlcm5lbChjb25zdCBjaGFyICopOwpleHRlcm4gdm9pZCBw
dXRuYW1lKHN0cnVjdCBmaWxlbmFtZSAqbmFtZSk7CgpleHRlcm4gaW50IGZpbmlzaF9vcGVu
KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgZGVudHJ5ICpkZW50cnksCiAgIGludCAoKm9w
ZW4pKHN0cnVjdCBpbm9kZSAqLCBzdHJ1Y3QgZmlsZSAqKSk7CmV4dGVybiBpbnQgZmluaXNo
X25vX29wZW4oc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCBkZW50cnkgKmRlbnRyeSk7CgoK
ZXh0ZXJuIHZvaWQgX19hdHRyaWJ1dGVfXygoX19zZWN0aW9uX18oIi5pbml0LnRleHQiKSkp
IF9fYXR0cmlidXRlX18oKF9fY29sZF9fKSkgdmZzX2NhY2hlc19pbml0X2Vhcmx5KHZvaWQp
OwpleHRlcm4gdm9pZCBfX2F0dHJpYnV0ZV9fKChfX3NlY3Rpb25fXygiLmluaXQudGV4dCIp
KSkgX19hdHRyaWJ1dGVfXygoX19jb2xkX18pKSB2ZnNfY2FjaGVzX2luaXQodm9pZCk7Cgpl
eHRlcm4gc3RydWN0IGttZW1fY2FjaGUgKm5hbWVzX2NhY2hlcDsKCgoKCgpleHRlcm4gaW50
IHJlZ2lzdGVyX2Jsa2Rldih1bnNpZ25lZCBpbnQsIGNvbnN0IGNoYXIgKik7CmV4dGVybiB2
b2lkIHVucmVnaXN0ZXJfYmxrZGV2KHVuc2lnbmVkIGludCwgY29uc3QgY2hhciAqKTsKZXh0
ZXJuIHN0cnVjdCBibG9ja19kZXZpY2UgKmJkZ2V0KGRldl90KTsKZXh0ZXJuIHN0cnVjdCBi
bG9ja19kZXZpY2UgKmJkZ3JhYihzdHJ1Y3QgYmxvY2tfZGV2aWNlICpiZGV2KTsKZXh0ZXJu
IHZvaWQgYmRfc2V0X3NpemUoc3RydWN0IGJsb2NrX2RldmljZSAqLCBsb2ZmX3Qgc2l6ZSk7
CmV4dGVybiB2b2lkIGJkX2ZvcmdldChzdHJ1Y3QgaW5vZGUgKmlub2RlKTsKZXh0ZXJuIHZv
aWQgYmRwdXQoc3RydWN0IGJsb2NrX2RldmljZSAqKTsKZXh0ZXJuIHZvaWQgaW52YWxpZGF0
ZV9iZGV2KHN0cnVjdCBibG9ja19kZXZpY2UgKik7CmV4dGVybiB2b2lkIGl0ZXJhdGVfYmRl
dnModm9pZCAoKikoc3RydWN0IGJsb2NrX2RldmljZSAqLCB2b2lkICopLCB2b2lkICopOwpl
eHRlcm4gaW50IHN5bmNfYmxvY2tkZXYoc3RydWN0IGJsb2NrX2RldmljZSAqYmRldik7CmV4
dGVybiBzdHJ1Y3Qgc3VwZXJfYmxvY2sgKmZyZWV6ZV9iZGV2KHN0cnVjdCBibG9ja19kZXZp
Y2UgKik7CmV4dGVybiB2b2lkIGVtZXJnZW5jeV90aGF3X2FsbCh2b2lkKTsKZXh0ZXJuIHZv
aWQgZW1lcmdlbmN5X3RoYXdfYmRldihzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiKTsKZXh0ZXJu
IGludCB0aGF3X2JkZXYoc3RydWN0IGJsb2NrX2RldmljZSAqYmRldiwgc3RydWN0IHN1cGVy
X2Jsb2NrICpzYik7CmV4dGVybiBpbnQgZnN5bmNfYmRldihzdHJ1Y3QgYmxvY2tfZGV2aWNl
ICopOwoKZXh0ZXJuIHN0cnVjdCBzdXBlcl9ibG9jayAqYmxvY2tkZXZfc3VwZXJibG9jazsK
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSBib29sIHNiX2lzX2Jsa2Rldl9zYihzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNi
KQp7CiByZXR1cm4gc2IgPT0gYmxvY2tkZXZfc3VwZXJibG9jazsKfQojIDI2MzYgIi4vaW5j
bHVkZS9saW51eC9mcy5oIgpleHRlcm4gaW50IHN5bmNfZmlsZXN5c3RlbShzdHJ1Y3Qgc3Vw
ZXJfYmxvY2sgKik7CmV4dGVybiBjb25zdCBzdHJ1Y3QgZmlsZV9vcGVyYXRpb25zIGRlZl9i
bGtfZm9wczsKZXh0ZXJuIGNvbnN0IHN0cnVjdCBmaWxlX29wZXJhdGlvbnMgZGVmX2Nocl9m
b3BzOwoKZXh0ZXJuIGludCBibGtkZXZfaW9jdGwoc3RydWN0IGJsb2NrX2RldmljZSAqLCBm
bW9kZV90LCB1bnNpZ25lZCwgdW5zaWduZWQgbG9uZyk7CmV4dGVybiBsb25nIGNvbXBhdF9i
bGtkZXZfaW9jdGwoc3RydWN0IGZpbGUgKiwgdW5zaWduZWQsIHVuc2lnbmVkIGxvbmcpOwpl
eHRlcm4gaW50IGJsa2Rldl9nZXQoc3RydWN0IGJsb2NrX2RldmljZSAqYmRldiwgZm1vZGVf
dCBtb2RlLCB2b2lkICpob2xkZXIpOwpleHRlcm4gc3RydWN0IGJsb2NrX2RldmljZSAqYmxr
ZGV2X2dldF9ieV9wYXRoKGNvbnN0IGNoYXIgKnBhdGgsIGZtb2RlX3QgbW9kZSwKICAgICAg
ICAgICAgdm9pZCAqaG9sZGVyKTsKZXh0ZXJuIHN0cnVjdCBibG9ja19kZXZpY2UgKmJsa2Rl
dl9nZXRfYnlfZGV2KGRldl90IGRldiwgZm1vZGVfdCBtb2RlLAogICAgICAgICAgIHZvaWQg
KmhvbGRlcik7CmV4dGVybiBzdHJ1Y3QgYmxvY2tfZGV2aWNlICpiZF9zdGFydF9jbGFpbWlu
ZyhzdHJ1Y3QgYmxvY2tfZGV2aWNlICpiZGV2LAogICAgICAgICAgIHZvaWQgKmhvbGRlcik7
CmV4dGVybiB2b2lkIGJkX2ZpbmlzaF9jbGFpbWluZyhzdHJ1Y3QgYmxvY2tfZGV2aWNlICpi
ZGV2LAogICAgICAgICAgc3RydWN0IGJsb2NrX2RldmljZSAqd2hvbGUsIHZvaWQgKmhvbGRl
cik7CmV4dGVybiB2b2lkIGJkX2Fib3J0X2NsYWltaW5nKHN0cnVjdCBibG9ja19kZXZpY2Ug
KmJkZXYsCiAgICAgICAgIHN0cnVjdCBibG9ja19kZXZpY2UgKndob2xlLCB2b2lkICpob2xk
ZXIpOwpleHRlcm4gdm9pZCBibGtkZXZfcHV0KHN0cnVjdCBibG9ja19kZXZpY2UgKmJkZXYs
IGZtb2RlX3QgbW9kZSk7CgoKZXh0ZXJuIGludCBiZF9saW5rX2Rpc2tfaG9sZGVyKHN0cnVj
dCBibG9ja19kZXZpY2UgKmJkZXYsIHN0cnVjdCBnZW5kaXNrICpkaXNrKTsKZXh0ZXJuIHZv
aWQgYmRfdW5saW5rX2Rpc2tfaG9sZGVyKHN0cnVjdCBibG9ja19kZXZpY2UgKmJkZXYsCiAg
ICAgIHN0cnVjdCBnZW5kaXNrICpkaXNrKTsKIyAyNjgwICIuL2luY2x1ZGUvbGludXgvZnMu
aCIKZXh0ZXJuIGludCBhbGxvY19jaHJkZXZfcmVnaW9uKGRldl90ICosIHVuc2lnbmVkLCB1
bnNpZ25lZCwgY29uc3QgY2hhciAqKTsKZXh0ZXJuIGludCByZWdpc3Rlcl9jaHJkZXZfcmVn
aW9uKGRldl90LCB1bnNpZ25lZCwgY29uc3QgY2hhciAqKTsKZXh0ZXJuIGludCBfX3JlZ2lz
dGVyX2NocmRldih1bnNpZ25lZCBpbnQgbWFqb3IsIHVuc2lnbmVkIGludCBiYXNlbWlub3Is
CiAgICAgICAgdW5zaWduZWQgaW50IGNvdW50LCBjb25zdCBjaGFyICpuYW1lLAogICAgICAg
IGNvbnN0IHN0cnVjdCBmaWxlX29wZXJhdGlvbnMgKmZvcHMpOwpleHRlcm4gdm9pZCBfX3Vu
cmVnaXN0ZXJfY2hyZGV2KHVuc2lnbmVkIGludCBtYWpvciwgdW5zaWduZWQgaW50IGJhc2Vt
aW5vciwKICAgIHVuc2lnbmVkIGludCBjb3VudCwgY29uc3QgY2hhciAqbmFtZSk7CmV4dGVy
biB2b2lkIHVucmVnaXN0ZXJfY2hyZGV2X3JlZ2lvbihkZXZfdCwgdW5zaWduZWQpOwpleHRl
cm4gdm9pZCBjaHJkZXZfc2hvdyhzdHJ1Y3Qgc2VxX2ZpbGUgKixvZmZfdCk7CgpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgaW50IHJlZ2lzdGVyX2NocmRldih1bnNpZ25lZCBpbnQgbWFqb3IsIGNvbnN0IGNoYXIg
Km5hbWUsCiAgICAgIGNvbnN0IHN0cnVjdCBmaWxlX29wZXJhdGlvbnMgKmZvcHMpCnsKIHJl
dHVybiBfX3JlZ2lzdGVyX2NocmRldihtYWpvciwgMCwgMjU2LCBuYW1lLCBmb3BzKTsKfQoK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIHZvaWQgdW5yZWdpc3Rlcl9jaHJkZXYodW5zaWduZWQgaW50IG1ham9yLCBj
b25zdCBjaGFyICpuYW1lKQp7CiBfX3VucmVnaXN0ZXJfY2hyZGV2KG1ham9yLCAwLCAyNTYs
IG5hbWUpOwp9CgoKCgoKCgpleHRlcm4gY29uc3QgY2hhciAqYmRldm5hbWUoc3RydWN0IGJs
b2NrX2RldmljZSAqYmRldiwgY2hhciAqYnVmZmVyKTsKZXh0ZXJuIHN0cnVjdCBibG9ja19k
ZXZpY2UgKmxvb2t1cF9iZGV2KGNvbnN0IGNoYXIgKik7CmV4dGVybiB2b2lkIGJsa2Rldl9z
aG93KHN0cnVjdCBzZXFfZmlsZSAqLG9mZl90KTsKCgoKCgpleHRlcm4gdm9pZCBpbml0X3Nw
ZWNpYWxfaW5vZGUoc3RydWN0IGlub2RlICosIHVtb2RlX3QsIGRldl90KTsKCgpleHRlcm4g
dm9pZCBtYWtlX2JhZF9pbm9kZShzdHJ1Y3QgaW5vZGUgKik7CmV4dGVybiBib29sIGlzX2Jh
ZF9pbm9kZShzdHJ1Y3QgaW5vZGUgKik7CgoKZXh0ZXJuIGludCByZXZhbGlkYXRlX2Rpc2so
c3RydWN0IGdlbmRpc2sgKik7CmV4dGVybiBpbnQgY2hlY2tfZGlza19jaGFuZ2Uoc3RydWN0
IGJsb2NrX2RldmljZSAqKTsKZXh0ZXJuIGludCBfX2ludmFsaWRhdGVfZGV2aWNlKHN0cnVj
dCBibG9ja19kZXZpY2UgKiwgYm9vbCk7Cgp1bnNpZ25lZCBsb25nIGludmFsaWRhdGVfbWFw
cGluZ19wYWdlcyhzdHJ1Y3QgYWRkcmVzc19zcGFjZSAqbWFwcGluZywKICAgICB1bnNpZ25l
ZCBsb25nIHN0YXJ0LCB1bnNpZ25lZCBsb25nIGVuZCk7CgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBpbnZh
bGlkYXRlX3JlbW90ZV9pbm9kZShzdHJ1Y3QgaW5vZGUgKmlub2RlKQp7CiBpZiAoKCgoaW5v
ZGUtPmlfbW9kZSkgJiAwMDE3MDAwMCkgPT0gMDEwMDAwMCkgfHwgKCgoaW5vZGUtPmlfbW9k
ZSkgJiAwMDE3MDAwMCkgPT0gMDA0MDAwMCkgfHwKICAgICAoKChpbm9kZS0+aV9tb2RlKSAm
IDAwMTcwMDAwKSA9PSAwMTIwMDAwKSkKICBpbnZhbGlkYXRlX21hcHBpbmdfcGFnZXMoaW5v
ZGUtPmlfbWFwcGluZywgMCwgLTEpOwp9CmV4dGVybiBpbnQgaW52YWxpZGF0ZV9pbm9kZV9w
YWdlczIoc3RydWN0IGFkZHJlc3Nfc3BhY2UgKm1hcHBpbmcpOwpleHRlcm4gaW50IGludmFs
aWRhdGVfaW5vZGVfcGFnZXMyX3JhbmdlKHN0cnVjdCBhZGRyZXNzX3NwYWNlICptYXBwaW5n
LAogICAgICB1bnNpZ25lZCBsb25nIHN0YXJ0LCB1bnNpZ25lZCBsb25nIGVuZCk7CmV4dGVy
biBpbnQgd3JpdGVfaW5vZGVfbm93KHN0cnVjdCBpbm9kZSAqLCBpbnQpOwpleHRlcm4gaW50
IGZpbGVtYXBfZmRhdGF3cml0ZShzdHJ1Y3QgYWRkcmVzc19zcGFjZSAqKTsKZXh0ZXJuIGlu
dCBmaWxlbWFwX2ZsdXNoKHN0cnVjdCBhZGRyZXNzX3NwYWNlICopOwpleHRlcm4gaW50IGZp
bGVtYXBfZmRhdGF3YWl0X2tlZXBfZXJyb3JzKHN0cnVjdCBhZGRyZXNzX3NwYWNlICptYXBw
aW5nKTsKZXh0ZXJuIGludCBmaWxlbWFwX2ZkYXRhd2FpdF9yYW5nZShzdHJ1Y3QgYWRkcmVz
c19zcGFjZSAqLCBsb2ZmX3QgbHN0YXJ0LAogICAgICAgbG9mZl90IGxlbmQpOwpleHRlcm4g
aW50IGZpbGVtYXBfZmRhdGF3YWl0X3JhbmdlX2tlZXBfZXJyb3JzKHN0cnVjdCBhZGRyZXNz
X3NwYWNlICptYXBwaW5nLAogIGxvZmZfdCBzdGFydF9ieXRlLCBsb2ZmX3QgZW5kX2J5dGUp
OwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIGludCBmaWxlbWFwX2ZkYXRhd2FpdChzdHJ1Y3QgYWRkcmVzc19zcGFj
ZSAqbWFwcGluZykKewogcmV0dXJuIGZpbGVtYXBfZmRhdGF3YWl0X3JhbmdlKG1hcHBpbmcs
IDAsICgobG9uZyBsb25nKSh+MFVMTCA+PiAxKSkpOwp9CgpleHRlcm4gYm9vbCBmaWxlbWFw
X3JhbmdlX2hhc19wYWdlKHN0cnVjdCBhZGRyZXNzX3NwYWNlICosIGxvZmZfdCBsc3RhcnQs
CiAgICAgIGxvZmZfdCBsZW5kKTsKZXh0ZXJuIGludCBmaWxlbWFwX3dyaXRlX2FuZF93YWl0
X3JhbmdlKHN0cnVjdCBhZGRyZXNzX3NwYWNlICptYXBwaW5nLAogICAgICAgICAgICBsb2Zm
X3QgbHN0YXJ0LCBsb2ZmX3QgbGVuZCk7CmV4dGVybiBpbnQgX19maWxlbWFwX2ZkYXRhd3Jp
dGVfcmFuZ2Uoc3RydWN0IGFkZHJlc3Nfc3BhY2UgKm1hcHBpbmcsCiAgICBsb2ZmX3Qgc3Rh
cnQsIGxvZmZfdCBlbmQsIGludCBzeW5jX21vZGUpOwpleHRlcm4gaW50IGZpbGVtYXBfZmRh
dGF3cml0ZV9yYW5nZShzdHJ1Y3QgYWRkcmVzc19zcGFjZSAqbWFwcGluZywKICAgIGxvZmZf
dCBzdGFydCwgbG9mZl90IGVuZCk7CmV4dGVybiBpbnQgZmlsZW1hcF9jaGVja19lcnJvcnMo
c3RydWN0IGFkZHJlc3Nfc3BhY2UgKm1hcHBpbmcpOwpleHRlcm4gdm9pZCBfX2ZpbGVtYXBf
c2V0X3diX2VycihzdHJ1Y3QgYWRkcmVzc19zcGFjZSAqbWFwcGluZywgaW50IGVycik7Cgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgaW50IGZpbGVtYXBfd3JpdGVfYW5kX3dhaXQoc3RydWN0IGFkZHJlc3Nfc3Bh
Y2UgKm1hcHBpbmcpCnsKIHJldHVybiBmaWxlbWFwX3dyaXRlX2FuZF93YWl0X3JhbmdlKG1h
cHBpbmcsIDAsICgobG9uZyBsb25nKSh+MFVMTCA+PiAxKSkpOwp9CgpleHRlcm4gaW50IF9f
YXR0cmlidXRlX18oKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKSBmaWxlX2ZkYXRhd2FpdF9y
YW5nZShzdHJ1Y3QgZmlsZSAqZmlsZSwgbG9mZl90IGxzdGFydCwKICAgICAgbG9mZl90IGxl
bmQpOwpleHRlcm4gaW50IF9fYXR0cmlidXRlX18oKF9fd2Fybl91bnVzZWRfcmVzdWx0X18p
KSBmaWxlX2NoZWNrX2FuZF9hZHZhbmNlX3diX2VycihzdHJ1Y3QgZmlsZSAqZmlsZSk7CmV4
dGVybiBpbnQgX19hdHRyaWJ1dGVfXygoX193YXJuX3VudXNlZF9yZXN1bHRfXykpIGZpbGVf
d3JpdGVfYW5kX3dhaXRfcmFuZ2Uoc3RydWN0IGZpbGUgKmZpbGUsCiAgICAgIGxvZmZfdCBz
dGFydCwgbG9mZl90IGVuZCk7CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGZpbGVfd3JpdGVfYW5kX3dhaXQo
c3RydWN0IGZpbGUgKmZpbGUpCnsKIHJldHVybiBmaWxlX3dyaXRlX2FuZF93YWl0X3Jhbmdl
KGZpbGUsIDAsICgobG9uZyBsb25nKSh+MFVMTCA+PiAxKSkpOwp9CiMgMjc5MyAiLi9pbmNs
dWRlL2xpbnV4L2ZzLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGZpbGVtYXBfc2V0X3diX2VycihzdHJ1
Y3QgYWRkcmVzc19zcGFjZSAqbWFwcGluZywgaW50IGVycikKewoKIGlmIChfX2J1aWx0aW5f
ZXhwZWN0KCEhKGVyciksIDApKQogIF9fZmlsZW1hcF9zZXRfd2JfZXJyKG1hcHBpbmcsIGVy
cik7Cn0KIyAyODEwICIuL2luY2x1ZGUvbGludXgvZnMuaCIKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBmaWxl
bWFwX2NoZWNrX3diX2VycihzdHJ1Y3QgYWRkcmVzc19zcGFjZSAqbWFwcGluZywKICAgICBl
cnJzZXFfdCBzaW5jZSkKewogcmV0dXJuIGVycnNlcV9jaGVjaygmbWFwcGluZy0+d2JfZXJy
LCBzaW5jZSk7Cn0KIyAyODIzICIuL2luY2x1ZGUvbGludXgvZnMuaCIKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGVy
cnNlcV90IGZpbGVtYXBfc2FtcGxlX3diX2VycihzdHJ1Y3QgYWRkcmVzc19zcGFjZSAqbWFw
cGluZykKewogcmV0dXJuIGVycnNlcV9zYW1wbGUoJm1hcHBpbmctPndiX2Vycik7Cn0KIyAy
ODM1ICIuL2luY2x1ZGUvbGludXgvZnMuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGVycnNlcV90IGZpbGVfc2Ft
cGxlX3NiX2VycihzdHJ1Y3QgZmlsZSAqZmlsZSkKewogcmV0dXJuIGVycnNlcV9zYW1wbGUo
JmZpbGUtPmZfcGF0aC5kZW50cnktPmRfc2ItPnNfd2JfZXJyKTsKfQoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGlu
dCBmaWxlbWFwX25yX3RocHMoc3RydWN0IGFkZHJlc3Nfc3BhY2UgKm1hcHBpbmcpCnsKCgoK
IHJldHVybiAwOwoKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgZmlsZW1hcF9ucl90aHBzX2luYyhzdHJ1
Y3QgYWRkcmVzc19zcGFjZSAqbWFwcGluZykKewoKCgogKHsgaW50IF9fcmV0X3dhcm5fb24g
PSAhISgxKTsgaWYgKF9fYnVpbHRpbl9leHBlY3QoISEoX19yZXRfd2Fybl9vbiksIDApKSBf
X2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CSIgInR3aSAzMSwgMCwgMCIgIlxuIiAiLnNlY3Rp
b24gX19idWdfdGFibGUsXCJhd1wiXG4iICIyOlx0IiAiLjhieXRlIiAiICIgIjFiLCAlMFxu
IiAiXHQuc2hvcnQgJTEsICUyXG4iICIub3JnIDJiKyUzXG4iICIucHJldmlvdXNcbiIgOiA6
ICJpIiAoIi4vaW5jbHVkZS9saW51eC9mcy5oIiksICJpIiAoMjg1NCksICJpIiAoKDEgPDwg
MCkgfCAoKDEgPDwgMSkgfCAoKDkpIDw8IDgpKSksICJpIiAoc2l6ZW9mKHN0cnVjdCBidWdf
ZW50cnkpKSk7IF9fYnVpbHRpbl9leHBlY3QoISEoX19yZXRfd2Fybl9vbiksIDApOyB9KTsK
Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSB2b2lkIGZpbGVtYXBfbnJfdGhwc19kZWMoc3RydWN0IGFkZHJlc3Nf
c3BhY2UgKm1hcHBpbmcpCnsKCgoKICh7IGludCBfX3JldF93YXJuX29uID0gISEoMSk7IGlm
IChfX2J1aWx0aW5fZXhwZWN0KCEhKF9fcmV0X3dhcm5fb24pLCAwKSkgX19hc21fXyBfX3Zv
bGF0aWxlX18oICIxOgkiICJ0d2kgMzEsIDAsIDAiICJcbiIgIi5zZWN0aW9uIF9fYnVnX3Rh
YmxlLFwiYXdcIlxuIiAiMjpcdCIgIi44Ynl0ZSIgIiAiICIxYiwgJTBcbiIgIlx0LnNob3J0
ICUxLCAlMlxuIiAiLm9yZyAyYislM1xuIiAiLnByZXZpb3VzXG4iIDogOiAiaSIgKCIuL2lu
Y2x1ZGUvbGludXgvZnMuaCIpLCAiaSIgKDI4NjMpLCAiaSIgKCgxIDw8IDApIHwgKCgxIDw8
IDEpIHwgKCg5KSA8PCA4KSkpLCAiaSIgKHNpemVvZihzdHJ1Y3QgYnVnX2VudHJ5KSkpOyBf
X2J1aWx0aW5fZXhwZWN0KCEhKF9fcmV0X3dhcm5fb24pLCAwKTsgfSk7Cgp9CgpleHRlcm4g
aW50IHZmc19mc3luY19yYW5nZShzdHJ1Y3QgZmlsZSAqZmlsZSwgbG9mZl90IHN0YXJ0LCBs
b2ZmX3QgZW5kLAogICAgICBpbnQgZGF0YXN5bmMpOwpleHRlcm4gaW50IHZmc19mc3luYyhz
dHJ1Y3QgZmlsZSAqZmlsZSwgaW50IGRhdGFzeW5jKTsKCmV4dGVybiBpbnQgc3luY19maWxl
X3JhbmdlKHN0cnVjdCBmaWxlICpmaWxlLCBsb2ZmX3Qgb2Zmc2V0LCBsb2ZmX3QgbmJ5dGVz
LAogICAgdW5zaWduZWQgaW50IGZsYWdzKTsKCgoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHNzaXplX3QgZ2Vu
ZXJpY193cml0ZV9zeW5jKHN0cnVjdCBraW9jYiAqaW9jYiwgc3NpemVfdCBjb3VudCkKewog
aWYgKGlvY2ItPmtpX2ZsYWdzICYgKDEgPDwgNCkpIHsKICBpbnQgcmV0ID0gdmZzX2ZzeW5j
X3JhbmdlKGlvY2ItPmtpX2ZpbHAsCiAgICBpb2NiLT5raV9wb3MgLSBjb3VudCwgaW9jYi0+
a2lfcG9zIC0gMSwKICAgIChpb2NiLT5raV9mbGFncyAmICgxIDw8IDUpKSA/IDAgOiAxKTsK
ICBpZiAocmV0KQogICByZXR1cm4gcmV0OwogfQoKIHJldHVybiBjb3VudDsKfQoKZXh0ZXJu
IHZvaWQgZW1lcmdlbmN5X3N5bmModm9pZCk7CmV4dGVybiB2b2lkIGVtZXJnZW5jeV9yZW1v
dW50KHZvaWQpOwoKCmV4dGVybiBpbnQgYm1hcChzdHJ1Y3QgaW5vZGUgKmlub2RlLCBzZWN0
b3JfdCAqYmxvY2spOwoKCgoKCgoKZXh0ZXJuIGludCBub3RpZnlfY2hhbmdlKHN0cnVjdCBk
ZW50cnkgKiwgc3RydWN0IGlhdHRyICosIHN0cnVjdCBpbm9kZSAqKik7CmV4dGVybiBpbnQg
aW5vZGVfcGVybWlzc2lvbihzdHJ1Y3QgaW5vZGUgKiwgaW50KTsKZXh0ZXJuIGludCBnZW5l
cmljX3Blcm1pc3Npb24oc3RydWN0IGlub2RlICosIGludCk7CmV4dGVybiBpbnQgX19jaGVj
a19zdGlja3koc3RydWN0IGlub2RlICpkaXIsIHN0cnVjdCBpbm9kZSAqaW5vZGUpOwoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIGJvb2wgZXhlY3V0ZV9vayhzdHJ1Y3QgaW5vZGUgKmlub2RlKQp7CiByZXR1cm4g
KGlub2RlLT5pX21vZGUgJiAoMDAxMDB8MDAwMTB8MDAwMDEpKSB8fCAoKChpbm9kZS0+aV9t
b2RlKSAmIDAwMTcwMDAwKSA9PSAwMDQwMDAwKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgZmlsZV9z
dGFydF93cml0ZShzdHJ1Y3QgZmlsZSAqZmlsZSkKewogaWYgKCEoKChmaWxlX2lub2RlKGZp
bGUpLT5pX21vZGUpICYgMDAxNzAwMDApID09IDAxMDAwMDApKQogIHJldHVybjsKIF9fc2Jf
c3RhcnRfd3JpdGUoZmlsZV9pbm9kZShmaWxlKS0+aV9zYiwgU0JfRlJFRVpFX1dSSVRFLCB0
cnVlKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgZmlsZV9zdGFydF93cml0ZV90cnlsb2NrKHN0cnVj
dCBmaWxlICpmaWxlKQp7CiBpZiAoISgoKGZpbGVfaW5vZGUoZmlsZSktPmlfbW9kZSkgJiAw
MDE3MDAwMCkgPT0gMDEwMDAwMCkpCiAgcmV0dXJuIHRydWU7CiByZXR1cm4gX19zYl9zdGFy
dF93cml0ZShmaWxlX2lub2RlKGZpbGUpLT5pX3NiLCBTQl9GUkVFWkVfV1JJVEUsIGZhbHNl
KTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIHZvaWQgZmlsZV9lbmRfd3JpdGUoc3RydWN0IGZpbGUgKmZpbGUp
CnsKIGlmICghKCgoZmlsZV9pbm9kZShmaWxlKS0+aV9tb2RlKSAmIDAwMTcwMDAwKSA9PSAw
MTAwMDAwKSkKICByZXR1cm47CiBfX3NiX2VuZF93cml0ZShmaWxlX2lub2RlKGZpbGUpLT5p
X3NiLCBTQl9GUkVFWkVfV1JJVEUpOwp9CiMgMjk1MSAiLi9pbmNsdWRlL2xpbnV4L2ZzLmgi
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSBpbnQgZ2V0X3dyaXRlX2FjY2VzcyhzdHJ1Y3QgaW5vZGUgKmlub2RlKQp7
CiByZXR1cm4gYXRvbWljX2luY191bmxlc3NfbmVnYXRpdmUoJmlub2RlLT5pX3dyaXRlY291
bnQpID8gMCA6IC0yNjsKfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGRlbnlfd3JpdGVfYWNjZXNzKHN0cnVj
dCBmaWxlICpmaWxlKQp7CiBzdHJ1Y3QgaW5vZGUgKmlub2RlID0gZmlsZV9pbm9kZShmaWxl
KTsKIHJldHVybiBhdG9taWNfZGVjX3VubGVzc19wb3NpdGl2ZSgmaW5vZGUtPmlfd3JpdGVj
b3VudCkgPyAwIDogLTI2Owp9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHB1dF93cml0ZV9hY2Nlc3Moc3Ry
dWN0IGlub2RlICogaW5vZGUpCnsKIGF0b21pY19kZWMoJmlub2RlLT5pX3dyaXRlY291bnQp
Owp9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSB2b2lkIGFsbG93X3dyaXRlX2FjY2VzcyhzdHJ1Y3QgZmlsZSAqZmls
ZSkKewogaWYgKGZpbGUpCiAgYXRvbWljX2luYygmZmlsZV9pbm9kZShmaWxlKS0+aV93cml0
ZWNvdW50KTsKfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBpbm9kZV9pc19vcGVuX2Zvcl93cml0ZShjb25z
dCBzdHJ1Y3QgaW5vZGUgKmlub2RlKQp7CiByZXR1cm4gYXRvbWljX3JlYWQoJmlub2RlLT5p
X3dyaXRlY291bnQpID4gMDsKfQoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGlfcmVhZGNvdW50X2RlYyhz
dHJ1Y3QgaW5vZGUgKmlub2RlKQp7CiBkbyB7IGlmIChfX2J1aWx0aW5fY29uc3RhbnRfcCgh
YXRvbWljX3JlYWQoJmlub2RlLT5pX3JlYWRjb3VudCkpKSB7IGlmICghYXRvbWljX3JlYWQo
Jmlub2RlLT5pX3JlYWRjb3VudCkpIGRvIHsgX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgki
ICJ0d2kgMzEsIDAsIDAiICJcbiIgIi5zZWN0aW9uIF9fYnVnX3RhYmxlLFwiYXdcIlxuIiAi
MjpcdCIgIi44Ynl0ZSIgIiAiICIxYiwgJTBcbiIgIlx0LnNob3J0ICUxLCAlMlxuIiAiLm9y
ZyAyYislM1xuIiAiLnByZXZpb3VzXG4iIDogOiAiaSIgKCIuL2luY2x1ZGUvbGludXgvZnMu
aCIpLCAiaSIgKDI5NzcpLCAiaSIgKDApLCAiaSIgKHNpemVvZihzdHJ1Y3QgYnVnX2VudHJ5
KSkpOyBkbyB7IDsgYXNtIHZvbGF0aWxlKCIiKTsgX19idWlsdGluX3VucmVhY2hhYmxlKCk7
IH0gd2hpbGUgKDApOyB9IHdoaWxlICgwKTsgfSBlbHNlIHsgX19hc21fXyBfX3ZvbGF0aWxl
X18oICIxOgkiICJ0ZG5laSIgIiAiICIgJTQsIDAiICJcbiIgIi5zZWN0aW9uIF9fYnVnX3Rh
YmxlLFwiYXdcIlxuIiAiMjpcdCIgIi44Ynl0ZSIgIiAiICIxYiwgJTBcbiIgIlx0LnNob3J0
ICUxLCAlMlxuIiAiLm9yZyAyYislM1xuIiAiLnByZXZpb3VzXG4iIDogOiAiaSIgKCIuL2lu
Y2x1ZGUvbGludXgvZnMuaCIpLCAiaSIgKDI5NzcpLCAiaSIgKDApLCAiaSIgKHNpemVvZihz
dHJ1Y3QgYnVnX2VudHJ5KSksICJyIiAoKCBsb25nKSghYXRvbWljX3JlYWQoJmlub2RlLT5p
X3JlYWRjb3VudCkpKSk7IH0gfSB3aGlsZSAoMCk7CiBhdG9taWNfZGVjKCZpbm9kZS0+aV9y
ZWFkY291bnQpOwp9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGlfcmVhZGNvdW50X2luYyhzdHJ1Y3QgaW5v
ZGUgKmlub2RlKQp7CiBhdG9taWNfaW5jKCZpbm9kZS0+aV9yZWFkY291bnQpOwp9CiMgMjk5
NCAiLi9pbmNsdWRlL2xpbnV4L2ZzLmgiCmV4dGVybiBpbnQgZG9fcGlwZV9mbGFncyhpbnQg
KiwgaW50KTsKIyAzMDExICIuL2luY2x1ZGUvbGludXgvZnMuaCIKZW51bSBrZXJuZWxfcmVh
ZF9maWxlX2lkIHsKIFJFQURJTkdfVU5LTk9XTiwgUkVBRElOR19GSVJNV0FSRSwgUkVBRElO
R19GSVJNV0FSRV9QUkVBTExPQ19CVUZGRVIsIFJFQURJTkdfRklSTVdBUkVfRUZJX0VNQkVE
REVELCBSRUFESU5HX01PRFVMRSwgUkVBRElOR19LRVhFQ19JTUFHRSwgUkVBRElOR19LRVhF
Q19JTklUUkFNRlMsIFJFQURJTkdfUE9MSUNZLCBSRUFESU5HX1g1MDlfQ0VSVElGSUNBVEUs
IFJFQURJTkdfTUFYX0lELAp9OwoKc3RhdGljIGNvbnN0IGNoYXIgKiBjb25zdCBrZXJuZWxf
cmVhZF9maWxlX3N0cltdID0gewogInVua25vd24iLCAiZmlybXdhcmUiLCAiZmlybXdhcmUi
LCAiZmlybXdhcmUiLCAia2VybmVsLW1vZHVsZSIsICJrZXhlYy1pbWFnZSIsICJrZXhlYy1p
bml0cmFtZnMiLCAic2VjdXJpdHktcG9saWN5IiwgIng1MDktY2VydGlmaWNhdGUiLCAiIiwK
fTsKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSBjb25zdCBjaGFyICprZXJuZWxfcmVhZF9maWxlX2lkX3N0cihlbnVt
IGtlcm5lbF9yZWFkX2ZpbGVfaWQgaWQpCnsKIGlmICgodW5zaWduZWQpaWQgPj0gUkVBRElO
R19NQVhfSUQpCiAgcmV0dXJuIGtlcm5lbF9yZWFkX2ZpbGVfc3RyW1JFQURJTkdfVU5LTk9X
Tl07CgogcmV0dXJuIGtlcm5lbF9yZWFkX2ZpbGVfc3RyW2lkXTsKfQoKZXh0ZXJuIGludCBr
ZXJuZWxfcmVhZF9maWxlKHN0cnVjdCBmaWxlICosIHZvaWQgKiosIGxvZmZfdCAqLCBsb2Zm
X3QsCiAgICAgICBlbnVtIGtlcm5lbF9yZWFkX2ZpbGVfaWQpOwpleHRlcm4gaW50IGtlcm5l
bF9yZWFkX2ZpbGVfZnJvbV9wYXRoKGNvbnN0IGNoYXIgKiwgdm9pZCAqKiwgbG9mZl90ICos
IGxvZmZfdCwKICAgICAgICAgIGVudW0ga2VybmVsX3JlYWRfZmlsZV9pZCk7CmV4dGVybiBp
bnQga2VybmVsX3JlYWRfZmlsZV9mcm9tX3BhdGhfaW5pdG5zKGNvbnN0IGNoYXIgKiwgdm9p
ZCAqKiwgbG9mZl90ICosIGxvZmZfdCwKICAgICAgICAgIGVudW0ga2VybmVsX3JlYWRfZmls
ZV9pZCk7CmV4dGVybiBpbnQga2VybmVsX3JlYWRfZmlsZV9mcm9tX2ZkKGludCwgdm9pZCAq
KiwgbG9mZl90ICosIGxvZmZfdCwKICAgICAgICBlbnVtIGtlcm5lbF9yZWFkX2ZpbGVfaWQp
OwpleHRlcm4gc3NpemVfdCBrZXJuZWxfcmVhZChzdHJ1Y3QgZmlsZSAqLCB2b2lkICosIHNp
emVfdCwgbG9mZl90ICopOwpleHRlcm4gc3NpemVfdCBrZXJuZWxfd3JpdGUoc3RydWN0IGZp
bGUgKiwgY29uc3Qgdm9pZCAqLCBzaXplX3QsIGxvZmZfdCAqKTsKZXh0ZXJuIHNzaXplX3Qg
X19rZXJuZWxfd3JpdGUoc3RydWN0IGZpbGUgKiwgY29uc3Qgdm9pZCAqLCBzaXplX3QsIGxv
ZmZfdCAqKTsKZXh0ZXJuIHN0cnVjdCBmaWxlICogb3Blbl9leGVjKGNvbnN0IGNoYXIgKik7
CgoKZXh0ZXJuIGJvb2wgaXNfc3ViZGlyKHN0cnVjdCBkZW50cnkgKiwgc3RydWN0IGRlbnRy
eSAqKTsKZXh0ZXJuIGJvb2wgcGF0aF9pc191bmRlcihjb25zdCBzdHJ1Y3QgcGF0aCAqLCBj
b25zdCBzdHJ1Y3QgcGF0aCAqKTsKCmV4dGVybiBjaGFyICpmaWxlX3BhdGgoc3RydWN0IGZp
bGUgKiwgY2hhciAqLCBpbnQpOwoKCgoKZXh0ZXJuIGxvZmZfdCBkZWZhdWx0X2xsc2Vlayhz
dHJ1Y3QgZmlsZSAqZmlsZSwgbG9mZl90IG9mZnNldCwgaW50IHdoZW5jZSk7CgpleHRlcm4g
bG9mZl90IHZmc19sbHNlZWsoc3RydWN0IGZpbGUgKmZpbGUsIGxvZmZfdCBvZmZzZXQsIGlu
dCB3aGVuY2UpOwoKZXh0ZXJuIGludCBpbm9kZV9pbml0X2Fsd2F5cyhzdHJ1Y3Qgc3VwZXJf
YmxvY2sgKiwgc3RydWN0IGlub2RlICopOwpleHRlcm4gdm9pZCBpbm9kZV9pbml0X29uY2Uo
c3RydWN0IGlub2RlICopOwpleHRlcm4gdm9pZCBhZGRyZXNzX3NwYWNlX2luaXRfb25jZShz
dHJ1Y3QgYWRkcmVzc19zcGFjZSAqbWFwcGluZyk7CmV4dGVybiBzdHJ1Y3QgaW5vZGUgKiBp
Z3JhYihzdHJ1Y3QgaW5vZGUgKik7CmV4dGVybiBpbm9fdCBpdW5pcXVlKHN0cnVjdCBzdXBl
cl9ibG9jayAqLCBpbm9fdCk7CmV4dGVybiBpbnQgaW5vZGVfbmVlZHNfc3luYyhzdHJ1Y3Qg
aW5vZGUgKmlub2RlKTsKZXh0ZXJuIGludCBnZW5lcmljX2RlbGV0ZV9pbm9kZShzdHJ1Y3Qg
aW5vZGUgKmlub2RlKTsKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBnZW5lcmljX2Ryb3BfaW5vZGUoc3RydWN0
IGlub2RlICppbm9kZSkKewogcmV0dXJuICFpbm9kZS0+aV9ubGluayB8fCBpbm9kZV91bmhh
c2hlZChpbm9kZSkgfHwKICAoaW5vZGUtPmlfc3RhdGUgJiAoMSA8PCAxNikpOwp9CmV4dGVy
biB2b2lkIGRfbWFya19kb250Y2FjaGUoc3RydWN0IGlub2RlICppbm9kZSk7CgpleHRlcm4g
c3RydWN0IGlub2RlICppbG9va3VwNV9ub3dhaXQoc3RydWN0IHN1cGVyX2Jsb2NrICpzYiwK
ICB1bnNpZ25lZCBsb25nIGhhc2h2YWwsIGludCAoKnRlc3QpKHN0cnVjdCBpbm9kZSAqLCB2
b2lkICopLAogIHZvaWQgKmRhdGEpOwpleHRlcm4gc3RydWN0IGlub2RlICppbG9va3VwNShz
dHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiLCB1bnNpZ25lZCBsb25nIGhhc2h2YWwsCiAgaW50ICgq
dGVzdCkoc3RydWN0IGlub2RlICosIHZvaWQgKiksIHZvaWQgKmRhdGEpOwpleHRlcm4gc3Ry
dWN0IGlub2RlICppbG9va3VwKHN0cnVjdCBzdXBlcl9ibG9jayAqc2IsIHVuc2lnbmVkIGxv
bmcgaW5vKTsKCmV4dGVybiBzdHJ1Y3QgaW5vZGUgKmlub2RlX2luc2VydDUoc3RydWN0IGlu
b2RlICppbm9kZSwgdW5zaWduZWQgbG9uZyBoYXNodmFsLAogIGludCAoKnRlc3QpKHN0cnVj
dCBpbm9kZSAqLCB2b2lkICopLAogIGludCAoKnNldCkoc3RydWN0IGlub2RlICosIHZvaWQg
KiksCiAgdm9pZCAqZGF0YSk7CmV4dGVybiBzdHJ1Y3QgaW5vZGUgKiBpZ2V0NV9sb2NrZWQo
c3RydWN0IHN1cGVyX2Jsb2NrICosIHVuc2lnbmVkIGxvbmcsIGludCAoKnRlc3QpKHN0cnVj
dCBpbm9kZSAqLCB2b2lkICopLCBpbnQgKCpzZXQpKHN0cnVjdCBpbm9kZSAqLCB2b2lkICop
LCB2b2lkICopOwpleHRlcm4gc3RydWN0IGlub2RlICogaWdldF9sb2NrZWQoc3RydWN0IHN1
cGVyX2Jsb2NrICosIHVuc2lnbmVkIGxvbmcpOwpleHRlcm4gc3RydWN0IGlub2RlICpmaW5k
X2lub2RlX25vd2FpdChzdHJ1Y3Qgc3VwZXJfYmxvY2sgKiwKICAgICAgICAgICB1bnNpZ25l
ZCBsb25nLAogICAgICAgICAgIGludCAoKm1hdGNoKShzdHJ1Y3QgaW5vZGUgKiwKICAgICAg
ICAgIHVuc2lnbmVkIGxvbmcsIHZvaWQgKiksCiAgICAgICAgICAgdm9pZCAqZGF0YSk7CmV4
dGVybiBzdHJ1Y3QgaW5vZGUgKmZpbmRfaW5vZGVfcmN1KHN0cnVjdCBzdXBlcl9ibG9jayAq
LCB1bnNpZ25lZCBsb25nLAogICAgICAgIGludCAoKikoc3RydWN0IGlub2RlICosIHZvaWQg
KiksIHZvaWQgKik7CmV4dGVybiBzdHJ1Y3QgaW5vZGUgKmZpbmRfaW5vZGVfYnlfaW5vX3Jj
dShzdHJ1Y3Qgc3VwZXJfYmxvY2sgKiwgdW5zaWduZWQgbG9uZyk7CmV4dGVybiBpbnQgaW5z
ZXJ0X2lub2RlX2xvY2tlZDQoc3RydWN0IGlub2RlICosIHVuc2lnbmVkIGxvbmcsIGludCAo
KnRlc3QpKHN0cnVjdCBpbm9kZSAqLCB2b2lkICopLCB2b2lkICopOwpleHRlcm4gaW50IGlu
c2VydF9pbm9kZV9sb2NrZWQoc3RydWN0IGlub2RlICopOwoKCgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBs
b2NrZGVwX2Fubm90YXRlX2lub2RlX211dGV4X2tleShzdHJ1Y3QgaW5vZGUgKmlub2RlKSB7
IH07CgpleHRlcm4gdm9pZCB1bmxvY2tfbmV3X2lub2RlKHN0cnVjdCBpbm9kZSAqKTsKZXh0
ZXJuIHZvaWQgZGlzY2FyZF9uZXdfaW5vZGUoc3RydWN0IGlub2RlICopOwpleHRlcm4gdW5z
aWduZWQgaW50IGdldF9uZXh0X2lubyh2b2lkKTsKZXh0ZXJuIHZvaWQgZXZpY3RfaW5vZGVz
KHN0cnVjdCBzdXBlcl9ibG9jayAqc2IpOwoKZXh0ZXJuIHZvaWQgX19pZ2V0KHN0cnVjdCBp
bm9kZSAqIGlub2RlKTsKZXh0ZXJuIHZvaWQgaWdldF9mYWlsZWQoc3RydWN0IGlub2RlICop
OwpleHRlcm4gdm9pZCBjbGVhcl9pbm9kZShzdHJ1Y3QgaW5vZGUgKik7CmV4dGVybiB2b2lk
IF9fZGVzdHJveV9pbm9kZShzdHJ1Y3QgaW5vZGUgKik7CmV4dGVybiBzdHJ1Y3QgaW5vZGUg
Km5ld19pbm9kZV9wc2V1ZG8oc3RydWN0IHN1cGVyX2Jsb2NrICpzYik7CmV4dGVybiBzdHJ1
Y3QgaW5vZGUgKm5ld19pbm9kZShzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiKTsKZXh0ZXJuIHZv
aWQgZnJlZV9pbm9kZV9ub25yY3Uoc3RydWN0IGlub2RlICppbm9kZSk7CmV4dGVybiBpbnQg
c2hvdWxkX3JlbW92ZV9zdWlkKHN0cnVjdCBkZW50cnkgKik7CmV4dGVybiBpbnQgZmlsZV9y
ZW1vdmVfcHJpdnMoc3RydWN0IGZpbGUgKik7CgpleHRlcm4gdm9pZCBfX2luc2VydF9pbm9k
ZV9oYXNoKHN0cnVjdCBpbm9kZSAqLCB1bnNpZ25lZCBsb25nIGhhc2h2YWwpOwpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgdm9pZCBpbnNlcnRfaW5vZGVfaGFzaChzdHJ1Y3QgaW5vZGUgKmlub2RlKQp7CiBfX2lu
c2VydF9pbm9kZV9oYXNoKGlub2RlLCBpbm9kZS0+aV9pbm8pOwp9CgpleHRlcm4gdm9pZCBf
X3JlbW92ZV9pbm9kZV9oYXNoKHN0cnVjdCBpbm9kZSAqKTsKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgcmVt
b3ZlX2lub2RlX2hhc2goc3RydWN0IGlub2RlICppbm9kZSkKewogaWYgKCFpbm9kZV91bmhh
c2hlZChpbm9kZSkgJiYgIWhsaXN0X2Zha2UoJmlub2RlLT5pX2hhc2gpKQogIF9fcmVtb3Zl
X2lub2RlX2hhc2goaW5vZGUpOwp9CgpleHRlcm4gdm9pZCBpbm9kZV9zYl9saXN0X2FkZChz
dHJ1Y3QgaW5vZGUgKmlub2RlKTsKCgpleHRlcm4gaW50IGJkZXZfcmVhZF9vbmx5KHN0cnVj
dCBibG9ja19kZXZpY2UgKik7CgpleHRlcm4gaW50IHNldF9ibG9ja3NpemUoc3RydWN0IGJs
b2NrX2RldmljZSAqLCBpbnQpOwpleHRlcm4gaW50IHNiX3NldF9ibG9ja3NpemUoc3RydWN0
IHN1cGVyX2Jsb2NrICosIGludCk7CmV4dGVybiBpbnQgc2JfbWluX2Jsb2Nrc2l6ZShzdHJ1
Y3Qgc3VwZXJfYmxvY2sgKiwgaW50KTsKCmV4dGVybiBpbnQgZ2VuZXJpY19maWxlX21tYXAo
c3RydWN0IGZpbGUgKiwgc3RydWN0IHZtX2FyZWFfc3RydWN0ICopOwpleHRlcm4gaW50IGdl
bmVyaWNfZmlsZV9yZWFkb25seV9tbWFwKHN0cnVjdCBmaWxlICosIHN0cnVjdCB2bV9hcmVh
X3N0cnVjdCAqKTsKZXh0ZXJuIHNzaXplX3QgZ2VuZXJpY193cml0ZV9jaGVja3Moc3RydWN0
IGtpb2NiICosIHN0cnVjdCBpb3ZfaXRlciAqKTsKZXh0ZXJuIGludCBnZW5lcmljX3JlbWFw
X2NoZWNrcyhzdHJ1Y3QgZmlsZSAqZmlsZV9pbiwgbG9mZl90IHBvc19pbiwKICAgIHN0cnVj
dCBmaWxlICpmaWxlX291dCwgbG9mZl90IHBvc19vdXQsCiAgICBsb2ZmX3QgKmNvdW50LCB1
bnNpZ25lZCBpbnQgcmVtYXBfZmxhZ3MpOwpleHRlcm4gaW50IGdlbmVyaWNfZmlsZV9yd19j
aGVja3Moc3RydWN0IGZpbGUgKmZpbGVfaW4sIHN0cnVjdCBmaWxlICpmaWxlX291dCk7CmV4
dGVybiBpbnQgZ2VuZXJpY19jb3B5X2ZpbGVfY2hlY2tzKHN0cnVjdCBmaWxlICpmaWxlX2lu
LCBsb2ZmX3QgcG9zX2luLAogICAgICAgIHN0cnVjdCBmaWxlICpmaWxlX291dCwgbG9mZl90
IHBvc19vdXQsCiAgICAgICAgc2l6ZV90ICpjb3VudCwgdW5zaWduZWQgaW50IGZsYWdzKTsK
ZXh0ZXJuIHNzaXplX3QgZ2VuZXJpY19maWxlX2J1ZmZlcmVkX3JlYWQoc3RydWN0IGtpb2Ni
ICppb2NiLAogIHN0cnVjdCBpb3ZfaXRlciAqdG8sIHNzaXplX3QgYWxyZWFkeV9yZWFkKTsK
ZXh0ZXJuIHNzaXplX3QgZ2VuZXJpY19maWxlX3JlYWRfaXRlcihzdHJ1Y3Qga2lvY2IgKiwg
c3RydWN0IGlvdl9pdGVyICopOwpleHRlcm4gc3NpemVfdCBfX2dlbmVyaWNfZmlsZV93cml0
ZV9pdGVyKHN0cnVjdCBraW9jYiAqLCBzdHJ1Y3QgaW92X2l0ZXIgKik7CmV4dGVybiBzc2l6
ZV90IGdlbmVyaWNfZmlsZV93cml0ZV9pdGVyKHN0cnVjdCBraW9jYiAqLCBzdHJ1Y3QgaW92
X2l0ZXIgKik7CmV4dGVybiBzc2l6ZV90IGdlbmVyaWNfZmlsZV9kaXJlY3Rfd3JpdGUoc3Ry
dWN0IGtpb2NiICosIHN0cnVjdCBpb3ZfaXRlciAqKTsKZXh0ZXJuIHNzaXplX3QgZ2VuZXJp
Y19wZXJmb3JtX3dyaXRlKHN0cnVjdCBmaWxlICosIHN0cnVjdCBpb3ZfaXRlciAqLCBsb2Zm
X3QpOwoKc3NpemVfdCB2ZnNfaXRlcl9yZWFkKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3Qg
aW92X2l0ZXIgKml0ZXIsIGxvZmZfdCAqcHBvcywKICByd2ZfdCBmbGFncyk7CnNzaXplX3Qg
dmZzX2l0ZXJfd3JpdGUoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCBpb3ZfaXRlciAqaXRl
ciwgbG9mZl90ICpwcG9zLAogIHJ3Zl90IGZsYWdzKTsKc3NpemVfdCB2ZnNfaW9jYl9pdGVy
X3JlYWQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCBraW9jYiAqaW9jYiwKICAgICAgc3Ry
dWN0IGlvdl9pdGVyICppdGVyKTsKc3NpemVfdCB2ZnNfaW9jYl9pdGVyX3dyaXRlKHN0cnVj
dCBmaWxlICpmaWxlLCBzdHJ1Y3Qga2lvY2IgKmlvY2IsCiAgICAgICBzdHJ1Y3QgaW92X2l0
ZXIgKml0ZXIpOwoKCmV4dGVybiBzc2l6ZV90IGJsa2Rldl9yZWFkX2l0ZXIoc3RydWN0IGtp
b2NiICppb2NiLCBzdHJ1Y3QgaW92X2l0ZXIgKnRvKTsKZXh0ZXJuIHNzaXplX3QgYmxrZGV2
X3dyaXRlX2l0ZXIoc3RydWN0IGtpb2NiICppb2NiLCBzdHJ1Y3QgaW92X2l0ZXIgKmZyb20p
OwpleHRlcm4gaW50IGJsa2Rldl9mc3luYyhzdHJ1Y3QgZmlsZSAqZmlscCwgbG9mZl90IHN0
YXJ0LCBsb2ZmX3QgZW5kLAogICBpbnQgZGF0YXN5bmMpOwpleHRlcm4gdm9pZCBibG9ja19z
eW5jX3BhZ2Uoc3RydWN0IHBhZ2UgKnBhZ2UpOwoKCmV4dGVybiBzc2l6ZV90IGdlbmVyaWNf
ZmlsZV9zcGxpY2VfcmVhZChzdHJ1Y3QgZmlsZSAqLCBsb2ZmX3QgKiwKICBzdHJ1Y3QgcGlw
ZV9pbm9kZV9pbmZvICosIHNpemVfdCwgdW5zaWduZWQgaW50KTsKZXh0ZXJuIHNzaXplX3Qg
aXRlcl9maWxlX3NwbGljZV93cml0ZShzdHJ1Y3QgcGlwZV9pbm9kZV9pbmZvICosCiAgc3Ry
dWN0IGZpbGUgKiwgbG9mZl90ICosIHNpemVfdCwgdW5zaWduZWQgaW50KTsKZXh0ZXJuIHNz
aXplX3QgZ2VuZXJpY19zcGxpY2Vfc2VuZHBhZ2Uoc3RydWN0IHBpcGVfaW5vZGVfaW5mbyAq
cGlwZSwKICBzdHJ1Y3QgZmlsZSAqb3V0LCBsb2ZmX3QgKiwgc2l6ZV90IGxlbiwgdW5zaWdu
ZWQgaW50IGZsYWdzKTsKZXh0ZXJuIGxvbmcgZG9fc3BsaWNlX2RpcmVjdChzdHJ1Y3QgZmls
ZSAqaW4sIGxvZmZfdCAqcHBvcywgc3RydWN0IGZpbGUgKm91dCwKICBsb2ZmX3QgKm9wb3Ms
IHNpemVfdCBsZW4sIHVuc2lnbmVkIGludCBmbGFncyk7CgoKZXh0ZXJuIHZvaWQKZmlsZV9y
YV9zdGF0ZV9pbml0KHN0cnVjdCBmaWxlX3JhX3N0YXRlICpyYSwgc3RydWN0IGFkZHJlc3Nf
c3BhY2UgKm1hcHBpbmcpOwpleHRlcm4gbG9mZl90IG5vb3BfbGxzZWVrKHN0cnVjdCBmaWxl
ICpmaWxlLCBsb2ZmX3Qgb2Zmc2V0LCBpbnQgd2hlbmNlKTsKZXh0ZXJuIGxvZmZfdCBub19s
bHNlZWsoc3RydWN0IGZpbGUgKmZpbGUsIGxvZmZfdCBvZmZzZXQsIGludCB3aGVuY2UpOwpl
eHRlcm4gbG9mZl90IHZmc19zZXRwb3Moc3RydWN0IGZpbGUgKmZpbGUsIGxvZmZfdCBvZmZz
ZXQsIGxvZmZfdCBtYXhzaXplKTsKZXh0ZXJuIGxvZmZfdCBnZW5lcmljX2ZpbGVfbGxzZWVr
KHN0cnVjdCBmaWxlICpmaWxlLCBsb2ZmX3Qgb2Zmc2V0LCBpbnQgd2hlbmNlKTsKZXh0ZXJu
IGxvZmZfdCBnZW5lcmljX2ZpbGVfbGxzZWVrX3NpemUoc3RydWN0IGZpbGUgKmZpbGUsIGxv
ZmZfdCBvZmZzZXQsCiAgaW50IHdoZW5jZSwgbG9mZl90IG1heHNpemUsIGxvZmZfdCBlb2Yp
OwpleHRlcm4gbG9mZl90IGZpeGVkX3NpemVfbGxzZWVrKHN0cnVjdCBmaWxlICpmaWxlLCBs
b2ZmX3Qgb2Zmc2V0LAogIGludCB3aGVuY2UsIGxvZmZfdCBzaXplKTsKZXh0ZXJuIGxvZmZf
dCBub19zZWVrX2VuZF9sbHNlZWtfc2l6ZShzdHJ1Y3QgZmlsZSAqLCBsb2ZmX3QsIGludCwg
bG9mZl90KTsKZXh0ZXJuIGxvZmZfdCBub19zZWVrX2VuZF9sbHNlZWsoc3RydWN0IGZpbGUg
KiwgbG9mZl90LCBpbnQpOwpleHRlcm4gaW50IGdlbmVyaWNfZmlsZV9vcGVuKHN0cnVjdCBp
bm9kZSAqIGlub2RlLCBzdHJ1Y3QgZmlsZSAqIGZpbHApOwpleHRlcm4gaW50IG5vbnNlZWth
YmxlX29wZW4oc3RydWN0IGlub2RlICogaW5vZGUsIHN0cnVjdCBmaWxlICogZmlscCk7CmV4
dGVybiBpbnQgc3RyZWFtX29wZW4oc3RydWN0IGlub2RlICogaW5vZGUsIHN0cnVjdCBmaWxl
ICogZmlscCk7CgoKdHlwZWRlZiB2b2lkIChkaW9fc3VibWl0X3QpKHN0cnVjdCBiaW8gKmJp
bywgc3RydWN0IGlub2RlICppbm9kZSwKICAgICAgIGxvZmZfdCBmaWxlX29mZnNldCk7Cgpl
bnVtIHsKCiBESU9fTE9DS0lORyA9IDB4MDEsCgoKIERJT19TS0lQX0hPTEVTID0gMHgwMiwK
fTsKCnZvaWQgZGlvX2VuZF9pbyhzdHJ1Y3QgYmlvICpiaW8pOwoKc3NpemVfdCBfX2Jsb2Nr
ZGV2X2RpcmVjdF9JTyhzdHJ1Y3Qga2lvY2IgKmlvY2IsIHN0cnVjdCBpbm9kZSAqaW5vZGUs
CiAgICAgICAgc3RydWN0IGJsb2NrX2RldmljZSAqYmRldiwgc3RydWN0IGlvdl9pdGVyICpp
dGVyLAogICAgICAgIGdldF9ibG9ja190IGdldF9ibG9jaywKICAgICAgICBkaW9faW9kb25l
X3QgZW5kX2lvLCBkaW9fc3VibWl0X3Qgc3VibWl0X2lvLAogICAgICAgIGludCBmbGFncyk7
CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgc3NpemVfdCBibG9ja2Rldl9kaXJlY3RfSU8oc3RydWN0IGtpb2NiICpp
b2NiLAogICAgICBzdHJ1Y3QgaW5vZGUgKmlub2RlLAogICAgICBzdHJ1Y3QgaW92X2l0ZXIg
Kml0ZXIsCiAgICAgIGdldF9ibG9ja190IGdldF9ibG9jaykKewogcmV0dXJuIF9fYmxvY2tk
ZXZfZGlyZWN0X0lPKGlvY2IsIGlub2RlLCBpbm9kZS0+aV9zYi0+c19iZGV2LCBpdGVyLAog
ICBnZXRfYmxvY2ssICgodm9pZCAqKTApLCAoKHZvaWQgKikwKSwgRElPX0xPQ0tJTkcgfCBE
SU9fU0tJUF9IT0xFUyk7Cn0KCgp2b2lkIGlub2RlX2Rpb193YWl0KHN0cnVjdCBpbm9kZSAq
aW5vZGUpOwojIDMyMzIgIi4vaW5jbHVkZS9saW51eC9mcy5oIgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBp
bm9kZV9kaW9fYmVnaW4oc3RydWN0IGlub2RlICppbm9kZSkKewogYXRvbWljX2luYygmaW5v
ZGUtPmlfZGlvX2NvdW50KTsKfQojIDMyNDQgIi4vaW5jbHVkZS9saW51eC9mcy5oIgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgdm9pZCBpbm9kZV9kaW9fZW5kKHN0cnVjdCBpbm9kZSAqaW5vZGUpCnsKIGlmIChh
dG9taWNfZGVjX2FuZF90ZXN0KCZpbm9kZS0+aV9kaW9fY291bnQpKQogIHdha2VfdXBfYml0
KCZpbm9kZS0+aV9zdGF0ZSwgOSk7Cn0KCgoKCnZvaWQgZGlvX3dhcm5fc3RhbGVfcGFnZWNh
Y2hlKHN0cnVjdCBmaWxlICpmaWxwKTsKCmV4dGVybiB2b2lkIGlub2RlX3NldF9mbGFncyhz
dHJ1Y3QgaW5vZGUgKmlub2RlLCB1bnNpZ25lZCBpbnQgZmxhZ3MsCiAgICAgICB1bnNpZ25l
ZCBpbnQgbWFzayk7CgpleHRlcm4gY29uc3Qgc3RydWN0IGZpbGVfb3BlcmF0aW9ucyBnZW5l
cmljX3JvX2ZvcHM7CgoKCmV4dGVybiBpbnQgcmVhZGxpbmtfY29weShjaGFyICosIGludCwg
Y29uc3QgY2hhciAqKTsKZXh0ZXJuIGludCBwYWdlX3JlYWRsaW5rKHN0cnVjdCBkZW50cnkg
KiwgY2hhciAqLCBpbnQpOwpleHRlcm4gY29uc3QgY2hhciAqcGFnZV9nZXRfbGluayhzdHJ1
Y3QgZGVudHJ5ICosIHN0cnVjdCBpbm9kZSAqLAogICAgIHN0cnVjdCBkZWxheWVkX2NhbGwg
Kik7CmV4dGVybiB2b2lkIHBhZ2VfcHV0X2xpbmsodm9pZCAqKTsKZXh0ZXJuIGludCBfX3Bh
Z2Vfc3ltbGluayhzdHJ1Y3QgaW5vZGUgKmlub2RlLCBjb25zdCBjaGFyICpzeW1uYW1lLCBp
bnQgbGVuLAogIGludCBub2ZzKTsKZXh0ZXJuIGludCBwYWdlX3N5bWxpbmsoc3RydWN0IGlu
b2RlICppbm9kZSwgY29uc3QgY2hhciAqc3ltbmFtZSwgaW50IGxlbik7CmV4dGVybiBjb25z
dCBzdHJ1Y3QgaW5vZGVfb3BlcmF0aW9ucyBwYWdlX3N5bWxpbmtfaW5vZGVfb3BlcmF0aW9u
czsKZXh0ZXJuIHZvaWQga2ZyZWVfbGluayh2b2lkICopOwpleHRlcm4gdm9pZCBnZW5lcmlj
X2ZpbGxhdHRyKHN0cnVjdCBpbm9kZSAqLCBzdHJ1Y3Qga3N0YXQgKik7CmV4dGVybiBpbnQg
dmZzX2dldGF0dHJfbm9zZWMoY29uc3Qgc3RydWN0IHBhdGggKiwgc3RydWN0IGtzdGF0ICos
IHUzMiwgdW5zaWduZWQgaW50KTsKZXh0ZXJuIGludCB2ZnNfZ2V0YXR0cihjb25zdCBzdHJ1
Y3QgcGF0aCAqLCBzdHJ1Y3Qga3N0YXQgKiwgdTMyLCB1bnNpZ25lZCBpbnQpOwp2b2lkIF9f
aW5vZGVfYWRkX2J5dGVzKHN0cnVjdCBpbm9kZSAqaW5vZGUsIGxvZmZfdCBieXRlcyk7CnZv
aWQgaW5vZGVfYWRkX2J5dGVzKHN0cnVjdCBpbm9kZSAqaW5vZGUsIGxvZmZfdCBieXRlcyk7
CnZvaWQgX19pbm9kZV9zdWJfYnl0ZXMoc3RydWN0IGlub2RlICppbm9kZSwgbG9mZl90IGJ5
dGVzKTsKdm9pZCBpbm9kZV9zdWJfYnl0ZXMoc3RydWN0IGlub2RlICppbm9kZSwgbG9mZl90
IGJ5dGVzKTsKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIGxvZmZfdCBfX2lub2RlX2dldF9ieXRlcyhzdHJ1Y3QgaW5v
ZGUgKmlub2RlKQp7CiByZXR1cm4gKCgobG9mZl90KWlub2RlLT5pX2Jsb2NrcykgPDwgOSkg
KyBpbm9kZS0+aV9ieXRlczsKfQpsb2ZmX3QgaW5vZGVfZ2V0X2J5dGVzKHN0cnVjdCBpbm9k
ZSAqaW5vZGUpOwp2b2lkIGlub2RlX3NldF9ieXRlcyhzdHJ1Y3QgaW5vZGUgKmlub2RlLCBs
b2ZmX3QgYnl0ZXMpOwpjb25zdCBjaGFyICpzaW1wbGVfZ2V0X2xpbmsoc3RydWN0IGRlbnRy
eSAqLCBzdHJ1Y3QgaW5vZGUgKiwKICAgICAgIHN0cnVjdCBkZWxheWVkX2NhbGwgKik7CmV4
dGVybiBjb25zdCBzdHJ1Y3QgaW5vZGVfb3BlcmF0aW9ucyBzaW1wbGVfc3ltbGlua19pbm9k
ZV9vcGVyYXRpb25zOwoKZXh0ZXJuIGludCBpdGVyYXRlX2RpcihzdHJ1Y3QgZmlsZSAqLCBz
dHJ1Y3QgZGlyX2NvbnRleHQgKik7CgpleHRlcm4gaW50IHZmc19zdGF0eChpbnQsIGNvbnN0
IGNoYXIgKiwgaW50LCBzdHJ1Y3Qga3N0YXQgKiwgdTMyKTsKZXh0ZXJuIGludCB2ZnNfc3Rh
dHhfZmQodW5zaWduZWQgaW50LCBzdHJ1Y3Qga3N0YXQgKiwgdTMyLCB1bnNpZ25lZCBpbnQp
OwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIGludCB2ZnNfc3RhdChjb25zdCBjaGFyICpmaWxlbmFtZSwgc3RydWN0
IGtzdGF0ICpzdGF0KQp7CiByZXR1cm4gdmZzX3N0YXR4KC0xMDAsIGZpbGVuYW1lLCAweDgw
MCwKICAgIHN0YXQsIDB4MDAwMDA3ZmZVKTsKfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHZmc19sc3RhdChj
b25zdCBjaGFyICpuYW1lLCBzdHJ1Y3Qga3N0YXQgKnN0YXQpCnsKIHJldHVybiB2ZnNfc3Rh
dHgoLTEwMCwgbmFtZSwgMHgxMDAgfCAweDgwMCwKICAgIHN0YXQsIDB4MDAwMDA3ZmZVKTsK
fQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgaW50IHZmc19mc3RhdGF0KGludCBkZmQsIGNvbnN0IGNoYXIgKmZpbGVu
YW1lLAogICAgICAgICBzdHJ1Y3Qga3N0YXQgKnN0YXQsIGludCBmbGFncykKewogcmV0dXJu
IHZmc19zdGF0eChkZmQsIGZpbGVuYW1lLCBmbGFncyB8IDB4ODAwLAogICAgc3RhdCwgMHgw
MDAwMDdmZlUpOwp9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgdmZzX2ZzdGF0KGludCBmZCwgc3RydWN0IGtz
dGF0ICpzdGF0KQp7CiByZXR1cm4gdmZzX3N0YXR4X2ZkKGZkLCBzdGF0LCAweDAwMDAwN2Zm
VSwgMCk7Cn0KCgpleHRlcm4gY29uc3QgY2hhciAqdmZzX2dldF9saW5rKHN0cnVjdCBkZW50
cnkgKiwgc3RydWN0IGRlbGF5ZWRfY2FsbCAqKTsKZXh0ZXJuIGludCB2ZnNfcmVhZGxpbmso
c3RydWN0IGRlbnRyeSAqLCBjaGFyICosIGludCk7CgpleHRlcm4gc3RydWN0IGZpbGVfc3lz
dGVtX3R5cGUgKmdldF9maWxlc3lzdGVtKHN0cnVjdCBmaWxlX3N5c3RlbV90eXBlICpmcyk7
CmV4dGVybiB2b2lkIHB1dF9maWxlc3lzdGVtKHN0cnVjdCBmaWxlX3N5c3RlbV90eXBlICpm
cyk7CmV4dGVybiBzdHJ1Y3QgZmlsZV9zeXN0ZW1fdHlwZSAqZ2V0X2ZzX3R5cGUoY29uc3Qg
Y2hhciAqbmFtZSk7CmV4dGVybiBzdHJ1Y3Qgc3VwZXJfYmxvY2sgKmdldF9zdXBlcihzdHJ1
Y3QgYmxvY2tfZGV2aWNlICopOwpleHRlcm4gc3RydWN0IHN1cGVyX2Jsb2NrICpnZXRfc3Vw
ZXJfdGhhd2VkKHN0cnVjdCBibG9ja19kZXZpY2UgKik7CmV4dGVybiBzdHJ1Y3Qgc3VwZXJf
YmxvY2sgKmdldF9zdXBlcl9leGNsdXNpdmVfdGhhd2VkKHN0cnVjdCBibG9ja19kZXZpY2Ug
KmJkZXYpOwpleHRlcm4gc3RydWN0IHN1cGVyX2Jsb2NrICpnZXRfYWN0aXZlX3N1cGVyKHN0
cnVjdCBibG9ja19kZXZpY2UgKmJkZXYpOwpleHRlcm4gdm9pZCBkcm9wX3N1cGVyKHN0cnVj
dCBzdXBlcl9ibG9jayAqc2IpOwpleHRlcm4gdm9pZCBkcm9wX3N1cGVyX2V4Y2x1c2l2ZShz
dHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiKTsKZXh0ZXJuIHZvaWQgaXRlcmF0ZV9zdXBlcnModm9p
ZCAoKikoc3RydWN0IHN1cGVyX2Jsb2NrICosIHZvaWQgKiksIHZvaWQgKik7CmV4dGVybiB2
b2lkIGl0ZXJhdGVfc3VwZXJzX3R5cGUoc3RydWN0IGZpbGVfc3lzdGVtX3R5cGUgKiwKICAg
ICAgICAgICB2b2lkICgqKShzdHJ1Y3Qgc3VwZXJfYmxvY2sgKiwgdm9pZCAqKSwgdm9pZCAq
KTsKCmV4dGVybiBpbnQgZGNhY2hlX2Rpcl9vcGVuKHN0cnVjdCBpbm9kZSAqLCBzdHJ1Y3Qg
ZmlsZSAqKTsKZXh0ZXJuIGludCBkY2FjaGVfZGlyX2Nsb3NlKHN0cnVjdCBpbm9kZSAqLCBz
dHJ1Y3QgZmlsZSAqKTsKZXh0ZXJuIGxvZmZfdCBkY2FjaGVfZGlyX2xzZWVrKHN0cnVjdCBm
aWxlICosIGxvZmZfdCwgaW50KTsKZXh0ZXJuIGludCBkY2FjaGVfcmVhZGRpcihzdHJ1Y3Qg
ZmlsZSAqLCBzdHJ1Y3QgZGlyX2NvbnRleHQgKik7CmV4dGVybiBpbnQgc2ltcGxlX3NldGF0
dHIoc3RydWN0IGRlbnRyeSAqLCBzdHJ1Y3QgaWF0dHIgKik7CmV4dGVybiBpbnQgc2ltcGxl
X2dldGF0dHIoY29uc3Qgc3RydWN0IHBhdGggKiwgc3RydWN0IGtzdGF0ICosIHUzMiwgdW5z
aWduZWQgaW50KTsKZXh0ZXJuIGludCBzaW1wbGVfc3RhdGZzKHN0cnVjdCBkZW50cnkgKiwg
c3RydWN0IGtzdGF0ZnMgKik7CmV4dGVybiBpbnQgc2ltcGxlX29wZW4oc3RydWN0IGlub2Rl
ICppbm9kZSwgc3RydWN0IGZpbGUgKmZpbGUpOwpleHRlcm4gaW50IHNpbXBsZV9saW5rKHN0
cnVjdCBkZW50cnkgKiwgc3RydWN0IGlub2RlICosIHN0cnVjdCBkZW50cnkgKik7CmV4dGVy
biBpbnQgc2ltcGxlX3VubGluayhzdHJ1Y3QgaW5vZGUgKiwgc3RydWN0IGRlbnRyeSAqKTsK
ZXh0ZXJuIGludCBzaW1wbGVfcm1kaXIoc3RydWN0IGlub2RlICosIHN0cnVjdCBkZW50cnkg
Kik7CmV4dGVybiBpbnQgc2ltcGxlX3JlbmFtZShzdHJ1Y3QgaW5vZGUgKiwgc3RydWN0IGRl
bnRyeSAqLAogICAgc3RydWN0IGlub2RlICosIHN0cnVjdCBkZW50cnkgKiwgdW5zaWduZWQg
aW50KTsKZXh0ZXJuIHZvaWQgc2ltcGxlX3JlY3Vyc2l2ZV9yZW1vdmFsKHN0cnVjdCBkZW50
cnkgKiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdm9pZCAoKmNhbGxiYWNrKShz
dHJ1Y3QgZGVudHJ5ICopKTsKZXh0ZXJuIGludCBub29wX2ZzeW5jKHN0cnVjdCBmaWxlICos
IGxvZmZfdCwgbG9mZl90LCBpbnQpOwpleHRlcm4gaW50IG5vb3Bfc2V0X3BhZ2VfZGlydHko
c3RydWN0IHBhZ2UgKnBhZ2UpOwpleHRlcm4gdm9pZCBub29wX2ludmFsaWRhdGVwYWdlKHN0
cnVjdCBwYWdlICpwYWdlLCB1bnNpZ25lZCBpbnQgb2Zmc2V0LAogIHVuc2lnbmVkIGludCBs
ZW5ndGgpOwpleHRlcm4gc3NpemVfdCBub29wX2RpcmVjdF9JTyhzdHJ1Y3Qga2lvY2IgKmlv
Y2IsIHN0cnVjdCBpb3ZfaXRlciAqaXRlcik7CmV4dGVybiBpbnQgc2ltcGxlX2VtcHR5KHN0
cnVjdCBkZW50cnkgKik7CmV4dGVybiBpbnQgc2ltcGxlX3JlYWRwYWdlKHN0cnVjdCBmaWxl
ICpmaWxlLCBzdHJ1Y3QgcGFnZSAqcGFnZSk7CmV4dGVybiBpbnQgc2ltcGxlX3dyaXRlX2Jl
Z2luKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgYWRkcmVzc19zcGFjZSAqbWFwcGluZywK
ICAgbG9mZl90IHBvcywgdW5zaWduZWQgbGVuLCB1bnNpZ25lZCBmbGFncywKICAgc3RydWN0
IHBhZ2UgKipwYWdlcCwgdm9pZCAqKmZzZGF0YSk7CmV4dGVybiBpbnQgc2ltcGxlX3dyaXRl
X2VuZChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IGFkZHJlc3Nfc3BhY2UgKm1hcHBpbmcs
CiAgIGxvZmZfdCBwb3MsIHVuc2lnbmVkIGxlbiwgdW5zaWduZWQgY29waWVkLAogICBzdHJ1
Y3QgcGFnZSAqcGFnZSwgdm9pZCAqZnNkYXRhKTsKZXh0ZXJuIGludCBhbHdheXNfZGVsZXRl
X2RlbnRyeShjb25zdCBzdHJ1Y3QgZGVudHJ5ICopOwpleHRlcm4gc3RydWN0IGlub2RlICph
bGxvY19hbm9uX2lub2RlKHN0cnVjdCBzdXBlcl9ibG9jayAqKTsKZXh0ZXJuIGludCBzaW1w
bGVfbm9zZXRsZWFzZShzdHJ1Y3QgZmlsZSAqLCBsb25nLCBzdHJ1Y3QgZmlsZV9sb2NrICoq
LCB2b2lkICoqKTsKZXh0ZXJuIGNvbnN0IHN0cnVjdCBkZW50cnlfb3BlcmF0aW9ucyBzaW1w
bGVfZGVudHJ5X29wZXJhdGlvbnM7CgpleHRlcm4gc3RydWN0IGRlbnRyeSAqc2ltcGxlX2xv
b2t1cChzdHJ1Y3QgaW5vZGUgKiwgc3RydWN0IGRlbnRyeSAqLCB1bnNpZ25lZCBpbnQgZmxh
Z3MpOwpleHRlcm4gc3NpemVfdCBnZW5lcmljX3JlYWRfZGlyKHN0cnVjdCBmaWxlICosIGNo
YXIgKiwgc2l6ZV90LCBsb2ZmX3QgKik7CmV4dGVybiBjb25zdCBzdHJ1Y3QgZmlsZV9vcGVy
YXRpb25zIHNpbXBsZV9kaXJfb3BlcmF0aW9uczsKZXh0ZXJuIGNvbnN0IHN0cnVjdCBpbm9k
ZV9vcGVyYXRpb25zIHNpbXBsZV9kaXJfaW5vZGVfb3BlcmF0aW9uczsKZXh0ZXJuIHZvaWQg
bWFrZV9lbXB0eV9kaXJfaW5vZGUoc3RydWN0IGlub2RlICppbm9kZSk7CmV4dGVybiBib29s
IGlzX2VtcHR5X2Rpcl9pbm9kZShzdHJ1Y3QgaW5vZGUgKmlub2RlKTsKc3RydWN0IHRyZWVf
ZGVzY3IgeyBjb25zdCBjaGFyICpuYW1lOyBjb25zdCBzdHJ1Y3QgZmlsZV9vcGVyYXRpb25z
ICpvcHM7IGludCBtb2RlOyB9OwpzdHJ1Y3QgZGVudHJ5ICpkX2FsbG9jX25hbWUoc3RydWN0
IGRlbnRyeSAqLCBjb25zdCBjaGFyICopOwpleHRlcm4gaW50IHNpbXBsZV9maWxsX3N1cGVy
KHN0cnVjdCBzdXBlcl9ibG9jayAqLCB1bnNpZ25lZCBsb25nLAogICAgICAgIGNvbnN0IHN0
cnVjdCB0cmVlX2Rlc2NyICopOwpleHRlcm4gaW50IHNpbXBsZV9waW5fZnMoc3RydWN0IGZp
bGVfc3lzdGVtX3R5cGUgKiwgc3RydWN0IHZmc21vdW50ICoqbW91bnQsIGludCAqY291bnQp
OwpleHRlcm4gdm9pZCBzaW1wbGVfcmVsZWFzZV9mcyhzdHJ1Y3QgdmZzbW91bnQgKiptb3Vu
dCwgaW50ICpjb3VudCk7CgpleHRlcm4gc3NpemVfdCBzaW1wbGVfcmVhZF9mcm9tX2J1ZmZl
cih2b2lkICp0bywgc2l6ZV90IGNvdW50LAogICBsb2ZmX3QgKnBwb3MsIGNvbnN0IHZvaWQg
KmZyb20sIHNpemVfdCBhdmFpbGFibGUpOwpleHRlcm4gc3NpemVfdCBzaW1wbGVfd3JpdGVf
dG9fYnVmZmVyKHZvaWQgKnRvLCBzaXplX3QgYXZhaWxhYmxlLCBsb2ZmX3QgKnBwb3MsCiAg
Y29uc3Qgdm9pZCAqZnJvbSwgc2l6ZV90IGNvdW50KTsKCmV4dGVybiBpbnQgX19nZW5lcmlj
X2ZpbGVfZnN5bmMoc3RydWN0IGZpbGUgKiwgbG9mZl90LCBsb2ZmX3QsIGludCk7CmV4dGVy
biBpbnQgZ2VuZXJpY19maWxlX2ZzeW5jKHN0cnVjdCBmaWxlICosIGxvZmZfdCwgbG9mZl90
LCBpbnQpOwoKZXh0ZXJuIGludCBnZW5lcmljX2NoZWNrX2FkZHJlc3NhYmxlKHVuc2lnbmVk
LCB1NjQpOwoKCmV4dGVybiBpbnQgYnVmZmVyX21pZ3JhdGVfcGFnZShzdHJ1Y3QgYWRkcmVz
c19zcGFjZSAqLAogICAgc3RydWN0IHBhZ2UgKiwgc3RydWN0IHBhZ2UgKiwKICAgIGVudW0g
bWlncmF0ZV9tb2RlKTsKZXh0ZXJuIGludCBidWZmZXJfbWlncmF0ZV9wYWdlX25vcmVmcyhz
dHJ1Y3QgYWRkcmVzc19zcGFjZSAqLAogICAgc3RydWN0IHBhZ2UgKiwgc3RydWN0IHBhZ2Ug
KiwKICAgIGVudW0gbWlncmF0ZV9tb2RlKTsKCgoKCgpleHRlcm4gaW50IHNldGF0dHJfcHJl
cGFyZShzdHJ1Y3QgZGVudHJ5ICosIHN0cnVjdCBpYXR0ciAqKTsKZXh0ZXJuIGludCBpbm9k
ZV9uZXdzaXplX29rKGNvbnN0IHN0cnVjdCBpbm9kZSAqLCBsb2ZmX3Qgb2Zmc2V0KTsKZXh0
ZXJuIHZvaWQgc2V0YXR0cl9jb3B5KHN0cnVjdCBpbm9kZSAqaW5vZGUsIGNvbnN0IHN0cnVj
dCBpYXR0ciAqYXR0cik7CgpleHRlcm4gaW50IGZpbGVfdXBkYXRlX3RpbWUoc3RydWN0IGZp
bGUgKmZpbGUpOwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgdm1hX2lzX2RheChjb25zdCBzdHJ1Y3Qgdm1f
YXJlYV9zdHJ1Y3QgKnZtYSkKewogcmV0dXJuIHZtYS0+dm1fZmlsZSAmJiAoKHZtYS0+dm1f
ZmlsZS0+Zl9tYXBwaW5nLT5ob3N0KS0+aV9mbGFncyAmIDApOwp9CgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9v
bCB2bWFfaXNfZnNkYXgoc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEpCnsKIHN0cnVjdCBp
bm9kZSAqaW5vZGU7CgogaWYgKCF2bWEtPnZtX2ZpbGUpCiAgcmV0dXJuIGZhbHNlOwogaWYg
KCF2bWFfaXNfZGF4KHZtYSkpCiAgcmV0dXJuIGZhbHNlOwogaW5vZGUgPSBmaWxlX2lub2Rl
KHZtYS0+dm1fZmlsZSk7CiBpZiAoKCgoaW5vZGUtPmlfbW9kZSkgJiAwMDE3MDAwMCkgPT0g
MDAyMDAwMCkpCiAgcmV0dXJuIGZhbHNlOwogcmV0dXJuIHRydWU7Cn0KCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBp
bnQgaW9jYl9mbGFncyhzdHJ1Y3QgZmlsZSAqZmlsZSkKewogaW50IHJlcyA9IDA7CiBpZiAo
ZmlsZS0+Zl9mbGFncyAmIDAwMDAyMDAwKQogIHJlcyB8PSAoMSA8PCAxKTsKIGlmIChmaWxl
LT5mX2ZsYWdzICYgMDQwMDAwMCkKICByZXMgfD0gKDEgPDwgMik7CiBpZiAoKGZpbGUtPmZf
ZmxhZ3MgJiAwMDAxMDAwMCkgfHwgKCgoZmlsZS0+Zl9tYXBwaW5nLT5ob3N0KS0+aV9zYi0+
c19mbGFncyAmICgxNikpIHx8ICgoZmlsZS0+Zl9tYXBwaW5nLT5ob3N0KS0+aV9mbGFncyAm
IDEpKSkKICByZXMgfD0gKDEgPDwgNCk7CiBpZiAoZmlsZS0+Zl9mbGFncyAmIDA0MDAwMDAw
KQogIHJlcyB8PSAoMSA8PCA1KTsKIHJldHVybiByZXM7Cn0KCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQga2lv
Y2Jfc2V0X3J3X2ZsYWdzKHN0cnVjdCBraW9jYiAqa2ksIHJ3Zl90IGZsYWdzKQp7CiBpZiAo
X19idWlsdGluX2V4cGVjdCghIShmbGFncyAmIH4oKCggX19rZXJuZWxfcndmX3QpMHgwMDAw
MDAwMSkgfCAoKCBfX2tlcm5lbF9yd2ZfdCkweDAwMDAwMDAyKSB8ICgoIF9fa2VybmVsX3J3
Zl90KTB4MDAwMDAwMDQpIHwgKCggX19rZXJuZWxfcndmX3QpMHgwMDAwMDAwOCkgfCAoKCBf
X2tlcm5lbF9yd2ZfdCkweDAwMDAwMDEwKSkpLCAwKSkKICByZXR1cm4gLTk1OwoKIGlmIChm
bGFncyAmICgoIF9fa2VybmVsX3J3Zl90KTB4MDAwMDAwMDgpKSB7CiAgaWYgKCEoa2ktPmtp
X2ZpbHAtPmZfbW9kZSAmICgoIGZtb2RlX3QpMHg4MDAwMDAwKSkpCiAgIHJldHVybiAtOTU7
CiAga2ktPmtpX2ZsYWdzIHw9ICgxIDw8IDcpOwogfQogaWYgKGZsYWdzICYgKCggX19rZXJu
ZWxfcndmX3QpMHgwMDAwMDAwMSkpCiAga2ktPmtpX2ZsYWdzIHw9ICgxIDw8IDMpOwogaWYg
KGZsYWdzICYgKCggX19rZXJuZWxfcndmX3QpMHgwMDAwMDAwMikpCiAga2ktPmtpX2ZsYWdz
IHw9ICgxIDw8IDQpOwogaWYgKGZsYWdzICYgKCggX19rZXJuZWxfcndmX3QpMHgwMDAwMDAw
NCkpCiAga2ktPmtpX2ZsYWdzIHw9ICgoMSA8PCA0KSB8ICgxIDw8IDUpKTsKIGlmIChmbGFn
cyAmICgoIF9fa2VybmVsX3J3Zl90KTB4MDAwMDAwMTApKQogIGtpLT5raV9mbGFncyB8PSAo
MSA8PCAxKTsKIHJldHVybiAwOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW5vX3QgcGFyZW50X2lubyhzdHJ1
Y3QgZGVudHJ5ICpkZW50cnkpCnsKIGlub190IHJlczsKCgoKCgogc3Bpbl9sb2NrKCZkZW50
cnktPmRfbG9ja3JlZi5sb2NrKTsKIHJlcyA9IGRlbnRyeS0+ZF9wYXJlbnQtPmRfaW5vZGUt
PmlfaW5vOwogc3Bpbl91bmxvY2soJmRlbnRyeS0+ZF9sb2NrcmVmLmxvY2spOwogcmV0dXJu
IHJlczsKfQoKCgoKCgoKc3RydWN0IHNpbXBsZV90cmFuc2FjdGlvbl9hcmdyZXNwIHsKIHNz
aXplX3Qgc2l6ZTsKIGNoYXIgZGF0YVswXTsKfTsKCgoKY2hhciAqc2ltcGxlX3RyYW5zYWN0
aW9uX2dldChzdHJ1Y3QgZmlsZSAqZmlsZSwgY29uc3QgY2hhciAqYnVmLAogICAgc2l6ZV90
IHNpemUpOwpzc2l6ZV90IHNpbXBsZV90cmFuc2FjdGlvbl9yZWFkKHN0cnVjdCBmaWxlICpm
aWxlLCBjaGFyICpidWYsCiAgICBzaXplX3Qgc2l6ZSwgbG9mZl90ICpwb3MpOwppbnQgc2lt
cGxlX3RyYW5zYWN0aW9uX3JlbGVhc2Uoc3RydWN0IGlub2RlICppbm9kZSwgc3RydWN0IGZp
bGUgKmZpbGUpOwoKdm9pZCBzaW1wbGVfdHJhbnNhY3Rpb25fc2V0KHN0cnVjdCBmaWxlICpm
aWxlLCBzaXplX3Qgbik7CiMgMzUyNiAiLi9pbmNsdWRlL2xpbnV4L2ZzLmgiCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBfX2F0dHJpYnV0ZV9fKChfX2Zvcm1hdF9fKHByaW50ZiwgMSwgMikpKQp2b2lkIF9fc2lt
cGxlX2F0dHJfY2hlY2tfZm9ybWF0KGNvbnN0IGNoYXIgKmZtdCwgLi4uKQp7Cgp9CgppbnQg
c2ltcGxlX2F0dHJfb3BlbihzdHJ1Y3QgaW5vZGUgKmlub2RlLCBzdHJ1Y3QgZmlsZSAqZmls
ZSwKICAgICAgIGludCAoKmdldCkodm9pZCAqLCB1NjQgKiksIGludCAoKnNldCkodm9pZCAq
LCB1NjQpLAogICAgICAgY29uc3QgY2hhciAqZm10KTsKaW50IHNpbXBsZV9hdHRyX3JlbGVh
c2Uoc3RydWN0IGlub2RlICppbm9kZSwgc3RydWN0IGZpbGUgKmZpbGUpOwpzc2l6ZV90IHNp
bXBsZV9hdHRyX3JlYWQoc3RydWN0IGZpbGUgKmZpbGUsIGNoYXIgKmJ1ZiwKICAgIHNpemVf
dCBsZW4sIGxvZmZfdCAqcHBvcyk7CnNzaXplX3Qgc2ltcGxlX2F0dHJfd3JpdGUoc3RydWN0
IGZpbGUgKmZpbGUsIGNvbnN0IGNoYXIgKmJ1ZiwKICAgICBzaXplX3QgbGVuLCBsb2ZmX3Qg
KnBwb3MpOwoKc3RydWN0IGN0bF90YWJsZTsKaW50IHByb2NfbnJfZmlsZXMoc3RydWN0IGN0
bF90YWJsZSAqdGFibGUsIGludCB3cml0ZSwKICAgIHZvaWQgKmJ1ZmZlciwgc2l6ZV90ICps
ZW5wLCBsb2ZmX3QgKnBwb3MpOwppbnQgcHJvY19ucl9kZW50cnkoc3RydWN0IGN0bF90YWJs
ZSAqdGFibGUsIGludCB3cml0ZSwKICAgIHZvaWQgKmJ1ZmZlciwgc2l6ZV90ICpsZW5wLCBs
b2ZmX3QgKnBwb3MpOwppbnQgcHJvY19ucl9pbm9kZXMoc3RydWN0IGN0bF90YWJsZSAqdGFi
bGUsIGludCB3cml0ZSwKICAgICB2b2lkICpidWZmZXIsIHNpemVfdCAqbGVucCwgbG9mZl90
ICpwcG9zKTsKaW50IF9fYXR0cmlidXRlX18oKF9fc2VjdGlvbl9fKCIuaW5pdC50ZXh0Iikp
KSBfX2F0dHJpYnV0ZV9fKChfX2NvbGRfXykpIGdldF9maWxlc3lzdGVtX2xpc3QoY2hhciAq
YnVmKTsKIyAzNTU3ICIuL2luY2x1ZGUvbGludXgvZnMuaCIKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgaXNf
c3hpZCh1bW9kZV90IG1vZGUpCnsKIHJldHVybiAobW9kZSAmIDAwMDQwMDApIHx8ICgobW9k
ZSAmIDAwMDIwMDApICYmIChtb2RlICYgMDAwMTApKTsKfQoKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBjaGVj
a19zdGlja3koc3RydWN0IGlub2RlICpkaXIsIHN0cnVjdCBpbm9kZSAqaW5vZGUpCnsKIGlm
ICghKGRpci0+aV9tb2RlICYgMDAwMTAwMCkpCiAgcmV0dXJuIDA7CgogcmV0dXJuIF9fY2hl
Y2tfc3RpY2t5KGRpciwgaW5vZGUpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBpbm9kZV9oYXNfbm9f
eGF0dHIoc3RydWN0IGlub2RlICppbm9kZSkKewogaWYgKCFpc19zeGlkKGlub2RlLT5pX21v
ZGUpICYmIChpbm9kZS0+aV9zYi0+c19mbGFncyAmICgxPDwyOCkpKQogIGlub2RlLT5pX2Zs
YWdzIHw9IDQwOTY7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIGlzX3Jvb3RfaW5vZGUoc3RydWN0IGlu
b2RlICppbm9kZSkKewogcmV0dXJuIGlub2RlID09IGlub2RlLT5pX3NiLT5zX3Jvb3QtPmRf
aW5vZGU7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIGRpcl9lbWl0KHN0cnVjdCBkaXJfY29udGV4dCAq
Y3R4LAogICAgICAgY29uc3QgY2hhciAqbmFtZSwgaW50IG5hbWVsZW4sCiAgICAgICB1NjQg
aW5vLCB1bnNpZ25lZCB0eXBlKQp7CiByZXR1cm4gY3R4LT5hY3RvcihjdHgsIG5hbWUsIG5h
bWVsZW4sIGN0eC0+cG9zLCBpbm8sIHR5cGUpID09IDA7Cn0Kc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgZGly
X2VtaXRfZG90KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgZGlyX2NvbnRleHQgKmN0eCkK
ewogcmV0dXJuIGN0eC0+YWN0b3IoY3R4LCAiLiIsIDEsIGN0eC0+cG9zLAogICAgIGZpbGUt
PmZfcGF0aC5kZW50cnktPmRfaW5vZGUtPmlfaW5vLCA0KSA9PSAwOwp9CnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBi
b29sIGRpcl9lbWl0X2RvdGRvdChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IGRpcl9jb250
ZXh0ICpjdHgpCnsKIHJldHVybiBjdHgtPmFjdG9yKGN0eCwgIi4uIiwgMiwgY3R4LT5wb3Ms
CiAgICAgcGFyZW50X2lubyhmaWxlLT5mX3BhdGguZGVudHJ5KSwgNCkgPT0gMDsKfQpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgYm9vbCBkaXJfZW1pdF9kb3RzKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgZGly
X2NvbnRleHQgKmN0eCkKewogaWYgKGN0eC0+cG9zID09IDApIHsKICBpZiAoIWRpcl9lbWl0
X2RvdChmaWxlLCBjdHgpKQogICByZXR1cm4gZmFsc2U7CiAgY3R4LT5wb3MgPSAxOwogfQog
aWYgKGN0eC0+cG9zID09IDEpIHsKICBpZiAoIWRpcl9lbWl0X2RvdGRvdChmaWxlLCBjdHgp
KQogICByZXR1cm4gZmFsc2U7CiAgY3R4LT5wb3MgPSAyOwogfQogcmV0dXJuIHRydWU7Cn0K
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIGJvb2wgZGlyX3JlbGF4KHN0cnVjdCBpbm9kZSAqaW5vZGUpCnsKIGlub2Rl
X3VubG9jayhpbm9kZSk7CiBpbm9kZV9sb2NrKGlub2RlKTsKIHJldHVybiAhKChpbm9kZSkt
PmlfZmxhZ3MgJiAxNik7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIGRpcl9yZWxheF9zaGFyZWQoc3Ry
dWN0IGlub2RlICppbm9kZSkKewogaW5vZGVfdW5sb2NrX3NoYXJlZChpbm9kZSk7CiBpbm9k
ZV9sb2NrX3NoYXJlZChpbm9kZSk7CiByZXR1cm4gISgoaW5vZGUpLT5pX2ZsYWdzICYgMTYp
Owp9CgpleHRlcm4gYm9vbCBwYXRoX25vZXhlYyhjb25zdCBzdHJ1Y3QgcGF0aCAqcGF0aCk7
CmV4dGVybiB2b2lkIGlub2RlX25vaGlnaG1lbShzdHJ1Y3QgaW5vZGUgKmlub2RlKTsKCgpl
eHRlcm4gaW50IHZmc19mYWR2aXNlKHN0cnVjdCBmaWxlICpmaWxlLCBsb2ZmX3Qgb2Zmc2V0
LCBsb2ZmX3QgbGVuLAogICAgICAgICBpbnQgYWR2aWNlKTsKZXh0ZXJuIGludCBnZW5lcmlj
X2ZhZHZpc2Uoc3RydWN0IGZpbGUgKmZpbGUsIGxvZmZfdCBvZmZzZXQsIGxvZmZfdCBsZW4s
CiAgICAgIGludCBhZHZpY2UpOwoKCmV4dGVybiBzdHJ1Y3Qgc29jayAqaW9fdXJpbmdfZ2V0
X3NvY2tldChzdHJ1Y3QgZmlsZSAqZmlsZSk7CgoKCgoKCgppbnQgdmZzX2lvY19zZXRmbGFn
c19wcmVwYXJlKHN0cnVjdCBpbm9kZSAqaW5vZGUsIHVuc2lnbmVkIGludCBvbGRmbGFncywK
ICAgICAgICB1bnNpZ25lZCBpbnQgZmxhZ3MpOwoKaW50IHZmc19pb2NfZnNzZXR4YXR0cl9j
aGVjayhzdHJ1Y3QgaW5vZGUgKmlub2RlLCBjb25zdCBzdHJ1Y3QgZnN4YXR0ciAqb2xkX2Zh
LAogICAgICAgIHN0cnVjdCBmc3hhdHRyICpmYSk7CgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBzaW1wbGVf
ZmlsbF9mc3hhdHRyKHN0cnVjdCBmc3hhdHRyICpmYSwgX191MzIgeGZsYWdzKQp7CiBtZW1z
ZXQoZmEsIDAsIHNpemVvZigqZmEpKTsKIGZhLT5mc3hfeGZsYWdzID0geGZsYWdzOwp9CgoK
CgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSBpbnQgaW5vZGVfZHJhaW5fd3JpdGVzKHN0cnVjdCBpbm9kZSAqaW5v
ZGUpCnsKIGlub2RlX2Rpb193YWl0KGlub2RlKTsKIHJldHVybiBmaWxlbWFwX3dyaXRlX2Fu
ZF93YWl0KGlub2RlLT5pX21hcHBpbmcpOwp9CiMgOSAiLi9pbmNsdWRlL2xpbnV4L2h1Z2Vf
bW0uaCIgMgoKZXh0ZXJuIHZtX2ZhdWx0X3QgZG9faHVnZV9wbWRfYW5vbnltb3VzX3BhZ2Uo
c3RydWN0IHZtX2ZhdWx0ICp2bWYpOwpleHRlcm4gaW50IGNvcHlfaHVnZV9wbWQoc3RydWN0
IG1tX3N0cnVjdCAqZHN0X21tLCBzdHJ1Y3QgbW1fc3RydWN0ICpzcmNfbW0sCiAgICBwbWRf
dCAqZHN0X3BtZCwgcG1kX3QgKnNyY19wbWQsIHVuc2lnbmVkIGxvbmcgYWRkciwKICAgIHN0
cnVjdCB2bV9hcmVhX3N0cnVjdCAqdm1hKTsKZXh0ZXJuIHZvaWQgaHVnZV9wbWRfc2V0X2Fj
Y2Vzc2VkKHN0cnVjdCB2bV9mYXVsdCAqdm1mLCBwbWRfdCBvcmlnX3BtZCk7CmV4dGVybiBp
bnQgY29weV9odWdlX3B1ZChzdHJ1Y3QgbW1fc3RydWN0ICpkc3RfbW0sIHN0cnVjdCBtbV9z
dHJ1Y3QgKnNyY19tbSwKICAgIHB1ZF90ICpkc3RfcHVkLCBwdWRfdCAqc3JjX3B1ZCwgdW5z
aWduZWQgbG9uZyBhZGRyLAogICAgc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEpOwoKCgoK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIHZvaWQgaHVnZV9wdWRfc2V0X2FjY2Vzc2VkKHN0cnVjdCB2bV9mYXVsdCAq
dm1mLCBwdWRfdCBvcmlnX3B1ZCkKewp9CgoKZXh0ZXJuIHZtX2ZhdWx0X3QgZG9faHVnZV9w
bWRfd3BfcGFnZShzdHJ1Y3Qgdm1fZmF1bHQgKnZtZiwgcG1kX3Qgb3JpZ19wbWQpOwpleHRl
cm4gc3RydWN0IHBhZ2UgKmZvbGxvd190cmFuc19odWdlX3BtZChzdHJ1Y3Qgdm1fYXJlYV9z
dHJ1Y3QgKnZtYSwKICAgICAgIHVuc2lnbmVkIGxvbmcgYWRkciwKICAgICAgIHBtZF90ICpw
bWQsCiAgICAgICB1bnNpZ25lZCBpbnQgZmxhZ3MpOwpleHRlcm4gYm9vbCBtYWR2aXNlX2Zy
ZWVfaHVnZV9wbWQoc3RydWN0IG1tdV9nYXRoZXIgKnRsYiwKICAgc3RydWN0IHZtX2FyZWFf
c3RydWN0ICp2bWEsCiAgIHBtZF90ICpwbWQsIHVuc2lnbmVkIGxvbmcgYWRkciwgdW5zaWdu
ZWQgbG9uZyBuZXh0KTsKZXh0ZXJuIGludCB6YXBfaHVnZV9wbWQoc3RydWN0IG1tdV9nYXRo
ZXIgKnRsYiwKICAgc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEsCiAgIHBtZF90ICpwbWQs
IHVuc2lnbmVkIGxvbmcgYWRkcik7CmV4dGVybiBpbnQgemFwX2h1Z2VfcHVkKHN0cnVjdCBt
bXVfZ2F0aGVyICp0bGIsCiAgIHN0cnVjdCB2bV9hcmVhX3N0cnVjdCAqdm1hLAogICBwdWRf
dCAqcHVkLCB1bnNpZ25lZCBsb25nIGFkZHIpOwpleHRlcm4gaW50IG1pbmNvcmVfaHVnZV9w
bWQoc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEsIHBtZF90ICpwbWQsCiAgIHVuc2lnbmVk
IGxvbmcgYWRkciwgdW5zaWduZWQgbG9uZyBlbmQsCiAgIHVuc2lnbmVkIGNoYXIgKnZlYyk7
CmV4dGVybiBib29sIG1vdmVfaHVnZV9wbWQoc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEs
IHVuc2lnbmVkIGxvbmcgb2xkX2FkZHIsCiAgICB1bnNpZ25lZCBsb25nIG5ld19hZGRyLCB1
bnNpZ25lZCBsb25nIG9sZF9lbmQsCiAgICBwbWRfdCAqb2xkX3BtZCwgcG1kX3QgKm5ld19w
bWQpOwpleHRlcm4gaW50IGNoYW5nZV9odWdlX3BtZChzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3Qg
KnZtYSwgcG1kX3QgKnBtZCwKICAgdW5zaWduZWQgbG9uZyBhZGRyLCBwZ3Byb3RfdCBuZXdw
cm90LAogICB1bnNpZ25lZCBsb25nIGNwX2ZsYWdzKTsKdm1fZmF1bHRfdCB2bWZfaW5zZXJ0
X3Bmbl9wbWRfcHJvdChzdHJ1Y3Qgdm1fZmF1bHQgKnZtZiwgcGZuX3QgcGZuLAogICAgICAg
cGdwcm90X3QgcGdwcm90LCBib29sIHdyaXRlKTsKIyA2NCAiLi9pbmNsdWRlL2xpbnV4L2h1
Z2VfbW0uaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHZtX2ZhdWx0X3Qgdm1mX2luc2VydF9wZm5fcG1kKHN0cnVj
dCB2bV9mYXVsdCAqdm1mLCBwZm5fdCBwZm4sCiAgICAgICAgIGJvb2wgd3JpdGUpCnsKIHJl
dHVybiB2bWZfaW5zZXJ0X3Bmbl9wbWRfcHJvdCh2bWYsIHBmbiwgdm1mLT52bWEtPnZtX3Bh
Z2VfcHJvdCwgd3JpdGUpOwp9CnZtX2ZhdWx0X3Qgdm1mX2luc2VydF9wZm5fcHVkX3Byb3Qo
c3RydWN0IHZtX2ZhdWx0ICp2bWYsIHBmbl90IHBmbiwKICAgICAgIHBncHJvdF90IHBncHJv
dCwgYm9vbCB3cml0ZSk7CiMgODMgIi4vaW5jbHVkZS9saW51eC9odWdlX21tLmgiCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSB2bV9mYXVsdF90IHZtZl9pbnNlcnRfcGZuX3B1ZChzdHJ1Y3Qgdm1fZmF1bHQgKnZt
ZiwgcGZuX3QgcGZuLAogICAgICAgICBib29sIHdyaXRlKQp7CiByZXR1cm4gdm1mX2luc2Vy
dF9wZm5fcHVkX3Byb3Qodm1mLCBwZm4sIHZtZi0+dm1hLT52bV9wYWdlX3Byb3QsIHdyaXRl
KTsKfQoKZW51bSB0cmFuc3BhcmVudF9odWdlcGFnZV9mbGFnIHsKIFRSQU5TUEFSRU5UX0hV
R0VQQUdFX0ZMQUcsCiBUUkFOU1BBUkVOVF9IVUdFUEFHRV9SRVFfTUFEVl9GTEFHLAogVFJB
TlNQQVJFTlRfSFVHRVBBR0VfREVGUkFHX0RJUkVDVF9GTEFHLAogVFJBTlNQQVJFTlRfSFVH
RVBBR0VfREVGUkFHX0tTV0FQRF9GTEFHLAogVFJBTlNQQVJFTlRfSFVHRVBBR0VfREVGUkFH
X0tTV0FQRF9PUl9NQURWX0ZMQUcsCiBUUkFOU1BBUkVOVF9IVUdFUEFHRV9ERUZSQUdfUkVR
X01BRFZfRkxBRywKIFRSQU5TUEFSRU5UX0hVR0VQQUdFX0RFRlJBR19LSFVHRVBBR0VEX0ZM
QUcsCiBUUkFOU1BBUkVOVF9IVUdFUEFHRV9VU0VfWkVST19QQUdFX0ZMQUcsCgoKCn07Cgpz
dHJ1Y3Qga29iamVjdDsKc3RydWN0IGtvYmpfYXR0cmlidXRlOwoKZXh0ZXJuIHNzaXplX3Qg
c2luZ2xlX2h1Z2VwYWdlX2ZsYWdfc3RvcmUoc3RydWN0IGtvYmplY3QgKmtvYmosCiAgICAg
c3RydWN0IGtvYmpfYXR0cmlidXRlICphdHRyLAogICAgIGNvbnN0IGNoYXIgKmJ1Ziwgc2l6
ZV90IGNvdW50LAogICAgIGVudW0gdHJhbnNwYXJlbnRfaHVnZXBhZ2VfZmxhZyBmbGFnKTsK
ZXh0ZXJuIHNzaXplX3Qgc2luZ2xlX2h1Z2VwYWdlX2ZsYWdfc2hvdyhzdHJ1Y3Qga29iamVj
dCAqa29iaiwKICAgIHN0cnVjdCBrb2JqX2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVmLAog
ICAgZW51bSB0cmFuc3BhcmVudF9odWdlcGFnZV9mbGFnIGZsYWcpOwpleHRlcm4gc3RydWN0
IGtvYmpfYXR0cmlidXRlIHNobWVtX2VuYWJsZWRfYXR0cjsKIyAzMjcgIi4vaW5jbHVkZS9s
aW51eC9odWdlX21tLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgaHBhZ2VfbnJfcGFnZXMoc3RydWN0IHBh
Z2UgKnBhZ2UpCnsKICgodm9pZCkoc2l6ZW9mKCggbG9uZykoUGFnZVRhaWwocGFnZSkpKSkp
OwogcmV0dXJuIDE7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIF9fdHJhbnNwYXJlbnRfaHVnZXBhZ2Vf
ZW5hYmxlZChzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnZtYSkKewogcmV0dXJuIGZhbHNlOwp9
CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgYm9vbCB0cmFuc3BhcmVudF9odWdlcGFnZV9lbmFibGVkKHN0cnVjdCB2
bV9hcmVhX3N0cnVjdCAqdm1hKQp7CiByZXR1cm4gZmFsc2U7Cn0KCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29s
IHRyYW5zaHVnZV92bWFfc3VpdGFibGUoc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEsCiAg
dW5zaWduZWQgbG9uZyBoYWRkcikKewogcmV0dXJuIGZhbHNlOwp9CgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9p
ZCBwcmVwX3RyYW5zaHVnZV9wYWdlKHN0cnVjdCBwYWdlICpwYWdlKSB7fQoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IGJvb2wgaXNfdHJhbnNwYXJlbnRfaHVnZXBhZ2Uoc3RydWN0IHBhZ2UgKnBhZ2UpCnsKIHJl
dHVybiBmYWxzZTsKfQoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKQoKIyAzNjAgIi4vaW5jbHVkZS9saW51eC9o
dWdlX21tLmgiCiAgICAgICAgICAgICAgYm9vbApjYW5fc3BsaXRfaHVnZV9wYWdlKHN0cnVj
dCBwYWdlICpwYWdlLCBpbnQgKnBleHRyYV9waW5zKQp7CiBkbyB7IGV4dGVybiB2b2lkIF9f
Y29tcGlsZXRpbWVfYXNzZXJ0XzE3Mih2b2lkKSBfX2F0dHJpYnV0ZV9fKChfX2Vycm9yX18o
IkJVSUxEX0JVRyBmYWlsZWQiKSkpOyBpZiAoISghKDEpKSkgX19jb21waWxldGltZV9hc3Nl
cnRfMTcyKCk7IH0gd2hpbGUgKDApOwogcmV0dXJuIGZhbHNlOwp9CnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQK
c3BsaXRfaHVnZV9wYWdlX3RvX2xpc3Qoc3RydWN0IHBhZ2UgKnBhZ2UsIHN0cnVjdCBsaXN0
X2hlYWQgKmxpc3QpCnsKIHJldHVybiAwOwp9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgc3BsaXRfaHVnZV9w
YWdlKHN0cnVjdCBwYWdlICpwYWdlKQp7CiByZXR1cm4gMDsKfQpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBk
ZWZlcnJlZF9zcGxpdF9odWdlX3BhZ2Uoc3RydWN0IHBhZ2UgKnBhZ2UpIHt9CgoKCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSB2b2lkIF9fc3BsaXRfaHVnZV9wbWQoc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEs
IHBtZF90ICpwbWQsCiAgdW5zaWduZWQgbG9uZyBhZGRyZXNzLCBib29sIGZyZWV6ZSwgc3Ry
dWN0IHBhZ2UgKnBhZ2UpIHt9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHNwbGl0X2h1Z2VfcG1kX2FkZHJl
c3Moc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEsCiAgdW5zaWduZWQgbG9uZyBhZGRyZXNz
LCBib29sIGZyZWV6ZSwgc3RydWN0IHBhZ2UgKnBhZ2UpIHt9CgoKCgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50
IGh1Z2VwYWdlX21hZHZpc2Uoc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEsCiAgICAgICB1
bnNpZ25lZCBsb25nICp2bV9mbGFncywgaW50IGFkdmljZSkKewogZG8geyBfX2FzbV9fIF9f
dm9sYXRpbGVfXyggIjE6CSIgInR3aSAzMSwgMCwgMCIgIlxuIiAiLnNlY3Rpb24gX19idWdf
dGFibGUsXCJhd1wiXG4iICIyOlx0IiAiLjhieXRlIiAiICIgIjFiLCAlMFxuIiAiXHQuc2hv
cnQgJTEsICUyXG4iICIub3JnIDJiKyUzXG4iICIucHJldmlvdXNcbiIgOiA6ICJpIiAoIi4v
aW5jbHVkZS9saW51eC9odWdlX21tLmgiKSwgImkiICgzOTApLCAiaSIgKDApLCAiaSIgKHNp
emVvZihzdHJ1Y3QgYnVnX2VudHJ5KSkpOyBkbyB7IDsgYXNtIHZvbGF0aWxlKCIiKTsgX19i
dWlsdGluX3VucmVhY2hhYmxlKCk7IH0gd2hpbGUgKDApOyB9IHdoaWxlICgwKTsKIHJldHVy
biAwOwp9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSB2b2lkIHZtYV9hZGp1c3RfdHJhbnNfaHVnZShzdHJ1Y3Qgdm1f
YXJlYV9zdHJ1Y3QgKnZtYSwKICAgICAgdW5zaWduZWQgbG9uZyBzdGFydCwKICAgICAgdW5z
aWduZWQgbG9uZyBlbmQsCiAgICAgIGxvbmcgYWRqdXN0X25leHQpCnsKfQpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
aW50IGlzX3N3YXBfcG1kKHBtZF90IHBtZCkKewogcmV0dXJuIDA7Cn0Kc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHNw
aW5sb2NrX3QgKnBtZF90cmFuc19odWdlX2xvY2socG1kX3QgKnBtZCwKICBzdHJ1Y3Qgdm1f
YXJlYV9zdHJ1Y3QgKnZtYSkKewogcmV0dXJuICgodm9pZCAqKTApOwp9CnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBz
cGlubG9ja190ICpwdWRfdHJhbnNfaHVnZV9sb2NrKHB1ZF90ICpwdWQsCiAgc3RydWN0IHZt
X2FyZWFfc3RydWN0ICp2bWEpCnsKIHJldHVybiAoKHZvaWQgKikwKTsKfQoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IHZtX2ZhdWx0X3QgZG9faHVnZV9wbWRfbnVtYV9wYWdlKHN0cnVjdCB2bV9mYXVsdCAqdm1m
LAogIHBtZF90IG9yaWdfcG1kKQp7CiByZXR1cm4gMDsKfQoKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgaXNf
aHVnZV96ZXJvX3BhZ2Uoc3RydWN0IHBhZ2UgKnBhZ2UpCnsKIHJldHVybiBmYWxzZTsKfQoK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIGJvb2wgaXNfaHVnZV96ZXJvX3B1ZChwdWRfdCBwdWQpCnsKIHJldHVybiBm
YWxzZTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgbW1fcHV0X2h1Z2VfemVyb19wYWdlKHN0cnVjdCBt
bV9zdHJ1Y3QgKm1tKQp7CiByZXR1cm47Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3QgcGFnZSAqZm9s
bG93X2Rldm1hcF9wbWQoc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEsCiB1bnNpZ25lZCBs
b25nIGFkZHIsIHBtZF90ICpwbWQsIGludCBmbGFncywgc3RydWN0IGRldl9wYWdlbWFwICoq
cGdtYXApCnsKIHJldHVybiAoKHZvaWQgKikwKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHN0cnVjdCBwYWdl
ICpmb2xsb3dfZGV2bWFwX3B1ZChzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnZtYSwKIHVuc2ln
bmVkIGxvbmcgYWRkciwgcHVkX3QgKnB1ZCwgaW50IGZsYWdzLCBzdHJ1Y3QgZGV2X3BhZ2Vt
YXAgKipwZ21hcCkKewogcmV0dXJuICgodm9pZCAqKTApOwp9CgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCB0
aHBfbWlncmF0aW9uX3N1cHBvcnRlZCh2b2lkKQp7CiByZXR1cm4gZmFsc2U7Cn0KIyA2NzYg
Ii4vaW5jbHVkZS9saW51eC9tbS5oIiAyCiMgNjkzICIuL2luY2x1ZGUvbGludXgvbW0uaCIK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIGludCBwdXRfcGFnZV90ZXN0emVybyhzdHJ1Y3QgcGFnZSAqcGFnZSkKewog
KCh2b2lkKShzaXplb2YoKCBsb25nKShwYWdlX3JlZl9jb3VudChwYWdlKSA9PSAwKSkpKTsK
IHJldHVybiBwYWdlX3JlZl9kZWNfYW5kX3Rlc3QocGFnZSk7Cn0KCgoKCgoKCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBpbnQgZ2V0X3BhZ2VfdW5sZXNzX3plcm8oc3RydWN0IHBhZ2UgKnBhZ2UpCnsKIHJldHVy
biBwYWdlX3JlZl9hZGRfdW5sZXNzKHBhZ2UsIDEsIDApOwp9CgpleHRlcm4gaW50IHBhZ2Vf
aXNfcmFtKHVuc2lnbmVkIGxvbmcgcGZuKTsKCmVudW0gewogUkVHSU9OX0lOVEVSU0VDVFMs
CiBSRUdJT05fRElTSk9JTlQsCiBSRUdJT05fTUlYRUQsCn07CgppbnQgcmVnaW9uX2ludGVy
c2VjdHMocmVzb3VyY2Vfc2l6ZV90IG9mZnNldCwgc2l6ZV90IHNpemUsIHVuc2lnbmVkIGxv
bmcgZmxhZ3MsCiAgICAgICAgdW5zaWduZWQgbG9uZyBkZXNjKTsKCgpzdHJ1Y3QgcGFnZSAq
dm1hbGxvY190b19wYWdlKGNvbnN0IHZvaWQgKmFkZHIpOwp1bnNpZ25lZCBsb25nIHZtYWxs
b2NfdG9fcGZuKGNvbnN0IHZvaWQgKmFkZHIpOwojIDczNyAiLi9pbmNsdWRlL2xpbnV4L21t
LmgiCmV4dGVybiBib29sIGlzX3ZtYWxsb2NfYWRkcihjb25zdCB2b2lkICp4KTsKZXh0ZXJu
IGludCBpc192bWFsbG9jX29yX21vZHVsZV9hZGRyKGNvbnN0IHZvaWQgKngpOwojIDc1MCAi
Li9pbmNsdWRlL2xpbnV4L21tLmgiCmV4dGVybiB2b2lkICprdm1hbGxvY19ub2RlKHNpemVf
dCBzaXplLCBnZnBfdCBmbGFncywgaW50IG5vZGUpOwpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCAqa3ZtYWxs
b2Moc2l6ZV90IHNpemUsIGdmcF90IGZsYWdzKQp7CiByZXR1cm4ga3ZtYWxsb2Nfbm9kZShz
aXplLCBmbGFncywgKC0xKSk7Cn0Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgKmt2emFsbG9jX25vZGUoc2l6
ZV90IHNpemUsIGdmcF90IGZsYWdzLCBpbnQgbm9kZSkKewogcmV0dXJuIGt2bWFsbG9jX25v
ZGUoc2l6ZSwgZmxhZ3MgfCAoKCBnZnBfdCkweDEwMHUpLCBub2RlKTsKfQpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
dm9pZCAqa3Z6YWxsb2Moc2l6ZV90IHNpemUsIGdmcF90IGZsYWdzKQp7CiByZXR1cm4ga3Zt
YWxsb2Moc2l6ZSwgZmxhZ3MgfCAoKCBnZnBfdCkweDEwMHUpKTsKfQoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZv
aWQgKmt2bWFsbG9jX2FycmF5KHNpemVfdCBuLCBzaXplX3Qgc2l6ZSwgZ2ZwX3QgZmxhZ3Mp
CnsKIHNpemVfdCBieXRlczsKCiBpZiAoX19idWlsdGluX2V4cGVjdCghIShfX2J1aWx0aW5f
Y2hvb3NlX2V4cHIoKCgodHlwZW9mKG4pKSgtMSkpIDwgKHR5cGVvZihuKSkxKSwgKHsgdHlw
ZW9mKG4pIF9fYSA9IChuKTsgdHlwZW9mKHNpemUpIF9fYiA9IChzaXplKTsgdHlwZW9mKCZi
eXRlcykgX19kID0gKCZieXRlcyk7IHR5cGVvZihuKSBfX3RtYXggPSAoKHR5cGVvZihuKSko
KCgodHlwZW9mKG4pKTEgPDwgKDgqc2l6ZW9mKHR5cGVvZihuKSkgLSAxIC0gKCgodHlwZW9m
KG4pKSgtMSkpIDwgKHR5cGVvZihuKSkxKSkpIC0gMSkgKyAoKHR5cGVvZihuKSkxIDw8ICg4
KnNpemVvZih0eXBlb2YobikpIC0gMSAtICgoKHR5cGVvZihuKSkoLTEpKSA8ICh0eXBlb2Yo
bikpMSkpKSkpOyB0eXBlb2YobikgX190bWluID0gKCh0eXBlb2YobikpKCh0eXBlb2Yobikp
LSgodHlwZW9mKG4pKSgoKCh0eXBlb2YobikpMSA8PCAoOCpzaXplb2YodHlwZW9mKG4pKSAt
IDEgLSAoKCh0eXBlb2YobikpKC0xKSkgPCAodHlwZW9mKG4pKTEpKSkgLSAxKSArICgodHlw
ZW9mKG4pKTEgPDwgKDgqc2l6ZW9mKHR5cGVvZihuKSkgLSAxIC0gKCgodHlwZW9mKG4pKSgt
MSkpIDwgKHR5cGVvZihuKSkxKSkpKSktKHR5cGVvZihuKSkxKSk7ICh2b2lkKSAoJl9fYSA9
PSAmX19iKTsgKHZvaWQpICgmX19hID09IF9fZCk7ICpfX2QgPSAodTY0KV9fYSAqICh1NjQp
X19iOyAoX19iID4gMCAmJiAoX19hID4gX190bWF4L19fYiB8fCBfX2EgPCBfX3RtaW4vX19i
KSkgfHwgKF9fYiA8ICh0eXBlb2YoX19iKSktMSAmJiAoX19hID4gX190bWluL19fYiB8fCBf
X2EgPCBfX3RtYXgvX19iKSkgfHwgKF9fYiA9PSAodHlwZW9mKF9fYikpLTEgJiYgX19hID09
IF9fdG1pbik7IH0pLCAoeyB0eXBlb2YobikgX19hID0gKG4pOyB0eXBlb2Yoc2l6ZSkgX19i
ID0gKHNpemUpOyB0eXBlb2YoJmJ5dGVzKSBfX2QgPSAoJmJ5dGVzKTsgKHZvaWQpICgmX19h
ID09ICZfX2IpOyAodm9pZCkgKCZfX2EgPT0gX19kKTsgKl9fZCA9IF9fYSAqIF9fYjsgX19i
dWlsdGluX2NvbnN0YW50X3AoX19iKSA/IF9fYiA+IDAgJiYgX19hID4gKCh0eXBlb2YoX19h
KSkoKCgodHlwZW9mKF9fYSkpMSA8PCAoOCpzaXplb2YodHlwZW9mKF9fYSkpIC0gMSAtICgo
KHR5cGVvZihfX2EpKSgtMSkpIDwgKHR5cGVvZihfX2EpKTEpKSkgLSAxKSArICgodHlwZW9m
KF9fYSkpMSA8PCAoOCpzaXplb2YodHlwZW9mKF9fYSkpIC0gMSAtICgoKHR5cGVvZihfX2Ep
KSgtMSkpIDwgKHR5cGVvZihfX2EpKTEpKSkpKSAvIF9fYiA6IF9fYSA+IDAgJiYgX19iID4g
KCh0eXBlb2YoX19iKSkoKCgodHlwZW9mKF9fYikpMSA8PCAoOCpzaXplb2YodHlwZW9mKF9f
YikpIC0gMSAtICgoKHR5cGVvZihfX2IpKSgtMSkpIDwgKHR5cGVvZihfX2IpKTEpKSkgLSAx
KSArICgodHlwZW9mKF9fYikpMSA8PCAoOCpzaXplb2YodHlwZW9mKF9fYikpIC0gMSAtICgo
KHR5cGVvZihfX2IpKSgtMSkpIDwgKHR5cGVvZihfX2IpKTEpKSkpKSAvIF9fYTsgfSkpKSwg
MCkpCiAgcmV0dXJuICgodm9pZCAqKTApOwoKIHJldHVybiBrdm1hbGxvYyhieXRlcywgZmxh
Z3MpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgdm9pZCAqa3ZjYWxsb2Moc2l6ZV90IG4sIHNpemVfdCBzaXpl
LCBnZnBfdCBmbGFncykKewogcmV0dXJuIGt2bWFsbG9jX2FycmF5KG4sIHNpemUsIGZsYWdz
IHwgKCggZ2ZwX3QpMHgxMDB1KSk7Cn0KCmV4dGVybiB2b2lkIGt2ZnJlZShjb25zdCB2b2lk
ICphZGRyKTsKZXh0ZXJuIHZvaWQga3ZmcmVlX3NlbnNpdGl2ZShjb25zdCB2b2lkICphZGRy
LCBzaXplX3QgbGVuKTsKCgoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBjb21wb3VuZF9tYXBjb3VudChz
dHJ1Y3QgcGFnZSAqcGFnZSkKewogKCh2b2lkKShzaXplb2YoKCBsb25nKSghUGFnZUNvbXBv
dW5kKHBhZ2UpKSkpKTsKIHBhZ2UgPSBjb21wb3VuZF9oZWFkKHBhZ2UpOwogcmV0dXJuIGF0
b21pY19yZWFkKGNvbXBvdW5kX21hcGNvdW50X3B0cihwYWdlKSkgKyAxOwp9CgoKCgoKCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSB2b2lkIHBhZ2VfbWFwY291bnRfcmVzZXQoc3RydWN0IHBhZ2UgKnBhZ2UpCnsK
IGF0b21pY19zZXQoJihwYWdlKS0+X21hcGNvdW50LCAtMSk7Cn0KCmludCBfX3BhZ2VfbWFw
Y291bnQoc3RydWN0IHBhZ2UgKnBhZ2UpOwojIDgxNCAiLi9pbmNsdWRlL2xpbnV4L21tLmgi
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSBpbnQgcGFnZV9tYXBjb3VudChzdHJ1Y3QgcGFnZSAqcGFnZSkKewogaWYg
KF9fYnVpbHRpbl9leHBlY3QoISEoUGFnZUNvbXBvdW5kKHBhZ2UpKSwgMCkpCiAgcmV0dXJu
IF9fcGFnZV9tYXBjb3VudChwYWdlKTsKIHJldHVybiBhdG9taWNfcmVhZCgmcGFnZS0+X21h
cGNvdW50KSArIDE7Cn0KCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHRvdGFsX21hcGNvdW50KHN0cnVj
dCBwYWdlICpwYWdlKQp7CiByZXR1cm4gcGFnZV9tYXBjb3VudChwYWdlKTsKfQpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgaW50IHBhZ2VfdHJhbnNfaHVnZV9tYXBjb3VudChzdHJ1Y3QgcGFnZSAqcGFnZSwKICAg
ICAgICBpbnQgKnRvdGFsX21hcGNvdW50KQp7CiBpbnQgbWFwY291bnQgPSBwYWdlX21hcGNv
dW50KHBhZ2UpOwogaWYgKHRvdGFsX21hcGNvdW50KQogICp0b3RhbF9tYXBjb3VudCA9IG1h
cGNvdW50OwogcmV0dXJuIG1hcGNvdW50Owp9CgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHN0cnVjdCBwYWdlICp2
aXJ0X3RvX2hlYWRfcGFnZShjb25zdCB2b2lkICp4KQp7CiBzdHJ1Y3QgcGFnZSAqcGFnZSA9
IChtZW1fbWFwICsgKCgoKHsgZG8geyB9IHdoaWxlICgwKTsgKHVuc2lnbmVkIGxvbmcpKHgp
ICYgMHgwZmZmZmZmZmZmZmZmZmZmVUw7IH0pID4+IDEyKSkgLSAoKHVuc2lnbmVkIGxvbmcp
KDBVTCA+PiAxMikpKSk7CgogcmV0dXJuIGNvbXBvdW5kX2hlYWQocGFnZSk7Cn0KCnZvaWQg
X19wdXRfcGFnZShzdHJ1Y3QgcGFnZSAqcGFnZSk7Cgp2b2lkIHB1dF9wYWdlc19saXN0KHN0
cnVjdCBsaXN0X2hlYWQgKnBhZ2VzKTsKCnZvaWQgc3BsaXRfcGFnZShzdHJ1Y3QgcGFnZSAq
cGFnZSwgdW5zaWduZWQgaW50IG9yZGVyKTsKCgoKCgoKdHlwZWRlZiB2b2lkIGNvbXBvdW5k
X3BhZ2VfZHRvcihzdHJ1Y3QgcGFnZSAqKTsKCgplbnVtIGNvbXBvdW5kX2R0b3JfaWQgewog
TlVMTF9DT01QT1VORF9EVE9SLAogQ09NUE9VTkRfUEFHRV9EVE9SLAoKIEhVR0VUTEJfUEFH
RV9EVE9SLAoKCgoKIE5SX0NPTVBPVU5EX0RUT1JTLAp9OwpleHRlcm4gY29tcG91bmRfcGFn
ZV9kdG9yICogY29uc3QgY29tcG91bmRfcGFnZV9kdG9yc1tOUl9DT01QT1VORF9EVE9SU107
CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgdm9pZCBzZXRfY29tcG91bmRfcGFnZV9kdG9yKHN0cnVjdCBwYWdlICpw
YWdlLAogIGVudW0gY29tcG91bmRfZHRvcl9pZCBjb21wb3VuZF9kdG9yKQp7CiAoKHZvaWQp
KHNpemVvZigoIGxvbmcpKGNvbXBvdW5kX2R0b3IgPj0gTlJfQ09NUE9VTkRfRFRPUlMpKSkp
OwogcGFnZVsxXS5jb21wb3VuZF9kdG9yID0gY29tcG91bmRfZHRvcjsKfQoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IHZvaWQgZGVzdHJveV9jb21wb3VuZF9wYWdlKHN0cnVjdCBwYWdlICpwYWdlKQp7CiAoKHZv
aWQpKHNpemVvZigoIGxvbmcpKHBhZ2VbMV0uY29tcG91bmRfZHRvciA+PSBOUl9DT01QT1VO
RF9EVE9SUykpKSk7CiBjb21wb3VuZF9wYWdlX2R0b3JzW3BhZ2VbMV0uY29tcG91bmRfZHRv
cl0ocGFnZSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1bnNpZ25lZCBpbnQgY29tcG91bmRfb3JkZXIoc3Ry
dWN0IHBhZ2UgKnBhZ2UpCnsKIGlmICghUGFnZUhlYWQocGFnZSkpCiAgcmV0dXJuIDA7CiBy
ZXR1cm4gcGFnZVsxXS5jb21wb3VuZF9vcmRlcjsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgaHBhZ2Vf
cGluY291bnRfYXZhaWxhYmxlKHN0cnVjdCBwYWdlICpwYWdlKQp7CgoKCgoKIHBhZ2UgPSBj
b21wb3VuZF9oZWFkKHBhZ2UpOwogcmV0dXJuIFBhZ2VDb21wb3VuZChwYWdlKSAmJiBjb21w
b3VuZF9vcmRlcihwYWdlKSA+IDE7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgY29tcG91bmRfcGluY291
bnQoc3RydWN0IHBhZ2UgKnBhZ2UpCnsKICgodm9pZCkoc2l6ZW9mKCggbG9uZykoIWhwYWdl
X3BpbmNvdW50X2F2YWlsYWJsZShwYWdlKSkpKSk7CiBwYWdlID0gY29tcG91bmRfaGVhZChw
YWdlKTsKIHJldHVybiBhdG9taWNfcmVhZChjb21wb3VuZF9waW5jb3VudF9wdHIocGFnZSkp
Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgdm9pZCBzZXRfY29tcG91bmRfb3JkZXIoc3RydWN0IHBhZ2UgKnBh
Z2UsIHVuc2lnbmVkIGludCBvcmRlcikKewogcGFnZVsxXS5jb21wb3VuZF9vcmRlciA9IG9y
ZGVyOwp9CgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHVuc2lnbmVkIGxvbmcgY29tcG91bmRfbnIoc3RydWN0IHBh
Z2UgKnBhZ2UpCnsKIHJldHVybiAxVUwgPDwgY29tcG91bmRfb3JkZXIocGFnZSk7Cn0KCgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgdW5zaWduZWQgbG9uZyBwYWdlX3NpemUoc3RydWN0IHBhZ2UgKnBhZ2UpCnsK
IHJldHVybiAoMVVMIDw8IDEyKSA8PCBjb21wb3VuZF9vcmRlcihwYWdlKTsKfQoKCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSB1bnNpZ25lZCBpbnQgcGFnZV9zaGlmdChzdHJ1Y3QgcGFnZSAqcGFnZSkKewogcmV0
dXJuIDEyICsgY29tcG91bmRfb3JkZXIocGFnZSk7Cn0KCnZvaWQgZnJlZV9jb21wb3VuZF9w
YWdlKHN0cnVjdCBwYWdlICpwYWdlKTsKIyA5NDMgIi4vaW5jbHVkZS9saW51eC9tbS5oIgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgcHRlX3QgbWF5YmVfbWt3cml0ZShwdGVfdCBwdGUsIHN0cnVjdCB2bV9hcmVh
X3N0cnVjdCAqdm1hKQp7CiBpZiAoX19idWlsdGluX2V4cGVjdCghISh2bWEtPnZtX2ZsYWdz
ICYgMHgwMDAwMDAwMiksIDEpKQogIHB0ZSA9IHB0ZV9ta3dyaXRlKHB0ZSk7CiByZXR1cm4g
cHRlOwp9Cgp2bV9mYXVsdF90IGFsbG9jX3NldF9wdGUoc3RydWN0IHZtX2ZhdWx0ICp2bWYs
IHN0cnVjdCBwYWdlICpwYWdlKTsKdm1fZmF1bHRfdCBmaW5pc2hfZmF1bHQoc3RydWN0IHZt
X2ZhdWx0ICp2bWYpOwp2bV9mYXVsdF90IGZpbmlzaF9ta3dyaXRlX2ZhdWx0KHN0cnVjdCB2
bV9mYXVsdCAqdm1mKTsKIyAxMDU4ICIuL2luY2x1ZGUvbGludXgvbW0uaCIKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IGVudW0gem9uZV90eXBlIHBhZ2Vfem9uZW51bShjb25zdCBzdHJ1Y3QgcGFnZSAqcGFnZSkK
ewogcmV0dXJuIChwYWdlLT5mbGFncyA+PiAoKCgoKHNpemVvZih1bnNpZ25lZCBsb25nKSo4
KSAtIDApIC0gMCkgLSAyKSAqICgyICE9IDApKSkgJiAoKDFVTCA8PCAyKSAtIDEpOwp9CiMg
MTA3MSAiLi9pbmNsdWRlL2xpbnV4L21tLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIGlzX3pvbmVfZGV2
aWNlX3BhZ2UoY29uc3Qgc3RydWN0IHBhZ2UgKnBhZ2UpCnsKIHJldHVybiBmYWxzZTsKfQoj
IDExMDAgIi4vaW5jbHVkZS9saW51eC9tbS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBwYWdlX2lzX2Rl
dm1hcF9tYW5hZ2VkKHN0cnVjdCBwYWdlICpwYWdlKQp7CiByZXR1cm4gZmFsc2U7Cn0KCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSB2b2lkIHB1dF9kZXZtYXBfbWFuYWdlZF9wYWdlKHN0cnVjdCBwYWdlICpwYWdl
KQp7Cn0KCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBpc19kZXZpY2VfcHJpdmF0ZV9wYWdlKGNvbnN0IHN0
cnVjdCBwYWdlICpwYWdlKQp7CiByZXR1cm4gMCAmJgogIDAgJiYKICBpc196b25lX2Rldmlj
ZV9wYWdlKHBhZ2UpICYmCiAgcGFnZS0+cGdtYXAtPnR5cGUgPT0gTUVNT1JZX0RFVklDRV9Q
UklWQVRFOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBpc19wY2lfcDJwZG1hX3BhZ2UoY29uc3Qgc3Ry
dWN0IHBhZ2UgKnBhZ2UpCnsKIHJldHVybiAwICYmCiAgMCAmJgogIGlzX3pvbmVfZGV2aWNl
X3BhZ2UocGFnZSkgJiYKICBwYWdlLT5wZ21hcC0+dHlwZSA9PSBNRU1PUllfREVWSUNFX1BD
SV9QMlBETUE7Cn0KCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBnZXRfcGFnZShzdHJ1Y3QgcGFnZSAq
cGFnZSkKewogcGFnZSA9IGNvbXBvdW5kX2hlYWQocGFnZSk7CgoKCgogKCh2b2lkKShzaXpl
b2YoKCBsb25nKSgoKHVuc2lnbmVkIGludCkgcGFnZV9yZWZfY291bnQocGFnZSkgKyAxMjd1
IDw9IDEyN3UpKSkpKTsKIHBhZ2VfcmVmX2luYyhwYWdlKTsKfQoKYm9vbCBfX2F0dHJpYnV0
ZV9fKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkgdHJ5X2dyYWJfcGFnZShzdHJ1Y3QgcGFn
ZSAqcGFnZSwgdW5zaWduZWQgaW50IGZsYWdzKTsKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkgYm9vbCB0cnlfZ2V0X3BhZ2Uoc3RydWN0IHBh
Z2UgKnBhZ2UpCnsKIHBhZ2UgPSBjb21wb3VuZF9oZWFkKHBhZ2UpOwogaWYgKCh7IGludCBf
X3JldF93YXJuX29uID0gISEocGFnZV9yZWZfY291bnQocGFnZSkgPD0gMCk7IGlmIChfX2J1
aWx0aW5fZXhwZWN0KCEhKF9fcmV0X3dhcm5fb24pLCAwKSkgX19hc21fXyBfX3ZvbGF0aWxl
X18oICIxOgkiICJ0d2kgMzEsIDAsIDAiICJcbiIgIi5zZWN0aW9uIF9fYnVnX3RhYmxlLFwi
YXdcIlxuIiAiMjpcdCIgIi44Ynl0ZSIgIiAiICIxYiwgJTBcbiIgIlx0LnNob3J0ICUxLCAl
MlxuIiAiLm9yZyAyYislM1xuIiAiLnByZXZpb3VzXG4iIDogOiAiaSIgKCIuL2luY2x1ZGUv
bGludXgvbW0uaCIpLCAiaSIgKDExNDYpLCAiaSIgKCgxIDw8IDApIHwgKCgxIDw8IDEpIHwg
KCg5KSA8PCA4KSkpLCAiaSIgKHNpemVvZihzdHJ1Y3QgYnVnX2VudHJ5KSkpOyBfX2J1aWx0
aW5fZXhwZWN0KCEhKF9fcmV0X3dhcm5fb24pLCAwKTsgfSkpCiAgcmV0dXJuIGZhbHNlOwog
cGFnZV9yZWZfaW5jKHBhZ2UpOwogcmV0dXJuIHRydWU7Cn0KCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHB1
dF9wYWdlKHN0cnVjdCBwYWdlICpwYWdlKQp7CiBwYWdlID0gY29tcG91bmRfaGVhZChwYWdl
KTsKCgoKCgoKCiBpZiAocGFnZV9pc19kZXZtYXBfbWFuYWdlZChwYWdlKSkgewogIHB1dF9k
ZXZtYXBfbWFuYWdlZF9wYWdlKHBhZ2UpOwogIHJldHVybjsKIH0KCiBpZiAocHV0X3BhZ2Vf
dGVzdHplcm8ocGFnZSkpCiAgX19wdXRfcGFnZShwYWdlKTsKfQojIDEyMDQgIi4vaW5jbHVk
ZS9saW51eC9tbS5oIgp2b2lkIHVucGluX3VzZXJfcGFnZShzdHJ1Y3QgcGFnZSAqcGFnZSk7
CnZvaWQgdW5waW5fdXNlcl9wYWdlc19kaXJ0eV9sb2NrKHN0cnVjdCBwYWdlICoqcGFnZXMs
IHVuc2lnbmVkIGxvbmcgbnBhZ2VzLAogICAgIGJvb2wgbWFrZV9kaXJ0eSk7CnZvaWQgdW5w
aW5fdXNlcl9wYWdlcyhzdHJ1Y3QgcGFnZSAqKnBhZ2VzLCB1bnNpZ25lZCBsb25nIG5wYWdl
cyk7CiMgMTIzNSAiLi9pbmNsdWRlL2xpbnV4L21tLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIHBhZ2Vf
bWF5YmVfZG1hX3Bpbm5lZChzdHJ1Y3QgcGFnZSAqcGFnZSkKewogaWYgKGhwYWdlX3BpbmNv
dW50X2F2YWlsYWJsZShwYWdlKSkKICByZXR1cm4gY29tcG91bmRfcGluY291bnQocGFnZSkg
PiAwOwojIDEyNDggIi4vaW5jbHVkZS9saW51eC9tbS5oIgogcmV0dXJuICgodW5zaWduZWQg
aW50KXBhZ2VfcmVmX2NvdW50KGNvbXBvdW5kX2hlYWQocGFnZSkpKSA+PQogICgxVSA8PCAx
MCk7Cn0KIyAxMjY0ICIuL2luY2x1ZGUvbGludXgvbW0uaCIKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBwYWdl
X3pvbmVfaWQoc3RydWN0IHBhZ2UgKnBhZ2UpCnsKIHJldHVybiAocGFnZS0+ZmxhZ3MgPj4g
KCgoKCgoc2l6ZW9mKHVuc2lnbmVkIGxvbmcpKjgpIC0gMCkgLSAwKSA8ICgoKChzaXplb2Yo
dW5zaWduZWQgbG9uZykqOCkgLSAwKSAtIDApIC0gMikpPyAoKChzaXplb2YodW5zaWduZWQg
bG9uZykqOCkgLSAwKSAtIDApIDogKCgoKHNpemVvZih1bnNpZ25lZCBsb25nKSo4KSAtIDAp
IC0gMCkgLSAyKSkgKiAoKDAgKyAyKSAhPSAwKSkpICYgKCgxVUwgPDwgKDAgKyAyKSkgLSAx
KTsKfQoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIGludCBwYWdlX3RvX25pZChjb25zdCBzdHJ1Y3QgcGFnZSAq
cGFnZSkKewogc3RydWN0IHBhZ2UgKnAgPSAoc3RydWN0IHBhZ2UgKilwYWdlOwoKIHJldHVy
biAoKHsgKCh2b2lkKShzaXplb2YoKCBsb25nKShQYWdlUG9pc29uZWQocCkpKSkpOyBwOyB9
KS0+ZmxhZ3MgPj4gKCgoKHNpemVvZih1bnNpZ25lZCBsb25nKSo4KSAtIDApIC0gMCkgKiAo
MCAhPSAwKSkpICYgKCgxVUwgPDwgMCkgLSAxKTsKfQojIDEzNDUgIi4vaW5jbHVkZS9saW51
eC9tbS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgaW50IHBhZ2VfY3B1cGlkX3hjaGdfbGFzdChzdHJ1Y3QgcGFn
ZSAqcGFnZSwgaW50IGNwdXBpZCkKewogcmV0dXJuIHBhZ2VfdG9fbmlkKHBhZ2UpOwp9Cgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgaW50IHBhZ2VfY3B1cGlkX2xhc3Qoc3RydWN0IHBhZ2UgKnBhZ2UpCnsKIHJl
dHVybiBwYWdlX3RvX25pZChwYWdlKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBjcHVwaWRfdG9fbmlk
KGludCBjcHVwaWQpCnsKIHJldHVybiAtMTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBjcHVwaWRfdG9f
cGlkKGludCBjcHVwaWQpCnsKIHJldHVybiAtMTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBjcHVwaWRf
dG9fY3B1KGludCBjcHVwaWQpCnsKIHJldHVybiAtMTsKfQoKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBjcHVf
cGlkX3RvX2NwdXBpZChpbnQgbmlkLCBpbnQgcGlkKQp7CiByZXR1cm4gLTE7Cn0KCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBib29sIGNwdXBpZF9waWRfdW5zZXQoaW50IGNwdXBpZCkKewogcmV0dXJuIHRydWU7
Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSB2b2lkIHBhZ2VfY3B1cGlkX3Jlc2V0X2xhc3Qoc3RydWN0IHBhZ2Ug
KnBhZ2UpCnsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgY3B1cGlkX21hdGNoX3BpZChzdHJ1Y3QgdGFz
a19zdHJ1Y3QgKnRhc2ssIGludCBjcHVwaWQpCnsKIHJldHVybiBmYWxzZTsKfQojIDE0MDcg
Ii4vaW5jbHVkZS9saW51eC9tbS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdTggcGFnZV9rYXNhbl90YWcoY29u
c3Qgc3RydWN0IHBhZ2UgKnBhZ2UpCnsKIHJldHVybiAweGZmOwp9CgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9p
ZCBwYWdlX2thc2FuX3RhZ19zZXQoc3RydWN0IHBhZ2UgKnBhZ2UsIHU4IHRhZykgeyB9CnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSB2b2lkIHBhZ2Vfa2FzYW5fdGFnX3Jlc2V0KHN0cnVjdCBwYWdlICpwYWdlKSB7
IH0KCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgc3RydWN0IHpvbmUgKnBhZ2Vfem9uZShjb25zdCBzdHJ1Y3QgcGFn
ZSAqcGFnZSkKewogcmV0dXJuICYoJmNvbnRpZ19wYWdlX2RhdGEpLT5ub2RlX3pvbmVzW3Bh
Z2Vfem9uZW51bShwYWdlKV07Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBwZ19kYXRhX3QgKnBhZ2VfcGdkYXQo
Y29uc3Qgc3RydWN0IHBhZ2UgKnBhZ2UpCnsKIHJldHVybiAoJmNvbnRpZ19wYWdlX2RhdGEp
Owp9CiMgMTQzOSAiLi9pbmNsdWRlL2xpbnV4L21tLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHNldF9w
YWdlX3pvbmUoc3RydWN0IHBhZ2UgKnBhZ2UsIGVudW0gem9uZV90eXBlIHpvbmUpCnsKIHBh
Z2UtPmZsYWdzICY9IH4oKCgxVUwgPDwgMikgLSAxKSA8PCAoKCgoKHNpemVvZih1bnNpZ25l
ZCBsb25nKSo4KSAtIDApIC0gMCkgLSAyKSAqICgyICE9IDApKSk7CiBwYWdlLT5mbGFncyB8
PSAoem9uZSAmICgoMVVMIDw8IDIpIC0gMSkpIDw8ICgoKCgoc2l6ZW9mKHVuc2lnbmVkIGxv
bmcpKjgpIC0gMCkgLSAwKSAtIDIpICogKDIgIT0gMCkpOwp9CgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBz
ZXRfcGFnZV9ub2RlKHN0cnVjdCBwYWdlICpwYWdlLCB1bnNpZ25lZCBsb25nIG5vZGUpCnsK
IHBhZ2UtPmZsYWdzICY9IH4oKCgxVUwgPDwgMCkgLSAxKSA8PCAoKCgoc2l6ZW9mKHVuc2ln
bmVkIGxvbmcpKjgpIC0gMCkgLSAwKSAqICgwICE9IDApKSk7CiBwYWdlLT5mbGFncyB8PSAo
bm9kZSAmICgoMVVMIDw8IDApIC0gMSkpIDw8ICgoKChzaXplb2YodW5zaWduZWQgbG9uZykq
OCkgLSAwKSAtIDApICogKDAgIT0gMCkpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBzZXRfcGFnZV9s
aW5rcyhzdHJ1Y3QgcGFnZSAqcGFnZSwgZW51bSB6b25lX3R5cGUgem9uZSwKIHVuc2lnbmVk
IGxvbmcgbm9kZSwgdW5zaWduZWQgbG9uZyBwZm4pCnsKIHNldF9wYWdlX3pvbmUocGFnZSwg
em9uZSk7CiBzZXRfcGFnZV9ub2RlKHBhZ2UsIG5vZGUpOwoKCgp9CiMgMTQ3MiAiLi9pbmNs
dWRlL2xpbnV4L21tLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3QgbWVtX2Nncm91cCAqcGFnZV9tZW1j
ZyhzdHJ1Y3QgcGFnZSAqcGFnZSkKewogcmV0dXJuICgodm9pZCAqKTApOwp9CnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBzdHJ1Y3QgbWVtX2Nncm91cCAqcGFnZV9tZW1jZ19yY3Uoc3RydWN0IHBhZ2UgKnBhZ2Up
CnsKICh7IGludCBfX3JldF93YXJuX29uID0gISEoIXJjdV9yZWFkX2xvY2tfaGVsZCgpKTsg
aWYgKF9fYnVpbHRpbl9leHBlY3QoISEoX19yZXRfd2Fybl9vbiksIDApKSBfX2FzbV9fIF9f
dm9sYXRpbGVfXyggIjE6CSIgInR3aSAzMSwgMCwgMCIgIlxuIiAiLnNlY3Rpb24gX19idWdf
dGFibGUsXCJhd1wiXG4iICIyOlx0IiAiLjhieXRlIiAiICIgIjFiLCAlMFxuIiAiXHQuc2hv
cnQgJTEsICUyXG4iICIub3JnIDJiKyUzXG4iICIucHJldmlvdXNcbiIgOiA6ICJpIiAoIi4v
aW5jbHVkZS9saW51eC9tbS5oIiksICJpIiAoMTQ3OCksICJpIiAoKDEgPDwgMCkgfCAoKDEg
PDwgMSkgfCAoKDkpIDw8IDgpKSksICJpIiAoc2l6ZW9mKHN0cnVjdCBidWdfZW50cnkpKSk7
IF9fYnVpbHRpbl9leHBlY3QoISEoX19yZXRfd2Fybl9vbiksIDApOyB9KTsKIHJldHVybiAo
KHZvaWQgKikwKTsKfQoKCgoKCiMgMSAiLi9pbmNsdWRlL2xpbnV4L3Ztc3RhdC5oIiAxCgoK
CgoKCgojIDEgIi4vaW5jbHVkZS9saW51eC92bV9ldmVudF9pdGVtLmgiIDEKIyAyNSAiLi9p
bmNsdWRlL2xpbnV4L3ZtX2V2ZW50X2l0ZW0uaCIKZW51bSB2bV9ldmVudF9pdGVtIHsgUEdQ
R0lOLCBQR1BHT1VULCBQU1dQSU4sIFBTV1BPVVQsCiAgUEdBTExPQ19ETUEsIFBHQUxMT0Nf
Tk9STUFMLCBQR0FMTE9DX01PVkFCTEUsCiAgQUxMT0NTVEFMTF9ETUEsIEFMTE9DU1RBTExf
Tk9STUFMLCBBTExPQ1NUQUxMX01PVkFCTEUsCiAgUEdTQ0FOX1NLSVBfRE1BLCBQR1NDQU5f
U0tJUF9OT1JNQUwsIFBHU0NBTl9TS0lQX01PVkFCTEUsCiAgUEdGUkVFLCBQR0FDVElWQVRF
LCBQR0RFQUNUSVZBVEUsIFBHTEFaWUZSRUUsCiAgUEdGQVVMVCwgUEdNQUpGQVVMVCwKICBQ
R0xBWllGUkVFRCwKICBQR1JFRklMTCwKICBQR1NURUFMX0tTV0FQRCwKICBQR1NURUFMX0RJ
UkVDVCwKICBQR1NDQU5fS1NXQVBELAogIFBHU0NBTl9ESVJFQ1QsCiAgUEdTQ0FOX0RJUkVD
VF9USFJPVFRMRSwKICBQR1NDQU5fQU5PTiwKICBQR1NDQU5fRklMRSwKICBQR1NURUFMX0FO
T04sCiAgUEdTVEVBTF9GSUxFLAoKCgogIFBHSU5PREVTVEVBTCwgU0xBQlNfU0NBTk5FRCwg
S1NXQVBEX0lOT0RFU1RFQUwsCiAgS1NXQVBEX0xPV19XTUFSS19ISVRfUVVJQ0tMWSwgS1NX
QVBEX0hJR0hfV01BUktfSElUX1FVSUNLTFksCiAgUEFHRU9VVFJVTiwgUEdST1RBVEVELAog
IERST1BfUEFHRUNBQ0hFLCBEUk9QX1NMQUIsCiAgT09NX0tJTEwsCiMgNTggIi4vaW5jbHVk
ZS9saW51eC92bV9ldmVudF9pdGVtLmgiCiAgUEdNSUdSQVRFX1NVQ0NFU1MsIFBHTUlHUkFU
RV9GQUlMLAoKCiAgQ09NUEFDVE1JR1JBVEVfU0NBTk5FRCwgQ09NUEFDVEZSRUVfU0NBTk5F
RCwKICBDT01QQUNUSVNPTEFURUQsCiAgQ09NUEFDVFNUQUxMLCBDT01QQUNURkFJTCwgQ09N
UEFDVFNVQ0NFU1MsCiAgS0NPTVBBQ1REX1dBS0UsCiAgS0NPTVBBQ1REX01JR1JBVEVfU0NB
Tk5FRCwgS0NPTVBBQ1REX0ZSRUVfU0NBTk5FRCwKCgogIEhUTEJfQlVERFlfUEdBTExPQywg
SFRMQl9CVUREWV9QR0FMTE9DX0ZBSUwsCgogIFVORVZJQ1RBQkxFX1BHQ1VMTEVELAogIFVO
RVZJQ1RBQkxFX1BHU0NBTk5FRCwKICBVTkVWSUNUQUJMRV9QR1JFU0NVRUQsCiAgVU5FVklD
VEFCTEVfUEdNTE9DS0VELAogIFVORVZJQ1RBQkxFX1BHTVVOTE9DS0VELAogIFVORVZJQ1RB
QkxFX1BHQ0xFQVJFRCwKICBVTkVWSUNUQUJMRV9QR1NUUkFOREVELAojIDExNyAiLi9pbmNs
dWRlL2xpbnV4L3ZtX2V2ZW50X2l0ZW0uaCIKICBTV0FQX1JBLAogIFNXQVBfUkFfSElULAoK
ICBOUl9WTV9FVkVOVF9JVEVNUwp9OwojIDkgIi4vaW5jbHVkZS9saW51eC92bXN0YXQuaCIg
MgoKIyAxICIuL2luY2x1ZGUvbGludXgvc3RhdGljX2tleS5oIiAxCiMgMTEgIi4vaW5jbHVk
ZS9saW51eC92bXN0YXQuaCIgMgoKZXh0ZXJuIGludCBzeXNjdGxfc3RhdF9pbnRlcnZhbDsK
IyAyMyAiLi9pbmNsdWRlL2xpbnV4L3Ztc3RhdC5oIgpzdHJ1Y3QgcmVjbGFpbV9zdGF0IHsK
IHVuc2lnbmVkIG5yX2RpcnR5OwogdW5zaWduZWQgbnJfdW5xdWV1ZWRfZGlydHk7CiB1bnNp
Z25lZCBucl9jb25nZXN0ZWQ7CiB1bnNpZ25lZCBucl93cml0ZWJhY2s7CiB1bnNpZ25lZCBu
cl9pbW1lZGlhdGU7CiB1bnNpZ25lZCBucl9wYWdlb3V0OwogdW5zaWduZWQgbnJfYWN0aXZh
dGVbMl07CiB1bnNpZ25lZCBucl9yZWZfa2VlcDsKIHVuc2lnbmVkIG5yX3VubWFwX2ZhaWw7
CiB1bnNpZ25lZCBucl9sYXp5ZnJlZV9mYWlsOwp9OwoKZW51bSB3cml0ZWJhY2tfc3RhdF9p
dGVtIHsKIE5SX0RJUlRZX1RIUkVTSE9MRCwKIE5SX0RJUlRZX0JHX1RIUkVTSE9MRCwKIE5S
X1ZNX1dSSVRFQkFDS19TVEFUX0lURU1TLAp9OwojIDUzICIuL2luY2x1ZGUvbGludXgvdm1z
dGF0LmgiCnN0cnVjdCB2bV9ldmVudF9zdGF0ZSB7CiB1bnNpZ25lZCBsb25nIGV2ZW50W05S
X1ZNX0VWRU5UX0lURU1TXTsKfTsKCmV4dGVybiBfX2F0dHJpYnV0ZV9fKChzZWN0aW9uKCIu
ZGF0YS4ucGVyY3B1IiAiIikpKSBfX3R5cGVvZl9fKHN0cnVjdCB2bV9ldmVudF9zdGF0ZSkg
dm1fZXZlbnRfc3RhdGVzOwoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIF9fY291bnRfdm1fZXZlbnQo
ZW51bSB2bV9ldmVudF9pdGVtIGl0ZW0pCnsKIGRvIHsgZG8geyBjb25zdCB2b2lkICpfX3Zw
cF92ZXJpZnkgPSAodHlwZW9mKCgmKHZtX2V2ZW50X3N0YXRlcy5ldmVudFtpdGVtXSkpICsg
MCkpKCh2b2lkICopMCk7ICh2b2lkKV9fdnBwX3ZlcmlmeTsgfSB3aGlsZSAoMCk7IHN3aXRj
aChzaXplb2Yodm1fZXZlbnRfc3RhdGVzLmV2ZW50W2l0ZW1dKSkgeyBjYXNlIDE6IGRvIHsg
Kih7IGRvIHsgY29uc3Qgdm9pZCAqX192cHBfdmVyaWZ5ID0gKHR5cGVvZigoJih2bV9ldmVu
dF9zdGF0ZXMuZXZlbnRbaXRlbV0pKSArIDApKSgodm9pZCAqKTApOyAodm9pZClfX3ZwcF92
ZXJpZnk7IH0gd2hpbGUgKDApOyAoeyB1bnNpZ25lZCBsb25nIF9fcHRyOyBfX2FzbV9fICgi
IiA6ICI9ciIoX19wdHIpIDogIjAiKCh0eXBlb2YoKigmKHZtX2V2ZW50X3N0YXRlcy5ldmVu
dFtpdGVtXSkpKSAqKSgmKHZtX2V2ZW50X3N0YXRlcy5ldmVudFtpdGVtXSkpKSk7ICh0eXBl
b2YoKHR5cGVvZigqKCYodm1fZXZlbnRfc3RhdGVzLmV2ZW50W2l0ZW1dKSkpICopKCYodm1f
ZXZlbnRfc3RhdGVzLmV2ZW50W2l0ZW1dKSkpKSAoX19wdHIgKyAoKGxvY2FsX3BhY2EtPmRh
dGFfb2Zmc2V0KSkpOyB9KTsgfSkgKz0gMTsgfSB3aGlsZSAoMCk7YnJlYWs7IGNhc2UgMjog
ZG8geyAqKHsgZG8geyBjb25zdCB2b2lkICpfX3ZwcF92ZXJpZnkgPSAodHlwZW9mKCgmKHZt
X2V2ZW50X3N0YXRlcy5ldmVudFtpdGVtXSkpICsgMCkpKCh2b2lkICopMCk7ICh2b2lkKV9f
dnBwX3ZlcmlmeTsgfSB3aGlsZSAoMCk7ICh7IHVuc2lnbmVkIGxvbmcgX19wdHI7IF9fYXNt
X18gKCIiIDogIj1yIihfX3B0cikgOiAiMCIoKHR5cGVvZigqKCYodm1fZXZlbnRfc3RhdGVz
LmV2ZW50W2l0ZW1dKSkpICopKCYodm1fZXZlbnRfc3RhdGVzLmV2ZW50W2l0ZW1dKSkpKTsg
KHR5cGVvZigodHlwZW9mKCooJih2bV9ldmVudF9zdGF0ZXMuZXZlbnRbaXRlbV0pKSkgKiko
Jih2bV9ldmVudF9zdGF0ZXMuZXZlbnRbaXRlbV0pKSkpIChfX3B0ciArICgobG9jYWxfcGFj
YS0+ZGF0YV9vZmZzZXQpKSk7IH0pOyB9KSArPSAxOyB9IHdoaWxlICgwKTticmVhazsgY2Fz
ZSA0OiBkbyB7ICooeyBkbyB7IGNvbnN0IHZvaWQgKl9fdnBwX3ZlcmlmeSA9ICh0eXBlb2Yo
KCYodm1fZXZlbnRfc3RhdGVzLmV2ZW50W2l0ZW1dKSkgKyAwKSkoKHZvaWQgKikwKTsgKHZv
aWQpX192cHBfdmVyaWZ5OyB9IHdoaWxlICgwKTsgKHsgdW5zaWduZWQgbG9uZyBfX3B0cjsg
X19hc21fXyAoIiIgOiAiPXIiKF9fcHRyKSA6ICIwIigodHlwZW9mKCooJih2bV9ldmVudF9z
dGF0ZXMuZXZlbnRbaXRlbV0pKSkgKikoJih2bV9ldmVudF9zdGF0ZXMuZXZlbnRbaXRlbV0p
KSkpOyAodHlwZW9mKCh0eXBlb2YoKigmKHZtX2V2ZW50X3N0YXRlcy5ldmVudFtpdGVtXSkp
KSAqKSgmKHZtX2V2ZW50X3N0YXRlcy5ldmVudFtpdGVtXSkpKSkgKF9fcHRyICsgKChsb2Nh
bF9wYWNhLT5kYXRhX29mZnNldCkpKTsgfSk7IH0pICs9IDE7IH0gd2hpbGUgKDApO2JyZWFr
OyBjYXNlIDg6IGRvIHsgKih7IGRvIHsgY29uc3Qgdm9pZCAqX192cHBfdmVyaWZ5ID0gKHR5
cGVvZigoJih2bV9ldmVudF9zdGF0ZXMuZXZlbnRbaXRlbV0pKSArIDApKSgodm9pZCAqKTAp
OyAodm9pZClfX3ZwcF92ZXJpZnk7IH0gd2hpbGUgKDApOyAoeyB1bnNpZ25lZCBsb25nIF9f
cHRyOyBfX2FzbV9fICgiIiA6ICI9ciIoX19wdHIpIDogIjAiKCh0eXBlb2YoKigmKHZtX2V2
ZW50X3N0YXRlcy5ldmVudFtpdGVtXSkpKSAqKSgmKHZtX2V2ZW50X3N0YXRlcy5ldmVudFtp
dGVtXSkpKSk7ICh0eXBlb2YoKHR5cGVvZigqKCYodm1fZXZlbnRfc3RhdGVzLmV2ZW50W2l0
ZW1dKSkpICopKCYodm1fZXZlbnRfc3RhdGVzLmV2ZW50W2l0ZW1dKSkpKSAoX19wdHIgKyAo
KGxvY2FsX3BhY2EtPmRhdGFfb2Zmc2V0KSkpOyB9KTsgfSkgKz0gMTsgfSB3aGlsZSAoMCk7
YnJlYWs7IGRlZmF1bHQ6IF9fYmFkX3NpemVfY2FsbF9wYXJhbWV0ZXIoKTticmVhazsgfSB9
IHdoaWxlICgwKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgY291bnRfdm1fZXZlbnQoZW51bSB2bV9l
dmVudF9pdGVtIGl0ZW0pCnsKIGRvIHsgZG8geyBjb25zdCB2b2lkICpfX3ZwcF92ZXJpZnkg
PSAodHlwZW9mKCgmKHZtX2V2ZW50X3N0YXRlcy5ldmVudFtpdGVtXSkpICsgMCkpKCh2b2lk
ICopMCk7ICh2b2lkKV9fdnBwX3ZlcmlmeTsgfSB3aGlsZSAoMCk7IHN3aXRjaChzaXplb2Yo
dm1fZXZlbnRfc3RhdGVzLmV2ZW50W2l0ZW1dKSkgeyBjYXNlIDE6IGRvIHsgdW5zaWduZWQg
bG9uZyBfX2ZsYWdzOyBkbyB7ICh7IHVuc2lnbmVkIGxvbmcgX19kdW1teTsgdHlwZW9mKF9f
ZmxhZ3MpIF9fZHVtbXkyOyAodm9pZCkoJl9fZHVtbXkgPT0gJl9fZHVtbXkyKTsgMTsgfSk7
IF9fZmxhZ3MgPSBhcmNoX2xvY2FsX2lycV9zYXZlKCk7IH0gd2hpbGUgKDApOyBkbyB7ICoo
eyBkbyB7IGNvbnN0IHZvaWQgKl9fdnBwX3ZlcmlmeSA9ICh0eXBlb2YoKCYodm1fZXZlbnRf
c3RhdGVzLmV2ZW50W2l0ZW1dKSkgKyAwKSkoKHZvaWQgKikwKTsgKHZvaWQpX192cHBfdmVy
aWZ5OyB9IHdoaWxlICgwKTsgKHsgdW5zaWduZWQgbG9uZyBfX3B0cjsgX19hc21fXyAoIiIg
OiAiPXIiKF9fcHRyKSA6ICIwIigodHlwZW9mKCooJih2bV9ldmVudF9zdGF0ZXMuZXZlbnRb
aXRlbV0pKSkgKikoJih2bV9ldmVudF9zdGF0ZXMuZXZlbnRbaXRlbV0pKSkpOyAodHlwZW9m
KCh0eXBlb2YoKigmKHZtX2V2ZW50X3N0YXRlcy5ldmVudFtpdGVtXSkpKSAqKSgmKHZtX2V2
ZW50X3N0YXRlcy5ldmVudFtpdGVtXSkpKSkgKF9fcHRyICsgKChsb2NhbF9wYWNhLT5kYXRh
X29mZnNldCkpKTsgfSk7IH0pICs9IDE7IH0gd2hpbGUgKDApOyBkbyB7ICh7IHVuc2lnbmVk
IGxvbmcgX19kdW1teTsgdHlwZW9mKF9fZmxhZ3MpIF9fZHVtbXkyOyAodm9pZCkoJl9fZHVt
bXkgPT0gJl9fZHVtbXkyKTsgMTsgfSk7IGFyY2hfbG9jYWxfaXJxX3Jlc3RvcmUoX19mbGFn
cyk7IH0gd2hpbGUgKDApOyB9IHdoaWxlICgwKTticmVhazsgY2FzZSAyOiBkbyB7IHVuc2ln
bmVkIGxvbmcgX19mbGFnczsgZG8geyAoeyB1bnNpZ25lZCBsb25nIF9fZHVtbXk7IHR5cGVv
ZihfX2ZsYWdzKSBfX2R1bW15MjsgKHZvaWQpKCZfX2R1bW15ID09ICZfX2R1bW15Mik7IDE7
IH0pOyBfX2ZsYWdzID0gYXJjaF9sb2NhbF9pcnFfc2F2ZSgpOyB9IHdoaWxlICgwKTsgZG8g
eyAqKHsgZG8geyBjb25zdCB2b2lkICpfX3ZwcF92ZXJpZnkgPSAodHlwZW9mKCgmKHZtX2V2
ZW50X3N0YXRlcy5ldmVudFtpdGVtXSkpICsgMCkpKCh2b2lkICopMCk7ICh2b2lkKV9fdnBw
X3ZlcmlmeTsgfSB3aGlsZSAoMCk7ICh7IHVuc2lnbmVkIGxvbmcgX19wdHI7IF9fYXNtX18g
KCIiIDogIj1yIihfX3B0cikgOiAiMCIoKHR5cGVvZigqKCYodm1fZXZlbnRfc3RhdGVzLmV2
ZW50W2l0ZW1dKSkpICopKCYodm1fZXZlbnRfc3RhdGVzLmV2ZW50W2l0ZW1dKSkpKTsgKHR5
cGVvZigodHlwZW9mKCooJih2bV9ldmVudF9zdGF0ZXMuZXZlbnRbaXRlbV0pKSkgKikoJih2
bV9ldmVudF9zdGF0ZXMuZXZlbnRbaXRlbV0pKSkpIChfX3B0ciArICgobG9jYWxfcGFjYS0+
ZGF0YV9vZmZzZXQpKSk7IH0pOyB9KSArPSAxOyB9IHdoaWxlICgwKTsgZG8geyAoeyB1bnNp
Z25lZCBsb25nIF9fZHVtbXk7IHR5cGVvZihfX2ZsYWdzKSBfX2R1bW15MjsgKHZvaWQpKCZf
X2R1bW15ID09ICZfX2R1bW15Mik7IDE7IH0pOyBhcmNoX2xvY2FsX2lycV9yZXN0b3JlKF9f
ZmxhZ3MpOyB9IHdoaWxlICgwKTsgfSB3aGlsZSAoMCk7YnJlYWs7IGNhc2UgNDogZG8geyB1
bnNpZ25lZCBsb25nIF9fZmxhZ3M7IGRvIHsgKHsgdW5zaWduZWQgbG9uZyBfX2R1bW15OyB0
eXBlb2YoX19mbGFncykgX19kdW1teTI7ICh2b2lkKSgmX19kdW1teSA9PSAmX19kdW1teTIp
OyAxOyB9KTsgX19mbGFncyA9IGFyY2hfbG9jYWxfaXJxX3NhdmUoKTsgfSB3aGlsZSAoMCk7
IGRvIHsgKih7IGRvIHsgY29uc3Qgdm9pZCAqX192cHBfdmVyaWZ5ID0gKHR5cGVvZigoJih2
bV9ldmVudF9zdGF0ZXMuZXZlbnRbaXRlbV0pKSArIDApKSgodm9pZCAqKTApOyAodm9pZClf
X3ZwcF92ZXJpZnk7IH0gd2hpbGUgKDApOyAoeyB1bnNpZ25lZCBsb25nIF9fcHRyOyBfX2Fz
bV9fICgiIiA6ICI9ciIoX19wdHIpIDogIjAiKCh0eXBlb2YoKigmKHZtX2V2ZW50X3N0YXRl
cy5ldmVudFtpdGVtXSkpKSAqKSgmKHZtX2V2ZW50X3N0YXRlcy5ldmVudFtpdGVtXSkpKSk7
ICh0eXBlb2YoKHR5cGVvZigqKCYodm1fZXZlbnRfc3RhdGVzLmV2ZW50W2l0ZW1dKSkpICop
KCYodm1fZXZlbnRfc3RhdGVzLmV2ZW50W2l0ZW1dKSkpKSAoX19wdHIgKyAoKGxvY2FsX3Bh
Y2EtPmRhdGFfb2Zmc2V0KSkpOyB9KTsgfSkgKz0gMTsgfSB3aGlsZSAoMCk7IGRvIHsgKHsg
dW5zaWduZWQgbG9uZyBfX2R1bW15OyB0eXBlb2YoX19mbGFncykgX19kdW1teTI7ICh2b2lk
KSgmX19kdW1teSA9PSAmX19kdW1teTIpOyAxOyB9KTsgYXJjaF9sb2NhbF9pcnFfcmVzdG9y
ZShfX2ZsYWdzKTsgfSB3aGlsZSAoMCk7IH0gd2hpbGUgKDApO2JyZWFrOyBjYXNlIDg6IGRv
IHsgdW5zaWduZWQgbG9uZyBfX2ZsYWdzOyBkbyB7ICh7IHVuc2lnbmVkIGxvbmcgX19kdW1t
eTsgdHlwZW9mKF9fZmxhZ3MpIF9fZHVtbXkyOyAodm9pZCkoJl9fZHVtbXkgPT0gJl9fZHVt
bXkyKTsgMTsgfSk7IF9fZmxhZ3MgPSBhcmNoX2xvY2FsX2lycV9zYXZlKCk7IH0gd2hpbGUg
KDApOyBkbyB7ICooeyBkbyB7IGNvbnN0IHZvaWQgKl9fdnBwX3ZlcmlmeSA9ICh0eXBlb2Yo
KCYodm1fZXZlbnRfc3RhdGVzLmV2ZW50W2l0ZW1dKSkgKyAwKSkoKHZvaWQgKikwKTsgKHZv
aWQpX192cHBfdmVyaWZ5OyB9IHdoaWxlICgwKTsgKHsgdW5zaWduZWQgbG9uZyBfX3B0cjsg
X19hc21fXyAoIiIgOiAiPXIiKF9fcHRyKSA6ICIwIigodHlwZW9mKCooJih2bV9ldmVudF9z
dGF0ZXMuZXZlbnRbaXRlbV0pKSkgKikoJih2bV9ldmVudF9zdGF0ZXMuZXZlbnRbaXRlbV0p
KSkpOyAodHlwZW9mKCh0eXBlb2YoKigmKHZtX2V2ZW50X3N0YXRlcy5ldmVudFtpdGVtXSkp
KSAqKSgmKHZtX2V2ZW50X3N0YXRlcy5ldmVudFtpdGVtXSkpKSkgKF9fcHRyICsgKChsb2Nh
bF9wYWNhLT5kYXRhX29mZnNldCkpKTsgfSk7IH0pICs9IDE7IH0gd2hpbGUgKDApOyBkbyB7
ICh7IHVuc2lnbmVkIGxvbmcgX19kdW1teTsgdHlwZW9mKF9fZmxhZ3MpIF9fZHVtbXkyOyAo
dm9pZCkoJl9fZHVtbXkgPT0gJl9fZHVtbXkyKTsgMTsgfSk7IGFyY2hfbG9jYWxfaXJxX3Jl
c3RvcmUoX19mbGFncyk7IH0gd2hpbGUgKDApOyB9IHdoaWxlICgwKTticmVhazsgZGVmYXVs
dDogX19iYWRfc2l6ZV9jYWxsX3BhcmFtZXRlcigpO2JyZWFrOyB9IH0gd2hpbGUgKDApOwp9
CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgdm9pZCBfX2NvdW50X3ZtX2V2ZW50cyhlbnVtIHZtX2V2ZW50X2l0ZW0g
aXRlbSwgbG9uZyBkZWx0YSkKewogZG8geyBkbyB7IGNvbnN0IHZvaWQgKl9fdnBwX3Zlcmlm
eSA9ICh0eXBlb2YoKCYodm1fZXZlbnRfc3RhdGVzLmV2ZW50W2l0ZW1dKSkgKyAwKSkoKHZv
aWQgKikwKTsgKHZvaWQpX192cHBfdmVyaWZ5OyB9IHdoaWxlICgwKTsgc3dpdGNoKHNpemVv
Zih2bV9ldmVudF9zdGF0ZXMuZXZlbnRbaXRlbV0pKSB7IGNhc2UgMTogZG8geyAqKHsgZG8g
eyBjb25zdCB2b2lkICpfX3ZwcF92ZXJpZnkgPSAodHlwZW9mKCgmKHZtX2V2ZW50X3N0YXRl
cy5ldmVudFtpdGVtXSkpICsgMCkpKCh2b2lkICopMCk7ICh2b2lkKV9fdnBwX3ZlcmlmeTsg
fSB3aGlsZSAoMCk7ICh7IHVuc2lnbmVkIGxvbmcgX19wdHI7IF9fYXNtX18gKCIiIDogIj1y
IihfX3B0cikgOiAiMCIoKHR5cGVvZigqKCYodm1fZXZlbnRfc3RhdGVzLmV2ZW50W2l0ZW1d
KSkpICopKCYodm1fZXZlbnRfc3RhdGVzLmV2ZW50W2l0ZW1dKSkpKTsgKHR5cGVvZigodHlw
ZW9mKCooJih2bV9ldmVudF9zdGF0ZXMuZXZlbnRbaXRlbV0pKSkgKikoJih2bV9ldmVudF9z
dGF0ZXMuZXZlbnRbaXRlbV0pKSkpIChfX3B0ciArICgobG9jYWxfcGFjYS0+ZGF0YV9vZmZz
ZXQpKSk7IH0pOyB9KSArPSBkZWx0YTsgfSB3aGlsZSAoMCk7YnJlYWs7IGNhc2UgMjogZG8g
eyAqKHsgZG8geyBjb25zdCB2b2lkICpfX3ZwcF92ZXJpZnkgPSAodHlwZW9mKCgmKHZtX2V2
ZW50X3N0YXRlcy5ldmVudFtpdGVtXSkpICsgMCkpKCh2b2lkICopMCk7ICh2b2lkKV9fdnBw
X3ZlcmlmeTsgfSB3aGlsZSAoMCk7ICh7IHVuc2lnbmVkIGxvbmcgX19wdHI7IF9fYXNtX18g
KCIiIDogIj1yIihfX3B0cikgOiAiMCIoKHR5cGVvZigqKCYodm1fZXZlbnRfc3RhdGVzLmV2
ZW50W2l0ZW1dKSkpICopKCYodm1fZXZlbnRfc3RhdGVzLmV2ZW50W2l0ZW1dKSkpKTsgKHR5
cGVvZigodHlwZW9mKCooJih2bV9ldmVudF9zdGF0ZXMuZXZlbnRbaXRlbV0pKSkgKikoJih2
bV9ldmVudF9zdGF0ZXMuZXZlbnRbaXRlbV0pKSkpIChfX3B0ciArICgobG9jYWxfcGFjYS0+
ZGF0YV9vZmZzZXQpKSk7IH0pOyB9KSArPSBkZWx0YTsgfSB3aGlsZSAoMCk7YnJlYWs7IGNh
c2UgNDogZG8geyAqKHsgZG8geyBjb25zdCB2b2lkICpfX3ZwcF92ZXJpZnkgPSAodHlwZW9m
KCgmKHZtX2V2ZW50X3N0YXRlcy5ldmVudFtpdGVtXSkpICsgMCkpKCh2b2lkICopMCk7ICh2
b2lkKV9fdnBwX3ZlcmlmeTsgfSB3aGlsZSAoMCk7ICh7IHVuc2lnbmVkIGxvbmcgX19wdHI7
IF9fYXNtX18gKCIiIDogIj1yIihfX3B0cikgOiAiMCIoKHR5cGVvZigqKCYodm1fZXZlbnRf
c3RhdGVzLmV2ZW50W2l0ZW1dKSkpICopKCYodm1fZXZlbnRfc3RhdGVzLmV2ZW50W2l0ZW1d
KSkpKTsgKHR5cGVvZigodHlwZW9mKCooJih2bV9ldmVudF9zdGF0ZXMuZXZlbnRbaXRlbV0p
KSkgKikoJih2bV9ldmVudF9zdGF0ZXMuZXZlbnRbaXRlbV0pKSkpIChfX3B0ciArICgobG9j
YWxfcGFjYS0+ZGF0YV9vZmZzZXQpKSk7IH0pOyB9KSArPSBkZWx0YTsgfSB3aGlsZSAoMCk7
YnJlYWs7IGNhc2UgODogZG8geyAqKHsgZG8geyBjb25zdCB2b2lkICpfX3ZwcF92ZXJpZnkg
PSAodHlwZW9mKCgmKHZtX2V2ZW50X3N0YXRlcy5ldmVudFtpdGVtXSkpICsgMCkpKCh2b2lk
ICopMCk7ICh2b2lkKV9fdnBwX3ZlcmlmeTsgfSB3aGlsZSAoMCk7ICh7IHVuc2lnbmVkIGxv
bmcgX19wdHI7IF9fYXNtX18gKCIiIDogIj1yIihfX3B0cikgOiAiMCIoKHR5cGVvZigqKCYo
dm1fZXZlbnRfc3RhdGVzLmV2ZW50W2l0ZW1dKSkpICopKCYodm1fZXZlbnRfc3RhdGVzLmV2
ZW50W2l0ZW1dKSkpKTsgKHR5cGVvZigodHlwZW9mKCooJih2bV9ldmVudF9zdGF0ZXMuZXZl
bnRbaXRlbV0pKSkgKikoJih2bV9ldmVudF9zdGF0ZXMuZXZlbnRbaXRlbV0pKSkpIChfX3B0
ciArICgobG9jYWxfcGFjYS0+ZGF0YV9vZmZzZXQpKSk7IH0pOyB9KSArPSBkZWx0YTsgfSB3
aGlsZSAoMCk7YnJlYWs7IGRlZmF1bHQ6IF9fYmFkX3NpemVfY2FsbF9wYXJhbWV0ZXIoKTti
cmVhazsgfSB9IHdoaWxlICgwKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgY291bnRfdm1fZXZlbnRz
KGVudW0gdm1fZXZlbnRfaXRlbSBpdGVtLCBsb25nIGRlbHRhKQp7CiBkbyB7IGRvIHsgY29u
c3Qgdm9pZCAqX192cHBfdmVyaWZ5ID0gKHR5cGVvZigoJih2bV9ldmVudF9zdGF0ZXMuZXZl
bnRbaXRlbV0pKSArIDApKSgodm9pZCAqKTApOyAodm9pZClfX3ZwcF92ZXJpZnk7IH0gd2hp
bGUgKDApOyBzd2l0Y2goc2l6ZW9mKHZtX2V2ZW50X3N0YXRlcy5ldmVudFtpdGVtXSkpIHsg
Y2FzZSAxOiBkbyB7IHVuc2lnbmVkIGxvbmcgX19mbGFnczsgZG8geyAoeyB1bnNpZ25lZCBs
b25nIF9fZHVtbXk7IHR5cGVvZihfX2ZsYWdzKSBfX2R1bW15MjsgKHZvaWQpKCZfX2R1bW15
ID09ICZfX2R1bW15Mik7IDE7IH0pOyBfX2ZsYWdzID0gYXJjaF9sb2NhbF9pcnFfc2F2ZSgp
OyB9IHdoaWxlICgwKTsgZG8geyAqKHsgZG8geyBjb25zdCB2b2lkICpfX3ZwcF92ZXJpZnkg
PSAodHlwZW9mKCgmKHZtX2V2ZW50X3N0YXRlcy5ldmVudFtpdGVtXSkpICsgMCkpKCh2b2lk
ICopMCk7ICh2b2lkKV9fdnBwX3ZlcmlmeTsgfSB3aGlsZSAoMCk7ICh7IHVuc2lnbmVkIGxv
bmcgX19wdHI7IF9fYXNtX18gKCIiIDogIj1yIihfX3B0cikgOiAiMCIoKHR5cGVvZigqKCYo
dm1fZXZlbnRfc3RhdGVzLmV2ZW50W2l0ZW1dKSkpICopKCYodm1fZXZlbnRfc3RhdGVzLmV2
ZW50W2l0ZW1dKSkpKTsgKHR5cGVvZigodHlwZW9mKCooJih2bV9ldmVudF9zdGF0ZXMuZXZl
bnRbaXRlbV0pKSkgKikoJih2bV9ldmVudF9zdGF0ZXMuZXZlbnRbaXRlbV0pKSkpIChfX3B0
ciArICgobG9jYWxfcGFjYS0+ZGF0YV9vZmZzZXQpKSk7IH0pOyB9KSArPSBkZWx0YTsgfSB3
aGlsZSAoMCk7IGRvIHsgKHsgdW5zaWduZWQgbG9uZyBfX2R1bW15OyB0eXBlb2YoX19mbGFn
cykgX19kdW1teTI7ICh2b2lkKSgmX19kdW1teSA9PSAmX19kdW1teTIpOyAxOyB9KTsgYXJj
aF9sb2NhbF9pcnFfcmVzdG9yZShfX2ZsYWdzKTsgfSB3aGlsZSAoMCk7IH0gd2hpbGUgKDAp
O2JyZWFrOyBjYXNlIDI6IGRvIHsgdW5zaWduZWQgbG9uZyBfX2ZsYWdzOyBkbyB7ICh7IHVu
c2lnbmVkIGxvbmcgX19kdW1teTsgdHlwZW9mKF9fZmxhZ3MpIF9fZHVtbXkyOyAodm9pZCko
Jl9fZHVtbXkgPT0gJl9fZHVtbXkyKTsgMTsgfSk7IF9fZmxhZ3MgPSBhcmNoX2xvY2FsX2ly
cV9zYXZlKCk7IH0gd2hpbGUgKDApOyBkbyB7ICooeyBkbyB7IGNvbnN0IHZvaWQgKl9fdnBw
X3ZlcmlmeSA9ICh0eXBlb2YoKCYodm1fZXZlbnRfc3RhdGVzLmV2ZW50W2l0ZW1dKSkgKyAw
KSkoKHZvaWQgKikwKTsgKHZvaWQpX192cHBfdmVyaWZ5OyB9IHdoaWxlICgwKTsgKHsgdW5z
aWduZWQgbG9uZyBfX3B0cjsgX19hc21fXyAoIiIgOiAiPXIiKF9fcHRyKSA6ICIwIigodHlw
ZW9mKCooJih2bV9ldmVudF9zdGF0ZXMuZXZlbnRbaXRlbV0pKSkgKikoJih2bV9ldmVudF9z
dGF0ZXMuZXZlbnRbaXRlbV0pKSkpOyAodHlwZW9mKCh0eXBlb2YoKigmKHZtX2V2ZW50X3N0
YXRlcy5ldmVudFtpdGVtXSkpKSAqKSgmKHZtX2V2ZW50X3N0YXRlcy5ldmVudFtpdGVtXSkp
KSkgKF9fcHRyICsgKChsb2NhbF9wYWNhLT5kYXRhX29mZnNldCkpKTsgfSk7IH0pICs9IGRl
bHRhOyB9IHdoaWxlICgwKTsgZG8geyAoeyB1bnNpZ25lZCBsb25nIF9fZHVtbXk7IHR5cGVv
ZihfX2ZsYWdzKSBfX2R1bW15MjsgKHZvaWQpKCZfX2R1bW15ID09ICZfX2R1bW15Mik7IDE7
IH0pOyBhcmNoX2xvY2FsX2lycV9yZXN0b3JlKF9fZmxhZ3MpOyB9IHdoaWxlICgwKTsgfSB3
aGlsZSAoMCk7YnJlYWs7IGNhc2UgNDogZG8geyB1bnNpZ25lZCBsb25nIF9fZmxhZ3M7IGRv
IHsgKHsgdW5zaWduZWQgbG9uZyBfX2R1bW15OyB0eXBlb2YoX19mbGFncykgX19kdW1teTI7
ICh2b2lkKSgmX19kdW1teSA9PSAmX19kdW1teTIpOyAxOyB9KTsgX19mbGFncyA9IGFyY2hf
bG9jYWxfaXJxX3NhdmUoKTsgfSB3aGlsZSAoMCk7IGRvIHsgKih7IGRvIHsgY29uc3Qgdm9p
ZCAqX192cHBfdmVyaWZ5ID0gKHR5cGVvZigoJih2bV9ldmVudF9zdGF0ZXMuZXZlbnRbaXRl
bV0pKSArIDApKSgodm9pZCAqKTApOyAodm9pZClfX3ZwcF92ZXJpZnk7IH0gd2hpbGUgKDAp
OyAoeyB1bnNpZ25lZCBsb25nIF9fcHRyOyBfX2FzbV9fICgiIiA6ICI9ciIoX19wdHIpIDog
IjAiKCh0eXBlb2YoKigmKHZtX2V2ZW50X3N0YXRlcy5ldmVudFtpdGVtXSkpKSAqKSgmKHZt
X2V2ZW50X3N0YXRlcy5ldmVudFtpdGVtXSkpKSk7ICh0eXBlb2YoKHR5cGVvZigqKCYodm1f
ZXZlbnRfc3RhdGVzLmV2ZW50W2l0ZW1dKSkpICopKCYodm1fZXZlbnRfc3RhdGVzLmV2ZW50
W2l0ZW1dKSkpKSAoX19wdHIgKyAoKGxvY2FsX3BhY2EtPmRhdGFfb2Zmc2V0KSkpOyB9KTsg
fSkgKz0gZGVsdGE7IH0gd2hpbGUgKDApOyBkbyB7ICh7IHVuc2lnbmVkIGxvbmcgX19kdW1t
eTsgdHlwZW9mKF9fZmxhZ3MpIF9fZHVtbXkyOyAodm9pZCkoJl9fZHVtbXkgPT0gJl9fZHVt
bXkyKTsgMTsgfSk7IGFyY2hfbG9jYWxfaXJxX3Jlc3RvcmUoX19mbGFncyk7IH0gd2hpbGUg
KDApOyB9IHdoaWxlICgwKTticmVhazsgY2FzZSA4OiBkbyB7IHVuc2lnbmVkIGxvbmcgX19m
bGFnczsgZG8geyAoeyB1bnNpZ25lZCBsb25nIF9fZHVtbXk7IHR5cGVvZihfX2ZsYWdzKSBf
X2R1bW15MjsgKHZvaWQpKCZfX2R1bW15ID09ICZfX2R1bW15Mik7IDE7IH0pOyBfX2ZsYWdz
ID0gYXJjaF9sb2NhbF9pcnFfc2F2ZSgpOyB9IHdoaWxlICgwKTsgZG8geyAqKHsgZG8geyBj
b25zdCB2b2lkICpfX3ZwcF92ZXJpZnkgPSAodHlwZW9mKCgmKHZtX2V2ZW50X3N0YXRlcy5l
dmVudFtpdGVtXSkpICsgMCkpKCh2b2lkICopMCk7ICh2b2lkKV9fdnBwX3ZlcmlmeTsgfSB3
aGlsZSAoMCk7ICh7IHVuc2lnbmVkIGxvbmcgX19wdHI7IF9fYXNtX18gKCIiIDogIj1yIihf
X3B0cikgOiAiMCIoKHR5cGVvZigqKCYodm1fZXZlbnRfc3RhdGVzLmV2ZW50W2l0ZW1dKSkp
ICopKCYodm1fZXZlbnRfc3RhdGVzLmV2ZW50W2l0ZW1dKSkpKTsgKHR5cGVvZigodHlwZW9m
KCooJih2bV9ldmVudF9zdGF0ZXMuZXZlbnRbaXRlbV0pKSkgKikoJih2bV9ldmVudF9zdGF0
ZXMuZXZlbnRbaXRlbV0pKSkpIChfX3B0ciArICgobG9jYWxfcGFjYS0+ZGF0YV9vZmZzZXQp
KSk7IH0pOyB9KSArPSBkZWx0YTsgfSB3aGlsZSAoMCk7IGRvIHsgKHsgdW5zaWduZWQgbG9u
ZyBfX2R1bW15OyB0eXBlb2YoX19mbGFncykgX19kdW1teTI7ICh2b2lkKSgmX19kdW1teSA9
PSAmX19kdW1teTIpOyAxOyB9KTsgYXJjaF9sb2NhbF9pcnFfcmVzdG9yZShfX2ZsYWdzKTsg
fSB3aGlsZSAoMCk7IH0gd2hpbGUgKDApO2JyZWFrOyBkZWZhdWx0OiBfX2JhZF9zaXplX2Nh
bGxfcGFyYW1ldGVyKCk7YnJlYWs7IH0gfSB3aGlsZSAoMCk7Cn0KCmV4dGVybiB2b2lkIGFs
bF92bV9ldmVudHModW5zaWduZWQgbG9uZyAqKTsKCmV4dGVybiB2b2lkIHZtX2V2ZW50c19m
b2xkX2NwdShpbnQgY3B1KTsKIyAxMzkgIi4vaW5jbHVkZS9saW51eC92bXN0YXQuaCIKZXh0
ZXJuIGF0b21pY19sb25nX3Qgdm1fem9uZV9zdGF0W05SX1ZNX1pPTkVfU1RBVF9JVEVNU107
CmV4dGVybiBhdG9taWNfbG9uZ190IHZtX251bWFfc3RhdFswXTsKZXh0ZXJuIGF0b21pY19s
b25nX3Qgdm1fbm9kZV9zdGF0W05SX1ZNX05PREVfU1RBVF9JVEVNU107CiMgMTcxICIuL2lu
Y2x1ZGUvbGludXgvdm1zdGF0LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHpvbmVfcGFnZV9zdGF0ZV9h
ZGQobG9uZyB4LCBzdHJ1Y3Qgem9uZSAqem9uZSwKICAgICBlbnVtIHpvbmVfc3RhdF9pdGVt
IGl0ZW0pCnsKIGF0b21pY19sb25nX2FkZCh4LCAmem9uZS0+dm1fc3RhdFtpdGVtXSk7CiBh
dG9taWNfbG9uZ19hZGQoeCwgJnZtX3pvbmVfc3RhdFtpdGVtXSk7Cn0KCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2
b2lkIG5vZGVfcGFnZV9zdGF0ZV9hZGQobG9uZyB4LCBzdHJ1Y3QgcGdsaXN0X2RhdGEgKnBn
ZGF0LAogICAgIGVudW0gbm9kZV9zdGF0X2l0ZW0gaXRlbSkKewogYXRvbWljX2xvbmdfYWRk
KHgsICZwZ2RhdC0+dm1fc3RhdFtpdGVtXSk7CiBhdG9taWNfbG9uZ19hZGQoeCwgJnZtX25v
ZGVfc3RhdFtpdGVtXSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1bnNpZ25lZCBsb25nIGdsb2JhbF96b25l
X3BhZ2Vfc3RhdGUoZW51bSB6b25lX3N0YXRfaXRlbSBpdGVtKQp7CiBsb25nIHggPSBhdG9t
aWNfbG9uZ19yZWFkKCZ2bV96b25lX3N0YXRbaXRlbV0pOwoKIGlmICh4IDwgMCkKICB4ID0g
MDsKCiByZXR1cm4geDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHVuc2lnbmVkIGxvbmcgZ2xvYmFsX25vZGVf
cGFnZV9zdGF0ZShlbnVtIG5vZGVfc3RhdF9pdGVtIGl0ZW0pCnsKIGxvbmcgeCA9IGF0b21p
Y19sb25nX3JlYWQoJnZtX25vZGVfc3RhdFtpdGVtXSk7CgogaWYgKHggPCAwKQogIHggPSAw
OwoKIHJldHVybiB4Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgbG9uZyB6b25lX3BhZ2Vfc3Rh
dGUoc3RydWN0IHpvbmUgKnpvbmUsCiAgICAgZW51bSB6b25lX3N0YXRfaXRlbSBpdGVtKQp7
CiBsb25nIHggPSBhdG9taWNfbG9uZ19yZWFkKCZ6b25lLT52bV9zdGF0W2l0ZW1dKTsKCiBp
ZiAoeCA8IDApCiAgeCA9IDA7CgogcmV0dXJuIHg7Cn0KCgoKCgoKCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1bnNp
Z25lZCBsb25nIHpvbmVfcGFnZV9zdGF0ZV9zbmFwc2hvdChzdHJ1Y3Qgem9uZSAqem9uZSwK
ICAgICBlbnVtIHpvbmVfc3RhdF9pdGVtIGl0ZW0pCnsKIGxvbmcgeCA9IGF0b21pY19sb25n
X3JlYWQoJnpvbmUtPnZtX3N0YXRbaXRlbV0pOwoKCiBpbnQgY3B1OwogZm9yICgoKGNwdSkp
ID0gLTE7ICgoY3B1KSkgPSBjcHVtYXNrX25leHQoKChjcHUpKSwgKCgoY29uc3Qgc3RydWN0
IGNwdW1hc2sgKikmX19jcHVfb25saW5lX21hc2spKSksICgoY3B1KSkgPCBucl9jcHVfaWRz
OykKICB4ICs9ICh7IGRvIHsgY29uc3Qgdm9pZCAqX192cHBfdmVyaWZ5ID0gKHR5cGVvZigo
em9uZS0+cGFnZXNldCkgKyAwKSkoKHZvaWQgKikwKTsgKHZvaWQpX192cHBfdmVyaWZ5OyB9
IHdoaWxlICgwKTsgKHsgdW5zaWduZWQgbG9uZyBfX3B0cjsgX19hc21fXyAoIiIgOiAiPXIi
KF9fcHRyKSA6ICIwIigodHlwZW9mKCooKHpvbmUtPnBhZ2VzZXQpKSkgKikoKHpvbmUtPnBh
Z2VzZXQpKSkpOyAodHlwZW9mKCh0eXBlb2YoKigoem9uZS0+cGFnZXNldCkpKSAqKSgoem9u
ZS0+cGFnZXNldCkpKSkgKF9fcHRyICsgKCgoX19wZXJfY3B1X29mZnNldFsoY3B1KV0pKSkp
OyB9KTsgfSktPnZtX3N0YXRfZGlmZltpdGVtXTsKCiBpZiAoeCA8IDApCiAgeCA9IDA7Cgog
cmV0dXJuIHg7Cn0KIyAyNTEgIi4vaW5jbHVkZS9saW51eC92bXN0YXQuaCIKdm9pZCBfX21v
ZF96b25lX3BhZ2Vfc3RhdGUoc3RydWN0IHpvbmUgKiwgZW51bSB6b25lX3N0YXRfaXRlbSBp
dGVtLCBsb25nKTsKdm9pZCBfX2luY196b25lX3BhZ2Vfc3RhdGUoc3RydWN0IHBhZ2UgKiwg
ZW51bSB6b25lX3N0YXRfaXRlbSk7CnZvaWQgX19kZWNfem9uZV9wYWdlX3N0YXRlKHN0cnVj
dCBwYWdlICosIGVudW0gem9uZV9zdGF0X2l0ZW0pOwoKdm9pZCBfX21vZF9ub2RlX3BhZ2Vf
c3RhdGUoc3RydWN0IHBnbGlzdF9kYXRhICosIGVudW0gbm9kZV9zdGF0X2l0ZW0gaXRlbSwg
bG9uZyk7CnZvaWQgX19pbmNfbm9kZV9wYWdlX3N0YXRlKHN0cnVjdCBwYWdlICosIGVudW0g
bm9kZV9zdGF0X2l0ZW0pOwp2b2lkIF9fZGVjX25vZGVfcGFnZV9zdGF0ZShzdHJ1Y3QgcGFn
ZSAqLCBlbnVtIG5vZGVfc3RhdF9pdGVtKTsKCnZvaWQgbW9kX3pvbmVfcGFnZV9zdGF0ZShz
dHJ1Y3Qgem9uZSAqLCBlbnVtIHpvbmVfc3RhdF9pdGVtLCBsb25nKTsKdm9pZCBpbmNfem9u
ZV9wYWdlX3N0YXRlKHN0cnVjdCBwYWdlICosIGVudW0gem9uZV9zdGF0X2l0ZW0pOwp2b2lk
IGRlY196b25lX3BhZ2Vfc3RhdGUoc3RydWN0IHBhZ2UgKiwgZW51bSB6b25lX3N0YXRfaXRl
bSk7Cgp2b2lkIG1vZF9ub2RlX3BhZ2Vfc3RhdGUoc3RydWN0IHBnbGlzdF9kYXRhICosIGVu
dW0gbm9kZV9zdGF0X2l0ZW0sIGxvbmcpOwp2b2lkIGluY19ub2RlX3BhZ2Vfc3RhdGUoc3Ry
dWN0IHBhZ2UgKiwgZW51bSBub2RlX3N0YXRfaXRlbSk7CnZvaWQgZGVjX25vZGVfcGFnZV9z
dGF0ZShzdHJ1Y3QgcGFnZSAqLCBlbnVtIG5vZGVfc3RhdF9pdGVtKTsKCmV4dGVybiB2b2lk
IGluY19ub2RlX3N0YXRlKHN0cnVjdCBwZ2xpc3RfZGF0YSAqLCBlbnVtIG5vZGVfc3RhdF9p
dGVtKTsKZXh0ZXJuIHZvaWQgX19pbmNfem9uZV9zdGF0ZShzdHJ1Y3Qgem9uZSAqLCBlbnVt
IHpvbmVfc3RhdF9pdGVtKTsKZXh0ZXJuIHZvaWQgX19pbmNfbm9kZV9zdGF0ZShzdHJ1Y3Qg
cGdsaXN0X2RhdGEgKiwgZW51bSBub2RlX3N0YXRfaXRlbSk7CmV4dGVybiB2b2lkIGRlY196
b25lX3N0YXRlKHN0cnVjdCB6b25lICosIGVudW0gem9uZV9zdGF0X2l0ZW0pOwpleHRlcm4g
dm9pZCBfX2RlY196b25lX3N0YXRlKHN0cnVjdCB6b25lICosIGVudW0gem9uZV9zdGF0X2l0
ZW0pOwpleHRlcm4gdm9pZCBfX2RlY19ub2RlX3N0YXRlKHN0cnVjdCBwZ2xpc3RfZGF0YSAq
LCBlbnVtIG5vZGVfc3RhdF9pdGVtKTsKCnZvaWQgcXVpZXRfdm1zdGF0KHZvaWQpOwp2b2lk
IGNwdV92bV9zdGF0c19mb2xkKGludCBjcHUpOwp2b2lkIHJlZnJlc2hfem9uZV9zdGF0X3Ro
cmVzaG9sZHModm9pZCk7CgpzdHJ1Y3QgY3RsX3RhYmxlOwppbnQgdm1zdGF0X3JlZnJlc2go
c3RydWN0IGN0bF90YWJsZSAqLCBpbnQgd3JpdGUsIHZvaWQgKmJ1ZmZlciwgc2l6ZV90ICps
ZW5wLAogIGxvZmZfdCAqcHBvcyk7Cgp2b2lkIGRyYWluX3pvbmVzdGF0KHN0cnVjdCB6b25l
ICp6b25lLCBzdHJ1Y3QgcGVyX2NwdV9wYWdlc2V0ICopOwoKaW50IGNhbGN1bGF0ZV9wcmVz
c3VyZV90aHJlc2hvbGQoc3RydWN0IHpvbmUgKnpvbmUpOwppbnQgY2FsY3VsYXRlX25vcm1h
bF90aHJlc2hvbGQoc3RydWN0IHpvbmUgKnpvbmUpOwp2b2lkIHNldF9wZ2RhdF9wZXJjcHVf
dGhyZXNob2xkKHBnX2RhdGFfdCAqcGdkYXQsCiAgICBpbnQgKCpjYWxjdWxhdGVfcHJlc3N1
cmUpKHN0cnVjdCB6b25lICopKTsKIyAzODIgIi4vaW5jbHVkZS9saW51eC92bXN0YXQuaCIK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIHZvaWQgX19tb2Rfem9uZV9mcmVlcGFnZV9zdGF0ZShzdHJ1Y3Qgem9uZSAq
em9uZSwgaW50IG5yX3BhZ2VzLAogICAgICAgICAgaW50IG1pZ3JhdGV0eXBlKQp7CiBfX21v
ZF96b25lX3BhZ2Vfc3RhdGUoem9uZSwgTlJfRlJFRV9QQUdFUywgbnJfcGFnZXMpOwogaWYg
KGZhbHNlKQogIF9fbW9kX3pvbmVfcGFnZV9zdGF0ZSh6b25lLCBOUl9GUkVFX0NNQV9QQUdF
UywgbnJfcGFnZXMpOwp9CgpleHRlcm4gY29uc3QgY2hhciAqIGNvbnN0IHZtc3RhdF90ZXh0
W107CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgY29uc3QgY2hhciAqem9uZV9zdGF0X25hbWUoZW51bSB6b25lX3N0
YXRfaXRlbSBpdGVtKQp7CiByZXR1cm4gdm1zdGF0X3RleHRbaXRlbV07Cn0KIyA0MDUgIi4v
aW5jbHVkZS9saW51eC92bXN0YXQuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGNvbnN0IGNoYXIgKm5vZGVfc3Rh
dF9uYW1lKGVudW0gbm9kZV9zdGF0X2l0ZW0gaXRlbSkKewogcmV0dXJuIHZtc3RhdF90ZXh0
W05SX1ZNX1pPTkVfU1RBVF9JVEVNUyArCiAgICAgIDAgKwogICAgICBpdGVtXTsKfQoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIGNvbnN0IGNoYXIgKmxydV9saXN0X25hbWUoZW51bSBscnVfbGlzdCBscnUpCnsK
IHJldHVybiBub2RlX3N0YXRfbmFtZShOUl9MUlVfQkFTRSArIGxydSkgKyAzOwp9CgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgY29uc3QgY2hhciAqd3JpdGViYWNrX3N0YXRfbmFtZShlbnVtIHdyaXRlYmFja19z
dGF0X2l0ZW0gaXRlbSkKewogcmV0dXJuIHZtc3RhdF90ZXh0W05SX1ZNX1pPTkVfU1RBVF9J
VEVNUyArCiAgICAgIDAgKwogICAgICBOUl9WTV9OT0RFX1NUQVRfSVRFTVMgKwogICAgICBp
dGVtXTsKfQoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBjb25zdCBjaGFyICp2bV9ldmVudF9uYW1lKGVudW0gdm1f
ZXZlbnRfaXRlbSBpdGVtKQp7CiByZXR1cm4gdm1zdGF0X3RleHRbTlJfVk1fWk9ORV9TVEFU
X0lURU1TICsKICAgICAgMCArCiAgICAgIE5SX1ZNX05PREVfU1RBVF9JVEVNUyArCiAgICAg
IE5SX1ZNX1dSSVRFQkFDS19TVEFUX0lURU1TICsKICAgICAgaXRlbV07Cn0KIyAxNDg3ICIu
L2luY2x1ZGUvbGludXgvbW0uaCIgMgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3
YXlzX2lubGluZV9fKSkgdm9pZCAqbG93bWVtX3BhZ2VfYWRkcmVzcyhjb25zdCBzdHJ1Y3Qg
cGFnZSAqcGFnZSkKewogcmV0dXJuICh7IGRvIHsgfSB3aGlsZSAoMCk7ICh2b2lkICopKHVu
c2lnbmVkIGxvbmcpKChwaHlzX2FkZHJfdCkoKChwaHlzX2FkZHJfdCkoKCh1bnNpZ25lZCBs
b25nKSgocGFnZSkgLSBtZW1fbWFwKSArICgodW5zaWduZWQgbG9uZykoMFVMID4+IDEyKSkp
KSA8PCAxMikpIHwgMHhjMDAwMDAwMDAwMDAwMDAwVUwpOyB9KTsKfQojIDE1MjEgIi4vaW5j
bHVkZS9saW51eC9tbS5oIgpleHRlcm4gdm9pZCAqcGFnZV9ybWFwcGluZyhzdHJ1Y3QgcGFn
ZSAqcGFnZSk7CmV4dGVybiBzdHJ1Y3QgYW5vbl92bWEgKnBhZ2VfYW5vbl92bWEoc3RydWN0
IHBhZ2UgKnBhZ2UpOwpleHRlcm4gc3RydWN0IGFkZHJlc3Nfc3BhY2UgKnBhZ2VfbWFwcGlu
ZyhzdHJ1Y3QgcGFnZSAqcGFnZSk7CgpleHRlcm4gc3RydWN0IGFkZHJlc3Nfc3BhY2UgKl9f
cGFnZV9maWxlX21hcHBpbmcoc3RydWN0IHBhZ2UgKik7CgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkKc3RydWN0IGFk
ZHJlc3Nfc3BhY2UgKnBhZ2VfZmlsZV9tYXBwaW5nKHN0cnVjdCBwYWdlICpwYWdlKQp7CiBp
ZiAoX19idWlsdGluX2V4cGVjdCghIShQYWdlU3dhcENhY2hlKHBhZ2UpKSwgMCkpCiAgcmV0
dXJuIF9fcGFnZV9maWxlX21hcHBpbmcocGFnZSk7CgogcmV0dXJuIHBhZ2UtPm1hcHBpbmc7
Cn0KCmV4dGVybiB1bnNpZ25lZCBsb25nIF9fcGFnZV9maWxlX2luZGV4KHN0cnVjdCBwYWdl
ICpwYWdlKTsKCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgbG9uZyBwYWdlX2luZGV4KHN0cnVj
dCBwYWdlICpwYWdlKQp7CiBpZiAoX19idWlsdGluX2V4cGVjdCghIShQYWdlU3dhcENhY2hl
KHBhZ2UpKSwgMCkpCiAgcmV0dXJuIF9fcGFnZV9maWxlX2luZGV4KHBhZ2UpOwogcmV0dXJu
IHBhZ2UtPmluZGV4Owp9Cgpib29sIHBhZ2VfbWFwcGVkKHN0cnVjdCBwYWdlICpwYWdlKTsK
c3RydWN0IGFkZHJlc3Nfc3BhY2UgKnBhZ2VfbWFwcGluZyhzdHJ1Y3QgcGFnZSAqcGFnZSk7
CnN0cnVjdCBhZGRyZXNzX3NwYWNlICpwYWdlX21hcHBpbmdfZmlsZShzdHJ1Y3QgcGFnZSAq
cGFnZSk7CgoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIHBhZ2VfaXNfcGZtZW1hbGxvYyhzdHJ1Y3Qg
cGFnZSAqcGFnZSkKewoKCgoKIHJldHVybiBwYWdlLT5pbmRleCA9PSAtMVVMOwp9CgoKCgoK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIHZvaWQgc2V0X3BhZ2VfcGZtZW1hbGxvYyhzdHJ1Y3QgcGFnZSAqcGFnZSkK
ewogcGFnZS0+aW5kZXggPSAtMVVMOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBjbGVhcl9wYWdlX3Bm
bWVtYWxsb2Moc3RydWN0IHBhZ2UgKnBhZ2UpCnsKIHBhZ2UtPmluZGV4ID0gMDsKfQoKCgoK
ZXh0ZXJuIHZvaWQgcGFnZWZhdWx0X291dF9vZl9tZW1vcnkodm9pZCk7CiMgMTU5NCAiLi9p
bmNsdWRlL2xpbnV4L21tLmgiCmV4dGVybiB2b2lkIHNob3dfZnJlZV9hcmVhcyh1bnNpZ25l
ZCBpbnQgZmxhZ3MsIG5vZGVtYXNrX3QgKm5vZGVtYXNrKTsKCgpleHRlcm4gYm9vbCBjYW5f
ZG9fbWxvY2sodm9pZCk7CgoKCmV4dGVybiBpbnQgdXNlcl9zaG1fbG9jayhzaXplX3QsIHN0
cnVjdCB1c2VyX3N0cnVjdCAqKTsKZXh0ZXJuIHZvaWQgdXNlcl9zaG1fdW5sb2NrKHNpemVf
dCwgc3RydWN0IHVzZXJfc3RydWN0ICopOwoKCgoKc3RydWN0IHphcF9kZXRhaWxzIHsKIHN0
cnVjdCBhZGRyZXNzX3NwYWNlICpjaGVja19tYXBwaW5nOwogdW5zaWduZWQgbG9uZyBmaXJz
dF9pbmRleDsKIHVuc2lnbmVkIGxvbmcgbGFzdF9pbmRleDsKfTsKCnN0cnVjdCBwYWdlICp2
bV9ub3JtYWxfcGFnZShzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnZtYSwgdW5zaWduZWQgbG9u
ZyBhZGRyLAogICAgICAgIHB0ZV90IHB0ZSk7CnN0cnVjdCBwYWdlICp2bV9ub3JtYWxfcGFn
ZV9wbWQoc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEsIHVuc2lnbmVkIGxvbmcgYWRkciwK
ICAgIHBtZF90IHBtZCk7Cgp2b2lkIHphcF92bWFfcHRlcyhzdHJ1Y3Qgdm1fYXJlYV9zdHJ1
Y3QgKnZtYSwgdW5zaWduZWQgbG9uZyBhZGRyZXNzLAogICAgdW5zaWduZWQgbG9uZyBzaXpl
KTsKdm9pZCB6YXBfcGFnZV9yYW5nZShzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnZtYSwgdW5z
aWduZWQgbG9uZyBhZGRyZXNzLAogICAgICB1bnNpZ25lZCBsb25nIHNpemUpOwp2b2lkIHVu
bWFwX3ZtYXMoc3RydWN0IG1tdV9nYXRoZXIgKnRsYiwgc3RydWN0IHZtX2FyZWFfc3RydWN0
ICpzdGFydF92bWEsCiAgdW5zaWduZWQgbG9uZyBzdGFydCwgdW5zaWduZWQgbG9uZyBlbmQp
OwoKc3RydWN0IG1tdV9ub3RpZmllcl9yYW5nZTsKCnZvaWQgZnJlZV9wZ2RfcmFuZ2Uoc3Ry
dWN0IG1tdV9nYXRoZXIgKnRsYiwgdW5zaWduZWQgbG9uZyBhZGRyLAogIHVuc2lnbmVkIGxv
bmcgZW5kLCB1bnNpZ25lZCBsb25nIGZsb29yLCB1bnNpZ25lZCBsb25nIGNlaWxpbmcpOwpp
bnQgY29weV9wYWdlX3JhbmdlKHN0cnVjdCBtbV9zdHJ1Y3QgKmRzdCwgc3RydWN0IG1tX3N0
cnVjdCAqc3JjLAogICBzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnZtYSk7CmludCBmb2xsb3df
cHRlX3BtZChzdHJ1Y3QgbW1fc3RydWN0ICptbSwgdW5zaWduZWQgbG9uZyBhZGRyZXNzLAog
ICAgIHN0cnVjdCBtbXVfbm90aWZpZXJfcmFuZ2UgKnJhbmdlLAogICAgIHB0ZV90ICoqcHRl
cHAsIHBtZF90ICoqcG1kcHAsIHNwaW5sb2NrX3QgKipwdGxwKTsKaW50IGZvbGxvd19wZm4o
c3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEsIHVuc2lnbmVkIGxvbmcgYWRkcmVzcywKIHVu
c2lnbmVkIGxvbmcgKnBmbik7CmludCBmb2xsb3dfcGh5cyhzdHJ1Y3Qgdm1fYXJlYV9zdHJ1
Y3QgKnZtYSwgdW5zaWduZWQgbG9uZyBhZGRyZXNzLAogIHVuc2lnbmVkIGludCBmbGFncywg
dW5zaWduZWQgbG9uZyAqcHJvdCwgcmVzb3VyY2Vfc2l6ZV90ICpwaHlzKTsKaW50IGdlbmVy
aWNfYWNjZXNzX3BoeXMoc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEsIHVuc2lnbmVkIGxv
bmcgYWRkciwKICAgdm9pZCAqYnVmLCBpbnQgbGVuLCBpbnQgd3JpdGUpOwoKZXh0ZXJuIHZv
aWQgdHJ1bmNhdGVfcGFnZWNhY2hlKHN0cnVjdCBpbm9kZSAqaW5vZGUsIGxvZmZfdCBuZXcp
OwpleHRlcm4gdm9pZCB0cnVuY2F0ZV9zZXRzaXplKHN0cnVjdCBpbm9kZSAqaW5vZGUsIGxv
ZmZfdCBuZXdzaXplKTsKdm9pZCBwYWdlY2FjaGVfaXNpemVfZXh0ZW5kZWQoc3RydWN0IGlu
b2RlICppbm9kZSwgbG9mZl90IGZyb20sIGxvZmZfdCB0byk7CnZvaWQgdHJ1bmNhdGVfcGFn
ZWNhY2hlX3JhbmdlKHN0cnVjdCBpbm9kZSAqaW5vZGUsIGxvZmZfdCBvZmZzZXQsIGxvZmZf
dCBlbmQpOwppbnQgdHJ1bmNhdGVfaW5vZGVfcGFnZShzdHJ1Y3QgYWRkcmVzc19zcGFjZSAq
bWFwcGluZywgc3RydWN0IHBhZ2UgKnBhZ2UpOwppbnQgZ2VuZXJpY19lcnJvcl9yZW1vdmVf
cGFnZShzdHJ1Y3QgYWRkcmVzc19zcGFjZSAqbWFwcGluZywgc3RydWN0IHBhZ2UgKnBhZ2Up
OwppbnQgaW52YWxpZGF0ZV9pbm9kZV9wYWdlKHN0cnVjdCBwYWdlICpwYWdlKTsKCgpleHRl
cm4gdm1fZmF1bHRfdCBoYW5kbGVfbW1fZmF1bHQoc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2
bWEsCiAgIHVuc2lnbmVkIGxvbmcgYWRkcmVzcywgdW5zaWduZWQgaW50IGZsYWdzKTsKZXh0
ZXJuIGludCBmaXh1cF91c2VyX2ZhdWx0KHN0cnVjdCB0YXNrX3N0cnVjdCAqdHNrLCBzdHJ1
Y3QgbW1fc3RydWN0ICptbSwKICAgICAgIHVuc2lnbmVkIGxvbmcgYWRkcmVzcywgdW5zaWdu
ZWQgaW50IGZhdWx0X2ZsYWdzLAogICAgICAgYm9vbCAqdW5sb2NrZWQpOwp2b2lkIHVubWFw
X21hcHBpbmdfcGFnZXMoc3RydWN0IGFkZHJlc3Nfc3BhY2UgKm1hcHBpbmcsCiAgdW5zaWdu
ZWQgbG9uZyBzdGFydCwgdW5zaWduZWQgbG9uZyBuciwgYm9vbCBldmVuX2Nvd3MpOwp2b2lk
IHVubWFwX21hcHBpbmdfcmFuZ2Uoc3RydWN0IGFkZHJlc3Nfc3BhY2UgKm1hcHBpbmcsCiAg
bG9mZl90IGNvbnN0IGhvbGViZWdpbiwgbG9mZl90IGNvbnN0IGhvbGVsZW4sIGludCBldmVu
X2Nvd3MpOwojIDE2ODEgIi4vaW5jbHVkZS9saW51eC9tbS5oIgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCB1
bm1hcF9zaGFyZWRfbWFwcGluZ19yYW5nZShzdHJ1Y3QgYWRkcmVzc19zcGFjZSAqbWFwcGlu
ZywKICBsb2ZmX3QgY29uc3QgaG9sZWJlZ2luLCBsb2ZmX3QgY29uc3QgaG9sZWxlbikKewog
dW5tYXBfbWFwcGluZ19yYW5nZShtYXBwaW5nLCBob2xlYmVnaW4sIGhvbGVsZW4sIDApOwp9
CgpleHRlcm4gaW50IGFjY2Vzc19wcm9jZXNzX3ZtKHN0cnVjdCB0YXNrX3N0cnVjdCAqdHNr
LCB1bnNpZ25lZCBsb25nIGFkZHIsCiAgdm9pZCAqYnVmLCBpbnQgbGVuLCB1bnNpZ25lZCBp
bnQgZ3VwX2ZsYWdzKTsKZXh0ZXJuIGludCBhY2Nlc3NfcmVtb3RlX3ZtKHN0cnVjdCBtbV9z
dHJ1Y3QgKm1tLCB1bnNpZ25lZCBsb25nIGFkZHIsCiAgdm9pZCAqYnVmLCBpbnQgbGVuLCB1
bnNpZ25lZCBpbnQgZ3VwX2ZsYWdzKTsKZXh0ZXJuIGludCBfX2FjY2Vzc19yZW1vdGVfdm0o
c3RydWN0IHRhc2tfc3RydWN0ICp0c2ssIHN0cnVjdCBtbV9zdHJ1Y3QgKm1tLAogIHVuc2ln
bmVkIGxvbmcgYWRkciwgdm9pZCAqYnVmLCBpbnQgbGVuLCB1bnNpZ25lZCBpbnQgZ3VwX2Zs
YWdzKTsKCmxvbmcgZ2V0X3VzZXJfcGFnZXNfcmVtb3RlKHN0cnVjdCB0YXNrX3N0cnVjdCAq
dHNrLCBzdHJ1Y3QgbW1fc3RydWN0ICptbSwKICAgICAgIHVuc2lnbmVkIGxvbmcgc3RhcnQs
IHVuc2lnbmVkIGxvbmcgbnJfcGFnZXMsCiAgICAgICB1bnNpZ25lZCBpbnQgZ3VwX2ZsYWdz
LCBzdHJ1Y3QgcGFnZSAqKnBhZ2VzLAogICAgICAgc3RydWN0IHZtX2FyZWFfc3RydWN0ICoq
dm1hcywgaW50ICpsb2NrZWQpOwpsb25nIHBpbl91c2VyX3BhZ2VzX3JlbW90ZShzdHJ1Y3Qg
dGFza19zdHJ1Y3QgKnRzaywgc3RydWN0IG1tX3N0cnVjdCAqbW0sCiAgICAgIHVuc2lnbmVk
IGxvbmcgc3RhcnQsIHVuc2lnbmVkIGxvbmcgbnJfcGFnZXMsCiAgICAgIHVuc2lnbmVkIGlu
dCBndXBfZmxhZ3MsIHN0cnVjdCBwYWdlICoqcGFnZXMsCiAgICAgIHN0cnVjdCB2bV9hcmVh
X3N0cnVjdCAqKnZtYXMsIGludCAqbG9ja2VkKTsKbG9uZyBnZXRfdXNlcl9wYWdlcyh1bnNp
Z25lZCBsb25nIHN0YXJ0LCB1bnNpZ25lZCBsb25nIG5yX3BhZ2VzLAogICAgICAgdW5zaWdu
ZWQgaW50IGd1cF9mbGFncywgc3RydWN0IHBhZ2UgKipwYWdlcywKICAgICAgIHN0cnVjdCB2
bV9hcmVhX3N0cnVjdCAqKnZtYXMpOwpsb25nIHBpbl91c2VyX3BhZ2VzKHVuc2lnbmVkIGxv
bmcgc3RhcnQsIHVuc2lnbmVkIGxvbmcgbnJfcGFnZXMsCiAgICAgIHVuc2lnbmVkIGludCBn
dXBfZmxhZ3MsIHN0cnVjdCBwYWdlICoqcGFnZXMsCiAgICAgIHN0cnVjdCB2bV9hcmVhX3N0
cnVjdCAqKnZtYXMpOwpsb25nIGdldF91c2VyX3BhZ2VzX2xvY2tlZCh1bnNpZ25lZCBsb25n
IHN0YXJ0LCB1bnNpZ25lZCBsb25nIG5yX3BhZ2VzLAogICAgICB1bnNpZ25lZCBpbnQgZ3Vw
X2ZsYWdzLCBzdHJ1Y3QgcGFnZSAqKnBhZ2VzLCBpbnQgKmxvY2tlZCk7CmxvbmcgcGluX3Vz
ZXJfcGFnZXNfbG9ja2VkKHVuc2lnbmVkIGxvbmcgc3RhcnQsIHVuc2lnbmVkIGxvbmcgbnJf
cGFnZXMsCiAgICAgIHVuc2lnbmVkIGludCBndXBfZmxhZ3MsIHN0cnVjdCBwYWdlICoqcGFn
ZXMsIGludCAqbG9ja2VkKTsKbG9uZyBnZXRfdXNlcl9wYWdlc191bmxvY2tlZCh1bnNpZ25l
ZCBsb25nIHN0YXJ0LCB1bnNpZ25lZCBsb25nIG5yX3BhZ2VzLAogICAgICBzdHJ1Y3QgcGFn
ZSAqKnBhZ2VzLCB1bnNpZ25lZCBpbnQgZ3VwX2ZsYWdzKTsKbG9uZyBwaW5fdXNlcl9wYWdl
c191bmxvY2tlZCh1bnNpZ25lZCBsb25nIHN0YXJ0LCB1bnNpZ25lZCBsb25nIG5yX3BhZ2Vz
LAogICAgICBzdHJ1Y3QgcGFnZSAqKnBhZ2VzLCB1bnNpZ25lZCBpbnQgZ3VwX2ZsYWdzKTsK
CmludCBnZXRfdXNlcl9wYWdlc19mYXN0KHVuc2lnbmVkIGxvbmcgc3RhcnQsIGludCBucl9w
YWdlcywKICAgdW5zaWduZWQgaW50IGd1cF9mbGFncywgc3RydWN0IHBhZ2UgKipwYWdlcyk7
CmludCBwaW5fdXNlcl9wYWdlc19mYXN0KHVuc2lnbmVkIGxvbmcgc3RhcnQsIGludCBucl9w
YWdlcywKICAgdW5zaWduZWQgaW50IGd1cF9mbGFncywgc3RydWN0IHBhZ2UgKipwYWdlcyk7
CgppbnQgYWNjb3VudF9sb2NrZWRfdm0oc3RydWN0IG1tX3N0cnVjdCAqbW0sIHVuc2lnbmVk
IGxvbmcgcGFnZXMsIGJvb2wgaW5jKTsKaW50IF9fYWNjb3VudF9sb2NrZWRfdm0oc3RydWN0
IG1tX3N0cnVjdCAqbW0sIHVuc2lnbmVkIGxvbmcgcGFnZXMsIGJvb2wgaW5jLAogICBzdHJ1
Y3QgdGFza19zdHJ1Y3QgKnRhc2ssIGJvb2wgYnlwYXNzX3JsaW0pOwoKCnN0cnVjdCBmcmFt
ZV92ZWN0b3IgewogdW5zaWduZWQgaW50IG5yX2FsbG9jYXRlZDsKIHVuc2lnbmVkIGludCBu
cl9mcmFtZXM7CiBib29sIGdvdF9yZWY7CiBib29sIGlzX3BmbnM7CiB2b2lkICpwdHJzW107
CgoKfTsKCnN0cnVjdCBmcmFtZV92ZWN0b3IgKmZyYW1lX3ZlY3Rvcl9jcmVhdGUodW5zaWdu
ZWQgaW50IG5yX2ZyYW1lcyk7CnZvaWQgZnJhbWVfdmVjdG9yX2Rlc3Ryb3koc3RydWN0IGZy
YW1lX3ZlY3RvciAqdmVjKTsKaW50IGdldF92YWRkcl9mcmFtZXModW5zaWduZWQgbG9uZyBz
dGFydCwgdW5zaWduZWQgaW50IG5yX3BmbnMsCiAgICAgICB1bnNpZ25lZCBpbnQgZ3VwX2Zs
YWdzLCBzdHJ1Y3QgZnJhbWVfdmVjdG9yICp2ZWMpOwp2b2lkIHB1dF92YWRkcl9mcmFtZXMo
c3RydWN0IGZyYW1lX3ZlY3RvciAqdmVjKTsKaW50IGZyYW1lX3ZlY3Rvcl90b19wYWdlcyhz
dHJ1Y3QgZnJhbWVfdmVjdG9yICp2ZWMpOwp2b2lkIGZyYW1lX3ZlY3Rvcl90b19wZm5zKHN0
cnVjdCBmcmFtZV92ZWN0b3IgKnZlYyk7CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgaW50IGZyYW1l
X3ZlY3Rvcl9jb3VudChzdHJ1Y3QgZnJhbWVfdmVjdG9yICp2ZWMpCnsKIHJldHVybiB2ZWMt
Pm5yX2ZyYW1lczsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHN0cnVjdCBwYWdlICoqZnJhbWVfdmVjdG9yX3Bh
Z2VzKHN0cnVjdCBmcmFtZV92ZWN0b3IgKnZlYykKewogaWYgKHZlYy0+aXNfcGZucykgewog
IGludCBlcnIgPSBmcmFtZV92ZWN0b3JfdG9fcGFnZXModmVjKTsKCiAgaWYgKGVycikKICAg
cmV0dXJuIEVSUl9QVFIoZXJyKTsKIH0KIHJldHVybiAoc3RydWN0IHBhZ2UgKiopKHZlYy0+
cHRycyk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSB1bnNpZ25lZCBsb25nICpmcmFtZV92ZWN0b3JfcGZucyhz
dHJ1Y3QgZnJhbWVfdmVjdG9yICp2ZWMpCnsKIGlmICghdmVjLT5pc19wZm5zKQogIGZyYW1l
X3ZlY3Rvcl90b19wZm5zKHZlYyk7CiByZXR1cm4gKHVuc2lnbmVkIGxvbmcgKikodmVjLT5w
dHJzKTsKfQoKc3RydWN0IGt2ZWM7CmludCBnZXRfa2VybmVsX3BhZ2VzKGNvbnN0IHN0cnVj
dCBrdmVjICppb3YsIGludCBucl9wYWdlcywgaW50IHdyaXRlLAogICBzdHJ1Y3QgcGFnZSAq
KnBhZ2VzKTsKaW50IGdldF9rZXJuZWxfcGFnZSh1bnNpZ25lZCBsb25nIHN0YXJ0LCBpbnQg
d3JpdGUsIHN0cnVjdCBwYWdlICoqcGFnZXMpOwpzdHJ1Y3QgcGFnZSAqZ2V0X2R1bXBfcGFn
ZSh1bnNpZ25lZCBsb25nIGFkZHIpOwoKZXh0ZXJuIGludCB0cnlfdG9fcmVsZWFzZV9wYWdl
KHN0cnVjdCBwYWdlICogcGFnZSwgZ2ZwX3QgZ2ZwX21hc2spOwpleHRlcm4gdm9pZCBkb19p
bnZhbGlkYXRlcGFnZShzdHJ1Y3QgcGFnZSAqcGFnZSwgdW5zaWduZWQgaW50IG9mZnNldCwK
ICAgICAgICAgdW5zaWduZWQgaW50IGxlbmd0aCk7Cgp2b2lkIF9fc2V0X3BhZ2VfZGlydHko
c3RydWN0IHBhZ2UgKiwgc3RydWN0IGFkZHJlc3Nfc3BhY2UgKiwgaW50IHdhcm4pOwppbnQg
X19zZXRfcGFnZV9kaXJ0eV9ub2J1ZmZlcnMoc3RydWN0IHBhZ2UgKnBhZ2UpOwppbnQgX19z
ZXRfcGFnZV9kaXJ0eV9ub193cml0ZWJhY2soc3RydWN0IHBhZ2UgKnBhZ2UpOwppbnQgcmVk
aXJ0eV9wYWdlX2Zvcl93cml0ZXBhZ2Uoc3RydWN0IHdyaXRlYmFja19jb250cm9sICp3YmMs
CiAgICBzdHJ1Y3QgcGFnZSAqcGFnZSk7CnZvaWQgYWNjb3VudF9wYWdlX2RpcnRpZWQoc3Ry
dWN0IHBhZ2UgKnBhZ2UsIHN0cnVjdCBhZGRyZXNzX3NwYWNlICptYXBwaW5nKTsKdm9pZCBh
Y2NvdW50X3BhZ2VfY2xlYW5lZChzdHJ1Y3QgcGFnZSAqcGFnZSwgc3RydWN0IGFkZHJlc3Nf
c3BhY2UgKm1hcHBpbmcsCiAgICAgc3RydWN0IGJkaV93cml0ZWJhY2sgKndiKTsKaW50IHNl
dF9wYWdlX2RpcnR5KHN0cnVjdCBwYWdlICpwYWdlKTsKaW50IHNldF9wYWdlX2RpcnR5X2xv
Y2soc3RydWN0IHBhZ2UgKnBhZ2UpOwp2b2lkIF9fY2FuY2VsX2RpcnR5X3BhZ2Uoc3RydWN0
IHBhZ2UgKnBhZ2UpOwpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBjYW5jZWxfZGlydHlfcGFnZShzdHJ1Y3Qg
cGFnZSAqcGFnZSkKewoKIGlmIChQYWdlRGlydHkocGFnZSkpCiAgX19jYW5jZWxfZGlydHlf
cGFnZShwYWdlKTsKfQppbnQgY2xlYXJfcGFnZV9kaXJ0eV9mb3JfaW8oc3RydWN0IHBhZ2Ug
KnBhZ2UpOwoKaW50IGdldF9jbWRsaW5lKHN0cnVjdCB0YXNrX3N0cnVjdCAqdGFzaywgY2hh
ciAqYnVmZmVyLCBpbnQgYnVmbGVuKTsKCmV4dGVybiB1bnNpZ25lZCBsb25nIG1vdmVfcGFn
ZV90YWJsZXMoc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEsCiAgdW5zaWduZWQgbG9uZyBv
bGRfYWRkciwgc3RydWN0IHZtX2FyZWFfc3RydWN0ICpuZXdfdm1hLAogIHVuc2lnbmVkIGxv
bmcgbmV3X2FkZHIsIHVuc2lnbmVkIGxvbmcgbGVuLAogIGJvb2wgbmVlZF9ybWFwX2xvY2tz
KTsKIyAxODIwICIuL2luY2x1ZGUvbGludXgvbW0uaCIKZXh0ZXJuIHVuc2lnbmVkIGxvbmcg
Y2hhbmdlX3Byb3RlY3Rpb24oc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEsIHVuc2lnbmVk
IGxvbmcgc3RhcnQsCiAgICAgICAgIHVuc2lnbmVkIGxvbmcgZW5kLCBwZ3Byb3RfdCBuZXdw
cm90LAogICAgICAgICB1bnNpZ25lZCBsb25nIGNwX2ZsYWdzKTsKZXh0ZXJuIGludCBtcHJv
dGVjdF9maXh1cChzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnZtYSwKICAgICBzdHJ1Y3Qgdm1f
YXJlYV9zdHJ1Y3QgKipwcHJldiwgdW5zaWduZWQgbG9uZyBzdGFydCwKICAgICB1bnNpZ25l
ZCBsb25nIGVuZCwgdW5zaWduZWQgbG9uZyBuZXdmbGFncyk7CgoKCgppbnQgZ2V0X3VzZXJf
cGFnZXNfZmFzdF9vbmx5KHVuc2lnbmVkIGxvbmcgc3RhcnQsIGludCBucl9wYWdlcywKICAg
ICAgICB1bnNpZ25lZCBpbnQgZ3VwX2ZsYWdzLCBzdHJ1Y3QgcGFnZSAqKnBhZ2VzKTsKaW50
IHBpbl91c2VyX3BhZ2VzX2Zhc3Rfb25seSh1bnNpZ25lZCBsb25nIHN0YXJ0LCBpbnQgbnJf
cGFnZXMsCiAgICAgICAgdW5zaWduZWQgaW50IGd1cF9mbGFncywgc3RydWN0IHBhZ2UgKipw
YWdlcyk7CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBnZXRfdXNlcl9wYWdlX2Zhc3Rfb25seSh1bnNpZ25l
ZCBsb25nIGFkZHIsCiAgIHVuc2lnbmVkIGludCBndXBfZmxhZ3MsIHN0cnVjdCBwYWdlICoq
cGFnZXApCnsKIHJldHVybiBnZXRfdXNlcl9wYWdlc19mYXN0X29ubHkoYWRkciwgMSwgZ3Vw
X2ZsYWdzLCBwYWdlcCkgPT0gMTsKfQoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgbG9uZyBnZXRf
bW1fY291bnRlcihzdHJ1Y3QgbW1fc3RydWN0ICptbSwgaW50IG1lbWJlcikKewogbG9uZyB2
YWwgPSBhdG9taWNfbG9uZ19yZWFkKCZtbS0+cnNzX3N0YXQuY291bnRbbWVtYmVyXSk7CgoK
CgoKCiBpZiAodmFsIDwgMCkKICB2YWwgPSAwOwoKIHJldHVybiAodW5zaWduZWQgbG9uZyl2
YWw7Cn0KCnZvaWQgbW1fdHJhY2VfcnNzX3N0YXQoc3RydWN0IG1tX3N0cnVjdCAqbW0sIGlu
dCBtZW1iZXIsIGxvbmcgY291bnQpOwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgYWRkX21tX2NvdW50ZXIo
c3RydWN0IG1tX3N0cnVjdCAqbW0sIGludCBtZW1iZXIsIGxvbmcgdmFsdWUpCnsKIGxvbmcg
Y291bnQgPSBhdG9taWNfbG9uZ19hZGRfcmV0dXJuKHZhbHVlLCAmbW0tPnJzc19zdGF0LmNv
dW50W21lbWJlcl0pOwoKIG1tX3RyYWNlX3Jzc19zdGF0KG1tLCBtZW1iZXIsIGNvdW50KTsK
fQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIHZvaWQgaW5jX21tX2NvdW50ZXIoc3RydWN0IG1tX3N0cnVjdCAqbW0s
IGludCBtZW1iZXIpCnsKIGxvbmcgY291bnQgPSBhdG9taWNfbG9uZ19pbmNfcmV0dXJuKCZt
bS0+cnNzX3N0YXQuY291bnRbbWVtYmVyXSk7CgogbW1fdHJhY2VfcnNzX3N0YXQobW0sIG1l
bWJlciwgY291bnQpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBkZWNfbW1fY291bnRlcihzdHJ1Y3Qg
bW1fc3RydWN0ICptbSwgaW50IG1lbWJlcikKewogbG9uZyBjb3VudCA9IGF0b21pY19sb25n
X2RlY19yZXR1cm4oJm1tLT5yc3Nfc3RhdC5jb3VudFttZW1iZXJdKTsKCiBtbV90cmFjZV9y
c3Nfc3RhdChtbSwgbWVtYmVyLCBjb3VudCk7Cn0KCgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IG1tX2NvdW50
ZXJfZmlsZShzdHJ1Y3QgcGFnZSAqcGFnZSkKewogaWYgKFBhZ2VTd2FwQmFja2VkKHBhZ2Up
KQogIHJldHVybiBNTV9TSE1FTVBBR0VTOwogcmV0dXJuIE1NX0ZJTEVQQUdFUzsKfQoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIGludCBtbV9jb3VudGVyKHN0cnVjdCBwYWdlICpwYWdlKQp7CiBpZiAoUGFnZUFu
b24ocGFnZSkpCiAgcmV0dXJuIE1NX0FOT05QQUdFUzsKIHJldHVybiBtbV9jb3VudGVyX2Zp
bGUocGFnZSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1bnNpZ25lZCBsb25nIGdldF9tbV9yc3Moc3RydWN0
IG1tX3N0cnVjdCAqbW0pCnsKIHJldHVybiBnZXRfbW1fY291bnRlcihtbSwgTU1fRklMRVBB
R0VTKSArCiAgZ2V0X21tX2NvdW50ZXIobW0sIE1NX0FOT05QQUdFUykgKwogIGdldF9tbV9j
b3VudGVyKG1tLCBNTV9TSE1FTVBBR0VTKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHVuc2lnbmVkIGxvbmcg
Z2V0X21tX2hpd2F0ZXJfcnNzKHN0cnVjdCBtbV9zdHJ1Y3QgKm1tKQp7CiByZXR1cm4gX19i
dWlsdGluX2Nob29zZV9leHByKCgoISEoc2l6ZW9mKCh0eXBlb2YobW0tPmhpd2F0ZXJfcnNz
KSAqKTEgPT0gKHR5cGVvZihnZXRfbW1fcnNzKG1tKSkgKikxKSkpICYmICgoc2l6ZW9mKGlu
dCkgPT0gc2l6ZW9mKCooOCA/ICgodm9pZCAqKSgobG9uZykobW0tPmhpd2F0ZXJfcnNzKSAq
IDBsKSkgOiAoaW50ICopOCkpKSAmJiAoc2l6ZW9mKGludCkgPT0gc2l6ZW9mKCooOCA/ICgo
dm9pZCAqKSgobG9uZykoZ2V0X21tX3JzcyhtbSkpICogMGwpKSA6IChpbnQgKik4KSkpKSks
ICgobW0tPmhpd2F0ZXJfcnNzKSA+IChnZXRfbW1fcnNzKG1tKSkgPyAobW0tPmhpd2F0ZXJf
cnNzKSA6IChnZXRfbW1fcnNzKG1tKSkpLCAoeyB0eXBlb2YobW0tPmhpd2F0ZXJfcnNzKSBf
X1VOSVFVRV9JRF9fX3gxNzMgPSAobW0tPmhpd2F0ZXJfcnNzKTsgdHlwZW9mKGdldF9tbV9y
c3MobW0pKSBfX1VOSVFVRV9JRF9fX3kxNzQgPSAoZ2V0X21tX3JzcyhtbSkpOyAoKF9fVU5J
UVVFX0lEX19feDE3MykgPiAoX19VTklRVUVfSURfX195MTc0KSA/IChfX1VOSVFVRV9JRF9f
X3gxNzMpIDogKF9fVU5JUVVFX0lEX19feTE3NCkpOyB9KSk7Cn0KCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1bnNp
Z25lZCBsb25nIGdldF9tbV9oaXdhdGVyX3ZtKHN0cnVjdCBtbV9zdHJ1Y3QgKm1tKQp7CiBy
ZXR1cm4gX19idWlsdGluX2Nob29zZV9leHByKCgoISEoc2l6ZW9mKCh0eXBlb2YobW0tPmhp
d2F0ZXJfdm0pICopMSA9PSAodHlwZW9mKG1tLT50b3RhbF92bSkgKikxKSkpICYmICgoc2l6
ZW9mKGludCkgPT0gc2l6ZW9mKCooOCA/ICgodm9pZCAqKSgobG9uZykobW0tPmhpd2F0ZXJf
dm0pICogMGwpKSA6IChpbnQgKik4KSkpICYmIChzaXplb2YoaW50KSA9PSBzaXplb2YoKig4
ID8gKCh2b2lkICopKChsb25nKShtbS0+dG90YWxfdm0pICogMGwpKSA6IChpbnQgKik4KSkp
KSksICgobW0tPmhpd2F0ZXJfdm0pID4gKG1tLT50b3RhbF92bSkgPyAobW0tPmhpd2F0ZXJf
dm0pIDogKG1tLT50b3RhbF92bSkpLCAoeyB0eXBlb2YobW0tPmhpd2F0ZXJfdm0pIF9fVU5J
UVVFX0lEX19feDE3NSA9IChtbS0+aGl3YXRlcl92bSk7IHR5cGVvZihtbS0+dG90YWxfdm0p
IF9fVU5JUVVFX0lEX19feTE3NiA9IChtbS0+dG90YWxfdm0pOyAoKF9fVU5JUVVFX0lEX19f
eDE3NSkgPiAoX19VTklRVUVfSURfX195MTc2KSA/IChfX1VOSVFVRV9JRF9fX3gxNzUpIDog
KF9fVU5JUVVFX0lEX19feTE3NikpOyB9KSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHVwZGF0ZV9o
aXdhdGVyX3JzcyhzdHJ1Y3QgbW1fc3RydWN0ICptbSkKewogdW5zaWduZWQgbG9uZyBfcnNz
ID0gZ2V0X21tX3JzcyhtbSk7CgogaWYgKChtbSktPmhpd2F0ZXJfcnNzIDwgX3JzcykKICAo
bW0pLT5oaXdhdGVyX3JzcyA9IF9yc3M7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHVwZGF0ZV9oaXdh
dGVyX3ZtKHN0cnVjdCBtbV9zdHJ1Y3QgKm1tKQp7CiBpZiAobW0tPmhpd2F0ZXJfdm0gPCBt
bS0+dG90YWxfdm0pCiAgbW0tPmhpd2F0ZXJfdm0gPSBtbS0+dG90YWxfdm07Cn0KCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSB2b2lkIHJlc2V0X21tX2hpd2F0ZXJfcnNzKHN0cnVjdCBtbV9zdHJ1Y3QgKm1tKQp7
CiBtbS0+aGl3YXRlcl9yc3MgPSBnZXRfbW1fcnNzKG1tKTsKfQoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQg
c2V0bWF4X21tX2hpd2F0ZXJfcnNzKHVuc2lnbmVkIGxvbmcgKm1heHJzcywKICAgICAgc3Ry
dWN0IG1tX3N0cnVjdCAqbW0pCnsKIHVuc2lnbmVkIGxvbmcgaGl3YXRlcl9yc3MgPSBnZXRf
bW1faGl3YXRlcl9yc3MobW0pOwoKIGlmICgqbWF4cnNzIDwgaGl3YXRlcl9yc3MpCiAgKm1h
eHJzcyA9IGhpd2F0ZXJfcnNzOwp9CgoKdm9pZCBzeW5jX21tX3JzcyhzdHJ1Y3QgbW1fc3Ry
dWN0ICptbSk7CiMgMTk2MiAiLi9pbmNsdWRlL2xpbnV4L21tLmgiCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQg
cHRlX2Rldm1hcChwdGVfdCBwdGUpCnsKIHJldHVybiAwOwp9CgoKaW50IHZtYV93YW50c193
cml0ZW5vdGlmeShzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnZtYSwgcGdwcm90X3Qgdm1fcGFn
ZV9wcm90KTsKCmV4dGVybiBwdGVfdCAqX19nZXRfbG9ja2VkX3B0ZShzdHJ1Y3QgbW1fc3Ry
dWN0ICptbSwgdW5zaWduZWQgbG9uZyBhZGRyLAogICAgICAgICAgc3BpbmxvY2tfdCAqKnB0
bCk7CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSBwdGVfdCAqZ2V0X2xvY2tlZF9wdGUoc3RydWN0IG1tX3N0cnVjdCAq
bW0sIHVuc2lnbmVkIGxvbmcgYWRkciwKICAgICAgICBzcGlubG9ja190ICoqcHRsKQp7CiBw
dGVfdCAqcHRlcDsKIChwdGVwID0gX19nZXRfbG9ja2VkX3B0ZShtbSwgYWRkciwgcHRsKSk7
CiByZXR1cm4gcHRlcDsKfQoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgX19wNGRfYWxsb2Moc3RydWN0IG1t
X3N0cnVjdCAqbW0sIHBnZF90ICpwZ2QsCiAgICAgIHVuc2lnbmVkIGxvbmcgYWRkcmVzcykK
ewogcmV0dXJuIDA7Cn0KIyAyMDAwICIuL2luY2x1ZGUvbGludXgvbW0uaCIKaW50IF9fcHVk
X2FsbG9jKHN0cnVjdCBtbV9zdHJ1Y3QgKm1tLCBwNGRfdCAqcDRkLCB1bnNpZ25lZCBsb25n
IGFkZHJlc3MpOwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgbW1faW5jX25yX3B1ZHMoc3RydWN0IG1tX3N0
cnVjdCAqbW0pCnsKIGlmICgwKQogIHJldHVybjsKIGF0b21pY19sb25nX2FkZCgoMSA8PCA5
KSAqIHNpemVvZihwdWRfdCksICZtbS0+cGd0YWJsZXNfYnl0ZXMpOwp9CgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
dm9pZCBtbV9kZWNfbnJfcHVkcyhzdHJ1Y3QgbW1fc3RydWN0ICptbSkKewogaWYgKDApCiAg
cmV0dXJuOwogYXRvbWljX2xvbmdfc3ViKCgxIDw8IDkpICogc2l6ZW9mKHB1ZF90KSwgJm1t
LT5wZ3RhYmxlc19ieXRlcyk7Cn0KIyAyMDI4ICIuL2luY2x1ZGUvbGludXgvbW0uaCIKaW50
IF9fcG1kX2FsbG9jKHN0cnVjdCBtbV9zdHJ1Y3QgKm1tLCBwdWRfdCAqcHVkLCB1bnNpZ25l
ZCBsb25nIGFkZHJlc3MpOwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgbW1faW5jX25yX3BtZHMoc3RydWN0
IG1tX3N0cnVjdCAqbW0pCnsKIGlmICgwKQogIHJldHVybjsKIGF0b21pY19sb25nX2FkZCgo
MSA8PCA3KSAqIHNpemVvZihwbWRfdCksICZtbS0+cGd0YWJsZXNfYnl0ZXMpOwp9CgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgdm9pZCBtbV9kZWNfbnJfcG1kcyhzdHJ1Y3QgbW1fc3RydWN0ICptbSkKewogaWYg
KDApCiAgcmV0dXJuOwogYXRvbWljX2xvbmdfc3ViKCgxIDw8IDcpICogc2l6ZW9mKHBtZF90
KSwgJm1tLT5wZ3RhYmxlc19ieXRlcyk7Cn0KCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgbW1fcGd0YWJs
ZXNfYnl0ZXNfaW5pdChzdHJ1Y3QgbW1fc3RydWN0ICptbSkKewogYXRvbWljX2xvbmdfc2V0
KCZtbS0+cGd0YWJsZXNfYnl0ZXMsIDApOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgbG9uZyBt
bV9wZ3RhYmxlc19ieXRlcyhjb25zdCBzdHJ1Y3QgbW1fc3RydWN0ICptbSkKewogcmV0dXJu
IGF0b21pY19sb25nX3JlYWQoJm1tLT5wZ3RhYmxlc19ieXRlcyk7Cn0KCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2
b2lkIG1tX2luY19ucl9wdGVzKHN0cnVjdCBtbV9zdHJ1Y3QgKm1tKQp7CiBhdG9taWNfbG9u
Z19hZGQoKDEgPDwgOSkgKiBzaXplb2YocHRlX3QpLCAmbW0tPnBndGFibGVzX2J5dGVzKTsK
fQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIHZvaWQgbW1fZGVjX25yX3B0ZXMoc3RydWN0IG1tX3N0cnVjdCAqbW0p
CnsKIGF0b21pY19sb25nX3N1YigoMSA8PCA5KSAqIHNpemVvZihwdGVfdCksICZtbS0+cGd0
YWJsZXNfYnl0ZXMpOwp9CiMgMjA3NyAiLi9pbmNsdWRlL2xpbnV4L21tLmgiCmludCBfX3B0
ZV9hbGxvYyhzdHJ1Y3QgbW1fc3RydWN0ICptbSwgcG1kX3QgKnBtZCk7CmludCBfX3B0ZV9h
bGxvY19rZXJuZWwocG1kX3QgKnBtZCk7CgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBwNGRfdCAqcDRkX2FsbG9j
KHN0cnVjdCBtbV9zdHJ1Y3QgKm1tLCBwZ2RfdCAqcGdkLAogIHVuc2lnbmVkIGxvbmcgYWRk
cmVzcykKewogcmV0dXJuIChfX2J1aWx0aW5fZXhwZWN0KCEhKHBnZF9ub25lKCpwZ2QpKSwg
MCkgJiYgX19wNGRfYWxsb2MobW0sIHBnZCwgYWRkcmVzcykpID8KICAoKHZvaWQgKikwKSA6
IHA0ZF9vZmZzZXQocGdkLCBhZGRyZXNzKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHB1ZF90ICpwdWRfYWxs
b2Moc3RydWN0IG1tX3N0cnVjdCAqbW0sIHA0ZF90ICpwNGQsCiAgdW5zaWduZWQgbG9uZyBh
ZGRyZXNzKQp7CiByZXR1cm4gKF9fYnVpbHRpbl9leHBlY3QoISEoKCEocGdkX3ZhbCgoKnA0
ZCkucGdkKSkpKSwgMCkgJiYgX19wdWRfYWxsb2MobW0sIHA0ZCwgYWRkcmVzcykpID8KICAo
KHZvaWQgKikwKSA6IHB1ZF9vZmZzZXQocDRkLCBhZGRyZXNzKTsKfQoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHA0
ZF90ICpwNGRfYWxsb2NfdHJhY2soc3RydWN0IG1tX3N0cnVjdCAqbW0sIHBnZF90ICpwZ2Qs
CiAgICAgICAgIHVuc2lnbmVkIGxvbmcgYWRkcmVzcywKICAgICAgICAgcGd0YmxfbW9kX21h
c2sgKm1vZF9tYXNrKQoKewogaWYgKF9fYnVpbHRpbl9leHBlY3QoISEocGdkX25vbmUoKnBn
ZCkpLCAwKSkgewogIGlmIChfX3A0ZF9hbGxvYyhtbSwgcGdkLCBhZGRyZXNzKSkKICAgcmV0
dXJuICgodm9pZCAqKTApOwogICptb2RfbWFzayB8PSAoKCgoMVVMKSkpIDw8ICgwKSk7CiB9
CgogcmV0dXJuIHA0ZF9vZmZzZXQocGdkLCBhZGRyZXNzKTsKfQoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHB1ZF90
ICpwdWRfYWxsb2NfdHJhY2soc3RydWN0IG1tX3N0cnVjdCAqbW0sIHA0ZF90ICpwNGQsCiAg
ICAgICAgIHVuc2lnbmVkIGxvbmcgYWRkcmVzcywKICAgICAgICAgcGd0YmxfbW9kX21hc2sg
Km1vZF9tYXNrKQp7CiBpZiAoX19idWlsdGluX2V4cGVjdCghISgoIShwZ2RfdmFsKCgqcDRk
KS5wZ2QpKSkpLCAwKSkgewogIGlmIChfX3B1ZF9hbGxvYyhtbSwgcDRkLCBhZGRyZXNzKSkK
ICAgcmV0dXJuICgodm9pZCAqKTApOwogICptb2RfbWFzayB8PSAoKCgoMVVMKSkpIDw8ICgx
KSk7CiB9CgogcmV0dXJuIHB1ZF9vZmZzZXQocDRkLCBhZGRyZXNzKTsKfQoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IHBtZF90ICpwbWRfYWxsb2Moc3RydWN0IG1tX3N0cnVjdCAqbW0sIHB1ZF90ICpwdWQsIHVu
c2lnbmVkIGxvbmcgYWRkcmVzcykKewogcmV0dXJuIChfX2J1aWx0aW5fZXhwZWN0KCEhKCgh
cHVkX3ZhbCgqcHVkKSkpLCAwKSAmJiBfX3BtZF9hbGxvYyhtbSwgcHVkLCBhZGRyZXNzKSk/
CiAgKCh2b2lkICopMCk6IHBtZF9vZmZzZXQocHVkLCBhZGRyZXNzKTsKfQoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IHBtZF90ICpwbWRfYWxsb2NfdHJhY2soc3RydWN0IG1tX3N0cnVjdCAqbW0sIHB1ZF90ICpw
dWQsCiAgICAgICAgIHVuc2lnbmVkIGxvbmcgYWRkcmVzcywKICAgICAgICAgcGd0YmxfbW9k
X21hc2sgKm1vZF9tYXNrKQp7CiBpZiAoX19idWlsdGluX2V4cGVjdCghISgoIXB1ZF92YWwo
KnB1ZCkpKSwgMCkpIHsKICBpZiAoX19wbWRfYWxsb2MobW0sIHB1ZCwgYWRkcmVzcykpCiAg
IHJldHVybiAoKHZvaWQgKikwKTsKICAqbW9kX21hc2sgfD0gKCgoKDFVTCkpKSA8PCAoMikp
OwogfQoKIHJldHVybiBwbWRfb2Zmc2V0KHB1ZCwgYWRkcmVzcyk7Cn0KIyAyMTU0ICIuL2lu
Y2x1ZGUvbGludXgvbW0uaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgcHRsb2NrX2NhY2hlX2luaXQodm9p
ZCkKewp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBwdGxvY2tfYWxsb2Moc3RydWN0IHBhZ2UgKnBhZ2Up
CnsKIHJldHVybiB0cnVlOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBwdGxvY2tfZnJlZShzdHJ1Y3Qg
cGFnZSAqcGFnZSkKewp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3BpbmxvY2tfdCAqcHRsb2NrX3B0cihzdHJ1
Y3QgcGFnZSAqcGFnZSkKewogcmV0dXJuICZwYWdlLT5wdGw7Cn0KCgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3Bp
bmxvY2tfdCAqcHRlX2xvY2twdHIoc3RydWN0IG1tX3N0cnVjdCAqbW0sIHBtZF90ICpwbWQp
CnsKIHJldHVybiBwdGxvY2tfcHRyKHBtZF9wYWdlKCpwbWQpKTsKfQoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJv
b2wgcHRsb2NrX2luaXQoc3RydWN0IHBhZ2UgKnBhZ2UpCnsKCgoKCgoKCiAoKHZvaWQpKHNp
emVvZigoIGxvbmcpKCoodW5zaWduZWQgbG9uZyAqKSZwYWdlLT5wdGwpKSkpOwogaWYgKCFw
dGxvY2tfYWxsb2MocGFnZSkpCiAgcmV0dXJuIGZhbHNlOwogZG8geyBzcGlubG9ja19jaGVj
ayhwdGxvY2tfcHRyKHBhZ2UpKTsgKihwdGxvY2tfcHRyKHBhZ2UpKSA9IChzcGlubG9ja190
KSB7IHsgLnJsb2NrID0geyAucmF3X2xvY2sgPSB7IDAgfSwgfSB9IH07IH0gd2hpbGUgKDAp
OwogcmV0dXJuIHRydWU7Cn0KIyAyMjA3ICIuL2luY2x1ZGUvbGludXgvbW0uaCIKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIHZvaWQgcGd0YWJsZV9pbml0KHZvaWQpCnsKIHB0bG9ja19jYWNoZV9pbml0KCk7CiBw
Z3RhYmxlX2NhY2hlX2luaXQoKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgcGd0YWJsZV9wdGVfcGFn
ZV9jdG9yKHN0cnVjdCBwYWdlICpwYWdlKQp7CiBpZiAoIXB0bG9ja19pbml0KHBhZ2UpKQog
IHJldHVybiBmYWxzZTsKIF9fU2V0UGFnZVRhYmxlKHBhZ2UpOwogaW5jX3pvbmVfcGFnZV9z
dGF0ZShwYWdlLCBOUl9QQUdFVEFCTEUpOwogcmV0dXJuIHRydWU7Cn0KCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2
b2lkIHBndGFibGVfcHRlX3BhZ2VfZHRvcihzdHJ1Y3QgcGFnZSAqcGFnZSkKewogcHRsb2Nr
X2ZyZWUocGFnZSk7CiBfX0NsZWFyUGFnZVRhYmxlKHBhZ2UpOwogZGVjX3pvbmVfcGFnZV9z
dGF0ZShwYWdlLCBOUl9QQUdFVEFCTEUpOwp9CiMgMjI5NCAiLi9pbmNsdWRlL2xpbnV4L21t
LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSBzcGlubG9ja190ICpwbWRfbG9ja3B0cihzdHJ1Y3QgbW1fc3RydWN0
ICptbSwgcG1kX3QgKnBtZCkKewogcmV0dXJuICZtbS0+cGFnZV90YWJsZV9sb2NrOwp9Cgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgYm9vbCBwZ3RhYmxlX3BtZF9wYWdlX2N0b3Ioc3RydWN0IHBhZ2UgKnBhZ2Up
IHsgcmV0dXJuIHRydWU7IH0Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgcGd0YWJsZV9wbWRfcGFnZV9kdG9y
KHN0cnVjdCBwYWdlICpwYWdlKSB7fQoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzcGlubG9ja190ICpwbWRf
bG9jayhzdHJ1Y3QgbW1fc3RydWN0ICptbSwgcG1kX3QgKnBtZCkKewogc3BpbmxvY2tfdCAq
cHRsID0gcG1kX2xvY2twdHIobW0sIHBtZCk7CiBzcGluX2xvY2socHRsKTsKIHJldHVybiBw
dGw7Cn0KCgoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzcGlubG9ja190ICpwdWRfbG9ja3B0cihzdHJ1Y3Qg
bW1fc3RydWN0ICptbSwgcHVkX3QgKnB1ZCkKewogcmV0dXJuICZtbS0+cGFnZV90YWJsZV9s
b2NrOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgc3BpbmxvY2tfdCAqcHVkX2xvY2soc3RydWN0IG1tX3N0cnVj
dCAqbW0sIHB1ZF90ICpwdWQpCnsKIHNwaW5sb2NrX3QgKnB0bCA9IHB1ZF9sb2NrcHRyKG1t
LCBwdWQpOwoKIHNwaW5fbG9jayhwdGwpOwogcmV0dXJuIHB0bDsKfQoKZXh0ZXJuIHZvaWQg
X19hdHRyaWJ1dGVfXygoX19zZWN0aW9uX18oIi5pbml0LnRleHQiKSkpIF9fYXR0cmlidXRl
X18oKF9fY29sZF9fKSkgcGFnZWNhY2hlX2luaXQodm9pZCk7CmV4dGVybiB2b2lkIF9fYXR0
cmlidXRlX18oKF9fc2VjdGlvbl9fKCIuaW5pdC50ZXh0IikpKSBfX2F0dHJpYnV0ZV9fKChf
X2NvbGRfXykpIGZyZWVfYXJlYV9pbml0X21lbW9yeWxlc3Nfbm9kZShpbnQgbmlkKTsKZXh0
ZXJuIHZvaWQgZnJlZV9pbml0bWVtKHZvaWQpOwoKCgoKCgoKZXh0ZXJuIHVuc2lnbmVkIGxv
bmcgZnJlZV9yZXNlcnZlZF9hcmVhKHZvaWQgKnN0YXJ0LCB2b2lkICplbmQsCiAgICAgaW50
IHBvaXNvbiwgY29uc3QgY2hhciAqcyk7CiMgMjM1MyAiLi9pbmNsdWRlL2xpbnV4L21tLmgi
CmV4dGVybiB2b2lkIGFkanVzdF9tYW5hZ2VkX3BhZ2VfY291bnQoc3RydWN0IHBhZ2UgKnBh
Z2UsIGxvbmcgY291bnQpOwpleHRlcm4gdm9pZCBtZW1faW5pdF9wcmludF9pbmZvKGNvbnN0
IGNoYXIgKnN0cik7CgpleHRlcm4gdm9pZCByZXNlcnZlX2Jvb3RtZW1fcmVnaW9uKHBoeXNf
YWRkcl90IHN0YXJ0LCBwaHlzX2FkZHJfdCBlbmQpOwoKCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIF9fZnJl
ZV9yZXNlcnZlZF9wYWdlKHN0cnVjdCBwYWdlICpwYWdlKQp7CiBDbGVhclBhZ2VSZXNlcnZl
ZChwYWdlKTsKIGluaXRfcGFnZV9jb3VudChwYWdlKTsKIF9fZnJlZV9wYWdlcygocGFnZSks
IDApOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBmcmVlX3Jlc2VydmVkX3BhZ2Uoc3RydWN0IHBhZ2Ug
KnBhZ2UpCnsKIF9fZnJlZV9yZXNlcnZlZF9wYWdlKHBhZ2UpOwogYWRqdXN0X21hbmFnZWRf
cGFnZV9jb3VudChwYWdlLCAxKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgbWFya19wYWdlX3Jlc2Vy
dmVkKHN0cnVjdCBwYWdlICpwYWdlKQp7CiBTZXRQYWdlUmVzZXJ2ZWQocGFnZSk7CiBhZGp1
c3RfbWFuYWdlZF9wYWdlX2NvdW50KHBhZ2UsIC0xKTsKfQoKCgoKCgoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHVu
c2lnbmVkIGxvbmcgZnJlZV9pbml0bWVtX2RlZmF1bHQoaW50IHBvaXNvbikKewogZXh0ZXJu
IGNoYXIgX19pbml0X2JlZ2luW10sIF9faW5pdF9lbmRbXTsKCiByZXR1cm4gZnJlZV9yZXNl
cnZlZF9hcmVhKCZfX2luaXRfYmVnaW4sICZfX2luaXRfZW5kLAogICAgICBwb2lzb24sICJ1
bnVzZWQga2VybmVsIik7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1bnNpZ25lZCBsb25nIGdldF9udW1fcGh5
c3BhZ2VzKHZvaWQpCnsKIGludCBuaWQ7CiB1bnNpZ25lZCBsb25nIHBoeXNfcGFnZXMgPSAw
OwoKIGZvciAoIChuaWQpID0gMDsgKG5pZCkgPT0gMDsgKG5pZCkgPSAxKQogIHBoeXNfcGFn
ZXMgKz0gKCgmY29udGlnX3BhZ2VfZGF0YSktPm5vZGVfcHJlc2VudF9wYWdlcyk7CgogcmV0
dXJuIHBoeXNfcGFnZXM7Cn0KIyAyNDIyICIuL2luY2x1ZGUvbGludXgvbW0uaCIKdm9pZCBm
cmVlX2FyZWFfaW5pdCh1bnNpZ25lZCBsb25nICptYXhfem9uZV9wZm4pOwp1bnNpZ25lZCBs
b25nIG5vZGVfbWFwX3Bmbl9hbGlnbm1lbnQodm9pZCk7CnVuc2lnbmVkIGxvbmcgX19hYnNl
bnRfcGFnZXNfaW5fcmFuZ2UoaW50IG5pZCwgdW5zaWduZWQgbG9uZyBzdGFydF9wZm4sCiAg
ICAgIHVuc2lnbmVkIGxvbmcgZW5kX3Bmbik7CmV4dGVybiB1bnNpZ25lZCBsb25nIGFic2Vu
dF9wYWdlc19pbl9yYW5nZSh1bnNpZ25lZCBsb25nIHN0YXJ0X3BmbiwKICAgICAgdW5zaWdu
ZWQgbG9uZyBlbmRfcGZuKTsKZXh0ZXJuIHZvaWQgZ2V0X3Bmbl9yYW5nZV9mb3JfbmlkKHVu
c2lnbmVkIGludCBuaWQsCiAgIHVuc2lnbmVkIGxvbmcgKnN0YXJ0X3BmbiwgdW5zaWduZWQg
bG9uZyAqZW5kX3Bmbik7CmV4dGVybiB1bnNpZ25lZCBsb25nIGZpbmRfbWluX3Bmbl93aXRo
X2FjdGl2ZV9yZWdpb25zKHZvaWQpOwpleHRlcm4gdm9pZCBzcGFyc2VfbWVtb3J5X3ByZXNl
bnRfd2l0aF9hY3RpdmVfcmVnaW9ucyhpbnQgbmlkKTsKCgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGVhcmx5
X3Bmbl90b19uaWQodW5zaWduZWQgbG9uZyBwZm4pCnsKIHJldHVybiAwOwp9CiMgMjQ0NiAi
Li9pbmNsdWRlL2xpbnV4L21tLmgiCmV4dGVybiB2b2lkIHNldF9kbWFfcmVzZXJ2ZSh1bnNp
Z25lZCBsb25nIG5ld19kbWFfcmVzZXJ2ZSk7CmV4dGVybiB2b2lkIG1lbW1hcF9pbml0X3pv
bmUodW5zaWduZWQgbG9uZywgaW50LCB1bnNpZ25lZCBsb25nLCB1bnNpZ25lZCBsb25nLAog
IGVudW0gbWVtbWFwX2NvbnRleHQsIHN0cnVjdCB2bWVtX2FsdG1hcCAqKTsKZXh0ZXJuIHZv
aWQgc2V0dXBfcGVyX3pvbmVfd21hcmtzKHZvaWQpOwpleHRlcm4gaW50IF9fYXR0cmlidXRl
X18oKF9fc2VjdGlvbl9fKCIubWVtaW5pdC50ZXh0IikpKSBfX2F0dHJpYnV0ZV9fKChfX2Nv
bGRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW5p
dF9wZXJfem9uZV93bWFya19taW4odm9pZCk7CmV4dGVybiB2b2lkIG1lbV9pbml0KHZvaWQp
OwpleHRlcm4gdm9pZCBfX2F0dHJpYnV0ZV9fKChfX3NlY3Rpb25fXygiLmluaXQudGV4dCIp
KSkgX19hdHRyaWJ1dGVfXygoX19jb2xkX18pKSBtbWFwX2luaXQodm9pZCk7CmV4dGVybiB2
b2lkIHNob3dfbWVtKHVuc2lnbmVkIGludCBmbGFncywgbm9kZW1hc2tfdCAqbm9kZW1hc2sp
OwpleHRlcm4gbG9uZyBzaV9tZW1fYXZhaWxhYmxlKHZvaWQpOwpleHRlcm4gdm9pZCBzaV9t
ZW1pbmZvKHN0cnVjdCBzeXNpbmZvICogdmFsKTsKZXh0ZXJuIHZvaWQgc2lfbWVtaW5mb19u
b2RlKHN0cnVjdCBzeXNpbmZvICp2YWwsIGludCBuaWQpOwoKCgoKZXh0ZXJuIF9fYXR0cmli
dXRlX18oKF9fZm9ybWF0X18ocHJpbnRmLCAzLCA0KSkpCnZvaWQgd2Fybl9hbGxvYyhnZnBf
dCBnZnBfbWFzaywgbm9kZW1hc2tfdCAqbm9kZW1hc2ssIGNvbnN0IGNoYXIgKmZtdCwgLi4u
KTsKCmV4dGVybiB2b2lkIHNldHVwX3Blcl9jcHVfcGFnZXNldCh2b2lkKTsKCgpleHRlcm4g
aW50IG1pbl9mcmVlX2tieXRlczsKZXh0ZXJuIGludCB3YXRlcm1hcmtfYm9vc3RfZmFjdG9y
OwpleHRlcm4gaW50IHdhdGVybWFya19zY2FsZV9mYWN0b3I7CmV4dGVybiBib29sIGFyY2hf
aGFzX2Rlc2NlbmRpbmdfbWF4X3pvbmVfcGZucyh2b2lkKTsKCgpleHRlcm4gYXRvbWljX2xv
bmdfdCBtbWFwX3BhZ2VzX2FsbG9jYXRlZDsKZXh0ZXJuIGludCBub21tdV9zaHJpbmtfaW5v
ZGVfbWFwcGluZ3Moc3RydWN0IGlub2RlICosIHNpemVfdCwgc2l6ZV90KTsKCgp2b2lkIHZt
YV9pbnRlcnZhbF90cmVlX2luc2VydChzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKm5vZGUsCiAg
ICAgICAgIHN0cnVjdCByYl9yb290X2NhY2hlZCAqcm9vdCk7CnZvaWQgdm1hX2ludGVydmFs
X3RyZWVfaW5zZXJ0X2FmdGVyKHN0cnVjdCB2bV9hcmVhX3N0cnVjdCAqbm9kZSwKICAgICAg
ICBzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnByZXYsCiAgICAgICAgc3RydWN0IHJiX3Jvb3Rf
Y2FjaGVkICpyb290KTsKdm9pZCB2bWFfaW50ZXJ2YWxfdHJlZV9yZW1vdmUoc3RydWN0IHZt
X2FyZWFfc3RydWN0ICpub2RlLAogICAgICAgICBzdHJ1Y3QgcmJfcm9vdF9jYWNoZWQgKnJv
b3QpOwpzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnZtYV9pbnRlcnZhbF90cmVlX2l0ZXJfZmly
c3Qoc3RydWN0IHJiX3Jvb3RfY2FjaGVkICpyb290LAogICAgdW5zaWduZWQgbG9uZyBzdGFy
dCwgdW5zaWduZWQgbG9uZyBsYXN0KTsKc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWFfaW50
ZXJ2YWxfdHJlZV9pdGVyX25leHQoc3RydWN0IHZtX2FyZWFfc3RydWN0ICpub2RlLAogICAg
dW5zaWduZWQgbG9uZyBzdGFydCwgdW5zaWduZWQgbG9uZyBsYXN0KTsKCgoKCgp2b2lkIGFu
b25fdm1hX2ludGVydmFsX3RyZWVfaW5zZXJ0KHN0cnVjdCBhbm9uX3ZtYV9jaGFpbiAqbm9k
ZSwKICAgICAgIHN0cnVjdCByYl9yb290X2NhY2hlZCAqcm9vdCk7CnZvaWQgYW5vbl92bWFf
aW50ZXJ2YWxfdHJlZV9yZW1vdmUoc3RydWN0IGFub25fdm1hX2NoYWluICpub2RlLAogICAg
ICAgc3RydWN0IHJiX3Jvb3RfY2FjaGVkICpyb290KTsKc3RydWN0IGFub25fdm1hX2NoYWlu
ICoKYW5vbl92bWFfaW50ZXJ2YWxfdHJlZV9pdGVyX2ZpcnN0KHN0cnVjdCByYl9yb290X2Nh
Y2hlZCAqcm9vdCwKICAgICAgdW5zaWduZWQgbG9uZyBzdGFydCwgdW5zaWduZWQgbG9uZyBs
YXN0KTsKc3RydWN0IGFub25fdm1hX2NoYWluICphbm9uX3ZtYV9pbnRlcnZhbF90cmVlX2l0
ZXJfbmV4dCgKIHN0cnVjdCBhbm9uX3ZtYV9jaGFpbiAqbm9kZSwgdW5zaWduZWQgbG9uZyBz
dGFydCwgdW5zaWduZWQgbG9uZyBsYXN0KTsKIyAyNTExICIuL2luY2x1ZGUvbGludXgvbW0u
aCIKZXh0ZXJuIGludCBfX3ZtX2Vub3VnaF9tZW1vcnkoc3RydWN0IG1tX3N0cnVjdCAqbW0s
IGxvbmcgcGFnZXMsIGludCBjYXBfc3lzX2FkbWluKTsKZXh0ZXJuIGludCBfX3ZtYV9hZGp1
c3Qoc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEsIHVuc2lnbmVkIGxvbmcgc3RhcnQsCiB1
bnNpZ25lZCBsb25nIGVuZCwgdW5zaWduZWQgbG9uZyBwZ29mZiwgc3RydWN0IHZtX2FyZWFf
c3RydWN0ICppbnNlcnQsCiBzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKmV4cGFuZCk7CnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBpbnQgdm1hX2FkanVzdChzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnZtYSwgdW5zaWdu
ZWQgbG9uZyBzdGFydCwKIHVuc2lnbmVkIGxvbmcgZW5kLCB1bnNpZ25lZCBsb25nIHBnb2Zm
LCBzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKmluc2VydCkKewogcmV0dXJuIF9fdm1hX2FkanVz
dCh2bWEsIHN0YXJ0LCBlbmQsIHBnb2ZmLCBpbnNlcnQsICgodm9pZCAqKTApKTsKfQpleHRl
cm4gc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWFfbWVyZ2Uoc3RydWN0IG1tX3N0cnVjdCAq
LAogc3RydWN0IHZtX2FyZWFfc3RydWN0ICpwcmV2LCB1bnNpZ25lZCBsb25nIGFkZHIsIHVu
c2lnbmVkIGxvbmcgZW5kLAogdW5zaWduZWQgbG9uZyB2bV9mbGFncywgc3RydWN0IGFub25f
dm1hICosIHN0cnVjdCBmaWxlICosIHVuc2lnbmVkIGxvbmcsCiBzdHJ1Y3QgbWVtcG9saWN5
ICosIHN0cnVjdCB2bV91c2VyZmF1bHRmZF9jdHgpOwpleHRlcm4gc3RydWN0IGFub25fdm1h
ICpmaW5kX21lcmdlYWJsZV9hbm9uX3ZtYShzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKik7CmV4
dGVybiBpbnQgX19zcGxpdF92bWEoc3RydWN0IG1tX3N0cnVjdCAqLCBzdHJ1Y3Qgdm1fYXJl
YV9zdHJ1Y3QgKiwKIHVuc2lnbmVkIGxvbmcgYWRkciwgaW50IG5ld19iZWxvdyk7CmV4dGVy
biBpbnQgc3BsaXRfdm1hKHN0cnVjdCBtbV9zdHJ1Y3QgKiwgc3RydWN0IHZtX2FyZWFfc3Ry
dWN0ICosCiB1bnNpZ25lZCBsb25nIGFkZHIsIGludCBuZXdfYmVsb3cpOwpleHRlcm4gaW50
IGluc2VydF92bV9zdHJ1Y3Qoc3RydWN0IG1tX3N0cnVjdCAqLCBzdHJ1Y3Qgdm1fYXJlYV9z
dHJ1Y3QgKik7CmV4dGVybiB2b2lkIF9fdm1hX2xpbmtfcmIoc3RydWN0IG1tX3N0cnVjdCAq
LCBzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKiwKIHN0cnVjdCByYl9ub2RlICoqLCBzdHJ1Y3Qg
cmJfbm9kZSAqKTsKZXh0ZXJuIHZvaWQgdW5saW5rX2ZpbGVfdm1hKHN0cnVjdCB2bV9hcmVh
X3N0cnVjdCAqKTsKZXh0ZXJuIHN0cnVjdCB2bV9hcmVhX3N0cnVjdCAqY29weV92bWEoc3Ry
dWN0IHZtX2FyZWFfc3RydWN0ICoqLAogdW5zaWduZWQgbG9uZyBhZGRyLCB1bnNpZ25lZCBs
b25nIGxlbiwgdW5zaWduZWQgbG9uZyBwZ29mZiwKIGJvb2wgKm5lZWRfcm1hcF9sb2Nrcyk7
CmV4dGVybiB2b2lkIGV4aXRfbW1hcChzdHJ1Y3QgbW1fc3RydWN0ICopOwoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IGludCBjaGVja19kYXRhX3JsaW1pdCh1bnNpZ25lZCBsb25nIHJsaW0sCiAgICAgICAgdW5z
aWduZWQgbG9uZyBuZXcsCiAgICAgICAgdW5zaWduZWQgbG9uZyBzdGFydCwKICAgICAgICB1
bnNpZ25lZCBsb25nIGVuZF9kYXRhLAogICAgICAgIHVuc2lnbmVkIGxvbmcgc3RhcnRfZGF0
YSkKewogaWYgKHJsaW0gPCAofjBVTCkpIHsKICBpZiAoKChuZXcgLSBzdGFydCkgKyAoZW5k
X2RhdGEgLSBzdGFydF9kYXRhKSkgPiBybGltKQogICByZXR1cm4gLTI4OwogfQoKIHJldHVy
biAwOwp9CgpleHRlcm4gaW50IG1tX3Rha2VfYWxsX2xvY2tzKHN0cnVjdCBtbV9zdHJ1Y3Qg
Km1tKTsKZXh0ZXJuIHZvaWQgbW1fZHJvcF9hbGxfbG9ja3Moc3RydWN0IG1tX3N0cnVjdCAq
bW0pOwoKZXh0ZXJuIHZvaWQgc2V0X21tX2V4ZV9maWxlKHN0cnVjdCBtbV9zdHJ1Y3QgKm1t
LCBzdHJ1Y3QgZmlsZSAqbmV3X2V4ZV9maWxlKTsKZXh0ZXJuIHN0cnVjdCBmaWxlICpnZXRf
bW1fZXhlX2ZpbGUoc3RydWN0IG1tX3N0cnVjdCAqbW0pOwpleHRlcm4gc3RydWN0IGZpbGUg
KmdldF90YXNrX2V4ZV9maWxlKHN0cnVjdCB0YXNrX3N0cnVjdCAqdGFzayk7CgpleHRlcm4g
Ym9vbCBtYXlfZXhwYW5kX3ZtKHN0cnVjdCBtbV9zdHJ1Y3QgKiwgdm1fZmxhZ3NfdCwgdW5z
aWduZWQgbG9uZyBucGFnZXMpOwpleHRlcm4gdm9pZCB2bV9zdGF0X2FjY291bnQoc3RydWN0
IG1tX3N0cnVjdCAqLCB2bV9mbGFnc190LCBsb25nIG5wYWdlcyk7CgpleHRlcm4gYm9vbCB2
bWFfaXNfc3BlY2lhbF9tYXBwaW5nKGNvbnN0IHN0cnVjdCB2bV9hcmVhX3N0cnVjdCAqdm1h
LAogICAgICAgY29uc3Qgc3RydWN0IHZtX3NwZWNpYWxfbWFwcGluZyAqc20pOwpleHRlcm4g
c3RydWN0IHZtX2FyZWFfc3RydWN0ICpfaW5zdGFsbF9zcGVjaWFsX21hcHBpbmcoc3RydWN0
IG1tX3N0cnVjdCAqbW0sCiAgICAgICB1bnNpZ25lZCBsb25nIGFkZHIsIHVuc2lnbmVkIGxv
bmcgbGVuLAogICAgICAgdW5zaWduZWQgbG9uZyBmbGFncywKICAgICAgIGNvbnN0IHN0cnVj
dCB2bV9zcGVjaWFsX21hcHBpbmcgKnNwZWMpOwoKZXh0ZXJuIGludCBpbnN0YWxsX3NwZWNp
YWxfbWFwcGluZyhzdHJ1Y3QgbW1fc3RydWN0ICptbSwKICAgICAgIHVuc2lnbmVkIGxvbmcg
YWRkciwgdW5zaWduZWQgbG9uZyBsZW4sCiAgICAgICB1bnNpZ25lZCBsb25nIGZsYWdzLCBz
dHJ1Y3QgcGFnZSAqKnBhZ2VzKTsKCnVuc2lnbmVkIGxvbmcgcmFuZG9taXplX3N0YWNrX3Rv
cCh1bnNpZ25lZCBsb25nIHN0YWNrX3RvcCk7CgpleHRlcm4gdW5zaWduZWQgbG9uZyBnZXRf
dW5tYXBwZWRfYXJlYShzdHJ1Y3QgZmlsZSAqLCB1bnNpZ25lZCBsb25nLCB1bnNpZ25lZCBs
b25nLCB1bnNpZ25lZCBsb25nLCB1bnNpZ25lZCBsb25nKTsKCmV4dGVybiB1bnNpZ25lZCBs
b25nIG1tYXBfcmVnaW9uKHN0cnVjdCBmaWxlICpmaWxlLCB1bnNpZ25lZCBsb25nIGFkZHIs
CiB1bnNpZ25lZCBsb25nIGxlbiwgdm1fZmxhZ3NfdCB2bV9mbGFncywgdW5zaWduZWQgbG9u
ZyBwZ29mZiwKIHN0cnVjdCBsaXN0X2hlYWQgKnVmKTsKZXh0ZXJuIHVuc2lnbmVkIGxvbmcg
ZG9fbW1hcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdW5zaWduZWQgbG9uZyBhZGRyLAogdW5zaWdu
ZWQgbG9uZyBsZW4sIHVuc2lnbmVkIGxvbmcgcHJvdCwgdW5zaWduZWQgbG9uZyBmbGFncywK
IHZtX2ZsYWdzX3Qgdm1fZmxhZ3MsIHVuc2lnbmVkIGxvbmcgcGdvZmYsIHVuc2lnbmVkIGxv
bmcgKnBvcHVsYXRlLAogc3RydWN0IGxpc3RfaGVhZCAqdWYpOwpleHRlcm4gaW50IF9fZG9f
bXVubWFwKHN0cnVjdCBtbV9zdHJ1Y3QgKiwgdW5zaWduZWQgbG9uZywgc2l6ZV90LAogICAg
ICAgICBzdHJ1Y3QgbGlzdF9oZWFkICp1ZiwgYm9vbCBkb3duZ3JhZGUpOwpleHRlcm4gaW50
IGRvX211bm1hcChzdHJ1Y3QgbW1fc3RydWN0ICosIHVuc2lnbmVkIGxvbmcsIHNpemVfdCwK
ICAgICAgIHN0cnVjdCBsaXN0X2hlYWQgKnVmKTsKZXh0ZXJuIGludCBkb19tYWR2aXNlKHVu
c2lnbmVkIGxvbmcgc3RhcnQsIHNpemVfdCBsZW5faW4sIGludCBiZWhhdmlvcik7CgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgdW5zaWduZWQgbG9uZwpkb19tbWFwX3Bnb2ZmKHN0cnVjdCBmaWxlICpmaWxlLCB1
bnNpZ25lZCBsb25nIGFkZHIsCiB1bnNpZ25lZCBsb25nIGxlbiwgdW5zaWduZWQgbG9uZyBw
cm90LCB1bnNpZ25lZCBsb25nIGZsYWdzLAogdW5zaWduZWQgbG9uZyBwZ29mZiwgdW5zaWdu
ZWQgbG9uZyAqcG9wdWxhdGUsCiBzdHJ1Y3QgbGlzdF9oZWFkICp1ZikKewogcmV0dXJuIGRv
X21tYXAoZmlsZSwgYWRkciwgbGVuLCBwcm90LCBmbGFncywgMCwgcGdvZmYsIHBvcHVsYXRl
LCB1Zik7Cn0KCgpleHRlcm4gaW50IF9fbW1fcG9wdWxhdGUodW5zaWduZWQgbG9uZyBhZGRy
LCB1bnNpZ25lZCBsb25nIGxlbiwKICAgIGludCBpZ25vcmVfZXJyb3JzKTsKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IHZvaWQgbW1fcG9wdWxhdGUodW5zaWduZWQgbG9uZyBhZGRyLCB1bnNpZ25lZCBsb25nIGxl
bikKewoKICh2b2lkKSBfX21tX3BvcHVsYXRlKGFkZHIsIGxlbiwgMSk7Cn0KCgoKCgpleHRl
cm4gaW50IF9fYXR0cmlidXRlX18oKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKSB2bV9icmso
dW5zaWduZWQgbG9uZywgdW5zaWduZWQgbG9uZyk7CmV4dGVybiBpbnQgX19hdHRyaWJ1dGVf
XygoX193YXJuX3VudXNlZF9yZXN1bHRfXykpIHZtX2Jya19mbGFncyh1bnNpZ25lZCBsb25n
LCB1bnNpZ25lZCBsb25nLCB1bnNpZ25lZCBsb25nKTsKZXh0ZXJuIGludCB2bV9tdW5tYXAo
dW5zaWduZWQgbG9uZywgc2l6ZV90KTsKZXh0ZXJuIHVuc2lnbmVkIGxvbmcgX19hdHRyaWJ1
dGVfXygoX193YXJuX3VudXNlZF9yZXN1bHRfXykpIHZtX21tYXAoc3RydWN0IGZpbGUgKiwg
dW5zaWduZWQgbG9uZywKICAgICAgICB1bnNpZ25lZCBsb25nLCB1bnNpZ25lZCBsb25nLAog
ICAgICAgIHVuc2lnbmVkIGxvbmcsIHVuc2lnbmVkIGxvbmcpOwoKc3RydWN0IHZtX3VubWFw
cGVkX2FyZWFfaW5mbyB7CgogdW5zaWduZWQgbG9uZyBmbGFnczsKIHVuc2lnbmVkIGxvbmcg
bGVuZ3RoOwogdW5zaWduZWQgbG9uZyBsb3dfbGltaXQ7CiB1bnNpZ25lZCBsb25nIGhpZ2hf
bGltaXQ7CiB1bnNpZ25lZCBsb25nIGFsaWduX21hc2s7CiB1bnNpZ25lZCBsb25nIGFsaWdu
X29mZnNldDsKfTsKCmV4dGVybiB1bnNpZ25lZCBsb25nIHZtX3VubWFwcGVkX2FyZWEoc3Ry
dWN0IHZtX3VubWFwcGVkX2FyZWFfaW5mbyAqaW5mbyk7CgoKZXh0ZXJuIHZvaWQgdHJ1bmNh
dGVfaW5vZGVfcGFnZXMoc3RydWN0IGFkZHJlc3Nfc3BhY2UgKiwgbG9mZl90KTsKZXh0ZXJu
IHZvaWQgdHJ1bmNhdGVfaW5vZGVfcGFnZXNfcmFuZ2Uoc3RydWN0IGFkZHJlc3Nfc3BhY2Ug
KiwKICAgICAgICAgICBsb2ZmX3QgbHN0YXJ0LCBsb2ZmX3QgbGVuZCk7CmV4dGVybiB2b2lk
IHRydW5jYXRlX2lub2RlX3BhZ2VzX2ZpbmFsKHN0cnVjdCBhZGRyZXNzX3NwYWNlICopOwoK
CmV4dGVybiB2bV9mYXVsdF90IGZpbGVtYXBfZmF1bHQoc3RydWN0IHZtX2ZhdWx0ICp2bWYp
OwpleHRlcm4gdm9pZCBmaWxlbWFwX21hcF9wYWdlcyhzdHJ1Y3Qgdm1fZmF1bHQgKnZtZiwK
ICB1bnNpZ25lZCBsb25nIHN0YXJ0X3Bnb2ZmLCB1bnNpZ25lZCBsb25nIGVuZF9wZ29mZik7
CmV4dGVybiB2bV9mYXVsdF90IGZpbGVtYXBfcGFnZV9ta3dyaXRlKHN0cnVjdCB2bV9mYXVs
dCAqdm1mKTsKCgppbnQgX19hdHRyaWJ1dGVfXygoX193YXJuX3VudXNlZF9yZXN1bHRfXykp
IHdyaXRlX29uZV9wYWdlKHN0cnVjdCBwYWdlICpwYWdlKTsKdm9pZCB0YXNrX2RpcnR5X2lu
YyhzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRzayk7CgpleHRlcm4gdW5zaWduZWQgbG9uZyBzdGFj
a19ndWFyZF9nYXA7CgpleHRlcm4gaW50IGV4cGFuZF9zdGFjayhzdHJ1Y3Qgdm1fYXJlYV9z
dHJ1Y3QgKnZtYSwgdW5zaWduZWQgbG9uZyBhZGRyZXNzKTsKCgpleHRlcm4gaW50IGV4cGFu
ZF9kb3dud2FyZHMoc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEsCiAgdW5zaWduZWQgbG9u
ZyBhZGRyZXNzKTsKCgoKCgoKCmV4dGVybiBzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKiBmaW5k
X3ZtYShzdHJ1Y3QgbW1fc3RydWN0ICogbW0sIHVuc2lnbmVkIGxvbmcgYWRkcik7CmV4dGVy
biBzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKiBmaW5kX3ZtYV9wcmV2KHN0cnVjdCBtbV9zdHJ1
Y3QgKiBtbSwgdW5zaWduZWQgbG9uZyBhZGRyLAogICAgICAgICAgc3RydWN0IHZtX2FyZWFf
c3RydWN0ICoqcHByZXYpOwoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IHZtX2FyZWFfc3RydWN0ICog
ZmluZF92bWFfaW50ZXJzZWN0aW9uKHN0cnVjdCBtbV9zdHJ1Y3QgKiBtbSwgdW5zaWduZWQg
bG9uZyBzdGFydF9hZGRyLCB1bnNpZ25lZCBsb25nIGVuZF9hZGRyKQp7CiBzdHJ1Y3Qgdm1f
YXJlYV9zdHJ1Y3QgKiB2bWEgPSBmaW5kX3ZtYShtbSxzdGFydF9hZGRyKTsKCiBpZiAodm1h
ICYmIGVuZF9hZGRyIDw9IHZtYS0+dm1fc3RhcnQpCiAgdm1hID0gKCh2b2lkICopMCk7CiBy
ZXR1cm4gdm1hOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgbG9uZyB2bV9zdGFydF9nYXAoc3Ry
dWN0IHZtX2FyZWFfc3RydWN0ICp2bWEpCnsKIHVuc2lnbmVkIGxvbmcgdm1fc3RhcnQgPSB2
bWEtPnZtX3N0YXJ0OwoKIGlmICh2bWEtPnZtX2ZsYWdzICYgMHgwMDAwMDEwMCkgewogIHZt
X3N0YXJ0IC09IHN0YWNrX2d1YXJkX2dhcDsKICBpZiAodm1fc3RhcnQgPiB2bWEtPnZtX3N0
YXJ0KQogICB2bV9zdGFydCA9IDA7CiB9CiByZXR1cm4gdm1fc3RhcnQ7Cn0KCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSB1bnNpZ25lZCBsb25nIHZtX2VuZF9nYXAoc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEp
CnsKIHVuc2lnbmVkIGxvbmcgdm1fZW5kID0gdm1hLT52bV9lbmQ7CgogaWYgKHZtYS0+dm1f
ZmxhZ3MgJiAweDAwMDAwMDAwKSB7CiAgdm1fZW5kICs9IHN0YWNrX2d1YXJkX2dhcDsKICBp
ZiAodm1fZW5kIDwgdm1hLT52bV9lbmQpCiAgIHZtX2VuZCA9IC0oMVVMIDw8IDEyKTsKIH0K
IHJldHVybiB2bV9lbmQ7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1bnNpZ25lZCBsb25nIHZtYV9wYWdlcyhz
dHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnZtYSkKewogcmV0dXJuICh2bWEtPnZtX2VuZCAtIHZt
YS0+dm1fc3RhcnQpID4+IDEyOwp9CgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHN0cnVjdCB2bV9hcmVhX3N0cnVj
dCAqZmluZF9leGFjdF92bWEoc3RydWN0IG1tX3N0cnVjdCAqbW0sCiAgICB1bnNpZ25lZCBs
b25nIHZtX3N0YXJ0LCB1bnNpZ25lZCBsb25nIHZtX2VuZCkKewogc3RydWN0IHZtX2FyZWFf
c3RydWN0ICp2bWEgPSBmaW5kX3ZtYShtbSwgdm1fc3RhcnQpOwoKIGlmICh2bWEgJiYgKHZt
YS0+dm1fc3RhcnQgIT0gdm1fc3RhcnQgfHwgdm1hLT52bV9lbmQgIT0gdm1fZW5kKSkKICB2
bWEgPSAoKHZvaWQgKikwKTsKCiByZXR1cm4gdm1hOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCByYW5n
ZV9pbl92bWEoc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEsCiAgICB1bnNpZ25lZCBsb25n
IHN0YXJ0LCB1bnNpZ25lZCBsb25nIGVuZCkKewogcmV0dXJuICh2bWEgJiYgdm1hLT52bV9z
dGFydCA8PSBzdGFydCAmJiBlbmQgPD0gdm1hLT52bV9lbmQpOwp9CgoKcGdwcm90X3Qgdm1f
Z2V0X3BhZ2VfcHJvdCh1bnNpZ25lZCBsb25nIHZtX2ZsYWdzKTsKdm9pZCB2bWFfc2V0X3Bh
Z2VfcHJvdChzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnZtYSk7CiMgMjc0MiAiLi9pbmNsdWRl
L2xpbnV4L21tLmgiCnN0cnVjdCB2bV9hcmVhX3N0cnVjdCAqZmluZF9leHRlbmRfdm1hKHN0
cnVjdCBtbV9zdHJ1Y3QgKiwgdW5zaWduZWQgbG9uZyBhZGRyKTsKaW50IHJlbWFwX3Bmbl9y
YW5nZShzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKiwgdW5zaWduZWQgbG9uZyBhZGRyLAogICB1
bnNpZ25lZCBsb25nIHBmbiwgdW5zaWduZWQgbG9uZyBzaXplLCBwZ3Byb3RfdCk7CmludCB2
bV9pbnNlcnRfcGFnZShzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKiwgdW5zaWduZWQgbG9uZyBh
ZGRyLCBzdHJ1Y3QgcGFnZSAqKTsKaW50IHZtX2luc2VydF9wYWdlcyhzdHJ1Y3Qgdm1fYXJl
YV9zdHJ1Y3QgKnZtYSwgdW5zaWduZWQgbG9uZyBhZGRyLAogICBzdHJ1Y3QgcGFnZSAqKnBh
Z2VzLCB1bnNpZ25lZCBsb25nICpudW0pOwppbnQgdm1fbWFwX3BhZ2VzKHN0cnVjdCB2bV9h
cmVhX3N0cnVjdCAqdm1hLCBzdHJ1Y3QgcGFnZSAqKnBhZ2VzLAogICAgdW5zaWduZWQgbG9u
ZyBudW0pOwppbnQgdm1fbWFwX3BhZ2VzX3plcm8oc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2
bWEsIHN0cnVjdCBwYWdlICoqcGFnZXMsCiAgICB1bnNpZ25lZCBsb25nIG51bSk7CnZtX2Zh
dWx0X3Qgdm1mX2luc2VydF9wZm4oc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEsIHVuc2ln
bmVkIGxvbmcgYWRkciwKICAgdW5zaWduZWQgbG9uZyBwZm4pOwp2bV9mYXVsdF90IHZtZl9p
bnNlcnRfcGZuX3Byb3Qoc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEsIHVuc2lnbmVkIGxv
bmcgYWRkciwKICAgdW5zaWduZWQgbG9uZyBwZm4sIHBncHJvdF90IHBncHJvdCk7CnZtX2Zh
dWx0X3Qgdm1mX2luc2VydF9taXhlZChzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnZtYSwgdW5z
aWduZWQgbG9uZyBhZGRyLAogICBwZm5fdCBwZm4pOwp2bV9mYXVsdF90IHZtZl9pbnNlcnRf
bWl4ZWRfcHJvdChzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnZtYSwgdW5zaWduZWQgbG9uZyBh
ZGRyLAogICBwZm5fdCBwZm4sIHBncHJvdF90IHBncHJvdCk7CnZtX2ZhdWx0X3Qgdm1mX2lu
c2VydF9taXhlZF9ta3dyaXRlKHN0cnVjdCB2bV9hcmVhX3N0cnVjdCAqdm1hLAogIHVuc2ln
bmVkIGxvbmcgYWRkciwgcGZuX3QgcGZuKTsKaW50IHZtX2lvbWFwX21lbW9yeShzdHJ1Y3Qg
dm1fYXJlYV9zdHJ1Y3QgKnZtYSwgcGh5c19hZGRyX3Qgc3RhcnQsIHVuc2lnbmVkIGxvbmcg
bGVuKTsKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSB2bV9mYXVsdF90IHZtZl9pbnNlcnRfcGFnZShzdHJ1Y3Qgdm1f
YXJlYV9zdHJ1Y3QgKnZtYSwKICAgIHVuc2lnbmVkIGxvbmcgYWRkciwgc3RydWN0IHBhZ2Ug
KnBhZ2UpCnsKIGludCBlcnIgPSB2bV9pbnNlcnRfcGFnZSh2bWEsIGFkZHIsIHBhZ2UpOwoK
IGlmIChlcnIgPT0gLTEyKQogIHJldHVybiBWTV9GQVVMVF9PT007CiBpZiAoZXJyIDwgMCAm
JiBlcnIgIT0gLTE2KQogIHJldHVybiBWTV9GQVVMVF9TSUdCVVM7CgogcmV0dXJuIFZNX0ZB
VUxUX05PUEFHRTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZtX2ZhdWx0X3Qgdm1mX2Vycm9yKGludCBlcnIp
CnsKIGlmIChlcnIgPT0gLTEyKQogIHJldHVybiBWTV9GQVVMVF9PT007CiByZXR1cm4gVk1f
RkFVTFRfU0lHQlVTOwp9CgpzdHJ1Y3QgcGFnZSAqZm9sbG93X3BhZ2Uoc3RydWN0IHZtX2Fy
ZWFfc3RydWN0ICp2bWEsIHVuc2lnbmVkIGxvbmcgYWRkcmVzcywKICAgIHVuc2lnbmVkIGlu
dCBmb2xsX2ZsYWdzKTsKIyAyODY1ICIuL2luY2x1ZGUvbGludXgvbW0uaCIKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IGludCB2bV9mYXVsdF90b19lcnJubyh2bV9mYXVsdF90IHZtX2ZhdWx0LCBpbnQgZm9sbF9m
bGFncykKewogaWYgKHZtX2ZhdWx0ICYgVk1fRkFVTFRfT09NKQogIHJldHVybiAtMTI7CiBp
ZiAodm1fZmF1bHQgJiAoVk1fRkFVTFRfSFdQT0lTT04gfCBWTV9GQVVMVF9IV1BPSVNPTl9M
QVJHRSkpCiAgcmV0dXJuIChmb2xsX2ZsYWdzICYgMHgxMDApID8gLTEzMyA6IC0xNDsKIGlm
ICh2bV9mYXVsdCAmIChWTV9GQVVMVF9TSUdCVVMgfCBWTV9GQVVMVF9TSUdTRUdWKSkKICBy
ZXR1cm4gLTE0OwogcmV0dXJuIDA7Cn0KCnR5cGVkZWYgaW50ICgqcHRlX2ZuX3QpKHB0ZV90
ICpwdGUsIHVuc2lnbmVkIGxvbmcgYWRkciwgdm9pZCAqZGF0YSk7CmV4dGVybiBpbnQgYXBw
bHlfdG9fcGFnZV9yYW5nZShzdHJ1Y3QgbW1fc3RydWN0ICptbSwgdW5zaWduZWQgbG9uZyBh
ZGRyZXNzLAogICAgICAgICAgdW5zaWduZWQgbG9uZyBzaXplLCBwdGVfZm5fdCBmbiwgdm9p
ZCAqZGF0YSk7CmV4dGVybiBpbnQgYXBwbHlfdG9fZXhpc3RpbmdfcGFnZV9yYW5nZShzdHJ1
Y3QgbW1fc3RydWN0ICptbSwKICAgICAgIHVuc2lnbmVkIGxvbmcgYWRkcmVzcywgdW5zaWdu
ZWQgbG9uZyBzaXplLAogICAgICAgcHRlX2ZuX3QgZm4sIHZvaWQgKmRhdGEpOwoKCgoKCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSBib29sIHBhZ2VfcG9pc29uaW5nX2VuYWJsZWQodm9pZCkgeyByZXR1cm4gZmFs
c2U7IH0Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIHZvaWQga2VybmVsX3BvaXNvbl9wYWdlcyhzdHJ1Y3QgcGFnZSAq
cGFnZSwgaW50IG51bXBhZ2VzLAogICAgIGludCBlbmFibGUpIHsgfQoKCgoKCmV4dGVybiBz
dHJ1Y3Qgc3RhdGljX2tleV9mYWxzZSBpbml0X29uX2FsbG9jOwoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wg
d2FudF9pbml0X29uX2FsbG9jKGdmcF90IGZsYWdzKQp7CiBpZiAoX19idWlsdGluX2V4cGVj
dCghISgoeyBpZiAoIV9fYnVpbHRpbl90eXBlc19jb21wYXRpYmxlX3AodHlwZW9mKComKCZp
bml0X29uX2FsbG9jKS0+a2V5KSwgc3RydWN0IHN0YXRpY19rZXkpICYmICFfX2J1aWx0aW5f
dHlwZXNfY29tcGF0aWJsZV9wKHR5cGVvZigqJigmaW5pdF9vbl9hbGxvYyktPmtleSksIHN0
cnVjdCBzdGF0aWNfa2V5X3RydWUpICYmICFfX2J1aWx0aW5fdHlwZXNfY29tcGF0aWJsZV9w
KHR5cGVvZigqJigmaW5pdF9vbl9hbGxvYyktPmtleSksIHN0cnVjdCBzdGF0aWNfa2V5X2Zh
bHNlKSkgX19fX3dyb25nX2JyYW5jaF9lcnJvcigpOyBzdGF0aWNfa2V5X2NvdW50KChzdHJ1
Y3Qgc3RhdGljX2tleSAqKSYoJmluaXRfb25fYWxsb2MpLT5rZXkpID4gMDsgfSkpLCAwKSAm
JgogICAgICFwYWdlX3BvaXNvbmluZ19lbmFibGVkKCkpCiAgcmV0dXJuIHRydWU7CiByZXR1
cm4gZmxhZ3MgJiAoKCBnZnBfdCkweDEwMHUpOwp9CgoKCgpleHRlcm4gc3RydWN0IHN0YXRp
Y19rZXlfZmFsc2UgaW5pdF9vbl9mcmVlOwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgd2FudF9pbml0X29u
X2ZyZWUodm9pZCkKewogcmV0dXJuIF9fYnVpbHRpbl9leHBlY3QoISEoKHsgaWYgKCFfX2J1
aWx0aW5fdHlwZXNfY29tcGF0aWJsZV9wKHR5cGVvZigqJigmaW5pdF9vbl9mcmVlKS0+a2V5
KSwgc3RydWN0IHN0YXRpY19rZXkpICYmICFfX2J1aWx0aW5fdHlwZXNfY29tcGF0aWJsZV9w
KHR5cGVvZigqJigmaW5pdF9vbl9mcmVlKS0+a2V5KSwgc3RydWN0IHN0YXRpY19rZXlfdHJ1
ZSkgJiYgIV9fYnVpbHRpbl90eXBlc19jb21wYXRpYmxlX3AodHlwZW9mKComKCZpbml0X29u
X2ZyZWUpLT5rZXkpLCBzdHJ1Y3Qgc3RhdGljX2tleV9mYWxzZSkpIF9fX193cm9uZ19icmFu
Y2hfZXJyb3IoKTsgc3RhdGljX2tleV9jb3VudCgoc3RydWN0IHN0YXRpY19rZXkgKikmKCZp
bml0X29uX2ZyZWUpLT5rZXkpID4gMDsgfSkpLCAwKSAmJgogICAgICAgICFwYWdlX3BvaXNv
bmluZ19lbmFibGVkKCk7Cn0KCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGluaXRfZGVidWdfcGFnZWFs
bG9jKHZvaWQpIHt9CgpleHRlcm4gYm9vbCBfZGVidWdfcGFnZWFsbG9jX2VuYWJsZWRfZWFy
bHk7CmV4dGVybiBzdHJ1Y3Qgc3RhdGljX2tleV9mYWxzZSBfZGVidWdfcGFnZWFsbG9jX2Vu
YWJsZWQ7CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBkZWJ1Z19wYWdlYWxsb2NfZW5hYmxlZCh2b2lkKQp7
CiByZXR1cm4gMCAmJgogIF9kZWJ1Z19wYWdlYWxsb2NfZW5hYmxlZF9lYXJseTsKfQoKCgoK
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSBib29sIGRlYnVnX3BhZ2VhbGxvY19lbmFibGVkX3N0YXRpYyh2b2lkKQp7
CiBpZiAoITApCiAgcmV0dXJuIGZhbHNlOwoKIHJldHVybiBfX2J1aWx0aW5fZXhwZWN0KCEh
KCh7IGlmICghX19idWlsdGluX3R5cGVzX2NvbXBhdGlibGVfcCh0eXBlb2YoKiYoJl9kZWJ1
Z19wYWdlYWxsb2NfZW5hYmxlZCktPmtleSksIHN0cnVjdCBzdGF0aWNfa2V5KSAmJiAhX19i
dWlsdGluX3R5cGVzX2NvbXBhdGlibGVfcCh0eXBlb2YoKiYoJl9kZWJ1Z19wYWdlYWxsb2Nf
ZW5hYmxlZCktPmtleSksIHN0cnVjdCBzdGF0aWNfa2V5X3RydWUpICYmICFfX2J1aWx0aW5f
dHlwZXNfY29tcGF0aWJsZV9wKHR5cGVvZigqJigmX2RlYnVnX3BhZ2VhbGxvY19lbmFibGVk
KS0+a2V5KSwgc3RydWN0IHN0YXRpY19rZXlfZmFsc2UpKSBfX19fd3JvbmdfYnJhbmNoX2Vy
cm9yKCk7IHN0YXRpY19rZXlfY291bnQoKHN0cnVjdCBzdGF0aWNfa2V5ICopJigmX2RlYnVn
X3BhZ2VhbGxvY19lbmFibGVkKS0+a2V5KSA+IDA7IH0pKSwgMCk7Cn0KIyAyOTU4ICIuL2lu
Y2x1ZGUvbGludXgvbW0uaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQKa2VybmVsX21hcF9wYWdlcyhzdHJ1
Y3QgcGFnZSAqcGFnZSwgaW50IG51bXBhZ2VzLCBpbnQgZW5hYmxlKSB7fQojIDI5NzAgIi4v
aW5jbHVkZS9saW51eC9tbS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IHZtX2FyZWFfc3RydWN0ICpn
ZXRfZ2F0ZV92bWEoc3RydWN0IG1tX3N0cnVjdCAqbW0pCnsKIHJldHVybiAoKHZvaWQgKikw
KTsKfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgaW50IGluX2dhdGVfYXJlYV9ub19tbSh1bnNpZ25lZCBsb25nIGFk
ZHIpIHsgcmV0dXJuIDA7IH0Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBpbl9nYXRlX2FyZWEoc3RydWN0IG1t
X3N0cnVjdCAqbW0sIHVuc2lnbmVkIGxvbmcgYWRkcikKewogcmV0dXJuIDA7Cn0KCgpleHRl
cm4gYm9vbCBwcm9jZXNzX3NoYXJlc19tbShzdHJ1Y3QgdGFza19zdHJ1Y3QgKnAsIHN0cnVj
dCBtbV9zdHJ1Y3QgKm1tKTsKCgpleHRlcm4gaW50IHN5c2N0bF9kcm9wX2NhY2hlczsKaW50
IGRyb3BfY2FjaGVzX3N5c2N0bF9oYW5kbGVyKHN0cnVjdCBjdGxfdGFibGUgKiwgaW50LCB2
b2lkICosIHNpemVfdCAqLAogIGxvZmZfdCAqKTsKCgp2b2lkIGRyb3Bfc2xhYih2b2lkKTsK
dm9pZCBkcm9wX3NsYWJfbm9kZShpbnQgbmlkKTsKCgoKCmV4dGVybiBpbnQgcmFuZG9taXpl
X3ZhX3NwYWNlOwoKCmNvbnN0IGNoYXIgKiBhcmNoX3ZtYV9uYW1lKHN0cnVjdCB2bV9hcmVh
X3N0cnVjdCAqdm1hKTsKCnZvaWQgcHJpbnRfdm1hX2FkZHIoY2hhciAqcHJlZml4LCB1bnNp
Z25lZCBsb25nIHJpcCk7CgoKCgoKCnZvaWQgKnNwYXJzZV9idWZmZXJfYWxsb2ModW5zaWdu
ZWQgbG9uZyBzaXplKTsKc3RydWN0IHBhZ2UgKiBfX3BvcHVsYXRlX3NlY3Rpb25fbWVtbWFw
KHVuc2lnbmVkIGxvbmcgcGZuLAogIHVuc2lnbmVkIGxvbmcgbnJfcGFnZXMsIGludCBuaWQs
IHN0cnVjdCB2bWVtX2FsdG1hcCAqYWx0bWFwKTsKcGdkX3QgKnZtZW1tYXBfcGdkX3BvcHVs
YXRlKHVuc2lnbmVkIGxvbmcgYWRkciwgaW50IG5vZGUpOwpwNGRfdCAqdm1lbW1hcF9wNGRf
cG9wdWxhdGUocGdkX3QgKnBnZCwgdW5zaWduZWQgbG9uZyBhZGRyLCBpbnQgbm9kZSk7CnB1
ZF90ICp2bWVtbWFwX3B1ZF9wb3B1bGF0ZShwNGRfdCAqcDRkLCB1bnNpZ25lZCBsb25nIGFk
ZHIsIGludCBub2RlKTsKcG1kX3QgKnZtZW1tYXBfcG1kX3BvcHVsYXRlKHB1ZF90ICpwdWQs
IHVuc2lnbmVkIGxvbmcgYWRkciwgaW50IG5vZGUpOwpwdGVfdCAqdm1lbW1hcF9wdGVfcG9w
dWxhdGUocG1kX3QgKnBtZCwgdW5zaWduZWQgbG9uZyBhZGRyLCBpbnQgbm9kZSk7CnZvaWQg
KnZtZW1tYXBfYWxsb2NfYmxvY2sodW5zaWduZWQgbG9uZyBzaXplLCBpbnQgbm9kZSk7CnN0
cnVjdCB2bWVtX2FsdG1hcDsKdm9pZCAqdm1lbW1hcF9hbGxvY19ibG9ja19idWYodW5zaWdu
ZWQgbG9uZyBzaXplLCBpbnQgbm9kZSk7CnZvaWQgKmFsdG1hcF9hbGxvY19ibG9ja19idWYo
dW5zaWduZWQgbG9uZyBzaXplLCBzdHJ1Y3Qgdm1lbV9hbHRtYXAgKmFsdG1hcCk7CnZvaWQg
dm1lbW1hcF92ZXJpZnkocHRlX3QgKiwgaW50LCB1bnNpZ25lZCBsb25nLCB1bnNpZ25lZCBs
b25nKTsKaW50IHZtZW1tYXBfcG9wdWxhdGVfYmFzZXBhZ2VzKHVuc2lnbmVkIGxvbmcgc3Rh
cnQsIHVuc2lnbmVkIGxvbmcgZW5kLAogICAgICAgICAgaW50IG5vZGUpOwppbnQgdm1lbW1h
cF9wb3B1bGF0ZSh1bnNpZ25lZCBsb25nIHN0YXJ0LCB1bnNpZ25lZCBsb25nIGVuZCwgaW50
IG5vZGUsCiAgc3RydWN0IHZtZW1fYWx0bWFwICphbHRtYXApOwp2b2lkIHZtZW1tYXBfcG9w
dWxhdGVfcHJpbnRfbGFzdCh2b2lkKTsKCgoKCnZvaWQgcmVnaXN0ZXJfcGFnZV9ib290bWVt
X21lbW1hcCh1bnNpZ25lZCBsb25nIHNlY3Rpb25fbnIsIHN0cnVjdCBwYWdlICptYXAsCiAg
ICAgIHVuc2lnbmVkIGxvbmcgbnJfcGFnZXMpOwoKZW51bSBtZl9mbGFncyB7CiBNRl9DT1VO
VF9JTkNSRUFTRUQgPSAxIDw8IDAsCiBNRl9BQ1RJT05fUkVRVUlSRUQgPSAxIDw8IDEsCiBN
Rl9NVVNUX0tJTEwgPSAxIDw8IDIsCiBNRl9TT0ZUX09GRkxJTkUgPSAxIDw8IDMsCn07CmV4
dGVybiBpbnQgbWVtb3J5X2ZhaWx1cmUodW5zaWduZWQgbG9uZyBwZm4sIGludCBmbGFncyk7
CmV4dGVybiB2b2lkIG1lbW9yeV9mYWlsdXJlX3F1ZXVlKHVuc2lnbmVkIGxvbmcgcGZuLCBp
bnQgZmxhZ3MpOwpleHRlcm4gdm9pZCBtZW1vcnlfZmFpbHVyZV9xdWV1ZV9raWNrKGludCBj
cHUpOwpleHRlcm4gaW50IHVucG9pc29uX21lbW9yeSh1bnNpZ25lZCBsb25nIHBmbik7CmV4
dGVybiBpbnQgZ2V0X2h3cG9pc29uX3BhZ2Uoc3RydWN0IHBhZ2UgKnBhZ2UpOwoKZXh0ZXJu
IGludCBzeXNjdGxfbWVtb3J5X2ZhaWx1cmVfZWFybHlfa2lsbDsKZXh0ZXJuIGludCBzeXNj
dGxfbWVtb3J5X2ZhaWx1cmVfcmVjb3Zlcnk7CmV4dGVybiB2b2lkIHNoYWtlX3BhZ2Uoc3Ry
dWN0IHBhZ2UgKnAsIGludCBhY2Nlc3MpOwpleHRlcm4gYXRvbWljX2xvbmdfdCBudW1fcG9p
c29uZWRfcGFnZXMgX19hdHRyaWJ1dGVfXygoX19zZWN0aW9uX18oIi5kYXRhLi5yZWFkX21v
c3RseSIpKSk7CmV4dGVybiBpbnQgc29mdF9vZmZsaW5lX3BhZ2UodW5zaWduZWQgbG9uZyBw
Zm4sIGludCBmbGFncyk7CgoKCgoKZW51bSBtZl9yZXN1bHQgewogTUZfSUdOT1JFRCwKIE1G
X0ZBSUxFRCwKIE1GX0RFTEFZRUQsCiBNRl9SRUNPVkVSRUQsCn07CgplbnVtIG1mX2FjdGlv
bl9wYWdlX3R5cGUgewogTUZfTVNHX0tFUk5FTCwKIE1GX01TR19LRVJORUxfSElHSF9PUkRF
UiwKIE1GX01TR19TTEFCLAogTUZfTVNHX0RJRkZFUkVOVF9DT01QT1VORCwKIE1GX01TR19Q
T0lTT05FRF9IVUdFLAogTUZfTVNHX0hVR0UsCiBNRl9NU0dfRlJFRV9IVUdFLAogTUZfTVNH
X05PTl9QTURfSFVHRSwKIE1GX01TR19VTk1BUF9GQUlMRUQsCiBNRl9NU0dfRElSVFlfU1dB
UENBQ0hFLAogTUZfTVNHX0NMRUFOX1NXQVBDQUNIRSwKIE1GX01TR19ESVJUWV9NTE9DS0VE
X0xSVSwKIE1GX01TR19DTEVBTl9NTE9DS0VEX0xSVSwKIE1GX01TR19ESVJUWV9VTkVWSUNU
QUJMRV9MUlUsCiBNRl9NU0dfQ0xFQU5fVU5FVklDVEFCTEVfTFJVLAogTUZfTVNHX0RJUlRZ
X0xSVSwKIE1GX01TR19DTEVBTl9MUlUsCiBNRl9NU0dfVFJVTkNBVEVEX0xSVSwKIE1GX01T
R19CVUREWSwKIE1GX01TR19CVUREWV8yTkQsCiBNRl9NU0dfREFYLAogTUZfTVNHX1VOS05P
V04sCn07CgoKZXh0ZXJuIHZvaWQgY2xlYXJfaHVnZV9wYWdlKHN0cnVjdCBwYWdlICpwYWdl
LAogICAgICAgdW5zaWduZWQgbG9uZyBhZGRyX2hpbnQsCiAgICAgICB1bnNpZ25lZCBpbnQg
cGFnZXNfcGVyX2h1Z2VfcGFnZSk7CmV4dGVybiB2b2lkIGNvcHlfdXNlcl9odWdlX3BhZ2Uo
c3RydWN0IHBhZ2UgKmRzdCwgc3RydWN0IHBhZ2UgKnNyYywKICAgIHVuc2lnbmVkIGxvbmcg
YWRkcl9oaW50LAogICAgc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEsCiAgICB1bnNpZ25l
ZCBpbnQgcGFnZXNfcGVyX2h1Z2VfcGFnZSk7CmV4dGVybiBsb25nIGNvcHlfaHVnZV9wYWdl
X2Zyb21fdXNlcihzdHJ1Y3QgcGFnZSAqZHN0X3BhZ2UsCiAgICBjb25zdCB2b2lkICp1c3Jf
c3JjLAogICAgdW5zaWduZWQgaW50IHBhZ2VzX3Blcl9odWdlX3BhZ2UsCiAgICBib29sIGFs
bG93X3BhZ2VmYXVsdCk7CiMgMzEwOSAiLi9pbmNsdWRlL2xpbnV4L21tLmgiCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBib29sIHZtYV9pc19zcGVjaWFsX2h1Z2UoY29uc3Qgc3RydWN0IHZtX2FyZWFfc3RydWN0
ICp2bWEpCnsKIHJldHVybiB2bWFfaXNfZGF4KHZtYSkgfHwgKHZtYS0+dm1fZmlsZSAmJgog
ICAgICAgKHZtYS0+dm1fZmxhZ3MgJiAoMHgwMDAwMDQwMCB8IDB4MTAwMDAwMDApKSk7Cn0K
IyAzMTM5ICIuL2luY2x1ZGUvbGludXgvbW0uaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHVuc2lnbmVkIGludCBk
ZWJ1Z19ndWFyZHBhZ2VfbWlub3JkZXIodm9pZCkgeyByZXR1cm4gMDsgfQpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
Ym9vbCBkZWJ1Z19ndWFyZHBhZ2VfZW5hYmxlZCh2b2lkKSB7IHJldHVybiBmYWxzZTsgfQpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgYm9vbCBwYWdlX2lzX2d1YXJkKHN0cnVjdCBwYWdlICpwYWdlKSB7IHJldHVy
biBmYWxzZTsgfQoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHNldHVwX25yX25vZGVfaWRzKHZvaWQp
IHt9CgoKZXh0ZXJuIGludCBtZW1jbXBfcGFnZXMoc3RydWN0IHBhZ2UgKnBhZ2UxLCBzdHJ1
Y3QgcGFnZSAqcGFnZTIpOwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBwYWdlc19pZGVudGljYWwoc3RydWN0
IHBhZ2UgKnBhZ2UxLCBzdHJ1Y3QgcGFnZSAqcGFnZTIpCnsKIHJldHVybiAhbWVtY21wX3Bh
Z2VzKHBhZ2UxLCBwYWdlMik7Cn0KIyAzMTY5ICIuL2luY2x1ZGUvbGludXgvbW0uaCIKZXh0
ZXJuIGludCBzeXNjdGxfbnJfdHJpbV9wYWdlczsKIyAxOCAiYXJjaC9wb3dlcnBjL2tlcm5l
bC9zaWduYWxfMzIuYyIgMgoKCgoKIyAxICIuL2luY2x1ZGUvbGludXgvZWxmLmgiIDEKCgoK
CgojIDEgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2VsZi5oIiAxCiMgMTEgIi4vYXJj
aC9wb3dlcnBjL2luY2x1ZGUvYXNtL2VsZi5oIgojIDEgIi4vYXJjaC9wb3dlcnBjL2luY2x1
ZGUvdWFwaS9hc20vZWxmLmgiIDEKIyAxMDIgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvdWFw
aS9hc20vZWxmLmgiCnR5cGVkZWYgdW5zaWduZWQgbG9uZyBlbGZfZ3JlZ190NjQ7CnR5cGVk
ZWYgZWxmX2dyZWdfdDY0IGVsZl9ncmVnc2V0X3Q2NFs0OF07Cgp0eXBlZGVmIHVuc2lnbmVk
IGludCBlbGZfZ3JlZ190MzI7CnR5cGVkZWYgZWxmX2dyZWdfdDMyIGVsZl9ncmVnc2V0X3Qz
Mls0OF07CnR5cGVkZWYgZWxmX2dyZWdzZXRfdDMyIGNvbXBhdF9lbGZfZ3JlZ3NldF90Owoj
IDExOSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS91YXBpL2FzbS9lbGYuaCIKdHlwZWRlZiBl
bGZfZ3JlZ190NjQgZWxmX2dyZWdfdDsKdHlwZWRlZiBlbGZfZ3JlZ3NldF90NjQgZWxmX2dy
ZWdzZXRfdDsKIyAxMzggIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvdWFwaS9hc20vZWxmLmgi
CnR5cGVkZWYgZG91YmxlIGVsZl9mcHJlZ190Owp0eXBlZGVmIGVsZl9mcHJlZ190IGVsZl9m
cHJlZ3NldF90WzMzXTsKIyAxNjAgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvdWFwaS9hc20v
ZWxmLmgiCnR5cGVkZWYgX192ZWN0b3IxMjggZWxmX3ZycmVnX3Q7CnR5cGVkZWYgZWxmX3Zy
cmVnX3QgZWxmX3ZycmVnc2V0X3RbMzRdOwoKdHlwZWRlZiBlbGZfdnJyZWdfdCBlbGZfdnJy
ZWdzZXRfdDMyWzMzXTsKdHlwZWRlZiBlbGZfZnByZWdfdCBlbGZfdnNycmVnaGFsZl90MzJb
MzJdOwojIDI5MyAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS91YXBpL2FzbS9lbGYuaCIKc3Ry
dWN0IHBwYzY0X29wZF9lbnRyeQp7CiB1bnNpZ25lZCBsb25nIGZ1bmNhZGRyOwogdW5zaWdu
ZWQgbG9uZyByMjsKfTsKIyAxMiAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vZWxmLmgi
IDIKIyA0OSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vZWxmLmgiCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2
b2lkIHBwY19lbGZfY29yZV9jb3B5X3JlZ3MoZWxmX2dyZWdzZXRfdCBlbGZfcmVncywKICAg
ICAgIHN0cnVjdCBwdF9yZWdzICpyZWdzKQp7CiBpbnQgaSwgbnJlZ3MgPSBfX2J1aWx0aW5f
Y2hvb3NlX2V4cHIoKCghIShzaXplb2YoKHR5cGVvZihzaXplb2YoKnJlZ3MpIC8gc2l6ZW9m
KHVuc2lnbmVkIGxvbmcpKSAqKTEgPT0gKHR5cGVvZigoc2l6ZV90KTQ4KSAqKTEpKSkgJiYg
KChzaXplb2YoaW50KSA9PSBzaXplb2YoKig4ID8gKCh2b2lkICopKChsb25nKShzaXplb2Yo
KnJlZ3MpIC8gc2l6ZW9mKHVuc2lnbmVkIGxvbmcpKSAqIDBsKSkgOiAoaW50ICopOCkpKSAm
JiAoc2l6ZW9mKGludCkgPT0gc2l6ZW9mKCooOCA/ICgodm9pZCAqKSgobG9uZykoKHNpemVf
dCk0OCkgKiAwbCkpIDogKGludCAqKTgpKSkpKSwgKChzaXplb2YoKnJlZ3MpIC8gc2l6ZW9m
KHVuc2lnbmVkIGxvbmcpKSA8ICgoc2l6ZV90KTQ4KSA/IChzaXplb2YoKnJlZ3MpIC8gc2l6
ZW9mKHVuc2lnbmVkIGxvbmcpKSA6ICgoc2l6ZV90KTQ4KSksICh7IHR5cGVvZihzaXplb2Yo
KnJlZ3MpIC8gc2l6ZW9mKHVuc2lnbmVkIGxvbmcpKSBfX1VOSVFVRV9JRF9fX3gxNzcgPSAo
c2l6ZW9mKCpyZWdzKSAvIHNpemVvZih1bnNpZ25lZCBsb25nKSk7IHR5cGVvZigoc2l6ZV90
KTQ4KSBfX1VOSVFVRV9JRF9fX3kxNzggPSAoKHNpemVfdCk0OCk7ICgoX19VTklRVUVfSURf
X194MTc3KSA8IChfX1VOSVFVRV9JRF9fX3kxNzgpID8gKF9fVU5JUVVFX0lEX19feDE3Nykg
OiAoX19VTklRVUVfSURfX195MTc4KSk7IH0pKTsgZm9yIChpID0gMDsgaSA8IG5yZWdzOyBp
KyspIGVsZl9yZWdzW2ldID0gKCh1bnNpZ25lZCBsb25nICopIHJlZ3MpW2ldOyBtZW1zZXQo
JmVsZl9yZWdzW2ldLCAwLCAoNDggLSBpKSAqIHNpemVvZihlbGZfcmVnc1swXSkpOwp9CgoK
dHlwZWRlZiBlbGZfdnJyZWdzZXRfdCBlbGZfZnB4cmVnc2V0X3Q7CiMgMTEyICIuL2FyY2gv
cG93ZXJwYy9pbmNsdWRlL2FzbS9lbGYuaCIKZXh0ZXJuIGludCBkY2FjaGVfYnNpemU7CmV4
dGVybiBpbnQgaWNhY2hlX2JzaXplOwpleHRlcm4gaW50IHVjYWNoZV9ic2l6ZTsKCgoKc3Ry
dWN0IGxpbnV4X2JpbnBybTsKZXh0ZXJuIGludCBhcmNoX3NldHVwX2FkZGl0aW9uYWxfcGFn
ZXMoc3RydWN0IGxpbnV4X2JpbnBybSAqYnBybSwKICAgICAgICAgICBpbnQgdXNlc19pbnRl
cnApOwojIDE3OSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vZWxmLmgiCnZvaWQgcmVs
b2NhdGUodW5zaWduZWQgbG9uZyBmaW5hbF9hZGRyZXNzKTsKIyA3ICIuL2luY2x1ZGUvbGlu
dXgvZWxmLmgiIDIKIyAxICIuL2luY2x1ZGUvdWFwaS9saW51eC9lbGYuaCIgMQoKCgoKCiMg
MSAiLi9pbmNsdWRlL3VhcGkvbGludXgvZWxmLWVtLmgiIDEKIyA3ICIuL2luY2x1ZGUvdWFw
aS9saW51eC9lbGYuaCIgMgoKCnR5cGVkZWYgX191MzIgRWxmMzJfQWRkcjsKdHlwZWRlZiBf
X3UxNiBFbGYzMl9IYWxmOwp0eXBlZGVmIF9fdTMyIEVsZjMyX09mZjsKdHlwZWRlZiBfX3Mz
MiBFbGYzMl9Td29yZDsKdHlwZWRlZiBfX3UzMiBFbGYzMl9Xb3JkOwoKCnR5cGVkZWYgX191
NjQgRWxmNjRfQWRkcjsKdHlwZWRlZiBfX3UxNiBFbGY2NF9IYWxmOwp0eXBlZGVmIF9fczE2
IEVsZjY0X1NIYWxmOwp0eXBlZGVmIF9fdTY0IEVsZjY0X09mZjsKdHlwZWRlZiBfX3MzMiBF
bGY2NF9Td29yZDsKdHlwZWRlZiBfX3UzMiBFbGY2NF9Xb3JkOwp0eXBlZGVmIF9fdTY0IEVs
ZjY0X1h3b3JkOwp0eXBlZGVmIF9fczY0IEVsZjY0X1N4d29yZDsKIyAxMzkgIi4vaW5jbHVk
ZS91YXBpL2xpbnV4L2VsZi5oIgp0eXBlZGVmIHN0cnVjdCBkeW5hbWljewogIEVsZjMyX1N3
b3JkIGRfdGFnOwogIHVuaW9uewogICAgRWxmMzJfU3dvcmQgZF92YWw7CiAgICBFbGYzMl9B
ZGRyIGRfcHRyOwogIH0gZF91bjsKfSBFbGYzMl9EeW47Cgp0eXBlZGVmIHN0cnVjdCB7CiAg
RWxmNjRfU3h3b3JkIGRfdGFnOwogIHVuaW9uIHsKICAgIEVsZjY0X1h3b3JkIGRfdmFsOwog
ICAgRWxmNjRfQWRkciBkX3B0cjsKICB9IGRfdW47Cn0gRWxmNjRfRHluOwojIDE2MiAiLi9p
bmNsdWRlL3VhcGkvbGludXgvZWxmLmgiCnR5cGVkZWYgc3RydWN0IGVsZjMyX3JlbCB7CiAg
RWxmMzJfQWRkciByX29mZnNldDsKICBFbGYzMl9Xb3JkIHJfaW5mbzsKfSBFbGYzMl9SZWw7
Cgp0eXBlZGVmIHN0cnVjdCBlbGY2NF9yZWwgewogIEVsZjY0X0FkZHIgcl9vZmZzZXQ7CiAg
RWxmNjRfWHdvcmQgcl9pbmZvOwp9IEVsZjY0X1JlbDsKCnR5cGVkZWYgc3RydWN0IGVsZjMy
X3JlbGF7CiAgRWxmMzJfQWRkciByX29mZnNldDsKICBFbGYzMl9Xb3JkIHJfaW5mbzsKICBF
bGYzMl9Td29yZCByX2FkZGVuZDsKfSBFbGYzMl9SZWxhOwoKdHlwZWRlZiBzdHJ1Y3QgZWxm
NjRfcmVsYSB7CiAgRWxmNjRfQWRkciByX29mZnNldDsKICBFbGY2NF9Yd29yZCByX2luZm87
CiAgRWxmNjRfU3h3b3JkIHJfYWRkZW5kOwp9IEVsZjY0X1JlbGE7Cgp0eXBlZGVmIHN0cnVj
dCBlbGYzMl9zeW17CiAgRWxmMzJfV29yZCBzdF9uYW1lOwogIEVsZjMyX0FkZHIgc3RfdmFs
dWU7CiAgRWxmMzJfV29yZCBzdF9zaXplOwogIHVuc2lnbmVkIGNoYXIgc3RfaW5mbzsKICB1
bnNpZ25lZCBjaGFyIHN0X290aGVyOwogIEVsZjMyX0hhbGYgc3Rfc2huZHg7Cn0gRWxmMzJf
U3ltOwoKdHlwZWRlZiBzdHJ1Y3QgZWxmNjRfc3ltIHsKICBFbGY2NF9Xb3JkIHN0X25hbWU7
CiAgdW5zaWduZWQgY2hhciBzdF9pbmZvOwogIHVuc2lnbmVkIGNoYXIgc3Rfb3RoZXI7CiAg
RWxmNjRfSGFsZiBzdF9zaG5keDsKICBFbGY2NF9BZGRyIHN0X3ZhbHVlOwogIEVsZjY0X1h3
b3JkIHN0X3NpemU7Cn0gRWxmNjRfU3ltOwoKCgoKdHlwZWRlZiBzdHJ1Y3QgZWxmMzJfaGRy
ewogIHVuc2lnbmVkIGNoYXIgZV9pZGVudFsxNl07CiAgRWxmMzJfSGFsZiBlX3R5cGU7CiAg
RWxmMzJfSGFsZiBlX21hY2hpbmU7CiAgRWxmMzJfV29yZCBlX3ZlcnNpb247CiAgRWxmMzJf
QWRkciBlX2VudHJ5OwogIEVsZjMyX09mZiBlX3Bob2ZmOwogIEVsZjMyX09mZiBlX3Nob2Zm
OwogIEVsZjMyX1dvcmQgZV9mbGFnczsKICBFbGYzMl9IYWxmIGVfZWhzaXplOwogIEVsZjMy
X0hhbGYgZV9waGVudHNpemU7CiAgRWxmMzJfSGFsZiBlX3BobnVtOwogIEVsZjMyX0hhbGYg
ZV9zaGVudHNpemU7CiAgRWxmMzJfSGFsZiBlX3NobnVtOwogIEVsZjMyX0hhbGYgZV9zaHN0
cm5keDsKfSBFbGYzMl9FaGRyOwoKdHlwZWRlZiBzdHJ1Y3QgZWxmNjRfaGRyIHsKICB1bnNp
Z25lZCBjaGFyIGVfaWRlbnRbMTZdOwogIEVsZjY0X0hhbGYgZV90eXBlOwogIEVsZjY0X0hh
bGYgZV9tYWNoaW5lOwogIEVsZjY0X1dvcmQgZV92ZXJzaW9uOwogIEVsZjY0X0FkZHIgZV9l
bnRyeTsKICBFbGY2NF9PZmYgZV9waG9mZjsKICBFbGY2NF9PZmYgZV9zaG9mZjsKICBFbGY2
NF9Xb3JkIGVfZmxhZ3M7CiAgRWxmNjRfSGFsZiBlX2Voc2l6ZTsKICBFbGY2NF9IYWxmIGVf
cGhlbnRzaXplOwogIEVsZjY0X0hhbGYgZV9waG51bTsKICBFbGY2NF9IYWxmIGVfc2hlbnRz
aXplOwogIEVsZjY0X0hhbGYgZV9zaG51bTsKICBFbGY2NF9IYWxmIGVfc2hzdHJuZHg7Cn0g
RWxmNjRfRWhkcjsKCgoKCgoKCnR5cGVkZWYgc3RydWN0IGVsZjMyX3BoZHJ7CiAgRWxmMzJf
V29yZCBwX3R5cGU7CiAgRWxmMzJfT2ZmIHBfb2Zmc2V0OwogIEVsZjMyX0FkZHIgcF92YWRk
cjsKICBFbGYzMl9BZGRyIHBfcGFkZHI7CiAgRWxmMzJfV29yZCBwX2ZpbGVzejsKICBFbGYz
Ml9Xb3JkIHBfbWVtc3o7CiAgRWxmMzJfV29yZCBwX2ZsYWdzOwogIEVsZjMyX1dvcmQgcF9h
bGlnbjsKfSBFbGYzMl9QaGRyOwoKdHlwZWRlZiBzdHJ1Y3QgZWxmNjRfcGhkciB7CiAgRWxm
NjRfV29yZCBwX3R5cGU7CiAgRWxmNjRfV29yZCBwX2ZsYWdzOwogIEVsZjY0X09mZiBwX29m
ZnNldDsKICBFbGY2NF9BZGRyIHBfdmFkZHI7CiAgRWxmNjRfQWRkciBwX3BhZGRyOwogIEVs
ZjY0X1h3b3JkIHBfZmlsZXN6OwogIEVsZjY0X1h3b3JkIHBfbWVtc3o7CiAgRWxmNjRfWHdv
cmQgcF9hbGlnbjsKfSBFbGY2NF9QaGRyOwojIDMwNCAiLi9pbmNsdWRlL3VhcGkvbGludXgv
ZWxmLmgiCnR5cGVkZWYgc3RydWN0IGVsZjMyX3NoZHIgewogIEVsZjMyX1dvcmQgc2hfbmFt
ZTsKICBFbGYzMl9Xb3JkIHNoX3R5cGU7CiAgRWxmMzJfV29yZCBzaF9mbGFnczsKICBFbGYz
Ml9BZGRyIHNoX2FkZHI7CiAgRWxmMzJfT2ZmIHNoX29mZnNldDsKICBFbGYzMl9Xb3JkIHNo
X3NpemU7CiAgRWxmMzJfV29yZCBzaF9saW5rOwogIEVsZjMyX1dvcmQgc2hfaW5mbzsKICBF
bGYzMl9Xb3JkIHNoX2FkZHJhbGlnbjsKICBFbGYzMl9Xb3JkIHNoX2VudHNpemU7Cn0gRWxm
MzJfU2hkcjsKCnR5cGVkZWYgc3RydWN0IGVsZjY0X3NoZHIgewogIEVsZjY0X1dvcmQgc2hf
bmFtZTsKICBFbGY2NF9Xb3JkIHNoX3R5cGU7CiAgRWxmNjRfWHdvcmQgc2hfZmxhZ3M7CiAg
RWxmNjRfQWRkciBzaF9hZGRyOwogIEVsZjY0X09mZiBzaF9vZmZzZXQ7CiAgRWxmNjRfWHdv
cmQgc2hfc2l6ZTsKICBFbGY2NF9Xb3JkIHNoX2xpbms7CiAgRWxmNjRfV29yZCBzaF9pbmZv
OwogIEVsZjY0X1h3b3JkIHNoX2FkZHJhbGlnbjsKICBFbGY2NF9Yd29yZCBzaF9lbnRzaXpl
Owp9IEVsZjY0X1NoZHI7CiMgNDM4ICIuL2luY2x1ZGUvdWFwaS9saW51eC9lbGYuaCIKdHlw
ZWRlZiBzdHJ1Y3QgZWxmMzJfbm90ZSB7CiAgRWxmMzJfV29yZCBuX25hbWVzejsKICBFbGYz
Ml9Xb3JkIG5fZGVzY3N6OwogIEVsZjMyX1dvcmQgbl90eXBlOwp9IEVsZjMyX05oZHI7CgoK
dHlwZWRlZiBzdHJ1Y3QgZWxmNjRfbm90ZSB7CiAgRWxmNjRfV29yZCBuX25hbWVzejsKICBF
bGY2NF9Xb3JkIG5fZGVzY3N6OwogIEVsZjY0X1dvcmQgbl90eXBlOwp9IEVsZjY0X05oZHI7
CiMgOCAiLi9pbmNsdWRlL2xpbnV4L2VsZi5oIiAyCiMgNDIgIi4vaW5jbHVkZS9saW51eC9l
bGYuaCIKZXh0ZXJuIEVsZjY0X0R5biBfRFlOQU1JQyBbXTsKIyA1NSAiLi9pbmNsdWRlL2xp
bnV4L2VsZi5oIgpzdHJ1Y3QgZmlsZTsKc3RydWN0IGNvcmVkdW1wX3BhcmFtczsKCgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgaW50IGVsZl9jb3JlZHVtcF9leHRyYV9ub3Rlc19zaXplKHZvaWQpIHsgcmV0dXJu
IDA7IH0Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIGludCBlbGZfY29yZWR1bXBfZXh0cmFfbm90ZXNfd3JpdGUoc3Ry
dWN0IGNvcmVkdW1wX3BhcmFtcyAqY3BybSkgeyByZXR1cm4gMDsgfQojIDcxICIuL2luY2x1
ZGUvbGludXgvZWxmLmgiCnN0cnVjdCBnbnVfcHJvcGVydHkgewogdTMyIHByX3R5cGU7CiB1
MzIgcHJfZGF0YXN6Owp9OwoKc3RydWN0IGFyY2hfZWxmX3N0YXRlOwoKCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBp
bnQgYXJjaF9wYXJzZV9lbGZfcHJvcGVydHkodTMyIHR5cGUsIGNvbnN0IHZvaWQgKmRhdGEs
CiAgICAgICBzaXplX3QgZGF0YXN6LCBib29sIGNvbXBhdCwKICAgICAgIHN0cnVjdCBhcmNo
X2VsZl9zdGF0ZSAqYXJjaCkKewogcmV0dXJuIDA7Cn0KIyA5NCAiLi9pbmNsdWRlL2xpbnV4
L2VsZi5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgaW50IGFyY2hfZWxmX2FkanVzdF9wcm90KGludCBwcm90LAog
ICAgICAgICAgIGNvbnN0IHN0cnVjdCBhcmNoX2VsZl9zdGF0ZSAqc3RhdGUsCiAgICAgICAg
ICAgYm9vbCBoYXNfaW50ZXJwLCBib29sIGlzX2ludGVycCkKewogcmV0dXJuIHByb3Q7Cn0K
IyAyMyAiYXJjaC9wb3dlcnBjL2tlcm5lbC9zaWduYWxfMzIuYyIgMgojIDEgIi4vaW5jbHVk
ZS9saW51eC9wdHJhY2UuaCIgMQojIDEwICIuL2luY2x1ZGUvbGludXgvcHRyYWNlLmgiCiMg
MSAiLi9pbmNsdWRlL2xpbnV4L3BpZF9uYW1lc3BhY2UuaCIgMQojIDEwICIuL2luY2x1ZGUv
bGludXgvcGlkX25hbWVzcGFjZS5oIgojIDEgIi4vaW5jbHVkZS9saW51eC9uc3Byb3h5Lmgi
IDEKCgoKCgoKCnN0cnVjdCBtbnRfbmFtZXNwYWNlOwpzdHJ1Y3QgdXRzX25hbWVzcGFjZTsK
c3RydWN0IGlwY19uYW1lc3BhY2U7CnN0cnVjdCBwaWRfbmFtZXNwYWNlOwpzdHJ1Y3QgY2dy
b3VwX25hbWVzcGFjZTsKc3RydWN0IGZzX3N0cnVjdDsKIyAzMSAiLi9pbmNsdWRlL2xpbnV4
L25zcHJveHkuaCIKc3RydWN0IG5zcHJveHkgewogYXRvbWljX3QgY291bnQ7CiBzdHJ1Y3Qg
dXRzX25hbWVzcGFjZSAqdXRzX25zOwogc3RydWN0IGlwY19uYW1lc3BhY2UgKmlwY19uczsK
IHN0cnVjdCBtbnRfbmFtZXNwYWNlICptbnRfbnM7CiBzdHJ1Y3QgcGlkX25hbWVzcGFjZSAq
cGlkX25zX2Zvcl9jaGlsZHJlbjsKIHN0cnVjdCBuZXQgKm5ldF9uczsKIHN0cnVjdCB0aW1l
X25hbWVzcGFjZSAqdGltZV9uczsKIHN0cnVjdCB0aW1lX25hbWVzcGFjZSAqdGltZV9uc19m
b3JfY2hpbGRyZW47CiBzdHJ1Y3QgY2dyb3VwX25hbWVzcGFjZSAqY2dyb3VwX25zOwp9Owpl
eHRlcm4gc3RydWN0IG5zcHJveHkgaW5pdF9uc3Byb3h5OwojIDUzICIuL2luY2x1ZGUvbGlu
dXgvbnNwcm94eS5oIgpzdHJ1Y3QgbnNzZXQgewogdW5zaWduZWQgZmxhZ3M7CiBzdHJ1Y3Qg
bnNwcm94eSAqbnNwcm94eTsKIHN0cnVjdCBmc19zdHJ1Y3QgKmZzOwogY29uc3Qgc3RydWN0
IGNyZWQgKmNyZWQ7Cn07CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IGNyZWQgKm5zc2V0X2NyZWQoc3Ry
dWN0IG5zc2V0ICpzZXQpCnsKIGlmIChzZXQtPmZsYWdzICYgMHgxMDAwMDAwMCkKICByZXR1
cm4gKHN0cnVjdCBjcmVkICopc2V0LT5jcmVkOwoKIHJldHVybiAoKHZvaWQgKikwKTsKfQoj
IDk0ICIuL2luY2x1ZGUvbGludXgvbnNwcm94eS5oIgppbnQgY29weV9uYW1lc3BhY2VzKHVu
c2lnbmVkIGxvbmcgZmxhZ3MsIHN0cnVjdCB0YXNrX3N0cnVjdCAqdHNrKTsKdm9pZCBleGl0
X3Rhc2tfbmFtZXNwYWNlcyhzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRzayk7CnZvaWQgc3dpdGNo
X3Rhc2tfbmFtZXNwYWNlcyhzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRzaywgc3RydWN0IG5zcHJv
eHkgKm5ldyk7CnZvaWQgZnJlZV9uc3Byb3h5KHN0cnVjdCBuc3Byb3h5ICpucyk7CmludCB1
bnNoYXJlX25zcHJveHlfbmFtZXNwYWNlcyh1bnNpZ25lZCBsb25nLCBzdHJ1Y3QgbnNwcm94
eSAqKiwKIHN0cnVjdCBjcmVkICosIHN0cnVjdCBmc19zdHJ1Y3QgKik7CmludCBfX2F0dHJp
YnV0ZV9fKChfX3NlY3Rpb25fXygiLmluaXQudGV4dCIpKSkgX19hdHRyaWJ1dGVfXygoX19j
b2xkX18pKSBuc3Byb3h5X2NhY2hlX2luaXQodm9pZCk7CgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBwdXRf
bnNwcm94eShzdHJ1Y3QgbnNwcm94eSAqbnMpCnsKIGlmIChhdG9taWNfZGVjX2FuZF90ZXN0
KCZucy0+Y291bnQpKSB7CiAgZnJlZV9uc3Byb3h5KG5zKTsKIH0KfQoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZv
aWQgZ2V0X25zcHJveHkoc3RydWN0IG5zcHJveHkgKm5zKQp7CiBhdG9taWNfaW5jKCZucy0+
Y291bnQpOwp9CiMgMTEgIi4vaW5jbHVkZS9saW51eC9waWRfbmFtZXNwYWNlLmgiIDIKIyAx
ICIuL2luY2x1ZGUvbGludXgva3JlZi5oIiAxCiMgMTkgIi4vaW5jbHVkZS9saW51eC9rcmVm
LmgiCnN0cnVjdCBrcmVmIHsKIHJlZmNvdW50X3QgcmVmY291bnQ7Cn07CgoKCgoKCgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgdm9pZCBrcmVmX2luaXQoc3RydWN0IGtyZWYgKmtyZWYpCnsKIHJlZmNvdW50X3Nl
dCgma3JlZi0+cmVmY291bnQsIDEpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgaW50IGtyZWZf
cmVhZChjb25zdCBzdHJ1Y3Qga3JlZiAqa3JlZikKewogcmV0dXJuIHJlZmNvdW50X3JlYWQo
JmtyZWYtPnJlZmNvdW50KTsKfQoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGtyZWZfZ2V0KHN0cnVj
dCBrcmVmICprcmVmKQp7CiByZWZjb3VudF9pbmMoJmtyZWYtPnJlZmNvdW50KTsKfQojIDYy
ICIuL2luY2x1ZGUvbGludXgva3JlZi5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGtyZWZfcHV0KHN0cnVj
dCBrcmVmICprcmVmLCB2b2lkICgqcmVsZWFzZSkoc3RydWN0IGtyZWYgKmtyZWYpKQp7CiBp
ZiAocmVmY291bnRfZGVjX2FuZF90ZXN0KCZrcmVmLT5yZWZjb3VudCkpIHsKICByZWxlYXNl
KGtyZWYpOwogIHJldHVybiAxOwogfQogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQga3Jl
Zl9wdXRfbXV0ZXgoc3RydWN0IGtyZWYgKmtyZWYsCiAgICAgdm9pZCAoKnJlbGVhc2UpKHN0
cnVjdCBrcmVmICprcmVmKSwKICAgICBzdHJ1Y3QgbXV0ZXggKmxvY2spCnsKIGlmIChyZWZj
b3VudF9kZWNfYW5kX211dGV4X2xvY2soJmtyZWYtPnJlZmNvdW50LCBsb2NrKSkgewogIHJl
bGVhc2Uoa3JlZik7CiAgcmV0dXJuIDE7CiB9CiByZXR1cm4gMDsKfQoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGlu
dCBrcmVmX3B1dF9sb2NrKHN0cnVjdCBrcmVmICprcmVmLAogICAgdm9pZCAoKnJlbGVhc2Up
KHN0cnVjdCBrcmVmICprcmVmKSwKICAgIHNwaW5sb2NrX3QgKmxvY2spCnsKIGlmIChyZWZj
b3VudF9kZWNfYW5kX2xvY2soJmtyZWYtPnJlZmNvdW50LCBsb2NrKSkgewogIHJlbGVhc2Uo
a3JlZik7CiAgcmV0dXJuIDE7CiB9CiByZXR1cm4gMDsKfQojIDEwOSAiLi9pbmNsdWRlL2xp
bnV4L2tyZWYuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBfX2F0dHJpYnV0ZV9fKChfX3dhcm5fdW51c2Vk
X3Jlc3VsdF9fKSkga3JlZl9nZXRfdW5sZXNzX3plcm8oc3RydWN0IGtyZWYgKmtyZWYpCnsK
IHJldHVybiByZWZjb3VudF9pbmNfbm90X3plcm8oJmtyZWYtPnJlZmNvdW50KTsKfQojIDEy
ICIuL2luY2x1ZGUvbGludXgvcGlkX25hbWVzcGFjZS5oIiAyCiMgMSAiLi9pbmNsdWRlL2xp
bnV4L25zX2NvbW1vbi5oIiAxCgoKCgpzdHJ1Y3QgcHJvY19uc19vcGVyYXRpb25zOwoKc3Ry
dWN0IG5zX2NvbW1vbiB7CiBhdG9taWNfbG9uZ190IHN0YXNoZWQ7CiBjb25zdCBzdHJ1Y3Qg
cHJvY19uc19vcGVyYXRpb25zICpvcHM7CiB1bnNpZ25lZCBpbnQgaW51bTsKfTsKIyAxMyAi
Li9pbmNsdWRlL2xpbnV4L3BpZF9uYW1lc3BhY2UuaCIgMgojIDEgIi4vaW5jbHVkZS9saW51
eC9pZHIuaCIgMQojIDE5ICIuL2luY2x1ZGUvbGludXgvaWRyLmgiCnN0cnVjdCBpZHIgewog
c3RydWN0IHhhcnJheSBpZHJfcnQ7CiB1bnNpZ25lZCBpbnQgaWRyX2Jhc2U7CiB1bnNpZ25l
ZCBpbnQgaWRyX25leHQ7Cn07CiMgNjYgIi4vaW5jbHVkZS9saW51eC9pZHIuaCIKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIHVuc2lnbmVkIGludCBpZHJfZ2V0X2N1cnNvcihjb25zdCBzdHJ1Y3QgaWRyICppZHIp
CnsKIHJldHVybiAoeyBkbyB7IGV4dGVybiB2b2lkIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzE3
OSh2b2lkKSBfX2F0dHJpYnV0ZV9fKChfX2Vycm9yX18oIlVuc3VwcG9ydGVkIGFjY2VzcyBz
aXplIGZvciB7UkVBRCxXUklURX1fT05DRSgpLiIpKSk7IGlmICghKChzaXplb2YoaWRyLT5p
ZHJfbmV4dCkgPT0gc2l6ZW9mKGNoYXIpIHx8IHNpemVvZihpZHItPmlkcl9uZXh0KSA9PSBz
aXplb2Yoc2hvcnQpIHx8IHNpemVvZihpZHItPmlkcl9uZXh0KSA9PSBzaXplb2YoaW50KSB8
fCBzaXplb2YoaWRyLT5pZHJfbmV4dCkgPT0gc2l6ZW9mKGxvbmcpKSB8fCBzaXplb2YoaWRy
LT5pZHJfbmV4dCkgPT0gc2l6ZW9mKGxvbmcgbG9uZykpKSBfX2NvbXBpbGV0aW1lX2Fzc2Vy
dF8xNzkoKTsgfSB3aGlsZSAoMCk7ICh7IHR5cGVvZiggX0dlbmVyaWMoKGlkci0+aWRyX25l
eHQpLCBjaGFyOiAoY2hhcikwLCB1bnNpZ25lZCBjaGFyOiAodW5zaWduZWQgY2hhcikwLCBz
aWduZWQgY2hhcjogKHNpZ25lZCBjaGFyKTAsIHVuc2lnbmVkIHNob3J0OiAodW5zaWduZWQg
c2hvcnQpMCwgc2lnbmVkIHNob3J0OiAoc2lnbmVkIHNob3J0KTAsIHVuc2lnbmVkIGludDog
KHVuc2lnbmVkIGludCkwLCBzaWduZWQgaW50OiAoc2lnbmVkIGludCkwLCB1bnNpZ25lZCBs
b25nOiAodW5zaWduZWQgbG9uZykwLCBzaWduZWQgbG9uZzogKHNpZ25lZCBsb25nKTAsIHVu
c2lnbmVkIGxvbmcgbG9uZzogKHVuc2lnbmVkIGxvbmcgbG9uZykwLCBzaWduZWQgbG9uZyBs
b25nOiAoc2lnbmVkIGxvbmcgbG9uZykwLCBkZWZhdWx0OiAoaWRyLT5pZHJfbmV4dCkpKSBf
X3ggPSAoKihjb25zdCB2b2xhdGlsZSB0eXBlb2YoIF9HZW5lcmljKChpZHItPmlkcl9uZXh0
KSwgY2hhcjogKGNoYXIpMCwgdW5zaWduZWQgY2hhcjogKHVuc2lnbmVkIGNoYXIpMCwgc2ln
bmVkIGNoYXI6IChzaWduZWQgY2hhcikwLCB1bnNpZ25lZCBzaG9ydDogKHVuc2lnbmVkIHNo
b3J0KTAsIHNpZ25lZCBzaG9ydDogKHNpZ25lZCBzaG9ydCkwLCB1bnNpZ25lZCBpbnQ6ICh1
bnNpZ25lZCBpbnQpMCwgc2lnbmVkIGludDogKHNpZ25lZCBpbnQpMCwgdW5zaWduZWQgbG9u
ZzogKHVuc2lnbmVkIGxvbmcpMCwgc2lnbmVkIGxvbmc6IChzaWduZWQgbG9uZykwLCB1bnNp
Z25lZCBsb25nIGxvbmc6ICh1bnNpZ25lZCBsb25nIGxvbmcpMCwgc2lnbmVkIGxvbmcgbG9u
ZzogKHNpZ25lZCBsb25nIGxvbmcpMCwgZGVmYXVsdDogKGlkci0+aWRyX25leHQpKSkgKikm
KGlkci0+aWRyX25leHQpKTsgZG8geyB9IHdoaWxlICgwKTsgKHR5cGVvZihpZHItPmlkcl9u
ZXh0KSlfX3g7IH0pOyB9KTsKfQojIDc5ICIuL2luY2x1ZGUvbGludXgvaWRyLmgiCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSB2b2lkIGlkcl9zZXRfY3Vyc29yKHN0cnVjdCBpZHIgKmlkciwgdW5zaWduZWQgaW50
IHZhbCkKewogZG8geyBkbyB7IGV4dGVybiB2b2lkIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzE4
MCh2b2lkKSBfX2F0dHJpYnV0ZV9fKChfX2Vycm9yX18oIlVuc3VwcG9ydGVkIGFjY2VzcyBz
aXplIGZvciB7UkVBRCxXUklURX1fT05DRSgpLiIpKSk7IGlmICghKChzaXplb2YoaWRyLT5p
ZHJfbmV4dCkgPT0gc2l6ZW9mKGNoYXIpIHx8IHNpemVvZihpZHItPmlkcl9uZXh0KSA9PSBz
aXplb2Yoc2hvcnQpIHx8IHNpemVvZihpZHItPmlkcl9uZXh0KSA9PSBzaXplb2YoaW50KSB8
fCBzaXplb2YoaWRyLT5pZHJfbmV4dCkgPT0gc2l6ZW9mKGxvbmcpKSB8fCBzaXplb2YoaWRy
LT5pZHJfbmV4dCkgPT0gc2l6ZW9mKGxvbmcgbG9uZykpKSBfX2NvbXBpbGV0aW1lX2Fzc2Vy
dF8xODAoKTsgfSB3aGlsZSAoMCk7IGRvIHsgKih2b2xhdGlsZSB0eXBlb2YoaWRyLT5pZHJf
bmV4dCkgKikmKGlkci0+aWRyX25leHQpID0gKHZhbCk7IH0gd2hpbGUgKDApOyB9IHdoaWxl
ICgwKTsKfQojIDExMiAiLi9pbmNsdWRlL2xpbnV4L2lkci5oIgp2b2lkIGlkcl9wcmVsb2Fk
KGdmcF90IGdmcF9tYXNrKTsKCmludCBpZHJfYWxsb2Moc3RydWN0IGlkciAqLCB2b2lkICpw
dHIsIGludCBzdGFydCwgaW50IGVuZCwgZ2ZwX3QpOwppbnQgX19hdHRyaWJ1dGVfXygoX193
YXJuX3VudXNlZF9yZXN1bHRfXykpIGlkcl9hbGxvY191MzIoc3RydWN0IGlkciAqLCB2b2lk
ICpwdHIsIHUzMiAqaWQsCiAgICB1bnNpZ25lZCBsb25nIG1heCwgZ2ZwX3QpOwppbnQgaWRy
X2FsbG9jX2N5Y2xpYyhzdHJ1Y3QgaWRyICosIHZvaWQgKnB0ciwgaW50IHN0YXJ0LCBpbnQg
ZW5kLCBnZnBfdCk7CnZvaWQgKmlkcl9yZW1vdmUoc3RydWN0IGlkciAqLCB1bnNpZ25lZCBs
b25nIGlkKTsKdm9pZCAqaWRyX2ZpbmQoY29uc3Qgc3RydWN0IGlkciAqLCB1bnNpZ25lZCBs
b25nIGlkKTsKaW50IGlkcl9mb3JfZWFjaChjb25zdCBzdHJ1Y3QgaWRyICosCiAgIGludCAo
KmZuKShpbnQgaWQsIHZvaWQgKnAsIHZvaWQgKmRhdGEpLCB2b2lkICpkYXRhKTsKdm9pZCAq
aWRyX2dldF9uZXh0KHN0cnVjdCBpZHIgKiwgaW50ICpuZXh0aWQpOwp2b2lkICppZHJfZ2V0
X25leHRfdWwoc3RydWN0IGlkciAqLCB1bnNpZ25lZCBsb25nICpuZXh0aWQpOwp2b2lkICpp
ZHJfcmVwbGFjZShzdHJ1Y3QgaWRyICosIHZvaWQgKiwgdW5zaWduZWQgbG9uZyBpZCk7CnZv
aWQgaWRyX2Rlc3Ryb3koc3RydWN0IGlkciAqKTsKIyAxMzUgIi4vaW5jbHVkZS9saW51eC9p
ZHIuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIHZvaWQgaWRyX2luaXRfYmFzZShzdHJ1Y3QgaWRyICppZHIsIGlu
dCBiYXNlKQp7CiB4YV9pbml0X2ZsYWdzKCZpZHItPmlkcl9ydCwgKCgoIGdmcF90KTQpIHwg
KCBnZnBfdCkgKDEgPDwgKCgoMjMgKyAwKSkgKyAwKSkpKTsKIGlkci0+aWRyX2Jhc2UgPSBi
YXNlOwogaWRyLT5pZHJfbmV4dCA9IDA7Cn0KIyAxNDkgIi4vaW5jbHVkZS9saW51eC9pZHIu
aCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIHZvaWQgaWRyX2luaXQoc3RydWN0IGlkciAqaWRyKQp7CiBpZHJfaW5p
dF9iYXNlKGlkciwgMCk7Cn0KCgoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIGlkcl9pc19lbXB0eShj
b25zdCBzdHJ1Y3QgaWRyICppZHIpCnsKIHJldHVybiByYWRpeF90cmVlX2VtcHR5KCZpZHIt
Pmlkcl9ydCkgJiYKICByYWRpeF90cmVlX3RhZ2dlZCgmaWRyLT5pZHJfcnQsIDApOwp9CgoK
CgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgdm9pZCBpZHJfcHJlbG9hZF9lbmQodm9pZCkKewogZG8geyBsb2Nh
bF9sb2NrX3JlbGVhc2UoKHsgZG8geyBjb25zdCB2b2lkICpfX3ZwcF92ZXJpZnkgPSAodHlw
ZW9mKCgmcmFkaXhfdHJlZV9wcmVsb2Fkcy5sb2NrKSArIDApKSgodm9pZCAqKTApOyAodm9p
ZClfX3ZwcF92ZXJpZnk7IH0gd2hpbGUgKDApOyAoeyB1bnNpZ25lZCBsb25nIF9fcHRyOyBf
X2FzbV9fICgiIiA6ICI9ciIoX19wdHIpIDogIjAiKCh0eXBlb2YoKigmcmFkaXhfdHJlZV9w
cmVsb2Fkcy5sb2NrKSkgKikoJnJhZGl4X3RyZWVfcHJlbG9hZHMubG9jaykpKTsgKHR5cGVv
ZigodHlwZW9mKCooJnJhZGl4X3RyZWVfcHJlbG9hZHMubG9jaykpICopKCZyYWRpeF90cmVl
X3ByZWxvYWRzLmxvY2spKSkgKF9fcHRyICsgKChsb2NhbF9wYWNhLT5kYXRhX29mZnNldCkp
KTsgfSk7IH0pKTsgX19hc21fXyBfX3ZvbGF0aWxlX18oIiI6IDogOiJtZW1vcnkiKTsgfSB3
aGlsZSAoMCk7Cn0KIyAyNDAgIi4vaW5jbHVkZS9saW51eC9pZHIuaCIKc3RydWN0IGlkYV9i
aXRtYXAgewogdW5zaWduZWQgbG9uZyBiaXRtYXBbKDEyOCAvIHNpemVvZihsb25nKSldOwp9
OwoKc3RydWN0IGlkYSB7CiBzdHJ1Y3QgeGFycmF5IHhhOwp9OwojIDI1NSAiLi9pbmNsdWRl
L2xpbnV4L2lkci5oIgppbnQgaWRhX2FsbG9jX3JhbmdlKHN0cnVjdCBpZGEgKiwgdW5zaWdu
ZWQgaW50IG1pbiwgdW5zaWduZWQgaW50IG1heCwgZ2ZwX3QpOwp2b2lkIGlkYV9mcmVlKHN0
cnVjdCBpZGEgKiwgdW5zaWduZWQgaW50IGlkKTsKdm9pZCBpZGFfZGVzdHJveShzdHJ1Y3Qg
aWRhICppZGEpOwojIDI3MCAiLi9pbmNsdWRlL2xpbnV4L2lkci5oIgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50
IGlkYV9hbGxvYyhzdHJ1Y3QgaWRhICppZGEsIGdmcF90IGdmcCkKewogcmV0dXJuIGlkYV9h
bGxvY19yYW5nZShpZGEsIDAsIH4wLCBnZnApOwp9CiMgMjg3ICIuL2luY2x1ZGUvbGludXgv
aWRyLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSBpbnQgaWRhX2FsbG9jX21pbihzdHJ1Y3QgaWRhICppZGEsIHVu
c2lnbmVkIGludCBtaW4sIGdmcF90IGdmcCkKewogcmV0dXJuIGlkYV9hbGxvY19yYW5nZShp
ZGEsIG1pbiwgfjAsIGdmcCk7Cn0KIyAzMDQgIi4vaW5jbHVkZS9saW51eC9pZHIuaCIKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIGludCBpZGFfYWxsb2NfbWF4KHN0cnVjdCBpZGEgKmlkYSwgdW5zaWduZWQgaW50
IG1heCwgZ2ZwX3QgZ2ZwKQp7CiByZXR1cm4gaWRhX2FsbG9jX3JhbmdlKGlkYSwgMCwgbWF4
LCBnZnApOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBpZGFfaW5pdChzdHJ1Y3QgaWRhICppZGEpCnsK
IHhhX2luaXRfZmxhZ3MoJmlkYS0+eGEsICgoKCBnZnBfdClYQV9MT0NLX0lSUSkgfCAoKCgg
Z2ZwX3QpNFUpIHwgKCggZ2ZwX3QpKCgxVSA8PCAoMjMgKyAwKSkgPDwgKCB1bnNpZ25lZCko
KCggeGFfbWFya190KTBVKSkpKSkpKTsKfQoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIGlkYV9pc19l
bXB0eShjb25zdCBzdHJ1Y3QgaWRhICppZGEpCnsKIHJldHVybiB4YV9lbXB0eSgmaWRhLT54
YSk7Cn0KIyAxNCAiLi9pbmNsdWRlL2xpbnV4L3BpZF9uYW1lc3BhY2UuaCIgMgoKCgoKc3Ry
dWN0IGZzX3BpbjsKCnN0cnVjdCBwaWRfbmFtZXNwYWNlIHsKIHN0cnVjdCBrcmVmIGtyZWY7
CiBzdHJ1Y3QgaWRyIGlkcjsKIHN0cnVjdCBjYWxsYmFja19oZWFkIHJjdTsKIHVuc2lnbmVk
IGludCBwaWRfYWxsb2NhdGVkOwogc3RydWN0IHRhc2tfc3RydWN0ICpjaGlsZF9yZWFwZXI7
CiBzdHJ1Y3Qga21lbV9jYWNoZSAqcGlkX2NhY2hlcDsKIHVuc2lnbmVkIGludCBsZXZlbDsK
IHN0cnVjdCBwaWRfbmFtZXNwYWNlICpwYXJlbnQ7Cgogc3RydWN0IGZzX3BpbiAqYmFjY3Q7
Cgogc3RydWN0IHVzZXJfbmFtZXNwYWNlICp1c2VyX25zOwogc3RydWN0IHVjb3VudHMgKnVj
b3VudHM7CiBpbnQgcmVib290Owogc3RydWN0IG5zX2NvbW1vbiBuczsKfSA7CgpleHRlcm4g
c3RydWN0IHBpZF9uYW1lc3BhY2UgaW5pdF9waWRfbnM7CiMgNTkgIi4vaW5jbHVkZS9saW51
eC9waWRfbmFtZXNwYWNlLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3QgcGlkX25hbWVzcGFjZSAqZ2V0
X3BpZF9ucyhzdHJ1Y3QgcGlkX25hbWVzcGFjZSAqbnMpCnsKIHJldHVybiBuczsKfQoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIHN0cnVjdCBwaWRfbmFtZXNwYWNlICpjb3B5X3BpZF9ucyh1bnNpZ25lZCBsb25n
IGZsYWdzLAogc3RydWN0IHVzZXJfbmFtZXNwYWNlICp1c2VyX25zLCBzdHJ1Y3QgcGlkX25h
bWVzcGFjZSAqbnMpCnsKIGlmIChmbGFncyAmIDB4MjAwMDAwMDApCiAgbnMgPSBFUlJfUFRS
KC0yMik7CiByZXR1cm4gbnM7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHB1dF9waWRfbnMoc3RydWN0
IHBpZF9uYW1lc3BhY2UgKm5zKQp7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHphcF9waWRfbnNfcHJv
Y2Vzc2VzKHN0cnVjdCBwaWRfbmFtZXNwYWNlICpucykKewogZG8geyBfX2FzbV9fIF9fdm9s
YXRpbGVfXyggIjE6CSIgInR3aSAzMSwgMCwgMCIgIlxuIiAiLnNlY3Rpb24gX19idWdfdGFi
bGUsXCJhd1wiXG4iICIyOlx0IiAiLjhieXRlIiAiICIgIjFiLCAlMFxuIiAiXHQuc2hvcnQg
JTEsICUyXG4iICIub3JnIDJiKyUzXG4iICIucHJldmlvdXNcbiIgOiA6ICJpIiAoIi4vaW5j
bHVkZS9saW51eC9waWRfbmFtZXNwYWNlLmgiKSwgImkiICg3OCksICJpIiAoMCksICJpIiAo
c2l6ZW9mKHN0cnVjdCBidWdfZW50cnkpKSk7IGRvIHsgOyBhc20gdm9sYXRpbGUoIiIpOyBf
X2J1aWx0aW5fdW5yZWFjaGFibGUoKTsgfSB3aGlsZSAoMCk7IH0gd2hpbGUgKDApOwp9Cgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgaW50IHJlYm9vdF9waWRfbnMoc3RydWN0IHBpZF9uYW1lc3BhY2UgKnBpZF9u
cywgaW50IGNtZCkKewogcmV0dXJuIDA7Cn0KCgpleHRlcm4gc3RydWN0IHBpZF9uYW1lc3Bh
Y2UgKnRhc2tfYWN0aXZlX3BpZF9ucyhzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRzayk7CnZvaWQg
cGlkaGFzaF9pbml0KHZvaWQpOwp2b2lkIHBpZF9pZHJfaW5pdCh2b2lkKTsKIyAxMSAiLi9p
bmNsdWRlL2xpbnV4L3B0cmFjZS5oIiAyCiMgMSAiLi9pbmNsdWRlL3VhcGkvbGludXgvcHRy
YWNlLmgiIDEKIyA1OSAiLi9pbmNsdWRlL3VhcGkvbGludXgvcHRyYWNlLmgiCnN0cnVjdCBw
dHJhY2VfcGVla3NpZ2luZm9fYXJncyB7CiBfX3U2NCBvZmY7CiBfX3UzMiBmbGFnczsKIF9f
czMyIG5yOwp9OwoKCgoKCgoKc3RydWN0IHNlY2NvbXBfbWV0YWRhdGEgewogX191NjQgZmls
dGVyX29mZjsKIF9fdTY0IGZsYWdzOwp9OwoKCgoKCgoKc3RydWN0IHB0cmFjZV9zeXNjYWxs
X2luZm8gewogX191OCBvcDsKIF9fdTMyIGFyY2ggX19hdHRyaWJ1dGVfXygoX19hbGlnbmVk
X18oc2l6ZW9mKF9fdTMyKSkpKTsKIF9fdTY0IGluc3RydWN0aW9uX3BvaW50ZXI7CiBfX3U2
NCBzdGFja19wb2ludGVyOwogdW5pb24gewogIHN0cnVjdCB7CiAgIF9fdTY0IG5yOwogICBf
X3U2NCBhcmdzWzZdOwogIH0gZW50cnk7CiAgc3RydWN0IHsKICAgX19zNjQgcnZhbDsKICAg
X191OCBpc19lcnJvcjsKICB9IGV4aXQ7CiAgc3RydWN0IHsKICAgX191NjQgbnI7CiAgIF9f
dTY0IGFyZ3NbNl07CiAgIF9fdTMyIHJldF9kYXRhOwogIH0gc2VjY29tcDsKIH07Cn07CiMg
MTIgIi4vaW5jbHVkZS9saW51eC9wdHJhY2UuaCIgMgoKCgpzdHJ1Y3Qgc3lzY2FsbF9pbmZv
IHsKIF9fdTY0IHNwOwogc3RydWN0IHNlY2NvbXBfZGF0YSBkYXRhOwp9OwoKZXh0ZXJuIGlu
dCBwdHJhY2VfYWNjZXNzX3ZtKHN0cnVjdCB0YXNrX3N0cnVjdCAqdHNrLCB1bnNpZ25lZCBs
b25nIGFkZHIsCiAgICAgICB2b2lkICpidWYsIGludCBsZW4sIHVuc2lnbmVkIGludCBndXBf
ZmxhZ3MpOwojIDU2ICIuL2luY2x1ZGUvbGludXgvcHRyYWNlLmgiCmV4dGVybiBsb25nIGFy
Y2hfcHRyYWNlKHN0cnVjdCB0YXNrX3N0cnVjdCAqY2hpbGQsIGxvbmcgcmVxdWVzdCwKICAg
dW5zaWduZWQgbG9uZyBhZGRyLCB1bnNpZ25lZCBsb25nIGRhdGEpOwpleHRlcm4gaW50IHB0
cmFjZV9yZWFkZGF0YShzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRzaywgdW5zaWduZWQgbG9uZyBz
cmMsIGNoYXIgKmRzdCwgaW50IGxlbik7CmV4dGVybiBpbnQgcHRyYWNlX3dyaXRlZGF0YShz
dHJ1Y3QgdGFza19zdHJ1Y3QgKnRzaywgY2hhciAqc3JjLCB1bnNpZ25lZCBsb25nIGRzdCwg
aW50IGxlbik7CmV4dGVybiB2b2lkIHB0cmFjZV9kaXNhYmxlKHN0cnVjdCB0YXNrX3N0cnVj
dCAqKTsKZXh0ZXJuIGludCBwdHJhY2VfcmVxdWVzdChzdHJ1Y3QgdGFza19zdHJ1Y3QgKmNo
aWxkLCBsb25nIHJlcXVlc3QsCiAgICAgdW5zaWduZWQgbG9uZyBhZGRyLCB1bnNpZ25lZCBs
b25nIGRhdGEpOwpleHRlcm4gdm9pZCBwdHJhY2Vfbm90aWZ5KGludCBleGl0X2NvZGUpOwpl
eHRlcm4gdm9pZCBfX3B0cmFjZV9saW5rKHN0cnVjdCB0YXNrX3N0cnVjdCAqY2hpbGQsCiAg
ICAgc3RydWN0IHRhc2tfc3RydWN0ICpuZXdfcGFyZW50LAogICAgIGNvbnN0IHN0cnVjdCBj
cmVkICpwdHJhY2VyX2NyZWQpOwpleHRlcm4gdm9pZCBfX3B0cmFjZV91bmxpbmsoc3RydWN0
IHRhc2tfc3RydWN0ICpjaGlsZCk7CmV4dGVybiB2b2lkIGV4aXRfcHRyYWNlKHN0cnVjdCB0
YXNrX3N0cnVjdCAqdHJhY2VyLCBzdHJ1Y3QgbGlzdF9oZWFkICpkZWFkKTsKIyA5NSAiLi9p
bmNsdWRlL2xpbnV4L3B0cmFjZS5oIgpleHRlcm4gYm9vbCBwdHJhY2VfbWF5X2FjY2Vzcyhz
dHJ1Y3QgdGFza19zdHJ1Y3QgKnRhc2ssIHVuc2lnbmVkIGludCBtb2RlKTsKCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBpbnQgcHRyYWNlX3JlcGFyZW50ZWQoc3RydWN0IHRhc2tfc3RydWN0ICpjaGlsZCkKewog
cmV0dXJuICFzYW1lX3RocmVhZF9ncm91cChjaGlsZC0+cmVhbF9wYXJlbnQsIGNoaWxkLT5w
YXJlbnQpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBwdHJhY2VfdW5saW5rKHN0cnVjdCB0YXNrX3N0
cnVjdCAqY2hpbGQpCnsKIGlmIChfX2J1aWx0aW5fZXhwZWN0KCEhKGNoaWxkLT5wdHJhY2Up
LCAwKSkKICBfX3B0cmFjZV91bmxpbmsoY2hpbGQpOwp9CgppbnQgZ2VuZXJpY19wdHJhY2Vf
cGVla2RhdGEoc3RydWN0IHRhc2tfc3RydWN0ICp0c2ssIHVuc2lnbmVkIGxvbmcgYWRkciwK
ICAgICAgIHVuc2lnbmVkIGxvbmcgZGF0YSk7CmludCBnZW5lcmljX3B0cmFjZV9wb2tlZGF0
YShzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRzaywgdW5zaWduZWQgbG9uZyBhZGRyLAogICAgICAg
dW5zaWduZWQgbG9uZyBkYXRhKTsKIyAxMjQgIi4vaW5jbHVkZS9saW51eC9wdHJhY2UuaCIK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIHN0cnVjdCB0YXNrX3N0cnVjdCAqcHRyYWNlX3BhcmVudChzdHJ1Y3QgdGFz
a19zdHJ1Y3QgKnRhc2spCnsKIGlmIChfX2J1aWx0aW5fZXhwZWN0KCEhKHRhc2stPnB0cmFj
ZSksIDApKQogIHJldHVybiAoeyB0eXBlb2YoKih0YXNrLT5wYXJlbnQpKSAqX19fX19fX19w
MSA9ICh0eXBlb2YoKih0YXNrLT5wYXJlbnQpKSAqKSh7IGRvIHsgZXh0ZXJuIHZvaWQgX19j
b21waWxldGltZV9hc3NlcnRfMTgxKHZvaWQpIF9fYXR0cmlidXRlX18oKF9fZXJyb3JfXygi
VW5zdXBwb3J0ZWQgYWNjZXNzIHNpemUgZm9yIHtSRUFELFdSSVRFfV9PTkNFKCkuIikpKTsg
aWYgKCEoKHNpemVvZigodGFzay0+cGFyZW50KSkgPT0gc2l6ZW9mKGNoYXIpIHx8IHNpemVv
ZigodGFzay0+cGFyZW50KSkgPT0gc2l6ZW9mKHNob3J0KSB8fCBzaXplb2YoKHRhc2stPnBh
cmVudCkpID09IHNpemVvZihpbnQpIHx8IHNpemVvZigodGFzay0+cGFyZW50KSkgPT0gc2l6
ZW9mKGxvbmcpKSB8fCBzaXplb2YoKHRhc2stPnBhcmVudCkpID09IHNpemVvZihsb25nIGxv
bmcpKSkgX19jb21waWxldGltZV9hc3NlcnRfMTgxKCk7IH0gd2hpbGUgKDApOyAoeyB0eXBl
b2YoIF9HZW5lcmljKCgodGFzay0+cGFyZW50KSksIGNoYXI6IChjaGFyKTAsIHVuc2lnbmVk
IGNoYXI6ICh1bnNpZ25lZCBjaGFyKTAsIHNpZ25lZCBjaGFyOiAoc2lnbmVkIGNoYXIpMCwg
dW5zaWduZWQgc2hvcnQ6ICh1bnNpZ25lZCBzaG9ydCkwLCBzaWduZWQgc2hvcnQ6IChzaWdu
ZWQgc2hvcnQpMCwgdW5zaWduZWQgaW50OiAodW5zaWduZWQgaW50KTAsIHNpZ25lZCBpbnQ6
IChzaWduZWQgaW50KTAsIHVuc2lnbmVkIGxvbmc6ICh1bnNpZ25lZCBsb25nKTAsIHNpZ25l
ZCBsb25nOiAoc2lnbmVkIGxvbmcpMCwgdW5zaWduZWQgbG9uZyBsb25nOiAodW5zaWduZWQg
bG9uZyBsb25nKTAsIHNpZ25lZCBsb25nIGxvbmc6IChzaWduZWQgbG9uZyBsb25nKTAsIGRl
ZmF1bHQ6ICgodGFzay0+cGFyZW50KSkpKSBfX3ggPSAoKihjb25zdCB2b2xhdGlsZSB0eXBl
b2YoIF9HZW5lcmljKCgodGFzay0+cGFyZW50KSksIGNoYXI6IChjaGFyKTAsIHVuc2lnbmVk
IGNoYXI6ICh1bnNpZ25lZCBjaGFyKTAsIHNpZ25lZCBjaGFyOiAoc2lnbmVkIGNoYXIpMCwg
dW5zaWduZWQgc2hvcnQ6ICh1bnNpZ25lZCBzaG9ydCkwLCBzaWduZWQgc2hvcnQ6IChzaWdu
ZWQgc2hvcnQpMCwgdW5zaWduZWQgaW50OiAodW5zaWduZWQgaW50KTAsIHNpZ25lZCBpbnQ6
IChzaWduZWQgaW50KTAsIHVuc2lnbmVkIGxvbmc6ICh1bnNpZ25lZCBsb25nKTAsIHNpZ25l
ZCBsb25nOiAoc2lnbmVkIGxvbmcpMCwgdW5zaWduZWQgbG9uZyBsb25nOiAodW5zaWduZWQg
bG9uZyBsb25nKTAsIHNpZ25lZCBsb25nIGxvbmc6IChzaWduZWQgbG9uZyBsb25nKTAsIGRl
ZmF1bHQ6ICgodGFzay0+cGFyZW50KSkpKSAqKSYoKHRhc2stPnBhcmVudCkpKTsgZG8geyB9
IHdoaWxlICgwKTsgKHR5cGVvZigodGFzay0+cGFyZW50KSkpX194OyB9KTsgfSk7IGRvIHsg
fSB3aGlsZSAoMCk7IDsgKCh0eXBlb2YoKih0YXNrLT5wYXJlbnQpKSAqKShfX19fX19fX3Ax
KSk7IH0pOwogcmV0dXJuICgodm9pZCAqKTApOwp9CiMgMTQwICIuL2luY2x1ZGUvbGludXgv
cHRyYWNlLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIHB0cmFjZV9ldmVudF9lbmFibGVkKHN0cnVjdCB0
YXNrX3N0cnVjdCAqdGFzaywgaW50IGV2ZW50KQp7CiByZXR1cm4gdGFzay0+cHRyYWNlICYg
KDEgPDwgKDMgKyAoZXZlbnQpKSk7Cn0KIyAxNTUgIi4vaW5jbHVkZS9saW51eC9wdHJhY2Uu
aCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIHZvaWQgcHRyYWNlX2V2ZW50KGludCBldmVudCwgdW5zaWduZWQgbG9u
ZyBtZXNzYWdlKQp7CiBpZiAoX19idWlsdGluX2V4cGVjdCghIShwdHJhY2VfZXZlbnRfZW5h
YmxlZChnZXRfY3VycmVudCgpLCBldmVudCkpLCAwKSkgewogIGdldF9jdXJyZW50KCktPnB0
cmFjZV9tZXNzYWdlID0gbWVzc2FnZTsKICBwdHJhY2Vfbm90aWZ5KChldmVudCA8PCA4KSB8
IDUpOwogfSBlbHNlIGlmIChldmVudCA9PSA0KSB7CgogIGlmICgoZ2V0X2N1cnJlbnQoKS0+
cHRyYWNlICYgKDB4MDAwMDAwMDF8MHgwMDAxMDAwMCkpID09IDB4MDAwMDAwMDEpCiAgIHNl
bmRfc2lnKDUsIGdldF9jdXJyZW50KCksIDApOwogfQp9CiMgMTc4ICIuL2luY2x1ZGUvbGlu
dXgvcHRyYWNlLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHB0cmFjZV9ldmVudF9waWQoaW50IGV2ZW50
LCBzdHJ1Y3QgcGlkICpwaWQpCnsKCgoKCgoKIHVuc2lnbmVkIGxvbmcgbWVzc2FnZSA9IDA7
CiBzdHJ1Y3QgcGlkX25hbWVzcGFjZSAqbnM7CgogcmN1X3JlYWRfbG9jaygpOwogbnMgPSB0
YXNrX2FjdGl2ZV9waWRfbnMoKHsgdHlwZW9mKCooZ2V0X2N1cnJlbnQoKS0+cGFyZW50KSkg
Kl9fX19fX19fcDEgPSAodHlwZW9mKCooZ2V0X2N1cnJlbnQoKS0+cGFyZW50KSkgKikoeyBk
byB7IGV4dGVybiB2b2lkIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzE4Mih2b2lkKSBfX2F0dHJp
YnV0ZV9fKChfX2Vycm9yX18oIlVuc3VwcG9ydGVkIGFjY2VzcyBzaXplIGZvciB7UkVBRCxX
UklURX1fT05DRSgpLiIpKSk7IGlmICghKChzaXplb2YoKGdldF9jdXJyZW50KCktPnBhcmVu
dCkpID09IHNpemVvZihjaGFyKSB8fCBzaXplb2YoKGdldF9jdXJyZW50KCktPnBhcmVudCkp
ID09IHNpemVvZihzaG9ydCkgfHwgc2l6ZW9mKChnZXRfY3VycmVudCgpLT5wYXJlbnQpKSA9
PSBzaXplb2YoaW50KSB8fCBzaXplb2YoKGdldF9jdXJyZW50KCktPnBhcmVudCkpID09IHNp
emVvZihsb25nKSkgfHwgc2l6ZW9mKChnZXRfY3VycmVudCgpLT5wYXJlbnQpKSA9PSBzaXpl
b2YobG9uZyBsb25nKSkpIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzE4MigpOyB9IHdoaWxlICgw
KTsgKHsgdHlwZW9mKCBfR2VuZXJpYygoKGdldF9jdXJyZW50KCktPnBhcmVudCkpLCBjaGFy
OiAoY2hhcikwLCB1bnNpZ25lZCBjaGFyOiAodW5zaWduZWQgY2hhcikwLCBzaWduZWQgY2hh
cjogKHNpZ25lZCBjaGFyKTAsIHVuc2lnbmVkIHNob3J0OiAodW5zaWduZWQgc2hvcnQpMCwg
c2lnbmVkIHNob3J0OiAoc2lnbmVkIHNob3J0KTAsIHVuc2lnbmVkIGludDogKHVuc2lnbmVk
IGludCkwLCBzaWduZWQgaW50OiAoc2lnbmVkIGludCkwLCB1bnNpZ25lZCBsb25nOiAodW5z
aWduZWQgbG9uZykwLCBzaWduZWQgbG9uZzogKHNpZ25lZCBsb25nKTAsIHVuc2lnbmVkIGxv
bmcgbG9uZzogKHVuc2lnbmVkIGxvbmcgbG9uZykwLCBzaWduZWQgbG9uZyBsb25nOiAoc2ln
bmVkIGxvbmcgbG9uZykwLCBkZWZhdWx0OiAoKGdldF9jdXJyZW50KCktPnBhcmVudCkpKSkg
X194ID0gKCooY29uc3Qgdm9sYXRpbGUgdHlwZW9mKCBfR2VuZXJpYygoKGdldF9jdXJyZW50
KCktPnBhcmVudCkpLCBjaGFyOiAoY2hhcikwLCB1bnNpZ25lZCBjaGFyOiAodW5zaWduZWQg
Y2hhcikwLCBzaWduZWQgY2hhcjogKHNpZ25lZCBjaGFyKTAsIHVuc2lnbmVkIHNob3J0OiAo
dW5zaWduZWQgc2hvcnQpMCwgc2lnbmVkIHNob3J0OiAoc2lnbmVkIHNob3J0KTAsIHVuc2ln
bmVkIGludDogKHVuc2lnbmVkIGludCkwLCBzaWduZWQgaW50OiAoc2lnbmVkIGludCkwLCB1
bnNpZ25lZCBsb25nOiAodW5zaWduZWQgbG9uZykwLCBzaWduZWQgbG9uZzogKHNpZ25lZCBs
b25nKTAsIHVuc2lnbmVkIGxvbmcgbG9uZzogKHVuc2lnbmVkIGxvbmcgbG9uZykwLCBzaWdu
ZWQgbG9uZyBsb25nOiAoc2lnbmVkIGxvbmcgbG9uZykwLCBkZWZhdWx0OiAoKGdldF9jdXJy
ZW50KCktPnBhcmVudCkpKSkgKikmKChnZXRfY3VycmVudCgpLT5wYXJlbnQpKSk7IGRvIHsg
fSB3aGlsZSAoMCk7ICh0eXBlb2YoKGdldF9jdXJyZW50KCktPnBhcmVudCkpKV9feDsgfSk7
IH0pOyBkbyB7IH0gd2hpbGUgKDApOyA7ICgodHlwZW9mKCooZ2V0X2N1cnJlbnQoKS0+cGFy
ZW50KSkgKikoX19fX19fX19wMSkpOyB9KSk7CiBpZiAobnMpCiAgbWVzc2FnZSA9IHBpZF9u
cl9ucyhwaWQsIG5zKTsKIHJjdV9yZWFkX3VubG9jaygpOwoKIHB0cmFjZV9ldmVudChldmVu
dCwgbWVzc2FnZSk7Cn0KIyAyMDggIi4vaW5jbHVkZS9saW51eC9wdHJhY2UuaCIKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIHZvaWQgcHRyYWNlX2luaXRfdGFzayhzdHJ1Y3QgdGFza19zdHJ1Y3QgKmNoaWxkLCBi
b29sIHB0cmFjZSkKewogSU5JVF9MSVNUX0hFQUQoJmNoaWxkLT5wdHJhY2VfZW50cnkpOwog
SU5JVF9MSVNUX0hFQUQoJmNoaWxkLT5wdHJhY2VkKTsKIGNoaWxkLT5qb2JjdGwgPSAwOwog
Y2hpbGQtPnB0cmFjZSA9IDA7CiBjaGlsZC0+cGFyZW50ID0gY2hpbGQtPnJlYWxfcGFyZW50
OwoKIGlmIChfX2J1aWx0aW5fZXhwZWN0KCEhKHB0cmFjZSksIDApICYmIGdldF9jdXJyZW50
KCktPnB0cmFjZSkgewogIGNoaWxkLT5wdHJhY2UgPSBnZXRfY3VycmVudCgpLT5wdHJhY2U7
CiAgX19wdHJhY2VfbGluayhjaGlsZCwgZ2V0X2N1cnJlbnQoKS0+cGFyZW50LCBnZXRfY3Vy
cmVudCgpLT5wdHJhY2VyX2NyZWQpOwoKICBpZiAoY2hpbGQtPnB0cmFjZSAmIDB4MDAwMTAw
MDApCiAgIHRhc2tfc2V0X2pvYmN0bF9wZW5kaW5nKGNoaWxkLCAoMVVMIDw8IDE5KSk7CiAg
ZWxzZQogICBzaWdhZGRzZXQoJmNoaWxkLT5wZW5kaW5nLnNpZ25hbCwgMTkpOwogfQogZWxz
ZQogIGNoaWxkLT5wdHJhY2VyX2NyZWQgPSAoKHZvaWQgKikwKTsKfQoKCgoKCgoKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIHZvaWQgcHRyYWNlX3JlbGVhc2VfdGFzayhzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRhc2sp
CnsKIGRvIHsgaWYgKF9fYnVpbHRpbl9jb25zdGFudF9wKCFsaXN0X2VtcHR5KCZ0YXNrLT5w
dHJhY2VkKSkpIHsgaWYgKCFsaXN0X2VtcHR5KCZ0YXNrLT5wdHJhY2VkKSkgZG8geyBfX2Fz
bV9fIF9fdm9sYXRpbGVfXyggIjE6CSIgInR3aSAzMSwgMCwgMCIgIlxuIiAiLnNlY3Rpb24g
X19idWdfdGFibGUsXCJhd1wiXG4iICIyOlx0IiAiLjhieXRlIiAiICIgIjFiLCAlMFxuIiAi
XHQuc2hvcnQgJTEsICUyXG4iICIub3JnIDJiKyUzXG4iICIucHJldmlvdXNcbiIgOiA6ICJp
IiAoIi4vaW5jbHVkZS9saW51eC9wdHJhY2UuaCIpLCAiaSIgKDIzNyksICJpIiAoMCksICJp
IiAoc2l6ZW9mKHN0cnVjdCBidWdfZW50cnkpKSk7IGRvIHsgOyBhc20gdm9sYXRpbGUoIiIp
OyBfX2J1aWx0aW5fdW5yZWFjaGFibGUoKTsgfSB3aGlsZSAoMCk7IH0gd2hpbGUgKDApOyB9
IGVsc2UgeyBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CSIgInRkbmVpIiAiICIgIiAlNCwg
MCIgIlxuIiAiLnNlY3Rpb24gX19idWdfdGFibGUsXCJhd1wiXG4iICIyOlx0IiAiLjhieXRl
IiAiICIgIjFiLCAlMFxuIiAiXHQuc2hvcnQgJTEsICUyXG4iICIub3JnIDJiKyUzXG4iICIu
cHJldmlvdXNcbiIgOiA6ICJpIiAoIi4vaW5jbHVkZS9saW51eC9wdHJhY2UuaCIpLCAiaSIg
KDIzNyksICJpIiAoMCksICJpIiAoc2l6ZW9mKHN0cnVjdCBidWdfZW50cnkpKSwgInIiICgo
IGxvbmcpKCFsaXN0X2VtcHR5KCZ0YXNrLT5wdHJhY2VkKSkpKTsgfSB9IHdoaWxlICgwKTsK
IHB0cmFjZV91bmxpbmsodGFzayk7CiBkbyB7IGlmIChfX2J1aWx0aW5fY29uc3RhbnRfcCgh
bGlzdF9lbXB0eSgmdGFzay0+cHRyYWNlX2VudHJ5KSkpIHsgaWYgKCFsaXN0X2VtcHR5KCZ0
YXNrLT5wdHJhY2VfZW50cnkpKSBkbyB7IF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJIiAi
dHdpIDMxLCAwLCAwIiAiXG4iICIuc2VjdGlvbiBfX2J1Z190YWJsZSxcImF3XCJcbiIgIjI6
XHQiICIuOGJ5dGUiICIgIiAiMWIsICUwXG4iICJcdC5zaG9ydCAlMSwgJTJcbiIgIi5vcmcg
MmIrJTNcbiIgIi5wcmV2aW91c1xuIiA6IDogImkiICgiLi9pbmNsdWRlL2xpbnV4L3B0cmFj
ZS5oIiksICJpIiAoMjM5KSwgImkiICgwKSwgImkiIChzaXplb2Yoc3RydWN0IGJ1Z19lbnRy
eSkpKTsgZG8geyA7IGFzbSB2b2xhdGlsZSgiIik7IF9fYnVpbHRpbl91bnJlYWNoYWJsZSgp
OyB9IHdoaWxlICgwKTsgfSB3aGlsZSAoMCk7IH0gZWxzZSB7IF9fYXNtX18gX192b2xhdGls
ZV9fKCAiMToJIiAidGRuZWkiICIgIiAiICU0LCAwIiAiXG4iICIuc2VjdGlvbiBfX2J1Z190
YWJsZSxcImF3XCJcbiIgIjI6XHQiICIuOGJ5dGUiICIgIiAiMWIsICUwXG4iICJcdC5zaG9y
dCAlMSwgJTJcbiIgIi5vcmcgMmIrJTNcbiIgIi5wcmV2aW91c1xuIiA6IDogImkiICgiLi9p
bmNsdWRlL2xpbnV4L3B0cmFjZS5oIiksICJpIiAoMjM5KSwgImkiICgwKSwgImkiIChzaXpl
b2Yoc3RydWN0IGJ1Z19lbnRyeSkpLCAiciIgKCggbG9uZykoIWxpc3RfZW1wdHkoJnRhc2st
PnB0cmFjZV9lbnRyeSkpKSk7IH0gfSB3aGlsZSAoMCk7Cn0KIyAzMTMgIi4vaW5jbHVkZS9s
aW51eC9wdHJhY2UuaCIKZXh0ZXJuIHZvaWQgdXNlcl9lbmFibGVfc2luZ2xlX3N0ZXAoc3Ry
dWN0IHRhc2tfc3RydWN0ICopOwpleHRlcm4gdm9pZCB1c2VyX2Rpc2FibGVfc2luZ2xlX3N0
ZXAoc3RydWN0IHRhc2tfc3RydWN0ICopOwojIDM0MyAiLi9pbmNsdWRlL2xpbnV4L3B0cmFj
ZS5oIgpleHRlcm4gdm9pZCB1c2VyX2VuYWJsZV9ibG9ja19zdGVwKHN0cnVjdCB0YXNrX3N0
cnVjdCAqKTsKCgoKZXh0ZXJuIHZvaWQgdXNlcl9zaW5nbGVfc3RlcF9yZXBvcnQoc3RydWN0
IHB0X3JlZ3MgKnJlZ3MpOwojIDQxNyAiLi9pbmNsdWRlL2xpbnV4L3B0cmFjZS5oIgpleHRl
cm4gaW50IHRhc2tfY3VycmVudF9zeXNjYWxsKHN0cnVjdCB0YXNrX3N0cnVjdCAqdGFyZ2V0
LCBzdHJ1Y3Qgc3lzY2FsbF9pbmZvICppbmZvKTsKCmV4dGVybiB2b2lkIHNpZ2FjdGlvbl9j
b21wYXRfYWJpKHN0cnVjdCBrX3NpZ2FjdGlvbiAqYWN0LCBzdHJ1Y3Qga19zaWdhY3Rpb24g
Km9hY3QpOwojIDI0ICJhcmNoL3Bvd2VycGMva2VybmVsL3NpZ25hbF8zMi5jIiAyCiMgMSAi
Li9pbmNsdWRlL2xpbnV4L3BhZ2VtYXAuaCIgMQojIDExICIuL2luY2x1ZGUvbGludXgvcGFn
ZW1hcC5oIgojIDEgIi4vaW5jbHVkZS9saW51eC9oaWdobWVtLmgiIDEKIyAxMCAiLi9pbmNs
dWRlL2xpbnV4L2hpZ2htZW0uaCIKIyAxICIuL2luY2x1ZGUvbGludXgvaGFyZGlycS5oIiAx
CgoKCgojIDEgIi4vaW5jbHVkZS9saW51eC9jb250ZXh0X3RyYWNraW5nX3N0YXRlLmgiIDEK
CgoKCgojIDEgIi4vaW5jbHVkZS9saW51eC9zdGF0aWNfa2V5LmgiIDEKIyA3ICIuL2luY2x1
ZGUvbGludXgvY29udGV4dF90cmFja2luZ19zdGF0ZS5oIiAyCgpzdHJ1Y3QgY29udGV4dF90
cmFja2luZyB7CgoKCgoKCiBib29sIGFjdGl2ZTsKIGludCByZWN1cnNpb247CiBlbnVtIGN0
eF9zdGF0ZSB7CiAgQ09OVEVYVF9ESVNBQkxFRCA9IC0xLAogIENPTlRFWFRfS0VSTkVMID0g
MCwKICBDT05URVhUX1VTRVIsCiAgQ09OVEVYVF9HVUVTVCwKIH0gc3RhdGU7Cn07CiMgNDkg
Ii4vaW5jbHVkZS9saW51eC9jb250ZXh0X3RyYWNraW5nX3N0YXRlLmgiCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBi
b29sIGNvbnRleHRfdHJhY2tpbmdfaW5fdXNlcih2b2lkKSB7IHJldHVybiBmYWxzZTsgfQpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgYm9vbCBjb250ZXh0X3RyYWNraW5nX2VuYWJsZWQodm9pZCkgeyByZXR1cm4g
ZmFsc2U7IH0Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgY29udGV4dF90cmFja2luZ19lbmFibGVkX2NwdShp
bnQgY3B1KSB7IHJldHVybiBmYWxzZTsgfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBjb250ZXh0X3RyYWNr
aW5nX2VuYWJsZWRfdGhpc19jcHUodm9pZCkgeyByZXR1cm4gZmFsc2U7IH0KIyA2ICIuL2lu
Y2x1ZGUvbGludXgvaGFyZGlycS5oIiAyCgoKIyAxICIuL2luY2x1ZGUvbGludXgvZnRyYWNl
X2lycS5oIiAxCiMgMTAgIi4vaW5jbHVkZS9saW51eC9mdHJhY2VfaXJxLmgiCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSB2b2lkIGZ0cmFjZV9ubWlfZW50ZXIodm9pZCkKewoKCgoKfQoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQg
ZnRyYWNlX25taV9leGl0KHZvaWQpCnsKCgoKCn0KIyA5ICIuL2luY2x1ZGUvbGludXgvaGFy
ZGlycS5oIiAyCiMgMSAiLi9pbmNsdWRlL2xpbnV4L3Z0aW1lLmgiIDEKCgoKCgoKIyAxICIu
L2FyY2gvcG93ZXJwYy9pbmNsdWRlL2dlbmVyYXRlZC9hc20vdnRpbWUuaCIgMQojIDEgIi4v
aW5jbHVkZS9hc20tZ2VuZXJpYy92dGltZS5oIiAxCiMgMSAiLi9hcmNoL3Bvd2VycGMvaW5j
bHVkZS9nZW5lcmF0ZWQvYXNtL3Z0aW1lLmgiIDIKIyA4ICIuL2luY2x1ZGUvbGludXgvdnRp
bWUuaCIgMgoKCgpzdHJ1Y3QgdGFza19zdHJ1Y3Q7CgoKCgoKCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIHZ0
aW1lX2FjY291bnRpbmdfZW5hYmxlZF90aGlzX2NwdSh2b2lkKSB7IHJldHVybiB0cnVlOyB9
CmV4dGVybiB2b2lkIHZ0aW1lX3Rhc2tfc3dpdGNoKHN0cnVjdCB0YXNrX3N0cnVjdCAqcHJl
dik7CiMgNjQgIi4vaW5jbHVkZS9saW51eC92dGltZS5oIgpleHRlcm4gdm9pZCB2dGltZV9h
Y2NvdW50X2tlcm5lbChzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRzayk7CmV4dGVybiB2b2lkIHZ0
aW1lX2FjY291bnRfaWRsZShzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRzayk7CiMgNzggIi4vaW5j
bHVkZS9saW51eC92dGltZS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCB2dGltZV91c2VyX2VudGVyKHN0
cnVjdCB0YXNrX3N0cnVjdCAqdHNrKSB7IH0Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgdnRpbWVfdXNlcl9l
eGl0KHN0cnVjdCB0YXNrX3N0cnVjdCAqdHNrKSB7IH0Kc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgdnRpbWVf
Z3Vlc3RfZW50ZXIoc3RydWN0IHRhc2tfc3RydWN0ICp0c2spIHsgfQpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9p
ZCB2dGltZV9ndWVzdF9leGl0KHN0cnVjdCB0YXNrX3N0cnVjdCAqdHNrKSB7IH0Kc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIHZvaWQgdnRpbWVfaW5pdF9pZGxlKHN0cnVjdCB0YXNrX3N0cnVjdCAqdHNrLCBpbnQg
Y3B1KSB7IH0KCgoKZXh0ZXJuIHZvaWQgdnRpbWVfYWNjb3VudF9pcnFfZW50ZXIoc3RydWN0
IHRhc2tfc3RydWN0ICp0c2spOwpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCB2dGltZV9hY2NvdW50X2lycV9l
eGl0KHN0cnVjdCB0YXNrX3N0cnVjdCAqdHNrKQp7CgogdnRpbWVfYWNjb3VudF9rZXJuZWwo
dHNrKTsKfQpleHRlcm4gdm9pZCB2dGltZV9mbHVzaChzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRz
ayk7CiMgMTAzICIuL2luY2x1ZGUvbGludXgvdnRpbWUuaCIKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgaXJx
dGltZV9hY2NvdW50X2lycShzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRzaykgeyB9CgoKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIHZvaWQgYWNjb3VudF9pcnFfZW50ZXJfdGltZShzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRz
aykKewogdnRpbWVfYWNjb3VudF9pcnFfZW50ZXIodHNrKTsKIGlycXRpbWVfYWNjb3VudF9p
cnEodHNrKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgYWNjb3VudF9pcnFfZXhpdF90aW1lKHN0cnVj
dCB0YXNrX3N0cnVjdCAqdHNrKQp7CiB2dGltZV9hY2NvdW50X2lycV9leGl0KHRzayk7CiBp
cnF0aW1lX2FjY291bnRfaXJxKHRzayk7Cn0KIyAxMCAiLi9pbmNsdWRlL2xpbnV4L2hhcmRp
cnEuaCIgMgojIDEgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2hhcmRpcnEuaCIgMQoK
CgoKCiMgMSAiLi9pbmNsdWRlL2xpbnV4L2lycS5oIiAxCiMgMTYgIi4vaW5jbHVkZS9saW51
eC9pcnEuaCIKIyAxICIuL2luY2x1ZGUvbGludXgvaXJxaGFuZGxlci5oIiAxCiMgMTAgIi4v
aW5jbHVkZS9saW51eC9pcnFoYW5kbGVyLmgiCnN0cnVjdCBpcnFfZGVzYzsKc3RydWN0IGly
cV9kYXRhOwp0eXBlZGVmIHZvaWQgKCppcnFfZmxvd19oYW5kbGVyX3QpKHN0cnVjdCBpcnFf
ZGVzYyAqZGVzYyk7CnR5cGVkZWYgdm9pZCAoKmlycV9wcmVmbG93X2hhbmRsZXJfdCkoc3Ry
dWN0IGlycV9kYXRhICpkYXRhKTsKIyAxNyAiLi9pbmNsdWRlL2xpbnV4L2lycS5oIiAyCgoj
IDEgIi4vaW5jbHVkZS9saW51eC9pcnFuci5oIiAxCgoKCgojIDEgIi4vaW5jbHVkZS91YXBp
L2xpbnV4L2lycW5yLmgiIDEKIyA2ICIuL2luY2x1ZGUvbGludXgvaXJxbnIuaCIgMgoKCmV4
dGVybiBpbnQgbnJfaXJxczsKZXh0ZXJuIHN0cnVjdCBpcnFfZGVzYyAqaXJxX3RvX2Rlc2Mo
dW5zaWduZWQgaW50IGlycSk7CnVuc2lnbmVkIGludCBpcnFfZ2V0X25leHRfaXJxKHVuc2ln
bmVkIGludCBvZmZzZXQpOwojIDE5ICIuL2luY2x1ZGUvbGludXgvaXJxLmgiIDIKCiMgMSAi
Li9pbmNsdWRlL2xpbnV4L2lvLmgiIDEKIyAxMyAiLi9pbmNsdWRlL2xpbnV4L2lvLmgiCiMg
MSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vaW8uaCIgMQojIDE1ICIuL2FyY2gvcG93
ZXJwYy9pbmNsdWRlL2FzbS9pby5oIgpleHRlcm4gaW50IGNoZWNrX2xlZ2FjeV9pb3BvcnQo
dW5zaWduZWQgbG9uZyBiYXNlX3BvcnQpOwoKCgoKZXh0ZXJuIHN0cnVjdCBwY2lfZGV2ICpp
c2FfYnJpZGdlX3BjaWRldjsKCgoKCgoKIyAxICIuL2luY2x1ZGUvbGludXgvZGV2aWNlLmgi
IDEKIyAxNSAiLi9pbmNsdWRlL2xpbnV4L2RldmljZS5oIgojIDEgIi4vaW5jbHVkZS9saW51
eC9kZXZfcHJpbnRrLmgiIDEKIyAyMiAiLi9pbmNsdWRlL2xpbnV4L2Rldl9wcmludGsuaCIK
c3RydWN0IGRldmljZTsKCgoKX19hdHRyaWJ1dGVfXygoX19mb3JtYXRfXyhwcmludGYsIDMs
IDApKSkgX19hdHRyaWJ1dGVfXygoX19jb2xkX18pKQppbnQgZGV2X3ZwcmludGtfZW1pdChp
bnQgbGV2ZWwsIGNvbnN0IHN0cnVjdCBkZXZpY2UgKmRldiwKICAgICAgIGNvbnN0IGNoYXIg
KmZtdCwgdmFfbGlzdCBhcmdzKTsKX19hdHRyaWJ1dGVfXygoX19mb3JtYXRfXyhwcmludGYs
IDMsIDQpKSkgX19hdHRyaWJ1dGVfXygoX19jb2xkX18pKQppbnQgZGV2X3ByaW50a19lbWl0
KGludCBsZXZlbCwgY29uc3Qgc3RydWN0IGRldmljZSAqZGV2LCBjb25zdCBjaGFyICpmbXQs
IC4uLik7CgpfX2F0dHJpYnV0ZV9fKChfX2Zvcm1hdF9fKHByaW50ZiwgMywgNCkpKSBfX2F0
dHJpYnV0ZV9fKChfX2NvbGRfXykpCnZvaWQgZGV2X3ByaW50ayhjb25zdCBjaGFyICpsZXZl
bCwgY29uc3Qgc3RydWN0IGRldmljZSAqZGV2LAogIGNvbnN0IGNoYXIgKmZtdCwgLi4uKTsK
X19hdHRyaWJ1dGVfXygoX19mb3JtYXRfXyhwcmludGYsIDIsIDMpKSkgX19hdHRyaWJ1dGVf
XygoX19jb2xkX18pKQp2b2lkIF9kZXZfZW1lcmcoY29uc3Qgc3RydWN0IGRldmljZSAqZGV2
LCBjb25zdCBjaGFyICpmbXQsIC4uLik7Cl9fYXR0cmlidXRlX18oKF9fZm9ybWF0X18ocHJp
bnRmLCAyLCAzKSkpIF9fYXR0cmlidXRlX18oKF9fY29sZF9fKSkKdm9pZCBfZGV2X2FsZXJ0
KGNvbnN0IHN0cnVjdCBkZXZpY2UgKmRldiwgY29uc3QgY2hhciAqZm10LCAuLi4pOwpfX2F0
dHJpYnV0ZV9fKChfX2Zvcm1hdF9fKHByaW50ZiwgMiwgMykpKSBfX2F0dHJpYnV0ZV9fKChf
X2NvbGRfXykpCnZvaWQgX2Rldl9jcml0KGNvbnN0IHN0cnVjdCBkZXZpY2UgKmRldiwgY29u
c3QgY2hhciAqZm10LCAuLi4pOwpfX2F0dHJpYnV0ZV9fKChfX2Zvcm1hdF9fKHByaW50Ziwg
MiwgMykpKSBfX2F0dHJpYnV0ZV9fKChfX2NvbGRfXykpCnZvaWQgX2Rldl9lcnIoY29uc3Qg
c3RydWN0IGRldmljZSAqZGV2LCBjb25zdCBjaGFyICpmbXQsIC4uLik7Cl9fYXR0cmlidXRl
X18oKF9fZm9ybWF0X18ocHJpbnRmLCAyLCAzKSkpIF9fYXR0cmlidXRlX18oKF9fY29sZF9f
KSkKdm9pZCBfZGV2X3dhcm4oY29uc3Qgc3RydWN0IGRldmljZSAqZGV2LCBjb25zdCBjaGFy
ICpmbXQsIC4uLik7Cl9fYXR0cmlidXRlX18oKF9fZm9ybWF0X18ocHJpbnRmLCAyLCAzKSkp
IF9fYXR0cmlidXRlX18oKF9fY29sZF9fKSkKdm9pZCBfZGV2X25vdGljZShjb25zdCBzdHJ1
Y3QgZGV2aWNlICpkZXYsIGNvbnN0IGNoYXIgKmZtdCwgLi4uKTsKX19hdHRyaWJ1dGVfXygo
X19mb3JtYXRfXyhwcmludGYsIDIsIDMpKSkgX19hdHRyaWJ1dGVfXygoX19jb2xkX18pKQp2
b2lkIF9kZXZfaW5mbyhjb25zdCBzdHJ1Y3QgZGV2aWNlICpkZXYsIGNvbnN0IGNoYXIgKmZt
dCwgLi4uKTsKIyAxNiAiLi9pbmNsdWRlL2xpbnV4L2RldmljZS5oIiAyCgojIDEgIi4vaW5j
bHVkZS9saW51eC9rb2JqZWN0LmgiIDEKIyAyMCAiLi9pbmNsdWRlL2xpbnV4L2tvYmplY3Qu
aCIKIyAxICIuL2luY2x1ZGUvbGludXgvc3lzZnMuaCIgMQojIDE2ICIuL2luY2x1ZGUvbGlu
dXgvc3lzZnMuaCIKIyAxICIuL2luY2x1ZGUvbGludXgva2VybmZzLmgiIDEKIyAyMCAiLi9p
bmNsdWRlL2xpbnV4L2tlcm5mcy5oIgpzdHJ1Y3QgZmlsZTsKc3RydWN0IGRlbnRyeTsKc3Ry
dWN0IGlhdHRyOwpzdHJ1Y3Qgc2VxX2ZpbGU7CnN0cnVjdCB2bV9hcmVhX3N0cnVjdDsKc3Ry
dWN0IHN1cGVyX2Jsb2NrOwpzdHJ1Y3QgZmlsZV9zeXN0ZW1fdHlwZTsKc3RydWN0IHBvbGxf
dGFibGVfc3RydWN0OwpzdHJ1Y3QgZnNfY29udGV4dDsKCnN0cnVjdCBrZXJuZnNfZnNfY29u
dGV4dDsKc3RydWN0IGtlcm5mc19vcGVuX25vZGU7CnN0cnVjdCBrZXJuZnNfaWF0dHJzOwoK
ZW51bSBrZXJuZnNfbm9kZV90eXBlIHsKIEtFUk5GU19ESVIgPSAweDAwMDEsCiBLRVJORlNf
RklMRSA9IDB4MDAwMiwKIEtFUk5GU19MSU5LID0gMHgwMDA0LAp9OwoKCgoKCgplbnVtIGtl
cm5mc19ub2RlX2ZsYWcgewogS0VSTkZTX0FDVElWQVRFRCA9IDB4MDAxMCwKIEtFUk5GU19O
UyA9IDB4MDAyMCwKIEtFUk5GU19IQVNfU0VRX1NIT1cgPSAweDAwNDAsCiBLRVJORlNfSEFT
X01NQVAgPSAweDAwODAsCiBLRVJORlNfTE9DS0RFUCA9IDB4MDEwMCwKIEtFUk5GU19TVUlD
SURBTCA9IDB4MDQwMCwKIEtFUk5GU19TVUlDSURFRCA9IDB4MDgwMCwKIEtFUk5GU19FTVBU
WV9ESVIgPSAweDEwMDAsCiBLRVJORlNfSEFTX1JFTEVBU0UgPSAweDIwMDAsCn07CgoKZW51
bSBrZXJuZnNfcm9vdF9mbGFnIHsKCgoKCgoKIEtFUk5GU19ST09UX0NSRUFURV9ERUFDVElW
QVRFRCA9IDB4MDAwMSwKIyA3NiAiLi9pbmNsdWRlL2xpbnV4L2tlcm5mcy5oIgogS0VSTkZT
X1JPT1RfRVhUUkFfT1BFTl9QRVJNX0NIRUNLID0gMHgwMDAyLAoKCgoKCiBLRVJORlNfUk9P
VF9TVVBQT1JUX0VYUE9SVE9QID0gMHgwMDA0LAoKCgoKIEtFUk5GU19ST09UX1NVUFBPUlRf
VVNFUl9YQVRUUiA9IDB4MDAwOCwKfTsKCgpzdHJ1Y3Qga2VybmZzX2VsZW1fZGlyIHsKIHVu
c2lnbmVkIGxvbmcgc3ViZGlyczsKCiBzdHJ1Y3QgcmJfcm9vdCBjaGlsZHJlbjsKCgoKCgog
c3RydWN0IGtlcm5mc19yb290ICpyb290Owp9OwoKc3RydWN0IGtlcm5mc19lbGVtX3N5bWxp
bmsgewogc3RydWN0IGtlcm5mc19ub2RlICp0YXJnZXRfa247Cn07CgpzdHJ1Y3Qga2VybmZz
X2VsZW1fYXR0ciB7CiBjb25zdCBzdHJ1Y3Qga2VybmZzX29wcyAqb3BzOwogc3RydWN0IGtl
cm5mc19vcGVuX25vZGUgKm9wZW47CiBsb2ZmX3Qgc2l6ZTsKIHN0cnVjdCBrZXJuZnNfbm9k
ZSAqbm90aWZ5X25leHQ7Cn07CiMgMTIzICIuL2luY2x1ZGUvbGludXgva2VybmZzLmgiCnN0
cnVjdCBrZXJuZnNfbm9kZSB7CiBhdG9taWNfdCBjb3VudDsKIGF0b21pY190IGFjdGl2ZTsK
IyAxMzUgIi4vaW5jbHVkZS9saW51eC9rZXJuZnMuaCIKIHN0cnVjdCBrZXJuZnNfbm9kZSAq
cGFyZW50OwogY29uc3QgY2hhciAqbmFtZTsKCiBzdHJ1Y3QgcmJfbm9kZSByYjsKCiBjb25z
dCB2b2lkICpuczsKIHVuc2lnbmVkIGludCBoYXNoOwogdW5pb24gewogIHN0cnVjdCBrZXJu
ZnNfZWxlbV9kaXIgZGlyOwogIHN0cnVjdCBrZXJuZnNfZWxlbV9zeW1saW5rIHN5bWxpbms7
CiAgc3RydWN0IGtlcm5mc19lbGVtX2F0dHIgYXR0cjsKIH07Cgogdm9pZCAqcHJpdjsKCgoK
CgogdTY0IGlkOwoKIHVuc2lnbmVkIHNob3J0IGZsYWdzOwogdW1vZGVfdCBtb2RlOwogc3Ry
dWN0IGtlcm5mc19pYXR0cnMgKmlhdHRyOwp9OwojIDE2OCAiLi9pbmNsdWRlL2xpbnV4L2tl
cm5mcy5oIgpzdHJ1Y3Qga2VybmZzX3N5c2NhbGxfb3BzIHsKIGludCAoKnNob3dfb3B0aW9u
cykoc3RydWN0IHNlcV9maWxlICpzZiwgc3RydWN0IGtlcm5mc19yb290ICpyb290KTsKCiBp
bnQgKCpta2Rpcikoc3RydWN0IGtlcm5mc19ub2RlICpwYXJlbnQsIGNvbnN0IGNoYXIgKm5h
bWUsCiAgICAgICB1bW9kZV90IG1vZGUpOwogaW50ICgqcm1kaXIpKHN0cnVjdCBrZXJuZnNf
bm9kZSAqa24pOwogaW50ICgqcmVuYW1lKShzdHJ1Y3Qga2VybmZzX25vZGUgKmtuLCBzdHJ1
Y3Qga2VybmZzX25vZGUgKm5ld19wYXJlbnQsCiAgICAgICAgY29uc3QgY2hhciAqbmV3X25h
bWUpOwogaW50ICgqc2hvd19wYXRoKShzdHJ1Y3Qgc2VxX2ZpbGUgKnNmLCBzdHJ1Y3Qga2Vy
bmZzX25vZGUgKmtuLAogICAgc3RydWN0IGtlcm5mc19yb290ICpyb290KTsKfTsKCnN0cnVj
dCBrZXJuZnNfcm9vdCB7Cgogc3RydWN0IGtlcm5mc19ub2RlICprbjsKIHVuc2lnbmVkIGlu
dCBmbGFnczsKCgogc3RydWN0IGlkciBpbm9faWRyOwogdTMyIGxhc3RfaWRfbG93Yml0czsK
IHUzMiBpZF9oaWdoYml0czsKIHN0cnVjdCBrZXJuZnNfc3lzY2FsbF9vcHMgKnN5c2NhbGxf
b3BzOwoKCiBzdHJ1Y3QgbGlzdF9oZWFkIHN1cGVyczsKCiB3YWl0X3F1ZXVlX2hlYWRfdCBk
ZWFjdGl2YXRlX3dhaXRxOwp9OwoKc3RydWN0IGtlcm5mc19vcGVuX2ZpbGUgewoKIHN0cnVj
dCBrZXJuZnNfbm9kZSAqa247CiBzdHJ1Y3QgZmlsZSAqZmlsZTsKIHN0cnVjdCBzZXFfZmls
ZSAqc2VxX2ZpbGU7CiB2b2lkICpwcml2OwoKCiBzdHJ1Y3QgbXV0ZXggbXV0ZXg7CiBzdHJ1
Y3QgbXV0ZXggcHJlYWxsb2NfbXV0ZXg7CiBpbnQgZXZlbnQ7CiBzdHJ1Y3QgbGlzdF9oZWFk
IGxpc3Q7CiBjaGFyICpwcmVhbGxvY19idWY7Cgogc2l6ZV90IGF0b21pY193cml0ZV9sZW47
CiBib29sIG1tYXBwZWQ6MTsKIGJvb2wgcmVsZWFzZWQ6MTsKIGNvbnN0IHN0cnVjdCB2bV9v
cGVyYXRpb25zX3N0cnVjdCAqdm1fb3BzOwp9OwoKc3RydWN0IGtlcm5mc19vcHMgewoKCgoK
IGludCAoKm9wZW4pKHN0cnVjdCBrZXJuZnNfb3Blbl9maWxlICpvZik7CiB2b2lkICgqcmVs
ZWFzZSkoc3RydWN0IGtlcm5mc19vcGVuX2ZpbGUgKm9mKTsKIyAyMzYgIi4vaW5jbHVkZS9s
aW51eC9rZXJuZnMuaCIKIGludCAoKnNlcV9zaG93KShzdHJ1Y3Qgc2VxX2ZpbGUgKnNmLCB2
b2lkICp2KTsKCiB2b2lkICooKnNlcV9zdGFydCkoc3RydWN0IHNlcV9maWxlICpzZiwgbG9m
Zl90ICpwcG9zKTsKIHZvaWQgKigqc2VxX25leHQpKHN0cnVjdCBzZXFfZmlsZSAqc2YsIHZv
aWQgKnYsIGxvZmZfdCAqcHBvcyk7CiB2b2lkICgqc2VxX3N0b3ApKHN0cnVjdCBzZXFfZmls
ZSAqc2YsIHZvaWQgKnYpOwoKIHNzaXplX3QgKCpyZWFkKShzdHJ1Y3Qga2VybmZzX29wZW5f
ZmlsZSAqb2YsIGNoYXIgKmJ1Ziwgc2l6ZV90IGJ5dGVzLAogICBsb2ZmX3Qgb2ZmKTsKIyAy
NTIgIi4vaW5jbHVkZS9saW51eC9rZXJuZnMuaCIKIHNpemVfdCBhdG9taWNfd3JpdGVfbGVu
OwoKCgoKCgogYm9vbCBwcmVhbGxvYzsKIHNzaXplX3QgKCp3cml0ZSkoc3RydWN0IGtlcm5m
c19vcGVuX2ZpbGUgKm9mLCBjaGFyICpidWYsIHNpemVfdCBieXRlcywKICAgIGxvZmZfdCBv
ZmYpOwoKIF9fcG9sbF90ICgqcG9sbCkoc3RydWN0IGtlcm5mc19vcGVuX2ZpbGUgKm9mLAog
ICAgc3RydWN0IHBvbGxfdGFibGVfc3RydWN0ICpwdCk7CgogaW50ICgqbW1hcCkoc3RydWN0
IGtlcm5mc19vcGVuX2ZpbGUgKm9mLCBzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnZtYSk7CgoK
Cgp9OwoKCgoKc3RydWN0IGtlcm5mc19mc19jb250ZXh0IHsKIHN0cnVjdCBrZXJuZnNfcm9v
dCAqcm9vdDsKIHZvaWQgKm5zX3RhZzsKIHVuc2lnbmVkIGxvbmcgbWFnaWM7CgoKIGJvb2wg
bmV3X3NiX2NyZWF0ZWQ7Cn07CgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBlbnVtIGtlcm5mc19ub2RlX3R5cGUg
a2VybmZzX3R5cGUoc3RydWN0IGtlcm5mc19ub2RlICprbikKewogcmV0dXJuIGtuLT5mbGFn
cyAmIDB4MDAwZjsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGlub190IGtlcm5mc19pZF9pbm8odTY0IGlkKQp7
CgogaWYgKHNpemVvZihpbm9fdCkgPj0gc2l6ZW9mKHU2NCkpCiAgcmV0dXJuIGlkOwogZWxz
ZQogIHJldHVybiAodTMyKWlkOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdTMyIGtlcm5mc19pZF9nZW4odTY0
IGlkKQp7CgogaWYgKHNpemVvZihpbm9fdCkgPj0gc2l6ZW9mKHU2NCkpCiAgcmV0dXJuIDE7
CiBlbHNlCiAgcmV0dXJuIGlkID4+IDMyOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW5vX3Qga2VybmZzX2lu
byhzdHJ1Y3Qga2VybmZzX25vZGUgKmtuKQp7CiByZXR1cm4ga2VybmZzX2lkX2lubyhrbi0+
aWQpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgaW5vX3Qga2VybmZzX2dlbihzdHJ1Y3Qga2VybmZzX25vZGUg
KmtuKQp7CiByZXR1cm4ga2VybmZzX2lkX2dlbihrbi0+aWQpOwp9CiMgMzI4ICIuL2luY2x1
ZGUvbGludXgva2VybmZzLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGtlcm5mc19lbmFibGVfbnMoc3Ry
dWN0IGtlcm5mc19ub2RlICprbikKewogKHsgaW50IF9fcmV0X3dhcm5fb24gPSAhIShrZXJu
ZnNfdHlwZShrbikgIT0gS0VSTkZTX0RJUik7IGlmIChfX2J1aWx0aW5fZXhwZWN0KCEhKF9f
cmV0X3dhcm5fb24pLCAwKSkgX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgkiICJ0d2kgMzEs
IDAsIDAiICJcbiIgIi5zZWN0aW9uIF9fYnVnX3RhYmxlLFwiYXdcIlxuIiAiMjpcdCIgIi44
Ynl0ZSIgIiAiICIxYiwgJTBcbiIgIlx0LnNob3J0ICUxLCAlMlxuIiAiLm9yZyAyYislM1xu
IiAiLnByZXZpb3VzXG4iIDogOiAiaSIgKCIuL2luY2x1ZGUvbGludXgva2VybmZzLmgiKSwg
ImkiICgzMzApLCAiaSIgKCgxIDw8IDApIHwgKCgxIDw8IDEpIHwgKCg5KSA8PCA4KSkpLCAi
aSIgKHNpemVvZihzdHJ1Y3QgYnVnX2VudHJ5KSkpOyBfX2J1aWx0aW5fZXhwZWN0KCEhKF9f
cmV0X3dhcm5fb24pLCAwKTsgfSk7CiAoeyBpbnQgX19yZXRfd2Fybl9vbiA9ICEhKCEoKHsg
ZG8geyBleHRlcm4gdm9pZCBfX2NvbXBpbGV0aW1lX2Fzc2VydF8xODModm9pZCkgX19hdHRy
aWJ1dGVfXygoX19lcnJvcl9fKCJVbnN1cHBvcnRlZCBhY2Nlc3Mgc2l6ZSBmb3Ige1JFQUQs
V1JJVEV9X09OQ0UoKS4iKSkpOyBpZiAoISgoc2l6ZW9mKCgma24tPmRpci5jaGlsZHJlbikt
PnJiX25vZGUpID09IHNpemVvZihjaGFyKSB8fCBzaXplb2YoKCZrbi0+ZGlyLmNoaWxkcmVu
KS0+cmJfbm9kZSkgPT0gc2l6ZW9mKHNob3J0KSB8fCBzaXplb2YoKCZrbi0+ZGlyLmNoaWxk
cmVuKS0+cmJfbm9kZSkgPT0gc2l6ZW9mKGludCkgfHwgc2l6ZW9mKCgma24tPmRpci5jaGls
ZHJlbiktPnJiX25vZGUpID09IHNpemVvZihsb25nKSkgfHwgc2l6ZW9mKCgma24tPmRpci5j
aGlsZHJlbiktPnJiX25vZGUpID09IHNpemVvZihsb25nIGxvbmcpKSkgX19jb21waWxldGlt
ZV9hc3NlcnRfMTgzKCk7IH0gd2hpbGUgKDApOyAoeyB0eXBlb2YoIF9HZW5lcmljKCgoJmtu
LT5kaXIuY2hpbGRyZW4pLT5yYl9ub2RlKSwgY2hhcjogKGNoYXIpMCwgdW5zaWduZWQgY2hh
cjogKHVuc2lnbmVkIGNoYXIpMCwgc2lnbmVkIGNoYXI6IChzaWduZWQgY2hhcikwLCB1bnNp
Z25lZCBzaG9ydDogKHVuc2lnbmVkIHNob3J0KTAsIHNpZ25lZCBzaG9ydDogKHNpZ25lZCBz
aG9ydCkwLCB1bnNpZ25lZCBpbnQ6ICh1bnNpZ25lZCBpbnQpMCwgc2lnbmVkIGludDogKHNp
Z25lZCBpbnQpMCwgdW5zaWduZWQgbG9uZzogKHVuc2lnbmVkIGxvbmcpMCwgc2lnbmVkIGxv
bmc6IChzaWduZWQgbG9uZykwLCB1bnNpZ25lZCBsb25nIGxvbmc6ICh1bnNpZ25lZCBsb25n
IGxvbmcpMCwgc2lnbmVkIGxvbmcgbG9uZzogKHNpZ25lZCBsb25nIGxvbmcpMCwgZGVmYXVs
dDogKCgma24tPmRpci5jaGlsZHJlbiktPnJiX25vZGUpKSkgX194ID0gKCooY29uc3Qgdm9s
YXRpbGUgdHlwZW9mKCBfR2VuZXJpYygoKCZrbi0+ZGlyLmNoaWxkcmVuKS0+cmJfbm9kZSks
IGNoYXI6IChjaGFyKTAsIHVuc2lnbmVkIGNoYXI6ICh1bnNpZ25lZCBjaGFyKTAsIHNpZ25l
ZCBjaGFyOiAoc2lnbmVkIGNoYXIpMCwgdW5zaWduZWQgc2hvcnQ6ICh1bnNpZ25lZCBzaG9y
dCkwLCBzaWduZWQgc2hvcnQ6IChzaWduZWQgc2hvcnQpMCwgdW5zaWduZWQgaW50OiAodW5z
aWduZWQgaW50KTAsIHNpZ25lZCBpbnQ6IChzaWduZWQgaW50KTAsIHVuc2lnbmVkIGxvbmc6
ICh1bnNpZ25lZCBsb25nKTAsIHNpZ25lZCBsb25nOiAoc2lnbmVkIGxvbmcpMCwgdW5zaWdu
ZWQgbG9uZyBsb25nOiAodW5zaWduZWQgbG9uZyBsb25nKTAsIHNpZ25lZCBsb25nIGxvbmc6
IChzaWduZWQgbG9uZyBsb25nKTAsIGRlZmF1bHQ6ICgoJmtuLT5kaXIuY2hpbGRyZW4pLT5y
Yl9ub2RlKSkpICopJigoJmtuLT5kaXIuY2hpbGRyZW4pLT5yYl9ub2RlKSk7IGRvIHsgfSB3
aGlsZSAoMCk7ICh0eXBlb2YoKCZrbi0+ZGlyLmNoaWxkcmVuKS0+cmJfbm9kZSkpX194OyB9
KTsgfSkgPT0gKCh2b2lkICopMCkpKTsgaWYgKF9fYnVpbHRpbl9leHBlY3QoISEoX19yZXRf
d2Fybl9vbiksIDApKSBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CSIgInR3aSAzMSwgMCwg
MCIgIlxuIiAiLnNlY3Rpb24gX19idWdfdGFibGUsXCJhd1wiXG4iICIyOlx0IiAiLjhieXRl
IiAiICIgIjFiLCAlMFxuIiAiXHQuc2hvcnQgJTEsICUyXG4iICIub3JnIDJiKyUzXG4iICIu
cHJldmlvdXNcbiIgOiA6ICJpIiAoIi4vaW5jbHVkZS9saW51eC9rZXJuZnMuaCIpLCAiaSIg
KDMzMSksICJpIiAoKDEgPDwgMCkgfCAoKDEgPDwgMSkgfCAoKDkpIDw8IDgpKSksICJpIiAo
c2l6ZW9mKHN0cnVjdCBidWdfZW50cnkpKSk7IF9fYnVpbHRpbl9leHBlY3QoISEoX19yZXRf
d2Fybl9vbiksIDApOyB9KTsKIGtuLT5mbGFncyB8PSBLRVJORlNfTlM7Cn0KCgoKCgoKCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSBib29sIGtlcm5mc19uc19lbmFibGVkKHN0cnVjdCBrZXJuZnNfbm9kZSAqa24p
CnsKIHJldHVybiBrbi0+ZmxhZ3MgJiBLRVJORlNfTlM7Cn0KCmludCBrZXJuZnNfbmFtZShz
dHJ1Y3Qga2VybmZzX25vZGUgKmtuLCBjaGFyICpidWYsIHNpemVfdCBidWZsZW4pOwppbnQg
a2VybmZzX3BhdGhfZnJvbV9ub2RlKHN0cnVjdCBrZXJuZnNfbm9kZSAqcm9vdF9rbiwgc3Ry
dWN0IGtlcm5mc19ub2RlICprbiwKICAgICBjaGFyICpidWYsIHNpemVfdCBidWZsZW4pOwp2
b2lkIHByX2NvbnRfa2VybmZzX25hbWUoc3RydWN0IGtlcm5mc19ub2RlICprbik7CnZvaWQg
cHJfY29udF9rZXJuZnNfcGF0aChzdHJ1Y3Qga2VybmZzX25vZGUgKmtuKTsKc3RydWN0IGtl
cm5mc19ub2RlICprZXJuZnNfZ2V0X3BhcmVudChzdHJ1Y3Qga2VybmZzX25vZGUgKmtuKTsK
c3RydWN0IGtlcm5mc19ub2RlICprZXJuZnNfZmluZF9hbmRfZ2V0X25zKHN0cnVjdCBrZXJu
ZnNfbm9kZSAqcGFyZW50LAogICAgICAgIGNvbnN0IGNoYXIgKm5hbWUsIGNvbnN0IHZvaWQg
Km5zKTsKc3RydWN0IGtlcm5mc19ub2RlICprZXJuZnNfd2Fsa19hbmRfZ2V0X25zKHN0cnVj
dCBrZXJuZnNfbm9kZSAqcGFyZW50LAogICAgICAgIGNvbnN0IGNoYXIgKnBhdGgsIGNvbnN0
IHZvaWQgKm5zKTsKdm9pZCBrZXJuZnNfZ2V0KHN0cnVjdCBrZXJuZnNfbm9kZSAqa24pOwp2
b2lkIGtlcm5mc19wdXQoc3RydWN0IGtlcm5mc19ub2RlICprbik7CgpzdHJ1Y3Qga2VybmZz
X25vZGUgKmtlcm5mc19ub2RlX2Zyb21fZGVudHJ5KHN0cnVjdCBkZW50cnkgKmRlbnRyeSk7
CnN0cnVjdCBrZXJuZnNfcm9vdCAqa2VybmZzX3Jvb3RfZnJvbV9zYihzdHJ1Y3Qgc3VwZXJf
YmxvY2sgKnNiKTsKc3RydWN0IGlub2RlICprZXJuZnNfZ2V0X2lub2RlKHN0cnVjdCBzdXBl
cl9ibG9jayAqc2IsIHN0cnVjdCBrZXJuZnNfbm9kZSAqa24pOwoKc3RydWN0IGRlbnRyeSAq
a2VybmZzX25vZGVfZGVudHJ5KHN0cnVjdCBrZXJuZnNfbm9kZSAqa24sCiAgICAgIHN0cnVj
dCBzdXBlcl9ibG9jayAqc2IpOwpzdHJ1Y3Qga2VybmZzX3Jvb3QgKmtlcm5mc19jcmVhdGVf
cm9vdChzdHJ1Y3Qga2VybmZzX3N5c2NhbGxfb3BzICpzY29wcywKICAgICAgICAgICB1bnNp
Z25lZCBpbnQgZmxhZ3MsIHZvaWQgKnByaXYpOwp2b2lkIGtlcm5mc19kZXN0cm95X3Jvb3Qo
c3RydWN0IGtlcm5mc19yb290ICpyb290KTsKCnN0cnVjdCBrZXJuZnNfbm9kZSAqa2VybmZz
X2NyZWF0ZV9kaXJfbnMoc3RydWN0IGtlcm5mc19ub2RlICpwYXJlbnQsCiAgICAgIGNvbnN0
IGNoYXIgKm5hbWUsIHVtb2RlX3QgbW9kZSwKICAgICAga3VpZF90IHVpZCwga2dpZF90IGdp
ZCwKICAgICAgdm9pZCAqcHJpdiwgY29uc3Qgdm9pZCAqbnMpOwpzdHJ1Y3Qga2VybmZzX25v
ZGUgKmtlcm5mc19jcmVhdGVfZW1wdHlfZGlyKHN0cnVjdCBrZXJuZnNfbm9kZSAqcGFyZW50
LAogICAgICAgICBjb25zdCBjaGFyICpuYW1lKTsKc3RydWN0IGtlcm5mc19ub2RlICpfX2tl
cm5mc19jcmVhdGVfZmlsZShzdHJ1Y3Qga2VybmZzX25vZGUgKnBhcmVudCwKICAgICAgY29u
c3QgY2hhciAqbmFtZSwgdW1vZGVfdCBtb2RlLAogICAgICBrdWlkX3QgdWlkLCBrZ2lkX3Qg
Z2lkLAogICAgICBsb2ZmX3Qgc2l6ZSwKICAgICAgY29uc3Qgc3RydWN0IGtlcm5mc19vcHMg
Km9wcywKICAgICAgdm9pZCAqcHJpdiwgY29uc3Qgdm9pZCAqbnMsCiAgICAgIHN0cnVjdCBs
b2NrX2NsYXNzX2tleSAqa2V5KTsKc3RydWN0IGtlcm5mc19ub2RlICprZXJuZnNfY3JlYXRl
X2xpbmsoc3RydWN0IGtlcm5mc19ub2RlICpwYXJlbnQsCiAgICAgICAgICAgY29uc3QgY2hh
ciAqbmFtZSwKICAgICAgICAgICBzdHJ1Y3Qga2VybmZzX25vZGUgKnRhcmdldCk7CnZvaWQg
a2VybmZzX2FjdGl2YXRlKHN0cnVjdCBrZXJuZnNfbm9kZSAqa24pOwp2b2lkIGtlcm5mc19y
ZW1vdmUoc3RydWN0IGtlcm5mc19ub2RlICprbik7CnZvaWQga2VybmZzX2JyZWFrX2FjdGl2
ZV9wcm90ZWN0aW9uKHN0cnVjdCBrZXJuZnNfbm9kZSAqa24pOwp2b2lkIGtlcm5mc191bmJy
ZWFrX2FjdGl2ZV9wcm90ZWN0aW9uKHN0cnVjdCBrZXJuZnNfbm9kZSAqa24pOwpib29sIGtl
cm5mc19yZW1vdmVfc2VsZihzdHJ1Y3Qga2VybmZzX25vZGUgKmtuKTsKaW50IGtlcm5mc19y
ZW1vdmVfYnlfbmFtZV9ucyhzdHJ1Y3Qga2VybmZzX25vZGUgKnBhcmVudCwgY29uc3QgY2hh
ciAqbmFtZSwKICAgICAgICBjb25zdCB2b2lkICpucyk7CmludCBrZXJuZnNfcmVuYW1lX25z
KHN0cnVjdCBrZXJuZnNfbm9kZSAqa24sIHN0cnVjdCBrZXJuZnNfbm9kZSAqbmV3X3BhcmVu
dCwKICAgICAgIGNvbnN0IGNoYXIgKm5ld19uYW1lLCBjb25zdCB2b2lkICpuZXdfbnMpOwpp
bnQga2VybmZzX3NldGF0dHIoc3RydWN0IGtlcm5mc19ub2RlICprbiwgY29uc3Qgc3RydWN0
IGlhdHRyICppYXR0cik7Cl9fcG9sbF90IGtlcm5mc19nZW5lcmljX3BvbGwoc3RydWN0IGtl
cm5mc19vcGVuX2ZpbGUgKm9mLAogICAgICAgIHN0cnVjdCBwb2xsX3RhYmxlX3N0cnVjdCAq
cHQpOwp2b2lkIGtlcm5mc19ub3RpZnkoc3RydWN0IGtlcm5mc19ub2RlICprbik7CgppbnQg
a2VybmZzX3hhdHRyX2dldChzdHJ1Y3Qga2VybmZzX25vZGUgKmtuLCBjb25zdCBjaGFyICpu
YW1lLAogICAgICAgdm9pZCAqdmFsdWUsIHNpemVfdCBzaXplKTsKaW50IGtlcm5mc194YXR0
cl9zZXQoc3RydWN0IGtlcm5mc19ub2RlICprbiwgY29uc3QgY2hhciAqbmFtZSwKICAgICAg
IGNvbnN0IHZvaWQgKnZhbHVlLCBzaXplX3Qgc2l6ZSwgaW50IGZsYWdzKTsKCmNvbnN0IHZv
aWQgKmtlcm5mc19zdXBlcl9ucyhzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiKTsKaW50IGtlcm5m
c19nZXRfdHJlZShzdHJ1Y3QgZnNfY29udGV4dCAqZmMpOwp2b2lkIGtlcm5mc19mcmVlX2Zz
X2NvbnRleHQoc3RydWN0IGZzX2NvbnRleHQgKmZjKTsKdm9pZCBrZXJuZnNfa2lsbF9zYihz
dHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiKTsKCnZvaWQga2VybmZzX2luaXQodm9pZCk7CgpzdHJ1
Y3Qga2VybmZzX25vZGUgKmtlcm5mc19maW5kX2FuZF9nZXRfbm9kZV9ieV9pZChzdHJ1Y3Qg
a2VybmZzX3Jvb3QgKnJvb3QsCiAgICAgICAgIHU2NCBpZCk7CiMgNTQwICIuL2luY2x1ZGUv
bGludXgva2VybmZzLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQga2VybmZzX3BhdGgoc3RydWN0IGtlcm5m
c19ub2RlICprbiwgY2hhciAqYnVmLCBzaXplX3QgYnVmbGVuKQp7CiByZXR1cm4ga2VybmZz
X3BhdGhfZnJvbV9ub2RlKGtuLCAoKHZvaWQgKikwKSwgYnVmLCBidWZsZW4pOwp9CgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgc3RydWN0IGtlcm5mc19ub2RlICoKa2VybmZzX2ZpbmRfYW5kX2dldChzdHJ1Y3Qg
a2VybmZzX25vZGUgKmtuLCBjb25zdCBjaGFyICpuYW1lKQp7CiByZXR1cm4ga2VybmZzX2Zp
bmRfYW5kX2dldF9ucyhrbiwgbmFtZSwgKCh2b2lkICopMCkpOwp9CgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3Ry
dWN0IGtlcm5mc19ub2RlICoKa2VybmZzX3dhbGtfYW5kX2dldChzdHJ1Y3Qga2VybmZzX25v
ZGUgKmtuLCBjb25zdCBjaGFyICpwYXRoKQp7CiByZXR1cm4ga2VybmZzX3dhbGtfYW5kX2dl
dF9ucyhrbiwgcGF0aCwgKCh2b2lkICopMCkpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IGtlcm5m
c19ub2RlICoKa2VybmZzX2NyZWF0ZV9kaXIoc3RydWN0IGtlcm5mc19ub2RlICpwYXJlbnQs
IGNvbnN0IGNoYXIgKm5hbWUsIHVtb2RlX3QgbW9kZSwKICAgIHZvaWQgKnByaXYpCnsKIHJl
dHVybiBrZXJuZnNfY3JlYXRlX2Rpcl9ucyhwYXJlbnQsIG5hbWUsIG1vZGUsCiAgICAgICAg
KGt1aWRfdCl7IDAgfSwgKGtnaWRfdCl7IDAgfSwKICAgICAgICBwcml2LCAoKHZvaWQgKikw
KSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3Qga2VybmZzX25vZGUgKgprZXJuZnNfY3JlYXRlX2Zp
bGVfbnMoc3RydWN0IGtlcm5mc19ub2RlICpwYXJlbnQsIGNvbnN0IGNoYXIgKm5hbWUsCiAg
ICAgICAgdW1vZGVfdCBtb2RlLCBrdWlkX3QgdWlkLCBrZ2lkX3QgZ2lkLAogICAgICAgIGxv
ZmZfdCBzaXplLCBjb25zdCBzdHJ1Y3Qga2VybmZzX29wcyAqb3BzLAogICAgICAgIHZvaWQg
KnByaXYsIGNvbnN0IHZvaWQgKm5zKQp7CiBzdHJ1Y3QgbG9ja19jbGFzc19rZXkgKmtleSA9
ICgodm9pZCAqKTApOwoKCgoKIHJldHVybiBfX2tlcm5mc19jcmVhdGVfZmlsZShwYXJlbnQs
IG5hbWUsIG1vZGUsIHVpZCwgZ2lkLAogICAgICAgIHNpemUsIG9wcywgcHJpdiwgbnMsIGtl
eSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3Qga2VybmZzX25vZGUgKgprZXJuZnNfY3JlYXRlX2Zp
bGUoc3RydWN0IGtlcm5mc19ub2RlICpwYXJlbnQsIGNvbnN0IGNoYXIgKm5hbWUsIHVtb2Rl
X3QgbW9kZSwKICAgICBsb2ZmX3Qgc2l6ZSwgY29uc3Qgc3RydWN0IGtlcm5mc19vcHMgKm9w
cywgdm9pZCAqcHJpdikKewogcmV0dXJuIGtlcm5mc19jcmVhdGVfZmlsZV9ucyhwYXJlbnQs
IG5hbWUsIG1vZGUsCiAgICAgICAgIChrdWlkX3QpeyAwIH0sIChrZ2lkX3QpeyAwIH0sCiAg
ICAgICAgIHNpemUsIG9wcywgcHJpdiwgKCh2b2lkICopMCkpOwp9CgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50
IGtlcm5mc19yZW1vdmVfYnlfbmFtZShzdHJ1Y3Qga2VybmZzX25vZGUgKnBhcmVudCwKICAg
ICBjb25zdCBjaGFyICpuYW1lKQp7CiByZXR1cm4ga2VybmZzX3JlbW92ZV9ieV9uYW1lX25z
KHBhcmVudCwgbmFtZSwgKCh2b2lkICopMCkpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGtlcm5mc19y
ZW5hbWUoc3RydWN0IGtlcm5mc19ub2RlICprbiwKICAgIHN0cnVjdCBrZXJuZnNfbm9kZSAq
bmV3X3BhcmVudCwKICAgIGNvbnN0IGNoYXIgKm5ld19uYW1lKQp7CiByZXR1cm4ga2VybmZz
X3JlbmFtZV9ucyhrbiwgbmV3X3BhcmVudCwgbmV3X25hbWUsICgodm9pZCAqKTApKTsKfQoj
IDE3ICIuL2luY2x1ZGUvbGludXgvc3lzZnMuaCIgMgoKCgoKIyAxICIuL2luY2x1ZGUvbGlu
dXgva29iamVjdF9ucy5oIiAxCiMgMTkgIi4vaW5jbHVkZS9saW51eC9rb2JqZWN0X25zLmgi
CnN0cnVjdCBzb2NrOwpzdHJ1Y3Qga29iamVjdDsKCgoKCgplbnVtIGtvYmpfbnNfdHlwZSB7
CiBLT0JKX05TX1RZUEVfTk9ORSA9IDAsCiBLT0JKX05TX1RZUEVfTkVULAogS09CSl9OU19U
WVBFUwp9OwojIDM5ICIuL2luY2x1ZGUvbGludXgva29iamVjdF9ucy5oIgpzdHJ1Y3Qga29i
al9uc190eXBlX29wZXJhdGlvbnMgewogZW51bSBrb2JqX25zX3R5cGUgdHlwZTsKIGJvb2wg
KCpjdXJyZW50X21heV9tb3VudCkodm9pZCk7CiB2b2lkICooKmdyYWJfY3VycmVudF9ucyko
dm9pZCk7CiBjb25zdCB2b2lkICooKm5ldGxpbmtfbnMpKHN0cnVjdCBzb2NrICpzayk7CiBj
b25zdCB2b2lkICooKmluaXRpYWxfbnMpKHZvaWQpOwogdm9pZCAoKmRyb3BfbnMpKHZvaWQg
Kik7Cn07CgppbnQga29ial9uc190eXBlX3JlZ2lzdGVyKGNvbnN0IHN0cnVjdCBrb2JqX25z
X3R5cGVfb3BlcmF0aW9ucyAqb3BzKTsKaW50IGtvYmpfbnNfdHlwZV9yZWdpc3RlcmVkKGVu
dW0ga29ial9uc190eXBlIHR5cGUpOwpjb25zdCBzdHJ1Y3Qga29ial9uc190eXBlX29wZXJh
dGlvbnMgKmtvYmpfY2hpbGRfbnNfb3BzKHN0cnVjdCBrb2JqZWN0ICpwYXJlbnQpOwpjb25z
dCBzdHJ1Y3Qga29ial9uc190eXBlX29wZXJhdGlvbnMgKmtvYmpfbnNfb3BzKHN0cnVjdCBr
b2JqZWN0ICprb2JqKTsKCmJvb2wga29ial9uc19jdXJyZW50X21heV9tb3VudChlbnVtIGtv
YmpfbnNfdHlwZSB0eXBlKTsKdm9pZCAqa29ial9uc19ncmFiX2N1cnJlbnQoZW51bSBrb2Jq
X25zX3R5cGUgdHlwZSk7CmNvbnN0IHZvaWQgKmtvYmpfbnNfbmV0bGluayhlbnVtIGtvYmpf
bnNfdHlwZSB0eXBlLCBzdHJ1Y3Qgc29jayAqc2spOwpjb25zdCB2b2lkICprb2JqX25zX2lu
aXRpYWwoZW51bSBrb2JqX25zX3R5cGUgdHlwZSk7CnZvaWQga29ial9uc19kcm9wKGVudW0g
a29ial9uc190eXBlIHR5cGUsIHZvaWQgKm5zKTsKIyAyMiAiLi9pbmNsdWRlL2xpbnV4L3N5
c2ZzLmgiIDIKCgoKc3RydWN0IGtvYmplY3Q7CnN0cnVjdCBtb2R1bGU7CnN0cnVjdCBiaW5f
YXR0cmlidXRlOwplbnVtIGtvYmpfbnNfdHlwZTsKCnN0cnVjdCBhdHRyaWJ1dGUgewogY29u
c3QgY2hhciAqbmFtZTsKIHVtb2RlX3QgbW9kZTsKCgoKCgp9OwojIDg0ICIuL2luY2x1ZGUv
bGludXgvc3lzZnMuaCIKc3RydWN0IGF0dHJpYnV0ZV9ncm91cCB7CiBjb25zdCBjaGFyICpu
YW1lOwogdW1vZGVfdCAoKmlzX3Zpc2libGUpKHN0cnVjdCBrb2JqZWN0ICosCiAgICAgICAg
ICAgc3RydWN0IGF0dHJpYnV0ZSAqLCBpbnQpOwogdW1vZGVfdCAoKmlzX2Jpbl92aXNpYmxl
KShzdHJ1Y3Qga29iamVjdCAqLAogICAgICAgIHN0cnVjdCBiaW5fYXR0cmlidXRlICosIGlu
dCk7CiBzdHJ1Y3QgYXR0cmlidXRlICoqYXR0cnM7CiBzdHJ1Y3QgYmluX2F0dHJpYnV0ZSAq
KmJpbl9hdHRyczsKfTsKIyAxNTggIi4vaW5jbHVkZS9saW51eC9zeXNmcy5oIgpzdHJ1Y3Qg
ZmlsZTsKc3RydWN0IHZtX2FyZWFfc3RydWN0OwoKc3RydWN0IGJpbl9hdHRyaWJ1dGUgewog
c3RydWN0IGF0dHJpYnV0ZSBhdHRyOwogc2l6ZV90IHNpemU7CiB2b2lkICpwcml2YXRlOwog
c3NpemVfdCAoKnJlYWQpKHN0cnVjdCBmaWxlICosIHN0cnVjdCBrb2JqZWN0ICosIHN0cnVj
dCBiaW5fYXR0cmlidXRlICosCiAgIGNoYXIgKiwgbG9mZl90LCBzaXplX3QpOwogc3NpemVf
dCAoKndyaXRlKShzdHJ1Y3QgZmlsZSAqLCBzdHJ1Y3Qga29iamVjdCAqLCBzdHJ1Y3QgYmlu
X2F0dHJpYnV0ZSAqLAogICAgY2hhciAqLCBsb2ZmX3QsIHNpemVfdCk7CiBpbnQgKCptbWFw
KShzdHJ1Y3QgZmlsZSAqLCBzdHJ1Y3Qga29iamVjdCAqLCBzdHJ1Y3QgYmluX2F0dHJpYnV0
ZSAqYXR0ciwKICAgICAgc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEpOwp9OwojIDIyMyAi
Li9pbmNsdWRlL2xpbnV4L3N5c2ZzLmgiCnN0cnVjdCBzeXNmc19vcHMgewogc3NpemVfdCAo
KnNob3cpKHN0cnVjdCBrb2JqZWN0ICosIHN0cnVjdCBhdHRyaWJ1dGUgKiwgY2hhciAqKTsK
IHNzaXplX3QgKCpzdG9yZSkoc3RydWN0IGtvYmplY3QgKiwgc3RydWN0IGF0dHJpYnV0ZSAq
LCBjb25zdCBjaGFyICosIHNpemVfdCk7Cn07CgoKCmludCBfX2F0dHJpYnV0ZV9fKChfX3dh
cm5fdW51c2VkX3Jlc3VsdF9fKSkgc3lzZnNfY3JlYXRlX2Rpcl9ucyhzdHJ1Y3Qga29iamVj
dCAqa29iaiwgY29uc3Qgdm9pZCAqbnMpOwp2b2lkIHN5c2ZzX3JlbW92ZV9kaXIoc3RydWN0
IGtvYmplY3QgKmtvYmopOwppbnQgX19hdHRyaWJ1dGVfXygoX193YXJuX3VudXNlZF9yZXN1
bHRfXykpIHN5c2ZzX3JlbmFtZV9kaXJfbnMoc3RydWN0IGtvYmplY3QgKmtvYmosIGNvbnN0
IGNoYXIgKm5ld19uYW1lLAogICAgICAgICBjb25zdCB2b2lkICpuZXdfbnMpOwppbnQgX19h
dHRyaWJ1dGVfXygoX193YXJuX3VudXNlZF9yZXN1bHRfXykpIHN5c2ZzX21vdmVfZGlyX25z
KHN0cnVjdCBrb2JqZWN0ICprb2JqLAogICAgICAgc3RydWN0IGtvYmplY3QgKm5ld19wYXJl
bnRfa29iaiwKICAgICAgIGNvbnN0IHZvaWQgKm5ld19ucyk7CmludCBfX2F0dHJpYnV0ZV9f
KChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkgc3lzZnNfY3JlYXRlX21vdW50X3BvaW50KHN0
cnVjdCBrb2JqZWN0ICpwYXJlbnRfa29iaiwKICAgICAgIGNvbnN0IGNoYXIgKm5hbWUpOwp2
b2lkIHN5c2ZzX3JlbW92ZV9tb3VudF9wb2ludChzdHJ1Y3Qga29iamVjdCAqcGFyZW50X2tv
YmosCiAgICAgICAgIGNvbnN0IGNoYXIgKm5hbWUpOwoKaW50IF9fYXR0cmlidXRlX18oKF9f
d2Fybl91bnVzZWRfcmVzdWx0X18pKSBzeXNmc19jcmVhdGVfZmlsZV9ucyhzdHJ1Y3Qga29i
amVjdCAqa29iaiwKICAgICAgICAgIGNvbnN0IHN0cnVjdCBhdHRyaWJ1dGUgKmF0dHIsCiAg
ICAgICAgICBjb25zdCB2b2lkICpucyk7CmludCBfX2F0dHJpYnV0ZV9fKChfX3dhcm5fdW51
c2VkX3Jlc3VsdF9fKSkgc3lzZnNfY3JlYXRlX2ZpbGVzKHN0cnVjdCBrb2JqZWN0ICprb2Jq
LAogICAgICAgY29uc3Qgc3RydWN0IGF0dHJpYnV0ZSAqIGNvbnN0ICphdHRyKTsKaW50IF9f
YXR0cmlidXRlX18oKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKSBzeXNmc19jaG1vZF9maWxl
KHN0cnVjdCBrb2JqZWN0ICprb2JqLAogICAgICBjb25zdCBzdHJ1Y3QgYXR0cmlidXRlICph
dHRyLCB1bW9kZV90IG1vZGUpOwpzdHJ1Y3Qga2VybmZzX25vZGUgKnN5c2ZzX2JyZWFrX2Fj
dGl2ZV9wcm90ZWN0aW9uKHN0cnVjdCBrb2JqZWN0ICprb2JqLAogICAgICAgIGNvbnN0IHN0
cnVjdCBhdHRyaWJ1dGUgKmF0dHIpOwp2b2lkIHN5c2ZzX3VuYnJlYWtfYWN0aXZlX3Byb3Rl
Y3Rpb24oc3RydWN0IGtlcm5mc19ub2RlICprbik7CnZvaWQgc3lzZnNfcmVtb3ZlX2ZpbGVf
bnMoc3RydWN0IGtvYmplY3QgKmtvYmosIGNvbnN0IHN0cnVjdCBhdHRyaWJ1dGUgKmF0dHIs
CiAgICAgY29uc3Qgdm9pZCAqbnMpOwpib29sIHN5c2ZzX3JlbW92ZV9maWxlX3NlbGYoc3Ry
dWN0IGtvYmplY3QgKmtvYmosIGNvbnN0IHN0cnVjdCBhdHRyaWJ1dGUgKmF0dHIpOwp2b2lk
IHN5c2ZzX3JlbW92ZV9maWxlcyhzdHJ1Y3Qga29iamVjdCAqa29iaiwgY29uc3Qgc3RydWN0
IGF0dHJpYnV0ZSAqIGNvbnN0ICphdHRyKTsKCmludCBfX2F0dHJpYnV0ZV9fKChfX3dhcm5f
dW51c2VkX3Jlc3VsdF9fKSkgc3lzZnNfY3JlYXRlX2Jpbl9maWxlKHN0cnVjdCBrb2JqZWN0
ICprb2JqLAogICAgICAgICAgIGNvbnN0IHN0cnVjdCBiaW5fYXR0cmlidXRlICphdHRyKTsK
dm9pZCBzeXNmc19yZW1vdmVfYmluX2ZpbGUoc3RydWN0IGtvYmplY3QgKmtvYmosCiAgICAg
IGNvbnN0IHN0cnVjdCBiaW5fYXR0cmlidXRlICphdHRyKTsKCmludCBfX2F0dHJpYnV0ZV9f
KChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkgc3lzZnNfY3JlYXRlX2xpbmsoc3RydWN0IGtv
YmplY3QgKmtvYmosIHN0cnVjdCBrb2JqZWN0ICp0YXJnZXQsCiAgICAgICBjb25zdCBjaGFy
ICpuYW1lKTsKaW50IF9fYXR0cmlidXRlX18oKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKSBz
eXNmc19jcmVhdGVfbGlua19ub3dhcm4oc3RydWN0IGtvYmplY3QgKmtvYmosCiAgICAgICBz
dHJ1Y3Qga29iamVjdCAqdGFyZ2V0LAogICAgICAgY29uc3QgY2hhciAqbmFtZSk7CnZvaWQg
c3lzZnNfcmVtb3ZlX2xpbmsoc3RydWN0IGtvYmplY3QgKmtvYmosIGNvbnN0IGNoYXIgKm5h
bWUpOwoKaW50IHN5c2ZzX3JlbmFtZV9saW5rX25zKHN0cnVjdCBrb2JqZWN0ICprb2JqLCBz
dHJ1Y3Qga29iamVjdCAqdGFyZ2V0LAogICAgY29uc3QgY2hhciAqb2xkX25hbWUsIGNvbnN0
IGNoYXIgKm5ld19uYW1lLAogICAgY29uc3Qgdm9pZCAqbmV3X25zKTsKCnZvaWQgc3lzZnNf
ZGVsZXRlX2xpbmsoc3RydWN0IGtvYmplY3QgKmRpciwgc3RydWN0IGtvYmplY3QgKnRhcmcs
CiAgIGNvbnN0IGNoYXIgKm5hbWUpOwoKaW50IF9fYXR0cmlidXRlX18oKF9fd2Fybl91bnVz
ZWRfcmVzdWx0X18pKSBzeXNmc19jcmVhdGVfZ3JvdXAoc3RydWN0IGtvYmplY3QgKmtvYmos
CiAgICAgICAgY29uc3Qgc3RydWN0IGF0dHJpYnV0ZV9ncm91cCAqZ3JwKTsKaW50IF9fYXR0
cmlidXRlX18oKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKSBzeXNmc19jcmVhdGVfZ3JvdXBz
KHN0cnVjdCBrb2JqZWN0ICprb2JqLAogICAgICAgICBjb25zdCBzdHJ1Y3QgYXR0cmlidXRl
X2dyb3VwICoqZ3JvdXBzKTsKaW50IF9fYXR0cmlidXRlX18oKF9fd2Fybl91bnVzZWRfcmVz
dWx0X18pKSBzeXNmc191cGRhdGVfZ3JvdXBzKHN0cnVjdCBrb2JqZWN0ICprb2JqLAogICAg
ICAgICBjb25zdCBzdHJ1Y3QgYXR0cmlidXRlX2dyb3VwICoqZ3JvdXBzKTsKaW50IHN5c2Zz
X3VwZGF0ZV9ncm91cChzdHJ1Y3Qga29iamVjdCAqa29iaiwKICAgICAgICAgY29uc3Qgc3Ry
dWN0IGF0dHJpYnV0ZV9ncm91cCAqZ3JwKTsKdm9pZCBzeXNmc19yZW1vdmVfZ3JvdXAoc3Ry
dWN0IGtvYmplY3QgKmtvYmosCiAgIGNvbnN0IHN0cnVjdCBhdHRyaWJ1dGVfZ3JvdXAgKmdy
cCk7CnZvaWQgc3lzZnNfcmVtb3ZlX2dyb3VwcyhzdHJ1Y3Qga29iamVjdCAqa29iaiwKICAg
IGNvbnN0IHN0cnVjdCBhdHRyaWJ1dGVfZ3JvdXAgKipncm91cHMpOwppbnQgc3lzZnNfYWRk
X2ZpbGVfdG9fZ3JvdXAoc3RydWN0IGtvYmplY3QgKmtvYmosCiAgIGNvbnN0IHN0cnVjdCBh
dHRyaWJ1dGUgKmF0dHIsIGNvbnN0IGNoYXIgKmdyb3VwKTsKdm9pZCBzeXNmc19yZW1vdmVf
ZmlsZV9mcm9tX2dyb3VwKHN0cnVjdCBrb2JqZWN0ICprb2JqLAogICBjb25zdCBzdHJ1Y3Qg
YXR0cmlidXRlICphdHRyLCBjb25zdCBjaGFyICpncm91cCk7CmludCBzeXNmc19tZXJnZV9n
cm91cChzdHJ1Y3Qga29iamVjdCAqa29iaiwKICAgICAgICAgY29uc3Qgc3RydWN0IGF0dHJp
YnV0ZV9ncm91cCAqZ3JwKTsKdm9pZCBzeXNmc191bm1lcmdlX2dyb3VwKHN0cnVjdCBrb2Jq
ZWN0ICprb2JqLAogICAgICAgICBjb25zdCBzdHJ1Y3QgYXR0cmlidXRlX2dyb3VwICpncnAp
OwppbnQgc3lzZnNfYWRkX2xpbmtfdG9fZ3JvdXAoc3RydWN0IGtvYmplY3QgKmtvYmosIGNv
bnN0IGNoYXIgKmdyb3VwX25hbWUsCiAgICAgICBzdHJ1Y3Qga29iamVjdCAqdGFyZ2V0LCBj
b25zdCBjaGFyICpsaW5rX25hbWUpOwp2b2lkIHN5c2ZzX3JlbW92ZV9saW5rX2Zyb21fZ3Jv
dXAoc3RydWN0IGtvYmplY3QgKmtvYmosIGNvbnN0IGNoYXIgKmdyb3VwX25hbWUsCiAgICAg
IGNvbnN0IGNoYXIgKmxpbmtfbmFtZSk7CmludCBjb21wYXRfb25seV9zeXNmc19saW5rX2Vu
dHJ5X3RvX2tvYmooc3RydWN0IGtvYmplY3QgKmtvYmosCiAgICAgIHN0cnVjdCBrb2JqZWN0
ICp0YXJnZXRfa29iaiwKICAgICAgY29uc3QgY2hhciAqdGFyZ2V0X25hbWUsCiAgICAgIGNv
bnN0IGNoYXIgKnN5bWxpbmtfbmFtZSk7Cgp2b2lkIHN5c2ZzX25vdGlmeShzdHJ1Y3Qga29i
amVjdCAqa29iaiwgY29uc3QgY2hhciAqZGlyLCBjb25zdCBjaGFyICphdHRyKTsKCmludCBf
X2F0dHJpYnV0ZV9fKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkgc3lzZnNfaW5pdCh2b2lk
KTsKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSB2b2lkIHN5c2ZzX2VuYWJsZV9ucyhzdHJ1Y3Qga2VybmZzX25vZGUg
KmtuKQp7CiByZXR1cm4ga2VybmZzX2VuYWJsZV9ucyhrbik7Cn0KCmludCBzeXNmc19maWxl
X2NoYW5nZV9vd25lcihzdHJ1Y3Qga29iamVjdCAqa29iaiwgY29uc3QgY2hhciAqbmFtZSwg
a3VpZF90IGt1aWQsCiAgICAgICBrZ2lkX3Qga2dpZCk7CmludCBzeXNmc19jaGFuZ2Vfb3du
ZXIoc3RydWN0IGtvYmplY3QgKmtvYmosIGt1aWRfdCBrdWlkLCBrZ2lkX3Qga2dpZCk7Cmlu
dCBzeXNmc19saW5rX2NoYW5nZV9vd25lcihzdHJ1Y3Qga29iamVjdCAqa29iaiwgc3RydWN0
IGtvYmplY3QgKnRhcmcsCiAgICAgICBjb25zdCBjaGFyICpuYW1lLCBrdWlkX3Qga3VpZCwg
a2dpZF90IGtnaWQpOwppbnQgc3lzZnNfZ3JvdXBzX2NoYW5nZV9vd25lcihzdHJ1Y3Qga29i
amVjdCAqa29iaiwKICAgICAgICAgY29uc3Qgc3RydWN0IGF0dHJpYnV0ZV9ncm91cCAqKmdy
b3VwcywKICAgICAgICAga3VpZF90IGt1aWQsIGtnaWRfdCBrZ2lkKTsKaW50IHN5c2ZzX2dy
b3VwX2NoYW5nZV9vd25lcihzdHJ1Y3Qga29iamVjdCAqa29iaiwKICAgICAgICBjb25zdCBz
dHJ1Y3QgYXR0cmlidXRlX2dyb3VwICpncm91cHMsIGt1aWRfdCBrdWlkLAogICAgICAgIGtn
aWRfdCBrZ2lkKTsKIyA1NzQgIi4vaW5jbHVkZS9saW51eC9zeXNmcy5oIgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
aW50IF9fYXR0cmlidXRlX18oKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKSBzeXNmc19jcmVh
dGVfZmlsZShzdHJ1Y3Qga29iamVjdCAqa29iaiwKICAgICAgIGNvbnN0IHN0cnVjdCBhdHRy
aWJ1dGUgKmF0dHIpCnsKIHJldHVybiBzeXNmc19jcmVhdGVfZmlsZV9ucyhrb2JqLCBhdHRy
LCAoKHZvaWQgKikwKSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHN5c2ZzX3JlbW92ZV9maWxlKHN0
cnVjdCBrb2JqZWN0ICprb2JqLAogICAgICAgICBjb25zdCBzdHJ1Y3QgYXR0cmlidXRlICph
dHRyKQp7CiBzeXNmc19yZW1vdmVfZmlsZV9ucyhrb2JqLCBhdHRyLCAoKHZvaWQgKikwKSk7
Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSBpbnQgc3lzZnNfcmVuYW1lX2xpbmsoc3RydWN0IGtvYmplY3QgKmtv
YmosIHN0cnVjdCBrb2JqZWN0ICp0YXJnZXQsCiAgICAgICAgY29uc3QgY2hhciAqb2xkX25h
bWUsIGNvbnN0IGNoYXIgKm5ld19uYW1lKQp7CiByZXR1cm4gc3lzZnNfcmVuYW1lX2xpbmtf
bnMoa29iaiwgdGFyZ2V0LCBvbGRfbmFtZSwgbmV3X25hbWUsICgodm9pZCAqKTApKTsKfQoK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIHZvaWQgc3lzZnNfbm90aWZ5X2RpcmVudChzdHJ1Y3Qga2VybmZzX25vZGUg
KmtuKQp7CiBrZXJuZnNfbm90aWZ5KGtuKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHN0cnVjdCBrZXJuZnNf
bm9kZSAqc3lzZnNfZ2V0X2RpcmVudChzdHJ1Y3Qga2VybmZzX25vZGUgKnBhcmVudCwKICAg
ICAgICAgY29uc3QgY2hhciAqbmFtZSkKewogcmV0dXJuIGtlcm5mc19maW5kX2FuZF9nZXQo
cGFyZW50LCBuYW1lKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHN0cnVjdCBrZXJuZnNfbm9kZSAqc3lzZnNf
Z2V0KHN0cnVjdCBrZXJuZnNfbm9kZSAqa24pCnsKIGtlcm5mc19nZXQoa24pOwogcmV0dXJu
IGtuOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBzeXNmc19wdXQoc3RydWN0IGtlcm5mc19ub2RlICpr
bikKewoga2VybmZzX3B1dChrbik7Cn0KIyAyMSAiLi9pbmNsdWRlL2xpbnV4L2tvYmplY3Qu
aCIgMgojIDQxICIuL2luY2x1ZGUvbGludXgva29iamVjdC5oIgpleHRlcm4gdTY0IHVldmVu
dF9zZXFudW07CiMgNTMgIi4vaW5jbHVkZS9saW51eC9rb2JqZWN0LmgiCmVudW0ga29iamVj
dF9hY3Rpb24gewogS09CSl9BREQsCiBLT0JKX1JFTU9WRSwKIEtPQkpfQ0hBTkdFLAogS09C
Sl9NT1ZFLAogS09CSl9PTkxJTkUsCiBLT0JKX09GRkxJTkUsCiBLT0JKX0JJTkQsCiBLT0JK
X1VOQklORCwKIEtPQkpfTUFYCn07CgpzdHJ1Y3Qga29iamVjdCB7CiBjb25zdCBjaGFyICpu
YW1lOwogc3RydWN0IGxpc3RfaGVhZCBlbnRyeTsKIHN0cnVjdCBrb2JqZWN0ICpwYXJlbnQ7
CiBzdHJ1Y3Qga3NldCAqa3NldDsKIHN0cnVjdCBrb2JqX3R5cGUgKmt0eXBlOwogc3RydWN0
IGtlcm5mc19ub2RlICpzZDsKIHN0cnVjdCBrcmVmIGtyZWY7CgoKCiB1bnNpZ25lZCBpbnQg
c3RhdGVfaW5pdGlhbGl6ZWQ6MTsKIHVuc2lnbmVkIGludCBzdGF0ZV9pbl9zeXNmczoxOwog
dW5zaWduZWQgaW50IHN0YXRlX2FkZF91ZXZlbnRfc2VudDoxOwogdW5zaWduZWQgaW50IHN0
YXRlX3JlbW92ZV91ZXZlbnRfc2VudDoxOwogdW5zaWduZWQgaW50IHVldmVudF9zdXBwcmVz
czoxOwp9OwoKZXh0ZXJuIF9fYXR0cmlidXRlX18oKF9fZm9ybWF0X18ocHJpbnRmLCAyLCAz
KSkpCmludCBrb2JqZWN0X3NldF9uYW1lKHN0cnVjdCBrb2JqZWN0ICprb2JqLCBjb25zdCBj
aGFyICpuYW1lLCAuLi4pOwpleHRlcm4gX19hdHRyaWJ1dGVfXygoX19mb3JtYXRfXyhwcmlu
dGYsIDIsIDApKSkKaW50IGtvYmplY3Rfc2V0X25hbWVfdmFyZ3Moc3RydWN0IGtvYmplY3Qg
KmtvYmosIGNvbnN0IGNoYXIgKmZtdCwKICAgICAgdmFfbGlzdCB2YXJncyk7CgpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgY29uc3QgY2hhciAqa29iamVjdF9uYW1lKGNvbnN0IHN0cnVjdCBrb2JqZWN0ICprb2Jq
KQp7CiByZXR1cm4ga29iai0+bmFtZTsKfQoKZXh0ZXJuIHZvaWQga29iamVjdF9pbml0KHN0
cnVjdCBrb2JqZWN0ICprb2JqLCBzdHJ1Y3Qga29ial90eXBlICprdHlwZSk7CmV4dGVybiBf
X2F0dHJpYnV0ZV9fKChfX2Zvcm1hdF9fKHByaW50ZiwgMywgNCkpKSBfX2F0dHJpYnV0ZV9f
KChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkKaW50IGtvYmplY3RfYWRkKHN0cnVjdCBrb2Jq
ZWN0ICprb2JqLCBzdHJ1Y3Qga29iamVjdCAqcGFyZW50LAogIGNvbnN0IGNoYXIgKmZtdCwg
Li4uKTsKZXh0ZXJuIF9fYXR0cmlidXRlX18oKF9fZm9ybWF0X18ocHJpbnRmLCA0LCA1KSkp
IF9fYXR0cmlidXRlX18oKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKQppbnQga29iamVjdF9p
bml0X2FuZF9hZGQoc3RydWN0IGtvYmplY3QgKmtvYmosCiAgICBzdHJ1Y3Qga29ial90eXBl
ICprdHlwZSwgc3RydWN0IGtvYmplY3QgKnBhcmVudCwKICAgIGNvbnN0IGNoYXIgKmZtdCwg
Li4uKTsKCmV4dGVybiB2b2lkIGtvYmplY3RfZGVsKHN0cnVjdCBrb2JqZWN0ICprb2JqKTsK
CmV4dGVybiBzdHJ1Y3Qga29iamVjdCAqIF9fYXR0cmlidXRlX18oKF9fd2Fybl91bnVzZWRf
cmVzdWx0X18pKSBrb2JqZWN0X2NyZWF0ZSh2b2lkKTsKZXh0ZXJuIHN0cnVjdCBrb2JqZWN0
ICogX19hdHRyaWJ1dGVfXygoX193YXJuX3VudXNlZF9yZXN1bHRfXykpIGtvYmplY3RfY3Jl
YXRlX2FuZF9hZGQoY29uc3QgY2hhciAqbmFtZSwKICAgICAgc3RydWN0IGtvYmplY3QgKnBh
cmVudCk7CgpleHRlcm4gaW50IF9fYXR0cmlidXRlX18oKF9fd2Fybl91bnVzZWRfcmVzdWx0
X18pKSBrb2JqZWN0X3JlbmFtZShzdHJ1Y3Qga29iamVjdCAqLCBjb25zdCBjaGFyICpuZXdf
bmFtZSk7CmV4dGVybiBpbnQgX19hdHRyaWJ1dGVfXygoX193YXJuX3VudXNlZF9yZXN1bHRf
XykpIGtvYmplY3RfbW92ZShzdHJ1Y3Qga29iamVjdCAqLCBzdHJ1Y3Qga29iamVjdCAqKTsK
CmV4dGVybiBzdHJ1Y3Qga29iamVjdCAqa29iamVjdF9nZXQoc3RydWN0IGtvYmplY3QgKmtv
YmopOwpleHRlcm4gc3RydWN0IGtvYmplY3QgKiBfX2F0dHJpYnV0ZV9fKChfX3dhcm5fdW51
c2VkX3Jlc3VsdF9fKSkga29iamVjdF9nZXRfdW5sZXNzX3plcm8oCiAgICAgIHN0cnVjdCBr
b2JqZWN0ICprb2JqKTsKZXh0ZXJuIHZvaWQga29iamVjdF9wdXQoc3RydWN0IGtvYmplY3Qg
KmtvYmopOwoKZXh0ZXJuIGNvbnN0IHZvaWQgKmtvYmplY3RfbmFtZXNwYWNlKHN0cnVjdCBr
b2JqZWN0ICprb2JqKTsKZXh0ZXJuIHZvaWQga29iamVjdF9nZXRfb3duZXJzaGlwKHN0cnVj
dCBrb2JqZWN0ICprb2JqLAogICAgICBrdWlkX3QgKnVpZCwga2dpZF90ICpnaWQpOwpleHRl
cm4gY2hhciAqa29iamVjdF9nZXRfcGF0aChzdHJ1Y3Qga29iamVjdCAqa29iaiwgZ2ZwX3Qg
ZmxhZyk7CiMgMTMyICIuL2luY2x1ZGUvbGludXgva29iamVjdC5oIgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9v
bCBrb2JqZWN0X2hhc19jaGlsZHJlbihzdHJ1Y3Qga29iamVjdCAqa29iaikKewogKHsgaW50
IF9fcmV0X3dhcm5fb24gPSAhIShrcmVmX3JlYWQoJmtvYmotPmtyZWYpID09IDApOyBpZiAo
X19idWlsdGluX2V4cGVjdCghIShfX3JldF93YXJuX29uKSwgMCkpIF9fYXNtX18gX192b2xh
dGlsZV9fKCAiMToJIiAidHdpIDMxLCAwLCAwIiAiXG4iICIuc2VjdGlvbiBfX2J1Z190YWJs
ZSxcImF3XCJcbiIgIjI6XHQiICIuOGJ5dGUiICIgIiAiMWIsICUwXG4iICJcdC5zaG9ydCAl
MSwgJTJcbiIgIi5vcmcgMmIrJTNcbiIgIi5wcmV2aW91c1xuIiA6IDogImkiICgiLi9pbmNs
dWRlL2xpbnV4L2tvYmplY3QuaCIpLCAiaSIgKDEzNCksICJpIiAoKDEgPDwgMCkgfCAoKDEg
PDwgMSkgfCAoKDkpIDw8IDgpKSksICJpIiAoc2l6ZW9mKHN0cnVjdCBidWdfZW50cnkpKSk7
IF9fYnVpbHRpbl9leHBlY3QoISEoX19yZXRfd2Fybl9vbiksIDApOyB9KTsKCiByZXR1cm4g
a29iai0+c2QgJiYga29iai0+c2QtPmRpci5zdWJkaXJzOwp9CgpzdHJ1Y3Qga29ial90eXBl
IHsKIHZvaWQgKCpyZWxlYXNlKShzdHJ1Y3Qga29iamVjdCAqa29iaik7CiBjb25zdCBzdHJ1
Y3Qgc3lzZnNfb3BzICpzeXNmc19vcHM7CiBzdHJ1Y3QgYXR0cmlidXRlICoqZGVmYXVsdF9h
dHRyczsKIGNvbnN0IHN0cnVjdCBhdHRyaWJ1dGVfZ3JvdXAgKipkZWZhdWx0X2dyb3VwczsK
IGNvbnN0IHN0cnVjdCBrb2JqX25zX3R5cGVfb3BlcmF0aW9ucyAqKCpjaGlsZF9uc190eXBl
KShzdHJ1Y3Qga29iamVjdCAqa29iaik7CiBjb25zdCB2b2lkICooKm5hbWVzcGFjZSkoc3Ry
dWN0IGtvYmplY3QgKmtvYmopOwogdm9pZCAoKmdldF9vd25lcnNoaXApKHN0cnVjdCBrb2Jq
ZWN0ICprb2JqLCBrdWlkX3QgKnVpZCwga2dpZF90ICpnaWQpOwp9OwoKc3RydWN0IGtvYmpf
dWV2ZW50X2VudiB7CiBjaGFyICphcmd2WzNdOwogY2hhciAqZW52cFs2NF07CiBpbnQgZW52
cF9pZHg7CiBjaGFyIGJ1ZlsyMDQ4XTsKIGludCBidWZsZW47Cn07CgpzdHJ1Y3Qga3NldF91
ZXZlbnRfb3BzIHsKIGludCAoKiBjb25zdCBmaWx0ZXIpKHN0cnVjdCBrc2V0ICprc2V0LCBz
dHJ1Y3Qga29iamVjdCAqa29iaik7CiBjb25zdCBjaGFyICooKiBjb25zdCBuYW1lKShzdHJ1
Y3Qga3NldCAqa3NldCwgc3RydWN0IGtvYmplY3QgKmtvYmopOwogaW50ICgqIGNvbnN0IHVl
dmVudCkoc3RydWN0IGtzZXQgKmtzZXQsIHN0cnVjdCBrb2JqZWN0ICprb2JqLAogICAgICAg
IHN0cnVjdCBrb2JqX3VldmVudF9lbnYgKmVudik7Cn07CgpzdHJ1Y3Qga29ial9hdHRyaWJ1
dGUgewogc3RydWN0IGF0dHJpYnV0ZSBhdHRyOwogc3NpemVfdCAoKnNob3cpKHN0cnVjdCBr
b2JqZWN0ICprb2JqLCBzdHJ1Y3Qga29ial9hdHRyaWJ1dGUgKmF0dHIsCiAgIGNoYXIgKmJ1
Zik7CiBzc2l6ZV90ICgqc3RvcmUpKHN0cnVjdCBrb2JqZWN0ICprb2JqLCBzdHJ1Y3Qga29i
al9hdHRyaWJ1dGUgKmF0dHIsCiAgICBjb25zdCBjaGFyICpidWYsIHNpemVfdCBjb3VudCk7
Cn07CgpleHRlcm4gY29uc3Qgc3RydWN0IHN5c2ZzX29wcyBrb2JqX3N5c2ZzX29wczsKCnN0
cnVjdCBzb2NrOwojIDE5MyAiLi9pbmNsdWRlL2xpbnV4L2tvYmplY3QuaCIKc3RydWN0IGtz
ZXQgewogc3RydWN0IGxpc3RfaGVhZCBsaXN0Owogc3BpbmxvY2tfdCBsaXN0X2xvY2s7CiBz
dHJ1Y3Qga29iamVjdCBrb2JqOwogY29uc3Qgc3RydWN0IGtzZXRfdWV2ZW50X29wcyAqdWV2
ZW50X29wczsKfSA7CgpleHRlcm4gdm9pZCBrc2V0X2luaXQoc3RydWN0IGtzZXQgKmtzZXQp
OwpleHRlcm4gaW50IF9fYXR0cmlidXRlX18oKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKSBr
c2V0X3JlZ2lzdGVyKHN0cnVjdCBrc2V0ICprc2V0KTsKZXh0ZXJuIHZvaWQga3NldF91bnJl
Z2lzdGVyKHN0cnVjdCBrc2V0ICprc2V0KTsKZXh0ZXJuIHN0cnVjdCBrc2V0ICogX19hdHRy
aWJ1dGVfXygoX193YXJuX3VudXNlZF9yZXN1bHRfXykpIGtzZXRfY3JlYXRlX2FuZF9hZGQo
Y29uc3QgY2hhciAqbmFtZSwKICAgICAgY29uc3Qgc3RydWN0IGtzZXRfdWV2ZW50X29wcyAq
dSwKICAgICAgc3RydWN0IGtvYmplY3QgKnBhcmVudF9rb2JqKTsKCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1
Y3Qga3NldCAqdG9fa3NldChzdHJ1Y3Qga29iamVjdCAqa29iaikKewogcmV0dXJuIGtvYmog
PyAoeyB2b2lkICpfX21wdHIgPSAodm9pZCAqKShrb2JqKTsgZG8geyBleHRlcm4gdm9pZCBf
X2NvbXBpbGV0aW1lX2Fzc2VydF8xODQodm9pZCkgX19hdHRyaWJ1dGVfXygoX19lcnJvcl9f
KCJwb2ludGVyIHR5cGUgbWlzbWF0Y2ggaW4gY29udGFpbmVyX29mKCkiKSkpOyBpZiAoISgh
KCFfX2J1aWx0aW5fdHlwZXNfY29tcGF0aWJsZV9wKHR5cGVvZigqKGtvYmopKSwgdHlwZW9m
KCgoc3RydWN0IGtzZXQgKikwKS0+a29iaikpICYmICFfX2J1aWx0aW5fdHlwZXNfY29tcGF0
aWJsZV9wKHR5cGVvZigqKGtvYmopKSwgdHlwZW9mKHZvaWQpKSkpKSBfX2NvbXBpbGV0aW1l
X2Fzc2VydF8xODQoKTsgfSB3aGlsZSAoMCk7ICgoc3RydWN0IGtzZXQgKikoX19tcHRyIC0g
X19idWlsdGluX29mZnNldG9mKHN0cnVjdCBrc2V0LCBrb2JqKSkpOyB9KSA6ICgodm9pZCAq
KTApOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IGtzZXQgKmtzZXRfZ2V0KHN0cnVjdCBrc2V0ICpr
KQp7CiByZXR1cm4gayA/IHRvX2tzZXQoa29iamVjdF9nZXQoJmstPmtvYmopKSA6ICgodm9p
ZCAqKTApOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBrc2V0X3B1dChzdHJ1Y3Qga3NldCAqaykKewog
a29iamVjdF9wdXQoJmstPmtvYmopOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IGtvYmpfdHlwZSAq
Z2V0X2t0eXBlKHN0cnVjdCBrb2JqZWN0ICprb2JqKQp7CiByZXR1cm4ga29iai0+a3R5cGU7
Cn0KCmV4dGVybiBzdHJ1Y3Qga29iamVjdCAqa3NldF9maW5kX29iaihzdHJ1Y3Qga3NldCAq
LCBjb25zdCBjaGFyICopOwoKCmV4dGVybiBzdHJ1Y3Qga29iamVjdCAqa2VybmVsX2tvYmo7
CgpleHRlcm4gc3RydWN0IGtvYmplY3QgKm1tX2tvYmo7CgpleHRlcm4gc3RydWN0IGtvYmpl
Y3QgKmh5cGVydmlzb3Jfa29iajsKCmV4dGVybiBzdHJ1Y3Qga29iamVjdCAqcG93ZXJfa29i
ajsKCmV4dGVybiBzdHJ1Y3Qga29iamVjdCAqZmlybXdhcmVfa29iajsKCmludCBrb2JqZWN0
X3VldmVudChzdHJ1Y3Qga29iamVjdCAqa29iaiwgZW51bSBrb2JqZWN0X2FjdGlvbiBhY3Rp
b24pOwppbnQga29iamVjdF91ZXZlbnRfZW52KHN0cnVjdCBrb2JqZWN0ICprb2JqLCBlbnVt
IGtvYmplY3RfYWN0aW9uIGFjdGlvbiwKICAgY2hhciAqZW52cFtdKTsKaW50IGtvYmplY3Rf
c3ludGhfdWV2ZW50KHN0cnVjdCBrb2JqZWN0ICprb2JqLCBjb25zdCBjaGFyICpidWYsIHNp
emVfdCBjb3VudCk7CgpfX2F0dHJpYnV0ZV9fKChfX2Zvcm1hdF9fKHByaW50ZiwgMiwgMykp
KQppbnQgYWRkX3VldmVudF92YXIoc3RydWN0IGtvYmpfdWV2ZW50X2VudiAqZW52LCBjb25z
dCBjaGFyICpmb3JtYXQsIC4uLik7CiMgMTggIi4vaW5jbHVkZS9saW51eC9kZXZpY2UuaCIg
MgojIDEgIi4vaW5jbHVkZS9saW51eC9rbGlzdC5oIiAxCiMgMTcgIi4vaW5jbHVkZS9saW51
eC9rbGlzdC5oIgpzdHJ1Y3Qga2xpc3Rfbm9kZTsKc3RydWN0IGtsaXN0IHsKIHNwaW5sb2Nr
X3Qga19sb2NrOwogc3RydWN0IGxpc3RfaGVhZCBrX2xpc3Q7CiB2b2lkICgqZ2V0KShzdHJ1
Y3Qga2xpc3Rfbm9kZSAqKTsKIHZvaWQgKCpwdXQpKHN0cnVjdCBrbGlzdF9ub2RlICopOwp9
IF9fYXR0cmlidXRlX18gKChhbGlnbmVkIChzaXplb2Yodm9pZCAqKSkpKTsKIyAzNCAiLi9p
bmNsdWRlL2xpbnV4L2tsaXN0LmgiCmV4dGVybiB2b2lkIGtsaXN0X2luaXQoc3RydWN0IGts
aXN0ICprLCB2b2lkICgqZ2V0KShzdHJ1Y3Qga2xpc3Rfbm9kZSAqKSwKICAgICAgICAgdm9p
ZCAoKnB1dCkoc3RydWN0IGtsaXN0X25vZGUgKikpOwoKc3RydWN0IGtsaXN0X25vZGUgewog
dm9pZCAqbl9rbGlzdDsKIHN0cnVjdCBsaXN0X2hlYWQgbl9ub2RlOwogc3RydWN0IGtyZWYg
bl9yZWY7Cn07CgpleHRlcm4gdm9pZCBrbGlzdF9hZGRfdGFpbChzdHJ1Y3Qga2xpc3Rfbm9k
ZSAqbiwgc3RydWN0IGtsaXN0ICprKTsKZXh0ZXJuIHZvaWQga2xpc3RfYWRkX2hlYWQoc3Ry
dWN0IGtsaXN0X25vZGUgKm4sIHN0cnVjdCBrbGlzdCAqayk7CmV4dGVybiB2b2lkIGtsaXN0
X2FkZF9iZWhpbmQoc3RydWN0IGtsaXN0X25vZGUgKm4sIHN0cnVjdCBrbGlzdF9ub2RlICpw
b3MpOwpleHRlcm4gdm9pZCBrbGlzdF9hZGRfYmVmb3JlKHN0cnVjdCBrbGlzdF9ub2RlICpu
LCBzdHJ1Y3Qga2xpc3Rfbm9kZSAqcG9zKTsKCmV4dGVybiB2b2lkIGtsaXN0X2RlbChzdHJ1
Y3Qga2xpc3Rfbm9kZSAqbik7CmV4dGVybiB2b2lkIGtsaXN0X3JlbW92ZShzdHJ1Y3Qga2xp
c3Rfbm9kZSAqbik7CgpleHRlcm4gaW50IGtsaXN0X25vZGVfYXR0YWNoZWQoc3RydWN0IGts
aXN0X25vZGUgKm4pOwoKCnN0cnVjdCBrbGlzdF9pdGVyIHsKIHN0cnVjdCBrbGlzdCAqaV9r
bGlzdDsKIHN0cnVjdCBrbGlzdF9ub2RlICppX2N1cjsKfTsKCgpleHRlcm4gdm9pZCBrbGlz
dF9pdGVyX2luaXQoc3RydWN0IGtsaXN0ICprLCBzdHJ1Y3Qga2xpc3RfaXRlciAqaSk7CmV4
dGVybiB2b2lkIGtsaXN0X2l0ZXJfaW5pdF9ub2RlKHN0cnVjdCBrbGlzdCAqaywgc3RydWN0
IGtsaXN0X2l0ZXIgKmksCiAgICAgc3RydWN0IGtsaXN0X25vZGUgKm4pOwpleHRlcm4gdm9p
ZCBrbGlzdF9pdGVyX2V4aXQoc3RydWN0IGtsaXN0X2l0ZXIgKmkpOwpleHRlcm4gc3RydWN0
IGtsaXN0X25vZGUgKmtsaXN0X3ByZXYoc3RydWN0IGtsaXN0X2l0ZXIgKmkpOwpleHRlcm4g
c3RydWN0IGtsaXN0X25vZGUgKmtsaXN0X25leHQoc3RydWN0IGtsaXN0X2l0ZXIgKmkpOwoj
IDE5ICIuL2luY2x1ZGUvbGludXgvZGV2aWNlLmgiIDIKCgoKCgojIDEgIi4vaW5jbHVkZS9s
aW51eC9wbS5oIiAxCiMgMjIgIi4vaW5jbHVkZS9saW51eC9wbS5oIgpleHRlcm4gdm9pZCAo
KnBtX3Bvd2VyX29mZikodm9pZCk7CmV4dGVybiB2b2lkICgqcG1fcG93ZXJfb2ZmX3ByZXBh
cmUpKHZvaWQpOwoKc3RydWN0IGRldmljZTsKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHBtX3Z0X3N3
aXRjaF9yZXF1aXJlZChzdHJ1Y3QgZGV2aWNlICpkZXYsIGJvb2wgcmVxdWlyZWQpCnsKfQpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgdm9pZCBwbV92dF9zd2l0Y2hfdW5yZWdpc3RlcihzdHJ1Y3QgZGV2aWNlICpk
ZXYpCnsKfQoKCgoKCgpzdHJ1Y3QgZGV2aWNlOwoKCgoKCgoKdHlwZWRlZiBzdHJ1Y3QgcG1f
bWVzc2FnZSB7CiBpbnQgZXZlbnQ7Cn0gcG1fbWVzc2FnZV90OwojIDI3OCAiLi9pbmNsdWRl
L2xpbnV4L3BtLmgiCnN0cnVjdCBkZXZfcG1fb3BzIHsKIGludCAoKnByZXBhcmUpKHN0cnVj
dCBkZXZpY2UgKmRldik7CiB2b2lkICgqY29tcGxldGUpKHN0cnVjdCBkZXZpY2UgKmRldik7
CiBpbnQgKCpzdXNwZW5kKShzdHJ1Y3QgZGV2aWNlICpkZXYpOwogaW50ICgqcmVzdW1lKShz
dHJ1Y3QgZGV2aWNlICpkZXYpOwogaW50ICgqZnJlZXplKShzdHJ1Y3QgZGV2aWNlICpkZXYp
OwogaW50ICgqdGhhdykoc3RydWN0IGRldmljZSAqZGV2KTsKIGludCAoKnBvd2Vyb2ZmKShz
dHJ1Y3QgZGV2aWNlICpkZXYpOwogaW50ICgqcmVzdG9yZSkoc3RydWN0IGRldmljZSAqZGV2
KTsKIGludCAoKnN1c3BlbmRfbGF0ZSkoc3RydWN0IGRldmljZSAqZGV2KTsKIGludCAoKnJl
c3VtZV9lYXJseSkoc3RydWN0IGRldmljZSAqZGV2KTsKIGludCAoKmZyZWV6ZV9sYXRlKShz
dHJ1Y3QgZGV2aWNlICpkZXYpOwogaW50ICgqdGhhd19lYXJseSkoc3RydWN0IGRldmljZSAq
ZGV2KTsKIGludCAoKnBvd2Vyb2ZmX2xhdGUpKHN0cnVjdCBkZXZpY2UgKmRldik7CiBpbnQg
KCpyZXN0b3JlX2Vhcmx5KShzdHJ1Y3QgZGV2aWNlICpkZXYpOwogaW50ICgqc3VzcGVuZF9u
b2lycSkoc3RydWN0IGRldmljZSAqZGV2KTsKIGludCAoKnJlc3VtZV9ub2lycSkoc3RydWN0
IGRldmljZSAqZGV2KTsKIGludCAoKmZyZWV6ZV9ub2lycSkoc3RydWN0IGRldmljZSAqZGV2
KTsKIGludCAoKnRoYXdfbm9pcnEpKHN0cnVjdCBkZXZpY2UgKmRldik7CiBpbnQgKCpwb3dl
cm9mZl9ub2lycSkoc3RydWN0IGRldmljZSAqZGV2KTsKIGludCAoKnJlc3RvcmVfbm9pcnEp
KHN0cnVjdCBkZXZpY2UgKmRldik7CiBpbnQgKCpydW50aW1lX3N1c3BlbmQpKHN0cnVjdCBk
ZXZpY2UgKmRldik7CiBpbnQgKCpydW50aW1lX3Jlc3VtZSkoc3RydWN0IGRldmljZSAqZGV2
KTsKIGludCAoKnJ1bnRpbWVfaWRsZSkoc3RydWN0IGRldmljZSAqZGV2KTsKfTsKIyA0OTYg
Ii4vaW5jbHVkZS9saW51eC9wbS5oIgplbnVtIHJwbV9zdGF0dXMgewogUlBNX0FDVElWRSA9
IDAsCiBSUE1fUkVTVU1JTkcsCiBSUE1fU1VTUEVOREVELAogUlBNX1NVU1BFTkRJTkcsCn07
CiMgNTE4ICIuL2luY2x1ZGUvbGludXgvcG0uaCIKZW51bSBycG1fcmVxdWVzdCB7CiBSUE1f
UkVRX05PTkUgPSAwLAogUlBNX1JFUV9JRExFLAogUlBNX1JFUV9TVVNQRU5ELAogUlBNX1JF
UV9BVVRPU1VTUEVORCwKIFJQTV9SRVFfUkVTVU1FLAp9OwoKc3RydWN0IHdha2V1cF9zb3Vy
Y2U7CnN0cnVjdCB3YWtlX2lycTsKc3RydWN0IHBtX2RvbWFpbl9kYXRhOwoKc3RydWN0IHBt
X3N1YnN5c19kYXRhIHsKIHNwaW5sb2NrX3QgbG9jazsKIHVuc2lnbmVkIGludCByZWZjb3Vu
dDsKCgoKCgoKfTsKIyA1NTkgIi4vaW5jbHVkZS9saW51eC9wbS5oIgpzdHJ1Y3QgZGV2X3Bt
X2luZm8gewogcG1fbWVzc2FnZV90IHBvd2VyX3N0YXRlOwogdW5zaWduZWQgaW50IGNhbl93
YWtldXA6MTsKIHVuc2lnbmVkIGludCBhc3luY19zdXNwZW5kOjE7CiBib29sIGluX2RwbV9s
aXN0OjE7CiBib29sIGlzX3ByZXBhcmVkOjE7CiBib29sIGlzX3N1c3BlbmRlZDoxOwogYm9v
bCBpc19ub2lycV9zdXNwZW5kZWQ6MTsKIGJvb2wgaXNfbGF0ZV9zdXNwZW5kZWQ6MTsKIGJv
b2wgbm9fcG06MTsKIGJvb2wgZWFybHlfaW5pdDoxOwogYm9vbCBkaXJlY3RfY29tcGxldGU6
MTsKIHUzMiBkcml2ZXJfZmxhZ3M7CiBzcGlubG9ja190IGxvY2s7CiMgNTgzICIuL2luY2x1
ZGUvbGludXgvcG0uaCIKIHVuc2lnbmVkIGludCBzaG91bGRfd2FrZXVwOjE7CiMgNjE0ICIu
L2luY2x1ZGUvbGludXgvcG0uaCIKIHN0cnVjdCBwbV9zdWJzeXNfZGF0YSAqc3Vic3lzX2Rh
dGE7CiB2b2lkICgqc2V0X2xhdGVuY3lfdG9sZXJhbmNlKShzdHJ1Y3QgZGV2aWNlICosIHMz
Mik7CiBzdHJ1Y3QgZGV2X3BtX3FvcyAqcW9zOwp9OwoKZXh0ZXJuIGludCBkZXZfcG1fZ2V0
X3N1YnN5c19kYXRhKHN0cnVjdCBkZXZpY2UgKmRldik7CmV4dGVybiB2b2lkIGRldl9wbV9w
dXRfc3Vic3lzX2RhdGEoc3RydWN0IGRldmljZSAqZGV2KTsKIyA2MzYgIi4vaW5jbHVkZS9s
aW51eC9wbS5oIgpzdHJ1Y3QgZGV2X3BtX2RvbWFpbiB7CiBzdHJ1Y3QgZGV2X3BtX29wcyBv
cHM7CiBpbnQgKCpzdGFydCkoc3RydWN0IGRldmljZSAqZGV2KTsKIHZvaWQgKCpkZXRhY2gp
KHN0cnVjdCBkZXZpY2UgKmRldiwgYm9vbCBwb3dlcl9vZmYpOwogaW50ICgqYWN0aXZhdGUp
KHN0cnVjdCBkZXZpY2UgKmRldik7CiB2b2lkICgqc3luYykoc3RydWN0IGRldmljZSAqZGV2
KTsKIHZvaWQgKCpkaXNtaXNzKShzdHJ1Y3QgZGV2aWNlICpkZXYpOwp9OwojIDc1NSAiLi9p
bmNsdWRlL2xpbnV4L3BtLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgZHBtX3N1c3BlbmRfc3RhcnQocG1f
bWVzc2FnZV90IHN0YXRlKQp7CiByZXR1cm4gMDsKfQoKCgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGRldmlj
ZV9wbV93YWl0X2Zvcl9kZXYoc3RydWN0IGRldmljZSAqYSwgc3RydWN0IGRldmljZSAqYikK
ewogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGRwbV9mb3JfZWFjaF9kZXYodm9pZCAq
ZGF0YSwgdm9pZCAoKmZuKShzdHJ1Y3QgZGV2aWNlICosIHZvaWQgKikpCnsKfQojIDc5NCAi
Li9pbmNsdWRlL2xpbnV4L3BtLmgiCmVudW0gZHBtX29yZGVyIHsKIERQTV9PUkRFUl9OT05F
LAogRFBNX09SREVSX0RFVl9BRlRFUl9QQVJFTlQsCiBEUE1fT1JERVJfUEFSRU5UX0JFRk9S
RV9ERVYsCiBEUE1fT1JERVJfREVWX0xBU1QsCn07CiMgMjUgIi4vaW5jbHVkZS9saW51eC9k
ZXZpY2UuaCIgMgoKCgoKIyAxICIuL2luY2x1ZGUvbGludXgvZGV2aWNlL2J1cy5oIiAxCiMg
MjEgIi4vaW5jbHVkZS9saW51eC9kZXZpY2UvYnVzLmgiCnN0cnVjdCBkZXZpY2VfZHJpdmVy
OwpzdHJ1Y3QgZndub2RlX2hhbmRsZTsKIyA4MiAiLi9pbmNsdWRlL2xpbnV4L2RldmljZS9i
dXMuaCIKc3RydWN0IGJ1c190eXBlIHsKIGNvbnN0IGNoYXIgKm5hbWU7CiBjb25zdCBjaGFy
ICpkZXZfbmFtZTsKIHN0cnVjdCBkZXZpY2UgKmRldl9yb290OwogY29uc3Qgc3RydWN0IGF0
dHJpYnV0ZV9ncm91cCAqKmJ1c19ncm91cHM7CiBjb25zdCBzdHJ1Y3QgYXR0cmlidXRlX2dy
b3VwICoqZGV2X2dyb3VwczsKIGNvbnN0IHN0cnVjdCBhdHRyaWJ1dGVfZ3JvdXAgKipkcnZf
Z3JvdXBzOwoKIGludCAoKm1hdGNoKShzdHJ1Y3QgZGV2aWNlICpkZXYsIHN0cnVjdCBkZXZp
Y2VfZHJpdmVyICpkcnYpOwogaW50ICgqdWV2ZW50KShzdHJ1Y3QgZGV2aWNlICpkZXYsIHN0
cnVjdCBrb2JqX3VldmVudF9lbnYgKmVudik7CiBpbnQgKCpwcm9iZSkoc3RydWN0IGRldmlj
ZSAqZGV2KTsKIHZvaWQgKCpzeW5jX3N0YXRlKShzdHJ1Y3QgZGV2aWNlICpkZXYpOwogaW50
ICgqcmVtb3ZlKShzdHJ1Y3QgZGV2aWNlICpkZXYpOwogdm9pZCAoKnNodXRkb3duKShzdHJ1
Y3QgZGV2aWNlICpkZXYpOwoKIGludCAoKm9ubGluZSkoc3RydWN0IGRldmljZSAqZGV2KTsK
IGludCAoKm9mZmxpbmUpKHN0cnVjdCBkZXZpY2UgKmRldik7CgogaW50ICgqc3VzcGVuZCko
c3RydWN0IGRldmljZSAqZGV2LCBwbV9tZXNzYWdlX3Qgc3RhdGUpOwogaW50ICgqcmVzdW1l
KShzdHJ1Y3QgZGV2aWNlICpkZXYpOwoKIGludCAoKm51bV92Zikoc3RydWN0IGRldmljZSAq
ZGV2KTsKCiBpbnQgKCpkbWFfY29uZmlndXJlKShzdHJ1Y3QgZGV2aWNlICpkZXYpOwoKIGNv
bnN0IHN0cnVjdCBkZXZfcG1fb3BzICpwbTsKCiBjb25zdCBzdHJ1Y3QgaW9tbXVfb3BzICpp
b21tdV9vcHM7Cgogc3RydWN0IHN1YnN5c19wcml2YXRlICpwOwogc3RydWN0IGxvY2tfY2xh
c3Nfa2V5IGxvY2tfa2V5OwoKIGJvb2wgbmVlZF9wYXJlbnRfbG9jazsKfTsKCmV4dGVybiBp
bnQgX19hdHRyaWJ1dGVfXygoX193YXJuX3VudXNlZF9yZXN1bHRfXykpIGJ1c19yZWdpc3Rl
cihzdHJ1Y3QgYnVzX3R5cGUgKmJ1cyk7CgpleHRlcm4gdm9pZCBidXNfdW5yZWdpc3Rlcihz
dHJ1Y3QgYnVzX3R5cGUgKmJ1cyk7CgpleHRlcm4gaW50IF9fYXR0cmlidXRlX18oKF9fd2Fy
bl91bnVzZWRfcmVzdWx0X18pKSBidXNfcmVzY2FuX2RldmljZXMoc3RydWN0IGJ1c190eXBl
ICpidXMpOwoKc3RydWN0IGJ1c19hdHRyaWJ1dGUgewogc3RydWN0IGF0dHJpYnV0ZSBhdHRy
Owogc3NpemVfdCAoKnNob3cpKHN0cnVjdCBidXNfdHlwZSAqYnVzLCBjaGFyICpidWYpOwog
c3NpemVfdCAoKnN0b3JlKShzdHJ1Y3QgYnVzX3R5cGUgKmJ1cywgY29uc3QgY2hhciAqYnVm
LCBzaXplX3QgY291bnQpOwp9OwojIDEzNiAiLi9pbmNsdWRlL2xpbnV4L2RldmljZS9idXMu
aCIKZXh0ZXJuIGludCBfX2F0dHJpYnV0ZV9fKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkg
YnVzX2NyZWF0ZV9maWxlKHN0cnVjdCBidXNfdHlwZSAqLAogICAgIHN0cnVjdCBidXNfYXR0
cmlidXRlICopOwpleHRlcm4gdm9pZCBidXNfcmVtb3ZlX2ZpbGUoc3RydWN0IGJ1c190eXBl
ICosIHN0cnVjdCBidXNfYXR0cmlidXRlICopOwoKCmludCBkZXZpY2VfbWF0Y2hfbmFtZShz
dHJ1Y3QgZGV2aWNlICpkZXYsIGNvbnN0IHZvaWQgKm5hbWUpOwppbnQgZGV2aWNlX21hdGNo
X29mX25vZGUoc3RydWN0IGRldmljZSAqZGV2LCBjb25zdCB2b2lkICpucCk7CmludCBkZXZp
Y2VfbWF0Y2hfZndub2RlKHN0cnVjdCBkZXZpY2UgKmRldiwgY29uc3Qgdm9pZCAqZndub2Rl
KTsKaW50IGRldmljZV9tYXRjaF9kZXZ0KHN0cnVjdCBkZXZpY2UgKmRldiwgY29uc3Qgdm9p
ZCAqcGRldnQpOwppbnQgZGV2aWNlX21hdGNoX2FjcGlfZGV2KHN0cnVjdCBkZXZpY2UgKmRl
diwgY29uc3Qgdm9pZCAqYWRldik7CmludCBkZXZpY2VfbWF0Y2hfYW55KHN0cnVjdCBkZXZp
Y2UgKmRldiwgY29uc3Qgdm9pZCAqdW51c2VkKTsKCgpzdHJ1Y3Qgc3Vic3lzX2Rldl9pdGVy
IHsKIHN0cnVjdCBrbGlzdF9pdGVyIGtpOwogY29uc3Qgc3RydWN0IGRldmljZV90eXBlICp0
eXBlOwp9Owp2b2lkIHN1YnN5c19kZXZfaXRlcl9pbml0KHN0cnVjdCBzdWJzeXNfZGV2X2l0
ZXIgKml0ZXIsCiAgICBzdHJ1Y3QgYnVzX3R5cGUgKnN1YnN5cywKICAgIHN0cnVjdCBkZXZp
Y2UgKnN0YXJ0LAogICAgY29uc3Qgc3RydWN0IGRldmljZV90eXBlICp0eXBlKTsKc3RydWN0
IGRldmljZSAqc3Vic3lzX2Rldl9pdGVyX25leHQoc3RydWN0IHN1YnN5c19kZXZfaXRlciAq
aXRlcik7CnZvaWQgc3Vic3lzX2Rldl9pdGVyX2V4aXQoc3RydWN0IHN1YnN5c19kZXZfaXRl
ciAqaXRlcik7CgppbnQgYnVzX2Zvcl9lYWNoX2RldihzdHJ1Y3QgYnVzX3R5cGUgKmJ1cywg
c3RydWN0IGRldmljZSAqc3RhcnQsIHZvaWQgKmRhdGEsCiAgICAgICBpbnQgKCpmbikoc3Ry
dWN0IGRldmljZSAqZGV2LCB2b2lkICpkYXRhKSk7CnN0cnVjdCBkZXZpY2UgKmJ1c19maW5k
X2RldmljZShzdHJ1Y3QgYnVzX3R5cGUgKmJ1cywgc3RydWN0IGRldmljZSAqc3RhcnQsCiAg
ICAgICAgICBjb25zdCB2b2lkICpkYXRhLAogICAgICAgICAgaW50ICgqbWF0Y2gpKHN0cnVj
dCBkZXZpY2UgKmRldiwgY29uc3Qgdm9pZCAqZGF0YSkpOwoKCgoKCgoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHN0
cnVjdCBkZXZpY2UgKmJ1c19maW5kX2RldmljZV9ieV9uYW1lKHN0cnVjdCBidXNfdHlwZSAq
YnVzLAogICAgICAgICAgIHN0cnVjdCBkZXZpY2UgKnN0YXJ0LAogICAgICAgICAgIGNvbnN0
IGNoYXIgKm5hbWUpCnsKIHJldHVybiBidXNfZmluZF9kZXZpY2UoYnVzLCBzdGFydCwgbmFt
ZSwgZGV2aWNlX21hdGNoX25hbWUpOwp9CgoKCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IGRldmlj
ZSAqCmJ1c19maW5kX2RldmljZV9ieV9vZl9ub2RlKHN0cnVjdCBidXNfdHlwZSAqYnVzLCBj
b25zdCBzdHJ1Y3QgZGV2aWNlX25vZGUgKm5wKQp7CiByZXR1cm4gYnVzX2ZpbmRfZGV2aWNl
KGJ1cywgKCh2b2lkICopMCksIG5wLCBkZXZpY2VfbWF0Y2hfb2Zfbm9kZSk7Cn0KCgoKCgoK
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSBzdHJ1Y3QgZGV2aWNlICoKYnVzX2ZpbmRfZGV2aWNlX2J5X2Z3bm9kZShz
dHJ1Y3QgYnVzX3R5cGUgKmJ1cywgY29uc3Qgc3RydWN0IGZ3bm9kZV9oYW5kbGUgKmZ3bm9k
ZSkKewogcmV0dXJuIGJ1c19maW5kX2RldmljZShidXMsICgodm9pZCAqKTApLCBmd25vZGUs
IGRldmljZV9tYXRjaF9md25vZGUpOwp9CgoKCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IGRldmlj
ZSAqYnVzX2ZpbmRfZGV2aWNlX2J5X2RldnQoc3RydWN0IGJ1c190eXBlICpidXMsCiAgICAg
ICAgICAgZGV2X3QgZGV2dCkKewogcmV0dXJuIGJ1c19maW5kX2RldmljZShidXMsICgodm9p
ZCAqKTApLCAmZGV2dCwgZGV2aWNlX21hdGNoX2RldnQpOwp9CgoKCgoKCgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
c3RydWN0IGRldmljZSAqCmJ1c19maW5kX25leHRfZGV2aWNlKHN0cnVjdCBidXNfdHlwZSAq
YnVzLHN0cnVjdCBkZXZpY2UgKmN1cikKewogcmV0dXJuIGJ1c19maW5kX2RldmljZShidXMs
IGN1ciwgKCh2b2lkICopMCksIGRldmljZV9tYXRjaF9hbnkpOwp9CiMgMjQyICIuL2luY2x1
ZGUvbGludXgvZGV2aWNlL2J1cy5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IGRldmljZSAqCmJ1c19m
aW5kX2RldmljZV9ieV9hY3BpX2RldihzdHJ1Y3QgYnVzX3R5cGUgKmJ1cywgY29uc3Qgdm9p
ZCAqYWRldikKewogcmV0dXJuICgodm9pZCAqKTApOwp9CgoKc3RydWN0IGRldmljZSAqc3Vi
c3lzX2ZpbmRfZGV2aWNlX2J5X2lkKHN0cnVjdCBidXNfdHlwZSAqYnVzLCB1bnNpZ25lZCBp
bnQgaWQsCiAgICAgc3RydWN0IGRldmljZSAqaGludCk7CmludCBidXNfZm9yX2VhY2hfZHJ2
KHN0cnVjdCBidXNfdHlwZSAqYnVzLCBzdHJ1Y3QgZGV2aWNlX2RyaXZlciAqc3RhcnQsCiAg
ICAgICB2b2lkICpkYXRhLCBpbnQgKCpmbikoc3RydWN0IGRldmljZV9kcml2ZXIgKiwgdm9p
ZCAqKSk7CnZvaWQgYnVzX3NvcnRfYnJlYWR0aGZpcnN0KHN0cnVjdCBidXNfdHlwZSAqYnVz
LAogICAgICBpbnQgKCpjb21wYXJlKShjb25zdCBzdHJ1Y3QgZGV2aWNlICphLAogICAgICAg
Y29uc3Qgc3RydWN0IGRldmljZSAqYikpOwoKCgoKCgpzdHJ1Y3Qgbm90aWZpZXJfYmxvY2s7
CgpleHRlcm4gaW50IGJ1c19yZWdpc3Rlcl9ub3RpZmllcihzdHJ1Y3QgYnVzX3R5cGUgKmJ1
cywKICAgICBzdHJ1Y3Qgbm90aWZpZXJfYmxvY2sgKm5iKTsKZXh0ZXJuIGludCBidXNfdW5y
ZWdpc3Rlcl9ub3RpZmllcihzdHJ1Y3QgYnVzX3R5cGUgKmJ1cywKICAgICAgIHN0cnVjdCBu
b3RpZmllcl9ibG9jayAqbmIpOwojIDI4NSAiLi9pbmNsdWRlL2xpbnV4L2RldmljZS9idXMu
aCIKZXh0ZXJuIHN0cnVjdCBrc2V0ICpidXNfZ2V0X2tzZXQoc3RydWN0IGJ1c190eXBlICpi
dXMpOwpleHRlcm4gc3RydWN0IGtsaXN0ICpidXNfZ2V0X2RldmljZV9rbGlzdChzdHJ1Y3Qg
YnVzX3R5cGUgKmJ1cyk7CiMgMzAgIi4vaW5jbHVkZS9saW51eC9kZXZpY2UuaCIgMgojIDEg
Ii4vaW5jbHVkZS9saW51eC9kZXZpY2UvY2xhc3MuaCIgMQojIDIyICIuL2luY2x1ZGUvbGlu
dXgvZGV2aWNlL2NsYXNzLmgiCnN0cnVjdCBkZXZpY2U7CnN0cnVjdCBmd25vZGVfaGFuZGxl
OwojIDU0ICIuL2luY2x1ZGUvbGludXgvZGV2aWNlL2NsYXNzLmgiCnN0cnVjdCBjbGFzcyB7
CiBjb25zdCBjaGFyICpuYW1lOwogc3RydWN0IG1vZHVsZSAqb3duZXI7CgogY29uc3Qgc3Ry
dWN0IGF0dHJpYnV0ZV9ncm91cCAqKmNsYXNzX2dyb3VwczsKIGNvbnN0IHN0cnVjdCBhdHRy
aWJ1dGVfZ3JvdXAgKipkZXZfZ3JvdXBzOwogc3RydWN0IGtvYmplY3QgKmRldl9rb2JqOwoK
IGludCAoKmRldl91ZXZlbnQpKHN0cnVjdCBkZXZpY2UgKmRldiwgc3RydWN0IGtvYmpfdWV2
ZW50X2VudiAqZW52KTsKIGNoYXIgKigqZGV2bm9kZSkoc3RydWN0IGRldmljZSAqZGV2LCB1
bW9kZV90ICptb2RlKTsKCiB2b2lkICgqY2xhc3NfcmVsZWFzZSkoc3RydWN0IGNsYXNzICpj
bGFzcyk7CiB2b2lkICgqZGV2X3JlbGVhc2UpKHN0cnVjdCBkZXZpY2UgKmRldik7CgogaW50
ICgqc2h1dGRvd25fcHJlKShzdHJ1Y3QgZGV2aWNlICpkZXYpOwoKIGNvbnN0IHN0cnVjdCBr
b2JqX25zX3R5cGVfb3BlcmF0aW9ucyAqbnNfdHlwZTsKIGNvbnN0IHZvaWQgKigqbmFtZXNw
YWNlKShzdHJ1Y3QgZGV2aWNlICpkZXYpOwoKIHZvaWQgKCpnZXRfb3duZXJzaGlwKShzdHJ1
Y3QgZGV2aWNlICpkZXYsIGt1aWRfdCAqdWlkLCBrZ2lkX3QgKmdpZCk7CgogY29uc3Qgc3Ry
dWN0IGRldl9wbV9vcHMgKnBtOwoKIHN0cnVjdCBzdWJzeXNfcHJpdmF0ZSAqcDsKfTsKCnN0
cnVjdCBjbGFzc19kZXZfaXRlciB7CiBzdHJ1Y3Qga2xpc3RfaXRlciBraTsKIGNvbnN0IHN0
cnVjdCBkZXZpY2VfdHlwZSAqdHlwZTsKfTsKCmV4dGVybiBzdHJ1Y3Qga29iamVjdCAqc3lz
ZnNfZGV2X2Jsb2NrX2tvYmo7CmV4dGVybiBzdHJ1Y3Qga29iamVjdCAqc3lzZnNfZGV2X2No
YXJfa29iajsKZXh0ZXJuIGludCBfX2F0dHJpYnV0ZV9fKChfX3dhcm5fdW51c2VkX3Jlc3Vs
dF9fKSkgX19jbGFzc19yZWdpc3RlcihzdHJ1Y3QgY2xhc3MgKmNsYXNzLAogICAgICBzdHJ1
Y3QgbG9ja19jbGFzc19rZXkgKmtleSk7CmV4dGVybiB2b2lkIGNsYXNzX3VucmVnaXN0ZXIo
c3RydWN0IGNsYXNzICpjbGFzcyk7CiMgOTkgIi4vaW5jbHVkZS9saW51eC9kZXZpY2UvY2xh
c3MuaCIKc3RydWN0IGNsYXNzX2NvbXBhdDsKc3RydWN0IGNsYXNzX2NvbXBhdCAqY2xhc3Nf
Y29tcGF0X3JlZ2lzdGVyKGNvbnN0IGNoYXIgKm5hbWUpOwp2b2lkIGNsYXNzX2NvbXBhdF91
bnJlZ2lzdGVyKHN0cnVjdCBjbGFzc19jb21wYXQgKmNscyk7CmludCBjbGFzc19jb21wYXRf
Y3JlYXRlX2xpbmsoc3RydWN0IGNsYXNzX2NvbXBhdCAqY2xzLCBzdHJ1Y3QgZGV2aWNlICpk
ZXYsCiAgICAgICAgc3RydWN0IGRldmljZSAqZGV2aWNlX2xpbmspOwp2b2lkIGNsYXNzX2Nv
bXBhdF9yZW1vdmVfbGluayhzdHJ1Y3QgY2xhc3NfY29tcGF0ICpjbHMsIHN0cnVjdCBkZXZp
Y2UgKmRldiwKICAgICAgICAgc3RydWN0IGRldmljZSAqZGV2aWNlX2xpbmspOwoKZXh0ZXJu
IHZvaWQgY2xhc3NfZGV2X2l0ZXJfaW5pdChzdHJ1Y3QgY2xhc3NfZGV2X2l0ZXIgKml0ZXIs
CiAgICBzdHJ1Y3QgY2xhc3MgKmNsYXNzLAogICAgc3RydWN0IGRldmljZSAqc3RhcnQsCiAg
ICBjb25zdCBzdHJ1Y3QgZGV2aWNlX3R5cGUgKnR5cGUpOwpleHRlcm4gc3RydWN0IGRldmlj
ZSAqY2xhc3NfZGV2X2l0ZXJfbmV4dChzdHJ1Y3QgY2xhc3NfZGV2X2l0ZXIgKml0ZXIpOwpl
eHRlcm4gdm9pZCBjbGFzc19kZXZfaXRlcl9leGl0KHN0cnVjdCBjbGFzc19kZXZfaXRlciAq
aXRlcik7CgpleHRlcm4gaW50IGNsYXNzX2Zvcl9lYWNoX2RldmljZShzdHJ1Y3QgY2xhc3Mg
KmNsYXNzLCBzdHJ1Y3QgZGV2aWNlICpzdGFydCwKICAgICB2b2lkICpkYXRhLAogICAgIGlu
dCAoKmZuKShzdHJ1Y3QgZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEpKTsKZXh0ZXJuIHN0cnVj
dCBkZXZpY2UgKmNsYXNzX2ZpbmRfZGV2aWNlKHN0cnVjdCBjbGFzcyAqY2xhc3MsCiAgICAg
c3RydWN0IGRldmljZSAqc3RhcnQsIGNvbnN0IHZvaWQgKmRhdGEsCiAgICAgaW50ICgqbWF0
Y2gpKHN0cnVjdCBkZXZpY2UgKiwgY29uc3Qgdm9pZCAqKSk7CgoKCgoKCgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
c3RydWN0IGRldmljZSAqY2xhc3NfZmluZF9kZXZpY2VfYnlfbmFtZShzdHJ1Y3QgY2xhc3Mg
KmNsYXNzLAogICAgICAgICAgICAgY29uc3QgY2hhciAqbmFtZSkKewogcmV0dXJuIGNsYXNz
X2ZpbmRfZGV2aWNlKGNsYXNzLCAoKHZvaWQgKikwKSwgbmFtZSwgZGV2aWNlX21hdGNoX25h
bWUpOwp9CgoKCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IGRldmljZSAqCmNsYXNzX2ZpbmRfZGV2
aWNlX2J5X29mX25vZGUoc3RydWN0IGNsYXNzICpjbGFzcywgY29uc3Qgc3RydWN0IGRldmlj
ZV9ub2RlICpucCkKewogcmV0dXJuIGNsYXNzX2ZpbmRfZGV2aWNlKGNsYXNzLCAoKHZvaWQg
KikwKSwgbnAsIGRldmljZV9tYXRjaF9vZl9ub2RlKTsKfQoKCgoKCgoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHN0
cnVjdCBkZXZpY2UgKgpjbGFzc19maW5kX2RldmljZV9ieV9md25vZGUoc3RydWN0IGNsYXNz
ICpjbGFzcywKICAgICAgIGNvbnN0IHN0cnVjdCBmd25vZGVfaGFuZGxlICpmd25vZGUpCnsK
IHJldHVybiBjbGFzc19maW5kX2RldmljZShjbGFzcywgKCh2b2lkICopMCksIGZ3bm9kZSwg
ZGV2aWNlX21hdGNoX2Z3bm9kZSk7Cn0KCgoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3QgZGV2aWNl
ICpjbGFzc19maW5kX2RldmljZV9ieV9kZXZ0KHN0cnVjdCBjbGFzcyAqY2xhc3MsCiAgICAg
ICAgICAgICBkZXZfdCBkZXZ0KQp7CiByZXR1cm4gY2xhc3NfZmluZF9kZXZpY2UoY2xhc3Ms
ICgodm9pZCAqKTApLCAmZGV2dCwgZGV2aWNlX21hdGNoX2RldnQpOwp9CiMgMTg0ICIuL2lu
Y2x1ZGUvbGludXgvZGV2aWNlL2NsYXNzLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3QgZGV2aWNlICoK
Y2xhc3NfZmluZF9kZXZpY2VfYnlfYWNwaV9kZXYoc3RydWN0IGNsYXNzICpjbGFzcywgY29u
c3Qgdm9pZCAqYWRldikKewogcmV0dXJuICgodm9pZCAqKTApOwp9CgoKc3RydWN0IGNsYXNz
X2F0dHJpYnV0ZSB7CiBzdHJ1Y3QgYXR0cmlidXRlIGF0dHI7CiBzc2l6ZV90ICgqc2hvdyko
c3RydWN0IGNsYXNzICpjbGFzcywgc3RydWN0IGNsYXNzX2F0dHJpYnV0ZSAqYXR0ciwKICAg
Y2hhciAqYnVmKTsKIHNzaXplX3QgKCpzdG9yZSkoc3RydWN0IGNsYXNzICpjbGFzcywgc3Ry
dWN0IGNsYXNzX2F0dHJpYnV0ZSAqYXR0ciwKICAgY29uc3QgY2hhciAqYnVmLCBzaXplX3Qg
Y291bnQpOwp9OwojIDIwNiAiLi9pbmNsdWRlL2xpbnV4L2RldmljZS9jbGFzcy5oIgpleHRl
cm4gaW50IF9fYXR0cmlidXRlX18oKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKSBjbGFzc19j
cmVhdGVfZmlsZV9ucyhzdHJ1Y3QgY2xhc3MgKmNsYXNzLAogICAgICAgICAgY29uc3Qgc3Ry
dWN0IGNsYXNzX2F0dHJpYnV0ZSAqYXR0ciwKICAgICAgICAgIGNvbnN0IHZvaWQgKm5zKTsK
ZXh0ZXJuIHZvaWQgY2xhc3NfcmVtb3ZlX2ZpbGVfbnMoc3RydWN0IGNsYXNzICpjbGFzcywK
ICAgICBjb25zdCBzdHJ1Y3QgY2xhc3NfYXR0cmlidXRlICphdHRyLAogICAgIGNvbnN0IHZv
aWQgKm5zKTsKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgX19hdHRyaWJ1dGVfXygoX193YXJuX3VudXNlZF9y
ZXN1bHRfXykpIGNsYXNzX2NyZWF0ZV9maWxlKHN0cnVjdCBjbGFzcyAqY2xhc3MsCiAgICAg
Y29uc3Qgc3RydWN0IGNsYXNzX2F0dHJpYnV0ZSAqYXR0cikKewogcmV0dXJuIGNsYXNzX2Ny
ZWF0ZV9maWxlX25zKGNsYXNzLCBhdHRyLCAoKHZvaWQgKikwKSk7Cn0KCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2
b2lkIGNsYXNzX3JlbW92ZV9maWxlKHN0cnVjdCBjbGFzcyAqY2xhc3MsCiAgICAgICAgIGNv
bnN0IHN0cnVjdCBjbGFzc19hdHRyaWJ1dGUgKmF0dHIpCnsKIHJldHVybiBjbGFzc19yZW1v
dmVfZmlsZV9ucyhjbGFzcywgYXR0ciwgKCh2b2lkICopMCkpOwp9CgoKc3RydWN0IGNsYXNz
X2F0dHJpYnV0ZV9zdHJpbmcgewogc3RydWN0IGNsYXNzX2F0dHJpYnV0ZSBhdHRyOwogY2hh
ciAqc3RyOwp9OwojIDIzOCAiLi9pbmNsdWRlL2xpbnV4L2RldmljZS9jbGFzcy5oIgpleHRl
cm4gc3NpemVfdCBzaG93X2NsYXNzX2F0dHJfc3RyaW5nKHN0cnVjdCBjbGFzcyAqY2xhc3Ms
IHN0cnVjdCBjbGFzc19hdHRyaWJ1dGUgKmF0dHIsCiAgICAgICAgICAgICAgICAgICAgICAg
IGNoYXIgKmJ1Zik7CgpzdHJ1Y3QgY2xhc3NfaW50ZXJmYWNlIHsKIHN0cnVjdCBsaXN0X2hl
YWQgbm9kZTsKIHN0cnVjdCBjbGFzcyAqY2xhc3M7CgogaW50ICgqYWRkX2RldikgKHN0cnVj
dCBkZXZpY2UgKiwgc3RydWN0IGNsYXNzX2ludGVyZmFjZSAqKTsKIHZvaWQgKCpyZW1vdmVf
ZGV2KSAoc3RydWN0IGRldmljZSAqLCBzdHJ1Y3QgY2xhc3NfaW50ZXJmYWNlICopOwp9OwoK
ZXh0ZXJuIGludCBfX2F0dHJpYnV0ZV9fKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkgY2xh
c3NfaW50ZXJmYWNlX3JlZ2lzdGVyKHN0cnVjdCBjbGFzc19pbnRlcmZhY2UgKik7CmV4dGVy
biB2b2lkIGNsYXNzX2ludGVyZmFjZV91bnJlZ2lzdGVyKHN0cnVjdCBjbGFzc19pbnRlcmZh
Y2UgKik7CgpleHRlcm4gc3RydWN0IGNsYXNzICogX19hdHRyaWJ1dGVfXygoX193YXJuX3Vu
dXNlZF9yZXN1bHRfXykpIF9fY2xhc3NfY3JlYXRlKHN0cnVjdCBtb2R1bGUgKm93bmVyLAog
ICAgICAgIGNvbnN0IGNoYXIgKm5hbWUsCiAgICAgICAgc3RydWN0IGxvY2tfY2xhc3Nfa2V5
ICprZXkpOwpleHRlcm4gdm9pZCBjbGFzc19kZXN0cm95KHN0cnVjdCBjbGFzcyAqY2xzKTsK
IyAzMSAiLi9pbmNsdWRlL2xpbnV4L2RldmljZS5oIiAyCiMgMSAiLi9pbmNsdWRlL2xpbnV4
L2RldmljZS9kcml2ZXIuaCIgMQojIDQ0ICIuL2luY2x1ZGUvbGludXgvZGV2aWNlL2RyaXZl
ci5oIgplbnVtIHByb2JlX3R5cGUgewogUFJPQkVfREVGQVVMVF9TVFJBVEVHWSwKIFBST0JF
X1BSRUZFUl9BU1lOQ0hST05PVVMsCiBQUk9CRV9GT1JDRV9TWU5DSFJPTk9VUywKfTsKIyA5
NSAiLi9pbmNsdWRlL2xpbnV4L2RldmljZS9kcml2ZXIuaCIKc3RydWN0IGRldmljZV9kcml2
ZXIgewogY29uc3QgY2hhciAqbmFtZTsKIHN0cnVjdCBidXNfdHlwZSAqYnVzOwoKIHN0cnVj
dCBtb2R1bGUgKm93bmVyOwogY29uc3QgY2hhciAqbW9kX25hbWU7CgogYm9vbCBzdXBwcmVz
c19iaW5kX2F0dHJzOwogZW51bSBwcm9iZV90eXBlIHByb2JlX3R5cGU7CgogY29uc3Qgc3Ry
dWN0IG9mX2RldmljZV9pZCAqb2ZfbWF0Y2hfdGFibGU7CiBjb25zdCBzdHJ1Y3QgYWNwaV9k
ZXZpY2VfaWQgKmFjcGlfbWF0Y2hfdGFibGU7CgogaW50ICgqcHJvYmUpIChzdHJ1Y3QgZGV2
aWNlICpkZXYpOwogdm9pZCAoKnN5bmNfc3RhdGUpKHN0cnVjdCBkZXZpY2UgKmRldik7CiBp
bnQgKCpyZW1vdmUpIChzdHJ1Y3QgZGV2aWNlICpkZXYpOwogdm9pZCAoKnNodXRkb3duKSAo
c3RydWN0IGRldmljZSAqZGV2KTsKIGludCAoKnN1c3BlbmQpIChzdHJ1Y3QgZGV2aWNlICpk
ZXYsIHBtX21lc3NhZ2VfdCBzdGF0ZSk7CiBpbnQgKCpyZXN1bWUpIChzdHJ1Y3QgZGV2aWNl
ICpkZXYpOwogY29uc3Qgc3RydWN0IGF0dHJpYnV0ZV9ncm91cCAqKmdyb3VwczsKIGNvbnN0
IHN0cnVjdCBhdHRyaWJ1dGVfZ3JvdXAgKipkZXZfZ3JvdXBzOwoKIGNvbnN0IHN0cnVjdCBk
ZXZfcG1fb3BzICpwbTsKIHZvaWQgKCpjb3JlZHVtcCkgKHN0cnVjdCBkZXZpY2UgKmRldik7
Cgogc3RydWN0IGRyaXZlcl9wcml2YXRlICpwOwp9OwoKCmV4dGVybiBpbnQgX19hdHRyaWJ1
dGVfXygoX193YXJuX3VudXNlZF9yZXN1bHRfXykpIGRyaXZlcl9yZWdpc3RlcihzdHJ1Y3Qg
ZGV2aWNlX2RyaXZlciAqZHJ2KTsKZXh0ZXJuIHZvaWQgZHJpdmVyX3VucmVnaXN0ZXIoc3Ry
dWN0IGRldmljZV9kcml2ZXIgKmRydik7CgpleHRlcm4gc3RydWN0IGRldmljZV9kcml2ZXIg
KmRyaXZlcl9maW5kKGNvbnN0IGNoYXIgKm5hbWUsCiAgICAgIHN0cnVjdCBidXNfdHlwZSAq
YnVzKTsKZXh0ZXJuIGludCBkcml2ZXJfcHJvYmVfZG9uZSh2b2lkKTsKZXh0ZXJuIHZvaWQg
d2FpdF9mb3JfZGV2aWNlX3Byb2JlKHZvaWQpOwoKCgpzdHJ1Y3QgZHJpdmVyX2F0dHJpYnV0
ZSB7CiBzdHJ1Y3QgYXR0cmlidXRlIGF0dHI7CiBzc2l6ZV90ICgqc2hvdykoc3RydWN0IGRl
dmljZV9kcml2ZXIgKmRyaXZlciwgY2hhciAqYnVmKTsKIHNzaXplX3QgKCpzdG9yZSkoc3Ry
dWN0IGRldmljZV9kcml2ZXIgKmRyaXZlciwgY29uc3QgY2hhciAqYnVmLAogICAgc2l6ZV90
IGNvdW50KTsKfTsKIyAxNDggIi4vaW5jbHVkZS9saW51eC9kZXZpY2UvZHJpdmVyLmgiCmV4
dGVybiBpbnQgX19hdHRyaWJ1dGVfXygoX193YXJuX3VudXNlZF9yZXN1bHRfXykpIGRyaXZl
cl9jcmVhdGVfZmlsZShzdHJ1Y3QgZGV2aWNlX2RyaXZlciAqZHJpdmVyLAogICAgIGNvbnN0
IHN0cnVjdCBkcml2ZXJfYXR0cmlidXRlICphdHRyKTsKZXh0ZXJuIHZvaWQgZHJpdmVyX3Jl
bW92ZV9maWxlKHN0cnVjdCBkZXZpY2VfZHJpdmVyICpkcml2ZXIsCiAgICAgICAgICBjb25z
dCBzdHJ1Y3QgZHJpdmVyX2F0dHJpYnV0ZSAqYXR0cik7CgpleHRlcm4gaW50IF9fYXR0cmli
dXRlX18oKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKSBkcml2ZXJfZm9yX2VhY2hfZGV2aWNl
KHN0cnVjdCBkZXZpY2VfZHJpdmVyICpkcnYsCiAgICAgICAgICAgIHN0cnVjdCBkZXZpY2Ug
KnN0YXJ0LAogICAgICAgICAgICB2b2lkICpkYXRhLAogICAgICAgICAgICBpbnQgKCpmbiko
c3RydWN0IGRldmljZSAqZGV2LAogICAgICAgIHZvaWQgKikpOwpzdHJ1Y3QgZGV2aWNlICpk
cml2ZXJfZmluZF9kZXZpY2Uoc3RydWN0IGRldmljZV9kcml2ZXIgKmRydiwKICAgICAgc3Ry
dWN0IGRldmljZSAqc3RhcnQsIGNvbnN0IHZvaWQgKmRhdGEsCiAgICAgIGludCAoKm1hdGNo
KShzdHJ1Y3QgZGV2aWNlICpkZXYsIGNvbnN0IHZvaWQgKmRhdGEpKTsKCgoKCgoKCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBzdHJ1Y3QgZGV2aWNlICpkcml2ZXJfZmluZF9kZXZpY2VfYnlfbmFtZShzdHJ1Y3Qg
ZGV2aWNlX2RyaXZlciAqZHJ2LAogICAgICAgY29uc3QgY2hhciAqbmFtZSkKewogcmV0dXJu
IGRyaXZlcl9maW5kX2RldmljZShkcnYsICgodm9pZCAqKTApLCBuYW1lLCBkZXZpY2VfbWF0
Y2hfbmFtZSk7Cn0KCgoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3QgZGV2aWNlICoKZHJpdmVyX2Zp
bmRfZGV2aWNlX2J5X29mX25vZGUoc3RydWN0IGRldmljZV9kcml2ZXIgKmRydiwKICAgICAg
ICAgY29uc3Qgc3RydWN0IGRldmljZV9ub2RlICpucCkKewogcmV0dXJuIGRyaXZlcl9maW5k
X2RldmljZShkcnYsICgodm9pZCAqKTApLCBucCwgZGV2aWNlX21hdGNoX29mX25vZGUpOwp9
CgoKCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IGRldmljZSAqCmRyaXZlcl9maW5kX2RldmljZV9i
eV9md25vZGUoc3RydWN0IGRldmljZV9kcml2ZXIgKmRydiwKICAgICAgICBjb25zdCBzdHJ1
Y3QgZndub2RlX2hhbmRsZSAqZndub2RlKQp7CiByZXR1cm4gZHJpdmVyX2ZpbmRfZGV2aWNl
KGRydiwgKCh2b2lkICopMCksIGZ3bm9kZSwgZGV2aWNlX21hdGNoX2Z3bm9kZSk7Cn0KCgoK
CgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSBzdHJ1Y3QgZGV2aWNlICpkcml2ZXJfZmluZF9kZXZpY2VfYnlfZGV2
dChzdHJ1Y3QgZGV2aWNlX2RyaXZlciAqZHJ2LAogICAgICAgZGV2X3QgZGV2dCkKewogcmV0
dXJuIGRyaXZlcl9maW5kX2RldmljZShkcnYsICgodm9pZCAqKTApLCAmZGV2dCwgZGV2aWNl
X21hdGNoX2RldnQpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IGRldmljZSAqZHJpdmVyX2ZpbmRf
bmV4dF9kZXZpY2Uoc3RydWN0IGRldmljZV9kcml2ZXIgKmRydiwKICAgICAgICAgICBzdHJ1
Y3QgZGV2aWNlICpzdGFydCkKewogcmV0dXJuIGRyaXZlcl9maW5kX2RldmljZShkcnYsIHN0
YXJ0LCAoKHZvaWQgKikwKSwgZGV2aWNlX21hdGNoX2FueSk7Cn0KIyAyMzIgIi4vaW5jbHVk
ZS9saW51eC9kZXZpY2UvZHJpdmVyLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3QgZGV2aWNlICoKZHJp
dmVyX2ZpbmRfZGV2aWNlX2J5X2FjcGlfZGV2KHN0cnVjdCBkZXZpY2VfZHJpdmVyICpkcnYs
IGNvbnN0IHZvaWQgKmFkZXYpCnsKIHJldHVybiAoKHZvaWQgKikwKTsKfQoKCmV4dGVybiBp
bnQgZHJpdmVyX2RlZmVycmVkX3Byb2JlX3RpbWVvdXQ7CnZvaWQgZHJpdmVyX2RlZmVycmVk
X3Byb2JlX2FkZChzdHJ1Y3QgZGV2aWNlICpkZXYpOwppbnQgZHJpdmVyX2RlZmVycmVkX3By
b2JlX2NoZWNrX3N0YXRlKHN0cnVjdCBkZXZpY2UgKmRldik7CnZvaWQgZHJpdmVyX2luaXQo
dm9pZCk7CiMgMzIgIi4vaW5jbHVkZS9saW51eC9kZXZpY2UuaCIgMgojIDEgIi4vYXJjaC9w
b3dlcnBjL2luY2x1ZGUvYXNtL2RldmljZS5oIiAxCgoKCgoKCgpzdHJ1Y3QgZGV2aWNlX25v
ZGU7CgpzdHJ1Y3QgcGNpX2RuOwpzdHJ1Y3QgaW9tbXVfdGFibGU7CiMgMjAgIi4vYXJjaC9w
b3dlcnBjL2luY2x1ZGUvYXNtL2RldmljZS5oIgpzdHJ1Y3QgZGV2X2FyY2hkYXRhIHsKCgoK
CiBib29sIGlvbW11X2J5cGFzcyA6IDE7CgoKCgoKIGRtYV9hZGRyX3QgZG1hX29mZnNldDsK
Cgogc3RydWN0IGlvbW11X3RhYmxlICppb21tdV90YWJsZV9iYXNlOwoKCgogdm9pZCAqaW9t
bXVfZG9tYWluOwoKCiBzdHJ1Y3QgcGNpX2RuICpwY2lfZGF0YTsKIyA1MiAiLi9hcmNoL3Bv
d2VycGMvaW5jbHVkZS9hc20vZGV2aWNlLmgiCn07CgpzdHJ1Y3QgcGRldl9hcmNoZGF0YSB7
CiB1NjQgZG1hX21hc2s7Cn07CiMgMzMgIi4vaW5jbHVkZS9saW51eC9kZXZpY2UuaCIgMgoK
c3RydWN0IGRldmljZTsKc3RydWN0IGRldmljZV9wcml2YXRlOwpzdHJ1Y3QgZGV2aWNlX2Ry
aXZlcjsKc3RydWN0IGRyaXZlcl9wcml2YXRlOwpzdHJ1Y3QgbW9kdWxlOwpzdHJ1Y3QgY2xh
c3M7CnN0cnVjdCBzdWJzeXNfcHJpdmF0ZTsKc3RydWN0IGRldmljZV9ub2RlOwpzdHJ1Y3Qg
Zndub2RlX2hhbmRsZTsKc3RydWN0IGlvbW11X29wczsKc3RydWN0IGlvbW11X2dyb3VwOwpz
dHJ1Y3QgZGV2X3Bpbl9pbmZvOwpzdHJ1Y3QgZGV2X2lvbW11OwojIDYxICIuL2luY2x1ZGUv
bGludXgvZGV2aWNlLmgiCnN0cnVjdCBzdWJzeXNfaW50ZXJmYWNlIHsKIGNvbnN0IGNoYXIg
Km5hbWU7CiBzdHJ1Y3QgYnVzX3R5cGUgKnN1YnN5czsKIHN0cnVjdCBsaXN0X2hlYWQgbm9k
ZTsKIGludCAoKmFkZF9kZXYpKHN0cnVjdCBkZXZpY2UgKmRldiwgc3RydWN0IHN1YnN5c19p
bnRlcmZhY2UgKnNpZik7CiB2b2lkICgqcmVtb3ZlX2Rldikoc3RydWN0IGRldmljZSAqZGV2
LCBzdHJ1Y3Qgc3Vic3lzX2ludGVyZmFjZSAqc2lmKTsKfTsKCmludCBzdWJzeXNfaW50ZXJm
YWNlX3JlZ2lzdGVyKHN0cnVjdCBzdWJzeXNfaW50ZXJmYWNlICpzaWYpOwp2b2lkIHN1YnN5
c19pbnRlcmZhY2VfdW5yZWdpc3RlcihzdHJ1Y3Qgc3Vic3lzX2ludGVyZmFjZSAqc2lmKTsK
CmludCBzdWJzeXNfc3lzdGVtX3JlZ2lzdGVyKHN0cnVjdCBidXNfdHlwZSAqc3Vic3lzLAog
ICAgICBjb25zdCBzdHJ1Y3QgYXR0cmlidXRlX2dyb3VwICoqZ3JvdXBzKTsKaW50IHN1YnN5
c192aXJ0dWFsX3JlZ2lzdGVyKHN0cnVjdCBidXNfdHlwZSAqc3Vic3lzLAogICAgICAgY29u
c3Qgc3RydWN0IGF0dHJpYnV0ZV9ncm91cCAqKmdyb3Vwcyk7CiMgODYgIi4vaW5jbHVkZS9s
aW51eC9kZXZpY2UuaCIKc3RydWN0IGRldmljZV90eXBlIHsKIGNvbnN0IGNoYXIgKm5hbWU7
CiBjb25zdCBzdHJ1Y3QgYXR0cmlidXRlX2dyb3VwICoqZ3JvdXBzOwogaW50ICgqdWV2ZW50
KShzdHJ1Y3QgZGV2aWNlICpkZXYsIHN0cnVjdCBrb2JqX3VldmVudF9lbnYgKmVudik7CiBj
aGFyICooKmRldm5vZGUpKHN0cnVjdCBkZXZpY2UgKmRldiwgdW1vZGVfdCAqbW9kZSwKICAg
IGt1aWRfdCAqdWlkLCBrZ2lkX3QgKmdpZCk7CiB2b2lkICgqcmVsZWFzZSkoc3RydWN0IGRl
dmljZSAqZGV2KTsKCiBjb25zdCBzdHJ1Y3QgZGV2X3BtX29wcyAqcG07Cn07CgoKc3RydWN0
IGRldmljZV9hdHRyaWJ1dGUgewogc3RydWN0IGF0dHJpYnV0ZSBhdHRyOwogc3NpemVfdCAo
KnNob3cpKHN0cnVjdCBkZXZpY2UgKmRldiwgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0
dHIsCiAgIGNoYXIgKmJ1Zik7CiBzc2l6ZV90ICgqc3RvcmUpKHN0cnVjdCBkZXZpY2UgKmRl
diwgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsCiAgICBjb25zdCBjaGFyICpidWYs
IHNpemVfdCBjb3VudCk7Cn07CgpzdHJ1Y3QgZGV2X2V4dF9hdHRyaWJ1dGUgewogc3RydWN0
IGRldmljZV9hdHRyaWJ1dGUgYXR0cjsKIHZvaWQgKnZhcjsKfTsKCnNzaXplX3QgZGV2aWNl
X3Nob3dfdWxvbmcoc3RydWN0IGRldmljZSAqZGV2LCBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0
ZSAqYXR0ciwKICAgICBjaGFyICpidWYpOwpzc2l6ZV90IGRldmljZV9zdG9yZV91bG9uZyhz
dHJ1Y3QgZGV2aWNlICpkZXYsIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLAogICAg
ICBjb25zdCBjaGFyICpidWYsIHNpemVfdCBjb3VudCk7CnNzaXplX3QgZGV2aWNlX3Nob3df
aW50KHN0cnVjdCBkZXZpY2UgKmRldiwgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIs
CiAgIGNoYXIgKmJ1Zik7CnNzaXplX3QgZGV2aWNlX3N0b3JlX2ludChzdHJ1Y3QgZGV2aWNl
ICpkZXYsIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLAogICAgY29uc3QgY2hhciAq
YnVmLCBzaXplX3QgY291bnQpOwpzc2l6ZV90IGRldmljZV9zaG93X2Jvb2woc3RydWN0IGRl
dmljZSAqZGV2LCBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwKICAgY2hhciAqYnVm
KTsKc3NpemVfdCBkZXZpY2Vfc3RvcmVfYm9vbChzdHJ1Y3QgZGV2aWNlICpkZXYsIHN0cnVj
dCBkZXZpY2VfYXR0cmlidXRlICphdHRyLAogICAgY29uc3QgY2hhciAqYnVmLCBzaXplX3Qg
Y291bnQpOwojIDE0OCAiLi9pbmNsdWRlL2xpbnV4L2RldmljZS5oIgpleHRlcm4gaW50IGRl
dmljZV9jcmVhdGVfZmlsZShzdHJ1Y3QgZGV2aWNlICpkZXZpY2UsCiAgICAgICAgIGNvbnN0
IHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICplbnRyeSk7CmV4dGVybiB2b2lkIGRldmljZV9y
ZW1vdmVfZmlsZShzdHJ1Y3QgZGV2aWNlICpkZXYsCiAgICAgICAgICBjb25zdCBzdHJ1Y3Qg
ZGV2aWNlX2F0dHJpYnV0ZSAqYXR0cik7CmV4dGVybiBib29sIGRldmljZV9yZW1vdmVfZmls
ZV9zZWxmKHN0cnVjdCBkZXZpY2UgKmRldiwKICAgICAgICBjb25zdCBzdHJ1Y3QgZGV2aWNl
X2F0dHJpYnV0ZSAqYXR0cik7CmV4dGVybiBpbnQgX19hdHRyaWJ1dGVfXygoX193YXJuX3Vu
dXNlZF9yZXN1bHRfXykpIGRldmljZV9jcmVhdGVfYmluX2ZpbGUoc3RydWN0IGRldmljZSAq
ZGV2LAogICAgIGNvbnN0IHN0cnVjdCBiaW5fYXR0cmlidXRlICphdHRyKTsKZXh0ZXJuIHZv
aWQgZGV2aWNlX3JlbW92ZV9iaW5fZmlsZShzdHJ1Y3QgZGV2aWNlICpkZXYsCiAgICAgICBj
b25zdCBzdHJ1Y3QgYmluX2F0dHJpYnV0ZSAqYXR0cik7CgoKdHlwZWRlZiB2b2lkICgqZHJf
cmVsZWFzZV90KShzdHJ1Y3QgZGV2aWNlICpkZXYsIHZvaWQgKnJlcyk7CnR5cGVkZWYgaW50
ICgqZHJfbWF0Y2hfdCkoc3RydWN0IGRldmljZSAqZGV2LCB2b2lkICpyZXMsIHZvaWQgKm1h
dGNoX2RhdGEpOwojIDE3MSAiLi9pbmNsdWRlL2xpbnV4L2RldmljZS5oIgpleHRlcm4gdm9p
ZCAqZGV2cmVzX2FsbG9jX25vZGUoZHJfcmVsZWFzZV90IHJlbGVhc2UsIHNpemVfdCBzaXpl
LCBnZnBfdCBnZnAsCiAgICAgICAgICBpbnQgbmlkKSBfX2F0dHJpYnV0ZV9fKChfX21hbGxv
Y19fKSk7CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSB2b2lkICpkZXZyZXNfYWxsb2MoZHJfcmVsZWFzZV90IHJlbGVh
c2UsIHNpemVfdCBzaXplLCBnZnBfdCBnZnApCnsKIHJldHVybiBkZXZyZXNfYWxsb2Nfbm9k
ZShyZWxlYXNlLCBzaXplLCBnZnAsICgtMSkpOwp9CgoKZXh0ZXJuIHZvaWQgZGV2cmVzX2Zv
cl9lYWNoX3JlcyhzdHJ1Y3QgZGV2aWNlICpkZXYsIGRyX3JlbGVhc2VfdCByZWxlYXNlLAog
ICAgZHJfbWF0Y2hfdCBtYXRjaCwgdm9pZCAqbWF0Y2hfZGF0YSwKICAgIHZvaWQgKCpmbiko
c3RydWN0IGRldmljZSAqLCB2b2lkICosIHZvaWQgKiksCiAgICB2b2lkICpkYXRhKTsKZXh0
ZXJuIHZvaWQgZGV2cmVzX2ZyZWUodm9pZCAqcmVzKTsKZXh0ZXJuIHZvaWQgZGV2cmVzX2Fk
ZChzdHJ1Y3QgZGV2aWNlICpkZXYsIHZvaWQgKnJlcyk7CmV4dGVybiB2b2lkICpkZXZyZXNf
ZmluZChzdHJ1Y3QgZGV2aWNlICpkZXYsIGRyX3JlbGVhc2VfdCByZWxlYXNlLAogICAgZHJf
bWF0Y2hfdCBtYXRjaCwgdm9pZCAqbWF0Y2hfZGF0YSk7CmV4dGVybiB2b2lkICpkZXZyZXNf
Z2V0KHN0cnVjdCBkZXZpY2UgKmRldiwgdm9pZCAqbmV3X3JlcywKICAgZHJfbWF0Y2hfdCBt
YXRjaCwgdm9pZCAqbWF0Y2hfZGF0YSk7CmV4dGVybiB2b2lkICpkZXZyZXNfcmVtb3ZlKHN0
cnVjdCBkZXZpY2UgKmRldiwgZHJfcmVsZWFzZV90IHJlbGVhc2UsCiAgICAgIGRyX21hdGNo
X3QgbWF0Y2gsIHZvaWQgKm1hdGNoX2RhdGEpOwpleHRlcm4gaW50IGRldnJlc19kZXN0cm95
KHN0cnVjdCBkZXZpY2UgKmRldiwgZHJfcmVsZWFzZV90IHJlbGVhc2UsCiAgICAgZHJfbWF0
Y2hfdCBtYXRjaCwgdm9pZCAqbWF0Y2hfZGF0YSk7CmV4dGVybiBpbnQgZGV2cmVzX3JlbGVh
c2Uoc3RydWN0IGRldmljZSAqZGV2LCBkcl9yZWxlYXNlX3QgcmVsZWFzZSwKICAgICBkcl9t
YXRjaF90IG1hdGNoLCB2b2lkICptYXRjaF9kYXRhKTsKCgpleHRlcm4gdm9pZCAqIF9fYXR0
cmlidXRlX18oKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKSBkZXZyZXNfb3Blbl9ncm91cChz
dHJ1Y3QgZGV2aWNlICpkZXYsIHZvaWQgKmlkLAogICAgICAgICAgZ2ZwX3QgZ2ZwKTsKZXh0
ZXJuIHZvaWQgZGV2cmVzX2Nsb3NlX2dyb3VwKHN0cnVjdCBkZXZpY2UgKmRldiwgdm9pZCAq
aWQpOwpleHRlcm4gdm9pZCBkZXZyZXNfcmVtb3ZlX2dyb3VwKHN0cnVjdCBkZXZpY2UgKmRl
diwgdm9pZCAqaWQpOwpleHRlcm4gaW50IGRldnJlc19yZWxlYXNlX2dyb3VwKHN0cnVjdCBk
ZXZpY2UgKmRldiwgdm9pZCAqaWQpOwoKCmV4dGVybiB2b2lkICpkZXZtX2ttYWxsb2Moc3Ry
dWN0IGRldmljZSAqZGV2LCBzaXplX3Qgc2l6ZSwgZ2ZwX3QgZ2ZwKSBfX2F0dHJpYnV0ZV9f
KChfX21hbGxvY19fKSk7CmV4dGVybiBfX2F0dHJpYnV0ZV9fKChfX2Zvcm1hdF9fKHByaW50
ZiwgMywgMCkpKQpjaGFyICpkZXZtX2t2YXNwcmludGYoc3RydWN0IGRldmljZSAqZGV2LCBn
ZnBfdCBnZnAsIGNvbnN0IGNoYXIgKmZtdCwKICAgICAgICB2YV9saXN0IGFwKSBfX2F0dHJp
YnV0ZV9fKChfX21hbGxvY19fKSk7CmV4dGVybiBfX2F0dHJpYnV0ZV9fKChfX2Zvcm1hdF9f
KHByaW50ZiwgMywgNCkpKQpjaGFyICpkZXZtX2thc3ByaW50ZihzdHJ1Y3QgZGV2aWNlICpk
ZXYsIGdmcF90IGdmcCwgY29uc3QgY2hhciAqZm10LCAuLi4pIF9fYXR0cmlidXRlX18oKF9f
bWFsbG9jX18pKTsKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgKmRldm1fa3phbGxvYyhzdHJ1Y3QgZGV2aWNl
ICpkZXYsIHNpemVfdCBzaXplLCBnZnBfdCBnZnApCnsKIHJldHVybiBkZXZtX2ttYWxsb2Mo
ZGV2LCBzaXplLCBnZnAgfCAoKCBnZnBfdCkweDEwMHUpKTsKfQpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCAq
ZGV2bV9rbWFsbG9jX2FycmF5KHN0cnVjdCBkZXZpY2UgKmRldiwKICAgICAgICAgICBzaXpl
X3Qgbiwgc2l6ZV90IHNpemUsIGdmcF90IGZsYWdzKQp7CiBzaXplX3QgYnl0ZXM7CgogaWYg
KF9fYnVpbHRpbl9leHBlY3QoISEoX19idWlsdGluX2Nob29zZV9leHByKCgoKHR5cGVvZihu
KSkoLTEpKSA8ICh0eXBlb2YobikpMSksICh7IHR5cGVvZihuKSBfX2EgPSAobik7IHR5cGVv
ZihzaXplKSBfX2IgPSAoc2l6ZSk7IHR5cGVvZigmYnl0ZXMpIF9fZCA9ICgmYnl0ZXMpOyB0
eXBlb2YobikgX190bWF4ID0gKCh0eXBlb2YobikpKCgoKHR5cGVvZihuKSkxIDw8ICg4KnNp
emVvZih0eXBlb2YobikpIC0gMSAtICgoKHR5cGVvZihuKSkoLTEpKSA8ICh0eXBlb2Yobikp
MSkpKSAtIDEpICsgKCh0eXBlb2YobikpMSA8PCAoOCpzaXplb2YodHlwZW9mKG4pKSAtIDEg
LSAoKCh0eXBlb2YobikpKC0xKSkgPCAodHlwZW9mKG4pKTEpKSkpKTsgdHlwZW9mKG4pIF9f
dG1pbiA9ICgodHlwZW9mKG4pKSgodHlwZW9mKG4pKS0oKHR5cGVvZihuKSkoKCgodHlwZW9m
KG4pKTEgPDwgKDgqc2l6ZW9mKHR5cGVvZihuKSkgLSAxIC0gKCgodHlwZW9mKG4pKSgtMSkp
IDwgKHR5cGVvZihuKSkxKSkpIC0gMSkgKyAoKHR5cGVvZihuKSkxIDw8ICg4KnNpemVvZih0
eXBlb2YobikpIC0gMSAtICgoKHR5cGVvZihuKSkoLTEpKSA8ICh0eXBlb2YobikpMSkpKSkp
LSh0eXBlb2YobikpMSkpOyAodm9pZCkgKCZfX2EgPT0gJl9fYik7ICh2b2lkKSAoJl9fYSA9
PSBfX2QpOyAqX19kID0gKHU2NClfX2EgKiAodTY0KV9fYjsgKF9fYiA+IDAgJiYgKF9fYSA+
IF9fdG1heC9fX2IgfHwgX19hIDwgX190bWluL19fYikpIHx8IChfX2IgPCAodHlwZW9mKF9f
YikpLTEgJiYgKF9fYSA+IF9fdG1pbi9fX2IgfHwgX19hIDwgX190bWF4L19fYikpIHx8IChf
X2IgPT0gKHR5cGVvZihfX2IpKS0xICYmIF9fYSA9PSBfX3RtaW4pOyB9KSwgKHsgdHlwZW9m
KG4pIF9fYSA9IChuKTsgdHlwZW9mKHNpemUpIF9fYiA9IChzaXplKTsgdHlwZW9mKCZieXRl
cykgX19kID0gKCZieXRlcyk7ICh2b2lkKSAoJl9fYSA9PSAmX19iKTsgKHZvaWQpICgmX19h
ID09IF9fZCk7ICpfX2QgPSBfX2EgKiBfX2I7IF9fYnVpbHRpbl9jb25zdGFudF9wKF9fYikg
PyBfX2IgPiAwICYmIF9fYSA+ICgodHlwZW9mKF9fYSkpKCgoKHR5cGVvZihfX2EpKTEgPDwg
KDgqc2l6ZW9mKHR5cGVvZihfX2EpKSAtIDEgLSAoKCh0eXBlb2YoX19hKSkoLTEpKSA8ICh0
eXBlb2YoX19hKSkxKSkpIC0gMSkgKyAoKHR5cGVvZihfX2EpKTEgPDwgKDgqc2l6ZW9mKHR5
cGVvZihfX2EpKSAtIDEgLSAoKCh0eXBlb2YoX19hKSkoLTEpKSA8ICh0eXBlb2YoX19hKSkx
KSkpKSkgLyBfX2IgOiBfX2EgPiAwICYmIF9fYiA+ICgodHlwZW9mKF9fYikpKCgoKHR5cGVv
ZihfX2IpKTEgPDwgKDgqc2l6ZW9mKHR5cGVvZihfX2IpKSAtIDEgLSAoKCh0eXBlb2YoX19i
KSkoLTEpKSA8ICh0eXBlb2YoX19iKSkxKSkpIC0gMSkgKyAoKHR5cGVvZihfX2IpKTEgPDwg
KDgqc2l6ZW9mKHR5cGVvZihfX2IpKSAtIDEgLSAoKCh0eXBlb2YoX19iKSkoLTEpKSA8ICh0
eXBlb2YoX19iKSkxKSkpKSkgLyBfX2E7IH0pKSksIDApKQogIHJldHVybiAoKHZvaWQgKikw
KTsKCiByZXR1cm4gZGV2bV9rbWFsbG9jKGRldiwgYnl0ZXMsIGZsYWdzKTsKfQpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgdm9pZCAqZGV2bV9rY2FsbG9jKHN0cnVjdCBkZXZpY2UgKmRldiwKICAgICBzaXplX3Qg
biwgc2l6ZV90IHNpemUsIGdmcF90IGZsYWdzKQp7CiByZXR1cm4gZGV2bV9rbWFsbG9jX2Fy
cmF5KGRldiwgbiwgc2l6ZSwgZmxhZ3MgfCAoKCBnZnBfdCkweDEwMHUpKTsKfQpleHRlcm4g
dm9pZCBkZXZtX2tmcmVlKHN0cnVjdCBkZXZpY2UgKmRldiwgY29uc3Qgdm9pZCAqcCk7CmV4
dGVybiBjaGFyICpkZXZtX2tzdHJkdXAoc3RydWN0IGRldmljZSAqZGV2LCBjb25zdCBjaGFy
ICpzLCBnZnBfdCBnZnApIF9fYXR0cmlidXRlX18oKF9fbWFsbG9jX18pKTsKZXh0ZXJuIGNv
bnN0IGNoYXIgKmRldm1fa3N0cmR1cF9jb25zdChzdHJ1Y3QgZGV2aWNlICpkZXYsCiAgICAg
ICAgICBjb25zdCBjaGFyICpzLCBnZnBfdCBnZnApOwpleHRlcm4gdm9pZCAqZGV2bV9rbWVt
ZHVwKHN0cnVjdCBkZXZpY2UgKmRldiwgY29uc3Qgdm9pZCAqc3JjLCBzaXplX3QgbGVuLAog
ICAgIGdmcF90IGdmcCk7CgpleHRlcm4gdW5zaWduZWQgbG9uZyBkZXZtX2dldF9mcmVlX3Bh
Z2VzKHN0cnVjdCBkZXZpY2UgKmRldiwKICAgICAgZ2ZwX3QgZ2ZwX21hc2ssIHVuc2lnbmVk
IGludCBvcmRlcik7CmV4dGVybiB2b2lkIGRldm1fZnJlZV9wYWdlcyhzdHJ1Y3QgZGV2aWNl
ICpkZXYsIHVuc2lnbmVkIGxvbmcgYWRkcik7Cgp2b2lkICpkZXZtX2lvcmVtYXBfcmVzb3Vy
Y2Uoc3RydWN0IGRldmljZSAqZGV2LAogICAgICAgIGNvbnN0IHN0cnVjdCByZXNvdXJjZSAq
cmVzKTsKdm9pZCAqZGV2bV9pb3JlbWFwX3Jlc291cmNlX3djKHN0cnVjdCBkZXZpY2UgKmRl
diwKICAgICAgICAgICBjb25zdCBzdHJ1Y3QgcmVzb3VyY2UgKnJlcyk7Cgp2b2lkICpkZXZt
X29mX2lvbWFwKHN0cnVjdCBkZXZpY2UgKmRldiwKICAgICAgIHN0cnVjdCBkZXZpY2Vfbm9k
ZSAqbm9kZSwgaW50IGluZGV4LAogICAgICAgcmVzb3VyY2Vfc2l6ZV90ICpzaXplKTsKCgpp
bnQgZGV2bV9hZGRfYWN0aW9uKHN0cnVjdCBkZXZpY2UgKmRldiwgdm9pZCAoKmFjdGlvbiko
dm9pZCAqKSwgdm9pZCAqZGF0YSk7CnZvaWQgZGV2bV9yZW1vdmVfYWN0aW9uKHN0cnVjdCBk
ZXZpY2UgKmRldiwgdm9pZCAoKmFjdGlvbikodm9pZCAqKSwgdm9pZCAqZGF0YSk7CnZvaWQg
ZGV2bV9yZWxlYXNlX2FjdGlvbihzdHJ1Y3QgZGV2aWNlICpkZXYsIHZvaWQgKCphY3Rpb24p
KHZvaWQgKiksIHZvaWQgKmRhdGEpOwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBkZXZtX2FkZF9hY3Rpb25f
b3JfcmVzZXQoc3RydWN0IGRldmljZSAqZGV2LAogICAgICAgIHZvaWQgKCphY3Rpb24pKHZv
aWQgKiksIHZvaWQgKmRhdGEpCnsKIGludCByZXQ7CgogcmV0ID0gZGV2bV9hZGRfYWN0aW9u
KGRldiwgYWN0aW9uLCBkYXRhKTsKIGlmIChyZXQpCiAgYWN0aW9uKGRhdGEpOwoKIHJldHVy
biByZXQ7Cn0KIyAyODEgIi4vaW5jbHVkZS9saW51eC9kZXZpY2UuaCIKdm9pZCAqX19kZXZt
X2FsbG9jX3BlcmNwdShzdHJ1Y3QgZGV2aWNlICpkZXYsIHNpemVfdCBzaXplLAogICAgICAg
c2l6ZV90IGFsaWduKTsKdm9pZCBkZXZtX2ZyZWVfcGVyY3B1KHN0cnVjdCBkZXZpY2UgKmRl
diwgdm9pZCAqcGRhdGEpOwoKc3RydWN0IGRldmljZV9kbWFfcGFyYW1ldGVycyB7CgoKCgog
dW5zaWduZWQgaW50IG1heF9zZWdtZW50X3NpemU7CiB1bnNpZ25lZCBsb25nIHNlZ21lbnRf
Ym91bmRhcnlfbWFzazsKfTsKIyAzMDUgIi4vaW5jbHVkZS9saW51eC9kZXZpY2UuaCIKc3Ry
dWN0IGRldmljZV9jb25uZWN0aW9uIHsKIHN0cnVjdCBmd25vZGVfaGFuZGxlICpmd25vZGU7
CiBjb25zdCBjaGFyICplbmRwb2ludFsyXTsKIGNvbnN0IGNoYXIgKmlkOwogc3RydWN0IGxp
c3RfaGVhZCBsaXN0Owp9OwoKdHlwZWRlZiB2b2lkICooKmRldmNvbl9tYXRjaF9mbl90KShz
dHJ1Y3QgZGV2aWNlX2Nvbm5lY3Rpb24gKmNvbiwgaW50IGVwLAogICAgICAgdm9pZCAqZGF0
YSk7Cgp2b2lkICpmd25vZGVfY29ubmVjdGlvbl9maW5kX21hdGNoKHN0cnVjdCBmd25vZGVf
aGFuZGxlICpmd25vZGUsCiAgICAgICBjb25zdCBjaGFyICpjb25faWQsIHZvaWQgKmRhdGEs
CiAgICAgICBkZXZjb25fbWF0Y2hfZm5fdCBtYXRjaCk7CnZvaWQgKmRldmljZV9jb25uZWN0
aW9uX2ZpbmRfbWF0Y2goc3RydWN0IGRldmljZSAqZGV2LCBjb25zdCBjaGFyICpjb25faWQs
CiAgICAgICB2b2lkICpkYXRhLCBkZXZjb25fbWF0Y2hfZm5fdCBtYXRjaCk7CgpzdHJ1Y3Qg
ZGV2aWNlICpkZXZpY2VfY29ubmVjdGlvbl9maW5kKHN0cnVjdCBkZXZpY2UgKmRldiwgY29u
c3QgY2hhciAqY29uX2lkKTsKCnZvaWQgZGV2aWNlX2Nvbm5lY3Rpb25fYWRkKHN0cnVjdCBk
ZXZpY2VfY29ubmVjdGlvbiAqY29uKTsKdm9pZCBkZXZpY2VfY29ubmVjdGlvbl9yZW1vdmUo
c3RydWN0IGRldmljZV9jb25uZWN0aW9uICpjb24pOwoKCgoKCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGRl
dmljZV9jb25uZWN0aW9uc19hZGQoc3RydWN0IGRldmljZV9jb25uZWN0aW9uICpjb25zKQp7
CiBzdHJ1Y3QgZGV2aWNlX2Nvbm5lY3Rpb24gKmM7CgogZm9yIChjID0gY29uczsgYy0+ZW5k
cG9pbnRbMF07IGMrKykKICBkZXZpY2VfY29ubmVjdGlvbl9hZGQoYyk7Cn0KCgoKCgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgdm9pZCBkZXZpY2VfY29ubmVjdGlvbnNfcmVtb3ZlKHN0cnVjdCBkZXZpY2VfY29u
bmVjdGlvbiAqY29ucykKewogc3RydWN0IGRldmljZV9jb25uZWN0aW9uICpjOwoKIGZvciAo
YyA9IGNvbnM7IGMtPmVuZHBvaW50WzBdOyBjKyspCiAgZGV2aWNlX2Nvbm5lY3Rpb25fcmVt
b3ZlKGMpOwp9CiMgMzU5ICIuL2luY2x1ZGUvbGludXgvZGV2aWNlLmgiCmVudW0gZGV2aWNl
X2xpbmtfc3RhdGUgewogRExfU1RBVEVfTk9ORSA9IC0xLAogRExfU1RBVEVfRE9STUFOVCA9
IDAsCiBETF9TVEFURV9BVkFJTEFCTEUsCiBETF9TVEFURV9DT05TVU1FUl9QUk9CRSwKIERM
X1NUQVRFX0FDVElWRSwKIERMX1NUQVRFX1NVUFBMSUVSX1VOQklORCwKfTsKIyA0MDIgIi4v
aW5jbHVkZS9saW51eC9kZXZpY2UuaCIKc3RydWN0IGRldmljZV9saW5rIHsKIHN0cnVjdCBk
ZXZpY2UgKnN1cHBsaWVyOwogc3RydWN0IGxpc3RfaGVhZCBzX25vZGU7CiBzdHJ1Y3QgZGV2
aWNlICpjb25zdW1lcjsKIHN0cnVjdCBsaXN0X2hlYWQgY19ub2RlOwogZW51bSBkZXZpY2Vf
bGlua19zdGF0ZSBzdGF0dXM7CiB1MzIgZmxhZ3M7CiByZWZjb3VudF90IHJwbV9hY3RpdmU7
CiBzdHJ1Y3Qga3JlZiBrcmVmOwoKIHN0cnVjdCBjYWxsYmFja19oZWFkIGNhbGxiYWNrX2hl
YWQ7CgogYm9vbCBzdXBwbGllcl9wcmVhY3RpdmF0ZWQ7Cn07CiMgNDI0ICIuL2luY2x1ZGUv
bGludXgvZGV2aWNlLmgiCmVudW0gZGxfZGV2X3N0YXRlIHsKIERMX0RFVl9OT19EUklWRVIg
PSAwLAogRExfREVWX1BST0JJTkcsCiBETF9ERVZfRFJJVkVSX0JPVU5ELAogRExfREVWX1VO
QklORElORywKfTsKIyA0NDEgIi4vaW5jbHVkZS9saW51eC9kZXZpY2UuaCIKc3RydWN0IGRl
dl9saW5rc19pbmZvIHsKIHN0cnVjdCBsaXN0X2hlYWQgc3VwcGxpZXJzOwogc3RydWN0IGxp
c3RfaGVhZCBjb25zdW1lcnM7CiBzdHJ1Y3QgbGlzdF9oZWFkIG5lZWRzX3N1cHBsaWVyczsK
IHN0cnVjdCBsaXN0X2hlYWQgZGVmZXJfc3luYzsKIGJvb2wgbmVlZF9mb3JfcHJvYmU7CiBl
bnVtIGRsX2Rldl9zdGF0ZSBzdGF0dXM7Cn07CiMgNTM1ICIuL2luY2x1ZGUvbGludXgvZGV2
aWNlLmgiCnN0cnVjdCBkZXZpY2Ugewogc3RydWN0IGtvYmplY3Qga29iajsKIHN0cnVjdCBk
ZXZpY2UgKnBhcmVudDsKCiBzdHJ1Y3QgZGV2aWNlX3ByaXZhdGUgKnA7CgogY29uc3QgY2hh
ciAqaW5pdF9uYW1lOwogY29uc3Qgc3RydWN0IGRldmljZV90eXBlICp0eXBlOwoKIHN0cnVj
dCBidXNfdHlwZSAqYnVzOwogc3RydWN0IGRldmljZV9kcml2ZXIgKmRyaXZlcjsKCiB2b2lk
ICpwbGF0Zm9ybV9kYXRhOwoKIHZvaWQgKmRyaXZlcl9kYXRhOwoKCgoKIHN0cnVjdCBtdXRl
eCBtdXRleDsKCgoKIHN0cnVjdCBkZXZfbGlua3NfaW5mbyBsaW5rczsKIHN0cnVjdCBkZXZf
cG1faW5mbyBwb3dlcjsKIHN0cnVjdCBkZXZfcG1fZG9tYWluICpwbV9kb21haW47CgoKIHN0
cnVjdCBpcnFfZG9tYWluICptc2lfZG9tYWluOwoKCgoKCiBzdHJ1Y3QgbGlzdF9oZWFkIG1z
aV9saXN0OwoKCiBjb25zdCBzdHJ1Y3QgZG1hX21hcF9vcHMgKmRtYV9vcHM7CiB1NjQgKmRt
YV9tYXNrOwogdTY0IGNvaGVyZW50X2RtYV9tYXNrOwoKCgoKIHU2NCBidXNfZG1hX2xpbWl0
OwogdW5zaWduZWQgbG9uZyBkbWFfcGZuX29mZnNldDsKCiBzdHJ1Y3QgZGV2aWNlX2RtYV9w
YXJhbWV0ZXJzICpkbWFfcGFybXM7Cgogc3RydWN0IGxpc3RfaGVhZCBkbWFfcG9vbHM7CgoK
IHN0cnVjdCBkbWFfY29oZXJlbnRfbWVtICpkbWFfbWVtOwoKCgoKCgoKIHN0cnVjdCBkZXZf
YXJjaGRhdGEgYXJjaGRhdGE7Cgogc3RydWN0IGRldmljZV9ub2RlICpvZl9ub2RlOwogc3Ry
dWN0IGZ3bm9kZV9oYW5kbGUgKmZ3bm9kZTsKCgoKCiBkZXZfdCBkZXZ0OwogdTMyIGlkOwoK
IHNwaW5sb2NrX3QgZGV2cmVzX2xvY2s7CiBzdHJ1Y3QgbGlzdF9oZWFkIGRldnJlc19oZWFk
OwoKIHN0cnVjdCBjbGFzcyAqY2xhc3M7CiBjb25zdCBzdHJ1Y3QgYXR0cmlidXRlX2dyb3Vw
ICoqZ3JvdXBzOwoKIHZvaWQgKCpyZWxlYXNlKShzdHJ1Y3QgZGV2aWNlICpkZXYpOwogc3Ry
dWN0IGlvbW11X2dyb3VwICppb21tdV9ncm91cDsKIHN0cnVjdCBkZXZfaW9tbXUgKmlvbW11
OwoKIGJvb2wgb2ZmbGluZV9kaXNhYmxlZDoxOwogYm9vbCBvZmZsaW5lOjE7CiBib29sIG9m
X25vZGVfcmV1c2VkOjE7CiBib29sIHN0YXRlX3N5bmNlZDoxOwoKCgoKCn07CgpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgc3RydWN0IGRldmljZSAqa29ial90b19kZXYoc3RydWN0IGtvYmplY3QgKmtvYmopCnsK
IHJldHVybiAoeyB2b2lkICpfX21wdHIgPSAodm9pZCAqKShrb2JqKTsgZG8geyBleHRlcm4g
dm9pZCBfX2NvbXBpbGV0aW1lX2Fzc2VydF8xODUodm9pZCkgX19hdHRyaWJ1dGVfXygoX19l
cnJvcl9fKCJwb2ludGVyIHR5cGUgbWlzbWF0Y2ggaW4gY29udGFpbmVyX29mKCkiKSkpOyBp
ZiAoISghKCFfX2J1aWx0aW5fdHlwZXNfY29tcGF0aWJsZV9wKHR5cGVvZigqKGtvYmopKSwg
dHlwZW9mKCgoc3RydWN0IGRldmljZSAqKTApLT5rb2JqKSkgJiYgIV9fYnVpbHRpbl90eXBl
c19jb21wYXRpYmxlX3AodHlwZW9mKCooa29iaikpLCB0eXBlb2Yodm9pZCkpKSkpIF9fY29t
cGlsZXRpbWVfYXNzZXJ0XzE4NSgpOyB9IHdoaWxlICgwKTsgKChzdHJ1Y3QgZGV2aWNlICop
KF9fbXB0ciAtIF9fYnVpbHRpbl9vZmZzZXRvZihzdHJ1Y3QgZGV2aWNlLCBrb2JqKSkpOyB9
KTsKfQoKCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBkZXZpY2VfaW9tbXVfbWFwcGVkKHN0cnVjdCBk
ZXZpY2UgKmRldikKewogcmV0dXJuIChkZXYtPmlvbW11X2dyb3VwICE9ICgodm9pZCAqKTAp
KTsKfQoKCiMgMSAiLi9pbmNsdWRlL2xpbnV4L3BtX3dha2V1cC5oIiAxCiMgMTggIi4vaW5j
bHVkZS9saW51eC9wbV93YWtldXAuaCIKc3RydWN0IHdha2VfaXJxOwojIDQzICIuL2luY2x1
ZGUvbGludXgvcG1fd2FrZXVwLmgiCnN0cnVjdCB3YWtldXBfc291cmNlIHsKIGNvbnN0IGNo
YXIgKm5hbWU7CiBpbnQgaWQ7CiBzdHJ1Y3QgbGlzdF9oZWFkIGVudHJ5Owogc3BpbmxvY2tf
dCBsb2NrOwogc3RydWN0IHdha2VfaXJxICp3YWtlaXJxOwogc3RydWN0IHRpbWVyX2xpc3Qg
dGltZXI7CiB1bnNpZ25lZCBsb25nIHRpbWVyX2V4cGlyZXM7CiBrdGltZV90IHRvdGFsX3Rp
bWU7CiBrdGltZV90IG1heF90aW1lOwoga3RpbWVfdCBsYXN0X3RpbWU7CiBrdGltZV90IHN0
YXJ0X3ByZXZlbnRfdGltZTsKIGt0aW1lX3QgcHJldmVudF9zbGVlcF90aW1lOwogdW5zaWdu
ZWQgbG9uZyBldmVudF9jb3VudDsKIHVuc2lnbmVkIGxvbmcgYWN0aXZlX2NvdW50OwogdW5z
aWduZWQgbG9uZyByZWxheF9jb3VudDsKIHVuc2lnbmVkIGxvbmcgZXhwaXJlX2NvdW50Owog
dW5zaWduZWQgbG9uZyB3YWtldXBfY291bnQ7CiBzdHJ1Y3QgZGV2aWNlICpkZXY7CiBib29s
IGFjdGl2ZToxOwogYm9vbCBhdXRvc2xlZXBfZW5hYmxlZDoxOwp9OwojIDExOCAiLi9pbmNs
dWRlL2xpbnV4L3BtX3dha2V1cC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBkZXZpY2Vfc2V0X3dha2V1
cF9jYXBhYmxlKHN0cnVjdCBkZXZpY2UgKmRldiwgYm9vbCBjYXBhYmxlKQp7CiBkZXYtPnBv
d2VyLmNhbl93YWtldXAgPSBjYXBhYmxlOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBkZXZpY2VfY2Fu
X3dha2V1cChzdHJ1Y3QgZGV2aWNlICpkZXYpCnsKIHJldHVybiBkZXYtPnBvd2VyLmNhbl93
YWtldXA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3Qgd2FrZXVwX3NvdXJjZSAqd2FrZXVwX3NvdXJj
ZV9jcmVhdGUoY29uc3QgY2hhciAqbmFtZSkKewogcmV0dXJuICgodm9pZCAqKTApOwp9Cgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgdm9pZCB3YWtldXBfc291cmNlX2Rlc3Ryb3koc3RydWN0IHdha2V1cF9zb3Vy
Y2UgKndzKSB7fQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgd2FrZXVwX3NvdXJjZV9hZGQoc3RydWN0IHdh
a2V1cF9zb3VyY2UgKndzKSB7fQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgd2FrZXVwX3NvdXJjZV9yZW1v
dmUoc3RydWN0IHdha2V1cF9zb3VyY2UgKndzKSB7fQoKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHN0cnVjdCB3YWtl
dXBfc291cmNlICp3YWtldXBfc291cmNlX3JlZ2lzdGVyKHN0cnVjdCBkZXZpY2UgKmRldiwK
ICAgICAgICAgIGNvbnN0IGNoYXIgKm5hbWUpCnsKIHJldHVybiAoKHZvaWQgKikwKTsKfQoK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIHZvaWQgd2FrZXVwX3NvdXJjZV91bnJlZ2lzdGVyKHN0cnVjdCB3YWtldXBf
c291cmNlICp3cykge30KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgZGV2aWNlX3dha2V1cF9lbmFibGUoc3Ry
dWN0IGRldmljZSAqZGV2KQp7CiBkZXYtPnBvd2VyLnNob3VsZF93YWtldXAgPSB0cnVlOwog
cmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgZGV2aWNlX3dha2V1cF9kaXNhYmxlKHN0cnVj
dCBkZXZpY2UgKmRldikKewogZGV2LT5wb3dlci5zaG91bGRfd2FrZXVwID0gZmFsc2U7CiBy
ZXR1cm4gMDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBkZXZpY2Vfc2V0X3dha2V1cF9lbmFibGUoc3Ry
dWN0IGRldmljZSAqZGV2LCBib29sIGVuYWJsZSkKewogZGV2LT5wb3dlci5zaG91bGRfd2Fr
ZXVwID0gZW5hYmxlOwogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgZGV2aWNlX2luaXRf
d2FrZXVwKHN0cnVjdCBkZXZpY2UgKmRldiwgYm9vbCB2YWwpCnsKIGRldmljZV9zZXRfd2Fr
ZXVwX2NhcGFibGUoZGV2LCB2YWwpOwogZGV2aWNlX3NldF93YWtldXBfZW5hYmxlKGRldiwg
dmFsKTsKIHJldHVybiAwOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBkZXZpY2VfbWF5X3dha2V1cChz
dHJ1Y3QgZGV2aWNlICpkZXYpCnsKIHJldHVybiBkZXYtPnBvd2VyLmNhbl93YWtldXAgJiYg
ZGV2LT5wb3dlci5zaG91bGRfd2FrZXVwOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBkZXZpY2Vfc2V0
X3dha2V1cF9wYXRoKHN0cnVjdCBkZXZpY2UgKmRldikge30KCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIF9f
cG1fc3RheV9hd2FrZShzdHJ1Y3Qgd2FrZXVwX3NvdXJjZSAqd3MpIHt9CgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
dm9pZCBwbV9zdGF5X2F3YWtlKHN0cnVjdCBkZXZpY2UgKmRldikge30KCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2
b2lkIF9fcG1fcmVsYXgoc3RydWN0IHdha2V1cF9zb3VyY2UgKndzKSB7fQoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IHZvaWQgcG1fcmVsYXgoc3RydWN0IGRldmljZSAqZGV2KSB7fQoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQg
cG1fd2FrZXVwX3dzX2V2ZW50KHN0cnVjdCB3YWtldXBfc291cmNlICp3cywKICAgICAgICAg
IHVuc2lnbmVkIGludCBtc2VjLCBib29sIGhhcmQpIHt9CgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBwbV93
YWtldXBfZGV2X2V2ZW50KHN0cnVjdCBkZXZpY2UgKmRldiwgdW5zaWduZWQgaW50IG1zZWMs
CiAgICAgICAgICAgYm9vbCBoYXJkKSB7fQoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBfX3BtX3dha2V1
cF9ldmVudChzdHJ1Y3Qgd2FrZXVwX3NvdXJjZSAqd3MsIHVuc2lnbmVkIGludCBtc2VjKQp7
CiByZXR1cm4gcG1fd2FrZXVwX3dzX2V2ZW50KHdzLCBtc2VjLCBmYWxzZSk7Cn0KCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSB2b2lkIHBtX3dha2V1cF9ldmVudChzdHJ1Y3QgZGV2aWNlICpkZXYsIHVuc2lnbmVk
IGludCBtc2VjKQp7CiByZXR1cm4gcG1fd2FrZXVwX2Rldl9ldmVudChkZXYsIG1zZWMsIGZh
bHNlKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgcG1fd2FrZXVwX2hhcmRfZXZlbnQoc3RydWN0IGRl
dmljZSAqZGV2KQp7CiByZXR1cm4gcG1fd2FrZXVwX2Rldl9ldmVudChkZXYsIDAsIHRydWUp
Owp9CiMgNjQ0ICIuL2luY2x1ZGUvbGludXgvZGV2aWNlLmgiIDIKCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBjb25z
dCBjaGFyICpkZXZfbmFtZShjb25zdCBzdHJ1Y3QgZGV2aWNlICpkZXYpCnsKCiBpZiAoZGV2
LT5pbml0X25hbWUpCiAgcmV0dXJuIGRldi0+aW5pdF9uYW1lOwoKIHJldHVybiBrb2JqZWN0
X25hbWUoJmRldi0+a29iaik7Cn0KCmV4dGVybiBfX2F0dHJpYnV0ZV9fKChfX2Zvcm1hdF9f
KHByaW50ZiwgMiwgMykpKQppbnQgZGV2X3NldF9uYW1lKHN0cnVjdCBkZXZpY2UgKmRldiwg
Y29uc3QgY2hhciAqbmFtZSwgLi4uKTsKIyA2NjcgIi4vaW5jbHVkZS9saW51eC9kZXZpY2Uu
aCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIGludCBkZXZfdG9fbm9kZShzdHJ1Y3QgZGV2aWNlICpkZXYpCnsKIHJl
dHVybiAoLTEpOwp9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHNldF9kZXZfbm9kZShzdHJ1Y3QgZGV2aWNl
ICpkZXYsIGludCBub2RlKQp7Cn0KCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IGlycV9kb21haW4gKmRl
dl9nZXRfbXNpX2RvbWFpbihjb25zdCBzdHJ1Y3QgZGV2aWNlICpkZXYpCnsKCiByZXR1cm4g
ZGV2LT5tc2lfZG9tYWluOwoKCgp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBkZXZfc2V0X21zaV9kb21h
aW4oc3RydWN0IGRldmljZSAqZGV2LCBzdHJ1Y3QgaXJxX2RvbWFpbiAqZCkKewoKIGRldi0+
bXNpX2RvbWFpbiA9IGQ7Cgp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCAqZGV2X2dldF9kcnZkYXRhKGNv
bnN0IHN0cnVjdCBkZXZpY2UgKmRldikKewogcmV0dXJuIGRldi0+ZHJpdmVyX2RhdGE7Cn0K
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSB2b2lkIGRldl9zZXRfZHJ2ZGF0YShzdHJ1Y3QgZGV2aWNlICpkZXYsIHZv
aWQgKmRhdGEpCnsKIGRldi0+ZHJpdmVyX2RhdGEgPSBkYXRhOwp9CgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3Ry
dWN0IHBtX3N1YnN5c19kYXRhICpkZXZfdG9fcHNkKHN0cnVjdCBkZXZpY2UgKmRldikKewog
cmV0dXJuIGRldiA/IGRldi0+cG93ZXIuc3Vic3lzX2RhdGEgOiAoKHZvaWQgKikwKTsKfQoK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIHVuc2lnbmVkIGludCBkZXZfZ2V0X3VldmVudF9zdXBwcmVzcyhjb25zdCBz
dHJ1Y3QgZGV2aWNlICpkZXYpCnsKIHJldHVybiBkZXYtPmtvYmoudWV2ZW50X3N1cHByZXNz
Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgdm9pZCBkZXZfc2V0X3VldmVudF9zdXBwcmVzcyhzdHJ1Y3QgZGV2
aWNlICpkZXYsIGludCB2YWwpCnsKIGRldi0+a29iai51ZXZlbnRfc3VwcHJlc3MgPSB2YWw7
Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSBpbnQgZGV2aWNlX2lzX3JlZ2lzdGVyZWQoc3RydWN0IGRldmljZSAq
ZGV2KQp7CiByZXR1cm4gZGV2LT5rb2JqLnN0YXRlX2luX3N5c2ZzOwp9CgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
dm9pZCBkZXZpY2VfZW5hYmxlX2FzeW5jX3N1c3BlbmQoc3RydWN0IGRldmljZSAqZGV2KQp7
CiBpZiAoIWRldi0+cG93ZXIuaXNfcHJlcGFyZWQpCiAgZGV2LT5wb3dlci5hc3luY19zdXNw
ZW5kID0gdHJ1ZTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgZGV2aWNlX2Rpc2FibGVfYXN5bmNfc3Vz
cGVuZChzdHJ1Y3QgZGV2aWNlICpkZXYpCnsKIGlmICghZGV2LT5wb3dlci5pc19wcmVwYXJl
ZCkKICBkZXYtPnBvd2VyLmFzeW5jX3N1c3BlbmQgPSBmYWxzZTsKfQoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJv
b2wgZGV2aWNlX2FzeW5jX3N1c3BlbmRfZW5hYmxlZChzdHJ1Y3QgZGV2aWNlICpkZXYpCnsK
IHJldHVybiAhIWRldi0+cG93ZXIuYXN5bmNfc3VzcGVuZDsKfQoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wg
ZGV2aWNlX3BtX25vdF9yZXF1aXJlZChzdHJ1Y3QgZGV2aWNlICpkZXYpCnsKIHJldHVybiBk
ZXYtPnBvd2VyLm5vX3BtOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBkZXZpY2Vfc2V0X3BtX25vdF9y
ZXF1aXJlZChzdHJ1Y3QgZGV2aWNlICpkZXYpCnsKIGRldi0+cG93ZXIubm9fcG0gPSB0cnVl
Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgdm9pZCBkZXZfcG1fc3lzY29yZV9kZXZpY2Uoc3RydWN0IGRldmlj
ZSAqZGV2LCBib29sIHZhbCkKewoKCgp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBkZXZfcG1fc2V0X2Ry
aXZlcl9mbGFncyhzdHJ1Y3QgZGV2aWNlICpkZXYsIHUzMiBmbGFncykKewogZGV2LT5wb3dl
ci5kcml2ZXJfZmxhZ3MgPSBmbGFnczsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgZGV2X3BtX3Rlc3Rf
ZHJpdmVyX2ZsYWdzKHN0cnVjdCBkZXZpY2UgKmRldiwgdTMyIGZsYWdzKQp7CiByZXR1cm4g
ISEoZGV2LT5wb3dlci5kcml2ZXJfZmxhZ3MgJiBmbGFncyk7Cn0KCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lk
IGRldmljZV9sb2NrKHN0cnVjdCBkZXZpY2UgKmRldikKewogbXV0ZXhfbG9jaygmZGV2LT5t
dXRleCk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgZGV2aWNlX2xvY2tfaW50ZXJydXB0aWJsZShzdHJ1
Y3QgZGV2aWNlICpkZXYpCnsKIHJldHVybiBtdXRleF9sb2NrX2ludGVycnVwdGlibGUoJmRl
di0+bXV0ZXgpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGRldmljZV90cnlsb2NrKHN0cnVjdCBkZXZp
Y2UgKmRldikKewogcmV0dXJuIG11dGV4X3RyeWxvY2soJmRldi0+bXV0ZXgpOwp9CgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgdm9pZCBkZXZpY2VfdW5sb2NrKHN0cnVjdCBkZXZpY2UgKmRldikKewogbXV0ZXhf
dW5sb2NrKCZkZXYtPm11dGV4KTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgZGV2aWNlX2xvY2tfYXNz
ZXJ0KHN0cnVjdCBkZXZpY2UgKmRldikKewogZG8geyAodm9pZCkoJmRldi0+bXV0ZXgpOyB9
IHdoaWxlICgwKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHN0cnVjdCBkZXZpY2Vfbm9kZSAqZGV2X29mX25v
ZGUoc3RydWN0IGRldmljZSAqZGV2KQp7CiBpZiAoITEgfHwgIWRldikKICByZXR1cm4gKCh2
b2lkICopMCk7CiByZXR1cm4gZGV2LT5vZl9ub2RlOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBkZXZf
aGFzX3N5bmNfc3RhdGUoc3RydWN0IGRldmljZSAqZGV2KQp7CiBpZiAoIWRldikKICByZXR1
cm4gZmFsc2U7CiBpZiAoZGV2LT5kcml2ZXIgJiYgZGV2LT5kcml2ZXItPnN5bmNfc3RhdGUp
CiAgcmV0dXJuIHRydWU7CiBpZiAoZGV2LT5idXMgJiYgZGV2LT5idXMtPnN5bmNfc3RhdGUp
CiAgcmV0dXJuIHRydWU7CiByZXR1cm4gZmFsc2U7Cn0KCgoKCmV4dGVybiBpbnQgX19hdHRy
aWJ1dGVfXygoX193YXJuX3VudXNlZF9yZXN1bHRfXykpIGRldmljZV9yZWdpc3RlcihzdHJ1
Y3QgZGV2aWNlICpkZXYpOwpleHRlcm4gdm9pZCBkZXZpY2VfdW5yZWdpc3RlcihzdHJ1Y3Qg
ZGV2aWNlICpkZXYpOwpleHRlcm4gdm9pZCBkZXZpY2VfaW5pdGlhbGl6ZShzdHJ1Y3QgZGV2
aWNlICpkZXYpOwpleHRlcm4gaW50IF9fYXR0cmlidXRlX18oKF9fd2Fybl91bnVzZWRfcmVz
dWx0X18pKSBkZXZpY2VfYWRkKHN0cnVjdCBkZXZpY2UgKmRldik7CmV4dGVybiB2b2lkIGRl
dmljZV9kZWwoc3RydWN0IGRldmljZSAqZGV2KTsKZXh0ZXJuIGludCBkZXZpY2VfZm9yX2Vh
Y2hfY2hpbGQoc3RydWN0IGRldmljZSAqZGV2LCB2b2lkICpkYXRhLAogICAgICAgaW50ICgq
Zm4pKHN0cnVjdCBkZXZpY2UgKmRldiwgdm9pZCAqZGF0YSkpOwpleHRlcm4gaW50IGRldmlj
ZV9mb3JfZWFjaF9jaGlsZF9yZXZlcnNlKHN0cnVjdCBkZXZpY2UgKmRldiwgdm9pZCAqZGF0
YSwKICAgICAgIGludCAoKmZuKShzdHJ1Y3QgZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEpKTsK
ZXh0ZXJuIHN0cnVjdCBkZXZpY2UgKmRldmljZV9maW5kX2NoaWxkKHN0cnVjdCBkZXZpY2Ug
KmRldiwgdm9pZCAqZGF0YSwKICAgIGludCAoKm1hdGNoKShzdHJ1Y3QgZGV2aWNlICpkZXYs
IHZvaWQgKmRhdGEpKTsKZXh0ZXJuIHN0cnVjdCBkZXZpY2UgKmRldmljZV9maW5kX2NoaWxk
X2J5X25hbWUoc3RydWN0IGRldmljZSAqcGFyZW50LAogICAgICBjb25zdCBjaGFyICpuYW1l
KTsKZXh0ZXJuIGludCBkZXZpY2VfcmVuYW1lKHN0cnVjdCBkZXZpY2UgKmRldiwgY29uc3Qg
Y2hhciAqbmV3X25hbWUpOwpleHRlcm4gaW50IGRldmljZV9tb3ZlKHN0cnVjdCBkZXZpY2Ug
KmRldiwgc3RydWN0IGRldmljZSAqbmV3X3BhcmVudCwKICAgICAgICAgZW51bSBkcG1fb3Jk
ZXIgZHBtX29yZGVyKTsKZXh0ZXJuIGludCBkZXZpY2VfY2hhbmdlX293bmVyKHN0cnVjdCBk
ZXZpY2UgKmRldiwga3VpZF90IGt1aWQsIGtnaWRfdCBrZ2lkKTsKZXh0ZXJuIGNvbnN0IGNo
YXIgKmRldmljZV9nZXRfZGV2bm9kZShzdHJ1Y3QgZGV2aWNlICpkZXYsCiAgICAgICAgICB1
bW9kZV90ICptb2RlLCBrdWlkX3QgKnVpZCwga2dpZF90ICpnaWQsCiAgICAgICAgICBjb25z
dCBjaGFyICoqdG1wKTsKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIGRldmljZV9zdXBwb3J0c19vZmZsaW5l
KHN0cnVjdCBkZXZpY2UgKmRldikKewogcmV0dXJuIGRldi0+YnVzICYmIGRldi0+YnVzLT5v
ZmZsaW5lICYmIGRldi0+YnVzLT5vbmxpbmU7Cn0KCmV4dGVybiB2b2lkIGxvY2tfZGV2aWNl
X2hvdHBsdWcodm9pZCk7CmV4dGVybiB2b2lkIHVubG9ja19kZXZpY2VfaG90cGx1Zyh2b2lk
KTsKZXh0ZXJuIGludCBsb2NrX2RldmljZV9ob3RwbHVnX3N5c2ZzKHZvaWQpOwpleHRlcm4g
aW50IGRldmljZV9vZmZsaW5lKHN0cnVjdCBkZXZpY2UgKmRldik7CmV4dGVybiBpbnQgZGV2
aWNlX29ubGluZShzdHJ1Y3QgZGV2aWNlICpkZXYpOwpleHRlcm4gdm9pZCBzZXRfcHJpbWFy
eV9md25vZGUoc3RydWN0IGRldmljZSAqZGV2LCBzdHJ1Y3QgZndub2RlX2hhbmRsZSAqZndu
b2RlKTsKZXh0ZXJuIHZvaWQgc2V0X3NlY29uZGFyeV9md25vZGUoc3RydWN0IGRldmljZSAq
ZGV2LCBzdHJ1Y3QgZndub2RlX2hhbmRsZSAqZndub2RlKTsKdm9pZCBkZXZpY2Vfc2V0X29m
X25vZGVfZnJvbV9kZXYoc3RydWN0IGRldmljZSAqZGV2LCBjb25zdCBzdHJ1Y3QgZGV2aWNl
ICpkZXYyKTsKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgZGV2X251bV92ZihzdHJ1Y3QgZGV2aWNlICpkZXYp
CnsKIGlmIChkZXYtPmJ1cyAmJiBkZXYtPmJ1cy0+bnVtX3ZmKQogIHJldHVybiBkZXYtPmJ1
cy0+bnVtX3ZmKGRldik7CiByZXR1cm4gMDsKfQoKCgoKZXh0ZXJuIHN0cnVjdCBkZXZpY2Ug
Kl9fcm9vdF9kZXZpY2VfcmVnaXN0ZXIoY29uc3QgY2hhciAqbmFtZSwKICAgICAgICAgIHN0
cnVjdCBtb2R1bGUgKm93bmVyKTsKCgoKCgpleHRlcm4gdm9pZCByb290X2RldmljZV91bnJl
Z2lzdGVyKHN0cnVjdCBkZXZpY2UgKnJvb3QpOwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgKmRldl9nZXRf
cGxhdGRhdGEoY29uc3Qgc3RydWN0IGRldmljZSAqZGV2KQp7CiByZXR1cm4gZGV2LT5wbGF0
Zm9ybV9kYXRhOwp9CgoKCgoKZXh0ZXJuIGludCBfX2F0dHJpYnV0ZV9fKChfX3dhcm5fdW51
c2VkX3Jlc3VsdF9fKSkgZGV2aWNlX2JpbmRfZHJpdmVyKHN0cnVjdCBkZXZpY2UgKmRldik7
CmV4dGVybiB2b2lkIGRldmljZV9yZWxlYXNlX2RyaXZlcihzdHJ1Y3QgZGV2aWNlICpkZXYp
OwpleHRlcm4gaW50IF9fYXR0cmlidXRlX18oKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKSBk
ZXZpY2VfYXR0YWNoKHN0cnVjdCBkZXZpY2UgKmRldik7CmV4dGVybiBpbnQgX19hdHRyaWJ1
dGVfXygoX193YXJuX3VudXNlZF9yZXN1bHRfXykpIGRyaXZlcl9hdHRhY2goc3RydWN0IGRl
dmljZV9kcml2ZXIgKmRydik7CmV4dGVybiB2b2lkIGRldmljZV9pbml0aWFsX3Byb2JlKHN0
cnVjdCBkZXZpY2UgKmRldik7CmV4dGVybiBpbnQgX19hdHRyaWJ1dGVfXygoX193YXJuX3Vu
dXNlZF9yZXN1bHRfXykpIGRldmljZV9yZXByb2JlKHN0cnVjdCBkZXZpY2UgKmRldik7Cgpl
eHRlcm4gYm9vbCBkZXZpY2VfaXNfYm91bmQoc3RydWN0IGRldmljZSAqZGV2KTsKCgoKCmV4
dGVybiBfX2F0dHJpYnV0ZV9fKChfX2Zvcm1hdF9fKHByaW50ZiwgNSwgNikpKQpzdHJ1Y3Qg
ZGV2aWNlICpkZXZpY2VfY3JlYXRlKHN0cnVjdCBjbGFzcyAqY2xzLCBzdHJ1Y3QgZGV2aWNl
ICpwYXJlbnQsCiAgICAgICAgZGV2X3QgZGV2dCwgdm9pZCAqZHJ2ZGF0YSwKICAgICAgICBj
b25zdCBjaGFyICpmbXQsIC4uLik7CmV4dGVybiBfX2F0dHJpYnV0ZV9fKChfX2Zvcm1hdF9f
KHByaW50ZiwgNiwgNykpKQpzdHJ1Y3QgZGV2aWNlICpkZXZpY2VfY3JlYXRlX3dpdGhfZ3Jv
dXBzKHN0cnVjdCBjbGFzcyAqY2xzLAogICAgICAgIHN0cnVjdCBkZXZpY2UgKnBhcmVudCwg
ZGV2X3QgZGV2dCwgdm9pZCAqZHJ2ZGF0YSwKICAgICAgICBjb25zdCBzdHJ1Y3QgYXR0cmli
dXRlX2dyb3VwICoqZ3JvdXBzLAogICAgICAgIGNvbnN0IGNoYXIgKmZtdCwgLi4uKTsKZXh0
ZXJuIHZvaWQgZGV2aWNlX2Rlc3Ryb3koc3RydWN0IGNsYXNzICpjbHMsIGRldl90IGRldnQp
OwoKZXh0ZXJuIGludCBfX2F0dHJpYnV0ZV9fKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkg
ZGV2aWNlX2FkZF9ncm91cHMoc3RydWN0IGRldmljZSAqZGV2LAogICAgIGNvbnN0IHN0cnVj
dCBhdHRyaWJ1dGVfZ3JvdXAgKipncm91cHMpOwpleHRlcm4gdm9pZCBkZXZpY2VfcmVtb3Zl
X2dyb3VwcyhzdHJ1Y3QgZGV2aWNlICpkZXYsCiAgICAgY29uc3Qgc3RydWN0IGF0dHJpYnV0
ZV9ncm91cCAqKmdyb3Vwcyk7CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IF9fYXR0cmlidXRlX18oKF9fd2Fy
bl91bnVzZWRfcmVzdWx0X18pKSBkZXZpY2VfYWRkX2dyb3VwKHN0cnVjdCBkZXZpY2UgKmRl
diwKICAgICBjb25zdCBzdHJ1Y3QgYXR0cmlidXRlX2dyb3VwICpncnApCnsKIGNvbnN0IHN0
cnVjdCBhdHRyaWJ1dGVfZ3JvdXAgKmdyb3Vwc1tdID0geyBncnAsICgodm9pZCAqKTApIH07
CgogcmV0dXJuIGRldmljZV9hZGRfZ3JvdXBzKGRldiwgZ3JvdXBzKTsKfQoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IHZvaWQgZGV2aWNlX3JlbW92ZV9ncm91cChzdHJ1Y3QgZGV2aWNlICpkZXYsCiAgICAgICAg
ICAgY29uc3Qgc3RydWN0IGF0dHJpYnV0ZV9ncm91cCAqZ3JwKQp7CiBjb25zdCBzdHJ1Y3Qg
YXR0cmlidXRlX2dyb3VwICpncm91cHNbXSA9IHsgZ3JwLCAoKHZvaWQgKikwKSB9OwoKIHJl
dHVybiBkZXZpY2VfcmVtb3ZlX2dyb3VwcyhkZXYsIGdyb3Vwcyk7Cn0KCmV4dGVybiBpbnQg
X19hdHRyaWJ1dGVfXygoX193YXJuX3VudXNlZF9yZXN1bHRfXykpIGRldm1fZGV2aWNlX2Fk
ZF9ncm91cHMoc3RydWN0IGRldmljZSAqZGV2LAogICAgIGNvbnN0IHN0cnVjdCBhdHRyaWJ1
dGVfZ3JvdXAgKipncm91cHMpOwpleHRlcm4gdm9pZCBkZXZtX2RldmljZV9yZW1vdmVfZ3Jv
dXBzKHN0cnVjdCBkZXZpY2UgKmRldiwKICAgICAgICAgIGNvbnN0IHN0cnVjdCBhdHRyaWJ1
dGVfZ3JvdXAgKipncm91cHMpOwpleHRlcm4gaW50IF9fYXR0cmlidXRlX18oKF9fd2Fybl91
bnVzZWRfcmVzdWx0X18pKSBkZXZtX2RldmljZV9hZGRfZ3JvdXAoc3RydWN0IGRldmljZSAq
ZGV2LAogICAgIGNvbnN0IHN0cnVjdCBhdHRyaWJ1dGVfZ3JvdXAgKmdycCk7CmV4dGVybiB2
b2lkIGRldm1fZGV2aWNlX3JlbW92ZV9ncm91cChzdHJ1Y3QgZGV2aWNlICpkZXYsCiAgICAg
ICAgIGNvbnN0IHN0cnVjdCBhdHRyaWJ1dGVfZ3JvdXAgKmdycCk7CgoKCgoKCgpleHRlcm4g
aW50ICgqcGxhdGZvcm1fbm90aWZ5KShzdHJ1Y3QgZGV2aWNlICpkZXYpOwoKZXh0ZXJuIGlu
dCAoKnBsYXRmb3JtX25vdGlmeV9yZW1vdmUpKHN0cnVjdCBkZXZpY2UgKmRldik7CgoKCgoK
CmV4dGVybiBzdHJ1Y3QgZGV2aWNlICpnZXRfZGV2aWNlKHN0cnVjdCBkZXZpY2UgKmRldik7
CmV4dGVybiB2b2lkIHB1dF9kZXZpY2Uoc3RydWN0IGRldmljZSAqZGV2KTsKZXh0ZXJuIGJv
b2wga2lsbF9kZXZpY2Uoc3RydWN0IGRldmljZSAqZGV2KTsKCgpleHRlcm4gaW50IGRldnRt
cGZzX21vdW50KHZvaWQpOwoKCgoKCmV4dGVybiB2b2lkIGRldmljZV9zaHV0ZG93bih2b2lk
KTsKCgpleHRlcm4gY29uc3QgY2hhciAqZGV2X2RyaXZlcl9zdHJpbmcoY29uc3Qgc3RydWN0
IGRldmljZSAqZGV2KTsKCgpzdHJ1Y3QgZGV2aWNlX2xpbmsgKmRldmljZV9saW5rX2FkZChz
dHJ1Y3QgZGV2aWNlICpjb25zdW1lciwKICAgICAgICBzdHJ1Y3QgZGV2aWNlICpzdXBwbGll
ciwgdTMyIGZsYWdzKTsKdm9pZCBkZXZpY2VfbGlua19kZWwoc3RydWN0IGRldmljZV9saW5r
ICpsaW5rKTsKdm9pZCBkZXZpY2VfbGlua19yZW1vdmUodm9pZCAqY29uc3VtZXIsIHN0cnVj
dCBkZXZpY2UgKnN1cHBsaWVyKTsKdm9pZCBkZXZpY2VfbGlua3Nfc3VwcGxpZXJfc3luY19z
dGF0ZV9wYXVzZSh2b2lkKTsKdm9pZCBkZXZpY2VfbGlua3Nfc3VwcGxpZXJfc3luY19zdGF0
ZV9yZXN1bWUodm9pZCk7CiMgMjggIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2lvLmgi
IDIKCgoKCgojIDEgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2RlbGF5LmgiIDEKCgoK
CgojIDEgIi4vaW5jbHVkZS9saW51eC9wcm9jZXNzb3IuaCIgMQojIDcgIi4vYXJjaC9wb3dl
cnBjL2luY2x1ZGUvYXNtL2RlbGF5LmgiIDIKIyAxICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRl
L2FzbS90aW1lLmgiIDEKIyAxNyAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vdGltZS5o
IgojIDEgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2NwdV9oYXNfZmVhdHVyZS5oIiAx
CiMgMTAgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2NwdV9oYXNfZmVhdHVyZS5oIgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgYm9vbCBlYXJseV9jcHVfaGFzX2ZlYXR1cmUodW5zaWduZWQgbG9uZyBmZWF0
dXJlKQp7CiByZXR1cm4gISEoKCgoMHgwMDAwMDAyMFVMIHwgMHgwMDAwMDA4MFVMIHwgMHgw
MDAwMDEwMFVMIHwgMHgwMDAwMDAwNFVMIHwgMHgwMDAwMDAwMTAwMDAwMDAwVUwgfCAweDAw
MDAwMDAyMDAwMDAwMDBVTCB8IDB4MDAwMDAwMTBVTCB8IDB4MDAwMDAyMDBVTCB8IDB4MDAw
MDAwMDJVTCB8IDB4MDAwMDAwMDAwMDgwMDAwMFVMIHwgMHgwMDAwMDAwMDAwMTAwMDAwVUwp
ICYgKDB4MDAwMDAwMjBVTCB8IDB4MDAwMDAwODBVTCB8IDB4MDAwMDAxMDBVTCB8IDB4MDAw
MDAwMDRVTCB8IDB4MDAwMDAwMDEwMDAwMDAwMFVMIHwgMHgwMDAwMDAwMjAwMDAwMDAwVUwg
fCAweDAwMDAwMDEwVUwgfCAweDAwMDAwMjAwVUwgfCAweDAwMDAwMDAwMDA4MDAwMDBVTCkp
ICYgZmVhdHVyZSkgfHwKICAgICgoKDB4MDAwMDAwMjBVTCB8IDB4MDAwMDAwODBVTCB8IDB4
MDAwMDAxMDBVTCB8IDB4MDAwMDAwMDRVTCB8IDB4MDAwMDAwMDEwMDAwMDAwMFVMIHwgMHgw
MDAwMDAwMjAwMDAwMDAwVUwgfCAweDAwMDAwMDEwVUwgfCAweDAwMDAwMjAwVUwgfCAweDAw
MDAwMDAyVUwgfCAweDAwMDAwMDAwMDA4MDAwMDBVTCB8IDB4MDAwMDAwMDAwMDEwMDAwMFVM
KSB8ICgweDAwMDAwMDIwVUwgfCAweDAwMDAwMDgwVUwgfCAweDAwMDAwMTAwVUwgfCAweDAw
MDAwMDA0VUwgfCAweDAwMDAwMDAxMDAwMDAwMDBVTCB8IDB4MDAwMDAwMDIwMDAwMDAwMFVM
IHwgMHgwMDAwMDAxMFVMIHwgMHgwMDAwMDIwMFVMIHwgMHgwMDAwMDAwMDAwODAwMDAwVUwp
KSAmIGN1cl9jcHVfc3BlYy0+Y3B1X2ZlYXR1cmVzICYgZmVhdHVyZSkpOwp9CiMgNDkgIi4v
YXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2NwdV9oYXNfZmVhdHVyZS5oIgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
Ym9vbCBjcHVfaGFzX2ZlYXR1cmUodW5zaWduZWQgbG9uZyBmZWF0dXJlKQp7CiByZXR1cm4g
ZWFybHlfY3B1X2hhc19mZWF0dXJlKGZlYXR1cmUpOwp9CiMgMTggIi4vYXJjaC9wb3dlcnBj
L2luY2x1ZGUvYXNtL3RpbWUuaCIgMgoKCmV4dGVybiB1bnNpZ25lZCBsb25nIHRiX3RpY2tz
X3Blcl9qaWZmeTsKZXh0ZXJuIHVuc2lnbmVkIGxvbmcgdGJfdGlja3NfcGVyX3VzZWM7CmV4
dGVybiB1bnNpZ25lZCBsb25nIHRiX3RpY2tzX3Blcl9zZWM7CmV4dGVybiBzdHJ1Y3QgY2xv
Y2tfZXZlbnRfZGV2aWNlIGRlY3JlbWVudGVyX2Nsb2NrZXZlbnQ7CgoKZXh0ZXJuIHZvaWQg
Z2VuZXJpY19jYWxpYnJhdGVfZGVjcih2b2lkKTsKCgpleHRlcm4gdW5zaWduZWQgbG9uZyBw
cGNfcHJvY19mcmVxOwoKZXh0ZXJuIHVuc2lnbmVkIGxvbmcgcHBjX3RiX2ZyZXE7CgoKZXh0
ZXJuIGJvb2wgdGJfaW52YWxpZDsKCnN0cnVjdCBkaXZfcmVzdWx0IHsKIHU2NCByZXN1bHRf
aGlnaDsKIHU2NCByZXN1bHRfbG93Owp9OwojIDYzICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRl
L2FzbS90aW1lLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1bnNpZ25lZCBpbnQgZ2V0X3J0Y2wodm9pZCkKewog
dW5zaWduZWQgaW50IHJ0Y2w7CgogYXNtIHZvbGF0aWxlKCJtZnJ0Y2wgJTAiIDogIj1yIiAo
cnRjbCkpOwogcmV0dXJuIHJ0Y2w7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1NjQgZ2V0X3J0Yyh2b2lkKQp7
CiB1bnNpZ25lZCBpbnQgaGksIGxvLCBoaTI7CgogZG8gewogIGFzbSB2b2xhdGlsZSgibWZy
dGN1ICUwOyBtZnJ0Y2wgJTE7IG1mcnRjdSAlMiIKICAgICAgICA6ICI9ciIgKGhpKSwgIj1y
IiAobG8pLCAiPXIiIChoaTIpKTsKIH0gd2hpbGUgKGhpMiAhPSBoaSk7CiByZXR1cm4gKHU2
NCloaSAqIDEwMDAwMDAwMDAgKyBsbzsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHU2NCBnZXRfdnRiKHZvaWQp
CnsKCgoKCiByZXR1cm4gMDsKfQoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1NjQgZ2V0X3RiKHZvaWQpCnsKIHJl
dHVybiAoe3Vuc2lnbmVkIGxvbmcgcnZhbDsgYXNtIHZvbGF0aWxlKCAiOTA6CW1mc3ByICUw
LCAlMjtcbiIgIjk3MToiICIgIiAiOTc6CWNtcHdpICUwLDA7XG4iICIJYmVxLSA5MGI7XG4i
ICI7ICIgIjk3MjogLnB1c2hzZWN0aW9uIF9fZnRyX2FsdF85NyxcImFcIjsgLmFsaWduIDI7
IDk3MzoiICIgIiAiIiAiOyAiICI5NzQ6IC5wb3BzZWN0aW9uOyAucHVzaHNlY3Rpb24gX19m
dHJfZml4dXAsXCJhXCI7IC5hbGlnbiAzOyA5NzU6IC44Ynl0ZSAoKCUxKSk7IC44Ynl0ZSAo
KCUxKSk7IC44Ynl0ZSA5NzFiLTk3NWI7IC44Ynl0ZSA5NzJiLTk3NWI7IC44Ynl0ZSA5NzNi
LTk3NWI7IC44Ynl0ZSA5NzRiLTk3NWI7IC5pZmd0ICg5NzRiLSA5NzNiKS0oOTcyYi0gOTcx
Yik7IC5lcnJvciBcIkZlYXR1cmUgc2VjdGlvbiBlbHNlIGNhc2UgbGFyZ2VyIHRoYW4gYm9k
eVwiOyAuZW5kaWY7IC5wb3BzZWN0aW9uOyIgIiAiIDogIj1yIiAocnZhbCkgOiAiaSIgKDB4
MDAwMDAwMDAwMDgwMDAwMFVMKSwgImkiICgweDEwQykgOiAiY3IwIik7IHJ2YWw7fSk7Cn0K
IyAxMTEgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL3RpbWUuaCIKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHU2
NCBnZXRfdGJfb3JfcnRjKHZvaWQpCnsKIHJldHVybiAoMCkgPyBnZXRfcnRjKCkgOiBnZXRf
dGIoKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgc2V0X3RiKHVuc2lnbmVkIGludCB1cHBlciwgdW5z
aWduZWQgaW50IGxvd2VyKQp7CiBhc20gdm9sYXRpbGUoIm10c3ByICIgIjB4MTFDIiAiLCUw
IiA6IDogInIiICgodW5zaWduZWQgbG9uZykoMCkpIDogIm1lbW9yeSIpOwogYXNtIHZvbGF0
aWxlKCJtdHNwciAiICIweDExRCIgIiwlMCIgOiA6ICJyIiAoKHVuc2lnbmVkIGxvbmcpKHVw
cGVyKSkgOiAibWVtb3J5Iik7CiBhc20gdm9sYXRpbGUoIm10c3ByICIgIjB4MTFDIiAiLCUw
IiA6IDogInIiICgodW5zaWduZWQgbG9uZykobG93ZXIpKSA6ICJtZW1vcnkiKTsKfQoKCgoK
CgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIHU2NCBnZXRfZGVjKHZvaWQpCnsKCgoKIHJldHVybiAoKHt1bnNpZ25l
ZCBsb25nIHJ2YWw7IGFzbSB2b2xhdGlsZSgibWZzcHIgJTAsIiAiMHgwMTYiIDogIj1yIiAo
cnZhbCkpOyBydmFsO30pKTsKCn0KCgoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgc2V0X2RlYyh1NjQg
dmFsKQp7CgoKCgoKCiBhc20gdm9sYXRpbGUoIm10c3ByICIgIjB4MDE2IiAiLCUwIiA6IDog
InIiICgodW5zaWduZWQgbG9uZykodmFsKSkgOiAibWVtb3J5Iik7Cgp9CgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
dW5zaWduZWQgbG9uZyB0Yl90aWNrc19zaW5jZSh1bnNpZ25lZCBsb25nIHRzdGFtcCkKewog
aWYgKCgwKSkgewogIGludCBkZWx0YSA9IGdldF9ydGNsKCkgLSAodW5zaWduZWQgaW50KSB0
c3RhbXA7CiAgcmV0dXJuIGRlbHRhIDwgMCA/IGRlbHRhICsgMTAwMDAwMDAwMCA6IGRlbHRh
OwogfQogcmV0dXJuIGdldF90YigpIC0gdHN0YW1wOwp9CiMgMTc0ICIuL2FyY2gvcG93ZXJw
Yy9pbmNsdWRlL2FzbS90aW1lLmgiCmV4dGVybiB2b2lkIGRpdjEyOF9ieV8zMih1NjQgZGl2
aWRlbmRfaGlnaCwgdTY0IGRpdmlkZW5kX2xvdywKICAgIHVuc2lnbmVkIGRpdmlzb3IsIHN0
cnVjdCBkaXZfcmVzdWx0ICpkcik7CgpleHRlcm4gdm9pZCBzZWNvbmRhcnlfY3B1X3RpbWVf
aW5pdCh2b2lkKTsKZXh0ZXJuIHZvaWQgX19hdHRyaWJ1dGVfXygoX19zZWN0aW9uX18oIi5p
bml0LnRleHQiKSkpIF9fYXR0cmlidXRlX18oKF9fY29sZF9fKSkgdGltZV9pbml0KHZvaWQp
OwoKZXh0ZXJuIF9fYXR0cmlidXRlX18oKHNlY3Rpb24oIi5kYXRhLi5wZXJjcHUiICIiKSkp
IF9fdHlwZW9mX18odTY0KSBkZWNyZW1lbnRlcnNfbmV4dF90YjsKCgp1bnNpZ25lZCBsb25n
IGxvbmcgdGJfdG9fbnModW5zaWduZWQgbG9uZyBsb25nIHRiX3RpY2tzKTsKCgp2b2lkIGFj
Y3VtdWxhdGVfc3RvbGVuX3RpbWUodm9pZCk7CiMgOCAiLi9hcmNoL3Bvd2VycGMvaW5jbHVk
ZS9hc20vZGVsYXkuaCIgMgojIDE3ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9kZWxh
eS5oIgpleHRlcm4gdm9pZCBfX2RlbGF5KHVuc2lnbmVkIGxvbmcgbG9vcHMpOwpleHRlcm4g
dm9pZCB1ZGVsYXkodW5zaWduZWQgbG9uZyB1c2Vjcyk7CiMgMzQgIi4vYXJjaC9wb3dlcnBj
L2luY2x1ZGUvYXNtL2lvLmgiIDIKIyA2MSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20v
aW8uaCIKZXh0ZXJuIHVuc2lnbmVkIGxvbmcgaXNhX2lvX2Jhc2U7CmV4dGVybiB1bnNpZ25l
ZCBsb25nIHBjaV9pb19iYXNlOwpleHRlcm4gdW5zaWduZWQgbG9uZyBwY2lfZHJhbV9vZmZz
ZXQ7CgpleHRlcm4gcmVzb3VyY2Vfc2l6ZV90IGlzYV9tZW1fYmFzZTsKCgoKCgoKCmV4dGVy
biBib29sIGlzYV9pb19zcGVjaWFsOwojIDEzNyAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9h
c20vaW8uaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHU4IGluXzgoY29uc3Qgdm9sYXRpbGUgdTggKmFkZHIpIHsg
dTggcmV0OyBfX2FzbV9fIF9fdm9sYXRpbGVfXygic3luYzsiImxieiIiJVUxJVgxICUwLCUx
O3R3aSAwLCUwLDA7aXN5bmMiIDogIj1yIiAocmV0KSA6ICJtIiAoKmFkZHIpIDogIm1lbW9y
eSIpOyByZXR1cm4gcmV0OyB9OwpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBvdXRfOCh2b2xhdGlsZSB1OCAq
YWRkciwgdTggdmFsKSB7IF9fYXNtX18gX192b2xhdGlsZV9fKCJzeW5jOyIic3RiIiIlVTAl
WDAgJTEsJTAiIDogIj1tIiAoKmFkZHIpIDogInIiICh2YWwpIDogIm1lbW9yeSIpOyBtbWlv
d2Jfc2V0X3BlbmRpbmcoKTsgfTsKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdTE2IGluX2JlMTYoY29uc3Qgdm9s
YXRpbGUgdTE2ICphZGRyKSB7IHUxNiByZXQ7IF9fYXNtX18gX192b2xhdGlsZV9fKCJzeW5j
OyIibGh6IiIlVTElWDEgJTAsJTE7dHdpIDAsJTAsMDtpc3luYyIgOiAiPXIiIChyZXQpIDog
Im0iICgqYWRkcikgOiAibWVtb3J5Iik7IHJldHVybiByZXQ7IH07CnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1MzIg
aW5fYmUzMihjb25zdCB2b2xhdGlsZSB1MzIgKmFkZHIpIHsgdTMyIHJldDsgX19hc21fXyBf
X3ZvbGF0aWxlX18oInN5bmM7IiJsd3oiIiVVMSVYMSAlMCwlMTt0d2kgMCwlMCwwO2lzeW5j
IiA6ICI9ciIgKHJldCkgOiAibSIgKCphZGRyKSA6ICJtZW1vcnkiKTsgcmV0dXJuIHJldDsg
fTsKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIHUxNiBpbl9sZTE2KGNvbnN0IHZvbGF0aWxlIHUxNiAqYWRkcikgeyB1
MTYgcmV0OyBfX2FzbV9fIF9fdm9sYXRpbGVfXygic3luYzsiImxoYnJ4IiIgJTAsJXkxO3R3
aSAwLCUwLDA7aXN5bmMiIDogIj1yIiAocmV0KSA6ICJaIiAoKmFkZHIpIDogIm1lbW9yeSIp
OyByZXR1cm4gcmV0OyB9OwpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdTMyIGluX2xlMzIoY29uc3Qgdm9sYXRpbGUg
dTMyICphZGRyKSB7IHUzMiByZXQ7IF9fYXNtX18gX192b2xhdGlsZV9fKCJzeW5jOyIibHdi
cngiIiAlMCwleTE7dHdpIDAsJTAsMDtpc3luYyIgOiAiPXIiIChyZXQpIDogIloiICgqYWRk
cikgOiAibWVtb3J5Iik7IHJldHVybiByZXQ7IH07CgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBvdXRfYmUx
Nih2b2xhdGlsZSB1MTYgKmFkZHIsIHUxNiB2YWwpIHsgX19hc21fXyBfX3ZvbGF0aWxlX18o
InN5bmM7IiJzdGgiIiVVMCVYMCAlMSwlMCIgOiAiPW0iICgqYWRkcikgOiAiciIgKHZhbCkg
OiAibWVtb3J5Iik7IG1taW93Yl9zZXRfcGVuZGluZygpOyB9OwpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBv
dXRfYmUzMih2b2xhdGlsZSB1MzIgKmFkZHIsIHUzMiB2YWwpIHsgX19hc21fXyBfX3ZvbGF0
aWxlX18oInN5bmM7IiJzdHciIiVVMCVYMCAlMSwlMCIgOiAiPW0iICgqYWRkcikgOiAiciIg
KHZhbCkgOiAibWVtb3J5Iik7IG1taW93Yl9zZXRfcGVuZGluZygpOyB9OwpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
dm9pZCBvdXRfbGUxNih2b2xhdGlsZSB1MTYgKmFkZHIsIHUxNiB2YWwpIHsgX19hc21fXyBf
X3ZvbGF0aWxlX18oInN5bmM7IiJzdGhicngiIiAlMSwleTAiIDogIj1aIiAoKmFkZHIpIDog
InIiICh2YWwpIDogIm1lbW9yeSIpOyBtbWlvd2Jfc2V0X3BlbmRpbmcoKTsgfTsKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIHZvaWQgb3V0X2xlMzIodm9sYXRpbGUgdTMyICphZGRyLCB1MzIgdmFsKSB7IF9fYXNt
X18gX192b2xhdGlsZV9fKCJzeW5jOyIic3R3YnJ4IiIgJTEsJXkwIiA6ICI9WiIgKCphZGRy
KSA6ICJyIiAodmFsKSA6ICJtZW1vcnkiKTsgbW1pb3diX3NldF9wZW5kaW5nKCk7IH07CiMg
MTY2ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9pby5oIgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBv
dXRfYmU2NCh2b2xhdGlsZSB1NjQgKmFkZHIsIHU2NCB2YWwpIHsgX19hc21fXyBfX3ZvbGF0
aWxlX18oInN5bmM7IiJzdGQiIiVVMCVYMCAlMSwlMCIgOiAiPW0iICgqYWRkcikgOiAiciIg
KHZhbCkgOiAibWVtb3J5Iik7IG1taW93Yl9zZXRfcGVuZGluZygpOyB9OwpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
dTY0IGluX2JlNjQoY29uc3Qgdm9sYXRpbGUgdTY0ICphZGRyKSB7IHU2NCByZXQ7IF9fYXNt
X18gX192b2xhdGlsZV9fKCJzeW5jOyIibGQiIiVVMSVYMSAlMCwlMTt0d2kgMCwlMCwwO2lz
eW5jIiA6ICI9ciIgKHJldCkgOiAibSIgKCphZGRyKSA6ICJtZW1vcnkiKTsgcmV0dXJuIHJl
dDsgfTsKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgdTY0IGluX2xlNjQoY29uc3Qgdm9sYXRpbGUgdTY0ICphZGRy
KQp7CiByZXR1cm4gKF9fdTY0KV9fYnVpbHRpbl9ic3dhcDY0KChfX3U2NCkoaW5fYmU2NChh
ZGRyKSkpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBvdXRfbGU2NCh2b2xhdGlsZSB1NjQgKmFkZHIs
IHU2NCB2YWwpCnsKIG91dF9iZTY0KGFkZHIsIChfX3U2NClfX2J1aWx0aW5fYnN3YXA2NCgo
X191NjQpKHZhbCkpKTsKfQojIDIwMCAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vaW8u
aCIKZXh0ZXJuIHZvaWQgX2luc2IoY29uc3Qgdm9sYXRpbGUgdTggKmFkZHIsIHZvaWQgKmJ1
ZiwgbG9uZyBjb3VudCk7CmV4dGVybiB2b2lkIF9vdXRzYih2b2xhdGlsZSB1OCAqYWRkcixj
b25zdCB2b2lkICpidWYsbG9uZyBjb3VudCk7CmV4dGVybiB2b2lkIF9pbnN3X25zKGNvbnN0
IHZvbGF0aWxlIHUxNiAqYWRkciwgdm9pZCAqYnVmLCBsb25nIGNvdW50KTsKZXh0ZXJuIHZv
aWQgX291dHN3X25zKHZvbGF0aWxlIHUxNiAqYWRkciwgY29uc3Qgdm9pZCAqYnVmLCBsb25n
IGNvdW50KTsKZXh0ZXJuIHZvaWQgX2luc2xfbnMoY29uc3Qgdm9sYXRpbGUgdTMyICphZGRy
LCB2b2lkICpidWYsIGxvbmcgY291bnQpOwpleHRlcm4gdm9pZCBfb3V0c2xfbnModm9sYXRp
bGUgdTMyICphZGRyLCBjb25zdCB2b2lkICpidWYsIGxvbmcgY291bnQpOwojIDIyMCAiLi9h
cmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vaW8uaCIKZXh0ZXJuIHZvaWQgX21lbXNldF9pbyh2
b2xhdGlsZSB2b2lkICphZGRyLCBpbnQgYywgdW5zaWduZWQgbG9uZyBuKTsKZXh0ZXJuIHZv
aWQgX21lbWNweV9mcm9taW8odm9pZCAqZGVzdCwgY29uc3Qgdm9sYXRpbGUgdm9pZCAqc3Jj
LAogICAgICB1bnNpZ25lZCBsb25nIG4pOwpleHRlcm4gdm9pZCBfbWVtY3B5X3RvaW8odm9s
YXRpbGUgdm9pZCAqZGVzdCwgY29uc3Qgdm9pZCAqc3JjLAogICAgdW5zaWduZWQgbG9uZyBu
KTsKIyAzMDEgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2lvLmgiCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1
bnNpZ25lZCBjaGFyIF9fcmF3X3JlYWRiKGNvbnN0IHZvbGF0aWxlIHZvaWQgKmFkZHIpCnsK
IHJldHVybiAqKHZvbGF0aWxlIHVuc2lnbmVkIGNoYXIgKikoYWRkcik7Cn0Kc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IHVuc2lnbmVkIHNob3J0IF9fcmF3X3JlYWR3KGNvbnN0IHZvbGF0aWxlIHZvaWQgKmFkZHIp
CnsKIHJldHVybiAqKHZvbGF0aWxlIHVuc2lnbmVkIHNob3J0ICopKGFkZHIpOwp9CnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSB1bnNpZ25lZCBpbnQgX19yYXdfcmVhZGwoY29uc3Qgdm9sYXRpbGUgdm9pZCAqYWRk
cikKewogcmV0dXJuICoodm9sYXRpbGUgdW5zaWduZWQgaW50ICopKGFkZHIpOwp9CnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSB2b2lkIF9fcmF3X3dyaXRlYih1bnNpZ25lZCBjaGFyIHYsIHZvbGF0aWxlIHZvaWQg
KmFkZHIpCnsKICoodm9sYXRpbGUgdW5zaWduZWQgY2hhciAqKShhZGRyKSA9IHY7Cn0Kc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIHZvaWQgX19yYXdfd3JpdGV3KHVuc2lnbmVkIHNob3J0IHYsIHZvbGF0aWxlIHZv
aWQgKmFkZHIpCnsKICoodm9sYXRpbGUgdW5zaWduZWQgc2hvcnQgKikoYWRkcikgPSB2Owp9
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSB2b2lkIF9fcmF3X3dyaXRlbCh1bnNpZ25lZCBpbnQgdiwgdm9sYXRpbGUg
dm9pZCAqYWRkcikKewogKih2b2xhdGlsZSB1bnNpZ25lZCBpbnQgKikoYWRkcikgPSB2Owp9
CgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIHVuc2lnbmVkIGxvbmcgX19yYXdfcmVhZHEoY29uc3Qgdm9sYXRpbGUg
dm9pZCAqYWRkcikKewogcmV0dXJuICoodm9sYXRpbGUgdW5zaWduZWQgbG9uZyAqKShhZGRy
KTsKfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgdm9pZCBfX3Jhd193cml0ZXEodW5zaWduZWQgbG9uZyB2LCB2b2xh
dGlsZSB2b2lkICphZGRyKQp7CiAqKHZvbGF0aWxlIHVuc2lnbmVkIGxvbmcgKikoYWRkcikg
PSB2Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBfX3Jhd193cml0ZXFfYmUodW5zaWduZWQgbG9uZyB2
LCB2b2xhdGlsZSB2b2lkICphZGRyKQp7CiBfX3Jhd193cml0ZXEoKCB1bnNpZ25lZCBsb25n
KSgoIF9fYmU2NCkoX191NjQpKHYpKSwgYWRkcik7Cn0KCgoKCgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBf
X3Jhd19ybV93cml0ZWIodTggdmFsLCB2b2xhdGlsZSB2b2lkICpwYWRkcikKewogX19hc21f
XyBfX3ZvbGF0aWxlX18oInN0YmNpeCAlMCwwLCUxIgogIDogOiAiciIgKHZhbCksICJyIiAo
cGFkZHIpIDogIm1lbW9yeSIpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBfX3Jhd19ybV93cml0ZXco
dTE2IHZhbCwgdm9sYXRpbGUgdm9pZCAqcGFkZHIpCnsKIF9fYXNtX18gX192b2xhdGlsZV9f
KCJzdGhjaXggJTAsMCwlMSIKICA6IDogInIiICh2YWwpLCAiciIgKHBhZGRyKSA6ICJtZW1v
cnkiKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgX19yYXdfcm1fd3JpdGVsKHUzMiB2YWwsIHZvbGF0
aWxlIHZvaWQgKnBhZGRyKQp7CiBfX2FzbV9fIF9fdm9sYXRpbGVfXygic3R3Y2l4ICUwLDAs
JTEiCiAgOiA6ICJyIiAodmFsKSwgInIiIChwYWRkcikgOiAibWVtb3J5Iik7Cn0KCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSB2b2lkIF9fcmF3X3JtX3dyaXRlcSh1NjQgdmFsLCB2b2xhdGlsZSB2b2lkICpwYWRk
cikKewogX19hc21fXyBfX3ZvbGF0aWxlX18oInN0ZGNpeCAlMCwwLCUxIgogIDogOiAiciIg
KHZhbCksICJyIiAocGFkZHIpIDogIm1lbW9yeSIpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBfX3Jh
d19ybV93cml0ZXFfYmUodTY0IHZhbCwgdm9sYXRpbGUgdm9pZCAqcGFkZHIpCnsKIF9fcmF3
X3JtX3dyaXRlcSgoIHU2NCkoKCBfX2JlNjQpKF9fdTY0KSh2YWwpKSwgcGFkZHIpOwp9Cgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgdTggX19yYXdfcm1fcmVhZGIodm9sYXRpbGUgdm9pZCAqcGFkZHIpCnsKIHU4
IHJldDsKIF9fYXNtX18gX192b2xhdGlsZV9fKCJsYnpjaXggJTAsMCwgJTEiCiAgICAgICAg
OiAiPXIiIChyZXQpIDogInIiIChwYWRkcikgOiAibWVtb3J5Iik7CiByZXR1cm4gcmV0Owp9
CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgdTE2IF9fcmF3X3JtX3JlYWR3KHZvbGF0aWxlIHZvaWQgKnBhZGRyKQp7
CiB1MTYgcmV0OwogX19hc21fXyBfX3ZvbGF0aWxlX18oImxoemNpeCAlMCwwLCAlMSIKICAg
ICAgICA6ICI9ciIgKHJldCkgOiAiciIgKHBhZGRyKSA6ICJtZW1vcnkiKTsKIHJldHVybiBy
ZXQ7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSB1MzIgX19yYXdfcm1fcmVhZGwodm9sYXRpbGUgdm9pZCAqcGFk
ZHIpCnsKIHUzMiByZXQ7CiBfX2FzbV9fIF9fdm9sYXRpbGVfXygibHd6Y2l4ICUwLDAsICUx
IgogICAgICAgIDogIj1yIiAocmV0KSA6ICJyIiAocGFkZHIpIDogIm1lbW9yeSIpOwogcmV0
dXJuIHJldDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIHU2NCBfX3Jhd19ybV9yZWFkcSh2b2xhdGlsZSB2b2lk
ICpwYWRkcikKewogdTY0IHJldDsKIF9fYXNtX18gX192b2xhdGlsZV9fKCJsZGNpeCAlMCww
LCAlMSIKICAgICAgICA6ICI9ciIgKHJldCkgOiAiciIgKHBhZGRyKSA6ICJtZW1vcnkiKTsK
IHJldHVybiByZXQ7Cn0KIyA1NzQgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2lvLmgi
CmV4dGVybiBzdHJ1Y3QgcHBjX3BjaV9pbyB7CgoKCgojIDEgIi4vYXJjaC9wb3dlcnBjL2lu
Y2x1ZGUvYXNtL2lvLWRlZnMuaCIgMQoKCgoKdTggKCpyZWFkYikgKGNvbnN0IHZvbGF0aWxl
IHZvaWQgKiBhZGRyKTsKdTE2ICgqcmVhZHcpIChjb25zdCB2b2xhdGlsZSB2b2lkICogYWRk
cik7CnUzMiAoKnJlYWRsKSAoY29uc3Qgdm9sYXRpbGUgdm9pZCAqIGFkZHIpOwp1MTYgKCpy
ZWFkd19iZSkgKGNvbnN0IHZvbGF0aWxlIHZvaWQgKiBhZGRyKTsKdTMyICgqcmVhZGxfYmUp
IChjb25zdCB2b2xhdGlsZSB2b2lkICogYWRkcik7CnZvaWQgKCp3cml0ZWIpICh1OCB2YWws
IHZvbGF0aWxlIHZvaWQgKiBhZGRyKTsKdm9pZCAoKndyaXRldykgKHUxNiB2YWwsIHZvbGF0
aWxlIHZvaWQgKiBhZGRyKTsKdm9pZCAoKndyaXRlbCkgKHUzMiB2YWwsIHZvbGF0aWxlIHZv
aWQgKiBhZGRyKTsKdm9pZCAoKndyaXRld19iZSkgKHUxNiB2YWwsIHZvbGF0aWxlIHZvaWQg
KiBhZGRyKTsKdm9pZCAoKndyaXRlbF9iZSkgKHUzMiB2YWwsIHZvbGF0aWxlIHZvaWQgKiBh
ZGRyKTsKCgp1NjQgKCpyZWFkcSkgKGNvbnN0IHZvbGF0aWxlIHZvaWQgKiBhZGRyKTsKdTY0
ICgqcmVhZHFfYmUpIChjb25zdCB2b2xhdGlsZSB2b2lkICogYWRkcik7CnZvaWQgKCp3cml0
ZXEpICh1NjQgdmFsLCB2b2xhdGlsZSB2b2lkICogYWRkcik7CnZvaWQgKCp3cml0ZXFfYmUp
ICh1NjQgdmFsLCB2b2xhdGlsZSB2b2lkICogYWRkcik7CgoKdTggKCppbmIpICh1bnNpZ25l
ZCBsb25nIHBvcnQpOwp1MTYgKCppbncpICh1bnNpZ25lZCBsb25nIHBvcnQpOwp1MzIgKCpp
bmwpICh1bnNpZ25lZCBsb25nIHBvcnQpOwp2b2lkICgqb3V0YikgKHU4IHZhbCwgdW5zaWdu
ZWQgbG9uZyBwb3J0KTsKdm9pZCAoKm91dHcpICh1MTYgdmFsLCB1bnNpZ25lZCBsb25nIHBv
cnQpOwp2b2lkICgqb3V0bCkgKHUzMiB2YWwsIHVuc2lnbmVkIGxvbmcgcG9ydCk7Cgp2b2lk
ICgqcmVhZHNiKSAoY29uc3Qgdm9sYXRpbGUgdm9pZCAqIGEsIHZvaWQgKmIsIHVuc2lnbmVk
IGxvbmcgYyk7Cgp2b2lkICgqcmVhZHN3KSAoY29uc3Qgdm9sYXRpbGUgdm9pZCAqIGEsIHZv
aWQgKmIsIHVuc2lnbmVkIGxvbmcgYyk7Cgp2b2lkICgqcmVhZHNsKSAoY29uc3Qgdm9sYXRp
bGUgdm9pZCAqIGEsIHZvaWQgKmIsIHVuc2lnbmVkIGxvbmcgYyk7Cgp2b2lkICgqd3JpdGVz
YikgKHZvbGF0aWxlIHZvaWQgKiBhLCBjb25zdCB2b2lkICpiLCB1bnNpZ25lZCBsb25nIGMp
OwoKdm9pZCAoKndyaXRlc3cpICh2b2xhdGlsZSB2b2lkICogYSwgY29uc3Qgdm9pZCAqYiwg
dW5zaWduZWQgbG9uZyBjKTsKCnZvaWQgKCp3cml0ZXNsKSAodm9sYXRpbGUgdm9pZCAqIGEs
IGNvbnN0IHZvaWQgKmIsIHVuc2lnbmVkIGxvbmcgYyk7CgoKdm9pZCAoKmluc2IpICh1bnNp
Z25lZCBsb25nIHAsIHZvaWQgKmIsIHVuc2lnbmVkIGxvbmcgYyk7Cgp2b2lkICgqaW5zdykg
KHVuc2lnbmVkIGxvbmcgcCwgdm9pZCAqYiwgdW5zaWduZWQgbG9uZyBjKTsKCnZvaWQgKCpp
bnNsKSAodW5zaWduZWQgbG9uZyBwLCB2b2lkICpiLCB1bnNpZ25lZCBsb25nIGMpOwoKdm9p
ZCAoKm91dHNiKSAodW5zaWduZWQgbG9uZyBwLCBjb25zdCB2b2lkICpiLCB1bnNpZ25lZCBs
b25nIGMpOwoKdm9pZCAoKm91dHN3KSAodW5zaWduZWQgbG9uZyBwLCBjb25zdCB2b2lkICpi
LCB1bnNpZ25lZCBsb25nIGMpOwoKdm9pZCAoKm91dHNsKSAodW5zaWduZWQgbG9uZyBwLCBj
b25zdCB2b2lkICpiLCB1bnNpZ25lZCBsb25nIGMpOwoKCnZvaWQgKCptZW1zZXRfaW8pICh2
b2xhdGlsZSB2b2lkICogYSwgaW50IGMsIHVuc2lnbmVkIGxvbmcgbik7Cgp2b2lkICgqbWVt
Y3B5X2Zyb21pbykgKHZvaWQgKmQsIGNvbnN0IHZvbGF0aWxlIHZvaWQgKiBzLCB1bnNpZ25l
ZCBsb25nIG4pOwoKdm9pZCAoKm1lbWNweV90b2lvKSAodm9sYXRpbGUgdm9pZCAqIGQsIGNv
bnN0IHZvaWQgKnMsIHVuc2lnbmVkIGxvbmcgbik7CiMgNTgwICIuL2FyY2gvcG93ZXJwYy9p
bmNsdWRlL2FzbS9pby5oIiAyCgoKCgp9IHBwY19wY2lfaW87CiMgNjA0ICIuL2FyY2gvcG93
ZXJwYy9pbmNsdWRlL2FzbS9pby5oIgojIDEgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNt
L2lvLWRlZnMuaCIgMQoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHU4IHJlYWRiIChjb25zdCB2b2xhdGlsZSB2
b2lkICogYWRkcikgeyBpZiAoKCh2b2lkICopMCkgIT0gKCh2b2lkICopMCkpIHJldHVybiBw
cGNfcGNpX2lvLnJlYWRiIChhZGRyKTsgcmV0dXJuIGluXzgoKGFkZHIpKTsgfQpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgdTE2IHJlYWR3IChjb25zdCB2b2xhdGlsZSB2b2lkICogYWRkcikgeyBpZiAoKCh2b2lk
ICopMCkgIT0gKCh2b2lkICopMCkpIHJldHVybiBwcGNfcGNpX2lvLnJlYWR3IChhZGRyKTsg
cmV0dXJuIGluX2xlMTYoKGFkZHIpKTsgfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdTMyIHJlYWRsIChjb25zdCB2
b2xhdGlsZSB2b2lkICogYWRkcikgeyBpZiAoKCh2b2lkICopMCkgIT0gKCh2b2lkICopMCkp
IHJldHVybiBwcGNfcGNpX2lvLnJlYWRsIChhZGRyKTsgcmV0dXJuIGluX2xlMzIoKGFkZHIp
KTsgfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgdTE2IHJlYWR3X2JlIChjb25zdCB2b2xhdGlsZSB2b2lkICogYWRk
cikgeyBpZiAoKCh2b2lkICopMCkgIT0gKCh2b2lkICopMCkpIHJldHVybiBwcGNfcGNpX2lv
LnJlYWR3X2JlIChhZGRyKTsgcmV0dXJuIGluX2JlMTYoKGFkZHIpKTsgfQpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
dTMyIHJlYWRsX2JlIChjb25zdCB2b2xhdGlsZSB2b2lkICogYWRkcikgeyBpZiAoKCh2b2lk
ICopMCkgIT0gKCh2b2lkICopMCkpIHJldHVybiBwcGNfcGNpX2lvLnJlYWRsX2JlIChhZGRy
KTsgcmV0dXJuIGluX2JlMzIoKGFkZHIpKTsgfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCB3cml0ZWIgKHU4
IHZhbCwgdm9sYXRpbGUgdm9pZCAqIGFkZHIpIHsgaWYgKCgodm9pZCAqKTApICE9ICgodm9p
ZCAqKTApKSBwcGNfcGNpX2lvLndyaXRlYiAodmFsLCBhZGRyKTsgZWxzZSBvdXRfOCgoYWRk
ciksIHZhbCk7IH0Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgd3JpdGV3ICh1MTYgdmFsLCB2b2xhdGlsZSB2
b2lkICogYWRkcikgeyBpZiAoKCh2b2lkICopMCkgIT0gKCh2b2lkICopMCkpIHBwY19wY2lf
aW8ud3JpdGV3ICh2YWwsIGFkZHIpOyBlbHNlIG91dF9sZTE2KChhZGRyKSwgdmFsKTsgfQpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgdm9pZCB3cml0ZWwgKHUzMiB2YWwsIHZvbGF0aWxlIHZvaWQgKiBhZGRyKSB7
IGlmICgoKHZvaWQgKikwKSAhPSAoKHZvaWQgKikwKSkgcHBjX3BjaV9pby53cml0ZWwgKHZh
bCwgYWRkcik7IGVsc2Ugb3V0X2xlMzIoKGFkZHIpLCB2YWwpOyB9CnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lk
IHdyaXRld19iZSAodTE2IHZhbCwgdm9sYXRpbGUgdm9pZCAqIGFkZHIpIHsgaWYgKCgodm9p
ZCAqKTApICE9ICgodm9pZCAqKTApKSBwcGNfcGNpX2lvLndyaXRld19iZSAodmFsLCBhZGRy
KTsgZWxzZSBvdXRfYmUxNigoYWRkciksIHZhbCk7IH0Kc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgd3JpdGVs
X2JlICh1MzIgdmFsLCB2b2xhdGlsZSB2b2lkICogYWRkcikgeyBpZiAoKCh2b2lkICopMCkg
IT0gKCh2b2lkICopMCkpIHBwY19wY2lfaW8ud3JpdGVsX2JlICh2YWwsIGFkZHIpOyBlbHNl
IG91dF9iZTMyKChhZGRyKSwgdmFsKTsgfQoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1NjQgcmVhZHEgKGNvbnN0
IHZvbGF0aWxlIHZvaWQgKiBhZGRyKSB7IGlmICgoKHZvaWQgKikwKSAhPSAoKHZvaWQgKikw
KSkgcmV0dXJuIHBwY19wY2lfaW8ucmVhZHEgKGFkZHIpOyByZXR1cm4gaW5fbGU2NCgoYWRk
cikpOyB9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSB1NjQgcmVhZHFfYmUgKGNvbnN0IHZvbGF0aWxlIHZvaWQgKiBh
ZGRyKSB7IGlmICgoKHZvaWQgKikwKSAhPSAoKHZvaWQgKikwKSkgcmV0dXJuIHBwY19wY2lf
aW8ucmVhZHFfYmUgKGFkZHIpOyByZXR1cm4gaW5fYmU2NCgoYWRkcikpOyB9CnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSB2b2lkIHdyaXRlcSAodTY0IHZhbCwgdm9sYXRpbGUgdm9pZCAqIGFkZHIpIHsgaWYgKCgo
dm9pZCAqKTApICE9ICgodm9pZCAqKTApKSBwcGNfcGNpX2lvLndyaXRlcSAodmFsLCBhZGRy
KTsgZWxzZSBvdXRfbGU2NCgoYWRkciksIHZhbCk7IH0Kc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgd3JpdGVx
X2JlICh1NjQgdmFsLCB2b2xhdGlsZSB2b2lkICogYWRkcikgeyBpZiAoKCh2b2lkICopMCkg
IT0gKCh2b2lkICopMCkpIHBwY19wY2lfaW8ud3JpdGVxX2JlICh2YWwsIGFkZHIpOyBlbHNl
IG91dF9iZTY0KChhZGRyKSwgdmFsKTsgfQoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1OCBpbmIgKHVuc2lnbmVk
IGxvbmcgcG9ydCkgeyBpZiAoKCh2b2lkICopMCkgIT0gKCh2b2lkICopMCkpIHJldHVybiBw
cGNfcGNpX2lvLmluYiAocG9ydCk7IHJldHVybiByZWFkYigodm9sYXRpbGUgdm9pZCAqKXBj
aV9pb19iYXNlICsgcG9ydCk7OyB9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1MTYgaW53ICh1bnNpZ25lZCBsb25n
IHBvcnQpIHsgaWYgKCgodm9pZCAqKTApICE9ICgodm9pZCAqKTApKSByZXR1cm4gcHBjX3Bj
aV9pby5pbncgKHBvcnQpOyByZXR1cm4gcmVhZHcoKHZvbGF0aWxlIHZvaWQgKilwY2lfaW9f
YmFzZSArIHBvcnQpOzsgfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdTMyIGlubCAodW5zaWduZWQgbG9uZyBwb3J0
KSB7IGlmICgoKHZvaWQgKikwKSAhPSAoKHZvaWQgKikwKSkgcmV0dXJuIHBwY19wY2lfaW8u
aW5sIChwb3J0KTsgcmV0dXJuIHJlYWRsKCh2b2xhdGlsZSB2b2lkICopcGNpX2lvX2Jhc2Ug
KyBwb3J0KTs7IH0Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgb3V0YiAodTggdmFsLCB1bnNpZ25lZCBsb25n
IHBvcnQpIHsgaWYgKCgodm9pZCAqKTApICE9ICgodm9pZCAqKTApKSBwcGNfcGNpX2lvLm91
dGIgKHZhbCwgcG9ydCk7IGVsc2Ugd3JpdGViKHZhbCwodm9sYXRpbGUgdm9pZCAqKXBjaV9p
b19iYXNlK3BvcnQpOzsgfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBvdXR3ICh1MTYgdmFsLCB1bnNpZ25l
ZCBsb25nIHBvcnQpIHsgaWYgKCgodm9pZCAqKTApICE9ICgodm9pZCAqKTApKSBwcGNfcGNp
X2lvLm91dHcgKHZhbCwgcG9ydCk7IGVsc2Ugd3JpdGV3KHZhbCwodm9sYXRpbGUgdm9pZCAq
KXBjaV9pb19iYXNlK3BvcnQpOzsgfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBvdXRsICh1MzIgdmFsLCB1
bnNpZ25lZCBsb25nIHBvcnQpIHsgaWYgKCgodm9pZCAqKTApICE9ICgodm9pZCAqKTApKSBw
cGNfcGNpX2lvLm91dGwgKHZhbCwgcG9ydCk7IGVsc2Ugd3JpdGVsKHZhbCwodm9sYXRpbGUg
dm9pZCAqKXBjaV9pb19iYXNlK3BvcnQpOzsgfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgcmVhZHNiIChj
b25zdCB2b2xhdGlsZSB2b2lkICogYSwgdm9pZCAqYiwgdW5zaWduZWQgbG9uZyBjKSB7IGlm
ICgoKHZvaWQgKikwKSAhPSAoKHZvaWQgKikwKSkgcHBjX3BjaV9pby5yZWFkc2IgKGEsIGIs
IGMpOyBlbHNlIF9pbnNiKChhKSwgKGIpLCAoYykpOyB9CgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCByZWFk
c3cgKGNvbnN0IHZvbGF0aWxlIHZvaWQgKiBhLCB2b2lkICpiLCB1bnNpZ25lZCBsb25nIGMp
IHsgaWYgKCgodm9pZCAqKTApICE9ICgodm9pZCAqKTApKSBwcGNfcGNpX2lvLnJlYWRzdyAo
YSwgYiwgYyk7IGVsc2UgX2luc3dfbnMoKGEpLCAoYiksIChjKSk7IH0KCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2
b2lkIHJlYWRzbCAoY29uc3Qgdm9sYXRpbGUgdm9pZCAqIGEsIHZvaWQgKmIsIHVuc2lnbmVk
IGxvbmcgYykgeyBpZiAoKCh2b2lkICopMCkgIT0gKCh2b2lkICopMCkpIHBwY19wY2lfaW8u
cmVhZHNsIChhLCBiLCBjKTsgZWxzZSBfaW5zbF9ucygoYSksIChiKSwgKGMpKTsgfQoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIHZvaWQgd3JpdGVzYiAodm9sYXRpbGUgdm9pZCAqIGEsIGNvbnN0IHZvaWQgKmIs
IHVuc2lnbmVkIGxvbmcgYykgeyBpZiAoKCh2b2lkICopMCkgIT0gKCh2b2lkICopMCkpIHBw
Y19wY2lfaW8ud3JpdGVzYiAoYSwgYiwgYyk7IGVsc2UgX291dHNiKChhKSwoYiksKGMpKTsg
fQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIHZvaWQgd3JpdGVzdyAodm9sYXRpbGUgdm9pZCAqIGEsIGNvbnN0IHZv
aWQgKmIsIHVuc2lnbmVkIGxvbmcgYykgeyBpZiAoKCh2b2lkICopMCkgIT0gKCh2b2lkICop
MCkpIHBwY19wY2lfaW8ud3JpdGVzdyAoYSwgYiwgYyk7IGVsc2UgX291dHN3X25zKChhKSwo
YiksKGMpKTsgfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgd3JpdGVzbCAodm9sYXRpbGUgdm9pZCAqIGEs
IGNvbnN0IHZvaWQgKmIsIHVuc2lnbmVkIGxvbmcgYykgeyBpZiAoKCh2b2lkICopMCkgIT0g
KCh2b2lkICopMCkpIHBwY19wY2lfaW8ud3JpdGVzbCAoYSwgYiwgYyk7IGVsc2UgX291dHNs
X25zKChhKSwoYiksKGMpKTsgfQoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGluc2IgKHVuc2lnbmVkIGxv
bmcgcCwgdm9pZCAqYiwgdW5zaWduZWQgbG9uZyBjKSB7IGlmICgoKHZvaWQgKikwKSAhPSAo
KHZvaWQgKikwKSkgcHBjX3BjaV9pby5pbnNiIChwLCBiLCBjKTsgZWxzZSByZWFkc2IoKHZv
bGF0aWxlIHZvaWQgKilwY2lfaW9fYmFzZSsocCksIChiKSwgKGMpKTsgfQoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IHZvaWQgaW5zdyAodW5zaWduZWQgbG9uZyBwLCB2b2lkICpiLCB1bnNpZ25lZCBsb25nIGMp
IHsgaWYgKCgodm9pZCAqKTApICE9ICgodm9pZCAqKTApKSBwcGNfcGNpX2lvLmluc3cgKHAs
IGIsIGMpOyBlbHNlIHJlYWRzdygodm9sYXRpbGUgdm9pZCAqKXBjaV9pb19iYXNlKyhwKSwg
KGIpLCAoYykpOyB9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBpbnNsICh1bnNpZ25lZCBsb25nIHAsIHZv
aWQgKmIsIHVuc2lnbmVkIGxvbmcgYykgeyBpZiAoKCh2b2lkICopMCkgIT0gKCh2b2lkICop
MCkpIHBwY19wY2lfaW8uaW5zbCAocCwgYiwgYyk7IGVsc2UgcmVhZHNsKCh2b2xhdGlsZSB2
b2lkICopcGNpX2lvX2Jhc2UrKHApLCAoYiksIChjKSk7IH0KCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIG91
dHNiICh1bnNpZ25lZCBsb25nIHAsIGNvbnN0IHZvaWQgKmIsIHVuc2lnbmVkIGxvbmcgYykg
eyBpZiAoKCh2b2lkICopMCkgIT0gKCh2b2lkICopMCkpIHBwY19wY2lfaW8ub3V0c2IgKHAs
IGIsIGMpOyBlbHNlIHdyaXRlc2IoKHZvbGF0aWxlIHZvaWQgKilwY2lfaW9fYmFzZSsocCks
KGIpLChjKSk7IH0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIG91dHN3ICh1bnNpZ25lZCBsb25nIHAsIGNv
bnN0IHZvaWQgKmIsIHVuc2lnbmVkIGxvbmcgYykgeyBpZiAoKCh2b2lkICopMCkgIT0gKCh2
b2lkICopMCkpIHBwY19wY2lfaW8ub3V0c3cgKHAsIGIsIGMpOyBlbHNlIHdyaXRlc3coKHZv
bGF0aWxlIHZvaWQgKilwY2lfaW9fYmFzZSsocCksKGIpLChjKSk7IH0KCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2
b2lkIG91dHNsICh1bnNpZ25lZCBsb25nIHAsIGNvbnN0IHZvaWQgKmIsIHVuc2lnbmVkIGxv
bmcgYykgeyBpZiAoKCh2b2lkICopMCkgIT0gKCh2b2lkICopMCkpIHBwY19wY2lfaW8ub3V0
c2wgKHAsIGIsIGMpOyBlbHNlIHdyaXRlc2woKHZvbGF0aWxlIHZvaWQgKilwY2lfaW9fYmFz
ZSsocCksKGIpLChjKSk7IH0KCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBtZW1zZXRfaW8gKHZvbGF0aWxl
IHZvaWQgKiBhLCBpbnQgYywgdW5zaWduZWQgbG9uZyBuKSB7IGlmICgoKHZvaWQgKikwKSAh
PSAoKHZvaWQgKikwKSkgcHBjX3BjaV9pby5tZW1zZXRfaW8gKGEsIGMsIG4pOyBlbHNlIF9t
ZW1zZXRfaW8oKGEpLCBjLCBuKTsgfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgbWVtY3B5X2Zyb21pbyAo
dm9pZCAqZCwgY29uc3Qgdm9sYXRpbGUgdm9pZCAqIHMsIHVuc2lnbmVkIGxvbmcgbikgeyBp
ZiAoKCh2b2lkICopMCkgIT0gKCh2b2lkICopMCkpIHBwY19wY2lfaW8ubWVtY3B5X2Zyb21p
byAoZCwgcywgbik7IGVsc2UgX21lbWNweV9mcm9taW8oZCwocyksbik7IH0KCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSB2b2lkIG1lbWNweV90b2lvICh2b2xhdGlsZSB2b2lkICogZCwgY29uc3Qgdm9pZCAqcywg
dW5zaWduZWQgbG9uZyBuKSB7IGlmICgoKHZvaWQgKikwKSAhPSAoKHZvaWQgKikwKSkgcHBj
X3BjaV9pby5tZW1jcHlfdG9pbyAoZCwgcywgbik7IGVsc2UgX21lbWNweV90b2lvKChkKSwg
cywgbik7IH0KIyA2MDUgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2lvLmgiIDIKIyA2
NDAgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2lvLmgiCiMgMSAiLi9pbmNsdWRlL2Fz
bS1nZW5lcmljL2lvbWFwLmgiIDEKIyAyOSAiLi9pbmNsdWRlL2FzbS1nZW5lcmljL2lvbWFw
LmgiCmV4dGVybiB1bnNpZ25lZCBpbnQgaW9yZWFkOCh2b2lkICopOwpleHRlcm4gdW5zaWdu
ZWQgaW50IGlvcmVhZDE2KHZvaWQgKik7CmV4dGVybiB1bnNpZ25lZCBpbnQgaW9yZWFkMTZi
ZSh2b2lkICopOwpleHRlcm4gdW5zaWduZWQgaW50IGlvcmVhZDMyKHZvaWQgKik7CmV4dGVy
biB1bnNpZ25lZCBpbnQgaW9yZWFkMzJiZSh2b2lkICopOwoKZXh0ZXJuIHU2NCBpb3JlYWQ2
NCh2b2lkICopOwpleHRlcm4gdTY0IGlvcmVhZDY0YmUodm9pZCAqKTsKCgoKCgoKCmV4dGVy
biB1NjQgaW9yZWFkNjRfbG9faGkodm9pZCAqYWRkcik7CmV4dGVybiB1NjQgaW9yZWFkNjRf
aGlfbG8odm9pZCAqYWRkcik7CmV4dGVybiB1NjQgaW9yZWFkNjRiZV9sb19oaSh2b2lkICph
ZGRyKTsKZXh0ZXJuIHU2NCBpb3JlYWQ2NGJlX2hpX2xvKHZvaWQgKmFkZHIpOwoKCmV4dGVy
biB2b2lkIGlvd3JpdGU4KHU4LCB2b2lkICopOwpleHRlcm4gdm9pZCBpb3dyaXRlMTYodTE2
LCB2b2lkICopOwpleHRlcm4gdm9pZCBpb3dyaXRlMTZiZSh1MTYsIHZvaWQgKik7CmV4dGVy
biB2b2lkIGlvd3JpdGUzMih1MzIsIHZvaWQgKik7CmV4dGVybiB2b2lkIGlvd3JpdGUzMmJl
KHUzMiwgdm9pZCAqKTsKCmV4dGVybiB2b2lkIGlvd3JpdGU2NCh1NjQsIHZvaWQgKik7CmV4
dGVybiB2b2lkIGlvd3JpdGU2NGJlKHU2NCwgdm9pZCAqKTsKCgoKCgoKCmV4dGVybiB2b2lk
IGlvd3JpdGU2NF9sb19oaSh1NjQgdmFsLCB2b2lkICphZGRyKTsKZXh0ZXJuIHZvaWQgaW93
cml0ZTY0X2hpX2xvKHU2NCB2YWwsIHZvaWQgKmFkZHIpOwpleHRlcm4gdm9pZCBpb3dyaXRl
NjRiZV9sb19oaSh1NjQgdmFsLCB2b2lkICphZGRyKTsKZXh0ZXJuIHZvaWQgaW93cml0ZTY0
YmVfaGlfbG8odTY0IHZhbCwgdm9pZCAqYWRkcik7CiMgODIgIi4vaW5jbHVkZS9hc20tZ2Vu
ZXJpYy9pb21hcC5oIgpleHRlcm4gdm9pZCBpb3JlYWQ4X3JlcCh2b2lkICpwb3J0LCB2b2lk
ICpidWYsIHVuc2lnbmVkIGxvbmcgY291bnQpOwpleHRlcm4gdm9pZCBpb3JlYWQxNl9yZXAo
dm9pZCAqcG9ydCwgdm9pZCAqYnVmLCB1bnNpZ25lZCBsb25nIGNvdW50KTsKZXh0ZXJuIHZv
aWQgaW9yZWFkMzJfcmVwKHZvaWQgKnBvcnQsIHZvaWQgKmJ1ZiwgdW5zaWduZWQgbG9uZyBj
b3VudCk7CgpleHRlcm4gdm9pZCBpb3dyaXRlOF9yZXAodm9pZCAqcG9ydCwgY29uc3Qgdm9p
ZCAqYnVmLCB1bnNpZ25lZCBsb25nIGNvdW50KTsKZXh0ZXJuIHZvaWQgaW93cml0ZTE2X3Jl
cCh2b2lkICpwb3J0LCBjb25zdCB2b2lkICpidWYsIHVuc2lnbmVkIGxvbmcgY291bnQpOwpl
eHRlcm4gdm9pZCBpb3dyaXRlMzJfcmVwKHZvaWQgKnBvcnQsIGNvbnN0IHZvaWQgKmJ1Ziwg
dW5zaWduZWQgbG9uZyBjb3VudCk7CgoKCmV4dGVybiB2b2lkICppb3BvcnRfbWFwKHVuc2ln
bmVkIGxvbmcgcG9ydCwgdW5zaWduZWQgaW50IG5yKTsKZXh0ZXJuIHZvaWQgaW9wb3J0X3Vu
bWFwKHZvaWQgKik7CiMgMTA2ICIuL2luY2x1ZGUvYXNtLWdlbmVyaWMvaW9tYXAuaCIKc3Ry
dWN0IHBjaV9kZXY7CmV4dGVybiB2b2lkIHBjaV9pb3VubWFwKHN0cnVjdCBwY2lfZGV2ICpk
ZXYsIHZvaWQgKik7CgoKCgoKCiMgMSAiLi9pbmNsdWRlL2FzbS1nZW5lcmljL3BjaV9pb21h
cC5oIiAxCiMgMTAgIi4vaW5jbHVkZS9hc20tZ2VuZXJpYy9wY2lfaW9tYXAuaCIKc3RydWN0
IHBjaV9kZXY7CgoKZXh0ZXJuIHZvaWQgKnBjaV9pb21hcChzdHJ1Y3QgcGNpX2RldiAqZGV2
LCBpbnQgYmFyLCB1bnNpZ25lZCBsb25nIG1heCk7CmV4dGVybiB2b2lkICpwY2lfaW9tYXBf
d2Moc3RydWN0IHBjaV9kZXYgKmRldiwgaW50IGJhciwgdW5zaWduZWQgbG9uZyBtYXgpOwpl
eHRlcm4gdm9pZCAqcGNpX2lvbWFwX3JhbmdlKHN0cnVjdCBwY2lfZGV2ICpkZXYsIGludCBi
YXIsCiAgICAgICAgIHVuc2lnbmVkIGxvbmcgb2Zmc2V0LAogICAgICAgICB1bnNpZ25lZCBs
b25nIG1heGxlbik7CmV4dGVybiB2b2lkICpwY2lfaW9tYXBfd2NfcmFuZ2Uoc3RydWN0IHBj
aV9kZXYgKmRldiwgaW50IGJhciwKICAgICB1bnNpZ25lZCBsb25nIG9mZnNldCwKICAgICB1
bnNpZ25lZCBsb25nIG1heGxlbik7CiMgMTE1ICIuL2luY2x1ZGUvYXNtLWdlbmVyaWMvaW9t
YXAuaCIgMgojIDY0MSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vaW8uaCIgMgoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIHZvaWQgaW9zeW5jKHZvaWQpCnsKICAgICAgICBfX2FzbV9fIF9fdm9sYXRpbGVf
XyAoInN5bmMiIDogOiA6ICJtZW1vcnkiKTsKfQojIDcwNSAiLi9hcmNoL3Bvd2VycGMvaW5j
bHVkZS9hc20vaW8uaCIKZXh0ZXJuIHZvaWQgKmlvcmVtYXAocGh5c19hZGRyX3QgYWRkcmVz
cywgdW5zaWduZWQgbG9uZyBzaXplKTsKZXh0ZXJuIHZvaWQgKmlvcmVtYXBfcHJvdChwaHlz
X2FkZHJfdCBhZGRyZXNzLCB1bnNpZ25lZCBsb25nIHNpemUsCiAgICAgIHVuc2lnbmVkIGxv
bmcgZmxhZ3MpOwpleHRlcm4gdm9pZCAqaW9yZW1hcF93YyhwaHlzX2FkZHJfdCBhZGRyZXNz
LCB1bnNpZ25lZCBsb25nIHNpemUpOwp2b2lkICppb3JlbWFwKHBoeXNfYWRkcl90IGFkZHJl
c3MsIHVuc2lnbmVkIGxvbmcgc2l6ZSk7CnZvaWQgKmlvcmVtYXBfY29oZXJlbnQocGh5c19h
ZGRyX3QgYWRkcmVzcywgdW5zaWduZWQgbG9uZyBzaXplKTsKCgoKCmV4dGVybiB2b2lkIGlv
dW5tYXAodm9sYXRpbGUgdm9pZCAqYWRkcik7Cgp2b2lkICppb3JlbWFwX3BoYihwaHlzX2Fk
ZHJfdCBwYWRkciwgdW5zaWduZWQgbG9uZyBzaXplKTsKCmludCBlYXJseV9pb3JlbWFwX3Jh
bmdlKHVuc2lnbmVkIGxvbmcgZWEsIHBoeXNfYWRkcl90IHBhLAogICB1bnNpZ25lZCBsb25n
IHNpemUsIHBncHJvdF90IHByb3QpOwp2b2lkICpkb19pb3JlbWFwKHBoeXNfYWRkcl90IHBh
LCBwaHlzX2FkZHJfdCBvZmZzZXQsIHVuc2lnbmVkIGxvbmcgc2l6ZSwKICAgIHBncHJvdF90
IHByb3QsIHZvaWQgKmNhbGxlcik7CgpleHRlcm4gdm9pZCAqX19pb3JlbWFwX2NhbGxlcihw
aHlzX2FkZHJfdCwgdW5zaWduZWQgbG9uZyBzaXplLAogICAgICAgICAgcGdwcm90X3QgcHJv
dCwgdm9pZCAqY2FsbGVyKTsKIyA3NjMgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2lv
LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSB1bnNpZ25lZCBsb25nIHZpcnRfdG9fcGh5cyh2b2xhdGlsZSB2b2lk
ICogYWRkcmVzcykKewogKHsgaW50IF9fcmV0X3dhcm5fb24gPSAhISgwICYmICFwZm5fdmFs
aWQoKCh7IGRvIHsgfSB3aGlsZSAoMCk7ICh1bnNpZ25lZCBsb25nKShhZGRyZXNzKSAmIDB4
MGZmZmZmZmZmZmZmZmZmZlVMOyB9KSA+PiAxMikpKTsgaWYgKF9fYnVpbHRpbl9jb25zdGFu
dF9wKF9fcmV0X3dhcm5fb24pKSB7IGlmIChfX3JldF93YXJuX29uKSBfX2FzbV9fIF9fdm9s
YXRpbGVfXyggIjE6CSIgInR3aSAzMSwgMCwgMCIgIlxuIiAiLnNlY3Rpb24gX19idWdfdGFi
bGUsXCJhd1wiXG4iICIyOlx0IiAiLjhieXRlIiAiICIgIjFiLCAlMFxuIiAiXHQuc2hvcnQg
JTEsICUyXG4iICIub3JnIDJiKyUzXG4iICIucHJldmlvdXNcbiIgOiA6ICJpIiAoIi4vYXJj
aC9wb3dlcnBjL2luY2x1ZGUvYXNtL2lvLmgiKSwgImkiICg3NjUpLCAiaSIgKCgxIDw8IDAp
IHwgKCgoOSkgPDwgOCkpKSwgImkiIChzaXplb2Yoc3RydWN0IGJ1Z19lbnRyeSkpKTsgfSBl
bHNlIHsgX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgkiICJ0ZG5laSIgIiAiICIgJTQsIDAi
ICJcbiIgIi5zZWN0aW9uIF9fYnVnX3RhYmxlLFwiYXdcIlxuIiAiMjpcdCIgIi44Ynl0ZSIg
IiAiICIxYiwgJTBcbiIgIlx0LnNob3J0ICUxLCAlMlxuIiAiLm9yZyAyYislM1xuIiAiLnBy
ZXZpb3VzXG4iIDogOiAiaSIgKCIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9pby5oIiks
ICJpIiAoNzY1KSwgImkiICgoMSA8PCAwKSB8ICgoOSkgPDwgOCkpLCAiaSIgKHNpemVvZihz
dHJ1Y3QgYnVnX2VudHJ5KSksICJyIiAoX19yZXRfd2Fybl9vbikpOyB9IF9fYnVpbHRpbl9l
eHBlY3QoISEoX19yZXRfd2Fybl9vbiksIDApOyB9KTsKCiByZXR1cm4gKHsgZG8geyB9IHdo
aWxlICgwKTsgKHVuc2lnbmVkIGxvbmcpKCh1bnNpZ25lZCBsb25nKWFkZHJlc3MpICYgMHgw
ZmZmZmZmZmZmZmZmZmZmVUw7IH0pOwp9CiMgNzgyICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRl
L2FzbS9pby5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCAqIHBoeXNfdG9fdmlydCh1bnNpZ25lZCBsb25n
IGFkZHJlc3MpCnsKIHJldHVybiAodm9pZCAqKSh7IGRvIHsgfSB3aGlsZSAoMCk7ICh2b2lk
ICopKHVuc2lnbmVkIGxvbmcpKChwaHlzX2FkZHJfdCkoYWRkcmVzcykgfCAweGMwMDAwMDAw
MDAwMDAwMDBVTCk7IH0pOwp9CgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgcGh5c19hZGRyX3QgcGFnZV90b19w
aHlzKHN0cnVjdCBwYWdlICpwYWdlKQp7CiB1bnNpZ25lZCBsb25nIHBmbiA9ICgodW5zaWdu
ZWQgbG9uZykoKHBhZ2UpIC0gbWVtX21hcCkgKyAoKHVuc2lnbmVkIGxvbmcpKDBVTCA+PiAx
MikpKTsKCiAoeyBpbnQgX19yZXRfd2Fybl9vbiA9ICEhKDAgJiYgIXBmbl92YWxpZChwZm4p
KTsgaWYgKF9fYnVpbHRpbl9jb25zdGFudF9wKF9fcmV0X3dhcm5fb24pKSB7IGlmIChfX3Jl
dF93YXJuX29uKSBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CSIgInR3aSAzMSwgMCwgMCIg
IlxuIiAiLnNlY3Rpb24gX19idWdfdGFibGUsXCJhd1wiXG4iICIyOlx0IiAiLjhieXRlIiAi
ICIgIjFiLCAlMFxuIiAiXHQuc2hvcnQgJTEsICUyXG4iICIub3JnIDJiKyUzXG4iICIucHJl
dmlvdXNcbiIgOiA6ICJpIiAoIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2lvLmgiKSwg
ImkiICg3OTQpLCAiaSIgKCgxIDw8IDApIHwgKCgoOSkgPDwgOCkpKSwgImkiIChzaXplb2Yo
c3RydWN0IGJ1Z19lbnRyeSkpKTsgfSBlbHNlIHsgX19hc21fXyBfX3ZvbGF0aWxlX18oICIx
OgkiICJ0ZG5laSIgIiAiICIgJTQsIDAiICJcbiIgIi5zZWN0aW9uIF9fYnVnX3RhYmxlLFwi
YXdcIlxuIiAiMjpcdCIgIi44Ynl0ZSIgIiAiICIxYiwgJTBcbiIgIlx0LnNob3J0ICUxLCAl
MlxuIiAiLm9yZyAyYislM1xuIiAiLnByZXZpb3VzXG4iIDogOiAiaSIgKCIuL2FyY2gvcG93
ZXJwYy9pbmNsdWRlL2FzbS9pby5oIiksICJpIiAoNzk0KSwgImkiICgoMSA8PCAwKSB8ICgo
OSkgPDwgOCkpLCAiaSIgKHNpemVvZihzdHJ1Y3QgYnVnX2VudHJ5KSksICJyIiAoX19yZXRf
d2Fybl9vbikpOyB9IF9fYnVpbHRpbl9leHBlY3QoISEoX19yZXRfd2Fybl9vbiksIDApOyB9
KTsKCiByZXR1cm4gKChwaHlzX2FkZHJfdCkocGZuKSA8PCAxMik7Cn0KIyAxNCAiLi9pbmNs
dWRlL2xpbnV4L2lvLmgiIDIKCgpzdHJ1Y3QgZGV2aWNlOwpzdHJ1Y3QgcmVzb3VyY2U7Cgpf
X2F0dHJpYnV0ZV9fKChfX2V4dGVybmFsbHlfdmlzaWJsZV9fKSkgdm9pZCBfX2lvd3JpdGUz
Ml9jb3B5KHZvaWQgKnRvLCBjb25zdCB2b2lkICpmcm9tLCBzaXplX3QgY291bnQpOwp2b2lk
IF9faW9yZWFkMzJfY29weSh2b2lkICp0bywgY29uc3Qgdm9pZCAqZnJvbSwgc2l6ZV90IGNv
dW50KTsKdm9pZCBfX2lvd3JpdGU2NF9jb3B5KHZvaWQgKnRvLCBjb25zdCB2b2lkICpmcm9t
LCBzaXplX3QgY291bnQpOwoKCmludCBpb3JlbWFwX3BhZ2VfcmFuZ2UodW5zaWduZWQgbG9u
ZyBhZGRyLCB1bnNpZ25lZCBsb25nIGVuZCwKICAgICAgICAgcGh5c19hZGRyX3QgcGh5c19h
ZGRyLCBwZ3Byb3RfdCBwcm90KTsKIyA0MCAiLi9pbmNsdWRlL2xpbnV4L2lvLmgiCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSB2b2lkIGlvcmVtYXBfaHVnZV9pbml0KHZvaWQpIHsgfQoKCgoKCgp2b2lkICogZGV2
bV9pb3BvcnRfbWFwKHN0cnVjdCBkZXZpY2UgKmRldiwgdW5zaWduZWQgbG9uZyBwb3J0LAog
ICAgICAgICAgdW5zaWduZWQgaW50IG5yKTsKdm9pZCBkZXZtX2lvcG9ydF91bm1hcChzdHJ1
Y3QgZGV2aWNlICpkZXYsIHZvaWQgKmFkZHIpOwojIDY1ICIuL2luY2x1ZGUvbGludXgvaW8u
aCIKdm9pZCAqZGV2bV9pb3JlbWFwKHN0cnVjdCBkZXZpY2UgKmRldiwgcmVzb3VyY2Vfc2l6
ZV90IG9mZnNldCwKICAgICAgcmVzb3VyY2Vfc2l6ZV90IHNpemUpOwp2b2lkICpkZXZtX2lv
cmVtYXBfdWMoc3RydWN0IGRldmljZSAqZGV2LCByZXNvdXJjZV9zaXplX3Qgb2Zmc2V0LAog
ICAgICAgcmVzb3VyY2Vfc2l6ZV90IHNpemUpOwp2b2lkICpkZXZtX2lvcmVtYXBfd2Moc3Ry
dWN0IGRldmljZSAqZGV2LCByZXNvdXJjZV9zaXplX3Qgb2Zmc2V0LAogICAgICAgcmVzb3Vy
Y2Vfc2l6ZV90IHNpemUpOwp2b2lkIGRldm1faW91bm1hcChzdHJ1Y3QgZGV2aWNlICpkZXYs
IHZvaWQgKmFkZHIpOwppbnQgY2hlY2tfc2lnbmF0dXJlKGNvbnN0IHZvbGF0aWxlIHZvaWQg
KmlvX2FkZHIsCiAgIGNvbnN0IHVuc2lnbmVkIGNoYXIgKnNpZ25hdHVyZSwgaW50IGxlbmd0
aCk7CnZvaWQgZGV2bV9pb3JlbWFwX3JlbGVhc2Uoc3RydWN0IGRldmljZSAqZGV2LCB2b2lk
ICpyZXMpOwoKdm9pZCAqZGV2bV9tZW1yZW1hcChzdHJ1Y3QgZGV2aWNlICpkZXYsIHJlc291
cmNlX3NpemVfdCBvZmZzZXQsCiAgc2l6ZV90IHNpemUsIHVuc2lnbmVkIGxvbmcgZmxhZ3Mp
Owp2b2lkIGRldm1fbWVtdW5tYXAoc3RydWN0IGRldmljZSAqZGV2LCB2b2lkICphZGRyKTsK
IyA5MyAiLi9pbmNsdWRlL2xpbnV4L2lvLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkICpwY2lfcmVtYXBf
Y2Znc3BhY2UocGh5c19hZGRyX3Qgb2Zmc2V0LAogICAgICAgICAgICBzaXplX3Qgc2l6ZSkK
ewogcmV0dXJuIGlvcmVtYXAob2Zmc2V0LCBzaXplKTsKfQojIDEyMiAiLi9pbmNsdWRlL2xp
bnV4L2lvLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgX19hdHRyaWJ1dGVfXygoX193YXJuX3VudXNlZF9y
ZXN1bHRfXykpIGFyY2hfcGh5c193Y19hZGQodW5zaWduZWQgbG9uZyBiYXNlLAogICAgICB1
bnNpZ25lZCBsb25nIHNpemUpCnsKIHJldHVybiAwOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBhcmNo
X3BoeXNfd2NfZGVsKGludCBoYW5kbGUpCnsKfQoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGFyY2hfcGh5
c193Y19pbmRleChpbnQgaGFuZGxlKQp7CiByZXR1cm4gLTE7Cn0KCgoKCmVudW0gewoKIE1F
TVJFTUFQX1dCID0gMSA8PCAwLAogTUVNUkVNQVBfV1QgPSAxIDw8IDEsCiBNRU1SRU1BUF9X
QyA9IDEgPDwgMiwKIE1FTVJFTUFQX0VOQyA9IDEgPDwgMywKIE1FTVJFTUFQX0RFQyA9IDEg
PDwgNCwKfTsKCnZvaWQgKm1lbXJlbWFwKHJlc291cmNlX3NpemVfdCBvZmZzZXQsIHNpemVf
dCBzaXplLCB1bnNpZ25lZCBsb25nIGZsYWdzKTsKdm9pZCBtZW11bm1hcCh2b2lkICphZGRy
KTsKIyAxNjQgIi4vaW5jbHVkZS9saW51eC9pby5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGFyY2hfaW9f
cmVzZXJ2ZV9tZW10eXBlX3djKHJlc291cmNlX3NpemVfdCBiYXNlLAogICAgICAgICAgcmVz
b3VyY2Vfc2l6ZV90IHNpemUpCnsKIHJldHVybiAwOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBhcmNo
X2lvX2ZyZWVfbWVtdHlwZV93YyhyZXNvdXJjZV9zaXplX3QgYmFzZSwKICAgICAgICByZXNv
dXJjZV9zaXplX3Qgc2l6ZSkKewp9CiMgMjEgIi4vaW5jbHVkZS9saW51eC9pcnEuaCIgMgoj
IDEgIi4vaW5jbHVkZS9saW51eC9zbGFiLmgiIDEKIyAxMzYgIi4vaW5jbHVkZS9saW51eC9z
bGFiLmgiCiMgMSAiLi9pbmNsdWRlL2xpbnV4L2thc2FuLmgiIDEKCgoKCgoKc3RydWN0IGtt
ZW1fY2FjaGU7CnN0cnVjdCBwYWdlOwpzdHJ1Y3Qgdm1fc3RydWN0OwpzdHJ1Y3QgdGFza19z
dHJ1Y3Q7CiMgMTAxICIuL2luY2x1ZGUvbGludXgva2FzYW4uaCIKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQg
a2FzYW5fdW5wb2lzb25fc2hhZG93KGNvbnN0IHZvaWQgKmFkZHJlc3MsIHNpemVfdCBzaXpl
KSB7fQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIHZvaWQga2FzYW5fdW5wb2lzb25fdGFza19zdGFjayhzdHJ1Y3Qg
dGFza19zdHJ1Y3QgKnRhc2spIHt9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGthc2FuX3VucG9pc29uX3N0
YWNrX2Fib3ZlX3NwX3RvKGNvbnN0IHZvaWQgKndhdGVybWFyaykge30KCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2
b2lkIGthc2FuX2VuYWJsZV9jdXJyZW50KHZvaWQpIHt9CnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGthc2Fu
X2Rpc2FibGVfY3VycmVudCh2b2lkKSB7fQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQga2FzYW5fYWxsb2Nf
cGFnZXMoc3RydWN0IHBhZ2UgKnBhZ2UsIHVuc2lnbmVkIGludCBvcmRlcikge30Kc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIHZvaWQga2FzYW5fZnJlZV9wYWdlcyhzdHJ1Y3QgcGFnZSAqcGFnZSwgdW5zaWduZWQg
aW50IG9yZGVyKSB7fQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQga2FzYW5fY2FjaGVfY3JlYXRlKHN0cnVj
dCBrbWVtX2NhY2hlICpjYWNoZSwKICAgICAgICAgIHVuc2lnbmVkIGludCAqc2l6ZSwKICAg
ICAgICAgIHNsYWJfZmxhZ3NfdCAqZmxhZ3MpIHt9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBrYXNhbl9w
b2lzb25fc2xhYihzdHJ1Y3QgcGFnZSAqcGFnZSkge30Kc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQga2FzYW5f
dW5wb2lzb25fb2JqZWN0X2RhdGEoc3RydWN0IGttZW1fY2FjaGUgKmNhY2hlLAogICAgIHZv
aWQgKm9iamVjdCkge30Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQga2FzYW5fcG9pc29uX29iamVjdF9kYXRh
KHN0cnVjdCBrbWVtX2NhY2hlICpjYWNoZSwKICAgICB2b2lkICpvYmplY3QpIHt9CnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSB2b2lkICprYXNhbl9pbml0X3NsYWJfb2JqKHN0cnVjdCBrbWVtX2NhY2hlICpjYWNo
ZSwKICAgIGNvbnN0IHZvaWQgKm9iamVjdCkKewogcmV0dXJuICh2b2lkICopb2JqZWN0Owp9
CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgdm9pZCAqa2FzYW5fa21hbGxvY19sYXJnZSh2b2lkICpwdHIsIHNpemVf
dCBzaXplLCBnZnBfdCBmbGFncykKewogcmV0dXJuIHB0cjsKfQpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBr
YXNhbl9rZnJlZV9sYXJnZSh2b2lkICpwdHIsIHVuc2lnbmVkIGxvbmcgaXApIHt9CnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSB2b2lkIGthc2FuX3BvaXNvbl9rZnJlZSh2b2lkICpwdHIsIHVuc2lnbmVkIGxvbmcg
aXApIHt9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSB2b2lkICprYXNhbl9rbWFsbG9jKHN0cnVjdCBrbWVtX2NhY2hl
ICpzLCBjb25zdCB2b2lkICpvYmplY3QsCiAgICBzaXplX3Qgc2l6ZSwgZ2ZwX3QgZmxhZ3Mp
CnsKIHJldHVybiAodm9pZCAqKW9iamVjdDsKfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCAqa2FzYW5fa3Jl
YWxsb2MoY29uc3Qgdm9pZCAqb2JqZWN0LCBzaXplX3QgbmV3X3NpemUsCiAgICAgZ2ZwX3Qg
ZmxhZ3MpCnsKIHJldHVybiAodm9pZCAqKW9iamVjdDsKfQoKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgKmth
c2FuX3NsYWJfYWxsb2Moc3RydWN0IGttZW1fY2FjaGUgKnMsIHZvaWQgKm9iamVjdCwKICAg
ICAgIGdmcF90IGZsYWdzKQp7CiByZXR1cm4gb2JqZWN0Owp9CnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIGth
c2FuX3NsYWJfZnJlZShzdHJ1Y3Qga21lbV9jYWNoZSAqcywgdm9pZCAqb2JqZWN0LAogICAg
ICAgdW5zaWduZWQgbG9uZyBpcCkKewogcmV0dXJuIGZhbHNlOwp9CgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50
IGthc2FuX21vZHVsZV9hbGxvYyh2b2lkICphZGRyLCBzaXplX3Qgc2l6ZSkgeyByZXR1cm4g
MDsgfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgdm9pZCBrYXNhbl9mcmVlX3NoYWRvdyhjb25zdCBzdHJ1Y3Qgdm1f
c3RydWN0ICp2bSkge30KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQga2FzYW5fYWRkX3plcm9fc2hhZG93KHZv
aWQgKnN0YXJ0LCB1bnNpZ25lZCBsb25nIHNpemUpCnsKIHJldHVybiAwOwp9CnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSB2b2lkIGthc2FuX3JlbW92ZV96ZXJvX3NoYWRvdyh2b2lkICpzdGFydCwKICAgICB1bnNp
Z25lZCBsb25nIHNpemUpCnt9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBrYXNhbl91bnBvaXNvbl9zbGFi
KGNvbnN0IHZvaWQgKnB0cikgeyB9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzaXplX3Qga2FzYW5fbWV0YWRhdGFf
c2l6ZShzdHJ1Y3Qga21lbV9jYWNoZSAqY2FjaGUpIHsgcmV0dXJuIDA7IH0KIyAxODAgIi4v
aW5jbHVkZS9saW51eC9rYXNhbi5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBrYXNhbl9jYWNoZV9zaHJp
bmsoc3RydWN0IGttZW1fY2FjaGUgKmNhY2hlKSB7fQpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBrYXNhbl9j
YWNoZV9zaHV0ZG93bihzdHJ1Y3Qga21lbV9jYWNoZSAqY2FjaGUpIHt9CiMgMTk4ICIuL2lu
Y2x1ZGUvbGludXgva2FzYW4uaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQga2FzYW5faW5pdF90YWdzKHZv
aWQpIHsgfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgKmthc2FuX3Jlc2V0X3RhZyhjb25zdCB2b2lkICph
ZGRyKQp7CiByZXR1cm4gKHZvaWQgKilhZGRyOwp9CiMgMjE1ICIuL2luY2x1ZGUvbGludXgv
a2FzYW4uaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIGludCBrYXNhbl9wb3B1bGF0ZV92bWFsbG9jKHVuc2lnbmVk
IGxvbmcgc3RhcnQsCiAgICAgdW5zaWduZWQgbG9uZyBzaXplKQp7CiByZXR1cm4gMDsKfQoK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIHZvaWQga2FzYW5fcG9pc29uX3ZtYWxsb2MoY29uc3Qgdm9pZCAqc3RhcnQs
IHVuc2lnbmVkIGxvbmcgc2l6ZSkKeyB9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGthc2FuX3VucG9pc29u
X3ZtYWxsb2MoY29uc3Qgdm9pZCAqc3RhcnQsIHVuc2lnbmVkIGxvbmcgc2l6ZSkKeyB9CnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSB2b2lkIGthc2FuX3JlbGVhc2Vfdm1hbGxvYyh1bnNpZ25lZCBsb25nIHN0YXJ0
LAogICAgICB1bnNpZ25lZCBsb25nIGVuZCwKICAgICAgdW5zaWduZWQgbG9uZyBmcmVlX3Jl
Z2lvbl9zdGFydCwKICAgICAgdW5zaWduZWQgbG9uZyBmcmVlX3JlZ2lvbl9lbmQpIHt9CgoK
CgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIHZvaWQga2FzYW5fbm9uX2Nhbm9uaWNhbF9ob29rKHVuc2lnbmVkIGxv
bmcgYWRkcikgeyB9CiMgMTM3ICIuL2luY2x1ZGUvbGludXgvc2xhYi5oIiAyCgpzdHJ1Y3Qg
bWVtX2Nncm91cDsKCgoKdm9pZCBfX2F0dHJpYnV0ZV9fKChfX3NlY3Rpb25fXygiLmluaXQu
dGV4dCIpKSkgX19hdHRyaWJ1dGVfXygoX19jb2xkX18pKSBrbWVtX2NhY2hlX2luaXQodm9p
ZCk7CmJvb2wgc2xhYl9pc19hdmFpbGFibGUodm9pZCk7CgpleHRlcm4gYm9vbCB1c2VyY29w
eV9mYWxsYmFjazsKCnN0cnVjdCBrbWVtX2NhY2hlICprbWVtX2NhY2hlX2NyZWF0ZShjb25z
dCBjaGFyICpuYW1lLCB1bnNpZ25lZCBpbnQgc2l6ZSwKICAgdW5zaWduZWQgaW50IGFsaWdu
LCBzbGFiX2ZsYWdzX3QgZmxhZ3MsCiAgIHZvaWQgKCpjdG9yKSh2b2lkICopKTsKc3RydWN0
IGttZW1fY2FjaGUgKmttZW1fY2FjaGVfY3JlYXRlX3VzZXJjb3B5KGNvbnN0IGNoYXIgKm5h
bWUsCiAgIHVuc2lnbmVkIGludCBzaXplLCB1bnNpZ25lZCBpbnQgYWxpZ24sCiAgIHNsYWJf
ZmxhZ3NfdCBmbGFncywKICAgdW5zaWduZWQgaW50IHVzZXJvZmZzZXQsIHVuc2lnbmVkIGlu
dCB1c2Vyc2l6ZSwKICAgdm9pZCAoKmN0b3IpKHZvaWQgKikpOwp2b2lkIGttZW1fY2FjaGVf
ZGVzdHJveShzdHJ1Y3Qga21lbV9jYWNoZSAqKTsKaW50IGttZW1fY2FjaGVfc2hyaW5rKHN0
cnVjdCBrbWVtX2NhY2hlICopOwoKdm9pZCBtZW1jZ19jcmVhdGVfa21lbV9jYWNoZShzdHJ1
Y3QgbWVtX2Nncm91cCAqLCBzdHJ1Y3Qga21lbV9jYWNoZSAqKTsKdm9pZCBtZW1jZ19kZWFj
dGl2YXRlX2ttZW1fY2FjaGVzKHN0cnVjdCBtZW1fY2dyb3VwICosIHN0cnVjdCBtZW1fY2dy
b3VwICopOwojIDE4NyAiLi9pbmNsdWRlL2xpbnV4L3NsYWIuaCIKdm9pZCAqIF9fYXR0cmli
dXRlX18oKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKSBrcmVhbGxvYyhjb25zdCB2b2lkICos
IHNpemVfdCwgZ2ZwX3QpOwp2b2lkIGtmcmVlKGNvbnN0IHZvaWQgKik7CnZvaWQga3pmcmVl
KGNvbnN0IHZvaWQgKik7CnNpemVfdCBfX2tzaXplKGNvbnN0IHZvaWQgKik7CnNpemVfdCBr
c2l6ZShjb25zdCB2b2lkICopOwoKCnZvaWQgX19jaGVja19oZWFwX29iamVjdChjb25zdCB2
b2lkICpwdHIsIHVuc2lnbmVkIGxvbmcgbiwgc3RydWN0IHBhZ2UgKnBhZ2UsCiAgIGJvb2wg
dG9fdXNlcik7CiMgMzA4ICIuL2luY2x1ZGUvbGludXgvc2xhYi5oIgplbnVtIGttYWxsb2Nf
Y2FjaGVfdHlwZSB7CiBLTUFMTE9DX05PUk1BTCA9IDAsCiBLTUFMTE9DX1JFQ0xBSU0sCgog
S01BTExPQ19ETUEsCgogTlJfS01BTExPQ19UWVBFUwp9OwoKCmV4dGVybiBzdHJ1Y3Qga21l
bV9jYWNoZSAqCmttYWxsb2NfY2FjaGVzW05SX0tNQUxMT0NfVFlQRVNdWygxMiArIDEpICsg
MV07CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBlbnVt
IGttYWxsb2NfY2FjaGVfdHlwZSBrbWFsbG9jX3R5cGUoZ2ZwX3QgZmxhZ3MpCnsKCgoKCgog
aWYgKF9fYnVpbHRpbl9leHBlY3QoISEoKGZsYWdzICYgKCgoIGdmcF90KTB4MDF1KSB8ICgo
IGdmcF90KTB4MTB1KSkpID09IDApLCAxKSkKICByZXR1cm4gS01BTExPQ19OT1JNQUw7CgoK
CgoKIHJldHVybiBmbGFncyAmICgoIGdmcF90KTB4MDF1KSA/IEtNQUxMT0NfRE1BIDogS01B
TExPQ19SRUNMQUlNOwoKCgp9CiMgMzQ5ICIuL2luY2x1ZGUvbGludXgvc2xhYi5oIgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB1bnNpZ25lZCBpbnQg
a21hbGxvY19pbmRleChzaXplX3Qgc2l6ZSkKewogaWYgKCFzaXplKQogIHJldHVybiAwOwoK
IGlmIChzaXplIDw9ICgxIDw8IDMpKQogIHJldHVybiAzOwoKIGlmICgoMSA8PCAzKSA8PSAz
MiAmJiBzaXplID4gNjQgJiYgc2l6ZSA8PSA5NikKICByZXR1cm4gMTsKIGlmICgoMSA8PCAz
KSA8PSA2NCAmJiBzaXplID4gMTI4ICYmIHNpemUgPD0gMTkyKQogIHJldHVybiAyOwogaWYg
KHNpemUgPD0gOCkgcmV0dXJuIDM7CiBpZiAoc2l6ZSA8PSAxNikgcmV0dXJuIDQ7CiBpZiAo
c2l6ZSA8PSAzMikgcmV0dXJuIDU7CiBpZiAoc2l6ZSA8PSA2NCkgcmV0dXJuIDY7CiBpZiAo
c2l6ZSA8PSAxMjgpIHJldHVybiA3OwogaWYgKHNpemUgPD0gMjU2KSByZXR1cm4gODsKIGlm
IChzaXplIDw9IDUxMikgcmV0dXJuIDk7CiBpZiAoc2l6ZSA8PSAxMDI0KSByZXR1cm4gMTA7
CiBpZiAoc2l6ZSA8PSAyICogMTAyNCkgcmV0dXJuIDExOwogaWYgKHNpemUgPD0gNCAqIDEw
MjQpIHJldHVybiAxMjsKIGlmIChzaXplIDw9IDggKiAxMDI0KSByZXR1cm4gMTM7CiBpZiAo
c2l6ZSA8PSAxNiAqIDEwMjQpIHJldHVybiAxNDsKIGlmIChzaXplIDw9IDMyICogMTAyNCkg
cmV0dXJuIDE1OwogaWYgKHNpemUgPD0gNjQgKiAxMDI0KSByZXR1cm4gMTY7CiBpZiAoc2l6
ZSA8PSAxMjggKiAxMDI0KSByZXR1cm4gMTc7CiBpZiAoc2l6ZSA8PSAyNTYgKiAxMDI0KSBy
ZXR1cm4gMTg7CiBpZiAoc2l6ZSA8PSA1MTIgKiAxMDI0KSByZXR1cm4gMTk7CiBpZiAoc2l6
ZSA8PSAxMDI0ICogMTAyNCkgcmV0dXJuIDIwOwogaWYgKHNpemUgPD0gMiAqIDEwMjQgKiAx
MDI0KSByZXR1cm4gMjE7CiBpZiAoc2l6ZSA8PSA0ICogMTAyNCAqIDEwMjQpIHJldHVybiAy
MjsKIGlmIChzaXplIDw9IDggKiAxMDI0ICogMTAyNCkgcmV0dXJuIDIzOwogaWYgKHNpemUg
PD0gMTYgKiAxMDI0ICogMTAyNCkgcmV0dXJuIDI0OwogaWYgKHNpemUgPD0gMzIgKiAxMDI0
ICogMTAyNCkgcmV0dXJuIDI1OwogaWYgKHNpemUgPD0gNjQgKiAxMDI0ICogMTAyNCkgcmV0
dXJuIDI2OwogZG8geyBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CSIgInR3aSAzMSwgMCwg
MCIgIlxuIiAiLnNlY3Rpb24gX19idWdfdGFibGUsXCJhd1wiXG4iICIyOlx0IiAiLjhieXRl
IiAiICIgIjFiLCAlMFxuIiAiXHQuc2hvcnQgJTEsICUyXG4iICIub3JnIDJiKyUzXG4iICIu
cHJldmlvdXNcbiIgOiA6ICJpIiAoIi4vaW5jbHVkZS9saW51eC9zbGFiLmgiKSwgImkiICgz
ODUpLCAiaSIgKDApLCAiaSIgKHNpemVvZihzdHJ1Y3QgYnVnX2VudHJ5KSkpOyBkbyB7IDsg
YXNtIHZvbGF0aWxlKCIiKTsgX19idWlsdGluX3VucmVhY2hhYmxlKCk7IH0gd2hpbGUgKDAp
OyB9IHdoaWxlICgwKTsKCgogcmV0dXJuIC0xOwp9CgoKdm9pZCAqX19rbWFsbG9jKHNpemVf
dCBzaXplLCBnZnBfdCBmbGFncykgX19hdHRyaWJ1dGVfXygoX19hc3N1bWVfYWxpZ25lZF9f
KF9fYWxpZ25vZl9fKHVuc2lnbmVkIGxvbmcgbG9uZykpKSkgX19hdHRyaWJ1dGVfXygoX19t
YWxsb2NfXykpOwp2b2lkICprbWVtX2NhY2hlX2FsbG9jKHN0cnVjdCBrbWVtX2NhY2hlICos
IGdmcF90IGZsYWdzKSBfX2F0dHJpYnV0ZV9fKChfX2Fzc3VtZV9hbGlnbmVkX18oX19hbGln
bm9mX18odW5zaWduZWQgbG9uZyBsb25nKSkpKSBfX2F0dHJpYnV0ZV9fKChfX21hbGxvY19f
KSk7CnZvaWQga21lbV9jYWNoZV9mcmVlKHN0cnVjdCBrbWVtX2NhY2hlICosIHZvaWQgKik7
CiMgNDAzICIuL2luY2x1ZGUvbGludXgvc2xhYi5oIgp2b2lkIGttZW1fY2FjaGVfZnJlZV9i
dWxrKHN0cnVjdCBrbWVtX2NhY2hlICosIHNpemVfdCwgdm9pZCAqKik7CmludCBrbWVtX2Nh
Y2hlX2FsbG9jX2J1bGsoc3RydWN0IGttZW1fY2FjaGUgKiwgZ2ZwX3QsIHNpemVfdCwgdm9p
ZCAqKik7CgoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9f
KSkgdm9pZCBrZnJlZV9idWxrKHNpemVfdCBzaXplLCB2b2lkICoqcCkKewoga21lbV9jYWNo
ZV9mcmVlX2J1bGsoKCh2b2lkICopMCksIHNpemUsIHApOwp9CgoKCgoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9f
YXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgdm9pZCAqX19rbWFsbG9jX25vZGUo
c2l6ZV90IHNpemUsIGdmcF90IGZsYWdzLCBpbnQgbm9kZSkKewogcmV0dXJuIF9fa21hbGxv
YyhzaXplLCBmbGFncyk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19p
bmxpbmVfXykpIHZvaWQgKmttZW1fY2FjaGVfYWxsb2Nfbm9kZShzdHJ1Y3Qga21lbV9jYWNo
ZSAqcywgZ2ZwX3QgZmxhZ3MsIGludCBub2RlKQp7CiByZXR1cm4ga21lbV9jYWNoZV9hbGxv
YyhzLCBmbGFncyk7Cn0KCgoKZXh0ZXJuIHZvaWQgKmttZW1fY2FjaGVfYWxsb2NfdHJhY2Uo
c3RydWN0IGttZW1fY2FjaGUgKiwgZ2ZwX3QsIHNpemVfdCkgX19hdHRyaWJ1dGVfXygoX19h
c3N1bWVfYWxpZ25lZF9fKF9fYWxpZ25vZl9fKHVuc2lnbmVkIGxvbmcgbG9uZykpKSkgX19h
dHRyaWJ1dGVfXygoX19tYWxsb2NfXykpOwoKCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVf
XygoX19hbHdheXNfaW5saW5lX18pKSB2b2lkICoKa21lbV9jYWNoZV9hbGxvY19ub2RlX3Ry
YWNlKHN0cnVjdCBrbWVtX2NhY2hlICpzLAogICAgICAgICBnZnBfdCBnZnBmbGFncywKICAg
ICAgICAgaW50IG5vZGUsIHNpemVfdCBzaXplKQp7CiByZXR1cm4ga21lbV9jYWNoZV9hbGxv
Y190cmFjZShzLCBnZnBmbGFncywgc2l6ZSk7Cn0KIyA0NjkgIi4vaW5jbHVkZS9saW51eC9z
bGFiLmgiCmV4dGVybiB2b2lkICprbWFsbG9jX29yZGVyKHNpemVfdCBzaXplLCBnZnBfdCBm
bGFncywgdW5zaWduZWQgaW50IG9yZGVyKSBfX2F0dHJpYnV0ZV9fKChfX2Fzc3VtZV9hbGln
bmVkX18oKDFVTCA8PCAxMikpKSkgX19hdHRyaWJ1dGVfXygoX19tYWxsb2NfXykpOwoKCmV4
dGVybiB2b2lkICprbWFsbG9jX29yZGVyX3RyYWNlKHNpemVfdCBzaXplLCBnZnBfdCBmbGFn
cywgdW5zaWduZWQgaW50IG9yZGVyKSBfX2F0dHJpYnV0ZV9fKChfX2Fzc3VtZV9hbGlnbmVk
X18oKDFVTCA8PCAxMikpKSkgX19hdHRyaWJ1dGVfXygoX19tYWxsb2NfXykpOwojIDQ4MSAi
Li9pbmNsdWRlL2xpbnV4L3NsYWIuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3
YXlzX2lubGluZV9fKSkgdm9pZCAqa21hbGxvY19sYXJnZShzaXplX3Qgc2l6ZSwgZ2ZwX3Qg
ZmxhZ3MpCnsKIHVuc2lnbmVkIGludCBvcmRlciA9IGdldF9vcmRlcihzaXplKTsKIHJldHVy
biBrbWFsbG9jX29yZGVyX3RyYWNlKHNpemUsIGZsYWdzLCBvcmRlcik7Cn0KIyA1NDEgIi4v
aW5jbHVkZS9saW51eC9zbGFiLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5
c19pbmxpbmVfXykpIHZvaWQgKmttYWxsb2Moc2l6ZV90IHNpemUsIGdmcF90IGZsYWdzKQp7
CiBpZiAoX19idWlsdGluX2NvbnN0YW50X3Aoc2l6ZSkpIHsKCiAgdW5zaWduZWQgaW50IGlu
ZGV4OwoKICBpZiAoc2l6ZSA+ICgxVUwgPDwgKDEyICsgMSkpKQogICByZXR1cm4ga21hbGxv
Y19sYXJnZShzaXplLCBmbGFncyk7CgogIGluZGV4ID0ga21hbGxvY19pbmRleChzaXplKTsK
CiAgaWYgKCFpbmRleCkKICAgcmV0dXJuICgodm9pZCAqKTE2KTsKCiAgcmV0dXJuIGttZW1f
Y2FjaGVfYWxsb2NfdHJhY2UoCiAgICBrbWFsbG9jX2NhY2hlc1trbWFsbG9jX3R5cGUoZmxh
Z3MpXVtpbmRleF0sCiAgICBmbGFncywgc2l6ZSk7CgogfQogcmV0dXJuIF9fa21hbGxvYyhz
aXplLCBmbGFncyk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxp
bmVfXykpIHZvaWQgKmttYWxsb2Nfbm9kZShzaXplX3Qgc2l6ZSwgZ2ZwX3QgZmxhZ3MsIGlu
dCBub2RlKQp7CgogaWYgKF9fYnVpbHRpbl9jb25zdGFudF9wKHNpemUpICYmCiAgc2l6ZSA8
PSAoMVVMIDw8ICgxMiArIDEpKSkgewogIHVuc2lnbmVkIGludCBpID0ga21hbGxvY19pbmRl
eChzaXplKTsKCiAgaWYgKCFpKQogICByZXR1cm4gKCh2b2lkICopMTYpOwoKICByZXR1cm4g
a21lbV9jYWNoZV9hbGxvY19ub2RlX3RyYWNlKAogICAga21hbGxvY19jYWNoZXNba21hbGxv
Y190eXBlKGZsYWdzKV1baV0sCiAgICAgIGZsYWdzLCBub2RlLCBzaXplKTsKIH0KCiByZXR1
cm4gX19rbWFsbG9jX25vZGUoc2l6ZSwgZmxhZ3MsIG5vZGUpOwp9CgppbnQgbWVtY2dfdXBk
YXRlX2FsbF9jYWNoZXMoaW50IG51bV9tZW1jZ3MpOwoKCgoKCgoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQg
KmttYWxsb2NfYXJyYXkoc2l6ZV90IG4sIHNpemVfdCBzaXplLCBnZnBfdCBmbGFncykKewog
c2l6ZV90IGJ5dGVzOwoKIGlmIChfX2J1aWx0aW5fZXhwZWN0KCEhKF9fYnVpbHRpbl9jaG9v
c2VfZXhwcigoKCh0eXBlb2YobikpKC0xKSkgPCAodHlwZW9mKG4pKTEpLCAoeyB0eXBlb2Yo
bikgX19hID0gKG4pOyB0eXBlb2Yoc2l6ZSkgX19iID0gKHNpemUpOyB0eXBlb2YoJmJ5dGVz
KSBfX2QgPSAoJmJ5dGVzKTsgdHlwZW9mKG4pIF9fdG1heCA9ICgodHlwZW9mKG4pKSgoKCh0
eXBlb2YobikpMSA8PCAoOCpzaXplb2YodHlwZW9mKG4pKSAtIDEgLSAoKCh0eXBlb2Yobikp
KC0xKSkgPCAodHlwZW9mKG4pKTEpKSkgLSAxKSArICgodHlwZW9mKG4pKTEgPDwgKDgqc2l6
ZW9mKHR5cGVvZihuKSkgLSAxIC0gKCgodHlwZW9mKG4pKSgtMSkpIDwgKHR5cGVvZihuKSkx
KSkpKSk7IHR5cGVvZihuKSBfX3RtaW4gPSAoKHR5cGVvZihuKSkoKHR5cGVvZihuKSktKCh0
eXBlb2YobikpKCgoKHR5cGVvZihuKSkxIDw8ICg4KnNpemVvZih0eXBlb2YobikpIC0gMSAt
ICgoKHR5cGVvZihuKSkoLTEpKSA8ICh0eXBlb2YobikpMSkpKSAtIDEpICsgKCh0eXBlb2Yo
bikpMSA8PCAoOCpzaXplb2YodHlwZW9mKG4pKSAtIDEgLSAoKCh0eXBlb2YobikpKC0xKSkg
PCAodHlwZW9mKG4pKTEpKSkpKS0odHlwZW9mKG4pKTEpKTsgKHZvaWQpICgmX19hID09ICZf
X2IpOyAodm9pZCkgKCZfX2EgPT0gX19kKTsgKl9fZCA9ICh1NjQpX19hICogKHU2NClfX2I7
IChfX2IgPiAwICYmIChfX2EgPiBfX3RtYXgvX19iIHx8IF9fYSA8IF9fdG1pbi9fX2IpKSB8
fCAoX19iIDwgKHR5cGVvZihfX2IpKS0xICYmIChfX2EgPiBfX3RtaW4vX19iIHx8IF9fYSA8
IF9fdG1heC9fX2IpKSB8fCAoX19iID09ICh0eXBlb2YoX19iKSktMSAmJiBfX2EgPT0gX190
bWluKTsgfSksICh7IHR5cGVvZihuKSBfX2EgPSAobik7IHR5cGVvZihzaXplKSBfX2IgPSAo
c2l6ZSk7IHR5cGVvZigmYnl0ZXMpIF9fZCA9ICgmYnl0ZXMpOyAodm9pZCkgKCZfX2EgPT0g
Jl9fYik7ICh2b2lkKSAoJl9fYSA9PSBfX2QpOyAqX19kID0gX19hICogX19iOyBfX2J1aWx0
aW5fY29uc3RhbnRfcChfX2IpID8gX19iID4gMCAmJiBfX2EgPiAoKHR5cGVvZihfX2EpKSgo
KCh0eXBlb2YoX19hKSkxIDw8ICg4KnNpemVvZih0eXBlb2YoX19hKSkgLSAxIC0gKCgodHlw
ZW9mKF9fYSkpKC0xKSkgPCAodHlwZW9mKF9fYSkpMSkpKSAtIDEpICsgKCh0eXBlb2YoX19h
KSkxIDw8ICg4KnNpemVvZih0eXBlb2YoX19hKSkgLSAxIC0gKCgodHlwZW9mKF9fYSkpKC0x
KSkgPCAodHlwZW9mKF9fYSkpMSkpKSkpIC8gX19iIDogX19hID4gMCAmJiBfX2IgPiAoKHR5
cGVvZihfX2IpKSgoKCh0eXBlb2YoX19iKSkxIDw8ICg4KnNpemVvZih0eXBlb2YoX19iKSkg
LSAxIC0gKCgodHlwZW9mKF9fYikpKC0xKSkgPCAodHlwZW9mKF9fYikpMSkpKSAtIDEpICsg
KCh0eXBlb2YoX19iKSkxIDw8ICg4KnNpemVvZih0eXBlb2YoX19iKSkgLSAxIC0gKCgodHlw
ZW9mKF9fYikpKC0xKSkgPCAodHlwZW9mKF9fYikpMSkpKSkpIC8gX19hOyB9KSkpLCAwKSkK
ICByZXR1cm4gKCh2b2lkICopMCk7CiBpZiAoX19idWlsdGluX2NvbnN0YW50X3AobikgJiYg
X19idWlsdGluX2NvbnN0YW50X3Aoc2l6ZSkpCiAgcmV0dXJuIGttYWxsb2MoYnl0ZXMsIGZs
YWdzKTsKIHJldHVybiBfX2ttYWxsb2MoYnl0ZXMsIGZsYWdzKTsKfQoKCgoKCgoKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIHZvaWQgKmtjYWxsb2Moc2l6ZV90IG4sIHNpemVfdCBzaXplLCBnZnBfdCBmbGFncykK
ewogcmV0dXJuIGttYWxsb2NfYXJyYXkobiwgc2l6ZSwgZmxhZ3MgfCAoKCBnZnBfdCkweDEw
MHUpKTsKfQojIDYxOSAiLi9pbmNsdWRlL2xpbnV4L3NsYWIuaCIKZXh0ZXJuIHZvaWQgKl9f
a21hbGxvY190cmFja19jYWxsZXIoc2l6ZV90LCBnZnBfdCwgdW5zaWduZWQgbG9uZyk7CgoK
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSB2b2lkICprbWFsbG9jX2FycmF5X25vZGUoc2l6ZV90IG4sIHNpemVfdCBz
aXplLCBnZnBfdCBmbGFncywKICAgICAgICAgICBpbnQgbm9kZSkKewogc2l6ZV90IGJ5dGVz
OwoKIGlmIChfX2J1aWx0aW5fZXhwZWN0KCEhKF9fYnVpbHRpbl9jaG9vc2VfZXhwcigoKCh0
eXBlb2YobikpKC0xKSkgPCAodHlwZW9mKG4pKTEpLCAoeyB0eXBlb2YobikgX19hID0gKG4p
OyB0eXBlb2Yoc2l6ZSkgX19iID0gKHNpemUpOyB0eXBlb2YoJmJ5dGVzKSBfX2QgPSAoJmJ5
dGVzKTsgdHlwZW9mKG4pIF9fdG1heCA9ICgodHlwZW9mKG4pKSgoKCh0eXBlb2YobikpMSA8
PCAoOCpzaXplb2YodHlwZW9mKG4pKSAtIDEgLSAoKCh0eXBlb2YobikpKC0xKSkgPCAodHlw
ZW9mKG4pKTEpKSkgLSAxKSArICgodHlwZW9mKG4pKTEgPDwgKDgqc2l6ZW9mKHR5cGVvZihu
KSkgLSAxIC0gKCgodHlwZW9mKG4pKSgtMSkpIDwgKHR5cGVvZihuKSkxKSkpKSk7IHR5cGVv
ZihuKSBfX3RtaW4gPSAoKHR5cGVvZihuKSkoKHR5cGVvZihuKSktKCh0eXBlb2YobikpKCgo
KHR5cGVvZihuKSkxIDw8ICg4KnNpemVvZih0eXBlb2YobikpIC0gMSAtICgoKHR5cGVvZihu
KSkoLTEpKSA8ICh0eXBlb2YobikpMSkpKSAtIDEpICsgKCh0eXBlb2YobikpMSA8PCAoOCpz
aXplb2YodHlwZW9mKG4pKSAtIDEgLSAoKCh0eXBlb2YobikpKC0xKSkgPCAodHlwZW9mKG4p
KTEpKSkpKS0odHlwZW9mKG4pKTEpKTsgKHZvaWQpICgmX19hID09ICZfX2IpOyAodm9pZCkg
KCZfX2EgPT0gX19kKTsgKl9fZCA9ICh1NjQpX19hICogKHU2NClfX2I7IChfX2IgPiAwICYm
IChfX2EgPiBfX3RtYXgvX19iIHx8IF9fYSA8IF9fdG1pbi9fX2IpKSB8fCAoX19iIDwgKHR5
cGVvZihfX2IpKS0xICYmIChfX2EgPiBfX3RtaW4vX19iIHx8IF9fYSA8IF9fdG1heC9fX2Ip
KSB8fCAoX19iID09ICh0eXBlb2YoX19iKSktMSAmJiBfX2EgPT0gX190bWluKTsgfSksICh7
IHR5cGVvZihuKSBfX2EgPSAobik7IHR5cGVvZihzaXplKSBfX2IgPSAoc2l6ZSk7IHR5cGVv
ZigmYnl0ZXMpIF9fZCA9ICgmYnl0ZXMpOyAodm9pZCkgKCZfX2EgPT0gJl9fYik7ICh2b2lk
KSAoJl9fYSA9PSBfX2QpOyAqX19kID0gX19hICogX19iOyBfX2J1aWx0aW5fY29uc3RhbnRf
cChfX2IpID8gX19iID4gMCAmJiBfX2EgPiAoKHR5cGVvZihfX2EpKSgoKCh0eXBlb2YoX19h
KSkxIDw8ICg4KnNpemVvZih0eXBlb2YoX19hKSkgLSAxIC0gKCgodHlwZW9mKF9fYSkpKC0x
KSkgPCAodHlwZW9mKF9fYSkpMSkpKSAtIDEpICsgKCh0eXBlb2YoX19hKSkxIDw8ICg4KnNp
emVvZih0eXBlb2YoX19hKSkgLSAxIC0gKCgodHlwZW9mKF9fYSkpKC0xKSkgPCAodHlwZW9m
KF9fYSkpMSkpKSkpIC8gX19iIDogX19hID4gMCAmJiBfX2IgPiAoKHR5cGVvZihfX2IpKSgo
KCh0eXBlb2YoX19iKSkxIDw8ICg4KnNpemVvZih0eXBlb2YoX19iKSkgLSAxIC0gKCgodHlw
ZW9mKF9fYikpKC0xKSkgPCAodHlwZW9mKF9fYikpMSkpKSAtIDEpICsgKCh0eXBlb2YoX19i
KSkxIDw8ICg4KnNpemVvZih0eXBlb2YoX19iKSkgLSAxIC0gKCgodHlwZW9mKF9fYikpKC0x
KSkgPCAodHlwZW9mKF9fYikpMSkpKSkpIC8gX19hOyB9KSkpLCAwKSkKICByZXR1cm4gKCh2
b2lkICopMCk7CiBpZiAoX19idWlsdGluX2NvbnN0YW50X3AobikgJiYgX19idWlsdGluX2Nv
bnN0YW50X3Aoc2l6ZSkpCiAgcmV0dXJuIGttYWxsb2Nfbm9kZShieXRlcywgZmxhZ3MsIG5v
ZGUpOwogcmV0dXJuIF9fa21hbGxvY19ub2RlKGJ5dGVzLCBmbGFncywgbm9kZSk7Cn0KCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSB2b2lkICprY2FsbG9jX25vZGUoc2l6ZV90IG4sIHNpemVfdCBzaXplLCBnZnBf
dCBmbGFncywgaW50IG5vZGUpCnsKIHJldHVybiBrbWFsbG9jX2FycmF5X25vZGUobiwgc2l6
ZSwgZmxhZ3MgfCAoKCBnZnBfdCkweDEwMHUpLCBub2RlKTsKfQojIDY1NyAiLi9pbmNsdWRl
L2xpbnV4L3NsYWIuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgKmttZW1fY2FjaGVfemFsbG9jKHN0cnVj
dCBrbWVtX2NhY2hlICprLCBnZnBfdCBmbGFncykKewogcmV0dXJuIGttZW1fY2FjaGVfYWxs
b2MoaywgZmxhZ3MgfCAoKCBnZnBfdCkweDEwMHUpKTsKfQoKCgoKCgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9p
ZCAqa3phbGxvYyhzaXplX3Qgc2l6ZSwgZ2ZwX3QgZmxhZ3MpCnsKIHJldHVybiBrbWFsbG9j
KHNpemUsIGZsYWdzIHwgKCggZ2ZwX3QpMHgxMDB1KSk7Cn0KCgoKCgoKCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2
b2lkICpremFsbG9jX25vZGUoc2l6ZV90IHNpemUsIGdmcF90IGZsYWdzLCBpbnQgbm9kZSkK
ewogcmV0dXJuIGttYWxsb2Nfbm9kZShzaXplLCBmbGFncyB8ICgoIGdmcF90KTB4MTAwdSks
IG5vZGUpOwp9Cgp1bnNpZ25lZCBpbnQga21lbV9jYWNoZV9zaXplKHN0cnVjdCBrbWVtX2Nh
Y2hlICpzKTsKdm9pZCBfX2F0dHJpYnV0ZV9fKChfX3NlY3Rpb25fXygiLmluaXQudGV4dCIp
KSkgX19hdHRyaWJ1dGVfXygoX19jb2xkX18pKSBrbWVtX2NhY2hlX2luaXRfbGF0ZSh2b2lk
KTsKIyAyMiAiLi9pbmNsdWRlL2xpbnV4L2lycS5oIiAyCgojIDEgIi4vYXJjaC9wb3dlcnBj
L2luY2x1ZGUvYXNtL2lycS5oIiAxCiMgOSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20v
aXJxLmgiCiMgMSAiLi9pbmNsdWRlL2xpbnV4L2lycWRvbWFpbi5oIiAxCiMgMzUgIi4vaW5j
bHVkZS9saW51eC9pcnFkb21haW4uaCIKIyAxICIuL2luY2x1ZGUvbGludXgvb2YuaCIgMQoj
IDE4ICIuL2luY2x1ZGUvbGludXgvb2YuaCIKIyAxICIuL2luY2x1ZGUvbGludXgvbW9kX2Rl
dmljZXRhYmxlLmgiIDEKIyAxNCAiLi9pbmNsdWRlL2xpbnV4L21vZF9kZXZpY2V0YWJsZS5o
Igp0eXBlZGVmIHVuc2lnbmVkIGxvbmcga2VybmVsX3Vsb25nX3Q7CiMgMzggIi4vaW5jbHVk
ZS9saW51eC9tb2RfZGV2aWNldGFibGUuaCIKc3RydWN0IHBjaV9kZXZpY2VfaWQgewogX191
MzIgdmVuZG9yLCBkZXZpY2U7CiBfX3UzMiBzdWJ2ZW5kb3IsIHN1YmRldmljZTsKIF9fdTMy
IGNsYXNzLCBjbGFzc19tYXNrOwoga2VybmVsX3Vsb25nX3QgZHJpdmVyX2RhdGE7Cn07CgoK
CgoKCgpzdHJ1Y3QgaWVlZTEzOTRfZGV2aWNlX2lkIHsKIF9fdTMyIG1hdGNoX2ZsYWdzOwog
X191MzIgdmVuZG9yX2lkOwogX191MzIgbW9kZWxfaWQ7CiBfX3UzMiBzcGVjaWZpZXJfaWQ7
CiBfX3UzMiB2ZXJzaW9uOwoga2VybmVsX3Vsb25nX3QgZHJpdmVyX2RhdGE7Cn07CiMgMTIx
ICIuL2luY2x1ZGUvbGludXgvbW9kX2RldmljZXRhYmxlLmgiCnN0cnVjdCB1c2JfZGV2aWNl
X2lkIHsKCiBfX3UxNiBtYXRjaF9mbGFnczsKCgogX191MTYgaWRWZW5kb3I7CiBfX3UxNiBp
ZFByb2R1Y3Q7CiBfX3UxNiBiY2REZXZpY2VfbG87CiBfX3UxNiBiY2REZXZpY2VfaGk7CgoK
IF9fdTggYkRldmljZUNsYXNzOwogX191OCBiRGV2aWNlU3ViQ2xhc3M7CiBfX3U4IGJEZXZp
Y2VQcm90b2NvbDsKCgogX191OCBiSW50ZXJmYWNlQ2xhc3M7CiBfX3U4IGJJbnRlcmZhY2VT
dWJDbGFzczsKIF9fdTggYkludGVyZmFjZVByb3RvY29sOwoKCiBfX3U4IGJJbnRlcmZhY2VO
dW1iZXI7CgoKIGtlcm5lbF91bG9uZ190IGRyaXZlcl9pbmZvCiAgX19hdHRyaWJ1dGVfXygo
YWxpZ25lZChzaXplb2Yoa2VybmVsX3Vsb25nX3QpKSkpOwp9OwojIDE2NiAiLi9pbmNsdWRl
L2xpbnV4L21vZF9kZXZpY2V0YWJsZS5oIgpzdHJ1Y3QgaGlkX2RldmljZV9pZCB7CiBfX3Ux
NiBidXM7CiBfX3UxNiBncm91cDsKIF9fdTMyIHZlbmRvcjsKIF9fdTMyIHByb2R1Y3Q7CiBr
ZXJuZWxfdWxvbmdfdCBkcml2ZXJfZGF0YTsKfTsKCgpzdHJ1Y3QgY2N3X2RldmljZV9pZCB7
CiBfX3UxNiBtYXRjaF9mbGFnczsKCiBfX3UxNiBjdV90eXBlOwogX191MTYgZGV2X3R5cGU7
CiBfX3U4IGN1X21vZGVsOwogX191OCBkZXZfbW9kZWw7Cgoga2VybmVsX3Vsb25nX3QgZHJp
dmVyX2luZm87Cn07CgoKCgoKCgpzdHJ1Y3QgYXBfZGV2aWNlX2lkIHsKIF9fdTE2IG1hdGNo
X2ZsYWdzOwogX191OCBkZXZfdHlwZTsKIGtlcm5lbF91bG9uZ190IGRyaXZlcl9pbmZvOwp9
OwoKCgoKCnN0cnVjdCBjc3NfZGV2aWNlX2lkIHsKIF9fdTggbWF0Y2hfZmxhZ3M7CiBfX3U4
IHR5cGU7CiBrZXJuZWxfdWxvbmdfdCBkcml2ZXJfZGF0YTsKfTsKCgoKc3RydWN0IGFjcGlf
ZGV2aWNlX2lkIHsKIF9fdTggaWRbOV07CiBrZXJuZWxfdWxvbmdfdCBkcml2ZXJfZGF0YTsK
IF9fdTMyIGNsczsKIF9fdTMyIGNsc19tc2s7Cn07CgoKCgpzdHJ1Y3QgcG5wX2RldmljZV9p
ZCB7CiBfX3U4IGlkWzhdOwoga2VybmVsX3Vsb25nX3QgZHJpdmVyX2RhdGE7Cn07CgpzdHJ1
Y3QgcG5wX2NhcmRfZGV2aWNlX2lkIHsKIF9fdTggaWRbOF07CiBrZXJuZWxfdWxvbmdfdCBk
cml2ZXJfZGF0YTsKIHN0cnVjdCB7CiAgX191OCBpZFs4XTsKIH0gZGV2c1s4XTsKfTsKCgoK
CnN0cnVjdCBzZXJpb19kZXZpY2VfaWQgewogX191OCB0eXBlOwogX191OCBleHRyYTsKIF9f
dTggaWQ7CiBfX3U4IHByb3RvOwp9OwoKc3RydWN0IGhkYV9kZXZpY2VfaWQgewogX191MzIg
dmVuZG9yX2lkOwogX191MzIgcmV2X2lkOwogX191OCBhcGlfdmVyc2lvbjsKIGNvbnN0IGNo
YXIgKm5hbWU7CiB1bnNpZ25lZCBsb25nIGRyaXZlcl9kYXRhOwp9OwoKc3RydWN0IHNkd19k
ZXZpY2VfaWQgewogX191MTYgbWZnX2lkOwogX191MTYgcGFydF9pZDsKIGtlcm5lbF91bG9u
Z190IGRyaXZlcl9kYXRhOwp9OwoKCgoKc3RydWN0IG9mX2RldmljZV9pZCB7CiBjaGFyIG5h
bWVbMzJdOwogY2hhciB0eXBlWzMyXTsKIGNoYXIgY29tcGF0aWJsZVsxMjhdOwogY29uc3Qg
dm9pZCAqZGF0YTsKfTsKCgpzdHJ1Y3QgdmlvX2RldmljZV9pZCB7CiBjaGFyIHR5cGVbMzJd
OwogY2hhciBjb21wYXRbMzJdOwp9OwoKCgpzdHJ1Y3QgcGNtY2lhX2RldmljZV9pZCB7CiBf
X3UxNiBtYXRjaF9mbGFnczsKCiBfX3UxNiBtYW5mX2lkOwogX191MTYgY2FyZF9pZDsKCiBf
X3U4IGZ1bmNfaWQ7CgoKIF9fdTggZnVuY3Rpb247CgoKIF9fdTggZGV2aWNlX25vOwoKIF9f
dTMyIHByb2RfaWRfaGFzaFs0XTsKCgogY29uc3QgY2hhciAqIHByb2RfaWRbNF07CgoKIGtl
cm5lbF91bG9uZ190IGRyaXZlcl9pbmZvOwogY2hhciAqIGNpc2ZpbGU7Cn07CiMgMzQwICIu
L2luY2x1ZGUvbGludXgvbW9kX2RldmljZXRhYmxlLmgiCnN0cnVjdCBpbnB1dF9kZXZpY2Vf
aWQgewoKIGtlcm5lbF91bG9uZ190IGZsYWdzOwoKIF9fdTE2IGJ1c3R5cGU7CiBfX3UxNiB2
ZW5kb3I7CiBfX3UxNiBwcm9kdWN0OwogX191MTYgdmVyc2lvbjsKCiBrZXJuZWxfdWxvbmdf
dCBldmJpdFsweDFmIC8gNjQgKyAxXTsKIGtlcm5lbF91bG9uZ190IGtleWJpdFsweDJmZiAv
IDY0ICsgMV07CiBrZXJuZWxfdWxvbmdfdCByZWxiaXRbMHgwZiAvIDY0ICsgMV07CiBrZXJu
ZWxfdWxvbmdfdCBhYnNiaXRbMHgzZiAvIDY0ICsgMV07CiBrZXJuZWxfdWxvbmdfdCBtc2Ni
aXRbMHgwNyAvIDY0ICsgMV07CiBrZXJuZWxfdWxvbmdfdCBsZWRiaXRbMHgwZiAvIDY0ICsg
MV07CiBrZXJuZWxfdWxvbmdfdCBzbmRiaXRbMHgwNyAvIDY0ICsgMV07CiBrZXJuZWxfdWxv
bmdfdCBmZmJpdFsweDdmIC8gNjQgKyAxXTsKIGtlcm5lbF91bG9uZ190IHN3Yml0WzB4MGYg
LyA2NCArIDFdOwoga2VybmVsX3Vsb25nX3QgcHJvcGJpdFsweDFmIC8gNjQgKyAxXTsKCiBr
ZXJuZWxfdWxvbmdfdCBkcml2ZXJfaW5mbzsKfTsKCgoKCgoKc3RydWN0IGVpc2FfZGV2aWNl
X2lkIHsKIGNoYXIgc2lnWzhdOwoga2VybmVsX3Vsb25nX3QgZHJpdmVyX2RhdGE7Cn07CgoK
CnN0cnVjdCBwYXJpc2NfZGV2aWNlX2lkIHsKIF9fdTggaHdfdHlwZTsKIF9fdTggaHZlcnNp
b25fcmV2OwogX191MTYgaHZlcnNpb247CiBfX3UzMiBzdmVyc2lvbjsKfTsKIyAzOTEgIi4v
aW5jbHVkZS9saW51eC9tb2RfZGV2aWNldGFibGUuaCIKc3RydWN0IHNkaW9fZGV2aWNlX2lk
IHsKIF9fdTggY2xhc3M7CiBfX3UxNiB2ZW5kb3I7CiBfX3UxNiBkZXZpY2U7CiBrZXJuZWxf
dWxvbmdfdCBkcml2ZXJfZGF0YTsKfTsKCgpzdHJ1Y3Qgc3NiX2RldmljZV9pZCB7CiBfX3Ux
NiB2ZW5kb3I7CiBfX3UxNiBjb3JlaWQ7CiBfX3U4IHJldmlzaW9uOwogX191OCBfX3BhZDsK
fSBfX2F0dHJpYnV0ZV9fKChwYWNrZWQsIGFsaWduZWQoMikpKTsKIyA0MTMgIi4vaW5jbHVk
ZS9saW51eC9tb2RfZGV2aWNldGFibGUuaCIKc3RydWN0IGJjbWFfZGV2aWNlX2lkIHsKIF9f
dTE2IG1hbnVmOwogX191MTYgaWQ7CiBfX3U4IHJldjsKIF9fdTggY2xhc3M7Cn0gX19hdHRy
aWJ1dGVfXygocGFja2VkLGFsaWduZWQoMikpKTsKIyA0MjcgIi4vaW5jbHVkZS9saW51eC9t
b2RfZGV2aWNldGFibGUuaCIKc3RydWN0IHZpcnRpb19kZXZpY2VfaWQgewogX191MzIgZGV2
aWNlOwogX191MzIgdmVuZG9yOwp9OwoKCgoKCnN0cnVjdCBodl92bWJ1c19kZXZpY2VfaWQg
ewogZ3VpZF90IGd1aWQ7CiBrZXJuZWxfdWxvbmdfdCBkcml2ZXJfZGF0YTsKfTsKCgoKCgoK
c3RydWN0IHJwbXNnX2RldmljZV9pZCB7CiBjaGFyIG5hbWVbMzJdOwp9OwoKCgoKCgpzdHJ1
Y3QgaTJjX2RldmljZV9pZCB7CiBjaGFyIG5hbWVbMjBdOwoga2VybmVsX3Vsb25nX3QgZHJp
dmVyX2RhdGE7Cn07CgoKCgoKCnN0cnVjdCBwY2lfZXBmX2RldmljZV9pZCB7CiBjaGFyIG5h
bWVbMjBdOwoga2VybmVsX3Vsb25nX3QgZHJpdmVyX2RhdGE7Cn07CiMgNDc3ICIuL2luY2x1
ZGUvbGludXgvbW9kX2RldmljZXRhYmxlLmgiCnN0cnVjdCBpM2NfZGV2aWNlX2lkIHsKIF9f
dTggbWF0Y2hfZmxhZ3M7CiBfX3U4IGRjcjsKIF9fdTE2IG1hbnVmX2lkOwogX191MTYgcGFy
dF9pZDsKIF9fdTE2IGV4dHJhX2luZm87CgogY29uc3Qgdm9pZCAqZGF0YTsKfTsKCgoKCgoK
c3RydWN0IHNwaV9kZXZpY2VfaWQgewogY2hhciBuYW1lWzMyXTsKIGtlcm5lbF91bG9uZ190
IGRyaXZlcl9kYXRhOwp9OwoKCgoKCgpzdHJ1Y3Qgc2xpbV9kZXZpY2VfaWQgewogX191MTYg
bWFuZl9pZCwgcHJvZF9jb2RlOwogX191MTYgZGV2X2luZGV4LCBpbnN0YW5jZTsKCgoga2Vy
bmVsX3Vsb25nX3QgZHJpdmVyX2RhdGE7Cn07CgoKCgpzdHJ1Y3QgYXByX2RldmljZV9pZCB7
CiBjaGFyIG5hbWVbMzJdOwogX191MzIgZG9tYWluX2lkOwogX191MzIgc3ZjX2lkOwogX191
MzIgc3ZjX3ZlcnNpb247CiBrZXJuZWxfdWxvbmdfdCBkcml2ZXJfZGF0YTsKfTsKCgoKCnN0
cnVjdCBzcG1pX2RldmljZV9pZCB7CiBjaGFyIG5hbWVbMzJdOwoga2VybmVsX3Vsb25nX3Qg
ZHJpdmVyX2RhdGE7Cn07CgoKZW51bSBkbWlfZmllbGQgewogRE1JX05PTkUsCiBETUlfQklP
U19WRU5ET1IsCiBETUlfQklPU19WRVJTSU9OLAogRE1JX0JJT1NfREFURSwKIERNSV9CSU9T
X1JFTEVBU0UsCiBETUlfRUNfRklSTVdBUkVfUkVMRUFTRSwKIERNSV9TWVNfVkVORE9SLAog
RE1JX1BST0RVQ1RfTkFNRSwKIERNSV9QUk9EVUNUX1ZFUlNJT04sCiBETUlfUFJPRFVDVF9T
RVJJQUwsCiBETUlfUFJPRFVDVF9VVUlELAogRE1JX1BST0RVQ1RfU0tVLAogRE1JX1BST0RV
Q1RfRkFNSUxZLAogRE1JX0JPQVJEX1ZFTkRPUiwKIERNSV9CT0FSRF9OQU1FLAogRE1JX0JP
QVJEX1ZFUlNJT04sCiBETUlfQk9BUkRfU0VSSUFMLAogRE1JX0JPQVJEX0FTU0VUX1RBRywK
IERNSV9DSEFTU0lTX1ZFTkRPUiwKIERNSV9DSEFTU0lTX1RZUEUsCiBETUlfQ0hBU1NJU19W
RVJTSU9OLAogRE1JX0NIQVNTSVNfU0VSSUFMLAogRE1JX0NIQVNTSVNfQVNTRVRfVEFHLAog
RE1JX1NUUklOR19NQVgsCiBETUlfT0VNX1NUUklORywKfTsKCnN0cnVjdCBkbWlfc3RybWF0
Y2ggewogdW5zaWduZWQgY2hhciBzbG90Ojc7CiB1bnNpZ25lZCBjaGFyIGV4YWN0X21hdGNo
OjE7CiBjaGFyIHN1YnN0cls3OV07Cn07CgpzdHJ1Y3QgZG1pX3N5c3RlbV9pZCB7CiBpbnQg
KCpjYWxsYmFjaykoY29uc3Qgc3RydWN0IGRtaV9zeXN0ZW1faWQgKik7CiBjb25zdCBjaGFy
ICppZGVudDsKIHN0cnVjdCBkbWlfc3RybWF0Y2ggbWF0Y2hlc1s0XTsKIHZvaWQgKmRyaXZl
cl9kYXRhOwp9OwojIDU4NCAiLi9pbmNsdWRlL2xpbnV4L21vZF9kZXZpY2V0YWJsZS5oIgpz
dHJ1Y3QgcGxhdGZvcm1fZGV2aWNlX2lkIHsKIGNoYXIgbmFtZVsyMF07CiBrZXJuZWxfdWxv
bmdfdCBkcml2ZXJfZGF0YTsKfTsKIyA2MTEgIi4vaW5jbHVkZS9saW51eC9tb2RfZGV2aWNl
dGFibGUuaCIKc3RydWN0IG1kaW9fZGV2aWNlX2lkIHsKIF9fdTMyIHBoeV9pZDsKIF9fdTMy
IHBoeV9pZF9tYXNrOwp9OwoKc3RydWN0IHpvcnJvX2RldmljZV9pZCB7CiBfX3UzMiBpZDsK
IGtlcm5lbF91bG9uZ190IGRyaXZlcl9kYXRhOwp9OwoKCgoKCgpzdHJ1Y3QgaXNhcG5wX2Rl
dmljZV9pZCB7CiB1bnNpZ25lZCBzaG9ydCBjYXJkX3ZlbmRvciwgY2FyZF9kZXZpY2U7CiB1
bnNpZ25lZCBzaG9ydCB2ZW5kb3IsIGZ1bmN0aW9uOwoga2VybmVsX3Vsb25nX3QgZHJpdmVy
X2RhdGE7Cn07CiMgNjQwICIuL2luY2x1ZGUvbGludXgvbW9kX2RldmljZXRhYmxlLmgiCnN0
cnVjdCBhbWJhX2lkIHsKIHVuc2lnbmVkIGludCBpZDsKIHVuc2lnbmVkIGludCBtYXNrOwog
dm9pZCAqZGF0YTsKfTsKCgoKCgpzdHJ1Y3QgbWlwc19jZG1tX2RldmljZV9pZCB7CiBfX3U4
IHR5cGU7Cn07CiMgNjY0ICIuL2luY2x1ZGUvbGludXgvbW9kX2RldmljZXRhYmxlLmgiCnN0
cnVjdCB4ODZfY3B1X2lkIHsKIF9fdTE2IHZlbmRvcjsKIF9fdTE2IGZhbWlseTsKIF9fdTE2
IG1vZGVsOwogX191MTYgc3RlcHBpbmdzOwogX191MTYgZmVhdHVyZTsKIGtlcm5lbF91bG9u
Z190IGRyaXZlcl9kYXRhOwp9OwojIDY4NSAiLi9pbmNsdWRlL2xpbnV4L21vZF9kZXZpY2V0
YWJsZS5oIgpzdHJ1Y3QgY3B1X2ZlYXR1cmUgewogX191MTYgZmVhdHVyZTsKfTsKCgoKc3Ry
dWN0IGlwYWNrX2RldmljZV9pZCB7CiBfX3U4IGZvcm1hdDsKIF9fdTMyIHZlbmRvcjsKIF9f
dTMyIGRldmljZTsKfTsKIyA3MTAgIi4vaW5jbHVkZS9saW51eC9tb2RfZGV2aWNldGFibGUu
aCIKc3RydWN0IG1laV9jbF9kZXZpY2VfaWQgewogY2hhciBuYW1lWzMyXTsKIHV1aWRfbGUg
dXVpZDsKIF9fdTggdmVyc2lvbjsKIGtlcm5lbF91bG9uZ190IGRyaXZlcl9pbmZvOwp9Owoj
IDczMSAiLi9pbmNsdWRlL2xpbnV4L21vZF9kZXZpY2V0YWJsZS5oIgpzdHJ1Y3QgcmlvX2Rl
dmljZV9pZCB7CiBfX3UxNiBkaWQsIHZpZDsKIF9fdTE2IGFzbV9kaWQsIGFzbV92aWQ7Cn07
CgpzdHJ1Y3QgbWNiX2RldmljZV9pZCB7CiBfX3UxNiBkZXZpY2U7CiBrZXJuZWxfdWxvbmdf
dCBkcml2ZXJfZGF0YTsKfTsKCnN0cnVjdCB1bHBpX2RldmljZV9pZCB7CiBfX3UxNiB2ZW5k
b3I7CiBfX3UxNiBwcm9kdWN0Owoga2VybmVsX3Vsb25nX3QgZHJpdmVyX2RhdGE7Cn07CiMg
NzU1ICIuL2luY2x1ZGUvbGludXgvbW9kX2RldmljZXRhYmxlLmgiCnN0cnVjdCBmc2xfbWNf
ZGV2aWNlX2lkIHsKIF9fdTE2IHZlbmRvcjsKIGNvbnN0IGNoYXIgb2JqX3R5cGVbMTZdOwp9
OwojIDc3MyAiLi9pbmNsdWRlL2xpbnV4L21vZF9kZXZpY2V0YWJsZS5oIgpzdHJ1Y3QgdGJf
c2VydmljZV9pZCB7CiBfX3UzMiBtYXRjaF9mbGFnczsKIGNoYXIgcHJvdG9jb2xfa2V5Wzgg
KyAxXTsKIF9fdTMyIHByb3RvY29sX2lkOwogX191MzIgcHJvdG9jb2xfdmVyc2lvbjsKIF9f
dTMyIHByb3RvY29sX3JldmlzaW9uOwoga2VybmVsX3Vsb25nX3QgZHJpdmVyX2RhdGE7Cn07
CiMgNzk3ICIuL2luY2x1ZGUvbGludXgvbW9kX2RldmljZXRhYmxlLmgiCnN0cnVjdCB0eXBl
Y19kZXZpY2VfaWQgewogX191MTYgc3ZpZDsKIF9fdTggbW9kZTsKIGtlcm5lbF91bG9uZ190
IGRyaXZlcl9kYXRhOwp9OwoKCgoKCgpzdHJ1Y3QgdGVlX2NsaWVudF9kZXZpY2VfaWQgewog
dXVpZF90IHV1aWQ7Cn07CiMgODIxICIuL2luY2x1ZGUvbGludXgvbW9kX2RldmljZXRhYmxl
LmgiCnN0cnVjdCB3bWlfZGV2aWNlX2lkIHsKIGNvbnN0IGNoYXIgZ3VpZF9zdHJpbmdbMzYg
KzFdOwogY29uc3Qgdm9pZCAqY29udGV4dDsKfTsKIyA4MzQgIi4vaW5jbHVkZS9saW51eC9t
b2RfZGV2aWNldGFibGUuaCIKc3RydWN0IG1oaV9kZXZpY2VfaWQgewogY29uc3QgY2hhciBj
aGFuWzMyXTsKIGtlcm5lbF91bG9uZ190IGRyaXZlcl9kYXRhOwp9OwojIDE5ICIuL2luY2x1
ZGUvbGludXgvb2YuaCIgMgoKCgojIDEgIi4vaW5jbHVkZS9saW51eC9wcm9wZXJ0eS5oIiAx
CiMgMTQgIi4vaW5jbHVkZS9saW51eC9wcm9wZXJ0eS5oIgojIDEgIi4vaW5jbHVkZS9saW51
eC9md25vZGUuaCIgMQojIDE0ICIuL2luY2x1ZGUvbGludXgvZndub2RlLmgiCnN0cnVjdCBm
d25vZGVfb3BlcmF0aW9uczsKc3RydWN0IGRldmljZTsKCnN0cnVjdCBmd25vZGVfaGFuZGxl
IHsKIHN0cnVjdCBmd25vZGVfaGFuZGxlICpzZWNvbmRhcnk7CiBjb25zdCBzdHJ1Y3QgZndu
b2RlX29wZXJhdGlvbnMgKm9wczsKIHN0cnVjdCBkZXZpY2UgKmRldjsKfTsKCgoKCgoKCnN0
cnVjdCBmd25vZGVfZW5kcG9pbnQgewogdW5zaWduZWQgaW50IHBvcnQ7CiB1bnNpZ25lZCBp
bnQgaWQ7CiBjb25zdCBzdHJ1Y3QgZndub2RlX2hhbmRsZSAqbG9jYWxfZndub2RlOwp9Owoj
IDQzICIuL2luY2x1ZGUvbGludXgvZndub2RlLmgiCnN0cnVjdCBmd25vZGVfcmVmZXJlbmNl
X2FyZ3Mgewogc3RydWN0IGZ3bm9kZV9oYW5kbGUgKmZ3bm9kZTsKIHVuc2lnbmVkIGludCBu
YXJnczsKIHU2NCBhcmdzWzhdOwp9OwojIDExMCAiLi9pbmNsdWRlL2xpbnV4L2Z3bm9kZS5o
IgpzdHJ1Y3QgZndub2RlX29wZXJhdGlvbnMgewogc3RydWN0IGZ3bm9kZV9oYW5kbGUgKigq
Z2V0KShzdHJ1Y3QgZndub2RlX2hhbmRsZSAqZndub2RlKTsKIHZvaWQgKCpwdXQpKHN0cnVj
dCBmd25vZGVfaGFuZGxlICpmd25vZGUpOwogYm9vbCAoKmRldmljZV9pc19hdmFpbGFibGUp
KGNvbnN0IHN0cnVjdCBmd25vZGVfaGFuZGxlICpmd25vZGUpOwogY29uc3Qgdm9pZCAqKCpk
ZXZpY2VfZ2V0X21hdGNoX2RhdGEpKGNvbnN0IHN0cnVjdCBmd25vZGVfaGFuZGxlICpmd25v
ZGUsCiAgICAgICAgICBjb25zdCBzdHJ1Y3QgZGV2aWNlICpkZXYpOwogYm9vbCAoKnByb3Bl
cnR5X3ByZXNlbnQpKGNvbnN0IHN0cnVjdCBmd25vZGVfaGFuZGxlICpmd25vZGUsCiAgICAg
Y29uc3QgY2hhciAqcHJvcG5hbWUpOwogaW50ICgqcHJvcGVydHlfcmVhZF9pbnRfYXJyYXkp
KGNvbnN0IHN0cnVjdCBmd25vZGVfaGFuZGxlICpmd25vZGUsCiAgICAgICAgICAgY29uc3Qg
Y2hhciAqcHJvcG5hbWUsCiAgICAgICAgICAgdW5zaWduZWQgaW50IGVsZW1fc2l6ZSwgdm9p
ZCAqdmFsLAogICAgICAgICAgIHNpemVfdCBudmFsKTsKIGludAogKCpwcm9wZXJ0eV9yZWFk
X3N0cmluZ19hcnJheSkoY29uc3Qgc3RydWN0IGZ3bm9kZV9oYW5kbGUgKmZ3bm9kZV9oYW5k
bGUsCiAgICAgICAgICBjb25zdCBjaGFyICpwcm9wbmFtZSwgY29uc3QgY2hhciAqKnZhbCwK
ICAgICAgICAgIHNpemVfdCBudmFsKTsKIGNvbnN0IGNoYXIgKigqZ2V0X25hbWUpKGNvbnN0
IHN0cnVjdCBmd25vZGVfaGFuZGxlICpmd25vZGUpOwogY29uc3QgY2hhciAqKCpnZXRfbmFt
ZV9wcmVmaXgpKGNvbnN0IHN0cnVjdCBmd25vZGVfaGFuZGxlICpmd25vZGUpOwogc3RydWN0
IGZ3bm9kZV9oYW5kbGUgKigqZ2V0X3BhcmVudCkoY29uc3Qgc3RydWN0IGZ3bm9kZV9oYW5k
bGUgKmZ3bm9kZSk7CiBzdHJ1Y3QgZndub2RlX2hhbmRsZSAqCiAoKmdldF9uZXh0X2NoaWxk
X25vZGUpKGNvbnN0IHN0cnVjdCBmd25vZGVfaGFuZGxlICpmd25vZGUsCiAgICAgICAgICBz
dHJ1Y3QgZndub2RlX2hhbmRsZSAqY2hpbGQpOwogc3RydWN0IGZ3bm9kZV9oYW5kbGUgKgog
KCpnZXRfbmFtZWRfY2hpbGRfbm9kZSkoY29uc3Qgc3RydWN0IGZ3bm9kZV9oYW5kbGUgKmZ3
bm9kZSwKICAgIGNvbnN0IGNoYXIgKm5hbWUpOwogaW50ICgqZ2V0X3JlZmVyZW5jZV9hcmdz
KShjb25zdCBzdHJ1Y3QgZndub2RlX2hhbmRsZSAqZndub2RlLAogICAgICBjb25zdCBjaGFy
ICpwcm9wLCBjb25zdCBjaGFyICpuYXJnc19wcm9wLAogICAgICB1bnNpZ25lZCBpbnQgbmFy
Z3MsIHVuc2lnbmVkIGludCBpbmRleCwKICAgICAgc3RydWN0IGZ3bm9kZV9yZWZlcmVuY2Vf
YXJncyAqYXJncyk7CiBzdHJ1Y3QgZndub2RlX2hhbmRsZSAqCiAoKmdyYXBoX2dldF9uZXh0
X2VuZHBvaW50KShjb25zdCBzdHJ1Y3QgZndub2RlX2hhbmRsZSAqZndub2RlLAogICAgICAg
c3RydWN0IGZ3bm9kZV9oYW5kbGUgKnByZXYpOwogc3RydWN0IGZ3bm9kZV9oYW5kbGUgKgog
KCpncmFwaF9nZXRfcmVtb3RlX2VuZHBvaW50KShjb25zdCBzdHJ1Y3QgZndub2RlX2hhbmRs
ZSAqZndub2RlKTsKIHN0cnVjdCBmd25vZGVfaGFuZGxlICoKICgqZ3JhcGhfZ2V0X3BvcnRf
cGFyZW50KShzdHJ1Y3QgZndub2RlX2hhbmRsZSAqZndub2RlKTsKIGludCAoKmdyYXBoX3Bh
cnNlX2VuZHBvaW50KShjb25zdCBzdHJ1Y3QgZndub2RlX2hhbmRsZSAqZndub2RlLAogICAg
ICAgIHN0cnVjdCBmd25vZGVfZW5kcG9pbnQgKmVuZHBvaW50KTsKIGludCAoKmFkZF9saW5r
cykoY29uc3Qgc3RydWN0IGZ3bm9kZV9oYW5kbGUgKmZ3bm9kZSwKICAgIHN0cnVjdCBkZXZp
Y2UgKmRldik7Cn07CiMgMTczICIuL2luY2x1ZGUvbGludXgvZndub2RlLmgiCmV4dGVybiB1
MzIgZndfZGV2bGlua19nZXRfZmxhZ3Modm9pZCk7CnZvaWQgZndfZGV2bGlua19wYXVzZSh2
b2lkKTsKdm9pZCBmd19kZXZsaW5rX3Jlc3VtZSh2b2lkKTsKIyAxNSAiLi9pbmNsdWRlL2xp
bnV4L3Byb3BlcnR5LmgiIDIKCgpzdHJ1Y3QgZGV2aWNlOwoKZW51bSBkZXZfcHJvcF90eXBl
IHsKIERFVl9QUk9QX1U4LAogREVWX1BST1BfVTE2LAogREVWX1BST1BfVTMyLAogREVWX1BS
T1BfVTY0LAogREVWX1BST1BfU1RSSU5HLAogREVWX1BST1BfUkVGLAp9OwoKZW51bSBkZXZf
ZG1hX2F0dHIgewogREVWX0RNQV9OT1RfU1VQUE9SVEVELAogREVWX0RNQV9OT05fQ09IRVJF
TlQsCiBERVZfRE1BX0NPSEVSRU5ULAp9OwoKc3RydWN0IGZ3bm9kZV9oYW5kbGUgKmRldl9m
d25vZGUoc3RydWN0IGRldmljZSAqZGV2KTsKCmJvb2wgZGV2aWNlX3Byb3BlcnR5X3ByZXNl
bnQoc3RydWN0IGRldmljZSAqZGV2LCBjb25zdCBjaGFyICpwcm9wbmFtZSk7CmludCBkZXZp
Y2VfcHJvcGVydHlfcmVhZF91OF9hcnJheShzdHJ1Y3QgZGV2aWNlICpkZXYsIGNvbnN0IGNo
YXIgKnByb3BuYW1lLAogICAgICB1OCAqdmFsLCBzaXplX3QgbnZhbCk7CmludCBkZXZpY2Vf
cHJvcGVydHlfcmVhZF91MTZfYXJyYXkoc3RydWN0IGRldmljZSAqZGV2LCBjb25zdCBjaGFy
ICpwcm9wbmFtZSwKICAgICAgIHUxNiAqdmFsLCBzaXplX3QgbnZhbCk7CmludCBkZXZpY2Vf
cHJvcGVydHlfcmVhZF91MzJfYXJyYXkoc3RydWN0IGRldmljZSAqZGV2LCBjb25zdCBjaGFy
ICpwcm9wbmFtZSwKICAgICAgIHUzMiAqdmFsLCBzaXplX3QgbnZhbCk7CmludCBkZXZpY2Vf
cHJvcGVydHlfcmVhZF91NjRfYXJyYXkoc3RydWN0IGRldmljZSAqZGV2LCBjb25zdCBjaGFy
ICpwcm9wbmFtZSwKICAgICAgIHU2NCAqdmFsLCBzaXplX3QgbnZhbCk7CmludCBkZXZpY2Vf
cHJvcGVydHlfcmVhZF9zdHJpbmdfYXJyYXkoc3RydWN0IGRldmljZSAqZGV2LCBjb25zdCBj
aGFyICpwcm9wbmFtZSwKICAgICAgICAgIGNvbnN0IGNoYXIgKip2YWwsIHNpemVfdCBudmFs
KTsKaW50IGRldmljZV9wcm9wZXJ0eV9yZWFkX3N0cmluZyhzdHJ1Y3QgZGV2aWNlICpkZXYs
IGNvbnN0IGNoYXIgKnByb3BuYW1lLAogICAgY29uc3QgY2hhciAqKnZhbCk7CmludCBkZXZp
Y2VfcHJvcGVydHlfbWF0Y2hfc3RyaW5nKHN0cnVjdCBkZXZpY2UgKmRldiwKICAgICBjb25z
dCBjaGFyICpwcm9wbmFtZSwgY29uc3QgY2hhciAqc3RyaW5nKTsKCmJvb2wgZndub2RlX2Rl
dmljZV9pc19hdmFpbGFibGUoY29uc3Qgc3RydWN0IGZ3bm9kZV9oYW5kbGUgKmZ3bm9kZSk7
CmJvb2wgZndub2RlX3Byb3BlcnR5X3ByZXNlbnQoY29uc3Qgc3RydWN0IGZ3bm9kZV9oYW5k
bGUgKmZ3bm9kZSwKICAgICAgICBjb25zdCBjaGFyICpwcm9wbmFtZSk7CmludCBmd25vZGVf
cHJvcGVydHlfcmVhZF91OF9hcnJheShjb25zdCBzdHJ1Y3QgZndub2RlX2hhbmRsZSAqZndu
b2RlLAogICAgICBjb25zdCBjaGFyICpwcm9wbmFtZSwgdTggKnZhbCwKICAgICAgc2l6ZV90
IG52YWwpOwppbnQgZndub2RlX3Byb3BlcnR5X3JlYWRfdTE2X2FycmF5KGNvbnN0IHN0cnVj
dCBmd25vZGVfaGFuZGxlICpmd25vZGUsCiAgICAgICBjb25zdCBjaGFyICpwcm9wbmFtZSwg
dTE2ICp2YWwsCiAgICAgICBzaXplX3QgbnZhbCk7CmludCBmd25vZGVfcHJvcGVydHlfcmVh
ZF91MzJfYXJyYXkoY29uc3Qgc3RydWN0IGZ3bm9kZV9oYW5kbGUgKmZ3bm9kZSwKICAgICAg
IGNvbnN0IGNoYXIgKnByb3BuYW1lLCB1MzIgKnZhbCwKICAgICAgIHNpemVfdCBudmFsKTsK
aW50IGZ3bm9kZV9wcm9wZXJ0eV9yZWFkX3U2NF9hcnJheShjb25zdCBzdHJ1Y3QgZndub2Rl
X2hhbmRsZSAqZndub2RlLAogICAgICAgY29uc3QgY2hhciAqcHJvcG5hbWUsIHU2NCAqdmFs
LAogICAgICAgc2l6ZV90IG52YWwpOwppbnQgZndub2RlX3Byb3BlcnR5X3JlYWRfc3RyaW5n
X2FycmF5KGNvbnN0IHN0cnVjdCBmd25vZGVfaGFuZGxlICpmd25vZGUsCiAgICAgICAgICBj
b25zdCBjaGFyICpwcm9wbmFtZSwgY29uc3QgY2hhciAqKnZhbCwKICAgICAgICAgIHNpemVf
dCBudmFsKTsKaW50IGZ3bm9kZV9wcm9wZXJ0eV9yZWFkX3N0cmluZyhjb25zdCBzdHJ1Y3Qg
Zndub2RlX2hhbmRsZSAqZndub2RlLAogICAgY29uc3QgY2hhciAqcHJvcG5hbWUsIGNvbnN0
IGNoYXIgKip2YWwpOwppbnQgZndub2RlX3Byb3BlcnR5X21hdGNoX3N0cmluZyhjb25zdCBz
dHJ1Y3QgZndub2RlX2hhbmRsZSAqZndub2RlLAogICAgIGNvbnN0IGNoYXIgKnByb3BuYW1l
LCBjb25zdCBjaGFyICpzdHJpbmcpOwppbnQgZndub2RlX3Byb3BlcnR5X2dldF9yZWZlcmVu
Y2VfYXJncyhjb25zdCBzdHJ1Y3QgZndub2RlX2hhbmRsZSAqZndub2RlLAogICAgICAgICAg
IGNvbnN0IGNoYXIgKnByb3AsIGNvbnN0IGNoYXIgKm5hcmdzX3Byb3AsCiAgICAgICAgICAg
dW5zaWduZWQgaW50IG5hcmdzLCB1bnNpZ25lZCBpbnQgaW5kZXgsCiAgICAgICAgICAgc3Ry
dWN0IGZ3bm9kZV9yZWZlcmVuY2VfYXJncyAqYXJncyk7CgpzdHJ1Y3QgZndub2RlX2hhbmRs
ZSAqZndub2RlX2ZpbmRfcmVmZXJlbmNlKGNvbnN0IHN0cnVjdCBmd25vZGVfaGFuZGxlICpm
d25vZGUsCiAgICAgICAgIGNvbnN0IGNoYXIgKm5hbWUsCiAgICAgICAgIHVuc2lnbmVkIGlu
dCBpbmRleCk7Cgpjb25zdCBjaGFyICpmd25vZGVfZ2V0X25hbWUoY29uc3Qgc3RydWN0IGZ3
bm9kZV9oYW5kbGUgKmZ3bm9kZSk7CmNvbnN0IGNoYXIgKmZ3bm9kZV9nZXRfbmFtZV9wcmVm
aXgoY29uc3Qgc3RydWN0IGZ3bm9kZV9oYW5kbGUgKmZ3bm9kZSk7CnN0cnVjdCBmd25vZGVf
aGFuZGxlICpmd25vZGVfZ2V0X3BhcmVudChjb25zdCBzdHJ1Y3QgZndub2RlX2hhbmRsZSAq
Zndub2RlKTsKc3RydWN0IGZ3bm9kZV9oYW5kbGUgKmZ3bm9kZV9nZXRfbmV4dF9wYXJlbnQo
CiBzdHJ1Y3QgZndub2RlX2hhbmRsZSAqZndub2RlKTsKdW5zaWduZWQgaW50IGZ3bm9kZV9j
b3VudF9wYXJlbnRzKGNvbnN0IHN0cnVjdCBmd25vZGVfaGFuZGxlICpmd24pOwpzdHJ1Y3Qg
Zndub2RlX2hhbmRsZSAqZndub2RlX2dldF9udGhfcGFyZW50KHN0cnVjdCBmd25vZGVfaGFu
ZGxlICpmd24sCiAgICAgICAgIHVuc2lnbmVkIGludCBkZXB0aCk7CnN0cnVjdCBmd25vZGVf
aGFuZGxlICpmd25vZGVfZ2V0X25leHRfY2hpbGRfbm9kZSgKIGNvbnN0IHN0cnVjdCBmd25v
ZGVfaGFuZGxlICpmd25vZGUsIHN0cnVjdCBmd25vZGVfaGFuZGxlICpjaGlsZCk7CnN0cnVj
dCBmd25vZGVfaGFuZGxlICpmd25vZGVfZ2V0X25leHRfYXZhaWxhYmxlX2NoaWxkX25vZGUo
CiBjb25zdCBzdHJ1Y3QgZndub2RlX2hhbmRsZSAqZndub2RlLCBzdHJ1Y3QgZndub2RlX2hh
bmRsZSAqY2hpbGQpOwojIDEwNCAiLi9pbmNsdWRlL2xpbnV4L3Byb3BlcnR5LmgiCnN0cnVj
dCBmd25vZGVfaGFuZGxlICpkZXZpY2VfZ2V0X25leHRfY2hpbGRfbm9kZSgKIHN0cnVjdCBk
ZXZpY2UgKmRldiwgc3RydWN0IGZ3bm9kZV9oYW5kbGUgKmNoaWxkKTsKCgoKCgpzdHJ1Y3Qg
Zndub2RlX2hhbmRsZSAqZndub2RlX2dldF9uYW1lZF9jaGlsZF9ub2RlKAogY29uc3Qgc3Ry
dWN0IGZ3bm9kZV9oYW5kbGUgKmZ3bm9kZSwgY29uc3QgY2hhciAqY2hpbGRuYW1lKTsKc3Ry
dWN0IGZ3bm9kZV9oYW5kbGUgKmRldmljZV9nZXRfbmFtZWRfY2hpbGRfbm9kZShzdHJ1Y3Qg
ZGV2aWNlICpkZXYsCiAgICAgICAgY29uc3QgY2hhciAqY2hpbGRuYW1lKTsKCnN0cnVjdCBm
d25vZGVfaGFuZGxlICpmd25vZGVfaGFuZGxlX2dldChzdHJ1Y3QgZndub2RlX2hhbmRsZSAq
Zndub2RlKTsKdm9pZCBmd25vZGVfaGFuZGxlX3B1dChzdHJ1Y3QgZndub2RlX2hhbmRsZSAq
Zndub2RlKTsKCmludCBmd25vZGVfaXJxX2dldChzdHJ1Y3QgZndub2RlX2hhbmRsZSAqZndu
b2RlLCB1bnNpZ25lZCBpbnQgaW5kZXgpOwoKdW5zaWduZWQgaW50IGRldmljZV9nZXRfY2hp
bGRfbm9kZV9jb3VudChzdHJ1Y3QgZGV2aWNlICpkZXYpOwoKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgZGV2
aWNlX3Byb3BlcnR5X3JlYWRfYm9vbChzdHJ1Y3QgZGV2aWNlICpkZXYsCiAgICAgICAgICBj
b25zdCBjaGFyICpwcm9wbmFtZSkKewogcmV0dXJuIGRldmljZV9wcm9wZXJ0eV9wcmVzZW50
KGRldiwgcHJvcG5hbWUpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGRldmljZV9wcm9wZXJ0eV9yZWFk
X3U4KHN0cnVjdCBkZXZpY2UgKmRldiwKICAgICAgIGNvbnN0IGNoYXIgKnByb3BuYW1lLCB1
OCAqdmFsKQp7CiByZXR1cm4gZGV2aWNlX3Byb3BlcnR5X3JlYWRfdThfYXJyYXkoZGV2LCBw
cm9wbmFtZSwgdmFsLCAxKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBkZXZpY2VfcHJvcGVydHlfcmVh
ZF91MTYoc3RydWN0IGRldmljZSAqZGV2LAogICAgICAgIGNvbnN0IGNoYXIgKnByb3BuYW1l
LCB1MTYgKnZhbCkKewogcmV0dXJuIGRldmljZV9wcm9wZXJ0eV9yZWFkX3UxNl9hcnJheShk
ZXYsIHByb3BuYW1lLCB2YWwsIDEpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGRldmljZV9wcm9wZXJ0
eV9yZWFkX3UzMihzdHJ1Y3QgZGV2aWNlICpkZXYsCiAgICAgICAgY29uc3QgY2hhciAqcHJv
cG5hbWUsIHUzMiAqdmFsKQp7CiByZXR1cm4gZGV2aWNlX3Byb3BlcnR5X3JlYWRfdTMyX2Fy
cmF5KGRldiwgcHJvcG5hbWUsIHZhbCwgMSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgZGV2aWNlX3By
b3BlcnR5X3JlYWRfdTY0KHN0cnVjdCBkZXZpY2UgKmRldiwKICAgICAgICBjb25zdCBjaGFy
ICpwcm9wbmFtZSwgdTY0ICp2YWwpCnsKIHJldHVybiBkZXZpY2VfcHJvcGVydHlfcmVhZF91
NjRfYXJyYXkoZGV2LCBwcm9wbmFtZSwgdmFsLCAxKTsKfQoKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBkZXZp
Y2VfcHJvcGVydHlfY291bnRfdTgoc3RydWN0IGRldmljZSAqZGV2LCBjb25zdCBjaGFyICpw
cm9wbmFtZSkKewogcmV0dXJuIGRldmljZV9wcm9wZXJ0eV9yZWFkX3U4X2FycmF5KGRldiwg
cHJvcG5hbWUsICgodm9pZCAqKTApLCAwKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBkZXZpY2VfcHJv
cGVydHlfY291bnRfdTE2KHN0cnVjdCBkZXZpY2UgKmRldiwgY29uc3QgY2hhciAqcHJvcG5h
bWUpCnsKIHJldHVybiBkZXZpY2VfcHJvcGVydHlfcmVhZF91MTZfYXJyYXkoZGV2LCBwcm9w
bmFtZSwgKCh2b2lkICopMCksIDApOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGRldmljZV9wcm9wZXJ0
eV9jb3VudF91MzIoc3RydWN0IGRldmljZSAqZGV2LCBjb25zdCBjaGFyICpwcm9wbmFtZSkK
ewogcmV0dXJuIGRldmljZV9wcm9wZXJ0eV9yZWFkX3UzMl9hcnJheShkZXYsIHByb3BuYW1l
LCAoKHZvaWQgKikwKSwgMCk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgZGV2aWNlX3Byb3BlcnR5X2Nv
dW50X3U2NChzdHJ1Y3QgZGV2aWNlICpkZXYsIGNvbnN0IGNoYXIgKnByb3BuYW1lKQp7CiBy
ZXR1cm4gZGV2aWNlX3Byb3BlcnR5X3JlYWRfdTY0X2FycmF5KGRldiwgcHJvcG5hbWUsICgo
dm9pZCAqKTApLCAwKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgZndub2RlX3Byb3BlcnR5X3JlYWRf
Ym9vbChjb25zdCBzdHJ1Y3QgZndub2RlX2hhbmRsZSAqZndub2RlLAogICAgICAgICAgY29u
c3QgY2hhciAqcHJvcG5hbWUpCnsKIHJldHVybiBmd25vZGVfcHJvcGVydHlfcHJlc2VudChm
d25vZGUsIHByb3BuYW1lKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBmd25vZGVfcHJvcGVydHlfcmVh
ZF91OChjb25zdCBzdHJ1Y3QgZndub2RlX2hhbmRsZSAqZndub2RlLAogICAgICAgY29uc3Qg
Y2hhciAqcHJvcG5hbWUsIHU4ICp2YWwpCnsKIHJldHVybiBmd25vZGVfcHJvcGVydHlfcmVh
ZF91OF9hcnJheShmd25vZGUsIHByb3BuYW1lLCB2YWwsIDEpOwp9CgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50
IGZ3bm9kZV9wcm9wZXJ0eV9yZWFkX3UxNihjb25zdCBzdHJ1Y3QgZndub2RlX2hhbmRsZSAq
Zndub2RlLAogICAgICAgIGNvbnN0IGNoYXIgKnByb3BuYW1lLCB1MTYgKnZhbCkKewogcmV0
dXJuIGZ3bm9kZV9wcm9wZXJ0eV9yZWFkX3UxNl9hcnJheShmd25vZGUsIHByb3BuYW1lLCB2
YWwsIDEpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGZ3bm9kZV9wcm9wZXJ0eV9yZWFkX3UzMihjb25z
dCBzdHJ1Y3QgZndub2RlX2hhbmRsZSAqZndub2RlLAogICAgICAgIGNvbnN0IGNoYXIgKnBy
b3BuYW1lLCB1MzIgKnZhbCkKewogcmV0dXJuIGZ3bm9kZV9wcm9wZXJ0eV9yZWFkX3UzMl9h
cnJheShmd25vZGUsIHByb3BuYW1lLCB2YWwsIDEpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGZ3bm9k
ZV9wcm9wZXJ0eV9yZWFkX3U2NChjb25zdCBzdHJ1Y3QgZndub2RlX2hhbmRsZSAqZndub2Rl
LAogICAgICAgIGNvbnN0IGNoYXIgKnByb3BuYW1lLCB1NjQgKnZhbCkKewogcmV0dXJuIGZ3
bm9kZV9wcm9wZXJ0eV9yZWFkX3U2NF9hcnJheShmd25vZGUsIHByb3BuYW1lLCB2YWwsIDEp
Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgaW50IGZ3bm9kZV9wcm9wZXJ0eV9jb3VudF91OChjb25zdCBzdHJ1
Y3QgZndub2RlX2hhbmRsZSAqZndub2RlLAogICAgICAgIGNvbnN0IGNoYXIgKnByb3BuYW1l
KQp7CiByZXR1cm4gZndub2RlX3Byb3BlcnR5X3JlYWRfdThfYXJyYXkoZndub2RlLCBwcm9w
bmFtZSwgKCh2b2lkICopMCksIDApOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGZ3bm9kZV9wcm9wZXJ0
eV9jb3VudF91MTYoY29uc3Qgc3RydWN0IGZ3bm9kZV9oYW5kbGUgKmZ3bm9kZSwKICAgICAg
ICAgY29uc3QgY2hhciAqcHJvcG5hbWUpCnsKIHJldHVybiBmd25vZGVfcHJvcGVydHlfcmVh
ZF91MTZfYXJyYXkoZndub2RlLCBwcm9wbmFtZSwgKCh2b2lkICopMCksIDApOwp9CgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgaW50IGZ3bm9kZV9wcm9wZXJ0eV9jb3VudF91MzIoY29uc3Qgc3RydWN0IGZ3bm9k
ZV9oYW5kbGUgKmZ3bm9kZSwKICAgICAgICAgY29uc3QgY2hhciAqcHJvcG5hbWUpCnsKIHJl
dHVybiBmd25vZGVfcHJvcGVydHlfcmVhZF91MzJfYXJyYXkoZndub2RlLCBwcm9wbmFtZSwg
KCh2b2lkICopMCksIDApOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGZ3bm9kZV9wcm9wZXJ0eV9jb3Vu
dF91NjQoY29uc3Qgc3RydWN0IGZ3bm9kZV9oYW5kbGUgKmZ3bm9kZSwKICAgICAgICAgY29u
c3QgY2hhciAqcHJvcG5hbWUpCnsKIHJldHVybiBmd25vZGVfcHJvcGVydHlfcmVhZF91NjRf
YXJyYXkoZndub2RlLCBwcm9wbmFtZSwgKCh2b2lkICopMCksIDApOwp9CgpzdHJ1Y3Qgc29m
dHdhcmVfbm9kZTsKCgoKCgoKCnN0cnVjdCBzb2Z0d2FyZV9ub2RlX3JlZl9hcmdzIHsKIGNv
bnN0IHN0cnVjdCBzb2Z0d2FyZV9ub2RlICpub2RlOwogdW5zaWduZWQgaW50IG5hcmdzOwog
dTY0IGFyZ3NbOF07Cn07CiMgMjUwICIuL2luY2x1ZGUvbGludXgvcHJvcGVydHkuaCIKc3Ry
dWN0IHByb3BlcnR5X2VudHJ5IHsKIGNvbnN0IGNoYXIgKm5hbWU7CiBzaXplX3QgbGVuZ3Ro
OwogYm9vbCBpc19pbmxpbmU7CiBlbnVtIGRldl9wcm9wX3R5cGUgdHlwZTsKIHVuaW9uIHsK
ICBjb25zdCB2b2lkICpwb2ludGVyOwogIHVuaW9uIHsKICAgdTggdThfZGF0YVtzaXplb2Yo
dTY0KSAvIHNpemVvZih1OCldOwogICB1MTYgdTE2X2RhdGFbc2l6ZW9mKHU2NCkgLyBzaXpl
b2YodTE2KV07CiAgIHUzMiB1MzJfZGF0YVtzaXplb2YodTY0KSAvIHNpemVvZih1MzIpXTsK
ICAgdTY0IHU2NF9kYXRhW3NpemVvZih1NjQpIC8gc2l6ZW9mKHU2NCldOwogICBjb25zdCBj
aGFyICpzdHJbc2l6ZW9mKHU2NCkgLyBzaXplb2YoY2hhciAqKV07CiAgfSB2YWx1ZTsKIH07
Cn07CiMgMzU2ICIuL2luY2x1ZGUvbGludXgvcHJvcGVydHkuaCIKc3RydWN0IHByb3BlcnR5
X2VudHJ5ICoKcHJvcGVydHlfZW50cmllc19kdXAoY29uc3Qgc3RydWN0IHByb3BlcnR5X2Vu
dHJ5ICpwcm9wZXJ0aWVzKTsKCnZvaWQgcHJvcGVydHlfZW50cmllc19mcmVlKGNvbnN0IHN0
cnVjdCBwcm9wZXJ0eV9lbnRyeSAqcHJvcGVydGllcyk7CgppbnQgZGV2aWNlX2FkZF9wcm9w
ZXJ0aWVzKHN0cnVjdCBkZXZpY2UgKmRldiwKICAgICBjb25zdCBzdHJ1Y3QgcHJvcGVydHlf
ZW50cnkgKnByb3BlcnRpZXMpOwp2b2lkIGRldmljZV9yZW1vdmVfcHJvcGVydGllcyhzdHJ1
Y3QgZGV2aWNlICpkZXYpOwoKYm9vbCBkZXZpY2VfZG1hX3N1cHBvcnRlZChzdHJ1Y3QgZGV2
aWNlICpkZXYpOwoKZW51bSBkZXZfZG1hX2F0dHIgZGV2aWNlX2dldF9kbWFfYXR0cihzdHJ1
Y3QgZGV2aWNlICpkZXYpOwoKY29uc3Qgdm9pZCAqZGV2aWNlX2dldF9tYXRjaF9kYXRhKHN0
cnVjdCBkZXZpY2UgKmRldik7CgppbnQgZGV2aWNlX2dldF9waHlfbW9kZShzdHJ1Y3QgZGV2
aWNlICpkZXYpOwoKdm9pZCAqZGV2aWNlX2dldF9tYWNfYWRkcmVzcyhzdHJ1Y3QgZGV2aWNl
ICpkZXYsIGNoYXIgKmFkZHIsIGludCBhbGVuKTsKCmludCBmd25vZGVfZ2V0X3BoeV9tb2Rl
KHN0cnVjdCBmd25vZGVfaGFuZGxlICpmd25vZGUpOwp2b2lkICpmd25vZGVfZ2V0X21hY19h
ZGRyZXNzKHN0cnVjdCBmd25vZGVfaGFuZGxlICpmd25vZGUsCiAgICAgICAgY2hhciAqYWRk
ciwgaW50IGFsZW4pOwpzdHJ1Y3QgZndub2RlX2hhbmRsZSAqZndub2RlX2dyYXBoX2dldF9u
ZXh0X2VuZHBvaW50KAogY29uc3Qgc3RydWN0IGZ3bm9kZV9oYW5kbGUgKmZ3bm9kZSwgc3Ry
dWN0IGZ3bm9kZV9oYW5kbGUgKnByZXYpOwpzdHJ1Y3QgZndub2RlX2hhbmRsZSAqCmZ3bm9k
ZV9ncmFwaF9nZXRfcG9ydF9wYXJlbnQoY29uc3Qgc3RydWN0IGZ3bm9kZV9oYW5kbGUgKmZ3
bm9kZSk7CnN0cnVjdCBmd25vZGVfaGFuZGxlICpmd25vZGVfZ3JhcGhfZ2V0X3JlbW90ZV9w
b3J0X3BhcmVudCgKIGNvbnN0IHN0cnVjdCBmd25vZGVfaGFuZGxlICpmd25vZGUpOwpzdHJ1
Y3QgZndub2RlX2hhbmRsZSAqZndub2RlX2dyYXBoX2dldF9yZW1vdGVfcG9ydCgKIGNvbnN0
IHN0cnVjdCBmd25vZGVfaGFuZGxlICpmd25vZGUpOwpzdHJ1Y3QgZndub2RlX2hhbmRsZSAq
Zndub2RlX2dyYXBoX2dldF9yZW1vdGVfZW5kcG9pbnQoCiBjb25zdCBzdHJ1Y3QgZndub2Rl
X2hhbmRsZSAqZndub2RlKTsKc3RydWN0IGZ3bm9kZV9oYW5kbGUgKgpmd25vZGVfZ3JhcGhf
Z2V0X3JlbW90ZV9ub2RlKGNvbnN0IHN0cnVjdCBmd25vZGVfaGFuZGxlICpmd25vZGUsIHUz
MiBwb3J0LAogICAgICAgIHUzMiBlbmRwb2ludCk7CiMgNDA1ICIuL2luY2x1ZGUvbGludXgv
cHJvcGVydHkuaCIKc3RydWN0IGZ3bm9kZV9oYW5kbGUgKgpmd25vZGVfZ3JhcGhfZ2V0X2Vu
ZHBvaW50X2J5X2lkKGNvbnN0IHN0cnVjdCBmd25vZGVfaGFuZGxlICpmd25vZGUsCiAgICB1
MzIgcG9ydCwgdTMyIGVuZHBvaW50LCB1bnNpZ25lZCBsb25nIGZsYWdzKTsKCgoKCgppbnQg
Zndub2RlX2dyYXBoX3BhcnNlX2VuZHBvaW50KGNvbnN0IHN0cnVjdCBmd25vZGVfaGFuZGxl
ICpmd25vZGUsCiAgICBzdHJ1Y3QgZndub2RlX2VuZHBvaW50ICplbmRwb2ludCk7CiMgNDI1
ICIuL2luY2x1ZGUvbGludXgvcHJvcGVydHkuaCIKc3RydWN0IHNvZnR3YXJlX25vZGUgewog
Y29uc3QgY2hhciAqbmFtZTsKIGNvbnN0IHN0cnVjdCBzb2Z0d2FyZV9ub2RlICpwYXJlbnQ7
CiBjb25zdCBzdHJ1Y3QgcHJvcGVydHlfZW50cnkgKnByb3BlcnRpZXM7Cn07Cgpib29sIGlz
X3NvZnR3YXJlX25vZGUoY29uc3Qgc3RydWN0IGZ3bm9kZV9oYW5kbGUgKmZ3bm9kZSk7CmNv
bnN0IHN0cnVjdCBzb2Z0d2FyZV9ub2RlICoKdG9fc29mdHdhcmVfbm9kZShjb25zdCBzdHJ1
Y3QgZndub2RlX2hhbmRsZSAqZndub2RlKTsKc3RydWN0IGZ3bm9kZV9oYW5kbGUgKnNvZnR3
YXJlX25vZGVfZndub2RlKGNvbnN0IHN0cnVjdCBzb2Z0d2FyZV9ub2RlICpub2RlKTsKCmNv
bnN0IHN0cnVjdCBzb2Z0d2FyZV9ub2RlICoKc29mdHdhcmVfbm9kZV9maW5kX2J5X25hbWUo
Y29uc3Qgc3RydWN0IHNvZnR3YXJlX25vZGUgKnBhcmVudCwKICAgICAgY29uc3QgY2hhciAq
bmFtZSk7CgppbnQgc29mdHdhcmVfbm9kZV9yZWdpc3Rlcl9ub2Rlcyhjb25zdCBzdHJ1Y3Qg
c29mdHdhcmVfbm9kZSAqbm9kZXMpOwp2b2lkIHNvZnR3YXJlX25vZGVfdW5yZWdpc3Rlcl9u
b2Rlcyhjb25zdCBzdHJ1Y3Qgc29mdHdhcmVfbm9kZSAqbm9kZXMpOwoKaW50IHNvZnR3YXJl
X25vZGVfcmVnaXN0ZXJfbm9kZV9ncm91cChjb25zdCBzdHJ1Y3Qgc29mdHdhcmVfbm9kZSAq
Km5vZGVfZ3JvdXApOwp2b2lkIHNvZnR3YXJlX25vZGVfdW5yZWdpc3Rlcl9ub2RlX2dyb3Vw
KGNvbnN0IHN0cnVjdCBzb2Z0d2FyZV9ub2RlICoqbm9kZV9ncm91cCk7CgppbnQgc29mdHdh
cmVfbm9kZV9yZWdpc3Rlcihjb25zdCBzdHJ1Y3Qgc29mdHdhcmVfbm9kZSAqbm9kZSk7CnZv
aWQgc29mdHdhcmVfbm9kZV91bnJlZ2lzdGVyKGNvbnN0IHN0cnVjdCBzb2Z0d2FyZV9ub2Rl
ICpub2RlKTsKCmludCBzb2Z0d2FyZV9ub2RlX25vdGlmeShzdHJ1Y3QgZGV2aWNlICpkZXYs
IHVuc2lnbmVkIGxvbmcgYWN0aW9uKTsKCnN0cnVjdCBmd25vZGVfaGFuZGxlICoKZndub2Rl
X2NyZWF0ZV9zb2Z0d2FyZV9ub2RlKGNvbnN0IHN0cnVjdCBwcm9wZXJ0eV9lbnRyeSAqcHJv
cGVydGllcywKICAgICAgIGNvbnN0IHN0cnVjdCBmd25vZGVfaGFuZGxlICpwYXJlbnQpOwp2
b2lkIGZ3bm9kZV9yZW1vdmVfc29mdHdhcmVfbm9kZShzdHJ1Y3QgZndub2RlX2hhbmRsZSAq
Zndub2RlKTsKIyAyMyAiLi9pbmNsdWRlL2xpbnV4L29mLmgiIDIKCgoKCgp0eXBlZGVmIHUz
MiBwaGFuZGxlOwp0eXBlZGVmIHUzMiBpaGFuZGxlOwoKc3RydWN0IHByb3BlcnR5IHsKIGNo
YXIgKm5hbWU7CiBpbnQgbGVuZ3RoOwogdm9pZCAqdmFsdWU7CiBzdHJ1Y3QgcHJvcGVydHkg
Km5leHQ7CgoKCgoKCgogc3RydWN0IGJpbl9hdHRyaWJ1dGUgYXR0cjsKCn07CgoKCgoKc3Ry
dWN0IGRldmljZV9ub2RlIHsKIGNvbnN0IGNoYXIgKm5hbWU7CiBwaGFuZGxlIHBoYW5kbGU7
CiBjb25zdCBjaGFyICpmdWxsX25hbWU7CiBzdHJ1Y3QgZndub2RlX2hhbmRsZSBmd25vZGU7
Cgogc3RydWN0IHByb3BlcnR5ICpwcm9wZXJ0aWVzOwogc3RydWN0IHByb3BlcnR5ICpkZWFk
cHJvcHM7CiBzdHJ1Y3QgZGV2aWNlX25vZGUgKnBhcmVudDsKIHN0cnVjdCBkZXZpY2Vfbm9k
ZSAqY2hpbGQ7CiBzdHJ1Y3QgZGV2aWNlX25vZGUgKnNpYmxpbmc7Cgogc3RydWN0IGtvYmpl
Y3Qga29iajsKCiB1bnNpZ25lZCBsb25nIF9mbGFnczsKIHZvaWQgKmRhdGE7CgoKCgp9OwoK
CnN0cnVjdCBvZl9waGFuZGxlX2FyZ3Mgewogc3RydWN0IGRldmljZV9ub2RlICpucDsKIGlu
dCBhcmdzX2NvdW50OwogdWludDMyX3QgYXJnc1sxNl07Cn07CgpzdHJ1Y3Qgb2ZfcGhhbmRs
ZV9pdGVyYXRvciB7CgogY29uc3QgY2hhciAqY2VsbHNfbmFtZTsKIGludCBjZWxsX2NvdW50
OwogY29uc3Qgc3RydWN0IGRldmljZV9ub2RlICpwYXJlbnQ7CgoKIGNvbnN0IF9fYmUzMiAq
bGlzdF9lbmQ7CiBjb25zdCBfX2JlMzIgKnBoYW5kbGVfZW5kOwoKCiBjb25zdCBfX2JlMzIg
KmN1cjsKIHVpbnQzMl90IGN1cl9jb3VudDsKIHBoYW5kbGUgcGhhbmRsZTsKIHN0cnVjdCBk
ZXZpY2Vfbm9kZSAqbm9kZTsKfTsKCnN0cnVjdCBvZl9yZWNvbmZpZ19kYXRhIHsKIHN0cnVj
dCBkZXZpY2Vfbm9kZSAqZG47CiBzdHJ1Y3QgcHJvcGVydHkgKnByb3A7CiBzdHJ1Y3QgcHJv
cGVydHkgKm9sZF9wcm9wOwp9OwoKCmV4dGVybiBzdHJ1Y3Qga29ial90eXBlIG9mX25vZGVf
a3R5cGU7CmV4dGVybiBjb25zdCBzdHJ1Y3QgZndub2RlX29wZXJhdGlvbnMgb2ZfZndub2Rl
X29wczsKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIHZvaWQgb2Zfbm9kZV9pbml0KHN0cnVjdCBkZXZpY2Vfbm9kZSAq
bm9kZSkKewoKIGtvYmplY3RfaW5pdCgmbm9kZS0+a29iaiwgJm9mX25vZGVfa3R5cGUpOwoK
IG5vZGUtPmZ3bm9kZS5vcHMgPSAmb2ZfZndub2RlX29wczsKfQojIDEyNSAiLi9pbmNsdWRl
L2xpbnV4L29mLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3QgZGV2aWNlX25vZGUgKm9mX25vZGVfZ2V0
KHN0cnVjdCBkZXZpY2Vfbm9kZSAqbm9kZSkKewogcmV0dXJuIG5vZGU7Cn0Kc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IHZvaWQgb2Zfbm9kZV9wdXQoc3RydWN0IGRldmljZV9ub2RlICpub2RlKSB7IH0KCgoKZXh0
ZXJuIHN0cnVjdCBkZXZpY2Vfbm9kZSAqb2Zfcm9vdDsKZXh0ZXJuIHN0cnVjdCBkZXZpY2Vf
bm9kZSAqb2ZfY2hvc2VuOwpleHRlcm4gc3RydWN0IGRldmljZV9ub2RlICpvZl9hbGlhc2Vz
OwpleHRlcm4gc3RydWN0IGRldmljZV9ub2RlICpvZl9zdGRvdXQ7CmV4dGVybiByYXdfc3Bp
bmxvY2tfdCBkZXZ0cmVlX2xvY2s7CiMgMTUzICIuL2luY2x1ZGUvbGludXgvb2YuaCIKdm9p
ZCBvZl9jb3JlX2luaXQodm9pZCk7CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBpc19vZl9ub2RlKGNvbnN0
IHN0cnVjdCBmd25vZGVfaGFuZGxlICpmd25vZGUpCnsKIHJldHVybiAhSVNfRVJSX09SX05V
TEwoZndub2RlKSAmJiBmd25vZGUtPm9wcyA9PSAmb2ZfZndub2RlX29wczsKfQojIDE3OCAi
Li9pbmNsdWRlL2xpbnV4L29mLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIG9mX2hhdmVfcG9wdWxhdGVk
X2R0KHZvaWQpCnsKIHJldHVybiBvZl9yb290ICE9ICgodm9pZCAqKTApOwp9CgpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgYm9vbCBvZl9ub2RlX2lzX3Jvb3QoY29uc3Qgc3RydWN0IGRldmljZV9ub2RlICpub2Rl
KQp7CiByZXR1cm4gbm9kZSAmJiAobm9kZS0+cGFyZW50ID09ICgodm9pZCAqKTApKTsKfQoK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIGludCBvZl9ub2RlX2NoZWNrX2ZsYWcoc3RydWN0IGRldmljZV9ub2RlICpu
LCB1bnNpZ25lZCBsb25nIGZsYWcpCnsKIHJldHVybiB0ZXN0X2JpdChmbGFnLCAmbi0+X2Zs
YWdzKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIGludCBvZl9ub2RlX3Rlc3RfYW5kX3NldF9mbGFnKHN0cnVj
dCBkZXZpY2Vfbm9kZSAqbiwKICAgICAgICAgdW5zaWduZWQgbG9uZyBmbGFnKQp7CiByZXR1
cm4gdGVzdF9hbmRfc2V0X2JpdChmbGFnLCAmbi0+X2ZsYWdzKTsKfQoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZv
aWQgb2Zfbm9kZV9zZXRfZmxhZyhzdHJ1Y3QgZGV2aWNlX25vZGUgKm4sIHVuc2lnbmVkIGxv
bmcgZmxhZykKewogc2V0X2JpdChmbGFnLCAmbi0+X2ZsYWdzKTsKfQoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZv
aWQgb2Zfbm9kZV9jbGVhcl9mbGFnKHN0cnVjdCBkZXZpY2Vfbm9kZSAqbiwgdW5zaWduZWQg
bG9uZyBmbGFnKQp7CiBjbGVhcl9iaXQoZmxhZywgJm4tPl9mbGFncyk7Cn0KIyAyMjYgIi4v
aW5jbHVkZS9saW51eC9vZi5oIgpleHRlcm4gc3RydWN0IGRldmljZV9ub2RlICpfX29mX2Zp
bmRfYWxsX25vZGVzKHN0cnVjdCBkZXZpY2Vfbm9kZSAqcHJldik7CmV4dGVybiBzdHJ1Y3Qg
ZGV2aWNlX25vZGUgKm9mX2ZpbmRfYWxsX25vZGVzKHN0cnVjdCBkZXZpY2Vfbm9kZSAqcHJl
dik7CgoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSB1NjQgb2ZfcmVhZF9udW1iZXIoY29uc3QgX19iZTMyICpj
ZWxsLCBpbnQgc2l6ZSkKewogdTY0IHIgPSAwOwogZm9yICg7IHNpemUtLTsgY2VsbCsrKQog
IHIgPSAociA8PCAzMikgfCAoKCBfX3UzMikoX19iZTMyKSgqY2VsbCkpOwogcmV0dXJuIHI7
Cn0KCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgbG9uZyBvZl9yZWFkX3Vsb25nKGNvbnN0IF9fYmUz
MiAqY2VsbCwgaW50IHNpemUpCnsKCiByZXR1cm4gb2ZfcmVhZF9udW1iZXIoY2VsbCwgc2l6
ZSk7Cn0KIyAyNTYgIi4vaW5jbHVkZS9saW51eC9vZi5oIgpleHRlcm4gYm9vbCBvZl9ub2Rl
X25hbWVfZXEoY29uc3Qgc3RydWN0IGRldmljZV9ub2RlICpucCwgY29uc3QgY2hhciAqbmFt
ZSk7CmV4dGVybiBib29sIG9mX25vZGVfbmFtZV9wcmVmaXgoY29uc3Qgc3RydWN0IGRldmlj
ZV9ub2RlICpucCwgY29uc3QgY2hhciAqcHJlZml4KTsKCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBjb25zdCBjaGFy
ICpvZl9ub2RlX2Z1bGxfbmFtZShjb25zdCBzdHJ1Y3QgZGV2aWNlX25vZGUgKm5wKQp7CiBy
ZXR1cm4gbnAgPyBucC0+ZnVsbF9uYW1lIDogIjxuby1ub2RlPiI7Cn0KCgoKCmV4dGVybiBz
dHJ1Y3QgZGV2aWNlX25vZGUgKm9mX2ZpbmRfbm9kZV9ieV9uYW1lKHN0cnVjdCBkZXZpY2Vf
bm9kZSAqZnJvbSwKIGNvbnN0IGNoYXIgKm5hbWUpOwpleHRlcm4gc3RydWN0IGRldmljZV9u
b2RlICpvZl9maW5kX25vZGVfYnlfdHlwZShzdHJ1Y3QgZGV2aWNlX25vZGUgKmZyb20sCiBj
b25zdCBjaGFyICp0eXBlKTsKZXh0ZXJuIHN0cnVjdCBkZXZpY2Vfbm9kZSAqb2ZfZmluZF9j
b21wYXRpYmxlX25vZGUoc3RydWN0IGRldmljZV9ub2RlICpmcm9tLAogY29uc3QgY2hhciAq
dHlwZSwgY29uc3QgY2hhciAqY29tcGF0KTsKZXh0ZXJuIHN0cnVjdCBkZXZpY2Vfbm9kZSAq
b2ZfZmluZF9tYXRjaGluZ19ub2RlX2FuZF9tYXRjaCgKIHN0cnVjdCBkZXZpY2Vfbm9kZSAq
ZnJvbSwKIGNvbnN0IHN0cnVjdCBvZl9kZXZpY2VfaWQgKm1hdGNoZXMsCiBjb25zdCBzdHJ1
Y3Qgb2ZfZGV2aWNlX2lkICoqbWF0Y2gpOwoKZXh0ZXJuIHN0cnVjdCBkZXZpY2Vfbm9kZSAq
b2ZfZmluZF9ub2RlX29wdHNfYnlfcGF0aChjb25zdCBjaGFyICpwYXRoLAogY29uc3QgY2hh
ciAqKm9wdHMpOwpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IGRldmljZV9ub2RlICpvZl9maW5kX25vZGVf
YnlfcGF0aChjb25zdCBjaGFyICpwYXRoKQp7CiByZXR1cm4gb2ZfZmluZF9ub2RlX29wdHNf
YnlfcGF0aChwYXRoLCAoKHZvaWQgKikwKSk7Cn0KCmV4dGVybiBzdHJ1Y3QgZGV2aWNlX25v
ZGUgKm9mX2ZpbmRfbm9kZV9ieV9waGFuZGxlKHBoYW5kbGUgaGFuZGxlKTsKZXh0ZXJuIHN0
cnVjdCBkZXZpY2Vfbm9kZSAqb2ZfZ2V0X3BhcmVudChjb25zdCBzdHJ1Y3QgZGV2aWNlX25v
ZGUgKm5vZGUpOwpleHRlcm4gc3RydWN0IGRldmljZV9ub2RlICpvZl9nZXRfbmV4dF9wYXJl
bnQoc3RydWN0IGRldmljZV9ub2RlICpub2RlKTsKZXh0ZXJuIHN0cnVjdCBkZXZpY2Vfbm9k
ZSAqb2ZfZ2V0X25leHRfY2hpbGQoY29uc3Qgc3RydWN0IGRldmljZV9ub2RlICpub2RlLAog
ICAgICAgICAgc3RydWN0IGRldmljZV9ub2RlICpwcmV2KTsKZXh0ZXJuIHN0cnVjdCBkZXZp
Y2Vfbm9kZSAqb2ZfZ2V0X25leHRfYXZhaWxhYmxlX2NoaWxkKAogY29uc3Qgc3RydWN0IGRl
dmljZV9ub2RlICpub2RlLCBzdHJ1Y3QgZGV2aWNlX25vZGUgKnByZXYpOwoKZXh0ZXJuIHN0
cnVjdCBkZXZpY2Vfbm9kZSAqb2ZfZ2V0X2NvbXBhdGlibGVfY2hpbGQoY29uc3Qgc3RydWN0
IGRldmljZV9ub2RlICpwYXJlbnQsCiAgICAgY29uc3QgY2hhciAqY29tcGF0aWJsZSk7CmV4
dGVybiBzdHJ1Y3QgZGV2aWNlX25vZGUgKm9mX2dldF9jaGlsZF9ieV9uYW1lKGNvbnN0IHN0
cnVjdCBkZXZpY2Vfbm9kZSAqbm9kZSwKICAgICBjb25zdCBjaGFyICpuYW1lKTsKCgpleHRl
cm4gc3RydWN0IGRldmljZV9ub2RlICpvZl9maW5kX25leHRfY2FjaGVfbm9kZShjb25zdCBz
dHJ1Y3QgZGV2aWNlX25vZGUgKik7CmV4dGVybiBpbnQgb2ZfZmluZF9sYXN0X2NhY2hlX2xl
dmVsKHVuc2lnbmVkIGludCBjcHUpOwpleHRlcm4gc3RydWN0IGRldmljZV9ub2RlICpvZl9m
aW5kX25vZGVfd2l0aF9wcm9wZXJ0eSgKIHN0cnVjdCBkZXZpY2Vfbm9kZSAqZnJvbSwgY29u
c3QgY2hhciAqcHJvcF9uYW1lKTsKCmV4dGVybiBzdHJ1Y3QgcHJvcGVydHkgKm9mX2ZpbmRf
cHJvcGVydHkoY29uc3Qgc3RydWN0IGRldmljZV9ub2RlICpucCwKICAgICAgY29uc3QgY2hh
ciAqbmFtZSwKICAgICAgaW50ICpsZW5wKTsKZXh0ZXJuIGludCBvZl9wcm9wZXJ0eV9jb3Vu
dF9lbGVtc19vZl9zaXplKGNvbnN0IHN0cnVjdCBkZXZpY2Vfbm9kZSAqbnAsCiAgICBjb25z
dCBjaGFyICpwcm9wbmFtZSwgaW50IGVsZW1fc2l6ZSk7CmV4dGVybiBpbnQgb2ZfcHJvcGVy
dHlfcmVhZF91MzJfaW5kZXgoY29uc3Qgc3RydWN0IGRldmljZV9ub2RlICpucCwKICAgICAg
ICAgICBjb25zdCBjaGFyICpwcm9wbmFtZSwKICAgICAgICAgICB1MzIgaW5kZXgsIHUzMiAq
b3V0X3ZhbHVlKTsKZXh0ZXJuIGludCBvZl9wcm9wZXJ0eV9yZWFkX3U2NF9pbmRleChjb25z
dCBzdHJ1Y3QgZGV2aWNlX25vZGUgKm5wLAogICAgICAgICAgIGNvbnN0IGNoYXIgKnByb3Bu
YW1lLAogICAgICAgICAgIHUzMiBpbmRleCwgdTY0ICpvdXRfdmFsdWUpOwpleHRlcm4gaW50
IG9mX3Byb3BlcnR5X3JlYWRfdmFyaWFibGVfdThfYXJyYXkoY29uc3Qgc3RydWN0IGRldmlj
ZV9ub2RlICpucCwKICAgICBjb25zdCBjaGFyICpwcm9wbmFtZSwgdTggKm91dF92YWx1ZXMs
CiAgICAgc2l6ZV90IHN6X21pbiwgc2l6ZV90IHN6X21heCk7CmV4dGVybiBpbnQgb2ZfcHJv
cGVydHlfcmVhZF92YXJpYWJsZV91MTZfYXJyYXkoY29uc3Qgc3RydWN0IGRldmljZV9ub2Rl
ICpucCwKICAgICBjb25zdCBjaGFyICpwcm9wbmFtZSwgdTE2ICpvdXRfdmFsdWVzLAogICAg
IHNpemVfdCBzel9taW4sIHNpemVfdCBzel9tYXgpOwpleHRlcm4gaW50IG9mX3Byb3BlcnR5
X3JlYWRfdmFyaWFibGVfdTMyX2FycmF5KGNvbnN0IHN0cnVjdCBkZXZpY2Vfbm9kZSAqbnAs
CiAgICAgY29uc3QgY2hhciAqcHJvcG5hbWUsCiAgICAgdTMyICpvdXRfdmFsdWVzLAogICAg
IHNpemVfdCBzel9taW4sCiAgICAgc2l6ZV90IHN6X21heCk7CmV4dGVybiBpbnQgb2ZfcHJv
cGVydHlfcmVhZF91NjQoY29uc3Qgc3RydWN0IGRldmljZV9ub2RlICpucCwKICAgIGNvbnN0
IGNoYXIgKnByb3BuYW1lLCB1NjQgKm91dF92YWx1ZSk7CmV4dGVybiBpbnQgb2ZfcHJvcGVy
dHlfcmVhZF92YXJpYWJsZV91NjRfYXJyYXkoY29uc3Qgc3RydWN0IGRldmljZV9ub2RlICpu
cCwKICAgICBjb25zdCBjaGFyICpwcm9wbmFtZSwKICAgICB1NjQgKm91dF92YWx1ZXMsCiAg
ICAgc2l6ZV90IHN6X21pbiwKICAgICBzaXplX3Qgc3pfbWF4KTsKCmV4dGVybiBpbnQgb2Zf
cHJvcGVydHlfcmVhZF9zdHJpbmcoY29uc3Qgc3RydWN0IGRldmljZV9ub2RlICpucCwKICAg
ICAgIGNvbnN0IGNoYXIgKnByb3BuYW1lLAogICAgICAgY29uc3QgY2hhciAqKm91dF9zdHJp
bmcpOwpleHRlcm4gaW50IG9mX3Byb3BlcnR5X21hdGNoX3N0cmluZyhjb25zdCBzdHJ1Y3Qg
ZGV2aWNlX25vZGUgKm5wLAogICAgICAgIGNvbnN0IGNoYXIgKnByb3BuYW1lLAogICAgICAg
IGNvbnN0IGNoYXIgKnN0cmluZyk7CmV4dGVybiBpbnQgb2ZfcHJvcGVydHlfcmVhZF9zdHJp
bmdfaGVscGVyKGNvbnN0IHN0cnVjdCBkZXZpY2Vfbm9kZSAqbnAsCiAgICAgICAgICAgY29u
c3QgY2hhciAqcHJvcG5hbWUsCiAgICAgICAgICAgY29uc3QgY2hhciAqKm91dF9zdHJzLCBz
aXplX3Qgc3osIGludCBpbmRleCk7CmV4dGVybiBpbnQgb2ZfZGV2aWNlX2lzX2NvbXBhdGli
bGUoY29uc3Qgc3RydWN0IGRldmljZV9ub2RlICpkZXZpY2UsCiAgICAgICBjb25zdCBjaGFy
ICopOwpleHRlcm4gaW50IG9mX2RldmljZV9jb21wYXRpYmxlX21hdGNoKHN0cnVjdCBkZXZp
Y2Vfbm9kZSAqZGV2aWNlLAogICAgICAgICAgY29uc3QgY2hhciAqY29uc3QgKmNvbXBhdCk7
CmV4dGVybiBib29sIG9mX2RldmljZV9pc19hdmFpbGFibGUoY29uc3Qgc3RydWN0IGRldmlj
ZV9ub2RlICpkZXZpY2UpOwpleHRlcm4gYm9vbCBvZl9kZXZpY2VfaXNfYmlnX2VuZGlhbihj
b25zdCBzdHJ1Y3QgZGV2aWNlX25vZGUgKmRldmljZSk7CmV4dGVybiBjb25zdCB2b2lkICpv
Zl9nZXRfcHJvcGVydHkoY29uc3Qgc3RydWN0IGRldmljZV9ub2RlICpub2RlLAogICAgY29u
c3QgY2hhciAqbmFtZSwKICAgIGludCAqbGVucCk7CmV4dGVybiBzdHJ1Y3QgZGV2aWNlX25v
ZGUgKm9mX2dldF9jcHVfbm9kZShpbnQgY3B1LCB1bnNpZ25lZCBpbnQgKnRocmVhZCk7CmV4
dGVybiBzdHJ1Y3QgZGV2aWNlX25vZGUgKm9mX2dldF9uZXh0X2NwdV9ub2RlKHN0cnVjdCBk
ZXZpY2Vfbm9kZSAqcHJldik7CmV4dGVybiBzdHJ1Y3QgZGV2aWNlX25vZGUgKm9mX2dldF9j
cHVfc3RhdGVfbm9kZShzdHJ1Y3QgZGV2aWNlX25vZGUgKmNwdV9ub2RlLAogICAgICAgaW50
IGluZGV4KTsKCgoKCmV4dGVybiBpbnQgb2Zfbl9hZGRyX2NlbGxzKHN0cnVjdCBkZXZpY2Vf
bm9kZSAqbnApOwpleHRlcm4gaW50IG9mX25fc2l6ZV9jZWxscyhzdHJ1Y3QgZGV2aWNlX25v
ZGUgKm5wKTsKZXh0ZXJuIGNvbnN0IHN0cnVjdCBvZl9kZXZpY2VfaWQgKm9mX21hdGNoX25v
ZGUoCiBjb25zdCBzdHJ1Y3Qgb2ZfZGV2aWNlX2lkICptYXRjaGVzLCBjb25zdCBzdHJ1Y3Qg
ZGV2aWNlX25vZGUgKm5vZGUpOwpleHRlcm4gaW50IG9mX21vZGFsaWFzX25vZGUoc3RydWN0
IGRldmljZV9ub2RlICpub2RlLCBjaGFyICptb2RhbGlhcywgaW50IGxlbik7CmV4dGVybiB2
b2lkIG9mX3ByaW50X3BoYW5kbGVfYXJncyhjb25zdCBjaGFyICptc2csIGNvbnN0IHN0cnVj
dCBvZl9waGFuZGxlX2FyZ3MgKmFyZ3MpOwpleHRlcm4gc3RydWN0IGRldmljZV9ub2RlICpv
Zl9wYXJzZV9waGFuZGxlKGNvbnN0IHN0cnVjdCBkZXZpY2Vfbm9kZSAqbnAsCiAgICAgICAg
IGNvbnN0IGNoYXIgKnBoYW5kbGVfbmFtZSwKICAgICAgICAgaW50IGluZGV4KTsKZXh0ZXJu
IGludCBvZl9wYXJzZV9waGFuZGxlX3dpdGhfYXJncyhjb25zdCBzdHJ1Y3QgZGV2aWNlX25v
ZGUgKm5wLAogY29uc3QgY2hhciAqbGlzdF9uYW1lLCBjb25zdCBjaGFyICpjZWxsc19uYW1l
LCBpbnQgaW5kZXgsCiBzdHJ1Y3Qgb2ZfcGhhbmRsZV9hcmdzICpvdXRfYXJncyk7CmV4dGVy
biBpbnQgb2ZfcGFyc2VfcGhhbmRsZV93aXRoX2FyZ3NfbWFwKGNvbnN0IHN0cnVjdCBkZXZp
Y2Vfbm9kZSAqbnAsCiBjb25zdCBjaGFyICpsaXN0X25hbWUsIGNvbnN0IGNoYXIgKnN0ZW1f
bmFtZSwgaW50IGluZGV4LAogc3RydWN0IG9mX3BoYW5kbGVfYXJncyAqb3V0X2FyZ3MpOwpl
eHRlcm4gaW50IG9mX3BhcnNlX3BoYW5kbGVfd2l0aF9maXhlZF9hcmdzKGNvbnN0IHN0cnVj
dCBkZXZpY2Vfbm9kZSAqbnAsCiBjb25zdCBjaGFyICpsaXN0X25hbWUsIGludCBjZWxsc19j
b3VudCwgaW50IGluZGV4LAogc3RydWN0IG9mX3BoYW5kbGVfYXJncyAqb3V0X2FyZ3MpOwpl
eHRlcm4gaW50IG9mX2NvdW50X3BoYW5kbGVfd2l0aF9hcmdzKGNvbnN0IHN0cnVjdCBkZXZp
Y2Vfbm9kZSAqbnAsCiBjb25zdCBjaGFyICpsaXN0X25hbWUsIGNvbnN0IGNoYXIgKmNlbGxz
X25hbWUpOwoKCmV4dGVybiBpbnQgb2ZfcGhhbmRsZV9pdGVyYXRvcl9pbml0KHN0cnVjdCBv
Zl9waGFuZGxlX2l0ZXJhdG9yICppdCwKICAgICAgICBjb25zdCBzdHJ1Y3QgZGV2aWNlX25v
ZGUgKm5wLAogICAgICAgIGNvbnN0IGNoYXIgKmxpc3RfbmFtZSwKICAgICAgICBjb25zdCBj
aGFyICpjZWxsc19uYW1lLAogICAgICAgIGludCBjZWxsX2NvdW50KTsKCmV4dGVybiBpbnQg
b2ZfcGhhbmRsZV9pdGVyYXRvcl9uZXh0KHN0cnVjdCBvZl9waGFuZGxlX2l0ZXJhdG9yICpp
dCk7CmV4dGVybiBpbnQgb2ZfcGhhbmRsZV9pdGVyYXRvcl9hcmdzKHN0cnVjdCBvZl9waGFu
ZGxlX2l0ZXJhdG9yICppdCwKICAgICAgICB1aW50MzJfdCAqYXJncywKICAgICAgICBpbnQg
c2l6ZSk7CgpleHRlcm4gdm9pZCBvZl9hbGlhc19zY2FuKHZvaWQgKiAoKmR0X2FsbG9jKSh1
NjQgc2l6ZSwgdTY0IGFsaWduKSk7CmV4dGVybiBpbnQgb2ZfYWxpYXNfZ2V0X2lkKHN0cnVj
dCBkZXZpY2Vfbm9kZSAqbnAsIGNvbnN0IGNoYXIgKnN0ZW0pOwpleHRlcm4gaW50IG9mX2Fs
aWFzX2dldF9oaWdoZXN0X2lkKGNvbnN0IGNoYXIgKnN0ZW0pOwpleHRlcm4gaW50IG9mX2Fs
aWFzX2dldF9hbGlhc19saXN0KGNvbnN0IHN0cnVjdCBvZl9kZXZpY2VfaWQgKm1hdGNoZXMs
CiAgICAgICBjb25zdCBjaGFyICpzdGVtLCB1bnNpZ25lZCBsb25nICpiaXRtYXAsCiAgICAg
ICB1bnNpZ25lZCBpbnQgbmJpdHMpOwoKZXh0ZXJuIGludCBvZl9tYWNoaW5lX2lzX2NvbXBh
dGlibGUoY29uc3QgY2hhciAqY29tcGF0KTsKCmV4dGVybiBpbnQgb2ZfYWRkX3Byb3BlcnR5
KHN0cnVjdCBkZXZpY2Vfbm9kZSAqbnAsIHN0cnVjdCBwcm9wZXJ0eSAqcHJvcCk7CmV4dGVy
biBpbnQgb2ZfcmVtb3ZlX3Byb3BlcnR5KHN0cnVjdCBkZXZpY2Vfbm9kZSAqbnAsIHN0cnVj
dCBwcm9wZXJ0eSAqcHJvcCk7CmV4dGVybiBpbnQgb2ZfdXBkYXRlX3Byb3BlcnR5KHN0cnVj
dCBkZXZpY2Vfbm9kZSAqbnAsIHN0cnVjdCBwcm9wZXJ0eSAqbmV3cHJvcCk7CiMgNDEzICIu
L2luY2x1ZGUvbGludXgvb2YuaCIKZXh0ZXJuIGludCBvZl9hdHRhY2hfbm9kZShzdHJ1Y3Qg
ZGV2aWNlX25vZGUgKik7CmV4dGVybiBpbnQgb2ZfZGV0YWNoX25vZGUoc3RydWN0IGRldmlj
ZV9ub2RlICopOwojIDQzNiAiLi9pbmNsdWRlL2xpbnV4L29mLmgiCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQg
b2ZfcHJvcGVydHlfcmVhZF91OF9hcnJheShjb25zdCBzdHJ1Y3QgZGV2aWNlX25vZGUgKm5w
LAogICAgICAgICBjb25zdCBjaGFyICpwcm9wbmFtZSwKICAgICAgICAgdTggKm91dF92YWx1
ZXMsIHNpemVfdCBzeikKewogaW50IHJldCA9IG9mX3Byb3BlcnR5X3JlYWRfdmFyaWFibGVf
dThfYXJyYXkobnAsIHByb3BuYW1lLCBvdXRfdmFsdWVzLAogICAgICAgICAgIHN6LCAwKTsK
IGlmIChyZXQgPj0gMCkKICByZXR1cm4gMDsKIGVsc2UKICByZXR1cm4gcmV0Owp9CiMgNDY2
ICIuL2luY2x1ZGUvbGludXgvb2YuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBvZl9wcm9wZXJ0eV9yZWFk
X3UxNl9hcnJheShjb25zdCBzdHJ1Y3QgZGV2aWNlX25vZGUgKm5wLAogICAgICAgICAgY29u
c3QgY2hhciAqcHJvcG5hbWUsCiAgICAgICAgICB1MTYgKm91dF92YWx1ZXMsIHNpemVfdCBz
eikKewogaW50IHJldCA9IG9mX3Byb3BlcnR5X3JlYWRfdmFyaWFibGVfdTE2X2FycmF5KG5w
LCBwcm9wbmFtZSwgb3V0X3ZhbHVlcywKICAgICAgICAgICAgc3osIDApOwogaWYgKHJldCA+
PSAwKQogIHJldHVybiAwOwogZWxzZQogIHJldHVybiByZXQ7Cn0KIyA0OTQgIi4vaW5jbHVk
ZS9saW51eC9vZi5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IG9mX3Byb3BlcnR5X3JlYWRfdTMyX2FycmF5
KGNvbnN0IHN0cnVjdCBkZXZpY2Vfbm9kZSAqbnAsCiAgICAgICAgICBjb25zdCBjaGFyICpw
cm9wbmFtZSwKICAgICAgICAgIHUzMiAqb3V0X3ZhbHVlcywgc2l6ZV90IHN6KQp7CiBpbnQg
cmV0ID0gb2ZfcHJvcGVydHlfcmVhZF92YXJpYWJsZV91MzJfYXJyYXkobnAsIHByb3BuYW1l
LCBvdXRfdmFsdWVzLAogICAgICAgICAgICBzeiwgMCk7CiBpZiAocmV0ID49IDApCiAgcmV0
dXJuIDA7CiBlbHNlCiAgcmV0dXJuIHJldDsKfQojIDUyMiAiLi9pbmNsdWRlL2xpbnV4L29m
LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSBpbnQgb2ZfcHJvcGVydHlfcmVhZF91NjRfYXJyYXkoY29uc3Qgc3Ry
dWN0IGRldmljZV9ub2RlICpucCwKICAgICAgICAgIGNvbnN0IGNoYXIgKnByb3BuYW1lLAog
ICAgICAgICAgdTY0ICpvdXRfdmFsdWVzLCBzaXplX3Qgc3opCnsKIGludCByZXQgPSBvZl9w
cm9wZXJ0eV9yZWFkX3ZhcmlhYmxlX3U2NF9hcnJheShucCwgcHJvcG5hbWUsIG91dF92YWx1
ZXMsCiAgICAgICAgICAgIHN6LCAwKTsKIGlmIChyZXQgPj0gMCkKICByZXR1cm4gMDsKIGVs
c2UKICByZXR1cm4gcmV0Owp9CiMgNTQyICIuL2luY2x1ZGUvbGludXgvb2YuaCIKY29uc3Qg
X19iZTMyICpvZl9wcm9wX25leHRfdTMyKHN0cnVjdCBwcm9wZXJ0eSAqcHJvcCwgY29uc3Qg
X19iZTMyICpjdXIsCiAgICAgICAgICB1MzIgKnB1KTsKCgoKCgoKCmNvbnN0IGNoYXIgKm9m
X3Byb3BfbmV4dF9zdHJpbmcoc3RydWN0IHByb3BlcnR5ICpwcm9wLCBjb25zdCBjaGFyICpj
dXIpOwoKYm9vbCBvZl9jb25zb2xlX2NoZWNrKHN0cnVjdCBkZXZpY2Vfbm9kZSAqZG4sIGNo
YXIgKm5hbWUsIGludCBpbmRleCk7CgpleHRlcm4gaW50IG9mX2NwdV9ub2RlX3RvX2lkKHN0
cnVjdCBkZXZpY2Vfbm9kZSAqbnApOwoKaW50IG9mX21hcF9yaWQoc3RydWN0IGRldmljZV9u
b2RlICpucCwgdTMyIHJpZCwKICAgICAgICBjb25zdCBjaGFyICptYXBfbmFtZSwgY29uc3Qg
Y2hhciAqbWFwX21hc2tfbmFtZSwKICAgICAgICBzdHJ1Y3QgZGV2aWNlX25vZGUgKip0YXJn
ZXQsIHUzMiAqaWRfb3V0KTsKIyA5OTkgIi4vaW5jbHVkZS9saW51eC9vZi5oIgpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgaW50IG9mX3Byb3BfdmFsX2VxKHN0cnVjdCBwcm9wZXJ0eSAqcDEsIHN0cnVjdCBwcm9w
ZXJ0eSAqcDIpCnsKIHJldHVybiBwMS0+bGVuZ3RoID09IHAyLT5sZW5ndGggJiYKICAgICAg
ICAhbWVtY21wKHAxLT52YWx1ZSwgcDItPnZhbHVlLCAoc2l6ZV90KXAxLT5sZW5ndGgpOwp9
CgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgaW50IG9mX25vZGVfdG9fbmlkKHN0cnVjdCBkZXZpY2Vfbm9kZSAq
ZGV2aWNlKQp7CiByZXR1cm4gKC0xKTsKfQoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgb2ZfbnVtYV9p
bml0KHZvaWQpCnsKIHJldHVybiAtMzg7Cn0KCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IGRldmljZV9u
b2RlICpvZl9maW5kX21hdGNoaW5nX25vZGUoCiBzdHJ1Y3QgZGV2aWNlX25vZGUgKmZyb20s
CiBjb25zdCBzdHJ1Y3Qgb2ZfZGV2aWNlX2lkICptYXRjaGVzKQp7CiByZXR1cm4gb2ZfZmlu
ZF9tYXRjaGluZ19ub2RlX2FuZF9tYXRjaChmcm9tLCBtYXRjaGVzLCAoKHZvaWQgKikwKSk7
Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSBjb25zdCBjaGFyICpvZl9ub2RlX2dldF9kZXZpY2VfdHlwZShjb25z
dCBzdHJ1Y3QgZGV2aWNlX25vZGUgKm5wKQp7CiByZXR1cm4gb2ZfZ2V0X3Byb3BlcnR5KG5w
LCAiZGV2aWNlX3R5cGUiLCAoKHZvaWQgKikwKSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIG9mX25v
ZGVfaXNfdHlwZShjb25zdCBzdHJ1Y3QgZGV2aWNlX25vZGUgKm5wLCBjb25zdCBjaGFyICp0
eXBlKQp7CiBjb25zdCBjaGFyICptYXRjaCA9IG9mX25vZGVfZ2V0X2RldmljZV90eXBlKG5w
KTsKCiByZXR1cm4gbnAgJiYgbWF0Y2ggJiYgdHlwZSAmJiAhc3RyY21wKG1hdGNoLCB0eXBl
KTsKfQojIDEwNTMgIi4vaW5jbHVkZS9saW51eC9vZi5oIgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IG9mX3By
b3BlcnR5X2NvdW50X3U4X2VsZW1zKGNvbnN0IHN0cnVjdCBkZXZpY2Vfbm9kZSAqbnAsCiAg
ICBjb25zdCBjaGFyICpwcm9wbmFtZSkKewogcmV0dXJuIG9mX3Byb3BlcnR5X2NvdW50X2Vs
ZW1zX29mX3NpemUobnAsIHByb3BuYW1lLCBzaXplb2YodTgpKTsKfQojIDEwNzAgIi4vaW5j
bHVkZS9saW51eC9vZi5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IG9mX3Byb3BlcnR5X2NvdW50X3UxNl9l
bGVtcyhjb25zdCBzdHJ1Y3QgZGV2aWNlX25vZGUgKm5wLAogICAgY29uc3QgY2hhciAqcHJv
cG5hbWUpCnsKIHJldHVybiBvZl9wcm9wZXJ0eV9jb3VudF9lbGVtc19vZl9zaXplKG5wLCBw
cm9wbmFtZSwgc2l6ZW9mKHUxNikpOwp9CiMgMTA4NyAiLi9pbmNsdWRlL2xpbnV4L29mLmgi
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSBpbnQgb2ZfcHJvcGVydHlfY291bnRfdTMyX2VsZW1zKGNvbnN0IHN0cnVj
dCBkZXZpY2Vfbm9kZSAqbnAsCiAgICBjb25zdCBjaGFyICpwcm9wbmFtZSkKewogcmV0dXJu
IG9mX3Byb3BlcnR5X2NvdW50X2VsZW1zX29mX3NpemUobnAsIHByb3BuYW1lLCBzaXplb2Yo
dTMyKSk7Cn0KIyAxMTA0ICIuL2luY2x1ZGUvbGludXgvb2YuaCIKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBv
Zl9wcm9wZXJ0eV9jb3VudF91NjRfZWxlbXMoY29uc3Qgc3RydWN0IGRldmljZV9ub2RlICpu
cCwKICAgIGNvbnN0IGNoYXIgKnByb3BuYW1lKQp7CiByZXR1cm4gb2ZfcHJvcGVydHlfY291
bnRfZWxlbXNfb2Zfc2l6ZShucCwgcHJvcG5hbWUsIHNpemVvZih1NjQpKTsKfQojIDExMjMg
Ii4vaW5jbHVkZS9saW51eC9vZi5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IG9mX3Byb3BlcnR5X3JlYWRf
c3RyaW5nX2FycmF5KGNvbnN0IHN0cnVjdCBkZXZpY2Vfbm9kZSAqbnAsCiAgICAgIGNvbnN0
IGNoYXIgKnByb3BuYW1lLCBjb25zdCBjaGFyICoqb3V0X3N0cnMsCiAgICAgIHNpemVfdCBz
eikKewogcmV0dXJuIG9mX3Byb3BlcnR5X3JlYWRfc3RyaW5nX2hlbHBlcihucCwgcHJvcG5h
bWUsIG91dF9zdHJzLCBzeiwgMCk7Cn0KIyAxMTQyICIuL2luY2x1ZGUvbGludXgvb2YuaCIK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIGludCBvZl9wcm9wZXJ0eV9jb3VudF9zdHJpbmdzKGNvbnN0IHN0cnVjdCBk
ZXZpY2Vfbm9kZSAqbnAsCiAgICAgICAgIGNvbnN0IGNoYXIgKnByb3BuYW1lKQp7CiByZXR1
cm4gb2ZfcHJvcGVydHlfcmVhZF9zdHJpbmdfaGVscGVyKG5wLCBwcm9wbmFtZSwgKCh2b2lk
ICopMCksIDAsIDApOwp9CiMgMTE2NiAiLi9pbmNsdWRlL2xpbnV4L29mLmgiCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBpbnQgb2ZfcHJvcGVydHlfcmVhZF9zdHJpbmdfaW5kZXgoY29uc3Qgc3RydWN0IGRldmlj
ZV9ub2RlICpucCwKICAgICAgY29uc3QgY2hhciAqcHJvcG5hbWUsCiAgICAgIGludCBpbmRl
eCwgY29uc3QgY2hhciAqKm91dHB1dCkKewogaW50IHJjID0gb2ZfcHJvcGVydHlfcmVhZF9z
dHJpbmdfaGVscGVyKG5wLCBwcm9wbmFtZSwgb3V0cHV0LCAxLCBpbmRleCk7CiByZXR1cm4g
cmMgPCAwID8gcmMgOiAwOwp9CiMgMTE4MiAiLi9pbmNsdWRlL2xpbnV4L29mLmgiCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBib29sIG9mX3Byb3BlcnR5X3JlYWRfYm9vbChjb25zdCBzdHJ1Y3QgZGV2aWNlX25v
ZGUgKm5wLAogICAgICBjb25zdCBjaGFyICpwcm9wbmFtZSkKewogc3RydWN0IHByb3BlcnR5
ICpwcm9wID0gb2ZfZmluZF9wcm9wZXJ0eShucCwgcHJvcG5hbWUsICgodm9pZCAqKTApKTsK
CiByZXR1cm4gcHJvcCA/IHRydWUgOiBmYWxzZTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBvZl9wcm9w
ZXJ0eV9yZWFkX3U4KGNvbnN0IHN0cnVjdCBkZXZpY2Vfbm9kZSAqbnAsCiAgICAgICAgICAg
Y29uc3QgY2hhciAqcHJvcG5hbWUsCiAgICAgICAgICAgdTggKm91dF92YWx1ZSkKewogcmV0
dXJuIG9mX3Byb3BlcnR5X3JlYWRfdThfYXJyYXkobnAsIHByb3BuYW1lLCBvdXRfdmFsdWUs
IDEpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgaW50IG9mX3Byb3BlcnR5X3JlYWRfdTE2KGNvbnN0IHN0cnVj
dCBkZXZpY2Vfbm9kZSAqbnAsCiAgICAgICAgICAgY29uc3QgY2hhciAqcHJvcG5hbWUsCiAg
ICAgICAgICAgdTE2ICpvdXRfdmFsdWUpCnsKIHJldHVybiBvZl9wcm9wZXJ0eV9yZWFkX3Ux
Nl9hcnJheShucCwgcHJvcG5hbWUsIG91dF92YWx1ZSwgMSk7Cn0KCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQg
b2ZfcHJvcGVydHlfcmVhZF91MzIoY29uc3Qgc3RydWN0IGRldmljZV9ub2RlICpucCwKICAg
ICAgICAgICBjb25zdCBjaGFyICpwcm9wbmFtZSwKICAgICAgICAgICB1MzIgKm91dF92YWx1
ZSkKewogcmV0dXJuIG9mX3Byb3BlcnR5X3JlYWRfdTMyX2FycmF5KG5wLCBwcm9wbmFtZSwg
b3V0X3ZhbHVlLCAxKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBvZl9wcm9wZXJ0eV9yZWFkX3MzMihj
b25zdCBzdHJ1Y3QgZGV2aWNlX25vZGUgKm5wLAogICAgICAgICAgIGNvbnN0IGNoYXIgKnBy
b3BuYW1lLAogICAgICAgICAgIHMzMiAqb3V0X3ZhbHVlKQp7CiByZXR1cm4gb2ZfcHJvcGVy
dHlfcmVhZF91MzIobnAsIHByb3BuYW1lLCAodTMyKikgb3V0X3ZhbHVlKTsKfQojIDEyNjcg
Ii4vaW5jbHVkZS9saW51eC9vZi5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IG9mX2dldF9jaGlsZF9jb3Vu
dChjb25zdCBzdHJ1Y3QgZGV2aWNlX25vZGUgKm5wKQp7CiBzdHJ1Y3QgZGV2aWNlX25vZGUg
KmNoaWxkOwogaW50IG51bSA9IDA7CgogZm9yIChjaGlsZCA9IG9mX2dldF9uZXh0X2NoaWxk
KG5wLCAoKHZvaWQgKikwKSk7IGNoaWxkICE9ICgodm9pZCAqKTApOyBjaGlsZCA9IG9mX2dl
dF9uZXh0X2NoaWxkKG5wLCBjaGlsZCkpCiAgbnVtKys7CgogcmV0dXJuIG51bTsKfQoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIGludCBvZl9nZXRfYXZhaWxhYmxlX2NoaWxkX2NvdW50KGNvbnN0IHN0cnVjdCBk
ZXZpY2Vfbm9kZSAqbnApCnsKIHN0cnVjdCBkZXZpY2Vfbm9kZSAqY2hpbGQ7CiBpbnQgbnVt
ID0gMDsKCiBmb3IgKGNoaWxkID0gb2ZfZ2V0X25leHRfYXZhaWxhYmxlX2NoaWxkKG5wLCAo
KHZvaWQgKikwKSk7IGNoaWxkICE9ICgodm9pZCAqKTApOyBjaGlsZCA9IG9mX2dldF9uZXh0
X2F2YWlsYWJsZV9jaGlsZChucCwgY2hpbGQpKQogIG51bSsrOwoKIHJldHVybiBudW07Cn0K
IyAxMzAzICIuL2luY2x1ZGUvbGludXgvb2YuaCIKdHlwZWRlZiBpbnQgKCpvZl9pbml0X2Zu
XzIpKHN0cnVjdCBkZXZpY2Vfbm9kZSAqLCBzdHJ1Y3QgZGV2aWNlX25vZGUgKik7CnR5cGVk
ZWYgaW50ICgqb2ZfaW5pdF9mbl8xX3JldCkoc3RydWN0IGRldmljZV9ub2RlICopOwp0eXBl
ZGVmIHZvaWQgKCpvZl9pbml0X2ZuXzEpKHN0cnVjdCBkZXZpY2Vfbm9kZSAqKTsKIyAxMzI4
ICIuL2luY2x1ZGUvbGludXgvb2YuaCIKc3RydWN0IG9mX2NoYW5nZXNldF9lbnRyeSB7CiBz
dHJ1Y3QgbGlzdF9oZWFkIG5vZGU7CiB1bnNpZ25lZCBsb25nIGFjdGlvbjsKIHN0cnVjdCBk
ZXZpY2Vfbm9kZSAqbnA7CiBzdHJ1Y3QgcHJvcGVydHkgKnByb3A7CiBzdHJ1Y3QgcHJvcGVy
dHkgKm9sZF9wcm9wOwp9OwojIDEzNDYgIi4vaW5jbHVkZS9saW51eC9vZi5oIgpzdHJ1Y3Qg
b2ZfY2hhbmdlc2V0IHsKIHN0cnVjdCBsaXN0X2hlYWQgZW50cmllczsKfTsKCmVudW0gb2Zf
cmVjb25maWdfY2hhbmdlIHsKIE9GX1JFQ09ORklHX05PX0NIQU5HRSA9IDAsCiBPRl9SRUNP
TkZJR19DSEFOR0VfQURELAogT0ZfUkVDT05GSUdfQ0hBTkdFX1JFTU9WRSwKfTsKIyAxNDAx
ICIuL2luY2x1ZGUvbGludXgvb2YuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBvZl9yZWNvbmZpZ19ub3Rp
Zmllcl9yZWdpc3RlcihzdHJ1Y3Qgbm90aWZpZXJfYmxvY2sgKm5iKQp7CiByZXR1cm4gLTIy
Owp9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSBpbnQgb2ZfcmVjb25maWdfbm90aWZpZXJfdW5yZWdpc3RlcihzdHJ1
Y3Qgbm90aWZpZXJfYmxvY2sgKm5iKQp7CiByZXR1cm4gLTIyOwp9CnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQg
b2ZfcmVjb25maWdfbm90aWZ5KHVuc2lnbmVkIGxvbmcgYWN0aW9uLAogICAgICAgICBzdHJ1
Y3Qgb2ZfcmVjb25maWdfZGF0YSAqYXJnKQp7CiByZXR1cm4gLTIyOwp9CnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBp
bnQgb2ZfcmVjb25maWdfZ2V0X3N0YXRlX2NoYW5nZSh1bnNpZ25lZCBsb25nIGFjdGlvbiwK
ICAgICAgc3RydWN0IG9mX3JlY29uZmlnX2RhdGEgKmFyZykKewogcmV0dXJuIC0yMjsKfQoj
IDE0MjcgIi4vaW5jbHVkZS9saW51eC9vZi5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBvZl9kZXZpY2Vf
aXNfc3lzdGVtX3Bvd2VyX2NvbnRyb2xsZXIoY29uc3Qgc3RydWN0IGRldmljZV9ub2RlICpu
cCkKewogcmV0dXJuIG9mX3Byb3BlcnR5X3JlYWRfYm9vbChucCwgInN5c3RlbS1wb3dlci1j
b250cm9sbGVyIik7Cn0KCgoKCgplbnVtIG9mX292ZXJsYXlfbm90aWZ5X2FjdGlvbiB7CiBP
Rl9PVkVSTEFZX1BSRV9BUFBMWSA9IDAsCiBPRl9PVkVSTEFZX1BPU1RfQVBQTFksCiBPRl9P
VkVSTEFZX1BSRV9SRU1PVkUsCiBPRl9PVkVSTEFZX1BPU1RfUkVNT1ZFLAp9OwoKc3RydWN0
IG9mX292ZXJsYXlfbm90aWZ5X2RhdGEgewogc3RydWN0IGRldmljZV9ub2RlICpvdmVybGF5
Owogc3RydWN0IGRldmljZV9ub2RlICp0YXJnZXQ7Cn07CiMgMTQ2MCAiLi9pbmNsdWRlL2xp
bnV4L29mLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgb2Zfb3ZlcmxheV9mZHRfYXBwbHkodm9pZCAqb3Zl
cmxheV9mZHQsIHUzMiBvdmVybGF5X2ZkdF9zaXplLAogICAgICAgICAgIGludCAqb3Zjc19p
ZCkKewogcmV0dXJuIC01MjQ7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgb2Zfb3ZlcmxheV9yZW1vdmUo
aW50ICpvdmNzX2lkKQp7CiByZXR1cm4gLTUyNDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBvZl9vdmVy
bGF5X3JlbW92ZV9hbGwodm9pZCkKewogcmV0dXJuIC01MjQ7Cn0KCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQg
b2Zfb3ZlcmxheV9ub3RpZmllcl9yZWdpc3RlcihzdHJ1Y3Qgbm90aWZpZXJfYmxvY2sgKm5i
KQp7CiByZXR1cm4gMDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBvZl9vdmVybGF5X25vdGlmaWVyX3Vu
cmVnaXN0ZXIoc3RydWN0IG5vdGlmaWVyX2Jsb2NrICpuYikKewogcmV0dXJuIDA7Cn0KIyAz
NiAiLi9pbmNsdWRlL2xpbnV4L2lycWRvbWFpbi5oIiAyCgoKCnN0cnVjdCBkZXZpY2Vfbm9k
ZTsKc3RydWN0IGlycV9kb21haW47CnN0cnVjdCBvZl9kZXZpY2VfaWQ7CnN0cnVjdCBpcnFf
Y2hpcDsKc3RydWN0IGlycV9kYXRhOwpzdHJ1Y3QgY3B1bWFzazsKc3RydWN0IHNlcV9maWxl
OwpzdHJ1Y3QgaXJxX2FmZmluaXR5X2Rlc2M7CiMgNjMgIi4vaW5jbHVkZS9saW51eC9pcnFk
b21haW4uaCIKc3RydWN0IGlycV9md3NwZWMgewogc3RydWN0IGZ3bm9kZV9oYW5kbGUgKmZ3
bm9kZTsKIGludCBwYXJhbV9jb3VudDsKIHUzMiBwYXJhbVsxNl07Cn07CiMgNzYgIi4vaW5j
bHVkZS9saW51eC9pcnFkb21haW4uaCIKZW51bSBpcnFfZG9tYWluX2J1c190b2tlbiB7CiBE
T01BSU5fQlVTX0FOWSA9IDAsCiBET01BSU5fQlVTX1dJUkVELAogRE9NQUlOX0JVU19HRU5F
UklDX01TSSwKIERPTUFJTl9CVVNfUENJX01TSSwKIERPTUFJTl9CVVNfUExBVEZPUk1fTVNJ
LAogRE9NQUlOX0JVU19ORVhVUywKIERPTUFJTl9CVVNfSVBJLAogRE9NQUlOX0JVU19GU0xf
TUNfTVNJLAogRE9NQUlOX0JVU19USV9TQ0lfSU5UQV9NU0ksCiBET01BSU5fQlVTX1dBS0VV
UCwKfTsKIyAxMDQgIi4vaW5jbHVkZS9saW51eC9pcnFkb21haW4uaCIKc3RydWN0IGlycV9k
b21haW5fb3BzIHsKIGludCAoKm1hdGNoKShzdHJ1Y3QgaXJxX2RvbWFpbiAqZCwgc3RydWN0
IGRldmljZV9ub2RlICpub2RlLAogICAgICAgZW51bSBpcnFfZG9tYWluX2J1c190b2tlbiBi
dXNfdG9rZW4pOwogaW50ICgqc2VsZWN0KShzdHJ1Y3QgaXJxX2RvbWFpbiAqZCwgc3RydWN0
IGlycV9md3NwZWMgKmZ3c3BlYywKICAgICAgICBlbnVtIGlycV9kb21haW5fYnVzX3Rva2Vu
IGJ1c190b2tlbik7CiBpbnQgKCptYXApKHN0cnVjdCBpcnFfZG9tYWluICpkLCB1bnNpZ25l
ZCBpbnQgdmlycSwgaXJxX2h3X251bWJlcl90IGh3KTsKIHZvaWQgKCp1bm1hcCkoc3RydWN0
IGlycV9kb21haW4gKmQsIHVuc2lnbmVkIGludCB2aXJxKTsKIGludCAoKnhsYXRlKShzdHJ1
Y3QgaXJxX2RvbWFpbiAqZCwgc3RydWN0IGRldmljZV9ub2RlICpub2RlLAogICAgICAgY29u
c3QgdTMyICppbnRzcGVjLCB1bnNpZ25lZCBpbnQgaW50c2l6ZSwKICAgICAgIHVuc2lnbmVk
IGxvbmcgKm91dF9od2lycSwgdW5zaWduZWQgaW50ICpvdXRfdHlwZSk7CgoKIGludCAoKmFs
bG9jKShzdHJ1Y3QgaXJxX2RvbWFpbiAqZCwgdW5zaWduZWQgaW50IHZpcnEsCiAgICAgICB1
bnNpZ25lZCBpbnQgbnJfaXJxcywgdm9pZCAqYXJnKTsKIHZvaWQgKCpmcmVlKShzdHJ1Y3Qg
aXJxX2RvbWFpbiAqZCwgdW5zaWduZWQgaW50IHZpcnEsCiAgICAgICB1bnNpZ25lZCBpbnQg
bnJfaXJxcyk7CiBpbnQgKCphY3RpdmF0ZSkoc3RydWN0IGlycV9kb21haW4gKmQsIHN0cnVj
dCBpcnFfZGF0YSAqaXJxZCwgYm9vbCByZXNlcnZlKTsKIHZvaWQgKCpkZWFjdGl2YXRlKShz
dHJ1Y3QgaXJxX2RvbWFpbiAqZCwgc3RydWN0IGlycV9kYXRhICppcnFfZGF0YSk7CiBpbnQg
KCp0cmFuc2xhdGUpKHN0cnVjdCBpcnFfZG9tYWluICpkLCBzdHJ1Y3QgaXJxX2Z3c3BlYyAq
ZndzcGVjLAogICAgdW5zaWduZWQgbG9uZyAqb3V0X2h3aXJxLCB1bnNpZ25lZCBpbnQgKm91
dF90eXBlKTsKCgoKCgp9OwoKZXh0ZXJuIHN0cnVjdCBpcnFfZG9tYWluX29wcyBpcnFfZ2Vu
ZXJpY19jaGlwX29wczsKCnN0cnVjdCBpcnFfZG9tYWluX2NoaXBfZ2VuZXJpYzsKIyAxNjEg
Ii4vaW5jbHVkZS9saW51eC9pcnFkb21haW4uaCIKc3RydWN0IGlycV9kb21haW4gewogc3Ry
dWN0IGxpc3RfaGVhZCBsaW5rOwogY29uc3QgY2hhciAqbmFtZTsKIGNvbnN0IHN0cnVjdCBp
cnFfZG9tYWluX29wcyAqb3BzOwogdm9pZCAqaG9zdF9kYXRhOwogdW5zaWduZWQgaW50IGZs
YWdzOwogdW5zaWduZWQgaW50IG1hcGNvdW50OwoKCiBzdHJ1Y3QgZndub2RlX2hhbmRsZSAq
Zndub2RlOwogZW51bSBpcnFfZG9tYWluX2J1c190b2tlbiBidXNfdG9rZW47CiBzdHJ1Y3Qg
aXJxX2RvbWFpbl9jaGlwX2dlbmVyaWMgKmdjOwoKIHN0cnVjdCBpcnFfZG9tYWluICpwYXJl
bnQ7CgoKCgoKCiBpcnFfaHdfbnVtYmVyX3QgaHdpcnFfbWF4OwogdW5zaWduZWQgaW50IHJl
dm1hcF9kaXJlY3RfbWF4X2lycTsKIHVuc2lnbmVkIGludCByZXZtYXBfc2l6ZTsKIHN0cnVj
dCB4YXJyYXkgcmV2bWFwX3RyZWU7CiBzdHJ1Y3QgbXV0ZXggcmV2bWFwX3RyZWVfbXV0ZXg7
CiB1bnNpZ25lZCBpbnQgbGluZWFyX3Jldm1hcFtdOwp9OwoKCmVudW0gewoKIElSUV9ET01B
SU5fRkxBR19ISUVSQVJDSFkgPSAoMSA8PCAwKSwKCgogSVJRX0RPTUFJTl9OQU1FX0FMTE9D
QVRFRCA9ICgxIDw8IDEpLAoKCiBJUlFfRE9NQUlOX0ZMQUdfSVBJX1BFUl9DUFUgPSAoMSA8
PCAyKSwKCgogSVJRX0RPTUFJTl9GTEFHX0lQSV9TSU5HTEUgPSAoMSA8PCAzKSwKCgogSVJR
X0RPTUFJTl9GTEFHX01TSSA9ICgxIDw8IDQpLAoKCiBJUlFfRE9NQUlOX0ZMQUdfTVNJX1JF
TUFQID0gKDEgPDwgNSksCgoKCgoKCiBJUlFfRE9NQUlOX01TSV9OT01BU0tfUVVJUksgPSAo
MSA8PCA2KSwKCgoKCgoKIElSUV9ET01BSU5fRkxBR19OT05DT1JFID0gKDEgPDwgMTYpLAp9
OwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIHN0cnVjdCBkZXZpY2Vfbm9kZSAqaXJxX2RvbWFpbl9nZXRfb2Zfbm9k
ZShzdHJ1Y3QgaXJxX2RvbWFpbiAqZCkKewogcmV0dXJuICh7IHR5cGVvZihkLT5md25vZGUp
IF9fdG9fb2Zfbm9kZV9md25vZGUgPSAoZC0+Zndub2RlKTsgaXNfb2Zfbm9kZShfX3RvX29m
X25vZGVfZndub2RlKSA/ICh7IHZvaWQgKl9fbXB0ciA9ICh2b2lkICopKF9fdG9fb2Zfbm9k
ZV9md25vZGUpOyBkbyB7IGV4dGVybiB2b2lkIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzE4Nih2
b2lkKSBfX2F0dHJpYnV0ZV9fKChfX2Vycm9yX18oInBvaW50ZXIgdHlwZSBtaXNtYXRjaCBp
biBjb250YWluZXJfb2YoKSIpKSk7IGlmICghKCEoIV9fYnVpbHRpbl90eXBlc19jb21wYXRp
YmxlX3AodHlwZW9mKCooX190b19vZl9ub2RlX2Z3bm9kZSkpLCB0eXBlb2YoKChzdHJ1Y3Qg
ZGV2aWNlX25vZGUgKikwKS0+Zndub2RlKSkgJiYgIV9fYnVpbHRpbl90eXBlc19jb21wYXRp
YmxlX3AodHlwZW9mKCooX190b19vZl9ub2RlX2Z3bm9kZSkpLCB0eXBlb2Yodm9pZCkpKSkp
IF9fY29tcGlsZXRpbWVfYXNzZXJ0XzE4NigpOyB9IHdoaWxlICgwKTsgKChzdHJ1Y3QgZGV2
aWNlX25vZGUgKikoX19tcHRyIC0gX19idWlsdGluX29mZnNldG9mKHN0cnVjdCBkZXZpY2Vf
bm9kZSwgZndub2RlKSkpOyB9KSA6ICgodm9pZCAqKTApOyB9KTsKfQoKCnN0cnVjdCBmd25v
ZGVfaGFuZGxlICpfX2lycV9kb21haW5fYWxsb2NfZndub2RlKHVuc2lnbmVkIGludCB0eXBl
LCBpbnQgaWQsCiAgICAgIGNvbnN0IGNoYXIgKm5hbWUsIHBoeXNfYWRkcl90ICpwYSk7Cgpl
bnVtIHsKIElSUUNISVBfRldOT0RFX1JFQUwsCiBJUlFDSElQX0ZXTk9ERV9OQU1FRCwKIElS
UUNISVBfRldOT0RFX05BTUVEX0lELAp9OwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpCnN0cnVjdCBmd25vZGVfaGFu
ZGxlICppcnFfZG9tYWluX2FsbG9jX25hbWVkX2Z3bm9kZShjb25zdCBjaGFyICpuYW1lKQp7
CiByZXR1cm4gX19pcnFfZG9tYWluX2FsbG9jX2Z3bm9kZShJUlFDSElQX0ZXTk9ERV9OQU1F
RCwgMCwgbmFtZSwgKCh2b2lkICopMCkpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkKc3RydWN0IGZ3bm9kZV9o
YW5kbGUgKmlycV9kb21haW5fYWxsb2NfbmFtZWRfaWRfZndub2RlKGNvbnN0IGNoYXIgKm5h
bWUsIGludCBpZCkKewogcmV0dXJuIF9faXJxX2RvbWFpbl9hbGxvY19md25vZGUoSVJRQ0hJ
UF9GV05PREVfTkFNRURfSUQsIGlkLCBuYW1lLAogICAgICAoKHZvaWQgKikwKSk7Cn0KCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSBzdHJ1Y3QgZndub2RlX2hhbmRsZSAqaXJxX2RvbWFpbl9hbGxvY19md25vZGUo
cGh5c19hZGRyX3QgKnBhKQp7CiByZXR1cm4gX19pcnFfZG9tYWluX2FsbG9jX2Z3bm9kZShJ
UlFDSElQX0ZXTk9ERV9SRUFMLCAwLCAoKHZvaWQgKikwKSwgcGEpOwp9Cgp2b2lkIGlycV9k
b21haW5fZnJlZV9md25vZGUoc3RydWN0IGZ3bm9kZV9oYW5kbGUgKmZ3bm9kZSk7CnN0cnVj
dCBpcnFfZG9tYWluICpfX2lycV9kb21haW5fYWRkKHN0cnVjdCBmd25vZGVfaGFuZGxlICpm
d25vZGUsIGludCBzaXplLAogICAgICAgIGlycV9od19udW1iZXJfdCBod2lycV9tYXgsIGlu
dCBkaXJlY3RfbWF4LAogICAgICAgIGNvbnN0IHN0cnVjdCBpcnFfZG9tYWluX29wcyAqb3Bz
LAogICAgICAgIHZvaWQgKmhvc3RfZGF0YSk7CnN0cnVjdCBpcnFfZG9tYWluICppcnFfZG9t
YWluX2FkZF9zaW1wbGUoc3RydWN0IGRldmljZV9ub2RlICpvZl9ub2RlLAogICAgICB1bnNp
Z25lZCBpbnQgc2l6ZSwKICAgICAgdW5zaWduZWQgaW50IGZpcnN0X2lycSwKICAgICAgY29u
c3Qgc3RydWN0IGlycV9kb21haW5fb3BzICpvcHMsCiAgICAgIHZvaWQgKmhvc3RfZGF0YSk7
CnN0cnVjdCBpcnFfZG9tYWluICppcnFfZG9tYWluX2FkZF9sZWdhY3koc3RydWN0IGRldmlj
ZV9ub2RlICpvZl9ub2RlLAogICAgICB1bnNpZ25lZCBpbnQgc2l6ZSwKICAgICAgdW5zaWdu
ZWQgaW50IGZpcnN0X2lycSwKICAgICAgaXJxX2h3X251bWJlcl90IGZpcnN0X2h3aXJxLAog
ICAgICBjb25zdCBzdHJ1Y3QgaXJxX2RvbWFpbl9vcHMgKm9wcywKICAgICAgdm9pZCAqaG9z
dF9kYXRhKTsKZXh0ZXJuIHN0cnVjdCBpcnFfZG9tYWluICppcnFfZmluZF9tYXRjaGluZ19m
d3NwZWMoc3RydWN0IGlycV9md3NwZWMgKmZ3c3BlYywKICAgICAgICAgZW51bSBpcnFfZG9t
YWluX2J1c190b2tlbiBidXNfdG9rZW4pOwpleHRlcm4gYm9vbCBpcnFfZG9tYWluX2NoZWNr
X21zaV9yZW1hcCh2b2lkKTsKZXh0ZXJuIHZvaWQgaXJxX3NldF9kZWZhdWx0X2hvc3Qoc3Ry
dWN0IGlycV9kb21haW4gKmhvc3QpOwpleHRlcm4gc3RydWN0IGlycV9kb21haW4gKmlycV9n
ZXRfZGVmYXVsdF9ob3N0KHZvaWQpOwpleHRlcm4gaW50IGlycV9kb21haW5fYWxsb2NfZGVz
Y3MoaW50IHZpcnEsIHVuc2lnbmVkIGludCBucl9pcnFzLAogICAgICBpcnFfaHdfbnVtYmVy
X3QgaHdpcnEsIGludCBub2RlLAogICAgICBjb25zdCBzdHJ1Y3QgaXJxX2FmZmluaXR5X2Rl
c2MgKmFmZmluaXR5KTsKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3QgZndub2RlX2hhbmRsZSAqb2Zfbm9k
ZV90b19md25vZGUoc3RydWN0IGRldmljZV9ub2RlICpub2RlKQp7CiByZXR1cm4gbm9kZSA/
ICZub2RlLT5md25vZGUgOiAoKHZvaWQgKikwKTsKfQoKZXh0ZXJuIGNvbnN0IHN0cnVjdCBm
d25vZGVfb3BlcmF0aW9ucyBpcnFjaGlwX2Z3bm9kZV9vcHM7CgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBp
c19md25vZGVfaXJxY2hpcChzdHJ1Y3QgZndub2RlX2hhbmRsZSAqZndub2RlKQp7CiByZXR1
cm4gZndub2RlICYmIGZ3bm9kZS0+b3BzID09ICZpcnFjaGlwX2Z3bm9kZV9vcHM7Cn0KCmV4
dGVybiB2b2lkIGlycV9kb21haW5fdXBkYXRlX2J1c190b2tlbihzdHJ1Y3QgaXJxX2RvbWFp
biAqZG9tYWluLAogICAgIGVudW0gaXJxX2RvbWFpbl9idXNfdG9rZW4gYnVzX3Rva2VuKTsK
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKQpzdHJ1Y3QgaXJxX2RvbWFpbiAqaXJxX2ZpbmRfbWF0Y2hpbmdfZndub2Rl
KHN0cnVjdCBmd25vZGVfaGFuZGxlICpmd25vZGUsCiAgICAgICAgIGVudW0gaXJxX2RvbWFp
bl9idXNfdG9rZW4gYnVzX3Rva2VuKQp7CiBzdHJ1Y3QgaXJxX2Z3c3BlYyBmd3NwZWMgPSB7
CiAgLmZ3bm9kZSA9IGZ3bm9kZSwKIH07CgogcmV0dXJuIGlycV9maW5kX21hdGNoaW5nX2Z3
c3BlYygmZndzcGVjLCBidXNfdG9rZW4pOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IGlycV9kb21h
aW4gKmlycV9maW5kX21hdGNoaW5nX2hvc3Qoc3RydWN0IGRldmljZV9ub2RlICpub2RlLAog
ICAgICAgZW51bSBpcnFfZG9tYWluX2J1c190b2tlbiBidXNfdG9rZW4pCnsKIHJldHVybiBp
cnFfZmluZF9tYXRjaGluZ19md25vZGUob2Zfbm9kZV90b19md25vZGUobm9kZSksIGJ1c190
b2tlbik7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3QgaXJxX2RvbWFpbiAqaXJxX2ZpbmRfaG9zdChz
dHJ1Y3QgZGV2aWNlX25vZGUgKm5vZGUpCnsKIHN0cnVjdCBpcnFfZG9tYWluICpkOwoKIGQg
PSBpcnFfZmluZF9tYXRjaGluZ19ob3N0KG5vZGUsIERPTUFJTl9CVVNfV0lSRUQpOwogaWYg
KCFkKQogIGQgPSBpcnFfZmluZF9tYXRjaGluZ19ob3N0KG5vZGUsIERPTUFJTl9CVVNfQU5Z
KTsKCiByZXR1cm4gZDsKfQojIDMzMiAiLi9pbmNsdWRlL2xpbnV4L2lycWRvbWFpbi5oIgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgc3RydWN0IGlycV9kb21haW4gKmlycV9kb21haW5fYWRkX2xpbmVhcihzdHJ1
Y3QgZGV2aWNlX25vZGUgKm9mX25vZGUsCiAgICAgIHVuc2lnbmVkIGludCBzaXplLAogICAg
ICBjb25zdCBzdHJ1Y3QgaXJxX2RvbWFpbl9vcHMgKm9wcywKICAgICAgdm9pZCAqaG9zdF9k
YXRhKQp7CiByZXR1cm4gX19pcnFfZG9tYWluX2FkZChvZl9ub2RlX3RvX2Z3bm9kZShvZl9u
b2RlKSwgc2l6ZSwgc2l6ZSwgMCwgb3BzLCBob3N0X2RhdGEpOwp9CnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1
Y3QgaXJxX2RvbWFpbiAqaXJxX2RvbWFpbl9hZGRfbm9tYXAoc3RydWN0IGRldmljZV9ub2Rl
ICpvZl9ub2RlLAogICAgICB1bnNpZ25lZCBpbnQgbWF4X2lycSwKICAgICAgY29uc3Qgc3Ry
dWN0IGlycV9kb21haW5fb3BzICpvcHMsCiAgICAgIHZvaWQgKmhvc3RfZGF0YSkKewogcmV0
dXJuIF9faXJxX2RvbWFpbl9hZGQob2Zfbm9kZV90b19md25vZGUob2Zfbm9kZSksIDAsIG1h
eF9pcnEsIG1heF9pcnEsIG9wcywgaG9zdF9kYXRhKTsKfQpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IGly
cV9kb21haW4gKmlycV9kb21haW5fYWRkX2xlZ2FjeV9pc2EoCiAgICBzdHJ1Y3QgZGV2aWNl
X25vZGUgKm9mX25vZGUsCiAgICBjb25zdCBzdHJ1Y3QgaXJxX2RvbWFpbl9vcHMgKm9wcywK
ICAgIHZvaWQgKmhvc3RfZGF0YSkKewogcmV0dXJuIGlycV9kb21haW5fYWRkX2xlZ2FjeShv
Zl9ub2RlLCAxNiwgMCwgMCwgb3BzLAogICAgICAgICBob3N0X2RhdGEpOwp9CnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBzdHJ1Y3QgaXJxX2RvbWFpbiAqaXJxX2RvbWFpbl9hZGRfdHJlZShzdHJ1Y3QgZGV2aWNl
X25vZGUgKm9mX25vZGUsCiAgICAgIGNvbnN0IHN0cnVjdCBpcnFfZG9tYWluX29wcyAqb3Bz
LAogICAgICB2b2lkICpob3N0X2RhdGEpCnsKIHJldHVybiBfX2lycV9kb21haW5fYWRkKG9m
X25vZGVfdG9fZndub2RlKG9mX25vZGUpLCAwLCB+MCwgMCwgb3BzLCBob3N0X2RhdGEpOwp9
CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgc3RydWN0IGlycV9kb21haW4gKmlycV9kb21haW5fY3JlYXRlX2xpbmVh
cihzdHJ1Y3QgZndub2RlX2hhbmRsZSAqZndub2RlLAogICAgICB1bnNpZ25lZCBpbnQgc2l6
ZSwKICAgICAgY29uc3Qgc3RydWN0IGlycV9kb21haW5fb3BzICpvcHMsCiAgICAgIHZvaWQg
Kmhvc3RfZGF0YSkKewogcmV0dXJuIF9faXJxX2RvbWFpbl9hZGQoZndub2RlLCBzaXplLCBz
aXplLCAwLCBvcHMsIGhvc3RfZGF0YSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3QgaXJxX2RvbWFp
biAqaXJxX2RvbWFpbl9jcmVhdGVfdHJlZShzdHJ1Y3QgZndub2RlX2hhbmRsZSAqZndub2Rl
LAogICAgICBjb25zdCBzdHJ1Y3QgaXJxX2RvbWFpbl9vcHMgKm9wcywKICAgICAgdm9pZCAq
aG9zdF9kYXRhKQp7CiByZXR1cm4gX19pcnFfZG9tYWluX2FkZChmd25vZGUsIDAsIH4wLCAw
LCBvcHMsIGhvc3RfZGF0YSk7Cn0KCmV4dGVybiB2b2lkIGlycV9kb21haW5fcmVtb3ZlKHN0
cnVjdCBpcnFfZG9tYWluICpob3N0KTsKCmV4dGVybiBpbnQgaXJxX2RvbWFpbl9hc3NvY2lh
dGUoc3RydWN0IGlycV9kb21haW4gKmRvbWFpbiwgdW5zaWduZWQgaW50IGlycSwKICAgICBp
cnFfaHdfbnVtYmVyX3QgaHdpcnEpOwpleHRlcm4gdm9pZCBpcnFfZG9tYWluX2Fzc29jaWF0
ZV9tYW55KHN0cnVjdCBpcnFfZG9tYWluICpkb21haW4sCiAgICAgICAgICB1bnNpZ25lZCBp
bnQgaXJxX2Jhc2UsCiAgICAgICAgICBpcnFfaHdfbnVtYmVyX3QgaHdpcnFfYmFzZSwgaW50
IGNvdW50KTsKZXh0ZXJuIHZvaWQgaXJxX2RvbWFpbl9kaXNhc3NvY2lhdGUoc3RydWN0IGly
cV9kb21haW4gKmRvbWFpbiwKICAgICAgICB1bnNpZ25lZCBpbnQgaXJxKTsKCmV4dGVybiB1
bnNpZ25lZCBpbnQgaXJxX2NyZWF0ZV9tYXBwaW5nKHN0cnVjdCBpcnFfZG9tYWluICpob3N0
LAogICAgICAgICAgIGlycV9od19udW1iZXJfdCBod2lycSk7CmV4dGVybiB1bnNpZ25lZCBp
bnQgaXJxX2NyZWF0ZV9md3NwZWNfbWFwcGluZyhzdHJ1Y3QgaXJxX2Z3c3BlYyAqZndzcGVj
KTsKZXh0ZXJuIHZvaWQgaXJxX2Rpc3Bvc2VfbWFwcGluZyh1bnNpZ25lZCBpbnQgdmlycSk7
CiMgNDAxICIuL2luY2x1ZGUvbGludXgvaXJxZG9tYWluLmgiCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1bnNpZ25l
ZCBpbnQgaXJxX2xpbmVhcl9yZXZtYXAoc3RydWN0IGlycV9kb21haW4gKmRvbWFpbiwKICAg
ICAgICAgIGlycV9od19udW1iZXJfdCBod2lycSkKewogcmV0dXJuIGh3aXJxIDwgZG9tYWlu
LT5yZXZtYXBfc2l6ZSA/IGRvbWFpbi0+bGluZWFyX3Jldm1hcFtod2lycV0gOiAwOwp9CmV4
dGVybiB1bnNpZ25lZCBpbnQgaXJxX2ZpbmRfbWFwcGluZyhzdHJ1Y3QgaXJxX2RvbWFpbiAq
aG9zdCwKICAgICAgICAgaXJxX2h3X251bWJlcl90IGh3aXJxKTsKZXh0ZXJuIHVuc2lnbmVk
IGludCBpcnFfY3JlYXRlX2RpcmVjdF9tYXBwaW5nKHN0cnVjdCBpcnFfZG9tYWluICpob3N0
KTsKZXh0ZXJuIGludCBpcnFfY3JlYXRlX3N0cmljdF9tYXBwaW5ncyhzdHJ1Y3QgaXJxX2Rv
bWFpbiAqZG9tYWluLAogICAgICAgICAgdW5zaWduZWQgaW50IGlycV9iYXNlLAogICAgICAg
ICAgaXJxX2h3X251bWJlcl90IGh3aXJxX2Jhc2UsIGludCBjb3VudCk7CgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
aW50IGlycV9jcmVhdGVfaWRlbnRpdHlfbWFwcGluZyhzdHJ1Y3QgaXJxX2RvbWFpbiAqaG9z
dCwKICAgICAgICAgICBpcnFfaHdfbnVtYmVyX3QgaHdpcnEpCnsKIHJldHVybiBpcnFfY3Jl
YXRlX3N0cmljdF9tYXBwaW5ncyhob3N0LCBod2lycSwgaHdpcnEsIDEpOwp9CgpleHRlcm4g
Y29uc3Qgc3RydWN0IGlycV9kb21haW5fb3BzIGlycV9kb21haW5fc2ltcGxlX29wczsKCgpp
bnQgaXJxX2RvbWFpbl94bGF0ZV9vbmVjZWxsKHN0cnVjdCBpcnFfZG9tYWluICpkLCBzdHJ1
Y3QgZGV2aWNlX25vZGUgKmN0cmxyLAogICBjb25zdCB1MzIgKmludHNwZWMsIHVuc2lnbmVk
IGludCBpbnRzaXplLAogICBpcnFfaHdfbnVtYmVyX3QgKm91dF9od2lycSwgdW5zaWduZWQg
aW50ICpvdXRfdHlwZSk7CmludCBpcnFfZG9tYWluX3hsYXRlX3R3b2NlbGwoc3RydWN0IGly
cV9kb21haW4gKmQsIHN0cnVjdCBkZXZpY2Vfbm9kZSAqY3RybHIsCiAgIGNvbnN0IHUzMiAq
aW50c3BlYywgdW5zaWduZWQgaW50IGludHNpemUsCiAgIGlycV9od19udW1iZXJfdCAqb3V0
X2h3aXJxLCB1bnNpZ25lZCBpbnQgKm91dF90eXBlKTsKaW50IGlycV9kb21haW5feGxhdGVf
b25ldHdvY2VsbChzdHJ1Y3QgaXJxX2RvbWFpbiAqZCwgc3RydWN0IGRldmljZV9ub2RlICpj
dHJsciwKICAgY29uc3QgdTMyICppbnRzcGVjLCB1bnNpZ25lZCBpbnQgaW50c2l6ZSwKICAg
aXJxX2h3X251bWJlcl90ICpvdXRfaHdpcnEsIHVuc2lnbmVkIGludCAqb3V0X3R5cGUpOwoK
aW50IGlycV9kb21haW5fdHJhbnNsYXRlX3R3b2NlbGwoc3RydWN0IGlycV9kb21haW4gKmQs
CiAgICAgc3RydWN0IGlycV9md3NwZWMgKmZ3c3BlYywKICAgICB1bnNpZ25lZCBsb25nICpv
dXRfaHdpcnEsCiAgICAgdW5zaWduZWQgaW50ICpvdXRfdHlwZSk7CgppbnQgaXJxX2RvbWFp
bl90cmFuc2xhdGVfb25lY2VsbChzdHJ1Y3QgaXJxX2RvbWFpbiAqZCwKICAgICBzdHJ1Y3Qg
aXJxX2Z3c3BlYyAqZndzcGVjLAogICAgIHVuc2lnbmVkIGxvbmcgKm91dF9od2lycSwKICAg
ICB1bnNpZ25lZCBpbnQgKm91dF90eXBlKTsKCgppbnQgaXJxX3Jlc2VydmVfaXBpKHN0cnVj
dCBpcnFfZG9tYWluICpkb21haW4sIGNvbnN0IHN0cnVjdCBjcHVtYXNrICpkZXN0KTsKaW50
IGlycV9kZXN0cm95X2lwaSh1bnNpZ25lZCBpbnQgaXJxLCBjb25zdCBzdHJ1Y3QgY3B1bWFz
ayAqZGVzdCk7CgoKZXh0ZXJuIHN0cnVjdCBpcnFfZGF0YSAqaXJxX2RvbWFpbl9nZXRfaXJx
X2RhdGEoc3RydWN0IGlycV9kb21haW4gKmRvbWFpbiwKICAgICAgdW5zaWduZWQgaW50IHZp
cnEpOwpleHRlcm4gdm9pZCBpcnFfZG9tYWluX3NldF9pbmZvKHN0cnVjdCBpcnFfZG9tYWlu
ICpkb21haW4sIHVuc2lnbmVkIGludCB2aXJxLAogICAgaXJxX2h3X251bWJlcl90IGh3aXJx
LCBzdHJ1Y3QgaXJxX2NoaXAgKmNoaXAsCiAgICB2b2lkICpjaGlwX2RhdGEsIGlycV9mbG93
X2hhbmRsZXJfdCBoYW5kbGVyLAogICAgdm9pZCAqaGFuZGxlcl9kYXRhLCBjb25zdCBjaGFy
ICpoYW5kbGVyX25hbWUpOwpleHRlcm4gdm9pZCBpcnFfZG9tYWluX3Jlc2V0X2lycV9kYXRh
KHN0cnVjdCBpcnFfZGF0YSAqaXJxX2RhdGEpOwoKZXh0ZXJuIHN0cnVjdCBpcnFfZG9tYWlu
ICppcnFfZG9tYWluX2NyZWF0ZV9oaWVyYXJjaHkoc3RydWN0IGlycV9kb21haW4gKnBhcmVu
dCwKICAgdW5zaWduZWQgaW50IGZsYWdzLCB1bnNpZ25lZCBpbnQgc2l6ZSwKICAgc3RydWN0
IGZ3bm9kZV9oYW5kbGUgKmZ3bm9kZSwKICAgY29uc3Qgc3RydWN0IGlycV9kb21haW5fb3Bz
ICpvcHMsIHZvaWQgKmhvc3RfZGF0YSk7CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IGlycV9kb21haW4g
KmlycV9kb21haW5fYWRkX2hpZXJhcmNoeShzdHJ1Y3QgaXJxX2RvbWFpbiAqcGFyZW50LAog
ICAgICAgICB1bnNpZ25lZCBpbnQgZmxhZ3MsCiAgICAgICAgIHVuc2lnbmVkIGludCBzaXpl
LAogICAgICAgICBzdHJ1Y3QgZGV2aWNlX25vZGUgKm5vZGUsCiAgICAgICAgIGNvbnN0IHN0
cnVjdCBpcnFfZG9tYWluX29wcyAqb3BzLAogICAgICAgICB2b2lkICpob3N0X2RhdGEpCnsK
IHJldHVybiBpcnFfZG9tYWluX2NyZWF0ZV9oaWVyYXJjaHkocGFyZW50LCBmbGFncywgc2l6
ZSwKICAgICAgICBvZl9ub2RlX3RvX2Z3bm9kZShub2RlKSwKICAgICAgICBvcHMsIGhvc3Rf
ZGF0YSk7Cn0KCmV4dGVybiBpbnQgX19pcnFfZG9tYWluX2FsbG9jX2lycXMoc3RydWN0IGly
cV9kb21haW4gKmRvbWFpbiwgaW50IGlycV9iYXNlLAogICAgICAgdW5zaWduZWQgaW50IG5y
X2lycXMsIGludCBub2RlLCB2b2lkICphcmcsCiAgICAgICBib29sIHJlYWxsb2MsCiAgICAg
ICBjb25zdCBzdHJ1Y3QgaXJxX2FmZmluaXR5X2Rlc2MgKmFmZmluaXR5KTsKZXh0ZXJuIHZv
aWQgaXJxX2RvbWFpbl9mcmVlX2lycXModW5zaWduZWQgaW50IHZpcnEsIHVuc2lnbmVkIGlu
dCBucl9pcnFzKTsKZXh0ZXJuIGludCBpcnFfZG9tYWluX2FjdGl2YXRlX2lycShzdHJ1Y3Qg
aXJxX2RhdGEgKmlycV9kYXRhLCBib29sIGVhcmx5KTsKZXh0ZXJuIHZvaWQgaXJxX2RvbWFp
bl9kZWFjdGl2YXRlX2lycShzdHJ1Y3QgaXJxX2RhdGEgKmlycV9kYXRhKTsKCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBpbnQgaXJxX2RvbWFpbl9hbGxvY19pcnFzKHN0cnVjdCBpcnFfZG9tYWluICpkb21haW4s
CiAgIHVuc2lnbmVkIGludCBucl9pcnFzLCBpbnQgbm9kZSwgdm9pZCAqYXJnKQp7CiByZXR1
cm4gX19pcnFfZG9tYWluX2FsbG9jX2lycXMoZG9tYWluLCAtMSwgbnJfaXJxcywgbm9kZSwg
YXJnLCBmYWxzZSwKICAgICAgICAgICAoKHZvaWQgKikwKSk7Cn0KCmV4dGVybiBpbnQgaXJx
X2RvbWFpbl9hbGxvY19pcnFzX2hpZXJhcmNoeShzdHJ1Y3QgaXJxX2RvbWFpbiAqZG9tYWlu
LAogICAgICAgIHVuc2lnbmVkIGludCBpcnFfYmFzZSwKICAgICAgICB1bnNpZ25lZCBpbnQg
bnJfaXJxcywgdm9pZCAqYXJnKTsKZXh0ZXJuIGludCBpcnFfZG9tYWluX3NldF9od2lycV9h
bmRfY2hpcChzdHJ1Y3QgaXJxX2RvbWFpbiAqZG9tYWluLAogICAgICB1bnNpZ25lZCBpbnQg
dmlycSwKICAgICAgaXJxX2h3X251bWJlcl90IGh3aXJxLAogICAgICBzdHJ1Y3QgaXJxX2No
aXAgKmNoaXAsCiAgICAgIHZvaWQgKmNoaXBfZGF0YSk7CmV4dGVybiB2b2lkIGlycV9kb21h
aW5fZnJlZV9pcnFzX2NvbW1vbihzdHJ1Y3QgaXJxX2RvbWFpbiAqZG9tYWluLAogICAgIHVu
c2lnbmVkIGludCB2aXJxLAogICAgIHVuc2lnbmVkIGludCBucl9pcnFzKTsKZXh0ZXJuIHZv
aWQgaXJxX2RvbWFpbl9mcmVlX2lycXNfdG9wKHN0cnVjdCBpcnFfZG9tYWluICpkb21haW4s
CiAgICAgICAgIHVuc2lnbmVkIGludCB2aXJxLCB1bnNpZ25lZCBpbnQgbnJfaXJxcyk7Cgpl
eHRlcm4gaW50IGlycV9kb21haW5fcHVzaF9pcnEoc3RydWN0IGlycV9kb21haW4gKmRvbWFp
biwgaW50IHZpcnEsIHZvaWQgKmFyZyk7CmV4dGVybiBpbnQgaXJxX2RvbWFpbl9wb3BfaXJx
KHN0cnVjdCBpcnFfZG9tYWluICpkb21haW4sIGludCB2aXJxKTsKCmV4dGVybiBpbnQgaXJx
X2RvbWFpbl9hbGxvY19pcnFzX3BhcmVudChzdHJ1Y3QgaXJxX2RvbWFpbiAqZG9tYWluLAog
ICAgIHVuc2lnbmVkIGludCBpcnFfYmFzZSwKICAgICB1bnNpZ25lZCBpbnQgbnJfaXJxcywg
dm9pZCAqYXJnKTsKCmV4dGVybiB2b2lkIGlycV9kb21haW5fZnJlZV9pcnFzX3BhcmVudChz
dHJ1Y3QgaXJxX2RvbWFpbiAqZG9tYWluLAogICAgIHVuc2lnbmVkIGludCBpcnFfYmFzZSwK
ICAgICB1bnNpZ25lZCBpbnQgbnJfaXJxcyk7CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBpcnFfZG9tYWlu
X2lzX2hpZXJhcmNoeShzdHJ1Y3QgaXJxX2RvbWFpbiAqZG9tYWluKQp7CiByZXR1cm4gZG9t
YWluLT5mbGFncyAmIElSUV9ET01BSU5fRkxBR19ISUVSQVJDSFk7Cn0KCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBi
b29sIGlycV9kb21haW5faXNfaXBpKHN0cnVjdCBpcnFfZG9tYWluICpkb21haW4pCnsKIHJl
dHVybiBkb21haW4tPmZsYWdzICYKICAoSVJRX0RPTUFJTl9GTEFHX0lQSV9QRVJfQ1BVIHwg
SVJRX0RPTUFJTl9GTEFHX0lQSV9TSU5HTEUpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBpcnFfZG9t
YWluX2lzX2lwaV9wZXJfY3B1KHN0cnVjdCBpcnFfZG9tYWluICpkb21haW4pCnsKIHJldHVy
biBkb21haW4tPmZsYWdzICYgSVJRX0RPTUFJTl9GTEFHX0lQSV9QRVJfQ1BVOwp9CgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgYm9vbCBpcnFfZG9tYWluX2lzX2lwaV9zaW5nbGUoc3RydWN0IGlycV9kb21haW4g
KmRvbWFpbikKewogcmV0dXJuIGRvbWFpbi0+ZmxhZ3MgJiBJUlFfRE9NQUlOX0ZMQUdfSVBJ
X1NJTkdMRTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgaXJxX2RvbWFpbl9pc19tc2koc3RydWN0IGly
cV9kb21haW4gKmRvbWFpbikKewogcmV0dXJuIGRvbWFpbi0+ZmxhZ3MgJiBJUlFfRE9NQUlO
X0ZMQUdfTVNJOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBpcnFfZG9tYWluX2lzX21zaV9yZW1hcChz
dHJ1Y3QgaXJxX2RvbWFpbiAqZG9tYWluKQp7CiByZXR1cm4gZG9tYWluLT5mbGFncyAmIElS
UV9ET01BSU5fRkxBR19NU0lfUkVNQVA7Cn0KCmV4dGVybiBib29sIGlycV9kb21haW5faGll
cmFyY2hpY2FsX2lzX21zaV9yZW1hcChzdHJ1Y3QgaXJxX2RvbWFpbiAqZG9tYWluKTsKIyAx
MCAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vaXJxLmgiIDIKIyAxOCAiLi9hcmNoL3Bv
d2VycGMvaW5jbHVkZS9hc20vaXJxLmgiCmV4dGVybiBhdG9taWNfdCBwcGNfbl9sb3N0X2lu
dGVycnVwdHM7CiMgMjkgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2lycS5oIgpleHRl
cm4gaXJxX2h3X251bWJlcl90IHZpcnFfdG9faHcodW5zaWduZWQgaW50IHZpcnEpOwoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIGludCBpcnFfY2Fub25pY2FsaXplKGludCBpcnEpCnsKIHJldHVybiBpcnE7Cn0K
CmV4dGVybiBpbnQgZGlzdHJpYnV0ZV9pcnFzOwoKc3RydWN0IGlycWFjdGlvbjsKc3RydWN0
IHB0X3JlZ3M7CiMgNDggIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2lycS5oIgpleHRl
cm4gdm9pZCAqY3JpdGlycV9jdHhbMjRdOwpleHRlcm4gdm9pZCAqZGJnaXJxX2N0eFsyNF07
CmV4dGVybiB2b2lkICptY2hlY2tpcnFfY3R4WzI0XTsKCgoKCgpleHRlcm4gdm9pZCAqaGFy
ZGlycV9jdHhbMjRdOwpleHRlcm4gdm9pZCAqc29mdGlycV9jdHhbMjRdOwoKdm9pZCBjYWxs
X2RvX3NvZnRpcnEodm9pZCAqc3ApOwp2b2lkIGNhbGxfZG9faXJxKHN0cnVjdCBwdF9yZWdz
ICpyZWdzLCB2b2lkICpzcCk7CmV4dGVybiB2b2lkIGRvX0lSUShzdHJ1Y3QgcHRfcmVncyAq
cmVncyk7CmV4dGVybiB2b2lkIF9fYXR0cmlidXRlX18oKF9fc2VjdGlvbl9fKCIuaW5pdC50
ZXh0IikpKSBfX2F0dHJpYnV0ZV9fKChfX2NvbGRfXykpIGluaXRfSVJRKHZvaWQpOwpleHRl
cm4gdm9pZCBfX2RvX2lycShzdHJ1Y3QgcHRfcmVncyAqcmVncyk7CgppbnQgaXJxX2Nob29z
ZV9jcHUoY29uc3Qgc3RydWN0IGNwdW1hc2sgKm1hc2spOwojIDI0ICIuL2luY2x1ZGUvbGlu
dXgvaXJxLmgiIDIKCiMgMSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9nZW5lcmF0ZWQvYXNt
L2lycV9yZWdzLmgiIDEKIyAxICIuL2luY2x1ZGUvYXNtLWdlbmVyaWMvaXJxX3JlZ3MuaCIg
MQojIDE3ICIuL2luY2x1ZGUvYXNtLWdlbmVyaWMvaXJxX3JlZ3MuaCIKZXh0ZXJuIF9fYXR0
cmlidXRlX18oKHNlY3Rpb24oIi5kYXRhLi5wZXJjcHUiICIiKSkpIF9fdHlwZW9mX18oc3Ry
dWN0IHB0X3JlZ3MgKikgX19pcnFfcmVnczsKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3QgcHRfcmVncyAq
Z2V0X2lycV9yZWdzKHZvaWQpCnsKIHJldHVybiAoeyBfX3RoaXNfY3B1X3ByZWVtcHRfY2hl
Y2soInJlYWQiKTsgKHsgdHlwZW9mKF9faXJxX3JlZ3MpIHBzY3JfcmV0X187IGRvIHsgY29u
c3Qgdm9pZCAqX192cHBfdmVyaWZ5ID0gKHR5cGVvZigoJihfX2lycV9yZWdzKSkgKyAwKSko
KHZvaWQgKikwKTsgKHZvaWQpX192cHBfdmVyaWZ5OyB9IHdoaWxlICgwKTsgc3dpdGNoKHNp
emVvZihfX2lycV9yZWdzKSkgeyBjYXNlIDE6IHBzY3JfcmV0X18gPSAoeyAqKHsgZG8geyBj
b25zdCB2b2lkICpfX3ZwcF92ZXJpZnkgPSAodHlwZW9mKCgmKF9faXJxX3JlZ3MpKSArIDAp
KSgodm9pZCAqKTApOyAodm9pZClfX3ZwcF92ZXJpZnk7IH0gd2hpbGUgKDApOyAoeyB1bnNp
Z25lZCBsb25nIF9fcHRyOyBfX2FzbV9fICgiIiA6ICI9ciIoX19wdHIpIDogIjAiKCh0eXBl
b2YoKigmKF9faXJxX3JlZ3MpKSkgKikoJihfX2lycV9yZWdzKSkpKTsgKHR5cGVvZigodHlw
ZW9mKCooJihfX2lycV9yZWdzKSkpICopKCYoX19pcnFfcmVncykpKSkgKF9fcHRyICsgKChs
b2NhbF9wYWNhLT5kYXRhX29mZnNldCkpKTsgfSk7IH0pOyB9KTsgYnJlYWs7IGNhc2UgMjog
cHNjcl9yZXRfXyA9ICh7ICooeyBkbyB7IGNvbnN0IHZvaWQgKl9fdnBwX3ZlcmlmeSA9ICh0
eXBlb2YoKCYoX19pcnFfcmVncykpICsgMCkpKCh2b2lkICopMCk7ICh2b2lkKV9fdnBwX3Zl
cmlmeTsgfSB3aGlsZSAoMCk7ICh7IHVuc2lnbmVkIGxvbmcgX19wdHI7IF9fYXNtX18gKCIi
IDogIj1yIihfX3B0cikgOiAiMCIoKHR5cGVvZigqKCYoX19pcnFfcmVncykpKSAqKSgmKF9f
aXJxX3JlZ3MpKSkpOyAodHlwZW9mKCh0eXBlb2YoKigmKF9faXJxX3JlZ3MpKSkgKikoJihf
X2lycV9yZWdzKSkpKSAoX19wdHIgKyAoKGxvY2FsX3BhY2EtPmRhdGFfb2Zmc2V0KSkpOyB9
KTsgfSk7IH0pOyBicmVhazsgY2FzZSA0OiBwc2NyX3JldF9fID0gKHsgKih7IGRvIHsgY29u
c3Qgdm9pZCAqX192cHBfdmVyaWZ5ID0gKHR5cGVvZigoJihfX2lycV9yZWdzKSkgKyAwKSko
KHZvaWQgKikwKTsgKHZvaWQpX192cHBfdmVyaWZ5OyB9IHdoaWxlICgwKTsgKHsgdW5zaWdu
ZWQgbG9uZyBfX3B0cjsgX19hc21fXyAoIiIgOiAiPXIiKF9fcHRyKSA6ICIwIigodHlwZW9m
KCooJihfX2lycV9yZWdzKSkpICopKCYoX19pcnFfcmVncykpKSk7ICh0eXBlb2YoKHR5cGVv
ZigqKCYoX19pcnFfcmVncykpKSAqKSgmKF9faXJxX3JlZ3MpKSkpIChfX3B0ciArICgobG9j
YWxfcGFjYS0+ZGF0YV9vZmZzZXQpKSk7IH0pOyB9KTsgfSk7IGJyZWFrOyBjYXNlIDg6IHBz
Y3JfcmV0X18gPSAoeyAqKHsgZG8geyBjb25zdCB2b2lkICpfX3ZwcF92ZXJpZnkgPSAodHlw
ZW9mKCgmKF9faXJxX3JlZ3MpKSArIDApKSgodm9pZCAqKTApOyAodm9pZClfX3ZwcF92ZXJp
Znk7IH0gd2hpbGUgKDApOyAoeyB1bnNpZ25lZCBsb25nIF9fcHRyOyBfX2FzbV9fICgiIiA6
ICI9ciIoX19wdHIpIDogIjAiKCh0eXBlb2YoKigmKF9faXJxX3JlZ3MpKSkgKikoJihfX2ly
cV9yZWdzKSkpKTsgKHR5cGVvZigodHlwZW9mKCooJihfX2lycV9yZWdzKSkpICopKCYoX19p
cnFfcmVncykpKSkgKF9fcHRyICsgKChsb2NhbF9wYWNhLT5kYXRhX29mZnNldCkpKTsgfSk7
IH0pOyB9KTsgYnJlYWs7IGRlZmF1bHQ6IF9fYmFkX3NpemVfY2FsbF9wYXJhbWV0ZXIoKTsg
YnJlYWs7IH0gcHNjcl9yZXRfXzsgfSk7IH0pOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IHB0X3Jl
Z3MgKnNldF9pcnFfcmVncyhzdHJ1Y3QgcHRfcmVncyAqbmV3X3JlZ3MpCnsKIHN0cnVjdCBw
dF9yZWdzICpvbGRfcmVnczsKCiBvbGRfcmVncyA9ICh7IF9fdGhpc19jcHVfcHJlZW1wdF9j
aGVjaygicmVhZCIpOyAoeyB0eXBlb2YoX19pcnFfcmVncykgcHNjcl9yZXRfXzsgZG8geyBj
b25zdCB2b2lkICpfX3ZwcF92ZXJpZnkgPSAodHlwZW9mKCgmKF9faXJxX3JlZ3MpKSArIDAp
KSgodm9pZCAqKTApOyAodm9pZClfX3ZwcF92ZXJpZnk7IH0gd2hpbGUgKDApOyBzd2l0Y2go
c2l6ZW9mKF9faXJxX3JlZ3MpKSB7IGNhc2UgMTogcHNjcl9yZXRfXyA9ICh7ICooeyBkbyB7
IGNvbnN0IHZvaWQgKl9fdnBwX3ZlcmlmeSA9ICh0eXBlb2YoKCYoX19pcnFfcmVncykpICsg
MCkpKCh2b2lkICopMCk7ICh2b2lkKV9fdnBwX3ZlcmlmeTsgfSB3aGlsZSAoMCk7ICh7IHVu
c2lnbmVkIGxvbmcgX19wdHI7IF9fYXNtX18gKCIiIDogIj1yIihfX3B0cikgOiAiMCIoKHR5
cGVvZigqKCYoX19pcnFfcmVncykpKSAqKSgmKF9faXJxX3JlZ3MpKSkpOyAodHlwZW9mKCh0
eXBlb2YoKigmKF9faXJxX3JlZ3MpKSkgKikoJihfX2lycV9yZWdzKSkpKSAoX19wdHIgKyAo
KGxvY2FsX3BhY2EtPmRhdGFfb2Zmc2V0KSkpOyB9KTsgfSk7IH0pOyBicmVhazsgY2FzZSAy
OiBwc2NyX3JldF9fID0gKHsgKih7IGRvIHsgY29uc3Qgdm9pZCAqX192cHBfdmVyaWZ5ID0g
KHR5cGVvZigoJihfX2lycV9yZWdzKSkgKyAwKSkoKHZvaWQgKikwKTsgKHZvaWQpX192cHBf
dmVyaWZ5OyB9IHdoaWxlICgwKTsgKHsgdW5zaWduZWQgbG9uZyBfX3B0cjsgX19hc21fXyAo
IiIgOiAiPXIiKF9fcHRyKSA6ICIwIigodHlwZW9mKCooJihfX2lycV9yZWdzKSkpICopKCYo
X19pcnFfcmVncykpKSk7ICh0eXBlb2YoKHR5cGVvZigqKCYoX19pcnFfcmVncykpKSAqKSgm
KF9faXJxX3JlZ3MpKSkpIChfX3B0ciArICgobG9jYWxfcGFjYS0+ZGF0YV9vZmZzZXQpKSk7
IH0pOyB9KTsgfSk7IGJyZWFrOyBjYXNlIDQ6IHBzY3JfcmV0X18gPSAoeyAqKHsgZG8geyBj
b25zdCB2b2lkICpfX3ZwcF92ZXJpZnkgPSAodHlwZW9mKCgmKF9faXJxX3JlZ3MpKSArIDAp
KSgodm9pZCAqKTApOyAodm9pZClfX3ZwcF92ZXJpZnk7IH0gd2hpbGUgKDApOyAoeyB1bnNp
Z25lZCBsb25nIF9fcHRyOyBfX2FzbV9fICgiIiA6ICI9ciIoX19wdHIpIDogIjAiKCh0eXBl
b2YoKigmKF9faXJxX3JlZ3MpKSkgKikoJihfX2lycV9yZWdzKSkpKTsgKHR5cGVvZigodHlw
ZW9mKCooJihfX2lycV9yZWdzKSkpICopKCYoX19pcnFfcmVncykpKSkgKF9fcHRyICsgKChs
b2NhbF9wYWNhLT5kYXRhX29mZnNldCkpKTsgfSk7IH0pOyB9KTsgYnJlYWs7IGNhc2UgODog
cHNjcl9yZXRfXyA9ICh7ICooeyBkbyB7IGNvbnN0IHZvaWQgKl9fdnBwX3ZlcmlmeSA9ICh0
eXBlb2YoKCYoX19pcnFfcmVncykpICsgMCkpKCh2b2lkICopMCk7ICh2b2lkKV9fdnBwX3Zl
cmlmeTsgfSB3aGlsZSAoMCk7ICh7IHVuc2lnbmVkIGxvbmcgX19wdHI7IF9fYXNtX18gKCIi
IDogIj1yIihfX3B0cikgOiAiMCIoKHR5cGVvZigqKCYoX19pcnFfcmVncykpKSAqKSgmKF9f
aXJxX3JlZ3MpKSkpOyAodHlwZW9mKCh0eXBlb2YoKigmKF9faXJxX3JlZ3MpKSkgKikoJihf
X2lycV9yZWdzKSkpKSAoX19wdHIgKyAoKGxvY2FsX3BhY2EtPmRhdGFfb2Zmc2V0KSkpOyB9
KTsgfSk7IH0pOyBicmVhazsgZGVmYXVsdDogX19iYWRfc2l6ZV9jYWxsX3BhcmFtZXRlcigp
OyBicmVhazsgfSBwc2NyX3JldF9fOyB9KTsgfSk7CiAoeyBfX3RoaXNfY3B1X3ByZWVtcHRf
Y2hlY2soIndyaXRlIik7IGRvIHsgZG8geyBjb25zdCB2b2lkICpfX3ZwcF92ZXJpZnkgPSAo
dHlwZW9mKCgmKF9faXJxX3JlZ3MpKSArIDApKSgodm9pZCAqKTApOyAodm9pZClfX3ZwcF92
ZXJpZnk7IH0gd2hpbGUgKDApOyBzd2l0Y2goc2l6ZW9mKF9faXJxX3JlZ3MpKSB7IGNhc2Ug
MTogZG8geyAqKHsgZG8geyBjb25zdCB2b2lkICpfX3ZwcF92ZXJpZnkgPSAodHlwZW9mKCgm
KF9faXJxX3JlZ3MpKSArIDApKSgodm9pZCAqKTApOyAodm9pZClfX3ZwcF92ZXJpZnk7IH0g
d2hpbGUgKDApOyAoeyB1bnNpZ25lZCBsb25nIF9fcHRyOyBfX2FzbV9fICgiIiA6ICI9ciIo
X19wdHIpIDogIjAiKCh0eXBlb2YoKigmKF9faXJxX3JlZ3MpKSkgKikoJihfX2lycV9yZWdz
KSkpKTsgKHR5cGVvZigodHlwZW9mKCooJihfX2lycV9yZWdzKSkpICopKCYoX19pcnFfcmVn
cykpKSkgKF9fcHRyICsgKChsb2NhbF9wYWNhLT5kYXRhX29mZnNldCkpKTsgfSk7IH0pID0g
bmV3X3JlZ3M7IH0gd2hpbGUgKDApO2JyZWFrOyBjYXNlIDI6IGRvIHsgKih7IGRvIHsgY29u
c3Qgdm9pZCAqX192cHBfdmVyaWZ5ID0gKHR5cGVvZigoJihfX2lycV9yZWdzKSkgKyAwKSko
KHZvaWQgKikwKTsgKHZvaWQpX192cHBfdmVyaWZ5OyB9IHdoaWxlICgwKTsgKHsgdW5zaWdu
ZWQgbG9uZyBfX3B0cjsgX19hc21fXyAoIiIgOiAiPXIiKF9fcHRyKSA6ICIwIigodHlwZW9m
KCooJihfX2lycV9yZWdzKSkpICopKCYoX19pcnFfcmVncykpKSk7ICh0eXBlb2YoKHR5cGVv
ZigqKCYoX19pcnFfcmVncykpKSAqKSgmKF9faXJxX3JlZ3MpKSkpIChfX3B0ciArICgobG9j
YWxfcGFjYS0+ZGF0YV9vZmZzZXQpKSk7IH0pOyB9KSA9IG5ld19yZWdzOyB9IHdoaWxlICgw
KTticmVhazsgY2FzZSA0OiBkbyB7ICooeyBkbyB7IGNvbnN0IHZvaWQgKl9fdnBwX3Zlcmlm
eSA9ICh0eXBlb2YoKCYoX19pcnFfcmVncykpICsgMCkpKCh2b2lkICopMCk7ICh2b2lkKV9f
dnBwX3ZlcmlmeTsgfSB3aGlsZSAoMCk7ICh7IHVuc2lnbmVkIGxvbmcgX19wdHI7IF9fYXNt
X18gKCIiIDogIj1yIihfX3B0cikgOiAiMCIoKHR5cGVvZigqKCYoX19pcnFfcmVncykpKSAq
KSgmKF9faXJxX3JlZ3MpKSkpOyAodHlwZW9mKCh0eXBlb2YoKigmKF9faXJxX3JlZ3MpKSkg
KikoJihfX2lycV9yZWdzKSkpKSAoX19wdHIgKyAoKGxvY2FsX3BhY2EtPmRhdGFfb2Zmc2V0
KSkpOyB9KTsgfSkgPSBuZXdfcmVnczsgfSB3aGlsZSAoMCk7YnJlYWs7IGNhc2UgODogZG8g
eyAqKHsgZG8geyBjb25zdCB2b2lkICpfX3ZwcF92ZXJpZnkgPSAodHlwZW9mKCgmKF9faXJx
X3JlZ3MpKSArIDApKSgodm9pZCAqKTApOyAodm9pZClfX3ZwcF92ZXJpZnk7IH0gd2hpbGUg
KDApOyAoeyB1bnNpZ25lZCBsb25nIF9fcHRyOyBfX2FzbV9fICgiIiA6ICI9ciIoX19wdHIp
IDogIjAiKCh0eXBlb2YoKigmKF9faXJxX3JlZ3MpKSkgKikoJihfX2lycV9yZWdzKSkpKTsg
KHR5cGVvZigodHlwZW9mKCooJihfX2lycV9yZWdzKSkpICopKCYoX19pcnFfcmVncykpKSkg
KF9fcHRyICsgKChsb2NhbF9wYWNhLT5kYXRhX29mZnNldCkpKTsgfSk7IH0pID0gbmV3X3Jl
Z3M7IH0gd2hpbGUgKDApO2JyZWFrOyBkZWZhdWx0OiBfX2JhZF9zaXplX2NhbGxfcGFyYW1l
dGVyKCk7YnJlYWs7IH0gfSB3aGlsZSAoMCk7IH0pOwogcmV0dXJuIG9sZF9yZWdzOwp9CiMg
MSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9nZW5lcmF0ZWQvYXNtL2lycV9yZWdzLmgiIDIK
IyAyNiAiLi9pbmNsdWRlL2xpbnV4L2lycS5oIiAyCgpzdHJ1Y3Qgc2VxX2ZpbGU7CnN0cnVj
dCBtb2R1bGU7CnN0cnVjdCBtc2lfbXNnOwpzdHJ1Y3QgaXJxX2FmZmluaXR5X2Rlc2M7CmVu
dW0gaXJxY2hpcF9pcnFfc3RhdGU7CiMgNzUgIi4vaW5jbHVkZS9saW51eC9pcnEuaCIKZW51
bSB7CiBJUlFfVFlQRV9OT05FID0gMHgwMDAwMDAwMCwKIElSUV9UWVBFX0VER0VfUklTSU5H
ID0gMHgwMDAwMDAwMSwKIElSUV9UWVBFX0VER0VfRkFMTElORyA9IDB4MDAwMDAwMDIsCiBJ
UlFfVFlQRV9FREdFX0JPVEggPSAoSVJRX1RZUEVfRURHRV9GQUxMSU5HIHwgSVJRX1RZUEVf
RURHRV9SSVNJTkcpLAogSVJRX1RZUEVfTEVWRUxfSElHSCA9IDB4MDAwMDAwMDQsCiBJUlFf
VFlQRV9MRVZFTF9MT1cgPSAweDAwMDAwMDA4LAogSVJRX1RZUEVfTEVWRUxfTUFTSyA9IChJ
UlFfVFlQRV9MRVZFTF9MT1cgfCBJUlFfVFlQRV9MRVZFTF9ISUdIKSwKIElSUV9UWVBFX1NF
TlNFX01BU0sgPSAweDAwMDAwMDBmLAogSVJRX1RZUEVfREVGQVVMVCA9IElSUV9UWVBFX1NF
TlNFX01BU0ssCgogSVJRX1RZUEVfUFJPQkUgPSAweDAwMDAwMDEwLAoKIElSUV9MRVZFTCA9
ICgxIDw8IDgpLAogSVJRX1BFUl9DUFUgPSAoMSA8PCA5KSwKIElSUV9OT1BST0JFID0gKDEg
PDwgMTApLAogSVJRX05PUkVRVUVTVCA9ICgxIDw8IDExKSwKIElSUV9OT0FVVE9FTiA9ICgx
IDw8IDEyKSwKIElSUV9OT19CQUxBTkNJTkcgPSAoMSA8PCAxMyksCiBJUlFfTU9WRV9QQ05U
WFQgPSAoMSA8PCAxNCksCiBJUlFfTkVTVEVEX1RIUkVBRCA9ICgxIDw8IDE1KSwKIElSUV9O
T1RIUkVBRCA9ICgxIDw8IDE2KSwKIElSUV9QRVJfQ1BVX0RFVklEID0gKDEgPDwgMTcpLAog
SVJRX0lTX1BPTExFRCA9ICgxIDw8IDE4KSwKIElSUV9ESVNBQkxFX1VOTEFaWSA9ICgxIDw8
IDE5KSwKfTsKIyAxMTkgIi4vaW5jbHVkZS9saW51eC9pcnEuaCIKZW51bSB7CiBJUlFfU0VU
X01BU0tfT0sgPSAwLAogSVJRX1NFVF9NQVNLX09LX05PQ09QWSwKIElSUV9TRVRfTUFTS19P
S19ET05FLAp9OwoKc3RydWN0IG1zaV9kZXNjOwpzdHJ1Y3QgaXJxX2RvbWFpbjsKIyAxNDMg
Ii4vaW5jbHVkZS9saW51eC9pcnEuaCIKc3RydWN0IGlycV9jb21tb25fZGF0YSB7CiB1bnNp
Z25lZCBpbnQgc3RhdGVfdXNlX2FjY2Vzc29yczsKCgoKIHZvaWQgKmhhbmRsZXJfZGF0YTsK
IHN0cnVjdCBtc2lfZGVzYyAqbXNpX2Rlc2M7CiBjcHVtYXNrX3Zhcl90IGFmZmluaXR5OwoK
CgoKCgp9OwojIDE3MyAiLi9pbmNsdWRlL2xpbnV4L2lycS5oIgpzdHJ1Y3QgaXJxX2RhdGEg
ewogdTMyIG1hc2s7CiB1bnNpZ25lZCBpbnQgaXJxOwogdW5zaWduZWQgbG9uZyBod2lycTsK
IHN0cnVjdCBpcnFfY29tbW9uX2RhdGEgKmNvbW1vbjsKIHN0cnVjdCBpcnFfY2hpcCAqY2hp
cDsKIHN0cnVjdCBpcnFfZG9tYWluICpkb21haW47Cgogc3RydWN0IGlycV9kYXRhICpwYXJl
bnRfZGF0YTsKCiB2b2lkICpjaGlwX2RhdGE7Cn07CiMgMjE3ICIuL2luY2x1ZGUvbGludXgv
aXJxLmgiCmVudW0gewogSVJRRF9UUklHR0VSX01BU0sgPSAweGYsCiBJUlFEX1NFVEFGRklO
SVRZX1BFTkRJTkcgPSAoMSA8PCA4KSwKIElSUURfQUNUSVZBVEVEID0gKDEgPDwgOSksCiBJ
UlFEX05PX0JBTEFOQ0lORyA9ICgxIDw8IDEwKSwKIElSUURfUEVSX0NQVSA9ICgxIDw8IDEx
KSwKIElSUURfQUZGSU5JVFlfU0VUID0gKDEgPDwgMTIpLAogSVJRRF9MRVZFTCA9ICgxIDw8
IDEzKSwKIElSUURfV0FLRVVQX1NUQVRFID0gKDEgPDwgMTQpLAogSVJRRF9NT1ZFX1BDTlRY
VCA9ICgxIDw8IDE1KSwKIElSUURfSVJRX0RJU0FCTEVEID0gKDEgPDwgMTYpLAogSVJRRF9J
UlFfTUFTS0VEID0gKDEgPDwgMTcpLAogSVJRRF9JUlFfSU5QUk9HUkVTUyA9ICgxIDw8IDE4
KSwKIElSUURfV0FLRVVQX0FSTUVEID0gKDEgPDwgMTkpLAogSVJRRF9GT1JXQVJERURfVE9f
VkNQVSA9ICgxIDw8IDIwKSwKIElSUURfQUZGSU5JVFlfTUFOQUdFRCA9ICgxIDw8IDIxKSwK
IElSUURfSVJRX1NUQVJURUQgPSAoMSA8PCAyMiksCiBJUlFEX01BTkFHRURfU0hVVERPV04g
PSAoMSA8PCAyMyksCiBJUlFEX1NJTkdMRV9UQVJHRVQgPSAoMSA8PCAyNCksCiBJUlFEX0RF
RkFVTFRfVFJJR0dFUl9TRVQgPSAoMSA8PCAyNSksCiBJUlFEX0NBTl9SRVNFUlZFID0gKDEg
PDwgMjYpLAogSVJRRF9NU0lfTk9NQVNLX1FVSVJLID0gKDEgPDwgMjcpLAogSVJRRF9IQU5E
TEVfRU5GT1JDRV9JUlFDVFggPSAoMSA8PCAyOCksCn07CgoKCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIGly
cWRfaXNfc2V0YWZmaW5pdHlfcGVuZGluZyhzdHJ1Y3QgaXJxX2RhdGEgKmQpCnsKIHJldHVy
biAoKChkKS0+Y29tbW9uKS0+c3RhdGVfdXNlX2FjY2Vzc29ycykgJiBJUlFEX1NFVEFGRklO
SVRZX1BFTkRJTkc7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIGlycWRfaXNfcGVyX2NwdShzdHJ1Y3Qg
aXJxX2RhdGEgKmQpCnsKIHJldHVybiAoKChkKS0+Y29tbW9uKS0+c3RhdGVfdXNlX2FjY2Vz
c29ycykgJiBJUlFEX1BFUl9DUFU7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIGlycWRfY2FuX2JhbGFu
Y2Uoc3RydWN0IGlycV9kYXRhICpkKQp7CiByZXR1cm4gISgoKChkKS0+Y29tbW9uKS0+c3Rh
dGVfdXNlX2FjY2Vzc29ycykgJiAoSVJRRF9QRVJfQ1BVIHwgSVJRRF9OT19CQUxBTkNJTkcp
KTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIGJvb2wgaXJxZF9hZmZpbml0eV93YXNfc2V0KHN0cnVjdCBpcnFf
ZGF0YSAqZCkKewogcmV0dXJuICgoKGQpLT5jb21tb24pLT5zdGF0ZV91c2VfYWNjZXNzb3Jz
KSAmIElSUURfQUZGSU5JVFlfU0VUOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBpcnFkX21hcmtfYWZm
aW5pdHlfd2FzX3NldChzdHJ1Y3QgaXJxX2RhdGEgKmQpCnsKICgoKGQpLT5jb21tb24pLT5z
dGF0ZV91c2VfYWNjZXNzb3JzKSB8PSBJUlFEX0FGRklOSVRZX1NFVDsKfQoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IGJvb2wgaXJxZF90cmlnZ2VyX3R5cGVfd2FzX3NldChzdHJ1Y3QgaXJxX2RhdGEgKmQpCnsK
IHJldHVybiAoKChkKS0+Y29tbW9uKS0+c3RhdGVfdXNlX2FjY2Vzc29ycykgJiBJUlFEX0RF
RkFVTFRfVFJJR0dFUl9TRVQ7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1MzIgaXJxZF9nZXRfdHJpZ2dlcl90
eXBlKHN0cnVjdCBpcnFfZGF0YSAqZCkKewogcmV0dXJuICgoKGQpLT5jb21tb24pLT5zdGF0
ZV91c2VfYWNjZXNzb3JzKSAmIElSUURfVFJJR0dFUl9NQVNLOwp9CgoKCgoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IHZvaWQgaXJxZF9zZXRfdHJpZ2dlcl90eXBlKHN0cnVjdCBpcnFfZGF0YSAqZCwgdTMyIHR5
cGUpCnsKICgoKGQpLT5jb21tb24pLT5zdGF0ZV91c2VfYWNjZXNzb3JzKSAmPSB+SVJRRF9U
UklHR0VSX01BU0s7CiAoKChkKS0+Y29tbW9uKS0+c3RhdGVfdXNlX2FjY2Vzc29ycykgfD0g
dHlwZSAmIElSUURfVFJJR0dFUl9NQVNLOwogKCgoZCktPmNvbW1vbiktPnN0YXRlX3VzZV9h
Y2Nlc3NvcnMpIHw9IElSUURfREVGQVVMVF9UUklHR0VSX1NFVDsKfQoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJv
b2wgaXJxZF9pc19sZXZlbF90eXBlKHN0cnVjdCBpcnFfZGF0YSAqZCkKewogcmV0dXJuICgo
KGQpLT5jb21tb24pLT5zdGF0ZV91c2VfYWNjZXNzb3JzKSAmIElSUURfTEVWRUw7Cn0KCgoK
CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgdm9pZCBpcnFkX3NldF9zaW5nbGVfdGFyZ2V0KHN0cnVjdCBpcnFfZGF0
YSAqZCkKewogKCgoZCktPmNvbW1vbiktPnN0YXRlX3VzZV9hY2Nlc3NvcnMpIHw9IElSUURf
U0lOR0xFX1RBUkdFVDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgaXJxZF9pc19zaW5nbGVfdGFyZ2V0
KHN0cnVjdCBpcnFfZGF0YSAqZCkKewogcmV0dXJuICgoKGQpLT5jb21tb24pLT5zdGF0ZV91
c2VfYWNjZXNzb3JzKSAmIElSUURfU0lOR0xFX1RBUkdFVDsKfQoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQg
aXJxZF9zZXRfaGFuZGxlX2VuZm9yY2VfaXJxY3R4KHN0cnVjdCBpcnFfZGF0YSAqZCkKewog
KCgoZCktPmNvbW1vbiktPnN0YXRlX3VzZV9hY2Nlc3NvcnMpIHw9IElSUURfSEFORExFX0VO
Rk9SQ0VfSVJRQ1RYOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBpcnFkX2lzX2hhbmRsZV9lbmZvcmNl
X2lycWN0eChzdHJ1Y3QgaXJxX2RhdGEgKmQpCnsKIHJldHVybiAoKChkKS0+Y29tbW9uKS0+
c3RhdGVfdXNlX2FjY2Vzc29ycykgJiBJUlFEX0hBTkRMRV9FTkZPUkNFX0lSUUNUWDsKfQoK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIGJvb2wgaXJxZF9pc193YWtldXBfc2V0KHN0cnVjdCBpcnFfZGF0YSAqZCkK
ewogcmV0dXJuICgoKGQpLT5jb21tb24pLT5zdGF0ZV91c2VfYWNjZXNzb3JzKSAmIElSUURf
V0FLRVVQX1NUQVRFOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBpcnFkX2Nhbl9tb3ZlX2luX3Byb2Nl
c3NfY29udGV4dChzdHJ1Y3QgaXJxX2RhdGEgKmQpCnsKIHJldHVybiAoKChkKS0+Y29tbW9u
KS0+c3RhdGVfdXNlX2FjY2Vzc29ycykgJiBJUlFEX01PVkVfUENOVFhUOwp9CgpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgYm9vbCBpcnFkX2lycV9kaXNhYmxlZChzdHJ1Y3QgaXJxX2RhdGEgKmQpCnsKIHJldHVy
biAoKChkKS0+Y29tbW9uKS0+c3RhdGVfdXNlX2FjY2Vzc29ycykgJiBJUlFEX0lSUV9ESVNB
QkxFRDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgaXJxZF9pcnFfbWFza2VkKHN0cnVjdCBpcnFfZGF0
YSAqZCkKewogcmV0dXJuICgoKGQpLT5jb21tb24pLT5zdGF0ZV91c2VfYWNjZXNzb3JzKSAm
IElSUURfSVJRX01BU0tFRDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgaXJxZF9pcnFfaW5wcm9ncmVz
cyhzdHJ1Y3QgaXJxX2RhdGEgKmQpCnsKIHJldHVybiAoKChkKS0+Y29tbW9uKS0+c3RhdGVf
dXNlX2FjY2Vzc29ycykgJiBJUlFEX0lSUV9JTlBST0dSRVNTOwp9CgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9v
bCBpcnFkX2lzX3dha2V1cF9hcm1lZChzdHJ1Y3QgaXJxX2RhdGEgKmQpCnsKIHJldHVybiAo
KChkKS0+Y29tbW9uKS0+c3RhdGVfdXNlX2FjY2Vzc29ycykgJiBJUlFEX1dBS0VVUF9BUk1F
RDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIGJvb2wgaXJxZF9pc19mb3J3YXJkZWRfdG9fdmNwdShzdHJ1Y3Qg
aXJxX2RhdGEgKmQpCnsKIHJldHVybiAoKChkKS0+Y29tbW9uKS0+c3RhdGVfdXNlX2FjY2Vz
c29ycykgJiBJUlFEX0ZPUldBUkRFRF9UT19WQ1BVOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBpcnFk
X3NldF9mb3J3YXJkZWRfdG9fdmNwdShzdHJ1Y3QgaXJxX2RhdGEgKmQpCnsKICgoKGQpLT5j
b21tb24pLT5zdGF0ZV91c2VfYWNjZXNzb3JzKSB8PSBJUlFEX0ZPUldBUkRFRF9UT19WQ1BV
Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgdm9pZCBpcnFkX2Nscl9mb3J3YXJkZWRfdG9fdmNwdShzdHJ1Y3Qg
aXJxX2RhdGEgKmQpCnsKICgoKGQpLT5jb21tb24pLT5zdGF0ZV91c2VfYWNjZXNzb3JzKSAm
PSB+SVJRRF9GT1JXQVJERURfVE9fVkNQVTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgaXJxZF9hZmZp
bml0eV9pc19tYW5hZ2VkKHN0cnVjdCBpcnFfZGF0YSAqZCkKewogcmV0dXJuICgoKGQpLT5j
b21tb24pLT5zdGF0ZV91c2VfYWNjZXNzb3JzKSAmIElSUURfQUZGSU5JVFlfTUFOQUdFRDsK
fQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIGJvb2wgaXJxZF9pc19hY3RpdmF0ZWQoc3RydWN0IGlycV9kYXRhICpk
KQp7CiByZXR1cm4gKCgoZCktPmNvbW1vbiktPnN0YXRlX3VzZV9hY2Nlc3NvcnMpICYgSVJR
RF9BQ1RJVkFURUQ7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGlycWRfc2V0X2FjdGl2YXRlZChzdHJ1
Y3QgaXJxX2RhdGEgKmQpCnsKICgoKGQpLT5jb21tb24pLT5zdGF0ZV91c2VfYWNjZXNzb3Jz
KSB8PSBJUlFEX0FDVElWQVRFRDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgaXJxZF9jbHJfYWN0aXZh
dGVkKHN0cnVjdCBpcnFfZGF0YSAqZCkKewogKCgoZCktPmNvbW1vbiktPnN0YXRlX3VzZV9h
Y2Nlc3NvcnMpICY9IH5JUlFEX0FDVElWQVRFRDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgaXJxZF9p
c19zdGFydGVkKHN0cnVjdCBpcnFfZGF0YSAqZCkKewogcmV0dXJuICgoKGQpLT5jb21tb24p
LT5zdGF0ZV91c2VfYWNjZXNzb3JzKSAmIElSUURfSVJRX1NUQVJURUQ7Cn0KCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBib29sIGlycWRfaXNfbWFuYWdlZF9hbmRfc2h1dGRvd24oc3RydWN0IGlycV9kYXRhICpk
KQp7CiByZXR1cm4gKCgoZCktPmNvbW1vbiktPnN0YXRlX3VzZV9hY2Nlc3NvcnMpICYgSVJR
RF9NQU5BR0VEX1NIVVRET1dOOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBpcnFkX3NldF9jYW5fcmVz
ZXJ2ZShzdHJ1Y3QgaXJxX2RhdGEgKmQpCnsKICgoKGQpLT5jb21tb24pLT5zdGF0ZV91c2Vf
YWNjZXNzb3JzKSB8PSBJUlFEX0NBTl9SRVNFUlZFOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBpcnFk
X2Nscl9jYW5fcmVzZXJ2ZShzdHJ1Y3QgaXJxX2RhdGEgKmQpCnsKICgoKGQpLT5jb21tb24p
LT5zdGF0ZV91c2VfYWNjZXNzb3JzKSAmPSB+SVJRRF9DQU5fUkVTRVJWRTsKfQoKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIGJvb2wgaXJxZF9jYW5fcmVzZXJ2ZShzdHJ1Y3QgaXJxX2RhdGEgKmQpCnsKIHJldHVy
biAoKChkKS0+Y29tbW9uKS0+c3RhdGVfdXNlX2FjY2Vzc29ycykgJiBJUlFEX0NBTl9SRVNF
UlZFOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBpcnFkX3NldF9tc2lfbm9tYXNrX3F1aXJrKHN0cnVj
dCBpcnFfZGF0YSAqZCkKewogKCgoZCktPmNvbW1vbiktPnN0YXRlX3VzZV9hY2Nlc3NvcnMp
IHw9IElSUURfTVNJX05PTUFTS19RVUlSSzsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgaXJxZF9jbHJf
bXNpX25vbWFza19xdWlyayhzdHJ1Y3QgaXJxX2RhdGEgKmQpCnsKICgoKGQpLT5jb21tb24p
LT5zdGF0ZV91c2VfYWNjZXNzb3JzKSAmPSB+SVJRRF9NU0lfTk9NQVNLX1FVSVJLOwp9Cgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgYm9vbCBpcnFkX21zaV9ub21hc2tfcXVpcmsoc3RydWN0IGlycV9kYXRhICpk
KQp7CiByZXR1cm4gKCgoZCktPmNvbW1vbiktPnN0YXRlX3VzZV9hY2Nlc3NvcnMpICYgSVJR
RF9NU0lfTk9NQVNLX1FVSVJLOwp9CgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpcnFfaHdfbnVtYmVyX3QgaXJx
ZF90b19od2lycShzdHJ1Y3QgaXJxX2RhdGEgKmQpCnsKIHJldHVybiBkLT5od2lycTsKfQoj
IDQ4MCAiLi9pbmNsdWRlL2xpbnV4L2lycS5oIgpzdHJ1Y3QgaXJxX2NoaXAgewogc3RydWN0
IGRldmljZSAqcGFyZW50X2RldmljZTsKIGNvbnN0IGNoYXIgKm5hbWU7CiB1bnNpZ25lZCBp
bnQgKCppcnFfc3RhcnR1cCkoc3RydWN0IGlycV9kYXRhICpkYXRhKTsKIHZvaWQgKCppcnFf
c2h1dGRvd24pKHN0cnVjdCBpcnFfZGF0YSAqZGF0YSk7CiB2b2lkICgqaXJxX2VuYWJsZSko
c3RydWN0IGlycV9kYXRhICpkYXRhKTsKIHZvaWQgKCppcnFfZGlzYWJsZSkoc3RydWN0IGly
cV9kYXRhICpkYXRhKTsKCiB2b2lkICgqaXJxX2Fjaykoc3RydWN0IGlycV9kYXRhICpkYXRh
KTsKIHZvaWQgKCppcnFfbWFzaykoc3RydWN0IGlycV9kYXRhICpkYXRhKTsKIHZvaWQgKCpp
cnFfbWFza19hY2spKHN0cnVjdCBpcnFfZGF0YSAqZGF0YSk7CiB2b2lkICgqaXJxX3VubWFz
aykoc3RydWN0IGlycV9kYXRhICpkYXRhKTsKIHZvaWQgKCppcnFfZW9pKShzdHJ1Y3QgaXJx
X2RhdGEgKmRhdGEpOwoKIGludCAoKmlycV9zZXRfYWZmaW5pdHkpKHN0cnVjdCBpcnFfZGF0
YSAqZGF0YSwgY29uc3Qgc3RydWN0IGNwdW1hc2sgKmRlc3QsIGJvb2wgZm9yY2UpOwogaW50
ICgqaXJxX3JldHJpZ2dlcikoc3RydWN0IGlycV9kYXRhICpkYXRhKTsKIGludCAoKmlycV9z
ZXRfdHlwZSkoc3RydWN0IGlycV9kYXRhICpkYXRhLCB1bnNpZ25lZCBpbnQgZmxvd190eXBl
KTsKIGludCAoKmlycV9zZXRfd2FrZSkoc3RydWN0IGlycV9kYXRhICpkYXRhLCB1bnNpZ25l
ZCBpbnQgb24pOwoKIHZvaWQgKCppcnFfYnVzX2xvY2spKHN0cnVjdCBpcnFfZGF0YSAqZGF0
YSk7CiB2b2lkICgqaXJxX2J1c19zeW5jX3VubG9jaykoc3RydWN0IGlycV9kYXRhICpkYXRh
KTsKCiB2b2lkICgqaXJxX2NwdV9vbmxpbmUpKHN0cnVjdCBpcnFfZGF0YSAqZGF0YSk7CiB2
b2lkICgqaXJxX2NwdV9vZmZsaW5lKShzdHJ1Y3QgaXJxX2RhdGEgKmRhdGEpOwoKIHZvaWQg
KCppcnFfc3VzcGVuZCkoc3RydWN0IGlycV9kYXRhICpkYXRhKTsKIHZvaWQgKCppcnFfcmVz
dW1lKShzdHJ1Y3QgaXJxX2RhdGEgKmRhdGEpOwogdm9pZCAoKmlycV9wbV9zaHV0ZG93biko
c3RydWN0IGlycV9kYXRhICpkYXRhKTsKCiB2b2lkICgqaXJxX2NhbGNfbWFzaykoc3RydWN0
IGlycV9kYXRhICpkYXRhKTsKCiB2b2lkICgqaXJxX3ByaW50X2NoaXApKHN0cnVjdCBpcnFf
ZGF0YSAqZGF0YSwgc3RydWN0IHNlcV9maWxlICpwKTsKIGludCAoKmlycV9yZXF1ZXN0X3Jl
c291cmNlcykoc3RydWN0IGlycV9kYXRhICpkYXRhKTsKIHZvaWQgKCppcnFfcmVsZWFzZV9y
ZXNvdXJjZXMpKHN0cnVjdCBpcnFfZGF0YSAqZGF0YSk7Cgogdm9pZCAoKmlycV9jb21wb3Nl
X21zaV9tc2cpKHN0cnVjdCBpcnFfZGF0YSAqZGF0YSwgc3RydWN0IG1zaV9tc2cgKm1zZyk7
CiB2b2lkICgqaXJxX3dyaXRlX21zaV9tc2cpKHN0cnVjdCBpcnFfZGF0YSAqZGF0YSwgc3Ry
dWN0IG1zaV9tc2cgKm1zZyk7CgogaW50ICgqaXJxX2dldF9pcnFjaGlwX3N0YXRlKShzdHJ1
Y3QgaXJxX2RhdGEgKmRhdGEsIGVudW0gaXJxY2hpcF9pcnFfc3RhdGUgd2hpY2gsIGJvb2wg
KnN0YXRlKTsKIGludCAoKmlycV9zZXRfaXJxY2hpcF9zdGF0ZSkoc3RydWN0IGlycV9kYXRh
ICpkYXRhLCBlbnVtIGlycWNoaXBfaXJxX3N0YXRlIHdoaWNoLCBib29sIHN0YXRlKTsKCiBp
bnQgKCppcnFfc2V0X3ZjcHVfYWZmaW5pdHkpKHN0cnVjdCBpcnFfZGF0YSAqZGF0YSwgdm9p
ZCAqdmNwdV9pbmZvKTsKCiB2b2lkICgqaXBpX3NlbmRfc2luZ2xlKShzdHJ1Y3QgaXJxX2Rh
dGEgKmRhdGEsIHVuc2lnbmVkIGludCBjcHUpOwogdm9pZCAoKmlwaV9zZW5kX21hc2spKHN0
cnVjdCBpcnFfZGF0YSAqZGF0YSwgY29uc3Qgc3RydWN0IGNwdW1hc2sgKmRlc3QpOwoKIGlu
dCAoKmlycV9ubWlfc2V0dXApKHN0cnVjdCBpcnFfZGF0YSAqZGF0YSk7CiB2b2lkICgqaXJx
X25taV90ZWFyZG93bikoc3RydWN0IGlycV9kYXRhICpkYXRhKTsKCiB1bnNpZ25lZCBsb25n
IGZsYWdzOwp9OwojIDU0NiAiLi9pbmNsdWRlL2xpbnV4L2lycS5oIgplbnVtIHsKIElSUUNI
SVBfU0VUX1RZUEVfTUFTS0VEID0gKDEgPDwgMCksCiBJUlFDSElQX0VPSV9JRl9IQU5ETEVE
ID0gKDEgPDwgMSksCiBJUlFDSElQX01BU0tfT05fU1VTUEVORCA9ICgxIDw8IDIpLAogSVJR
Q0hJUF9PTk9GRkxJTkVfRU5BQkxFRCA9ICgxIDw8IDMpLAogSVJRQ0hJUF9TS0lQX1NFVF9X
QUtFID0gKDEgPDwgNCksCiBJUlFDSElQX09ORVNIT1RfU0FGRSA9ICgxIDw8IDUpLAogSVJR
Q0hJUF9FT0lfVEhSRUFERUQgPSAoMSA8PCA2KSwKIElSUUNISVBfU1VQUE9SVFNfTEVWRUxf
TVNJID0gKDEgPDwgNyksCiBJUlFDSElQX1NVUFBPUlRTX05NSSA9ICgxIDw8IDgpLAp9OwoK
IyAxICIuL2luY2x1ZGUvbGludXgvaXJxZGVzYy5oIiAxCiMgMTMgIi4vaW5jbHVkZS9saW51
eC9pcnFkZXNjLmgiCnN0cnVjdCBpcnFfYWZmaW5pdHlfbm90aWZ5OwpzdHJ1Y3QgcHJvY19k
aXJfZW50cnk7CnN0cnVjdCBtb2R1bGU7CnN0cnVjdCBpcnFfZGVzYzsKc3RydWN0IGlycV9k
b21haW47CnN0cnVjdCBwdF9yZWdzOwojIDU2ICIuL2luY2x1ZGUvbGludXgvaXJxZGVzYy5o
IgpzdHJ1Y3QgaXJxX2Rlc2Mgewogc3RydWN0IGlycV9jb21tb25fZGF0YSBpcnFfY29tbW9u
X2RhdGE7CiBzdHJ1Y3QgaXJxX2RhdGEgaXJxX2RhdGE7CiB1bnNpZ25lZCBpbnQgKmtzdGF0
X2lycXM7CiBpcnFfZmxvd19oYW5kbGVyX3QgaGFuZGxlX2lycTsKCgoKIHN0cnVjdCBpcnFh
Y3Rpb24gKmFjdGlvbjsKIHVuc2lnbmVkIGludCBzdGF0dXNfdXNlX2FjY2Vzc29yczsKIHVu
c2lnbmVkIGludCBjb3JlX2ludGVybmFsX3N0YXRlX19kb19ub3RfbWVzc193aXRoX2l0Owog
dW5zaWduZWQgaW50IGRlcHRoOwogdW5zaWduZWQgaW50IHdha2VfZGVwdGg7CiB1bnNpZ25l
ZCBpbnQgdG90X2NvdW50OwogdW5zaWduZWQgaW50IGlycV9jb3VudDsKIHVuc2lnbmVkIGxv
bmcgbGFzdF91bmhhbmRsZWQ7CiB1bnNpZ25lZCBpbnQgaXJxc191bmhhbmRsZWQ7CiBhdG9t
aWNfdCB0aHJlYWRzX2hhbmRsZWQ7CiBpbnQgdGhyZWFkc19oYW5kbGVkX2xhc3Q7CiByYXdf
c3BpbmxvY2tfdCBsb2NrOwogc3RydWN0IGNwdW1hc2sgKnBlcmNwdV9lbmFibGVkOwogY29u
c3Qgc3RydWN0IGNwdW1hc2sgKnBlcmNwdV9hZmZpbml0eTsKCiBjb25zdCBzdHJ1Y3QgY3B1
bWFzayAqYWZmaW5pdHlfaGludDsKIHN0cnVjdCBpcnFfYWZmaW5pdHlfbm90aWZ5ICphZmZp
bml0eV9ub3RpZnk7CgoKCgogdW5zaWduZWQgbG9uZyB0aHJlYWRzX29uZXNob3Q7CiBhdG9t
aWNfdCB0aHJlYWRzX2FjdGl2ZTsKIHdhaXRfcXVldWVfaGVhZF90IHdhaXRfZm9yX3RocmVh
ZHM7CgoKCgoKCgogc3RydWN0IHByb2NfZGlyX2VudHJ5ICpkaXI7CgoKCgoKCiBzdHJ1Y3Qg
Y2FsbGJhY2tfaGVhZCByY3U7CiBzdHJ1Y3Qga29iamVjdCBrb2JqOwoKIHN0cnVjdCBtdXRl
eCByZXF1ZXN0X211dGV4OwogaW50IHBhcmVudF9pcnE7CiBzdHJ1Y3QgbW9kdWxlICpvd25l
cjsKIGNvbnN0IGNoYXIgKm5hbWU7Cn0gX19hdHRyaWJ1dGVfXygoX19hbGlnbmVkX18oMSA8
PCAoNikpKSk7CgoKZXh0ZXJuIHZvaWQgaXJxX2xvY2tfc3BhcnNlKHZvaWQpOwpleHRlcm4g
dm9pZCBpcnFfdW5sb2NrX3NwYXJzZSh2b2lkKTsKCgoKCgoKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHN0cnVjdCBp
cnFfZGVzYyAqaXJxX2RhdGFfdG9fZGVzYyhzdHJ1Y3QgaXJxX2RhdGEgKmRhdGEpCnsKIHJl
dHVybiAoeyB2b2lkICpfX21wdHIgPSAodm9pZCAqKShkYXRhLT5jb21tb24pOyBkbyB7IGV4
dGVybiB2b2lkIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzE4Nyh2b2lkKSBfX2F0dHJpYnV0ZV9f
KChfX2Vycm9yX18oInBvaW50ZXIgdHlwZSBtaXNtYXRjaCBpbiBjb250YWluZXJfb2YoKSIp
KSk7IGlmICghKCEoIV9fYnVpbHRpbl90eXBlc19jb21wYXRpYmxlX3AodHlwZW9mKCooZGF0
YS0+Y29tbW9uKSksIHR5cGVvZigoKHN0cnVjdCBpcnFfZGVzYyAqKTApLT5pcnFfY29tbW9u
X2RhdGEpKSAmJiAhX19idWlsdGluX3R5cGVzX2NvbXBhdGlibGVfcCh0eXBlb2YoKihkYXRh
LT5jb21tb24pKSwgdHlwZW9mKHZvaWQpKSkpKSBfX2NvbXBpbGV0aW1lX2Fzc2VydF8xODco
KTsgfSB3aGlsZSAoMCk7ICgoc3RydWN0IGlycV9kZXNjICopKF9fbXB0ciAtIF9fYnVpbHRp
bl9vZmZzZXRvZihzdHJ1Y3QgaXJxX2Rlc2MsIGlycV9jb21tb25fZGF0YSkpKTsgfSk7Cn0K
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSB1bnNpZ25lZCBpbnQgaXJxX2Rlc2NfZ2V0X2lycShzdHJ1Y3QgaXJxX2Rl
c2MgKmRlc2MpCnsKIHJldHVybiBkZXNjLT5pcnFfZGF0YS5pcnE7Cn0KCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBz
dHJ1Y3QgaXJxX2RhdGEgKmlycV9kZXNjX2dldF9pcnFfZGF0YShzdHJ1Y3QgaXJxX2Rlc2Mg
KmRlc2MpCnsKIHJldHVybiAmZGVzYy0+aXJxX2RhdGE7Cn0KCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3Qg
aXJxX2NoaXAgKmlycV9kZXNjX2dldF9jaGlwKHN0cnVjdCBpcnFfZGVzYyAqZGVzYykKewog
cmV0dXJuIGRlc2MtPmlycV9kYXRhLmNoaXA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkICppcnFfZGVz
Y19nZXRfY2hpcF9kYXRhKHN0cnVjdCBpcnFfZGVzYyAqZGVzYykKewogcmV0dXJuIGRlc2Mt
PmlycV9kYXRhLmNoaXBfZGF0YTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgKmlycV9kZXNjX2dldF9o
YW5kbGVyX2RhdGEoc3RydWN0IGlycV9kZXNjICpkZXNjKQp7CiByZXR1cm4gZGVzYy0+aXJx
X2NvbW1vbl9kYXRhLmhhbmRsZXJfZGF0YTsKfQoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGdlbmVy
aWNfaGFuZGxlX2lycV9kZXNjKHN0cnVjdCBpcnFfZGVzYyAqZGVzYykKewogZGVzYy0+aGFu
ZGxlX2lycShkZXNjKTsKfQoKaW50IGdlbmVyaWNfaGFuZGxlX2lycSh1bnNpZ25lZCBpbnQg
aXJxKTsKIyAxODQgIi4vaW5jbHVkZS9saW51eC9pcnFkZXNjLmgiCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQg
aXJxX2Rlc2NfaGFzX2FjdGlvbihzdHJ1Y3QgaXJxX2Rlc2MgKmRlc2MpCnsKIHJldHVybiBk
ZXNjLT5hY3Rpb24gIT0gKCh2b2lkICopMCk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgaXJxX2hhc19h
Y3Rpb24odW5zaWduZWQgaW50IGlycSkKewogcmV0dXJuIGlycV9kZXNjX2hhc19hY3Rpb24o
aXJxX3RvX2Rlc2MoaXJxKSk7Cn0KIyAyMDQgIi4vaW5jbHVkZS9saW51eC9pcnFkZXNjLmgi
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSB2b2lkIGlycV9zZXRfaGFuZGxlcl9sb2NrZWQoc3RydWN0IGlycV9kYXRh
ICpkYXRhLAogICAgICAgaXJxX2Zsb3dfaGFuZGxlcl90IGhhbmRsZXIpCnsKIHN0cnVjdCBp
cnFfZGVzYyAqZGVzYyA9IGlycV9kYXRhX3RvX2Rlc2MoZGF0YSk7CgogZGVzYy0+aGFuZGxl
X2lycSA9IGhhbmRsZXI7Cn0KIyAyMjQgIi4vaW5jbHVkZS9saW51eC9pcnFkZXNjLmgiCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSB2b2lkCmlycV9zZXRfY2hpcF9oYW5kbGVyX25hbWVfbG9ja2VkKHN0cnVjdCBp
cnFfZGF0YSAqZGF0YSwgc3RydWN0IGlycV9jaGlwICpjaGlwLAogICAgIGlycV9mbG93X2hh
bmRsZXJfdCBoYW5kbGVyLCBjb25zdCBjaGFyICpuYW1lKQp7CiBzdHJ1Y3QgaXJxX2Rlc2Mg
KmRlc2MgPSBpcnFfZGF0YV90b19kZXNjKGRhdGEpOwoKIGRlc2MtPmhhbmRsZV9pcnEgPSBo
YW5kbGVyOwogZGVzYy0+bmFtZSA9IG5hbWU7CiBkYXRhLT5jaGlwID0gY2hpcDsKfQoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIGJvb2wgaXJxX2JhbGFuY2luZ19kaXNhYmxlZCh1bnNpZ25lZCBpbnQgaXJxKQp7
CiBzdHJ1Y3QgaXJxX2Rlc2MgKmRlc2M7CgogZGVzYyA9IGlycV90b19kZXNjKGlycSk7CiBy
ZXR1cm4gZGVzYy0+c3RhdHVzX3VzZV9hY2Nlc3NvcnMgJiAoSVJRX1BFUl9DUFUgfCBJUlFf
Tk9fQkFMQU5DSU5HKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgaXJxX2lzX3BlcmNwdSh1bnNpZ25l
ZCBpbnQgaXJxKQp7CiBzdHJ1Y3QgaXJxX2Rlc2MgKmRlc2M7CgogZGVzYyA9IGlycV90b19k
ZXNjKGlycSk7CiByZXR1cm4gZGVzYy0+c3RhdHVzX3VzZV9hY2Nlc3NvcnMgJiBJUlFfUEVS
X0NQVTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgaXJxX2lzX3BlcmNwdV9kZXZpZCh1bnNpZ25lZCBp
bnQgaXJxKQp7CiBzdHJ1Y3QgaXJxX2Rlc2MgKmRlc2M7CgogZGVzYyA9IGlycV90b19kZXNj
KGlycSk7CiByZXR1cm4gZGVzYy0+c3RhdHVzX3VzZV9hY2Nlc3NvcnMgJiBJUlFfUEVSX0NQ
VV9ERVZJRDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQKaXJxX3NldF9sb2NrZGVwX2NsYXNzKHVuc2ln
bmVkIGludCBpcnEsIHN0cnVjdCBsb2NrX2NsYXNzX2tleSAqbG9ja19jbGFzcywKICAgICAg
ICBzdHJ1Y3QgbG9ja19jbGFzc19rZXkgKnJlcXVlc3RfY2xhc3MpCnsKIHN0cnVjdCBpcnFf
ZGVzYyAqZGVzYyA9IGlycV90b19kZXNjKGlycSk7CgogaWYgKGRlc2MpIHsKICBkbyB7ICh2
b2lkKShsb2NrX2NsYXNzKTsgfSB3aGlsZSAoMCk7CiAgZG8geyAodm9pZCkocmVxdWVzdF9j
bGFzcyk7IH0gd2hpbGUgKDApOwogfQp9CiMgNTU5ICIuL2luY2x1ZGUvbGludXgvaXJxLmgi
IDIKIyA1NzUgIi4vaW5jbHVkZS9saW51eC9pcnEuaCIKc3RydWN0IGlycWFjdGlvbjsKZXh0
ZXJuIGludCBzZXR1cF9wZXJjcHVfaXJxKHVuc2lnbmVkIGludCBpcnEsIHN0cnVjdCBpcnFh
Y3Rpb24gKm5ldyk7CmV4dGVybiB2b2lkIHJlbW92ZV9wZXJjcHVfaXJxKHVuc2lnbmVkIGlu
dCBpcnEsIHN0cnVjdCBpcnFhY3Rpb24gKmFjdCk7CgpleHRlcm4gdm9pZCBpcnFfY3B1X29u
bGluZSh2b2lkKTsKZXh0ZXJuIHZvaWQgaXJxX2NwdV9vZmZsaW5lKHZvaWQpOwpleHRlcm4g
aW50IGlycV9zZXRfYWZmaW5pdHlfbG9ja2VkKHN0cnVjdCBpcnFfZGF0YSAqZGF0YSwKICAg
ICAgIGNvbnN0IHN0cnVjdCBjcHVtYXNrICpjcHVtYXNrLCBib29sIGZvcmNlKTsKZXh0ZXJu
IGludCBpcnFfc2V0X3ZjcHVfYWZmaW5pdHkodW5zaWduZWQgaW50IGlycSwgdm9pZCAqdmNw
dV9pbmZvKTsKCgpleHRlcm4gdm9pZCBpcnFfbWlncmF0ZV9hbGxfb2ZmX3RoaXNfY3B1KHZv
aWQpOwpleHRlcm4gaW50IGlycV9hZmZpbml0eV9vbmxpbmVfY3B1KHVuc2lnbmVkIGludCBj
cHUpOwojIDYwMiAiLi9pbmNsdWRlL2xpbnV4L2lycS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBpcnFf
bW92ZV9pcnEoc3RydWN0IGlycV9kYXRhICpkYXRhKSB7IH0Kc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgaXJx
X21vdmVfbWFza2VkX2lycShzdHJ1Y3QgaXJxX2RhdGEgKmRhdGEpIHsgfQpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
dm9pZCBpcnFfZm9yY2VfY29tcGxldGVfbW92ZShzdHJ1Y3QgaXJxX2Rlc2MgKmRlc2MpIHsg
fQoKCmV4dGVybiBpbnQgbm9faXJxX2FmZmluaXR5OwoKCgoKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBpcnFf
c2V0X3BhcmVudChpbnQgaXJxLCBpbnQgcGFyZW50X2lycSkKewogcmV0dXJuIDA7Cn0KCgoK
CgoKZXh0ZXJuIHZvaWQgaGFuZGxlX2xldmVsX2lycShzdHJ1Y3QgaXJxX2Rlc2MgKmRlc2Mp
OwpleHRlcm4gdm9pZCBoYW5kbGVfZmFzdGVvaV9pcnEoc3RydWN0IGlycV9kZXNjICpkZXNj
KTsKZXh0ZXJuIHZvaWQgaGFuZGxlX2VkZ2VfaXJxKHN0cnVjdCBpcnFfZGVzYyAqZGVzYyk7
CmV4dGVybiB2b2lkIGhhbmRsZV9lZGdlX2VvaV9pcnEoc3RydWN0IGlycV9kZXNjICpkZXNj
KTsKZXh0ZXJuIHZvaWQgaGFuZGxlX3NpbXBsZV9pcnEoc3RydWN0IGlycV9kZXNjICpkZXNj
KTsKZXh0ZXJuIHZvaWQgaGFuZGxlX3VudHJhY2tlZF9pcnEoc3RydWN0IGlycV9kZXNjICpk
ZXNjKTsKZXh0ZXJuIHZvaWQgaGFuZGxlX3BlcmNwdV9pcnEoc3RydWN0IGlycV9kZXNjICpk
ZXNjKTsKZXh0ZXJuIHZvaWQgaGFuZGxlX3BlcmNwdV9kZXZpZF9pcnEoc3RydWN0IGlycV9k
ZXNjICpkZXNjKTsKZXh0ZXJuIHZvaWQgaGFuZGxlX2JhZF9pcnEoc3RydWN0IGlycV9kZXNj
ICpkZXNjKTsKZXh0ZXJuIHZvaWQgaGFuZGxlX25lc3RlZF9pcnEodW5zaWduZWQgaW50IGly
cSk7CgpleHRlcm4gdm9pZCBoYW5kbGVfZmFzdGVvaV9ubWkoc3RydWN0IGlycV9kZXNjICpk
ZXNjKTsKZXh0ZXJuIHZvaWQgaGFuZGxlX3BlcmNwdV9kZXZpZF9mYXN0ZW9pX25taShzdHJ1
Y3QgaXJxX2Rlc2MgKmRlc2MpOwoKZXh0ZXJuIGludCBpcnFfY2hpcF9jb21wb3NlX21zaV9t
c2coc3RydWN0IGlycV9kYXRhICpkYXRhLCBzdHJ1Y3QgbXNpX21zZyAqbXNnKTsKZXh0ZXJu
IGludCBpcnFfY2hpcF9wbV9nZXQoc3RydWN0IGlycV9kYXRhICpkYXRhKTsKZXh0ZXJuIGlu
dCBpcnFfY2hpcF9wbV9wdXQoc3RydWN0IGlycV9kYXRhICpkYXRhKTsKCmV4dGVybiB2b2lk
IGhhbmRsZV9mYXN0ZW9pX2Fja19pcnEoc3RydWN0IGlycV9kZXNjICpkZXNjKTsKZXh0ZXJu
IHZvaWQgaGFuZGxlX2Zhc3Rlb2lfbWFza19pcnEoc3RydWN0IGlycV9kZXNjICpkZXNjKTsK
ZXh0ZXJuIGludCBpcnFfY2hpcF9zZXRfcGFyZW50X3N0YXRlKHN0cnVjdCBpcnFfZGF0YSAq
ZGF0YSwKICAgICAgICAgZW51bSBpcnFjaGlwX2lycV9zdGF0ZSB3aGljaCwKICAgICAgICAg
Ym9vbCB2YWwpOwpleHRlcm4gaW50IGlycV9jaGlwX2dldF9wYXJlbnRfc3RhdGUoc3RydWN0
IGlycV9kYXRhICpkYXRhLAogICAgICAgICBlbnVtIGlycWNoaXBfaXJxX3N0YXRlIHdoaWNo
LAogICAgICAgICBib29sICpzdGF0ZSk7CmV4dGVybiB2b2lkIGlycV9jaGlwX2VuYWJsZV9w
YXJlbnQoc3RydWN0IGlycV9kYXRhICpkYXRhKTsKZXh0ZXJuIHZvaWQgaXJxX2NoaXBfZGlz
YWJsZV9wYXJlbnQoc3RydWN0IGlycV9kYXRhICpkYXRhKTsKZXh0ZXJuIHZvaWQgaXJxX2No
aXBfYWNrX3BhcmVudChzdHJ1Y3QgaXJxX2RhdGEgKmRhdGEpOwpleHRlcm4gaW50IGlycV9j
aGlwX3JldHJpZ2dlcl9oaWVyYXJjaHkoc3RydWN0IGlycV9kYXRhICpkYXRhKTsKZXh0ZXJu
IHZvaWQgaXJxX2NoaXBfbWFza19wYXJlbnQoc3RydWN0IGlycV9kYXRhICpkYXRhKTsKZXh0
ZXJuIHZvaWQgaXJxX2NoaXBfbWFza19hY2tfcGFyZW50KHN0cnVjdCBpcnFfZGF0YSAqZGF0
YSk7CmV4dGVybiB2b2lkIGlycV9jaGlwX3VubWFza19wYXJlbnQoc3RydWN0IGlycV9kYXRh
ICpkYXRhKTsKZXh0ZXJuIHZvaWQgaXJxX2NoaXBfZW9pX3BhcmVudChzdHJ1Y3QgaXJxX2Rh
dGEgKmRhdGEpOwpleHRlcm4gaW50IGlycV9jaGlwX3NldF9hZmZpbml0eV9wYXJlbnQoc3Ry
dWN0IGlycV9kYXRhICpkYXRhLAogICAgIGNvbnN0IHN0cnVjdCBjcHVtYXNrICpkZXN0LAog
ICAgIGJvb2wgZm9yY2UpOwpleHRlcm4gaW50IGlycV9jaGlwX3NldF93YWtlX3BhcmVudChz
dHJ1Y3QgaXJxX2RhdGEgKmRhdGEsIHVuc2lnbmVkIGludCBvbik7CmV4dGVybiBpbnQgaXJx
X2NoaXBfc2V0X3ZjcHVfYWZmaW5pdHlfcGFyZW50KHN0cnVjdCBpcnFfZGF0YSAqZGF0YSwK
ICAgICAgICAgIHZvaWQgKnZjcHVfaW5mbyk7CmV4dGVybiBpbnQgaXJxX2NoaXBfc2V0X3R5
cGVfcGFyZW50KHN0cnVjdCBpcnFfZGF0YSAqZGF0YSwgdW5zaWduZWQgaW50IHR5cGUpOwpl
eHRlcm4gaW50IGlycV9jaGlwX3JlcXVlc3RfcmVzb3VyY2VzX3BhcmVudChzdHJ1Y3QgaXJx
X2RhdGEgKmRhdGEpOwpleHRlcm4gdm9pZCBpcnFfY2hpcF9yZWxlYXNlX3Jlc291cmNlc19w
YXJlbnQoc3RydWN0IGlycV9kYXRhICpkYXRhKTsKCgoKZXh0ZXJuIHZvaWQgbm90ZV9pbnRl
cnJ1cHQoc3RydWN0IGlycV9kZXNjICpkZXNjLCBpcnFyZXR1cm5fdCBhY3Rpb25fcmV0KTsK
CgoKZXh0ZXJuIGludCBub2lycWRlYnVnX3NldHVwKGNoYXIgKnN0cik7CgoKZXh0ZXJuIGlu
dCBjYW5fcmVxdWVzdF9pcnEodW5zaWduZWQgaW50IGlycSwgdW5zaWduZWQgbG9uZyBpcnFm
bGFncyk7CgoKZXh0ZXJuIHN0cnVjdCBpcnFfY2hpcCBub19pcnFfY2hpcDsKZXh0ZXJuIHN0
cnVjdCBpcnFfY2hpcCBkdW1teV9pcnFfY2hpcDsKCmV4dGVybiB2b2lkCmlycV9zZXRfY2hp
cF9hbmRfaGFuZGxlcl9uYW1lKHVuc2lnbmVkIGludCBpcnEsIHN0cnVjdCBpcnFfY2hpcCAq
Y2hpcCwKICAgICAgICAgaXJxX2Zsb3dfaGFuZGxlcl90IGhhbmRsZSwgY29uc3QgY2hhciAq
bmFtZSk7CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBpcnFfc2V0X2NoaXBfYW5kX2hhbmRsZXIodW5zaWdu
ZWQgaW50IGlycSwgc3RydWN0IGlycV9jaGlwICpjaGlwLAogICAgICAgICBpcnFfZmxvd19o
YW5kbGVyX3QgaGFuZGxlKQp7CiBpcnFfc2V0X2NoaXBfYW5kX2hhbmRsZXJfbmFtZShpcnEs
IGNoaXAsIGhhbmRsZSwgKCh2b2lkICopMCkpOwp9CgpleHRlcm4gaW50IGlycV9zZXRfcGVy
Y3B1X2RldmlkKHVuc2lnbmVkIGludCBpcnEpOwpleHRlcm4gaW50IGlycV9zZXRfcGVyY3B1
X2RldmlkX3BhcnRpdGlvbih1bnNpZ25lZCBpbnQgaXJxLAogICAgICAgY29uc3Qgc3RydWN0
IGNwdW1hc2sgKmFmZmluaXR5KTsKZXh0ZXJuIGludCBpcnFfZ2V0X3BlcmNwdV9kZXZpZF9w
YXJ0aXRpb24odW5zaWduZWQgaW50IGlycSwKICAgICAgIHN0cnVjdCBjcHVtYXNrICphZmZp
bml0eSk7CgpleHRlcm4gdm9pZApfX2lycV9zZXRfaGFuZGxlcih1bnNpZ25lZCBpbnQgaXJx
LCBpcnFfZmxvd19oYW5kbGVyX3QgaGFuZGxlLCBpbnQgaXNfY2hhaW5lZCwKICAgIGNvbnN0
IGNoYXIgKm5hbWUpOwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQKaXJxX3NldF9oYW5kbGVyKHVuc2lnbmVk
IGludCBpcnEsIGlycV9mbG93X2hhbmRsZXJfdCBoYW5kbGUpCnsKIF9faXJxX3NldF9oYW5k
bGVyKGlycSwgaGFuZGxlLCAwLCAoKHZvaWQgKikwKSk7Cn0KCgoKCgoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZv
aWQKaXJxX3NldF9jaGFpbmVkX2hhbmRsZXIodW5zaWduZWQgaW50IGlycSwgaXJxX2Zsb3df
aGFuZGxlcl90IGhhbmRsZSkKewogX19pcnFfc2V0X2hhbmRsZXIoaXJxLCBoYW5kbGUsIDEs
ICgodm9pZCAqKTApKTsKfQoKCgoKCgp2b2lkCmlycV9zZXRfY2hhaW5lZF9oYW5kbGVyX2Fu
ZF9kYXRhKHVuc2lnbmVkIGludCBpcnEsIGlycV9mbG93X2hhbmRsZXJfdCBoYW5kbGUsCiAg
ICAgdm9pZCAqZGF0YSk7Cgp2b2lkIGlycV9tb2RpZnlfc3RhdHVzKHVuc2lnbmVkIGludCBp
cnEsIHVuc2lnbmVkIGxvbmcgY2xyLCB1bnNpZ25lZCBsb25nIHNldCk7CgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
dm9pZCBpcnFfc2V0X3N0YXR1c19mbGFncyh1bnNpZ25lZCBpbnQgaXJxLCB1bnNpZ25lZCBs
b25nIHNldCkKewogaXJxX21vZGlmeV9zdGF0dXMoaXJxLCAwLCBzZXQpOwp9CgpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgdm9pZCBpcnFfY2xlYXJfc3RhdHVzX2ZsYWdzKHVuc2lnbmVkIGludCBpcnEsIHVuc2ln
bmVkIGxvbmcgY2xyKQp7CiBpcnFfbW9kaWZ5X3N0YXR1cyhpcnEsIGNsciwgMCk7Cn0KCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSB2b2lkIGlycV9zZXRfbm9wcm9iZSh1bnNpZ25lZCBpbnQgaXJxKQp7CiBpcnFf
bW9kaWZ5X3N0YXR1cyhpcnEsIDAsIElSUV9OT1BST0JFKTsKfQoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQg
aXJxX3NldF9wcm9iZSh1bnNpZ25lZCBpbnQgaXJxKQp7CiBpcnFfbW9kaWZ5X3N0YXR1cyhp
cnEsIElSUV9OT1BST0JFLCAwKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgaXJxX3NldF9ub3RocmVh
ZCh1bnNpZ25lZCBpbnQgaXJxKQp7CiBpcnFfbW9kaWZ5X3N0YXR1cyhpcnEsIDAsIElSUV9O
T1RIUkVBRCk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGlycV9zZXRfdGhyZWFkKHVuc2lnbmVkIGlu
dCBpcnEpCnsKIGlycV9tb2RpZnlfc3RhdHVzKGlycSwgSVJRX05PVEhSRUFELCAwKTsKfQoK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIHZvaWQgaXJxX3NldF9uZXN0ZWRfdGhyZWFkKHVuc2lnbmVkIGludCBpcnEs
IGJvb2wgbmVzdCkKewogaWYgKG5lc3QpCiAgaXJxX3NldF9zdGF0dXNfZmxhZ3MoaXJxLCBJ
UlFfTkVTVEVEX1RIUkVBRCk7CiBlbHNlCiAgaXJxX2NsZWFyX3N0YXR1c19mbGFncyhpcnEs
IElSUV9ORVNURURfVEhSRUFEKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgaXJxX3NldF9wZXJjcHVf
ZGV2aWRfZmxhZ3ModW5zaWduZWQgaW50IGlycSkKewogaXJxX3NldF9zdGF0dXNfZmxhZ3Mo
aXJxLAogICAgICAgIElSUV9OT0FVVE9FTiB8IElSUV9QRVJfQ1BVIHwgSVJRX05PVEhSRUFE
IHwKICAgICAgICBJUlFfTk9QUk9CRSB8IElSUV9QRVJfQ1BVX0RFVklEKTsKfQoKCmV4dGVy
biBpbnQgaXJxX3NldF9jaGlwKHVuc2lnbmVkIGludCBpcnEsIHN0cnVjdCBpcnFfY2hpcCAq
Y2hpcCk7CmV4dGVybiBpbnQgaXJxX3NldF9oYW5kbGVyX2RhdGEodW5zaWduZWQgaW50IGly
cSwgdm9pZCAqZGF0YSk7CmV4dGVybiBpbnQgaXJxX3NldF9jaGlwX2RhdGEodW5zaWduZWQg
aW50IGlycSwgdm9pZCAqZGF0YSk7CmV4dGVybiBpbnQgaXJxX3NldF9pcnFfdHlwZSh1bnNp
Z25lZCBpbnQgaXJxLCB1bnNpZ25lZCBpbnQgdHlwZSk7CmV4dGVybiBpbnQgaXJxX3NldF9t
c2lfZGVzYyh1bnNpZ25lZCBpbnQgaXJxLCBzdHJ1Y3QgbXNpX2Rlc2MgKmVudHJ5KTsKZXh0
ZXJuIGludCBpcnFfc2V0X21zaV9kZXNjX29mZih1bnNpZ25lZCBpbnQgaXJxX2Jhc2UsIHVu
c2lnbmVkIGludCBpcnFfb2Zmc2V0LAogICAgc3RydWN0IG1zaV9kZXNjICplbnRyeSk7CmV4
dGVybiBzdHJ1Y3QgaXJxX2RhdGEgKmlycV9nZXRfaXJxX2RhdGEodW5zaWduZWQgaW50IGly
cSk7CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgc3RydWN0IGlycV9jaGlwICppcnFfZ2V0X2NoaXAodW5zaWduZWQg
aW50IGlycSkKewogc3RydWN0IGlycV9kYXRhICpkID0gaXJxX2dldF9pcnFfZGF0YShpcnEp
OwogcmV0dXJuIGQgPyBkLT5jaGlwIDogKCh2b2lkICopMCk7Cn0KCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1
Y3QgaXJxX2NoaXAgKmlycV9kYXRhX2dldF9pcnFfY2hpcChzdHJ1Y3QgaXJxX2RhdGEgKmQp
CnsKIHJldHVybiBkLT5jaGlwOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCAqaXJxX2dldF9jaGlwX2Rh
dGEodW5zaWduZWQgaW50IGlycSkKewogc3RydWN0IGlycV9kYXRhICpkID0gaXJxX2dldF9p
cnFfZGF0YShpcnEpOwogcmV0dXJuIGQgPyBkLT5jaGlwX2RhdGEgOiAoKHZvaWQgKikwKTsK
fQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIHZvaWQgKmlycV9kYXRhX2dldF9pcnFfY2hpcF9kYXRhKHN0cnVjdCBp
cnFfZGF0YSAqZCkKewogcmV0dXJuIGQtPmNoaXBfZGF0YTsKfQoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQg
KmlycV9nZXRfaGFuZGxlcl9kYXRhKHVuc2lnbmVkIGludCBpcnEpCnsKIHN0cnVjdCBpcnFf
ZGF0YSAqZCA9IGlycV9nZXRfaXJxX2RhdGEoaXJxKTsKIHJldHVybiBkID8gZC0+Y29tbW9u
LT5oYW5kbGVyX2RhdGEgOiAoKHZvaWQgKikwKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgKmlycV9k
YXRhX2dldF9pcnFfaGFuZGxlcl9kYXRhKHN0cnVjdCBpcnFfZGF0YSAqZCkKewogcmV0dXJu
IGQtPmNvbW1vbi0+aGFuZGxlcl9kYXRhOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IG1zaV9kZXNj
ICppcnFfZ2V0X21zaV9kZXNjKHVuc2lnbmVkIGludCBpcnEpCnsKIHN0cnVjdCBpcnFfZGF0
YSAqZCA9IGlycV9nZXRfaXJxX2RhdGEoaXJxKTsKIHJldHVybiBkID8gZC0+Y29tbW9uLT5t
c2lfZGVzYyA6ICgodm9pZCAqKTApOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IG1zaV9kZXNjICpp
cnFfZGF0YV9nZXRfbXNpX2Rlc2Moc3RydWN0IGlycV9kYXRhICpkKQp7CiByZXR1cm4gZC0+
Y29tbW9uLT5tc2lfZGVzYzsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHUzMiBpcnFfZ2V0X3RyaWdnZXJfdHlw
ZSh1bnNpZ25lZCBpbnQgaXJxKQp7CiBzdHJ1Y3QgaXJxX2RhdGEgKmQgPSBpcnFfZ2V0X2ly
cV9kYXRhKGlycSk7CiByZXR1cm4gZCA/IGlycWRfZ2V0X3RyaWdnZXJfdHlwZShkKSA6IDA7
Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSBpbnQgaXJxX2NvbW1vbl9kYXRhX2dldF9ub2RlKHN0cnVjdCBpcnFf
Y29tbW9uX2RhdGEgKmQpCnsKCgoKIHJldHVybiAwOwoKfQoKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBpcnFf
ZGF0YV9nZXRfbm9kZShzdHJ1Y3QgaXJxX2RhdGEgKmQpCnsKIHJldHVybiBpcnFfY29tbW9u
X2RhdGFfZ2V0X25vZGUoZC0+Y29tbW9uKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHN0cnVjdCBjcHVtYXNr
ICppcnFfZ2V0X2FmZmluaXR5X21hc2soaW50IGlycSkKewogc3RydWN0IGlycV9kYXRhICpk
ID0gaXJxX2dldF9pcnFfZGF0YShpcnEpOwoKIHJldHVybiBkID8gZC0+Y29tbW9uLT5hZmZp
bml0eSA6ICgodm9pZCAqKTApOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IGNwdW1hc2sgKmlycV9k
YXRhX2dldF9hZmZpbml0eV9tYXNrKHN0cnVjdCBpcnFfZGF0YSAqZCkKewogcmV0dXJuIGQt
PmNvbW1vbi0+YWZmaW5pdHk7Cn0KIyA4NzIgIi4vaW5jbHVkZS9saW51eC9pcnEuaCIKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIHZvaWQgaXJxX2RhdGFfdXBkYXRlX2VmZmVjdGl2ZV9hZmZpbml0eShzdHJ1Y3Qg
aXJxX2RhdGEgKmQsCiAgICAgICAgICAgIGNvbnN0IHN0cnVjdCBjcHVtYXNrICptKQp7Cn0K
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpCnN0cnVjdCBjcHVtYXNrICppcnFfZGF0YV9nZXRfZWZmZWN0aXZlX2FmZmlu
aXR5X21hc2soc3RydWN0IGlycV9kYXRhICpkKQp7CiByZXR1cm4gZC0+Y29tbW9uLT5hZmZp
bml0eTsKfQoKCnVuc2lnbmVkIGludCBhcmNoX2R5bmlycV9sb3dlcl9ib3VuZCh1bnNpZ25l
ZCBpbnQgZnJvbSk7CgppbnQgX19pcnFfYWxsb2NfZGVzY3MoaW50IGlycSwgdW5zaWduZWQg
aW50IGZyb20sIHVuc2lnbmVkIGludCBjbnQsIGludCBub2RlLAogICAgICAgIHN0cnVjdCBt
b2R1bGUgKm93bmVyLAogICAgICAgIGNvbnN0IHN0cnVjdCBpcnFfYWZmaW5pdHlfZGVzYyAq
YWZmaW5pdHkpOwoKaW50IF9fZGV2bV9pcnFfYWxsb2NfZGVzY3Moc3RydWN0IGRldmljZSAq
ZGV2LCBpbnQgaXJxLCB1bnNpZ25lZCBpbnQgZnJvbSwKICAgICAgdW5zaWduZWQgaW50IGNu
dCwgaW50IG5vZGUsIHN0cnVjdCBtb2R1bGUgKm93bmVyLAogICAgICBjb25zdCBzdHJ1Y3Qg
aXJxX2FmZmluaXR5X2Rlc2MgKmFmZmluaXR5KTsKIyA5MjQgIi4vaW5jbHVkZS9saW51eC9p
cnEuaCIKdm9pZCBpcnFfZnJlZV9kZXNjcyh1bnNpZ25lZCBpbnQgaXJxLCB1bnNpZ25lZCBp
bnQgY250KTsKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgaXJxX2ZyZWVfZGVzYyh1bnNpZ25lZCBpbnQgaXJx
KQp7CiBpcnFfZnJlZV9kZXNjcyhpcnEsIDEpOwp9CiMgOTU5ICIuL2luY2x1ZGUvbGludXgv
aXJxLmgiCnN0cnVjdCBpcnFfY2hpcF9yZWdzIHsKIHVuc2lnbmVkIGxvbmcgZW5hYmxlOwog
dW5zaWduZWQgbG9uZyBkaXNhYmxlOwogdW5zaWduZWQgbG9uZyBtYXNrOwogdW5zaWduZWQg
bG9uZyBhY2s7CiB1bnNpZ25lZCBsb25nIGVvaTsKIHVuc2lnbmVkIGxvbmcgdHlwZTsKIHVu
c2lnbmVkIGxvbmcgcG9sYXJpdHk7Cn07CiMgOTgyICIuL2luY2x1ZGUvbGludXgvaXJxLmgi
CnN0cnVjdCBpcnFfY2hpcF90eXBlIHsKIHN0cnVjdCBpcnFfY2hpcCBjaGlwOwogc3RydWN0
IGlycV9jaGlwX3JlZ3MgcmVnczsKIGlycV9mbG93X2hhbmRsZXJfdCBoYW5kbGVyOwogdTMy
IHR5cGU7CiB1MzIgbWFza19jYWNoZV9wcml2OwogdTMyICptYXNrX2NhY2hlOwp9OwojIDEw
MjQgIi4vaW5jbHVkZS9saW51eC9pcnEuaCIKc3RydWN0IGlycV9jaGlwX2dlbmVyaWMgewog
cmF3X3NwaW5sb2NrX3QgbG9jazsKIHZvaWQgKnJlZ19iYXNlOwogdTMyICgqcmVnX3JlYWRs
KSh2b2lkICphZGRyKTsKIHZvaWQgKCpyZWdfd3JpdGVsKSh1MzIgdmFsLCB2b2lkICphZGRy
KTsKIHZvaWQgKCpzdXNwZW5kKShzdHJ1Y3QgaXJxX2NoaXBfZ2VuZXJpYyAqZ2MpOwogdm9p
ZCAoKnJlc3VtZSkoc3RydWN0IGlycV9jaGlwX2dlbmVyaWMgKmdjKTsKIHVuc2lnbmVkIGlu
dCBpcnFfYmFzZTsKIHVuc2lnbmVkIGludCBpcnFfY250OwogdTMyIG1hc2tfY2FjaGU7CiB1
MzIgdHlwZV9jYWNoZTsKIHUzMiBwb2xhcml0eV9jYWNoZTsKIHUzMiB3YWtlX2VuYWJsZWQ7
CiB1MzIgd2FrZV9hY3RpdmU7CiB1bnNpZ25lZCBpbnQgbnVtX2N0Owogdm9pZCAqcHJpdmF0
ZTsKIHVuc2lnbmVkIGxvbmcgaW5zdGFsbGVkOwogdW5zaWduZWQgbG9uZyB1bnVzZWQ7CiBz
dHJ1Y3QgaXJxX2RvbWFpbiAqZG9tYWluOwogc3RydWN0IGxpc3RfaGVhZCBsaXN0Owogc3Ry
dWN0IGlycV9jaGlwX3R5cGUgY2hpcF90eXBlc1tdOwp9OwojIDEwNTcgIi4vaW5jbHVkZS9s
aW51eC9pcnEuaCIKZW51bSBpcnFfZ2NfZmxhZ3MgewogSVJRX0dDX0lOSVRfTUFTS19DQUNI
RSA9IDEgPDwgMCwKIElSUV9HQ19JTklUX05FU1RFRF9MT0NLID0gMSA8PCAxLAogSVJRX0dD
X01BU0tfQ0FDSEVfUEVSX1RZUEUgPSAxIDw8IDIsCiBJUlFfR0NfTk9fTUFTSyA9IDEgPDwg
MywKIElSUV9HQ19CRV9JTyA9IDEgPDwgNCwKfTsKIyAxMDc0ICIuL2luY2x1ZGUvbGludXgv
aXJxLmgiCnN0cnVjdCBpcnFfZG9tYWluX2NoaXBfZ2VuZXJpYyB7CiB1bnNpZ25lZCBpbnQg
aXJxc19wZXJfY2hpcDsKIHVuc2lnbmVkIGludCBudW1fY2hpcHM7CiB1bnNpZ25lZCBpbnQg
aXJxX2ZsYWdzX3RvX2NsZWFyOwogdW5zaWduZWQgaW50IGlycV9mbGFnc190b19zZXQ7CiBl
bnVtIGlycV9nY19mbGFncyBnY19mbGFnczsKIHN0cnVjdCBpcnFfY2hpcF9nZW5lcmljICpn
Y1tdOwp9OwoKCnZvaWQgaXJxX2djX25vb3Aoc3RydWN0IGlycV9kYXRhICpkKTsKdm9pZCBp
cnFfZ2NfbWFza19kaXNhYmxlX3JlZyhzdHJ1Y3QgaXJxX2RhdGEgKmQpOwp2b2lkIGlycV9n
Y19tYXNrX3NldF9iaXQoc3RydWN0IGlycV9kYXRhICpkKTsKdm9pZCBpcnFfZ2NfbWFza19j
bHJfYml0KHN0cnVjdCBpcnFfZGF0YSAqZCk7CnZvaWQgaXJxX2djX3VubWFza19lbmFibGVf
cmVnKHN0cnVjdCBpcnFfZGF0YSAqZCk7CnZvaWQgaXJxX2djX2Fja19zZXRfYml0KHN0cnVj
dCBpcnFfZGF0YSAqZCk7CnZvaWQgaXJxX2djX2Fja19jbHJfYml0KHN0cnVjdCBpcnFfZGF0
YSAqZCk7CnZvaWQgaXJxX2djX21hc2tfZGlzYWJsZV9hbmRfYWNrX3NldChzdHJ1Y3QgaXJx
X2RhdGEgKmQpOwp2b2lkIGlycV9nY19lb2koc3RydWN0IGlycV9kYXRhICpkKTsKaW50IGly
cV9nY19zZXRfd2FrZShzdHJ1Y3QgaXJxX2RhdGEgKmQsIHVuc2lnbmVkIGludCBvbik7CgoK
aW50IGlycV9tYXBfZ2VuZXJpY19jaGlwKHN0cnVjdCBpcnFfZG9tYWluICpkLCB1bnNpZ25l
ZCBpbnQgdmlycSwKICAgIGlycV9od19udW1iZXJfdCBod19pcnEpOwpzdHJ1Y3QgaXJxX2No
aXBfZ2VuZXJpYyAqCmlycV9hbGxvY19nZW5lcmljX2NoaXAoY29uc3QgY2hhciAqbmFtZSwg
aW50IG5yX2N0LCB1bnNpZ25lZCBpbnQgaXJxX2Jhc2UsCiAgICAgICAgIHZvaWQgKnJlZ19i
YXNlLCBpcnFfZmxvd19oYW5kbGVyX3QgaGFuZGxlcik7CnZvaWQgaXJxX3NldHVwX2dlbmVy
aWNfY2hpcChzdHJ1Y3QgaXJxX2NoaXBfZ2VuZXJpYyAqZ2MsIHUzMiBtc2ssCiAgICAgICBl
bnVtIGlycV9nY19mbGFncyBmbGFncywgdW5zaWduZWQgaW50IGNsciwKICAgICAgIHVuc2ln
bmVkIGludCBzZXQpOwppbnQgaXJxX3NldHVwX2FsdF9jaGlwKHN0cnVjdCBpcnFfZGF0YSAq
ZCwgdW5zaWduZWQgaW50IHR5cGUpOwp2b2lkIGlycV9yZW1vdmVfZ2VuZXJpY19jaGlwKHN0
cnVjdCBpcnFfY2hpcF9nZW5lcmljICpnYywgdTMyIG1zaywKICAgICAgICB1bnNpZ25lZCBp
bnQgY2xyLCB1bnNpZ25lZCBpbnQgc2V0KTsKCnN0cnVjdCBpcnFfY2hpcF9nZW5lcmljICoK
ZGV2bV9pcnFfYWxsb2NfZ2VuZXJpY19jaGlwKHN0cnVjdCBkZXZpY2UgKmRldiwgY29uc3Qg
Y2hhciAqbmFtZSwgaW50IG51bV9jdCwKICAgICAgIHVuc2lnbmVkIGludCBpcnFfYmFzZSwg
dm9pZCAqcmVnX2Jhc2UsCiAgICAgICBpcnFfZmxvd19oYW5kbGVyX3QgaGFuZGxlcik7Cmlu
dCBkZXZtX2lycV9zZXR1cF9nZW5lcmljX2NoaXAoc3RydWN0IGRldmljZSAqZGV2LCBzdHJ1
Y3QgaXJxX2NoaXBfZ2VuZXJpYyAqZ2MsCiAgICB1MzIgbXNrLCBlbnVtIGlycV9nY19mbGFn
cyBmbGFncywKICAgIHVuc2lnbmVkIGludCBjbHIsIHVuc2lnbmVkIGludCBzZXQpOwoKc3Ry
dWN0IGlycV9jaGlwX2dlbmVyaWMgKmlycV9nZXRfZG9tYWluX2dlbmVyaWNfY2hpcChzdHJ1
Y3QgaXJxX2RvbWFpbiAqZCwgdW5zaWduZWQgaW50IGh3X2lycSk7CgppbnQgX19pcnFfYWxs
b2NfZG9tYWluX2dlbmVyaWNfY2hpcHMoc3RydWN0IGlycV9kb21haW4gKmQsIGludCBpcnFz
X3Blcl9jaGlwLAogICAgICAgICBpbnQgbnVtX2N0LCBjb25zdCBjaGFyICpuYW1lLAogICAg
ICAgICBpcnFfZmxvd19oYW5kbGVyX3QgaGFuZGxlciwKICAgICAgICAgdW5zaWduZWQgaW50
IGNsciwgdW5zaWduZWQgaW50IHNldCwKICAgICAgICAgZW51bSBpcnFfZ2NfZmxhZ3MgZmxh
Z3MpOwojIDExMzIgIi4vaW5jbHVkZS9saW51eC9pcnEuaCIKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgaXJx
X2ZyZWVfZ2VuZXJpY19jaGlwKHN0cnVjdCBpcnFfY2hpcF9nZW5lcmljICpnYykKewoga2Zy
ZWUoZ2MpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBpcnFfZGVzdHJveV9nZW5lcmljX2NoaXAoc3Ry
dWN0IGlycV9jaGlwX2dlbmVyaWMgKmdjLAogICAgICAgICB1MzIgbXNrLCB1bnNpZ25lZCBp
bnQgY2xyLAogICAgICAgICB1bnNpZ25lZCBpbnQgc2V0KQp7CiBpcnFfcmVtb3ZlX2dlbmVy
aWNfY2hpcChnYywgbXNrLCBjbHIsIHNldCk7CiBpcnFfZnJlZV9nZW5lcmljX2NoaXAoZ2Mp
Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgc3RydWN0IGlycV9jaGlwX3R5cGUgKmlycV9kYXRhX2dldF9jaGlw
X3R5cGUoc3RydWN0IGlycV9kYXRhICpkKQp7CiByZXR1cm4gKHsgdm9pZCAqX19tcHRyID0g
KHZvaWQgKikoZC0+Y2hpcCk7IGRvIHsgZXh0ZXJuIHZvaWQgX19jb21waWxldGltZV9hc3Nl
cnRfMTg4KHZvaWQpIF9fYXR0cmlidXRlX18oKF9fZXJyb3JfXygicG9pbnRlciB0eXBlIG1p
c21hdGNoIGluIGNvbnRhaW5lcl9vZigpIikpKTsgaWYgKCEoISghX19idWlsdGluX3R5cGVz
X2NvbXBhdGlibGVfcCh0eXBlb2YoKihkLT5jaGlwKSksIHR5cGVvZigoKHN0cnVjdCBpcnFf
Y2hpcF90eXBlICopMCktPmNoaXApKSAmJiAhX19idWlsdGluX3R5cGVzX2NvbXBhdGlibGVf
cCh0eXBlb2YoKihkLT5jaGlwKSksIHR5cGVvZih2b2lkKSkpKSkgX19jb21waWxldGltZV9h
c3NlcnRfMTg4KCk7IH0gd2hpbGUgKDApOyAoKHN0cnVjdCBpcnFfY2hpcF90eXBlICopKF9f
bXB0ciAtIF9fYnVpbHRpbl9vZmZzZXRvZihzdHJ1Y3QgaXJxX2NoaXBfdHlwZSwgY2hpcCkp
KTsgfSk7Cn0KCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGlycV9nY19sb2NrKHN0cnVjdCBpcnFfY2hp
cF9nZW5lcmljICpnYykKewogX3Jhd19zcGluX2xvY2soJmdjLT5sb2NrKTsKfQoKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIHZvaWQgaXJxX2djX3VubG9jayhzdHJ1Y3QgaXJxX2NoaXBfZ2VuZXJpYyAqZ2MpCnsK
IF9fcmF3X3NwaW5fdW5sb2NrKCZnYy0+bG9jayk7Cn0KIyAxMTc3ICIuL2luY2x1ZGUvbGlu
dXgvaXJxLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGlycV9yZWdfd3JpdGVsKHN0cnVjdCBpcnFfY2hp
cF9nZW5lcmljICpnYywKICAgICAgdTMyIHZhbCwgaW50IHJlZ19vZmZzZXQpCnsKIGlmIChn
Yy0+cmVnX3dyaXRlbCkKICBnYy0+cmVnX3dyaXRlbCh2YWwsIGdjLT5yZWdfYmFzZSArIHJl
Z19vZmZzZXQpOwogZWxzZQogIHdyaXRlbCh2YWwsIGdjLT5yZWdfYmFzZSArIHJlZ19vZmZz
ZXQpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgdTMyIGlycV9yZWdfcmVhZGwoc3RydWN0IGlycV9jaGlwX2dl
bmVyaWMgKmdjLAogICAgaW50IHJlZ19vZmZzZXQpCnsKIGlmIChnYy0+cmVnX3JlYWRsKQog
IHJldHVybiBnYy0+cmVnX3JlYWRsKGdjLT5yZWdfYmFzZSArIHJlZ19vZmZzZXQpOwogZWxz
ZQogIHJldHVybiByZWFkbChnYy0+cmVnX2Jhc2UgKyByZWdfb2Zmc2V0KTsKfQoKc3RydWN0
IGlycV9tYXRyaXg7CnN0cnVjdCBpcnFfbWF0cml4ICppcnFfYWxsb2NfbWF0cml4KHVuc2ln
bmVkIGludCBtYXRyaXhfYml0cywKICAgICAgICB1bnNpZ25lZCBpbnQgYWxsb2Nfc3RhcnQs
CiAgICAgICAgdW5zaWduZWQgaW50IGFsbG9jX2VuZCk7CnZvaWQgaXJxX21hdHJpeF9vbmxp
bmUoc3RydWN0IGlycV9tYXRyaXggKm0pOwp2b2lkIGlycV9tYXRyaXhfb2ZmbGluZShzdHJ1
Y3QgaXJxX21hdHJpeCAqbSk7CnZvaWQgaXJxX21hdHJpeF9hc3NpZ25fc3lzdGVtKHN0cnVj
dCBpcnFfbWF0cml4ICptLCB1bnNpZ25lZCBpbnQgYml0LCBib29sIHJlcGxhY2UpOwppbnQg
aXJxX21hdHJpeF9yZXNlcnZlX21hbmFnZWQoc3RydWN0IGlycV9tYXRyaXggKm0sIGNvbnN0
IHN0cnVjdCBjcHVtYXNrICptc2spOwp2b2lkIGlycV9tYXRyaXhfcmVtb3ZlX21hbmFnZWQo
c3RydWN0IGlycV9tYXRyaXggKm0sIGNvbnN0IHN0cnVjdCBjcHVtYXNrICptc2spOwppbnQg
aXJxX21hdHJpeF9hbGxvY19tYW5hZ2VkKHN0cnVjdCBpcnFfbWF0cml4ICptLCBjb25zdCBz
dHJ1Y3QgY3B1bWFzayAqbXNrLAogICAgdW5zaWduZWQgaW50ICptYXBwZWRfY3B1KTsKdm9p
ZCBpcnFfbWF0cml4X3Jlc2VydmUoc3RydWN0IGlycV9tYXRyaXggKm0pOwp2b2lkIGlycV9t
YXRyaXhfcmVtb3ZlX3Jlc2VydmVkKHN0cnVjdCBpcnFfbWF0cml4ICptKTsKaW50IGlycV9t
YXRyaXhfYWxsb2Moc3RydWN0IGlycV9tYXRyaXggKm0sIGNvbnN0IHN0cnVjdCBjcHVtYXNr
ICptc2ssCiAgICAgICBib29sIHJlc2VydmVkLCB1bnNpZ25lZCBpbnQgKm1hcHBlZF9jcHUp
Owp2b2lkIGlycV9tYXRyaXhfZnJlZShzdHJ1Y3QgaXJxX21hdHJpeCAqbSwgdW5zaWduZWQg
aW50IGNwdSwKICAgICAgIHVuc2lnbmVkIGludCBiaXQsIGJvb2wgbWFuYWdlZCk7CnZvaWQg
aXJxX21hdHJpeF9hc3NpZ24oc3RydWN0IGlycV9tYXRyaXggKm0sIHVuc2lnbmVkIGludCBi
aXQpOwp1bnNpZ25lZCBpbnQgaXJxX21hdHJpeF9hdmFpbGFibGUoc3RydWN0IGlycV9tYXRy
aXggKm0sIGJvb2wgY3B1ZG93bik7CnVuc2lnbmVkIGludCBpcnFfbWF0cml4X2FsbG9jYXRl
ZChzdHJ1Y3QgaXJxX21hdHJpeCAqbSk7CnVuc2lnbmVkIGludCBpcnFfbWF0cml4X3Jlc2Vy
dmVkKHN0cnVjdCBpcnFfbWF0cml4ICptKTsKdm9pZCBpcnFfbWF0cml4X2RlYnVnX3Nob3co
c3RydWN0IHNlcV9maWxlICpzZiwgc3RydWN0IGlycV9tYXRyaXggKm0sIGludCBpbmQpOwoK
CgppcnFfaHdfbnVtYmVyX3QgaXBpX2dldF9od2lycSh1bnNpZ25lZCBpbnQgaXJxLCB1bnNp
Z25lZCBpbnQgY3B1KTsKaW50IF9faXBpX3NlbmRfc2luZ2xlKHN0cnVjdCBpcnFfZGVzYyAq
ZGVzYywgdW5zaWduZWQgaW50IGNwdSk7CmludCBfX2lwaV9zZW5kX21hc2soc3RydWN0IGly
cV9kZXNjICpkZXNjLCBjb25zdCBzdHJ1Y3QgY3B1bWFzayAqZGVzdCk7CmludCBpcGlfc2Vu
ZF9zaW5nbGUodW5zaWduZWQgaW50IHZpcnEsIHVuc2lnbmVkIGludCBjcHUpOwppbnQgaXBp
X3NlbmRfbWFzayh1bnNpZ25lZCBpbnQgdmlycSwgY29uc3Qgc3RydWN0IGNwdW1hc2sgKmRl
c3QpOwojIDcgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2hhcmRpcnEuaCIgMgoKdHlw
ZWRlZiBzdHJ1Y3QgewogdW5zaWduZWQgaW50IF9fc29mdGlycV9wZW5kaW5nOwogdW5zaWdu
ZWQgaW50IHRpbWVyX2lycXNfZXZlbnQ7CiB1bnNpZ25lZCBpbnQgYnJvYWRjYXN0X2lycXNf
ZXZlbnQ7CiB1bnNpZ25lZCBpbnQgdGltZXJfaXJxc19vdGhlcnM7CiB1bnNpZ25lZCBpbnQg
cG11X2lycXM7CiB1bnNpZ25lZCBpbnQgbWNlX2V4Y2VwdGlvbnM7CiB1bnNpZ25lZCBpbnQg
c3B1cmlvdXNfaXJxczsKIHVuc2lnbmVkIGludCBobWlfZXhjZXB0aW9uczsKIHVuc2lnbmVk
IGludCBzcmVzZXRfaXJxczsKCgoKCiB1bnNpZ25lZCBpbnQgZG9vcmJlbGxfaXJxczsKCn0g
X19hdHRyaWJ1dGVfXygoX19hbGlnbmVkX18oKDEgPDwgNikpKSkgaXJxX2NwdXN0YXRfdDsK
CmV4dGVybiBfX2F0dHJpYnV0ZV9fKChzZWN0aW9uKCIuZGF0YS4ucGVyY3B1IiAiLi5zaGFy
ZWRfYWxpZ25lZCIpKSkgX190eXBlb2ZfXyhpcnFfY3B1c3RhdF90KSBpcnFfc3RhdCBfX2F0
dHJpYnV0ZV9fKChfX2FsaWduZWRfXygoMSA8PCA2KSkpKTsKCgoKCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lk
IGFja19iYWRfaXJxKHVuc2lnbmVkIGludCBpcnEpCnsKIHByaW50aygiXDAwMSIgIjIiICJ1
bmV4cGVjdGVkIElSUSB0cmFwIGF0IHZlY3RvciAlMDJ4XG4iLCBpcnEpOwp9CgpleHRlcm4g
dTY0IGFyY2hfaXJxX3N0YXRfY3B1KHVuc2lnbmVkIGludCBjcHUpOwojIDExICIuL2luY2x1
ZGUvbGludXgvaGFyZGlycS5oIiAyCgpleHRlcm4gdm9pZCBzeW5jaHJvbml6ZV9pcnEodW5z
aWduZWQgaW50IGlycSk7CmV4dGVybiBib29sIHN5bmNocm9uaXplX2hhcmRpcnEodW5zaWdu
ZWQgaW50IGlycSk7CgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBfX3JjdV9pcnFfZW50ZXJfY2hlY2tf
dGljayh2b2lkKSB7IH0KCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5s
aW5lX18pKSB2b2lkIHJjdV9pcnFfZW50ZXJfY2hlY2tfdGljayh2b2lkKQp7CiBpZiAoY29u
dGV4dF90cmFja2luZ19lbmFibGVkKCkpCiAgX19yY3VfaXJxX2VudGVyX2NoZWNrX3RpY2so
KTsKfQojIDU0ICIuL2luY2x1ZGUvbGludXgvaGFyZGlycS5oIgp2b2lkIGlycV9lbnRlcih2
b2lkKTsKCgoKdm9pZCBpcnFfZW50ZXJfcmN1KHZvaWQpOwojIDgyICIuL2luY2x1ZGUvbGlu
dXgvaGFyZGlycS5oIgp2b2lkIGlycV9leGl0KHZvaWQpOwoKCgoKdm9pZCBpcnFfZXhpdF9y
Y3Uodm9pZCk7CiMgOTggIi4vaW5jbHVkZS9saW51eC9oYXJkaXJxLmgiCmV4dGVybiB2b2lk
IHJjdV9ubWlfZW50ZXIodm9pZCk7CmV4dGVybiB2b2lkIHJjdV9ubWlfZXhpdCh2b2lkKTsK
IyAxMSAiLi9pbmNsdWRlL2xpbnV4L2hpZ2htZW0uaCIgMgoKIyAxICIuL2FyY2gvcG93ZXJw
Yy9pbmNsdWRlL2FzbS9jYWNoZWZsdXNoLmgiIDEKIyAyNiAiLi9hcmNoL3Bvd2VycGMvaW5j
bHVkZS9hc20vY2FjaGVmbHVzaC5oIgpleHRlcm4gdm9pZCBmbHVzaF9kY2FjaGVfcGFnZShz
dHJ1Y3QgcGFnZSAqcGFnZSk7Cgp2b2lkIGZsdXNoX2ljYWNoZV9yYW5nZSh1bnNpZ25lZCBs
b25nIHN0YXJ0LCB1bnNpZ25lZCBsb25nIHN0b3ApOwoKCnZvaWQgZmx1c2hfaWNhY2hlX3Vz
ZXJfcGFnZShzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnZtYSwgc3RydWN0IHBhZ2UgKnBhZ2Us
CiAgdW5zaWduZWQgbG9uZyBhZGRyLCBpbnQgbGVuKTsKCgp2b2lkIGZsdXNoX2RjYWNoZV9p
Y2FjaGVfcGFnZShzdHJ1Y3QgcGFnZSAqcGFnZSk7CnZvaWQgX19mbHVzaF9kY2FjaGVfaWNh
Y2hlKHZvaWQgKnBhZ2UpOwojIDQ2ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9jYWNo
ZWZsdXNoLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGZsdXNoX2RjYWNoZV9yYW5nZSh1bnNpZ25lZCBs
b25nIHN0YXJ0LCB1bnNpZ25lZCBsb25nIHN0b3ApCnsKIHVuc2lnbmVkIGxvbmcgc2hpZnQg
PSBsMV9kY2FjaGVfc2hpZnQoKTsKIHVuc2lnbmVkIGxvbmcgYnl0ZXMgPSBsMV9kY2FjaGVf
Ynl0ZXMoKTsKIHZvaWQgKmFkZHIgPSAodm9pZCAqKShzdGFydCAmIH4oYnl0ZXMgLSAxKSk7
CiB1bnNpZ25lZCBsb25nIHNpemUgPSBzdG9wIC0gKHVuc2lnbmVkIGxvbmcpYWRkciArIChi
eXRlcyAtIDEpOwogdW5zaWduZWQgbG9uZyBpOwoKIGlmICgxKQogIF9fYXNtX18gX192b2xh
dGlsZV9fICgic3luYyIgOiA6IDogIm1lbW9yeSIpOwoKIGZvciAoaSA9IDA7IGkgPCBzaXpl
ID4+IHNoaWZ0OyBpKyssIGFkZHIgKz0gYnl0ZXMpCiAgZGNiZihhZGRyKTsKIF9fYXNtX18g
X192b2xhdGlsZV9fICgic3luYyIgOiA6IDogIm1lbW9yeSIpOwoKfQoKCgoKCgpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgdm9pZCBjbGVhbl9kY2FjaGVfcmFuZ2UodW5zaWduZWQgbG9uZyBzdGFydCwgdW5zaWdu
ZWQgbG9uZyBzdG9wKQp7CiB1bnNpZ25lZCBsb25nIHNoaWZ0ID0gbDFfZGNhY2hlX3NoaWZ0
KCk7CiB1bnNpZ25lZCBsb25nIGJ5dGVzID0gbDFfZGNhY2hlX2J5dGVzKCk7CiB2b2lkICph
ZGRyID0gKHZvaWQgKikoc3RhcnQgJiB+KGJ5dGVzIC0gMSkpOwogdW5zaWduZWQgbG9uZyBz
aXplID0gc3RvcCAtICh1bnNpZ25lZCBsb25nKWFkZHIgKyAoYnl0ZXMgLSAxKTsKIHVuc2ln
bmVkIGxvbmcgaTsKCiBmb3IgKGkgPSAwOyBpIDwgc2l6ZSA+PiBzaGlmdDsgaSsrLCBhZGRy
ICs9IGJ5dGVzKQogIGRjYnN0KGFkZHIpOwogX19hc21fXyBfX3ZvbGF0aWxlX18gKCJzeW5j
IiA6IDogOiAibWVtb3J5Iik7Cn0KCgoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgaW52YWxpZGF0ZV9k
Y2FjaGVfcmFuZ2UodW5zaWduZWQgbG9uZyBzdGFydCwKICAgICAgICB1bnNpZ25lZCBsb25n
IHN0b3ApCnsKIHVuc2lnbmVkIGxvbmcgc2hpZnQgPSBsMV9kY2FjaGVfc2hpZnQoKTsKIHVu
c2lnbmVkIGxvbmcgYnl0ZXMgPSBsMV9kY2FjaGVfYnl0ZXMoKTsKIHZvaWQgKmFkZHIgPSAo
dm9pZCAqKShzdGFydCAmIH4oYnl0ZXMgLSAxKSk7CiB1bnNpZ25lZCBsb25nIHNpemUgPSBz
dG9wIC0gKHVuc2lnbmVkIGxvbmcpYWRkciArIChieXRlcyAtIDEpOwogdW5zaWduZWQgbG9u
ZyBpOwoKIGZvciAoaSA9IDA7IGkgPCBzaXplID4+IHNoaWZ0OyBpKyssIGFkZHIgKz0gYnl0
ZXMpCiAgZGNiaShhZGRyKTsKIF9fYXNtX18gX192b2xhdGlsZV9fICgic3luYyIgOiA6IDog
Im1lbW9yeSIpOwp9CgojIDEgIi4vaW5jbHVkZS9hc20tZ2VuZXJpYy9jYWNoZWZsdXNoLmgi
IDEKCgoKCnN0cnVjdCBtbV9zdHJ1Y3Q7CnN0cnVjdCB2bV9hcmVhX3N0cnVjdDsKc3RydWN0
IHBhZ2U7CnN0cnVjdCBhZGRyZXNzX3NwYWNlOwoKCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBmbHVz
aF9jYWNoZV9hbGwodm9pZCkKewp9CgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGZsdXNoX2NhY2hlX21t
KHN0cnVjdCBtbV9zdHJ1Y3QgKm1tKQp7Cn0KCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgZmx1c2hfY2Fj
aGVfZHVwX21tKHN0cnVjdCBtbV9zdHJ1Y3QgKm1tKQp7Cn0KCgoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQg
Zmx1c2hfY2FjaGVfcmFuZ2Uoc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEsCiAgICAgICAg
IHVuc2lnbmVkIGxvbmcgc3RhcnQsCiAgICAgICAgIHVuc2lnbmVkIGxvbmcgZW5kKQp7Cn0K
CgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIHZvaWQgZmx1c2hfY2FjaGVfcGFnZShzdHJ1Y3Qgdm1fYXJlYV9zdHJ1
Y3QgKnZtYSwKICAgICAgICB1bnNpZ25lZCBsb25nIHZtYWRkciwKICAgICAgICB1bnNpZ25l
ZCBsb25nIHBmbikKewp9CiMgNTcgIi4vaW5jbHVkZS9hc20tZ2VuZXJpYy9jYWNoZWZsdXNo
LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSB2b2lkIGZsdXNoX2RjYWNoZV9tbWFwX2xvY2soc3RydWN0IGFkZHJl
c3Nfc3BhY2UgKm1hcHBpbmcpCnsKfQoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBmbHVzaF9kY2FjaGVf
bW1hcF91bmxvY2soc3RydWN0IGFkZHJlc3Nfc3BhY2UgKm1hcHBpbmcpCnsKfQojIDc5ICIu
L2luY2x1ZGUvYXNtLWdlbmVyaWMvY2FjaGVmbHVzaC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBmbHVz
aF9pY2FjaGVfcGFnZShzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnZtYSwKICAgICAgICAgc3Ry
dWN0IHBhZ2UgKnBhZ2UpCnsKfQojIDk0ICIuL2luY2x1ZGUvYXNtLWdlbmVyaWMvY2FjaGVm
bHVzaC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBmbHVzaF9jYWNoZV92bWFwKHVuc2lnbmVkIGxvbmcg
c3RhcnQsIHVuc2lnbmVkIGxvbmcgZW5kKQp7Cn0KCgoKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgZmx1c2hf
Y2FjaGVfdnVubWFwKHVuc2lnbmVkIGxvbmcgc3RhcnQsIHVuc2lnbmVkIGxvbmcgZW5kKQp7
Cn0KIyAxMDEgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2NhY2hlZmx1c2guaCIgMgoj
IDEzICIuL2luY2x1ZGUvbGludXgvaGlnaG1lbS5oIiAyCgoKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgZmx1
c2hfYW5vbl9wYWdlKHN0cnVjdCB2bV9hcmVhX3N0cnVjdCAqdm1hLCBzdHJ1Y3QgcGFnZSAq
cGFnZSwgdW5zaWduZWQgbG9uZyB2bWFkZHIpCnsKfQoKCgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBmbHVz
aF9rZXJuZWxfZGNhY2hlX3BhZ2Uoc3RydWN0IHBhZ2UgKnBhZ2UpCnsKfQpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
dm9pZCBmbHVzaF9rZXJuZWxfdm1hcF9yYW5nZSh2b2lkICp2YWRkciwgaW50IHNpemUpCnsK
fQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgdm9pZCBpbnZhbGlkYXRlX2tlcm5lbF92bWFwX3JhbmdlKHZvaWQgKnZh
ZGRyLCBpbnQgc2l6ZSkKewp9CgoKIyAxICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9r
bWFwX3R5cGVzLmgiIDEKIyAzMyAiLi9pbmNsdWRlL2xpbnV4L2hpZ2htZW0uaCIgMgojIDEy
OCAiLi9pbmNsdWRlL2xpbnV4L2hpZ2htZW0uaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHVuc2lnbmVkIGludCBu
cl9mcmVlX2hpZ2hwYWdlcyh2b2lkKSB7IHJldHVybiAwOyB9CgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0
IHBhZ2UgKmttYXBfdG9fcGFnZSh2b2lkICphZGRyKQp7CiByZXR1cm4gKG1lbV9tYXAgKyAo
KCgoeyBkbyB7IH0gd2hpbGUgKDApOyAodW5zaWduZWQgbG9uZykoYWRkcikgJiAweDBmZmZm
ZmZmZmZmZmZmZmZVTDsgfSkgPj4gMTIpKSAtICgodW5zaWduZWQgbG9uZykoMFVMID4+IDEy
KSkpKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHVuc2lnbmVkIGxvbmcgdG90YWxoaWdoX3BhZ2VzKHZvaWQp
IHsgcmV0dXJuIDBVTDsgfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgKmttYXAoc3RydWN0IHBhZ2UgKnBh
Z2UpCnsKIGRvIHsgZG8geyB9IHdoaWxlICgwKTsgfSB3aGlsZSAoMCk7CiByZXR1cm4gbG93
bWVtX3BhZ2VfYWRkcmVzcyhwYWdlKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQga3VubWFwX2hpZ2go
c3RydWN0IHBhZ2UgKnBhZ2UpCnsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQga3VubWFwKHN0cnVjdCBw
YWdlICpwYWdlKQp7CgoKCn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkICprbWFwX2F0b21pYyhzdHJ1Y3Qg
cGFnZSAqcGFnZSkKewogX19hc21fXyBfX3ZvbGF0aWxlX18oIiI6IDogOiJtZW1vcnkiKTsK
IHBhZ2VmYXVsdF9kaXNhYmxlKCk7CiByZXR1cm4gbG93bWVtX3BhZ2VfYWRkcmVzcyhwYWdl
KTsKfQoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSB2b2lkIGt1bm1hcF9hdG9taWNfaGlnaCh2b2lkICphZGRyKQp7
CgoKCgoKCgp9CiMgMjI3ICIuL2luY2x1ZGUvbGludXgvaGlnaG1lbS5oIgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
dm9pZCBjbGVhcl91c2VyX2hpZ2hwYWdlKHN0cnVjdCBwYWdlICpwYWdlLCB1bnNpZ25lZCBs
b25nIHZhZGRyKQp7CiB2b2lkICphZGRyID0ga21hcF9hdG9taWMocGFnZSk7CiBjbGVhcl91
c2VyX3BhZ2UoYWRkciwgdmFkZHIsIHBhZ2UpOwogZG8geyBkbyB7IGV4dGVybiB2b2lkIF9f
Y29tcGlsZXRpbWVfYXNzZXJ0XzE4OSh2b2lkKSBfX2F0dHJpYnV0ZV9fKChfX2Vycm9yX18o
IkJVSUxEX0JVR19PTiBmYWlsZWQ6ICIgIl9fc2FtZV90eXBlKChhZGRyKSwgc3RydWN0IHBh
Z2UgKikiKSkpOyBpZiAoISghKF9fYnVpbHRpbl90eXBlc19jb21wYXRpYmxlX3AodHlwZW9m
KChhZGRyKSksIHR5cGVvZihzdHJ1Y3QgcGFnZSAqKSkpKSkgX19jb21waWxldGltZV9hc3Nl
cnRfMTg5KCk7IH0gd2hpbGUgKDApOyBrdW5tYXBfYXRvbWljX2hpZ2goYWRkcik7IHBhZ2Vm
YXVsdF9lbmFibGUoKTsgX19hc21fXyBfX3ZvbGF0aWxlX18oIiI6IDogOiJtZW1vcnkiKTsg
fSB3aGlsZSAoMCk7Cn0KIyAyNTAgIi4vaW5jbHVkZS9saW51eC9oaWdobWVtLmgiCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBzdHJ1Y3QgcGFnZSAqCl9fYWxsb2NfemVyb2VkX3VzZXJfaGlnaHBhZ2UoZ2ZwX3Qg
bW92YWJsZWZsYWdzLAogICBzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnZtYSwKICAgdW5zaWdu
ZWQgbG9uZyB2YWRkcikKewogc3RydWN0IHBhZ2UgKnBhZ2UgPSBhbGxvY19wYWdlc19ub2Rl
KG51bWFfbm9kZV9pZCgpLCAoKCgoIGdmcF90KSgweDQwMHV8MHg4MDB1KSkgfCAoKCBnZnBf
dCkweDQwdSkgfCAoKCBnZnBfdCkweDgwdSkgfCAoKCBnZnBfdCkweDEwMDAwMHUpKSB8ICgo
IGdmcF90KTB4MDJ1KSkgfCBtb3ZhYmxlZmxhZ3MsIDApCiAgICAgICAgICAgICAgOwoKIGlm
IChwYWdlKQogIGNsZWFyX3VzZXJfaGlnaHBhZ2UocGFnZSwgdmFkZHIpOwoKIHJldHVybiBw
YWdlOwp9CiMgMjczICIuL2luY2x1ZGUvbGludXgvaGlnaG1lbS5oIgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3Ry
dWN0IHBhZ2UgKgphbGxvY196ZXJvZWRfdXNlcl9oaWdocGFnZV9tb3ZhYmxlKHN0cnVjdCB2
bV9hcmVhX3N0cnVjdCAqdm1hLAogICAgIHVuc2lnbmVkIGxvbmcgdmFkZHIpCnsKIHJldHVy
biBfX2FsbG9jX3plcm9lZF91c2VyX2hpZ2hwYWdlKCgoIGdmcF90KTB4MDh1KSwgdm1hLCB2
YWRkcik7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGNsZWFyX2hpZ2hwYWdlKHN0cnVjdCBwYWdlICpw
YWdlKQp7CiB2b2lkICprYWRkciA9IGttYXBfYXRvbWljKHBhZ2UpOwogY2xlYXJfcGFnZShr
YWRkcik7CiBkbyB7IGRvIHsgZXh0ZXJuIHZvaWQgX19jb21waWxldGltZV9hc3NlcnRfMTkw
KHZvaWQpIF9fYXR0cmlidXRlX18oKF9fZXJyb3JfXygiQlVJTERfQlVHX09OIGZhaWxlZDog
IiAiX19zYW1lX3R5cGUoKGthZGRyKSwgc3RydWN0IHBhZ2UgKikiKSkpOyBpZiAoISghKF9f
YnVpbHRpbl90eXBlc19jb21wYXRpYmxlX3AodHlwZW9mKChrYWRkcikpLCB0eXBlb2Yoc3Ry
dWN0IHBhZ2UgKikpKSkpIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzE5MCgpOyB9IHdoaWxlICgw
KTsga3VubWFwX2F0b21pY19oaWdoKGthZGRyKTsgcGFnZWZhdWx0X2VuYWJsZSgpOyBfX2Fz
bV9fIF9fdm9sYXRpbGVfXygiIjogOiA6Im1lbW9yeSIpOyB9IHdoaWxlICgwKTsKfQoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIHZvaWQgemVyb191c2VyX3NlZ21lbnRzKHN0cnVjdCBwYWdlICpwYWdlLAogdW5z
aWduZWQgc3RhcnQxLCB1bnNpZ25lZCBlbmQxLAogdW5zaWduZWQgc3RhcnQyLCB1bnNpZ25l
ZCBlbmQyKQp7CiB2b2lkICprYWRkciA9IGttYXBfYXRvbWljKHBhZ2UpOwoKIGRvIHsgaWYg
KF9fYnVpbHRpbl9jb25zdGFudF9wKGVuZDEgPiAoMVVMIDw8IDEyKSB8fCBlbmQyID4gKDFV
TCA8PCAxMikpKSB7IGlmIChlbmQxID4gKDFVTCA8PCAxMikgfHwgZW5kMiA+ICgxVUwgPDwg
MTIpKSBkbyB7IF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJIiAidHdpIDMxLCAwLCAwIiAi
XG4iICIuc2VjdGlvbiBfX2J1Z190YWJsZSxcImF3XCJcbiIgIjI6XHQiICIuOGJ5dGUiICIg
IiAiMWIsICUwXG4iICJcdC5zaG9ydCAlMSwgJTJcbiIgIi5vcmcgMmIrJTNcbiIgIi5wcmV2
aW91c1xuIiA6IDogImkiICgiLi9pbmNsdWRlL2xpbnV4L2hpZ2htZW0uaCIpLCAiaSIgKDI5
MyksICJpIiAoMCksICJpIiAoc2l6ZW9mKHN0cnVjdCBidWdfZW50cnkpKSk7IGRvIHsgOyBh
c20gdm9sYXRpbGUoIiIpOyBfX2J1aWx0aW5fdW5yZWFjaGFibGUoKTsgfSB3aGlsZSAoMCk7
IH0gd2hpbGUgKDApOyB9IGVsc2UgeyBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CSIgInRk
bmVpIiAiICIgIiAlNCwgMCIgIlxuIiAiLnNlY3Rpb24gX19idWdfdGFibGUsXCJhd1wiXG4i
ICIyOlx0IiAiLjhieXRlIiAiICIgIjFiLCAlMFxuIiAiXHQuc2hvcnQgJTEsICUyXG4iICIu
b3JnIDJiKyUzXG4iICIucHJldmlvdXNcbiIgOiA6ICJpIiAoIi4vaW5jbHVkZS9saW51eC9o
aWdobWVtLmgiKSwgImkiICgyOTMpLCAiaSIgKDApLCAiaSIgKHNpemVvZihzdHJ1Y3QgYnVn
X2VudHJ5KSksICJyIiAoKCBsb25nKShlbmQxID4gKDFVTCA8PCAxMikgfHwgZW5kMiA+ICgx
VUwgPDwgMTIpKSkpOyB9IH0gd2hpbGUgKDApOwoKIGlmIChlbmQxID4gc3RhcnQxKQogIG1l
bXNldChrYWRkciArIHN0YXJ0MSwgMCwgZW5kMSAtIHN0YXJ0MSk7CgogaWYgKGVuZDIgPiBz
dGFydDIpCiAgbWVtc2V0KGthZGRyICsgc3RhcnQyLCAwLCBlbmQyIC0gc3RhcnQyKTsKCiBk
byB7IGRvIHsgZXh0ZXJuIHZvaWQgX19jb21waWxldGltZV9hc3NlcnRfMTkxKHZvaWQpIF9f
YXR0cmlidXRlX18oKF9fZXJyb3JfXygiQlVJTERfQlVHX09OIGZhaWxlZDogIiAiX19zYW1l
X3R5cGUoKGthZGRyKSwgc3RydWN0IHBhZ2UgKikiKSkpOyBpZiAoISghKF9fYnVpbHRpbl90
eXBlc19jb21wYXRpYmxlX3AodHlwZW9mKChrYWRkcikpLCB0eXBlb2Yoc3RydWN0IHBhZ2Ug
KikpKSkpIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzE5MSgpOyB9IHdoaWxlICgwKTsga3VubWFw
X2F0b21pY19oaWdoKGthZGRyKTsgcGFnZWZhdWx0X2VuYWJsZSgpOyBfX2FzbV9fIF9fdm9s
YXRpbGVfXygiIjogOiA6Im1lbW9yeSIpOyB9IHdoaWxlICgwKTsKIGZsdXNoX2RjYWNoZV9w
YWdlKHBhZ2UpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCB6ZXJvX3VzZXJfc2VnbWVudChzdHJ1Y3Qg
cGFnZSAqcGFnZSwKIHVuc2lnbmVkIHN0YXJ0LCB1bnNpZ25lZCBlbmQpCnsKIHplcm9fdXNl
cl9zZWdtZW50cyhwYWdlLCBzdGFydCwgZW5kLCAwLCAwKTsKfQoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQg
emVyb191c2VyKHN0cnVjdCBwYWdlICpwYWdlLAogdW5zaWduZWQgc3RhcnQsIHVuc2lnbmVk
IHNpemUpCnsKIHplcm9fdXNlcl9zZWdtZW50cyhwYWdlLCBzdGFydCwgc3RhcnQgKyBzaXpl
LCAwLCAwKTsKfQoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBjb3B5X3VzZXJfaGlnaHBhZ2Uoc3RydWN0
IHBhZ2UgKnRvLCBzdHJ1Y3QgcGFnZSAqZnJvbSwKIHVuc2lnbmVkIGxvbmcgdmFkZHIsIHN0
cnVjdCB2bV9hcmVhX3N0cnVjdCAqdm1hKQp7CiBjaGFyICp2ZnJvbSwgKnZ0bzsKCiB2ZnJv
bSA9IGttYXBfYXRvbWljKGZyb20pOwogdnRvID0ga21hcF9hdG9taWModG8pOwogY29weV91
c2VyX3BhZ2UodnRvLCB2ZnJvbSwgdmFkZHIsIHRvKTsKIGRvIHsgZG8geyBleHRlcm4gdm9p
ZCBfX2NvbXBpbGV0aW1lX2Fzc2VydF8xOTIodm9pZCkgX19hdHRyaWJ1dGVfXygoX19lcnJv
cl9fKCJCVUlMRF9CVUdfT04gZmFpbGVkOiAiICJfX3NhbWVfdHlwZSgodnRvKSwgc3RydWN0
IHBhZ2UgKikiKSkpOyBpZiAoISghKF9fYnVpbHRpbl90eXBlc19jb21wYXRpYmxlX3AodHlw
ZW9mKCh2dG8pKSwgdHlwZW9mKHN0cnVjdCBwYWdlICopKSkpKSBfX2NvbXBpbGV0aW1lX2Fz
c2VydF8xOTIoKTsgfSB3aGlsZSAoMCk7IGt1bm1hcF9hdG9taWNfaGlnaCh2dG8pOyBwYWdl
ZmF1bHRfZW5hYmxlKCk7IF9fYXNtX18gX192b2xhdGlsZV9fKCIiOiA6IDoibWVtb3J5Iik7
IH0gd2hpbGUgKDApOwogZG8geyBkbyB7IGV4dGVybiB2b2lkIF9fY29tcGlsZXRpbWVfYXNz
ZXJ0XzE5Myh2b2lkKSBfX2F0dHJpYnV0ZV9fKChfX2Vycm9yX18oIkJVSUxEX0JVR19PTiBm
YWlsZWQ6ICIgIl9fc2FtZV90eXBlKCh2ZnJvbSksIHN0cnVjdCBwYWdlICopIikpKTsgaWYg
KCEoIShfX2J1aWx0aW5fdHlwZXNfY29tcGF0aWJsZV9wKHR5cGVvZigodmZyb20pKSwgdHlw
ZW9mKHN0cnVjdCBwYWdlICopKSkpKSBfX2NvbXBpbGV0aW1lX2Fzc2VydF8xOTMoKTsgfSB3
aGlsZSAoMCk7IGt1bm1hcF9hdG9taWNfaGlnaCh2ZnJvbSk7IHBhZ2VmYXVsdF9lbmFibGUo
KTsgX19hc21fXyBfX3ZvbGF0aWxlX18oIiI6IDogOiJtZW1vcnkiKTsgfSB3aGlsZSAoMCk7
Cn0KCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBjb3B5X2hpZ2hwYWdlKHN0cnVjdCBwYWdlICp0bywg
c3RydWN0IHBhZ2UgKmZyb20pCnsKIGNoYXIgKnZmcm9tLCAqdnRvOwoKIHZmcm9tID0ga21h
cF9hdG9taWMoZnJvbSk7CiB2dG8gPSBrbWFwX2F0b21pYyh0byk7CiBjb3B5X3BhZ2UodnRv
LCB2ZnJvbSk7CiBkbyB7IGRvIHsgZXh0ZXJuIHZvaWQgX19jb21waWxldGltZV9hc3NlcnRf
MTk0KHZvaWQpIF9fYXR0cmlidXRlX18oKF9fZXJyb3JfXygiQlVJTERfQlVHX09OIGZhaWxl
ZDogIiAiX19zYW1lX3R5cGUoKHZ0byksIHN0cnVjdCBwYWdlICopIikpKTsgaWYgKCEoIShf
X2J1aWx0aW5fdHlwZXNfY29tcGF0aWJsZV9wKHR5cGVvZigodnRvKSksIHR5cGVvZihzdHJ1
Y3QgcGFnZSAqKSkpKSkgX19jb21waWxldGltZV9hc3NlcnRfMTk0KCk7IH0gd2hpbGUgKDAp
OyBrdW5tYXBfYXRvbWljX2hpZ2godnRvKTsgcGFnZWZhdWx0X2VuYWJsZSgpOyBfX2FzbV9f
IF9fdm9sYXRpbGVfXygiIjogOiA6Im1lbW9yeSIpOyB9IHdoaWxlICgwKTsKIGRvIHsgZG8g
eyBleHRlcm4gdm9pZCBfX2NvbXBpbGV0aW1lX2Fzc2VydF8xOTUodm9pZCkgX19hdHRyaWJ1
dGVfXygoX19lcnJvcl9fKCJCVUlMRF9CVUdfT04gZmFpbGVkOiAiICJfX3NhbWVfdHlwZSgo
dmZyb20pLCBzdHJ1Y3QgcGFnZSAqKSIpKSk7IGlmICghKCEoX19idWlsdGluX3R5cGVzX2Nv
bXBhdGlibGVfcCh0eXBlb2YoKHZmcm9tKSksIHR5cGVvZihzdHJ1Y3QgcGFnZSAqKSkpKSkg
X19jb21waWxldGltZV9hc3NlcnRfMTk1KCk7IH0gd2hpbGUgKDApOyBrdW5tYXBfYXRvbWlj
X2hpZ2godmZyb20pOyBwYWdlZmF1bHRfZW5hYmxlKCk7IF9fYXNtX18gX192b2xhdGlsZV9f
KCIiOiA6IDoibWVtb3J5Iik7IH0gd2hpbGUgKDApOwp9CiMgMTIgIi4vaW5jbHVkZS9saW51
eC9wYWdlbWFwLmgiIDIKCgoKCgojIDEgIi4vaW5jbHVkZS9saW51eC9odWdldGxiX2lubGlu
ZS5oIiAxCiMgOSAiLi9pbmNsdWRlL2xpbnV4L2h1Z2V0bGJfaW5saW5lLmgiCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBib29sIGlzX3ZtX2h1Z2V0bGJfcGFnZShzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnZtYSkK
ewogcmV0dXJuICEhKHZtYS0+dm1fZmxhZ3MgJiAweDAwNDAwMDAwKTsKfQojIDE4ICIuL2lu
Y2x1ZGUvbGludXgvcGFnZW1hcC5oIiAyCgpzdHJ1Y3QgcGFnZXZlYzsKCgoKCmVudW0gbWFw
cGluZ19mbGFncyB7CiBBU19FSU8gPSAwLAogQVNfRU5PU1BDID0gMSwKIEFTX01NX0FMTF9M
T0NLUyA9IDIsCiBBU19VTkVWSUNUQUJMRSA9IDMsCiBBU19FWElUSU5HID0gNCwKCiBBU19O
T19XUklURUJBQ0tfVEFHUyA9IDUsCn07CiMgNDggIi4vaW5jbHVkZS9saW51eC9wYWdlbWFw
LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSB2b2lkIG1hcHBpbmdfc2V0X2Vycm9yKHN0cnVjdCBhZGRyZXNzX3Nw
YWNlICptYXBwaW5nLCBpbnQgZXJyb3IpCnsKIGlmIChfX2J1aWx0aW5fZXhwZWN0KCEhKCFl
cnJvciksIDEpKQogIHJldHVybjsKCgogX19maWxlbWFwX3NldF93Yl9lcnIobWFwcGluZywg
ZXJyb3IpOwoKCiBlcnJzZXFfc2V0KCZtYXBwaW5nLT5ob3N0LT5pX3NiLT5zX3diX2Vyciwg
ZXJyb3IpOwoKCiBpZiAoZXJyb3IgPT0gLTI4KQogIHNldF9iaXQoQVNfRU5PU1BDLCAmbWFw
cGluZy0+ZmxhZ3MpOwogZWxzZQogIHNldF9iaXQoQVNfRUlPLCAmbWFwcGluZy0+ZmxhZ3Mp
Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgdm9pZCBtYXBwaW5nX3NldF91bmV2aWN0YWJsZShzdHJ1Y3QgYWRk
cmVzc19zcGFjZSAqbWFwcGluZykKewogc2V0X2JpdChBU19VTkVWSUNUQUJMRSwgJm1hcHBp
bmctPmZsYWdzKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgbWFwcGluZ19jbGVhcl91bmV2aWN0YWJs
ZShzdHJ1Y3QgYWRkcmVzc19zcGFjZSAqbWFwcGluZykKewogY2xlYXJfYml0KEFTX1VORVZJ
Q1RBQkxFLCAmbWFwcGluZy0+ZmxhZ3MpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBtYXBwaW5nX3Vu
ZXZpY3RhYmxlKHN0cnVjdCBhZGRyZXNzX3NwYWNlICptYXBwaW5nKQp7CiByZXR1cm4gbWFw
cGluZyAmJiB0ZXN0X2JpdChBU19VTkVWSUNUQUJMRSwgJm1hcHBpbmctPmZsYWdzKTsKfQoK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIHZvaWQgbWFwcGluZ19zZXRfZXhpdGluZyhzdHJ1Y3QgYWRkcmVzc19zcGFj
ZSAqbWFwcGluZykKewogc2V0X2JpdChBU19FWElUSU5HLCAmbWFwcGluZy0+ZmxhZ3MpOwp9
CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgaW50IG1hcHBpbmdfZXhpdGluZyhzdHJ1Y3QgYWRkcmVzc19zcGFjZSAq
bWFwcGluZykKewogcmV0dXJuIHRlc3RfYml0KEFTX0VYSVRJTkcsICZtYXBwaW5nLT5mbGFn
cyk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSB2b2lkIG1hcHBpbmdfc2V0X25vX3dyaXRlYmFja190YWdzKHN0
cnVjdCBhZGRyZXNzX3NwYWNlICptYXBwaW5nKQp7CiBzZXRfYml0KEFTX05PX1dSSVRFQkFD
S19UQUdTLCAmbWFwcGluZy0+ZmxhZ3MpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IG1hcHBpbmdfdXNl
X3dyaXRlYmFja190YWdzKHN0cnVjdCBhZGRyZXNzX3NwYWNlICptYXBwaW5nKQp7CiByZXR1
cm4gIXRlc3RfYml0KEFTX05PX1dSSVRFQkFDS19UQUdTLCAmbWFwcGluZy0+ZmxhZ3MpOwp9
CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgZ2ZwX3QgbWFwcGluZ19nZnBfbWFzayhzdHJ1Y3QgYWRkcmVzc19zcGFj
ZSAqIG1hcHBpbmcpCnsKIHJldHVybiBtYXBwaW5nLT5nZnBfbWFzazsKfQoKCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBnZnBfdCBtYXBwaW5nX2dmcF9jb25zdHJhaW50KHN0cnVjdCBhZGRyZXNzX3NwYWNlICpt
YXBwaW5nLAogIGdmcF90IGdmcF9tYXNrKQp7CiByZXR1cm4gbWFwcGluZ19nZnBfbWFzayht
YXBwaW5nKSAmIGdmcF9tYXNrOwp9CgoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgbWFwcGluZ19zZXRf
Z2ZwX21hc2soc3RydWN0IGFkZHJlc3Nfc3BhY2UgKm0sIGdmcF90IG1hc2spCnsKIG0tPmdm
cF9tYXNrID0gbWFzazsKfQoKdm9pZCByZWxlYXNlX3BhZ2VzKHN0cnVjdCBwYWdlICoqcGFn
ZXMsIGludCBucik7CiMgMTY4ICIuL2luY2x1ZGUvbGludXgvcGFnZW1hcC5oIgpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgaW50IF9fcGFnZV9jYWNoZV9hZGRfc3BlY3VsYXRpdmUoc3RydWN0IHBhZ2UgKnBhZ2Us
IGludCBjb3VudCkKewojIDE4NyAiLi9pbmNsdWRlL2xpbnV4L3BhZ2VtYXAuaCIKIGlmIChf
X2J1aWx0aW5fZXhwZWN0KCEhKCFwYWdlX3JlZl9hZGRfdW5sZXNzKHBhZ2UsIGNvdW50LCAw
KSksIDApKSB7CgoKCgoKICByZXR1cm4gMDsKIH0KCiAoKHZvaWQpKHNpemVvZigoIGxvbmcp
KFBhZ2VUYWlsKHBhZ2UpKSkpKTsKCiByZXR1cm4gMTsKfQoKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBwYWdl
X2NhY2hlX2dldF9zcGVjdWxhdGl2ZShzdHJ1Y3QgcGFnZSAqcGFnZSkKewogcmV0dXJuIF9f
cGFnZV9jYWNoZV9hZGRfc3BlY3VsYXRpdmUocGFnZSwgMSk7Cn0KCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQg
cGFnZV9jYWNoZV9hZGRfc3BlY3VsYXRpdmUoc3RydWN0IHBhZ2UgKnBhZ2UsIGludCBjb3Vu
dCkKewogcmV0dXJuIF9fcGFnZV9jYWNoZV9hZGRfc3BlY3VsYXRpdmUocGFnZSwgY291bnQp
Owp9CiMgMjE5ICIuL2luY2x1ZGUvbGludXgvcGFnZW1hcC5oIgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBh
dHRhY2hfcGFnZV9wcml2YXRlKHN0cnVjdCBwYWdlICpwYWdlLCB2b2lkICpkYXRhKQp7CiBn
ZXRfcGFnZShwYWdlKTsKIHNldF9wYWdlX3ByaXZhdGUocGFnZSwgKHVuc2lnbmVkIGxvbmcp
ZGF0YSk7CiBTZXRQYWdlUHJpdmF0ZShwYWdlKTsKfQojIDIzNSAiLi9pbmNsdWRlL2xpbnV4
L3BhZ2VtYXAuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgKmRldGFjaF9wYWdlX3ByaXZhdGUoc3RydWN0
IHBhZ2UgKnBhZ2UpCnsKIHZvaWQgKmRhdGEgPSAodm9pZCAqKSgocGFnZSktPnByaXZhdGUp
OwoKIGlmICghUGFnZVByaXZhdGUocGFnZSkpCiAgcmV0dXJuICgodm9pZCAqKTApOwogQ2xl
YXJQYWdlUHJpdmF0ZShwYWdlKTsKIHNldF9wYWdlX3ByaXZhdGUocGFnZSwgMCk7CiBwdXRf
cGFnZShwYWdlKTsKCiByZXR1cm4gZGF0YTsKfQoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHN0cnVjdCBwYWdl
ICpfX3BhZ2VfY2FjaGVfYWxsb2MoZ2ZwX3QgZ2ZwKQp7CiByZXR1cm4gYWxsb2NfcGFnZXNf
bm9kZShudW1hX25vZGVfaWQoKSwgZ2ZwLCAwKTsKfQoKCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3QgcGFn
ZSAqcGFnZV9jYWNoZV9hbGxvYyhzdHJ1Y3QgYWRkcmVzc19zcGFjZSAqeCkKewogcmV0dXJu
IF9fcGFnZV9jYWNoZV9hbGxvYyhtYXBwaW5nX2dmcF9tYXNrKHgpKTsKfQoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IGdmcF90IHJlYWRhaGVhZF9nZnBfbWFzayhzdHJ1Y3QgYWRkcmVzc19zcGFjZSAqeCkKewog
cmV0dXJuIG1hcHBpbmdfZ2ZwX21hc2soeCkgfCAoKCBnZnBfdCkweDEwMDAwdSkgfCAoKCBn
ZnBfdCkweDIwMDB1KTsKfQoKdHlwZWRlZiBpbnQgZmlsbGVyX3Qodm9pZCAqLCBzdHJ1Y3Qg
cGFnZSAqKTsKCnVuc2lnbmVkIGxvbmcgcGFnZV9jYWNoZV9uZXh0X21pc3Moc3RydWN0IGFk
ZHJlc3Nfc3BhY2UgKm1hcHBpbmcsCiAgICAgICAgdW5zaWduZWQgbG9uZyBpbmRleCwgdW5z
aWduZWQgbG9uZyBtYXhfc2Nhbik7CnVuc2lnbmVkIGxvbmcgcGFnZV9jYWNoZV9wcmV2X21p
c3Moc3RydWN0IGFkZHJlc3Nfc3BhY2UgKm1hcHBpbmcsCiAgICAgICAgdW5zaWduZWQgbG9u
ZyBpbmRleCwgdW5zaWduZWQgbG9uZyBtYXhfc2Nhbik7CiMgMjgyICIuL2luY2x1ZGUvbGlu
dXgvcGFnZW1hcC5oIgpzdHJ1Y3QgcGFnZSAqcGFnZWNhY2hlX2dldF9wYWdlKHN0cnVjdCBh
ZGRyZXNzX3NwYWNlICptYXBwaW5nLCB1bnNpZ25lZCBsb25nIG9mZnNldCwKICBpbnQgZmdw
X2ZsYWdzLCBnZnBfdCBjYWNoZV9nZnBfbWFzayk7CiMgMjk1ICIuL2luY2x1ZGUvbGludXgv
cGFnZW1hcC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IHBhZ2UgKmZpbmRfZ2V0X3BhZ2Uoc3RydWN0
IGFkZHJlc3Nfc3BhY2UgKm1hcHBpbmcsCiAgICAgdW5zaWduZWQgbG9uZyBvZmZzZXQpCnsK
IHJldHVybiBwYWdlY2FjaGVfZ2V0X3BhZ2UobWFwcGluZywgb2Zmc2V0LCAwLCAwKTsKfQoK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIHN0cnVjdCBwYWdlICpmaW5kX2dldF9wYWdlX2ZsYWdzKHN0cnVjdCBhZGRy
ZXNzX3NwYWNlICptYXBwaW5nLAogICAgIHVuc2lnbmVkIGxvbmcgb2Zmc2V0LCBpbnQgZmdw
X2ZsYWdzKQp7CiByZXR1cm4gcGFnZWNhY2hlX2dldF9wYWdlKG1hcHBpbmcsIG9mZnNldCwg
ZmdwX2ZsYWdzLCAwKTsKfQojIDMyMCAiLi9pbmNsdWRlL2xpbnV4L3BhZ2VtYXAuaCIKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIHN0cnVjdCBwYWdlICpmaW5kX2xvY2tfcGFnZShzdHJ1Y3QgYWRkcmVzc19zcGFj
ZSAqbWFwcGluZywKICAgICB1bnNpZ25lZCBsb25nIG9mZnNldCkKewogcmV0dXJuIHBhZ2Vj
YWNoZV9nZXRfcGFnZShtYXBwaW5nLCBvZmZzZXQsIDB4MDAwMDAwMDIsIDApOwp9CiMgMzQ1
ICIuL2luY2x1ZGUvbGludXgvcGFnZW1hcC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IHBhZ2UgKmZp
bmRfb3JfY3JlYXRlX3BhZ2Uoc3RydWN0IGFkZHJlc3Nfc3BhY2UgKm1hcHBpbmcsCiAgICAg
dW5zaWduZWQgbG9uZyBpbmRleCwgZ2ZwX3QgZ2ZwX21hc2spCnsKIHJldHVybiBwYWdlY2Fj
aGVfZ2V0X3BhZ2UobWFwcGluZywgaW5kZXgsCiAgICAgMHgwMDAwMDAwMnwweDAwMDAwMDAx
fDB4MDAwMDAwMDQsCiAgICAgZ2ZwX21hc2spOwp9CiMgMzY2ICIuL2luY2x1ZGUvbGludXgv
cGFnZW1hcC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IHBhZ2UgKmdyYWJfY2FjaGVfcGFnZV9ub3dh
aXQoc3RydWN0IGFkZHJlc3Nfc3BhY2UgKm1hcHBpbmcsCiAgICB1bnNpZ25lZCBsb25nIGlu
ZGV4KQp7CiByZXR1cm4gcGFnZWNhY2hlX2dldF9wYWdlKG1hcHBpbmcsIGluZGV4LAogICAw
eDAwMDAwMDAyfDB4MDAwMDAwMDR8MHgwMDAwMDAxMHwweDAwMDAwMDIwLAogICBtYXBwaW5n
X2dmcF9tYXNrKG1hcHBpbmcpKTsKfQoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3QgcGFnZSAqZmlu
ZF9zdWJwYWdlKHN0cnVjdCBwYWdlICpoZWFkLCB1bnNpZ25lZCBsb25nIGluZGV4KQp7Cgog
aWYgKFBhZ2VIdWdlKGhlYWQpKQogIHJldHVybiBoZWFkOwoKIHJldHVybiBoZWFkICsgKGlu
ZGV4ICYgKGhwYWdlX25yX3BhZ2VzKGhlYWQpIC0gMSkpOwp9CgpzdHJ1Y3QgcGFnZSAqZmlu
ZF9nZXRfZW50cnkoc3RydWN0IGFkZHJlc3Nfc3BhY2UgKm1hcHBpbmcsIHVuc2lnbmVkIGxv
bmcgb2Zmc2V0KTsKc3RydWN0IHBhZ2UgKmZpbmRfbG9ja19lbnRyeShzdHJ1Y3QgYWRkcmVz
c19zcGFjZSAqbWFwcGluZywgdW5zaWduZWQgbG9uZyBvZmZzZXQpOwp1bnNpZ25lZCBmaW5k
X2dldF9lbnRyaWVzKHN0cnVjdCBhZGRyZXNzX3NwYWNlICptYXBwaW5nLCB1bnNpZ25lZCBs
b25nIHN0YXJ0LAogICAgIHVuc2lnbmVkIGludCBucl9lbnRyaWVzLCBzdHJ1Y3QgcGFnZSAq
KmVudHJpZXMsCiAgICAgdW5zaWduZWQgbG9uZyAqaW5kaWNlcyk7CnVuc2lnbmVkIGZpbmRf
Z2V0X3BhZ2VzX3JhbmdlKHN0cnVjdCBhZGRyZXNzX3NwYWNlICptYXBwaW5nLCB1bnNpZ25l
ZCBsb25nICpzdGFydCwKICAgdW5zaWduZWQgbG9uZyBlbmQsIHVuc2lnbmVkIGludCBucl9w
YWdlcywKICAgc3RydWN0IHBhZ2UgKipwYWdlcyk7CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1bnNpZ25lZCBmaW5k
X2dldF9wYWdlcyhzdHJ1Y3QgYWRkcmVzc19zcGFjZSAqbWFwcGluZywKICAgdW5zaWduZWQg
bG9uZyAqc3RhcnQsIHVuc2lnbmVkIGludCBucl9wYWdlcywKICAgc3RydWN0IHBhZ2UgKipw
YWdlcykKewogcmV0dXJuIGZpbmRfZ2V0X3BhZ2VzX3JhbmdlKG1hcHBpbmcsIHN0YXJ0LCAo
dW5zaWduZWQgbG9uZyktMSwgbnJfcGFnZXMsCiAgICAgICAgcGFnZXMpOwp9CnVuc2lnbmVk
IGZpbmRfZ2V0X3BhZ2VzX2NvbnRpZyhzdHJ1Y3QgYWRkcmVzc19zcGFjZSAqbWFwcGluZywg
dW5zaWduZWQgbG9uZyBzdGFydCwKICAgICAgICAgIHVuc2lnbmVkIGludCBucl9wYWdlcywg
c3RydWN0IHBhZ2UgKipwYWdlcyk7CnVuc2lnbmVkIGZpbmRfZ2V0X3BhZ2VzX3JhbmdlX3Rh
ZyhzdHJ1Y3QgYWRkcmVzc19zcGFjZSAqbWFwcGluZywgdW5zaWduZWQgbG9uZyAqaW5kZXgs
CiAgIHVuc2lnbmVkIGxvbmcgZW5kLCB4YV9tYXJrX3QgdGFnLCB1bnNpZ25lZCBpbnQgbnJf
cGFnZXMsCiAgIHN0cnVjdCBwYWdlICoqcGFnZXMpOwpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgZmlu
ZF9nZXRfcGFnZXNfdGFnKHN0cnVjdCBhZGRyZXNzX3NwYWNlICptYXBwaW5nLAogICB1bnNp
Z25lZCBsb25nICppbmRleCwgeGFfbWFya190IHRhZywgdW5zaWduZWQgaW50IG5yX3BhZ2Vz
LAogICBzdHJ1Y3QgcGFnZSAqKnBhZ2VzKQp7CiByZXR1cm4gZmluZF9nZXRfcGFnZXNfcmFu
Z2VfdGFnKG1hcHBpbmcsIGluZGV4LCAodW5zaWduZWQgbG9uZyktMSwgdGFnLAogICAgIG5y
X3BhZ2VzLCBwYWdlcyk7Cn0KCnN0cnVjdCBwYWdlICpncmFiX2NhY2hlX3BhZ2Vfd3JpdGVf
YmVnaW4oc3RydWN0IGFkZHJlc3Nfc3BhY2UgKm1hcHBpbmcsCiAgIHVuc2lnbmVkIGxvbmcg
aW5kZXgsIHVuc2lnbmVkIGZsYWdzKTsKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3QgcGFnZSAqZ3Jh
Yl9jYWNoZV9wYWdlKHN0cnVjdCBhZGRyZXNzX3NwYWNlICptYXBwaW5nLAogICAgICAgIHVu
c2lnbmVkIGxvbmcgaW5kZXgpCnsKIHJldHVybiBmaW5kX29yX2NyZWF0ZV9wYWdlKG1hcHBp
bmcsIGluZGV4LCBtYXBwaW5nX2dmcF9tYXNrKG1hcHBpbmcpKTsKfQoKZXh0ZXJuIHN0cnVj
dCBwYWdlICogcmVhZF9jYWNoZV9wYWdlKHN0cnVjdCBhZGRyZXNzX3NwYWNlICptYXBwaW5n
LAogICAgdW5zaWduZWQgbG9uZyBpbmRleCwgZmlsbGVyX3QgKmZpbGxlciwgdm9pZCAqZGF0
YSk7CmV4dGVybiBzdHJ1Y3QgcGFnZSAqIHJlYWRfY2FjaGVfcGFnZV9nZnAoc3RydWN0IGFk
ZHJlc3Nfc3BhY2UgKm1hcHBpbmcsCiAgICB1bnNpZ25lZCBsb25nIGluZGV4LCBnZnBfdCBn
ZnBfbWFzayk7CmV4dGVybiBpbnQgcmVhZF9jYWNoZV9wYWdlcyhzdHJ1Y3QgYWRkcmVzc19z
cGFjZSAqbWFwcGluZywKICBzdHJ1Y3QgbGlzdF9oZWFkICpwYWdlcywgZmlsbGVyX3QgKmZp
bGxlciwgdm9pZCAqZGF0YSk7CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IHBhZ2UgKnJlYWRfbWFwcGlu
Z19wYWdlKHN0cnVjdCBhZGRyZXNzX3NwYWNlICptYXBwaW5nLAogICAgdW5zaWduZWQgbG9u
ZyBpbmRleCwgdm9pZCAqZGF0YSkKewogcmV0dXJuIHJlYWRfY2FjaGVfcGFnZShtYXBwaW5n
LCBpbmRleCwgKCh2b2lkICopMCksIGRhdGEpOwp9CgoKCgoKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHVuc2lnbmVk
IGxvbmcgcGFnZV90b19pbmRleChzdHJ1Y3QgcGFnZSAqcGFnZSkKewogdW5zaWduZWQgbG9u
ZyBwZ29mZjsKCiBpZiAoX19idWlsdGluX2V4cGVjdCghISghUGFnZVRyYW5zVGFpbChwYWdl
KSksIDEpKQogIHJldHVybiBwYWdlLT5pbmRleDsKCgoKCgogcGdvZmYgPSBjb21wb3VuZF9o
ZWFkKHBhZ2UpLT5pbmRleDsKIHBnb2ZmICs9IHBhZ2UgLSBjb21wb3VuZF9oZWFkKHBhZ2Up
OwogcmV0dXJuIHBnb2ZmOwp9CgoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHVuc2lnbmVkIGxvbmcgcGFnZV90
b19wZ29mZihzdHJ1Y3QgcGFnZSAqcGFnZSkKewogaWYgKF9fYnVpbHRpbl9leHBlY3QoISEo
UGFnZUhlYWRIdWdlKHBhZ2UpKSwgMCkpCiAgcmV0dXJuIHBhZ2UtPmluZGV4IDw8IGNvbXBv
dW5kX29yZGVyKHBhZ2UpOwoKIHJldHVybiBwYWdlX3RvX2luZGV4KHBhZ2UpOwp9CgoKCgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgbG9mZl90IHBhZ2Vfb2Zmc2V0KHN0cnVjdCBwYWdlICpwYWdlKQp7CiByZXR1
cm4gKChsb2ZmX3QpcGFnZS0+aW5kZXgpIDw8IDEyOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgbG9mZl90IHBh
Z2VfZmlsZV9vZmZzZXQoc3RydWN0IHBhZ2UgKnBhZ2UpCnsKIHJldHVybiAoKGxvZmZfdClw
YWdlX2luZGV4KHBhZ2UpKSA8PCAxMjsKfQoKZXh0ZXJuIHVuc2lnbmVkIGxvbmcgbGluZWFy
X2h1Z2VwYWdlX2luZGV4KHN0cnVjdCB2bV9hcmVhX3N0cnVjdCAqdm1hLAogICAgICAgICB1
bnNpZ25lZCBsb25nIGFkZHJlc3MpOwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHVuc2lnbmVkIGxvbmcgbGluZWFy
X3BhZ2VfaW5kZXgoc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEsCiAgICAgdW5zaWduZWQg
bG9uZyBhZGRyZXNzKQp7CiB1bnNpZ25lZCBsb25nIHBnb2ZmOwogaWYgKF9fYnVpbHRpbl9l
eHBlY3QoISEoaXNfdm1faHVnZXRsYl9wYWdlKHZtYSkpLCAwKSkKICByZXR1cm4gbGluZWFy
X2h1Z2VwYWdlX2luZGV4KHZtYSwgYWRkcmVzcyk7CiBwZ29mZiA9IChhZGRyZXNzIC0gdm1h
LT52bV9zdGFydCkgPj4gMTI7CiBwZ29mZiArPSB2bWEtPnZtX3Bnb2ZmOwogcmV0dXJuIHBn
b2ZmOwp9CgpleHRlcm4gdm9pZCBfX2xvY2tfcGFnZShzdHJ1Y3QgcGFnZSAqcGFnZSk7CmV4
dGVybiBpbnQgX19sb2NrX3BhZ2Vfa2lsbGFibGUoc3RydWN0IHBhZ2UgKnBhZ2UpOwpleHRl
cm4gaW50IF9fbG9ja19wYWdlX29yX3JldHJ5KHN0cnVjdCBwYWdlICpwYWdlLCBzdHJ1Y3Qg
bW1fc3RydWN0ICptbSwKICAgIHVuc2lnbmVkIGludCBmbGFncyk7CmV4dGVybiB2b2lkIHVu
bG9ja19wYWdlKHN0cnVjdCBwYWdlICpwYWdlKTsKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgdHJ5bG9j
a19wYWdlKHN0cnVjdCBwYWdlICpwYWdlKQp7CiBwYWdlID0gY29tcG91bmRfaGVhZChwYWdl
KTsKIHJldHVybiAoX19idWlsdGluX2V4cGVjdCghISghdGVzdF9hbmRfc2V0X2JpdF9sb2Nr
KFBHX2xvY2tlZCwgJnBhZ2UtPmZsYWdzKSksIDEpKTsKfQoKCgoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQg
bG9ja19wYWdlKHN0cnVjdCBwYWdlICpwYWdlKQp7CiBkbyB7IGRvIHsgfSB3aGlsZSAoMCk7
IH0gd2hpbGUgKDApOwogaWYgKCF0cnlsb2NrX3BhZ2UocGFnZSkpCiAgX19sb2NrX3BhZ2Uo
cGFnZSk7Cn0KCgoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBsb2NrX3BhZ2Vfa2lsbGFibGUoc3RydWN0
IHBhZ2UgKnBhZ2UpCnsKIGRvIHsgZG8geyB9IHdoaWxlICgwKTsgfSB3aGlsZSAoMCk7CiBp
ZiAoIXRyeWxvY2tfcGFnZShwYWdlKSkKICByZXR1cm4gX19sb2NrX3BhZ2Vfa2lsbGFibGUo
cGFnZSk7CiByZXR1cm4gMDsKfQojIDU0NCAiLi9pbmNsdWRlL2xpbnV4L3BhZ2VtYXAuaCIK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIGludCBsb2NrX3BhZ2Vfb3JfcmV0cnkoc3RydWN0IHBhZ2UgKnBhZ2UsIHN0
cnVjdCBtbV9zdHJ1Y3QgKm1tLAogICAgICAgICB1bnNpZ25lZCBpbnQgZmxhZ3MpCnsKIGRv
IHsgZG8geyB9IHdoaWxlICgwKTsgfSB3aGlsZSAoMCk7CiByZXR1cm4gdHJ5bG9ja19wYWdl
KHBhZ2UpIHx8IF9fbG9ja19wYWdlX29yX3JldHJ5KHBhZ2UsIG1tLCBmbGFncyk7Cn0KCgoK
CgpleHRlcm4gdm9pZCB3YWl0X29uX3BhZ2VfYml0KHN0cnVjdCBwYWdlICpwYWdlLCBpbnQg
Yml0X25yKTsKZXh0ZXJuIGludCB3YWl0X29uX3BhZ2VfYml0X2tpbGxhYmxlKHN0cnVjdCBw
YWdlICpwYWdlLCBpbnQgYml0X25yKTsKIyA1NjUgIi4vaW5jbHVkZS9saW51eC9wYWdlbWFw
LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSB2b2lkIHdhaXRfb25fcGFnZV9sb2NrZWQoc3RydWN0IHBhZ2UgKnBh
Z2UpCnsKIGlmIChQYWdlTG9ja2VkKHBhZ2UpKQogIHdhaXRfb25fcGFnZV9iaXQoY29tcG91
bmRfaGVhZChwYWdlKSwgUEdfbG9ja2VkKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCB3YWl0X29uX3Bh
Z2VfbG9ja2VkX2tpbGxhYmxlKHN0cnVjdCBwYWdlICpwYWdlKQp7CiBpZiAoIVBhZ2VMb2Nr
ZWQocGFnZSkpCiAgcmV0dXJuIDA7CiByZXR1cm4gd2FpdF9vbl9wYWdlX2JpdF9raWxsYWJs
ZShjb21wb3VuZF9oZWFkKHBhZ2UpLCBQR19sb2NrZWQpOwp9CgpleHRlcm4gdm9pZCBwdXRf
YW5kX3dhaXRfb25fcGFnZV9sb2NrZWQoc3RydWN0IHBhZ2UgKnBhZ2UpOwoKdm9pZCB3YWl0
X29uX3BhZ2Vfd3JpdGViYWNrKHN0cnVjdCBwYWdlICpwYWdlKTsKZXh0ZXJuIHZvaWQgZW5k
X3BhZ2Vfd3JpdGViYWNrKHN0cnVjdCBwYWdlICpwYWdlKTsKdm9pZCB3YWl0X2Zvcl9zdGFi
bGVfcGFnZShzdHJ1Y3QgcGFnZSAqcGFnZSk7Cgp2b2lkIHBhZ2VfZW5kaW8oc3RydWN0IHBh
Z2UgKnBhZ2UsIGJvb2wgaXNfd3JpdGUsIGludCBlcnIpOwoKCgoKZXh0ZXJuIHZvaWQgYWRk
X3BhZ2Vfd2FpdF9xdWV1ZShzdHJ1Y3QgcGFnZSAqcGFnZSwgd2FpdF9xdWV1ZV9lbnRyeV90
ICp3YWl0ZXIpOwoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBmYXVsdF9pbl9wYWdlc193cml0ZWFibGUo
Y2hhciAqdWFkZHIsIGludCBzaXplKQp7CiBjaGFyICplbmQgPSB1YWRkciArIHNpemUgLSAx
OwoKIGlmIChfX2J1aWx0aW5fZXhwZWN0KCEhKHNpemUgPT0gMCksIDApKQogIHJldHVybiAw
OwoKIGlmIChfX2J1aWx0aW5fZXhwZWN0KCEhKHVhZGRyID4gZW5kKSwgMCkpCiAgcmV0dXJu
IC0xNDsKCgoKCiBkbyB7CiAgaWYgKF9fYnVpbHRpbl9leHBlY3QoISEoKHsgbG9uZyBfX3B1
X2VycjsgX190eXBlb2ZfXygqKCh1YWRkcikpKSAqX19wdV9hZGRyID0gKCh1YWRkcikpOyBf
X3R5cGVvZl9fKCooKHVhZGRyKSkpIF9fcHVfdmFsID0gKChfX3R5cGVvZl9fKCoodWFkZHIp
KSkoMCkpOyBfX3R5cGVvZl9fKHNpemVvZigqKHVhZGRyKSkpIF9fcHVfc2l6ZSA9IChzaXpl
b2YoKih1YWRkcikpKTsgaWYgKCEoKCh1bnNpZ25lZCBsb25nKV9fcHVfYWRkcikgPj0gMHg4
MDAwMDAwMDAwMDAwMDAwdWwpKSBtaWdodF9mYXVsdCgpOyAodm9pZCkwOyBkbyB7IGFsbG93
X3dyaXRlX3RvX3VzZXIoX19wdV9hZGRyLCBfX3B1X3NpemUpOyBkbyB7IF9fcHVfZXJyID0g
MDsgc3dpdGNoIChfX3B1X3NpemUpIHsgY2FzZSAxOiBfX2FzbV9fIF9fdm9sYXRpbGVfXygg
IjE6CSIgInN0YiIgIiVVMiVYMiAlMSwlMgkjIHB1dF91c2VyXG4iICIyOlxuIiAiLnNlY3Rp
b24gLmZpeHVwLFwiYXhcIlxuIiAiMzoJbGkgJTAsJTNcbiIgIgliIDJiXG4iICIucHJldmlv
dXNcbiIgIi5zZWN0aW9uIF9fZXhfdGFibGUsXCJhXCI7IiAiICIgIi5iYWxpZ24gNDsiICIg
IiAiLmxvbmcgKDFiKSAtIC4gOyIgIiAiICIubG9uZyAoM2IpIC0gLiA7IiAiICIgIi5wcmV2
aW91cyIgIiAiIDogIj1yIiAoX19wdV9lcnIpIDogInIiIChfX3B1X3ZhbCksICJtPD4iICgq
X19wdV9hZGRyKSwgImkiICgtMTQpLCAiMCIgKF9fcHVfZXJyKSk7IGJyZWFrOyBjYXNlIDI6
IF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJIiAic3RoIiAiJVUyJVgyICUxLCUyCSMgcHV0
X3VzZXJcbiIgIjI6XG4iICIuc2VjdGlvbiAuZml4dXAsXCJheFwiXG4iICIzOglsaSAlMCwl
M1xuIiAiCWIgMmJcbiIgIi5wcmV2aW91c1xuIiAiLnNlY3Rpb24gX19leF90YWJsZSxcImFc
IjsiICIgIiAiLmJhbGlnbiA0OyIgIiAiICIubG9uZyAoMWIpIC0gLiA7IiAiICIgIi5sb25n
ICgzYikgLSAuIDsiICIgIiAiLnByZXZpb3VzIiAiICIgOiAiPXIiIChfX3B1X2VycikgOiAi
ciIgKF9fcHVfdmFsKSwgIm08PiIgKCpfX3B1X2FkZHIpLCAiaSIgKC0xNCksICIwIiAoX19w
dV9lcnIpKTsgYnJlYWs7IGNhc2UgNDogX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgkiICJz
dHciICIlVTIlWDIgJTEsJTIJIyBwdXRfdXNlclxuIiAiMjpcbiIgIi5zZWN0aW9uIC5maXh1
cCxcImF4XCJcbiIgIjM6CWxpICUwLCUzXG4iICIJYiAyYlxuIiAiLnByZXZpb3VzXG4iICIu
c2VjdGlvbiBfX2V4X3RhYmxlLFwiYVwiOyIgIiAiICIuYmFsaWduIDQ7IiAiICIgIi5sb25n
ICgxYikgLSAuIDsiICIgIiAiLmxvbmcgKDNiKSAtIC4gOyIgIiAiICIucHJldmlvdXMiICIg
IiA6ICI9ciIgKF9fcHVfZXJyKSA6ICJyIiAoX19wdV92YWwpLCAibTw+IiAoKl9fcHVfYWRk
ciksICJpIiAoLTE0KSwgIjAiIChfX3B1X2VycikpOyBicmVhazsgY2FzZSA4OiBfX2FzbV9f
IF9fdm9sYXRpbGVfXyggIjE6CSIgInN0ZCIgIiVVMiVYMiAlMSwlMgkjIHB1dF91c2VyXG4i
ICIyOlxuIiAiLnNlY3Rpb24gLmZpeHVwLFwiYXhcIlxuIiAiMzoJbGkgJTAsJTNcbiIgIgli
IDJiXG4iICIucHJldmlvdXNcbiIgIi5zZWN0aW9uIF9fZXhfdGFibGUsXCJhXCI7IiAiICIg
Ii5iYWxpZ24gNDsiICIgIiAiLmxvbmcgKDFiKSAtIC4gOyIgIiAiICIubG9uZyAoM2IpIC0g
LiA7IiAiICIgIi5wcmV2aW91cyIgIiAiIDogIj1yIiAoX19wdV9lcnIpIDogInIiIChfX3B1
X3ZhbCksICJtPD4iICgqX19wdV9hZGRyKSwgImkiICgtMTQpLCAiMCIgKF9fcHVfZXJyKSk7
IGJyZWFrOyBkZWZhdWx0OiBfX3B1dF91c2VyX2JhZCgpOyB9IH0gd2hpbGUgKDApOyBwcmV2
ZW50X3dyaXRlX3RvX3VzZXIoX19wdV9hZGRyLCBfX3B1X3NpemUpOyB9IHdoaWxlICgwKTsg
X19wdV9lcnI7IH0pICE9IDApLCAwKSkKICAgcmV0dXJuIC0xNDsKICB1YWRkciArPSAoMVVM
IDw8IDEyKTsKIH0gd2hpbGUgKHVhZGRyIDw9IGVuZCk7CgoKIGlmICgoKHVuc2lnbmVkIGxv
bmcpdWFkZHIgJiAofigoMSA8PCAxMikgLSAxKSkpID09CiAgICgodW5zaWduZWQgbG9uZyll
bmQgJiAofigoMSA8PCAxMikgLSAxKSkpKQogIHJldHVybiAoeyBsb25nIF9fcHVfZXJyOyBf
X3R5cGVvZl9fKCooKGVuZCkpKSAqX19wdV9hZGRyID0gKChlbmQpKTsgX190eXBlb2ZfXygq
KChlbmQpKSkgX19wdV92YWwgPSAoKF9fdHlwZW9mX18oKihlbmQpKSkoMCkpOyBfX3R5cGVv
Zl9fKHNpemVvZigqKGVuZCkpKSBfX3B1X3NpemUgPSAoc2l6ZW9mKCooZW5kKSkpOyBpZiAo
ISgoKHVuc2lnbmVkIGxvbmcpX19wdV9hZGRyKSA+PSAweDgwMDAwMDAwMDAwMDAwMDB1bCkp
IG1pZ2h0X2ZhdWx0KCk7ICh2b2lkKTA7IGRvIHsgYWxsb3dfd3JpdGVfdG9fdXNlcihfX3B1
X2FkZHIsIF9fcHVfc2l6ZSk7IGRvIHsgX19wdV9lcnIgPSAwOyBzd2l0Y2ggKF9fcHVfc2l6
ZSkgeyBjYXNlIDE6IF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJIiAic3RiIiAiJVUyJVgy
ICUxLCUyCSMgcHV0X3VzZXJcbiIgIjI6XG4iICIuc2VjdGlvbiAuZml4dXAsXCJheFwiXG4i
ICIzOglsaSAlMCwlM1xuIiAiCWIgMmJcbiIgIi5wcmV2aW91c1xuIiAiLnNlY3Rpb24gX19l
eF90YWJsZSxcImFcIjsiICIgIiAiLmJhbGlnbiA0OyIgIiAiICIubG9uZyAoMWIpIC0gLiA7
IiAiICIgIi5sb25nICgzYikgLSAuIDsiICIgIiAiLnByZXZpb3VzIiAiICIgOiAiPXIiIChf
X3B1X2VycikgOiAiciIgKF9fcHVfdmFsKSwgIm08PiIgKCpfX3B1X2FkZHIpLCAiaSIgKC0x
NCksICIwIiAoX19wdV9lcnIpKTsgYnJlYWs7IGNhc2UgMjogX19hc21fXyBfX3ZvbGF0aWxl
X18oICIxOgkiICJzdGgiICIlVTIlWDIgJTEsJTIJIyBwdXRfdXNlclxuIiAiMjpcbiIgIi5z
ZWN0aW9uIC5maXh1cCxcImF4XCJcbiIgIjM6CWxpICUwLCUzXG4iICIJYiAyYlxuIiAiLnBy
ZXZpb3VzXG4iICIuc2VjdGlvbiBfX2V4X3RhYmxlLFwiYVwiOyIgIiAiICIuYmFsaWduIDQ7
IiAiICIgIi5sb25nICgxYikgLSAuIDsiICIgIiAiLmxvbmcgKDNiKSAtIC4gOyIgIiAiICIu
cHJldmlvdXMiICIgIiA6ICI9ciIgKF9fcHVfZXJyKSA6ICJyIiAoX19wdV92YWwpLCAibTw+
IiAoKl9fcHVfYWRkciksICJpIiAoLTE0KSwgIjAiIChfX3B1X2VycikpOyBicmVhazsgY2Fz
ZSA0OiBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CSIgInN0dyIgIiVVMiVYMiAlMSwlMgkj
IHB1dF91c2VyXG4iICIyOlxuIiAiLnNlY3Rpb24gLmZpeHVwLFwiYXhcIlxuIiAiMzoJbGkg
JTAsJTNcbiIgIgliIDJiXG4iICIucHJldmlvdXNcbiIgIi5zZWN0aW9uIF9fZXhfdGFibGUs
XCJhXCI7IiAiICIgIi5iYWxpZ24gNDsiICIgIiAiLmxvbmcgKDFiKSAtIC4gOyIgIiAiICIu
bG9uZyAoM2IpIC0gLiA7IiAiICIgIi5wcmV2aW91cyIgIiAiIDogIj1yIiAoX19wdV9lcnIp
IDogInIiIChfX3B1X3ZhbCksICJtPD4iICgqX19wdV9hZGRyKSwgImkiICgtMTQpLCAiMCIg
KF9fcHVfZXJyKSk7IGJyZWFrOyBjYXNlIDg6IF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJ
IiAic3RkIiAiJVUyJVgyICUxLCUyCSMgcHV0X3VzZXJcbiIgIjI6XG4iICIuc2VjdGlvbiAu
Zml4dXAsXCJheFwiXG4iICIzOglsaSAlMCwlM1xuIiAiCWIgMmJcbiIgIi5wcmV2aW91c1xu
IiAiLnNlY3Rpb24gX19leF90YWJsZSxcImFcIjsiICIgIiAiLmJhbGlnbiA0OyIgIiAiICIu
bG9uZyAoMWIpIC0gLiA7IiAiICIgIi5sb25nICgzYikgLSAuIDsiICIgIiAiLnByZXZpb3Vz
IiAiICIgOiAiPXIiIChfX3B1X2VycikgOiAiciIgKF9fcHVfdmFsKSwgIm08PiIgKCpfX3B1
X2FkZHIpLCAiaSIgKC0xNCksICIwIiAoX19wdV9lcnIpKTsgYnJlYWs7IGRlZmF1bHQ6IF9f
cHV0X3VzZXJfYmFkKCk7IH0gfSB3aGlsZSAoMCk7IHByZXZlbnRfd3JpdGVfdG9fdXNlcihf
X3B1X2FkZHIsIF9fcHVfc2l6ZSk7IH0gd2hpbGUgKDApOyBfX3B1X2VycjsgfSk7CgogcmV0
dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgZmF1bHRfaW5fcGFnZXNfcmVhZGFibGUoY29uc3Qg
Y2hhciAqdWFkZHIsIGludCBzaXplKQp7CiB2b2xhdGlsZSBjaGFyIGM7CiBjb25zdCBjaGFy
ICplbmQgPSB1YWRkciArIHNpemUgLSAxOwoKIGlmIChfX2J1aWx0aW5fZXhwZWN0KCEhKHNp
emUgPT0gMCksIDApKQogIHJldHVybiAwOwoKIGlmIChfX2J1aWx0aW5fZXhwZWN0KCEhKHVh
ZGRyID4gZW5kKSwgMCkpCiAgcmV0dXJuIC0xNDsKCiBkbyB7CiAgaWYgKF9fYnVpbHRpbl9l
eHBlY3QoISEoKHsgbG9uZyBfX2d1X2VycjsgX190eXBlb2ZfXyhfX2J1aWx0aW5fY2hvb3Nl
X2V4cHIoc2l6ZW9mKCooKHVhZGRyKSkpID4gc2l6ZW9mKDBVTCksIDBVTEwsIDBVTCkpIF9f
Z3VfdmFsOyBfX3R5cGVvZl9fKCooKHVhZGRyKSkpICpfX2d1X2FkZHIgPSAoKHVhZGRyKSk7
IF9fdHlwZW9mX18oc2l6ZW9mKCoodWFkZHIpKSkgX19ndV9zaXplID0gKHNpemVvZigqKHVh
ZGRyKSkpOyAodm9pZCkwOyBpZiAoISgoKHVuc2lnbmVkIGxvbmcpX19ndV9hZGRyKSA+PSAw
eDgwMDAwMDAwMDAwMDAwMDB1bCkpIG1pZ2h0X2ZhdWx0KCk7IGFzbSAoIjk1MzogLnB1c2hz
ZWN0aW9uIF9fYmFycmllcl9ub3NwZWNfZml4dXAsXCJhXCI7IC5hbGlnbiAyOyA5NTQ6IC44
Ynl0ZSA5NTNiLTk1NGI7IC5wb3BzZWN0aW9uOzsgbm9wOyBub3AiICIgIiA6OjogIm1lbW9y
eSIpOyBpZiAodHJ1ZSkgZG8geyBhbGxvd19yZWFkX2Zyb21fdXNlcihfX2d1X2FkZHIsIF9f
Z3Vfc2l6ZSk7IGRvIHsgX19ndV9lcnIgPSAwOyAodm9pZCkwOyBpZiAoX19ndV9zaXplID4g
c2l6ZW9mKF9fZ3VfdmFsKSkgKF9fZ3VfdmFsKSA9IF9fZ2V0X3VzZXJfYmFkKCk7IHN3aXRj
aCAoX19ndV9zaXplKSB7IGNhc2UgMTogX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgkiImxi
eiIiJVUyJVgyICUxLCAlMgkjIGdldF91c2VyXG4iICIyOlxuIiAiLnNlY3Rpb24gLmZpeHVw
LFwiYXhcIlxuIiAiMzoJbGkgJTAsJTNcbiIgIglsaSAlMSwwXG4iICIJYiAyYlxuIiAiLnBy
ZXZpb3VzXG4iICIuc2VjdGlvbiBfX2V4X3RhYmxlLFwiYVwiOyIgIiAiICIuYmFsaWduIDQ7
IiAiICIgIi5sb25nICgxYikgLSAuIDsiICIgIiAiLmxvbmcgKDNiKSAtIC4gOyIgIiAiICIu
cHJldmlvdXMiICIgIiA6ICI9ciIgKF9fZ3VfZXJyKSwgIj1yIiAoX19ndV92YWwpIDogIm08
PiIgKCoodTggKilfX2d1X2FkZHIpLCAiaSIgKC0xNCksICIwIiAoX19ndV9lcnIpKTsgYnJl
YWs7IGNhc2UgMjogX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgkiImxoeiIiJVUyJVgyICUx
LCAlMgkjIGdldF91c2VyXG4iICIyOlxuIiAiLnNlY3Rpb24gLmZpeHVwLFwiYXhcIlxuIiAi
MzoJbGkgJTAsJTNcbiIgIglsaSAlMSwwXG4iICIJYiAyYlxuIiAiLnByZXZpb3VzXG4iICIu
c2VjdGlvbiBfX2V4X3RhYmxlLFwiYVwiOyIgIiAiICIuYmFsaWduIDQ7IiAiICIgIi5sb25n
ICgxYikgLSAuIDsiICIgIiAiLmxvbmcgKDNiKSAtIC4gOyIgIiAiICIucHJldmlvdXMiICIg
IiA6ICI9ciIgKF9fZ3VfZXJyKSwgIj1yIiAoX19ndV92YWwpIDogIm08PiIgKCoodTE2ICop
X19ndV9hZGRyKSwgImkiICgtMTQpLCAiMCIgKF9fZ3VfZXJyKSk7IGJyZWFrOyBjYXNlIDQ6
IF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJIiJsd3oiIiVVMiVYMiAlMSwgJTIJIyBnZXRf
dXNlclxuIiAiMjpcbiIgIi5zZWN0aW9uIC5maXh1cCxcImF4XCJcbiIgIjM6CWxpICUwLCUz
XG4iICIJbGkgJTEsMFxuIiAiCWIgMmJcbiIgIi5wcmV2aW91c1xuIiAiLnNlY3Rpb24gX19l
eF90YWJsZSxcImFcIjsiICIgIiAiLmJhbGlnbiA0OyIgIiAiICIubG9uZyAoMWIpIC0gLiA7
IiAiICIgIi5sb25nICgzYikgLSAuIDsiICIgIiAiLnByZXZpb3VzIiAiICIgOiAiPXIiIChf
X2d1X2VyciksICI9ciIgKF9fZ3VfdmFsKSA6ICJtPD4iICgqKHUzMiAqKV9fZ3VfYWRkciks
ICJpIiAoLTE0KSwgIjAiIChfX2d1X2VycikpOyBicmVhazsgY2FzZSA4OiBfX2FzbV9fIF9f
dm9sYXRpbGVfXyggIjE6CSIibGQiIiVVMiVYMiAlMSwgJTIJIyBnZXRfdXNlclxuIiAiMjpc
biIgIi5zZWN0aW9uIC5maXh1cCxcImF4XCJcbiIgIjM6CWxpICUwLCUzXG4iICIJbGkgJTEs
MFxuIiAiCWIgMmJcbiIgIi5wcmV2aW91c1xuIiAiLnNlY3Rpb24gX19leF90YWJsZSxcImFc
IjsiICIgIiAiLmJhbGlnbiA0OyIgIiAiICIubG9uZyAoMWIpIC0gLiA7IiAiICIgIi5sb25n
ICgzYikgLSAuIDsiICIgIiAiLnByZXZpb3VzIiAiICIgOiAiPXIiIChfX2d1X2VyciksICI9
ciIgKF9fZ3VfdmFsKSA6ICJtPD4iICgqKHU2NCAqKV9fZ3VfYWRkciksICJpIiAoLTE0KSwg
IjAiIChfX2d1X2VycikpOyBicmVhazsgZGVmYXVsdDogKF9fZ3VfdmFsKSA9IF9fZ2V0X3Vz
ZXJfYmFkKCk7IH0gfSB3aGlsZSAoMCk7IHByZXZlbnRfcmVhZF9mcm9tX3VzZXIoX19ndV9h
ZGRyLCBfX2d1X3NpemUpOyB9IHdoaWxlICgwKTsgZWxzZSBkbyB7IF9fZ3VfZXJyID0gMDsg
KHZvaWQpMDsgaWYgKF9fZ3Vfc2l6ZSA+IHNpemVvZihfX2d1X3ZhbCkpIChfX2d1X3ZhbCkg
PSBfX2dldF91c2VyX2JhZCgpOyBzd2l0Y2ggKF9fZ3Vfc2l6ZSkgeyBjYXNlIDE6IF9fYXNt
X18gX192b2xhdGlsZV9fKCAiMToJIiJsYnoiIiVVMiVYMiAlMSwgJTIJIyBnZXRfdXNlclxu
IiAiMjpcbiIgIi5zZWN0aW9uIC5maXh1cCxcImF4XCJcbiIgIjM6CWxpICUwLCUzXG4iICIJ
bGkgJTEsMFxuIiAiCWIgMmJcbiIgIi5wcmV2aW91c1xuIiAiLnNlY3Rpb24gX19leF90YWJs
ZSxcImFcIjsiICIgIiAiLmJhbGlnbiA0OyIgIiAiICIubG9uZyAoMWIpIC0gLiA7IiAiICIg
Ii5sb25nICgzYikgLSAuIDsiICIgIiAiLnByZXZpb3VzIiAiICIgOiAiPXIiIChfX2d1X2Vy
ciksICI9ciIgKF9fZ3VfdmFsKSA6ICJtPD4iICgqKHU4ICopX19ndV9hZGRyKSwgImkiICgt
MTQpLCAiMCIgKF9fZ3VfZXJyKSk7IGJyZWFrOyBjYXNlIDI6IF9fYXNtX18gX192b2xhdGls
ZV9fKCAiMToJIiJsaHoiIiVVMiVYMiAlMSwgJTIJIyBnZXRfdXNlclxuIiAiMjpcbiIgIi5z
ZWN0aW9uIC5maXh1cCxcImF4XCJcbiIgIjM6CWxpICUwLCUzXG4iICIJbGkgJTEsMFxuIiAi
CWIgMmJcbiIgIi5wcmV2aW91c1xuIiAiLnNlY3Rpb24gX19leF90YWJsZSxcImFcIjsiICIg
IiAiLmJhbGlnbiA0OyIgIiAiICIubG9uZyAoMWIpIC0gLiA7IiAiICIgIi5sb25nICgzYikg
LSAuIDsiICIgIiAiLnByZXZpb3VzIiAiICIgOiAiPXIiIChfX2d1X2VyciksICI9ciIgKF9f
Z3VfdmFsKSA6ICJtPD4iICgqKHUxNiAqKV9fZ3VfYWRkciksICJpIiAoLTE0KSwgIjAiIChf
X2d1X2VycikpOyBicmVhazsgY2FzZSA0OiBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CSIi
bHd6IiIlVTIlWDIgJTEsICUyCSMgZ2V0X3VzZXJcbiIgIjI6XG4iICIuc2VjdGlvbiAuZml4
dXAsXCJheFwiXG4iICIzOglsaSAlMCwlM1xuIiAiCWxpICUxLDBcbiIgIgliIDJiXG4iICIu
cHJldmlvdXNcbiIgIi5zZWN0aW9uIF9fZXhfdGFibGUsXCJhXCI7IiAiICIgIi5iYWxpZ24g
NDsiICIgIiAiLmxvbmcgKDFiKSAtIC4gOyIgIiAiICIubG9uZyAoM2IpIC0gLiA7IiAiICIg
Ii5wcmV2aW91cyIgIiAiIDogIj1yIiAoX19ndV9lcnIpLCAiPXIiIChfX2d1X3ZhbCkgOiAi
bTw+IiAoKih1MzIgKilfX2d1X2FkZHIpLCAiaSIgKC0xNCksICIwIiAoX19ndV9lcnIpKTsg
YnJlYWs7IGNhc2UgODogX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgkiImxkIiIlVTIlWDIg
JTEsICUyCSMgZ2V0X3VzZXJcbiIgIjI6XG4iICIuc2VjdGlvbiAuZml4dXAsXCJheFwiXG4i
ICIzOglsaSAlMCwlM1xuIiAiCWxpICUxLDBcbiIgIgliIDJiXG4iICIucHJldmlvdXNcbiIg
Ii5zZWN0aW9uIF9fZXhfdGFibGUsXCJhXCI7IiAiICIgIi5iYWxpZ24gNDsiICIgIiAiLmxv
bmcgKDFiKSAtIC4gOyIgIiAiICIubG9uZyAoM2IpIC0gLiA7IiAiICIgIi5wcmV2aW91cyIg
IiAiIDogIj1yIiAoX19ndV9lcnIpLCAiPXIiIChfX2d1X3ZhbCkgOiAibTw+IiAoKih1NjQg
KilfX2d1X2FkZHIpLCAiaSIgKC0xNCksICIwIiAoX19ndV9lcnIpKTsgYnJlYWs7IGRlZmF1
bHQ6IChfX2d1X3ZhbCkgPSBfX2dldF91c2VyX2JhZCgpOyB9IH0gd2hpbGUgKDApOyAoKGMp
KSA9IChfX3R5cGVvZl9fKCooKHVhZGRyKSkpKV9fZ3VfdmFsOyBfX2d1X2VycjsgfSkgIT0g
MCksIDApKQogICByZXR1cm4gLTE0OwogIHVhZGRyICs9ICgxVUwgPDwgMTIpOwogfSB3aGls
ZSAodWFkZHIgPD0gZW5kKTsKCgogaWYgKCgodW5zaWduZWQgbG9uZyl1YWRkciAmICh+KCgx
IDw8IDEyKSAtIDEpKSkgPT0KICAgKCh1bnNpZ25lZCBsb25nKWVuZCAmICh+KCgxIDw8IDEy
KSAtIDEpKSkpIHsKICByZXR1cm4gKHsgbG9uZyBfX2d1X2VycjsgX190eXBlb2ZfXyhfX2J1
aWx0aW5fY2hvb3NlX2V4cHIoc2l6ZW9mKCooKGVuZCkpKSA+IHNpemVvZigwVUwpLCAwVUxM
LCAwVUwpKSBfX2d1X3ZhbDsgX190eXBlb2ZfXygqKChlbmQpKSkgKl9fZ3VfYWRkciA9ICgo
ZW5kKSk7IF9fdHlwZW9mX18oc2l6ZW9mKCooZW5kKSkpIF9fZ3Vfc2l6ZSA9IChzaXplb2Yo
KihlbmQpKSk7ICh2b2lkKTA7IGlmICghKCgodW5zaWduZWQgbG9uZylfX2d1X2FkZHIpID49
IDB4ODAwMDAwMDAwMDAwMDAwMHVsKSkgbWlnaHRfZmF1bHQoKTsgYXNtICgiOTUzOiAucHVz
aHNlY3Rpb24gX19iYXJyaWVyX25vc3BlY19maXh1cCxcImFcIjsgLmFsaWduIDI7IDk1NDog
LjhieXRlIDk1M2ItOTU0YjsgLnBvcHNlY3Rpb247OyBub3A7IG5vcCIgIiAiIDo6OiAibWVt
b3J5Iik7IGlmICh0cnVlKSBkbyB7IGFsbG93X3JlYWRfZnJvbV91c2VyKF9fZ3VfYWRkciwg
X19ndV9zaXplKTsgZG8geyBfX2d1X2VyciA9IDA7ICh2b2lkKTA7IGlmIChfX2d1X3NpemUg
PiBzaXplb2YoX19ndV92YWwpKSAoX19ndV92YWwpID0gX19nZXRfdXNlcl9iYWQoKTsgc3dp
dGNoIChfX2d1X3NpemUpIHsgY2FzZSAxOiBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CSIi
bGJ6IiIlVTIlWDIgJTEsICUyCSMgZ2V0X3VzZXJcbiIgIjI6XG4iICIuc2VjdGlvbiAuZml4
dXAsXCJheFwiXG4iICIzOglsaSAlMCwlM1xuIiAiCWxpICUxLDBcbiIgIgliIDJiXG4iICIu
cHJldmlvdXNcbiIgIi5zZWN0aW9uIF9fZXhfdGFibGUsXCJhXCI7IiAiICIgIi5iYWxpZ24g
NDsiICIgIiAiLmxvbmcgKDFiKSAtIC4gOyIgIiAiICIubG9uZyAoM2IpIC0gLiA7IiAiICIg
Ii5wcmV2aW91cyIgIiAiIDogIj1yIiAoX19ndV9lcnIpLCAiPXIiIChfX2d1X3ZhbCkgOiAi
bTw+IiAoKih1OCAqKV9fZ3VfYWRkciksICJpIiAoLTE0KSwgIjAiIChfX2d1X2VycikpOyBi
cmVhazsgY2FzZSAyOiBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CSIibGh6IiIlVTIlWDIg
JTEsICUyCSMgZ2V0X3VzZXJcbiIgIjI6XG4iICIuc2VjdGlvbiAuZml4dXAsXCJheFwiXG4i
ICIzOglsaSAlMCwlM1xuIiAiCWxpICUxLDBcbiIgIgliIDJiXG4iICIucHJldmlvdXNcbiIg
Ii5zZWN0aW9uIF9fZXhfdGFibGUsXCJhXCI7IiAiICIgIi5iYWxpZ24gNDsiICIgIiAiLmxv
bmcgKDFiKSAtIC4gOyIgIiAiICIubG9uZyAoM2IpIC0gLiA7IiAiICIgIi5wcmV2aW91cyIg
IiAiIDogIj1yIiAoX19ndV9lcnIpLCAiPXIiIChfX2d1X3ZhbCkgOiAibTw+IiAoKih1MTYg
KilfX2d1X2FkZHIpLCAiaSIgKC0xNCksICIwIiAoX19ndV9lcnIpKTsgYnJlYWs7IGNhc2Ug
NDogX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgkiImx3eiIiJVUyJVgyICUxLCAlMgkjIGdl
dF91c2VyXG4iICIyOlxuIiAiLnNlY3Rpb24gLmZpeHVwLFwiYXhcIlxuIiAiMzoJbGkgJTAs
JTNcbiIgIglsaSAlMSwwXG4iICIJYiAyYlxuIiAiLnByZXZpb3VzXG4iICIuc2VjdGlvbiBf
X2V4X3RhYmxlLFwiYVwiOyIgIiAiICIuYmFsaWduIDQ7IiAiICIgIi5sb25nICgxYikgLSAu
IDsiICIgIiAiLmxvbmcgKDNiKSAtIC4gOyIgIiAiICIucHJldmlvdXMiICIgIiA6ICI9ciIg
KF9fZ3VfZXJyKSwgIj1yIiAoX19ndV92YWwpIDogIm08PiIgKCoodTMyICopX19ndV9hZGRy
KSwgImkiICgtMTQpLCAiMCIgKF9fZ3VfZXJyKSk7IGJyZWFrOyBjYXNlIDg6IF9fYXNtX18g
X192b2xhdGlsZV9fKCAiMToJIiJsZCIiJVUyJVgyICUxLCAlMgkjIGdldF91c2VyXG4iICIy
OlxuIiAiLnNlY3Rpb24gLmZpeHVwLFwiYXhcIlxuIiAiMzoJbGkgJTAsJTNcbiIgIglsaSAl
MSwwXG4iICIJYiAyYlxuIiAiLnByZXZpb3VzXG4iICIuc2VjdGlvbiBfX2V4X3RhYmxlLFwi
YVwiOyIgIiAiICIuYmFsaWduIDQ7IiAiICIgIi5sb25nICgxYikgLSAuIDsiICIgIiAiLmxv
bmcgKDNiKSAtIC4gOyIgIiAiICIucHJldmlvdXMiICIgIiA6ICI9ciIgKF9fZ3VfZXJyKSwg
Ij1yIiAoX19ndV92YWwpIDogIm08PiIgKCoodTY0ICopX19ndV9hZGRyKSwgImkiICgtMTQp
LCAiMCIgKF9fZ3VfZXJyKSk7IGJyZWFrOyBkZWZhdWx0OiAoX19ndV92YWwpID0gX19nZXRf
dXNlcl9iYWQoKTsgfSB9IHdoaWxlICgwKTsgcHJldmVudF9yZWFkX2Zyb21fdXNlcihfX2d1
X2FkZHIsIF9fZ3Vfc2l6ZSk7IH0gd2hpbGUgKDApOyBlbHNlIGRvIHsgX19ndV9lcnIgPSAw
OyAodm9pZCkwOyBpZiAoX19ndV9zaXplID4gc2l6ZW9mKF9fZ3VfdmFsKSkgKF9fZ3VfdmFs
KSA9IF9fZ2V0X3VzZXJfYmFkKCk7IHN3aXRjaCAoX19ndV9zaXplKSB7IGNhc2UgMTogX19h
c21fXyBfX3ZvbGF0aWxlX18oICIxOgkiImxieiIiJVUyJVgyICUxLCAlMgkjIGdldF91c2Vy
XG4iICIyOlxuIiAiLnNlY3Rpb24gLmZpeHVwLFwiYXhcIlxuIiAiMzoJbGkgJTAsJTNcbiIg
IglsaSAlMSwwXG4iICIJYiAyYlxuIiAiLnByZXZpb3VzXG4iICIuc2VjdGlvbiBfX2V4X3Rh
YmxlLFwiYVwiOyIgIiAiICIuYmFsaWduIDQ7IiAiICIgIi5sb25nICgxYikgLSAuIDsiICIg
IiAiLmxvbmcgKDNiKSAtIC4gOyIgIiAiICIucHJldmlvdXMiICIgIiA6ICI9ciIgKF9fZ3Vf
ZXJyKSwgIj1yIiAoX19ndV92YWwpIDogIm08PiIgKCoodTggKilfX2d1X2FkZHIpLCAiaSIg
KC0xNCksICIwIiAoX19ndV9lcnIpKTsgYnJlYWs7IGNhc2UgMjogX19hc21fXyBfX3ZvbGF0
aWxlX18oICIxOgkiImxoeiIiJVUyJVgyICUxLCAlMgkjIGdldF91c2VyXG4iICIyOlxuIiAi
LnNlY3Rpb24gLmZpeHVwLFwiYXhcIlxuIiAiMzoJbGkgJTAsJTNcbiIgIglsaSAlMSwwXG4i
ICIJYiAyYlxuIiAiLnByZXZpb3VzXG4iICIuc2VjdGlvbiBfX2V4X3RhYmxlLFwiYVwiOyIg
IiAiICIuYmFsaWduIDQ7IiAiICIgIi5sb25nICgxYikgLSAuIDsiICIgIiAiLmxvbmcgKDNi
KSAtIC4gOyIgIiAiICIucHJldmlvdXMiICIgIiA6ICI9ciIgKF9fZ3VfZXJyKSwgIj1yIiAo
X19ndV92YWwpIDogIm08PiIgKCoodTE2ICopX19ndV9hZGRyKSwgImkiICgtMTQpLCAiMCIg
KF9fZ3VfZXJyKSk7IGJyZWFrOyBjYXNlIDQ6IF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJ
IiJsd3oiIiVVMiVYMiAlMSwgJTIJIyBnZXRfdXNlclxuIiAiMjpcbiIgIi5zZWN0aW9uIC5m
aXh1cCxcImF4XCJcbiIgIjM6CWxpICUwLCUzXG4iICIJbGkgJTEsMFxuIiAiCWIgMmJcbiIg
Ii5wcmV2aW91c1xuIiAiLnNlY3Rpb24gX19leF90YWJsZSxcImFcIjsiICIgIiAiLmJhbGln
biA0OyIgIiAiICIubG9uZyAoMWIpIC0gLiA7IiAiICIgIi5sb25nICgzYikgLSAuIDsiICIg
IiAiLnByZXZpb3VzIiAiICIgOiAiPXIiIChfX2d1X2VyciksICI9ciIgKF9fZ3VfdmFsKSA6
ICJtPD4iICgqKHUzMiAqKV9fZ3VfYWRkciksICJpIiAoLTE0KSwgIjAiIChfX2d1X2Vycikp
OyBicmVhazsgY2FzZSA4OiBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CSIibGQiIiVVMiVY
MiAlMSwgJTIJIyBnZXRfdXNlclxuIiAiMjpcbiIgIi5zZWN0aW9uIC5maXh1cCxcImF4XCJc
biIgIjM6CWxpICUwLCUzXG4iICIJbGkgJTEsMFxuIiAiCWIgMmJcbiIgIi5wcmV2aW91c1xu
IiAiLnNlY3Rpb24gX19leF90YWJsZSxcImFcIjsiICIgIiAiLmJhbGlnbiA0OyIgIiAiICIu
bG9uZyAoMWIpIC0gLiA7IiAiICIgIi5sb25nICgzYikgLSAuIDsiICIgIiAiLnByZXZpb3Vz
IiAiICIgOiAiPXIiIChfX2d1X2VyciksICI9ciIgKF9fZ3VfdmFsKSA6ICJtPD4iICgqKHU2
NCAqKV9fZ3VfYWRkciksICJpIiAoLTE0KSwgIjAiIChfX2d1X2VycikpOyBicmVhazsgZGVm
YXVsdDogKF9fZ3VfdmFsKSA9IF9fZ2V0X3VzZXJfYmFkKCk7IH0gfSB3aGlsZSAoMCk7ICgo
YykpID0gKF9fdHlwZW9mX18oKigoZW5kKSkpKV9fZ3VfdmFsOyBfX2d1X2VycjsgfSk7CiB9
CgogKHZvaWQpYzsKIHJldHVybiAwOwp9CgppbnQgYWRkX3RvX3BhZ2VfY2FjaGVfbG9ja2Vk
KHN0cnVjdCBwYWdlICpwYWdlLCBzdHJ1Y3QgYWRkcmVzc19zcGFjZSAqbWFwcGluZywKICAg
IHVuc2lnbmVkIGxvbmcgaW5kZXgsIGdmcF90IGdmcF9tYXNrKTsKaW50IGFkZF90b19wYWdl
X2NhY2hlX2xydShzdHJ1Y3QgcGFnZSAqcGFnZSwgc3RydWN0IGFkZHJlc3Nfc3BhY2UgKm1h
cHBpbmcsCiAgICB1bnNpZ25lZCBsb25nIGluZGV4LCBnZnBfdCBnZnBfbWFzayk7CmV4dGVy
biB2b2lkIGRlbGV0ZV9mcm9tX3BhZ2VfY2FjaGUoc3RydWN0IHBhZ2UgKnBhZ2UpOwpleHRl
cm4gdm9pZCBfX2RlbGV0ZV9mcm9tX3BhZ2VfY2FjaGUoc3RydWN0IHBhZ2UgKnBhZ2UsIHZv
aWQgKnNoYWRvdyk7CmludCByZXBsYWNlX3BhZ2VfY2FjaGVfcGFnZShzdHJ1Y3QgcGFnZSAq
b2xkLCBzdHJ1Y3QgcGFnZSAqbmV3LCBnZnBfdCBnZnBfbWFzayk7CnZvaWQgZGVsZXRlX2Zy
b21fcGFnZV9jYWNoZV9iYXRjaChzdHJ1Y3QgYWRkcmVzc19zcGFjZSAqbWFwcGluZywKICAg
ICAgc3RydWN0IHBhZ2V2ZWMgKnB2ZWMpOwoKCgp2b2lkIHBhZ2VfY2FjaGVfc3luY19yZWFk
YWhlYWQoc3RydWN0IGFkZHJlc3Nfc3BhY2UgKiwgc3RydWN0IGZpbGVfcmFfc3RhdGUgKiwK
ICBzdHJ1Y3QgZmlsZSAqLCB1bnNpZ25lZCBsb25nIGluZGV4LCB1bnNpZ25lZCBsb25nIHJl
cV9jb3VudCk7CnZvaWQgcGFnZV9jYWNoZV9hc3luY19yZWFkYWhlYWQoc3RydWN0IGFkZHJl
c3Nfc3BhY2UgKiwgc3RydWN0IGZpbGVfcmFfc3RhdGUgKiwKICBzdHJ1Y3QgZmlsZSAqLCBz
dHJ1Y3QgcGFnZSAqLCB1bnNpZ25lZCBsb25nIGluZGV4LAogIHVuc2lnbmVkIGxvbmcgcmVx
X2NvdW50KTsKdm9pZCBwYWdlX2NhY2hlX3JlYWRhaGVhZF91bmJvdW5kZWQoc3RydWN0IGFk
ZHJlc3Nfc3BhY2UgKiwgc3RydWN0IGZpbGUgKiwKICB1bnNpZ25lZCBsb25nIGluZGV4LCB1
bnNpZ25lZCBsb25nIG5yX3RvX3JlYWQsCiAgdW5zaWduZWQgbG9uZyBsb29rYWhlYWRfY291
bnQpOwoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgYWRkX3RvX3BhZ2VfY2FjaGUoc3RydWN0IHBhZ2Ug
KnBhZ2UsCiAgc3RydWN0IGFkZHJlc3Nfc3BhY2UgKm1hcHBpbmcsIHVuc2lnbmVkIGxvbmcg
b2Zmc2V0LCBnZnBfdCBnZnBfbWFzaykKewogaW50IGVycm9yOwoKIF9fU2V0UGFnZUxvY2tl
ZChwYWdlKTsKIGVycm9yID0gYWRkX3RvX3BhZ2VfY2FjaGVfbG9ja2VkKHBhZ2UsIG1hcHBp
bmcsIG9mZnNldCwgZ2ZwX21hc2spOwogaWYgKF9fYnVpbHRpbl9leHBlY3QoISEoZXJyb3Ip
LCAwKSkKICBfX0NsZWFyUGFnZUxvY2tlZChwYWdlKTsKIHJldHVybiBlcnJvcjsKfQojIDcw
MCAiLi9pbmNsdWRlL2xpbnV4L3BhZ2VtYXAuaCIKc3RydWN0IHJlYWRhaGVhZF9jb250cm9s
IHsKIHN0cnVjdCBmaWxlICpmaWxlOwogc3RydWN0IGFkZHJlc3Nfc3BhY2UgKm1hcHBpbmc7
CgogdW5zaWduZWQgbG9uZyBfaW5kZXg7CiB1bnNpZ25lZCBpbnQgX25yX3BhZ2VzOwogdW5z
aWduZWQgaW50IF9iYXRjaF9jb3VudDsKfTsKIyA3MTggIi4vaW5jbHVkZS9saW51eC9wYWdl
bWFwLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3QgcGFnZSAqcmVhZGFoZWFkX3BhZ2Uoc3RydWN0IHJl
YWRhaGVhZF9jb250cm9sICpyYWMpCnsKIHN0cnVjdCBwYWdlICpwYWdlOwoKIGRvIHsgaWYg
KF9fYnVpbHRpbl9jb25zdGFudF9wKHJhYy0+X2JhdGNoX2NvdW50ID4gcmFjLT5fbnJfcGFn
ZXMpKSB7IGlmIChyYWMtPl9iYXRjaF9jb3VudCA+IHJhYy0+X25yX3BhZ2VzKSBkbyB7IF9f
YXNtX18gX192b2xhdGlsZV9fKCAiMToJIiAidHdpIDMxLCAwLCAwIiAiXG4iICIuc2VjdGlv
biBfX2J1Z190YWJsZSxcImF3XCJcbiIgIjI6XHQiICIuOGJ5dGUiICIgIiAiMWIsICUwXG4i
ICJcdC5zaG9ydCAlMSwgJTJcbiIgIi5vcmcgMmIrJTNcbiIgIi5wcmV2aW91c1xuIiA6IDog
ImkiICgiLi9pbmNsdWRlL2xpbnV4L3BhZ2VtYXAuaCIpLCAiaSIgKDcyMiksICJpIiAoMCks
ICJpIiAoc2l6ZW9mKHN0cnVjdCBidWdfZW50cnkpKSk7IGRvIHsgOyBhc20gdm9sYXRpbGUo
IiIpOyBfX2J1aWx0aW5fdW5yZWFjaGFibGUoKTsgfSB3aGlsZSAoMCk7IH0gd2hpbGUgKDAp
OyB9IGVsc2UgeyBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CSIgInRkbmVpIiAiICIgIiAl
NCwgMCIgIlxuIiAiLnNlY3Rpb24gX19idWdfdGFibGUsXCJhd1wiXG4iICIyOlx0IiAiLjhi
eXRlIiAiICIgIjFiLCAlMFxuIiAiXHQuc2hvcnQgJTEsICUyXG4iICIub3JnIDJiKyUzXG4i
ICIucHJldmlvdXNcbiIgOiA6ICJpIiAoIi4vaW5jbHVkZS9saW51eC9wYWdlbWFwLmgiKSwg
ImkiICg3MjIpLCAiaSIgKDApLCAiaSIgKHNpemVvZihzdHJ1Y3QgYnVnX2VudHJ5KSksICJy
IiAoKCBsb25nKShyYWMtPl9iYXRjaF9jb3VudCA+IHJhYy0+X25yX3BhZ2VzKSkpOyB9IH0g
d2hpbGUgKDApOwogcmFjLT5fbnJfcGFnZXMgLT0gcmFjLT5fYmF0Y2hfY291bnQ7CiByYWMt
Pl9pbmRleCArPSByYWMtPl9iYXRjaF9jb3VudDsKCiBpZiAoIXJhYy0+X25yX3BhZ2VzKSB7
CiAgcmFjLT5fYmF0Y2hfY291bnQgPSAwOwogIHJldHVybiAoKHZvaWQgKikwKTsKIH0KCiBw
YWdlID0geGFfbG9hZCgmcmFjLT5tYXBwaW5nLT5pX3BhZ2VzLCByYWMtPl9pbmRleCk7CiAo
KHZvaWQpKHNpemVvZigoIGxvbmcpKCFQYWdlTG9ja2VkKHBhZ2UpKSkpKTsKIHJhYy0+X2Jh
dGNoX2NvdW50ID0gaHBhZ2VfbnJfcGFnZXMocGFnZSk7CgogcmV0dXJuIHBhZ2U7Cn0KCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSB1bnNpZ25lZCBpbnQgX19yZWFkYWhlYWRfYmF0Y2goc3RydWN0IHJlYWRhaGVh
ZF9jb250cm9sICpyYWMsCiAgc3RydWN0IHBhZ2UgKiphcnJheSwgdW5zaWduZWQgaW50IGFy
cmF5X3N6KQp7CiB1bnNpZ25lZCBpbnQgaSA9IDA7CiBzdHJ1Y3QgeGFfc3RhdGUgeGFzID0g
eyAueGEgPSAmcmFjLT5tYXBwaW5nLT5pX3BhZ2VzLCAueGFfaW5kZXggPSAwLCAueGFfc2hp
ZnQgPSAwLCAueGFfc2licyA9IDAsIC54YV9vZmZzZXQgPSAwLCAueGFfcGFkID0gMCwgLnhh
X25vZGUgPSAoKHN0cnVjdCB4YV9ub2RlICopM1VMKSwgLnhhX2FsbG9jID0gKCh2b2lkICop
MCksIC54YV91cGRhdGUgPSAoKHZvaWQgKikwKSB9Owogc3RydWN0IHBhZ2UgKnBhZ2U7Cgog
ZG8geyBpZiAoX19idWlsdGluX2NvbnN0YW50X3AocmFjLT5fYmF0Y2hfY291bnQgPiByYWMt
Pl9ucl9wYWdlcykpIHsgaWYgKHJhYy0+X2JhdGNoX2NvdW50ID4gcmFjLT5fbnJfcGFnZXMp
IGRvIHsgX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgkiICJ0d2kgMzEsIDAsIDAiICJcbiIg
Ii5zZWN0aW9uIF9fYnVnX3RhYmxlLFwiYXdcIlxuIiAiMjpcdCIgIi44Ynl0ZSIgIiAiICIx
YiwgJTBcbiIgIlx0LnNob3J0ICUxLCAlMlxuIiAiLm9yZyAyYislM1xuIiAiLnByZXZpb3Vz
XG4iIDogOiAiaSIgKCIuL2luY2x1ZGUvbGludXgvcGFnZW1hcC5oIiksICJpIiAoNzQ1KSwg
ImkiICgwKSwgImkiIChzaXplb2Yoc3RydWN0IGJ1Z19lbnRyeSkpKTsgZG8geyA7IGFzbSB2
b2xhdGlsZSgiIik7IF9fYnVpbHRpbl91bnJlYWNoYWJsZSgpOyB9IHdoaWxlICgwKTsgfSB3
aGlsZSAoMCk7IH0gZWxzZSB7IF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJIiAidGRuZWki
ICIgIiAiICU0LCAwIiAiXG4iICIuc2VjdGlvbiBfX2J1Z190YWJsZSxcImF3XCJcbiIgIjI6
XHQiICIuOGJ5dGUiICIgIiAiMWIsICUwXG4iICJcdC5zaG9ydCAlMSwgJTJcbiIgIi5vcmcg
MmIrJTNcbiIgIi5wcmV2aW91c1xuIiA6IDogImkiICgiLi9pbmNsdWRlL2xpbnV4L3BhZ2Vt
YXAuaCIpLCAiaSIgKDc0NSksICJpIiAoMCksICJpIiAoc2l6ZW9mKHN0cnVjdCBidWdfZW50
cnkpKSwgInIiICgoIGxvbmcpKHJhYy0+X2JhdGNoX2NvdW50ID4gcmFjLT5fbnJfcGFnZXMp
KSk7IH0gfSB3aGlsZSAoMCk7CiByYWMtPl9ucl9wYWdlcyAtPSByYWMtPl9iYXRjaF9jb3Vu
dDsKIHJhYy0+X2luZGV4ICs9IHJhYy0+X2JhdGNoX2NvdW50OwogcmFjLT5fYmF0Y2hfY291
bnQgPSAwOwoKIHhhc19zZXQoJnhhcywgcmFjLT5faW5kZXgpOwogcmN1X3JlYWRfbG9jaygp
OwogZm9yIChwYWdlID0geGFzX2ZpbmQoJnhhcywgcmFjLT5faW5kZXggKyByYWMtPl9ucl9w
YWdlcyAtIDEpOyBwYWdlOyBwYWdlID0geGFzX25leHRfZW50cnkoJnhhcywgcmFjLT5faW5k
ZXggKyByYWMtPl9ucl9wYWdlcyAtIDEpKSB7CiAgKCh2b2lkKShzaXplb2YoKCBsb25nKSgh
UGFnZUxvY2tlZChwYWdlKSkpKSk7CiAgKCh2b2lkKShzaXplb2YoKCBsb25nKShQYWdlVGFp
bChwYWdlKSkpKSk7CiAgYXJyYXlbaSsrXSA9IHBhZ2U7CiAgcmFjLT5fYmF0Y2hfY291bnQg
Kz0gaHBhZ2VfbnJfcGFnZXMocGFnZSk7CgoKCgoKCgogIGlmIChQYWdlSGVhZChwYWdlKSkK
ICAgeGFzX3NldCgmeGFzLCByYWMtPl9pbmRleCArIHJhYy0+X2JhdGNoX2NvdW50KTsKCiAg
aWYgKGkgPT0gYXJyYXlfc3opCiAgIGJyZWFrOwogfQogcmN1X3JlYWRfdW5sb2NrKCk7Cgog
cmV0dXJuIGk7Cn0KIyA3OTMgIi4vaW5jbHVkZS9saW51eC9wYWdlbWFwLmgiCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBsb2ZmX3QgcmVhZGFoZWFkX3BvcyhzdHJ1Y3QgcmVhZGFoZWFkX2NvbnRyb2wgKnJhYykK
ewogcmV0dXJuIChsb2ZmX3QpcmFjLT5faW5kZXggKiAoMVVMIDw8IDEyKTsKfQoKCgoKCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSBsb2ZmX3QgcmVhZGFoZWFkX2xlbmd0aChzdHJ1Y3QgcmVhZGFoZWFkX2NvbnRy
b2wgKnJhYykKewogcmV0dXJuIChsb2ZmX3QpcmFjLT5fbnJfcGFnZXMgKiAoMVVMIDw8IDEy
KTsKfQoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSB1bnNpZ25lZCBsb25nIHJlYWRhaGVhZF9pbmRleChzdHJ1
Y3QgcmVhZGFoZWFkX2NvbnRyb2wgKnJhYykKewogcmV0dXJuIHJhYy0+X2luZGV4Owp9CgoK
CgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIHVuc2lnbmVkIGludCByZWFkYWhlYWRfY291bnQoc3RydWN0IHJlYWRh
aGVhZF9jb250cm9sICpyYWMpCnsKIHJldHVybiByYWMtPl9ucl9wYWdlczsKfQoKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIHVuc2lnbmVkIGxvbmcgZGlyX3BhZ2VzKHN0cnVjdCBpbm9kZSAqaW5vZGUpCnsKIHJl
dHVybiAodW5zaWduZWQgbG9uZykoaW5vZGUtPmlfc2l6ZSArICgxVUwgPDwgMTIpIC0gMSkg
Pj4KICAgICAgICAgIDEyOwp9CiMgODM5ICIuL2luY2x1ZGUvbGludXgvcGFnZW1hcC5oIgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgaW50IHBhZ2VfbWt3cml0ZV9jaGVja190cnVuY2F0ZShzdHJ1Y3QgcGFnZSAq
cGFnZSwKICAgICAgICAgICBzdHJ1Y3QgaW5vZGUgKmlub2RlKQp7CiBsb2ZmX3Qgc2l6ZSA9
IGlfc2l6ZV9yZWFkKGlub2RlKTsKIHVuc2lnbmVkIGxvbmcgaW5kZXggPSBzaXplID4+IDEy
OwogaW50IG9mZnNldCA9ICgodW5zaWduZWQgbG9uZykoc2l6ZSkgJiB+KH4oKDEgPDwgMTIp
IC0gMSkpKTsKCiBpZiAocGFnZS0+bWFwcGluZyAhPSBpbm9kZS0+aV9tYXBwaW5nKQogIHJl
dHVybiAtMTQ7CgoKIGlmIChwYWdlLT5pbmRleCA8IGluZGV4KQogIHJldHVybiAoMVVMIDw8
IDEyKTsKCiBpZiAocGFnZS0+aW5kZXggPiBpbmRleCB8fCAhb2Zmc2V0KQogIHJldHVybiAt
MTQ7CgogcmV0dXJuIG9mZnNldDsKfQojIDI1ICJhcmNoL3Bvd2VycGMva2VybmVsL3NpZ25h
bF8zMi5jIiAyCgojIDEgIi4vaW5jbHVkZS9saW51eC9zeXNjYWxscy5oIiAxCiMgMTIgIi4v
aW5jbHVkZS9saW51eC9zeXNjYWxscy5oIgpzdHJ1Y3QgX19haW9fc2lnc2V0OwpzdHJ1Y3Qg
ZXBvbGxfZXZlbnQ7CnN0cnVjdCBpYXR0cjsKc3RydWN0IGlub2RlOwpzdHJ1Y3QgaW9jYjsK
c3RydWN0IGlvX2V2ZW50OwpzdHJ1Y3QgaW92ZWM7CnN0cnVjdCBfX2tlcm5lbF9vbGRfaXRp
bWVydmFsOwpzdHJ1Y3Qga2V4ZWNfc2VnbWVudDsKc3RydWN0IGxpbnV4X2RpcmVudDsKc3Ry
dWN0IGxpbnV4X2RpcmVudDY0OwpzdHJ1Y3QgbGlzdF9oZWFkOwpzdHJ1Y3QgbW1hcF9hcmdf
c3RydWN0OwpzdHJ1Y3QgbXNnYnVmOwpzdHJ1Y3QgdXNlcl9tc2doZHI7CnN0cnVjdCBtbXNn
aGRyOwpzdHJ1Y3QgbXNxaWRfZHM7CnN0cnVjdCBuZXdfdXRzbmFtZTsKc3RydWN0IG5mc2N0
bF9hcmc7CnN0cnVjdCBfX29sZF9rZXJuZWxfc3RhdDsKc3RydWN0IG9sZG9sZF91dHNuYW1l
OwpzdHJ1Y3Qgb2xkX3V0c25hbWU7CnN0cnVjdCBwb2xsZmQ7CnN0cnVjdCBybGltaXQ7CnN0
cnVjdCBybGltaXQ2NDsKc3RydWN0IHJ1c2FnZTsKc3RydWN0IHNjaGVkX3BhcmFtOwpzdHJ1
Y3Qgc2NoZWRfYXR0cjsKc3RydWN0IHNlbF9hcmdfc3RydWN0OwpzdHJ1Y3Qgc2VtYXBob3Jl
OwpzdHJ1Y3Qgc2VtYnVmOwpzdHJ1Y3Qgc2htaWRfZHM7CnN0cnVjdCBzb2NrYWRkcjsKc3Ry
dWN0IHN0YXQ7CnN0cnVjdCBzdGF0NjQ7CnN0cnVjdCBzdGF0ZnM7CnN0cnVjdCBzdGF0ZnM2
NDsKc3RydWN0IHN0YXR4OwpzdHJ1Y3QgX19zeXNjdGxfYXJnczsKc3RydWN0IHN5c2luZm87
CnN0cnVjdCB0aW1lc3BlYzsKc3RydWN0IF9fa2VybmVsX29sZF90aW1ldmFsOwpzdHJ1Y3Qg
X19rZXJuZWxfdGltZXg7CnN0cnVjdCB0aW1lem9uZTsKc3RydWN0IHRtczsKc3RydWN0IHV0
aW1idWY7CnN0cnVjdCBtcV9hdHRyOwpzdHJ1Y3QgY29tcGF0X3N0YXQ7CnN0cnVjdCBvbGRf
dGltZXZhbDMyOwpzdHJ1Y3Qgcm9idXN0X2xpc3RfaGVhZDsKc3RydWN0IGdldGNwdV9jYWNo
ZTsKc3RydWN0IG9sZF9saW51eF9kaXJlbnQ7CnN0cnVjdCBwZXJmX2V2ZW50X2F0dHI7CnN0
cnVjdCBmaWxlX2hhbmRsZTsKc3RydWN0IHNpZ2FsdHN0YWNrOwpzdHJ1Y3QgcnNlcTsKdW5p
b24gYnBmX2F0dHI7CnN0cnVjdCBpb191cmluZ19wYXJhbXM7CnN0cnVjdCBjbG9uZV9hcmdz
OwpzdHJ1Y3Qgb3Blbl9ob3c7CgoKIyAxICIuL2luY2x1ZGUvdWFwaS9saW51eC9haW9fYWJp
LmgiIDEKIyAzNCAiLi9pbmNsdWRlL3VhcGkvbGludXgvYWlvX2FiaS5oIgp0eXBlZGVmIF9f
a2VybmVsX3Vsb25nX3QgYWlvX2NvbnRleHRfdDsKCmVudW0gewogSU9DQl9DTURfUFJFQUQg
PSAwLAogSU9DQl9DTURfUFdSSVRFID0gMSwKIElPQ0JfQ01EX0ZTWU5DID0gMiwKIElPQ0Jf
Q01EX0ZEU1lOQyA9IDMsCgogSU9DQl9DTURfUE9MTCA9IDUsCiBJT0NCX0NNRF9OT09QID0g
NiwKIElPQ0JfQ01EX1BSRUFEViA9IDcsCiBJT0NCX0NNRF9QV1JJVEVWID0gOCwKfTsKIyA2
MCAiLi9pbmNsdWRlL3VhcGkvbGludXgvYWlvX2FiaS5oIgpzdHJ1Y3QgaW9fZXZlbnQgewog
X191NjQgZGF0YTsKIF9fdTY0IG9iajsKIF9fczY0IHJlczsKIF9fczY0IHJlczI7Cn07CgoK
CgoKCgpzdHJ1Y3QgaW9jYiB7CgogX191NjQgYWlvX2RhdGE7CgoKCgoKIF9fa2VybmVsX3J3
Zl90IGFpb19yd19mbGFnczsKIF9fdTMyIGFpb19rZXk7CgoKCgoKIF9fdTE2IGFpb19saW9f
b3Bjb2RlOwogX19zMTYgYWlvX3JlcXByaW87CiBfX3UzMiBhaW9fZmlsZGVzOwoKIF9fdTY0
IGFpb19idWY7CiBfX3U2NCBhaW9fbmJ5dGVzOwogX19zNjQgYWlvX29mZnNldDsKCgogX191
NjQgYWlvX3Jlc2VydmVkMjsKCgogX191MzIgYWlvX2ZsYWdzOwoKCgoKCiBfX3UzMiBhaW9f
cmVzZmQ7Cn07CiMgNzUgIi4vaW5jbHVkZS9saW51eC9zeXNjYWxscy5oIiAyCgoKCgoKIyAx
ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2dlbmVyYXRlZC91YXBpL2FzbS9zaWdpbmZvLmgi
IDEKIyA4MSAiLi9pbmNsdWRlL2xpbnV4L3N5c2NhbGxzLmgiIDIKCgoKIyAxICIuL2luY2x1
ZGUvbGludXgvcGVyc29uYWxpdHkuaCIgMQoKCgoKIyAxICIuL2luY2x1ZGUvdWFwaS9saW51
eC9wZXJzb25hbGl0eS5oIiAxCiMgMTEgIi4vaW5jbHVkZS91YXBpL2xpbnV4L3BlcnNvbmFs
aXR5LmgiCmVudW0gewogVU5BTUUyNiA9IDB4MDAyMDAwMCwKIEFERFJfTk9fUkFORE9NSVpF
ID0gMHgwMDQwMDAwLAogRkRQSUNfRlVOQ1BUUlMgPSAweDAwODAwMDAsCgoKIE1NQVBfUEFH
RV9aRVJPID0gMHgwMTAwMDAwLAogQUREUl9DT01QQVRfTEFZT1VUID0gMHgwMjAwMDAwLAog
UkVBRF9JTVBMSUVTX0VYRUMgPSAweDA0MDAwMDAsCiBBRERSX0xJTUlUXzMyQklUID0gMHgw
ODAwMDAwLAogU0hPUlRfSU5PREUgPSAweDEwMDAwMDAsCiBXSE9MRV9TRUNPTkRTID0gMHgy
MDAwMDAwLAogU1RJQ0tZX1RJTUVPVVRTID0gMHg0MDAwMDAwLAogQUREUl9MSU1JVF8zR0Ig
PSAweDgwMDAwMDAsCn07CiMgNDIgIi4vaW5jbHVkZS91YXBpL2xpbnV4L3BlcnNvbmFsaXR5
LmgiCmVudW0gewogUEVSX0xJTlVYID0gMHgwMDAwLAogUEVSX0xJTlVYXzMyQklUID0gMHgw
MDAwIHwgQUREUl9MSU1JVF8zMkJJVCwKIFBFUl9MSU5VWF9GRFBJQyA9IDB4MDAwMCB8IEZE
UElDX0ZVTkNQVFJTLAogUEVSX1NWUjQgPSAweDAwMDEgfCBTVElDS1lfVElNRU9VVFMgfCBN
TUFQX1BBR0VfWkVSTywKIFBFUl9TVlIzID0gMHgwMDAyIHwgU1RJQ0tZX1RJTUVPVVRTIHwg
U0hPUlRfSU5PREUsCiBQRVJfU0NPU1ZSMyA9IDB4MDAwMyB8IFNUSUNLWV9USU1FT1VUUyB8
CiAgICAgIFdIT0xFX1NFQ09ORFMgfCBTSE9SVF9JTk9ERSwKIFBFUl9PU1I1ID0gMHgwMDAz
IHwgU1RJQ0tZX1RJTUVPVVRTIHwgV0hPTEVfU0VDT05EUywKIFBFUl9XWVNFVjM4NiA9IDB4
MDAwNCB8IFNUSUNLWV9USU1FT1VUUyB8IFNIT1JUX0lOT0RFLAogUEVSX0lTQ1I0ID0gMHgw
MDA1IHwgU1RJQ0tZX1RJTUVPVVRTLAogUEVSX0JTRCA9IDB4MDAwNiwKIFBFUl9TVU5PUyA9
IDB4MDAwNiB8IFNUSUNLWV9USU1FT1VUUywKIFBFUl9YRU5JWCA9IDB4MDAwNyB8IFNUSUNL
WV9USU1FT1VUUyB8IFNIT1JUX0lOT0RFLAogUEVSX0xJTlVYMzIgPSAweDAwMDgsCiBQRVJf
TElOVVgzMl8zR0IgPSAweDAwMDggfCBBRERSX0xJTUlUXzNHQiwKIFBFUl9JUklYMzIgPSAw
eDAwMDkgfCBTVElDS1lfVElNRU9VVFMsCiBQRVJfSVJJWE4zMiA9IDB4MDAwYSB8IFNUSUNL
WV9USU1FT1VUUywKIFBFUl9JUklYNjQgPSAweDAwMGIgfCBTVElDS1lfVElNRU9VVFMsCiBQ
RVJfUklTQ09TID0gMHgwMDBjLAogUEVSX1NPTEFSSVMgPSAweDAwMGQgfCBTVElDS1lfVElN
RU9VVFMsCiBQRVJfVVc3ID0gMHgwMDBlIHwgU1RJQ0tZX1RJTUVPVVRTIHwgTU1BUF9QQUdF
X1pFUk8sCiBQRVJfT1NGNCA9IDB4MDAwZiwKIFBFUl9IUFVYID0gMHgwMDEwLAogUEVSX01B
U0sgPSAweDAwZmYsCn07CiMgNiAiLi9pbmNsdWRlL2xpbnV4L3BlcnNvbmFsaXR5LmgiIDIK
IyA4NSAiLi9pbmNsdWRlL2xpbnV4L3N5c2NhbGxzLmgiIDIKIyAxICIuL2luY2x1ZGUvdHJh
Y2Uvc3lzY2FsbC5oIiAxCgoKCgojIDEgIi4vaW5jbHVkZS9saW51eC90cmFjZXBvaW50Lmgi
IDEKIyAyMyAiLi9pbmNsdWRlL2xpbnV4L3RyYWNlcG9pbnQuaCIKc3RydWN0IG1vZHVsZTsK
c3RydWN0IHRyYWNlcG9pbnQ7CnN0cnVjdCBub3RpZmllcl9ibG9jazsKCnN0cnVjdCB0cmFj
ZV9ldmFsX21hcCB7CiBjb25zdCBjaGFyICpzeXN0ZW07CiBjb25zdCBjaGFyICpldmFsX3N0
cmluZzsKIHVuc2lnbmVkIGxvbmcgZXZhbF92YWx1ZTsKfTsKCgoKZXh0ZXJuIHN0cnVjdCBz
cmN1X3N0cnVjdCB0cmFjZXBvaW50X3NyY3U7CgpleHRlcm4gaW50CnRyYWNlcG9pbnRfcHJv
YmVfcmVnaXN0ZXIoc3RydWN0IHRyYWNlcG9pbnQgKnRwLCB2b2lkICpwcm9iZSwgdm9pZCAq
ZGF0YSk7CmV4dGVybiBpbnQKdHJhY2Vwb2ludF9wcm9iZV9yZWdpc3Rlcl9wcmlvKHN0cnVj
dCB0cmFjZXBvaW50ICp0cCwgdm9pZCAqcHJvYmUsIHZvaWQgKmRhdGEsCiAgICAgICAgICBp
bnQgcHJpbyk7CmV4dGVybiBpbnQKdHJhY2Vwb2ludF9wcm9iZV91bnJlZ2lzdGVyKHN0cnVj
dCB0cmFjZXBvaW50ICp0cCwgdm9pZCAqcHJvYmUsIHZvaWQgKmRhdGEpOwpleHRlcm4gdm9p
ZApmb3JfZWFjaF9rZXJuZWxfdHJhY2Vwb2ludCh2b2lkICgqZmN0KShzdHJ1Y3QgdHJhY2Vw
b2ludCAqdHAsIHZvaWQgKnByaXYpLAogIHZvaWQgKnByaXYpOwoKCnN0cnVjdCB0cF9tb2R1
bGUgewogc3RydWN0IGxpc3RfaGVhZCBsaXN0Owogc3RydWN0IG1vZHVsZSAqbW9kOwp9OwoK
Ym9vbCB0cmFjZV9tb2R1bGVfaGFzX2JhZF90YWludChzdHJ1Y3QgbW9kdWxlICptb2QpOwpl
eHRlcm4gaW50IHJlZ2lzdGVyX3RyYWNlcG9pbnRfbW9kdWxlX25vdGlmaWVyKHN0cnVjdCBu
b3RpZmllcl9ibG9jayAqbmIpOwpleHRlcm4gaW50IHVucmVnaXN0ZXJfdHJhY2Vwb2ludF9t
b2R1bGVfbm90aWZpZXIoc3RydWN0IG5vdGlmaWVyX2Jsb2NrICpuYik7CiMgODAgIi4vaW5j
bHVkZS9saW51eC90cmFjZXBvaW50LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHRyYWNlcG9pbnRfc3lu
Y2hyb25pemVfdW5yZWdpc3Rlcih2b2lkKQp7CiBzeW5jaHJvbml6ZV9zcmN1KCZ0cmFjZXBv
aW50X3NyY3UpOwogc3luY2hyb25pemVfcmN1KCk7Cn0KCgoKCgoKZXh0ZXJuIGludCBzeXNj
YWxsX3JlZ2Z1bmModm9pZCk7CmV4dGVybiB2b2lkIHN5c2NhbGxfdW5yZWdmdW5jKHZvaWQp
OwojIDExMiAiLi9pbmNsdWRlL2xpbnV4L3RyYWNlcG9pbnQuaCIKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHN0cnVj
dCB0cmFjZXBvaW50ICp0cmFjZXBvaW50X3B0cl9kZXJlZih0cmFjZXBvaW50X3B0cl90ICpw
KQp7CiByZXR1cm4gKnA7Cn0KIyA2ICIuL2luY2x1ZGUvdHJhY2Uvc3lzY2FsbC5oIiAyCgoj
IDEgIi4vaW5jbHVkZS9saW51eC90cmFjZV9ldmVudHMuaCIgMQoKCgoKCiMgMSAiLi9pbmNs
dWRlL2xpbnV4L3JpbmdfYnVmZmVyLmgiIDEKCgoKCgojIDEgIi4vaW5jbHVkZS9saW51eC9z
ZXFfZmlsZS5oIiAxCiMgMTQgIi4vaW5jbHVkZS9saW51eC9zZXFfZmlsZS5oIgpzdHJ1Y3Qg
c2VxX29wZXJhdGlvbnM7CgpzdHJ1Y3Qgc2VxX2ZpbGUgewogY2hhciAqYnVmOwogc2l6ZV90
IHNpemU7CiBzaXplX3QgZnJvbTsKIHNpemVfdCBjb3VudDsKIHNpemVfdCBwYWRfdW50aWw7
CiBsb2ZmX3QgaW5kZXg7CiBsb2ZmX3QgcmVhZF9wb3M7CiBzdHJ1Y3QgbXV0ZXggbG9jazsK
IGNvbnN0IHN0cnVjdCBzZXFfb3BlcmF0aW9ucyAqb3A7CiBpbnQgcG9sbF9ldmVudDsKIGNv
bnN0IHN0cnVjdCBmaWxlICpmaWxlOwogdm9pZCAqcHJpdmF0ZTsKfTsKCnN0cnVjdCBzZXFf
b3BlcmF0aW9ucyB7CiB2b2lkICogKCpzdGFydCkgKHN0cnVjdCBzZXFfZmlsZSAqbSwgbG9m
Zl90ICpwb3MpOwogdm9pZCAoKnN0b3ApIChzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnYp
Owogdm9pZCAqICgqbmV4dCkgKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdiwgbG9mZl90
ICpwb3MpOwogaW50ICgqc2hvdykgKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdik7Cn07
CiMgNTAgIi4vaW5jbHVkZS9saW51eC9zZXFfZmlsZS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBzZXFf
aGFzX292ZXJmbG93ZWQoc3RydWN0IHNlcV9maWxlICptKQp7CiByZXR1cm4gbS0+Y291bnQg
PT0gbS0+c2l6ZTsKfQojIDYzICIuL2luY2x1ZGUvbGludXgvc2VxX2ZpbGUuaCIKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIHNpemVfdCBzZXFfZ2V0X2J1ZihzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIGNoYXIgKipidWZw
KQp7CiBkbyB7IGlmIChfX2J1aWx0aW5fY29uc3RhbnRfcChtLT5jb3VudCA+IG0tPnNpemUp
KSB7IGlmIChtLT5jb3VudCA+IG0tPnNpemUpIGRvIHsgX19hc21fXyBfX3ZvbGF0aWxlX18o
ICIxOgkiICJ0d2kgMzEsIDAsIDAiICJcbiIgIi5zZWN0aW9uIF9fYnVnX3RhYmxlLFwiYXdc
IlxuIiAiMjpcdCIgIi44Ynl0ZSIgIiAiICIxYiwgJTBcbiIgIlx0LnNob3J0ICUxLCAlMlxu
IiAiLm9yZyAyYislM1xuIiAiLnByZXZpb3VzXG4iIDogOiAiaSIgKCIuL2luY2x1ZGUvbGlu
dXgvc2VxX2ZpbGUuaCIpLCAiaSIgKDY1KSwgImkiICgwKSwgImkiIChzaXplb2Yoc3RydWN0
IGJ1Z19lbnRyeSkpKTsgZG8geyA7IGFzbSB2b2xhdGlsZSgiIik7IF9fYnVpbHRpbl91bnJl
YWNoYWJsZSgpOyB9IHdoaWxlICgwKTsgfSB3aGlsZSAoMCk7IH0gZWxzZSB7IF9fYXNtX18g
X192b2xhdGlsZV9fKCAiMToJIiAidGRuZWkiICIgIiAiICU0LCAwIiAiXG4iICIuc2VjdGlv
biBfX2J1Z190YWJsZSxcImF3XCJcbiIgIjI6XHQiICIuOGJ5dGUiICIgIiAiMWIsICUwXG4i
ICJcdC5zaG9ydCAlMSwgJTJcbiIgIi5vcmcgMmIrJTNcbiIgIi5wcmV2aW91c1xuIiA6IDog
ImkiICgiLi9pbmNsdWRlL2xpbnV4L3NlcV9maWxlLmgiKSwgImkiICg2NSksICJpIiAoMCks
ICJpIiAoc2l6ZW9mKHN0cnVjdCBidWdfZW50cnkpKSwgInIiICgoIGxvbmcpKG0tPmNvdW50
ID4gbS0+c2l6ZSkpKTsgfSB9IHdoaWxlICgwKTsKIGlmIChtLT5jb3VudCA8IG0tPnNpemUp
CiAgKmJ1ZnAgPSBtLT5idWYgKyBtLT5jb3VudDsKIGVsc2UKICAqYnVmcCA9ICgodm9pZCAq
KTApOwoKIHJldHVybiBtLT5zaXplIC0gbS0+Y291bnQ7Cn0KIyA4MyAiLi9pbmNsdWRlL2xp
bnV4L3NlcV9maWxlLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHNlcV9jb21taXQoc3RydWN0IHNlcV9m
aWxlICptLCBpbnQgbnVtKQp7CiBpZiAobnVtIDwgMCkgewogIG0tPmNvdW50ID0gbS0+c2l6
ZTsKIH0gZWxzZSB7CiAgZG8geyBpZiAoX19idWlsdGluX2NvbnN0YW50X3AobS0+Y291bnQg
KyBudW0gPiBtLT5zaXplKSkgeyBpZiAobS0+Y291bnQgKyBudW0gPiBtLT5zaXplKSBkbyB7
IF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJIiAidHdpIDMxLCAwLCAwIiAiXG4iICIuc2Vj
dGlvbiBfX2J1Z190YWJsZSxcImF3XCJcbiIgIjI6XHQiICIuOGJ5dGUiICIgIiAiMWIsICUw
XG4iICJcdC5zaG9ydCAlMSwgJTJcbiIgIi5vcmcgMmIrJTNcbiIgIi5wcmV2aW91c1xuIiA6
IDogImkiICgiLi9pbmNsdWRlL2xpbnV4L3NlcV9maWxlLmgiKSwgImkiICg4OCksICJpIiAo
MCksICJpIiAoc2l6ZW9mKHN0cnVjdCBidWdfZW50cnkpKSk7IGRvIHsgOyBhc20gdm9sYXRp
bGUoIiIpOyBfX2J1aWx0aW5fdW5yZWFjaGFibGUoKTsgfSB3aGlsZSAoMCk7IH0gd2hpbGUg
KDApOyB9IGVsc2UgeyBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CSIgInRkbmVpIiAiICIg
IiAlNCwgMCIgIlxuIiAiLnNlY3Rpb24gX19idWdfdGFibGUsXCJhd1wiXG4iICIyOlx0IiAi
LjhieXRlIiAiICIgIjFiLCAlMFxuIiAiXHQuc2hvcnQgJTEsICUyXG4iICIub3JnIDJiKyUz
XG4iICIucHJldmlvdXNcbiIgOiA6ICJpIiAoIi4vaW5jbHVkZS9saW51eC9zZXFfZmlsZS5o
IiksICJpIiAoODgpLCAiaSIgKDApLCAiaSIgKHNpemVvZihzdHJ1Y3QgYnVnX2VudHJ5KSks
ICJyIiAoKCBsb25nKShtLT5jb3VudCArIG51bSA+IG0tPnNpemUpKSk7IH0gfSB3aGlsZSAo
MCk7CiAgbS0+Y291bnQgKz0gbnVtOwogfQp9CiMgMTAxICIuL2luY2x1ZGUvbGludXgvc2Vx
X2ZpbGUuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgc2VxX3NldHdpZHRoKHN0cnVjdCBzZXFfZmlsZSAq
bSwgc2l6ZV90IHNpemUpCnsKIG0tPnBhZF91bnRpbCA9IG0tPmNvdW50ICsgc2l6ZTsKfQp2
b2lkIHNlcV9wYWQoc3RydWN0IHNlcV9maWxlICptLCBjaGFyIGMpOwoKY2hhciAqbWFuZ2xl
X3BhdGgoY2hhciAqcywgY29uc3QgY2hhciAqcCwgY29uc3QgY2hhciAqZXNjKTsKaW50IHNl
cV9vcGVuKHN0cnVjdCBmaWxlICosIGNvbnN0IHN0cnVjdCBzZXFfb3BlcmF0aW9ucyAqKTsK
c3NpemVfdCBzZXFfcmVhZChzdHJ1Y3QgZmlsZSAqLCBjaGFyICosIHNpemVfdCwgbG9mZl90
ICopOwpsb2ZmX3Qgc2VxX2xzZWVrKHN0cnVjdCBmaWxlICosIGxvZmZfdCwgaW50KTsKaW50
IHNlcV9yZWxlYXNlKHN0cnVjdCBpbm9kZSAqLCBzdHJ1Y3QgZmlsZSAqKTsKaW50IHNlcV93
cml0ZShzdHJ1Y3Qgc2VxX2ZpbGUgKnNlcSwgY29uc3Qgdm9pZCAqZGF0YSwgc2l6ZV90IGxl
bik7CgpfX2F0dHJpYnV0ZV9fKChfX2Zvcm1hdF9fKHByaW50ZiwgMiwgMCkpKQp2b2lkIHNl
cV92cHJpbnRmKHN0cnVjdCBzZXFfZmlsZSAqbSwgY29uc3QgY2hhciAqZm10LCB2YV9saXN0
IGFyZ3MpOwpfX2F0dHJpYnV0ZV9fKChfX2Zvcm1hdF9fKHByaW50ZiwgMiwgMykpKQp2b2lk
IHNlcV9wcmludGYoc3RydWN0IHNlcV9maWxlICptLCBjb25zdCBjaGFyICpmbXQsIC4uLik7
CnZvaWQgc2VxX3B1dGMoc3RydWN0IHNlcV9maWxlICptLCBjaGFyIGMpOwp2b2lkIHNlcV9w
dXRzKHN0cnVjdCBzZXFfZmlsZSAqbSwgY29uc3QgY2hhciAqcyk7CnZvaWQgc2VxX3B1dF9k
ZWNpbWFsX3VsbF93aWR0aChzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIGNvbnN0IGNoYXIgKmRlbGlt
aXRlciwKICAgICAgICAgIHVuc2lnbmVkIGxvbmcgbG9uZyBudW0sIHVuc2lnbmVkIGludCB3
aWR0aCk7CnZvaWQgc2VxX3B1dF9kZWNpbWFsX3VsbChzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIGNv
bnN0IGNoYXIgKmRlbGltaXRlciwKICAgIHVuc2lnbmVkIGxvbmcgbG9uZyBudW0pOwp2b2lk
IHNlcV9wdXRfZGVjaW1hbF9sbChzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIGNvbnN0IGNoYXIgKmRl
bGltaXRlciwgbG9uZyBsb25nIG51bSk7CnZvaWQgc2VxX3B1dF9oZXhfbGwoc3RydWN0IHNl
cV9maWxlICptLCBjb25zdCBjaGFyICpkZWxpbWl0ZXIsCiAgICAgIHVuc2lnbmVkIGxvbmcg
bG9uZyB2LCB1bnNpZ25lZCBpbnQgd2lkdGgpOwoKdm9pZCBzZXFfZXNjYXBlKHN0cnVjdCBz
ZXFfZmlsZSAqbSwgY29uc3QgY2hhciAqcywgY29uc3QgY2hhciAqZXNjKTsKdm9pZCBzZXFf
ZXNjYXBlX21lbV9hc2NpaShzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIGNvbnN0IGNoYXIgKnNyYywg
c2l6ZV90IGlzeik7Cgp2b2lkIHNlcV9oZXhfZHVtcChzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIGNv
bnN0IGNoYXIgKnByZWZpeF9zdHIsIGludCBwcmVmaXhfdHlwZSwKICAgIGludCByb3dzaXpl
LCBpbnQgZ3JvdXBzaXplLCBjb25zdCB2b2lkICpidWYsIHNpemVfdCBsZW4sCiAgICBib29s
IGFzY2lpKTsKCmludCBzZXFfcGF0aChzdHJ1Y3Qgc2VxX2ZpbGUgKiwgY29uc3Qgc3RydWN0
IHBhdGggKiwgY29uc3QgY2hhciAqKTsKaW50IHNlcV9maWxlX3BhdGgoc3RydWN0IHNlcV9m
aWxlICosIHN0cnVjdCBmaWxlICosIGNvbnN0IGNoYXIgKik7CmludCBzZXFfZGVudHJ5KHN0
cnVjdCBzZXFfZmlsZSAqLCBzdHJ1Y3QgZGVudHJ5ICosIGNvbnN0IGNoYXIgKik7CmludCBz
ZXFfcGF0aF9yb290KHN0cnVjdCBzZXFfZmlsZSAqbSwgY29uc3Qgc3RydWN0IHBhdGggKnBh
dGgsCiAgICBjb25zdCBzdHJ1Y3QgcGF0aCAqcm9vdCwgY29uc3QgY2hhciAqZXNjKTsKCmlu
dCBzaW5nbGVfb3BlbihzdHJ1Y3QgZmlsZSAqLCBpbnQgKCopKHN0cnVjdCBzZXFfZmlsZSAq
LCB2b2lkICopLCB2b2lkICopOwppbnQgc2luZ2xlX29wZW5fc2l6ZShzdHJ1Y3QgZmlsZSAq
LCBpbnQgKCopKHN0cnVjdCBzZXFfZmlsZSAqLCB2b2lkICopLCB2b2lkICosIHNpemVfdCk7
CmludCBzaW5nbGVfcmVsZWFzZShzdHJ1Y3QgaW5vZGUgKiwgc3RydWN0IGZpbGUgKik7CnZv
aWQgKl9fc2VxX29wZW5fcHJpdmF0ZShzdHJ1Y3QgZmlsZSAqLCBjb25zdCBzdHJ1Y3Qgc2Vx
X29wZXJhdGlvbnMgKiwgaW50KTsKaW50IHNlcV9vcGVuX3ByaXZhdGUoc3RydWN0IGZpbGUg
KiwgY29uc3Qgc3RydWN0IHNlcV9vcGVyYXRpb25zICosIGludCk7CmludCBzZXFfcmVsZWFz
ZV9wcml2YXRlKHN0cnVjdCBpbm9kZSAqLCBzdHJ1Y3QgZmlsZSAqKTsKIyAxOTQgIi4vaW5j
bHVkZS9saW51eC9zZXFfZmlsZS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IHVzZXJfbmFtZXNwYWNl
ICpzZXFfdXNlcl9ucyhzdHJ1Y3Qgc2VxX2ZpbGUgKnNlcSkKewoKCgogZXh0ZXJuIHN0cnVj
dCB1c2VyX25hbWVzcGFjZSBpbml0X3VzZXJfbnM7CiByZXR1cm4gJmluaXRfdXNlcl9uczsK
Cn0KCgoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHNlcV9zaG93X29wdGlvbihzdHJ1Y3Qgc2VxX2Zp
bGUgKm0sIGNvbnN0IGNoYXIgKm5hbWUsCiAgICAgICBjb25zdCBjaGFyICp2YWx1ZSkKewog
c2VxX3B1dGMobSwgJywnKTsKIHNlcV9lc2NhcGUobSwgbmFtZSwgIiw9IFx0XG5cXCIpOwog
aWYgKHZhbHVlKSB7CiAgc2VxX3B1dGMobSwgJz0nKTsKICBzZXFfZXNjYXBlKG0sIHZhbHVl
LCAiLCBcdFxuXFwiKTsKIH0KfQojIDI0NCAiLi9pbmNsdWRlL2xpbnV4L3NlcV9maWxlLmgi
CmV4dGVybiBzdHJ1Y3QgbGlzdF9oZWFkICpzZXFfbGlzdF9zdGFydChzdHJ1Y3QgbGlzdF9o
ZWFkICpoZWFkLAogIGxvZmZfdCBwb3MpOwpleHRlcm4gc3RydWN0IGxpc3RfaGVhZCAqc2Vx
X2xpc3Rfc3RhcnRfaGVhZChzdHJ1Y3QgbGlzdF9oZWFkICpoZWFkLAogIGxvZmZfdCBwb3Mp
OwpleHRlcm4gc3RydWN0IGxpc3RfaGVhZCAqc2VxX2xpc3RfbmV4dCh2b2lkICp2LCBzdHJ1
Y3QgbGlzdF9oZWFkICpoZWFkLAogIGxvZmZfdCAqcHBvcyk7CgoKCgoKZXh0ZXJuIHN0cnVj
dCBobGlzdF9ub2RlICpzZXFfaGxpc3Rfc3RhcnQoc3RydWN0IGhsaXN0X2hlYWQgKmhlYWQs
CiAgICAgICBsb2ZmX3QgcG9zKTsKZXh0ZXJuIHN0cnVjdCBobGlzdF9ub2RlICpzZXFfaGxp
c3Rfc3RhcnRfaGVhZChzdHJ1Y3QgaGxpc3RfaGVhZCAqaGVhZCwKICAgICAgICAgICAgbG9m
Zl90IHBvcyk7CmV4dGVybiBzdHJ1Y3QgaGxpc3Rfbm9kZSAqc2VxX2hsaXN0X25leHQodm9p
ZCAqdiwgc3RydWN0IGhsaXN0X2hlYWQgKmhlYWQsCiAgICAgIGxvZmZfdCAqcHBvcyk7Cgpl
eHRlcm4gc3RydWN0IGhsaXN0X25vZGUgKnNlcV9obGlzdF9zdGFydF9yY3Uoc3RydWN0IGhs
aXN0X2hlYWQgKmhlYWQsCiAgICAgICAgICAgbG9mZl90IHBvcyk7CmV4dGVybiBzdHJ1Y3Qg
aGxpc3Rfbm9kZSAqc2VxX2hsaXN0X3N0YXJ0X2hlYWRfcmN1KHN0cnVjdCBobGlzdF9oZWFk
ICpoZWFkLAogICAgICAgICBsb2ZmX3QgcG9zKTsKZXh0ZXJuIHN0cnVjdCBobGlzdF9ub2Rl
ICpzZXFfaGxpc3RfbmV4dF9yY3Uodm9pZCAqdiwKICAgICAgICAgc3RydWN0IGhsaXN0X2hl
YWQgKmhlYWQsCiAgICAgICAgIGxvZmZfdCAqcHBvcyk7CgoKZXh0ZXJuIHN0cnVjdCBobGlz
dF9ub2RlICpzZXFfaGxpc3Rfc3RhcnRfcGVyY3B1KHN0cnVjdCBobGlzdF9oZWFkICpoZWFk
LCBpbnQgKmNwdSwgbG9mZl90IHBvcyk7CgpleHRlcm4gc3RydWN0IGhsaXN0X25vZGUgKnNl
cV9obGlzdF9uZXh0X3BlcmNwdSh2b2lkICp2LCBzdHJ1Y3QgaGxpc3RfaGVhZCAqaGVhZCwg
aW50ICpjcHUsIGxvZmZfdCAqcG9zKTsKCnZvaWQgc2VxX2ZpbGVfaW5pdCh2b2lkKTsKIyA3
ICIuL2luY2x1ZGUvbGludXgvcmluZ19idWZmZXIuaCIgMgojIDEgIi4vaW5jbHVkZS9saW51
eC9wb2xsLmgiIDEKIyAxMyAiLi9pbmNsdWRlL2xpbnV4L3BvbGwuaCIKIyAxICIuL2luY2x1
ZGUvdWFwaS9saW51eC9wb2xsLmgiIDEKIyAxICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2dl
bmVyYXRlZC91YXBpL2FzbS9wb2xsLmgiIDEKIyAxICIuL2luY2x1ZGUvdWFwaS9hc20tZ2Vu
ZXJpYy9wb2xsLmgiIDEKIyAzNiAiLi9pbmNsdWRlL3VhcGkvYXNtLWdlbmVyaWMvcG9sbC5o
IgpzdHJ1Y3QgcG9sbGZkIHsKIGludCBmZDsKIHNob3J0IGV2ZW50czsKIHNob3J0IHJldmVu
dHM7Cn07CiMgMSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9nZW5lcmF0ZWQvdWFwaS9hc20v
cG9sbC5oIiAyCiMgMSAiLi9pbmNsdWRlL3VhcGkvbGludXgvcG9sbC5oIiAyCiMgMTQgIi4v
aW5jbHVkZS9saW51eC9wb2xsLmgiIDIKIyAxICIuL2luY2x1ZGUvdWFwaS9saW51eC9ldmVu
dHBvbGwuaCIgMQojIDc3ICIuL2luY2x1ZGUvdWFwaS9saW51eC9ldmVudHBvbGwuaCIKc3Ry
dWN0IGVwb2xsX2V2ZW50IHsKIF9fcG9sbF90IGV2ZW50czsKIF9fdTY0IGRhdGE7Cn0gOwoj
IDg5ICIuL2luY2x1ZGUvdWFwaS9saW51eC9ldmVudHBvbGwuaCIKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQg
ZXBfdGFrZV9jYXJlX29mX2Vwb2xsd2FrZXVwKHN0cnVjdCBlcG9sbF9ldmVudCAqZXBldikK
ewogZXBldi0+ZXZlbnRzICY9IH4oKCBfX3BvbGxfdCkoMVUgPDwgMjkpKTsKfQojIDE1ICIu
L2luY2x1ZGUvbGludXgvcG9sbC5oIiAyCgpleHRlcm4gc3RydWN0IGN0bF90YWJsZSBlcG9s
bF90YWJsZVtdOwojIDMyICIuL2luY2x1ZGUvbGludXgvcG9sbC5oIgpzdHJ1Y3QgcG9sbF90
YWJsZV9zdHJ1Y3Q7CgoKCgp0eXBlZGVmIHZvaWQgKCpwb2xsX3F1ZXVlX3Byb2MpKHN0cnVj
dCBmaWxlICosIHdhaXRfcXVldWVfaGVhZF90ICosIHN0cnVjdCBwb2xsX3RhYmxlX3N0cnVj
dCAqKTsKCgoKCgp0eXBlZGVmIHN0cnVjdCBwb2xsX3RhYmxlX3N0cnVjdCB7CiBwb2xsX3F1
ZXVlX3Byb2MgX3Fwcm9jOwogX19wb2xsX3QgX2tleTsKfSBwb2xsX3RhYmxlOwoKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIHZvaWQgcG9sbF93YWl0KHN0cnVjdCBmaWxlICogZmlscCwgd2FpdF9xdWV1ZV9oZWFk
X3QgKiB3YWl0X2FkZHJlc3MsIHBvbGxfdGFibGUgKnApCnsKIGlmIChwICYmIHAtPl9xcHJv
YyAmJiB3YWl0X2FkZHJlc3MpCiAgcC0+X3Fwcm9jKGZpbHAsIHdhaXRfYWRkcmVzcywgcCk7
Cn0KCgoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgcG9sbF9kb2VzX25vdF93YWl0KGNvbnN0IHBvbGxf
dGFibGUgKnApCnsKIHJldHVybiBwID09ICgodm9pZCAqKTApIHx8IHAtPl9xcHJvYyA9PSAo
KHZvaWQgKikwKTsKfQoKCgoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fcG9sbF90IHBvbGxfcmVxdWVzdGVk
X2V2ZW50cyhjb25zdCBwb2xsX3RhYmxlICpwKQp7CiByZXR1cm4gcCA/IHAtPl9rZXkgOiB+
KF9fcG9sbF90KTA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGluaXRfcG9sbF9mdW5jcHRyKHBvbGxf
dGFibGUgKnB0LCBwb2xsX3F1ZXVlX3Byb2MgcXByb2MpCnsKIHB0LT5fcXByb2MgPSBxcHJv
YzsKIHB0LT5fa2V5ID0gfihfX3BvbGxfdCkwOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBmaWxlX2Nh
bl9wb2xsKHN0cnVjdCBmaWxlICpmaWxlKQp7CiByZXR1cm4gZmlsZS0+Zl9vcC0+cG9sbDsK
fQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIF9fcG9sbF90IHZmc19wb2xsKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1
Y3QgcG9sbF90YWJsZV9zdHJ1Y3QgKnB0KQp7CiBpZiAoX19idWlsdGluX2V4cGVjdCghISgh
ZmlsZS0+Zl9vcC0+cG9sbCksIDApKQogIHJldHVybiAoKCBfX3BvbGxfdCkweDAwMDAwMDAx
IHwgKCBfX3BvbGxfdCkweDAwMDAwMDA0IHwgKCBfX3BvbGxfdCkweDAwMDAwMDQwIHwgKCBf
X3BvbGxfdCkweDAwMDAwMTAwKTsKIHJldHVybiBmaWxlLT5mX29wLT5wb2xsKGZpbGUsIHB0
KTsKfQoKc3RydWN0IHBvbGxfdGFibGVfZW50cnkgewogc3RydWN0IGZpbGUgKmZpbHA7CiBf
X3BvbGxfdCBrZXk7CiB3YWl0X3F1ZXVlX2VudHJ5X3Qgd2FpdDsKIHdhaXRfcXVldWVfaGVh
ZF90ICp3YWl0X2FkZHJlc3M7Cn07CgoKCgpzdHJ1Y3QgcG9sbF93cXVldWVzIHsKIHBvbGxf
dGFibGUgcHQ7CiBzdHJ1Y3QgcG9sbF90YWJsZV9wYWdlICp0YWJsZTsKIHN0cnVjdCB0YXNr
X3N0cnVjdCAqcG9sbGluZ190YXNrOwogaW50IHRyaWdnZXJlZDsKIGludCBlcnJvcjsKIGlu
dCBpbmxpbmVfaW5kZXg7CiBzdHJ1Y3QgcG9sbF90YWJsZV9lbnRyeSBpbmxpbmVfZW50cmll
c1soKDgzMiAtIDI1NikgLyBzaXplb2Yoc3RydWN0IHBvbGxfdGFibGVfZW50cnkpKV07Cn07
CgpleHRlcm4gdm9pZCBwb2xsX2luaXR3YWl0KHN0cnVjdCBwb2xsX3dxdWV1ZXMgKnB3cSk7
CmV4dGVybiB2b2lkIHBvbGxfZnJlZXdhaXQoc3RydWN0IHBvbGxfd3F1ZXVlcyAqcHdxKTsK
ZXh0ZXJuIHU2NCBzZWxlY3RfZXN0aW1hdGVfYWNjdXJhY3koc3RydWN0IHRpbWVzcGVjNjQg
KnR2KTsKCgoKZXh0ZXJuIGludCBjb3JlX3N5c19zZWxlY3QoaW50IG4sIGZkX3NldCAqaW5w
LCBmZF9zZXQgKm91dHAsCiAgICAgIGZkX3NldCAqZXhwLCBzdHJ1Y3QgdGltZXNwZWM2NCAq
ZW5kX3RpbWUpOwoKZXh0ZXJuIGludCBwb2xsX3NlbGVjdF9zZXRfdGltZW91dChzdHJ1Y3Qg
dGltZXNwZWM2NCAqdG8sIHRpbWU2NF90IHNlYywKICAgICAgIGxvbmcgbnNlYyk7CgoKCgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgX191MTYgbWFuZ2xlX3BvbGwoX19wb2xsX3QgdmFsKQp7CiBfX3UxNiB2ID0g
KCBfX3UxNil2YWw7CgogcmV0dXJuICgoIF9fdTE2KSggX19wb2xsX3QpMHgwMDAwMDAwMSA8
IDB4MDAwMSA/ICh2ICYgKCBfX3UxNikoIF9fcG9sbF90KTB4MDAwMDAwMDEpICogKDB4MDAw
MS8oIF9fdTE2KSggX19wb2xsX3QpMHgwMDAwMDAwMSkgOiAodiAmICggX191MTYpKCBfX3Bv
bGxfdCkweDAwMDAwMDAxKSAvICgoIF9fdTE2KSggX19wb2xsX3QpMHgwMDAwMDAwMS8weDAw
MDEpKSB8ICgoIF9fdTE2KSggX19wb2xsX3QpMHgwMDAwMDAwNCA8IDB4MDAwNCA/ICh2ICYg
KCBfX3UxNikoIF9fcG9sbF90KTB4MDAwMDAwMDQpICogKDB4MDAwNC8oIF9fdTE2KSggX19w
b2xsX3QpMHgwMDAwMDAwNCkgOiAodiAmICggX191MTYpKCBfX3BvbGxfdCkweDAwMDAwMDA0
KSAvICgoIF9fdTE2KSggX19wb2xsX3QpMHgwMDAwMDAwNC8weDAwMDQpKSB8ICgoIF9fdTE2
KSggX19wb2xsX3QpMHgwMDAwMDAwMiA8IDB4MDAwMiA/ICh2ICYgKCBfX3UxNikoIF9fcG9s
bF90KTB4MDAwMDAwMDIpICogKDB4MDAwMi8oIF9fdTE2KSggX19wb2xsX3QpMHgwMDAwMDAw
MikgOiAodiAmICggX191MTYpKCBfX3BvbGxfdCkweDAwMDAwMDAyKSAvICgoIF9fdTE2KSgg
X19wb2xsX3QpMHgwMDAwMDAwMi8weDAwMDIpKSB8ICgoIF9fdTE2KSggX19wb2xsX3QpMHgw
MDAwMDAwOCA8IDB4MDAwOCA/ICh2ICYgKCBfX3UxNikoIF9fcG9sbF90KTB4MDAwMDAwMDgp
ICogKDB4MDAwOC8oIF9fdTE2KSggX19wb2xsX3QpMHgwMDAwMDAwOCkgOiAodiAmICggX191
MTYpKCBfX3BvbGxfdCkweDAwMDAwMDA4KSAvICgoIF9fdTE2KSggX19wb2xsX3QpMHgwMDAw
MDAwOC8weDAwMDgpKSB8ICgoIF9fdTE2KSggX19wb2xsX3QpMHgwMDAwMDAyMCA8IDB4MDAy
MCA/ICh2ICYgKCBfX3UxNikoIF9fcG9sbF90KTB4MDAwMDAwMjApICogKDB4MDAyMC8oIF9f
dTE2KSggX19wb2xsX3QpMHgwMDAwMDAyMCkgOiAodiAmICggX191MTYpKCBfX3BvbGxfdCkw
eDAwMDAwMDIwKSAvICgoIF9fdTE2KSggX19wb2xsX3QpMHgwMDAwMDAyMC8weDAwMjApKSB8
CiAgKCggX191MTYpKCBfX3BvbGxfdCkweDAwMDAwMDQwIDwgMHgwMDQwID8gKHYgJiAoIF9f
dTE2KSggX19wb2xsX3QpMHgwMDAwMDA0MCkgKiAoMHgwMDQwLyggX191MTYpKCBfX3BvbGxf
dCkweDAwMDAwMDQwKSA6ICh2ICYgKCBfX3UxNikoIF9fcG9sbF90KTB4MDAwMDAwNDApIC8g
KCggX191MTYpKCBfX3BvbGxfdCkweDAwMDAwMDQwLzB4MDA0MCkpIHwgKCggX191MTYpKCBf
X3BvbGxfdCkweDAwMDAwMDgwIDwgMHgwMDgwID8gKHYgJiAoIF9fdTE2KSggX19wb2xsX3Qp
MHgwMDAwMDA4MCkgKiAoMHgwMDgwLyggX191MTYpKCBfX3BvbGxfdCkweDAwMDAwMDgwKSA6
ICh2ICYgKCBfX3UxNikoIF9fcG9sbF90KTB4MDAwMDAwODApIC8gKCggX191MTYpKCBfX3Bv
bGxfdCkweDAwMDAwMDgwLzB4MDA4MCkpIHwgKCggX191MTYpKCBfX3BvbGxfdCkweDAwMDAw
MTAwIDwgMHgwMTAwID8gKHYgJiAoIF9fdTE2KSggX19wb2xsX3QpMHgwMDAwMDEwMCkgKiAo
MHgwMTAwLyggX191MTYpKCBfX3BvbGxfdCkweDAwMDAwMTAwKSA6ICh2ICYgKCBfX3UxNiko
IF9fcG9sbF90KTB4MDAwMDAxMDApIC8gKCggX191MTYpKCBfX3BvbGxfdCkweDAwMDAwMTAw
LzB4MDEwMCkpIHwgKCggX191MTYpKCBfX3BvbGxfdCkweDAwMDAwMjAwIDwgMHgwMjAwID8g
KHYgJiAoIF9fdTE2KSggX19wb2xsX3QpMHgwMDAwMDIwMCkgKiAoMHgwMjAwLyggX191MTYp
KCBfX3BvbGxfdCkweDAwMDAwMjAwKSA6ICh2ICYgKCBfX3UxNikoIF9fcG9sbF90KTB4MDAw
MDAyMDApIC8gKCggX191MTYpKCBfX3BvbGxfdCkweDAwMDAwMjAwLzB4MDIwMCkpIHwKICAo
KCBfX3UxNikoIF9fcG9sbF90KTB4MDAwMDAwMTAgPCAweDAwMTAgPyAodiAmICggX191MTYp
KCBfX3BvbGxfdCkweDAwMDAwMDEwKSAqICgweDAwMTAvKCBfX3UxNikoIF9fcG9sbF90KTB4
MDAwMDAwMTApIDogKHYgJiAoIF9fdTE2KSggX19wb2xsX3QpMHgwMDAwMDAxMCkgLyAoKCBf
X3UxNikoIF9fcG9sbF90KTB4MDAwMDAwMTAvMHgwMDEwKSkgfCAoKCBfX3UxNikoIF9fcG9s
bF90KTB4MDAwMDIwMDAgPCAweDIwMDAgPyAodiAmICggX191MTYpKCBfX3BvbGxfdCkweDAw
MDAyMDAwKSAqICgweDIwMDAvKCBfX3UxNikoIF9fcG9sbF90KTB4MDAwMDIwMDApIDogKHYg
JiAoIF9fdTE2KSggX19wb2xsX3QpMHgwMDAwMjAwMCkgLyAoKCBfX3UxNikoIF9fcG9sbF90
KTB4MDAwMDIwMDAvMHgyMDAwKSkgfCAoKCBfX3UxNikoIF9fcG9sbF90KTB4MDAwMDA0MDAg
PCAweDA0MDAgPyAodiAmICggX191MTYpKCBfX3BvbGxfdCkweDAwMDAwNDAwKSAqICgweDA0
MDAvKCBfX3UxNikoIF9fcG9sbF90KTB4MDAwMDA0MDApIDogKHYgJiAoIF9fdTE2KSggX19w
b2xsX3QpMHgwMDAwMDQwMCkgLyAoKCBfX3UxNikoIF9fcG9sbF90KTB4MDAwMDA0MDAvMHgw
NDAwKSk7Cgp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgX19wb2xsX3QgZGVtYW5nbGVfcG9sbCh1MTYgdmFsKQp7
CgogcmV0dXJuICggX19wb2xsX3QpKDB4MDAwMSA8ICggX191MTYpKCBfX3BvbGxfdCkweDAw
MDAwMDAxID8gKHZhbCAmIDB4MDAwMSkgKiAoKCBfX3UxNikoIF9fcG9sbF90KTB4MDAwMDAw
MDEvMHgwMDAxKSA6ICh2YWwgJiAweDAwMDEpIC8gKDB4MDAwMS8oIF9fdTE2KSggX19wb2xs
X3QpMHgwMDAwMDAwMSkpIHwgKCBfX3BvbGxfdCkoMHgwMDA0IDwgKCBfX3UxNikoIF9fcG9s
bF90KTB4MDAwMDAwMDQgPyAodmFsICYgMHgwMDA0KSAqICgoIF9fdTE2KSggX19wb2xsX3Qp
MHgwMDAwMDAwNC8weDAwMDQpIDogKHZhbCAmIDB4MDAwNCkgLyAoMHgwMDA0LyggX191MTYp
KCBfX3BvbGxfdCkweDAwMDAwMDA0KSkgfCAoIF9fcG9sbF90KSgweDAwMDIgPCAoIF9fdTE2
KSggX19wb2xsX3QpMHgwMDAwMDAwMiA/ICh2YWwgJiAweDAwMDIpICogKCggX191MTYpKCBf
X3BvbGxfdCkweDAwMDAwMDAyLzB4MDAwMikgOiAodmFsICYgMHgwMDAyKSAvICgweDAwMDIv
KCBfX3UxNikoIF9fcG9sbF90KTB4MDAwMDAwMDIpKSB8ICggX19wb2xsX3QpKDB4MDAwOCA8
ICggX191MTYpKCBfX3BvbGxfdCkweDAwMDAwMDA4ID8gKHZhbCAmIDB4MDAwOCkgKiAoKCBf
X3UxNikoIF9fcG9sbF90KTB4MDAwMDAwMDgvMHgwMDA4KSA6ICh2YWwgJiAweDAwMDgpIC8g
KDB4MDAwOC8oIF9fdTE2KSggX19wb2xsX3QpMHgwMDAwMDAwOCkpIHwgKCBfX3BvbGxfdCko
MHgwMDIwIDwgKCBfX3UxNikoIF9fcG9sbF90KTB4MDAwMDAwMjAgPyAodmFsICYgMHgwMDIw
KSAqICgoIF9fdTE2KSggX19wb2xsX3QpMHgwMDAwMDAyMC8weDAwMjApIDogKHZhbCAmIDB4
MDAyMCkgLyAoMHgwMDIwLyggX191MTYpKCBfX3BvbGxfdCkweDAwMDAwMDIwKSkgfAogICgg
X19wb2xsX3QpKDB4MDA0MCA8ICggX191MTYpKCBfX3BvbGxfdCkweDAwMDAwMDQwID8gKHZh
bCAmIDB4MDA0MCkgKiAoKCBfX3UxNikoIF9fcG9sbF90KTB4MDAwMDAwNDAvMHgwMDQwKSA6
ICh2YWwgJiAweDAwNDApIC8gKDB4MDA0MC8oIF9fdTE2KSggX19wb2xsX3QpMHgwMDAwMDA0
MCkpIHwgKCBfX3BvbGxfdCkoMHgwMDgwIDwgKCBfX3UxNikoIF9fcG9sbF90KTB4MDAwMDAw
ODAgPyAodmFsICYgMHgwMDgwKSAqICgoIF9fdTE2KSggX19wb2xsX3QpMHgwMDAwMDA4MC8w
eDAwODApIDogKHZhbCAmIDB4MDA4MCkgLyAoMHgwMDgwLyggX191MTYpKCBfX3BvbGxfdCkw
eDAwMDAwMDgwKSkgfCAoIF9fcG9sbF90KSgweDAxMDAgPCAoIF9fdTE2KSggX19wb2xsX3Qp
MHgwMDAwMDEwMCA/ICh2YWwgJiAweDAxMDApICogKCggX191MTYpKCBfX3BvbGxfdCkweDAw
MDAwMTAwLzB4MDEwMCkgOiAodmFsICYgMHgwMTAwKSAvICgweDAxMDAvKCBfX3UxNikoIF9f
cG9sbF90KTB4MDAwMDAxMDApKSB8ICggX19wb2xsX3QpKDB4MDIwMCA8ICggX191MTYpKCBf
X3BvbGxfdCkweDAwMDAwMjAwID8gKHZhbCAmIDB4MDIwMCkgKiAoKCBfX3UxNikoIF9fcG9s
bF90KTB4MDAwMDAyMDAvMHgwMjAwKSA6ICh2YWwgJiAweDAyMDApIC8gKDB4MDIwMC8oIF9f
dTE2KSggX19wb2xsX3QpMHgwMDAwMDIwMCkpIHwKICAoIF9fcG9sbF90KSgweDAwMTAgPCAo
IF9fdTE2KSggX19wb2xsX3QpMHgwMDAwMDAxMCA/ICh2YWwgJiAweDAwMTApICogKCggX191
MTYpKCBfX3BvbGxfdCkweDAwMDAwMDEwLzB4MDAxMCkgOiAodmFsICYgMHgwMDEwKSAvICgw
eDAwMTAvKCBfX3UxNikoIF9fcG9sbF90KTB4MDAwMDAwMTApKSB8ICggX19wb2xsX3QpKDB4
MjAwMCA8ICggX191MTYpKCBfX3BvbGxfdCkweDAwMDAyMDAwID8gKHZhbCAmIDB4MjAwMCkg
KiAoKCBfX3UxNikoIF9fcG9sbF90KTB4MDAwMDIwMDAvMHgyMDAwKSA6ICh2YWwgJiAweDIw
MDApIC8gKDB4MjAwMC8oIF9fdTE2KSggX19wb2xsX3QpMHgwMDAwMjAwMCkpIHwgKCBfX3Bv
bGxfdCkoMHgwNDAwIDwgKCBfX3UxNikoIF9fcG9sbF90KTB4MDAwMDA0MDAgPyAodmFsICYg
MHgwNDAwKSAqICgoIF9fdTE2KSggX19wb2xsX3QpMHgwMDAwMDQwMC8weDA0MDApIDogKHZh
bCAmIDB4MDQwMCkgLyAoMHgwNDAwLyggX191MTYpKCBfX3BvbGxfdCkweDAwMDAwNDAwKSk7
Cgp9CiMgOCAiLi9pbmNsdWRlL2xpbnV4L3JpbmdfYnVmZmVyLmgiIDIKCnN0cnVjdCB0cmFj
ZV9idWZmZXI7CnN0cnVjdCByaW5nX2J1ZmZlcl9pdGVyOwoKCgoKc3RydWN0IHJpbmdfYnVm
ZmVyX2V2ZW50IHsKIHUzMiB0eXBlX2xlbjo1LCB0aW1lX2RlbHRhOjI3OwoKIHUzMiBhcnJh
eVtdOwp9OwojIDU1ICIuL2luY2x1ZGUvbGludXgvcmluZ19idWZmZXIuaCIKZW51bSByaW5n
X2J1ZmZlcl90eXBlIHsKIFJJTkdCVUZfVFlQRV9EQVRBX1RZUEVfTEVOX01BWCA9IDI4LAog
UklOR0JVRl9UWVBFX1BBRERJTkcsCiBSSU5HQlVGX1RZUEVfVElNRV9FWFRFTkQsCiBSSU5H
QlVGX1RZUEVfVElNRV9TVEFNUCwKfTsKCnVuc2lnbmVkIHJpbmdfYnVmZmVyX2V2ZW50X2xl
bmd0aChzdHJ1Y3QgcmluZ19idWZmZXJfZXZlbnQgKmV2ZW50KTsKdm9pZCAqcmluZ19idWZm
ZXJfZXZlbnRfZGF0YShzdHJ1Y3QgcmluZ19idWZmZXJfZXZlbnQgKmV2ZW50KTsKdTY0IHJp
bmdfYnVmZmVyX2V2ZW50X3RpbWVfc3RhbXAoc3RydWN0IHJpbmdfYnVmZmVyX2V2ZW50ICpl
dmVudCk7CiMgODAgIi4vaW5jbHVkZS9saW51eC9yaW5nX2J1ZmZlci5oIgp2b2lkIHJpbmdf
YnVmZmVyX2Rpc2NhcmRfY29tbWl0KHN0cnVjdCB0cmFjZV9idWZmZXIgKmJ1ZmZlciwKICAg
IHN0cnVjdCByaW5nX2J1ZmZlcl9ldmVudCAqZXZlbnQpOwoKCgoKc3RydWN0IHRyYWNlX2J1
ZmZlciAqCl9fcmluZ19idWZmZXJfYWxsb2ModW5zaWduZWQgbG9uZyBzaXplLCB1bnNpZ25l
ZCBmbGFncywgc3RydWN0IGxvY2tfY2xhc3Nfa2V5ICprZXkpOwojIDEwMCAiLi9pbmNsdWRl
L2xpbnV4L3JpbmdfYnVmZmVyLmgiCmludCByaW5nX2J1ZmZlcl93YWl0KHN0cnVjdCB0cmFj
ZV9idWZmZXIgKmJ1ZmZlciwgaW50IGNwdSwgaW50IGZ1bGwpOwpfX3BvbGxfdCByaW5nX2J1
ZmZlcl9wb2xsX3dhaXQoc3RydWN0IHRyYWNlX2J1ZmZlciAqYnVmZmVyLCBpbnQgY3B1LAog
ICAgIHN0cnVjdCBmaWxlICpmaWxwLCBwb2xsX3RhYmxlICpwb2xsX3RhYmxlKTsKCgoKCnZv
aWQgcmluZ19idWZmZXJfZnJlZShzdHJ1Y3QgdHJhY2VfYnVmZmVyICpidWZmZXIpOwoKaW50
IHJpbmdfYnVmZmVyX3Jlc2l6ZShzdHJ1Y3QgdHJhY2VfYnVmZmVyICpidWZmZXIsIHVuc2ln
bmVkIGxvbmcgc2l6ZSwgaW50IGNwdSk7Cgp2b2lkIHJpbmdfYnVmZmVyX2NoYW5nZV9vdmVy
d3JpdGUoc3RydWN0IHRyYWNlX2J1ZmZlciAqYnVmZmVyLCBpbnQgdmFsKTsKCnN0cnVjdCBy
aW5nX2J1ZmZlcl9ldmVudCAqcmluZ19idWZmZXJfbG9ja19yZXNlcnZlKHN0cnVjdCB0cmFj
ZV9idWZmZXIgKmJ1ZmZlciwKICAgICAgICAgdW5zaWduZWQgbG9uZyBsZW5ndGgpOwppbnQg
cmluZ19idWZmZXJfdW5sb2NrX2NvbW1pdChzdHJ1Y3QgdHJhY2VfYnVmZmVyICpidWZmZXIs
CiAgICAgICAgIHN0cnVjdCByaW5nX2J1ZmZlcl9ldmVudCAqZXZlbnQpOwppbnQgcmluZ19i
dWZmZXJfd3JpdGUoc3RydWN0IHRyYWNlX2J1ZmZlciAqYnVmZmVyLAogICAgICAgIHVuc2ln
bmVkIGxvbmcgbGVuZ3RoLCB2b2lkICpkYXRhKTsKCnZvaWQgcmluZ19idWZmZXJfbmVzdF9z
dGFydChzdHJ1Y3QgdHJhY2VfYnVmZmVyICpidWZmZXIpOwp2b2lkIHJpbmdfYnVmZmVyX25l
c3RfZW5kKHN0cnVjdCB0cmFjZV9idWZmZXIgKmJ1ZmZlcik7CgpzdHJ1Y3QgcmluZ19idWZm
ZXJfZXZlbnQgKgpyaW5nX2J1ZmZlcl9wZWVrKHN0cnVjdCB0cmFjZV9idWZmZXIgKmJ1ZmZl
ciwgaW50IGNwdSwgdTY0ICp0cywKICAgdW5zaWduZWQgbG9uZyAqbG9zdF9ldmVudHMpOwpz
dHJ1Y3QgcmluZ19idWZmZXJfZXZlbnQgKgpyaW5nX2J1ZmZlcl9jb25zdW1lKHN0cnVjdCB0
cmFjZV9idWZmZXIgKmJ1ZmZlciwgaW50IGNwdSwgdTY0ICp0cywKICAgICAgdW5zaWduZWQg
bG9uZyAqbG9zdF9ldmVudHMpOwoKc3RydWN0IHJpbmdfYnVmZmVyX2l0ZXIgKgpyaW5nX2J1
ZmZlcl9yZWFkX3ByZXBhcmUoc3RydWN0IHRyYWNlX2J1ZmZlciAqYnVmZmVyLCBpbnQgY3B1
LCBnZnBfdCBmbGFncyk7CnZvaWQgcmluZ19idWZmZXJfcmVhZF9wcmVwYXJlX3N5bmModm9p
ZCk7CnZvaWQgcmluZ19idWZmZXJfcmVhZF9zdGFydChzdHJ1Y3QgcmluZ19idWZmZXJfaXRl
ciAqaXRlcik7CnZvaWQgcmluZ19idWZmZXJfcmVhZF9maW5pc2goc3RydWN0IHJpbmdfYnVm
ZmVyX2l0ZXIgKml0ZXIpOwoKc3RydWN0IHJpbmdfYnVmZmVyX2V2ZW50ICoKcmluZ19idWZm
ZXJfaXRlcl9wZWVrKHN0cnVjdCByaW5nX2J1ZmZlcl9pdGVyICppdGVyLCB1NjQgKnRzKTsK
dm9pZCByaW5nX2J1ZmZlcl9pdGVyX2FkdmFuY2Uoc3RydWN0IHJpbmdfYnVmZmVyX2l0ZXIg
Kml0ZXIpOwp2b2lkIHJpbmdfYnVmZmVyX2l0ZXJfcmVzZXQoc3RydWN0IHJpbmdfYnVmZmVy
X2l0ZXIgKml0ZXIpOwppbnQgcmluZ19idWZmZXJfaXRlcl9lbXB0eShzdHJ1Y3QgcmluZ19i
dWZmZXJfaXRlciAqaXRlcik7CmJvb2wgcmluZ19idWZmZXJfaXRlcl9kcm9wcGVkKHN0cnVj
dCByaW5nX2J1ZmZlcl9pdGVyICppdGVyKTsKCnVuc2lnbmVkIGxvbmcgcmluZ19idWZmZXJf
c2l6ZShzdHJ1Y3QgdHJhY2VfYnVmZmVyICpidWZmZXIsIGludCBjcHUpOwoKdm9pZCByaW5n
X2J1ZmZlcl9yZXNldF9jcHUoc3RydWN0IHRyYWNlX2J1ZmZlciAqYnVmZmVyLCBpbnQgY3B1
KTsKdm9pZCByaW5nX2J1ZmZlcl9yZXNldChzdHJ1Y3QgdHJhY2VfYnVmZmVyICpidWZmZXIp
OwoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSBpbnQKcmluZ19idWZmZXJfc3dhcF9jcHUoc3RydWN0IHRyYWNl
X2J1ZmZlciAqYnVmZmVyX2EsCiAgICAgICBzdHJ1Y3QgdHJhY2VfYnVmZmVyICpidWZmZXJf
YiwgaW50IGNwdSkKewogcmV0dXJuIC0xOTsKfQoKCmJvb2wgcmluZ19idWZmZXJfZW1wdHko
c3RydWN0IHRyYWNlX2J1ZmZlciAqYnVmZmVyKTsKYm9vbCByaW5nX2J1ZmZlcl9lbXB0eV9j
cHUoc3RydWN0IHRyYWNlX2J1ZmZlciAqYnVmZmVyLCBpbnQgY3B1KTsKCnZvaWQgcmluZ19i
dWZmZXJfcmVjb3JkX2Rpc2FibGUoc3RydWN0IHRyYWNlX2J1ZmZlciAqYnVmZmVyKTsKdm9p
ZCByaW5nX2J1ZmZlcl9yZWNvcmRfZW5hYmxlKHN0cnVjdCB0cmFjZV9idWZmZXIgKmJ1ZmZl
cik7CnZvaWQgcmluZ19idWZmZXJfcmVjb3JkX29mZihzdHJ1Y3QgdHJhY2VfYnVmZmVyICpi
dWZmZXIpOwp2b2lkIHJpbmdfYnVmZmVyX3JlY29yZF9vbihzdHJ1Y3QgdHJhY2VfYnVmZmVy
ICpidWZmZXIpOwpib29sIHJpbmdfYnVmZmVyX3JlY29yZF9pc19vbihzdHJ1Y3QgdHJhY2Vf
YnVmZmVyICpidWZmZXIpOwpib29sIHJpbmdfYnVmZmVyX3JlY29yZF9pc19zZXRfb24oc3Ry
dWN0IHRyYWNlX2J1ZmZlciAqYnVmZmVyKTsKdm9pZCByaW5nX2J1ZmZlcl9yZWNvcmRfZGlz
YWJsZV9jcHUoc3RydWN0IHRyYWNlX2J1ZmZlciAqYnVmZmVyLCBpbnQgY3B1KTsKdm9pZCBy
aW5nX2J1ZmZlcl9yZWNvcmRfZW5hYmxlX2NwdShzdHJ1Y3QgdHJhY2VfYnVmZmVyICpidWZm
ZXIsIGludCBjcHUpOwoKdTY0IHJpbmdfYnVmZmVyX29sZGVzdF9ldmVudF90cyhzdHJ1Y3Qg
dHJhY2VfYnVmZmVyICpidWZmZXIsIGludCBjcHUpOwp1bnNpZ25lZCBsb25nIHJpbmdfYnVm
ZmVyX2J5dGVzX2NwdShzdHJ1Y3QgdHJhY2VfYnVmZmVyICpidWZmZXIsIGludCBjcHUpOwp1
bnNpZ25lZCBsb25nIHJpbmdfYnVmZmVyX2VudHJpZXMoc3RydWN0IHRyYWNlX2J1ZmZlciAq
YnVmZmVyKTsKdW5zaWduZWQgbG9uZyByaW5nX2J1ZmZlcl9vdmVycnVucyhzdHJ1Y3QgdHJh
Y2VfYnVmZmVyICpidWZmZXIpOwp1bnNpZ25lZCBsb25nIHJpbmdfYnVmZmVyX2VudHJpZXNf
Y3B1KHN0cnVjdCB0cmFjZV9idWZmZXIgKmJ1ZmZlciwgaW50IGNwdSk7CnVuc2lnbmVkIGxv
bmcgcmluZ19idWZmZXJfb3ZlcnJ1bl9jcHUoc3RydWN0IHRyYWNlX2J1ZmZlciAqYnVmZmVy
LCBpbnQgY3B1KTsKdW5zaWduZWQgbG9uZyByaW5nX2J1ZmZlcl9jb21taXRfb3ZlcnJ1bl9j
cHUoc3RydWN0IHRyYWNlX2J1ZmZlciAqYnVmZmVyLCBpbnQgY3B1KTsKdW5zaWduZWQgbG9u
ZyByaW5nX2J1ZmZlcl9kcm9wcGVkX2V2ZW50c19jcHUoc3RydWN0IHRyYWNlX2J1ZmZlciAq
YnVmZmVyLCBpbnQgY3B1KTsKdW5zaWduZWQgbG9uZyByaW5nX2J1ZmZlcl9yZWFkX2V2ZW50
c19jcHUoc3RydWN0IHRyYWNlX2J1ZmZlciAqYnVmZmVyLCBpbnQgY3B1KTsKCnU2NCByaW5n
X2J1ZmZlcl90aW1lX3N0YW1wKHN0cnVjdCB0cmFjZV9idWZmZXIgKmJ1ZmZlciwgaW50IGNw
dSk7CnZvaWQgcmluZ19idWZmZXJfbm9ybWFsaXplX3RpbWVfc3RhbXAoc3RydWN0IHRyYWNl
X2J1ZmZlciAqYnVmZmVyLAogICAgICAgICAgaW50IGNwdSwgdTY0ICp0cyk7CnZvaWQgcmlu
Z19idWZmZXJfc2V0X2Nsb2NrKHN0cnVjdCB0cmFjZV9idWZmZXIgKmJ1ZmZlciwKICAgICAg
dTY0ICgqY2xvY2spKHZvaWQpKTsKdm9pZCByaW5nX2J1ZmZlcl9zZXRfdGltZV9zdGFtcF9h
YnMoc3RydWN0IHRyYWNlX2J1ZmZlciAqYnVmZmVyLCBib29sIGFicyk7CmJvb2wgcmluZ19i
dWZmZXJfdGltZV9zdGFtcF9hYnMoc3RydWN0IHRyYWNlX2J1ZmZlciAqYnVmZmVyKTsKCnNp
emVfdCByaW5nX2J1ZmZlcl9ucl9wYWdlcyhzdHJ1Y3QgdHJhY2VfYnVmZmVyICpidWZmZXIs
IGludCBjcHUpOwpzaXplX3QgcmluZ19idWZmZXJfbnJfZGlydHlfcGFnZXMoc3RydWN0IHRy
YWNlX2J1ZmZlciAqYnVmZmVyLCBpbnQgY3B1KTsKCnZvaWQgKnJpbmdfYnVmZmVyX2FsbG9j
X3JlYWRfcGFnZShzdHJ1Y3QgdHJhY2VfYnVmZmVyICpidWZmZXIsIGludCBjcHUpOwp2b2lk
IHJpbmdfYnVmZmVyX2ZyZWVfcmVhZF9wYWdlKHN0cnVjdCB0cmFjZV9idWZmZXIgKmJ1ZmZl
ciwgaW50IGNwdSwgdm9pZCAqZGF0YSk7CmludCByaW5nX2J1ZmZlcl9yZWFkX3BhZ2Uoc3Ry
dWN0IHRyYWNlX2J1ZmZlciAqYnVmZmVyLCB2b2lkICoqZGF0YV9wYWdlLAogICAgIHNpemVf
dCBsZW4sIGludCBjcHUsIGludCBmdWxsKTsKCnN0cnVjdCB0cmFjZV9zZXE7CgppbnQgcmlu
Z19idWZmZXJfcHJpbnRfZW50cnlfaGVhZGVyKHN0cnVjdCB0cmFjZV9zZXEgKnMpOwppbnQg
cmluZ19idWZmZXJfcHJpbnRfcGFnZV9oZWFkZXIoc3RydWN0IHRyYWNlX3NlcSAqcyk7Cgpl
bnVtIHJpbmdfYnVmZmVyX2ZsYWdzIHsKIFJCX0ZMX09WRVJXUklURSA9IDEgPDwgMCwKfTsK
CgppbnQgdHJhY2VfcmJfY3B1X3ByZXBhcmUodW5zaWduZWQgaW50IGNwdSwgc3RydWN0IGhs
aXN0X25vZGUgKm5vZGUpOwojIDcgIi4vaW5jbHVkZS9saW51eC90cmFjZV9ldmVudHMuaCIg
MgojIDEgIi4vaW5jbHVkZS9saW51eC90cmFjZV9zZXEuaCIgMQoKCgoKIyAxICIuL2luY2x1
ZGUvbGludXgvc2VxX2J1Zi5oIiAxCiMgMTkgIi4vaW5jbHVkZS9saW51eC9zZXFfYnVmLmgi
CnN0cnVjdCBzZXFfYnVmIHsKIGNoYXIgKmJ1ZmZlcjsKIHNpemVfdCBzaXplOwogc2l6ZV90
IGxlbjsKIGxvZmZfdCByZWFkcG9zOwp9OwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgc2VxX2J1Zl9jbGVh
cihzdHJ1Y3Qgc2VxX2J1ZiAqcykKewogcy0+bGVuID0gMDsKIHMtPnJlYWRwb3MgPSAwOwp9
CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgdm9pZApzZXFfYnVmX2luaXQoc3RydWN0IHNlcV9idWYgKnMsIHVuc2ln
bmVkIGNoYXIgKmJ1ZiwgdW5zaWduZWQgaW50IHNpemUpCnsKIHMtPmJ1ZmZlciA9IGJ1ZjsK
IHMtPnNpemUgPSBzaXplOwogc2VxX2J1Zl9jbGVhcihzKTsKfQoKCgoKCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKQoK
IyA0NCAiLi9pbmNsdWRlL2xpbnV4L3NlcV9idWYuaCIKICAgICAgICAgICAgICBib29sCnNl
cV9idWZfaGFzX292ZXJmbG93ZWQoc3RydWN0IHNlcV9idWYgKnMpCnsKIHJldHVybiBzLT5s
ZW4gPiBzLT5zaXplOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZApzZXFfYnVmX3NldF9vdmVyZmxvdyhz
dHJ1Y3Qgc2VxX2J1ZiAqcykKewogcy0+bGVuID0gcy0+c2l6ZSArIDE7Cn0KCgoKCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSB1bnNpZ25lZCBpbnQKc2VxX2J1Zl9idWZmZXJfbGVmdChzdHJ1Y3Qgc2VxX2J1ZiAq
cykKewogaWYgKHNlcV9idWZfaGFzX292ZXJmbG93ZWQocykpCiAgcmV0dXJuIDA7CgogcmV0
dXJuIHMtPnNpemUgLSBzLT5sZW47Cn0KCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgaW50IHNlcV9i
dWZfdXNlZChzdHJ1Y3Qgc2VxX2J1ZiAqcykKewogcmV0dXJuIF9fYnVpbHRpbl9jaG9vc2Vf
ZXhwcigoKCEhKHNpemVvZigodHlwZW9mKHMtPmxlbikgKikxID09ICh0eXBlb2Yocy0+c2l6
ZSkgKikxKSkpICYmICgoc2l6ZW9mKGludCkgPT0gc2l6ZW9mKCooOCA/ICgodm9pZCAqKSgo
bG9uZykocy0+bGVuKSAqIDBsKSkgOiAoaW50ICopOCkpKSAmJiAoc2l6ZW9mKGludCkgPT0g
c2l6ZW9mKCooOCA/ICgodm9pZCAqKSgobG9uZykocy0+c2l6ZSkgKiAwbCkpIDogKGludCAq
KTgpKSkpKSwgKChzLT5sZW4pIDwgKHMtPnNpemUpID8gKHMtPmxlbikgOiAocy0+c2l6ZSkp
LCAoeyB0eXBlb2Yocy0+bGVuKSBfX1VOSVFVRV9JRF9fX3gxOTYgPSAocy0+bGVuKTsgdHlw
ZW9mKHMtPnNpemUpIF9fVU5JUVVFX0lEX19feTE5NyA9IChzLT5zaXplKTsgKChfX1VOSVFV
RV9JRF9fX3gxOTYpIDwgKF9fVU5JUVVFX0lEX19feTE5NykgPyAoX19VTklRVUVfSURfX194
MTk2KSA6IChfX1VOSVFVRV9JRF9fX3kxOTcpKTsgfSkpOwp9CiMgODIgIi4vaW5jbHVkZS9s
aW51eC9zZXFfYnVmLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzaXplX3Qgc2VxX2J1Zl9nZXRfYnVmKHN0cnVj
dCBzZXFfYnVmICpzLCBjaGFyICoqYnVmcCkKewogKHsgaW50IF9fcmV0X3dhcm5fb24gPSAh
IShzLT5sZW4gPiBzLT5zaXplICsgMSk7IGlmIChfX2J1aWx0aW5fY29uc3RhbnRfcChfX3Jl
dF93YXJuX29uKSkgeyBpZiAoX19yZXRfd2Fybl9vbikgX19hc21fXyBfX3ZvbGF0aWxlX18o
ICIxOgkiICJ0d2kgMzEsIDAsIDAiICJcbiIgIi5zZWN0aW9uIF9fYnVnX3RhYmxlLFwiYXdc
IlxuIiAiMjpcdCIgIi44Ynl0ZSIgIiAiICIxYiwgJTBcbiIgIlx0LnNob3J0ICUxLCAlMlxu
IiAiLm9yZyAyYislM1xuIiAiLnByZXZpb3VzXG4iIDogOiAiaSIgKCIuL2luY2x1ZGUvbGlu
dXgvc2VxX2J1Zi5oIiksICJpIiAoODQpLCAiaSIgKCgxIDw8IDApIHwgKCgoOSkgPDwgOCkp
KSwgImkiIChzaXplb2Yoc3RydWN0IGJ1Z19lbnRyeSkpKTsgfSBlbHNlIHsgX19hc21fXyBf
X3ZvbGF0aWxlX18oICIxOgkiICJ0ZG5laSIgIiAiICIgJTQsIDAiICJcbiIgIi5zZWN0aW9u
IF9fYnVnX3RhYmxlLFwiYXdcIlxuIiAiMjpcdCIgIi44Ynl0ZSIgIiAiICIxYiwgJTBcbiIg
Ilx0LnNob3J0ICUxLCAlMlxuIiAiLm9yZyAyYislM1xuIiAiLnByZXZpb3VzXG4iIDogOiAi
aSIgKCIuL2luY2x1ZGUvbGludXgvc2VxX2J1Zi5oIiksICJpIiAoODQpLCAiaSIgKCgxIDw8
IDApIHwgKCg5KSA8PCA4KSksICJpIiAoc2l6ZW9mKHN0cnVjdCBidWdfZW50cnkpKSwgInIi
IChfX3JldF93YXJuX29uKSk7IH0gX19idWlsdGluX2V4cGVjdCghIShfX3JldF93YXJuX29u
KSwgMCk7IH0pOwoKIGlmIChzLT5sZW4gPCBzLT5zaXplKSB7CiAgKmJ1ZnAgPSBzLT5idWZm
ZXIgKyBzLT5sZW47CiAgcmV0dXJuIHMtPnNpemUgLSBzLT5sZW47CiB9CgogKmJ1ZnAgPSAo
KHZvaWQgKikwKTsKIHJldHVybiAwOwp9CiMgMTA0ICIuL2luY2x1ZGUvbGludXgvc2VxX2J1
Zi5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgdm9pZCBzZXFfYnVmX2NvbW1pdChzdHJ1Y3Qgc2VxX2J1ZiAqcywg
aW50IG51bSkKewogaWYgKG51bSA8IDApIHsKICBzZXFfYnVmX3NldF9vdmVyZmxvdyhzKTsK
IH0gZWxzZSB7CgogIGRvIHsgaWYgKF9fYnVpbHRpbl9jb25zdGFudF9wKHMtPmxlbiArIG51
bSA+IHMtPnNpemUpKSB7IGlmIChzLT5sZW4gKyBudW0gPiBzLT5zaXplKSBkbyB7IF9fYXNt
X18gX192b2xhdGlsZV9fKCAiMToJIiAidHdpIDMxLCAwLCAwIiAiXG4iICIuc2VjdGlvbiBf
X2J1Z190YWJsZSxcImF3XCJcbiIgIjI6XHQiICIuOGJ5dGUiICIgIiAiMWIsICUwXG4iICJc
dC5zaG9ydCAlMSwgJTJcbiIgIi5vcmcgMmIrJTNcbiIgIi5wcmV2aW91c1xuIiA6IDogImki
ICgiLi9pbmNsdWRlL2xpbnV4L3NlcV9idWYuaCIpLCAiaSIgKDExMCksICJpIiAoMCksICJp
IiAoc2l6ZW9mKHN0cnVjdCBidWdfZW50cnkpKSk7IGRvIHsgOyBhc20gdm9sYXRpbGUoIiIp
OyBfX2J1aWx0aW5fdW5yZWFjaGFibGUoKTsgfSB3aGlsZSAoMCk7IH0gd2hpbGUgKDApOyB9
IGVsc2UgeyBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CSIgInRkbmVpIiAiICIgIiAlNCwg
MCIgIlxuIiAiLnNlY3Rpb24gX19idWdfdGFibGUsXCJhd1wiXG4iICIyOlx0IiAiLjhieXRl
IiAiICIgIjFiLCAlMFxuIiAiXHQuc2hvcnQgJTEsICUyXG4iICIub3JnIDJiKyUzXG4iICIu
cHJldmlvdXNcbiIgOiA6ICJpIiAoIi4vaW5jbHVkZS9saW51eC9zZXFfYnVmLmgiKSwgImki
ICgxMTApLCAiaSIgKDApLCAiaSIgKHNpemVvZihzdHJ1Y3QgYnVnX2VudHJ5KSksICJyIiAo
KCBsb25nKShzLT5sZW4gKyBudW0gPiBzLT5zaXplKSkpOyB9IH0gd2hpbGUgKDApOwogIHMt
PmxlbiArPSBudW07CiB9Cn0KCmV4dGVybiBfX2F0dHJpYnV0ZV9fKChfX2Zvcm1hdF9fKHBy
aW50ZiwgMiwgMykpKQppbnQgc2VxX2J1Zl9wcmludGYoc3RydWN0IHNlcV9idWYgKnMsIGNv
bnN0IGNoYXIgKmZtdCwgLi4uKTsKZXh0ZXJuIF9fYXR0cmlidXRlX18oKF9fZm9ybWF0X18o
cHJpbnRmLCAyLCAwKSkpCmludCBzZXFfYnVmX3ZwcmludGYoc3RydWN0IHNlcV9idWYgKnMs
IGNvbnN0IGNoYXIgKmZtdCwgdmFfbGlzdCBhcmdzKTsKZXh0ZXJuIGludCBzZXFfYnVmX3By
aW50X3NlcShzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHN0cnVjdCBzZXFfYnVmICpzKTsKZXh0ZXJu
IGludCBzZXFfYnVmX3RvX3VzZXIoc3RydWN0IHNlcV9idWYgKnMsIGNoYXIgKnVidWYsCiAg
ICAgIGludCBjbnQpOwpleHRlcm4gaW50IHNlcV9idWZfcHV0cyhzdHJ1Y3Qgc2VxX2J1ZiAq
cywgY29uc3QgY2hhciAqc3RyKTsKZXh0ZXJuIGludCBzZXFfYnVmX3B1dGMoc3RydWN0IHNl
cV9idWYgKnMsIHVuc2lnbmVkIGNoYXIgYyk7CmV4dGVybiBpbnQgc2VxX2J1Zl9wdXRtZW0o
c3RydWN0IHNlcV9idWYgKnMsIGNvbnN0IHZvaWQgKm1lbSwgdW5zaWduZWQgaW50IGxlbik7
CmV4dGVybiBpbnQgc2VxX2J1Zl9wdXRtZW1faGV4KHN0cnVjdCBzZXFfYnVmICpzLCBjb25z
dCB2b2lkICptZW0sCiAgICAgICAgIHVuc2lnbmVkIGludCBsZW4pOwpleHRlcm4gaW50IHNl
cV9idWZfcGF0aChzdHJ1Y3Qgc2VxX2J1ZiAqcywgY29uc3Qgc3RydWN0IHBhdGggKnBhdGgs
IGNvbnN0IGNoYXIgKmVzYyk7CmV4dGVybiBpbnQgc2VxX2J1Zl9oZXhfZHVtcChzdHJ1Y3Qg
c2VxX2J1ZiAqcywgY29uc3QgY2hhciAqcHJlZml4X3N0ciwKICAgICAgIGludCBwcmVmaXhf
dHlwZSwgaW50IHJvd3NpemUsIGludCBncm91cHNpemUsCiAgICAgICBjb25zdCB2b2lkICpi
dWYsIHNpemVfdCBsZW4sIGJvb2wgYXNjaWkpOwoKCmV4dGVybiBpbnQKc2VxX2J1Zl9icHJp
bnRmKHN0cnVjdCBzZXFfYnVmICpzLCBjb25zdCBjaGFyICpmbXQsIGNvbnN0IHUzMiAqYmlu
YXJ5KTsKIyA2ICIuL2luY2x1ZGUvbGludXgvdHJhY2Vfc2VxLmgiIDIKIyAxNCAiLi9pbmNs
dWRlL2xpbnV4L3RyYWNlX3NlcS5oIgpzdHJ1Y3QgdHJhY2Vfc2VxIHsKIHVuc2lnbmVkIGNo
YXIgYnVmZmVyWygxVUwgPDwgMTIpXTsKIHN0cnVjdCBzZXFfYnVmIHNlcTsKIGludCBmdWxs
Owp9OwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIHZvaWQKdHJhY2Vfc2VxX2luaXQoc3RydWN0IHRyYWNlX3NlcSAq
cykKewogc2VxX2J1Zl9pbml0KCZzLT5zZXEsIHMtPmJ1ZmZlciwgKDFVTCA8PCAxMikpOwog
cy0+ZnVsbCA9IDA7Cn0KIyA0MCAiLi9pbmNsdWRlL2xpbnV4L3RyYWNlX3NlcS5oIgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgaW50IHRyYWNlX3NlcV91c2VkKHN0cnVjdCB0cmFjZV9zZXEgKnMpCnsKIHJldHVy
biBzZXFfYnVmX3VzZWQoJnMtPnNlcSk7Cn0KIyA1NCAiLi9pbmNsdWRlL2xpbnV4L3RyYWNl
X3NlcS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgY2hhciAqCnRyYWNlX3NlcV9idWZmZXJfcHRy
KHN0cnVjdCB0cmFjZV9zZXEgKnMpCnsKIHJldHVybiBzLT5idWZmZXIgKyBzZXFfYnVmX3Vz
ZWQoJnMtPnNlcSk7Cn0KIyA2NyAiLi9pbmNsdWRlL2xpbnV4L3RyYWNlX3NlcS5oIgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgYm9vbCB0cmFjZV9zZXFfaGFzX292ZXJmbG93ZWQoc3RydWN0IHRyYWNlX3NlcSAq
cykKewogcmV0dXJuIHMtPmZ1bGwgfHwgc2VxX2J1Zl9oYXNfb3ZlcmZsb3dlZCgmcy0+c2Vx
KTsKfQoKCgoKCmV4dGVybiBfX2F0dHJpYnV0ZV9fKChfX2Zvcm1hdF9fKHByaW50ZiwgMiwg
MykpKQp2b2lkIHRyYWNlX3NlcV9wcmludGYoc3RydWN0IHRyYWNlX3NlcSAqcywgY29uc3Qg
Y2hhciAqZm10LCAuLi4pOwpleHRlcm4gX19hdHRyaWJ1dGVfXygoX19mb3JtYXRfXyhwcmlu
dGYsIDIsIDApKSkKdm9pZCB0cmFjZV9zZXFfdnByaW50ZihzdHJ1Y3QgdHJhY2Vfc2VxICpz
LCBjb25zdCBjaGFyICpmbXQsIHZhX2xpc3QgYXJncyk7CmV4dGVybiB2b2lkCnRyYWNlX3Nl
cV9icHJpbnRmKHN0cnVjdCB0cmFjZV9zZXEgKnMsIGNvbnN0IGNoYXIgKmZtdCwgY29uc3Qg
dTMyICpiaW5hcnkpOwpleHRlcm4gaW50IHRyYWNlX3ByaW50X3NlcShzdHJ1Y3Qgc2VxX2Zp
bGUgKm0sIHN0cnVjdCB0cmFjZV9zZXEgKnMpOwpleHRlcm4gaW50IHRyYWNlX3NlcV90b191
c2VyKHN0cnVjdCB0cmFjZV9zZXEgKnMsIGNoYXIgKnVidWYsCiAgICAgICAgaW50IGNudCk7
CmV4dGVybiB2b2lkIHRyYWNlX3NlcV9wdXRzKHN0cnVjdCB0cmFjZV9zZXEgKnMsIGNvbnN0
IGNoYXIgKnN0cik7CmV4dGVybiB2b2lkIHRyYWNlX3NlcV9wdXRjKHN0cnVjdCB0cmFjZV9z
ZXEgKnMsIHVuc2lnbmVkIGNoYXIgYyk7CmV4dGVybiB2b2lkIHRyYWNlX3NlcV9wdXRtZW0o
c3RydWN0IHRyYWNlX3NlcSAqcywgY29uc3Qgdm9pZCAqbWVtLCB1bnNpZ25lZCBpbnQgbGVu
KTsKZXh0ZXJuIHZvaWQgdHJhY2Vfc2VxX3B1dG1lbV9oZXgoc3RydWN0IHRyYWNlX3NlcSAq
cywgY29uc3Qgdm9pZCAqbWVtLAogICAgdW5zaWduZWQgaW50IGxlbik7CmV4dGVybiBpbnQg
dHJhY2Vfc2VxX3BhdGgoc3RydWN0IHRyYWNlX3NlcSAqcywgY29uc3Qgc3RydWN0IHBhdGgg
KnBhdGgpOwoKZXh0ZXJuIHZvaWQgdHJhY2Vfc2VxX2JpdG1hc2soc3RydWN0IHRyYWNlX3Nl
cSAqcywgY29uc3QgdW5zaWduZWQgbG9uZyAqbWFza3AsCiAgICAgICAgaW50IG5tYXNrYml0
cyk7CgpleHRlcm4gaW50IHRyYWNlX3NlcV9oZXhfZHVtcChzdHJ1Y3QgdHJhY2Vfc2VxICpz
LCBjb25zdCBjaGFyICpwcmVmaXhfc3RyLAogICAgICAgICBpbnQgcHJlZml4X3R5cGUsIGlu
dCByb3dzaXplLCBpbnQgZ3JvdXBzaXplLAogICAgICAgICBjb25zdCB2b2lkICpidWYsIHNp
emVfdCBsZW4sIGJvb2wgYXNjaWkpOwojIDggIi4vaW5jbHVkZS9saW51eC90cmFjZV9ldmVu
dHMuaCIgMgoKCiMgMSAiLi9pbmNsdWRlL2xpbnV4L3BlcmZfZXZlbnQuaCIgMQojIDE3ICIu
L2luY2x1ZGUvbGludXgvcGVyZl9ldmVudC5oIgojIDEgIi4vaW5jbHVkZS91YXBpL2xpbnV4
L3BlcmZfZXZlbnQuaCIgMQojIDI5ICIuL2luY2x1ZGUvdWFwaS9saW51eC9wZXJmX2V2ZW50
LmgiCmVudW0gcGVyZl90eXBlX2lkIHsKIFBFUkZfVFlQRV9IQVJEV0FSRSA9IDAsCiBQRVJG
X1RZUEVfU09GVFdBUkUgPSAxLAogUEVSRl9UWVBFX1RSQUNFUE9JTlQgPSAyLAogUEVSRl9U
WVBFX0hXX0NBQ0hFID0gMywKIFBFUkZfVFlQRV9SQVcgPSA0LAogUEVSRl9UWVBFX0JSRUFL
UE9JTlQgPSA1LAoKIFBFUkZfVFlQRV9NQVgsCn07CgoKCgoKCmVudW0gcGVyZl9od19pZCB7
CgoKCiBQRVJGX0NPVU5UX0hXX0NQVV9DWUNMRVMgPSAwLAogUEVSRl9DT1VOVF9IV19JTlNU
UlVDVElPTlMgPSAxLAogUEVSRl9DT1VOVF9IV19DQUNIRV9SRUZFUkVOQ0VTID0gMiwKIFBF
UkZfQ09VTlRfSFdfQ0FDSEVfTUlTU0VTID0gMywKIFBFUkZfQ09VTlRfSFdfQlJBTkNIX0lO
U1RSVUNUSU9OUyA9IDQsCiBQRVJGX0NPVU5UX0hXX0JSQU5DSF9NSVNTRVMgPSA1LAogUEVS
Rl9DT1VOVF9IV19CVVNfQ1lDTEVTID0gNiwKIFBFUkZfQ09VTlRfSFdfU1RBTExFRF9DWUNM
RVNfRlJPTlRFTkQgPSA3LAogUEVSRl9DT1VOVF9IV19TVEFMTEVEX0NZQ0xFU19CQUNLRU5E
ID0gOCwKIFBFUkZfQ09VTlRfSFdfUkVGX0NQVV9DWUNMRVMgPSA5LAoKIFBFUkZfQ09VTlRf
SFdfTUFYLAp9OwojIDcwICIuL2luY2x1ZGUvdWFwaS9saW51eC9wZXJmX2V2ZW50LmgiCmVu
dW0gcGVyZl9od19jYWNoZV9pZCB7CiBQRVJGX0NPVU5UX0hXX0NBQ0hFX0wxRCA9IDAsCiBQ
RVJGX0NPVU5UX0hXX0NBQ0hFX0wxSSA9IDEsCiBQRVJGX0NPVU5UX0hXX0NBQ0hFX0xMID0g
MiwKIFBFUkZfQ09VTlRfSFdfQ0FDSEVfRFRMQiA9IDMsCiBQRVJGX0NPVU5UX0hXX0NBQ0hF
X0lUTEIgPSA0LAogUEVSRl9DT1VOVF9IV19DQUNIRV9CUFUgPSA1LAogUEVSRl9DT1VOVF9I
V19DQUNIRV9OT0RFID0gNiwKCiBQRVJGX0NPVU5UX0hXX0NBQ0hFX01BWCwKfTsKCmVudW0g
cGVyZl9od19jYWNoZV9vcF9pZCB7CiBQRVJGX0NPVU5UX0hXX0NBQ0hFX09QX1JFQUQgPSAw
LAogUEVSRl9DT1VOVF9IV19DQUNIRV9PUF9XUklURSA9IDEsCiBQRVJGX0NPVU5UX0hXX0NB
Q0hFX09QX1BSRUZFVENIID0gMiwKCiBQRVJGX0NPVU5UX0hXX0NBQ0hFX09QX01BWCwKfTsK
CmVudW0gcGVyZl9od19jYWNoZV9vcF9yZXN1bHRfaWQgewogUEVSRl9DT1VOVF9IV19DQUNI
RV9SRVNVTFRfQUNDRVNTID0gMCwKIFBFUkZfQ09VTlRfSFdfQ0FDSEVfUkVTVUxUX01JU1Mg
PSAxLAoKIFBFUkZfQ09VTlRfSFdfQ0FDSEVfUkVTVUxUX01BWCwKfTsKCgoKCgoKCmVudW0g
cGVyZl9zd19pZHMgewogUEVSRl9DT1VOVF9TV19DUFVfQ0xPQ0sgPSAwLAogUEVSRl9DT1VO
VF9TV19UQVNLX0NMT0NLID0gMSwKIFBFUkZfQ09VTlRfU1dfUEFHRV9GQVVMVFMgPSAyLAog
UEVSRl9DT1VOVF9TV19DT05URVhUX1NXSVRDSEVTID0gMywKIFBFUkZfQ09VTlRfU1dfQ1BV
X01JR1JBVElPTlMgPSA0LAogUEVSRl9DT1VOVF9TV19QQUdFX0ZBVUxUU19NSU4gPSA1LAog
UEVSRl9DT1VOVF9TV19QQUdFX0ZBVUxUU19NQUogPSA2LAogUEVSRl9DT1VOVF9TV19BTElH
Tk1FTlRfRkFVTFRTID0gNywKIFBFUkZfQ09VTlRfU1dfRU1VTEFUSU9OX0ZBVUxUUyA9IDgs
CiBQRVJGX0NPVU5UX1NXX0RVTU1ZID0gOSwKIFBFUkZfQ09VTlRfU1dfQlBGX09VVFBVVCA9
IDEwLAoKIFBFUkZfQ09VTlRfU1dfTUFYLAp9OwoKCgoKCmVudW0gcGVyZl9ldmVudF9zYW1w
bGVfZm9ybWF0IHsKIFBFUkZfU0FNUExFX0lQID0gMVUgPDwgMCwKIFBFUkZfU0FNUExFX1RJ
RCA9IDFVIDw8IDEsCiBQRVJGX1NBTVBMRV9USU1FID0gMVUgPDwgMiwKIFBFUkZfU0FNUExF
X0FERFIgPSAxVSA8PCAzLAogUEVSRl9TQU1QTEVfUkVBRCA9IDFVIDw8IDQsCiBQRVJGX1NB
TVBMRV9DQUxMQ0hBSU4gPSAxVSA8PCA1LAogUEVSRl9TQU1QTEVfSUQgPSAxVSA8PCA2LAog
UEVSRl9TQU1QTEVfQ1BVID0gMVUgPDwgNywKIFBFUkZfU0FNUExFX1BFUklPRCA9IDFVIDw8
IDgsCiBQRVJGX1NBTVBMRV9TVFJFQU1fSUQgPSAxVSA8PCA5LAogUEVSRl9TQU1QTEVfUkFX
ID0gMVUgPDwgMTAsCiBQRVJGX1NBTVBMRV9CUkFOQ0hfU1RBQ0sgPSAxVSA8PCAxMSwKIFBF
UkZfU0FNUExFX1JFR1NfVVNFUiA9IDFVIDw8IDEyLAogUEVSRl9TQU1QTEVfU1RBQ0tfVVNF
UiA9IDFVIDw8IDEzLAogUEVSRl9TQU1QTEVfV0VJR0hUID0gMVUgPDwgMTQsCiBQRVJGX1NB
TVBMRV9EQVRBX1NSQyA9IDFVIDw8IDE1LAogUEVSRl9TQU1QTEVfSURFTlRJRklFUiA9IDFV
IDw8IDE2LAogUEVSRl9TQU1QTEVfVFJBTlNBQ1RJT04gPSAxVSA8PCAxNywKIFBFUkZfU0FN
UExFX1JFR1NfSU5UUiA9IDFVIDw8IDE4LAogUEVSRl9TQU1QTEVfUEhZU19BRERSID0gMVUg
PDwgMTksCiBQRVJGX1NBTVBMRV9BVVggPSAxVSA8PCAyMCwKIFBFUkZfU0FNUExFX0NHUk9V
UCA9IDFVIDw8IDIxLAoKIFBFUkZfU0FNUExFX01BWCA9IDFVIDw8IDIyLAoKIF9fUEVSRl9T
QU1QTEVfQ0FMTENIQUlOX0VBUkxZID0gMVVMTCA8PCA2MywKfTsKIyAxNjIgIi4vaW5jbHVk
ZS91YXBpL2xpbnV4L3BlcmZfZXZlbnQuaCIKZW51bSBwZXJmX2JyYW5jaF9zYW1wbGVfdHlw
ZV9zaGlmdCB7CiBQRVJGX1NBTVBMRV9CUkFOQ0hfVVNFUl9TSElGVCA9IDAsCiBQRVJGX1NB
TVBMRV9CUkFOQ0hfS0VSTkVMX1NISUZUID0gMSwKIFBFUkZfU0FNUExFX0JSQU5DSF9IVl9T
SElGVCA9IDIsCgogUEVSRl9TQU1QTEVfQlJBTkNIX0FOWV9TSElGVCA9IDMsCiBQRVJGX1NB
TVBMRV9CUkFOQ0hfQU5ZX0NBTExfU0hJRlQgPSA0LAogUEVSRl9TQU1QTEVfQlJBTkNIX0FO
WV9SRVRVUk5fU0hJRlQgPSA1LAogUEVSRl9TQU1QTEVfQlJBTkNIX0lORF9DQUxMX1NISUZU
ID0gNiwKIFBFUkZfU0FNUExFX0JSQU5DSF9BQk9SVF9UWF9TSElGVCA9IDcsCiBQRVJGX1NB
TVBMRV9CUkFOQ0hfSU5fVFhfU0hJRlQgPSA4LAogUEVSRl9TQU1QTEVfQlJBTkNIX05PX1RY
X1NISUZUID0gOSwKIFBFUkZfU0FNUExFX0JSQU5DSF9DT05EX1NISUZUID0gMTAsCgogUEVS
Rl9TQU1QTEVfQlJBTkNIX0NBTExfU1RBQ0tfU0hJRlQgPSAxMSwKIFBFUkZfU0FNUExFX0JS
QU5DSF9JTkRfSlVNUF9TSElGVCA9IDEyLAogUEVSRl9TQU1QTEVfQlJBTkNIX0NBTExfU0hJ
RlQgPSAxMywKCiBQRVJGX1NBTVBMRV9CUkFOQ0hfTk9fRkxBR1NfU0hJRlQgPSAxNCwKIFBF
UkZfU0FNUExFX0JSQU5DSF9OT19DWUNMRVNfU0hJRlQgPSAxNSwKCiBQRVJGX1NBTVBMRV9C
UkFOQ0hfVFlQRV9TQVZFX1NISUZUID0gMTYsCgogUEVSRl9TQU1QTEVfQlJBTkNIX0hXX0lO
REVYX1NISUZUID0gMTcsCgogUEVSRl9TQU1QTEVfQlJBTkNIX01BWF9TSElGVAp9OwoKZW51
bSBwZXJmX2JyYW5jaF9zYW1wbGVfdHlwZSB7CiBQRVJGX1NBTVBMRV9CUkFOQ0hfVVNFUiA9
IDFVIDw8IFBFUkZfU0FNUExFX0JSQU5DSF9VU0VSX1NISUZULAogUEVSRl9TQU1QTEVfQlJB
TkNIX0tFUk5FTCA9IDFVIDw8IFBFUkZfU0FNUExFX0JSQU5DSF9LRVJORUxfU0hJRlQsCiBQ
RVJGX1NBTVBMRV9CUkFOQ0hfSFYgPSAxVSA8PCBQRVJGX1NBTVBMRV9CUkFOQ0hfSFZfU0hJ
RlQsCgogUEVSRl9TQU1QTEVfQlJBTkNIX0FOWSA9IDFVIDw8IFBFUkZfU0FNUExFX0JSQU5D
SF9BTllfU0hJRlQsCiBQRVJGX1NBTVBMRV9CUkFOQ0hfQU5ZX0NBTEwgPSAxVSA8PCBQRVJG
X1NBTVBMRV9CUkFOQ0hfQU5ZX0NBTExfU0hJRlQsCiBQRVJGX1NBTVBMRV9CUkFOQ0hfQU5Z
X1JFVFVSTiA9IDFVIDw8IFBFUkZfU0FNUExFX0JSQU5DSF9BTllfUkVUVVJOX1NISUZULAog
UEVSRl9TQU1QTEVfQlJBTkNIX0lORF9DQUxMID0gMVUgPDwgUEVSRl9TQU1QTEVfQlJBTkNI
X0lORF9DQUxMX1NISUZULAogUEVSRl9TQU1QTEVfQlJBTkNIX0FCT1JUX1RYID0gMVUgPDwg
UEVSRl9TQU1QTEVfQlJBTkNIX0FCT1JUX1RYX1NISUZULAogUEVSRl9TQU1QTEVfQlJBTkNI
X0lOX1RYID0gMVUgPDwgUEVSRl9TQU1QTEVfQlJBTkNIX0lOX1RYX1NISUZULAogUEVSRl9T
QU1QTEVfQlJBTkNIX05PX1RYID0gMVUgPDwgUEVSRl9TQU1QTEVfQlJBTkNIX05PX1RYX1NI
SUZULAogUEVSRl9TQU1QTEVfQlJBTkNIX0NPTkQgPSAxVSA8PCBQRVJGX1NBTVBMRV9CUkFO
Q0hfQ09ORF9TSElGVCwKCiBQRVJGX1NBTVBMRV9CUkFOQ0hfQ0FMTF9TVEFDSyA9IDFVIDw8
IFBFUkZfU0FNUExFX0JSQU5DSF9DQUxMX1NUQUNLX1NISUZULAogUEVSRl9TQU1QTEVfQlJB
TkNIX0lORF9KVU1QID0gMVUgPDwgUEVSRl9TQU1QTEVfQlJBTkNIX0lORF9KVU1QX1NISUZU
LAogUEVSRl9TQU1QTEVfQlJBTkNIX0NBTEwgPSAxVSA8PCBQRVJGX1NBTVBMRV9CUkFOQ0hf
Q0FMTF9TSElGVCwKCiBQRVJGX1NBTVBMRV9CUkFOQ0hfTk9fRkxBR1MgPSAxVSA8PCBQRVJG
X1NBTVBMRV9CUkFOQ0hfTk9fRkxBR1NfU0hJRlQsCiBQRVJGX1NBTVBMRV9CUkFOQ0hfTk9f
Q1lDTEVTID0gMVUgPDwgUEVSRl9TQU1QTEVfQlJBTkNIX05PX0NZQ0xFU19TSElGVCwKCiBQ
RVJGX1NBTVBMRV9CUkFOQ0hfVFlQRV9TQVZFID0KICAxVSA8PCBQRVJGX1NBTVBMRV9CUkFO
Q0hfVFlQRV9TQVZFX1NISUZULAoKIFBFUkZfU0FNUExFX0JSQU5DSF9IV19JTkRFWCA9IDFV
IDw8IFBFUkZfU0FNUExFX0JSQU5DSF9IV19JTkRFWF9TSElGVCwKCiBQRVJGX1NBTVBMRV9C
UkFOQ0hfTUFYID0gMVUgPDwgUEVSRl9TQU1QTEVfQlJBTkNIX01BWF9TSElGVCwKfTsKCgoK
CmVudW0gewogUEVSRl9CUl9VTktOT1dOID0gMCwKIFBFUkZfQlJfQ09ORCA9IDEsCiBQRVJG
X0JSX1VOQ09ORCA9IDIsCiBQRVJGX0JSX0lORCA9IDMsCiBQRVJGX0JSX0NBTEwgPSA0LAog
UEVSRl9CUl9JTkRfQ0FMTCA9IDUsCiBQRVJGX0JSX1JFVCA9IDYsCiBQRVJGX0JSX1NZU0NB
TEwgPSA3LAogUEVSRl9CUl9TWVNSRVQgPSA4LAogUEVSRl9CUl9DT05EX0NBTEwgPSA5LAog
UEVSRl9CUl9DT05EX1JFVCA9IDEwLAogUEVSRl9CUl9NQVgsCn07CiMgMjQ1ICIuL2luY2x1
ZGUvdWFwaS9saW51eC9wZXJmX2V2ZW50LmgiCmVudW0gcGVyZl9zYW1wbGVfcmVnc19hYmkg
ewogUEVSRl9TQU1QTEVfUkVHU19BQklfTk9ORSA9IDAsCiBQRVJGX1NBTVBMRV9SRUdTX0FC
SV8zMiA9IDEsCiBQRVJGX1NBTVBMRV9SRUdTX0FCSV82NCA9IDIsCn07CgoKCgoKZW51bSB7
CiBQRVJGX1RYTl9FTElTSU9OID0gKDEgPDwgMCksCiBQRVJGX1RYTl9UUkFOU0FDVElPTiA9
ICgxIDw8IDEpLAogUEVSRl9UWE5fU1lOQyA9ICgxIDw8IDIpLAogUEVSRl9UWE5fQVNZTkMg
PSAoMSA8PCAzKSwKIFBFUkZfVFhOX1JFVFJZID0gKDEgPDwgNCksCiBQRVJGX1RYTl9DT05G
TElDVCA9ICgxIDw8IDUpLAogUEVSRl9UWE5fQ0FQQUNJVFlfV1JJVEUgPSAoMSA8PCA2KSwK
IFBFUkZfVFhOX0NBUEFDSVRZX1JFQUQgPSAoMSA8PCA3KSwKCiBQRVJGX1RYTl9NQVggPSAo
MSA8PCA4KSwKCgoKIFBFUkZfVFhOX0FCT1JUX01BU0sgPSAoMHhmZmZmZmZmZlVMTCA8PCAz
MiksCiBQRVJGX1RYTl9BQk9SVF9TSElGVCA9IDMyLAp9OwojIDI5MyAiLi9pbmNsdWRlL3Vh
cGkvbGludXgvcGVyZl9ldmVudC5oIgplbnVtIHBlcmZfZXZlbnRfcmVhZF9mb3JtYXQgewog
UEVSRl9GT1JNQVRfVE9UQUxfVElNRV9FTkFCTEVEID0gMVUgPDwgMCwKIFBFUkZfRk9STUFU
X1RPVEFMX1RJTUVfUlVOTklORyA9IDFVIDw8IDEsCiBQRVJGX0ZPUk1BVF9JRCA9IDFVIDw8
IDIsCiBQRVJGX0ZPUk1BVF9HUk9VUCA9IDFVIDw8IDMsCgogUEVSRl9GT1JNQVRfTUFYID0g
MVUgPDwgNCwKfTsKIyAzMTcgIi4vaW5jbHVkZS91YXBpL2xpbnV4L3BlcmZfZXZlbnQuaCIK
c3RydWN0IHBlcmZfZXZlbnRfYXR0ciB7CgoKCgogX191MzIgdHlwZTsKCgoKCiBfX3UzMiBz
aXplOwoKCgoKIF9fdTY0IGNvbmZpZzsKCiB1bmlvbiB7CiAgX191NjQgc2FtcGxlX3Blcmlv
ZDsKICBfX3U2NCBzYW1wbGVfZnJlcTsKIH07CgogX191NjQgc2FtcGxlX3R5cGU7CiBfX3U2
NCByZWFkX2Zvcm1hdDsKCiBfX3U2NCBkaXNhYmxlZCA6IDEsCiAgICBpbmhlcml0IDogMSwK
ICAgIHBpbm5lZCA6IDEsCiAgICBleGNsdXNpdmUgOiAxLAogICAgZXhjbHVkZV91c2VyIDog
MSwKICAgIGV4Y2x1ZGVfa2VybmVsIDogMSwKICAgIGV4Y2x1ZGVfaHYgOiAxLAogICAgZXhj
bHVkZV9pZGxlIDogMSwKICAgIG1tYXAgOiAxLAogICAgY29tbSA6IDEsCiAgICBmcmVxIDog
MSwKICAgIGluaGVyaXRfc3RhdCA6IDEsCiAgICBlbmFibGVfb25fZXhlYyA6IDEsCiAgICB0
YXNrIDogMSwKICAgIHdhdGVybWFyayA6IDEsCiMgMzY3ICIuL2luY2x1ZGUvdWFwaS9saW51
eC9wZXJmX2V2ZW50LmgiCiAgICBwcmVjaXNlX2lwIDogMiwKICAgIG1tYXBfZGF0YSA6IDEs
CiAgICBzYW1wbGVfaWRfYWxsIDogMSwKCiAgICBleGNsdWRlX2hvc3QgOiAxLAogICAgZXhj
bHVkZV9ndWVzdCA6IDEsCgogICAgZXhjbHVkZV9jYWxsY2hhaW5fa2VybmVsIDogMSwKICAg
IGV4Y2x1ZGVfY2FsbGNoYWluX3VzZXIgOiAxLAogICAgbW1hcDIgOiAxLAogICAgY29tbV9l
eGVjIDogMSwKICAgIHVzZV9jbG9ja2lkIDogMSwKICAgIGNvbnRleHRfc3dpdGNoIDogMSwK
ICAgIHdyaXRlX2JhY2t3YXJkIDogMSwKICAgIG5hbWVzcGFjZXMgOiAxLAogICAga3N5bWJv
bCA6IDEsCiAgICBicGZfZXZlbnQgOiAxLAogICAgYXV4X291dHB1dCA6IDEsCiAgICBjZ3Jv
dXAgOiAxLAogICAgX19yZXNlcnZlZF8xIDogMzE7CgogdW5pb24gewogIF9fdTMyIHdha2V1
cF9ldmVudHM7CiAgX191MzIgd2FrZXVwX3dhdGVybWFyazsKIH07CgogX191MzIgYnBfdHlw
ZTsKIHVuaW9uIHsKICBfX3U2NCBicF9hZGRyOwogIF9fdTY0IGtwcm9iZV9mdW5jOwogIF9f
dTY0IHVwcm9iZV9wYXRoOwogIF9fdTY0IGNvbmZpZzE7CiB9OwogdW5pb24gewogIF9fdTY0
IGJwX2xlbjsKICBfX3U2NCBrcHJvYmVfYWRkcjsKICBfX3U2NCBwcm9iZV9vZmZzZXQ7CiAg
X191NjQgY29uZmlnMjsKIH07CiBfX3U2NCBicmFuY2hfc2FtcGxlX3R5cGU7CgoKCgoKIF9f
dTY0IHNhbXBsZV9yZWdzX3VzZXI7CgoKCgogX191MzIgc2FtcGxlX3N0YWNrX3VzZXI7Cgog
X19zMzIgY2xvY2tpZDsKIyA0MjggIi4vaW5jbHVkZS91YXBpL2xpbnV4L3BlcmZfZXZlbnQu
aCIKIF9fdTY0IHNhbXBsZV9yZWdzX2ludHI7CgoKCgogX191MzIgYXV4X3dhdGVybWFyazsK
IF9fdTE2IHNhbXBsZV9tYXhfc3RhY2s7CiBfX3UxNiBfX3Jlc2VydmVkXzI7CiBfX3UzMiBh
dXhfc2FtcGxlX3NpemU7CiBfX3UzMiBfX3Jlc2VydmVkXzM7Cn07CgoKCgoKCnN0cnVjdCBw
ZXJmX2V2ZW50X3F1ZXJ5X2JwZiB7CgoKCiBfX3UzMiBpZHNfbGVuOwoKCgoKIF9fdTMyIHBy
b2dfY250OwoKCgogX191MzIgaWRzWzBdOwp9OwojIDQ3NyAiLi9pbmNsdWRlL3VhcGkvbGlu
dXgvcGVyZl9ldmVudC5oIgplbnVtIHBlcmZfZXZlbnRfaW9jX2ZsYWdzIHsKIFBFUkZfSU9D
X0ZMQUdfR1JPVVAgPSAxVSA8PCAwLAp9OwoKCgoKc3RydWN0IHBlcmZfZXZlbnRfbW1hcF9w
YWdlIHsKIF9fdTMyIHZlcnNpb247CiBfX3UzMiBjb21wYXRfdmVyc2lvbjsKIyA1MjMgIi4v
aW5jbHVkZS91YXBpL2xpbnV4L3BlcmZfZXZlbnQuaCIKIF9fdTMyIGxvY2s7CiBfX3UzMiBp
bmRleDsKIF9fczY0IG9mZnNldDsKIF9fdTY0IHRpbWVfZW5hYmxlZDsKIF9fdTY0IHRpbWVf
cnVubmluZzsKIHVuaW9uIHsKICBfX3U2NCBjYXBhYmlsaXRpZXM7CiAgc3RydWN0IHsKICAg
X191NjQgY2FwX2JpdDAgOiAxLAogICAgY2FwX2JpdDBfaXNfZGVwcmVjYXRlZCA6IDEsCgog
ICAgY2FwX3VzZXJfcmRwbWMgOiAxLAogICAgY2FwX3VzZXJfdGltZSA6IDEsCiAgICBjYXBf
dXNlcl90aW1lX3plcm8gOiAxLAogICAgY2FwX19fX19yZXMgOiA1OTsKICB9OwogfTsKIyA1
NTAgIi4vaW5jbHVkZS91YXBpL2xpbnV4L3BlcmZfZXZlbnQuaCIKIF9fdTE2IHBtY193aWR0
aDsKIyA1NzYgIi4vaW5jbHVkZS91YXBpL2xpbnV4L3BlcmZfZXZlbnQuaCIKIF9fdTE2IHRp
bWVfc2hpZnQ7CiBfX3UzMiB0aW1lX211bHQ7CiBfX3U2NCB0aW1lX29mZnNldDsKIyA1OTUg
Ii4vaW5jbHVkZS91YXBpL2xpbnV4L3BlcmZfZXZlbnQuaCIKIF9fdTY0IHRpbWVfemVybzsK
IF9fdTMyIHNpemU7CgoKCgoKIF9fdTggX19yZXNlcnZlZFsxMTgqOCs0XTsKIyA2MjAgIi4v
aW5jbHVkZS91YXBpL2xpbnV4L3BlcmZfZXZlbnQuaCIKIF9fdTY0IGRhdGFfaGVhZDsKIF9f
dTY0IGRhdGFfdGFpbDsKIF9fdTY0IGRhdGFfb2Zmc2V0OwogX191NjQgZGF0YV9zaXplOwoj
IDYzNiAiLi9pbmNsdWRlL3VhcGkvbGludXgvcGVyZl9ldmVudC5oIgogX191NjQgYXV4X2hl
YWQ7CiBfX3U2NCBhdXhfdGFpbDsKIF9fdTY0IGF1eF9vZmZzZXQ7CiBfX3U2NCBhdXhfc2l6
ZTsKfTsKIyA2OTAgIi4vaW5jbHVkZS91YXBpL2xpbnV4L3BlcmZfZXZlbnQuaCIKc3RydWN0
IHBlcmZfZXZlbnRfaGVhZGVyIHsKIF9fdTMyIHR5cGU7CiBfX3UxNiBtaXNjOwogX191MTYg
c2l6ZTsKfTsKCnN0cnVjdCBwZXJmX25zX2xpbmtfaW5mbyB7CiBfX3U2NCBkZXY7CiBfX3U2
NCBpbm87Cn07CgplbnVtIHsKIE5FVF9OU19JTkRFWCA9IDAsCiBVVFNfTlNfSU5ERVggPSAx
LAogSVBDX05TX0lOREVYID0gMiwKIFBJRF9OU19JTkRFWCA9IDMsCiBVU0VSX05TX0lOREVY
ID0gNCwKIE1OVF9OU19JTkRFWCA9IDUsCiBDR1JPVVBfTlNfSU5ERVggPSA2LAoKIE5SX05B
TUVTUEFDRVMsCn07CgplbnVtIHBlcmZfZXZlbnRfdHlwZSB7CiMgNzU0ICIuL2luY2x1ZGUv
dWFwaS9saW51eC9wZXJmX2V2ZW50LmgiCiBQRVJGX1JFQ09SRF9NTUFQID0gMSwKIyA3NjQg
Ii4vaW5jbHVkZS91YXBpL2xpbnV4L3BlcmZfZXZlbnQuaCIKIFBFUkZfUkVDT1JEX0xPU1Qg
PSAyLAojIDc3NSAiLi9pbmNsdWRlL3VhcGkvbGludXgvcGVyZl9ldmVudC5oIgogUEVSRl9S
RUNPUkRfQ09NTSA9IDMsCiMgNzg2ICIuL2luY2x1ZGUvdWFwaS9saW51eC9wZXJmX2V2ZW50
LmgiCiBQRVJGX1JFQ09SRF9FWElUID0gNCwKIyA3OTcgIi4vaW5jbHVkZS91YXBpL2xpbnV4
L3BlcmZfZXZlbnQuaCIKIFBFUkZfUkVDT1JEX1RIUk9UVExFID0gNSwKIFBFUkZfUkVDT1JE
X1VOVEhST1RUTEUgPSA2LAojIDgwOSAiLi9pbmNsdWRlL3VhcGkvbGludXgvcGVyZl9ldmVu
dC5oIgogUEVSRl9SRUNPUkRfRk9SSyA9IDcsCiMgODIwICIuL2luY2x1ZGUvdWFwaS9saW51
eC9wZXJmX2V2ZW50LmgiCiBQRVJGX1JFQ09SRF9SRUFEID0gOCwKIyA4ODMgIi4vaW5jbHVk
ZS91YXBpL2xpbnV4L3BlcmZfZXZlbnQuaCIKIFBFUkZfUkVDT1JEX1NBTVBMRSA9IDksCiMg
OTA1ICIuL2luY2x1ZGUvdWFwaS9saW51eC9wZXJmX2V2ZW50LmgiCiBQRVJGX1JFQ09SRF9N
TUFQMiA9IDEwLAojIDkxOSAiLi9pbmNsdWRlL3VhcGkvbGludXgvcGVyZl9ldmVudC5oIgog
UEVSRl9SRUNPUkRfQVVYID0gMTEsCiMgOTMxICIuL2luY2x1ZGUvdWFwaS9saW51eC9wZXJm
X2V2ZW50LmgiCiBQRVJGX1JFQ09SRF9JVFJBQ0VfU1RBUlQgPSAxMiwKIyA5NDMgIi4vaW5j
bHVkZS91YXBpL2xpbnV4L3BlcmZfZXZlbnQuaCIKIFBFUkZfUkVDT1JEX0xPU1RfU0FNUExF
UyA9IDEzLAojIDk1NSAiLi9pbmNsdWRlL3VhcGkvbGludXgvcGVyZl9ldmVudC5oIgogUEVS
Rl9SRUNPUkRfU1dJVENIID0gMTQsCiMgOTY5ICIuL2luY2x1ZGUvdWFwaS9saW51eC9wZXJm
X2V2ZW50LmgiCiBQRVJGX1JFQ09SRF9TV0lUQ0hfQ1BVX1dJREUgPSAxNSwKIyA5ODEgIi4v
aW5jbHVkZS91YXBpL2xpbnV4L3BlcmZfZXZlbnQuaCIKIFBFUkZfUkVDT1JEX05BTUVTUEFD
RVMgPSAxNiwKIyA5OTYgIi4vaW5jbHVkZS91YXBpL2xpbnV4L3BlcmZfZXZlbnQuaCIKIFBF
UkZfUkVDT1JEX0tTWU1CT0wgPSAxNywKIyAxMDE1ICIuL2luY2x1ZGUvdWFwaS9saW51eC9w
ZXJmX2V2ZW50LmgiCiBQRVJGX1JFQ09SRF9CUEZfRVZFTlQgPSAxOCwKIyAxMDI1ICIuL2lu
Y2x1ZGUvdWFwaS9saW51eC9wZXJmX2V2ZW50LmgiCiBQRVJGX1JFQ09SRF9DR1JPVVAgPSAx
OSwKCiBQRVJGX1JFQ09SRF9NQVgsCn07CgplbnVtIHBlcmZfcmVjb3JkX2tzeW1ib2xfdHlw
ZSB7CiBQRVJGX1JFQ09SRF9LU1lNQk9MX1RZUEVfVU5LTk9XTiA9IDAsCiBQRVJGX1JFQ09S
RF9LU1lNQk9MX1RZUEVfQlBGID0gMSwKIFBFUkZfUkVDT1JEX0tTWU1CT0xfVFlQRV9NQVgK
fTsKCgoKZW51bSBwZXJmX2JwZl9ldmVudF90eXBlIHsKIFBFUkZfQlBGX0VWRU5UX1VOS05P
V04gPSAwLAogUEVSRl9CUEZfRVZFTlRfUFJPR19MT0FEID0gMSwKIFBFUkZfQlBGX0VWRU5U
X1BST0dfVU5MT0FEID0gMiwKIFBFUkZfQlBGX0VWRU5UX01BWCwKfTsKCgoKCmVudW0gcGVy
Zl9jYWxsY2hhaW5fY29udGV4dCB7CiBQRVJGX0NPTlRFWFRfSFYgPSAoX191NjQpLTMyLAog
UEVSRl9DT05URVhUX0tFUk5FTCA9IChfX3U2NCktMTI4LAogUEVSRl9DT05URVhUX1VTRVIg
PSAoX191NjQpLTUxMiwKCiBQRVJGX0NPTlRFWFRfR1VFU1QgPSAoX191NjQpLTIwNDgsCiBQ
RVJGX0NPTlRFWFRfR1VFU1RfS0VSTkVMID0gKF9fdTY0KS0yMTc2LAogUEVSRl9DT05URVhU
X0dVRVNUX1VTRVIgPSAoX191NjQpLTI1NjAsCgogUEVSRl9DT05URVhUX01BWCA9IChfX3U2
NCktNDA5NSwKfTsKIyAxMDg5ICIuL2luY2x1ZGUvdWFwaS9saW51eC9wZXJmX2V2ZW50Lmgi
CnVuaW9uIHBlcmZfbWVtX2RhdGFfc3JjIHsKIF9fdTY0IHZhbDsKIHN0cnVjdCB7CiAgX191
NjQgbWVtX3JzdmQ6MjQsCiAgIG1lbV9zbm9vcHg6MiwKICAgbWVtX3JlbW90ZToxLAogICBt
ZW1fbHZsX251bTo0LAogICBtZW1fZHRsYjo3LAogICBtZW1fbG9jazoyLAogICBtZW1fc25v
b3A6NSwKICAgbWVtX2x2bDoxNCwKICAgbWVtX29wOjU7CiB9Owp9OwojIDExOTQgIi4vaW5j
bHVkZS91YXBpL2xpbnV4L3BlcmZfZXZlbnQuaCIKc3RydWN0IHBlcmZfYnJhbmNoX2VudHJ5
IHsKIF9fdTY0IGZyb207CiBfX3U2NCB0bzsKIF9fdTY0IG1pc3ByZWQ6MSwKICBwcmVkaWN0
ZWQ6MSwKICBpbl90eDoxLAogIGFib3J0OjEsCiAgY3ljbGVzOjE2LAogIHR5cGU6NCwKICBy
ZXNlcnZlZDo0MDsKfTsKIyAxOCAiLi9pbmNsdWRlL2xpbnV4L3BlcmZfZXZlbnQuaCIgMgoj
IDEgIi4vaW5jbHVkZS91YXBpL2xpbnV4L2JwZl9wZXJmX2V2ZW50LmgiIDEKIyAxMSAiLi9p
bmNsdWRlL3VhcGkvbGludXgvYnBmX3BlcmZfZXZlbnQuaCIKIyAxICIuL2FyY2gvcG93ZXJw
Yy9pbmNsdWRlL3VhcGkvYXNtL2JwZl9wZXJmX2V2ZW50LmgiIDEKCgoKCgoKdHlwZWRlZiBz
dHJ1Y3QgdXNlcl9wdF9yZWdzIGJwZl91c2VyX3B0X3JlZ3NfdDsKIyAxMiAiLi9pbmNsdWRl
L3VhcGkvbGludXgvYnBmX3BlcmZfZXZlbnQuaCIgMgoKc3RydWN0IGJwZl9wZXJmX2V2ZW50
X2RhdGEgewogYnBmX3VzZXJfcHRfcmVnc190IHJlZ3M7CiBfX3U2NCBzYW1wbGVfcGVyaW9k
OwogX191NjQgYWRkcjsKfTsKIyAxOSAiLi9pbmNsdWRlL2xpbnV4L3BlcmZfZXZlbnQuaCIg
MgoKCgoKCgojIDEgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL3BlcmZfZXZlbnQuaCIg
MQojIDE4ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9wZXJmX2V2ZW50LmgiCiMgMSAi
Li9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vcGVyZl9ldmVudF9mc2xfZW1iLmgiIDEKIyAy
MiAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vcGVyZl9ldmVudF9mc2xfZW1iLmgiCnN0
cnVjdCBmc2xfZW1iX3BtdSB7CiBjb25zdCBjaGFyICpuYW1lOwogaW50IG5fY291bnRlcjsK
IyAzNCAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vcGVyZl9ldmVudF9mc2xfZW1iLmgi
CiBpbnQgbl9yZXN0cmljdGVkOwoKCiB1NjQgKCp4bGF0ZV9ldmVudCkodTY0IGV2ZW50X2lk
KTsKCiBpbnQgbl9nZW5lcmljOwogaW50ICpnZW5lcmljX2V2ZW50czsKIGludCAoKmNhY2hl
X2V2ZW50cylbUEVSRl9DT1VOVF9IV19DQUNIRV9NQVhdCiAgICAgICAgICBbUEVSRl9DT1VO
VF9IV19DQUNIRV9PUF9NQVhdCiAgICAgICAgICBbUEVSRl9DT1VOVF9IV19DQUNIRV9SRVNV
TFRfTUFYXTsKfTsKCmludCByZWdpc3Rlcl9mc2xfZW1iX3BtdShzdHJ1Y3QgZnNsX2VtYl9w
bXUgKik7CiMgMTkgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL3BlcmZfZXZlbnQuaCIg
MgojIDQwICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9wZXJmX2V2ZW50LmgiCmV4dGVy
biBib29sIGlzX3NpZXJfYXZhaWxhYmxlKHZvaWQpOwojIDI2ICIuL2luY2x1ZGUvbGludXgv
cGVyZl9ldmVudC5oIiAyCiMgMSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9nZW5lcmF0ZWQv
YXNtL2xvY2FsNjQuaCIgMQojIDEgIi4vaW5jbHVkZS9hc20tZ2VuZXJpYy9sb2NhbDY0Lmgi
IDEKIyAyMiAiLi9pbmNsdWRlL2FzbS1nZW5lcmljL2xvY2FsNjQuaCIKIyAxICIuL2FyY2gv
cG93ZXJwYy9pbmNsdWRlL2FzbS9sb2NhbC5oIiAxCiMgMTQ0ICIuL2FyY2gvcG93ZXJwYy9p
bmNsdWRlL2FzbS9sb2NhbC5oIgojIDEgIi4vaW5jbHVkZS9hc20tZ2VuZXJpYy9sb2NhbC5o
IiAxCiMgMjIgIi4vaW5jbHVkZS9hc20tZ2VuZXJpYy9sb2NhbC5oIgp0eXBlZGVmIHN0cnVj
dAp7CiBhdG9taWNfbG9uZ190IGE7Cn0gbG9jYWxfdDsKIyAxNDUgIi4vYXJjaC9wb3dlcnBj
L2luY2x1ZGUvYXNtL2xvY2FsLmgiIDIKIyAyMyAiLi9pbmNsdWRlL2FzbS1nZW5lcmljL2xv
Y2FsNjQuaCIgMgoKdHlwZWRlZiBzdHJ1Y3QgewogbG9jYWxfdCBhOwp9IGxvY2FsNjRfdDsK
IyAxICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2dlbmVyYXRlZC9hc20vbG9jYWw2NC5oIiAy
CiMgMjcgIi4vaW5jbHVkZS9saW51eC9wZXJmX2V2ZW50LmgiIDIKCgpzdHJ1Y3QgcGVyZl9n
dWVzdF9pbmZvX2NhbGxiYWNrcyB7CiBpbnQgKCppc19pbl9ndWVzdCkodm9pZCk7CiBpbnQg
KCppc191c2VyX21vZGUpKHZvaWQpOwogdW5zaWduZWQgbG9uZyAoKmdldF9ndWVzdF9pcCko
dm9pZCk7CiB2b2lkICgqaGFuZGxlX2ludGVsX3B0X2ludHIpKHZvaWQpOwp9OwojIDQ5ICIu
L2luY2x1ZGUvbGludXgvcGVyZl9ldmVudC5oIgojIDEgIi4vaW5jbHVkZS9saW51eC9mdHJh
Y2UuaCIgMQojIDEwICIuL2luY2x1ZGUvbGludXgvZnRyYWNlLmgiCiMgMSAiLi9pbmNsdWRl
L2xpbnV4L3RyYWNlX2Nsb2NrLmgiIDEKIyAxNiAiLi9pbmNsdWRlL2xpbnV4L3RyYWNlX2Ns
b2NrLmgiCiMgMSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vdHJhY2VfY2xvY2suaCIg
MQojIDEzICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS90cmFjZV9jbG9jay5oIgpleHRl
cm4gdTY0IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdHJh
Y2VfY2xvY2tfcHBjX3RiKHZvaWQpOwojIDE3ICIuL2luY2x1ZGUvbGludXgvdHJhY2VfY2xv
Y2suaCIgMgoKZXh0ZXJuIHU2NCBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIHRyYWNlX2Nsb2NrX2xvY2FsKHZvaWQpOwpleHRlcm4gdTY0IF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdHJhY2VfY2xvY2sodm9pZCk7
CmV4dGVybiB1NjQgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSB0cmFjZV9jbG9ja19qaWZmaWVzKHZvaWQpOwpleHRlcm4gdTY0IF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdHJhY2VfY2xvY2tfZ2xvYmFsKHZvaWQp
OwpleHRlcm4gdTY0IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgdHJhY2VfY2xvY2tfY291bnRlcih2b2lkKTsKIyAxMSAiLi9pbmNsdWRlL2xpbnV4L2Z0
cmFjZS5oIiAyCiMgMSAiLi9pbmNsdWRlL2xpbnV4L2thbGxzeW1zLmgiIDEKIyAxMyAiLi9p
bmNsdWRlL2xpbnV4L2thbGxzeW1zLmgiCiMgMSAiLi9pbmNsdWRlL2xpbnV4L21vZHVsZS5o
IiAxCiMgMTYgIi4vaW5jbHVkZS9saW51eC9tb2R1bGUuaCIKIyAxICIuL2luY2x1ZGUvbGlu
dXgva21vZC5oIiAxCiMgOSAiLi9pbmNsdWRlL2xpbnV4L2ttb2QuaCIKIyAxICIuL2luY2x1
ZGUvbGludXgvdW1oLmgiIDEKIyAxMSAiLi9pbmNsdWRlL2xpbnV4L3VtaC5oIgpzdHJ1Y3Qg
Y3JlZDsKc3RydWN0IGZpbGU7CgoKCgoKCnN0cnVjdCBzdWJwcm9jZXNzX2luZm8gewogc3Ry
dWN0IHdvcmtfc3RydWN0IHdvcms7CiBzdHJ1Y3QgY29tcGxldGlvbiAqY29tcGxldGU7CiBj
b25zdCBjaGFyICpwYXRoOwogY2hhciAqKmFyZ3Y7CiBjaGFyICoqZW52cDsKIHN0cnVjdCBm
aWxlICpmaWxlOwogaW50IHdhaXQ7CiBpbnQgcmV0dmFsOwogcGlkX3QgcGlkOwogaW50ICgq
aW5pdCkoc3RydWN0IHN1YnByb2Nlc3NfaW5mbyAqaW5mbywgc3RydWN0IGNyZWQgKm5ldyk7
CiB2b2lkICgqY2xlYW51cCkoc3RydWN0IHN1YnByb2Nlc3NfaW5mbyAqaW5mbyk7CiB2b2lk
ICpkYXRhOwp9IDsKCmV4dGVybiBpbnQKY2FsbF91c2VybW9kZWhlbHBlcihjb25zdCBjaGFy
ICpwYXRoLCBjaGFyICoqYXJndiwgY2hhciAqKmVudnAsIGludCB3YWl0KTsKCmV4dGVybiBz
dHJ1Y3Qgc3VicHJvY2Vzc19pbmZvICoKY2FsbF91c2VybW9kZWhlbHBlcl9zZXR1cChjb25z
dCBjaGFyICpwYXRoLCBjaGFyICoqYXJndiwgY2hhciAqKmVudnAsCiAgICAgZ2ZwX3QgZ2Zw
X21hc2ssCiAgICAgaW50ICgqaW5pdCkoc3RydWN0IHN1YnByb2Nlc3NfaW5mbyAqaW5mbywg
c3RydWN0IGNyZWQgKm5ldyksCiAgICAgdm9pZCAoKmNsZWFudXApKHN0cnVjdCBzdWJwcm9j
ZXNzX2luZm8gKiksIHZvaWQgKmRhdGEpOwoKc3RydWN0IHN1YnByb2Nlc3NfaW5mbyAqY2Fs
bF91c2VybW9kZWhlbHBlcl9zZXR1cF9maWxlKHN0cnVjdCBmaWxlICpmaWxlLAogICAgIGlu
dCAoKmluaXQpKHN0cnVjdCBzdWJwcm9jZXNzX2luZm8gKmluZm8sIHN0cnVjdCBjcmVkICpu
ZXcpLAogICAgIHZvaWQgKCpjbGVhbnVwKShzdHJ1Y3Qgc3VicHJvY2Vzc19pbmZvICopLCB2
b2lkICpkYXRhKTsKc3RydWN0IHVtaF9pbmZvIHsKIGNvbnN0IGNoYXIgKmNtZGxpbmU7CiBz
dHJ1Y3QgZmlsZSAqcGlwZV90b191bWg7CiBzdHJ1Y3QgZmlsZSAqcGlwZV9mcm9tX3VtaDsK
IHN0cnVjdCBsaXN0X2hlYWQgbGlzdDsKIHZvaWQgKCpjbGVhbnVwKShzdHJ1Y3QgdW1oX2lu
Zm8gKmluZm8pOwogcGlkX3QgcGlkOwp9OwppbnQgZm9ya191c2VybW9kZV9ibG9iKHZvaWQg
KmRhdGEsIHNpemVfdCBsZW4sIHN0cnVjdCB1bWhfaW5mbyAqaW5mbyk7CgpleHRlcm4gaW50
CmNhbGxfdXNlcm1vZGVoZWxwZXJfZXhlYyhzdHJ1Y3Qgc3VicHJvY2Vzc19pbmZvICppbmZv
LCBpbnQgd2FpdCk7CgpleHRlcm4gc3RydWN0IGN0bF90YWJsZSB1c2VybW9kZWhlbHBlcl90
YWJsZVtdOwoKZW51bSB1bWhfZGlzYWJsZV9kZXB0aCB7CiBVTUhfRU5BQkxFRCA9IDAsCiBV
TUhfRlJFRVpJTkcsCiBVTUhfRElTQUJMRUQsCn07CgpleHRlcm4gaW50IF9fdXNlcm1vZGVo
ZWxwZXJfZGlzYWJsZShlbnVtIHVtaF9kaXNhYmxlX2RlcHRoIGRlcHRoKTsKZXh0ZXJuIHZv
aWQgX191c2VybW9kZWhlbHBlcl9zZXRfZGlzYWJsZV9kZXB0aChlbnVtIHVtaF9kaXNhYmxl
X2RlcHRoIGRlcHRoKTsKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgdXNlcm1vZGVoZWxwZXJfZGlzYWJsZSh2
b2lkKQp7CiByZXR1cm4gX191c2VybW9kZWhlbHBlcl9kaXNhYmxlKFVNSF9ESVNBQkxFRCk7
Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSB2b2lkIHVzZXJtb2RlaGVscGVyX2VuYWJsZSh2b2lkKQp7CiBfX3Vz
ZXJtb2RlaGVscGVyX3NldF9kaXNhYmxlX2RlcHRoKFVNSF9FTkFCTEVEKTsKfQoKZXh0ZXJu
IGludCB1c2VybW9kZWhlbHBlcl9yZWFkX3RyeWxvY2sodm9pZCk7CmV4dGVybiBsb25nIHVz
ZXJtb2RlaGVscGVyX3JlYWRfbG9ja193YWl0KGxvbmcgdGltZW91dCk7CmV4dGVybiB2b2lk
IHVzZXJtb2RlaGVscGVyX3JlYWRfdW5sb2NrKHZvaWQpOwojIDEwICIuL2luY2x1ZGUvbGlu
dXgva21vZC5oIiAyCiMgMjAgIi4vaW5jbHVkZS9saW51eC9rbW9kLmgiCmV4dGVybiBjaGFy
IG1vZHByb2JlX3BhdGhbXTsKCgpleHRlcm4gX19hdHRyaWJ1dGVfXygoX19mb3JtYXRfXyhw
cmludGYsIDIsIDMpKSkKaW50IF9fcmVxdWVzdF9tb2R1bGUoYm9vbCB3YWl0LCBjb25zdCBj
aGFyICpuYW1lLCAuLi4pOwojIDE3ICIuL2luY2x1ZGUvbGludXgvbW9kdWxlLmgiIDIKCgoK
CiMgMSAiLi9pbmNsdWRlL2xpbnV4L21vZHVsZXBhcmFtLmgiIDEKIyAzNiAiLi9pbmNsdWRl
L2xpbnV4L21vZHVsZXBhcmFtLmgiCnN0cnVjdCBrZXJuZWxfcGFyYW07CgoKCgoKCmVudW0g
ewogS0VSTkVMX1BBUkFNX09QU19GTF9OT0FSRyA9ICgxIDw8IDApCn07CgpzdHJ1Y3Qga2Vy
bmVsX3BhcmFtX29wcyB7CgogdW5zaWduZWQgaW50IGZsYWdzOwoKIGludCAoKnNldCkoY29u
c3QgY2hhciAqdmFsLCBjb25zdCBzdHJ1Y3Qga2VybmVsX3BhcmFtICprcCk7CgogaW50ICgq
Z2V0KShjaGFyICpidWZmZXIsIGNvbnN0IHN0cnVjdCBrZXJuZWxfcGFyYW0gKmtwKTsKCiB2
b2lkICgqZnJlZSkodm9pZCAqYXJnKTsKfTsKCgoKCgoKCmVudW0gewogS0VSTkVMX1BBUkFN
X0ZMX1VOU0FGRSA9ICgxIDw8IDApLAogS0VSTkVMX1BBUkFNX0ZMX0hXUEFSQU0gPSAoMSA8
PCAxKSwKfTsKCnN0cnVjdCBrZXJuZWxfcGFyYW0gewogY29uc3QgY2hhciAqbmFtZTsKIHN0
cnVjdCBtb2R1bGUgKm1vZDsKIGNvbnN0IHN0cnVjdCBrZXJuZWxfcGFyYW1fb3BzICpvcHM7
CiBjb25zdCB1MTYgcGVybTsKIHM4IGxldmVsOwogdTggZmxhZ3M7CiB1bmlvbiB7CiAgdm9p
ZCAqYXJnOwogIGNvbnN0IHN0cnVjdCBrcGFyYW1fc3RyaW5nICpzdHI7CiAgY29uc3Qgc3Ry
dWN0IGtwYXJhbV9hcnJheSAqYXJyOwogfTsKfTsKCmV4dGVybiBjb25zdCBzdHJ1Y3Qga2Vy
bmVsX3BhcmFtIF9fc3RhcnRfX19wYXJhbVtdLCBfX3N0b3BfX19wYXJhbVtdOwoKCnN0cnVj
dCBrcGFyYW1fc3RyaW5nIHsKIHVuc2lnbmVkIGludCBtYXhsZW47CiBjaGFyICpzdHJpbmc7
Cn07CgoKc3RydWN0IGtwYXJhbV9hcnJheQp7CiB1bnNpZ25lZCBpbnQgbWF4OwogdW5zaWdu
ZWQgaW50IGVsZW1zaXplOwogdW5zaWduZWQgaW50ICpudW07CiBjb25zdCBzdHJ1Y3Qga2Vy
bmVsX3BhcmFtX29wcyAqb3BzOwogdm9pZCAqZWxlbTsKfTsKIyAzMDQgIi4vaW5jbHVkZS9s
aW51eC9tb2R1bGVwYXJhbS5oIgpleHRlcm4gdm9pZCBrZXJuZWxfcGFyYW1fbG9jayhzdHJ1
Y3QgbW9kdWxlICptb2QpOwpleHRlcm4gdm9pZCBrZXJuZWxfcGFyYW1fdW5sb2NrKHN0cnVj
dCBtb2R1bGUgKm1vZCk7CiMgMzcyICIuL2luY2x1ZGUvbGludXgvbW9kdWxlcGFyYW0uaCIK
ZXh0ZXJuIGJvb2wgcGFyYW1lcShjb25zdCBjaGFyICpuYW1lMSwgY29uc3QgY2hhciAqbmFt
ZTIpOwojIDM4MiAiLi9pbmNsdWRlL2xpbnV4L21vZHVsZXBhcmFtLmgiCmV4dGVybiBib29s
IHBhcmFtZXFuKGNvbnN0IGNoYXIgKm5hbWUxLCBjb25zdCBjaGFyICpuYW1lMiwgc2l6ZV90
IG4pOwoKCmV4dGVybiBjaGFyICpwYXJzZV9hcmdzKGNvbnN0IGNoYXIgKm5hbWUsCiAgICAg
ICAgY2hhciAqYXJncywKICAgICAgICBjb25zdCBzdHJ1Y3Qga2VybmVsX3BhcmFtICpwYXJh
bXMsCiAgICAgICAgdW5zaWduZWQgbnVtLAogICAgICAgIHMxNiBsZXZlbF9taW4sCiAgICAg
ICAgczE2IGxldmVsX21heCwKICAgICAgICB2b2lkICphcmcsCiAgICAgICAgaW50ICgqdW5r
bm93bikoY2hhciAqcGFyYW0sIGNoYXIgKnZhbCwKICAgICAgICAgY29uc3QgY2hhciAqZG9p
bmcsIHZvaWQgKmFyZykpOwoKCgpleHRlcm4gdm9pZCBkZXN0cm95X3BhcmFtcyhjb25zdCBz
dHJ1Y3Qga2VybmVsX3BhcmFtICpwYXJhbXMsIHVuc2lnbmVkIG51bSk7CiMgNDExICIuL2lu
Y2x1ZGUvbGludXgvbW9kdWxlcGFyYW0uaCIKZXh0ZXJuIGNvbnN0IHN0cnVjdCBrZXJuZWxf
cGFyYW1fb3BzIHBhcmFtX29wc19ieXRlOwpleHRlcm4gaW50IHBhcmFtX3NldF9ieXRlKGNv
bnN0IGNoYXIgKnZhbCwgY29uc3Qgc3RydWN0IGtlcm5lbF9wYXJhbSAqa3ApOwpleHRlcm4g
aW50IHBhcmFtX2dldF9ieXRlKGNoYXIgKmJ1ZmZlciwgY29uc3Qgc3RydWN0IGtlcm5lbF9w
YXJhbSAqa3ApOwoKCmV4dGVybiBjb25zdCBzdHJ1Y3Qga2VybmVsX3BhcmFtX29wcyBwYXJh
bV9vcHNfc2hvcnQ7CmV4dGVybiBpbnQgcGFyYW1fc2V0X3Nob3J0KGNvbnN0IGNoYXIgKnZh
bCwgY29uc3Qgc3RydWN0IGtlcm5lbF9wYXJhbSAqa3ApOwpleHRlcm4gaW50IHBhcmFtX2dl
dF9zaG9ydChjaGFyICpidWZmZXIsIGNvbnN0IHN0cnVjdCBrZXJuZWxfcGFyYW0gKmtwKTsK
CgpleHRlcm4gY29uc3Qgc3RydWN0IGtlcm5lbF9wYXJhbV9vcHMgcGFyYW1fb3BzX3VzaG9y
dDsKZXh0ZXJuIGludCBwYXJhbV9zZXRfdXNob3J0KGNvbnN0IGNoYXIgKnZhbCwgY29uc3Qg
c3RydWN0IGtlcm5lbF9wYXJhbSAqa3ApOwpleHRlcm4gaW50IHBhcmFtX2dldF91c2hvcnQo
Y2hhciAqYnVmZmVyLCBjb25zdCBzdHJ1Y3Qga2VybmVsX3BhcmFtICprcCk7CgoKZXh0ZXJu
IGNvbnN0IHN0cnVjdCBrZXJuZWxfcGFyYW1fb3BzIHBhcmFtX29wc19pbnQ7CmV4dGVybiBp
bnQgcGFyYW1fc2V0X2ludChjb25zdCBjaGFyICp2YWwsIGNvbnN0IHN0cnVjdCBrZXJuZWxf
cGFyYW0gKmtwKTsKZXh0ZXJuIGludCBwYXJhbV9nZXRfaW50KGNoYXIgKmJ1ZmZlciwgY29u
c3Qgc3RydWN0IGtlcm5lbF9wYXJhbSAqa3ApOwoKCmV4dGVybiBjb25zdCBzdHJ1Y3Qga2Vy
bmVsX3BhcmFtX29wcyBwYXJhbV9vcHNfdWludDsKZXh0ZXJuIGludCBwYXJhbV9zZXRfdWlu
dChjb25zdCBjaGFyICp2YWwsIGNvbnN0IHN0cnVjdCBrZXJuZWxfcGFyYW0gKmtwKTsKZXh0
ZXJuIGludCBwYXJhbV9nZXRfdWludChjaGFyICpidWZmZXIsIGNvbnN0IHN0cnVjdCBrZXJu
ZWxfcGFyYW0gKmtwKTsKCgpleHRlcm4gY29uc3Qgc3RydWN0IGtlcm5lbF9wYXJhbV9vcHMg
cGFyYW1fb3BzX2xvbmc7CmV4dGVybiBpbnQgcGFyYW1fc2V0X2xvbmcoY29uc3QgY2hhciAq
dmFsLCBjb25zdCBzdHJ1Y3Qga2VybmVsX3BhcmFtICprcCk7CmV4dGVybiBpbnQgcGFyYW1f
Z2V0X2xvbmcoY2hhciAqYnVmZmVyLCBjb25zdCBzdHJ1Y3Qga2VybmVsX3BhcmFtICprcCk7
CgoKZXh0ZXJuIGNvbnN0IHN0cnVjdCBrZXJuZWxfcGFyYW1fb3BzIHBhcmFtX29wc191bG9u
ZzsKZXh0ZXJuIGludCBwYXJhbV9zZXRfdWxvbmcoY29uc3QgY2hhciAqdmFsLCBjb25zdCBz
dHJ1Y3Qga2VybmVsX3BhcmFtICprcCk7CmV4dGVybiBpbnQgcGFyYW1fZ2V0X3Vsb25nKGNo
YXIgKmJ1ZmZlciwgY29uc3Qgc3RydWN0IGtlcm5lbF9wYXJhbSAqa3ApOwoKCmV4dGVybiBj
b25zdCBzdHJ1Y3Qga2VybmVsX3BhcmFtX29wcyBwYXJhbV9vcHNfdWxsb25nOwpleHRlcm4g
aW50IHBhcmFtX3NldF91bGxvbmcoY29uc3QgY2hhciAqdmFsLCBjb25zdCBzdHJ1Y3Qga2Vy
bmVsX3BhcmFtICprcCk7CmV4dGVybiBpbnQgcGFyYW1fZ2V0X3VsbG9uZyhjaGFyICpidWZm
ZXIsIGNvbnN0IHN0cnVjdCBrZXJuZWxfcGFyYW0gKmtwKTsKCgpleHRlcm4gY29uc3Qgc3Ry
dWN0IGtlcm5lbF9wYXJhbV9vcHMgcGFyYW1fb3BzX2NoYXJwOwpleHRlcm4gaW50IHBhcmFt
X3NldF9jaGFycChjb25zdCBjaGFyICp2YWwsIGNvbnN0IHN0cnVjdCBrZXJuZWxfcGFyYW0g
KmtwKTsKZXh0ZXJuIGludCBwYXJhbV9nZXRfY2hhcnAoY2hhciAqYnVmZmVyLCBjb25zdCBz
dHJ1Y3Qga2VybmVsX3BhcmFtICprcCk7CmV4dGVybiB2b2lkIHBhcmFtX2ZyZWVfY2hhcnAo
dm9pZCAqYXJnKTsKCgoKZXh0ZXJuIGNvbnN0IHN0cnVjdCBrZXJuZWxfcGFyYW1fb3BzIHBh
cmFtX29wc19ib29sOwpleHRlcm4gaW50IHBhcmFtX3NldF9ib29sKGNvbnN0IGNoYXIgKnZh
bCwgY29uc3Qgc3RydWN0IGtlcm5lbF9wYXJhbSAqa3ApOwpleHRlcm4gaW50IHBhcmFtX2dl
dF9ib29sKGNoYXIgKmJ1ZmZlciwgY29uc3Qgc3RydWN0IGtlcm5lbF9wYXJhbSAqa3ApOwoK
CmV4dGVybiBjb25zdCBzdHJ1Y3Qga2VybmVsX3BhcmFtX29wcyBwYXJhbV9vcHNfYm9vbF9l
bmFibGVfb25seTsKZXh0ZXJuIGludCBwYXJhbV9zZXRfYm9vbF9lbmFibGVfb25seShjb25z
dCBjaGFyICp2YWwsCiAgICAgICAgICBjb25zdCBzdHJ1Y3Qga2VybmVsX3BhcmFtICprcCk7
CgoKCmV4dGVybiBjb25zdCBzdHJ1Y3Qga2VybmVsX3BhcmFtX29wcyBwYXJhbV9vcHNfaW52
Ym9vbDsKZXh0ZXJuIGludCBwYXJhbV9zZXRfaW52Ym9vbChjb25zdCBjaGFyICp2YWwsIGNv
bnN0IHN0cnVjdCBrZXJuZWxfcGFyYW0gKmtwKTsKZXh0ZXJuIGludCBwYXJhbV9nZXRfaW52
Ym9vbChjaGFyICpidWZmZXIsIGNvbnN0IHN0cnVjdCBrZXJuZWxfcGFyYW0gKmtwKTsKCgoK
ZXh0ZXJuIGNvbnN0IHN0cnVjdCBrZXJuZWxfcGFyYW1fb3BzIHBhcmFtX29wc19iaW50Owpl
eHRlcm4gaW50IHBhcmFtX3NldF9iaW50KGNvbnN0IGNoYXIgKnZhbCwgY29uc3Qgc3RydWN0
IGtlcm5lbF9wYXJhbSAqa3ApOwojIDUxOSAiLi9pbmNsdWRlL2xpbnV4L21vZHVsZXBhcmFt
LmgiCmVudW0gaHdwYXJhbV90eXBlIHsKIGh3cGFyYW1faW9wb3J0LAogaHdwYXJhbV9pb21l
bSwKIGh3cGFyYW1faW9wb3J0X29yX2lvbWVtLAogaHdwYXJhbV9pcnEsCiBod3BhcmFtX2Rt
YSwKIGh3cGFyYW1fZG1hX2FkZHIsCiBod3BhcmFtX290aGVyLAp9OwojIDU4MCAiLi9pbmNs
dWRlL2xpbnV4L21vZHVsZXBhcmFtLmgiCmV4dGVybiBjb25zdCBzdHJ1Y3Qga2VybmVsX3Bh
cmFtX29wcyBwYXJhbV9hcnJheV9vcHM7CgpleHRlcm4gY29uc3Qgc3RydWN0IGtlcm5lbF9w
YXJhbV9vcHMgcGFyYW1fb3BzX3N0cmluZzsKZXh0ZXJuIGludCBwYXJhbV9zZXRfY29weXN0
cmluZyhjb25zdCBjaGFyICp2YWwsIGNvbnN0IHN0cnVjdCBrZXJuZWxfcGFyYW0gKik7CmV4
dGVybiBpbnQgcGFyYW1fZ2V0X3N0cmluZyhjaGFyICpidWZmZXIsIGNvbnN0IHN0cnVjdCBr
ZXJuZWxfcGFyYW0gKmtwKTsKCgoKc3RydWN0IG1vZHVsZTsKCgpleHRlcm4gaW50IG1vZHVs
ZV9wYXJhbV9zeXNmc19zZXR1cChzdHJ1Y3QgbW9kdWxlICptb2QsCiAgICAgICAgY29uc3Qg
c3RydWN0IGtlcm5lbF9wYXJhbSAqa3BhcmFtLAogICAgICAgIHVuc2lnbmVkIGludCBudW1f
cGFyYW1zKTsKCmV4dGVybiB2b2lkIG1vZHVsZV9wYXJhbV9zeXNmc19yZW1vdmUoc3RydWN0
IG1vZHVsZSAqbW9kKTsKIyAyMiAiLi9pbmNsdWRlL2xpbnV4L21vZHVsZS5oIiAyCgoKIyAx
ICIuL2luY2x1ZGUvbGludXgvcmJ0cmVlX2xhdGNoLmgiIDEKIyA0MCAiLi9pbmNsdWRlL2xp
bnV4L3JidHJlZV9sYXRjaC5oIgpzdHJ1Y3QgbGF0Y2hfdHJlZV9ub2RlIHsKIHN0cnVjdCBy
Yl9ub2RlIG5vZGVbMl07Cn07CgpzdHJ1Y3QgbGF0Y2hfdHJlZV9yb290IHsKIHNlcWNvdW50
X3Qgc2VxOwogc3RydWN0IHJiX3Jvb3QgdHJlZVsyXTsKfTsKIyA2NCAiLi9pbmNsdWRlL2xp
bnV4L3JidHJlZV9sYXRjaC5oIgpzdHJ1Y3QgbGF0Y2hfdHJlZV9vcHMgewogYm9vbCAoKmxl
c3MpKHN0cnVjdCBsYXRjaF90cmVlX25vZGUgKmEsIHN0cnVjdCBsYXRjaF90cmVlX25vZGUg
KmIpOwogaW50ICgqY29tcCkodm9pZCAqa2V5LCBzdHJ1Y3QgbGF0Y2hfdHJlZV9ub2RlICpi
KTsKfTsKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHN0
cnVjdCBsYXRjaF90cmVlX25vZGUgKgpfX2x0X2Zyb21fcmIoc3RydWN0IHJiX25vZGUgKm5v
ZGUsIGludCBpZHgpCnsKIHJldHVybiAoeyB2b2lkICpfX21wdHIgPSAodm9pZCAqKShub2Rl
KTsgZG8geyBleHRlcm4gdm9pZCBfX2NvbXBpbGV0aW1lX2Fzc2VydF8xOTgodm9pZCkgX19h
dHRyaWJ1dGVfXygoX19lcnJvcl9fKCJwb2ludGVyIHR5cGUgbWlzbWF0Y2ggaW4gY29udGFp
bmVyX29mKCkiKSkpOyBpZiAoISghKCFfX2J1aWx0aW5fdHlwZXNfY29tcGF0aWJsZV9wKHR5
cGVvZigqKG5vZGUpKSwgdHlwZW9mKCgoc3RydWN0IGxhdGNoX3RyZWVfbm9kZSAqKTApLT5u
b2RlW2lkeF0pKSAmJiAhX19idWlsdGluX3R5cGVzX2NvbXBhdGlibGVfcCh0eXBlb2YoKihu
b2RlKSksIHR5cGVvZih2b2lkKSkpKSkgX19jb21waWxldGltZV9hc3NlcnRfMTk4KCk7IH0g
d2hpbGUgKDApOyAoKHN0cnVjdCBsYXRjaF90cmVlX25vZGUgKikoX19tcHRyIC0gX19idWls
dGluX29mZnNldG9mKHN0cnVjdCBsYXRjaF90cmVlX25vZGUsIG5vZGVbaWR4XSkpKTsgfSk7
Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHZvaWQK
X19sdF9pbnNlcnQoc3RydWN0IGxhdGNoX3RyZWVfbm9kZSAqbHRuLCBzdHJ1Y3QgbGF0Y2hf
dHJlZV9yb290ICpsdHIsIGludCBpZHgsCiAgICAgYm9vbCAoKmxlc3MpKHN0cnVjdCBsYXRj
aF90cmVlX25vZGUgKmEsIHN0cnVjdCBsYXRjaF90cmVlX25vZGUgKmIpKQp7CiBzdHJ1Y3Qg
cmJfcm9vdCAqcm9vdCA9ICZsdHItPnRyZWVbaWR4XTsKIHN0cnVjdCByYl9ub2RlICoqbGlu
ayA9ICZyb290LT5yYl9ub2RlOwogc3RydWN0IHJiX25vZGUgKm5vZGUgPSAmbHRuLT5ub2Rl
W2lkeF07CiBzdHJ1Y3QgcmJfbm9kZSAqcGFyZW50ID0gKCh2b2lkICopMCk7CiBzdHJ1Y3Qg
bGF0Y2hfdHJlZV9ub2RlICpsdHA7Cgogd2hpbGUgKCpsaW5rKSB7CiAgcGFyZW50ID0gKmxp
bms7CiAgbHRwID0gX19sdF9mcm9tX3JiKHBhcmVudCwgaWR4KTsKCiAgaWYgKGxlc3MobHRu
LCBsdHApKQogICBsaW5rID0gJnBhcmVudC0+cmJfbGVmdDsKICBlbHNlCiAgIGxpbmsgPSAm
cGFyZW50LT5yYl9yaWdodDsKIH0KCiByYl9saW5rX25vZGVfcmN1KG5vZGUsIHBhcmVudCwg
bGluayk7CiByYl9pbnNlcnRfY29sb3Iobm9kZSwgcm9vdCk7Cn0KCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0
dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHZvaWQKX19sdF9lcmFzZShzdHJ1Y3Qg
bGF0Y2hfdHJlZV9ub2RlICpsdG4sIHN0cnVjdCBsYXRjaF90cmVlX3Jvb3QgKmx0ciwgaW50
IGlkeCkKewogcmJfZXJhc2UoJmx0bi0+bm9kZVtpZHhdLCAmbHRyLT50cmVlW2lkeF0pOwp9
CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBzdHJ1Y3Qg
bGF0Y2hfdHJlZV9ub2RlICoKX19sdF9maW5kKHZvaWQgKmtleSwgc3RydWN0IGxhdGNoX3Ry
ZWVfcm9vdCAqbHRyLCBpbnQgaWR4LAogICBpbnQgKCpjb21wKSh2b2lkICprZXksIHN0cnVj
dCBsYXRjaF90cmVlX25vZGUgKm5vZGUpKQp7CiBzdHJ1Y3QgcmJfbm9kZSAqbm9kZSA9ICh7
IHR5cGVvZihsdHItPnRyZWVbaWR4XS5yYl9ub2RlKSBfX19fX19fX3AxID0gKHsgZG8geyBl
eHRlcm4gdm9pZCBfX2NvbXBpbGV0aW1lX2Fzc2VydF8xOTkodm9pZCkgX19hdHRyaWJ1dGVf
XygoX19lcnJvcl9fKCJVbnN1cHBvcnRlZCBhY2Nlc3Mgc2l6ZSBmb3Ige1JFQUQsV1JJVEV9
X09OQ0UoKS4iKSkpOyBpZiAoISgoc2l6ZW9mKGx0ci0+dHJlZVtpZHhdLnJiX25vZGUpID09
IHNpemVvZihjaGFyKSB8fCBzaXplb2YobHRyLT50cmVlW2lkeF0ucmJfbm9kZSkgPT0gc2l6
ZW9mKHNob3J0KSB8fCBzaXplb2YobHRyLT50cmVlW2lkeF0ucmJfbm9kZSkgPT0gc2l6ZW9m
KGludCkgfHwgc2l6ZW9mKGx0ci0+dHJlZVtpZHhdLnJiX25vZGUpID09IHNpemVvZihsb25n
KSkgfHwgc2l6ZW9mKGx0ci0+dHJlZVtpZHhdLnJiX25vZGUpID09IHNpemVvZihsb25nIGxv
bmcpKSkgX19jb21waWxldGltZV9hc3NlcnRfMTk5KCk7IH0gd2hpbGUgKDApOyAoeyB0eXBl
b2YoIF9HZW5lcmljKChsdHItPnRyZWVbaWR4XS5yYl9ub2RlKSwgY2hhcjogKGNoYXIpMCwg
dW5zaWduZWQgY2hhcjogKHVuc2lnbmVkIGNoYXIpMCwgc2lnbmVkIGNoYXI6IChzaWduZWQg
Y2hhcikwLCB1bnNpZ25lZCBzaG9ydDogKHVuc2lnbmVkIHNob3J0KTAsIHNpZ25lZCBzaG9y
dDogKHNpZ25lZCBzaG9ydCkwLCB1bnNpZ25lZCBpbnQ6ICh1bnNpZ25lZCBpbnQpMCwgc2ln
bmVkIGludDogKHNpZ25lZCBpbnQpMCwgdW5zaWduZWQgbG9uZzogKHVuc2lnbmVkIGxvbmcp
MCwgc2lnbmVkIGxvbmc6IChzaWduZWQgbG9uZykwLCB1bnNpZ25lZCBsb25nIGxvbmc6ICh1
bnNpZ25lZCBsb25nIGxvbmcpMCwgc2lnbmVkIGxvbmcgbG9uZzogKHNpZ25lZCBsb25nIGxv
bmcpMCwgZGVmYXVsdDogKGx0ci0+dHJlZVtpZHhdLnJiX25vZGUpKSkgX194ID0gKCooY29u
c3Qgdm9sYXRpbGUgdHlwZW9mKCBfR2VuZXJpYygobHRyLT50cmVlW2lkeF0ucmJfbm9kZSks
IGNoYXI6IChjaGFyKTAsIHVuc2lnbmVkIGNoYXI6ICh1bnNpZ25lZCBjaGFyKTAsIHNpZ25l
ZCBjaGFyOiAoc2lnbmVkIGNoYXIpMCwgdW5zaWduZWQgc2hvcnQ6ICh1bnNpZ25lZCBzaG9y
dCkwLCBzaWduZWQgc2hvcnQ6IChzaWduZWQgc2hvcnQpMCwgdW5zaWduZWQgaW50OiAodW5z
aWduZWQgaW50KTAsIHNpZ25lZCBpbnQ6IChzaWduZWQgaW50KTAsIHVuc2lnbmVkIGxvbmc6
ICh1bnNpZ25lZCBsb25nKTAsIHNpZ25lZCBsb25nOiAoc2lnbmVkIGxvbmcpMCwgdW5zaWdu
ZWQgbG9uZyBsb25nOiAodW5zaWduZWQgbG9uZyBsb25nKTAsIHNpZ25lZCBsb25nIGxvbmc6
IChzaWduZWQgbG9uZyBsb25nKTAsIGRlZmF1bHQ6IChsdHItPnRyZWVbaWR4XS5yYl9ub2Rl
KSkpICopJihsdHItPnRyZWVbaWR4XS5yYl9ub2RlKSk7IGRvIHsgfSB3aGlsZSAoMCk7ICh0
eXBlb2YobHRyLT50cmVlW2lkeF0ucmJfbm9kZSkpX194OyB9KTsgfSk7ICgodHlwZW9mKCps
dHItPnRyZWVbaWR4XS5yYl9ub2RlKSAqKShfX19fX19fX3AxKSk7IH0pOwogc3RydWN0IGxh
dGNoX3RyZWVfbm9kZSAqbHRuOwogaW50IGM7Cgogd2hpbGUgKG5vZGUpIHsKICBsdG4gPSBf
X2x0X2Zyb21fcmIobm9kZSwgaWR4KTsKICBjID0gY29tcChrZXksIGx0bik7CgogIGlmIChj
IDwgMCkKICAgbm9kZSA9ICh7IHR5cGVvZihub2RlLT5yYl9sZWZ0KSBfX19fX19fX3AxID0g
KHsgZG8geyBleHRlcm4gdm9pZCBfX2NvbXBpbGV0aW1lX2Fzc2VydF8yMDAodm9pZCkgX19h
dHRyaWJ1dGVfXygoX19lcnJvcl9fKCJVbnN1cHBvcnRlZCBhY2Nlc3Mgc2l6ZSBmb3Ige1JF
QUQsV1JJVEV9X09OQ0UoKS4iKSkpOyBpZiAoISgoc2l6ZW9mKG5vZGUtPnJiX2xlZnQpID09
IHNpemVvZihjaGFyKSB8fCBzaXplb2Yobm9kZS0+cmJfbGVmdCkgPT0gc2l6ZW9mKHNob3J0
KSB8fCBzaXplb2Yobm9kZS0+cmJfbGVmdCkgPT0gc2l6ZW9mKGludCkgfHwgc2l6ZW9mKG5v
ZGUtPnJiX2xlZnQpID09IHNpemVvZihsb25nKSkgfHwgc2l6ZW9mKG5vZGUtPnJiX2xlZnQp
ID09IHNpemVvZihsb25nIGxvbmcpKSkgX19jb21waWxldGltZV9hc3NlcnRfMjAwKCk7IH0g
d2hpbGUgKDApOyAoeyB0eXBlb2YoIF9HZW5lcmljKChub2RlLT5yYl9sZWZ0KSwgY2hhcjog
KGNoYXIpMCwgdW5zaWduZWQgY2hhcjogKHVuc2lnbmVkIGNoYXIpMCwgc2lnbmVkIGNoYXI6
IChzaWduZWQgY2hhcikwLCB1bnNpZ25lZCBzaG9ydDogKHVuc2lnbmVkIHNob3J0KTAsIHNp
Z25lZCBzaG9ydDogKHNpZ25lZCBzaG9ydCkwLCB1bnNpZ25lZCBpbnQ6ICh1bnNpZ25lZCBp
bnQpMCwgc2lnbmVkIGludDogKHNpZ25lZCBpbnQpMCwgdW5zaWduZWQgbG9uZzogKHVuc2ln
bmVkIGxvbmcpMCwgc2lnbmVkIGxvbmc6IChzaWduZWQgbG9uZykwLCB1bnNpZ25lZCBsb25n
IGxvbmc6ICh1bnNpZ25lZCBsb25nIGxvbmcpMCwgc2lnbmVkIGxvbmcgbG9uZzogKHNpZ25l
ZCBsb25nIGxvbmcpMCwgZGVmYXVsdDogKG5vZGUtPnJiX2xlZnQpKSkgX194ID0gKCooY29u
c3Qgdm9sYXRpbGUgdHlwZW9mKCBfR2VuZXJpYygobm9kZS0+cmJfbGVmdCksIGNoYXI6IChj
aGFyKTAsIHVuc2lnbmVkIGNoYXI6ICh1bnNpZ25lZCBjaGFyKTAsIHNpZ25lZCBjaGFyOiAo
c2lnbmVkIGNoYXIpMCwgdW5zaWduZWQgc2hvcnQ6ICh1bnNpZ25lZCBzaG9ydCkwLCBzaWdu
ZWQgc2hvcnQ6IChzaWduZWQgc2hvcnQpMCwgdW5zaWduZWQgaW50OiAodW5zaWduZWQgaW50
KTAsIHNpZ25lZCBpbnQ6IChzaWduZWQgaW50KTAsIHVuc2lnbmVkIGxvbmc6ICh1bnNpZ25l
ZCBsb25nKTAsIHNpZ25lZCBsb25nOiAoc2lnbmVkIGxvbmcpMCwgdW5zaWduZWQgbG9uZyBs
b25nOiAodW5zaWduZWQgbG9uZyBsb25nKTAsIHNpZ25lZCBsb25nIGxvbmc6IChzaWduZWQg
bG9uZyBsb25nKTAsIGRlZmF1bHQ6IChub2RlLT5yYl9sZWZ0KSkpICopJihub2RlLT5yYl9s
ZWZ0KSk7IGRvIHsgfSB3aGlsZSAoMCk7ICh0eXBlb2Yobm9kZS0+cmJfbGVmdCkpX194OyB9
KTsgfSk7ICgodHlwZW9mKCpub2RlLT5yYl9sZWZ0KSAqKShfX19fX19fX3AxKSk7IH0pOwog
IGVsc2UgaWYgKGMgPiAwKQogICBub2RlID0gKHsgdHlwZW9mKG5vZGUtPnJiX3JpZ2h0KSBf
X19fX19fX3AxID0gKHsgZG8geyBleHRlcm4gdm9pZCBfX2NvbXBpbGV0aW1lX2Fzc2VydF8y
MDEodm9pZCkgX19hdHRyaWJ1dGVfXygoX19lcnJvcl9fKCJVbnN1cHBvcnRlZCBhY2Nlc3Mg
c2l6ZSBmb3Ige1JFQUQsV1JJVEV9X09OQ0UoKS4iKSkpOyBpZiAoISgoc2l6ZW9mKG5vZGUt
PnJiX3JpZ2h0KSA9PSBzaXplb2YoY2hhcikgfHwgc2l6ZW9mKG5vZGUtPnJiX3JpZ2h0KSA9
PSBzaXplb2Yoc2hvcnQpIHx8IHNpemVvZihub2RlLT5yYl9yaWdodCkgPT0gc2l6ZW9mKGlu
dCkgfHwgc2l6ZW9mKG5vZGUtPnJiX3JpZ2h0KSA9PSBzaXplb2YobG9uZykpIHx8IHNpemVv
Zihub2RlLT5yYl9yaWdodCkgPT0gc2l6ZW9mKGxvbmcgbG9uZykpKSBfX2NvbXBpbGV0aW1l
X2Fzc2VydF8yMDEoKTsgfSB3aGlsZSAoMCk7ICh7IHR5cGVvZiggX0dlbmVyaWMoKG5vZGUt
PnJiX3JpZ2h0KSwgY2hhcjogKGNoYXIpMCwgdW5zaWduZWQgY2hhcjogKHVuc2lnbmVkIGNo
YXIpMCwgc2lnbmVkIGNoYXI6IChzaWduZWQgY2hhcikwLCB1bnNpZ25lZCBzaG9ydDogKHVu
c2lnbmVkIHNob3J0KTAsIHNpZ25lZCBzaG9ydDogKHNpZ25lZCBzaG9ydCkwLCB1bnNpZ25l
ZCBpbnQ6ICh1bnNpZ25lZCBpbnQpMCwgc2lnbmVkIGludDogKHNpZ25lZCBpbnQpMCwgdW5z
aWduZWQgbG9uZzogKHVuc2lnbmVkIGxvbmcpMCwgc2lnbmVkIGxvbmc6IChzaWduZWQgbG9u
ZykwLCB1bnNpZ25lZCBsb25nIGxvbmc6ICh1bnNpZ25lZCBsb25nIGxvbmcpMCwgc2lnbmVk
IGxvbmcgbG9uZzogKHNpZ25lZCBsb25nIGxvbmcpMCwgZGVmYXVsdDogKG5vZGUtPnJiX3Jp
Z2h0KSkpIF9feCA9ICgqKGNvbnN0IHZvbGF0aWxlIHR5cGVvZiggX0dlbmVyaWMoKG5vZGUt
PnJiX3JpZ2h0KSwgY2hhcjogKGNoYXIpMCwgdW5zaWduZWQgY2hhcjogKHVuc2lnbmVkIGNo
YXIpMCwgc2lnbmVkIGNoYXI6IChzaWduZWQgY2hhcikwLCB1bnNpZ25lZCBzaG9ydDogKHVu
c2lnbmVkIHNob3J0KTAsIHNpZ25lZCBzaG9ydDogKHNpZ25lZCBzaG9ydCkwLCB1bnNpZ25l
ZCBpbnQ6ICh1bnNpZ25lZCBpbnQpMCwgc2lnbmVkIGludDogKHNpZ25lZCBpbnQpMCwgdW5z
aWduZWQgbG9uZzogKHVuc2lnbmVkIGxvbmcpMCwgc2lnbmVkIGxvbmc6IChzaWduZWQgbG9u
ZykwLCB1bnNpZ25lZCBsb25nIGxvbmc6ICh1bnNpZ25lZCBsb25nIGxvbmcpMCwgc2lnbmVk
IGxvbmcgbG9uZzogKHNpZ25lZCBsb25nIGxvbmcpMCwgZGVmYXVsdDogKG5vZGUtPnJiX3Jp
Z2h0KSkpICopJihub2RlLT5yYl9yaWdodCkpOyBkbyB7IH0gd2hpbGUgKDApOyAodHlwZW9m
KG5vZGUtPnJiX3JpZ2h0KSlfX3g7IH0pOyB9KTsgKCh0eXBlb2YoKm5vZGUtPnJiX3JpZ2h0
KSAqKShfX19fX19fX3AxKSk7IH0pOwogIGVsc2UKICAgcmV0dXJuIGx0bjsKIH0KCiByZXR1
cm4gKCh2b2lkICopMCk7Cn0KIyAxNDMgIi4vaW5jbHVkZS9saW51eC9yYnRyZWVfbGF0Y2gu
aCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgdm9pZAps
YXRjaF90cmVlX2luc2VydChzdHJ1Y3QgbGF0Y2hfdHJlZV9ub2RlICpub2RlLAogICAgc3Ry
dWN0IGxhdGNoX3RyZWVfcm9vdCAqcm9vdCwKICAgIGNvbnN0IHN0cnVjdCBsYXRjaF90cmVl
X29wcyAqb3BzKQp7CiByYXdfd3JpdGVfc2VxY291bnRfbGF0Y2goJnJvb3QtPnNlcSk7CiBf
X2x0X2luc2VydChub2RlLCByb290LCAwLCBvcHMtPmxlc3MpOwogcmF3X3dyaXRlX3NlcWNv
dW50X2xhdGNoKCZyb290LT5zZXEpOwogX19sdF9pbnNlcnQobm9kZSwgcm9vdCwgMSwgb3Bz
LT5sZXNzKTsKfQojIDE3MCAiLi9pbmNsdWRlL2xpbnV4L3JidHJlZV9sYXRjaC5oIgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB2b2lkCmxhdGNoX3Ry
ZWVfZXJhc2Uoc3RydWN0IGxhdGNoX3RyZWVfbm9kZSAqbm9kZSwKICAgc3RydWN0IGxhdGNo
X3RyZWVfcm9vdCAqcm9vdCwKICAgY29uc3Qgc3RydWN0IGxhdGNoX3RyZWVfb3BzICpvcHMp
CnsKIHJhd193cml0ZV9zZXFjb3VudF9sYXRjaCgmcm9vdC0+c2VxKTsKIF9fbHRfZXJhc2Uo
bm9kZSwgcm9vdCwgMCk7CiByYXdfd3JpdGVfc2VxY291bnRfbGF0Y2goJnJvb3QtPnNlcSk7
CiBfX2x0X2VyYXNlKG5vZGUsIHJvb3QsIDEpOwp9CiMgMTk5ICIuL2luY2x1ZGUvbGludXgv
cmJ0cmVlX2xhdGNoLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxp
bmVfXykpIHN0cnVjdCBsYXRjaF90cmVlX25vZGUgKgpsYXRjaF90cmVlX2ZpbmQodm9pZCAq
a2V5LCBzdHJ1Y3QgbGF0Y2hfdHJlZV9yb290ICpyb290LAogIGNvbnN0IHN0cnVjdCBsYXRj
aF90cmVlX29wcyAqb3BzKQp7CiBzdHJ1Y3QgbGF0Y2hfdHJlZV9ub2RlICpub2RlOwogdW5z
aWduZWQgaW50IHNlcTsKCiBkbyB7CiAgc2VxID0gcmF3X3JlYWRfc2VxY291bnRfbGF0Y2go
JnJvb3QtPnNlcSk7CiAgbm9kZSA9IF9fbHRfZmluZChrZXksIHJvb3QsIHNlcSAmIDEsIG9w
cy0+Y29tcCk7CiB9IHdoaWxlIChyZWFkX3NlcWNvdW50X3JldHJ5KCZyb290LT5zZXEsIHNl
cSkpOwoKIHJldHVybiBub2RlOwp9CiMgMjUgIi4vaW5jbHVkZS9saW51eC9tb2R1bGUuaCIg
MgojIDEgIi4vaW5jbHVkZS9saW51eC9lcnJvci1pbmplY3Rpb24uaCIgMQoKCgoKCiMgMSAi
Li9pbmNsdWRlL2FzbS1nZW5lcmljL2Vycm9yLWluamVjdGlvbi5oIiAxCgoKCgoKZW51bSB7
CiBFSV9FVFlQRV9OT05FLAogRUlfRVRZUEVfTlVMTCwKIEVJX0VUWVBFX0VSUk5PLAogRUlf
RVRZUEVfRVJSTk9fTlVMTCwKIEVJX0VUWVBFX1RSVUUsCn07CgpzdHJ1Y3QgZXJyb3JfaW5q
ZWN0aW9uX2VudHJ5IHsKIHVuc2lnbmVkIGxvbmcgYWRkcjsKIGludCBldHlwZTsKfTsKCnN0
cnVjdCBwdF9yZWdzOwojIDM4ICIuL2luY2x1ZGUvYXNtLWdlbmVyaWMvZXJyb3ItaW5qZWN0
aW9uLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSB2b2lkIG92ZXJyaWRlX2Z1bmN0aW9uX3dpdGhfcmV0dXJuKHN0
cnVjdCBwdF9yZWdzICpyZWdzKSB7IH0KIyA3ICIuL2luY2x1ZGUvbGludXgvZXJyb3ItaW5q
ZWN0aW9uLmgiIDIKIyAxNSAiLi9pbmNsdWRlL2xpbnV4L2Vycm9yLWluamVjdGlvbi5oIgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgYm9vbCB3aXRoaW5fZXJyb3JfaW5qZWN0aW9uX2xpc3QodW5zaWduZWQgbG9u
ZyBhZGRyKQp7CiByZXR1cm4gZmFsc2U7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgZ2V0X2luamVjdGFi
bGVfZXJyb3JfdHlwZSh1bnNpZ25lZCBsb25nIGFkZHIpCnsKIHJldHVybiBFSV9FVFlQRV9O
T05FOwp9CiMgMjYgIi4vaW5jbHVkZS9saW51eC9tb2R1bGUuaCIgMgoKCgoKIyAxICIuL2Fy
Y2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9tb2R1bGUuaCIgMQoKCgoKCgoKIyAxICIuL2luY2x1
ZGUvYXNtLWdlbmVyaWMvbW9kdWxlLmgiIDEKIyA5ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRl
L2FzbS9tb2R1bGUuaCIgMgojIDI3ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9tb2R1
bGUuaCIKc3RydWN0IG1vZF9hcmNoX3NwZWNpZmljIHsKCiB1bnNpZ25lZCBpbnQgc3R1YnNf
c2VjdGlvbjsKIHVuc2lnbmVkIGludCB0b2Nfc2VjdGlvbjsKIGJvb2wgdG9jX2ZpeGVkOwoK
CiB1bnNpZ25lZCBsb25nIHN0YXJ0X29wZDsKIHVuc2lnbmVkIGxvbmcgZW5kX29wZDsKIyA1
MCAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vbW9kdWxlLmgiCiBzdHJ1Y3QgbGlzdF9o
ZWFkIGJ1Z19saXN0Owogc3RydWN0IGJ1Z19lbnRyeSAqYnVnX3RhYmxlOwogdW5zaWduZWQg
aW50IG51bV9idWdzOwp9OwojIDgwICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9tb2R1
bGUuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIGludCBtb2R1bGVfZmluYWxpemVfZnRyYWNlKHN0cnVjdCBtb2R1
bGUgKm1vZCwgY29uc3QgRWxmNjRfU2hkciAqc2VjaGRycykKewogcmV0dXJuIDA7Cn0KIyAz
MSAiLi9pbmNsdWRlL2xpbnV4L21vZHVsZS5oIiAyCgoKCgoKCnN0cnVjdCBtb2R2ZXJzaW9u
X2luZm8gewogdW5zaWduZWQgbG9uZyBjcmM7CiBjaGFyIG5hbWVbKDY0IC0gc2l6ZW9mKHVu
c2lnbmVkIGxvbmcpKV07Cn07CgpzdHJ1Y3QgbW9kdWxlOwpzdHJ1Y3QgZXhjZXB0aW9uX3Rh
YmxlX2VudHJ5OwoKc3RydWN0IG1vZHVsZV9rb2JqZWN0IHsKIHN0cnVjdCBrb2JqZWN0IGtv
Ymo7CiBzdHJ1Y3QgbW9kdWxlICptb2Q7CiBzdHJ1Y3Qga29iamVjdCAqZHJpdmVyc19kaXI7
CiBzdHJ1Y3QgbW9kdWxlX3BhcmFtX2F0dHJzICptcDsKIHN0cnVjdCBjb21wbGV0aW9uICpr
b2JqX2NvbXBsZXRpb247Cn0gOwoKc3RydWN0IG1vZHVsZV9hdHRyaWJ1dGUgewogc3RydWN0
IGF0dHJpYnV0ZSBhdHRyOwogc3NpemVfdCAoKnNob3cpKHN0cnVjdCBtb2R1bGVfYXR0cmli
dXRlICosIHN0cnVjdCBtb2R1bGVfa29iamVjdCAqLAogICBjaGFyICopOwogc3NpemVfdCAo
KnN0b3JlKShzdHJ1Y3QgbW9kdWxlX2F0dHJpYnV0ZSAqLCBzdHJ1Y3QgbW9kdWxlX2tvYmpl
Y3QgKiwKICAgIGNvbnN0IGNoYXIgKiwgc2l6ZV90IGNvdW50KTsKIHZvaWQgKCpzZXR1cCko
c3RydWN0IG1vZHVsZSAqLCBjb25zdCBjaGFyICopOwogaW50ICgqdGVzdCkoc3RydWN0IG1v
ZHVsZSAqKTsKIHZvaWQgKCpmcmVlKShzdHJ1Y3QgbW9kdWxlICopOwp9OwoKc3RydWN0IG1v
ZHVsZV92ZXJzaW9uX2F0dHJpYnV0ZSB7CiBzdHJ1Y3QgbW9kdWxlX2F0dHJpYnV0ZSBtYXR0
cjsKIGNvbnN0IGNoYXIgKm1vZHVsZV9uYW1lOwogY29uc3QgY2hhciAqdmVyc2lvbjsKfSBf
X2F0dHJpYnV0ZV9fICgoX19hbGlnbmVkX18oc2l6ZW9mKHZvaWQgKikpKSk7CgpleHRlcm4g
c3NpemVfdCBfX21vZHZlcl92ZXJzaW9uX3Nob3coc3RydWN0IG1vZHVsZV9hdHRyaWJ1dGUg
KiwKICAgICAgICAgc3RydWN0IG1vZHVsZV9rb2JqZWN0ICosIGNoYXIgKik7CgpleHRlcm4g
c3RydWN0IG1vZHVsZV9hdHRyaWJ1dGUgbW9kdWxlX3VldmVudDsKCgpleHRlcm4gaW50IGlu
aXRfbW9kdWxlKHZvaWQpOwpleHRlcm4gdm9pZCBjbGVhbnVwX21vZHVsZSh2b2lkKTsKIyAy
OTEgIi4vaW5jbHVkZS9saW51eC9tb2R1bGUuaCIKc3RydWN0IG5vdGlmaWVyX2Jsb2NrOwoK
CgpleHRlcm4gaW50IG1vZHVsZXNfZGlzYWJsZWQ7Cgp2b2lkICpfX3N5bWJvbF9nZXQoY29u
c3QgY2hhciAqc3ltYm9sKTsKdm9pZCAqX19zeW1ib2xfZ2V0X2dwbChjb25zdCBjaGFyICpz
eW1ib2wpOwoKCgpzdHJ1Y3QgbW9kdWxlX3VzZSB7CiBzdHJ1Y3QgbGlzdF9oZWFkIHNvdXJj
ZV9saXN0Owogc3RydWN0IGxpc3RfaGVhZCB0YXJnZXRfbGlzdDsKIHN0cnVjdCBtb2R1bGUg
KnNvdXJjZSwgKnRhcmdldDsKfTsKCmVudW0gbW9kdWxlX3N0YXRlIHsKIE1PRFVMRV9TVEFU
RV9MSVZFLAogTU9EVUxFX1NUQVRFX0NPTUlORywKIE1PRFVMRV9TVEFURV9HT0lORywKIE1P
RFVMRV9TVEFURV9VTkZPUk1FRCwKfTsKCnN0cnVjdCBtb2RfdHJlZV9ub2RlIHsKIHN0cnVj
dCBtb2R1bGUgKm1vZDsKIHN0cnVjdCBsYXRjaF90cmVlX25vZGUgbm9kZTsKfTsKCnN0cnVj
dCBtb2R1bGVfbGF5b3V0IHsKCiB2b2lkICpiYXNlOwoKIHVuc2lnbmVkIGludCBzaXplOwoK
IHVuc2lnbmVkIGludCB0ZXh0X3NpemU7CgogdW5zaWduZWQgaW50IHJvX3NpemU7CgogdW5z
aWduZWQgaW50IHJvX2FmdGVyX2luaXRfc2l6ZTsKCgogc3RydWN0IG1vZF90cmVlX25vZGUg
bXRuOwoKfTsKIyAzNDQgIi4vaW5jbHVkZS9saW51eC9tb2R1bGUuaCIKc3RydWN0IG1vZF9r
YWxsc3ltcyB7CiBFbGY2NF9TeW0gKnN5bXRhYjsKIHVuc2lnbmVkIGludCBudW1fc3ltdGFi
OwogY2hhciAqc3RydGFiOwogY2hhciAqdHlwZXRhYjsKfTsKIyAzNjAgIi4vaW5jbHVkZS9s
aW51eC9tb2R1bGUuaCIKc3RydWN0IG1vZHVsZSB7CiBlbnVtIG1vZHVsZV9zdGF0ZSBzdGF0
ZTsKCgogc3RydWN0IGxpc3RfaGVhZCBsaXN0OwoKCiBjaGFyIG5hbWVbKDY0IC0gc2l6ZW9m
KHVuc2lnbmVkIGxvbmcpKV07CgoKIHN0cnVjdCBtb2R1bGVfa29iamVjdCBta29iajsKIHN0
cnVjdCBtb2R1bGVfYXR0cmlidXRlICptb2RpbmZvX2F0dHJzOwogY29uc3QgY2hhciAqdmVy
c2lvbjsKIGNvbnN0IGNoYXIgKnNyY3ZlcnNpb247CiBzdHJ1Y3Qga29iamVjdCAqaG9sZGVy
c19kaXI7CgoKIGNvbnN0IHN0cnVjdCBrZXJuZWxfc3ltYm9sICpzeW1zOwogY29uc3QgczMy
ICpjcmNzOwogdW5zaWduZWQgaW50IG51bV9zeW1zOwoKCgogc3RydWN0IG11dGV4IHBhcmFt
X2xvY2s7Cgogc3RydWN0IGtlcm5lbF9wYXJhbSAqa3A7CiB1bnNpZ25lZCBpbnQgbnVtX2tw
OwoKCiB1bnNpZ25lZCBpbnQgbnVtX2dwbF9zeW1zOwogY29uc3Qgc3RydWN0IGtlcm5lbF9z
eW1ib2wgKmdwbF9zeW1zOwogY29uc3QgczMyICpncGxfY3JjczsKIyA0MTAgIi4vaW5jbHVk
ZS9saW51eC9tb2R1bGUuaCIKIGJvb2wgYXN5bmNfcHJvYmVfcmVxdWVzdGVkOwoKCiBjb25z
dCBzdHJ1Y3Qga2VybmVsX3N5bWJvbCAqZ3BsX2Z1dHVyZV9zeW1zOwogY29uc3QgczMyICpn
cGxfZnV0dXJlX2NyY3M7CiB1bnNpZ25lZCBpbnQgbnVtX2dwbF9mdXR1cmVfc3ltczsKCgog
dW5zaWduZWQgaW50IG51bV9leGVudHJpZXM7CiBzdHJ1Y3QgZXhjZXB0aW9uX3RhYmxlX2Vu
dHJ5ICpleHRhYmxlOwoKCiBpbnQgKCppbml0KSh2b2lkKTsKCgogc3RydWN0IG1vZHVsZV9s
YXlvdXQgY29yZV9sYXlvdXQgX19hdHRyaWJ1dGVfXygoX19hbGlnbmVkX18oKDEgPDwgNikp
KSk7CiBzdHJ1Y3QgbW9kdWxlX2xheW91dCBpbml0X2xheW91dDsKCgogc3RydWN0IG1vZF9h
cmNoX3NwZWNpZmljIGFyY2g7CgogdW5zaWduZWQgbG9uZyB0YWludHM7CgoKCiB1bnNpZ25l
ZCBudW1fYnVnczsKIHN0cnVjdCBsaXN0X2hlYWQgYnVnX2xpc3Q7CiBzdHJ1Y3QgYnVnX2Vu
dHJ5ICpidWdfdGFibGU7CgoKCgogc3RydWN0IG1vZF9rYWxsc3ltcyAqa2FsbHN5bXM7CiBz
dHJ1Y3QgbW9kX2thbGxzeW1zIGNvcmVfa2FsbHN5bXM7CgoKIHN0cnVjdCBtb2R1bGVfc2Vj
dF9hdHRycyAqc2VjdF9hdHRyczsKCgogc3RydWN0IG1vZHVsZV9ub3Rlc19hdHRycyAqbm90
ZXNfYXR0cnM7CgoKCgogY2hhciAqYXJnczsKCgoKIHZvaWQgKnBlcmNwdTsKIHVuc2lnbmVk
IGludCBwZXJjcHVfc2l6ZTsKCiB2b2lkICpub2luc3RyX3RleHRfc3RhcnQ7CiB1bnNpZ25l
ZCBpbnQgbm9pbnN0cl90ZXh0X3NpemU7CgoKIHVuc2lnbmVkIGludCBudW1fdHJhY2Vwb2lu
dHM7CiB0cmFjZXBvaW50X3B0cl90ICp0cmFjZXBvaW50c19wdHJzOwoKCiB1bnNpZ25lZCBp
bnQgbnVtX3NyY3Vfc3RydWN0czsKIHN0cnVjdCBzcmN1X3N0cnVjdCAqKnNyY3Vfc3RydWN0
X3B0cnM7CiMgNDgxICIuL2luY2x1ZGUvbGludXgvbW9kdWxlLmgiCiB1bnNpZ25lZCBpbnQg
bnVtX3RyYWNlX2JwcmludGtfZm10OwogY29uc3QgY2hhciAqKnRyYWNlX2JwcmludGtfZm10
X3N0YXJ0OwoKCiBzdHJ1Y3QgdHJhY2VfZXZlbnRfY2FsbCAqKnRyYWNlX2V2ZW50czsKIHVu
c2lnbmVkIGludCBudW1fdHJhY2VfZXZlbnRzOwogc3RydWN0IHRyYWNlX2V2YWxfbWFwICoq
dHJhY2VfZXZhbHM7CiB1bnNpZ25lZCBpbnQgbnVtX3RyYWNlX2V2YWxzOwojIDUxMSAiLi9p
bmNsdWRlL2xpbnV4L21vZHVsZS5oIgogc3RydWN0IGxpc3RfaGVhZCBzb3VyY2VfbGlzdDsK
CiBzdHJ1Y3QgbGlzdF9oZWFkIHRhcmdldF9saXN0OwoKCiB2b2lkICgqZXhpdCkodm9pZCk7
CgogYXRvbWljX3QgcmVmY250OwojIDUzMSAiLi9pbmNsdWRlL2xpbnV4L21vZHVsZS5oIgp9
IF9fYXR0cmlidXRlX18oKF9fYWxpZ25lZF9fKCgxIDw8IDYpKSkpIDsKCgoKCgpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgdW5zaWduZWQgbG9uZyBrYWxsc3ltc19zeW1ib2xfdmFsdWUoY29uc3QgRWxmNjRfU3lt
ICpzeW0pCnsKIHJldHVybiBzeW0tPnN0X3ZhbHVlOwp9CgoKZXh0ZXJuIHN0cnVjdCBtdXRl
eCBtb2R1bGVfbXV0ZXg7CgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBtb2R1bGVfaXNfbGl2ZShzdHJ1
Y3QgbW9kdWxlICptb2QpCnsKIHJldHVybiBtb2QtPnN0YXRlICE9IE1PRFVMRV9TVEFURV9H
T0lORzsKfQoKc3RydWN0IG1vZHVsZSAqX19tb2R1bGVfdGV4dF9hZGRyZXNzKHVuc2lnbmVk
IGxvbmcgYWRkcik7CnN0cnVjdCBtb2R1bGUgKl9fbW9kdWxlX2FkZHJlc3ModW5zaWduZWQg
bG9uZyBhZGRyKTsKYm9vbCBpc19tb2R1bGVfYWRkcmVzcyh1bnNpZ25lZCBsb25nIGFkZHIp
Owpib29sIF9faXNfbW9kdWxlX3BlcmNwdV9hZGRyZXNzKHVuc2lnbmVkIGxvbmcgYWRkciwg
dW5zaWduZWQgbG9uZyAqY2FuX2FkZHIpOwpib29sIGlzX21vZHVsZV9wZXJjcHVfYWRkcmVz
cyh1bnNpZ25lZCBsb25nIGFkZHIpOwpib29sIGlzX21vZHVsZV90ZXh0X2FkZHJlc3ModW5z
aWduZWQgbG9uZyBhZGRyKTsKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIHdpdGhpbl9tb2R1bGVfY29yZSh1
bnNpZ25lZCBsb25nIGFkZHIsCiAgICAgICAgICBjb25zdCBzdHJ1Y3QgbW9kdWxlICptb2Qp
CnsKIHJldHVybiAodW5zaWduZWQgbG9uZyltb2QtPmNvcmVfbGF5b3V0LmJhc2UgPD0gYWRk
ciAmJgogICAgICAgIGFkZHIgPCAodW5zaWduZWQgbG9uZyltb2QtPmNvcmVfbGF5b3V0LmJh
c2UgKyBtb2QtPmNvcmVfbGF5b3V0LnNpemU7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIHdpdGhpbl9t
b2R1bGVfaW5pdCh1bnNpZ25lZCBsb25nIGFkZHIsCiAgICAgICAgICBjb25zdCBzdHJ1Y3Qg
bW9kdWxlICptb2QpCnsKIHJldHVybiAodW5zaWduZWQgbG9uZyltb2QtPmluaXRfbGF5b3V0
LmJhc2UgPD0gYWRkciAmJgogICAgICAgIGFkZHIgPCAodW5zaWduZWQgbG9uZyltb2QtPmlu
aXRfbGF5b3V0LmJhc2UgKyBtb2QtPmluaXRfbGF5b3V0LnNpemU7Cn0KCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBi
b29sIHdpdGhpbl9tb2R1bGUodW5zaWduZWQgbG9uZyBhZGRyLCBjb25zdCBzdHJ1Y3QgbW9k
dWxlICptb2QpCnsKIHJldHVybiB3aXRoaW5fbW9kdWxlX2luaXQoYWRkciwgbW9kKSB8fCB3
aXRoaW5fbW9kdWxlX2NvcmUoYWRkciwgbW9kKTsKfQoKCnN0cnVjdCBtb2R1bGUgKmZpbmRf
bW9kdWxlKGNvbnN0IGNoYXIgKm5hbWUpOwoKc3RydWN0IHN5bXNlYXJjaCB7CiBjb25zdCBz
dHJ1Y3Qga2VybmVsX3N5bWJvbCAqc3RhcnQsICpzdG9wOwogY29uc3QgczMyICpjcmNzOwog
ZW51bSB7CiAgTk9UX0dQTF9PTkxZLAogIEdQTF9PTkxZLAogIFdJTExfQkVfR1BMX09OTFks
CiB9IGxpY2VuY2U7CiBib29sIHVudXNlZDsKfTsKCgoKCgoKY29uc3Qgc3RydWN0IGtlcm5l
bF9zeW1ib2wgKmZpbmRfc3ltYm9sKGNvbnN0IGNoYXIgKm5hbWUsCiAgICAgc3RydWN0IG1v
ZHVsZSAqKm93bmVyLAogICAgIGNvbnN0IHMzMiAqKmNyYywKICAgICBib29sIGdwbG9rLAog
ICAgIGJvb2wgd2Fybik7CgoKCgoKCmJvb2wgZWFjaF9zeW1ib2xfc2VjdGlvbihib29sICgq
Zm4pKGNvbnN0IHN0cnVjdCBzeW1zZWFyY2ggKmFyciwKICAgICAgICBzdHJ1Y3QgbW9kdWxl
ICpvd25lciwKICAgICAgICB2b2lkICpkYXRhKSwgdm9pZCAqZGF0YSk7CgoKCmludCBtb2R1
bGVfZ2V0X2thbGxzeW0odW5zaWduZWQgaW50IHN5bW51bSwgdW5zaWduZWQgbG9uZyAqdmFs
dWUsIGNoYXIgKnR5cGUsCiAgIGNoYXIgKm5hbWUsIGNoYXIgKm1vZHVsZV9uYW1lLCBpbnQg
KmV4cG9ydGVkKTsKCgp1bnNpZ25lZCBsb25nIG1vZHVsZV9rYWxsc3ltc19sb29rdXBfbmFt
ZShjb25zdCBjaGFyICpuYW1lKTsKCmludCBtb2R1bGVfa2FsbHN5bXNfb25fZWFjaF9zeW1i
b2woaW50ICgqZm4pKHZvaWQgKiwgY29uc3QgY2hhciAqLAogICAgICAgICAgc3RydWN0IG1v
ZHVsZSAqLCB1bnNpZ25lZCBsb25nKSwKICAgICAgIHZvaWQgKmRhdGEpOwoKZXh0ZXJuIHZv
aWQgX19hdHRyaWJ1dGVfXygoX19ub3JldHVybl9fKSkgX19tb2R1bGVfcHV0X2FuZF9leGl0
KHN0cnVjdCBtb2R1bGUgKm1vZCwKICAgbG9uZyBjb2RlKTsKCgoKaW50IG1vZHVsZV9yZWZj
b3VudChzdHJ1Y3QgbW9kdWxlICptb2QpOwp2b2lkIF9fc3ltYm9sX3B1dChjb25zdCBjaGFy
ICpzeW1ib2wpOwoKdm9pZCBzeW1ib2xfcHV0X2FkZHIodm9pZCAqYWRkcik7CgoKCmV4dGVy
biB2b2lkIF9fbW9kdWxlX2dldChzdHJ1Y3QgbW9kdWxlICptb2R1bGUpOwoKCgpleHRlcm4g
Ym9vbCB0cnlfbW9kdWxlX2dldChzdHJ1Y3QgbW9kdWxlICptb2R1bGUpOwoKZXh0ZXJuIHZv
aWQgbW9kdWxlX3B1dChzdHJ1Y3QgbW9kdWxlICptb2R1bGUpOwojIDY2MCAiLi9pbmNsdWRl
L2xpbnV4L21vZHVsZS5oIgppbnQgcmVmX21vZHVsZShzdHJ1Y3QgbW9kdWxlICphLCBzdHJ1
Y3QgbW9kdWxlICpiKTsKIyA2NzAgIi4vaW5jbHVkZS9saW51eC9tb2R1bGUuaCIKdm9pZCAq
ZGVyZWZlcmVuY2VfbW9kdWxlX2Z1bmN0aW9uX2Rlc2NyaXB0b3Ioc3RydWN0IG1vZHVsZSAq
bW9kLCB2b2lkICpwdHIpOwoKCgoKY29uc3QgY2hhciAqbW9kdWxlX2FkZHJlc3NfbG9va3Vw
KHVuc2lnbmVkIGxvbmcgYWRkciwKICAgICAgIHVuc2lnbmVkIGxvbmcgKnN5bWJvbHNpemUs
CiAgICAgICB1bnNpZ25lZCBsb25nICpvZmZzZXQsCiAgICAgICBjaGFyICoqbW9kbmFtZSwK
ICAgICAgIGNoYXIgKm5hbWVidWYpOwppbnQgbG9va3VwX21vZHVsZV9zeW1ib2xfbmFtZSh1
bnNpZ25lZCBsb25nIGFkZHIsIGNoYXIgKnN5bW5hbWUpOwppbnQgbG9va3VwX21vZHVsZV9z
eW1ib2xfYXR0cnModW5zaWduZWQgbG9uZyBhZGRyLCB1bnNpZ25lZCBsb25nICpzaXplLCB1
bnNpZ25lZCBsb25nICpvZmZzZXQsIGNoYXIgKm1vZG5hbWUsIGNoYXIgKm5hbWUpOwoKaW50
IHJlZ2lzdGVyX21vZHVsZV9ub3RpZmllcihzdHJ1Y3Qgbm90aWZpZXJfYmxvY2sgKm5iKTsK
aW50IHVucmVnaXN0ZXJfbW9kdWxlX25vdGlmaWVyKHN0cnVjdCBub3RpZmllcl9ibG9jayAq
bmIpOwoKZXh0ZXJuIHZvaWQgcHJpbnRfbW9kdWxlcyh2b2lkKTsKCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29s
IG1vZHVsZV9yZXF1ZXN0ZWRfYXN5bmNfcHJvYmluZyhzdHJ1Y3QgbW9kdWxlICptb2R1bGUp
CnsKIHJldHVybiBtb2R1bGUgJiYgbW9kdWxlLT5hc3luY19wcm9iZV9yZXF1ZXN0ZWQ7Cn0K
CgoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSBib29sIGlzX2xpdmVwYXRjaF9tb2R1bGUoc3RydWN0IG1vZHVs
ZSAqbW9kKQp7CiByZXR1cm4gZmFsc2U7Cn0KCgpib29sIGlzX21vZHVsZV9zaWdfZW5mb3Jj
ZWQodm9pZCk7CnZvaWQgc2V0X21vZHVsZV9zaWdfZW5mb3JjZWQodm9pZCk7CiMgODU4ICIu
L2luY2x1ZGUvbGludXgvbW9kdWxlLmgiCmV4dGVybiBzdHJ1Y3Qga3NldCAqbW9kdWxlX2tz
ZXQ7CmV4dGVybiBzdHJ1Y3Qga29ial90eXBlIG1vZHVsZV9rdHlwZTsKZXh0ZXJuIGludCBt
b2R1bGVfc3lzZnNfaW5pdGlhbGl6ZWQ7CiMgODcwICIuL2luY2x1ZGUvbGludXgvbW9kdWxl
LmgiCnZvaWQgbW9kdWxlX2J1Z19maW5hbGl6ZShjb25zdCBFbGY2NF9FaGRyICosIGNvbnN0
IEVsZjY0X1NoZHIgKiwKICAgIHN0cnVjdCBtb2R1bGUgKik7CnZvaWQgbW9kdWxlX2J1Z19j
bGVhbnVwKHN0cnVjdCBtb2R1bGUgKik7CiMgODg3ICIuL2luY2x1ZGUvbGludXgvbW9kdWxl
LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSBib29sIHJldHBvbGluZV9tb2R1bGVfb2soYm9vbCBoYXNfcmV0cG9s
aW5lKQp7CiByZXR1cm4gdHJ1ZTsKfQojIDg5OSAiLi9pbmNsdWRlL2xpbnV4L21vZHVsZS5o
IgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgYm9vbCBtb2R1bGVfc2lnX29rKHN0cnVjdCBtb2R1bGUgKm1vZHVsZSkK
ewogcmV0dXJuIHRydWU7Cn0KIyAxNCAiLi9pbmNsdWRlL2xpbnV4L2thbGxzeW1zLmgiIDIK
CiMgMSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vc2VjdGlvbnMuaCIgMQojIDExICIu
L2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9zZWN0aW9ucy5oIgojIDEgIi4vaW5jbHVkZS9h
c20tZ2VuZXJpYy9zZWN0aW9ucy5oIiAxCiMgMzUgIi4vaW5jbHVkZS9hc20tZ2VuZXJpYy9z
ZWN0aW9ucy5oIgpleHRlcm4gY2hhciBfdGV4dFtdLCBfc3RleHRbXSwgX2V0ZXh0W107CmV4
dGVybiBjaGFyIF9kYXRhW10sIF9zZGF0YVtdLCBfZWRhdGFbXTsKZXh0ZXJuIGNoYXIgX19i
c3Nfc3RhcnRbXSwgX19ic3Nfc3RvcFtdOwpleHRlcm4gY2hhciBfX2luaXRfYmVnaW5bXSwg
X19pbml0X2VuZFtdOwpleHRlcm4gY2hhciBfc2luaXR0ZXh0W10sIF9laW5pdHRleHRbXTsK
ZXh0ZXJuIGNoYXIgX19zdGFydF9yb19hZnRlcl9pbml0W10sIF9fZW5kX3JvX2FmdGVyX2lu
aXRbXTsKZXh0ZXJuIGNoYXIgX2VuZFtdOwpleHRlcm4gY2hhciBfX3Blcl9jcHVfbG9hZFtd
LCBfX3Blcl9jcHVfc3RhcnRbXSwgX19wZXJfY3B1X2VuZFtdOwpleHRlcm4gY2hhciBfX2tw
cm9iZXNfdGV4dF9zdGFydFtdLCBfX2twcm9iZXNfdGV4dF9lbmRbXTsKZXh0ZXJuIGNoYXIg
X19lbnRyeV90ZXh0X3N0YXJ0W10sIF9fZW50cnlfdGV4dF9lbmRbXTsKZXh0ZXJuIGNoYXIg
X19zdGFydF9yb2RhdGFbXSwgX19lbmRfcm9kYXRhW107CmV4dGVybiBjaGFyIF9faXJxZW50
cnlfdGV4dF9zdGFydFtdLCBfX2lycWVudHJ5X3RleHRfZW5kW107CmV4dGVybiBjaGFyIF9f
c29mdGlycWVudHJ5X3RleHRfc3RhcnRbXSwgX19zb2Z0aXJxZW50cnlfdGV4dF9lbmRbXTsK
ZXh0ZXJuIGNoYXIgX19zdGFydF9vbmNlW10sIF9fZW5kX29uY2VbXTsKCgpleHRlcm4gY2hh
ciBfX2N0b3JzX3N0YXJ0W10sIF9fY3RvcnNfZW5kW107CgoKZXh0ZXJuIGNoYXIgX19zdGFy
dF9vcGRbXSwgX19lbmRfb3BkW107CgoKZXh0ZXJuIGNoYXIgX19ub2luc3RyX3RleHRfc3Rh
cnRbXSwgX19ub2luc3RyX3RleHRfZW5kW107CgpleHRlcm4gX19hdHRyaWJ1dGVfXygoX19l
eHRlcm5hbGx5X3Zpc2libGVfXykpIGNvbnN0IHZvaWQgX19ub3NhdmVfYmVnaW4sIF9fbm9z
YXZlX2VuZDsKIyA3MCAiLi9pbmNsdWRlL2FzbS1nZW5lcmljL3NlY3Rpb25zLmgiCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBpbnQgYXJjaF9pc19rZXJuZWxfdGV4dCh1bnNpZ25lZCBsb25nIGFkZHIpCnsKIHJl
dHVybiAwOwp9CgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgYXJjaF9pc19rZXJuZWxfZGF0YSh1bnNpZ25l
ZCBsb25nIGFkZHIpCnsKIHJldHVybiAwOwp9CiMgMTA4ICIuL2luY2x1ZGUvYXNtLWdlbmVy
aWMvc2VjdGlvbnMuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgbWVtb3J5X2NvbnRhaW5zKHZvaWQgKmJl
Z2luLCB2b2lkICplbmQsIHZvaWQgKnZpcnQsCiAgICAgICBzaXplX3Qgc2l6ZSkKewogcmV0
dXJuIHZpcnQgPj0gYmVnaW4gJiYgdmlydCArIHNpemUgPD0gZW5kOwp9CiMgMTI1ICIuL2lu
Y2x1ZGUvYXNtLWdlbmVyaWMvc2VjdGlvbnMuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgbWVtb3J5X2lu
dGVyc2VjdHModm9pZCAqYmVnaW4sIHZvaWQgKmVuZCwgdm9pZCAqdmlydCwKICAgICAgICAg
c2l6ZV90IHNpemUpCnsKIHZvaWQgKnZlbmQgPSB2aXJ0ICsgc2l6ZTsKCiByZXR1cm4gKHZp
cnQgPj0gYmVnaW4gJiYgdmlydCA8IGVuZCkgfHwgKHZlbmQgPj0gYmVnaW4gJiYgdmVuZCA8
IGVuZCk7Cn0KIyAxNDIgIi4vaW5jbHVkZS9hc20tZ2VuZXJpYy9zZWN0aW9ucy5oIgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgYm9vbCBpbml0X3NlY3Rpb25fY29udGFpbnModm9pZCAqdmlydCwgc2l6ZV90IHNp
emUpCnsKIHJldHVybiBtZW1vcnlfY29udGFpbnMoX19pbml0X2JlZ2luLCBfX2luaXRfZW5k
LCB2aXJ0LCBzaXplKTsKfQojIDE1NiAiLi9pbmNsdWRlL2FzbS1nZW5lcmljL3NlY3Rpb25z
LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSBib29sIGluaXRfc2VjdGlvbl9pbnRlcnNlY3RzKHZvaWQgKnZpcnQs
IHNpemVfdCBzaXplKQp7CiByZXR1cm4gbWVtb3J5X2ludGVyc2VjdHMoX19pbml0X2JlZ2lu
LCBfX2luaXRfZW5kLCB2aXJ0LCBzaXplKTsKfQojIDE2OSAiLi9pbmNsdWRlL2FzbS1nZW5l
cmljL3NlY3Rpb25zLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIGlzX2tlcm5lbF9yb2RhdGEodW5zaWdu
ZWQgbG9uZyBhZGRyKQp7CiByZXR1cm4gYWRkciA+PSAodW5zaWduZWQgbG9uZylfX3N0YXJ0
X3JvZGF0YSAmJgogICAgICAgIGFkZHIgPCAodW5zaWduZWQgbG9uZylfX2VuZF9yb2RhdGE7
Cn0KIyAxMiAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vc2VjdGlvbnMuaCIgMgoKZXh0
ZXJuIGJvb2wgaW5pdF9tZW1faXNfZnJlZTsKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgYXJjaF9pc19rZXJu
ZWxfaW5pdG1lbV9mcmVlZCh1bnNpZ25lZCBsb25nIGFkZHIpCnsKIGlmICghaW5pdF9tZW1f
aXNfZnJlZSkKICByZXR1cm4gMDsKCiByZXR1cm4gYWRkciA+PSAodW5zaWduZWQgbG9uZylf
X2luaXRfYmVnaW4gJiYKICBhZGRyIDwgKHVuc2lnbmVkIGxvbmcpX19pbml0X2VuZDsKfQoK
ZXh0ZXJuIGNoYXIgX19oZWFkX2VuZFtdOwoKCgpleHRlcm4gY2hhciBfX3N0YXJ0X2ludGVy
cnVwdHNbXTsKZXh0ZXJuIGNoYXIgX19lbmRfaW50ZXJydXB0c1tdOwoKZXh0ZXJuIGNoYXIg
X19wcm9tX2luaXRfdG9jX3N0YXJ0W107CmV4dGVybiBjaGFyIF9fcHJvbV9pbml0X3RvY19l
bmRbXTsKIyA0MSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vc2VjdGlvbnMuaCIKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIGludCBpbl9rZXJuZWxfdGV4dCh1bnNpZ25lZCBsb25nIGFkZHIpCnsKIGlmIChh
ZGRyID49ICh1bnNpZ25lZCBsb25nKV9zdGV4dCAmJiBhZGRyIDwgKHVuc2lnbmVkIGxvbmcp
X19pbml0X2VuZCkKICByZXR1cm4gMTsKCiByZXR1cm4gMDsKfQoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHVuc2ln
bmVkIGxvbmcga2VybmVsX3RvY19hZGRyKHZvaWQpCnsKCiBleHRlcm4gdW5zaWduZWQgbG9u
ZyBfX3RvY19zdGFydDsKCgoKCgogcmV0dXJuICh1bnNpZ25lZCBsb25nKSgmX190b2Nfc3Rh
cnQpICsgMHg4MDAwVUw7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgb3ZlcmxhcHNfaW50ZXJydXB0X3Zl
Y3Rvcl90ZXh0KHVuc2lnbmVkIGxvbmcgc3RhcnQsCiAgICAgICB1bnNpZ25lZCBsb25nIGVu
ZCkKewogdW5zaWduZWQgbG9uZyByZWFsX3N0YXJ0LCByZWFsX2VuZDsKIHJlYWxfc3RhcnQg
PSBfX3N0YXJ0X2ludGVycnVwdHMgLSBfc3RleHQ7CiByZWFsX2VuZCA9IF9fZW5kX2ludGVy
cnVwdHMgLSBfc3RleHQ7CgogcmV0dXJuIHN0YXJ0IDwgKHVuc2lnbmVkIGxvbmcpKHsgZG8g
eyB9IHdoaWxlICgwKTsgKHZvaWQgKikodW5zaWduZWQgbG9uZykoKHBoeXNfYWRkcl90KShy
ZWFsX2VuZCkgfCAweGMwMDAwMDAwMDAwMDAwMDBVTCk7IH0pICYmCiAgKHVuc2lnbmVkIGxv
bmcpKHsgZG8geyB9IHdoaWxlICgwKTsgKHZvaWQgKikodW5zaWduZWQgbG9uZykoKHBoeXNf
YWRkcl90KShyZWFsX3N0YXJ0KSB8IDB4YzAwMDAwMDAwMDAwMDAwMFVMKTsgfSkgPCBlbmQ7
Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSBpbnQgb3ZlcmxhcHNfa2VybmVsX3RleHQodW5zaWduZWQgbG9uZyBz
dGFydCwgdW5zaWduZWQgbG9uZyBlbmQpCnsKIHJldHVybiBzdGFydCA8ICh1bnNpZ25lZCBs
b25nKV9faW5pdF9lbmQgJiYKICAodW5zaWduZWQgbG9uZylfc3RleHQgPCBlbmQ7Cn0KCgoK
CgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIHZvaWQgKmRlcmVmZXJlbmNlX2Z1bmN0aW9uX2Rlc2NyaXB0b3Iodm9p
ZCAqcHRyKQp7CiBzdHJ1Y3QgcHBjNjRfb3BkX2VudHJ5ICpkZXNjID0gcHRyOwogdm9pZCAq
cDsKCiBpZiAoISh7IGNvbnN0IHR5cGVvZihwKSAqX19na19wdHIgPSAoKHZvaWQgKikmZGVz
Yy0+ZnVuY2FkZHIpOyBjb3B5X2Zyb21fa2VybmVsX25vZmF1bHQoJihwKSwgX19na19wdHIs
IHNpemVvZihwKSk7fSkpCiAgcHRyID0gcDsKIHJldHVybiBwdHI7Cn0KCgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
dm9pZCAqZGVyZWZlcmVuY2Vfa2VybmVsX2Z1bmN0aW9uX2Rlc2NyaXB0b3Iodm9pZCAqcHRy
KQp7CiBpZiAocHRyIDwgKHZvaWQgKilfX3N0YXJ0X29wZCB8fCBwdHIgPj0gKHZvaWQgKilf
X2VuZF9vcGQpCiAgcmV0dXJuIHB0cjsKCiByZXR1cm4gZGVyZWZlcmVuY2VfZnVuY3Rpb25f
ZGVzY3JpcHRvcihwdHIpOwp9CiMgMTYgIi4vaW5jbHVkZS9saW51eC9rYWxsc3ltcy5oIiAy
CgoKCgoKc3RydWN0IG1vZHVsZTsKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgaXNfa2VybmVsX2luaXR0ZXh0
KHVuc2lnbmVkIGxvbmcgYWRkcikKewogaWYgKGFkZHIgPj0gKHVuc2lnbmVkIGxvbmcpX3Np
bml0dGV4dAogICAgICYmIGFkZHIgPD0gKHVuc2lnbmVkIGxvbmcpX2Vpbml0dGV4dCkKICBy
ZXR1cm4gMTsKIHJldHVybiAwOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGlzX2tlcm5lbF90ZXh0KHVu
c2lnbmVkIGxvbmcgYWRkcikKewogaWYgKChhZGRyID49ICh1bnNpZ25lZCBsb25nKV9zdGV4
dCAmJiBhZGRyIDw9ICh1bnNpZ25lZCBsb25nKV9ldGV4dCkgfHwKICAgICBhcmNoX2lzX2tl
cm5lbF90ZXh0KGFkZHIpKQogIHJldHVybiAxOwogcmV0dXJuIGluX2dhdGVfYXJlYV9ub19t
bShhZGRyKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBpc19rZXJuZWwodW5zaWduZWQgbG9uZyBhZGRy
KQp7CiBpZiAoYWRkciA+PSAodW5zaWduZWQgbG9uZylfc3RleHQgJiYgYWRkciA8PSAodW5z
aWduZWQgbG9uZylfZW5kKQogIHJldHVybiAxOwogcmV0dXJuIGluX2dhdGVfYXJlYV9ub19t
bShhZGRyKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBpc19rc3ltX2FkZHIodW5zaWduZWQgbG9uZyBh
ZGRyKQp7CiBpZiAoMSkKICByZXR1cm4gaXNfa2VybmVsKGFkZHIpOwoKIHJldHVybiBpc19r
ZXJuZWxfdGV4dChhZGRyKSB8fCBpc19rZXJuZWxfaW5pdHRleHQoYWRkcik7Cn0KCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSB2b2lkICpkZXJlZmVyZW5jZV9zeW1ib2xfZGVzY3JpcHRvcih2b2lkICpwdHIpCnsK
CiBzdHJ1Y3QgbW9kdWxlICptb2Q7CgogcHRyID0gZGVyZWZlcmVuY2Vfa2VybmVsX2Z1bmN0
aW9uX2Rlc2NyaXB0b3IocHRyKTsKIGlmIChpc19rc3ltX2FkZHIoKHVuc2lnbmVkIGxvbmcp
cHRyKSkKICByZXR1cm4gcHRyOwoKIF9fYXNtX18gX192b2xhdGlsZV9fKCIiOiA6IDoibWVt
b3J5Iik7CiBtb2QgPSBfX21vZHVsZV9hZGRyZXNzKCh1bnNpZ25lZCBsb25nKXB0cik7CiBf
X2FzbV9fIF9fdm9sYXRpbGVfXygiIjogOiA6Im1lbW9yeSIpOwoKIGlmIChtb2QpCiAgcHRy
ID0gZGVyZWZlcmVuY2VfbW9kdWxlX2Z1bmN0aW9uX2Rlc2NyaXB0b3IobW9kLCBwdHIpOwoK
IHJldHVybiBwdHI7Cn0KCgoKdW5zaWduZWQgbG9uZyBrYWxsc3ltc19sb29rdXBfbmFtZShj
b25zdCBjaGFyICpuYW1lKTsKCgppbnQga2FsbHN5bXNfb25fZWFjaF9zeW1ib2woaW50ICgq
Zm4pKHZvaWQgKiwgY29uc3QgY2hhciAqLCBzdHJ1Y3QgbW9kdWxlICosCiAgICAgICAgICB1
bnNpZ25lZCBsb25nKSwKICAgICAgIHZvaWQgKmRhdGEpOwoKZXh0ZXJuIGludCBrYWxsc3lt
c19sb29rdXBfc2l6ZV9vZmZzZXQodW5zaWduZWQgbG9uZyBhZGRyLAogICAgICB1bnNpZ25l
ZCBsb25nICpzeW1ib2xzaXplLAogICAgICB1bnNpZ25lZCBsb25nICpvZmZzZXQpOwoKCmNv
bnN0IGNoYXIgKmthbGxzeW1zX2xvb2t1cCh1bnNpZ25lZCBsb25nIGFkZHIsCiAgICAgICB1
bnNpZ25lZCBsb25nICpzeW1ib2xzaXplLAogICAgICAgdW5zaWduZWQgbG9uZyAqb2Zmc2V0
LAogICAgICAgY2hhciAqKm1vZG5hbWUsIGNoYXIgKm5hbWVidWYpOwoKCmV4dGVybiBpbnQg
c3ByaW50X3N5bWJvbChjaGFyICpidWZmZXIsIHVuc2lnbmVkIGxvbmcgYWRkcmVzcyk7CmV4
dGVybiBpbnQgc3ByaW50X3N5bWJvbF9ub19vZmZzZXQoY2hhciAqYnVmZmVyLCB1bnNpZ25l
ZCBsb25nIGFkZHJlc3MpOwpleHRlcm4gaW50IHNwcmludF9iYWNrdHJhY2UoY2hhciAqYnVm
ZmVyLCB1bnNpZ25lZCBsb25nIGFkZHJlc3MpOwoKaW50IGxvb2t1cF9zeW1ib2xfbmFtZSh1
bnNpZ25lZCBsb25nIGFkZHIsIGNoYXIgKnN5bW5hbWUpOwppbnQgbG9va3VwX3N5bWJvbF9h
dHRycyh1bnNpZ25lZCBsb25nIGFkZHIsIHVuc2lnbmVkIGxvbmcgKnNpemUsIHVuc2lnbmVk
IGxvbmcgKm9mZnNldCwgY2hhciAqbW9kbmFtZSwgY2hhciAqbmFtZSk7CgoKZXh0ZXJuIGlu
dCBrYWxsc3ltc19zaG93X3ZhbHVlKHZvaWQpOwojIDE2OCAiLi9pbmNsdWRlL2xpbnV4L2th
bGxzeW1zLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHByaW50X2lwX3N5bShjb25zdCBjaGFyICpsb2ds
dmwsIHVuc2lnbmVkIGxvbmcgaXApCnsKIHByaW50aygiJXNbPCVweD5dICVwU1xuIiwgbG9n
bHZsLCAodm9pZCAqKSBpcCwgKHZvaWQgKikgaXApOwp9CiMgMTIgIi4vaW5jbHVkZS9saW51
eC9mdHJhY2UuaCIgMgojIDIxICIuL2luY2x1ZGUvbGludXgvZnRyYWNlLmgiCiMgMSAiLi9h
cmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vZnRyYWNlLmgiIDEKIyAxMDIgIi4vYXJjaC9wb3dl
cnBjL2luY2x1ZGUvYXNtL2Z0cmFjZS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCB0aGlzX2NwdV9kaXNh
YmxlX2Z0cmFjZSh2b2lkKQp7CiBsb2NhbF9wYWNhLT5mdHJhY2VfZW5hYmxlZCA9IDA7Cn0K
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSB2b2lkIHRoaXNfY3B1X2VuYWJsZV9mdHJhY2Uodm9pZCkKewogbG9jYWxf
cGFjYS0+ZnRyYWNlX2VuYWJsZWQgPSAxOwp9CgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgdGhpc19jcHVf
c2V0X2Z0cmFjZV9lbmFibGVkKHU4IGZ0cmFjZV9lbmFibGVkKQp7CiBsb2NhbF9wYWNhLT5m
dHJhY2VfZW5hYmxlZCA9IGZ0cmFjZV9lbmFibGVkOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdTggdGhpc19j
cHVfZ2V0X2Z0cmFjZV9lbmFibGVkKHZvaWQpCnsKIHJldHVybiBsb2NhbF9wYWNhLT5mdHJh
Y2VfZW5hYmxlZDsKfQojIDIyICIuL2luY2x1ZGUvbGludXgvZnRyYWNlLmgiIDIKIyA0NSAi
Li9pbmNsdWRlL2xpbnV4L2Z0cmFjZS5oIgp2b2lkIHRyYWNlX2luaXQodm9pZCk7CnZvaWQg
ZWFybHlfdHJhY2VfaW5pdCh2b2lkKTsKCgoKCgpzdHJ1Y3QgbW9kdWxlOwpzdHJ1Y3QgZnRy
YWNlX2hhc2g7CnN0cnVjdCBmdHJhY2VfZGlyZWN0X2Z1bmM7CiMgNjUgIi4vaW5jbHVkZS9s
aW51eC9mdHJhY2UuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGNvbnN0IGNoYXIgKgpmdHJhY2VfbW9kX2FkZHJl
c3NfbG9va3VwKHVuc2lnbmVkIGxvbmcgYWRkciwgdW5zaWduZWQgbG9uZyAqc2l6ZSwKICAg
ICB1bnNpZ25lZCBsb25nICpvZmYsIGNoYXIgKiptb2RuYW1lLCBjaGFyICpzeW0pCnsKIHJl
dHVybiAoKHZvaWQgKikwKTsKfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGZ0cmFjZV9tb2RfZ2V0X2thbGxz
eW0odW5zaWduZWQgaW50IHN5bW51bSwgdW5zaWduZWQgbG9uZyAqdmFsdWUsCiAgICAgIGNo
YXIgKnR5cGUsIGNoYXIgKm5hbWUsCiAgICAgIGNoYXIgKm1vZHVsZV9uYW1lLCBpbnQgKmV4
cG9ydGVkKQp7CiByZXR1cm4gLTE7Cn0KIyAyNjcgIi4vaW5jbHVkZS9saW51eC9mdHJhY2Uu
aCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIHZvaWQgZnRyYWNlX2tpbGwodm9pZCkgeyB9CnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lk
IGZ0cmFjZV9mcmVlX2luaXRfbWVtKHZvaWQpIHsgfQpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBmdHJhY2Vf
ZnJlZV9tZW0oc3RydWN0IG1vZHVsZSAqbW9kLCB2b2lkICpzdGFydCwgdm9pZCAqZW5kKSB7
IH0KCgpzdHJ1Y3QgZnRyYWNlX2Z1bmNfZW50cnkgewogc3RydWN0IGhsaXN0X25vZGUgaGxp
c3Q7CiB1bnNpZ25lZCBsb25nIGlwOwogdW5zaWduZWQgbG9uZyBkaXJlY3Q7Cn07CgpzdHJ1
Y3QgZHluX2Z0cmFjZTsKIyAyOTMgIi4vaW5jbHVkZS9saW51eC9mdHJhY2UuaCIKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIGludCByZWdpc3Rlcl9mdHJhY2VfZGlyZWN0KHVuc2lnbmVkIGxvbmcgaXAsIHVuc2ln
bmVkIGxvbmcgYWRkcikKewogcmV0dXJuIC01MjQ7Cn0Kc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCB1bnJlZ2lz
dGVyX2Z0cmFjZV9kaXJlY3QodW5zaWduZWQgbG9uZyBpcCwgdW5zaWduZWQgbG9uZyBhZGRy
KQp7CiByZXR1cm4gLTUyNDsKfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IG1vZGlmeV9mdHJhY2VfZGlyZWN0
KHVuc2lnbmVkIGxvbmcgaXAsCiAgICAgICAgICAgdW5zaWduZWQgbG9uZyBvbGRfYWRkciwg
dW5zaWduZWQgbG9uZyBuZXdfYWRkcikKewogcmV0dXJuIC01MjQ7Cn0Kc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHN0
cnVjdCBmdHJhY2VfZGlyZWN0X2Z1bmMgKmZ0cmFjZV9maW5kX2RpcmVjdF9mdW5jKHVuc2ln
bmVkIGxvbmcgYWRkcikKewogcmV0dXJuICgodm9pZCAqKTApOwp9CnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQg
ZnRyYWNlX21vZGlmeV9kaXJlY3RfY2FsbGVyKHN0cnVjdCBmdHJhY2VfZnVuY19lbnRyeSAq
ZW50cnksCiAgICAgICAgICAgc3RydWN0IGR5bl9mdHJhY2UgKnJlYywKICAgICAgICAgICB1
bnNpZ25lZCBsb25nIG9sZF9hZGRyLAogICAgICAgICAgIHVuc2lnbmVkIGxvbmcgbmV3X2Fk
ZHIpCnsKIHJldHVybiAtMTk7Cn0Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHVuc2lnbmVkIGxvbmcgZnRyYWNlX2Zp
bmRfcmVjX2RpcmVjdCh1bnNpZ25lZCBsb25nIGlwKQp7CiByZXR1cm4gMDsKfQojIDMzNyAi
Li9pbmNsdWRlL2xpbnV4L2Z0cmFjZS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBhcmNoX2Z0cmFjZV9z
ZXRfZGlyZWN0X2NhbGxlcihzdHJ1Y3QgcHRfcmVncyAqcmVncywKICAgICAgIHVuc2lnbmVk
IGxvbmcgYWRkcikgeyB9CiMgMzgzICIuL2luY2x1ZGUvbGludXgvZnRyYWNlLmgiCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSB2b2lkIHN0YWNrX3RyYWNlcl9kaXNhYmxlKHZvaWQpIHsgfQpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9p
ZCBzdGFja190cmFjZXJfZW5hYmxlKHZvaWQpIHsgfQojIDcxNyAiLi9pbmNsdWRlL2xpbnV4
L2Z0cmFjZS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHNraXBfdHJhY2UodW5zaWduZWQgbG9uZyBpcCkg
eyByZXR1cm4gMDsgfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGZ0cmFjZV9mb3JjZV91cGRhdGUodm9pZCkg
eyByZXR1cm4gMDsgfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBmdHJhY2VfZGlzYWJsZV9kYWVtb24odm9p
ZCkgeyB9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSB2b2lkIGZ0cmFjZV9lbmFibGVfZGFlbW9uKHZvaWQpIHsgfQpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgdm9pZCBmdHJhY2VfbW9kdWxlX2luaXQoc3RydWN0IG1vZHVsZSAqbW9kKSB7
IH0Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIHZvaWQgZnRyYWNlX21vZHVsZV9lbmFibGUoc3RydWN0IG1vZHVsZSAq
bW9kKSB7IH0Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgZnRyYWNlX3JlbGVhc2VfbW9kKHN0cnVjdCBtb2R1
bGUgKm1vZCkgeyB9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgZnRyYWNlX3RleHRfcmVzZXJ2ZWQoY29uc3Qg
dm9pZCAqc3RhcnQsIGNvbnN0IHZvaWQgKmVuZCkKewogcmV0dXJuIDA7Cn0Kc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IHVuc2lnbmVkIGxvbmcgZnRyYWNlX2xvY2F0aW9uKHVuc2lnbmVkIGxvbmcgaXApCnsKIHJl
dHVybiAwOwp9CiMgNzQ2ICIuL2luY2x1ZGUvbGludXgvZnRyYWNlLmgiCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBz
c2l6ZV90IGZ0cmFjZV9maWx0ZXJfd3JpdGUoc3RydWN0IGZpbGUgKmZpbGUsIGNvbnN0IGNo
YXIgKnVidWYsCiAgICAgICBzaXplX3QgY250LCBsb2ZmX3QgKnBwb3MpIHsgcmV0dXJuIC0x
OTsgfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgc3NpemVfdCBmdHJhY2Vfbm90cmFjZV93cml0ZShzdHJ1Y3QgZmls
ZSAqZmlsZSwgY29uc3QgY2hhciAqdWJ1ZiwKICAgICAgICBzaXplX3QgY250LCBsb2ZmX3Qg
KnBwb3MpIHsgcmV0dXJuIC0xOTsgfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50CmZ0cmFjZV9yZWdleF9yZWxl
YXNlKHN0cnVjdCBpbm9kZSAqaW5vZGUsIHN0cnVjdCBmaWxlICpmaWxlKSB7IHJldHVybiAt
MTk7IH0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSBib29sIGlzX2Z0cmFjZV90cmFtcG9saW5lKHVuc2lnbmVkIGxv
bmcgYWRkcikKewogcmV0dXJuIGZhbHNlOwp9CgoKCnZvaWQgZnRyYWNlX2tpbGwodm9pZCk7
CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgdm9pZCB0cmFjZXJfZGlzYWJsZSh2b2lkKQp7CgoKCn0KCgoKCgoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIGludCBfX2Z0cmFjZV9lbmFibGVkX3NhdmUodm9pZCkKewoKCgoKCiByZXR1cm4g
MDsKCn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSB2b2lkIF9fZnRyYWNlX2VuYWJsZWRfcmVzdG9yZShpbnQgZW5h
YmxlZCkKewoKCgp9CiMgODE0ICIuL2luY2x1ZGUvbGludXgvZnRyYWNlLmgiCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSB1bnNpZ25lZCBsb25nIGdldF9sb2NrX3BhcmVudF9pcCh2b2lkKQp7CiB1bnNpZ25lZCBs
b25nIGFkZHIgPSAoKHVuc2lnbmVkIGxvbmcpX19idWlsdGluX3JldHVybl9hZGRyZXNzKDAp
KTsKCiBpZiAoIWluX2xvY2tfZnVuY3Rpb25zKGFkZHIpKQogIHJldHVybiBhZGRyOwogYWRk
ciA9ICgodW5zaWduZWQgbG9uZykwVUwpOwogaWYgKCFpbl9sb2NrX2Z1bmN0aW9ucyhhZGRy
KSkKICByZXR1cm4gYWRkcjsKIHJldHVybiAoKHVuc2lnbmVkIGxvbmcpMFVMKTsKfQojIDg0
NiAiLi9pbmNsdWRlL2xpbnV4L2Z0cmFjZS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBmdHJhY2VfaW5p
dCh2b2lkKSB7IH0KCgoKCgoKCnN0cnVjdCBmdHJhY2VfZ3JhcGhfZW50IHsKIHVuc2lnbmVk
IGxvbmcgZnVuYzsKIGludCBkZXB0aDsKfSBfX2F0dHJpYnV0ZV9fKChfX3BhY2tlZF9fKSk7
CgoKCgoKCnN0cnVjdCBmdHJhY2VfZ3JhcGhfcmV0IHsKIHVuc2lnbmVkIGxvbmcgZnVuYzsK
CiB1bnNpZ25lZCBsb25nIG92ZXJydW47CiB1bnNpZ25lZCBsb25nIGxvbmcgY2FsbHRpbWU7
CiB1bnNpZ25lZCBsb25nIGxvbmcgcmV0dGltZTsKIGludCBkZXB0aDsKfSBfX2F0dHJpYnV0
ZV9fKChfX3BhY2tlZF9fKSk7CgoKdHlwZWRlZiB2b2lkICgqdHJhY2VfZnVuY19ncmFwaF9y
ZXRfdCkoc3RydWN0IGZ0cmFjZV9ncmFwaF9yZXQgKik7CnR5cGVkZWYgaW50ICgqdHJhY2Vf
ZnVuY19ncmFwaF9lbnRfdCkoc3RydWN0IGZ0cmFjZV9ncmFwaF9lbnQgKik7CgpleHRlcm4g
aW50IGZ0cmFjZV9ncmFwaF9lbnRyeV9zdHViKHN0cnVjdCBmdHJhY2VfZ3JhcGhfZW50ICp0
cmFjZSk7CiMgOTYwICIuL2luY2x1ZGUvbGludXgvZnRyYWNlLmgiCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lk
IGZ0cmFjZV9ncmFwaF9pbml0X3Rhc2soc3RydWN0IHRhc2tfc3RydWN0ICp0KSB7IH0Kc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIHZvaWQgZnRyYWNlX2dyYXBoX2V4aXRfdGFzayhzdHJ1Y3QgdGFza19zdHJ1Y3Qg
KnQpIHsgfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBmdHJhY2VfZ3JhcGhfaW5pdF9pZGxlX3Rhc2soc3Ry
dWN0IHRhc2tfc3RydWN0ICp0LCBpbnQgY3B1KSB7IH0KCgoKCgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWdu
ZWQgbG9uZwpmdHJhY2VfZ3JhcGhfcmV0X2FkZHIoc3RydWN0IHRhc2tfc3RydWN0ICp0YXNr
LCBpbnQgKmlkeCwgdW5zaWduZWQgbG9uZyByZXQsCiAgICAgICAgdW5zaWduZWQgbG9uZyAq
cmV0cCkKewogcmV0dXJuIHJldDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgcGF1c2VfZ3JhcGhfdHJh
Y2luZyh2b2lkKSB7IH0Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgdW5wYXVzZV9ncmFwaF90cmFjaW5nKHZv
aWQpIHsgfQoKCgoKCmVudW0gewogVFNLX1RSQUNFX0ZMX1RSQUNFX0JJVCA9IDAsCiBUU0tf
VFJBQ0VfRkxfR1JBUEhfQklUID0gMSwKfTsKZW51bSB7CiBUU0tfVFJBQ0VfRkxfVFJBQ0Ug
PSAxIDw8IFRTS19UUkFDRV9GTF9UUkFDRV9CSVQsCiBUU0tfVFJBQ0VfRkxfR1JBUEggPSAx
IDw8IFRTS19UUkFDRV9GTF9HUkFQSF9CSVQsCn07CgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBzZXRfdHNr
X3RyYWNlX3RyYWNlKHN0cnVjdCB0YXNrX3N0cnVjdCAqdHNrKQp7CiBzZXRfYml0KFRTS19U
UkFDRV9GTF9UUkFDRV9CSVQsICZ0c2stPnRyYWNlKTsKfQoKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgY2xl
YXJfdHNrX3RyYWNlX3RyYWNlKHN0cnVjdCB0YXNrX3N0cnVjdCAqdHNrKQp7CiBjbGVhcl9i
aXQoVFNLX1RSQUNFX0ZMX1RSQUNFX0JJVCwgJnRzay0+dHJhY2UpOwp9CgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
aW50IHRlc3RfdHNrX3RyYWNlX3RyYWNlKHN0cnVjdCB0YXNrX3N0cnVjdCAqdHNrKQp7CiBy
ZXR1cm4gdHNrLT50cmFjZSAmIFRTS19UUkFDRV9GTF9UUkFDRTsKfQoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZv
aWQgc2V0X3Rza190cmFjZV9ncmFwaChzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRzaykKewogc2V0
X2JpdChUU0tfVFJBQ0VfRkxfR1JBUEhfQklULCAmdHNrLT50cmFjZSk7Cn0KCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSB2b2lkIGNsZWFyX3Rza190cmFjZV9ncmFwaChzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRzaykK
ewogY2xlYXJfYml0KFRTS19UUkFDRV9GTF9HUkFQSF9CSVQsICZ0c2stPnRyYWNlKTsKfQoK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIGludCB0ZXN0X3Rza190cmFjZV9ncmFwaChzdHJ1Y3QgdGFza19zdHJ1Y3Qg
KnRzaykKewogcmV0dXJuIHRzay0+dHJhY2UgJiBUU0tfVFJBQ0VfRkxfR1JBUEg7Cn0KCmVu
dW0gZnRyYWNlX2R1bXBfbW9kZTsKCmV4dGVybiBlbnVtIGZ0cmFjZV9kdW1wX21vZGUgZnRy
YWNlX2R1bXBfb25fb29wczsKZXh0ZXJuIGludCB0cmFjZXBvaW50X3ByaW50azsKCmV4dGVy
biB2b2lkIGRpc2FibGVfdHJhY2Vfb25fd2FybmluZyh2b2lkKTsKZXh0ZXJuIGludCBfX2Rp
c2FibGVfdHJhY2Vfb25fd2FybmluZzsKCmludCB0cmFjZXBvaW50X3ByaW50a19zeXNjdGwo
c3RydWN0IGN0bF90YWJsZSAqdGFibGUsIGludCB3cml0ZSwKICAgICAgICB2b2lkICpidWZm
ZXIsIHNpemVfdCAqbGVucCwgbG9mZl90ICpwcG9zKTsKIyA1MCAiLi9pbmNsdWRlL2xpbnV4
L3BlcmZfZXZlbnQuaCIgMgojIDEgIi4vaW5jbHVkZS9saW51eC9jcHUuaCIgMQojIDE3ICIu
L2luY2x1ZGUvbGludXgvY3B1LmgiCiMgMSAiLi9pbmNsdWRlL2xpbnV4L25vZGUuaCIgMQoj
IDMxICIuL2luY2x1ZGUvbGludXgvbm9kZS5oIgpzdHJ1Y3Qgbm9kZV9obWVtX2F0dHJzIHsK
IHVuc2lnbmVkIGludCByZWFkX2JhbmR3aWR0aDsKIHVuc2lnbmVkIGludCB3cml0ZV9iYW5k
d2lkdGg7CiB1bnNpZ25lZCBpbnQgcmVhZF9sYXRlbmN5OwogdW5zaWduZWQgaW50IHdyaXRl
X2xhdGVuY3k7Cn07CgplbnVtIGNhY2hlX2luZGV4aW5nIHsKIE5PREVfQ0FDSEVfRElSRUNU
X01BUCwKIE5PREVfQ0FDSEVfSU5ERVhFRCwKIE5PREVfQ0FDSEVfT1RIRVIsCn07CgplbnVt
IGNhY2hlX3dyaXRlX3BvbGljeSB7CiBOT0RFX0NBQ0hFX1dSSVRFX0JBQ0ssCiBOT0RFX0NB
Q0hFX1dSSVRFX1RIUk9VR0gsCiBOT0RFX0NBQ0hFX1dSSVRFX09USEVSLAp9OwojIDU5ICIu
L2luY2x1ZGUvbGludXgvbm9kZS5oIgpzdHJ1Y3Qgbm9kZV9jYWNoZV9hdHRycyB7CiBlbnVt
IGNhY2hlX2luZGV4aW5nIGluZGV4aW5nOwogZW51bSBjYWNoZV93cml0ZV9wb2xpY3kgd3Jp
dGVfcG9saWN5OwogdTY0IHNpemU7CiB1MTYgbGluZV9zaXplOwogdTggbGV2ZWw7Cn07CgoK
CgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSB2b2lkIG5vZGVfYWRkX2NhY2hlKHVuc2lnbmVkIGludCBuaWQsCiAg
ICAgIHN0cnVjdCBub2RlX2NhY2hlX2F0dHJzICpjYWNoZV9hdHRycykKewp9CgpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgdm9pZCBub2RlX3NldF9wZXJmX2F0dHJzKHVuc2lnbmVkIGludCBuaWQsCiAgICAgICAg
ICAgc3RydWN0IG5vZGVfaG1lbV9hdHRycyAqaG1lbV9hdHRycywKICAgICAgICAgICB1bnNp
Z25lZCBhY2Nlc3MpCnsKfQoKCnN0cnVjdCBub2RlIHsKIHN0cnVjdCBkZXZpY2UgZGV2Owog
c3RydWN0IGxpc3RfaGVhZCBhY2Nlc3NfbGlzdDsKIyA5NSAiLi9pbmNsdWRlL2xpbnV4L25v
ZGUuaCIKfTsKCnN0cnVjdCBtZW1vcnlfYmxvY2s7CmV4dGVybiBzdHJ1Y3Qgbm9kZSAqbm9k
ZV9kZXZpY2VzW107CnR5cGVkZWYgdm9pZCAoKm5vZGVfcmVnaXN0cmF0aW9uX2Z1bmNfdCko
c3RydWN0IG5vZGUgKik7CgoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBsaW5rX21lbV9zZWN0aW9ucyhp
bnQgbmlkLCB1bnNpZ25lZCBsb25nIHN0YXJ0X3BmbiwKICAgICAgICB1bnNpZ25lZCBsb25n
IGVuZF9wZm4pCnsKIHJldHVybiAwOwp9CgoKZXh0ZXJuIHZvaWQgdW5yZWdpc3Rlcl9ub2Rl
KHN0cnVjdCBub2RlICpub2RlKTsKIyAxNTEgIi4vaW5jbHVkZS9saW51eC9ub2RlLmgiCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSBpbnQgX19yZWdpc3Rlcl9vbmVfbm9kZShpbnQgbmlkKQp7CiByZXR1cm4gMDsK
fQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgaW50IHJlZ2lzdGVyX29uZV9ub2RlKGludCBuaWQpCnsKIHJldHVybiAw
Owp9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSBpbnQgdW5yZWdpc3Rlcl9vbmVfbm9kZShpbnQgbmlkKQp7CiByZXR1
cm4gMDsKfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgaW50IHJlZ2lzdGVyX2NwdV91bmRlcl9ub2RlKHVuc2lnbmVk
IGludCBjcHUsIHVuc2lnbmVkIGludCBuaWQpCnsKIHJldHVybiAwOwp9CnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBp
bnQgdW5yZWdpc3Rlcl9jcHVfdW5kZXJfbm9kZSh1bnNpZ25lZCBpbnQgY3B1LCB1bnNpZ25l
ZCBpbnQgbmlkKQp7CiByZXR1cm4gMDsKfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCB1bnJlZ2lzdGVyX21l
bW9yeV9ibG9ja191bmRlcl9ub2RlcyhzdHJ1Y3QgbWVtb3J5X2Jsb2NrICptZW1fYmxrKQp7
Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSB2b2lkIHJlZ2lzdGVyX2h1Z2V0bGJmc193aXRoX25vZGUobm9kZV9y
ZWdpc3RyYXRpb25fZnVuY190IHJlZywKICAgICAgbm9kZV9yZWdpc3RyYXRpb25fZnVuY190
IHVucmVnKQp7Cn0KIyAxOCAiLi9pbmNsdWRlL2xpbnV4L2NwdS5oIiAyCgoKIyAxICIuL2lu
Y2x1ZGUvbGludXgvY3B1aG90cGx1Zy5oIiAxCiMgMjUgIi4vaW5jbHVkZS9saW51eC9jcHVo
b3RwbHVnLmgiCmVudW0gY3B1aHBfc3RhdGUgewogQ1BVSFBfSU5WQUxJRCA9IC0xLAogQ1BV
SFBfT0ZGTElORSA9IDAsCiBDUFVIUF9DUkVBVEVfVEhSRUFEUywKIENQVUhQX1BFUkZfUFJF
UEFSRSwKIENQVUhQX1BFUkZfWDg2X1BSRVBBUkUsCiBDUFVIUF9QRVJGX1g4Nl9BTURfVU5D
T1JFX1BSRVAsCiBDUFVIUF9QRVJGX1BPV0VSLAogQ1BVSFBfUEVSRl9TVVBFUkgsCiBDUFVI
UF9YODZfSFBFVF9ERUFELAogQ1BVSFBfWDg2X0FQQl9ERUFELAogQ1BVSFBfWDg2X01DRV9E
RUFELAogQ1BVSFBfVklSVF9ORVRfREVBRCwKIENQVUhQX1NMVUJfREVBRCwKIENQVUhQX01N
X1dSSVRFQkFDS19ERUFELAogQ1BVSFBfTU1fVk1TVEFUX0RFQUQsCiBDUFVIUF9TT0ZUSVJR
X0RFQUQsCiBDUFVIUF9ORVRfTVZORVRBX0RFQUQsCiBDUFVIUF9DUFVJRExFX0RFQUQsCiBD
UFVIUF9BUk02NF9GUFNJTURfREVBRCwKIENQVUhQX0FSTV9PTUFQX1dBS0VfREVBRCwKIENQ
VUhQX0lSUV9QT0xMX0RFQUQsCiBDUFVIUF9CTE9DS19TT0ZUSVJRX0RFQUQsCiBDUFVIUF9B
Q1BJX0NQVURSVl9ERUFELAogQ1BVSFBfUzM5MF9QRkFVTFRfREVBRCwKIENQVUhQX0JMS19N
UV9ERUFELAogQ1BVSFBfRlNfQlVGRl9ERUFELAogQ1BVSFBfUFJJTlRLX0RFQUQsCiBDUFVI
UF9NTV9NRU1DUV9ERUFELAogQ1BVSFBfUEVSQ1BVX0NOVF9ERUFELAogQ1BVSFBfUkFESVhf
REVBRCwKIENQVUhQX1BBR0VfQUxMT0NfREVBRCwKIENQVUhQX05FVF9ERVZfREVBRCwKIENQ
VUhQX1BDSV9YR0VORV9ERUFELAogQ1BVSFBfSU9NTVVfSU5URUxfREVBRCwKIENQVUhQX0xV
U1RSRV9DRlNfREVBRCwKIENQVUhQX0FQX0FSTV9DQUNIRV9CMTVfUkFDX0RFQUQsCiBDUFVI
UF9QQURBVEFfREVBRCwKIENQVUhQX1dPUktRVUVVRV9QUkVQLAogQ1BVSFBfUE9XRVJfTlVN
QV9QUkVQQVJFLAogQ1BVSFBfSFJUSU1FUlNfUFJFUEFSRSwKIENQVUhQX1BST0ZJTEVfUFJF
UEFSRSwKIENQVUhQX1gyQVBJQ19QUkVQQVJFLAogQ1BVSFBfU01QQ0ZEX1BSRVBBUkUsCiBD
UFVIUF9SRUxBWV9QUkVQQVJFLAogQ1BVSFBfU0xBQl9QUkVQQVJFLAogQ1BVSFBfTURfUkFJ
RDVfUFJFUEFSRSwKIENQVUhQX1JDVVRSRUVfUFJFUCwKIENQVUhQX0NQVUlETEVfQ09VUExF
RF9QUkVQQVJFLAogQ1BVSFBfUE9XRVJQQ19QTUFDX1BSRVBBUkUsCiBDUFVIUF9QT1dFUlBD
X01NVV9DVFhfUFJFUEFSRSwKIENQVUhQX1hFTl9QUkVQQVJFLAogQ1BVSFBfWEVOX0VWVENI
Tl9QUkVQQVJFLAogQ1BVSFBfQVJNX1NITU9CSUxFX1NDVV9QUkVQQVJFLAogQ1BVSFBfU0hf
U0gzWF9QUkVQQVJFLAogQ1BVSFBfTkVUX0ZMT1dfUFJFUEFSRSwKIENQVUhQX1RPUE9MT0dZ
X1BSRVBBUkUsCiBDUFVIUF9ORVRfSVVDVl9QUkVQQVJFLAogQ1BVSFBfQVJNX0JMX1BSRVBB
UkUsCiBDUFVIUF9UUkFDRV9SQl9QUkVQQVJFLAogQ1BVSFBfTU1fWlNfUFJFUEFSRSwKIENQ
VUhQX01NX1pTV1BfTUVNX1BSRVBBUkUsCiBDUFVIUF9NTV9aU1dQX1BPT0xfUFJFUEFSRSwK
IENQVUhQX0tWTV9QUENfQk9PSzNTX1BSRVBBUkUsCiBDUFVIUF9aQ09NUF9QUkVQQVJFLAog
Q1BVSFBfVElNRVJTX1BSRVBBUkUsCiBDUFVIUF9NSVBTX1NPQ19QUkVQQVJFLAogQ1BVSFBf
QlBfUFJFUEFSRV9EWU4sCiBDUFVIUF9CUF9QUkVQQVJFX0RZTl9FTkQgPSBDUFVIUF9CUF9Q
UkVQQVJFX0RZTiArIDIwLAogQ1BVSFBfQlJJTkdVUF9DUFUsCiBDUFVIUF9BUF9JRExFX0RF
QUQsCiBDUFVIUF9BUF9PRkZMSU5FLAogQ1BVSFBfQVBfU0NIRURfU1RBUlRJTkcsCiBDUFVI
UF9BUF9SQ1VUUkVFX0RZSU5HLAogQ1BVSFBfQVBfQ1BVX1BNX1NUQVJUSU5HLAogQ1BVSFBf
QVBfSVJRX0dJQ19TVEFSVElORywKIENQVUhQX0FQX0lSUV9ISVAwNF9TVEFSVElORywKIENQ
VUhQX0FQX0lSUV9BUk1BREFfWFBfU1RBUlRJTkcsCiBDUFVIUF9BUF9JUlFfQkNNMjgzNl9T
VEFSVElORywKIENQVUhQX0FQX0lSUV9NSVBTX0dJQ19TVEFSVElORywKIENQVUhQX0FQX0lS
UV9SSVNDVl9TVEFSVElORywKIENQVUhQX0FQX0lSUV9TSUZJVkVfUExJQ19TVEFSVElORywK
IENQVUhQX0FQX0FSTV9NVkVCVV9DT0hFUkVOQ1ksCiBDUFVIUF9BUF9NSUNST0NPREVfTE9B
REVSLAogQ1BVSFBfQVBfUEVSRl9YODZfQU1EX1VOQ09SRV9TVEFSVElORywKIENQVUhQX0FQ
X1BFUkZfWDg2X1NUQVJUSU5HLAogQ1BVSFBfQVBfUEVSRl9YODZfQU1EX0lCU19TVEFSVElO
RywKIENQVUhQX0FQX1BFUkZfWDg2X0NRTV9TVEFSVElORywKIENQVUhQX0FQX1BFUkZfWDg2
X0NTVEFURV9TVEFSVElORywKIENQVUhQX0FQX1BFUkZfWFRFTlNBX1NUQVJUSU5HLAogQ1BV
SFBfQVBfTUlQU19PUF9MT09OR1NPTjNfU1RBUlRJTkcsCiBDUFVIUF9BUF9BUk1fU0RFSV9T
VEFSVElORywKIENQVUhQX0FQX0FSTV9WRlBfU1RBUlRJTkcsCiBDUFVIUF9BUF9BUk02NF9E
RUJVR19NT05JVE9SU19TVEFSVElORywKIENQVUhQX0FQX1BFUkZfQVJNX0hXX0JSRUFLUE9J
TlRfU1RBUlRJTkcsCiBDUFVIUF9BUF9QRVJGX0FSTV9BQ1BJX1NUQVJUSU5HLAogQ1BVSFBf
QVBfUEVSRl9BUk1fU1RBUlRJTkcsCiBDUFVIUF9BUF9BUk1fTDJYMF9TVEFSVElORywKIENQ
VUhQX0FQX0VYWU5PUzRfTUNUX1RJTUVSX1NUQVJUSU5HLAogQ1BVSFBfQVBfQVJNX0FSQ0hf
VElNRVJfU1RBUlRJTkcsCiBDUFVIUF9BUF9BUk1fR0xPQkFMX1RJTUVSX1NUQVJUSU5HLAog
Q1BVSFBfQVBfSkNPUkVfVElNRVJfU1RBUlRJTkcsCiBDUFVIUF9BUF9BUk1fVFdEX1NUQVJU
SU5HLAogQ1BVSFBfQVBfUUNPTV9USU1FUl9TVEFSVElORywKIENQVUhQX0FQX1RFR1JBX1RJ
TUVSX1NUQVJUSU5HLAogQ1BVSFBfQVBfQVJNQURBX1RJTUVSX1NUQVJUSU5HLAogQ1BVSFBf
QVBfTUFSQ09fVElNRVJfU1RBUlRJTkcsCiBDUFVIUF9BUF9NSVBTX0dJQ19USU1FUl9TVEFS
VElORywKIENQVUhQX0FQX0FSQ19USU1FUl9TVEFSVElORywKIENQVUhQX0FQX1JJU0NWX1RJ
TUVSX1NUQVJUSU5HLAogQ1BVSFBfQVBfQ1NLWV9USU1FUl9TVEFSVElORywKIENQVUhQX0FQ
X0hZUEVSVl9USU1FUl9TVEFSVElORywKIENQVUhQX0FQX0tWTV9TVEFSVElORywKIENQVUhQ
X0FQX0tWTV9BUk1fVkdJQ19JTklUX1NUQVJUSU5HLAogQ1BVSFBfQVBfS1ZNX0FSTV9WR0lD
X1NUQVJUSU5HLAogQ1BVSFBfQVBfS1ZNX0FSTV9USU1FUl9TVEFSVElORywKCiBDUFVIUF9B
UF9EVU1NWV9USU1FUl9TVEFSVElORywKIENQVUhQX0FQX0FSTV9YRU5fU1RBUlRJTkcsCiBD
UFVIUF9BUF9BUk1fS1ZNUFZfU1RBUlRJTkcsCiBDUFVIUF9BUF9BUk1fQ09SRVNJR0hUX1NU
QVJUSU5HLAogQ1BVSFBfQVBfQVJNX0NPUkVTSUdIVF9DVElfU1RBUlRJTkcsCiBDUFVIUF9B
UF9BUk02NF9JU05ERVBfU1RBUlRJTkcsCiBDUFVIUF9BUF9TTVBDRkRfRFlJTkcsCiBDUFVI
UF9BUF9YODZfVEJPT1RfRFlJTkcsCiBDUFVIUF9BUF9BUk1fQ0FDSEVfQjE1X1JBQ19EWUlO
RywKIENQVUhQX0FQX09OTElORSwKIENQVUhQX1RFQVJET1dOX0NQVSwKIENQVUhQX0FQX09O
TElORV9JRExFLAogQ1BVSFBfQVBfU01QQk9PVF9USFJFQURTLAogQ1BVSFBfQVBfWDg2X1ZE
U09fVk1BX09OTElORSwKIENQVUhQX0FQX0lSUV9BRkZJTklUWV9PTkxJTkUsCiBDUFVIUF9B
UF9CTEtfTVFfT05MSU5FLAogQ1BVSFBfQVBfQVJNX01WRUJVX1NZTkNfQ0xPQ0tTLAogQ1BV
SFBfQVBfWDg2X0lOVEVMX0VQQl9PTkxJTkUsCiBDUFVIUF9BUF9QRVJGX09OTElORSwKIENQ
VUhQX0FQX1BFUkZfWDg2X09OTElORSwKIENQVUhQX0FQX1BFUkZfWDg2X1VOQ09SRV9PTkxJ
TkUsCiBDUFVIUF9BUF9QRVJGX1g4Nl9BTURfVU5DT1JFX09OTElORSwKIENQVUhQX0FQX1BF
UkZfWDg2X0FNRF9QT1dFUl9PTkxJTkUsCiBDUFVIUF9BUF9QRVJGX1g4Nl9SQVBMX09OTElO
RSwKIENQVUhQX0FQX1BFUkZfWDg2X0NRTV9PTkxJTkUsCiBDUFVIUF9BUF9QRVJGX1g4Nl9D
U1RBVEVfT05MSU5FLAogQ1BVSFBfQVBfUEVSRl9TMzkwX0NGX09OTElORSwKIENQVUhQX0FQ
X1BFUkZfUzM5MF9TRl9PTkxJTkUsCiBDUFVIUF9BUF9QRVJGX0FSTV9DQ0lfT05MSU5FLAog
Q1BVSFBfQVBfUEVSRl9BUk1fQ0NOX09OTElORSwKIENQVUhQX0FQX1BFUkZfQVJNX0hJU0lf
RERSQ19PTkxJTkUsCiBDUFVIUF9BUF9QRVJGX0FSTV9ISVNJX0hIQV9PTkxJTkUsCiBDUFVI
UF9BUF9QRVJGX0FSTV9ISVNJX0wzX09OTElORSwKIENQVUhQX0FQX1BFUkZfQVJNX0wyWDBf
T05MSU5FLAogQ1BVSFBfQVBfUEVSRl9BUk1fUUNPTV9MMl9PTkxJTkUsCiBDUFVIUF9BUF9Q
RVJGX0FSTV9RQ09NX0wzX09OTElORSwKIENQVUhQX0FQX1BFUkZfQVJNX0FQTV9YR0VORV9P
TkxJTkUsCiBDUFVIUF9BUF9QRVJGX0FSTV9DQVZJVU1fVFgyX1VOQ09SRV9PTkxJTkUsCiBD
UFVIUF9BUF9QRVJGX1BPV0VSUENfTkVTVF9JTUNfT05MSU5FLAogQ1BVSFBfQVBfUEVSRl9Q
T1dFUlBDX0NPUkVfSU1DX09OTElORSwKIENQVUhQX0FQX1BFUkZfUE9XRVJQQ19USFJFQURf
SU1DX09OTElORSwKIENQVUhQX0FQX1BFUkZfUE9XRVJQQ19UUkFDRV9JTUNfT05MSU5FLAog
Q1BVSFBfQVBfV0FUQ0hET0dfT05MSU5FLAogQ1BVSFBfQVBfV09SS1FVRVVFX09OTElORSwK
IENQVUhQX0FQX1JDVVRSRUVfT05MSU5FLAogQ1BVSFBfQVBfQkFTRV9DQUNIRUlORk9fT05M
SU5FLAogQ1BVSFBfQVBfT05MSU5FX0RZTiwKIENQVUhQX0FQX09OTElORV9EWU5fRU5EID0g
Q1BVSFBfQVBfT05MSU5FX0RZTiArIDMwLAogQ1BVSFBfQVBfWDg2X0hQRVRfT05MSU5FLAog
Q1BVSFBfQVBfWDg2X0tWTV9DTEtfT05MSU5FLAogQ1BVSFBfQVBfQUNUSVZFLAogQ1BVSFBf
T05MSU5FLAp9OwoKaW50IF9fY3B1aHBfc2V0dXBfc3RhdGUoZW51bSBjcHVocF9zdGF0ZSBz
dGF0ZSwgY29uc3QgY2hhciAqbmFtZSwgYm9vbCBpbnZva2UsCiAgIGludCAoKnN0YXJ0dXAp
KHVuc2lnbmVkIGludCBjcHUpLAogICBpbnQgKCp0ZWFyZG93bikodW5zaWduZWQgaW50IGNw
dSksIGJvb2wgbXVsdGlfaW5zdGFuY2UpOwoKaW50IF9fY3B1aHBfc2V0dXBfc3RhdGVfY3B1
c2xvY2tlZChlbnVtIGNwdWhwX3N0YXRlIHN0YXRlLCBjb25zdCBjaGFyICpuYW1lLAogICAg
ICAgYm9vbCBpbnZva2UsCiAgICAgICBpbnQgKCpzdGFydHVwKSh1bnNpZ25lZCBpbnQgY3B1
KSwKICAgICAgIGludCAoKnRlYXJkb3duKSh1bnNpZ25lZCBpbnQgY3B1KSwKICAgICAgIGJv
b2wgbXVsdGlfaW5zdGFuY2UpOwojIDIxNSAiLi9pbmNsdWRlL2xpbnV4L2NwdWhvdHBsdWcu
aCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIGludCBjcHVocF9zZXR1cF9zdGF0ZShlbnVtIGNwdWhwX3N0YXRlIHN0
YXRlLAogICAgICAgIGNvbnN0IGNoYXIgKm5hbWUsCiAgICAgICAgaW50ICgqc3RhcnR1cCko
dW5zaWduZWQgaW50IGNwdSksCiAgICAgICAgaW50ICgqdGVhcmRvd24pKHVuc2lnbmVkIGlu
dCBjcHUpKQp7CiByZXR1cm4gX19jcHVocF9zZXR1cF9zdGF0ZShzdGF0ZSwgbmFtZSwgdHJ1
ZSwgc3RhcnR1cCwgdGVhcmRvd24sIGZhbHNlKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBjcHVocF9z
ZXR1cF9zdGF0ZV9jcHVzbG9ja2VkKGVudW0gY3B1aHBfc3RhdGUgc3RhdGUsCiAgICAgICAg
ICAgIGNvbnN0IGNoYXIgKm5hbWUsCiAgICAgICAgICAgIGludCAoKnN0YXJ0dXApKHVuc2ln
bmVkIGludCBjcHUpLAogICAgICAgICAgICBpbnQgKCp0ZWFyZG93bikodW5zaWduZWQgaW50
IGNwdSkpCnsKIHJldHVybiBfX2NwdWhwX3NldHVwX3N0YXRlX2NwdXNsb2NrZWQoc3RhdGUs
IG5hbWUsIHRydWUsIHN0YXJ0dXAsCiAgICAgICAgICAgdGVhcmRvd24sIGZhbHNlKTsKfQoj
IDI0MyAiLi9pbmNsdWRlL2xpbnV4L2NwdWhvdHBsdWcuaCIKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBjcHVo
cF9zZXR1cF9zdGF0ZV9ub2NhbGxzKGVudW0gY3B1aHBfc3RhdGUgc3RhdGUsCiAgICAgICAg
IGNvbnN0IGNoYXIgKm5hbWUsCiAgICAgICAgIGludCAoKnN0YXJ0dXApKHVuc2lnbmVkIGlu
dCBjcHUpLAogICAgICAgICBpbnQgKCp0ZWFyZG93bikodW5zaWduZWQgaW50IGNwdSkpCnsK
IHJldHVybiBfX2NwdWhwX3NldHVwX3N0YXRlKHN0YXRlLCBuYW1lLCBmYWxzZSwgc3RhcnR1
cCwgdGVhcmRvd24sCiAgICAgICBmYWxzZSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgY3B1aHBfc2V0
dXBfc3RhdGVfbm9jYWxsc19jcHVzbG9ja2VkKGVudW0gY3B1aHBfc3RhdGUgc3RhdGUsCiAg
ICAgICAgICAgY29uc3QgY2hhciAqbmFtZSwKICAgICAgICAgICBpbnQgKCpzdGFydHVwKSh1
bnNpZ25lZCBpbnQgY3B1KSwKICAgICAgICAgICBpbnQgKCp0ZWFyZG93bikodW5zaWduZWQg
aW50IGNwdSkpCnsKIHJldHVybiBfX2NwdWhwX3NldHVwX3N0YXRlX2NwdXNsb2NrZWQoc3Rh
dGUsIG5hbWUsIGZhbHNlLCBzdGFydHVwLAogICAgICAgICB0ZWFyZG93biwgZmFsc2UpOwp9
CiMgMjczICIuL2luY2x1ZGUvbGludXgvY3B1aG90cGx1Zy5oIgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGNw
dWhwX3NldHVwX3N0YXRlX211bHRpKGVudW0gY3B1aHBfc3RhdGUgc3RhdGUsCiAgICAgICBj
b25zdCBjaGFyICpuYW1lLAogICAgICAgaW50ICgqc3RhcnR1cCkodW5zaWduZWQgaW50IGNw
dSwKICAgICAgICBzdHJ1Y3QgaGxpc3Rfbm9kZSAqbm9kZSksCiAgICAgICBpbnQgKCp0ZWFy
ZG93bikodW5zaWduZWQgaW50IGNwdSwKICAgICAgICAgc3RydWN0IGhsaXN0X25vZGUgKm5v
ZGUpKQp7CiByZXR1cm4gX19jcHVocF9zZXR1cF9zdGF0ZShzdGF0ZSwgbmFtZSwgZmFsc2Us
CiAgICAgICAodm9pZCAqKSBzdGFydHVwLAogICAgICAgKHZvaWQgKikgdGVhcmRvd24sIHRy
dWUpOwp9CgppbnQgX19jcHVocF9zdGF0ZV9hZGRfaW5zdGFuY2UoZW51bSBjcHVocF9zdGF0
ZSBzdGF0ZSwgc3RydWN0IGhsaXN0X25vZGUgKm5vZGUsCiAgICAgICAgICBib29sIGludm9r
ZSk7CmludCBfX2NwdWhwX3N0YXRlX2FkZF9pbnN0YW5jZV9jcHVzbG9ja2VkKGVudW0gY3B1
aHBfc3RhdGUgc3RhdGUsCiAgICAgICBzdHJ1Y3QgaGxpc3Rfbm9kZSAqbm9kZSwgYm9vbCBp
bnZva2UpOwojIDMwMCAiLi9pbmNsdWRlL2xpbnV4L2NwdWhvdHBsdWcuaCIKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IGludCBjcHVocF9zdGF0ZV9hZGRfaW5zdGFuY2UoZW51bSBjcHVocF9zdGF0ZSBzdGF0ZSwK
ICAgICAgICBzdHJ1Y3QgaGxpc3Rfbm9kZSAqbm9kZSkKewogcmV0dXJuIF9fY3B1aHBfc3Rh
dGVfYWRkX2luc3RhbmNlKHN0YXRlLCBub2RlLCB0cnVlKTsKfQojIDMxNSAiLi9pbmNsdWRl
L2xpbnV4L2NwdWhvdHBsdWcuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBjcHVocF9zdGF0ZV9hZGRfaW5z
dGFuY2Vfbm9jYWxscyhlbnVtIGNwdWhwX3N0YXRlIHN0YXRlLAogICAgICAgICBzdHJ1Y3Qg
aGxpc3Rfbm9kZSAqbm9kZSkKewogcmV0dXJuIF9fY3B1aHBfc3RhdGVfYWRkX2luc3RhbmNl
KHN0YXRlLCBub2RlLCBmYWxzZSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQKY3B1aHBfc3RhdGVfYWRk
X2luc3RhbmNlX25vY2FsbHNfY3B1c2xvY2tlZChlbnVtIGNwdWhwX3N0YXRlIHN0YXRlLAog
ICAgICAgICBzdHJ1Y3QgaGxpc3Rfbm9kZSAqbm9kZSkKewogcmV0dXJuIF9fY3B1aHBfc3Rh
dGVfYWRkX2luc3RhbmNlX2NwdXNsb2NrZWQoc3RhdGUsIG5vZGUsIGZhbHNlKTsKfQoKdm9p
ZCBfX2NwdWhwX3JlbW92ZV9zdGF0ZShlbnVtIGNwdWhwX3N0YXRlIHN0YXRlLCBib29sIGlu
dm9rZSk7CnZvaWQgX19jcHVocF9yZW1vdmVfc3RhdGVfY3B1c2xvY2tlZChlbnVtIGNwdWhw
X3N0YXRlIHN0YXRlLCBib29sIGludm9rZSk7CiMgMzM4ICIuL2luY2x1ZGUvbGludXgvY3B1
aG90cGx1Zy5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBjcHVocF9yZW1vdmVfc3RhdGUoZW51bSBjcHVo
cF9zdGF0ZSBzdGF0ZSkKewogX19jcHVocF9yZW1vdmVfc3RhdGUoc3RhdGUsIHRydWUpOwp9
CgoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSB2b2lkIGNwdWhwX3JlbW92ZV9zdGF0ZV9ub2NhbGxzKGVudW0g
Y3B1aHBfc3RhdGUgc3RhdGUpCnsKIF9fY3B1aHBfcmVtb3ZlX3N0YXRlKHN0YXRlLCBmYWxz
ZSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSB2b2lkIGNwdWhwX3JlbW92ZV9zdGF0ZV9ub2NhbGxzX2NwdXNs
b2NrZWQoZW51bSBjcHVocF9zdGF0ZSBzdGF0ZSkKewogX19jcHVocF9yZW1vdmVfc3RhdGVf
Y3B1c2xvY2tlZChzdGF0ZSwgZmFsc2UpOwp9CiMgMzY2ICIuL2luY2x1ZGUvbGludXgvY3B1
aG90cGx1Zy5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBjcHVocF9yZW1vdmVfbXVsdGlfc3RhdGUoZW51
bSBjcHVocF9zdGF0ZSBzdGF0ZSkKewogX19jcHVocF9yZW1vdmVfc3RhdGUoc3RhdGUsIGZh
bHNlKTsKfQoKaW50IF9fY3B1aHBfc3RhdGVfcmVtb3ZlX2luc3RhbmNlKGVudW0gY3B1aHBf
c3RhdGUgc3RhdGUsCiAgICAgIHN0cnVjdCBobGlzdF9ub2RlICpub2RlLCBib29sIGludm9r
ZSk7CiMgMzgzICIuL2luY2x1ZGUvbGludXgvY3B1aG90cGx1Zy5oIgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50
IGNwdWhwX3N0YXRlX3JlbW92ZV9pbnN0YW5jZShlbnVtIGNwdWhwX3N0YXRlIHN0YXRlLAog
ICAgICAgICAgIHN0cnVjdCBobGlzdF9ub2RlICpub2RlKQp7CiByZXR1cm4gX19jcHVocF9z
dGF0ZV9yZW1vdmVfaW5zdGFuY2Uoc3RhdGUsIG5vZGUsIHRydWUpOwp9CiMgMzk3ICIuL2lu
Y2x1ZGUvbGludXgvY3B1aG90cGx1Zy5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGNwdWhwX3N0YXRlX3Jl
bW92ZV9pbnN0YW5jZV9ub2NhbGxzKGVudW0gY3B1aHBfc3RhdGUgc3RhdGUsCiAgICAgICAg
ICAgIHN0cnVjdCBobGlzdF9ub2RlICpub2RlKQp7CiByZXR1cm4gX19jcHVocF9zdGF0ZV9y
ZW1vdmVfaW5zdGFuY2Uoc3RhdGUsIG5vZGUsIGZhbHNlKTsKfQoKCnZvaWQgY3B1aHBfb25s
aW5lX2lkbGUoZW51bSBjcHVocF9zdGF0ZSBzdGF0ZSk7CiMgMjEgIi4vaW5jbHVkZS9saW51
eC9jcHUuaCIgMgoKc3RydWN0IGRldmljZTsKc3RydWN0IGRldmljZV9ub2RlOwpzdHJ1Y3Qg
YXR0cmlidXRlX2dyb3VwOwoKc3RydWN0IGNwdSB7CiBpbnQgbm9kZV9pZDsKIGludCBob3Rw
bHVnZ2FibGU7CiBzdHJ1Y3QgZGV2aWNlIGRldjsKfTsKCmV4dGVybiB2b2lkIGJvb3RfY3B1
X2luaXQodm9pZCk7CmV4dGVybiB2b2lkIGJvb3RfY3B1X2hvdHBsdWdfaW5pdCh2b2lkKTsK
ZXh0ZXJuIHZvaWQgY3B1X2luaXQodm9pZCk7CmV4dGVybiB2b2lkIHRyYXBfaW5pdCh2b2lk
KTsKCmV4dGVybiBpbnQgcmVnaXN0ZXJfY3B1KHN0cnVjdCBjcHUgKmNwdSwgaW50IG51bSk7
CmV4dGVybiBzdHJ1Y3QgZGV2aWNlICpnZXRfY3B1X2RldmljZSh1bnNpZ25lZCBjcHUpOwpl
eHRlcm4gYm9vbCBjcHVfaXNfaG90cGx1Z2dhYmxlKHVuc2lnbmVkIGNwdSk7CmV4dGVybiBi
b29sIGFyY2hfbWF0Y2hfY3B1X3BoeXNfaWQoaW50IGNwdSwgdTY0IHBoeXNfaWQpOwpleHRl
cm4gYm9vbCBhcmNoX2ZpbmRfbl9tYXRjaF9jcHVfcGh5c2ljYWxfaWQoc3RydWN0IGRldmlj
ZV9ub2RlICpjcHVuLAogICAgICAgICAgIGludCBjcHUsIHVuc2lnbmVkIGludCAqdGhyZWFk
KTsKCmV4dGVybiBpbnQgY3B1X2FkZF9kZXZfYXR0cihzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0
ZSAqYXR0cik7CmV4dGVybiB2b2lkIGNwdV9yZW1vdmVfZGV2X2F0dHIoc3RydWN0IGRldmlj
ZV9hdHRyaWJ1dGUgKmF0dHIpOwoKZXh0ZXJuIGludCBjcHVfYWRkX2Rldl9hdHRyX2dyb3Vw
KHN0cnVjdCBhdHRyaWJ1dGVfZ3JvdXAgKmF0dHJzKTsKZXh0ZXJuIHZvaWQgY3B1X3JlbW92
ZV9kZXZfYXR0cl9ncm91cChzdHJ1Y3QgYXR0cmlidXRlX2dyb3VwICphdHRycyk7CgpleHRl
cm4gc3NpemVfdCBjcHVfc2hvd19tZWx0ZG93bihzdHJ1Y3QgZGV2aWNlICpkZXYsCiAgICAg
c3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsIGNoYXIgKmJ1Zik7CmV4dGVybiBzc2l6
ZV90IGNwdV9zaG93X3NwZWN0cmVfdjEoc3RydWN0IGRldmljZSAqZGV2LAogICAgICAgc3Ry
dWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsIGNoYXIgKmJ1Zik7CmV4dGVybiBzc2l6ZV90
IGNwdV9zaG93X3NwZWN0cmVfdjIoc3RydWN0IGRldmljZSAqZGV2LAogICAgICAgc3RydWN0
IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsIGNoYXIgKmJ1Zik7CmV4dGVybiBzc2l6ZV90IGNw
dV9zaG93X3NwZWNfc3RvcmVfYnlwYXNzKHN0cnVjdCBkZXZpY2UgKmRldiwKICAgICAgIHN0
cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLCBjaGFyICpidWYpOwpleHRlcm4gc3NpemVf
dCBjcHVfc2hvd19sMXRmKHN0cnVjdCBkZXZpY2UgKmRldiwKICAgICAgICBzdHJ1Y3QgZGV2
aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVmKTsKZXh0ZXJuIHNzaXplX3QgY3B1X3No
b3dfbWRzKHN0cnVjdCBkZXZpY2UgKmRldiwKICAgICAgIHN0cnVjdCBkZXZpY2VfYXR0cmli
dXRlICphdHRyLCBjaGFyICpidWYpOwpleHRlcm4gc3NpemVfdCBjcHVfc2hvd190c3hfYXN5
bmNfYWJvcnQoc3RydWN0IGRldmljZSAqZGV2LAogICAgIHN0cnVjdCBkZXZpY2VfYXR0cmli
dXRlICphdHRyLAogICAgIGNoYXIgKmJ1Zik7CmV4dGVybiBzc2l6ZV90IGNwdV9zaG93X2l0
bGJfbXVsdGloaXQoc3RydWN0IGRldmljZSAqZGV2LAogICAgICAgICAgc3RydWN0IGRldmlj
ZV9hdHRyaWJ1dGUgKmF0dHIsIGNoYXIgKmJ1Zik7CgpleHRlcm4gX19hdHRyaWJ1dGVfXygo
X19mb3JtYXRfXyhwcmludGYsIDQsIDUpKSkKc3RydWN0IGRldmljZSAqY3B1X2RldmljZV9j
cmVhdGUoc3RydWN0IGRldmljZSAqcGFyZW50LCB2b2lkICpkcnZkYXRhLAogICAgIGNvbnN0
IHN0cnVjdCBhdHRyaWJ1dGVfZ3JvdXAgKipncm91cHMsCiAgICAgY29uc3QgY2hhciAqZm10
LCAuLi4pOwojIDkwICIuL2luY2x1ZGUvbGludXgvY3B1LmgiCmV4dGVybiBib29sIGNwdWhw
X3Rhc2tzX2Zyb3plbjsKaW50IGFkZF9jcHUodW5zaWduZWQgaW50IGNwdSk7CmludCBjcHVf
ZGV2aWNlX3VwKHN0cnVjdCBkZXZpY2UgKmRldik7CnZvaWQgbm90aWZ5X2NwdV9zdGFydGlu
Zyh1bnNpZ25lZCBpbnQgY3B1KTsKZXh0ZXJuIHZvaWQgY3B1X21hcHNfdXBkYXRlX2JlZ2lu
KHZvaWQpOwpleHRlcm4gdm9pZCBjcHVfbWFwc191cGRhdGVfZG9uZSh2b2lkKTsKaW50IGJy
aW5ndXBfaGliZXJuYXRlX2NwdSh1bnNpZ25lZCBpbnQgc2xlZXBfY3B1KTsKdm9pZCBicmlu
Z3VwX25vbmJvb3RfY3B1cyh1bnNpZ25lZCBpbnQgc2V0dXBfbWF4X2NwdXMpOwojIDExMSAi
Li9pbmNsdWRlL2xpbnV4L2NwdS5oIgpleHRlcm4gc3RydWN0IGJ1c190eXBlIGNwdV9zdWJz
eXM7CiMgMTI5ICIuL2luY2x1ZGUvbGludXgvY3B1LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGNwdXNf
d3JpdGVfbG9jayh2b2lkKSB7IH0Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgY3B1c193cml0ZV91bmxvY2so
dm9pZCkgeyB9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGNwdXNfcmVhZF9sb2NrKHZvaWQpIHsgfQpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgdm9pZCBjcHVzX3JlYWRfdW5sb2NrKHZvaWQpIHsgfQpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGNw
dXNfcmVhZF90cnlsb2NrKHZvaWQpIHsgcmV0dXJuIHRydWU7IH0Kc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQg
bG9ja2RlcF9hc3NlcnRfY3B1c19oZWxkKHZvaWQpIHsgfQpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBjcHVf
aG90cGx1Z19kaXNhYmxlKHZvaWQpIHsgfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBjcHVfaG90cGx1Z19l
bmFibGUodm9pZCkgeyB9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHNtcF9zaHV0ZG93bl9ub25ib290X2Nw
dXModW5zaWduZWQgaW50IHByaW1hcnlfY3B1KSB7IH0KCgoKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgY3B1
X2hvdHBsdWdfYmVnaW4odm9pZCkgeyBjcHVzX3dyaXRlX2xvY2soKTsgfQpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
dm9pZCBjcHVfaG90cGx1Z19kb25lKHZvaWQpIHsgY3B1c193cml0ZV91bmxvY2soKTsgfQpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgdm9pZCBnZXRfb25saW5lX2NwdXModm9pZCkgeyBjcHVzX3JlYWRfbG9jaygp
OyB9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSB2b2lkIHB1dF9vbmxpbmVfY3B1cyh2b2lkKSB7IGNwdXNfcmVhZF91
bmxvY2soKTsgfQojIDE2NSAiLi9pbmNsdWRlL2xpbnV4L2NwdS5oIgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9p
ZCB0aGF3X3NlY29uZGFyeV9jcHVzKHZvaWQpIHt9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgc3VzcGVuZF9k
aXNhYmxlX3NlY29uZGFyeV9jcHVzKHZvaWQpIHsgcmV0dXJuIDA7IH0Kc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZv
aWQgc3VzcGVuZF9lbmFibGVfc2Vjb25kYXJ5X2NwdXModm9pZCkgeyB9CgoKdm9pZCBjcHVf
c3RhcnR1cF9lbnRyeShlbnVtIGNwdWhwX3N0YXRlIHN0YXRlKTsKCnZvaWQgY3B1X2lkbGVf
cG9sbF9jdHJsKGJvb2wgZW5hYmxlKTsKCgoKCmJvb2wgY3B1X2luX2lkbGUodW5zaWduZWQg
bG9uZyBwYyk7Cgp2b2lkIGFyY2hfY3B1X2lkbGUodm9pZCk7CnZvaWQgYXJjaF9jcHVfaWRs
ZV9wcmVwYXJlKHZvaWQpOwp2b2lkIGFyY2hfY3B1X2lkbGVfZW50ZXIodm9pZCk7CnZvaWQg
YXJjaF9jcHVfaWRsZV9leGl0KHZvaWQpOwp2b2lkIGFyY2hfY3B1X2lkbGVfZGVhZCh2b2lk
KTsKCmludCBjcHVfcmVwb3J0X3N0YXRlKGludCBjcHUpOwppbnQgY3B1X2NoZWNrX3VwX3By
ZXBhcmUoaW50IGNwdSk7CnZvaWQgY3B1X3NldF9zdGF0ZV9vbmxpbmUoaW50IGNwdSk7CnZv
aWQgcGxheV9pZGxlX3ByZWNpc2UodTY0IGR1cmF0aW9uX25zLCB1NjQgbGF0ZW5jeV9ucyk7
CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgdm9pZCBwbGF5X2lkbGUodW5zaWduZWQgbG9uZyBkdXJhdGlvbl91cykK
ewogcGxheV9pZGxlX3ByZWNpc2UoZHVyYXRpb25fdXMgKiAxMDAwTCwgKCh1NjQpfjBVTEwp
KTsKfQoKCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBjcHVocF9yZXBvcnRfaWRsZV9kZWFkKHZvaWQp
IHsgfQoKCmVudW0gY3B1aHBfc210X2NvbnRyb2wgewogQ1BVX1NNVF9FTkFCTEVELAogQ1BV
X1NNVF9ESVNBQkxFRCwKIENQVV9TTVRfRk9SQ0VfRElTQUJMRUQsCiBDUFVfU01UX05PVF9T
VVBQT1JURUQsCiBDUFVfU01UX05PVF9JTVBMRU1FTlRFRCwKfTsKIyAyMjAgIi4vaW5jbHVk
ZS9saW51eC9jcHUuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgY3B1X3NtdF9kaXNhYmxlKGJvb2wgZm9y
Y2UpIHsgfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBjcHVfc210X2NoZWNrX3RvcG9sb2d5KHZvaWQpIHsg
fQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgYm9vbCBjcHVfc210X3Bvc3NpYmxlKHZvaWQpIHsgcmV0dXJuIGZhbHNl
OyB9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSBpbnQgY3B1aHBfc210X2VuYWJsZSh2b2lkKSB7IHJldHVybiAwOyB9
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSBpbnQgY3B1aHBfc210X2Rpc2FibGUoZW51bSBjcHVocF9zbXRfY29udHJv
bCBjdHJsdmFsKSB7IHJldHVybiAwOyB9CgoKZXh0ZXJuIGJvb2wgY3B1X21pdGlnYXRpb25z
X29mZih2b2lkKTsKZXh0ZXJuIGJvb2wgY3B1X21pdGlnYXRpb25zX2F1dG9fbm9zbXQodm9p
ZCk7CiMgNTEgIi4vaW5jbHVkZS9saW51eC9wZXJmX2V2ZW50LmgiIDIKIyAxICIuL2luY2x1
ZGUvbGludXgvaXJxX3dvcmsuaCIgMQojIDE2ICIuL2luY2x1ZGUvbGludXgvaXJxX3dvcmsu
aCIKc3RydWN0IGlycV93b3JrIHsKIHVuaW9uIHsKICBzdHJ1Y3QgX19jYWxsX3NpbmdsZV9u
b2RlIG5vZGU7CiAgc3RydWN0IHsKICAgc3RydWN0IGxsaXN0X25vZGUgbGxub2RlOwogICBh
dG9taWNfdCBmbGFnczsKICB9OwogfTsKIHZvaWQgKCpmdW5jKShzdHJ1Y3QgaXJxX3dvcmsg
Kik7Cn07CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkKdm9pZCBpbml0X2lycV93b3JrKHN0cnVjdCBpcnFfd29yayAq
d29yaywgdm9pZCAoKmZ1bmMpKHN0cnVjdCBpcnFfd29yayAqKSkKewogYXRvbWljX3NldCgm
d29yay0+ZmxhZ3MsIDApOwogd29yay0+ZnVuYyA9IGZ1bmM7Cn0KCgoKCgoKCmJvb2wgaXJx
X3dvcmtfcXVldWUoc3RydWN0IGlycV93b3JrICp3b3JrKTsKYm9vbCBpcnFfd29ya19xdWV1
ZV9vbihzdHJ1Y3QgaXJxX3dvcmsgKndvcmssIGludCBjcHUpOwoKdm9pZCBpcnFfd29ya190
aWNrKHZvaWQpOwp2b2lkIGlycV93b3JrX3N5bmMoc3RydWN0IGlycV93b3JrICp3b3JrKTsK
CgojIDEgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2lycV93b3JrLmgiIDEKCgoKCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSBib29sIGFyY2hfaXJxX3dvcmtfaGFzX2ludGVycnVwdCh2b2lkKQp7CiByZXR1
cm4gdHJ1ZTsKfQpleHRlcm4gdm9pZCBhcmNoX2lycV93b3JrX3JhaXNlKHZvaWQpOwojIDQ4
ICIuL2luY2x1ZGUvbGludXgvaXJxX3dvcmsuaCIgMgoKdm9pZCBpcnFfd29ya19ydW4odm9p
ZCk7CmJvb2wgaXJxX3dvcmtfbmVlZHNfY3B1KHZvaWQpOwp2b2lkIGlycV93b3JrX3Npbmds
ZSh2b2lkICphcmcpOwojIDUyICIuL2luY2x1ZGUvbGludXgvcGVyZl9ldmVudC5oIiAyCiMg
MSAiLi9pbmNsdWRlL2xpbnV4L3N0YXRpY19rZXkuaCIgMQojIDUzICIuL2luY2x1ZGUvbGlu
dXgvcGVyZl9ldmVudC5oIiAyCiMgMSAiLi9pbmNsdWRlL2xpbnV4L2p1bXBfbGFiZWxfcmF0
ZWxpbWl0LmgiIDEKIyA2NCAiLi9pbmNsdWRlL2xpbnV4L2p1bXBfbGFiZWxfcmF0ZWxpbWl0
LmgiCnN0cnVjdCBzdGF0aWNfa2V5X2RlZmVycmVkIHsKIHN0cnVjdCBzdGF0aWNfa2V5IGtl
eTsKfTsKc3RydWN0IHN0YXRpY19rZXlfdHJ1ZV9kZWZlcnJlZCB7CiBzdHJ1Y3Qgc3RhdGlj
X2tleV90cnVlIGtleTsKfTsKc3RydWN0IHN0YXRpY19rZXlfZmFsc2VfZGVmZXJyZWQgewog
c3RydWN0IHN0YXRpY19rZXlfZmFsc2Uga2V5Owp9OwoKCgoKCgoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQg
c3RhdGljX2tleV9zbG93X2RlY19kZWZlcnJlZChzdHJ1Y3Qgc3RhdGljX2tleV9kZWZlcnJl
ZCAqa2V5KQp7CiAoeyBpbnQgX19yZXRfd2Fybl9vbiA9ICEhKCFzdGF0aWNfa2V5X2luaXRp
YWxpemVkKTsgaWYgKF9fYnVpbHRpbl9leHBlY3QoISEoX19yZXRfd2Fybl9vbiksIDApKSBk
byB7IGRvIHsgfSB3aGlsZSgwKTsgX193YXJuX3ByaW50aygiJXMoKTogc3RhdGljIGtleSAn
JXBTJyB1c2VkIGJlZm9yZSBjYWxsIHRvIGp1bXBfbGFiZWxfaW5pdCgpIiwgX19mdW5jX18s
IChrZXkpKTsgX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgkiICJ0d2kgMzEsIDAsIDAiICJc
biIgIi5zZWN0aW9uIF9fYnVnX3RhYmxlLFwiYXdcIlxuIiAiMjpcdCIgIi44Ynl0ZSIgIiAi
ICIxYiwgJTBcbiIgIlx0LnNob3J0ICUxLCAlMlxuIiAiLm9yZyAyYislM1xuIiAiLnByZXZp
b3VzXG4iIDogOiAiaSIgKCIuL2luY2x1ZGUvbGludXgvanVtcF9sYWJlbF9yYXRlbGltaXQu
aCIpLCAiaSIgKDgyKSwgImkiICgoMSA8PCAwKSB8ICgoMSA8PCAzKSB8ICgoOSkgPDwgOCkp
KSwgImkiIChzaXplb2Yoc3RydWN0IGJ1Z19lbnRyeSkpKTsgZG8geyB9IHdoaWxlKDApOyB9
IHdoaWxlICgwKTsgX19idWlsdGluX2V4cGVjdCghIShfX3JldF93YXJuX29uKSwgMCk7IH0p
Owogc3RhdGljX2tleV9zbG93X2RlYygma2V5LT5rZXkpOwp9CnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHN0
YXRpY19rZXlfZGVmZXJyZWRfZmx1c2godm9pZCAqa2V5KQp7CiAoeyBpbnQgX19yZXRfd2Fy
bl9vbiA9ICEhKCFzdGF0aWNfa2V5X2luaXRpYWxpemVkKTsgaWYgKF9fYnVpbHRpbl9leHBl
Y3QoISEoX19yZXRfd2Fybl9vbiksIDApKSBkbyB7IGRvIHsgfSB3aGlsZSgwKTsgX193YXJu
X3ByaW50aygiJXMoKTogc3RhdGljIGtleSAnJXBTJyB1c2VkIGJlZm9yZSBjYWxsIHRvIGp1
bXBfbGFiZWxfaW5pdCgpIiwgX19mdW5jX18sIChrZXkpKTsgX19hc21fXyBfX3ZvbGF0aWxl
X18oICIxOgkiICJ0d2kgMzEsIDAsIDAiICJcbiIgIi5zZWN0aW9uIF9fYnVnX3RhYmxlLFwi
YXdcIlxuIiAiMjpcdCIgIi44Ynl0ZSIgIiAiICIxYiwgJTBcbiIgIlx0LnNob3J0ICUxLCAl
MlxuIiAiLm9yZyAyYislM1xuIiAiLnByZXZpb3VzXG4iIDogOiAiaSIgKCIuL2luY2x1ZGUv
bGludXgvanVtcF9sYWJlbF9yYXRlbGltaXQuaCIpLCAiaSIgKDg3KSwgImkiICgoMSA8PCAw
KSB8ICgoMSA8PCAzKSB8ICgoOSkgPDwgOCkpKSwgImkiIChzaXplb2Yoc3RydWN0IGJ1Z19l
bnRyeSkpKTsgZG8geyB9IHdoaWxlKDApOyB9IHdoaWxlICgwKTsgX19idWlsdGluX2V4cGVj
dCghIShfX3JldF93YXJuX29uKSwgMCk7IH0pOwp9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkCmp1bXBfbGFi
ZWxfcmF0ZV9saW1pdChzdHJ1Y3Qgc3RhdGljX2tleV9kZWZlcnJlZCAqa2V5LAogIHVuc2ln
bmVkIGxvbmcgcmwpCnsKICh7IGludCBfX3JldF93YXJuX29uID0gISEoIXN0YXRpY19rZXlf
aW5pdGlhbGl6ZWQpOyBpZiAoX19idWlsdGluX2V4cGVjdCghIShfX3JldF93YXJuX29uKSwg
MCkpIGRvIHsgZG8geyB9IHdoaWxlKDApOyBfX3dhcm5fcHJpbnRrKCIlcygpOiBzdGF0aWMg
a2V5ICclcFMnIHVzZWQgYmVmb3JlIGNhbGwgdG8ganVtcF9sYWJlbF9pbml0KCkiLCBfX2Z1
bmNfXywgKGtleSkpOyBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CSIgInR3aSAzMSwgMCwg
MCIgIlxuIiAiLnNlY3Rpb24gX19idWdfdGFibGUsXCJhd1wiXG4iICIyOlx0IiAiLjhieXRl
IiAiICIgIjFiLCAlMFxuIiAiXHQuc2hvcnQgJTEsICUyXG4iICIub3JnIDJiKyUzXG4iICIu
cHJldmlvdXNcbiIgOiA6ICJpIiAoIi4vaW5jbHVkZS9saW51eC9qdW1wX2xhYmVsX3JhdGVs
aW1pdC5oIiksICJpIiAoOTMpLCAiaSIgKCgxIDw8IDApIHwgKCgxIDw8IDMpIHwgKCg5KSA8
PCA4KSkpLCAiaSIgKHNpemVvZihzdHJ1Y3QgYnVnX2VudHJ5KSkpOyBkbyB7IH0gd2hpbGUo
MCk7IH0gd2hpbGUgKDApOyBfX2J1aWx0aW5fZXhwZWN0KCEhKF9fcmV0X3dhcm5fb24pLCAw
KTsgfSk7Cn0KIyA1NCAiLi9pbmNsdWRlL2xpbnV4L3BlcmZfZXZlbnQuaCIgMgoKCiMgMSAi
Li9pbmNsdWRlL2xpbnV4L3BlcmZfcmVncy5oIiAxCgoKCgojIDEgIi4vaW5jbHVkZS9saW51
eC9zY2hlZC90YXNrX3N0YWNrLmgiIDEKIyAxMCAiLi9pbmNsdWRlL2xpbnV4L3NjaGVkL3Rh
c2tfc3RhY2suaCIKIyAxICIuL2luY2x1ZGUvdWFwaS9saW51eC9tYWdpYy5oIiAxCiMgMTEg
Ii4vaW5jbHVkZS9saW51eC9zY2hlZC90YXNrX3N0YWNrLmgiIDIKIyAxOSAiLi9pbmNsdWRl
L2xpbnV4L3NjaGVkL3Rhc2tfc3RhY2suaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgKnRhc2tfc3RhY2tf
cGFnZShjb25zdCBzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRhc2spCnsKIHJldHVybiB0YXNrLT5z
dGFjazsKfQoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgbG9uZyAqZW5kX29mX3N0YWNrKGNvbnN0
IHN0cnVjdCB0YXNrX3N0cnVjdCAqdGFzaykKewogcmV0dXJuIHRhc2stPnN0YWNrOwp9CiMg
NjIgIi4vaW5jbHVkZS9saW51eC9zY2hlZC90YXNrX3N0YWNrLmgiCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lk
ICp0cnlfZ2V0X3Rhc2tfc3RhY2soc3RydWN0IHRhc2tfc3RydWN0ICp0c2spCnsKIHJldHVy
biByZWZjb3VudF9pbmNfbm90X3plcm8oJnRzay0+c3RhY2tfcmVmY291bnQpID8KICB0YXNr
X3N0YWNrX3BhZ2UodHNrKSA6ICgodm9pZCAqKTApOwp9CgpleHRlcm4gdm9pZCBwdXRfdGFz
a19zdGFjayhzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRzayk7CiMgODEgIi4vaW5jbHVkZS9saW51
eC9zY2hlZC90YXNrX3N0YWNrLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgb2JqZWN0X2lzX29uX3N0YWNr
KGNvbnN0IHZvaWQgKm9iaikKewogdm9pZCAqc3RhY2sgPSB0YXNrX3N0YWNrX3BhZ2UoZ2V0
X2N1cnJlbnQoKSk7CgogcmV0dXJuIChvYmogPj0gc3RhY2spICYmIChvYmogPCAoc3RhY2sg
KyAoMSA8PCAxNCkpKTsKfQoKZXh0ZXJuIHZvaWQgdGhyZWFkX3N0YWNrX2NhY2hlX2luaXQo
dm9pZCk7CiMgMTEwICIuL2luY2x1ZGUvbGludXgvc2NoZWQvdGFza19zdGFjay5oIgpleHRl
cm4gdm9pZCBzZXRfdGFza19zdGFja19lbmRfbWFnaWMoc3RydWN0IHRhc2tfc3RydWN0ICp0
c2spOwoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSBpbnQga3N0YWNrX2VuZCh2b2lkICphZGRyKQp7CgoKCiByZXR1
cm4gISgoKHVuc2lnbmVkIGxvbmcpYWRkcitzaXplb2Yodm9pZCopLTEpICYgKCgxIDw8IDE0
KS1zaXplb2Yodm9pZCopKSk7Cn0KIyA2ICIuL2luY2x1ZGUvbGludXgvcGVyZl9yZWdzLmgi
IDIKCnN0cnVjdCBwZXJmX3JlZ3MgewogX191NjQgYWJpOwogc3RydWN0IHB0X3JlZ3MgKnJl
Z3M7Cn07CgoKIyAxICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL3VhcGkvYXNtL3BlcmZfcmVn
cy5oIiAxCgoKCgplbnVtIHBlcmZfZXZlbnRfcG93ZXJwY19yZWdzIHsKIFBFUkZfUkVHX1BP
V0VSUENfUjAsCiBQRVJGX1JFR19QT1dFUlBDX1IxLAogUEVSRl9SRUdfUE9XRVJQQ19SMiwK
IFBFUkZfUkVHX1BPV0VSUENfUjMsCiBQRVJGX1JFR19QT1dFUlBDX1I0LAogUEVSRl9SRUdf
UE9XRVJQQ19SNSwKIFBFUkZfUkVHX1BPV0VSUENfUjYsCiBQRVJGX1JFR19QT1dFUlBDX1I3
LAogUEVSRl9SRUdfUE9XRVJQQ19SOCwKIFBFUkZfUkVHX1BPV0VSUENfUjksCiBQRVJGX1JF
R19QT1dFUlBDX1IxMCwKIFBFUkZfUkVHX1BPV0VSUENfUjExLAogUEVSRl9SRUdfUE9XRVJQ
Q19SMTIsCiBQRVJGX1JFR19QT1dFUlBDX1IxMywKIFBFUkZfUkVHX1BPV0VSUENfUjE0LAog
UEVSRl9SRUdfUE9XRVJQQ19SMTUsCiBQRVJGX1JFR19QT1dFUlBDX1IxNiwKIFBFUkZfUkVH
X1BPV0VSUENfUjE3LAogUEVSRl9SRUdfUE9XRVJQQ19SMTgsCiBQRVJGX1JFR19QT1dFUlBD
X1IxOSwKIFBFUkZfUkVHX1BPV0VSUENfUjIwLAogUEVSRl9SRUdfUE9XRVJQQ19SMjEsCiBQ
RVJGX1JFR19QT1dFUlBDX1IyMiwKIFBFUkZfUkVHX1BPV0VSUENfUjIzLAogUEVSRl9SRUdf
UE9XRVJQQ19SMjQsCiBQRVJGX1JFR19QT1dFUlBDX1IyNSwKIFBFUkZfUkVHX1BPV0VSUENf
UjI2LAogUEVSRl9SRUdfUE9XRVJQQ19SMjcsCiBQRVJGX1JFR19QT1dFUlBDX1IyOCwKIFBF
UkZfUkVHX1BPV0VSUENfUjI5LAogUEVSRl9SRUdfUE9XRVJQQ19SMzAsCiBQRVJGX1JFR19Q
T1dFUlBDX1IzMSwKIFBFUkZfUkVHX1BPV0VSUENfTklQLAogUEVSRl9SRUdfUE9XRVJQQ19N
U1IsCiBQRVJGX1JFR19QT1dFUlBDX09SSUdfUjMsCiBQRVJGX1JFR19QT1dFUlBDX0NUUiwK
IFBFUkZfUkVHX1BPV0VSUENfTElOSywKIFBFUkZfUkVHX1BPV0VSUENfWEVSLAogUEVSRl9S
RUdfUE9XRVJQQ19DQ1IsCiBQRVJGX1JFR19QT1dFUlBDX1NPRlRFLAogUEVSRl9SRUdfUE9X
RVJQQ19UUkFQLAogUEVSRl9SRUdfUE9XRVJQQ19EQVIsCiBQRVJGX1JFR19QT1dFUlBDX0RT
SVNSLAogUEVSRl9SRUdfUE9XRVJQQ19TSUVSLAogUEVSRl9SRUdfUE9XRVJQQ19NTUNSQSwK
IFBFUkZfUkVHX1BPV0VSUENfTUFYLAp9OwojIDE0ICIuL2luY2x1ZGUvbGludXgvcGVyZl9y
ZWdzLmgiIDIKCgoKCgp1NjQgcGVyZl9yZWdfdmFsdWUoc3RydWN0IHB0X3JlZ3MgKnJlZ3Ms
IGludCBpZHgpOwppbnQgcGVyZl9yZWdfdmFsaWRhdGUodTY0IG1hc2spOwp1NjQgcGVyZl9y
ZWdfYWJpKHN0cnVjdCB0YXNrX3N0cnVjdCAqdGFzayk7CnZvaWQgcGVyZl9nZXRfcmVnc191
c2VyKHN0cnVjdCBwZXJmX3JlZ3MgKnJlZ3NfdXNlciwKICAgc3RydWN0IHB0X3JlZ3MgKnJl
Z3MsCiAgIHN0cnVjdCBwdF9yZWdzICpyZWdzX3VzZXJfY29weSk7CiMgNTcgIi4vaW5jbHVk
ZS9saW51eC9wZXJmX2V2ZW50LmgiIDIKIyAxICIuL2luY2x1ZGUvbGludXgvY2dyb3VwLmgi
IDEKIyAxNiAiLi9pbmNsdWRlL2xpbnV4L2Nncm91cC5oIgojIDEgIi4vaW5jbHVkZS91YXBp
L2xpbnV4L2Nncm91cHN0YXRzLmgiIDEKIyAyMCAiLi9pbmNsdWRlL3VhcGkvbGludXgvY2dy
b3Vwc3RhdHMuaCIKIyAxICIuL2luY2x1ZGUvdWFwaS9saW51eC90YXNrc3RhdHMuaCIgMQoj
IDQxICIuL2luY2x1ZGUvdWFwaS9saW51eC90YXNrc3RhdHMuaCIKc3RydWN0IHRhc2tzdGF0
cyB7CgoKCgoKIF9fdTE2IHZlcnNpb247CiBfX3UzMiBhY19leGl0Y29kZTsKCgoKCiBfX3U4
IGFjX2ZsYWc7CiBfX3U4IGFjX25pY2U7CiMgNzIgIi4vaW5jbHVkZS91YXBpL2xpbnV4L3Rh
c2tzdGF0cy5oIgogX191NjQgY3B1X2NvdW50IF9fYXR0cmlidXRlX18oKGFsaWduZWQoOCkp
KTsKIF9fdTY0IGNwdV9kZWxheV90b3RhbDsKCgoKCgoKIF9fdTY0IGJsa2lvX2NvdW50Owog
X191NjQgYmxraW9fZGVsYXlfdG90YWw7CgoKIF9fdTY0IHN3YXBpbl9jb3VudDsKIF9fdTY0
IHN3YXBpbl9kZWxheV90b3RhbDsKCgoKCgoKCiBfX3U2NCBjcHVfcnVuX3JlYWxfdG90YWw7
CgoKCgoKCgogX191NjQgY3B1X3J1bl92aXJ0dWFsX3RvdGFsOwoKCgoKIGNoYXIgYWNfY29t
bVszMl07CiBfX3U4IGFjX3NjaGVkIF9fYXR0cmlidXRlX18oKGFsaWduZWQoOCkpKTsKCiBf
X3U4IGFjX3BhZFszXTsKIF9fdTMyIGFjX3VpZCBfX2F0dHJpYnV0ZV9fKChhbGlnbmVkKDgp
KSk7CgogX191MzIgYWNfZ2lkOwogX191MzIgYWNfcGlkOwogX191MzIgYWNfcHBpZDsKCiBf
X3UzMiBhY19idGltZTsKIF9fdTY0IGFjX2V0aW1lIF9fYXR0cmlidXRlX18oKGFsaWduZWQo
OCkpKTsKCiBfX3U2NCBhY191dGltZTsKIF9fdTY0IGFjX3N0aW1lOwogX191NjQgYWNfbWlu
Zmx0OwogX191NjQgYWNfbWFqZmx0OwojIDEzMiAiLi9pbmNsdWRlL3VhcGkvbGludXgvdGFz
a3N0YXRzLmgiCiBfX3U2NCBjb3JlbWVtOwoKCgogX191NjQgdmlydG1lbTsKCgoKCiBfX3U2
NCBoaXdhdGVyX3JzczsKIF9fdTY0IGhpd2F0ZXJfdm07CgoKIF9fdTY0IHJlYWRfY2hhcjsK
IF9fdTY0IHdyaXRlX2NoYXI7CiBfX3U2NCByZWFkX3N5c2NhbGxzOwogX191NjQgd3JpdGVf
c3lzY2FsbHM7CgoKCgogX191NjQgcmVhZF9ieXRlczsKIF9fdTY0IHdyaXRlX2J5dGVzOwog
X191NjQgY2FuY2VsbGVkX3dyaXRlX2J5dGVzOwoKIF9fdTY0IG52Y3N3OwogX191NjQgbml2
Y3N3OwoKCiBfX3U2NCBhY191dGltZXNjYWxlZDsKIF9fdTY0IGFjX3N0aW1lc2NhbGVkOwog
X191NjQgY3B1X3NjYWxlZF9ydW5fcmVhbF90b3RhbDsKCgogX191NjQgZnJlZXBhZ2VzX2Nv
dW50OwogX191NjQgZnJlZXBhZ2VzX2RlbGF5X3RvdGFsOwoKCiBfX3U2NCB0aHJhc2hpbmdf
Y291bnQ7CiBfX3U2NCB0aHJhc2hpbmdfZGVsYXlfdG90YWw7CgoKIF9fdTY0IGFjX2J0aW1l
NjQ7Cn07CiMgMTg0ICIuL2luY2x1ZGUvdWFwaS9saW51eC90YXNrc3RhdHMuaCIKZW51bSB7
CiBUQVNLU1RBVFNfQ01EX1VOU1BFQyA9IDAsCiBUQVNLU1RBVFNfQ01EX0dFVCwKIFRBU0tT
VEFUU19DTURfTkVXLAogX19UQVNLU1RBVFNfQ01EX01BWCwKfTsKCgoKZW51bSB7CiBUQVNL
U1RBVFNfVFlQRV9VTlNQRUMgPSAwLAogVEFTS1NUQVRTX1RZUEVfUElELAogVEFTS1NUQVRT
X1RZUEVfVEdJRCwKIFRBU0tTVEFUU19UWVBFX1NUQVRTLAogVEFTS1NUQVRTX1RZUEVfQUdH
Ul9QSUQsCiBUQVNLU1RBVFNfVFlQRV9BR0dSX1RHSUQsCiBUQVNLU1RBVFNfVFlQRV9OVUxM
LAogX19UQVNLU1RBVFNfVFlQRV9NQVgsCn07CgoKCmVudW0gewogVEFTS1NUQVRTX0NNRF9B
VFRSX1VOU1BFQyA9IDAsCiBUQVNLU1RBVFNfQ01EX0FUVFJfUElELAogVEFTS1NUQVRTX0NN
RF9BVFRSX1RHSUQsCiBUQVNLU1RBVFNfQ01EX0FUVFJfUkVHSVNURVJfQ1BVTUFTSywKIFRB
U0tTVEFUU19DTURfQVRUUl9ERVJFR0lTVEVSX0NQVU1BU0ssCiBfX1RBU0tTVEFUU19DTURf
QVRUUl9NQVgsCn07CiMgMjEgIi4vaW5jbHVkZS91YXBpL2xpbnV4L2Nncm91cHN0YXRzLmgi
IDIKIyAzMiAiLi9pbmNsdWRlL3VhcGkvbGludXgvY2dyb3Vwc3RhdHMuaCIKc3RydWN0IGNn
cm91cHN0YXRzIHsKIF9fdTY0IG5yX3NsZWVwaW5nOwogX191NjQgbnJfcnVubmluZzsKIF9f
dTY0IG5yX3N0b3BwZWQ7CiBfX3U2NCBucl91bmludGVycnVwdGlibGU7CgogX191NjQgbnJf
aW9fd2FpdDsKfTsKCgoKCgoKCmVudW0gewogQ0dST1VQU1RBVFNfQ01EX1VOU1BFQyA9IF9f
VEFTS1NUQVRTX0NNRF9NQVgsCiBDR1JPVVBTVEFUU19DTURfR0VULAogQ0dST1VQU1RBVFNf
Q01EX05FVywKIF9fQ0dST1VQU1RBVFNfQ01EX01BWCwKfTsKCgoKZW51bSB7CiBDR1JPVVBT
VEFUU19UWVBFX1VOU1BFQyA9IDAsCiBDR1JPVVBTVEFUU19UWVBFX0NHUk9VUF9TVEFUUywK
IF9fQ0dST1VQU1RBVFNfVFlQRV9NQVgsCn07CgoKCmVudW0gewogQ0dST1VQU1RBVFNfQ01E
X0FUVFJfVU5TUEVDID0gMCwKIENHUk9VUFNUQVRTX0NNRF9BVFRSX0ZELAogX19DR1JPVVBT
VEFUU19DTURfQVRUUl9NQVgsCn07CiMgMTcgIi4vaW5jbHVkZS9saW51eC9jZ3JvdXAuaCIg
MgoKCgoKCgoKIyAxICIuL2luY2x1ZGUvbGludXgvdXNlcl9uYW1lc3BhY2UuaCIgMQojIDE3
ICIuL2luY2x1ZGUvbGludXgvdXNlcl9uYW1lc3BhY2UuaCIKc3RydWN0IHVpZF9naWRfZXh0
ZW50IHsKIHUzMiBmaXJzdDsKIHUzMiBsb3dlcl9maXJzdDsKIHUzMiBjb3VudDsKfTsKCnN0
cnVjdCB1aWRfZ2lkX21hcCB7CiB1MzIgbnJfZXh0ZW50czsKIHVuaW9uIHsKICBzdHJ1Y3Qg
dWlkX2dpZF9leHRlbnQgZXh0ZW50WzVdOwogIHN0cnVjdCB7CiAgIHN0cnVjdCB1aWRfZ2lk
X2V4dGVudCAqZm9yd2FyZDsKICAgc3RydWN0IHVpZF9naWRfZXh0ZW50ICpyZXZlcnNlOwog
IH07CiB9Owp9OwoKCgoKCnN0cnVjdCB1Y291bnRzOwoKZW51bSB1Y291bnRfdHlwZSB7CiBV
Q09VTlRfVVNFUl9OQU1FU1BBQ0VTLAogVUNPVU5UX1BJRF9OQU1FU1BBQ0VTLAogVUNPVU5U
X1VUU19OQU1FU1BBQ0VTLAogVUNPVU5UX0lQQ19OQU1FU1BBQ0VTLAogVUNPVU5UX05FVF9O
QU1FU1BBQ0VTLAogVUNPVU5UX01OVF9OQU1FU1BBQ0VTLAogVUNPVU5UX0NHUk9VUF9OQU1F
U1BBQ0VTLAogVUNPVU5UX1RJTUVfTkFNRVNQQUNFUywKCiBVQ09VTlRfSU5PVElGWV9JTlNU
QU5DRVMsCiBVQ09VTlRfSU5PVElGWV9XQVRDSEVTLAoKIFVDT1VOVF9DT1VOVFMsCn07Cgpz
dHJ1Y3QgdXNlcl9uYW1lc3BhY2Ugewogc3RydWN0IHVpZF9naWRfbWFwIHVpZF9tYXA7CiBz
dHJ1Y3QgdWlkX2dpZF9tYXAgZ2lkX21hcDsKIHN0cnVjdCB1aWRfZ2lkX21hcCBwcm9qaWRf
bWFwOwogYXRvbWljX3QgY291bnQ7CiBzdHJ1Y3QgdXNlcl9uYW1lc3BhY2UgKnBhcmVudDsK
IGludCBsZXZlbDsKIGt1aWRfdCBvd25lcjsKIGtnaWRfdCBncm91cDsKIHN0cnVjdCBuc19j
b21tb24gbnM7CiB1bnNpZ25lZCBsb25nIGZsYWdzOwoKCgoKCgoKIHN0cnVjdCBsaXN0X2hl
YWQga2V5cmluZ19uYW1lX2xpc3Q7CiBzdHJ1Y3Qga2V5ICp1c2VyX2tleXJpbmdfcmVnaXN0
ZXI7CiBzdHJ1Y3Qgcndfc2VtYXBob3JlIGtleXJpbmdfc2VtOwoKCgoKCgogc3RydWN0IHdv
cmtfc3RydWN0IHdvcms7Cgogc3RydWN0IGN0bF90YWJsZV9zZXQgc2V0Owogc3RydWN0IGN0
bF90YWJsZV9oZWFkZXIgKnN5c2N0bHM7Cgogc3RydWN0IHVjb3VudHMgKnVjb3VudHM7CiBp
bnQgdWNvdW50X21heFtVQ09VTlRfQ09VTlRTXTsKfSA7CgpzdHJ1Y3QgdWNvdW50cyB7CiBz
dHJ1Y3QgaGxpc3Rfbm9kZSBub2RlOwogc3RydWN0IHVzZXJfbmFtZXNwYWNlICpuczsKIGt1
aWRfdCB1aWQ7CiBpbnQgY291bnQ7CiBhdG9taWNfdCB1Y291bnRbVUNPVU5UX0NPVU5UU107
Cn07CgpleHRlcm4gc3RydWN0IHVzZXJfbmFtZXNwYWNlIGluaXRfdXNlcl9uczsKCmJvb2wg
c2V0dXBfdXNlcm5zX3N5c2N0bHMoc3RydWN0IHVzZXJfbmFtZXNwYWNlICpucyk7CnZvaWQg
cmV0aXJlX3VzZXJuc19zeXNjdGxzKHN0cnVjdCB1c2VyX25hbWVzcGFjZSAqbnMpOwpzdHJ1
Y3QgdWNvdW50cyAqaW5jX3Vjb3VudChzdHJ1Y3QgdXNlcl9uYW1lc3BhY2UgKm5zLCBrdWlk
X3QgdWlkLCBlbnVtIHVjb3VudF90eXBlIHR5cGUpOwp2b2lkIGRlY191Y291bnQoc3RydWN0
IHVjb3VudHMgKnVjb3VudHMsIGVudW0gdWNvdW50X3R5cGUgdHlwZSk7CiMgMTQyICIuL2lu
Y2x1ZGUvbGludXgvdXNlcl9uYW1lc3BhY2UuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHN0cnVjdCB1c2VyX25h
bWVzcGFjZSAqZ2V0X3VzZXJfbnMoc3RydWN0IHVzZXJfbmFtZXNwYWNlICpucykKewogcmV0
dXJuICZpbml0X3VzZXJfbnM7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgY3JlYXRlX3VzZXJfbnMoc3Ry
dWN0IGNyZWQgKm5ldykKewogcmV0dXJuIC0yMjsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCB1bnNoYXJl
X3VzZXJucyh1bnNpZ25lZCBsb25nIHVuc2hhcmVfZmxhZ3MsCiAgICAgc3RydWN0IGNyZWQg
KipuZXdfY3JlZCkKewogaWYgKHVuc2hhcmVfZmxhZ3MgJiAweDEwMDAwMDAwKQogIHJldHVy
biAtMjI7CiByZXR1cm4gMDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgcHV0X3VzZXJfbnMoc3RydWN0
IHVzZXJfbmFtZXNwYWNlICpucykKewp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCB1c2VybnNfbWF5X3Nl
dGdyb3Vwcyhjb25zdCBzdHJ1Y3QgdXNlcl9uYW1lc3BhY2UgKm5zKQp7CiByZXR1cm4gdHJ1
ZTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIGJvb2wgaW5fdXNlcm5zKGNvbnN0IHN0cnVjdCB1c2VyX25hbWVz
cGFjZSAqYW5jZXN0b3IsCiAgICAgICAgY29uc3Qgc3RydWN0IHVzZXJfbmFtZXNwYWNlICpj
aGlsZCkKewogcmV0dXJuIHRydWU7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIGN1cnJlbnRfaW5fdXNl
cm5zKGNvbnN0IHN0cnVjdCB1c2VyX25hbWVzcGFjZSAqdGFyZ2V0X25zKQp7CiByZXR1cm4g
dHJ1ZTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHN0cnVjdCBuc19jb21tb24gKm5zX2dldF9vd25lcihzdHJ1
Y3QgbnNfY29tbW9uICpucykKewogcmV0dXJuIEVSUl9QVFIoLTEpOwp9CiMgMjUgIi4vaW5j
bHVkZS9saW51eC9jZ3JvdXAuaCIgMgoKIyAxICIuL2luY2x1ZGUvbGludXgva2VybmVsX3N0
YXQuaCIgMQojIDkgIi4vaW5jbHVkZS9saW51eC9rZXJuZWxfc3RhdC5oIgojIDEgIi4vaW5j
bHVkZS9saW51eC9pbnRlcnJ1cHQuaCIgMQojIDE5ICIuL2luY2x1ZGUvbGludXgvaW50ZXJy
dXB0LmgiCiMgMSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vaXJxLmgiIDEKIyAyMCAi
Li9pbmNsdWRlL2xpbnV4L2ludGVycnVwdC5oIiAyCiMgODcgIi4vaW5jbHVkZS9saW51eC9p
bnRlcnJ1cHQuaCIKZW51bSB7CiBJUlFDX0lTX0hBUkRJUlEgPSAwLAogSVJRQ19JU19ORVNU
RUQsCn07Cgp0eXBlZGVmIGlycXJldHVybl90ICgqaXJxX2hhbmRsZXJfdCkoaW50LCB2b2lk
ICopOwojIDExMCAiLi9pbmNsdWRlL2xpbnV4L2ludGVycnVwdC5oIgpzdHJ1Y3QgaXJxYWN0
aW9uIHsKIGlycV9oYW5kbGVyX3QgaGFuZGxlcjsKIHZvaWQgKmRldl9pZDsKIHZvaWQgKnBl
cmNwdV9kZXZfaWQ7CiBzdHJ1Y3QgaXJxYWN0aW9uICpuZXh0OwogaXJxX2hhbmRsZXJfdCB0
aHJlYWRfZm47CiBzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRocmVhZDsKIHN0cnVjdCBpcnFhY3Rp
b24gKnNlY29uZGFyeTsKIHVuc2lnbmVkIGludCBpcnE7CiB1bnNpZ25lZCBpbnQgZmxhZ3M7
CiB1bnNpZ25lZCBsb25nIHRocmVhZF9mbGFnczsKIHVuc2lnbmVkIGxvbmcgdGhyZWFkX21h
c2s7CiBjb25zdCBjaGFyICpuYW1lOwogc3RydWN0IHByb2NfZGlyX2VudHJ5ICpkaXI7Cn0g
X19hdHRyaWJ1dGVfXygoX19hbGlnbmVkX18oMSA8PCAoNikpKSk7CgpleHRlcm4gaXJxcmV0
dXJuX3Qgbm9fYWN0aW9uKGludCBjcGwsIHZvaWQgKmRldl9pZCk7CiMgMTM4ICIuL2luY2x1
ZGUvbGludXgvaW50ZXJydXB0LmgiCmV4dGVybiBpbnQgX19hdHRyaWJ1dGVfXygoX193YXJu
X3VudXNlZF9yZXN1bHRfXykpCnJlcXVlc3RfdGhyZWFkZWRfaXJxKHVuc2lnbmVkIGludCBp
cnEsIGlycV9oYW5kbGVyX3QgaGFuZGxlciwKICAgICAgIGlycV9oYW5kbGVyX3QgdGhyZWFk
X2ZuLAogICAgICAgdW5zaWduZWQgbG9uZyBmbGFncywgY29uc3QgY2hhciAqbmFtZSwgdm9p
ZCAqZGV2KTsKIyAxNTYgIi4vaW5jbHVkZS9saW51eC9pbnRlcnJ1cHQuaCIKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IGludCBfX2F0dHJpYnV0ZV9fKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkKcmVxdWVzdF9p
cnEodW5zaWduZWQgaW50IGlycSwgaXJxX2hhbmRsZXJfdCBoYW5kbGVyLCB1bnNpZ25lZCBs
b25nIGZsYWdzLAogICAgIGNvbnN0IGNoYXIgKm5hbWUsIHZvaWQgKmRldikKewogcmV0dXJu
IHJlcXVlc3RfdGhyZWFkZWRfaXJxKGlycSwgaGFuZGxlciwgKCh2b2lkICopMCksIGZsYWdz
LCBuYW1lLCBkZXYpOwp9CgpleHRlcm4gaW50IF9fYXR0cmlidXRlX18oKF9fd2Fybl91bnVz
ZWRfcmVzdWx0X18pKQpyZXF1ZXN0X2FueV9jb250ZXh0X2lycSh1bnNpZ25lZCBpbnQgaXJx
LCBpcnFfaGFuZGxlcl90IGhhbmRsZXIsCiAgIHVuc2lnbmVkIGxvbmcgZmxhZ3MsIGNvbnN0
IGNoYXIgKm5hbWUsIHZvaWQgKmRldl9pZCk7CgpleHRlcm4gaW50IF9fYXR0cmlidXRlX18o
KF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKQpfX3JlcXVlc3RfcGVyY3B1X2lycSh1bnNpZ25l
ZCBpbnQgaXJxLCBpcnFfaGFuZGxlcl90IGhhbmRsZXIsCiAgICAgICB1bnNpZ25lZCBsb25n
IGZsYWdzLCBjb25zdCBjaGFyICpkZXZuYW1lLAogICAgICAgdm9pZCAqcGVyY3B1X2Rldl9p
ZCk7CgpleHRlcm4gaW50IF9fYXR0cmlidXRlX18oKF9fd2Fybl91bnVzZWRfcmVzdWx0X18p
KQpyZXF1ZXN0X25taSh1bnNpZ25lZCBpbnQgaXJxLCBpcnFfaGFuZGxlcl90IGhhbmRsZXIs
IHVuc2lnbmVkIGxvbmcgZmxhZ3MsCiAgICAgY29uc3QgY2hhciAqbmFtZSwgdm9pZCAqZGV2
KTsKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSBpbnQgX19hdHRyaWJ1dGVfXygoX193YXJuX3VudXNlZF9yZXN1bHRf
XykpCnJlcXVlc3RfcGVyY3B1X2lycSh1bnNpZ25lZCBpbnQgaXJxLCBpcnFfaGFuZGxlcl90
IGhhbmRsZXIsCiAgICAgY29uc3QgY2hhciAqZGV2bmFtZSwgdm9pZCAqcGVyY3B1X2Rldl9p
ZCkKewogcmV0dXJuIF9fcmVxdWVzdF9wZXJjcHVfaXJxKGlycSwgaGFuZGxlciwgMCwKICAg
ICAgICBkZXZuYW1lLCBwZXJjcHVfZGV2X2lkKTsKfQoKZXh0ZXJuIGludCBfX2F0dHJpYnV0
ZV9fKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkKcmVxdWVzdF9wZXJjcHVfbm1pKHVuc2ln
bmVkIGludCBpcnEsIGlycV9oYW5kbGVyX3QgaGFuZGxlciwKICAgICBjb25zdCBjaGFyICpk
ZXZuYW1lLCB2b2lkICpkZXYpOwoKZXh0ZXJuIGNvbnN0IHZvaWQgKmZyZWVfaXJxKHVuc2ln
bmVkIGludCwgdm9pZCAqKTsKZXh0ZXJuIHZvaWQgZnJlZV9wZXJjcHVfaXJxKHVuc2lnbmVk
IGludCwgdm9pZCAqKTsKCmV4dGVybiBjb25zdCB2b2lkICpmcmVlX25taSh1bnNpZ25lZCBp
bnQgaXJxLCB2b2lkICpkZXZfaWQpOwpleHRlcm4gdm9pZCBmcmVlX3BlcmNwdV9ubWkodW5z
aWduZWQgaW50IGlycSwgdm9pZCAqcGVyY3B1X2Rldl9pZCk7CgpzdHJ1Y3QgZGV2aWNlOwoK
ZXh0ZXJuIGludCBfX2F0dHJpYnV0ZV9fKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkKZGV2
bV9yZXF1ZXN0X3RocmVhZGVkX2lycShzdHJ1Y3QgZGV2aWNlICpkZXYsIHVuc2lnbmVkIGlu
dCBpcnEsCiAgICAgaXJxX2hhbmRsZXJfdCBoYW5kbGVyLCBpcnFfaGFuZGxlcl90IHRocmVh
ZF9mbiwKICAgICB1bnNpZ25lZCBsb25nIGlycWZsYWdzLCBjb25zdCBjaGFyICpkZXZuYW1l
LAogICAgIHZvaWQgKmRldl9pZCk7CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IF9fYXR0cmlidXRlX18oKF9f
d2Fybl91bnVzZWRfcmVzdWx0X18pKQpkZXZtX3JlcXVlc3RfaXJxKHN0cnVjdCBkZXZpY2Ug
KmRldiwgdW5zaWduZWQgaW50IGlycSwgaXJxX2hhbmRsZXJfdCBoYW5kbGVyLAogICB1bnNp
Z25lZCBsb25nIGlycWZsYWdzLCBjb25zdCBjaGFyICpkZXZuYW1lLCB2b2lkICpkZXZfaWQp
CnsKIHJldHVybiBkZXZtX3JlcXVlc3RfdGhyZWFkZWRfaXJxKGRldiwgaXJxLCBoYW5kbGVy
LCAoKHZvaWQgKikwKSwgaXJxZmxhZ3MsCiAgICAgIGRldm5hbWUsIGRldl9pZCk7Cn0KCmV4
dGVybiBpbnQgX19hdHRyaWJ1dGVfXygoX193YXJuX3VudXNlZF9yZXN1bHRfXykpCmRldm1f
cmVxdWVzdF9hbnlfY29udGV4dF9pcnEoc3RydWN0IGRldmljZSAqZGV2LCB1bnNpZ25lZCBp
bnQgaXJxLAogICBpcnFfaGFuZGxlcl90IGhhbmRsZXIsIHVuc2lnbmVkIGxvbmcgaXJxZmxh
Z3MsCiAgIGNvbnN0IGNoYXIgKmRldm5hbWUsIHZvaWQgKmRldl9pZCk7CgpleHRlcm4gdm9p
ZCBkZXZtX2ZyZWVfaXJxKHN0cnVjdCBkZXZpY2UgKmRldiwgdW5zaWduZWQgaW50IGlycSwg
dm9pZCAqZGV2X2lkKTsKIyAyMzUgIi4vaW5jbHVkZS9saW51eC9pbnRlcnJ1cHQuaCIKZXh0
ZXJuIHZvaWQgZGlzYWJsZV9pcnFfbm9zeW5jKHVuc2lnbmVkIGludCBpcnEpOwpleHRlcm4g
Ym9vbCBkaXNhYmxlX2hhcmRpcnEodW5zaWduZWQgaW50IGlycSk7CmV4dGVybiB2b2lkIGRp
c2FibGVfaXJxKHVuc2lnbmVkIGludCBpcnEpOwpleHRlcm4gdm9pZCBkaXNhYmxlX3BlcmNw
dV9pcnEodW5zaWduZWQgaW50IGlycSk7CmV4dGVybiB2b2lkIGVuYWJsZV9pcnEodW5zaWdu
ZWQgaW50IGlycSk7CmV4dGVybiB2b2lkIGVuYWJsZV9wZXJjcHVfaXJxKHVuc2lnbmVkIGlu
dCBpcnEsIHVuc2lnbmVkIGludCB0eXBlKTsKZXh0ZXJuIGJvb2wgaXJxX3BlcmNwdV9pc19l
bmFibGVkKHVuc2lnbmVkIGludCBpcnEpOwpleHRlcm4gdm9pZCBpcnFfd2FrZV90aHJlYWQo
dW5zaWduZWQgaW50IGlycSwgdm9pZCAqZGV2X2lkKTsKCmV4dGVybiB2b2lkIGRpc2FibGVf
bm1pX25vc3luYyh1bnNpZ25lZCBpbnQgaXJxKTsKZXh0ZXJuIHZvaWQgZGlzYWJsZV9wZXJj
cHVfbm1pKHVuc2lnbmVkIGludCBpcnEpOwpleHRlcm4gdm9pZCBlbmFibGVfbm1pKHVuc2ln
bmVkIGludCBpcnEpOwpleHRlcm4gdm9pZCBlbmFibGVfcGVyY3B1X25taSh1bnNpZ25lZCBp
bnQgaXJxLCB1bnNpZ25lZCBpbnQgdHlwZSk7CmV4dGVybiBpbnQgcHJlcGFyZV9wZXJjcHVf
bm1pKHVuc2lnbmVkIGludCBpcnEpOwpleHRlcm4gdm9pZCB0ZWFyZG93bl9wZXJjcHVfbm1p
KHVuc2lnbmVkIGludCBpcnEpOwoKZXh0ZXJuIGludCBpcnFfaW5qZWN0X2ludGVycnVwdCh1
bnNpZ25lZCBpbnQgaXJxKTsKCgpleHRlcm4gdm9pZCBzdXNwZW5kX2RldmljZV9pcnFzKHZv
aWQpOwpleHRlcm4gdm9pZCByZXN1bWVfZGV2aWNlX2lycXModm9pZCk7CmV4dGVybiB2b2lk
IHJlYXJtX3dha2VfaXJxKHVuc2lnbmVkIGludCBpcnEpOwojIDI3MCAiLi9pbmNsdWRlL2xp
bnV4L2ludGVycnVwdC5oIgpzdHJ1Y3QgaXJxX2FmZmluaXR5X25vdGlmeSB7CiB1bnNpZ25l
ZCBpbnQgaXJxOwogc3RydWN0IGtyZWYga3JlZjsKIHN0cnVjdCB3b3JrX3N0cnVjdCB3b3Jr
Owogdm9pZCAoKm5vdGlmeSkoc3RydWN0IGlycV9hZmZpbml0eV9ub3RpZnkgKiwgY29uc3Qg
Y3B1bWFza190ICptYXNrKTsKIHZvaWQgKCpyZWxlYXNlKShzdHJ1Y3Qga3JlZiAqcmVmKTsK
fTsKIyAyOTQgIi4vaW5jbHVkZS9saW51eC9pbnRlcnJ1cHQuaCIKc3RydWN0IGlycV9hZmZp
bml0eSB7CiB1bnNpZ25lZCBpbnQgcHJlX3ZlY3RvcnM7CiB1bnNpZ25lZCBpbnQgcG9zdF92
ZWN0b3JzOwogdW5zaWduZWQgaW50IG5yX3NldHM7CiB1bnNpZ25lZCBpbnQgc2V0X3NpemVb
NF07CiB2b2lkICgqY2FsY19zZXRzKShzdHJ1Y3QgaXJxX2FmZmluaXR5ICosIHVuc2lnbmVk
IGludCBudmVjcyk7CiB2b2lkICpwcml2Owp9OwoKCgoKCgpzdHJ1Y3QgaXJxX2FmZmluaXR5
X2Rlc2Mgewogc3RydWN0IGNwdW1hc2sgbWFzazsKIHVuc2lnbmVkIGludCBpc19tYW5hZ2Vk
IDogMTsKfTsKCgoKZXh0ZXJuIGNwdW1hc2tfdmFyX3QgaXJxX2RlZmF1bHRfYWZmaW5pdHk7
CgoKZXh0ZXJuIGludCBfX2lycV9zZXRfYWZmaW5pdHkodW5zaWduZWQgaW50IGlycSwgY29u
c3Qgc3RydWN0IGNwdW1hc2sgKmNwdW1hc2ssCiAgICAgICAgIGJvb2wgZm9yY2UpOwojIDMy
OCAiLi9pbmNsdWRlL2xpbnV4L2ludGVycnVwdC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50CmlycV9zZXRf
YWZmaW5pdHkodW5zaWduZWQgaW50IGlycSwgY29uc3Qgc3RydWN0IGNwdW1hc2sgKmNwdW1h
c2spCnsKIHJldHVybiBfX2lycV9zZXRfYWZmaW5pdHkoaXJxLCBjcHVtYXNrLCBmYWxzZSk7
Cn0KIyAzNDUgIi4vaW5jbHVkZS9saW51eC9pbnRlcnJ1cHQuaCIKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludApp
cnFfZm9yY2VfYWZmaW5pdHkodW5zaWduZWQgaW50IGlycSwgY29uc3Qgc3RydWN0IGNwdW1h
c2sgKmNwdW1hc2spCnsKIHJldHVybiBfX2lycV9zZXRfYWZmaW5pdHkoaXJxLCBjcHVtYXNr
LCB0cnVlKTsKfQoKZXh0ZXJuIGludCBpcnFfY2FuX3NldF9hZmZpbml0eSh1bnNpZ25lZCBp
bnQgaXJxKTsKZXh0ZXJuIGludCBpcnFfc2VsZWN0X2FmZmluaXR5KHVuc2lnbmVkIGludCBp
cnEpOwoKZXh0ZXJuIGludCBpcnFfc2V0X2FmZmluaXR5X2hpbnQodW5zaWduZWQgaW50IGly
cSwgY29uc3Qgc3RydWN0IGNwdW1hc2sgKm0pOwoKZXh0ZXJuIGludAppcnFfc2V0X2FmZmlu
aXR5X25vdGlmaWVyKHVuc2lnbmVkIGludCBpcnEsIHN0cnVjdCBpcnFfYWZmaW5pdHlfbm90
aWZ5ICpub3RpZnkpOwoKc3RydWN0IGlycV9hZmZpbml0eV9kZXNjICoKaXJxX2NyZWF0ZV9h
ZmZpbml0eV9tYXNrcyh1bnNpZ25lZCBpbnQgbnZlYywgc3RydWN0IGlycV9hZmZpbml0eSAq
YWZmZCk7Cgp1bnNpZ25lZCBpbnQgaXJxX2NhbGNfYWZmaW5pdHlfdmVjdG9ycyh1bnNpZ25l
ZCBpbnQgbWludmVjLCB1bnNpZ25lZCBpbnQgbWF4dmVjLAogICAgICAgICAgIGNvbnN0IHN0
cnVjdCBpcnFfYWZmaW5pdHkgKmFmZmQpOwojIDQyMiAiLi9pbmNsdWRlL2xpbnV4L2ludGVy
cnVwdC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBkaXNhYmxlX2lycV9ub3N5bmNfbG9ja2RlcCh1bnNp
Z25lZCBpbnQgaXJxKQp7CiBkaXNhYmxlX2lycV9ub3N5bmMoaXJxKTsKCgoKfQoKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIHZvaWQgZGlzYWJsZV9pcnFfbm9zeW5jX2xvY2tkZXBfaXJxc2F2ZSh1bnNpZ25lZCBp
bnQgaXJxLCB1bnNpZ25lZCBsb25nICpmbGFncykKewogZGlzYWJsZV9pcnFfbm9zeW5jKGly
cSk7CgoKCn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGRpc2FibGVfaXJxX2xvY2tkZXAodW5zaWduZWQg
aW50IGlycSkKewogZGlzYWJsZV9pcnEoaXJxKTsKCgoKfQoKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgZW5h
YmxlX2lycV9sb2NrZGVwKHVuc2lnbmVkIGludCBpcnEpCnsKCgoKIGVuYWJsZV9pcnEoaXJx
KTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIHZvaWQgZW5hYmxlX2lycV9sb2NrZGVwX2lycXJlc3RvcmUodW5z
aWduZWQgaW50IGlycSwgdW5zaWduZWQgbG9uZyAqZmxhZ3MpCnsKCgoKIGVuYWJsZV9pcnEo
aXJxKTsKfQoKCmV4dGVybiBpbnQgaXJxX3NldF9pcnFfd2FrZSh1bnNpZ25lZCBpbnQgaXJx
LCB1bnNpZ25lZCBpbnQgb24pOwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBlbmFibGVfaXJxX3dha2UodW5z
aWduZWQgaW50IGlycSkKewogcmV0dXJuIGlycV9zZXRfaXJxX3dha2UoaXJxLCAxKTsKfQoK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIGludCBkaXNhYmxlX2lycV93YWtlKHVuc2lnbmVkIGludCBpcnEpCnsKIHJl
dHVybiBpcnFfc2V0X2lycV93YWtlKGlycSwgMCk7Cn0KCgoKCmVudW0gaXJxY2hpcF9pcnFf
c3RhdGUgewogSVJRQ0hJUF9TVEFURV9QRU5ESU5HLAogSVJRQ0hJUF9TVEFURV9BQ1RJVkUs
CiBJUlFDSElQX1NUQVRFX01BU0tFRCwKIElSUUNISVBfU1RBVEVfTElORV9MRVZFTCwKfTsK
CmV4dGVybiBpbnQgaXJxX2dldF9pcnFjaGlwX3N0YXRlKHVuc2lnbmVkIGludCBpcnEsIGVu
dW0gaXJxY2hpcF9pcnFfc3RhdGUgd2hpY2gsCiAgICAgYm9vbCAqc3RhdGUpOwpleHRlcm4g
aW50IGlycV9zZXRfaXJxY2hpcF9zdGF0ZSh1bnNpZ25lZCBpbnQgaXJxLCBlbnVtIGlycWNo
aXBfaXJxX3N0YXRlIHdoaWNoLAogICAgIGJvb2wgc3RhdGUpOwoKCgoKCmV4dGVybiBib29s
IGZvcmNlX2lycXRocmVhZHM7CiMgNTI4ICIuL2luY2x1ZGUvbGludXgvaW50ZXJydXB0Lmgi
CmVudW0KewogSElfU09GVElSUT0wLAogVElNRVJfU09GVElSUSwKIE5FVF9UWF9TT0ZUSVJR
LAogTkVUX1JYX1NPRlRJUlEsCiBCTE9DS19TT0ZUSVJRLAogSVJRX1BPTExfU09GVElSUSwK
IFRBU0tMRVRfU09GVElSUSwKIFNDSEVEX1NPRlRJUlEsCiBIUlRJTUVSX1NPRlRJUlEsCiBS
Q1VfU09GVElSUSwKCiBOUl9TT0ZUSVJRUwp9OwoKCgoKCgpleHRlcm4gY29uc3QgY2hhciAq
IGNvbnN0IHNvZnRpcnFfdG9fbmFtZVtOUl9TT0ZUSVJRU107CgoKCgoKc3RydWN0IHNvZnRp
cnFfYWN0aW9uCnsKIHZvaWQgKCphY3Rpb24pKHN0cnVjdCBzb2Z0aXJxX2FjdGlvbiAqKTsK
fTsKCiB2b2lkIGRvX3NvZnRpcnEodm9pZCk7CiB2b2lkIF9fZG9fc29mdGlycSh2b2lkKTsK
Cgp2b2lkIGRvX3NvZnRpcnFfb3duX3N0YWNrKHZvaWQpOwoKCgoKCgoKZXh0ZXJuIHZvaWQg
b3Blbl9zb2Z0aXJxKGludCBuciwgdm9pZCAoKmFjdGlvbikoc3RydWN0IHNvZnRpcnFfYWN0
aW9uICopKTsKZXh0ZXJuIHZvaWQgc29mdGlycV9pbml0KHZvaWQpOwpleHRlcm4gdm9pZCBf
X3JhaXNlX3NvZnRpcnFfaXJxb2ZmKHVuc2lnbmVkIGludCBucik7CgpleHRlcm4gdm9pZCBy
YWlzZV9zb2Z0aXJxX2lycW9mZih1bnNpZ25lZCBpbnQgbnIpOwpleHRlcm4gdm9pZCByYWlz
ZV9zb2Z0aXJxKHVuc2lnbmVkIGludCBucik7CgpleHRlcm4gX19hdHRyaWJ1dGVfXygoc2Vj
dGlvbigiLmRhdGEuLnBlcmNwdSIgIiIpKSkgX190eXBlb2ZfXyhzdHJ1Y3QgdGFza19zdHJ1
Y3QgKikga3NvZnRpcnFkOwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHN0cnVjdCB0YXNrX3N0cnVjdCAqdGhpc19j
cHVfa3NvZnRpcnFkKHZvaWQpCnsKIHJldHVybiAoeyB0eXBlb2Yoa3NvZnRpcnFkKSBwc2Ny
X3JldF9fOyBkbyB7IGNvbnN0IHZvaWQgKl9fdnBwX3ZlcmlmeSA9ICh0eXBlb2YoKCYoa3Nv
ZnRpcnFkKSkgKyAwKSkoKHZvaWQgKikwKTsgKHZvaWQpX192cHBfdmVyaWZ5OyB9IHdoaWxl
ICgwKTsgc3dpdGNoKHNpemVvZihrc29mdGlycWQpKSB7IGNhc2UgMTogcHNjcl9yZXRfXyA9
ICh7IHR5cGVvZihrc29mdGlycWQpIF9fcmV0OyBpZiAoKHNpemVvZihrc29mdGlycWQpID09
IHNpemVvZihjaGFyKSB8fCBzaXplb2Yoa3NvZnRpcnFkKSA9PSBzaXplb2Yoc2hvcnQpIHx8
IHNpemVvZihrc29mdGlycWQpID09IHNpemVvZihpbnQpIHx8IHNpemVvZihrc29mdGlycWQp
ID09IHNpemVvZihsb25nKSkpIF9fcmV0ID0gKHsgdHlwZW9mKGtzb2Z0aXJxZCkgX19yZXQ7
IF9fYXNtX18gX192b2xhdGlsZV9fKCIiOiA6IDoibWVtb3J5Iik7IF9fcmV0ID0gKHsgZG8g
eyBleHRlcm4gdm9pZCBfX2NvbXBpbGV0aW1lX2Fzc2VydF8yMDIodm9pZCkgX19hdHRyaWJ1
dGVfXygoX19lcnJvcl9fKCJVbnN1cHBvcnRlZCBhY2Nlc3Mgc2l6ZSBmb3Ige1JFQUQsV1JJ
VEV9X09OQ0UoKS4iKSkpOyBpZiAoISgoc2l6ZW9mKCooeyBkbyB7IGNvbnN0IHZvaWQgKl9f
dnBwX3ZlcmlmeSA9ICh0eXBlb2YoKCYoa3NvZnRpcnFkKSkgKyAwKSkoKHZvaWQgKikwKTsg
KHZvaWQpX192cHBfdmVyaWZ5OyB9IHdoaWxlICgwKTsgKHsgdW5zaWduZWQgbG9uZyBfX3B0
cjsgX19hc21fXyAoIiIgOiAiPXIiKF9fcHRyKSA6ICIwIigodHlwZW9mKCooJihrc29mdGly
cWQpKSkgKikoJihrc29mdGlycWQpKSkpOyAodHlwZW9mKCh0eXBlb2YoKigmKGtzb2Z0aXJx
ZCkpKSAqKSgmKGtzb2Z0aXJxZCkpKSkgKF9fcHRyICsgKChsb2NhbF9wYWNhLT5kYXRhX29m
ZnNldCkpKTsgfSk7IH0pKSA9PSBzaXplb2YoY2hhcikgfHwgc2l6ZW9mKCooeyBkbyB7IGNv
bnN0IHZvaWQgKl9fdnBwX3ZlcmlmeSA9ICh0eXBlb2YoKCYoa3NvZnRpcnFkKSkgKyAwKSko
KHZvaWQgKikwKTsgKHZvaWQpX192cHBfdmVyaWZ5OyB9IHdoaWxlICgwKTsgKHsgdW5zaWdu
ZWQgbG9uZyBfX3B0cjsgX19hc21fXyAoIiIgOiAiPXIiKF9fcHRyKSA6ICIwIigodHlwZW9m
KCooJihrc29mdGlycWQpKSkgKikoJihrc29mdGlycWQpKSkpOyAodHlwZW9mKCh0eXBlb2Yo
KigmKGtzb2Z0aXJxZCkpKSAqKSgmKGtzb2Z0aXJxZCkpKSkgKF9fcHRyICsgKChsb2NhbF9w
YWNhLT5kYXRhX29mZnNldCkpKTsgfSk7IH0pKSA9PSBzaXplb2Yoc2hvcnQpIHx8IHNpemVv
ZigqKHsgZG8geyBjb25zdCB2b2lkICpfX3ZwcF92ZXJpZnkgPSAodHlwZW9mKCgmKGtzb2Z0
aXJxZCkpICsgMCkpKCh2b2lkICopMCk7ICh2b2lkKV9fdnBwX3ZlcmlmeTsgfSB3aGlsZSAo
MCk7ICh7IHVuc2lnbmVkIGxvbmcgX19wdHI7IF9fYXNtX18gKCIiIDogIj1yIihfX3B0cikg
OiAiMCIoKHR5cGVvZigqKCYoa3NvZnRpcnFkKSkpICopKCYoa3NvZnRpcnFkKSkpKTsgKHR5
cGVvZigodHlwZW9mKCooJihrc29mdGlycWQpKSkgKikoJihrc29mdGlycWQpKSkpIChfX3B0
ciArICgobG9jYWxfcGFjYS0+ZGF0YV9vZmZzZXQpKSk7IH0pOyB9KSkgPT0gc2l6ZW9mKGlu
dCkgfHwgc2l6ZW9mKCooeyBkbyB7IGNvbnN0IHZvaWQgKl9fdnBwX3ZlcmlmeSA9ICh0eXBl
b2YoKCYoa3NvZnRpcnFkKSkgKyAwKSkoKHZvaWQgKikwKTsgKHZvaWQpX192cHBfdmVyaWZ5
OyB9IHdoaWxlICgwKTsgKHsgdW5zaWduZWQgbG9uZyBfX3B0cjsgX19hc21fXyAoIiIgOiAi
PXIiKF9fcHRyKSA6ICIwIigodHlwZW9mKCooJihrc29mdGlycWQpKSkgKikoJihrc29mdGly
cWQpKSkpOyAodHlwZW9mKCh0eXBlb2YoKigmKGtzb2Z0aXJxZCkpKSAqKSgmKGtzb2Z0aXJx
ZCkpKSkgKF9fcHRyICsgKChsb2NhbF9wYWNhLT5kYXRhX29mZnNldCkpKTsgfSk7IH0pKSA9
PSBzaXplb2YobG9uZykpIHx8IHNpemVvZigqKHsgZG8geyBjb25zdCB2b2lkICpfX3ZwcF92
ZXJpZnkgPSAodHlwZW9mKCgmKGtzb2Z0aXJxZCkpICsgMCkpKCh2b2lkICopMCk7ICh2b2lk
KV9fdnBwX3ZlcmlmeTsgfSB3aGlsZSAoMCk7ICh7IHVuc2lnbmVkIGxvbmcgX19wdHI7IF9f
YXNtX18gKCIiIDogIj1yIihfX3B0cikgOiAiMCIoKHR5cGVvZigqKCYoa3NvZnRpcnFkKSkp
ICopKCYoa3NvZnRpcnFkKSkpKTsgKHR5cGVvZigodHlwZW9mKCooJihrc29mdGlycWQpKSkg
KikoJihrc29mdGlycWQpKSkpIChfX3B0ciArICgobG9jYWxfcGFjYS0+ZGF0YV9vZmZzZXQp
KSk7IH0pOyB9KSkgPT0gc2l6ZW9mKGxvbmcgbG9uZykpKSBfX2NvbXBpbGV0aW1lX2Fzc2Vy
dF8yMDIoKTsgfSB3aGlsZSAoMCk7ICh7IHR5cGVvZiggX0dlbmVyaWMoKCooeyBkbyB7IGNv
bnN0IHZvaWQgKl9fdnBwX3ZlcmlmeSA9ICh0eXBlb2YoKCYoa3NvZnRpcnFkKSkgKyAwKSko
KHZvaWQgKikwKTsgKHZvaWQpX192cHBfdmVyaWZ5OyB9IHdoaWxlICgwKTsgKHsgdW5zaWdu
ZWQgbG9uZyBfX3B0cjsgX19hc21fXyAoIiIgOiAiPXIiKF9fcHRyKSA6ICIwIigodHlwZW9m
KCooJihrc29mdGlycWQpKSkgKikoJihrc29mdGlycWQpKSkpOyAodHlwZW9mKCh0eXBlb2Yo
KigmKGtzb2Z0aXJxZCkpKSAqKSgmKGtzb2Z0aXJxZCkpKSkgKF9fcHRyICsgKChsb2NhbF9w
YWNhLT5kYXRhX29mZnNldCkpKTsgfSk7IH0pKSwgY2hhcjogKGNoYXIpMCwgdW5zaWduZWQg
Y2hhcjogKHVuc2lnbmVkIGNoYXIpMCwgc2lnbmVkIGNoYXI6IChzaWduZWQgY2hhcikwLCB1
bnNpZ25lZCBzaG9ydDogKHVuc2lnbmVkIHNob3J0KTAsIHNpZ25lZCBzaG9ydDogKHNpZ25l
ZCBzaG9ydCkwLCB1bnNpZ25lZCBpbnQ6ICh1bnNpZ25lZCBpbnQpMCwgc2lnbmVkIGludDog
KHNpZ25lZCBpbnQpMCwgdW5zaWduZWQgbG9uZzogKHVuc2lnbmVkIGxvbmcpMCwgc2lnbmVk
IGxvbmc6IChzaWduZWQgbG9uZykwLCB1bnNpZ25lZCBsb25nIGxvbmc6ICh1bnNpZ25lZCBs
b25nIGxvbmcpMCwgc2lnbmVkIGxvbmcgbG9uZzogKHNpZ25lZCBsb25nIGxvbmcpMCwgZGVm
YXVsdDogKCooeyBkbyB7IGNvbnN0IHZvaWQgKl9fdnBwX3ZlcmlmeSA9ICh0eXBlb2YoKCYo
a3NvZnRpcnFkKSkgKyAwKSkoKHZvaWQgKikwKTsgKHZvaWQpX192cHBfdmVyaWZ5OyB9IHdo
aWxlICgwKTsgKHsgdW5zaWduZWQgbG9uZyBfX3B0cjsgX19hc21fXyAoIiIgOiAiPXIiKF9f
cHRyKSA6ICIwIigodHlwZW9mKCooJihrc29mdGlycWQpKSkgKikoJihrc29mdGlycWQpKSkp
OyAodHlwZW9mKCh0eXBlb2YoKigmKGtzb2Z0aXJxZCkpKSAqKSgmKGtzb2Z0aXJxZCkpKSkg
KF9fcHRyICsgKChsb2NhbF9wYWNhLT5kYXRhX29mZnNldCkpKTsgfSk7IH0pKSkpIF9feCA9
ICgqKGNvbnN0IHZvbGF0aWxlIHR5cGVvZiggX0dlbmVyaWMoKCooeyBkbyB7IGNvbnN0IHZv
aWQgKl9fdnBwX3ZlcmlmeSA9ICh0eXBlb2YoKCYoa3NvZnRpcnFkKSkgKyAwKSkoKHZvaWQg
KikwKTsgKHZvaWQpX192cHBfdmVyaWZ5OyB9IHdoaWxlICgwKTsgKHsgdW5zaWduZWQgbG9u
ZyBfX3B0cjsgX19hc21fXyAoIiIgOiAiPXIiKF9fcHRyKSA6ICIwIigodHlwZW9mKCooJihr
c29mdGlycWQpKSkgKikoJihrc29mdGlycWQpKSkpOyAodHlwZW9mKCh0eXBlb2YoKigmKGtz
b2Z0aXJxZCkpKSAqKSgmKGtzb2Z0aXJxZCkpKSkgKF9fcHRyICsgKChsb2NhbF9wYWNhLT5k
YXRhX29mZnNldCkpKTsgfSk7IH0pKSwgY2hhcjogKGNoYXIpMCwgdW5zaWduZWQgY2hhcjog
KHVuc2lnbmVkIGNoYXIpMCwgc2lnbmVkIGNoYXI6IChzaWduZWQgY2hhcikwLCB1bnNpZ25l
ZCBzaG9ydDogKHVuc2lnbmVkIHNob3J0KTAsIHNpZ25lZCBzaG9ydDogKHNpZ25lZCBzaG9y
dCkwLCB1bnNpZ25lZCBpbnQ6ICh1bnNpZ25lZCBpbnQpMCwgc2lnbmVkIGludDogKHNpZ25l
ZCBpbnQpMCwgdW5zaWduZWQgbG9uZzogKHVuc2lnbmVkIGxvbmcpMCwgc2lnbmVkIGxvbmc6
IChzaWduZWQgbG9uZykwLCB1bnNpZ25lZCBsb25nIGxvbmc6ICh1bnNpZ25lZCBsb25nIGxv
bmcpMCwgc2lnbmVkIGxvbmcgbG9uZzogKHNpZ25lZCBsb25nIGxvbmcpMCwgZGVmYXVsdDog
KCooeyBkbyB7IGNvbnN0IHZvaWQgKl9fdnBwX3ZlcmlmeSA9ICh0eXBlb2YoKCYoa3NvZnRp
cnFkKSkgKyAwKSkoKHZvaWQgKikwKTsgKHZvaWQpX192cHBfdmVyaWZ5OyB9IHdoaWxlICgw
KTsgKHsgdW5zaWduZWQgbG9uZyBfX3B0cjsgX19hc21fXyAoIiIgOiAiPXIiKF9fcHRyKSA6
ICIwIigodHlwZW9mKCooJihrc29mdGlycWQpKSkgKikoJihrc29mdGlycWQpKSkpOyAodHlw
ZW9mKCh0eXBlb2YoKigmKGtzb2Z0aXJxZCkpKSAqKSgmKGtzb2Z0aXJxZCkpKSkgKF9fcHRy
ICsgKChsb2NhbF9wYWNhLT5kYXRhX29mZnNldCkpKTsgfSk7IH0pKSkpICopJigqKHsgZG8g
eyBjb25zdCB2b2lkICpfX3ZwcF92ZXJpZnkgPSAodHlwZW9mKCgmKGtzb2Z0aXJxZCkpICsg
MCkpKCh2b2lkICopMCk7ICh2b2lkKV9fdnBwX3ZlcmlmeTsgfSB3aGlsZSAoMCk7ICh7IHVu
c2lnbmVkIGxvbmcgX19wdHI7IF9fYXNtX18gKCIiIDogIj1yIihfX3B0cikgOiAiMCIoKHR5
cGVvZigqKCYoa3NvZnRpcnFkKSkpICopKCYoa3NvZnRpcnFkKSkpKTsgKHR5cGVvZigodHlw
ZW9mKCooJihrc29mdGlycWQpKSkgKikoJihrc29mdGlycWQpKSkpIChfX3B0ciArICgobG9j
YWxfcGFjYS0+ZGF0YV9vZmZzZXQpKSk7IH0pOyB9KSkpOyBkbyB7IH0gd2hpbGUgKDApOyAo
dHlwZW9mKCooeyBkbyB7IGNvbnN0IHZvaWQgKl9fdnBwX3ZlcmlmeSA9ICh0eXBlb2YoKCYo
a3NvZnRpcnFkKSkgKyAwKSkoKHZvaWQgKikwKTsgKHZvaWQpX192cHBfdmVyaWZ5OyB9IHdo
aWxlICgwKTsgKHsgdW5zaWduZWQgbG9uZyBfX3B0cjsgX19hc21fXyAoIiIgOiAiPXIiKF9f
cHRyKSA6ICIwIigodHlwZW9mKCooJihrc29mdGlycWQpKSkgKikoJihrc29mdGlycWQpKSkp
OyAodHlwZW9mKCh0eXBlb2YoKigmKGtzb2Z0aXJxZCkpKSAqKSgmKGtzb2Z0aXJxZCkpKSkg
KF9fcHRyICsgKChsb2NhbF9wYWNhLT5kYXRhX29mZnNldCkpKTsgfSk7IH0pKSlfX3g7IH0p
OyB9KTsgX19hc21fXyBfX3ZvbGF0aWxlX18oIiI6IDogOiJtZW1vcnkiKTsgX19yZXQ7IH0p
OyBlbHNlIF9fcmV0ID0gKHsgdHlwZW9mKGtzb2Z0aXJxZCkgX19yZXQ7IHVuc2lnbmVkIGxv
bmcgX19mbGFnczsgZG8geyAoeyB1bnNpZ25lZCBsb25nIF9fZHVtbXk7IHR5cGVvZihfX2Zs
YWdzKSBfX2R1bW15MjsgKHZvaWQpKCZfX2R1bW15ID09ICZfX2R1bW15Mik7IDE7IH0pOyBf
X2ZsYWdzID0gYXJjaF9sb2NhbF9pcnFfc2F2ZSgpOyB9IHdoaWxlICgwKTsgX19yZXQgPSAo
eyAqKHsgZG8geyBjb25zdCB2b2lkICpfX3ZwcF92ZXJpZnkgPSAodHlwZW9mKCgmKGtzb2Z0
aXJxZCkpICsgMCkpKCh2b2lkICopMCk7ICh2b2lkKV9fdnBwX3ZlcmlmeTsgfSB3aGlsZSAo
MCk7ICh7IHVuc2lnbmVkIGxvbmcgX19wdHI7IF9fYXNtX18gKCIiIDogIj1yIihfX3B0cikg
OiAiMCIoKHR5cGVvZigqKCYoa3NvZnRpcnFkKSkpICopKCYoa3NvZnRpcnFkKSkpKTsgKHR5
cGVvZigodHlwZW9mKCooJihrc29mdGlycWQpKSkgKikoJihrc29mdGlycWQpKSkpIChfX3B0
ciArICgobG9jYWxfcGFjYS0+ZGF0YV9vZmZzZXQpKSk7IH0pOyB9KTsgfSk7IGRvIHsgKHsg
dW5zaWduZWQgbG9uZyBfX2R1bW15OyB0eXBlb2YoX19mbGFncykgX19kdW1teTI7ICh2b2lk
KSgmX19kdW1teSA9PSAmX19kdW1teTIpOyAxOyB9KTsgYXJjaF9sb2NhbF9pcnFfcmVzdG9y
ZShfX2ZsYWdzKTsgfSB3aGlsZSAoMCk7IF9fcmV0OyB9KTsgX19yZXQ7IH0pOyBicmVhazsg
Y2FzZSAyOiBwc2NyX3JldF9fID0gKHsgdHlwZW9mKGtzb2Z0aXJxZCkgX19yZXQ7IGlmICgo
c2l6ZW9mKGtzb2Z0aXJxZCkgPT0gc2l6ZW9mKGNoYXIpIHx8IHNpemVvZihrc29mdGlycWQp
ID09IHNpemVvZihzaG9ydCkgfHwgc2l6ZW9mKGtzb2Z0aXJxZCkgPT0gc2l6ZW9mKGludCkg
fHwgc2l6ZW9mKGtzb2Z0aXJxZCkgPT0gc2l6ZW9mKGxvbmcpKSkgX19yZXQgPSAoeyB0eXBl
b2Yoa3NvZnRpcnFkKSBfX3JldDsgX19hc21fXyBfX3ZvbGF0aWxlX18oIiI6IDogOiJtZW1v
cnkiKTsgX19yZXQgPSAoeyBkbyB7IGV4dGVybiB2b2lkIF9fY29tcGlsZXRpbWVfYXNzZXJ0
XzIwMyh2b2lkKSBfX2F0dHJpYnV0ZV9fKChfX2Vycm9yX18oIlVuc3VwcG9ydGVkIGFjY2Vz
cyBzaXplIGZvciB7UkVBRCxXUklURX1fT05DRSgpLiIpKSk7IGlmICghKChzaXplb2YoKih7
IGRvIHsgY29uc3Qgdm9pZCAqX192cHBfdmVyaWZ5ID0gKHR5cGVvZigoJihrc29mdGlycWQp
KSArIDApKSgodm9pZCAqKTApOyAodm9pZClfX3ZwcF92ZXJpZnk7IH0gd2hpbGUgKDApOyAo
eyB1bnNpZ25lZCBsb25nIF9fcHRyOyBfX2FzbV9fICgiIiA6ICI9ciIoX19wdHIpIDogIjAi
KCh0eXBlb2YoKigmKGtzb2Z0aXJxZCkpKSAqKSgmKGtzb2Z0aXJxZCkpKSk7ICh0eXBlb2Yo
KHR5cGVvZigqKCYoa3NvZnRpcnFkKSkpICopKCYoa3NvZnRpcnFkKSkpKSAoX19wdHIgKyAo
KGxvY2FsX3BhY2EtPmRhdGFfb2Zmc2V0KSkpOyB9KTsgfSkpID09IHNpemVvZihjaGFyKSB8
fCBzaXplb2YoKih7IGRvIHsgY29uc3Qgdm9pZCAqX192cHBfdmVyaWZ5ID0gKHR5cGVvZigo
Jihrc29mdGlycWQpKSArIDApKSgodm9pZCAqKTApOyAodm9pZClfX3ZwcF92ZXJpZnk7IH0g
d2hpbGUgKDApOyAoeyB1bnNpZ25lZCBsb25nIF9fcHRyOyBfX2FzbV9fICgiIiA6ICI9ciIo
X19wdHIpIDogIjAiKCh0eXBlb2YoKigmKGtzb2Z0aXJxZCkpKSAqKSgmKGtzb2Z0aXJxZCkp
KSk7ICh0eXBlb2YoKHR5cGVvZigqKCYoa3NvZnRpcnFkKSkpICopKCYoa3NvZnRpcnFkKSkp
KSAoX19wdHIgKyAoKGxvY2FsX3BhY2EtPmRhdGFfb2Zmc2V0KSkpOyB9KTsgfSkpID09IHNp
emVvZihzaG9ydCkgfHwgc2l6ZW9mKCooeyBkbyB7IGNvbnN0IHZvaWQgKl9fdnBwX3Zlcmlm
eSA9ICh0eXBlb2YoKCYoa3NvZnRpcnFkKSkgKyAwKSkoKHZvaWQgKikwKTsgKHZvaWQpX192
cHBfdmVyaWZ5OyB9IHdoaWxlICgwKTsgKHsgdW5zaWduZWQgbG9uZyBfX3B0cjsgX19hc21f
XyAoIiIgOiAiPXIiKF9fcHRyKSA6ICIwIigodHlwZW9mKCooJihrc29mdGlycWQpKSkgKiko
Jihrc29mdGlycWQpKSkpOyAodHlwZW9mKCh0eXBlb2YoKigmKGtzb2Z0aXJxZCkpKSAqKSgm
KGtzb2Z0aXJxZCkpKSkgKF9fcHRyICsgKChsb2NhbF9wYWNhLT5kYXRhX29mZnNldCkpKTsg
fSk7IH0pKSA9PSBzaXplb2YoaW50KSB8fCBzaXplb2YoKih7IGRvIHsgY29uc3Qgdm9pZCAq
X192cHBfdmVyaWZ5ID0gKHR5cGVvZigoJihrc29mdGlycWQpKSArIDApKSgodm9pZCAqKTAp
OyAodm9pZClfX3ZwcF92ZXJpZnk7IH0gd2hpbGUgKDApOyAoeyB1bnNpZ25lZCBsb25nIF9f
cHRyOyBfX2FzbV9fICgiIiA6ICI9ciIoX19wdHIpIDogIjAiKCh0eXBlb2YoKigmKGtzb2Z0
aXJxZCkpKSAqKSgmKGtzb2Z0aXJxZCkpKSk7ICh0eXBlb2YoKHR5cGVvZigqKCYoa3NvZnRp
cnFkKSkpICopKCYoa3NvZnRpcnFkKSkpKSAoX19wdHIgKyAoKGxvY2FsX3BhY2EtPmRhdGFf
b2Zmc2V0KSkpOyB9KTsgfSkpID09IHNpemVvZihsb25nKSkgfHwgc2l6ZW9mKCooeyBkbyB7
IGNvbnN0IHZvaWQgKl9fdnBwX3ZlcmlmeSA9ICh0eXBlb2YoKCYoa3NvZnRpcnFkKSkgKyAw
KSkoKHZvaWQgKikwKTsgKHZvaWQpX192cHBfdmVyaWZ5OyB9IHdoaWxlICgwKTsgKHsgdW5z
aWduZWQgbG9uZyBfX3B0cjsgX19hc21fXyAoIiIgOiAiPXIiKF9fcHRyKSA6ICIwIigodHlw
ZW9mKCooJihrc29mdGlycWQpKSkgKikoJihrc29mdGlycWQpKSkpOyAodHlwZW9mKCh0eXBl
b2YoKigmKGtzb2Z0aXJxZCkpKSAqKSgmKGtzb2Z0aXJxZCkpKSkgKF9fcHRyICsgKChsb2Nh
bF9wYWNhLT5kYXRhX29mZnNldCkpKTsgfSk7IH0pKSA9PSBzaXplb2YobG9uZyBsb25nKSkp
IF9fY29tcGlsZXRpbWVfYXNzZXJ0XzIwMygpOyB9IHdoaWxlICgwKTsgKHsgdHlwZW9mKCBf
R2VuZXJpYygoKih7IGRvIHsgY29uc3Qgdm9pZCAqX192cHBfdmVyaWZ5ID0gKHR5cGVvZigo
Jihrc29mdGlycWQpKSArIDApKSgodm9pZCAqKTApOyAodm9pZClfX3ZwcF92ZXJpZnk7IH0g
d2hpbGUgKDApOyAoeyB1bnNpZ25lZCBsb25nIF9fcHRyOyBfX2FzbV9fICgiIiA6ICI9ciIo
X19wdHIpIDogIjAiKCh0eXBlb2YoKigmKGtzb2Z0aXJxZCkpKSAqKSgmKGtzb2Z0aXJxZCkp
KSk7ICh0eXBlb2YoKHR5cGVvZigqKCYoa3NvZnRpcnFkKSkpICopKCYoa3NvZnRpcnFkKSkp
KSAoX19wdHIgKyAoKGxvY2FsX3BhY2EtPmRhdGFfb2Zmc2V0KSkpOyB9KTsgfSkpLCBjaGFy
OiAoY2hhcikwLCB1bnNpZ25lZCBjaGFyOiAodW5zaWduZWQgY2hhcikwLCBzaWduZWQgY2hh
cjogKHNpZ25lZCBjaGFyKTAsIHVuc2lnbmVkIHNob3J0OiAodW5zaWduZWQgc2hvcnQpMCwg
c2lnbmVkIHNob3J0OiAoc2lnbmVkIHNob3J0KTAsIHVuc2lnbmVkIGludDogKHVuc2lnbmVk
IGludCkwLCBzaWduZWQgaW50OiAoc2lnbmVkIGludCkwLCB1bnNpZ25lZCBsb25nOiAodW5z
aWduZWQgbG9uZykwLCBzaWduZWQgbG9uZzogKHNpZ25lZCBsb25nKTAsIHVuc2lnbmVkIGxv
bmcgbG9uZzogKHVuc2lnbmVkIGxvbmcgbG9uZykwLCBzaWduZWQgbG9uZyBsb25nOiAoc2ln
bmVkIGxvbmcgbG9uZykwLCBkZWZhdWx0OiAoKih7IGRvIHsgY29uc3Qgdm9pZCAqX192cHBf
dmVyaWZ5ID0gKHR5cGVvZigoJihrc29mdGlycWQpKSArIDApKSgodm9pZCAqKTApOyAodm9p
ZClfX3ZwcF92ZXJpZnk7IH0gd2hpbGUgKDApOyAoeyB1bnNpZ25lZCBsb25nIF9fcHRyOyBf
X2FzbV9fICgiIiA6ICI9ciIoX19wdHIpIDogIjAiKCh0eXBlb2YoKigmKGtzb2Z0aXJxZCkp
KSAqKSgmKGtzb2Z0aXJxZCkpKSk7ICh0eXBlb2YoKHR5cGVvZigqKCYoa3NvZnRpcnFkKSkp
ICopKCYoa3NvZnRpcnFkKSkpKSAoX19wdHIgKyAoKGxvY2FsX3BhY2EtPmRhdGFfb2Zmc2V0
KSkpOyB9KTsgfSkpKSkgX194ID0gKCooY29uc3Qgdm9sYXRpbGUgdHlwZW9mKCBfR2VuZXJp
YygoKih7IGRvIHsgY29uc3Qgdm9pZCAqX192cHBfdmVyaWZ5ID0gKHR5cGVvZigoJihrc29m
dGlycWQpKSArIDApKSgodm9pZCAqKTApOyAodm9pZClfX3ZwcF92ZXJpZnk7IH0gd2hpbGUg
KDApOyAoeyB1bnNpZ25lZCBsb25nIF9fcHRyOyBfX2FzbV9fICgiIiA6ICI9ciIoX19wdHIp
IDogIjAiKCh0eXBlb2YoKigmKGtzb2Z0aXJxZCkpKSAqKSgmKGtzb2Z0aXJxZCkpKSk7ICh0
eXBlb2YoKHR5cGVvZigqKCYoa3NvZnRpcnFkKSkpICopKCYoa3NvZnRpcnFkKSkpKSAoX19w
dHIgKyAoKGxvY2FsX3BhY2EtPmRhdGFfb2Zmc2V0KSkpOyB9KTsgfSkpLCBjaGFyOiAoY2hh
cikwLCB1bnNpZ25lZCBjaGFyOiAodW5zaWduZWQgY2hhcikwLCBzaWduZWQgY2hhcjogKHNp
Z25lZCBjaGFyKTAsIHVuc2lnbmVkIHNob3J0OiAodW5zaWduZWQgc2hvcnQpMCwgc2lnbmVk
IHNob3J0OiAoc2lnbmVkIHNob3J0KTAsIHVuc2lnbmVkIGludDogKHVuc2lnbmVkIGludCkw
LCBzaWduZWQgaW50OiAoc2lnbmVkIGludCkwLCB1bnNpZ25lZCBsb25nOiAodW5zaWduZWQg
bG9uZykwLCBzaWduZWQgbG9uZzogKHNpZ25lZCBsb25nKTAsIHVuc2lnbmVkIGxvbmcgbG9u
ZzogKHVuc2lnbmVkIGxvbmcgbG9uZykwLCBzaWduZWQgbG9uZyBsb25nOiAoc2lnbmVkIGxv
bmcgbG9uZykwLCBkZWZhdWx0OiAoKih7IGRvIHsgY29uc3Qgdm9pZCAqX192cHBfdmVyaWZ5
ID0gKHR5cGVvZigoJihrc29mdGlycWQpKSArIDApKSgodm9pZCAqKTApOyAodm9pZClfX3Zw
cF92ZXJpZnk7IH0gd2hpbGUgKDApOyAoeyB1bnNpZ25lZCBsb25nIF9fcHRyOyBfX2FzbV9f
ICgiIiA6ICI9ciIoX19wdHIpIDogIjAiKCh0eXBlb2YoKigmKGtzb2Z0aXJxZCkpKSAqKSgm
KGtzb2Z0aXJxZCkpKSk7ICh0eXBlb2YoKHR5cGVvZigqKCYoa3NvZnRpcnFkKSkpICopKCYo
a3NvZnRpcnFkKSkpKSAoX19wdHIgKyAoKGxvY2FsX3BhY2EtPmRhdGFfb2Zmc2V0KSkpOyB9
KTsgfSkpKSkgKikmKCooeyBkbyB7IGNvbnN0IHZvaWQgKl9fdnBwX3ZlcmlmeSA9ICh0eXBl
b2YoKCYoa3NvZnRpcnFkKSkgKyAwKSkoKHZvaWQgKikwKTsgKHZvaWQpX192cHBfdmVyaWZ5
OyB9IHdoaWxlICgwKTsgKHsgdW5zaWduZWQgbG9uZyBfX3B0cjsgX19hc21fXyAoIiIgOiAi
PXIiKF9fcHRyKSA6ICIwIigodHlwZW9mKCooJihrc29mdGlycWQpKSkgKikoJihrc29mdGly
cWQpKSkpOyAodHlwZW9mKCh0eXBlb2YoKigmKGtzb2Z0aXJxZCkpKSAqKSgmKGtzb2Z0aXJx
ZCkpKSkgKF9fcHRyICsgKChsb2NhbF9wYWNhLT5kYXRhX29mZnNldCkpKTsgfSk7IH0pKSk7
IGRvIHsgfSB3aGlsZSAoMCk7ICh0eXBlb2YoKih7IGRvIHsgY29uc3Qgdm9pZCAqX192cHBf
dmVyaWZ5ID0gKHR5cGVvZigoJihrc29mdGlycWQpKSArIDApKSgodm9pZCAqKTApOyAodm9p
ZClfX3ZwcF92ZXJpZnk7IH0gd2hpbGUgKDApOyAoeyB1bnNpZ25lZCBsb25nIF9fcHRyOyBf
X2FzbV9fICgiIiA6ICI9ciIoX19wdHIpIDogIjAiKCh0eXBlb2YoKigmKGtzb2Z0aXJxZCkp
KSAqKSgmKGtzb2Z0aXJxZCkpKSk7ICh0eXBlb2YoKHR5cGVvZigqKCYoa3NvZnRpcnFkKSkp
ICopKCYoa3NvZnRpcnFkKSkpKSAoX19wdHIgKyAoKGxvY2FsX3BhY2EtPmRhdGFfb2Zmc2V0
KSkpOyB9KTsgfSkpKV9feDsgfSk7IH0pOyBfX2FzbV9fIF9fdm9sYXRpbGVfXygiIjogOiA6
Im1lbW9yeSIpOyBfX3JldDsgfSk7IGVsc2UgX19yZXQgPSAoeyB0eXBlb2Yoa3NvZnRpcnFk
KSBfX3JldDsgdW5zaWduZWQgbG9uZyBfX2ZsYWdzOyBkbyB7ICh7IHVuc2lnbmVkIGxvbmcg
X19kdW1teTsgdHlwZW9mKF9fZmxhZ3MpIF9fZHVtbXkyOyAodm9pZCkoJl9fZHVtbXkgPT0g
Jl9fZHVtbXkyKTsgMTsgfSk7IF9fZmxhZ3MgPSBhcmNoX2xvY2FsX2lycV9zYXZlKCk7IH0g
d2hpbGUgKDApOyBfX3JldCA9ICh7ICooeyBkbyB7IGNvbnN0IHZvaWQgKl9fdnBwX3Zlcmlm
eSA9ICh0eXBlb2YoKCYoa3NvZnRpcnFkKSkgKyAwKSkoKHZvaWQgKikwKTsgKHZvaWQpX192
cHBfdmVyaWZ5OyB9IHdoaWxlICgwKTsgKHsgdW5zaWduZWQgbG9uZyBfX3B0cjsgX19hc21f
XyAoIiIgOiAiPXIiKF9fcHRyKSA6ICIwIigodHlwZW9mKCooJihrc29mdGlycWQpKSkgKiko
Jihrc29mdGlycWQpKSkpOyAodHlwZW9mKCh0eXBlb2YoKigmKGtzb2Z0aXJxZCkpKSAqKSgm
KGtzb2Z0aXJxZCkpKSkgKF9fcHRyICsgKChsb2NhbF9wYWNhLT5kYXRhX29mZnNldCkpKTsg
fSk7IH0pOyB9KTsgZG8geyAoeyB1bnNpZ25lZCBsb25nIF9fZHVtbXk7IHR5cGVvZihfX2Zs
YWdzKSBfX2R1bW15MjsgKHZvaWQpKCZfX2R1bW15ID09ICZfX2R1bW15Mik7IDE7IH0pOyBh
cmNoX2xvY2FsX2lycV9yZXN0b3JlKF9fZmxhZ3MpOyB9IHdoaWxlICgwKTsgX19yZXQ7IH0p
OyBfX3JldDsgfSk7IGJyZWFrOyBjYXNlIDQ6IHBzY3JfcmV0X18gPSAoeyB0eXBlb2Yoa3Nv
ZnRpcnFkKSBfX3JldDsgaWYgKChzaXplb2Yoa3NvZnRpcnFkKSA9PSBzaXplb2YoY2hhcikg
fHwgc2l6ZW9mKGtzb2Z0aXJxZCkgPT0gc2l6ZW9mKHNob3J0KSB8fCBzaXplb2Yoa3NvZnRp
cnFkKSA9PSBzaXplb2YoaW50KSB8fCBzaXplb2Yoa3NvZnRpcnFkKSA9PSBzaXplb2YobG9u
ZykpKSBfX3JldCA9ICh7IHR5cGVvZihrc29mdGlycWQpIF9fcmV0OyBfX2FzbV9fIF9fdm9s
YXRpbGVfXygiIjogOiA6Im1lbW9yeSIpOyBfX3JldCA9ICh7IGRvIHsgZXh0ZXJuIHZvaWQg
X19jb21waWxldGltZV9hc3NlcnRfMjA0KHZvaWQpIF9fYXR0cmlidXRlX18oKF9fZXJyb3Jf
XygiVW5zdXBwb3J0ZWQgYWNjZXNzIHNpemUgZm9yIHtSRUFELFdSSVRFfV9PTkNFKCkuIikp
KTsgaWYgKCEoKHNpemVvZigqKHsgZG8geyBjb25zdCB2b2lkICpfX3ZwcF92ZXJpZnkgPSAo
dHlwZW9mKCgmKGtzb2Z0aXJxZCkpICsgMCkpKCh2b2lkICopMCk7ICh2b2lkKV9fdnBwX3Zl
cmlmeTsgfSB3aGlsZSAoMCk7ICh7IHVuc2lnbmVkIGxvbmcgX19wdHI7IF9fYXNtX18gKCIi
IDogIj1yIihfX3B0cikgOiAiMCIoKHR5cGVvZigqKCYoa3NvZnRpcnFkKSkpICopKCYoa3Nv
ZnRpcnFkKSkpKTsgKHR5cGVvZigodHlwZW9mKCooJihrc29mdGlycWQpKSkgKikoJihrc29m
dGlycWQpKSkpIChfX3B0ciArICgobG9jYWxfcGFjYS0+ZGF0YV9vZmZzZXQpKSk7IH0pOyB9
KSkgPT0gc2l6ZW9mKGNoYXIpIHx8IHNpemVvZigqKHsgZG8geyBjb25zdCB2b2lkICpfX3Zw
cF92ZXJpZnkgPSAodHlwZW9mKCgmKGtzb2Z0aXJxZCkpICsgMCkpKCh2b2lkICopMCk7ICh2
b2lkKV9fdnBwX3ZlcmlmeTsgfSB3aGlsZSAoMCk7ICh7IHVuc2lnbmVkIGxvbmcgX19wdHI7
IF9fYXNtX18gKCIiIDogIj1yIihfX3B0cikgOiAiMCIoKHR5cGVvZigqKCYoa3NvZnRpcnFk
KSkpICopKCYoa3NvZnRpcnFkKSkpKTsgKHR5cGVvZigodHlwZW9mKCooJihrc29mdGlycWQp
KSkgKikoJihrc29mdGlycWQpKSkpIChfX3B0ciArICgobG9jYWxfcGFjYS0+ZGF0YV9vZmZz
ZXQpKSk7IH0pOyB9KSkgPT0gc2l6ZW9mKHNob3J0KSB8fCBzaXplb2YoKih7IGRvIHsgY29u
c3Qgdm9pZCAqX192cHBfdmVyaWZ5ID0gKHR5cGVvZigoJihrc29mdGlycWQpKSArIDApKSgo
dm9pZCAqKTApOyAodm9pZClfX3ZwcF92ZXJpZnk7IH0gd2hpbGUgKDApOyAoeyB1bnNpZ25l
ZCBsb25nIF9fcHRyOyBfX2FzbV9fICgiIiA6ICI9ciIoX19wdHIpIDogIjAiKCh0eXBlb2Yo
KigmKGtzb2Z0aXJxZCkpKSAqKSgmKGtzb2Z0aXJxZCkpKSk7ICh0eXBlb2YoKHR5cGVvZigq
KCYoa3NvZnRpcnFkKSkpICopKCYoa3NvZnRpcnFkKSkpKSAoX19wdHIgKyAoKGxvY2FsX3Bh
Y2EtPmRhdGFfb2Zmc2V0KSkpOyB9KTsgfSkpID09IHNpemVvZihpbnQpIHx8IHNpemVvZigq
KHsgZG8geyBjb25zdCB2b2lkICpfX3ZwcF92ZXJpZnkgPSAodHlwZW9mKCgmKGtzb2Z0aXJx
ZCkpICsgMCkpKCh2b2lkICopMCk7ICh2b2lkKV9fdnBwX3ZlcmlmeTsgfSB3aGlsZSAoMCk7
ICh7IHVuc2lnbmVkIGxvbmcgX19wdHI7IF9fYXNtX18gKCIiIDogIj1yIihfX3B0cikgOiAi
MCIoKHR5cGVvZigqKCYoa3NvZnRpcnFkKSkpICopKCYoa3NvZnRpcnFkKSkpKTsgKHR5cGVv
ZigodHlwZW9mKCooJihrc29mdGlycWQpKSkgKikoJihrc29mdGlycWQpKSkpIChfX3B0ciAr
ICgobG9jYWxfcGFjYS0+ZGF0YV9vZmZzZXQpKSk7IH0pOyB9KSkgPT0gc2l6ZW9mKGxvbmcp
KSB8fCBzaXplb2YoKih7IGRvIHsgY29uc3Qgdm9pZCAqX192cHBfdmVyaWZ5ID0gKHR5cGVv
ZigoJihrc29mdGlycWQpKSArIDApKSgodm9pZCAqKTApOyAodm9pZClfX3ZwcF92ZXJpZnk7
IH0gd2hpbGUgKDApOyAoeyB1bnNpZ25lZCBsb25nIF9fcHRyOyBfX2FzbV9fICgiIiA6ICI9
ciIoX19wdHIpIDogIjAiKCh0eXBlb2YoKigmKGtzb2Z0aXJxZCkpKSAqKSgmKGtzb2Z0aXJx
ZCkpKSk7ICh0eXBlb2YoKHR5cGVvZigqKCYoa3NvZnRpcnFkKSkpICopKCYoa3NvZnRpcnFk
KSkpKSAoX19wdHIgKyAoKGxvY2FsX3BhY2EtPmRhdGFfb2Zmc2V0KSkpOyB9KTsgfSkpID09
IHNpemVvZihsb25nIGxvbmcpKSkgX19jb21waWxldGltZV9hc3NlcnRfMjA0KCk7IH0gd2hp
bGUgKDApOyAoeyB0eXBlb2YoIF9HZW5lcmljKCgqKHsgZG8geyBjb25zdCB2b2lkICpfX3Zw
cF92ZXJpZnkgPSAodHlwZW9mKCgmKGtzb2Z0aXJxZCkpICsgMCkpKCh2b2lkICopMCk7ICh2
b2lkKV9fdnBwX3ZlcmlmeTsgfSB3aGlsZSAoMCk7ICh7IHVuc2lnbmVkIGxvbmcgX19wdHI7
IF9fYXNtX18gKCIiIDogIj1yIihfX3B0cikgOiAiMCIoKHR5cGVvZigqKCYoa3NvZnRpcnFk
KSkpICopKCYoa3NvZnRpcnFkKSkpKTsgKHR5cGVvZigodHlwZW9mKCooJihrc29mdGlycWQp
KSkgKikoJihrc29mdGlycWQpKSkpIChfX3B0ciArICgobG9jYWxfcGFjYS0+ZGF0YV9vZmZz
ZXQpKSk7IH0pOyB9KSksIGNoYXI6IChjaGFyKTAsIHVuc2lnbmVkIGNoYXI6ICh1bnNpZ25l
ZCBjaGFyKTAsIHNpZ25lZCBjaGFyOiAoc2lnbmVkIGNoYXIpMCwgdW5zaWduZWQgc2hvcnQ6
ICh1bnNpZ25lZCBzaG9ydCkwLCBzaWduZWQgc2hvcnQ6IChzaWduZWQgc2hvcnQpMCwgdW5z
aWduZWQgaW50OiAodW5zaWduZWQgaW50KTAsIHNpZ25lZCBpbnQ6IChzaWduZWQgaW50KTAs
IHVuc2lnbmVkIGxvbmc6ICh1bnNpZ25lZCBsb25nKTAsIHNpZ25lZCBsb25nOiAoc2lnbmVk
IGxvbmcpMCwgdW5zaWduZWQgbG9uZyBsb25nOiAodW5zaWduZWQgbG9uZyBsb25nKTAsIHNp
Z25lZCBsb25nIGxvbmc6IChzaWduZWQgbG9uZyBsb25nKTAsIGRlZmF1bHQ6ICgqKHsgZG8g
eyBjb25zdCB2b2lkICpfX3ZwcF92ZXJpZnkgPSAodHlwZW9mKCgmKGtzb2Z0aXJxZCkpICsg
MCkpKCh2b2lkICopMCk7ICh2b2lkKV9fdnBwX3ZlcmlmeTsgfSB3aGlsZSAoMCk7ICh7IHVu
c2lnbmVkIGxvbmcgX19wdHI7IF9fYXNtX18gKCIiIDogIj1yIihfX3B0cikgOiAiMCIoKHR5
cGVvZigqKCYoa3NvZnRpcnFkKSkpICopKCYoa3NvZnRpcnFkKSkpKTsgKHR5cGVvZigodHlw
ZW9mKCooJihrc29mdGlycWQpKSkgKikoJihrc29mdGlycWQpKSkpIChfX3B0ciArICgobG9j
YWxfcGFjYS0+ZGF0YV9vZmZzZXQpKSk7IH0pOyB9KSkpKSBfX3ggPSAoKihjb25zdCB2b2xh
dGlsZSB0eXBlb2YoIF9HZW5lcmljKCgqKHsgZG8geyBjb25zdCB2b2lkICpfX3ZwcF92ZXJp
ZnkgPSAodHlwZW9mKCgmKGtzb2Z0aXJxZCkpICsgMCkpKCh2b2lkICopMCk7ICh2b2lkKV9f
dnBwX3ZlcmlmeTsgfSB3aGlsZSAoMCk7ICh7IHVuc2lnbmVkIGxvbmcgX19wdHI7IF9fYXNt
X18gKCIiIDogIj1yIihfX3B0cikgOiAiMCIoKHR5cGVvZigqKCYoa3NvZnRpcnFkKSkpICop
KCYoa3NvZnRpcnFkKSkpKTsgKHR5cGVvZigodHlwZW9mKCooJihrc29mdGlycWQpKSkgKiko
Jihrc29mdGlycWQpKSkpIChfX3B0ciArICgobG9jYWxfcGFjYS0+ZGF0YV9vZmZzZXQpKSk7
IH0pOyB9KSksIGNoYXI6IChjaGFyKTAsIHVuc2lnbmVkIGNoYXI6ICh1bnNpZ25lZCBjaGFy
KTAsIHNpZ25lZCBjaGFyOiAoc2lnbmVkIGNoYXIpMCwgdW5zaWduZWQgc2hvcnQ6ICh1bnNp
Z25lZCBzaG9ydCkwLCBzaWduZWQgc2hvcnQ6IChzaWduZWQgc2hvcnQpMCwgdW5zaWduZWQg
aW50OiAodW5zaWduZWQgaW50KTAsIHNpZ25lZCBpbnQ6IChzaWduZWQgaW50KTAsIHVuc2ln
bmVkIGxvbmc6ICh1bnNpZ25lZCBsb25nKTAsIHNpZ25lZCBsb25nOiAoc2lnbmVkIGxvbmcp
MCwgdW5zaWduZWQgbG9uZyBsb25nOiAodW5zaWduZWQgbG9uZyBsb25nKTAsIHNpZ25lZCBs
b25nIGxvbmc6IChzaWduZWQgbG9uZyBsb25nKTAsIGRlZmF1bHQ6ICgqKHsgZG8geyBjb25z
dCB2b2lkICpfX3ZwcF92ZXJpZnkgPSAodHlwZW9mKCgmKGtzb2Z0aXJxZCkpICsgMCkpKCh2
b2lkICopMCk7ICh2b2lkKV9fdnBwX3ZlcmlmeTsgfSB3aGlsZSAoMCk7ICh7IHVuc2lnbmVk
IGxvbmcgX19wdHI7IF9fYXNtX18gKCIiIDogIj1yIihfX3B0cikgOiAiMCIoKHR5cGVvZigq
KCYoa3NvZnRpcnFkKSkpICopKCYoa3NvZnRpcnFkKSkpKTsgKHR5cGVvZigodHlwZW9mKCoo
Jihrc29mdGlycWQpKSkgKikoJihrc29mdGlycWQpKSkpIChfX3B0ciArICgobG9jYWxfcGFj
YS0+ZGF0YV9vZmZzZXQpKSk7IH0pOyB9KSkpKSAqKSYoKih7IGRvIHsgY29uc3Qgdm9pZCAq
X192cHBfdmVyaWZ5ID0gKHR5cGVvZigoJihrc29mdGlycWQpKSArIDApKSgodm9pZCAqKTAp
OyAodm9pZClfX3ZwcF92ZXJpZnk7IH0gd2hpbGUgKDApOyAoeyB1bnNpZ25lZCBsb25nIF9f
cHRyOyBfX2FzbV9fICgiIiA6ICI9ciIoX19wdHIpIDogIjAiKCh0eXBlb2YoKigmKGtzb2Z0
aXJxZCkpKSAqKSgmKGtzb2Z0aXJxZCkpKSk7ICh0eXBlb2YoKHR5cGVvZigqKCYoa3NvZnRp
cnFkKSkpICopKCYoa3NvZnRpcnFkKSkpKSAoX19wdHIgKyAoKGxvY2FsX3BhY2EtPmRhdGFf
b2Zmc2V0KSkpOyB9KTsgfSkpKTsgZG8geyB9IHdoaWxlICgwKTsgKHR5cGVvZigqKHsgZG8g
eyBjb25zdCB2b2lkICpfX3ZwcF92ZXJpZnkgPSAodHlwZW9mKCgmKGtzb2Z0aXJxZCkpICsg
MCkpKCh2b2lkICopMCk7ICh2b2lkKV9fdnBwX3ZlcmlmeTsgfSB3aGlsZSAoMCk7ICh7IHVu
c2lnbmVkIGxvbmcgX19wdHI7IF9fYXNtX18gKCIiIDogIj1yIihfX3B0cikgOiAiMCIoKHR5
cGVvZigqKCYoa3NvZnRpcnFkKSkpICopKCYoa3NvZnRpcnFkKSkpKTsgKHR5cGVvZigodHlw
ZW9mKCooJihrc29mdGlycWQpKSkgKikoJihrc29mdGlycWQpKSkpIChfX3B0ciArICgobG9j
YWxfcGFjYS0+ZGF0YV9vZmZzZXQpKSk7IH0pOyB9KSkpX194OyB9KTsgfSk7IF9fYXNtX18g
X192b2xhdGlsZV9fKCIiOiA6IDoibWVtb3J5Iik7IF9fcmV0OyB9KTsgZWxzZSBfX3JldCA9
ICh7IHR5cGVvZihrc29mdGlycWQpIF9fcmV0OyB1bnNpZ25lZCBsb25nIF9fZmxhZ3M7IGRv
IHsgKHsgdW5zaWduZWQgbG9uZyBfX2R1bW15OyB0eXBlb2YoX19mbGFncykgX19kdW1teTI7
ICh2b2lkKSgmX19kdW1teSA9PSAmX19kdW1teTIpOyAxOyB9KTsgX19mbGFncyA9IGFyY2hf
bG9jYWxfaXJxX3NhdmUoKTsgfSB3aGlsZSAoMCk7IF9fcmV0ID0gKHsgKih7IGRvIHsgY29u
c3Qgdm9pZCAqX192cHBfdmVyaWZ5ID0gKHR5cGVvZigoJihrc29mdGlycWQpKSArIDApKSgo
dm9pZCAqKTApOyAodm9pZClfX3ZwcF92ZXJpZnk7IH0gd2hpbGUgKDApOyAoeyB1bnNpZ25l
ZCBsb25nIF9fcHRyOyBfX2FzbV9fICgiIiA6ICI9ciIoX19wdHIpIDogIjAiKCh0eXBlb2Yo
KigmKGtzb2Z0aXJxZCkpKSAqKSgmKGtzb2Z0aXJxZCkpKSk7ICh0eXBlb2YoKHR5cGVvZigq
KCYoa3NvZnRpcnFkKSkpICopKCYoa3NvZnRpcnFkKSkpKSAoX19wdHIgKyAoKGxvY2FsX3Bh
Y2EtPmRhdGFfb2Zmc2V0KSkpOyB9KTsgfSk7IH0pOyBkbyB7ICh7IHVuc2lnbmVkIGxvbmcg
X19kdW1teTsgdHlwZW9mKF9fZmxhZ3MpIF9fZHVtbXkyOyAodm9pZCkoJl9fZHVtbXkgPT0g
Jl9fZHVtbXkyKTsgMTsgfSk7IGFyY2hfbG9jYWxfaXJxX3Jlc3RvcmUoX19mbGFncyk7IH0g
d2hpbGUgKDApOyBfX3JldDsgfSk7IF9fcmV0OyB9KTsgYnJlYWs7IGNhc2UgODogcHNjcl9y
ZXRfXyA9ICh7IHR5cGVvZihrc29mdGlycWQpIF9fcmV0OyBpZiAoKHNpemVvZihrc29mdGly
cWQpID09IHNpemVvZihjaGFyKSB8fCBzaXplb2Yoa3NvZnRpcnFkKSA9PSBzaXplb2Yoc2hv
cnQpIHx8IHNpemVvZihrc29mdGlycWQpID09IHNpemVvZihpbnQpIHx8IHNpemVvZihrc29m
dGlycWQpID09IHNpemVvZihsb25nKSkpIF9fcmV0ID0gKHsgdHlwZW9mKGtzb2Z0aXJxZCkg
X19yZXQ7IF9fYXNtX18gX192b2xhdGlsZV9fKCIiOiA6IDoibWVtb3J5Iik7IF9fcmV0ID0g
KHsgZG8geyBleHRlcm4gdm9pZCBfX2NvbXBpbGV0aW1lX2Fzc2VydF8yMDUodm9pZCkgX19h
dHRyaWJ1dGVfXygoX19lcnJvcl9fKCJVbnN1cHBvcnRlZCBhY2Nlc3Mgc2l6ZSBmb3Ige1JF
QUQsV1JJVEV9X09OQ0UoKS4iKSkpOyBpZiAoISgoc2l6ZW9mKCooeyBkbyB7IGNvbnN0IHZv
aWQgKl9fdnBwX3ZlcmlmeSA9ICh0eXBlb2YoKCYoa3NvZnRpcnFkKSkgKyAwKSkoKHZvaWQg
KikwKTsgKHZvaWQpX192cHBfdmVyaWZ5OyB9IHdoaWxlICgwKTsgKHsgdW5zaWduZWQgbG9u
ZyBfX3B0cjsgX19hc21fXyAoIiIgOiAiPXIiKF9fcHRyKSA6ICIwIigodHlwZW9mKCooJihr
c29mdGlycWQpKSkgKikoJihrc29mdGlycWQpKSkpOyAodHlwZW9mKCh0eXBlb2YoKigmKGtz
b2Z0aXJxZCkpKSAqKSgmKGtzb2Z0aXJxZCkpKSkgKF9fcHRyICsgKChsb2NhbF9wYWNhLT5k
YXRhX29mZnNldCkpKTsgfSk7IH0pKSA9PSBzaXplb2YoY2hhcikgfHwgc2l6ZW9mKCooeyBk
byB7IGNvbnN0IHZvaWQgKl9fdnBwX3ZlcmlmeSA9ICh0eXBlb2YoKCYoa3NvZnRpcnFkKSkg
KyAwKSkoKHZvaWQgKikwKTsgKHZvaWQpX192cHBfdmVyaWZ5OyB9IHdoaWxlICgwKTsgKHsg
dW5zaWduZWQgbG9uZyBfX3B0cjsgX19hc21fXyAoIiIgOiAiPXIiKF9fcHRyKSA6ICIwIigo
dHlwZW9mKCooJihrc29mdGlycWQpKSkgKikoJihrc29mdGlycWQpKSkpOyAodHlwZW9mKCh0
eXBlb2YoKigmKGtzb2Z0aXJxZCkpKSAqKSgmKGtzb2Z0aXJxZCkpKSkgKF9fcHRyICsgKChs
b2NhbF9wYWNhLT5kYXRhX29mZnNldCkpKTsgfSk7IH0pKSA9PSBzaXplb2Yoc2hvcnQpIHx8
IHNpemVvZigqKHsgZG8geyBjb25zdCB2b2lkICpfX3ZwcF92ZXJpZnkgPSAodHlwZW9mKCgm
KGtzb2Z0aXJxZCkpICsgMCkpKCh2b2lkICopMCk7ICh2b2lkKV9fdnBwX3ZlcmlmeTsgfSB3
aGlsZSAoMCk7ICh7IHVuc2lnbmVkIGxvbmcgX19wdHI7IF9fYXNtX18gKCIiIDogIj1yIihf
X3B0cikgOiAiMCIoKHR5cGVvZigqKCYoa3NvZnRpcnFkKSkpICopKCYoa3NvZnRpcnFkKSkp
KTsgKHR5cGVvZigodHlwZW9mKCooJihrc29mdGlycWQpKSkgKikoJihrc29mdGlycWQpKSkp
IChfX3B0ciArICgobG9jYWxfcGFjYS0+ZGF0YV9vZmZzZXQpKSk7IH0pOyB9KSkgPT0gc2l6
ZW9mKGludCkgfHwgc2l6ZW9mKCooeyBkbyB7IGNvbnN0IHZvaWQgKl9fdnBwX3ZlcmlmeSA9
ICh0eXBlb2YoKCYoa3NvZnRpcnFkKSkgKyAwKSkoKHZvaWQgKikwKTsgKHZvaWQpX192cHBf
dmVyaWZ5OyB9IHdoaWxlICgwKTsgKHsgdW5zaWduZWQgbG9uZyBfX3B0cjsgX19hc21fXyAo
IiIgOiAiPXIiKF9fcHRyKSA6ICIwIigodHlwZW9mKCooJihrc29mdGlycWQpKSkgKikoJihr
c29mdGlycWQpKSkpOyAodHlwZW9mKCh0eXBlb2YoKigmKGtzb2Z0aXJxZCkpKSAqKSgmKGtz
b2Z0aXJxZCkpKSkgKF9fcHRyICsgKChsb2NhbF9wYWNhLT5kYXRhX29mZnNldCkpKTsgfSk7
IH0pKSA9PSBzaXplb2YobG9uZykpIHx8IHNpemVvZigqKHsgZG8geyBjb25zdCB2b2lkICpf
X3ZwcF92ZXJpZnkgPSAodHlwZW9mKCgmKGtzb2Z0aXJxZCkpICsgMCkpKCh2b2lkICopMCk7
ICh2b2lkKV9fdnBwX3ZlcmlmeTsgfSB3aGlsZSAoMCk7ICh7IHVuc2lnbmVkIGxvbmcgX19w
dHI7IF9fYXNtX18gKCIiIDogIj1yIihfX3B0cikgOiAiMCIoKHR5cGVvZigqKCYoa3NvZnRp
cnFkKSkpICopKCYoa3NvZnRpcnFkKSkpKTsgKHR5cGVvZigodHlwZW9mKCooJihrc29mdGly
cWQpKSkgKikoJihrc29mdGlycWQpKSkpIChfX3B0ciArICgobG9jYWxfcGFjYS0+ZGF0YV9v
ZmZzZXQpKSk7IH0pOyB9KSkgPT0gc2l6ZW9mKGxvbmcgbG9uZykpKSBfX2NvbXBpbGV0aW1l
X2Fzc2VydF8yMDUoKTsgfSB3aGlsZSAoMCk7ICh7IHR5cGVvZiggX0dlbmVyaWMoKCooeyBk
byB7IGNvbnN0IHZvaWQgKl9fdnBwX3ZlcmlmeSA9ICh0eXBlb2YoKCYoa3NvZnRpcnFkKSkg
KyAwKSkoKHZvaWQgKikwKTsgKHZvaWQpX192cHBfdmVyaWZ5OyB9IHdoaWxlICgwKTsgKHsg
dW5zaWduZWQgbG9uZyBfX3B0cjsgX19hc21fXyAoIiIgOiAiPXIiKF9fcHRyKSA6ICIwIigo
dHlwZW9mKCooJihrc29mdGlycWQpKSkgKikoJihrc29mdGlycWQpKSkpOyAodHlwZW9mKCh0
eXBlb2YoKigmKGtzb2Z0aXJxZCkpKSAqKSgmKGtzb2Z0aXJxZCkpKSkgKF9fcHRyICsgKChs
b2NhbF9wYWNhLT5kYXRhX29mZnNldCkpKTsgfSk7IH0pKSwgY2hhcjogKGNoYXIpMCwgdW5z
aWduZWQgY2hhcjogKHVuc2lnbmVkIGNoYXIpMCwgc2lnbmVkIGNoYXI6IChzaWduZWQgY2hh
cikwLCB1bnNpZ25lZCBzaG9ydDogKHVuc2lnbmVkIHNob3J0KTAsIHNpZ25lZCBzaG9ydDog
KHNpZ25lZCBzaG9ydCkwLCB1bnNpZ25lZCBpbnQ6ICh1bnNpZ25lZCBpbnQpMCwgc2lnbmVk
IGludDogKHNpZ25lZCBpbnQpMCwgdW5zaWduZWQgbG9uZzogKHVuc2lnbmVkIGxvbmcpMCwg
c2lnbmVkIGxvbmc6IChzaWduZWQgbG9uZykwLCB1bnNpZ25lZCBsb25nIGxvbmc6ICh1bnNp
Z25lZCBsb25nIGxvbmcpMCwgc2lnbmVkIGxvbmcgbG9uZzogKHNpZ25lZCBsb25nIGxvbmcp
MCwgZGVmYXVsdDogKCooeyBkbyB7IGNvbnN0IHZvaWQgKl9fdnBwX3ZlcmlmeSA9ICh0eXBl
b2YoKCYoa3NvZnRpcnFkKSkgKyAwKSkoKHZvaWQgKikwKTsgKHZvaWQpX192cHBfdmVyaWZ5
OyB9IHdoaWxlICgwKTsgKHsgdW5zaWduZWQgbG9uZyBfX3B0cjsgX19hc21fXyAoIiIgOiAi
PXIiKF9fcHRyKSA6ICIwIigodHlwZW9mKCooJihrc29mdGlycWQpKSkgKikoJihrc29mdGly
cWQpKSkpOyAodHlwZW9mKCh0eXBlb2YoKigmKGtzb2Z0aXJxZCkpKSAqKSgmKGtzb2Z0aXJx
ZCkpKSkgKF9fcHRyICsgKChsb2NhbF9wYWNhLT5kYXRhX29mZnNldCkpKTsgfSk7IH0pKSkp
IF9feCA9ICgqKGNvbnN0IHZvbGF0aWxlIHR5cGVvZiggX0dlbmVyaWMoKCooeyBkbyB7IGNv
bnN0IHZvaWQgKl9fdnBwX3ZlcmlmeSA9ICh0eXBlb2YoKCYoa3NvZnRpcnFkKSkgKyAwKSko
KHZvaWQgKikwKTsgKHZvaWQpX192cHBfdmVyaWZ5OyB9IHdoaWxlICgwKTsgKHsgdW5zaWdu
ZWQgbG9uZyBfX3B0cjsgX19hc21fXyAoIiIgOiAiPXIiKF9fcHRyKSA6ICIwIigodHlwZW9m
KCooJihrc29mdGlycWQpKSkgKikoJihrc29mdGlycWQpKSkpOyAodHlwZW9mKCh0eXBlb2Yo
KigmKGtzb2Z0aXJxZCkpKSAqKSgmKGtzb2Z0aXJxZCkpKSkgKF9fcHRyICsgKChsb2NhbF9w
YWNhLT5kYXRhX29mZnNldCkpKTsgfSk7IH0pKSwgY2hhcjogKGNoYXIpMCwgdW5zaWduZWQg
Y2hhcjogKHVuc2lnbmVkIGNoYXIpMCwgc2lnbmVkIGNoYXI6IChzaWduZWQgY2hhcikwLCB1
bnNpZ25lZCBzaG9ydDogKHVuc2lnbmVkIHNob3J0KTAsIHNpZ25lZCBzaG9ydDogKHNpZ25l
ZCBzaG9ydCkwLCB1bnNpZ25lZCBpbnQ6ICh1bnNpZ25lZCBpbnQpMCwgc2lnbmVkIGludDog
KHNpZ25lZCBpbnQpMCwgdW5zaWduZWQgbG9uZzogKHVuc2lnbmVkIGxvbmcpMCwgc2lnbmVk
IGxvbmc6IChzaWduZWQgbG9uZykwLCB1bnNpZ25lZCBsb25nIGxvbmc6ICh1bnNpZ25lZCBs
b25nIGxvbmcpMCwgc2lnbmVkIGxvbmcgbG9uZzogKHNpZ25lZCBsb25nIGxvbmcpMCwgZGVm
YXVsdDogKCooeyBkbyB7IGNvbnN0IHZvaWQgKl9fdnBwX3ZlcmlmeSA9ICh0eXBlb2YoKCYo
a3NvZnRpcnFkKSkgKyAwKSkoKHZvaWQgKikwKTsgKHZvaWQpX192cHBfdmVyaWZ5OyB9IHdo
aWxlICgwKTsgKHsgdW5zaWduZWQgbG9uZyBfX3B0cjsgX19hc21fXyAoIiIgOiAiPXIiKF9f
cHRyKSA6ICIwIigodHlwZW9mKCooJihrc29mdGlycWQpKSkgKikoJihrc29mdGlycWQpKSkp
OyAodHlwZW9mKCh0eXBlb2YoKigmKGtzb2Z0aXJxZCkpKSAqKSgmKGtzb2Z0aXJxZCkpKSkg
KF9fcHRyICsgKChsb2NhbF9wYWNhLT5kYXRhX29mZnNldCkpKTsgfSk7IH0pKSkpICopJigq
KHsgZG8geyBjb25zdCB2b2lkICpfX3ZwcF92ZXJpZnkgPSAodHlwZW9mKCgmKGtzb2Z0aXJx
ZCkpICsgMCkpKCh2b2lkICopMCk7ICh2b2lkKV9fdnBwX3ZlcmlmeTsgfSB3aGlsZSAoMCk7
ICh7IHVuc2lnbmVkIGxvbmcgX19wdHI7IF9fYXNtX18gKCIiIDogIj1yIihfX3B0cikgOiAi
MCIoKHR5cGVvZigqKCYoa3NvZnRpcnFkKSkpICopKCYoa3NvZnRpcnFkKSkpKTsgKHR5cGVv
ZigodHlwZW9mKCooJihrc29mdGlycWQpKSkgKikoJihrc29mdGlycWQpKSkpIChfX3B0ciAr
ICgobG9jYWxfcGFjYS0+ZGF0YV9vZmZzZXQpKSk7IH0pOyB9KSkpOyBkbyB7IH0gd2hpbGUg
KDApOyAodHlwZW9mKCooeyBkbyB7IGNvbnN0IHZvaWQgKl9fdnBwX3ZlcmlmeSA9ICh0eXBl
b2YoKCYoa3NvZnRpcnFkKSkgKyAwKSkoKHZvaWQgKikwKTsgKHZvaWQpX192cHBfdmVyaWZ5
OyB9IHdoaWxlICgwKTsgKHsgdW5zaWduZWQgbG9uZyBfX3B0cjsgX19hc21fXyAoIiIgOiAi
PXIiKF9fcHRyKSA6ICIwIigodHlwZW9mKCooJihrc29mdGlycWQpKSkgKikoJihrc29mdGly
cWQpKSkpOyAodHlwZW9mKCh0eXBlb2YoKigmKGtzb2Z0aXJxZCkpKSAqKSgmKGtzb2Z0aXJx
ZCkpKSkgKF9fcHRyICsgKChsb2NhbF9wYWNhLT5kYXRhX29mZnNldCkpKTsgfSk7IH0pKSlf
X3g7IH0pOyB9KTsgX19hc21fXyBfX3ZvbGF0aWxlX18oIiI6IDogOiJtZW1vcnkiKTsgX19y
ZXQ7IH0pOyBlbHNlIF9fcmV0ID0gKHsgdHlwZW9mKGtzb2Z0aXJxZCkgX19yZXQ7IHVuc2ln
bmVkIGxvbmcgX19mbGFnczsgZG8geyAoeyB1bnNpZ25lZCBsb25nIF9fZHVtbXk7IHR5cGVv
ZihfX2ZsYWdzKSBfX2R1bW15MjsgKHZvaWQpKCZfX2R1bW15ID09ICZfX2R1bW15Mik7IDE7
IH0pOyBfX2ZsYWdzID0gYXJjaF9sb2NhbF9pcnFfc2F2ZSgpOyB9IHdoaWxlICgwKTsgX19y
ZXQgPSAoeyAqKHsgZG8geyBjb25zdCB2b2lkICpfX3ZwcF92ZXJpZnkgPSAodHlwZW9mKCgm
KGtzb2Z0aXJxZCkpICsgMCkpKCh2b2lkICopMCk7ICh2b2lkKV9fdnBwX3ZlcmlmeTsgfSB3
aGlsZSAoMCk7ICh7IHVuc2lnbmVkIGxvbmcgX19wdHI7IF9fYXNtX18gKCIiIDogIj1yIihf
X3B0cikgOiAiMCIoKHR5cGVvZigqKCYoa3NvZnRpcnFkKSkpICopKCYoa3NvZnRpcnFkKSkp
KTsgKHR5cGVvZigodHlwZW9mKCooJihrc29mdGlycWQpKSkgKikoJihrc29mdGlycWQpKSkp
IChfX3B0ciArICgobG9jYWxfcGFjYS0+ZGF0YV9vZmZzZXQpKSk7IH0pOyB9KTsgfSk7IGRv
IHsgKHsgdW5zaWduZWQgbG9uZyBfX2R1bW15OyB0eXBlb2YoX19mbGFncykgX19kdW1teTI7
ICh2b2lkKSgmX19kdW1teSA9PSAmX19kdW1teTIpOyAxOyB9KTsgYXJjaF9sb2NhbF9pcnFf
cmVzdG9yZShfX2ZsYWdzKTsgfSB3aGlsZSAoMCk7IF9fcmV0OyB9KTsgX19yZXQ7IH0pOyBi
cmVhazsgZGVmYXVsdDogX19iYWRfc2l6ZV9jYWxsX3BhcmFtZXRlcigpOyBicmVhazsgfSBw
c2NyX3JldF9fOyB9KTsKfQojIDYwNiAiLi9pbmNsdWRlL2xpbnV4L2ludGVycnVwdC5oIgpz
dHJ1Y3QgdGFza2xldF9zdHJ1Y3QKewogc3RydWN0IHRhc2tsZXRfc3RydWN0ICpuZXh0Owog
dW5zaWduZWQgbG9uZyBzdGF0ZTsKIGF0b21pY190IGNvdW50Owogdm9pZCAoKmZ1bmMpKHVu
c2lnbmVkIGxvbmcpOwogdW5zaWduZWQgbG9uZyBkYXRhOwp9OwojIDYyMiAiLi9pbmNsdWRl
L2xpbnV4L2ludGVycnVwdC5oIgplbnVtCnsKIFRBU0tMRVRfU1RBVEVfU0NIRUQsCiBUQVNL
TEVUX1NUQVRFX1JVTgp9OwoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgdGFza2xldF90cnlsb2NrKHN0cnVj
dCB0YXNrbGV0X3N0cnVjdCAqdCkKewogcmV0dXJuICF0ZXN0X2FuZF9zZXRfYml0KFRBU0tM
RVRfU1RBVEVfUlVOLCAmKHQpLT5zdGF0ZSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHRhc2tsZXRf
dW5sb2NrKHN0cnVjdCB0YXNrbGV0X3N0cnVjdCAqdCkKewogX19hc21fXyBfX3ZvbGF0aWxl
X18gKCJzeW5jIiA6IDogOiAibWVtb3J5Iik7CiBjbGVhcl9iaXQoVEFTS0xFVF9TVEFURV9S
VU4sICYodCktPnN0YXRlKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgdGFza2xldF91bmxvY2tfd2Fp
dChzdHJ1Y3QgdGFza2xldF9zdHJ1Y3QgKnQpCnsKIHdoaWxlICh0ZXN0X2JpdChUQVNLTEVU
X1NUQVRFX1JVTiwgJih0KS0+c3RhdGUpKSB7IF9fYXNtX18gX192b2xhdGlsZV9fKCIiOiA6
IDoibWVtb3J5Iik7IH0KfQoKCgoKCgpleHRlcm4gdm9pZCBfX3Rhc2tsZXRfc2NoZWR1bGUo
c3RydWN0IHRhc2tsZXRfc3RydWN0ICp0KTsKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHRhc2tsZXRfc2No
ZWR1bGUoc3RydWN0IHRhc2tsZXRfc3RydWN0ICp0KQp7CiBpZiAoIXRlc3RfYW5kX3NldF9i
aXQoVEFTS0xFVF9TVEFURV9TQ0hFRCwgJnQtPnN0YXRlKSkKICBfX3Rhc2tsZXRfc2NoZWR1
bGUodCk7Cn0KCmV4dGVybiB2b2lkIF9fdGFza2xldF9oaV9zY2hlZHVsZShzdHJ1Y3QgdGFz
a2xldF9zdHJ1Y3QgKnQpOwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgdGFza2xldF9oaV9zY2hlZHVsZShz
dHJ1Y3QgdGFza2xldF9zdHJ1Y3QgKnQpCnsKIGlmICghdGVzdF9hbmRfc2V0X2JpdChUQVNL
TEVUX1NUQVRFX1NDSEVELCAmdC0+c3RhdGUpKQogIF9fdGFza2xldF9oaV9zY2hlZHVsZSh0
KTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIHZvaWQgdGFza2xldF9kaXNhYmxlX25vc3luYyhzdHJ1Y3QgdGFz
a2xldF9zdHJ1Y3QgKnQpCnsKIGF0b21pY19pbmMoJnQtPmNvdW50KTsKIF9fYXNtX18gX192
b2xhdGlsZV9fICgic3luYyIgOiA6IDogIm1lbW9yeSIpOwp9CgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCB0
YXNrbGV0X2Rpc2FibGUoc3RydWN0IHRhc2tsZXRfc3RydWN0ICp0KQp7CiB0YXNrbGV0X2Rp
c2FibGVfbm9zeW5jKHQpOwogdGFza2xldF91bmxvY2tfd2FpdCh0KTsKIF9fYXNtX18gX192
b2xhdGlsZV9fICgic3luYyIgOiA6IDogIm1lbW9yeSIpOwp9CgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCB0
YXNrbGV0X2VuYWJsZShzdHJ1Y3QgdGFza2xldF9zdHJ1Y3QgKnQpCnsKIF9fYXNtX18gX192
b2xhdGlsZV9fICgic3luYyIgOiA6IDogIm1lbW9yeSIpOwogYXRvbWljX2RlYygmdC0+Y291
bnQpOwp9CgpleHRlcm4gdm9pZCB0YXNrbGV0X2tpbGwoc3RydWN0IHRhc2tsZXRfc3RydWN0
ICp0KTsKZXh0ZXJuIHZvaWQgdGFza2xldF9raWxsX2ltbWVkaWF0ZShzdHJ1Y3QgdGFza2xl
dF9zdHJ1Y3QgKnQsIHVuc2lnbmVkIGludCBjcHUpOwpleHRlcm4gdm9pZCB0YXNrbGV0X2lu
aXQoc3RydWN0IHRhc2tsZXRfc3RydWN0ICp0LAogICAgdm9pZCAoKmZ1bmMpKHVuc2lnbmVk
IGxvbmcpLCB1bnNpZ25lZCBsb25nIGRhdGEpOwojIDcxOSAiLi9pbmNsdWRlL2xpbnV4L2lu
dGVycnVwdC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgbG9uZyBwcm9iZV9pcnFfb24odm9pZCkK
ewogcmV0dXJuIDA7Cn0Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBwcm9iZV9pcnFfb2ZmKHVuc2lnbmVkIGxv
bmcgdmFsKQp7CiByZXR1cm4gMDsKfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgaW50IHByb2JlX2ly
cV9tYXNrKHVuc2lnbmVkIGxvbmcgdmFsKQp7CiByZXR1cm4gMDsKfQojIDczOSAiLi9pbmNs
dWRlL2xpbnV4L2ludGVycnVwdC5oIgpleHRlcm4gdm9pZCBpbml0X2lycV9wcm9jKHZvaWQp
OwojIDc1MiAiLi9pbmNsdWRlL2xpbnV4L2ludGVycnVwdC5oIgpzdHJ1Y3Qgc2VxX2ZpbGU7
CmludCBzaG93X2ludGVycnVwdHMoc3RydWN0IHNlcV9maWxlICpwLCB2b2lkICp2KTsKaW50
IGFyY2hfc2hvd19pbnRlcnJ1cHRzKHN0cnVjdCBzZXFfZmlsZSAqcCwgaW50IHByZWMpOwoK
ZXh0ZXJuIGludCBlYXJseV9pcnFfaW5pdCh2b2lkKTsKZXh0ZXJuIGludCBhcmNoX3Byb2Jl
X25yX2lycXModm9pZCk7CmV4dGVybiBpbnQgYXJjaF9lYXJseV9pcnFfaW5pdCh2b2lkKTsK
IyAxMCAiLi9pbmNsdWRlL2xpbnV4L2tlcm5lbF9zdGF0LmgiIDIKCgojIDEgIi4vYXJjaC9w
b3dlcnBjL2luY2x1ZGUvYXNtL2lycS5oIiAxCiMgMTMgIi4vaW5jbHVkZS9saW51eC9rZXJu
ZWxfc3RhdC5oIiAyCgoKCgoKCgplbnVtIGNwdV91c2FnZV9zdGF0IHsKIENQVVRJTUVfVVNF
UiwKIENQVVRJTUVfTklDRSwKIENQVVRJTUVfU1lTVEVNLAogQ1BVVElNRV9TT0ZUSVJRLAog
Q1BVVElNRV9JUlEsCiBDUFVUSU1FX0lETEUsCiBDUFVUSU1FX0lPV0FJVCwKIENQVVRJTUVf
U1RFQUwsCiBDUFVUSU1FX0dVRVNULAogQ1BVVElNRV9HVUVTVF9OSUNFLAogTlJfU1RBVFMs
Cn07CgpzdHJ1Y3Qga2VybmVsX2NwdXN0YXQgewogdTY0IGNwdXN0YXRbTlJfU1RBVFNdOwp9
OwoKc3RydWN0IGtlcm5lbF9zdGF0IHsKIHVuc2lnbmVkIGxvbmcgaXJxc19zdW07CiB1bnNp
Z25lZCBpbnQgc29mdGlycXNbTlJfU09GVElSUVNdOwp9OwoKZXh0ZXJuIF9fYXR0cmlidXRl
X18oKHNlY3Rpb24oIi5kYXRhLi5wZXJjcHUiICIiKSkpIF9fdHlwZW9mX18oc3RydWN0IGtl
cm5lbF9zdGF0KSBrc3RhdDsKZXh0ZXJuIF9fYXR0cmlidXRlX18oKHNlY3Rpb24oIi5kYXRh
Li5wZXJjcHUiICIiKSkpIF9fdHlwZW9mX18oc3RydWN0IGtlcm5lbF9jcHVzdGF0KSBrZXJu
ZWxfY3B1c3RhdDsKCgoKCgoKCmV4dGVybiB1bnNpZ25lZCBsb25nIGxvbmcgbnJfY29udGV4
dF9zd2l0Y2hlcyh2b2lkKTsKCmV4dGVybiB1bnNpZ25lZCBpbnQga3N0YXRfaXJxc19jcHUo
dW5zaWduZWQgaW50IGlycSwgaW50IGNwdSk7CmV4dGVybiB2b2lkIGtzdGF0X2luY3JfaXJx
X3RoaXNfY3B1KHVuc2lnbmVkIGludCBpcnEpOwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQga3N0YXRfaW5j
cl9zb2Z0aXJxc190aGlzX2NwdSh1bnNpZ25lZCBpbnQgaXJxKQp7CiAoeyBfX3RoaXNfY3B1
X3ByZWVtcHRfY2hlY2soImFkZCIpOyBkbyB7IGRvIHsgY29uc3Qgdm9pZCAqX192cHBfdmVy
aWZ5ID0gKHR5cGVvZigoJihrc3RhdC5zb2Z0aXJxc1tpcnFdKSkgKyAwKSkoKHZvaWQgKikw
KTsgKHZvaWQpX192cHBfdmVyaWZ5OyB9IHdoaWxlICgwKTsgc3dpdGNoKHNpemVvZihrc3Rh
dC5zb2Z0aXJxc1tpcnFdKSkgeyBjYXNlIDE6IGRvIHsgKih7IGRvIHsgY29uc3Qgdm9pZCAq
X192cHBfdmVyaWZ5ID0gKHR5cGVvZigoJihrc3RhdC5zb2Z0aXJxc1tpcnFdKSkgKyAwKSko
KHZvaWQgKikwKTsgKHZvaWQpX192cHBfdmVyaWZ5OyB9IHdoaWxlICgwKTsgKHsgdW5zaWdu
ZWQgbG9uZyBfX3B0cjsgX19hc21fXyAoIiIgOiAiPXIiKF9fcHRyKSA6ICIwIigodHlwZW9m
KCooJihrc3RhdC5zb2Z0aXJxc1tpcnFdKSkpICopKCYoa3N0YXQuc29mdGlycXNbaXJxXSkp
KSk7ICh0eXBlb2YoKHR5cGVvZigqKCYoa3N0YXQuc29mdGlycXNbaXJxXSkpKSAqKSgmKGtz
dGF0LnNvZnRpcnFzW2lycV0pKSkpIChfX3B0ciArICgobG9jYWxfcGFjYS0+ZGF0YV9vZmZz
ZXQpKSk7IH0pOyB9KSArPSAxOyB9IHdoaWxlICgwKTticmVhazsgY2FzZSAyOiBkbyB7ICoo
eyBkbyB7IGNvbnN0IHZvaWQgKl9fdnBwX3ZlcmlmeSA9ICh0eXBlb2YoKCYoa3N0YXQuc29m
dGlycXNbaXJxXSkpICsgMCkpKCh2b2lkICopMCk7ICh2b2lkKV9fdnBwX3ZlcmlmeTsgfSB3
aGlsZSAoMCk7ICh7IHVuc2lnbmVkIGxvbmcgX19wdHI7IF9fYXNtX18gKCIiIDogIj1yIihf
X3B0cikgOiAiMCIoKHR5cGVvZigqKCYoa3N0YXQuc29mdGlycXNbaXJxXSkpKSAqKSgmKGtz
dGF0LnNvZnRpcnFzW2lycV0pKSkpOyAodHlwZW9mKCh0eXBlb2YoKigmKGtzdGF0LnNvZnRp
cnFzW2lycV0pKSkgKikoJihrc3RhdC5zb2Z0aXJxc1tpcnFdKSkpKSAoX19wdHIgKyAoKGxv
Y2FsX3BhY2EtPmRhdGFfb2Zmc2V0KSkpOyB9KTsgfSkgKz0gMTsgfSB3aGlsZSAoMCk7YnJl
YWs7IGNhc2UgNDogZG8geyAqKHsgZG8geyBjb25zdCB2b2lkICpfX3ZwcF92ZXJpZnkgPSAo
dHlwZW9mKCgmKGtzdGF0LnNvZnRpcnFzW2lycV0pKSArIDApKSgodm9pZCAqKTApOyAodm9p
ZClfX3ZwcF92ZXJpZnk7IH0gd2hpbGUgKDApOyAoeyB1bnNpZ25lZCBsb25nIF9fcHRyOyBf
X2FzbV9fICgiIiA6ICI9ciIoX19wdHIpIDogIjAiKCh0eXBlb2YoKigmKGtzdGF0LnNvZnRp
cnFzW2lycV0pKSkgKikoJihrc3RhdC5zb2Z0aXJxc1tpcnFdKSkpKTsgKHR5cGVvZigodHlw
ZW9mKCooJihrc3RhdC5zb2Z0aXJxc1tpcnFdKSkpICopKCYoa3N0YXQuc29mdGlycXNbaXJx
XSkpKSkgKF9fcHRyICsgKChsb2NhbF9wYWNhLT5kYXRhX29mZnNldCkpKTsgfSk7IH0pICs9
IDE7IH0gd2hpbGUgKDApO2JyZWFrOyBjYXNlIDg6IGRvIHsgKih7IGRvIHsgY29uc3Qgdm9p
ZCAqX192cHBfdmVyaWZ5ID0gKHR5cGVvZigoJihrc3RhdC5zb2Z0aXJxc1tpcnFdKSkgKyAw
KSkoKHZvaWQgKikwKTsgKHZvaWQpX192cHBfdmVyaWZ5OyB9IHdoaWxlICgwKTsgKHsgdW5z
aWduZWQgbG9uZyBfX3B0cjsgX19hc21fXyAoIiIgOiAiPXIiKF9fcHRyKSA6ICIwIigodHlw
ZW9mKCooJihrc3RhdC5zb2Z0aXJxc1tpcnFdKSkpICopKCYoa3N0YXQuc29mdGlycXNbaXJx
XSkpKSk7ICh0eXBlb2YoKHR5cGVvZigqKCYoa3N0YXQuc29mdGlycXNbaXJxXSkpKSAqKSgm
KGtzdGF0LnNvZnRpcnFzW2lycV0pKSkpIChfX3B0ciArICgobG9jYWxfcGFjYS0+ZGF0YV9v
ZmZzZXQpKSk7IH0pOyB9KSArPSAxOyB9IHdoaWxlICgwKTticmVhazsgZGVmYXVsdDogX19i
YWRfc2l6ZV9jYWxsX3BhcmFtZXRlcigpO2JyZWFrOyB9IH0gd2hpbGUgKDApOyB9KTsKfQoK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIHVuc2lnbmVkIGludCBrc3RhdF9zb2Z0aXJxc19jcHUodW5zaWduZWQgaW50
IGlycSwgaW50IGNwdSkKewogICAgICAgcmV0dXJuICgqKHsgZG8geyBjb25zdCB2b2lkICpf
X3ZwcF92ZXJpZnkgPSAodHlwZW9mKCgmKGtzdGF0KSkgKyAwKSkoKHZvaWQgKikwKTsgKHZv
aWQpX192cHBfdmVyaWZ5OyB9IHdoaWxlICgwKTsgKHsgdW5zaWduZWQgbG9uZyBfX3B0cjsg
X19hc21fXyAoIiIgOiAiPXIiKF9fcHRyKSA6ICIwIigodHlwZW9mKCooKCYoa3N0YXQpKSkp
ICopKCgmKGtzdGF0KSkpKSk7ICh0eXBlb2YoKHR5cGVvZigqKCgmKGtzdGF0KSkpKSAqKSgo
Jihrc3RhdCkpKSkpIChfX3B0ciArICgoKF9fcGVyX2NwdV9vZmZzZXRbKGNwdSldKSkpKTsg
fSk7IH0pKS5zb2Z0aXJxc1tpcnFdOwp9CgoKCgpleHRlcm4gdW5zaWduZWQgaW50IGtzdGF0
X2lycXModW5zaWduZWQgaW50IGlycSk7CmV4dGVybiB1bnNpZ25lZCBpbnQga3N0YXRfaXJx
c191c3IodW5zaWduZWQgaW50IGlycSk7CgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgaW50IGtz
dGF0X2NwdV9pcnFzX3N1bSh1bnNpZ25lZCBpbnQgY3B1KQp7CiByZXR1cm4gKCooeyBkbyB7
IGNvbnN0IHZvaWQgKl9fdnBwX3ZlcmlmeSA9ICh0eXBlb2YoKCYoa3N0YXQpKSArIDApKSgo
dm9pZCAqKTApOyAodm9pZClfX3ZwcF92ZXJpZnk7IH0gd2hpbGUgKDApOyAoeyB1bnNpZ25l
ZCBsb25nIF9fcHRyOyBfX2FzbV9fICgiIiA6ICI9ciIoX19wdHIpIDogIjAiKCh0eXBlb2Yo
KigoJihrc3RhdCkpKSkgKikoKCYoa3N0YXQpKSkpKTsgKHR5cGVvZigodHlwZW9mKCooKCYo
a3N0YXQpKSkpICopKCgmKGtzdGF0KSkpKSkgKF9fcHRyICsgKCgoX19wZXJfY3B1X29mZnNl
dFsoY3B1KV0pKSkpOyB9KTsgfSkpLmlycXNfc3VtOwp9CgoKCgoKCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1NjQg
a2NwdXN0YXRfZmllbGQoc3RydWN0IGtlcm5lbF9jcHVzdGF0ICprY3B1c3RhdCwKICAgICBl
bnVtIGNwdV91c2FnZV9zdGF0IHVzYWdlLCBpbnQgY3B1KQp7CiByZXR1cm4ga2NwdXN0YXQt
PmNwdXN0YXRbdXNhZ2VdOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBrY3B1c3RhdF9jcHVfZmV0Y2go
c3RydWN0IGtlcm5lbF9jcHVzdGF0ICpkc3QsIGludCBjcHUpCnsKICpkc3QgPSAoKih7IGRv
IHsgY29uc3Qgdm9pZCAqX192cHBfdmVyaWZ5ID0gKHR5cGVvZigoJihrZXJuZWxfY3B1c3Rh
dCkpICsgMCkpKCh2b2lkICopMCk7ICh2b2lkKV9fdnBwX3ZlcmlmeTsgfSB3aGlsZSAoMCk7
ICh7IHVuc2lnbmVkIGxvbmcgX19wdHI7IF9fYXNtX18gKCIiIDogIj1yIihfX3B0cikgOiAi
MCIoKHR5cGVvZigqKCgmKGtlcm5lbF9jcHVzdGF0KSkpKSAqKSgoJihrZXJuZWxfY3B1c3Rh
dCkpKSkpOyAodHlwZW9mKCh0eXBlb2YoKigoJihrZXJuZWxfY3B1c3RhdCkpKSkgKikoKCYo
a2VybmVsX2NwdXN0YXQpKSkpKSAoX19wdHIgKyAoKChfX3Blcl9jcHVfb2Zmc2V0WyhjcHUp
XSkpKSk7IH0pOyB9KSk7Cn0KCgoKZXh0ZXJuIHZvaWQgYWNjb3VudF91c2VyX3RpbWUoc3Ry
dWN0IHRhc2tfc3RydWN0ICosIHU2NCk7CmV4dGVybiB2b2lkIGFjY291bnRfZ3Vlc3RfdGlt
ZShzdHJ1Y3QgdGFza19zdHJ1Y3QgKiwgdTY0KTsKZXh0ZXJuIHZvaWQgYWNjb3VudF9zeXN0
ZW1fdGltZShzdHJ1Y3QgdGFza19zdHJ1Y3QgKiwgaW50LCB1NjQpOwpleHRlcm4gdm9pZCBh
Y2NvdW50X3N5c3RlbV9pbmRleF90aW1lKHN0cnVjdCB0YXNrX3N0cnVjdCAqLCB1NjQsCiAg
ICAgICAgICBlbnVtIGNwdV91c2FnZV9zdGF0KTsKZXh0ZXJuIHZvaWQgYWNjb3VudF9zdGVh
bF90aW1lKHU2NCk7CmV4dGVybiB2b2lkIGFjY291bnRfaWRsZV90aW1lKHU2NCk7CgoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIHZvaWQgYWNjb3VudF9wcm9jZXNzX3RpY2soc3RydWN0IHRhc2tfc3RydWN0ICp0
c2ssIGludCB1c2VyKQp7CiB2dGltZV9mbHVzaCh0c2spOwp9CgoKCgpleHRlcm4gdm9pZCBh
Y2NvdW50X2lkbGVfdGlja3ModW5zaWduZWQgbG9uZyB0aWNrcyk7CiMgMjcgIi4vaW5jbHVk
ZS9saW51eC9jZ3JvdXAuaCIgMgoKIyAxICIuL2luY2x1ZGUvbGludXgvY2dyb3VwLWRlZnMu
aCIgMQojIDIwICIuL2luY2x1ZGUvbGludXgvY2dyb3VwLWRlZnMuaCIKIyAxICIuL2luY2x1
ZGUvbGludXgvdTY0X3N0YXRzX3N5bmMuaCIgMQojIDY4ICIuL2luY2x1ZGUvbGludXgvdTY0
X3N0YXRzX3N5bmMuaCIKc3RydWN0IHU2NF9zdGF0c19zeW5jIHsKCgoKfTsKCgojIDEgIi4v
YXJjaC9wb3dlcnBjL2luY2x1ZGUvZ2VuZXJhdGVkL2FzbS9sb2NhbDY0LmgiIDEKIyA3NiAi
Li9pbmNsdWRlL2xpbnV4L3U2NF9zdGF0c19zeW5jLmgiIDIKCnR5cGVkZWYgc3RydWN0IHsK
IGxvY2FsNjRfdCB2Owp9IHU2NF9zdGF0c190IDsKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1NjQgdTY0X3N0YXRz
X3JlYWQoY29uc3QgdTY0X3N0YXRzX3QgKnApCnsKIHJldHVybiBhdG9taWNfbG9uZ19yZWFk
KCYoJigmcC0+diktPmEpLT5hKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgdTY0X3N0YXRzX2FkZCh1
NjRfc3RhdHNfdCAqcCwgdW5zaWduZWQgbG9uZyB2YWwpCnsKIGF0b21pY19sb25nX2FkZCgo
KHZhbCkpLCgmKCgmKCZwLT52KS0+YSkpLT5hKSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHU2NF9z
dGF0c19pbmModTY0X3N0YXRzX3QgKnApCnsKIGF0b21pY19sb25nX2luYygmKCYoJnAtPnYp
LT5hKS0+YSk7Cn0KIyAxMTggIi4vaW5jbHVkZS9saW51eC91NjRfc3RhdHNfc3luYy5oIgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgdm9pZCB1NjRfc3RhdHNfaW5pdChzdHJ1Y3QgdTY0X3N0YXRzX3N5bmMgKnN5
bmNwKQp7CgoKCn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHU2NF9zdGF0c191cGRhdGVfYmVnaW4oc3Ry
dWN0IHU2NF9zdGF0c19zeW5jICpzeW5jcCkKewoKCgp9CgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCB1NjRf
c3RhdHNfdXBkYXRlX2VuZChzdHJ1Y3QgdTY0X3N0YXRzX3N5bmMgKnN5bmNwKQp7CgoKCn0K
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSB1bnNpZ25lZCBsb25nCnU2NF9zdGF0c191cGRhdGVfYmVnaW5faXJxc2F2
ZShzdHJ1Y3QgdTY0X3N0YXRzX3N5bmMgKnN5bmNwKQp7CiB1bnNpZ25lZCBsb25nIGZsYWdz
ID0gMDsKCgoKCgogcmV0dXJuIGZsYWdzOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZAp1NjRfc3RhdHNf
dXBkYXRlX2VuZF9pcnFyZXN0b3JlKHN0cnVjdCB1NjRfc3RhdHNfc3luYyAqc3luY3AsCiAg
ICB1bnNpZ25lZCBsb25nIGZsYWdzKQp7CgoKCgp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgaW50
IF9fdTY0X3N0YXRzX2ZldGNoX2JlZ2luKGNvbnN0IHN0cnVjdCB1NjRfc3RhdHNfc3luYyAq
c3luY3ApCnsKCgoKIHJldHVybiAwOwoKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHVuc2lnbmVkIGludCB1NjRf
c3RhdHNfZmV0Y2hfYmVnaW4oY29uc3Qgc3RydWN0IHU2NF9zdGF0c19zeW5jICpzeW5jcCkK
ewoKCgogcmV0dXJuIF9fdTY0X3N0YXRzX2ZldGNoX2JlZ2luKHN5bmNwKTsKfQoKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIGJvb2wgX191NjRfc3RhdHNfZmV0Y2hfcmV0cnkoY29uc3Qgc3RydWN0IHU2NF9zdGF0
c19zeW5jICpzeW5jcCwKICAgICAgdW5zaWduZWQgaW50IHN0YXJ0KQp7CgoKCiByZXR1cm4g
ZmFsc2U7Cgp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCB1NjRfc3RhdHNfZmV0Y2hfcmV0cnkoY29uc3Qg
c3RydWN0IHU2NF9zdGF0c19zeW5jICpzeW5jcCwKICAgICAgdW5zaWduZWQgaW50IHN0YXJ0
KQp7CgoKCiByZXR1cm4gX191NjRfc3RhdHNfZmV0Y2hfcmV0cnkoc3luY3AsIHN0YXJ0KTsK
fQoKCgoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHVuc2lnbmVkIGludCB1NjRfc3RhdHNfZmV0Y2hfYmVnaW5f
aXJxKGNvbnN0IHN0cnVjdCB1NjRfc3RhdHNfc3luYyAqc3luY3ApCnsKCgoKIHJldHVybiBf
X3U2NF9zdGF0c19mZXRjaF9iZWdpbihzeW5jcCk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIHU2NF9z
dGF0c19mZXRjaF9yZXRyeV9pcnEoY29uc3Qgc3RydWN0IHU2NF9zdGF0c19zeW5jICpzeW5j
cCwKICAgICAgICAgIHVuc2lnbmVkIGludCBzdGFydCkKewoKCgogcmV0dXJuIF9fdTY0X3N0
YXRzX2ZldGNoX3JldHJ5KHN5bmNwLCBzdGFydCk7Cn0KIyAyMSAiLi9pbmNsdWRlL2xpbnV4
L2Nncm91cC1kZWZzLmgiIDIKCiMgMSAiLi9pbmNsdWRlL2xpbnV4L2JwZi1jZ3JvdXAuaCIg
MQoKCgoKIyAxICIuL2luY2x1ZGUvbGludXgvYnBmLmgiIDEKCgoKCgoKIyAxICIuL2luY2x1
ZGUvdWFwaS9saW51eC9icGYuaCIgMQojIDEyICIuL2luY2x1ZGUvdWFwaS9saW51eC9icGYu
aCIKIyAxICIuL2luY2x1ZGUvdWFwaS9saW51eC9icGZfY29tbW9uLmgiIDEKIyAxMyAiLi9p
bmNsdWRlL3VhcGkvbGludXgvYnBmLmgiIDIKIyA0NyAiLi9pbmNsdWRlL3VhcGkvbGludXgv
YnBmLmgiCmVudW0gewogQlBGX1JFR18wID0gMCwKIEJQRl9SRUdfMSwKIEJQRl9SRUdfMiwK
IEJQRl9SRUdfMywKIEJQRl9SRUdfNCwKIEJQRl9SRUdfNSwKIEJQRl9SRUdfNiwKIEJQRl9S
RUdfNywKIEJQRl9SRUdfOCwKIEJQRl9SRUdfOSwKIEJQRl9SRUdfMTAsCiBfX01BWF9CUEZf
UkVHLAp9OwoKCgoKc3RydWN0IGJwZl9pbnNuIHsKIF9fdTggY29kZTsKIF9fdTggZHN0X3Jl
Zzo0OwogX191OCBzcmNfcmVnOjQ7CiBfX3MxNiBvZmY7CiBfX3MzMiBpbW07Cn07CgoKc3Ry
dWN0IGJwZl9scG1fdHJpZV9rZXkgewogX191MzIgcHJlZml4bGVuOwogX191OCBkYXRhWzBd
Owp9OwoKc3RydWN0IGJwZl9jZ3JvdXBfc3RvcmFnZV9rZXkgewogX191NjQgY2dyb3VwX2lu
b2RlX2lkOwogX191MzIgYXR0YWNoX3R5cGU7Cn07CgoKZW51bSBicGZfY21kIHsKIEJQRl9N
QVBfQ1JFQVRFLAogQlBGX01BUF9MT09LVVBfRUxFTSwKIEJQRl9NQVBfVVBEQVRFX0VMRU0s
CiBCUEZfTUFQX0RFTEVURV9FTEVNLAogQlBGX01BUF9HRVRfTkVYVF9LRVksCiBCUEZfUFJP
R19MT0FELAogQlBGX09CSl9QSU4sCiBCUEZfT0JKX0dFVCwKIEJQRl9QUk9HX0FUVEFDSCwK
IEJQRl9QUk9HX0RFVEFDSCwKIEJQRl9QUk9HX1RFU1RfUlVOLAogQlBGX1BST0dfR0VUX05F
WFRfSUQsCiBCUEZfTUFQX0dFVF9ORVhUX0lELAogQlBGX1BST0dfR0VUX0ZEX0JZX0lELAog
QlBGX01BUF9HRVRfRkRfQllfSUQsCiBCUEZfT0JKX0dFVF9JTkZPX0JZX0ZELAogQlBGX1BS
T0dfUVVFUlksCiBCUEZfUkFXX1RSQUNFUE9JTlRfT1BFTiwKIEJQRl9CVEZfTE9BRCwKIEJQ
Rl9CVEZfR0VUX0ZEX0JZX0lELAogQlBGX1RBU0tfRkRfUVVFUlksCiBCUEZfTUFQX0xPT0tV
UF9BTkRfREVMRVRFX0VMRU0sCiBCUEZfTUFQX0ZSRUVaRSwKIEJQRl9CVEZfR0VUX05FWFRf
SUQsCiBCUEZfTUFQX0xPT0tVUF9CQVRDSCwKIEJQRl9NQVBfTE9PS1VQX0FORF9ERUxFVEVf
QkFUQ0gsCiBCUEZfTUFQX1VQREFURV9CQVRDSCwKIEJQRl9NQVBfREVMRVRFX0JBVENILAog
QlBGX0xJTktfQ1JFQVRFLAogQlBGX0xJTktfVVBEQVRFLAogQlBGX0xJTktfR0VUX0ZEX0JZ
X0lELAogQlBGX0xJTktfR0VUX05FWFRfSUQsCiBCUEZfRU5BQkxFX1NUQVRTLAogQlBGX0lU
RVJfQ1JFQVRFLAp9OwoKZW51bSBicGZfbWFwX3R5cGUgewogQlBGX01BUF9UWVBFX1VOU1BF
QywKIEJQRl9NQVBfVFlQRV9IQVNILAogQlBGX01BUF9UWVBFX0FSUkFZLAogQlBGX01BUF9U
WVBFX1BST0dfQVJSQVksCiBCUEZfTUFQX1RZUEVfUEVSRl9FVkVOVF9BUlJBWSwKIEJQRl9N
QVBfVFlQRV9QRVJDUFVfSEFTSCwKIEJQRl9NQVBfVFlQRV9QRVJDUFVfQVJSQVksCiBCUEZf
TUFQX1RZUEVfU1RBQ0tfVFJBQ0UsCiBCUEZfTUFQX1RZUEVfQ0dST1VQX0FSUkFZLAogQlBG
X01BUF9UWVBFX0xSVV9IQVNILAogQlBGX01BUF9UWVBFX0xSVV9QRVJDUFVfSEFTSCwKIEJQ
Rl9NQVBfVFlQRV9MUE1fVFJJRSwKIEJQRl9NQVBfVFlQRV9BUlJBWV9PRl9NQVBTLAogQlBG
X01BUF9UWVBFX0hBU0hfT0ZfTUFQUywKIEJQRl9NQVBfVFlQRV9ERVZNQVAsCiBCUEZfTUFQ
X1RZUEVfU09DS01BUCwKIEJQRl9NQVBfVFlQRV9DUFVNQVAsCiBCUEZfTUFQX1RZUEVfWFNL
TUFQLAogQlBGX01BUF9UWVBFX1NPQ0tIQVNILAogQlBGX01BUF9UWVBFX0NHUk9VUF9TVE9S
QUdFLAogQlBGX01BUF9UWVBFX1JFVVNFUE9SVF9TT0NLQVJSQVksCiBCUEZfTUFQX1RZUEVf
UEVSQ1BVX0NHUk9VUF9TVE9SQUdFLAogQlBGX01BUF9UWVBFX1FVRVVFLAogQlBGX01BUF9U
WVBFX1NUQUNLLAogQlBGX01BUF9UWVBFX1NLX1NUT1JBR0UsCiBCUEZfTUFQX1RZUEVfREVW
TUFQX0hBU0gsCiBCUEZfTUFQX1RZUEVfU1RSVUNUX09QUywKIEJQRl9NQVBfVFlQRV9SSU5H
QlVGLAp9OwojIDE2MSAiLi9pbmNsdWRlL3VhcGkvbGludXgvYnBmLmgiCmVudW0gYnBmX3By
b2dfdHlwZSB7CiBCUEZfUFJPR19UWVBFX1VOU1BFQywKIEJQRl9QUk9HX1RZUEVfU09DS0VU
X0ZJTFRFUiwKIEJQRl9QUk9HX1RZUEVfS1BST0JFLAogQlBGX1BST0dfVFlQRV9TQ0hFRF9D
TFMsCiBCUEZfUFJPR19UWVBFX1NDSEVEX0FDVCwKIEJQRl9QUk9HX1RZUEVfVFJBQ0VQT0lO
VCwKIEJQRl9QUk9HX1RZUEVfWERQLAogQlBGX1BST0dfVFlQRV9QRVJGX0VWRU5ULAogQlBG
X1BST0dfVFlQRV9DR1JPVVBfU0tCLAogQlBGX1BST0dfVFlQRV9DR1JPVVBfU09DSywKIEJQ
Rl9QUk9HX1RZUEVfTFdUX0lOLAogQlBGX1BST0dfVFlQRV9MV1RfT1VULAogQlBGX1BST0df
VFlQRV9MV1RfWE1JVCwKIEJQRl9QUk9HX1RZUEVfU09DS19PUFMsCiBCUEZfUFJPR19UWVBF
X1NLX1NLQiwKIEJQRl9QUk9HX1RZUEVfQ0dST1VQX0RFVklDRSwKIEJQRl9QUk9HX1RZUEVf
U0tfTVNHLAogQlBGX1BST0dfVFlQRV9SQVdfVFJBQ0VQT0lOVCwKIEJQRl9QUk9HX1RZUEVf
Q0dST1VQX1NPQ0tfQUREUiwKIEJQRl9QUk9HX1RZUEVfTFdUX1NFRzZMT0NBTCwKIEJQRl9Q
Uk9HX1RZUEVfTElSQ19NT0RFMiwKIEJQRl9QUk9HX1RZUEVfU0tfUkVVU0VQT1JULAogQlBG
X1BST0dfVFlQRV9GTE9XX0RJU1NFQ1RPUiwKIEJQRl9QUk9HX1RZUEVfQ0dST1VQX1NZU0NU
TCwKIEJQRl9QUk9HX1RZUEVfUkFXX1RSQUNFUE9JTlRfV1JJVEFCTEUsCiBCUEZfUFJPR19U
WVBFX0NHUk9VUF9TT0NLT1BULAogQlBGX1BST0dfVFlQRV9UUkFDSU5HLAogQlBGX1BST0df
VFlQRV9TVFJVQ1RfT1BTLAogQlBGX1BST0dfVFlQRV9FWFQsCiBCUEZfUFJPR19UWVBFX0xT
TSwKfTsKCmVudW0gYnBmX2F0dGFjaF90eXBlIHsKIEJQRl9DR1JPVVBfSU5FVF9JTkdSRVNT
LAogQlBGX0NHUk9VUF9JTkVUX0VHUkVTUywKIEJQRl9DR1JPVVBfSU5FVF9TT0NLX0NSRUFU
RSwKIEJQRl9DR1JPVVBfU09DS19PUFMsCiBCUEZfU0tfU0tCX1NUUkVBTV9QQVJTRVIsCiBC
UEZfU0tfU0tCX1NUUkVBTV9WRVJESUNULAogQlBGX0NHUk9VUF9ERVZJQ0UsCiBCUEZfU0tf
TVNHX1ZFUkRJQ1QsCiBCUEZfQ0dST1VQX0lORVQ0X0JJTkQsCiBCUEZfQ0dST1VQX0lORVQ2
X0JJTkQsCiBCUEZfQ0dST1VQX0lORVQ0X0NPTk5FQ1QsCiBCUEZfQ0dST1VQX0lORVQ2X0NP
Tk5FQ1QsCiBCUEZfQ0dST1VQX0lORVQ0X1BPU1RfQklORCwKIEJQRl9DR1JPVVBfSU5FVDZf
UE9TVF9CSU5ELAogQlBGX0NHUk9VUF9VRFA0X1NFTkRNU0csCiBCUEZfQ0dST1VQX1VEUDZf
U0VORE1TRywKIEJQRl9MSVJDX01PREUyLAogQlBGX0ZMT1dfRElTU0VDVE9SLAogQlBGX0NH
Uk9VUF9TWVNDVEwsCiBCUEZfQ0dST1VQX1VEUDRfUkVDVk1TRywKIEJQRl9DR1JPVVBfVURQ
Nl9SRUNWTVNHLAogQlBGX0NHUk9VUF9HRVRTT0NLT1BULAogQlBGX0NHUk9VUF9TRVRTT0NL
T1BULAogQlBGX1RSQUNFX1JBV19UUCwKIEJQRl9UUkFDRV9GRU5UUlksCiBCUEZfVFJBQ0Vf
RkVYSVQsCiBCUEZfTU9ESUZZX1JFVFVSTiwKIEJQRl9MU01fTUFDLAogQlBGX1RSQUNFX0lU
RVIsCiBCUEZfQ0dST1VQX0lORVQ0X0dFVFBFRVJOQU1FLAogQlBGX0NHUk9VUF9JTkVUNl9H
RVRQRUVSTkFNRSwKIEJQRl9DR1JPVVBfSU5FVDRfR0VUU09DS05BTUUsCiBCUEZfQ0dST1VQ
X0lORVQ2X0dFVFNPQ0tOQU1FLAogQlBGX1hEUF9ERVZNQVAsCiBfX01BWF9CUEZfQVRUQUNI
X1RZUEUKfTsKCgoKZW51bSBicGZfbGlua190eXBlIHsKIEJQRl9MSU5LX1RZUEVfVU5TUEVD
ID0gMCwKIEJQRl9MSU5LX1RZUEVfUkFXX1RSQUNFUE9JTlQgPSAxLAogQlBGX0xJTktfVFlQ
RV9UUkFDSU5HID0gMiwKIEJQRl9MSU5LX1RZUEVfQ0dST1VQID0gMywKIEJQRl9MSU5LX1RZ
UEVfSVRFUiA9IDQsCiBCUEZfTElOS19UWVBFX05FVE5TID0gNSwKCiBNQVhfQlBGX0xJTktf
VFlQRSwKfTsKIyAzNTUgIi4vaW5jbHVkZS91YXBpL2xpbnV4L2JwZi5oIgplbnVtIHsKIEJQ
Rl9BTlkgPSAwLAogQlBGX05PRVhJU1QgPSAxLAogQlBGX0VYSVNUID0gMiwKIEJQRl9GX0xP
Q0sgPSA0LAp9OwoKCmVudW0gewogQlBGX0ZfTk9fUFJFQUxMT0MgPSAoMVUgPDwgMCksCgoK
CgoKCiBCUEZfRl9OT19DT01NT05fTFJVID0gKDFVIDw8IDEpLAoKIEJQRl9GX05VTUFfTk9E
RSA9ICgxVSA8PCAyKSwKCgogQlBGX0ZfUkRPTkxZID0gKDFVIDw8IDMpLAogQlBGX0ZfV1JP
TkxZID0gKDFVIDw8IDQpLAoKCiBCUEZfRl9TVEFDS19CVUlMRF9JRCA9ICgxVSA8PCA1KSwK
CgogQlBGX0ZfWkVST19TRUVEID0gKDFVIDw8IDYpLAoKCiBCUEZfRl9SRE9OTFlfUFJPRyA9
ICgxVSA8PCA3KSwKIEJQRl9GX1dST05MWV9QUk9HID0gKDFVIDw8IDgpLAoKCiBCUEZfRl9D
TE9ORSA9ICgxVSA8PCA5KSwKCgogQlBGX0ZfTU1BUEFCTEUgPSAoMVUgPDwgMTApLAp9Owoj
IDQwNSAiLi9pbmNsdWRlL3VhcGkvbGludXgvYnBmLmgiCmVudW0gYnBmX3N0YXRzX3R5cGUg
ewoKIEJQRl9TVEFUU19SVU5fVElNRSA9IDAsCn07CgplbnVtIGJwZl9zdGFja19idWlsZF9p
ZF9zdGF0dXMgewoKIEJQRl9TVEFDS19CVUlMRF9JRF9FTVBUWSA9IDAsCgogQlBGX1NUQUNL
X0JVSUxEX0lEX1ZBTElEID0gMSwKCiBCUEZfU1RBQ0tfQlVJTERfSURfSVAgPSAyLAp9OwoK
CnN0cnVjdCBicGZfc3RhY2tfYnVpbGRfaWQgewogX19zMzIgc3RhdHVzOwogdW5zaWduZWQg
Y2hhciBidWlsZF9pZFsyMF07CiB1bmlvbiB7CiAgX191NjQgb2Zmc2V0OwogIF9fdTY0IGlw
OwogfTsKfTsKCgoKdW5pb24gYnBmX2F0dHIgewogc3RydWN0IHsKICBfX3UzMiBtYXBfdHlw
ZTsKICBfX3UzMiBrZXlfc2l6ZTsKICBfX3UzMiB2YWx1ZV9zaXplOwogIF9fdTMyIG1heF9l
bnRyaWVzOwogIF9fdTMyIG1hcF9mbGFnczsKCgogIF9fdTMyIGlubmVyX21hcF9mZDsKICBf
X3UzMiBudW1hX25vZGU7CgoKICBjaGFyIG1hcF9uYW1lWzE2VV07CiAgX191MzIgbWFwX2lm
aW5kZXg7CiAgX191MzIgYnRmX2ZkOwogIF9fdTMyIGJ0Zl9rZXlfdHlwZV9pZDsKICBfX3Uz
MiBidGZfdmFsdWVfdHlwZV9pZDsKICBfX3UzMiBidGZfdm1saW51eF92YWx1ZV90eXBlX2lk
OwoKCgogfTsKCiBzdHJ1Y3QgewogIF9fdTMyIG1hcF9mZDsKICBfX3U2NCBfX2F0dHJpYnV0
ZV9fKChhbGlnbmVkKDgpKSkga2V5OwogIHVuaW9uIHsKICAgX191NjQgX19hdHRyaWJ1dGVf
XygoYWxpZ25lZCg4KSkpIHZhbHVlOwogICBfX3U2NCBfX2F0dHJpYnV0ZV9fKChhbGlnbmVk
KDgpKSkgbmV4dF9rZXk7CiAgfTsKICBfX3U2NCBmbGFnczsKIH07Cgogc3RydWN0IHsKICBf
X3U2NCBfX2F0dHJpYnV0ZV9fKChhbGlnbmVkKDgpKSkgaW5fYmF0Y2g7CgoKICBfX3U2NCBf
X2F0dHJpYnV0ZV9fKChhbGlnbmVkKDgpKSkgb3V0X2JhdGNoOwogIF9fdTY0IF9fYXR0cmli
dXRlX18oKGFsaWduZWQoOCkpKSBrZXlzOwogIF9fdTY0IF9fYXR0cmlidXRlX18oKGFsaWdu
ZWQoOCkpKSB2YWx1ZXM7CiAgX191MzIgY291bnQ7CgoKCgogIF9fdTMyIG1hcF9mZDsKICBf
X3U2NCBlbGVtX2ZsYWdzOwogIF9fdTY0IGZsYWdzOwogfSBiYXRjaDsKCiBzdHJ1Y3Qgewog
IF9fdTMyIHByb2dfdHlwZTsKICBfX3UzMiBpbnNuX2NudDsKICBfX3U2NCBfX2F0dHJpYnV0
ZV9fKChhbGlnbmVkKDgpKSkgaW5zbnM7CiAgX191NjQgX19hdHRyaWJ1dGVfXygoYWxpZ25l
ZCg4KSkpIGxpY2Vuc2U7CiAgX191MzIgbG9nX2xldmVsOwogIF9fdTMyIGxvZ19zaXplOwog
IF9fdTY0IF9fYXR0cmlidXRlX18oKGFsaWduZWQoOCkpKSBsb2dfYnVmOwogIF9fdTMyIGtl
cm5fdmVyc2lvbjsKICBfX3UzMiBwcm9nX2ZsYWdzOwogIGNoYXIgcHJvZ19uYW1lWzE2VV07
CiAgX191MzIgcHJvZ19pZmluZGV4OwoKCgoKICBfX3UzMiBleHBlY3RlZF9hdHRhY2hfdHlw
ZTsKICBfX3UzMiBwcm9nX2J0Zl9mZDsKICBfX3UzMiBmdW5jX2luZm9fcmVjX3NpemU7CiAg
X191NjQgX19hdHRyaWJ1dGVfXygoYWxpZ25lZCg4KSkpIGZ1bmNfaW5mbzsKICBfX3UzMiBm
dW5jX2luZm9fY250OwogIF9fdTMyIGxpbmVfaW5mb19yZWNfc2l6ZTsKICBfX3U2NCBfX2F0
dHJpYnV0ZV9fKChhbGlnbmVkKDgpKSkgbGluZV9pbmZvOwogIF9fdTMyIGxpbmVfaW5mb19j
bnQ7CiAgX191MzIgYXR0YWNoX2J0Zl9pZDsKICBfX3UzMiBhdHRhY2hfcHJvZ19mZDsKIH07
Cgogc3RydWN0IHsKICBfX3U2NCBfX2F0dHJpYnV0ZV9fKChhbGlnbmVkKDgpKSkgcGF0aG5h
bWU7CiAgX191MzIgYnBmX2ZkOwogIF9fdTMyIGZpbGVfZmxhZ3M7CiB9OwoKIHN0cnVjdCB7
CiAgX191MzIgdGFyZ2V0X2ZkOwogIF9fdTMyIGF0dGFjaF9icGZfZmQ7CiAgX191MzIgYXR0
YWNoX3R5cGU7CiAgX191MzIgYXR0YWNoX2ZsYWdzOwogIF9fdTMyIHJlcGxhY2VfYnBmX2Zk
OwoKCgogfTsKCiBzdHJ1Y3QgewogIF9fdTMyIHByb2dfZmQ7CiAgX191MzIgcmV0dmFsOwog
IF9fdTMyIGRhdGFfc2l6ZV9pbjsKICBfX3UzMiBkYXRhX3NpemVfb3V0OwoKCgogIF9fdTY0
IF9fYXR0cmlidXRlX18oKGFsaWduZWQoOCkpKSBkYXRhX2luOwogIF9fdTY0IF9fYXR0cmli
dXRlX18oKGFsaWduZWQoOCkpKSBkYXRhX291dDsKICBfX3UzMiByZXBlYXQ7CiAgX191MzIg
ZHVyYXRpb247CiAgX191MzIgY3R4X3NpemVfaW47CiAgX191MzIgY3R4X3NpemVfb3V0OwoK
CgogIF9fdTY0IF9fYXR0cmlidXRlX18oKGFsaWduZWQoOCkpKSBjdHhfaW47CiAgX191NjQg
X19hdHRyaWJ1dGVfXygoYWxpZ25lZCg4KSkpIGN0eF9vdXQ7CiB9IHRlc3Q7Cgogc3RydWN0
IHsKICB1bmlvbiB7CiAgIF9fdTMyIHN0YXJ0X2lkOwogICBfX3UzMiBwcm9nX2lkOwogICBf
X3UzMiBtYXBfaWQ7CiAgIF9fdTMyIGJ0Zl9pZDsKICAgX191MzIgbGlua19pZDsKICB9Owog
IF9fdTMyIG5leHRfaWQ7CiAgX191MzIgb3Blbl9mbGFnczsKIH07Cgogc3RydWN0IHsKICBf
X3UzMiBicGZfZmQ7CiAgX191MzIgaW5mb19sZW47CiAgX191NjQgX19hdHRyaWJ1dGVfXygo
YWxpZ25lZCg4KSkpIGluZm87CiB9IGluZm87Cgogc3RydWN0IHsKICBfX3UzMiB0YXJnZXRf
ZmQ7CiAgX191MzIgYXR0YWNoX3R5cGU7CiAgX191MzIgcXVlcnlfZmxhZ3M7CiAgX191MzIg
YXR0YWNoX2ZsYWdzOwogIF9fdTY0IF9fYXR0cmlidXRlX18oKGFsaWduZWQoOCkpKSBwcm9n
X2lkczsKICBfX3UzMiBwcm9nX2NudDsKIH0gcXVlcnk7Cgogc3RydWN0IHsKICBfX3U2NCBu
YW1lOwogIF9fdTMyIHByb2dfZmQ7CiB9IHJhd190cmFjZXBvaW50OwoKIHN0cnVjdCB7CiAg
X191NjQgX19hdHRyaWJ1dGVfXygoYWxpZ25lZCg4KSkpIGJ0ZjsKICBfX3U2NCBfX2F0dHJp
YnV0ZV9fKChhbGlnbmVkKDgpKSkgYnRmX2xvZ19idWY7CiAgX191MzIgYnRmX3NpemU7CiAg
X191MzIgYnRmX2xvZ19zaXplOwogIF9fdTMyIGJ0Zl9sb2dfbGV2ZWw7CiB9OwoKIHN0cnVj
dCB7CiAgX191MzIgcGlkOwogIF9fdTMyIGZkOwogIF9fdTMyIGZsYWdzOwogIF9fdTMyIGJ1
Zl9sZW47CiAgX191NjQgX19hdHRyaWJ1dGVfXygoYWxpZ25lZCg4KSkpIGJ1ZjsKCgoKCiAg
X191MzIgcHJvZ19pZDsKICBfX3UzMiBmZF90eXBlOwogIF9fdTY0IHByb2JlX29mZnNldDsK
ICBfX3U2NCBwcm9iZV9hZGRyOwogfSB0YXNrX2ZkX3F1ZXJ5OwoKIHN0cnVjdCB7CiAgX191
MzIgcHJvZ19mZDsKICBfX3UzMiB0YXJnZXRfZmQ7CiAgX191MzIgYXR0YWNoX3R5cGU7CiAg
X191MzIgZmxhZ3M7CiB9IGxpbmtfY3JlYXRlOwoKIHN0cnVjdCB7CiAgX191MzIgbGlua19m
ZDsKCiAgX191MzIgbmV3X3Byb2dfZmQ7CiAgX191MzIgZmxhZ3M7CgoKICBfX3UzMiBvbGRf
cHJvZ19mZDsKIH0gbGlua191cGRhdGU7Cgogc3RydWN0IHsKICBfX3UzMiB0eXBlOwogfSBl
bmFibGVfc3RhdHM7Cgogc3RydWN0IHsKICBfX3UzMiBsaW5rX2ZkOwogIF9fdTMyIGZsYWdz
OwogfSBpdGVyX2NyZWF0ZTsKCn0gX19hdHRyaWJ1dGVfXygoYWxpZ25lZCg4KSkpOwojIDMz
OTggIi4vaW5jbHVkZS91YXBpL2xpbnV4L2JwZi5oIgplbnVtIGJwZl9mdW5jX2lkIHsKIEJQ
Rl9GVU5DX3Vuc3BlYywgQlBGX0ZVTkNfbWFwX2xvb2t1cF9lbGVtLCBCUEZfRlVOQ19tYXBf
dXBkYXRlX2VsZW0sIEJQRl9GVU5DX21hcF9kZWxldGVfZWxlbSwgQlBGX0ZVTkNfcHJvYmVf
cmVhZCwgQlBGX0ZVTkNfa3RpbWVfZ2V0X25zLCBCUEZfRlVOQ190cmFjZV9wcmludGssIEJQ
Rl9GVU5DX2dldF9wcmFuZG9tX3UzMiwgQlBGX0ZVTkNfZ2V0X3NtcF9wcm9jZXNzb3JfaWQs
IEJQRl9GVU5DX3NrYl9zdG9yZV9ieXRlcywgQlBGX0ZVTkNfbDNfY3N1bV9yZXBsYWNlLCBC
UEZfRlVOQ19sNF9jc3VtX3JlcGxhY2UsIEJQRl9GVU5DX3RhaWxfY2FsbCwgQlBGX0ZVTkNf
Y2xvbmVfcmVkaXJlY3QsIEJQRl9GVU5DX2dldF9jdXJyZW50X3BpZF90Z2lkLCBCUEZfRlVO
Q19nZXRfY3VycmVudF91aWRfZ2lkLCBCUEZfRlVOQ19nZXRfY3VycmVudF9jb21tLCBCUEZf
RlVOQ19nZXRfY2dyb3VwX2NsYXNzaWQsIEJQRl9GVU5DX3NrYl92bGFuX3B1c2gsIEJQRl9G
VU5DX3NrYl92bGFuX3BvcCwgQlBGX0ZVTkNfc2tiX2dldF90dW5uZWxfa2V5LCBCUEZfRlVO
Q19za2Jfc2V0X3R1bm5lbF9rZXksIEJQRl9GVU5DX3BlcmZfZXZlbnRfcmVhZCwgQlBGX0ZV
TkNfcmVkaXJlY3QsIEJQRl9GVU5DX2dldF9yb3V0ZV9yZWFsbSwgQlBGX0ZVTkNfcGVyZl9l
dmVudF9vdXRwdXQsIEJQRl9GVU5DX3NrYl9sb2FkX2J5dGVzLCBCUEZfRlVOQ19nZXRfc3Rh
Y2tpZCwgQlBGX0ZVTkNfY3N1bV9kaWZmLCBCUEZfRlVOQ19za2JfZ2V0X3R1bm5lbF9vcHQs
IEJQRl9GVU5DX3NrYl9zZXRfdHVubmVsX29wdCwgQlBGX0ZVTkNfc2tiX2NoYW5nZV9wcm90
bywgQlBGX0ZVTkNfc2tiX2NoYW5nZV90eXBlLCBCUEZfRlVOQ19za2JfdW5kZXJfY2dyb3Vw
LCBCUEZfRlVOQ19nZXRfaGFzaF9yZWNhbGMsIEJQRl9GVU5DX2dldF9jdXJyZW50X3Rhc2ss
IEJQRl9GVU5DX3Byb2JlX3dyaXRlX3VzZXIsIEJQRl9GVU5DX2N1cnJlbnRfdGFza191bmRl
cl9jZ3JvdXAsIEJQRl9GVU5DX3NrYl9jaGFuZ2VfdGFpbCwgQlBGX0ZVTkNfc2tiX3B1bGxf
ZGF0YSwgQlBGX0ZVTkNfY3N1bV91cGRhdGUsIEJQRl9GVU5DX3NldF9oYXNoX2ludmFsaWQs
IEJQRl9GVU5DX2dldF9udW1hX25vZGVfaWQsIEJQRl9GVU5DX3NrYl9jaGFuZ2VfaGVhZCwg
QlBGX0ZVTkNfeGRwX2FkanVzdF9oZWFkLCBCUEZfRlVOQ19wcm9iZV9yZWFkX3N0ciwgQlBG
X0ZVTkNfZ2V0X3NvY2tldF9jb29raWUsIEJQRl9GVU5DX2dldF9zb2NrZXRfdWlkLCBCUEZf
RlVOQ19zZXRfaGFzaCwgQlBGX0ZVTkNfc2V0c29ja29wdCwgQlBGX0ZVTkNfc2tiX2FkanVz
dF9yb29tLCBCUEZfRlVOQ19yZWRpcmVjdF9tYXAsIEJQRl9GVU5DX3NrX3JlZGlyZWN0X21h
cCwgQlBGX0ZVTkNfc29ja19tYXBfdXBkYXRlLCBCUEZfRlVOQ194ZHBfYWRqdXN0X21ldGEs
IEJQRl9GVU5DX3BlcmZfZXZlbnRfcmVhZF92YWx1ZSwgQlBGX0ZVTkNfcGVyZl9wcm9nX3Jl
YWRfdmFsdWUsIEJQRl9GVU5DX2dldHNvY2tvcHQsIEJQRl9GVU5DX292ZXJyaWRlX3JldHVy
biwgQlBGX0ZVTkNfc29ja19vcHNfY2JfZmxhZ3Nfc2V0LCBCUEZfRlVOQ19tc2dfcmVkaXJl
Y3RfbWFwLCBCUEZfRlVOQ19tc2dfYXBwbHlfYnl0ZXMsIEJQRl9GVU5DX21zZ19jb3JrX2J5
dGVzLCBCUEZfRlVOQ19tc2dfcHVsbF9kYXRhLCBCUEZfRlVOQ19iaW5kLCBCUEZfRlVOQ194
ZHBfYWRqdXN0X3RhaWwsIEJQRl9GVU5DX3NrYl9nZXRfeGZybV9zdGF0ZSwgQlBGX0ZVTkNf
Z2V0X3N0YWNrLCBCUEZfRlVOQ19za2JfbG9hZF9ieXRlc19yZWxhdGl2ZSwgQlBGX0ZVTkNf
ZmliX2xvb2t1cCwgQlBGX0ZVTkNfc29ja19oYXNoX3VwZGF0ZSwgQlBGX0ZVTkNfbXNnX3Jl
ZGlyZWN0X2hhc2gsIEJQRl9GVU5DX3NrX3JlZGlyZWN0X2hhc2gsIEJQRl9GVU5DX2x3dF9w
dXNoX2VuY2FwLCBCUEZfRlVOQ19sd3Rfc2VnNl9zdG9yZV9ieXRlcywgQlBGX0ZVTkNfbHd0
X3NlZzZfYWRqdXN0X3NyaCwgQlBGX0ZVTkNfbHd0X3NlZzZfYWN0aW9uLCBCUEZfRlVOQ19y
Y19yZXBlYXQsIEJQRl9GVU5DX3JjX2tleWRvd24sIEJQRl9GVU5DX3NrYl9jZ3JvdXBfaWQs
IEJQRl9GVU5DX2dldF9jdXJyZW50X2Nncm91cF9pZCwgQlBGX0ZVTkNfZ2V0X2xvY2FsX3N0
b3JhZ2UsIEJQRl9GVU5DX3NrX3NlbGVjdF9yZXVzZXBvcnQsIEJQRl9GVU5DX3NrYl9hbmNl
c3Rvcl9jZ3JvdXBfaWQsIEJQRl9GVU5DX3NrX2xvb2t1cF90Y3AsIEJQRl9GVU5DX3NrX2xv
b2t1cF91ZHAsIEJQRl9GVU5DX3NrX3JlbGVhc2UsIEJQRl9GVU5DX21hcF9wdXNoX2VsZW0s
IEJQRl9GVU5DX21hcF9wb3BfZWxlbSwgQlBGX0ZVTkNfbWFwX3BlZWtfZWxlbSwgQlBGX0ZV
TkNfbXNnX3B1c2hfZGF0YSwgQlBGX0ZVTkNfbXNnX3BvcF9kYXRhLCBCUEZfRlVOQ19yY19w
b2ludGVyX3JlbCwgQlBGX0ZVTkNfc3Bpbl9sb2NrLCBCUEZfRlVOQ19zcGluX3VubG9jaywg
QlBGX0ZVTkNfc2tfZnVsbHNvY2ssIEJQRl9GVU5DX3RjcF9zb2NrLCBCUEZfRlVOQ19za2Jf
ZWNuX3NldF9jZSwgQlBGX0ZVTkNfZ2V0X2xpc3RlbmVyX3NvY2ssIEJQRl9GVU5DX3NrY19s
b29rdXBfdGNwLCBCUEZfRlVOQ190Y3BfY2hlY2tfc3luY29va2llLCBCUEZfRlVOQ19zeXNj
dGxfZ2V0X25hbWUsIEJQRl9GVU5DX3N5c2N0bF9nZXRfY3VycmVudF92YWx1ZSwgQlBGX0ZV
TkNfc3lzY3RsX2dldF9uZXdfdmFsdWUsIEJQRl9GVU5DX3N5c2N0bF9zZXRfbmV3X3ZhbHVl
LCBCUEZfRlVOQ19zdHJ0b2wsIEJQRl9GVU5DX3N0cnRvdWwsIEJQRl9GVU5DX3NrX3N0b3Jh
Z2VfZ2V0LCBCUEZfRlVOQ19za19zdG9yYWdlX2RlbGV0ZSwgQlBGX0ZVTkNfc2VuZF9zaWdu
YWwsIEJQRl9GVU5DX3RjcF9nZW5fc3luY29va2llLCBCUEZfRlVOQ19za2Jfb3V0cHV0LCBC
UEZfRlVOQ19wcm9iZV9yZWFkX3VzZXIsIEJQRl9GVU5DX3Byb2JlX3JlYWRfa2VybmVsLCBC
UEZfRlVOQ19wcm9iZV9yZWFkX3VzZXJfc3RyLCBCUEZfRlVOQ19wcm9iZV9yZWFkX2tlcm5l
bF9zdHIsIEJQRl9GVU5DX3RjcF9zZW5kX2FjaywgQlBGX0ZVTkNfc2VuZF9zaWduYWxfdGhy
ZWFkLCBCUEZfRlVOQ19qaWZmaWVzNjQsIEJQRl9GVU5DX3JlYWRfYnJhbmNoX3JlY29yZHMs
IEJQRl9GVU5DX2dldF9uc19jdXJyZW50X3BpZF90Z2lkLCBCUEZfRlVOQ194ZHBfb3V0cHV0
LCBCUEZfRlVOQ19nZXRfbmV0bnNfY29va2llLCBCUEZfRlVOQ19nZXRfY3VycmVudF9hbmNl
c3Rvcl9jZ3JvdXBfaWQsIEJQRl9GVU5DX3NrX2Fzc2lnbiwgQlBGX0ZVTkNfa3RpbWVfZ2V0
X2Jvb3RfbnMsIEJQRl9GVU5DX3NlcV9wcmludGYsIEJQRl9GVU5DX3NlcV93cml0ZSwgQlBG
X0ZVTkNfc2tfY2dyb3VwX2lkLCBCUEZfRlVOQ19za19hbmNlc3Rvcl9jZ3JvdXBfaWQsIEJQ
Rl9GVU5DX3JpbmdidWZfb3V0cHV0LCBCUEZfRlVOQ19yaW5nYnVmX3Jlc2VydmUsIEJQRl9G
VU5DX3JpbmdidWZfc3VibWl0LCBCUEZfRlVOQ19yaW5nYnVmX2Rpc2NhcmQsIEJQRl9GVU5D
X3JpbmdidWZfcXVlcnksIEJQRl9GVU5DX2NzdW1fbGV2ZWwsCiBfX0JQRl9GVU5DX01BWF9J
RCwKfTsKCgoKCgplbnVtIHsKIEJQRl9GX1JFQ09NUFVURV9DU1VNID0gKDFVTEwgPDwgMCks
CiBCUEZfRl9JTlZBTElEQVRFX0hBU0ggPSAoMVVMTCA8PCAxKSwKfTsKCgoKCmVudW0gewog
QlBGX0ZfSERSX0ZJRUxEX01BU0sgPSAweGZVTEwsCn07CgoKZW51bSB7CiBCUEZfRl9QU0VV
RE9fSERSID0gKDFVTEwgPDwgNCksCiBCUEZfRl9NQVJLX01BTkdMRURfMCA9ICgxVUxMIDw8
IDUpLAogQlBGX0ZfTUFSS19FTkZPUkNFID0gKDFVTEwgPDwgNiksCn07CgoKZW51bSB7CiBC
UEZfRl9JTkdSRVNTID0gKDFVTEwgPDwgMCksCn07CgoKZW51bSB7CiBCUEZfRl9UVU5JTkZP
X0lQVjYgPSAoMVVMTCA8PCAwKSwKfTsKCgplbnVtIHsKIEJQRl9GX1NLSVBfRklFTERfTUFT
SyA9IDB4ZmZVTEwsCiBCUEZfRl9VU0VSX1NUQUNLID0gKDFVTEwgPDwgOCksCgogQlBGX0Zf
RkFTVF9TVEFDS19DTVAgPSAoMVVMTCA8PCA5KSwKIEJQRl9GX1JFVVNFX1NUQUNLSUQgPSAo
MVVMTCA8PCAxMCksCgogQlBGX0ZfVVNFUl9CVUlMRF9JRCA9ICgxVUxMIDw8IDExKSwKfTsK
CgplbnVtIHsKIEJQRl9GX1pFUk9fQ1NVTV9UWCA9ICgxVUxMIDw8IDEpLAogQlBGX0ZfRE9O
VF9GUkFHTUVOVCA9ICgxVUxMIDw8IDIpLAogQlBGX0ZfU0VRX05VTUJFUiA9ICgxVUxMIDw8
IDMpLAp9OwoKCgoKZW51bSB7CiBCUEZfRl9JTkRFWF9NQVNLID0gMHhmZmZmZmZmZlVMTCwK
IEJQRl9GX0NVUlJFTlRfQ1BVID0gQlBGX0ZfSU5ERVhfTUFTSywKCiBCUEZfRl9DVFhMRU5f
TUFTSyA9ICgweGZmZmZmVUxMIDw8IDMyKSwKfTsKCgplbnVtIHsKIEJQRl9GX0NVUlJFTlRf
TkVUTlMgPSAoLTFMKSwKfTsKCgplbnVtIHsKIEJQRl9DU1VNX0xFVkVMX1FVRVJZLAogQlBG
X0NTVU1fTEVWRUxfSU5DLAogQlBGX0NTVU1fTEVWRUxfREVDLAogQlBGX0NTVU1fTEVWRUxf
UkVTRVQsCn07CgoKZW51bSB7CiBCUEZfRl9BREpfUk9PTV9GSVhFRF9HU08gPSAoMVVMTCA8
PCAwKSwKIEJQRl9GX0FESl9ST09NX0VOQ0FQX0wzX0lQVjQgPSAoMVVMTCA8PCAxKSwKIEJQ
Rl9GX0FESl9ST09NX0VOQ0FQX0wzX0lQVjYgPSAoMVVMTCA8PCAyKSwKIEJQRl9GX0FESl9S
T09NX0VOQ0FQX0w0X0dSRSA9ICgxVUxMIDw8IDMpLAogQlBGX0ZfQURKX1JPT01fRU5DQVBf
TDRfVURQID0gKDFVTEwgPDwgNCksCiBCUEZfRl9BREpfUk9PTV9OT19DU1VNX1JFU0VUID0g
KDFVTEwgPDwgNSksCn07CgplbnVtIHsKIEJQRl9BREpfUk9PTV9FTkNBUF9MMl9NQVNLID0g
MHhmZiwKIEJQRl9BREpfUk9PTV9FTkNBUF9MMl9TSElGVCA9IDU2LAp9OwoKCgoKCgplbnVt
IHsKIEJQRl9GX1NZU0NUTF9CQVNFX05BTUUgPSAoMVVMTCA8PCAwKSwKfTsKCgplbnVtIHsK
IEJQRl9TS19TVE9SQUdFX0dFVF9GX0NSRUFURSA9ICgxVUxMIDw8IDApLAp9OwoKCmVudW0g
ewogQlBGX0ZfR0VUX0JSQU5DSF9SRUNPUkRTX1NJWkUgPSAoMVVMTCA8PCAwKSwKfTsKCgoK
CmVudW0gewogQlBGX1JCX05PX1dBS0VVUCA9ICgxVUxMIDw8IDApLAogQlBGX1JCX0ZPUkNF
X1dBS0VVUCA9ICgxVUxMIDw8IDEpLAp9OwoKCmVudW0gewogQlBGX1JCX0FWQUlMX0RBVEEg
PSAwLAogQlBGX1JCX1JJTkdfU0laRSA9IDEsCiBCUEZfUkJfQ09OU19QT1MgPSAyLAogQlBG
X1JCX1BST0RfUE9TID0gMywKfTsKCgplbnVtIHsKIEJQRl9SSU5HQlVGX0JVU1lfQklUID0g
KDFVIDw8IDMxKSwKIEJQRl9SSU5HQlVGX0RJU0NBUkRfQklUID0gKDFVIDw8IDMwKSwKIEJQ
Rl9SSU5HQlVGX0hEUl9TWiA9IDgsCn07CgoKZW51bSBicGZfYWRqX3Jvb21fbW9kZSB7CiBC
UEZfQURKX1JPT01fTkVULAogQlBGX0FESl9ST09NX01BQywKfTsKCgplbnVtIGJwZl9oZHJf
c3RhcnRfb2ZmIHsKIEJQRl9IRFJfU1RBUlRfTUFDLAogQlBGX0hEUl9TVEFSVF9ORVQsCn07
CgoKZW51bSBicGZfbHd0X2VuY2FwX21vZGUgewogQlBGX0xXVF9FTkNBUF9TRUc2LAogQlBG
X0xXVF9FTkNBUF9TRUc2X0lOTElORSwKIEJQRl9MV1RfRU5DQVBfSVAsCn07CiMgMzU2MiAi
Li9pbmNsdWRlL3VhcGkvbGludXgvYnBmLmgiCnN0cnVjdCBfX3NrX2J1ZmYgewogX191MzIg
bGVuOwogX191MzIgcGt0X3R5cGU7CiBfX3UzMiBtYXJrOwogX191MzIgcXVldWVfbWFwcGlu
ZzsKIF9fdTMyIHByb3RvY29sOwogX191MzIgdmxhbl9wcmVzZW50OwogX191MzIgdmxhbl90
Y2k7CiBfX3UzMiB2bGFuX3Byb3RvOwogX191MzIgcHJpb3JpdHk7CiBfX3UzMiBpbmdyZXNz
X2lmaW5kZXg7CiBfX3UzMiBpZmluZGV4OwogX191MzIgdGNfaW5kZXg7CiBfX3UzMiBjYls1
XTsKIF9fdTMyIGhhc2g7CiBfX3UzMiB0Y19jbGFzc2lkOwogX191MzIgZGF0YTsKIF9fdTMy
IGRhdGFfZW5kOwogX191MzIgbmFwaV9pZDsKCgogX191MzIgZmFtaWx5OwogX191MzIgcmVt
b3RlX2lwNDsKIF9fdTMyIGxvY2FsX2lwNDsKIF9fdTMyIHJlbW90ZV9pcDZbNF07CiBfX3Uz
MiBsb2NhbF9pcDZbNF07CiBfX3UzMiByZW1vdGVfcG9ydDsKIF9fdTMyIGxvY2FsX3BvcnQ7
CgoKIF9fdTMyIGRhdGFfbWV0YTsKIHVuaW9uIHsgc3RydWN0IGJwZl9mbG93X2tleXMgKiBm
bG93X2tleXM7IF9fdTY0IDo2NDsgfSBfX2F0dHJpYnV0ZV9fKChhbGlnbmVkKDgpKSk7CiBf
X3U2NCB0c3RhbXA7CiBfX3UzMiB3aXJlX2xlbjsKIF9fdTMyIGdzb19zZWdzOwogdW5pb24g
eyBzdHJ1Y3QgYnBmX3NvY2sgKiBzazsgX191NjQgOjY0OyB9IF9fYXR0cmlidXRlX18oKGFs
aWduZWQoOCkpKTsKIF9fdTMyIGdzb19zaXplOwp9OwoKc3RydWN0IGJwZl90dW5uZWxfa2V5
IHsKIF9fdTMyIHR1bm5lbF9pZDsKIHVuaW9uIHsKICBfX3UzMiByZW1vdGVfaXB2NDsKICBf
X3UzMiByZW1vdGVfaXB2Nls0XTsKIH07CiBfX3U4IHR1bm5lbF90b3M7CiBfX3U4IHR1bm5l
bF90dGw7CiBfX3UxNiB0dW5uZWxfZXh0OwogX191MzIgdHVubmVsX2xhYmVsOwp9OwoKCgoK
c3RydWN0IGJwZl94ZnJtX3N0YXRlIHsKIF9fdTMyIHJlcWlkOwogX191MzIgc3BpOwogX191
MTYgZmFtaWx5OwogX191MTYgZXh0OwogdW5pb24gewogIF9fdTMyIHJlbW90ZV9pcHY0Owog
IF9fdTMyIHJlbW90ZV9pcHY2WzRdOwogfTsKfTsKIyAzNjM0ICIuL2luY2x1ZGUvdWFwaS9s
aW51eC9icGYuaCIKZW51bSBicGZfcmV0X2NvZGUgewogQlBGX09LID0gMCwKCiBCUEZfRFJP
UCA9IDIsCgogQlBGX1JFRElSRUNUID0gNywKIyAzNjQ4ICIuL2luY2x1ZGUvdWFwaS9saW51
eC9icGYuaCIKIEJQRl9MV1RfUkVST1VURSA9IDEyOCwKfTsKCnN0cnVjdCBicGZfc29jayB7
CiBfX3UzMiBib3VuZF9kZXZfaWY7CiBfX3UzMiBmYW1pbHk7CiBfX3UzMiB0eXBlOwogX191
MzIgcHJvdG9jb2w7CiBfX3UzMiBtYXJrOwogX191MzIgcHJpb3JpdHk7CgogX191MzIgc3Jj
X2lwNDsKIF9fdTMyIHNyY19pcDZbNF07CiBfX3UzMiBzcmNfcG9ydDsKIF9fdTMyIGRzdF9w
b3J0OwogX191MzIgZHN0X2lwNDsKIF9fdTMyIGRzdF9pcDZbNF07CiBfX3UzMiBzdGF0ZTsK
IF9fczMyIHJ4X3F1ZXVlX21hcHBpbmc7Cn07CgpzdHJ1Y3QgYnBmX3RjcF9zb2NrIHsKIF9f
dTMyIHNuZF9jd25kOwogX191MzIgc3J0dF91czsKIF9fdTMyIHJ0dF9taW47CiBfX3UzMiBz
bmRfc3N0aHJlc2g7CiBfX3UzMiByY3Zfbnh0OwogX191MzIgc25kX254dDsKIF9fdTMyIHNu
ZF91bmE7CiBfX3UzMiBtc3NfY2FjaGU7CiBfX3UzMiBlY25fZmxhZ3M7CiBfX3UzMiByYXRl
X2RlbGl2ZXJlZDsKIF9fdTMyIHJhdGVfaW50ZXJ2YWxfdXM7CiBfX3UzMiBwYWNrZXRzX291
dDsKIF9fdTMyIHJldHJhbnNfb3V0OwogX191MzIgdG90YWxfcmV0cmFuczsKIF9fdTMyIHNl
Z3NfaW47CgoKIF9fdTMyIGRhdGFfc2Vnc19pbjsKCgogX191MzIgc2Vnc19vdXQ7CgoKIF9f
dTMyIGRhdGFfc2Vnc19vdXQ7CgoKIF9fdTMyIGxvc3Rfb3V0OwogX191MzIgc2Fja2VkX291
dDsKIF9fdTY0IGJ5dGVzX3JlY2VpdmVkOwoKCgogX191NjQgYnl0ZXNfYWNrZWQ7CgoKCiBf
X3UzMiBkc2Fja19kdXBzOwoKCiBfX3UzMiBkZWxpdmVyZWQ7CiBfX3UzMiBkZWxpdmVyZWRf
Y2U7CiBfX3UzMiBpY3NrX3JldHJhbnNtaXRzOwp9OwoKc3RydWN0IGJwZl9zb2NrX3R1cGxl
IHsKIHVuaW9uIHsKICBzdHJ1Y3QgewogICBfX2JlMzIgc2FkZHI7CiAgIF9fYmUzMiBkYWRk
cjsKICAgX19iZTE2IHNwb3J0OwogICBfX2JlMTYgZHBvcnQ7CiAgfSBpcHY0OwogIHN0cnVj
dCB7CiAgIF9fYmUzMiBzYWRkcls0XTsKICAgX19iZTMyIGRhZGRyWzRdOwogICBfX2JlMTYg
c3BvcnQ7CiAgIF9fYmUxNiBkcG9ydDsKICB9IGlwdjY7CiB9Owp9OwoKc3RydWN0IGJwZl94
ZHBfc29jayB7CiBfX3UzMiBxdWV1ZV9pZDsKfTsKIyAzNzQyICIuL2luY2x1ZGUvdWFwaS9s
aW51eC9icGYuaCIKZW51bSB4ZHBfYWN0aW9uIHsKIFhEUF9BQk9SVEVEID0gMCwKIFhEUF9E
Uk9QLAogWERQX1BBU1MsCiBYRFBfVFgsCiBYRFBfUkVESVJFQ1QsCn07CgoKCgpzdHJ1Y3Qg
eGRwX21kIHsKIF9fdTMyIGRhdGE7CiBfX3UzMiBkYXRhX2VuZDsKIF9fdTMyIGRhdGFfbWV0
YTsKCiBfX3UzMiBpbmdyZXNzX2lmaW5kZXg7CiBfX3UzMiByeF9xdWV1ZV9pbmRleDsKCiBf
X3UzMiBlZ3Jlc3NfaWZpbmRleDsKfTsKCgoKCgoKc3RydWN0IGJwZl9kZXZtYXBfdmFsIHsK
IF9fdTMyIGlmaW5kZXg7CiB1bmlvbiB7CiAgaW50IGZkOwogIF9fdTMyIGlkOwogfSBicGZf
cHJvZzsKfTsKCmVudW0gc2tfYWN0aW9uIHsKIFNLX0RST1AgPSAwLAogU0tfUEFTUywKfTsK
CgoKCnN0cnVjdCBza19tc2dfbWQgewogdW5pb24geyB2b2lkICogZGF0YTsgX191NjQgOjY0
OyB9IF9fYXR0cmlidXRlX18oKGFsaWduZWQoOCkpKTsKIHVuaW9uIHsgdm9pZCAqIGRhdGFf
ZW5kOyBfX3U2NCA6NjQ7IH0gX19hdHRyaWJ1dGVfXygoYWxpZ25lZCg4KSkpOwoKIF9fdTMy
IGZhbWlseTsKIF9fdTMyIHJlbW90ZV9pcDQ7CiBfX3UzMiBsb2NhbF9pcDQ7CiBfX3UzMiBy
ZW1vdGVfaXA2WzRdOwogX191MzIgbG9jYWxfaXA2WzRdOwogX191MzIgcmVtb3RlX3BvcnQ7
CiBfX3UzMiBsb2NhbF9wb3J0OwogX191MzIgc2l6ZTsKCiB1bmlvbiB7IHN0cnVjdCBicGZf
c29jayAqIHNrOyBfX3U2NCA6NjQ7IH0gX19hdHRyaWJ1dGVfXygoYWxpZ25lZCg4KSkpOwp9
OwoKc3RydWN0IHNrX3JldXNlcG9ydF9tZCB7CgoKCgogdW5pb24geyB2b2lkICogZGF0YTsg
X191NjQgOjY0OyB9IF9fYXR0cmlidXRlX18oKGFsaWduZWQoOCkpKTsKCiB1bmlvbiB7IHZv
aWQgKiBkYXRhX2VuZDsgX191NjQgOjY0OyB9IF9fYXR0cmlidXRlX18oKGFsaWduZWQoOCkp
KTsKCgoKCgoKIF9fdTMyIGxlbjsKCgoKCiBfX3UzMiBldGhfcHJvdG9jb2w7CiBfX3UzMiBp
cF9wcm90b2NvbDsKIF9fdTMyIGJpbmRfaW5hbnk7CiBfX3UzMiBoYXNoOwp9OwoKCgpzdHJ1
Y3QgYnBmX3Byb2dfaW5mbyB7CiBfX3UzMiB0eXBlOwogX191MzIgaWQ7CiBfX3U4IHRhZ1s4
XTsKIF9fdTMyIGppdGVkX3Byb2dfbGVuOwogX191MzIgeGxhdGVkX3Byb2dfbGVuOwogX191
NjQgX19hdHRyaWJ1dGVfXygoYWxpZ25lZCg4KSkpIGppdGVkX3Byb2dfaW5zbnM7CiBfX3U2
NCBfX2F0dHJpYnV0ZV9fKChhbGlnbmVkKDgpKSkgeGxhdGVkX3Byb2dfaW5zbnM7CiBfX3U2
NCBsb2FkX3RpbWU7CiBfX3UzMiBjcmVhdGVkX2J5X3VpZDsKIF9fdTMyIG5yX21hcF9pZHM7
CiBfX3U2NCBfX2F0dHJpYnV0ZV9fKChhbGlnbmVkKDgpKSkgbWFwX2lkczsKIGNoYXIgbmFt
ZVsxNlVdOwogX191MzIgaWZpbmRleDsKIF9fdTMyIGdwbF9jb21wYXRpYmxlOjE7CiBfX3Uz
MiA6MzE7CiBfX3U2NCBuZXRuc19kZXY7CiBfX3U2NCBuZXRuc19pbm87CiBfX3UzMiBucl9q
aXRlZF9rc3ltczsKIF9fdTMyIG5yX2ppdGVkX2Z1bmNfbGVuczsKIF9fdTY0IF9fYXR0cmli
dXRlX18oKGFsaWduZWQoOCkpKSBqaXRlZF9rc3ltczsKIF9fdTY0IF9fYXR0cmlidXRlX18o
KGFsaWduZWQoOCkpKSBqaXRlZF9mdW5jX2xlbnM7CiBfX3UzMiBidGZfaWQ7CiBfX3UzMiBm
dW5jX2luZm9fcmVjX3NpemU7CiBfX3U2NCBfX2F0dHJpYnV0ZV9fKChhbGlnbmVkKDgpKSkg
ZnVuY19pbmZvOwogX191MzIgbnJfZnVuY19pbmZvOwogX191MzIgbnJfbGluZV9pbmZvOwog
X191NjQgX19hdHRyaWJ1dGVfXygoYWxpZ25lZCg4KSkpIGxpbmVfaW5mbzsKIF9fdTY0IF9f
YXR0cmlidXRlX18oKGFsaWduZWQoOCkpKSBqaXRlZF9saW5lX2luZm87CiBfX3UzMiBucl9q
aXRlZF9saW5lX2luZm87CiBfX3UzMiBsaW5lX2luZm9fcmVjX3NpemU7CiBfX3UzMiBqaXRl
ZF9saW5lX2luZm9fcmVjX3NpemU7CiBfX3UzMiBucl9wcm9nX3RhZ3M7CiBfX3U2NCBfX2F0
dHJpYnV0ZV9fKChhbGlnbmVkKDgpKSkgcHJvZ190YWdzOwogX191NjQgcnVuX3RpbWVfbnM7
CiBfX3U2NCBydW5fY250Owp9IF9fYXR0cmlidXRlX18oKGFsaWduZWQoOCkpKTsKCnN0cnVj
dCBicGZfbWFwX2luZm8gewogX191MzIgdHlwZTsKIF9fdTMyIGlkOwogX191MzIga2V5X3Np
emU7CiBfX3UzMiB2YWx1ZV9zaXplOwogX191MzIgbWF4X2VudHJpZXM7CiBfX3UzMiBtYXBf
ZmxhZ3M7CiBjaGFyIG5hbWVbMTZVXTsKIF9fdTMyIGlmaW5kZXg7CiBfX3UzMiBidGZfdm1s
aW51eF92YWx1ZV90eXBlX2lkOwogX191NjQgbmV0bnNfZGV2OwogX191NjQgbmV0bnNfaW5v
OwogX191MzIgYnRmX2lkOwogX191MzIgYnRmX2tleV90eXBlX2lkOwogX191MzIgYnRmX3Zh
bHVlX3R5cGVfaWQ7Cn0gX19hdHRyaWJ1dGVfXygoYWxpZ25lZCg4KSkpOwoKc3RydWN0IGJw
Zl9idGZfaW5mbyB7CiBfX3U2NCBfX2F0dHJpYnV0ZV9fKChhbGlnbmVkKDgpKSkgYnRmOwog
X191MzIgYnRmX3NpemU7CiBfX3UzMiBpZDsKfSBfX2F0dHJpYnV0ZV9fKChhbGlnbmVkKDgp
KSk7CgpzdHJ1Y3QgYnBmX2xpbmtfaW5mbyB7CiBfX3UzMiB0eXBlOwogX191MzIgaWQ7CiBf
X3UzMiBwcm9nX2lkOwogdW5pb24gewogIHN0cnVjdCB7CiAgIF9fdTY0IF9fYXR0cmlidXRl
X18oKGFsaWduZWQoOCkpKSB0cF9uYW1lOwogICBfX3UzMiB0cF9uYW1lX2xlbjsKICB9IHJh
d190cmFjZXBvaW50OwogIHN0cnVjdCB7CiAgIF9fdTMyIGF0dGFjaF90eXBlOwogIH0gdHJh
Y2luZzsKICBzdHJ1Y3QgewogICBfX3U2NCBjZ3JvdXBfaWQ7CiAgIF9fdTMyIGF0dGFjaF90
eXBlOwogIH0gY2dyb3VwOwogIHN0cnVjdCB7CiAgIF9fdTMyIG5ldG5zX2lubzsKICAgX191
MzIgYXR0YWNoX3R5cGU7CiAgfSBuZXRuczsKIH07Cn0gX19hdHRyaWJ1dGVfXygoYWxpZ25l
ZCg4KSkpOwoKCgoKCnN0cnVjdCBicGZfc29ja19hZGRyIHsKIF9fdTMyIHVzZXJfZmFtaWx5
OwogX191MzIgdXNlcl9pcDQ7CgoKIF9fdTMyIHVzZXJfaXA2WzRdOwoKCiBfX3UzMiB1c2Vy
X3BvcnQ7CgoKIF9fdTMyIGZhbWlseTsKIF9fdTMyIHR5cGU7CiBfX3UzMiBwcm90b2NvbDsK
IF9fdTMyIG1zZ19zcmNfaXA0OwoKCiBfX3UzMiBtc2dfc3JjX2lwNls0XTsKCgogdW5pb24g
eyBzdHJ1Y3QgYnBmX3NvY2sgKiBzazsgX191NjQgOjY0OyB9IF9fYXR0cmlidXRlX18oKGFs
aWduZWQoOCkpKTsKfTsKCgoKCgoKCnN0cnVjdCBicGZfc29ja19vcHMgewogX191MzIgb3A7
CiB1bmlvbiB7CiAgX191MzIgYXJnc1s0XTsKICBfX3UzMiByZXBseTsKICBfX3UzMiByZXBs
eWxvbmdbNF07CiB9OwogX191MzIgZmFtaWx5OwogX191MzIgcmVtb3RlX2lwNDsKIF9fdTMy
IGxvY2FsX2lwNDsKIF9fdTMyIHJlbW90ZV9pcDZbNF07CiBfX3UzMiBsb2NhbF9pcDZbNF07
CiBfX3UzMiByZW1vdGVfcG9ydDsKIF9fdTMyIGxvY2FsX3BvcnQ7CiBfX3UzMiBpc19mdWxs
c29jazsKCgoKIF9fdTMyIHNuZF9jd25kOwogX191MzIgc3J0dF91czsKIF9fdTMyIGJwZl9z
b2NrX29wc19jYl9mbGFnczsKIF9fdTMyIHN0YXRlOwogX191MzIgcnR0X21pbjsKIF9fdTMy
IHNuZF9zc3RocmVzaDsKIF9fdTMyIHJjdl9ueHQ7CiBfX3UzMiBzbmRfbnh0OwogX191MzIg
c25kX3VuYTsKIF9fdTMyIG1zc19jYWNoZTsKIF9fdTMyIGVjbl9mbGFnczsKIF9fdTMyIHJh
dGVfZGVsaXZlcmVkOwogX191MzIgcmF0ZV9pbnRlcnZhbF91czsKIF9fdTMyIHBhY2tldHNf
b3V0OwogX191MzIgcmV0cmFuc19vdXQ7CiBfX3UzMiB0b3RhbF9yZXRyYW5zOwogX191MzIg
c2Vnc19pbjsKIF9fdTMyIGRhdGFfc2Vnc19pbjsKIF9fdTMyIHNlZ3Nfb3V0OwogX191MzIg
ZGF0YV9zZWdzX291dDsKIF9fdTMyIGxvc3Rfb3V0OwogX191MzIgc2Fja2VkX291dDsKIF9f
dTMyIHNrX3R4aGFzaDsKIF9fdTY0IGJ5dGVzX3JlY2VpdmVkOwogX191NjQgYnl0ZXNfYWNr
ZWQ7CiB1bmlvbiB7IHN0cnVjdCBicGZfc29jayAqIHNrOyBfX3U2NCA6NjQ7IH0gX19hdHRy
aWJ1dGVfXygoYWxpZ25lZCg4KSkpOwp9OwoKCmVudW0gewogQlBGX1NPQ0tfT1BTX1JUT19D
Ql9GTEFHID0gKDE8PDApLAogQlBGX1NPQ0tfT1BTX1JFVFJBTlNfQ0JfRkxBRyA9ICgxPDwx
KSwKIEJQRl9TT0NLX09QU19TVEFURV9DQl9GTEFHID0gKDE8PDIpLAogQlBGX1NPQ0tfT1BT
X1JUVF9DQl9GTEFHID0gKDE8PDMpLAoKIEJQRl9TT0NLX09QU19BTExfQ0JfRkxBR1MgPSAw
eEYsCn07CgoKCgplbnVtIHsKIEJQRl9TT0NLX09QU19WT0lELAogQlBGX1NPQ0tfT1BTX1RJ
TUVPVVRfSU5JVCwKCgogQlBGX1NPQ0tfT1BTX1JXTkRfSU5JVCwKCgoKIEJQRl9TT0NLX09Q
U19UQ1BfQ09OTkVDVF9DQiwKCgogQlBGX1NPQ0tfT1BTX0FDVElWRV9FU1RBQkxJU0hFRF9D
QiwKCgoKIEJQRl9TT0NLX09QU19QQVNTSVZFX0VTVEFCTElTSEVEX0NCLAoKCgogQlBGX1NP
Q0tfT1BTX05FRURTX0VDTiwKCgogQlBGX1NPQ0tfT1BTX0JBU0VfUlRULAoKCgoKCgogQlBG
X1NPQ0tfT1BTX1JUT19DQiwKCgoKCiBCUEZfU09DS19PUFNfUkVUUkFOU19DQiwKCgoKCgog
QlBGX1NPQ0tfT1BTX1NUQVRFX0NCLAoKCgogQlBGX1NPQ0tfT1BTX1RDUF9MSVNURU5fQ0Is
CgoKIEJQRl9TT0NLX09QU19SVFRfQ0IsCgp9OwoKCgoKCgplbnVtIHsKIEJQRl9UQ1BfRVNU
QUJMSVNIRUQgPSAxLAogQlBGX1RDUF9TWU5fU0VOVCwKIEJQRl9UQ1BfU1lOX1JFQ1YsCiBC
UEZfVENQX0ZJTl9XQUlUMSwKIEJQRl9UQ1BfRklOX1dBSVQyLAogQlBGX1RDUF9USU1FX1dB
SVQsCiBCUEZfVENQX0NMT1NFLAogQlBGX1RDUF9DTE9TRV9XQUlULAogQlBGX1RDUF9MQVNU
X0FDSywKIEJQRl9UQ1BfTElTVEVOLAogQlBGX1RDUF9DTE9TSU5HLAogQlBGX1RDUF9ORVdf
U1lOX1JFQ1YsCgogQlBGX1RDUF9NQVhfU1RBVEVTCn07CgplbnVtIHsKIFRDUF9CUEZfSVcg
PSAxMDAxLAogVENQX0JQRl9TTkRDV05EX0NMQU1QID0gMTAwMiwKfTsKCnN0cnVjdCBicGZf
cGVyZl9ldmVudF92YWx1ZSB7CiBfX3U2NCBjb3VudGVyOwogX191NjQgZW5hYmxlZDsKIF9f
dTY0IHJ1bm5pbmc7Cn07CgplbnVtIHsKIEJQRl9ERVZDR19BQ0NfTUtOT0QgPSAoMVVMTCA8
PCAwKSwKIEJQRl9ERVZDR19BQ0NfUkVBRCA9ICgxVUxMIDw8IDEpLAogQlBGX0RFVkNHX0FD
Q19XUklURSA9ICgxVUxMIDw8IDIpLAp9OwoKZW51bSB7CiBCUEZfREVWQ0dfREVWX0JMT0NL
ID0gKDFVTEwgPDwgMCksCiBCUEZfREVWQ0dfREVWX0NIQVIgPSAoMVVMTCA8PCAxKSwKfTsK
CnN0cnVjdCBicGZfY2dyb3VwX2Rldl9jdHggewoKIF9fdTMyIGFjY2Vzc190eXBlOwogX191
MzIgbWFqb3I7CiBfX3UzMiBtaW5vcjsKfTsKCnN0cnVjdCBicGZfcmF3X3RyYWNlcG9pbnRf
YXJncyB7CiBfX3U2NCBhcmdzWzBdOwp9OwoKCgoKZW51bSB7CiBCUEZfRklCX0xPT0tVUF9E
SVJFQ1QgPSAoMVUgPDwgMCksCiBCUEZfRklCX0xPT0tVUF9PVVRQVVQgPSAoMVUgPDwgMSks
Cn07CgplbnVtIHsKIEJQRl9GSUJfTEtVUF9SRVRfU1VDQ0VTUywKIEJQRl9GSUJfTEtVUF9S
RVRfQkxBQ0tIT0xFLAogQlBGX0ZJQl9MS1VQX1JFVF9VTlJFQUNIQUJMRSwKIEJQRl9GSUJf
TEtVUF9SRVRfUFJPSElCSVQsCiBCUEZfRklCX0xLVVBfUkVUX05PVF9GV0RFRCwKIEJQRl9G
SUJfTEtVUF9SRVRfRldEX0RJU0FCTEVELAogQlBGX0ZJQl9MS1VQX1JFVF9VTlNVUFBfTFdU
LAogQlBGX0ZJQl9MS1VQX1JFVF9OT19ORUlHSCwKIEJQRl9GSUJfTEtVUF9SRVRfRlJBR19O
RUVERUQsCn07CgpzdHJ1Y3QgYnBmX2ZpYl9sb29rdXAgewoKCgogX191OCBmYW1pbHk7CgoK
IF9fdTggbDRfcHJvdG9jb2w7CiBfX2JlMTYgc3BvcnQ7CiBfX2JlMTYgZHBvcnQ7CgoKIF9f
dTE2IHRvdF9sZW47CgoKCgogX191MzIgaWZpbmRleDsKCiB1bmlvbiB7CgogIF9fdTggdG9z
OwogIF9fYmUzMiBmbG93aW5mbzsKCgogIF9fdTMyIHJ0X21ldHJpYzsKIH07CgogdW5pb24g
ewogIF9fYmUzMiBpcHY0X3NyYzsKICBfX3UzMiBpcHY2X3NyY1s0XTsKIH07CgoKCgoKIHVu
aW9uIHsKICBfX2JlMzIgaXB2NF9kc3Q7CiAgX191MzIgaXB2Nl9kc3RbNF07CiB9OwoKCiBf
X2JlMTYgaF92bGFuX3Byb3RvOwogX19iZTE2IGhfdmxhbl9UQ0k7CiBfX3U4IHNtYWNbNl07
CiBfX3U4IGRtYWNbNl07Cn07CgplbnVtIGJwZl90YXNrX2ZkX3R5cGUgewogQlBGX0ZEX1RZ
UEVfUkFXX1RSQUNFUE9JTlQsCiBCUEZfRkRfVFlQRV9UUkFDRVBPSU5ULAogQlBGX0ZEX1RZ
UEVfS1BST0JFLAogQlBGX0ZEX1RZUEVfS1JFVFBST0JFLAogQlBGX0ZEX1RZUEVfVVBST0JF
LAogQlBGX0ZEX1RZUEVfVVJFVFBST0JFLAp9OwoKZW51bSB7CiBCUEZfRkxPV19ESVNTRUNU
T1JfRl9QQVJTRV8xU1RfRlJBRyA9ICgxVSA8PCAwKSwKIEJQRl9GTE9XX0RJU1NFQ1RPUl9G
X1NUT1BfQVRfRkxPV19MQUJFTCA9ICgxVSA8PCAxKSwKIEJQRl9GTE9XX0RJU1NFQ1RPUl9G
X1NUT1BfQVRfRU5DQVAgPSAoMVUgPDwgMiksCn07CgpzdHJ1Y3QgYnBmX2Zsb3dfa2V5cyB7
CiBfX3UxNiBuaG9mZjsKIF9fdTE2IHRob2ZmOwogX191MTYgYWRkcl9wcm90bzsKIF9fdTgg
aXNfZnJhZzsKIF9fdTggaXNfZmlyc3RfZnJhZzsKIF9fdTggaXNfZW5jYXA7CiBfX3U4IGlw
X3Byb3RvOwogX19iZTE2IG5fcHJvdG87CiBfX2JlMTYgc3BvcnQ7CiBfX2JlMTYgZHBvcnQ7
CiB1bmlvbiB7CiAgc3RydWN0IHsKICAgX19iZTMyIGlwdjRfc3JjOwogICBfX2JlMzIgaXB2
NF9kc3Q7CiAgfTsKICBzdHJ1Y3QgewogICBfX3UzMiBpcHY2X3NyY1s0XTsKICAgX191MzIg
aXB2Nl9kc3RbNF07CiAgfTsKIH07CiBfX3UzMiBmbGFnczsKIF9fYmUzMiBmbG93X2xhYmVs
Owp9OwoKc3RydWN0IGJwZl9mdW5jX2luZm8gewogX191MzIgaW5zbl9vZmY7CiBfX3UzMiB0
eXBlX2lkOwp9OwoKCgoKc3RydWN0IGJwZl9saW5lX2luZm8gewogX191MzIgaW5zbl9vZmY7
CiBfX3UzMiBmaWxlX25hbWVfb2ZmOwogX191MzIgbGluZV9vZmY7CiBfX3UzMiBsaW5lX2Nv
bDsKfTsKCnN0cnVjdCBicGZfc3Bpbl9sb2NrIHsKIF9fdTMyIHZhbDsKfTsKCnN0cnVjdCBi
cGZfc3lzY3RsIHsKIF9fdTMyIHdyaXRlOwoKCiBfX3UzMiBmaWxlX3BvczsKCgp9OwoKc3Ry
dWN0IGJwZl9zb2Nrb3B0IHsKIHVuaW9uIHsgc3RydWN0IGJwZl9zb2NrICogc2s7IF9fdTY0
IDo2NDsgfSBfX2F0dHJpYnV0ZV9fKChhbGlnbmVkKDgpKSk7CiB1bmlvbiB7IHZvaWQgKiBv
cHR2YWw7IF9fdTY0IDo2NDsgfSBfX2F0dHJpYnV0ZV9fKChhbGlnbmVkKDgpKSk7CiB1bmlv
biB7IHZvaWQgKiBvcHR2YWxfZW5kOyBfX3U2NCA6NjQ7IH0gX19hdHRyaWJ1dGVfXygoYWxp
Z25lZCg4KSkpOwoKIF9fczMyIGxldmVsOwogX19zMzIgb3B0bmFtZTsKIF9fczMyIG9wdGxl
bjsKIF9fczMyIHJldHZhbDsKfTsKCnN0cnVjdCBicGZfcGlkbnNfaW5mbyB7CiBfX3UzMiBw
aWQ7CiBfX3UzMiB0Z2lkOwp9OwojIDggIi4vaW5jbHVkZS9saW51eC9icGYuaCIgMgoKCiMg
MSAiLi9pbmNsdWRlL2xpbnV4L2ZpbGUuaCIgMQojIDEzICIuL2luY2x1ZGUvbGludXgvZmls
ZS5oIgpzdHJ1Y3QgZmlsZTsKCmV4dGVybiB2b2lkIGZwdXQoc3RydWN0IGZpbGUgKik7CmV4
dGVybiB2b2lkIGZwdXRfbWFueShzdHJ1Y3QgZmlsZSAqLCB1bnNpZ25lZCBpbnQpOwoKc3Ry
dWN0IGZpbGVfb3BlcmF0aW9uczsKc3RydWN0IHRhc2tfc3RydWN0OwpzdHJ1Y3QgdmZzbW91
bnQ7CnN0cnVjdCBkZW50cnk7CnN0cnVjdCBpbm9kZTsKc3RydWN0IHBhdGg7CmV4dGVybiBz
dHJ1Y3QgZmlsZSAqYWxsb2NfZmlsZV9wc2V1ZG8oc3RydWN0IGlub2RlICosIHN0cnVjdCB2
ZnNtb3VudCAqLAogY29uc3QgY2hhciAqLCBpbnQgZmxhZ3MsIGNvbnN0IHN0cnVjdCBmaWxl
X29wZXJhdGlvbnMgKik7CmV4dGVybiBzdHJ1Y3QgZmlsZSAqYWxsb2NfZmlsZV9jbG9uZShz
dHJ1Y3QgZmlsZSAqLCBpbnQgZmxhZ3MsCiBjb25zdCBzdHJ1Y3QgZmlsZV9vcGVyYXRpb25z
ICopOwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIHZvaWQgZnB1dF9saWdodChzdHJ1Y3QgZmlsZSAqZmlsZSwgaW50
IGZwdXRfbmVlZGVkKQp7CiBpZiAoZnB1dF9uZWVkZWQpCiAgZnB1dChmaWxlKTsKfQoKc3Ry
dWN0IGZkIHsKIHN0cnVjdCBmaWxlICpmaWxlOwogdW5zaWduZWQgaW50IGZsYWdzOwp9OwoK
CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgdm9pZCBmZHB1dChzdHJ1Y3QgZmQgZmQpCnsKIGlmIChmZC5mbGFncyAm
IDEpCiAgZnB1dChmZC5maWxlKTsKfQoKZXh0ZXJuIHN0cnVjdCBmaWxlICpmZ2V0KHVuc2ln
bmVkIGludCBmZCk7CmV4dGVybiBzdHJ1Y3QgZmlsZSAqZmdldF9tYW55KHVuc2lnbmVkIGlu
dCBmZCwgdW5zaWduZWQgaW50IHJlZnMpOwpleHRlcm4gc3RydWN0IGZpbGUgKmZnZXRfcmF3
KHVuc2lnbmVkIGludCBmZCk7CmV4dGVybiBzdHJ1Y3QgZmlsZSAqZmdldF90YXNrKHN0cnVj
dCB0YXNrX3N0cnVjdCAqdGFzaywgdW5zaWduZWQgaW50IGZkKTsKZXh0ZXJuIHVuc2lnbmVk
IGxvbmcgX19mZGdldCh1bnNpZ25lZCBpbnQgZmQpOwpleHRlcm4gdW5zaWduZWQgbG9uZyBf
X2ZkZ2V0X3Jhdyh1bnNpZ25lZCBpbnQgZmQpOwpleHRlcm4gdW5zaWduZWQgbG9uZyBfX2Zk
Z2V0X3Bvcyh1bnNpZ25lZCBpbnQgZmQpOwpleHRlcm4gdm9pZCBfX2ZfdW5sb2NrX3Bvcyhz
dHJ1Y3QgZmlsZSAqKTsKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3QgZmQgX190b19mZCh1bnNpZ25lZCBs
b25nIHYpCnsKIHJldHVybiAoc3RydWN0IGZkKXsoc3RydWN0IGZpbGUgKikodiAmIH4zKSx2
ICYgM307Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3QgZmQgZmRnZXQodW5zaWduZWQgaW50IGZkKQp7
CiByZXR1cm4gX190b19mZChfX2ZkZ2V0KGZkKSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3QgZmQg
ZmRnZXRfcmF3KHVuc2lnbmVkIGludCBmZCkKewogcmV0dXJuIF9fdG9fZmQoX19mZGdldF9y
YXcoZmQpKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIHN0cnVjdCBmZCBmZGdldF9wb3MoaW50IGZkKQp7CiBy
ZXR1cm4gX190b19mZChfX2ZkZ2V0X3BvcyhmZCkpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBmZHB1
dF9wb3Moc3RydWN0IGZkIGYpCnsKIGlmIChmLmZsYWdzICYgMikKICBfX2ZfdW5sb2NrX3Bv
cyhmLmZpbGUpOwogZmRwdXQoZik7Cn0KCmV4dGVybiBpbnQgZl9kdXBmZCh1bnNpZ25lZCBp
bnQgZnJvbSwgc3RydWN0IGZpbGUgKmZpbGUsIHVuc2lnbmVkIGZsYWdzKTsKZXh0ZXJuIGlu
dCByZXBsYWNlX2ZkKHVuc2lnbmVkIGZkLCBzdHJ1Y3QgZmlsZSAqZmlsZSwgdW5zaWduZWQg
ZmxhZ3MpOwpleHRlcm4gdm9pZCBzZXRfY2xvc2Vfb25fZXhlYyh1bnNpZ25lZCBpbnQgZmQs
IGludCBmbGFnKTsKZXh0ZXJuIGJvb2wgZ2V0X2Nsb3NlX29uX2V4ZWModW5zaWduZWQgaW50
IGZkKTsKZXh0ZXJuIGludCBfX2dldF91bnVzZWRfZmRfZmxhZ3ModW5zaWduZWQgZmxhZ3Ms
IHVuc2lnbmVkIGxvbmcgbm9maWxlKTsKZXh0ZXJuIGludCBnZXRfdW51c2VkX2ZkX2ZsYWdz
KHVuc2lnbmVkIGZsYWdzKTsKZXh0ZXJuIHZvaWQgcHV0X3VudXNlZF9mZCh1bnNpZ25lZCBp
bnQgZmQpOwoKZXh0ZXJuIHZvaWQgZmRfaW5zdGFsbCh1bnNpZ25lZCBpbnQgZmQsIHN0cnVj
dCBmaWxlICpmaWxlKTsKCmV4dGVybiB2b2lkIGZsdXNoX2RlbGF5ZWRfZnB1dCh2b2lkKTsK
ZXh0ZXJuIHZvaWQgX19mcHV0X3N5bmMoc3RydWN0IGZpbGUgKik7CgpleHRlcm4gdW5zaWdu
ZWQgaW50IHN5c2N0bF9ucl9vcGVuX21pbiwgc3lzY3RsX25yX29wZW5fbWF4OwojIDExICIu
L2luY2x1ZGUvbGludXgvYnBmLmgiIDIKIyAyNCAiLi9pbmNsdWRlL2xpbnV4L2JwZi5oIgpz
dHJ1Y3QgYnBmX3ZlcmlmaWVyX2VudjsKc3RydWN0IGJwZl92ZXJpZmllcl9sb2c7CnN0cnVj
dCBwZXJmX2V2ZW50OwpzdHJ1Y3QgYnBmX3Byb2c7CnN0cnVjdCBicGZfcHJvZ19hdXg7CnN0
cnVjdCBicGZfbWFwOwpzdHJ1Y3Qgc29jazsKc3RydWN0IHNlcV9maWxlOwpzdHJ1Y3QgYnRm
OwpzdHJ1Y3QgYnRmX3R5cGU7CnN0cnVjdCBleGNlcHRpb25fdGFibGVfZW50cnk7CnN0cnVj
dCBzZXFfb3BlcmF0aW9uczsKCmV4dGVybiBzdHJ1Y3QgaWRyIGJ0Zl9pZHI7CmV4dGVybiBz
cGlubG9ja190IGJ0Zl9pZHJfbG9jazsKCgpzdHJ1Y3QgYnBmX21hcF9vcHMgewoKIGludCAo
Km1hcF9hbGxvY19jaGVjaykodW5pb24gYnBmX2F0dHIgKmF0dHIpOwogc3RydWN0IGJwZl9t
YXAgKigqbWFwX2FsbG9jKSh1bmlvbiBicGZfYXR0ciAqYXR0cik7CiB2b2lkICgqbWFwX3Jl
bGVhc2UpKHN0cnVjdCBicGZfbWFwICptYXAsIHN0cnVjdCBmaWxlICptYXBfZmlsZSk7CiB2
b2lkICgqbWFwX2ZyZWUpKHN0cnVjdCBicGZfbWFwICptYXApOwogaW50ICgqbWFwX2dldF9u
ZXh0X2tleSkoc3RydWN0IGJwZl9tYXAgKm1hcCwgdm9pZCAqa2V5LCB2b2lkICpuZXh0X2tl
eSk7CiB2b2lkICgqbWFwX3JlbGVhc2VfdXJlZikoc3RydWN0IGJwZl9tYXAgKm1hcCk7CiB2
b2lkICooKm1hcF9sb29rdXBfZWxlbV9zeXNfb25seSkoc3RydWN0IGJwZl9tYXAgKm1hcCwg
dm9pZCAqa2V5KTsKIGludCAoKm1hcF9sb29rdXBfYmF0Y2gpKHN0cnVjdCBicGZfbWFwICpt
YXAsIGNvbnN0IHVuaW9uIGJwZl9hdHRyICphdHRyLAogICAgdW5pb24gYnBmX2F0dHIgKnVh
dHRyKTsKIGludCAoKm1hcF9sb29rdXBfYW5kX2RlbGV0ZV9iYXRjaCkoc3RydWN0IGJwZl9t
YXAgKm1hcCwKICAgICAgICBjb25zdCB1bmlvbiBicGZfYXR0ciAqYXR0ciwKICAgICAgICB1
bmlvbiBicGZfYXR0ciAqdWF0dHIpOwogaW50ICgqbWFwX3VwZGF0ZV9iYXRjaCkoc3RydWN0
IGJwZl9tYXAgKm1hcCwgY29uc3QgdW5pb24gYnBmX2F0dHIgKmF0dHIsCiAgICB1bmlvbiBi
cGZfYXR0ciAqdWF0dHIpOwogaW50ICgqbWFwX2RlbGV0ZV9iYXRjaCkoc3RydWN0IGJwZl9t
YXAgKm1hcCwgY29uc3QgdW5pb24gYnBmX2F0dHIgKmF0dHIsCiAgICB1bmlvbiBicGZfYXR0
ciAqdWF0dHIpOwoKCiB2b2lkICooKm1hcF9sb29rdXBfZWxlbSkoc3RydWN0IGJwZl9tYXAg
Km1hcCwgdm9pZCAqa2V5KTsKIGludCAoKm1hcF91cGRhdGVfZWxlbSkoc3RydWN0IGJwZl9t
YXAgKm1hcCwgdm9pZCAqa2V5LCB2b2lkICp2YWx1ZSwgdTY0IGZsYWdzKTsKIGludCAoKm1h
cF9kZWxldGVfZWxlbSkoc3RydWN0IGJwZl9tYXAgKm1hcCwgdm9pZCAqa2V5KTsKIGludCAo
Km1hcF9wdXNoX2VsZW0pKHN0cnVjdCBicGZfbWFwICptYXAsIHZvaWQgKnZhbHVlLCB1NjQg
ZmxhZ3MpOwogaW50ICgqbWFwX3BvcF9lbGVtKShzdHJ1Y3QgYnBmX21hcCAqbWFwLCB2b2lk
ICp2YWx1ZSk7CiBpbnQgKCptYXBfcGVla19lbGVtKShzdHJ1Y3QgYnBmX21hcCAqbWFwLCB2
b2lkICp2YWx1ZSk7CgoKIHZvaWQgKigqbWFwX2ZkX2dldF9wdHIpKHN0cnVjdCBicGZfbWFw
ICptYXAsIHN0cnVjdCBmaWxlICptYXBfZmlsZSwKICAgIGludCBmZCk7CiB2b2lkICgqbWFw
X2ZkX3B1dF9wdHIpKHZvaWQgKnB0cik7CiB1MzIgKCptYXBfZ2VuX2xvb2t1cCkoc3RydWN0
IGJwZl9tYXAgKm1hcCwgc3RydWN0IGJwZl9pbnNuICppbnNuX2J1Zik7CiB1MzIgKCptYXBf
ZmRfc3lzX2xvb2t1cF9lbGVtKSh2b2lkICpwdHIpOwogdm9pZCAoKm1hcF9zZXFfc2hvd19l
bGVtKShzdHJ1Y3QgYnBmX21hcCAqbWFwLCB2b2lkICprZXksCiAgICAgIHN0cnVjdCBzZXFf
ZmlsZSAqbSk7CiBpbnQgKCptYXBfY2hlY2tfYnRmKShjb25zdCBzdHJ1Y3QgYnBmX21hcCAq
bWFwLAogICAgICAgIGNvbnN0IHN0cnVjdCBidGYgKmJ0ZiwKICAgICAgICBjb25zdCBzdHJ1
Y3QgYnRmX3R5cGUgKmtleV90eXBlLAogICAgICAgIGNvbnN0IHN0cnVjdCBidGZfdHlwZSAq
dmFsdWVfdHlwZSk7CgoKIGludCAoKm1hcF9wb2tlX3RyYWNrKShzdHJ1Y3QgYnBmX21hcCAq
bWFwLCBzdHJ1Y3QgYnBmX3Byb2dfYXV4ICphdXgpOwogdm9pZCAoKm1hcF9wb2tlX3VudHJh
Y2spKHN0cnVjdCBicGZfbWFwICptYXAsIHN0cnVjdCBicGZfcHJvZ19hdXggKmF1eCk7CiB2
b2lkICgqbWFwX3Bva2VfcnVuKShzdHJ1Y3QgYnBmX21hcCAqbWFwLCB1MzIga2V5LCBzdHJ1
Y3QgYnBmX3Byb2cgKm9sZCwKICAgICAgICBzdHJ1Y3QgYnBmX3Byb2cgKm5ldyk7CgoKIGlu
dCAoKm1hcF9kaXJlY3RfdmFsdWVfYWRkcikoY29uc3Qgc3RydWN0IGJwZl9tYXAgKm1hcCwK
ICAgICAgICAgdTY0ICppbW0sIHUzMiBvZmYpOwogaW50ICgqbWFwX2RpcmVjdF92YWx1ZV9t
ZXRhKShjb25zdCBzdHJ1Y3QgYnBmX21hcCAqbWFwLAogICAgICAgICB1NjQgaW1tLCB1MzIg
Km9mZik7CiBpbnQgKCptYXBfbW1hcCkoc3RydWN0IGJwZl9tYXAgKm1hcCwgc3RydWN0IHZt
X2FyZWFfc3RydWN0ICp2bWEpOwogX19wb2xsX3QgKCptYXBfcG9sbCkoc3RydWN0IGJwZl9t
YXAgKm1hcCwgc3RydWN0IGZpbGUgKmZpbHAsCiAgICAgICAgc3RydWN0IHBvbGxfdGFibGVf
c3RydWN0ICpwdHMpOwp9OwoKc3RydWN0IGJwZl9tYXBfbWVtb3J5IHsKIHUzMiBwYWdlczsK
IHN0cnVjdCB1c2VyX3N0cnVjdCAqdXNlcjsKfTsKCnN0cnVjdCBicGZfbWFwIHsKCgoKIGNv
bnN0IHN0cnVjdCBicGZfbWFwX29wcyAqb3BzIF9fYXR0cmlidXRlX18oKF9fYWxpZ25lZF9f
KCgxIDw8IDYpKSkpOwogc3RydWN0IGJwZl9tYXAgKmlubmVyX21hcF9tZXRhOwoKCgogZW51
bSBicGZfbWFwX3R5cGUgbWFwX3R5cGU7CiB1MzIga2V5X3NpemU7CiB1MzIgdmFsdWVfc2l6
ZTsKIHUzMiBtYXhfZW50cmllczsKIHUzMiBtYXBfZmxhZ3M7CiBpbnQgc3Bpbl9sb2NrX29m
ZjsKIHUzMiBpZDsKIGludCBudW1hX25vZGU7CiB1MzIgYnRmX2tleV90eXBlX2lkOwogdTMy
IGJ0Zl92YWx1ZV90eXBlX2lkOwogc3RydWN0IGJ0ZiAqYnRmOwogc3RydWN0IGJwZl9tYXBf
bWVtb3J5IG1lbW9yeTsKIGNoYXIgbmFtZVsxNlVdOwogdTMyIGJ0Zl92bWxpbnV4X3ZhbHVl
X3R5cGVfaWQ7CiBib29sIGJ5cGFzc19zcGVjX3YxOwogYm9vbCBmcm96ZW47CgoKCgoKIGF0
b21pYzY0X3QgcmVmY250IF9fYXR0cmlidXRlX18oKF9fYWxpZ25lZF9fKCgxIDw8IDYpKSkp
OwogYXRvbWljNjRfdCB1c2VyY250Owogc3RydWN0IHdvcmtfc3RydWN0IHdvcms7CiBzdHJ1
Y3QgbXV0ZXggZnJlZXplX211dGV4OwogdTY0IHdyaXRlY250Owp9OwoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJv
b2wgbWFwX3ZhbHVlX2hhc19zcGluX2xvY2soY29uc3Qgc3RydWN0IGJwZl9tYXAgKm1hcCkK
ewogcmV0dXJuIG1hcC0+c3Bpbl9sb2NrX29mZiA+PSAwOwp9CgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBj
aGVja19hbmRfaW5pdF9tYXBfbG9jayhzdHJ1Y3QgYnBmX21hcCAqbWFwLCB2b2lkICpkc3Qp
CnsKIGlmIChfX2J1aWx0aW5fZXhwZWN0KCEhKCFtYXBfdmFsdWVfaGFzX3NwaW5fbG9jayht
YXApKSwgMSkpCiAgcmV0dXJuOwogKihzdHJ1Y3QgYnBmX3NwaW5fbG9jayAqKShkc3QgKyBt
YXAtPnNwaW5fbG9ja19vZmYpID0KICAoc3RydWN0IGJwZl9zcGluX2xvY2spe307Cn0KCgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgdm9pZCBjb3B5X21hcF92YWx1ZShzdHJ1Y3QgYnBmX21hcCAqbWFwLCB2b2lk
ICpkc3QsIHZvaWQgKnNyYykKewogaWYgKF9fYnVpbHRpbl9leHBlY3QoISEobWFwX3ZhbHVl
X2hhc19zcGluX2xvY2sobWFwKSksIDApKSB7CiAgdTMyIG9mZiA9IG1hcC0+c3Bpbl9sb2Nr
X29mZjsKCiAgbWVtY3B5KGRzdCwgc3JjLCBvZmYpOwogIG1lbWNweShkc3QgKyBvZmYgKyBz
aXplb2Yoc3RydWN0IGJwZl9zcGluX2xvY2spLAogICAgICAgICBzcmMgKyBvZmYgKyBzaXpl
b2Yoc3RydWN0IGJwZl9zcGluX2xvY2spLAogICAgICAgICBtYXAtPnZhbHVlX3NpemUgLSBv
ZmYgLSBzaXplb2Yoc3RydWN0IGJwZl9zcGluX2xvY2spKTsKIH0gZWxzZSB7CiAgbWVtY3B5
KGRzdCwgc3JjLCBtYXAtPnZhbHVlX3NpemUpOwogfQp9CnZvaWQgY29weV9tYXBfdmFsdWVf
bG9ja2VkKHN0cnVjdCBicGZfbWFwICptYXAsIHZvaWQgKmRzdCwgdm9pZCAqc3JjLAogICAg
ICBib29sIGxvY2tfc3JjKTsKaW50IGJwZl9vYmpfbmFtZV9jcHkoY2hhciAqZHN0LCBjb25z
dCBjaGFyICpzcmMsIHVuc2lnbmVkIGludCBzaXplKTsKCnN0cnVjdCBicGZfb2ZmbG9hZF9k
ZXY7CnN0cnVjdCBicGZfb2ZmbG9hZGVkX21hcDsKCnN0cnVjdCBicGZfbWFwX2Rldl9vcHMg
ewogaW50ICgqbWFwX2dldF9uZXh0X2tleSkoc3RydWN0IGJwZl9vZmZsb2FkZWRfbWFwICpt
YXAsCiAgICB2b2lkICprZXksIHZvaWQgKm5leHRfa2V5KTsKIGludCAoKm1hcF9sb29rdXBf
ZWxlbSkoc3RydWN0IGJwZl9vZmZsb2FkZWRfbWFwICptYXAsCiAgICAgICAgICB2b2lkICpr
ZXksIHZvaWQgKnZhbHVlKTsKIGludCAoKm1hcF91cGRhdGVfZWxlbSkoc3RydWN0IGJwZl9v
ZmZsb2FkZWRfbWFwICptYXAsCiAgICAgICAgICB2b2lkICprZXksIHZvaWQgKnZhbHVlLCB1
NjQgZmxhZ3MpOwogaW50ICgqbWFwX2RlbGV0ZV9lbGVtKShzdHJ1Y3QgYnBmX29mZmxvYWRl
ZF9tYXAgKm1hcCwgdm9pZCAqa2V5KTsKfTsKCnN0cnVjdCBicGZfb2ZmbG9hZGVkX21hcCB7
CiBzdHJ1Y3QgYnBmX21hcCBtYXA7CiBzdHJ1Y3QgbmV0X2RldmljZSAqbmV0ZGV2OwogY29u
c3Qgc3RydWN0IGJwZl9tYXBfZGV2X29wcyAqZGV2X29wczsKIHZvaWQgKmRldl9wcml2Owog
c3RydWN0IGxpc3RfaGVhZCBvZmZsb2FkczsKfTsKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3QgYnBmX29m
ZmxvYWRlZF9tYXAgKm1hcF90b19vZmZtYXAoc3RydWN0IGJwZl9tYXAgKm1hcCkKewogcmV0
dXJuICh7IHZvaWQgKl9fbXB0ciA9ICh2b2lkICopKG1hcCk7IGRvIHsgZXh0ZXJuIHZvaWQg
X19jb21waWxldGltZV9hc3NlcnRfMjA2KHZvaWQpIF9fYXR0cmlidXRlX18oKF9fZXJyb3Jf
XygicG9pbnRlciB0eXBlIG1pc21hdGNoIGluIGNvbnRhaW5lcl9vZigpIikpKTsgaWYgKCEo
ISghX19idWlsdGluX3R5cGVzX2NvbXBhdGlibGVfcCh0eXBlb2YoKihtYXApKSwgdHlwZW9m
KCgoc3RydWN0IGJwZl9vZmZsb2FkZWRfbWFwICopMCktPm1hcCkpICYmICFfX2J1aWx0aW5f
dHlwZXNfY29tcGF0aWJsZV9wKHR5cGVvZigqKG1hcCkpLCB0eXBlb2Yodm9pZCkpKSkpIF9f
Y29tcGlsZXRpbWVfYXNzZXJ0XzIwNigpOyB9IHdoaWxlICgwKTsgKChzdHJ1Y3QgYnBmX29m
ZmxvYWRlZF9tYXAgKikoX19tcHRyIC0gX19idWlsdGluX29mZnNldG9mKHN0cnVjdCBicGZf
b2ZmbG9hZGVkX21hcCwgbWFwKSkpOyB9KTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgYnBmX21hcF9v
ZmZsb2FkX25ldXRyYWwoY29uc3Qgc3RydWN0IGJwZl9tYXAgKm1hcCkKewogcmV0dXJuIG1h
cC0+bWFwX3R5cGUgPT0gQlBGX01BUF9UWVBFX1BFUkZfRVZFTlRfQVJSQVk7Cn0KCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBib29sIGJwZl9tYXBfc3VwcG9ydF9zZXFfc2hvdyhjb25zdCBzdHJ1Y3QgYnBmX21h
cCAqbWFwKQp7CiByZXR1cm4gKG1hcC0+YnRmX3ZhbHVlX3R5cGVfaWQgfHwgbWFwLT5idGZf
dm1saW51eF92YWx1ZV90eXBlX2lkKSAmJgogIG1hcC0+b3BzLT5tYXBfc2VxX3Nob3dfZWxl
bTsKfQoKaW50IG1hcF9jaGVja19ub19idGYoY29uc3Qgc3RydWN0IGJwZl9tYXAgKm1hcCwK
ICAgICAgIGNvbnN0IHN0cnVjdCBidGYgKmJ0ZiwKICAgICAgIGNvbnN0IHN0cnVjdCBidGZf
dHlwZSAqa2V5X3R5cGUsCiAgICAgICBjb25zdCBzdHJ1Y3QgYnRmX3R5cGUgKnZhbHVlX3R5
cGUpOwoKZXh0ZXJuIGNvbnN0IHN0cnVjdCBicGZfbWFwX29wcyBicGZfbWFwX29mZmxvYWRf
b3BzOwoKCmVudW0gYnBmX2FyZ190eXBlIHsKIEFSR19ET05UQ0FSRSA9IDAsCgoKCgogQVJH
X0NPTlNUX01BUF9QVFIsCiBBUkdfUFRSX1RPX01BUF9LRVksCiBBUkdfUFRSX1RPX01BUF9W
QUxVRSwKIEFSR19QVFJfVE9fVU5JTklUX01BUF9WQUxVRSwKIEFSR19QVFJfVE9fTUFQX1ZB
TFVFX09SX05VTEwsCgoKCgogQVJHX1BUUl9UT19NRU0sCiBBUkdfUFRSX1RPX01FTV9PUl9O
VUxMLAogQVJHX1BUUl9UT19VTklOSVRfTUVNLAoKCgoKIEFSR19DT05TVF9TSVpFLAogQVJH
X0NPTlNUX1NJWkVfT1JfWkVSTywKCiBBUkdfUFRSX1RPX0NUWCwKIEFSR19QVFJfVE9fQ1RY
X09SX05VTEwsCiBBUkdfQU5ZVEhJTkcsCiBBUkdfUFRSX1RPX1NQSU5fTE9DSywKIEFSR19Q
VFJfVE9fU09DS19DT01NT04sCiBBUkdfUFRSX1RPX0lOVCwKIEFSR19QVFJfVE9fTE9ORywK
IEFSR19QVFJfVE9fU09DS0VULAogQVJHX1BUUl9UT19CVEZfSUQsCiBBUkdfUFRSX1RPX0FM
TE9DX01FTSwKIEFSR19QVFJfVE9fQUxMT0NfTUVNX09SX05VTEwsCiBBUkdfQ09OU1RfQUxM
T0NfU0laRV9PUl9aRVJPLAp9OwoKCmVudW0gYnBmX3JldHVybl90eXBlIHsKIFJFVF9JTlRF
R0VSLAogUkVUX1ZPSUQsCiBSRVRfUFRSX1RPX01BUF9WQUxVRSwKIFJFVF9QVFJfVE9fTUFQ
X1ZBTFVFX09SX05VTEwsCiBSRVRfUFRSX1RPX1NPQ0tFVF9PUl9OVUxMLAogUkVUX1BUUl9U
T19UQ1BfU09DS19PUl9OVUxMLAogUkVUX1BUUl9UT19TT0NLX0NPTU1PTl9PUl9OVUxMLAog
UkVUX1BUUl9UT19BTExPQ19NRU1fT1JfTlVMTCwKfTsKCgoKCgpzdHJ1Y3QgYnBmX2Z1bmNf
cHJvdG8gewogdTY0ICgqZnVuYykodTY0IHIxLCB1NjQgcjIsIHU2NCByMywgdTY0IHI0LCB1
NjQgcjUpOwogYm9vbCBncGxfb25seTsKIGJvb2wgcGt0X2FjY2VzczsKIGVudW0gYnBmX3Jl
dHVybl90eXBlIHJldF90eXBlOwogdW5pb24gewogIHN0cnVjdCB7CiAgIGVudW0gYnBmX2Fy
Z190eXBlIGFyZzFfdHlwZTsKICAgZW51bSBicGZfYXJnX3R5cGUgYXJnMl90eXBlOwogICBl
bnVtIGJwZl9hcmdfdHlwZSBhcmczX3R5cGU7CiAgIGVudW0gYnBmX2FyZ190eXBlIGFyZzRf
dHlwZTsKICAgZW51bSBicGZfYXJnX3R5cGUgYXJnNV90eXBlOwogIH07CiAgZW51bSBicGZf
YXJnX3R5cGUgYXJnX3R5cGVbNV07CiB9OwogaW50ICpidGZfaWQ7Cn07CgoKCgoKc3RydWN0
IGJwZl9jb250ZXh0OwoKZW51bSBicGZfYWNjZXNzX3R5cGUgewogQlBGX1JFQUQgPSAxLAog
QlBGX1dSSVRFID0gMgp9OwojIDMwOSAiLi9pbmNsdWRlL2xpbnV4L2JwZi5oIgplbnVtIGJw
Zl9yZWdfdHlwZSB7CiBOT1RfSU5JVCA9IDAsCiBTQ0FMQVJfVkFMVUUsCiBQVFJfVE9fQ1RY
LAogQ09OU1RfUFRSX1RPX01BUCwKIFBUUl9UT19NQVBfVkFMVUUsCiBQVFJfVE9fTUFQX1ZB
TFVFX09SX05VTEwsCiBQVFJfVE9fU1RBQ0ssCiBQVFJfVE9fUEFDS0VUX01FVEEsCiBQVFJf
VE9fUEFDS0VULAogUFRSX1RPX1BBQ0tFVF9FTkQsCiBQVFJfVE9fRkxPV19LRVlTLAogUFRS
X1RPX1NPQ0tFVCwKIFBUUl9UT19TT0NLRVRfT1JfTlVMTCwKIFBUUl9UT19TT0NLX0NPTU1P
TiwKIFBUUl9UT19TT0NLX0NPTU1PTl9PUl9OVUxMLAogUFRSX1RPX1RDUF9TT0NLLAogUFRS
X1RPX1RDUF9TT0NLX09SX05VTEwsCiBQVFJfVE9fVFBfQlVGRkVSLAogUFRSX1RPX1hEUF9T
T0NLLAogUFRSX1RPX0JURl9JRCwKIFBUUl9UT19CVEZfSURfT1JfTlVMTCwKIFBUUl9UT19N
RU0sCiBQVFJfVE9fTUVNX09SX05VTEwsCn07CgoKCgpzdHJ1Y3QgYnBmX2luc25fYWNjZXNz
X2F1eCB7CiBlbnVtIGJwZl9yZWdfdHlwZSByZWdfdHlwZTsKIHVuaW9uIHsKICBpbnQgY3R4
X2ZpZWxkX3NpemU7CiAgdTMyIGJ0Zl9pZDsKIH07CiBzdHJ1Y3QgYnBmX3ZlcmlmaWVyX2xv
ZyAqbG9nOwp9OwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQKYnBmX2N0eF9yZWNvcmRfZmllbGRfc2l6ZShz
dHJ1Y3QgYnBmX2luc25fYWNjZXNzX2F1eCAqYXV4LCB1MzIgc2l6ZSkKewogYXV4LT5jdHhf
ZmllbGRfc2l6ZSA9IHNpemU7Cn0KCnN0cnVjdCBicGZfcHJvZ19vcHMgewogaW50ICgqdGVz
dF9ydW4pKHN0cnVjdCBicGZfcHJvZyAqcHJvZywgY29uc3QgdW5pb24gYnBmX2F0dHIgKmth
dHRyLAogICB1bmlvbiBicGZfYXR0ciAqdWF0dHIpOwp9OwoKc3RydWN0IGJwZl92ZXJpZmll
cl9vcHMgewoKIGNvbnN0IHN0cnVjdCBicGZfZnVuY19wcm90byAqCiAoKmdldF9mdW5jX3By
b3RvKShlbnVtIGJwZl9mdW5jX2lkIGZ1bmNfaWQsCiAgICAgY29uc3Qgc3RydWN0IGJwZl9w
cm9nICpwcm9nKTsKCgoKCiBib29sICgqaXNfdmFsaWRfYWNjZXNzKShpbnQgb2ZmLCBpbnQg
c2l6ZSwgZW51bSBicGZfYWNjZXNzX3R5cGUgdHlwZSwKICAgIGNvbnN0IHN0cnVjdCBicGZf
cHJvZyAqcHJvZywKICAgIHN0cnVjdCBicGZfaW5zbl9hY2Nlc3NfYXV4ICppbmZvKTsKIGlu
dCAoKmdlbl9wcm9sb2d1ZSkoc3RydWN0IGJwZl9pbnNuICppbnNuLCBib29sIGRpcmVjdF93
cml0ZSwKICAgICAgIGNvbnN0IHN0cnVjdCBicGZfcHJvZyAqcHJvZyk7CiBpbnQgKCpnZW5f
bGRfYWJzKShjb25zdCBzdHJ1Y3QgYnBmX2luc24gKm9yaWcsCiAgICAgc3RydWN0IGJwZl9p
bnNuICppbnNuX2J1Zik7CiB1MzIgKCpjb252ZXJ0X2N0eF9hY2Nlc3MpKGVudW0gYnBmX2Fj
Y2Vzc190eXBlIHR5cGUsCiAgICAgIGNvbnN0IHN0cnVjdCBicGZfaW5zbiAqc3JjLAogICAg
ICBzdHJ1Y3QgYnBmX2luc24gKmRzdCwKICAgICAgc3RydWN0IGJwZl9wcm9nICpwcm9nLCB1
MzIgKnRhcmdldF9zaXplKTsKIGludCAoKmJ0Zl9zdHJ1Y3RfYWNjZXNzKShzdHJ1Y3QgYnBm
X3ZlcmlmaWVyX2xvZyAqbG9nLAogICAgIGNvbnN0IHN0cnVjdCBidGZfdHlwZSAqdCwgaW50
IG9mZiwgaW50IHNpemUsCiAgICAgZW51bSBicGZfYWNjZXNzX3R5cGUgYXR5cGUsCiAgICAg
dTMyICpuZXh0X2J0Zl9pZCk7Cn07CgpzdHJ1Y3QgYnBmX3Byb2dfb2ZmbG9hZF9vcHMgewoK
IGludCAoKmluc25faG9vaykoc3RydWN0IGJwZl92ZXJpZmllcl9lbnYgKmVudiwKICAgIGlu
dCBpbnNuX2lkeCwgaW50IHByZXZfaW5zbl9pZHgpOwogaW50ICgqZmluYWxpemUpKHN0cnVj
dCBicGZfdmVyaWZpZXJfZW52ICplbnYpOwoKIGludCAoKnJlcGxhY2VfaW5zbikoc3RydWN0
IGJwZl92ZXJpZmllcl9lbnYgKmVudiwgdTMyIG9mZiwKICAgICAgIHN0cnVjdCBicGZfaW5z
biAqaW5zbik7CiBpbnQgKCpyZW1vdmVfaW5zbnMpKHN0cnVjdCBicGZfdmVyaWZpZXJfZW52
ICplbnYsIHUzMiBvZmYsIHUzMiBjbnQpOwoKIGludCAoKnByZXBhcmUpKHN0cnVjdCBicGZf
cHJvZyAqcHJvZyk7CiBpbnQgKCp0cmFuc2xhdGUpKHN0cnVjdCBicGZfcHJvZyAqcHJvZyk7
CiB2b2lkICgqZGVzdHJveSkoc3RydWN0IGJwZl9wcm9nICpwcm9nKTsKfTsKCnN0cnVjdCBi
cGZfcHJvZ19vZmZsb2FkIHsKIHN0cnVjdCBicGZfcHJvZyAqcHJvZzsKIHN0cnVjdCBuZXRf
ZGV2aWNlICpuZXRkZXY7CiBzdHJ1Y3QgYnBmX29mZmxvYWRfZGV2ICpvZmZkZXY7CiB2b2lk
ICpkZXZfcHJpdjsKIHN0cnVjdCBsaXN0X2hlYWQgb2ZmbG9hZHM7CiBib29sIGRldl9zdGF0
ZTsKIGJvb2wgb3B0X2ZhaWxlZDsKIHZvaWQgKmppdGVkX2ltYWdlOwogdTMyIGppdGVkX2xl
bjsKfTsKCmVudW0gYnBmX2Nncm91cF9zdG9yYWdlX3R5cGUgewogQlBGX0NHUk9VUF9TVE9S
QUdFX1NIQVJFRCwKIEJQRl9DR1JPVVBfU1RPUkFHRV9QRVJDUFUsCiBfX0JQRl9DR1JPVVBf
U1RPUkFHRV9NQVgKfTsKIyA0MjQgIi4vaW5jbHVkZS9saW51eC9icGYuaCIKc3RydWN0IGJw
Zl9wcm9nX3N0YXRzIHsKIHU2NCBjbnQ7CiB1NjQgbnNlY3M7CiBzdHJ1Y3QgdTY0X3N0YXRz
X3N5bmMgc3luY3A7Cn0gX19hdHRyaWJ1dGVfXygoX19hbGlnbmVkX18oMiAqIHNpemVvZih1
NjQpKSkpOwoKc3RydWN0IGJ0Zl9mdW5jX21vZGVsIHsKIHU4IHJldF9zaXplOwogdTggbnJf
YXJnczsKIHU4IGFyZ19zaXplWzEyXTsKfTsKIyA0NTUgIi4vaW5jbHVkZS9saW51eC9icGYu
aCIKc3RydWN0IGJwZl90cmFtcF9wcm9ncyB7CiBzdHJ1Y3QgYnBmX3Byb2cgKnByb2dzWzQw
XTsKIGludCBucl9wcm9nczsKfTsKIyA0ODAgIi4vaW5jbHVkZS9saW51eC9icGYuaCIKaW50
IGFyY2hfcHJlcGFyZV9icGZfdHJhbXBvbGluZSh2b2lkICppbWFnZSwgdm9pZCAqaW1hZ2Vf
ZW5kLAogICAgY29uc3Qgc3RydWN0IGJ0Zl9mdW5jX21vZGVsICptLCB1MzIgZmxhZ3MsCiAg
ICBzdHJ1Y3QgYnBmX3RyYW1wX3Byb2dzICp0cHJvZ3MsCiAgICB2b2lkICpvcmlnX2NhbGwp
OwoKdTY0IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19i
cGZfcHJvZ19lbnRlcih2b2lkKTsKdm9pZCBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIF9fYnBmX3Byb2dfZXhpdChzdHJ1Y3QgYnBmX3Byb2cgKnByb2cs
IHU2NCBzdGFydCk7CgpzdHJ1Y3QgYnBmX2tzeW0gewogdW5zaWduZWQgbG9uZyBzdGFydDsK
IHVuc2lnbmVkIGxvbmcgZW5kOwogY2hhciBuYW1lWzEyOF07CiBzdHJ1Y3QgbGlzdF9oZWFk
IGxub2RlOwogc3RydWN0IGxhdGNoX3RyZWVfbm9kZSB0bm9kZTsKIGJvb2wgcHJvZzsKfTsK
CmVudW0gYnBmX3RyYW1wX3Byb2dfdHlwZSB7CiBCUEZfVFJBTVBfRkVOVFJZLAogQlBGX1RS
QU1QX0ZFWElULAogQlBGX1RSQU1QX01PRElGWV9SRVRVUk4sCiBCUEZfVFJBTVBfTUFYLAog
QlBGX1RSQU1QX1JFUExBQ0UsCn07CgpzdHJ1Y3QgYnBmX3RyYW1wb2xpbmUgewoKIHN0cnVj
dCBobGlzdF9ub2RlIGhsaXN0OwoKIHN0cnVjdCBtdXRleCBtdXRleDsKIHJlZmNvdW50X3Qg
cmVmY250OwogdTY0IGtleTsKIHN0cnVjdCB7CiAgc3RydWN0IGJ0Zl9mdW5jX21vZGVsIG1v
ZGVsOwogIHZvaWQgKmFkZHI7CiAgYm9vbCBmdHJhY2VfbWFuYWdlZDsKIH0gZnVuYzsKCgoK
CiBzdHJ1Y3QgYnBmX3Byb2cgKmV4dGVuc2lvbl9wcm9nOwoKIHN0cnVjdCBobGlzdF9oZWFk
IHByb2dzX2hsaXN0W0JQRl9UUkFNUF9NQVhdOwoKIGludCBwcm9nc19jbnRbQlBGX1RSQU1Q
X01BWF07Cgogdm9pZCAqaW1hZ2U7CiB1NjQgc2VsZWN0b3I7CiBzdHJ1Y3QgYnBmX2tzeW0g
a3N5bTsKfTsKCgoKc3RydWN0IGJwZl9kaXNwYXRjaGVyX3Byb2cgewogc3RydWN0IGJwZl9w
cm9nICpwcm9nOwogcmVmY291bnRfdCB1c2VyczsKfTsKCnN0cnVjdCBicGZfZGlzcGF0Y2hl
ciB7Cgogc3RydWN0IG11dGV4IG11dGV4Owogdm9pZCAqZnVuYzsKIHN0cnVjdCBicGZfZGlz
cGF0Y2hlcl9wcm9nIHByb2dzWzQ4XTsKIGludCBudW1fcHJvZ3M7CiB2b2lkICppbWFnZTsK
IHUzMiBpbWFnZV9vZmY7CiBzdHJ1Y3QgYnBmX2tzeW0ga3N5bTsKfTsKCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBf
X2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHVuc2lnbmVkIGludCBicGZfZGlz
cGF0Y2hlcl9ub3BfZnVuYygKIGNvbnN0IHZvaWQgKmN0eCwKIGNvbnN0IHN0cnVjdCBicGZf
aW5zbiAqaW5zbnNpLAogdW5zaWduZWQgaW50ICgqYnBmX2Z1bmMpKGNvbnN0IHZvaWQgKiwK
ICAgICBjb25zdCBzdHJ1Y3QgYnBmX2luc24gKikpCnsKIHJldHVybiBicGZfZnVuYyhjdHgs
IGluc25zaSk7Cn0KIyA2MDYgIi4vaW5jbHVkZS9saW51eC9icGYuaCIKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHN0
cnVjdCBicGZfdHJhbXBvbGluZSAqYnBmX3RyYW1wb2xpbmVfbG9va3VwKHU2NCBrZXkpCnsK
IHJldHVybiAoKHZvaWQgKikwKTsKfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGJwZl90cmFtcG9saW5lX2xp
bmtfcHJvZyhzdHJ1Y3QgYnBmX3Byb2cgKnByb2cpCnsKIHJldHVybiAtNTI0Owp9CnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBpbnQgYnBmX3RyYW1wb2xpbmVfdW5saW5rX3Byb2coc3RydWN0IGJwZl9wcm9nICpw
cm9nKQp7CiByZXR1cm4gLTUyNDsKfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBicGZfdHJhbXBvbGluZV9w
dXQoc3RydWN0IGJwZl90cmFtcG9saW5lICp0cikge30KCgoKCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGJw
Zl9kaXNwYXRjaGVyX2NoYW5nZV9wcm9nKHN0cnVjdCBicGZfZGlzcGF0Y2hlciAqZCwKICAg
ICAgICAgICBzdHJ1Y3QgYnBmX3Byb2cgKmZyb20sCiAgICAgICAgICAgc3RydWN0IGJwZl9w
cm9nICp0bykge30Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgaXNfYnBmX2ltYWdlX2FkZHJlc3ModW5zaWdu
ZWQgbG9uZyBhZGRyZXNzKQp7CiByZXR1cm4gZmFsc2U7Cn0KCgpzdHJ1Y3QgYnBmX2Z1bmNf
aW5mb19hdXggewogdTE2IGxpbmthZ2U7CiBib29sIHVucmVsaWFibGU7Cn07CgplbnVtIGJw
Zl9qaXRfcG9rZV9yZWFzb24gewogQlBGX1BPS0VfUkVBU09OX1RBSUxfQ0FMTCwKfTsKCgpz
dHJ1Y3QgYnBmX2ppdF9wb2tlX2Rlc2NyaXB0b3Igewogdm9pZCAqaXA7CiB1bmlvbiB7CiAg
c3RydWN0IHsKICAgc3RydWN0IGJwZl9tYXAgKm1hcDsKICAgdTMyIGtleTsKICB9IHRhaWxf
Y2FsbDsKIH07CiBib29sIGlwX3N0YWJsZTsKIHU4IGFkal9vZmY7CiB1MTYgcmVhc29uOwp9
OwoKCnN0cnVjdCBicGZfY3R4X2FyZ19hdXggewogdTMyIG9mZnNldDsKIGVudW0gYnBmX3Jl
Z190eXBlIHJlZ190eXBlOwp9OwoKc3RydWN0IGJwZl9wcm9nX2F1eCB7CiBhdG9taWM2NF90
IHJlZmNudDsKIHUzMiB1c2VkX21hcF9jbnQ7CiB1MzIgbWF4X2N0eF9vZmZzZXQ7CiB1MzIg
bWF4X3BrdF9vZmZzZXQ7CiB1MzIgbWF4X3RwX2FjY2VzczsKIHUzMiBzdGFja19kZXB0aDsK
IHUzMiBpZDsKIHUzMiBmdW5jX2NudDsKIHUzMiBmdW5jX2lkeDsKIHUzMiBhdHRhY2hfYnRm
X2lkOwogdTMyIGN0eF9hcmdfaW5mb19zaXplOwogY29uc3Qgc3RydWN0IGJwZl9jdHhfYXJn
X2F1eCAqY3R4X2FyZ19pbmZvOwogc3RydWN0IGJwZl9wcm9nICpsaW5rZWRfcHJvZzsKIGJv
b2wgdmVyaWZpZXJfemV4dDsKIGJvb2wgb2ZmbG9hZF9yZXF1ZXN0ZWQ7CiBib29sIGF0dGFj
aF9idGZfdHJhY2U7CiBib29sIGZ1bmNfcHJvdG9fdW5yZWxpYWJsZTsKIGVudW0gYnBmX3Ry
YW1wX3Byb2dfdHlwZSB0cmFtcG9saW5lX3Byb2dfdHlwZTsKIHN0cnVjdCBicGZfdHJhbXBv
bGluZSAqdHJhbXBvbGluZTsKIHN0cnVjdCBobGlzdF9ub2RlIHRyYW1wX2hsaXN0OwoKIGNv
bnN0IHN0cnVjdCBidGZfdHlwZSAqYXR0YWNoX2Z1bmNfcHJvdG87CgogY29uc3QgY2hhciAq
YXR0YWNoX2Z1bmNfbmFtZTsKIHN0cnVjdCBicGZfcHJvZyAqKmZ1bmM7CiB2b2lkICpqaXRf
ZGF0YTsKIHN0cnVjdCBicGZfaml0X3Bva2VfZGVzY3JpcHRvciAqcG9rZV90YWI7CiB1MzIg
c2l6ZV9wb2tlX3RhYjsKIHN0cnVjdCBicGZfa3N5bSBrc3ltOwogY29uc3Qgc3RydWN0IGJw
Zl9wcm9nX29wcyAqb3BzOwogc3RydWN0IGJwZl9tYXAgKip1c2VkX21hcHM7CiBzdHJ1Y3Qg
YnBmX3Byb2cgKnByb2c7CiBzdHJ1Y3QgdXNlcl9zdHJ1Y3QgKnVzZXI7CiB1NjQgbG9hZF90
aW1lOwogc3RydWN0IGJwZl9tYXAgKmNncm91cF9zdG9yYWdlW19fQlBGX0NHUk9VUF9TVE9S
QUdFX01BWF07CiBjaGFyIG5hbWVbMTZVXTsKCgoKIHN0cnVjdCBicGZfcHJvZ19vZmZsb2Fk
ICpvZmZsb2FkOwogc3RydWN0IGJ0ZiAqYnRmOwogc3RydWN0IGJwZl9mdW5jX2luZm8gKmZ1
bmNfaW5mbzsKIHN0cnVjdCBicGZfZnVuY19pbmZvX2F1eCAqZnVuY19pbmZvX2F1eDsKCgoK
CgoKIHN0cnVjdCBicGZfbGluZV9pbmZvICpsaW5mbzsKCgoKCgoKCiB2b2lkICoqaml0ZWRf
bGluZm87CiB1MzIgZnVuY19pbmZvX2NudDsKIHUzMiBucl9saW5mbzsKCgoKCiB1MzIgbGlu
Zm9faWR4OwogdTMyIG51bV9leGVudHJpZXM7CiBzdHJ1Y3QgZXhjZXB0aW9uX3RhYmxlX2Vu
dHJ5ICpleHRhYmxlOwogc3RydWN0IGJwZl9wcm9nX3N0YXRzICpzdGF0czsKIHVuaW9uIHsK
ICBzdHJ1Y3Qgd29ya19zdHJ1Y3Qgd29yazsKICBzdHJ1Y3QgY2FsbGJhY2tfaGVhZCByY3U7
CiB9Owp9OwoKc3RydWN0IGJwZl9hcnJheV9hdXggewoKCgoKCiBlbnVtIGJwZl9wcm9nX3R5
cGUgdHlwZTsKIGJvb2wgaml0ZWQ7Cgogc3RydWN0IGxpc3RfaGVhZCBwb2tlX3Byb2dzOwog
c3RydWN0IGJwZl9tYXAgKm1hcDsKIHN0cnVjdCBtdXRleCBwb2tlX211dGV4Owogc3RydWN0
IHdvcmtfc3RydWN0IHdvcms7Cn07CgpzdHJ1Y3QgYnBmX3N0cnVjdF9vcHNfdmFsdWU7CnN0
cnVjdCBidGZfdHlwZTsKc3RydWN0IGJ0Zl9tZW1iZXI7CgoKc3RydWN0IGJwZl9zdHJ1Y3Rf
b3BzIHsKIGNvbnN0IHN0cnVjdCBicGZfdmVyaWZpZXJfb3BzICp2ZXJpZmllcl9vcHM7CiBp
bnQgKCppbml0KShzdHJ1Y3QgYnRmICpidGYpOwogaW50ICgqY2hlY2tfbWVtYmVyKShjb25z
dCBzdHJ1Y3QgYnRmX3R5cGUgKnQsCiAgICAgICBjb25zdCBzdHJ1Y3QgYnRmX21lbWJlciAq
bWVtYmVyKTsKIGludCAoKmluaXRfbWVtYmVyKShjb25zdCBzdHJ1Y3QgYnRmX3R5cGUgKnQs
CiAgICAgIGNvbnN0IHN0cnVjdCBidGZfbWVtYmVyICptZW1iZXIsCiAgICAgIHZvaWQgKmtk
YXRhLCBjb25zdCB2b2lkICp1ZGF0YSk7CiBpbnQgKCpyZWcpKHZvaWQgKmtkYXRhKTsKIHZv
aWQgKCp1bnJlZykodm9pZCAqa2RhdGEpOwogY29uc3Qgc3RydWN0IGJ0Zl90eXBlICp0eXBl
OwogY29uc3Qgc3RydWN0IGJ0Zl90eXBlICp2YWx1ZV90eXBlOwogY29uc3QgY2hhciAqbmFt
ZTsKIHN0cnVjdCBidGZfZnVuY19tb2RlbCBmdW5jX21vZGVsc1s2NF07CiB1MzIgdHlwZV9p
ZDsKIHUzMiB2YWx1ZV9pZDsKfTsKIyA3OTcgIi4vaW5jbHVkZS9saW51eC9icGYuaCIKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIGNvbnN0IHN0cnVjdCBicGZfc3RydWN0X29wcyAqYnBmX3N0cnVjdF9vcHNfZmlu
ZCh1MzIgdHlwZV9pZCkKewogcmV0dXJuICgodm9pZCAqKTApOwp9CnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lk
IGJwZl9zdHJ1Y3Rfb3BzX2luaXQoc3RydWN0IGJ0ZiAqYnRmLAogICAgICAgICAgIHN0cnVj
dCBicGZfdmVyaWZpZXJfbG9nICpsb2cpCnsKfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBicGZfdHJ5X21v
ZHVsZV9nZXQoY29uc3Qgdm9pZCAqZGF0YSwgc3RydWN0IG1vZHVsZSAqb3duZXIpCnsKIHJl
dHVybiB0cnlfbW9kdWxlX2dldChvd25lcik7Cn0Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgYnBmX21vZHVs
ZV9wdXQoY29uc3Qgdm9pZCAqZGF0YSwgc3RydWN0IG1vZHVsZSAqb3duZXIpCnsKIG1vZHVs
ZV9wdXQob3duZXIpOwp9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgYnBmX3N0cnVjdF9vcHNfbWFwX3N5c19s
b29rdXBfZWxlbShzdHJ1Y3QgYnBmX21hcCAqbWFwLAogICAgICAgICAgIHZvaWQgKmtleSwK
ICAgICAgICAgICB2b2lkICp2YWx1ZSkKewogcmV0dXJuIC0yMjsKfQoKCnN0cnVjdCBicGZf
YXJyYXkgewogc3RydWN0IGJwZl9tYXAgbWFwOwogdTMyIGVsZW1fc2l6ZTsKIHUzMiBpbmRl
eF9tYXNrOwogc3RydWN0IGJwZl9hcnJheV9hdXggKmF1eDsKIHVuaW9uIHsKICBjaGFyIHZh
bHVlWzBdIF9fYXR0cmlidXRlX18oKF9fYWxpZ25lZF9fKDgpKSk7CiAgdm9pZCAqcHRyc1sw
XSBfX2F0dHJpYnV0ZV9fKChfX2FsaWduZWRfXyg4KSkpOwogIHZvaWQgKnBwdHJzWzBdIF9f
YXR0cmlidXRlX18oKF9fYWxpZ25lZF9fKDgpKSk7CiB9Owp9OwojIDg0NCAiLi9pbmNsdWRl
L2xpbnV4L2JwZi5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdTMyIGJwZl9tYXBfZmxhZ3NfdG9fY2FwKHN0cnVj
dCBicGZfbWFwICptYXApCnsKIHUzMiBhY2Nlc3NfZmxhZ3MgPSBtYXAtPm1hcF9mbGFncyAm
IChCUEZfRl9SRE9OTFlfUFJPRyB8IEJQRl9GX1dST05MWV9QUk9HKTsKCgoKCiBpZiAoYWNj
ZXNzX2ZsYWdzICYgQlBGX0ZfUkRPTkxZX1BST0cpCiAgcmV0dXJuICgoKCgxVUwpKSkgPDwg
KDApKTsKIGVsc2UgaWYgKGFjY2Vzc19mbGFncyAmIEJQRl9GX1dST05MWV9QUk9HKQogIHJl
dHVybiAoKCgoMVVMKSkpIDw8ICgxKSk7CiBlbHNlCiAgcmV0dXJuICgoKCgxVUwpKSkgPDwg
KDApKSB8ICgoKCgxVUwpKSkgPDwgKDEpKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgYnBmX21hcF9m
bGFnc19hY2Nlc3Nfb2sodTMyIGFjY2Vzc19mbGFncykKewogcmV0dXJuIChhY2Nlc3NfZmxh
Z3MgJiAoQlBGX0ZfUkRPTkxZX1BST0cgfCBCUEZfRl9XUk9OTFlfUFJPRykpICE9CiAgICAg
ICAgKEJQRl9GX1JET05MWV9QUk9HIHwgQlBGX0ZfV1JPTkxZX1BST0cpOwp9CgpzdHJ1Y3Qg
YnBmX2V2ZW50X2VudHJ5IHsKIHN0cnVjdCBwZXJmX2V2ZW50ICpldmVudDsKIHN0cnVjdCBm
aWxlICpwZXJmX2ZpbGU7CiBzdHJ1Y3QgZmlsZSAqbWFwX2ZpbGU7CiBzdHJ1Y3QgY2FsbGJh
Y2tfaGVhZCByY3U7Cn07Cgpib29sIGJwZl9wcm9nX2FycmF5X2NvbXBhdGlibGUoc3RydWN0
IGJwZl9hcnJheSAqYXJyYXksIGNvbnN0IHN0cnVjdCBicGZfcHJvZyAqZnApOwppbnQgYnBm
X3Byb2dfY2FsY190YWcoc3RydWN0IGJwZl9wcm9nICpmcCk7CmNvbnN0IGNoYXIgKmtlcm5l
bF90eXBlX25hbWUodTMyIGJ0Zl90eXBlX2lkKTsKCmNvbnN0IHN0cnVjdCBicGZfZnVuY19w
cm90byAqYnBmX2dldF90cmFjZV9wcmludGtfcHJvdG8odm9pZCk7Cgp0eXBlZGVmIHVuc2ln
bmVkIGxvbmcgKCpicGZfY3R4X2NvcHlfdCkodm9pZCAqZHN0LCBjb25zdCB2b2lkICpzcmMs
CiAgICAgdW5zaWduZWQgbG9uZyBvZmYsIHVuc2lnbmVkIGxvbmcgbGVuKTsKdHlwZWRlZiB1
MzIgKCpicGZfY29udmVydF9jdHhfYWNjZXNzX3QpKGVudW0gYnBmX2FjY2Vzc190eXBlIHR5
cGUsCiAgICAgY29uc3Qgc3RydWN0IGJwZl9pbnNuICpzcmMsCiAgICAgc3RydWN0IGJwZl9p
bnNuICpkc3QsCiAgICAgc3RydWN0IGJwZl9wcm9nICpwcm9nLAogICAgIHUzMiAqdGFyZ2V0
X3NpemUpOwoKdTY0IGJwZl9ldmVudF9vdXRwdXQoc3RydWN0IGJwZl9tYXAgKm1hcCwgdTY0
IGZsYWdzLCB2b2lkICptZXRhLCB1NjQgbWV0YV9zaXplLAogICAgICAgdm9pZCAqY3R4LCB1
NjQgY3R4X3NpemUsIGJwZl9jdHhfY29weV90IGN0eF9jb3B5KTsKIyA5MDEgIi4vaW5jbHVk
ZS9saW51eC9icGYuaCIKc3RydWN0IGJwZl9wcm9nX2FycmF5X2l0ZW0gewogc3RydWN0IGJw
Zl9wcm9nICpwcm9nOwogc3RydWN0IGJwZl9jZ3JvdXBfc3RvcmFnZSAqY2dyb3VwX3N0b3Jh
Z2VbX19CUEZfQ0dST1VQX1NUT1JBR0VfTUFYXTsKfTsKCnN0cnVjdCBicGZfcHJvZ19hcnJh
eSB7CiBzdHJ1Y3QgY2FsbGJhY2tfaGVhZCByY3U7CiBzdHJ1Y3QgYnBmX3Byb2dfYXJyYXlf
aXRlbSBpdGVtc1tdOwp9OwoKc3RydWN0IGJwZl9wcm9nX2FycmF5ICpicGZfcHJvZ19hcnJh
eV9hbGxvYyh1MzIgcHJvZ19jbnQsIGdmcF90IGZsYWdzKTsKdm9pZCBicGZfcHJvZ19hcnJh
eV9mcmVlKHN0cnVjdCBicGZfcHJvZ19hcnJheSAqcHJvZ3MpOwppbnQgYnBmX3Byb2dfYXJy
YXlfbGVuZ3RoKHN0cnVjdCBicGZfcHJvZ19hcnJheSAqcHJvZ3MpOwpib29sIGJwZl9wcm9n
X2FycmF5X2lzX2VtcHR5KHN0cnVjdCBicGZfcHJvZ19hcnJheSAqYXJyYXkpOwppbnQgYnBm
X3Byb2dfYXJyYXlfY29weV90b191c2VyKHN0cnVjdCBicGZfcHJvZ19hcnJheSAqcHJvZ3Ms
CiAgICBfX3UzMiAqcHJvZ19pZHMsIHUzMiBjbnQpOwoKdm9pZCBicGZfcHJvZ19hcnJheV9k
ZWxldGVfc2FmZShzdHJ1Y3QgYnBmX3Byb2dfYXJyYXkgKnByb2dzLAogICAgc3RydWN0IGJw
Zl9wcm9nICpvbGRfcHJvZyk7CmludCBicGZfcHJvZ19hcnJheV9jb3B5X2luZm8oc3RydWN0
IGJwZl9wcm9nX2FycmF5ICphcnJheSwKICAgICAgICB1MzIgKnByb2dfaWRzLCB1MzIgcmVx
dWVzdF9jbnQsCiAgICAgICAgdTMyICpwcm9nX2NudCk7CmludCBicGZfcHJvZ19hcnJheV9j
b3B5KHN0cnVjdCBicGZfcHJvZ19hcnJheSAqb2xkX2FycmF5LAogICBzdHJ1Y3QgYnBmX3By
b2cgKmV4Y2x1ZGVfcHJvZywKICAgc3RydWN0IGJwZl9wcm9nICppbmNsdWRlX3Byb2csCiAg
IHN0cnVjdCBicGZfcHJvZ19hcnJheSAqKm5ld19hcnJheSk7CiMgMTMwOCAiLi9pbmNsdWRl
L2xpbnV4L2JwZi5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IGJwZl9wcm9nICpicGZfcHJvZ19nZXQo
dTMyIHVmZCkKewogcmV0dXJuIEVSUl9QVFIoLTk1KTsKfQoKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHN0cnVjdCBi
cGZfcHJvZyAqYnBmX3Byb2dfZ2V0X3R5cGVfZGV2KHUzMiB1ZmQsCiAgICAgICAgICAgZW51
bSBicGZfcHJvZ190eXBlIHR5cGUsCiAgICAgICAgICAgYm9vbCBhdHRhY2hfZHJ2KQp7CiBy
ZXR1cm4gRVJSX1BUUigtOTUpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBicGZfcHJvZ19hZGQoc3Ry
dWN0IGJwZl9wcm9nICpwcm9nLCBpbnQgaSkKewp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBicGZfcHJv
Z19zdWIoc3RydWN0IGJwZl9wcm9nICpwcm9nLCBpbnQgaSkKewp9CgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9p
ZCBicGZfcHJvZ19wdXQoc3RydWN0IGJwZl9wcm9nICpwcm9nKQp7Cn0KCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2
b2lkIGJwZl9wcm9nX2luYyhzdHJ1Y3QgYnBmX3Byb2cgKnByb2cpCnsKfQoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IHN0cnVjdCBicGZfcHJvZyAqX19hdHRyaWJ1dGVfXygoX193YXJuX3VudXNlZF9yZXN1bHRf
XykpCmJwZl9wcm9nX2luY19ub3RfemVybyhzdHJ1Y3QgYnBmX3Byb2cgKnByb2cpCnsKIHJl
dHVybiBFUlJfUFRSKC05NSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgX19icGZfcHJvZ19jaGFyZ2Uo
c3RydWN0IHVzZXJfc3RydWN0ICp1c2VyLCB1MzIgcGFnZXMpCnsKIHJldHVybiAwOwp9Cgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgdm9pZCBfX2JwZl9wcm9nX3VuY2hhcmdlKHN0cnVjdCB1c2VyX3N0cnVjdCAq
dXNlciwgdTMyIHBhZ2VzKQp7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgYnBmX29ial9nZXRfdXNlcihj
b25zdCBjaGFyICpwYXRobmFtZSwgaW50IGZsYWdzKQp7CiByZXR1cm4gLTk1Owp9CgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgc3RydWN0IG5ldF9kZXZpY2UgKl9fZGV2X21hcF9sb29rdXBfZWxlbShzdHJ1Y3Qg
YnBmX21hcCAqbWFwLAogICAgICAgICAgICAgdTMyIGtleSkKewogcmV0dXJuICgodm9pZCAq
KTApOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IG5ldF9kZXZpY2UgKl9fZGV2X21hcF9oYXNoX2xv
b2t1cF9lbGVtKHN0cnVjdCBicGZfbWFwICptYXAsCiAgICAgICAgICAgIHUzMiBrZXkpCnsK
IHJldHVybiAoKHZvaWQgKikwKTsKfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBkZXZfbWFwX2Nhbl9oYXZl
X3Byb2coc3RydWN0IGJwZl9tYXAgKm1hcCkKewogcmV0dXJuIGZhbHNlOwp9CgpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgdm9pZCBfX2Rldl9mbHVzaCh2b2lkKQp7Cn0KCnN0cnVjdCB4ZHBfYnVmZjsKc3RydWN0
IGJwZl9kdGFiX25ldGRldjsKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKQppbnQgZGV2X3hkcF9lbnF1ZXVlKHN0cnVj
dCBuZXRfZGV2aWNlICpkZXYsIHN0cnVjdCB4ZHBfYnVmZiAqeGRwLAogICAgICBzdHJ1Y3Qg
bmV0X2RldmljZSAqZGV2X3J4KQp7CiByZXR1cm4gMDsKfQoKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpCmludCBkZXZf
bWFwX2VucXVldWUoc3RydWN0IGJwZl9kdGFiX25ldGRldiAqZHN0LCBzdHJ1Y3QgeGRwX2J1
ZmYgKnhkcCwKICAgICAgc3RydWN0IG5ldF9kZXZpY2UgKmRldl9yeCkKewogcmV0dXJuIDA7
Cn0KCnN0cnVjdCBza19idWZmOwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBkZXZfbWFwX2dlbmVyaWNfcmVk
aXJlY3Qoc3RydWN0IGJwZl9kdGFiX25ldGRldiAqZHN0LAogICAgICAgIHN0cnVjdCBza19i
dWZmICpza2IsCiAgICAgICAgc3RydWN0IGJwZl9wcm9nICp4ZHBfcHJvZykKewogcmV0dXJu
IDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKQpzdHJ1Y3QgYnBmX2NwdV9tYXBfZW50cnkgKl9fY3B1X21hcF9s
b29rdXBfZWxlbShzdHJ1Y3QgYnBmX21hcCAqbWFwLCB1MzIga2V5KQp7CiByZXR1cm4gKCh2
b2lkICopMCk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIF9fY3B1X21hcF9mbHVzaCh2b2lkKQp7Cn0K
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSBpbnQgY3B1X21hcF9lbnF1ZXVlKHN0cnVjdCBicGZfY3B1X21hcF9lbnRy
eSAqcmNwdSwKICAgICAgc3RydWN0IHhkcF9idWZmICp4ZHAsCiAgICAgIHN0cnVjdCBuZXRf
ZGV2aWNlICpkZXZfcngpCnsKIHJldHVybiAwOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IGJwZl9w
cm9nICpicGZfcHJvZ19nZXRfdHlwZV9wYXRoKGNvbnN0IGNoYXIgKm5hbWUsCiAgICBlbnVt
IGJwZl9wcm9nX3R5cGUgdHlwZSkKewogcmV0dXJuIEVSUl9QVFIoLTk1KTsKfQoKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIGludCBicGZfcHJvZ190ZXN0X3J1bl94ZHAoc3RydWN0IGJwZl9wcm9nICpwcm9nLAog
ICAgIGNvbnN0IHVuaW9uIGJwZl9hdHRyICprYXR0ciwKICAgICB1bmlvbiBicGZfYXR0ciAq
dWF0dHIpCnsKIHJldHVybiAtNTI0Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGJwZl9wcm9nX3Rlc3Rf
cnVuX3NrYihzdHJ1Y3QgYnBmX3Byb2cgKnByb2csCiAgICAgY29uc3QgdW5pb24gYnBmX2F0
dHIgKmthdHRyLAogICAgIHVuaW9uIGJwZl9hdHRyICp1YXR0cikKewogcmV0dXJuIC01MjQ7
Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSBpbnQgYnBmX3Byb2dfdGVzdF9ydW5fdHJhY2luZyhzdHJ1Y3QgYnBm
X3Byb2cgKnByb2csCiAgICAgICAgIGNvbnN0IHVuaW9uIGJwZl9hdHRyICprYXR0ciwKICAg
ICAgICAgdW5pb24gYnBmX2F0dHIgKnVhdHRyKQp7CiByZXR1cm4gLTUyNDsKfQoKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIGludCBicGZfcHJvZ190ZXN0X3J1bl9mbG93X2Rpc3NlY3RvcihzdHJ1Y3QgYnBmX3By
b2cgKnByb2csCiAgICAgICAgIGNvbnN0IHVuaW9uIGJwZl9hdHRyICprYXR0ciwKICAgICAg
ICAgdW5pb24gYnBmX2F0dHIgKnVhdHRyKQp7CiByZXR1cm4gLTUyNDsKfQoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IHZvaWQgYnBmX21hcF9wdXQoc3RydWN0IGJwZl9tYXAgKm1hcCkKewp9CgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
c3RydWN0IGJwZl9wcm9nICpicGZfcHJvZ19ieV9pZCh1MzIgaWQpCnsKIHJldHVybiBFUlJf
UFRSKC01MjQpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgY29uc3Qgc3RydWN0IGJwZl9mdW5jX3Byb3RvICoK
YnBmX2Jhc2VfZnVuY19wcm90byhlbnVtIGJwZl9mdW5jX2lkIGZ1bmNfaWQpCnsKIHJldHVy
biAoKHZvaWQgKikwKTsKfQoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3QgYnBmX3Byb2cgKmJwZl9wcm9n
X2dldF90eXBlKHUzMiB1ZmQsCiAgICAgICBlbnVtIGJwZl9wcm9nX3R5cGUgdHlwZSkKewog
cmV0dXJuIGJwZl9wcm9nX2dldF90eXBlX2Rldih1ZmQsIHR5cGUsIGZhbHNlKTsKfQoKYm9v
bCBicGZfcHJvZ19nZXRfb2soc3RydWN0IGJwZl9wcm9nICosIGVudW0gYnBmX3Byb2dfdHlw
ZSAqLCBib29sKTsKCmludCBicGZfcHJvZ19vZmZsb2FkX2NvbXBpbGUoc3RydWN0IGJwZl9w
cm9nICpwcm9nKTsKdm9pZCBicGZfcHJvZ19vZmZsb2FkX2Rlc3Ryb3koc3RydWN0IGJwZl9w
cm9nICpwcm9nKTsKaW50IGJwZl9wcm9nX29mZmxvYWRfaW5mb19maWxsKHN0cnVjdCBicGZf
cHJvZ19pbmZvICppbmZvLAogICAgICAgICAgc3RydWN0IGJwZl9wcm9nICpwcm9nKTsKCmlu
dCBicGZfbWFwX29mZmxvYWRfaW5mb19maWxsKHN0cnVjdCBicGZfbWFwX2luZm8gKmluZm8s
IHN0cnVjdCBicGZfbWFwICptYXApOwoKaW50IGJwZl9tYXBfb2ZmbG9hZF9sb29rdXBfZWxl
bShzdHJ1Y3QgYnBmX21hcCAqbWFwLCB2b2lkICprZXksIHZvaWQgKnZhbHVlKTsKaW50IGJw
Zl9tYXBfb2ZmbG9hZF91cGRhdGVfZWxlbShzdHJ1Y3QgYnBmX21hcCAqbWFwLAogICAgdm9p
ZCAqa2V5LCB2b2lkICp2YWx1ZSwgdTY0IGZsYWdzKTsKaW50IGJwZl9tYXBfb2ZmbG9hZF9k
ZWxldGVfZWxlbShzdHJ1Y3QgYnBmX21hcCAqbWFwLCB2b2lkICprZXkpOwppbnQgYnBmX21h
cF9vZmZsb2FkX2dldF9uZXh0X2tleShzdHJ1Y3QgYnBmX21hcCAqbWFwLAogICAgIHZvaWQg
KmtleSwgdm9pZCAqbmV4dF9rZXkpOwoKYm9vbCBicGZfb2ZmbG9hZF9wcm9nX21hcF9tYXRj
aChzdHJ1Y3QgYnBmX3Byb2cgKnByb2csIHN0cnVjdCBicGZfbWFwICptYXApOwoKc3RydWN0
IGJwZl9vZmZsb2FkX2RldiAqCmJwZl9vZmZsb2FkX2Rldl9jcmVhdGUoY29uc3Qgc3RydWN0
IGJwZl9wcm9nX29mZmxvYWRfb3BzICpvcHMsIHZvaWQgKnByaXYpOwp2b2lkIGJwZl9vZmZs
b2FkX2Rldl9kZXN0cm95KHN0cnVjdCBicGZfb2ZmbG9hZF9kZXYgKm9mZmRldik7CnZvaWQg
KmJwZl9vZmZsb2FkX2Rldl9wcml2KHN0cnVjdCBicGZfb2ZmbG9hZF9kZXYgKm9mZmRldik7
CmludCBicGZfb2ZmbG9hZF9kZXZfbmV0ZGV2X3JlZ2lzdGVyKHN0cnVjdCBicGZfb2ZmbG9h
ZF9kZXYgKm9mZmRldiwKICAgICAgICBzdHJ1Y3QgbmV0X2RldmljZSAqbmV0ZGV2KTsKdm9p
ZCBicGZfb2ZmbG9hZF9kZXZfbmV0ZGV2X3VucmVnaXN0ZXIoc3RydWN0IGJwZl9vZmZsb2Fk
X2RldiAqb2ZmZGV2LAogICAgICAgICAgIHN0cnVjdCBuZXRfZGV2aWNlICpuZXRkZXYpOwpi
b29sIGJwZl9vZmZsb2FkX2Rldl9tYXRjaChzdHJ1Y3QgYnBmX3Byb2cgKnByb2csIHN0cnVj
dCBuZXRfZGV2aWNlICpuZXRkZXYpOwojIDE1MTkgIi4vaW5jbHVkZS9saW51eC9icGYuaCIK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIGludCBicGZfcHJvZ19vZmZsb2FkX2luaXQoc3RydWN0IGJwZl9wcm9nICpw
cm9nLAogICAgIHVuaW9uIGJwZl9hdHRyICphdHRyKQp7CiByZXR1cm4gLTk1Owp9CgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgYm9vbCBicGZfcHJvZ19pc19kZXZfYm91bmQoc3RydWN0IGJwZl9wcm9nX2F1eCAq
YXV4KQp7CiByZXR1cm4gZmFsc2U7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIGJwZl9tYXBfaXNfZGV2
X2JvdW5kKHN0cnVjdCBicGZfbWFwICptYXApCnsKIHJldHVybiBmYWxzZTsKfQoKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIHN0cnVjdCBicGZfbWFwICpicGZfbWFwX29mZmxvYWRfbWFwX2FsbG9jKHVuaW9uIGJw
Zl9hdHRyICphdHRyKQp7CiByZXR1cm4gRVJSX1BUUigtOTUpOwp9CgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9p
ZCBicGZfbWFwX29mZmxvYWRfbWFwX2ZyZWUoc3RydWN0IGJwZl9tYXAgKm1hcCkKewp9CiMg
MTU1MSAiLi9pbmNsdWRlL2xpbnV4L2JwZi5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHNvY2tfbWFwX3By
b2dfdXBkYXRlKHN0cnVjdCBicGZfbWFwICptYXAsCiAgICAgICAgICAgc3RydWN0IGJwZl9w
cm9nICpwcm9nLCB1MzIgd2hpY2gpCnsKIHJldHVybiAtOTU7Cn0KCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQg
c29ja19tYXBfZ2V0X2Zyb21fZmQoY29uc3QgdW5pb24gYnBmX2F0dHIgKmF0dHIsCiAgICAg
ICAgICAgc3RydWN0IGJwZl9wcm9nICpwcm9nKQp7CiByZXR1cm4gLTIyOwp9CiMgMTU3MSAi
Li9pbmNsdWRlL2xpbnV4L2JwZi5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBicGZfc2tfcmV1c2Vwb3J0
X2RldGFjaChzdHJ1Y3Qgc29jayAqc2spCnsKfQojIDE1OTIgIi4vaW5jbHVkZS9saW51eC9i
cGYuaCIKZXh0ZXJuIGNvbnN0IHN0cnVjdCBicGZfZnVuY19wcm90byBicGZfbWFwX2xvb2t1
cF9lbGVtX3Byb3RvOwpleHRlcm4gY29uc3Qgc3RydWN0IGJwZl9mdW5jX3Byb3RvIGJwZl9t
YXBfdXBkYXRlX2VsZW1fcHJvdG87CmV4dGVybiBjb25zdCBzdHJ1Y3QgYnBmX2Z1bmNfcHJv
dG8gYnBmX21hcF9kZWxldGVfZWxlbV9wcm90bzsKZXh0ZXJuIGNvbnN0IHN0cnVjdCBicGZf
ZnVuY19wcm90byBicGZfbWFwX3B1c2hfZWxlbV9wcm90bzsKZXh0ZXJuIGNvbnN0IHN0cnVj
dCBicGZfZnVuY19wcm90byBicGZfbWFwX3BvcF9lbGVtX3Byb3RvOwpleHRlcm4gY29uc3Qg
c3RydWN0IGJwZl9mdW5jX3Byb3RvIGJwZl9tYXBfcGVla19lbGVtX3Byb3RvOwoKZXh0ZXJu
IGNvbnN0IHN0cnVjdCBicGZfZnVuY19wcm90byBicGZfZ2V0X3ByYW5kb21fdTMyX3Byb3Rv
OwpleHRlcm4gY29uc3Qgc3RydWN0IGJwZl9mdW5jX3Byb3RvIGJwZl9nZXRfc21wX3Byb2Nl
c3Nvcl9pZF9wcm90bzsKZXh0ZXJuIGNvbnN0IHN0cnVjdCBicGZfZnVuY19wcm90byBicGZf
Z2V0X251bWFfbm9kZV9pZF9wcm90bzsKZXh0ZXJuIGNvbnN0IHN0cnVjdCBicGZfZnVuY19w
cm90byBicGZfdGFpbF9jYWxsX3Byb3RvOwpleHRlcm4gY29uc3Qgc3RydWN0IGJwZl9mdW5j
X3Byb3RvIGJwZl9rdGltZV9nZXRfbnNfcHJvdG87CmV4dGVybiBjb25zdCBzdHJ1Y3QgYnBm
X2Z1bmNfcHJvdG8gYnBmX2t0aW1lX2dldF9ib290X25zX3Byb3RvOwpleHRlcm4gY29uc3Qg
c3RydWN0IGJwZl9mdW5jX3Byb3RvIGJwZl9nZXRfY3VycmVudF9waWRfdGdpZF9wcm90bzsK
ZXh0ZXJuIGNvbnN0IHN0cnVjdCBicGZfZnVuY19wcm90byBicGZfZ2V0X2N1cnJlbnRfdWlk
X2dpZF9wcm90bzsKZXh0ZXJuIGNvbnN0IHN0cnVjdCBicGZfZnVuY19wcm90byBicGZfZ2V0
X2N1cnJlbnRfY29tbV9wcm90bzsKZXh0ZXJuIGNvbnN0IHN0cnVjdCBicGZfZnVuY19wcm90
byBicGZfZ2V0X3N0YWNraWRfcHJvdG87CmV4dGVybiBjb25zdCBzdHJ1Y3QgYnBmX2Z1bmNf
cHJvdG8gYnBmX2dldF9zdGFja19wcm90bzsKZXh0ZXJuIGNvbnN0IHN0cnVjdCBicGZfZnVu
Y19wcm90byBicGZfc29ja19tYXBfdXBkYXRlX3Byb3RvOwpleHRlcm4gY29uc3Qgc3RydWN0
IGJwZl9mdW5jX3Byb3RvIGJwZl9zb2NrX2hhc2hfdXBkYXRlX3Byb3RvOwpleHRlcm4gY29u
c3Qgc3RydWN0IGJwZl9mdW5jX3Byb3RvIGJwZl9nZXRfY3VycmVudF9jZ3JvdXBfaWRfcHJv
dG87CmV4dGVybiBjb25zdCBzdHJ1Y3QgYnBmX2Z1bmNfcHJvdG8gYnBmX2dldF9jdXJyZW50
X2FuY2VzdG9yX2Nncm91cF9pZF9wcm90bzsKZXh0ZXJuIGNvbnN0IHN0cnVjdCBicGZfZnVu
Y19wcm90byBicGZfbXNnX3JlZGlyZWN0X2hhc2hfcHJvdG87CmV4dGVybiBjb25zdCBzdHJ1
Y3QgYnBmX2Z1bmNfcHJvdG8gYnBmX21zZ19yZWRpcmVjdF9tYXBfcHJvdG87CmV4dGVybiBj
b25zdCBzdHJ1Y3QgYnBmX2Z1bmNfcHJvdG8gYnBmX3NrX3JlZGlyZWN0X2hhc2hfcHJvdG87
CmV4dGVybiBjb25zdCBzdHJ1Y3QgYnBmX2Z1bmNfcHJvdG8gYnBmX3NrX3JlZGlyZWN0X21h
cF9wcm90bzsKZXh0ZXJuIGNvbnN0IHN0cnVjdCBicGZfZnVuY19wcm90byBicGZfc3Bpbl9s
b2NrX3Byb3RvOwpleHRlcm4gY29uc3Qgc3RydWN0IGJwZl9mdW5jX3Byb3RvIGJwZl9zcGlu
X3VubG9ja19wcm90bzsKZXh0ZXJuIGNvbnN0IHN0cnVjdCBicGZfZnVuY19wcm90byBicGZf
Z2V0X2xvY2FsX3N0b3JhZ2VfcHJvdG87CmV4dGVybiBjb25zdCBzdHJ1Y3QgYnBmX2Z1bmNf
cHJvdG8gYnBmX3N0cnRvbF9wcm90bzsKZXh0ZXJuIGNvbnN0IHN0cnVjdCBicGZfZnVuY19w
cm90byBicGZfc3RydG91bF9wcm90bzsKZXh0ZXJuIGNvbnN0IHN0cnVjdCBicGZfZnVuY19w
cm90byBicGZfdGNwX3NvY2tfcHJvdG87CmV4dGVybiBjb25zdCBzdHJ1Y3QgYnBmX2Z1bmNf
cHJvdG8gYnBmX2ppZmZpZXM2NF9wcm90bzsKZXh0ZXJuIGNvbnN0IHN0cnVjdCBicGZfZnVu
Y19wcm90byBicGZfZ2V0X25zX2N1cnJlbnRfcGlkX3RnaWRfcHJvdG87CmV4dGVybiBjb25z
dCBzdHJ1Y3QgYnBmX2Z1bmNfcHJvdG8gYnBmX2V2ZW50X291dHB1dF9kYXRhX3Byb3RvOwpl
eHRlcm4gY29uc3Qgc3RydWN0IGJwZl9mdW5jX3Byb3RvIGJwZl9yaW5nYnVmX291dHB1dF9w
cm90bzsKZXh0ZXJuIGNvbnN0IHN0cnVjdCBicGZfZnVuY19wcm90byBicGZfcmluZ2J1Zl9y
ZXNlcnZlX3Byb3RvOwpleHRlcm4gY29uc3Qgc3RydWN0IGJwZl9mdW5jX3Byb3RvIGJwZl9y
aW5nYnVmX3N1Ym1pdF9wcm90bzsKZXh0ZXJuIGNvbnN0IHN0cnVjdCBicGZfZnVuY19wcm90
byBicGZfcmluZ2J1Zl9kaXNjYXJkX3Byb3RvOwpleHRlcm4gY29uc3Qgc3RydWN0IGJwZl9m
dW5jX3Byb3RvIGJwZl9yaW5nYnVmX3F1ZXJ5X3Byb3RvOwoKY29uc3Qgc3RydWN0IGJwZl9m
dW5jX3Byb3RvICpicGZfdHJhY2luZ19mdW5jX3Byb3RvKAogZW51bSBicGZfZnVuY19pZCBm
dW5jX2lkLCBjb25zdCBzdHJ1Y3QgYnBmX3Byb2cgKnByb2cpOwoKY29uc3Qgc3RydWN0IGJw
Zl9mdW5jX3Byb3RvICp0cmFjaW5nX3Byb2dfZnVuY19wcm90bygKICBlbnVtIGJwZl9mdW5j
X2lkIGZ1bmNfaWQsIGNvbnN0IHN0cnVjdCBicGZfcHJvZyAqcHJvZyk7CgoKdm9pZCBicGZf
dXNlcl9ybmRfaW5pdF9vbmNlKHZvaWQpOwp1NjQgYnBmX3VzZXJfcm5kX3UzMih1NjQgcjEs
IHU2NCByMiwgdTY0IHIzLCB1NjQgcjQsIHU2NCByNSk7CnU2NCBicGZfZ2V0X3Jhd19jcHVf
aWQodTY0IHIxLCB1NjQgcjIsIHU2NCByMywgdTY0IHI0LCB1NjQgcjUpOwoKCmJvb2wgYnBm
X3NvY2tfY29tbW9uX2lzX3ZhbGlkX2FjY2VzcyhpbnQgb2ZmLCBpbnQgc2l6ZSwKICAgICAg
ICAgZW51bSBicGZfYWNjZXNzX3R5cGUgdHlwZSwKICAgICAgICAgc3RydWN0IGJwZl9pbnNu
X2FjY2Vzc19hdXggKmluZm8pOwpib29sIGJwZl9zb2NrX2lzX3ZhbGlkX2FjY2VzcyhpbnQg
b2ZmLCBpbnQgc2l6ZSwgZW51bSBicGZfYWNjZXNzX3R5cGUgdHlwZSwKICAgICAgICAgc3Ry
dWN0IGJwZl9pbnNuX2FjY2Vzc19hdXggKmluZm8pOwp1MzIgYnBmX3NvY2tfY29udmVydF9j
dHhfYWNjZXNzKGVudW0gYnBmX2FjY2Vzc190eXBlIHR5cGUsCiAgICBjb25zdCBzdHJ1Y3Qg
YnBmX2luc24gKnNpLAogICAgc3RydWN0IGJwZl9pbnNuICppbnNuX2J1ZiwKICAgIHN0cnVj
dCBicGZfcHJvZyAqcHJvZywKICAgIHUzMiAqdGFyZ2V0X3NpemUpOwojIDE2NzkgIi4vaW5j
bHVkZS9saW51eC9icGYuaCIKc3RydWN0IHNrX3JldXNlcG9ydF9rZXJuIHsKIHN0cnVjdCBz
a19idWZmICpza2I7CiBzdHJ1Y3Qgc29jayAqc2s7CiBzdHJ1Y3Qgc29jayAqc2VsZWN0ZWRf
c2s7CiB2b2lkICpkYXRhX2VuZDsKIHUzMiBoYXNoOwogdTMyIHJldXNlcG9ydF9pZDsKIGJv
b2wgYmluZF9pbmFueTsKfTsKYm9vbCBicGZfdGNwX3NvY2tfaXNfdmFsaWRfYWNjZXNzKGlu
dCBvZmYsIGludCBzaXplLCBlbnVtIGJwZl9hY2Nlc3NfdHlwZSB0eXBlLAogICAgICBzdHJ1
Y3QgYnBmX2luc25fYWNjZXNzX2F1eCAqaW5mbyk7Cgp1MzIgYnBmX3RjcF9zb2NrX2NvbnZl
cnRfY3R4X2FjY2VzcyhlbnVtIGJwZl9hY2Nlc3NfdHlwZSB0eXBlLAogICAgICAgIGNvbnN0
IHN0cnVjdCBicGZfaW5zbiAqc2ksCiAgICAgICAgc3RydWN0IGJwZl9pbnNuICppbnNuX2J1
ZiwKICAgICAgICBzdHJ1Y3QgYnBmX3Byb2cgKnByb2csCiAgICAgICAgdTMyICp0YXJnZXRf
c2l6ZSk7Cgpib29sIGJwZl94ZHBfc29ja19pc192YWxpZF9hY2Nlc3MoaW50IG9mZiwgaW50
IHNpemUsIGVudW0gYnBmX2FjY2Vzc190eXBlIHR5cGUsCiAgICAgIHN0cnVjdCBicGZfaW5z
bl9hY2Nlc3NfYXV4ICppbmZvKTsKCnUzMiBicGZfeGRwX3NvY2tfY29udmVydF9jdHhfYWNj
ZXNzKGVudW0gYnBmX2FjY2Vzc190eXBlIHR5cGUsCiAgICAgICAgY29uc3Qgc3RydWN0IGJw
Zl9pbnNuICpzaSwKICAgICAgICBzdHJ1Y3QgYnBmX2luc24gKmluc25fYnVmLAogICAgICAg
IHN0cnVjdCBicGZfcHJvZyAqcHJvZywKICAgICAgICB1MzIgKnRhcmdldF9zaXplKTsKIyAx
NzM4ICIuL2luY2x1ZGUvbGludXgvYnBmLmgiCmVudW0gYnBmX3RleHRfcG9rZV90eXBlIHsK
IEJQRl9NT0RfQ0FMTCwKIEJQRl9NT0RfSlVNUCwKfTsKCmludCBicGZfYXJjaF90ZXh0X3Bv
a2Uodm9pZCAqaXAsIGVudW0gYnBmX3RleHRfcG9rZV90eXBlIHQsCiAgICAgICAgIHZvaWQg
KmFkZHIxLCB2b2lkICphZGRyMik7CiMgNiAiLi9pbmNsdWRlL2xpbnV4L2JwZi1jZ3JvdXAu
aCIgMgoKCgoKCgoKc3RydWN0IHNvY2s7CnN0cnVjdCBzb2NrYWRkcjsKc3RydWN0IGNncm91
cDsKc3RydWN0IHNrX2J1ZmY7CnN0cnVjdCBicGZfbWFwOwpzdHJ1Y3QgYnBmX3Byb2c7CnN0
cnVjdCBicGZfc29ja19vcHNfa2VybjsKc3RydWN0IGJwZl9jZ3JvdXBfc3RvcmFnZTsKc3Ry
dWN0IGN0bF90YWJsZTsKc3RydWN0IGN0bF90YWJsZV9oZWFkZXI7CiMgMzQ5ICIuL2luY2x1
ZGUvbGludXgvYnBmLWNncm91cC5oIgpzdHJ1Y3QgYnBmX3Byb2c7CnN0cnVjdCBjZ3JvdXBf
YnBmIHt9OwpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgaW50IGNncm91cF9icGZfaW5oZXJpdChzdHJ1Y3QgY2dyb3Vw
ICpjZ3JwKSB7IHJldHVybiAwOyB9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGNncm91cF9icGZfb2ZmbGlu
ZShzdHJ1Y3QgY2dyb3VwICpjZ3JwKSB7fQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBjZ3JvdXBfYnBmX3By
b2dfYXR0YWNoKGNvbnN0IHVuaW9uIGJwZl9hdHRyICphdHRyLAogICAgICBlbnVtIGJwZl9w
cm9nX3R5cGUgcHR5cGUsCiAgICAgIHN0cnVjdCBicGZfcHJvZyAqcHJvZykKewogcmV0dXJu
IC0yMjsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIGludCBjZ3JvdXBfYnBmX3Byb2dfZGV0YWNoKGNvbnN0IHVu
aW9uIGJwZl9hdHRyICphdHRyLAogICAgICBlbnVtIGJwZl9wcm9nX3R5cGUgcHR5cGUpCnsK
IHJldHVybiAtMjI7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgY2dyb3VwX2JwZl9saW5rX2F0dGFjaChj
b25zdCB1bmlvbiBicGZfYXR0ciAqYXR0ciwKICAgICAgc3RydWN0IGJwZl9wcm9nICpwcm9n
KQp7CiByZXR1cm4gLTIyOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGNncm91cF9icGZfcHJvZ19xdWVy
eShjb25zdCB1bmlvbiBicGZfYXR0ciAqYXR0ciwKICAgICB1bmlvbiBicGZfYXR0ciAqdWF0
dHIpCnsKIHJldHVybiAtMjI7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGJwZl9jZ3JvdXBfc3RvcmFn
ZV9zZXQoCiBzdHJ1Y3QgYnBmX2Nncm91cF9zdG9yYWdlICpzdG9yYWdlW19fQlBGX0NHUk9V
UF9TVE9SQUdFX01BWF0pIHt9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgYnBmX2Nncm91cF9zdG9yYWdlX2Fz
c2lnbihzdHJ1Y3QgYnBmX3Byb2dfYXV4ICphdXgsCiAgICAgICAgIHN0cnVjdCBicGZfbWFw
ICptYXApIHsgcmV0dXJuIDA7IH0Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgYnBmX2Nncm91cF9zdG9yYWdl
X3JlbGVhc2Uoc3RydWN0IGJwZl9wcm9nX2F1eCAqYXV4LAogICAgICAgICAgIHN0cnVjdCBi
cGZfbWFwICptYXApIHt9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3QgYnBmX2Nncm91cF9zdG9yYWdlICpi
cGZfY2dyb3VwX3N0b3JhZ2VfYWxsb2MoCiBzdHJ1Y3QgYnBmX3Byb2cgKnByb2csIGVudW0g
YnBmX2Nncm91cF9zdG9yYWdlX3R5cGUgc3R5cGUpIHsgcmV0dXJuICgodm9pZCAqKTApOyB9
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSB2b2lkIGJwZl9jZ3JvdXBfc3RvcmFnZV9mcmVlKAogc3RydWN0IGJwZl9j
Z3JvdXBfc3RvcmFnZSAqc3RvcmFnZSkge30Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBicGZfcGVyY3B1X2Nn
cm91cF9zdG9yYWdlX2NvcHkoc3RydWN0IGJwZl9tYXAgKm1hcCwgdm9pZCAqa2V5LAogICAg
ICAgdm9pZCAqdmFsdWUpIHsKIHJldHVybiAwOwp9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgYnBmX3BlcmNw
dV9jZ3JvdXBfc3RvcmFnZV91cGRhdGUoc3RydWN0IGJwZl9tYXAgKm1hcCwKICAgICB2b2lk
ICprZXksIHZvaWQgKnZhbHVlLCB1NjQgZmxhZ3MpIHsKIHJldHVybiAwOwp9CiMgMjMgIi4v
aW5jbHVkZS9saW51eC9jZ3JvdXAtZGVmcy5oIiAyCiMgMSAiLi9pbmNsdWRlL2xpbnV4L3Bz
aV90eXBlcy5oIiAxCgoKCiMgMSAiLi9pbmNsdWRlL2xpbnV4L2t0aHJlYWQuaCIgMQoKCgoK
CgoKc3RydWN0IG1tX3N0cnVjdDsKCl9fYXR0cmlidXRlX18oKF9fZm9ybWF0X18ocHJpbnRm
LCA0LCA1KSkpCnN0cnVjdCB0YXNrX3N0cnVjdCAqa3RocmVhZF9jcmVhdGVfb25fbm9kZShp
bnQgKCp0aHJlYWRmbikodm9pZCAqZGF0YSksCiAgICAgICAgdm9pZCAqZGF0YSwKICAgICAg
ICBpbnQgbm9kZSwKICAgICAgICBjb25zdCBjaGFyIG5hbWVmbXRbXSwgLi4uKTsKIyAzMSAi
Li9pbmNsdWRlL2xpbnV4L2t0aHJlYWQuaCIKc3RydWN0IHRhc2tfc3RydWN0ICprdGhyZWFk
X2NyZWF0ZV9vbl9jcHUoaW50ICgqdGhyZWFkZm4pKHZvaWQgKmRhdGEpLAogICAgICAgdm9p
ZCAqZGF0YSwKICAgICAgIHVuc2lnbmVkIGludCBjcHUsCiAgICAgICBjb25zdCBjaGFyICpu
YW1lZm10KTsKIyA1NCAiLi9pbmNsdWRlL2xpbnV4L2t0aHJlYWQuaCIKdm9pZCBmcmVlX2t0
aHJlYWRfc3RydWN0KHN0cnVjdCB0YXNrX3N0cnVjdCAqayk7CnZvaWQga3RocmVhZF9iaW5k
KHN0cnVjdCB0YXNrX3N0cnVjdCAqaywgdW5zaWduZWQgaW50IGNwdSk7CnZvaWQga3RocmVh
ZF9iaW5kX21hc2soc3RydWN0IHRhc2tfc3RydWN0ICprLCBjb25zdCBzdHJ1Y3QgY3B1bWFz
ayAqbWFzayk7CmludCBrdGhyZWFkX3N0b3Aoc3RydWN0IHRhc2tfc3RydWN0ICprKTsKYm9v
bCBrdGhyZWFkX3Nob3VsZF9zdG9wKHZvaWQpOwpib29sIGt0aHJlYWRfc2hvdWxkX3Bhcmso
dm9pZCk7CmJvb2wgX19rdGhyZWFkX3Nob3VsZF9wYXJrKHN0cnVjdCB0YXNrX3N0cnVjdCAq
ayk7CmJvb2wga3RocmVhZF9mcmVlemFibGVfc2hvdWxkX3N0b3AoYm9vbCAqd2FzX2Zyb3pl
bik7CnZvaWQgKmt0aHJlYWRfZnVuYyhzdHJ1Y3QgdGFza19zdHJ1Y3QgKmspOwp2b2lkICpr
dGhyZWFkX2RhdGEoc3RydWN0IHRhc2tfc3RydWN0ICprKTsKdm9pZCAqa3RocmVhZF9wcm9i
ZV9kYXRhKHN0cnVjdCB0YXNrX3N0cnVjdCAqayk7CmludCBrdGhyZWFkX3Bhcmsoc3RydWN0
IHRhc2tfc3RydWN0ICprKTsKdm9pZCBrdGhyZWFkX3VucGFyayhzdHJ1Y3QgdGFza19zdHJ1
Y3QgKmspOwp2b2lkIGt0aHJlYWRfcGFya21lKHZvaWQpOwoKaW50IGt0aHJlYWRkKHZvaWQg
KnVudXNlZCk7CmV4dGVybiBzdHJ1Y3QgdGFza19zdHJ1Y3QgKmt0aHJlYWRkX3Rhc2s7CmV4
dGVybiBpbnQgdHNrX2ZvcmtfZ2V0X25vZGUoc3RydWN0IHRhc2tfc3RydWN0ICp0c2spOwoj
IDgxICIuL2luY2x1ZGUvbGludXgva3RocmVhZC5oIgpzdHJ1Y3Qga3RocmVhZF93b3JrOwp0
eXBlZGVmIHZvaWQgKCprdGhyZWFkX3dvcmtfZnVuY190KShzdHJ1Y3Qga3RocmVhZF93b3Jr
ICp3b3JrKTsKdm9pZCBrdGhyZWFkX2RlbGF5ZWRfd29ya190aW1lcl9mbihzdHJ1Y3QgdGlt
ZXJfbGlzdCAqdCk7CgplbnVtIHsKIEtUV19GUkVFWkFCTEUgPSAxIDw8IDAsCn07CgpzdHJ1
Y3Qga3RocmVhZF93b3JrZXIgewogdW5zaWduZWQgaW50IGZsYWdzOwogcmF3X3NwaW5sb2Nr
X3QgbG9jazsKIHN0cnVjdCBsaXN0X2hlYWQgd29ya19saXN0Owogc3RydWN0IGxpc3RfaGVh
ZCBkZWxheWVkX3dvcmtfbGlzdDsKIHN0cnVjdCB0YXNrX3N0cnVjdCAqdGFzazsKIHN0cnVj
dCBrdGhyZWFkX3dvcmsgKmN1cnJlbnRfd29yazsKfTsKCnN0cnVjdCBrdGhyZWFkX3dvcmsg
ewogc3RydWN0IGxpc3RfaGVhZCBub2RlOwoga3RocmVhZF93b3JrX2Z1bmNfdCBmdW5jOwog
c3RydWN0IGt0aHJlYWRfd29ya2VyICp3b3JrZXI7CgogaW50IGNhbmNlbGluZzsKfTsKCnN0
cnVjdCBrdGhyZWFkX2RlbGF5ZWRfd29yayB7CiBzdHJ1Y3Qga3RocmVhZF93b3JrIHdvcms7
CiBzdHJ1Y3QgdGltZXJfbGlzdCB0aW1lcjsKfTsKIyAxNTEgIi4vaW5jbHVkZS9saW51eC9r
dGhyZWFkLmgiCmV4dGVybiB2b2lkIF9fa3RocmVhZF9pbml0X3dvcmtlcihzdHJ1Y3Qga3Ro
cmVhZF93b3JrZXIgKndvcmtlciwKICAgY29uc3QgY2hhciAqbmFtZSwgc3RydWN0IGxvY2tf
Y2xhc3Nfa2V5ICprZXkpOwojIDE3NSAiLi9pbmNsdWRlL2xpbnV4L2t0aHJlYWQuaCIKaW50
IGt0aHJlYWRfd29ya2VyX2ZuKHZvaWQgKndvcmtlcl9wdHIpOwoKX19hdHRyaWJ1dGVfXygo
X19mb3JtYXRfXyhwcmludGYsIDIsIDMpKSkKc3RydWN0IGt0aHJlYWRfd29ya2VyICoKa3Ro
cmVhZF9jcmVhdGVfd29ya2VyKHVuc2lnbmVkIGludCBmbGFncywgY29uc3QgY2hhciBuYW1l
Zm10W10sIC4uLik7CgpfX2F0dHJpYnV0ZV9fKChfX2Zvcm1hdF9fKHByaW50ZiwgMywgNCkp
KSBzdHJ1Y3Qga3RocmVhZF93b3JrZXIgKgprdGhyZWFkX2NyZWF0ZV93b3JrZXJfb25fY3B1
KGludCBjcHUsIHVuc2lnbmVkIGludCBmbGFncywKICAgICAgICBjb25zdCBjaGFyIG5hbWVm
bXRbXSwgLi4uKTsKCmJvb2wga3RocmVhZF9xdWV1ZV93b3JrKHN0cnVjdCBrdGhyZWFkX3dv
cmtlciAqd29ya2VyLAogICBzdHJ1Y3Qga3RocmVhZF93b3JrICp3b3JrKTsKCmJvb2wga3Ro
cmVhZF9xdWV1ZV9kZWxheWVkX3dvcmsoc3RydWN0IGt0aHJlYWRfd29ya2VyICp3b3JrZXIs
CiAgICBzdHJ1Y3Qga3RocmVhZF9kZWxheWVkX3dvcmsgKmR3b3JrLAogICAgdW5zaWduZWQg
bG9uZyBkZWxheSk7Cgpib29sIGt0aHJlYWRfbW9kX2RlbGF5ZWRfd29yayhzdHJ1Y3Qga3Ro
cmVhZF93b3JrZXIgKndvcmtlciwKICAgICAgICAgc3RydWN0IGt0aHJlYWRfZGVsYXllZF93
b3JrICpkd29yaywKICAgICAgICAgdW5zaWduZWQgbG9uZyBkZWxheSk7Cgp2b2lkIGt0aHJl
YWRfZmx1c2hfd29yayhzdHJ1Y3Qga3RocmVhZF93b3JrICp3b3JrKTsKdm9pZCBrdGhyZWFk
X2ZsdXNoX3dvcmtlcihzdHJ1Y3Qga3RocmVhZF93b3JrZXIgKndvcmtlcik7Cgpib29sIGt0
aHJlYWRfY2FuY2VsX3dvcmtfc3luYyhzdHJ1Y3Qga3RocmVhZF93b3JrICp3b3JrKTsKYm9v
bCBrdGhyZWFkX2NhbmNlbF9kZWxheWVkX3dvcmtfc3luYyhzdHJ1Y3Qga3RocmVhZF9kZWxh
eWVkX3dvcmsgKndvcmspOwoKdm9pZCBrdGhyZWFkX2Rlc3Ryb3lfd29ya2VyKHN0cnVjdCBr
dGhyZWFkX3dvcmtlciAqd29ya2VyKTsKCnZvaWQga3RocmVhZF91c2VfbW0oc3RydWN0IG1t
X3N0cnVjdCAqbW0pOwp2b2lkIGt0aHJlYWRfdW51c2VfbW0oc3RydWN0IG1tX3N0cnVjdCAq
bW0pOwoKc3RydWN0IGNncm91cF9zdWJzeXNfc3RhdGU7CgoKCgoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQg
a3RocmVhZF9hc3NvY2lhdGVfYmxrY2coc3RydWN0IGNncm91cF9zdWJzeXNfc3RhdGUgKmNz
cykgeyB9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3QgY2dyb3VwX3N1YnN5c19zdGF0ZSAqa3RocmVhZF9i
bGtjZyh2b2lkKQp7CiByZXR1cm4gKCh2b2lkICopMCk7Cn0KIyA1ICIuL2luY2x1ZGUvbGlu
dXgvcHNpX3R5cGVzLmgiIDIKIyAxNzcgIi4vaW5jbHVkZS9saW51eC9wc2lfdHlwZXMuaCIK
c3RydWN0IHBzaV9ncm91cCB7IH07CiMgMjQgIi4vaW5jbHVkZS9saW51eC9jZ3JvdXAtZGVm
cy5oIiAyCgoKCnN0cnVjdCBjZ3JvdXA7CnN0cnVjdCBjZ3JvdXBfcm9vdDsKc3RydWN0IGNn
cm91cF9zdWJzeXM7CnN0cnVjdCBjZ3JvdXBfdGFza3NldDsKc3RydWN0IGtlcm5mc19ub2Rl
OwpzdHJ1Y3Qga2VybmZzX29wczsKc3RydWN0IGtlcm5mc19vcGVuX2ZpbGU7CnN0cnVjdCBz
ZXFfZmlsZTsKc3RydWN0IHBvbGxfdGFibGVfc3RydWN0OwoKCgoKCgoKZW51bSBjZ3JvdXBf
c3Vic3lzX2lkIHsKIyAxICIuL2luY2x1ZGUvbGludXgvY2dyb3VwX3N1YnN5cy5oIiAxCiMg
MTMgIi4vaW5jbHVkZS9saW51eC9jZ3JvdXBfc3Vic3lzLmgiCmNwdXNldF9jZ3JwX2lkLAoK
CgpjcHVfY2dycF9pZCwKCgoKY3B1YWNjdF9jZ3JwX2lkLAojIDQ1ICIuL2luY2x1ZGUvbGlu
dXgvY2dyb3VwLWRlZnMuaCIgMgogQ0dST1VQX1NVQlNZU19DT1VOVCwKfTsKCgoKZW51bSB7
CiBDU1NfTk9fUkVGID0gKDEgPDwgMCksCiBDU1NfT05MSU5FID0gKDEgPDwgMSksCiBDU1Nf
UkVMRUFTRUQgPSAoMSA8PCAyKSwKIENTU19WSVNJQkxFID0gKDEgPDwgMyksCiBDU1NfRFlJ
TkcgPSAoMSA8PCA0KSwKfTsKCgplbnVtIHsKCiBDR1JQX05PVElGWV9PTl9SRUxFQVNFLAoK
CgoKCiBDR1JQX0NQVVNFVF9DTE9ORV9DSElMRFJFTiwKCgogQ0dSUF9GUkVFWkUsCgoKIENH
UlBfRlJPWkVOLAp9OwoKCmVudW0gewogQ0dSUF9ST09UX05PUFJFRklYID0gKDEgPDwgMSks
CiBDR1JQX1JPT1RfWEFUVFIgPSAoMSA8PCAyKSwKCgoKCgoKIENHUlBfUk9PVF9OU19ERUxF
R0FURSA9ICgxIDw8IDMpLAoKCgoKIENHUlBfUk9PVF9DUFVTRVRfVjJfTU9ERSA9ICgxIDw8
IDQpLAoKCgoKIENHUlBfUk9PVF9NRU1PUllfTE9DQUxfRVZFTlRTID0gKDEgPDwgNSksCgoK
CgogQ0dSUF9ST09UX01FTU9SWV9SRUNVUlNJVkVfUFJPVCA9ICgxIDw8IDYpLAp9OwoKCmVu
dW0gewogQ0ZUWVBFX09OTFlfT05fUk9PVCA9ICgxIDw8IDApLAogQ0ZUWVBFX05PVF9PTl9S
T09UID0gKDEgPDwgMSksCiBDRlRZUEVfTlNfREVMRUdBVEFCTEUgPSAoMSA8PCAyKSwKCiBD
RlRZUEVfTk9fUFJFRklYID0gKDEgPDwgMyksCiBDRlRZUEVfV09STERfV1JJVEFCTEUgPSAo
MSA8PCA0KSwKIENGVFlQRV9ERUJVRyA9ICgxIDw8IDUpLAoKCiBfX0NGVFlQRV9PTkxZX09O
X0RGTCA9ICgxIDw8IDE2KSwKIF9fQ0ZUWVBFX05PVF9PTl9ERkwgPSAoMSA8PCAxNyksCn07
CgoKCgoKCnN0cnVjdCBjZ3JvdXBfZmlsZSB7Cgogc3RydWN0IGtlcm5mc19ub2RlICprbjsK
IHVuc2lnbmVkIGxvbmcgbm90aWZpZWRfYXQ7CiBzdHJ1Y3QgdGltZXJfbGlzdCBub3RpZnlf
dGltZXI7Cn07CiMgMTM4ICIuL2luY2x1ZGUvbGludXgvY2dyb3VwLWRlZnMuaCIKc3RydWN0
IGNncm91cF9zdWJzeXNfc3RhdGUgewoKIHN0cnVjdCBjZ3JvdXAgKmNncm91cDsKCgogc3Ry
dWN0IGNncm91cF9zdWJzeXMgKnNzOwoKCiBzdHJ1Y3QgcGVyY3B1X3JlZiByZWZjbnQ7CgoK
IHN0cnVjdCBsaXN0X2hlYWQgc2libGluZzsKIHN0cnVjdCBsaXN0X2hlYWQgY2hpbGRyZW47
CgoKIHN0cnVjdCBsaXN0X2hlYWQgcnN0YXRfY3NzX25vZGU7CgoKCgoKIGludCBpZDsKCiB1
bnNpZ25lZCBpbnQgZmxhZ3M7CgoKCgoKCgogdTY0IHNlcmlhbF9ucjsKCgoKCgogYXRvbWlj
X3Qgb25saW5lX2NudDsKCgogc3RydWN0IHdvcmtfc3RydWN0IGRlc3Ryb3lfd29yazsKIHN0
cnVjdCByY3Vfd29yayBkZXN0cm95X3J3b3JrOwoKCgoKCiBzdHJ1Y3QgY2dyb3VwX3N1YnN5
c19zdGF0ZSAqcGFyZW50Owp9OwojIDE5NSAiLi9pbmNsdWRlL2xpbnV4L2Nncm91cC1kZWZz
LmgiCnN0cnVjdCBjc3Nfc2V0IHsKCgoKCgogc3RydWN0IGNncm91cF9zdWJzeXNfc3RhdGUg
KnN1YnN5c1tDR1JPVVBfU1VCU1lTX0NPVU5UXTsKCgogcmVmY291bnRfdCByZWZjb3VudDsK
CgoKCgoKCiBzdHJ1Y3QgY3NzX3NldCAqZG9tX2NzZXQ7CgoKIHN0cnVjdCBjZ3JvdXAgKmRm
bF9jZ3JwOwoKCiBpbnQgbnJfdGFza3M7CiMgMjI3ICIuL2luY2x1ZGUvbGludXgvY2dyb3Vw
LWRlZnMuaCIKIHN0cnVjdCBsaXN0X2hlYWQgdGFza3M7CiBzdHJ1Y3QgbGlzdF9oZWFkIG1n
X3Rhc2tzOwogc3RydWN0IGxpc3RfaGVhZCBkeWluZ190YXNrczsKCgogc3RydWN0IGxpc3Rf
aGVhZCB0YXNrX2l0ZXJzOwojIDI0MSAiLi9pbmNsdWRlL2xpbnV4L2Nncm91cC1kZWZzLmgi
CiBzdHJ1Y3QgbGlzdF9oZWFkIGVfY3NldF9ub2RlW0NHUk9VUF9TVUJTWVNfQ09VTlRdOwoK
CiBzdHJ1Y3QgbGlzdF9oZWFkIHRocmVhZGVkX2NzZXRzOwogc3RydWN0IGxpc3RfaGVhZCB0
aHJlYWRlZF9jc2V0c19ub2RlOwoKCgoKCiBzdHJ1Y3QgaGxpc3Rfbm9kZSBobGlzdDsKCgoK
Cgogc3RydWN0IGxpc3RfaGVhZCBjZ3JwX2xpbmtzOwoKCgoKCiBzdHJ1Y3QgbGlzdF9oZWFk
IG1nX3ByZWxvYWRfbm9kZTsKIHN0cnVjdCBsaXN0X2hlYWQgbWdfbm9kZTsKIyAyNzMgIi4v
aW5jbHVkZS9saW51eC9jZ3JvdXAtZGVmcy5oIgogc3RydWN0IGNncm91cCAqbWdfc3JjX2Nn
cnA7CiBzdHJ1Y3QgY2dyb3VwICptZ19kc3RfY2dycDsKIHN0cnVjdCBjc3Nfc2V0ICptZ19k
c3RfY3NldDsKCgogYm9vbCBkZWFkOwoKCiBzdHJ1Y3QgY2FsbGJhY2tfaGVhZCBjYWxsYmFj
a19oZWFkOwp9OwoKc3RydWN0IGNncm91cF9iYXNlX3N0YXQgewogc3RydWN0IHRhc2tfY3B1
dGltZSBjcHV0aW1lOwp9OwojIDMwOCAiLi9pbmNsdWRlL2xpbnV4L2Nncm91cC1kZWZzLmgi
CnN0cnVjdCBjZ3JvdXBfcnN0YXRfY3B1IHsKCgoKCiBzdHJ1Y3QgdTY0X3N0YXRzX3N5bmMg
YnN5bmM7CiBzdHJ1Y3QgY2dyb3VwX2Jhc2Vfc3RhdCBic3RhdDsKCgoKCgogc3RydWN0IGNn
cm91cF9iYXNlX3N0YXQgbGFzdF9ic3RhdDsKIyAzMzMgIi4vaW5jbHVkZS9saW51eC9jZ3Jv
dXAtZGVmcy5oIgogc3RydWN0IGNncm91cCAqdXBkYXRlZF9jaGlsZHJlbjsKIHN0cnVjdCBj
Z3JvdXAgKnVwZGF0ZWRfbmV4dDsKfTsKCnN0cnVjdCBjZ3JvdXBfZnJlZXplcl9zdGF0ZSB7
CgogYm9vbCBmcmVlemU7CgoKIGludCBlX2ZyZWV6ZTsKCgoKCiBpbnQgbnJfZnJvemVuX2Rl
c2NlbmRhbnRzOwoKCgoKCiBpbnQgbnJfZnJvemVuX3Rhc2tzOwp9OwoKc3RydWN0IGNncm91
cCB7Cgogc3RydWN0IGNncm91cF9zdWJzeXNfc3RhdGUgc2VsZjsKCiB1bnNpZ25lZCBsb25n
IGZsYWdzOwoKCgoKCgoKIGludCBsZXZlbDsKCgogaW50IG1heF9kZXB0aDsKIyAzODQgIi4v
aW5jbHVkZS9saW51eC9jZ3JvdXAtZGVmcy5oIgogaW50IG5yX2Rlc2NlbmRhbnRzOwogaW50
IG5yX2R5aW5nX2Rlc2NlbmRhbnRzOwogaW50IG1heF9kZXNjZW5kYW50czsKIyAzOTkgIi4v
aW5jbHVkZS9saW51eC9jZ3JvdXAtZGVmcy5oIgogaW50IG5yX3BvcHVsYXRlZF9jc2V0czsK
IGludCBucl9wb3B1bGF0ZWRfZG9tYWluX2NoaWxkcmVuOwogaW50IG5yX3BvcHVsYXRlZF90
aHJlYWRlZF9jaGlsZHJlbjsKCiBpbnQgbnJfdGhyZWFkZWRfY2hpbGRyZW47Cgogc3RydWN0
IGtlcm5mc19ub2RlICprbjsKIHN0cnVjdCBjZ3JvdXBfZmlsZSBwcm9jc19maWxlOwogc3Ry
dWN0IGNncm91cF9maWxlIGV2ZW50c19maWxlOwojIDQxNiAiLi9pbmNsdWRlL2xpbnV4L2Nn
cm91cC1kZWZzLmgiCiB1MTYgc3VidHJlZV9jb250cm9sOwogdTE2IHN1YnRyZWVfc3NfbWFz
azsKIHUxNiBvbGRfc3VidHJlZV9jb250cm9sOwogdTE2IG9sZF9zdWJ0cmVlX3NzX21hc2s7
CgoKIHN0cnVjdCBjZ3JvdXBfc3Vic3lzX3N0YXRlICpzdWJzeXNbQ0dST1VQX1NVQlNZU19D
T1VOVF07Cgogc3RydWN0IGNncm91cF9yb290ICpyb290OwoKCgoKCiBzdHJ1Y3QgbGlzdF9o
ZWFkIGNzZXRfbGlua3M7CiMgNDM5ICIuL2luY2x1ZGUvbGludXgvY2dyb3VwLWRlZnMuaCIK
IHN0cnVjdCBsaXN0X2hlYWQgZV9jc2V0c1tDR1JPVVBfU1VCU1lTX0NPVU5UXTsKIyA0NDgg
Ii4vaW5jbHVkZS9saW51eC9jZ3JvdXAtZGVmcy5oIgogc3RydWN0IGNncm91cCAqZG9tX2Nn
cnA7CiBzdHJ1Y3QgY2dyb3VwICpvbGRfZG9tX2NncnA7CgoKIHN0cnVjdCBjZ3JvdXBfcnN0
YXRfY3B1ICpyc3RhdF9jcHU7CiBzdHJ1Y3QgbGlzdF9oZWFkIHJzdGF0X2Nzc19saXN0OwoK
CiBzdHJ1Y3QgY2dyb3VwX2Jhc2Vfc3RhdCBsYXN0X2JzdGF0Owogc3RydWN0IGNncm91cF9i
YXNlX3N0YXQgYnN0YXQ7CiBzdHJ1Y3QgcHJldl9jcHV0aW1lIHByZXZfY3B1dGltZTsKCgoK
Cgogc3RydWN0IGxpc3RfaGVhZCBwaWRsaXN0czsKIHN0cnVjdCBtdXRleCBwaWRsaXN0X211
dGV4OwoKCiB3YWl0X3F1ZXVlX2hlYWRfdCBvZmZsaW5lX3dhaXRxOwoKCiBzdHJ1Y3Qgd29y
a19zdHJ1Y3QgcmVsZWFzZV9hZ2VudF93b3JrOwoKCiBzdHJ1Y3QgcHNpX2dyb3VwIHBzaTsK
Cgogc3RydWN0IGNncm91cF9icGYgYnBmOwoKCiBhdG9taWNfdCBjb25nZXN0aW9uX2NvdW50
OwoKCiBzdHJ1Y3QgY2dyb3VwX2ZyZWV6ZXJfc3RhdGUgZnJlZXplcjsKCgogdTY0IGFuY2Vz
dG9yX2lkc1tdOwp9OwoKCgoKCgpzdHJ1Y3QgY2dyb3VwX3Jvb3Qgewogc3RydWN0IGtlcm5m
c19yb290ICprZl9yb290OwoKCiB1bnNpZ25lZCBpbnQgc3Vic3lzX21hc2s7CgoKIGludCBo
aWVyYXJjaHlfaWQ7CgoKIHN0cnVjdCBjZ3JvdXAgY2dycDsKCgogdTY0IGNncnBfYW5jZXN0
b3JfaWRfc3RvcmFnZTsKCgogYXRvbWljX3QgbnJfY2dycHM7CgoKIHN0cnVjdCBsaXN0X2hl
YWQgcm9vdF9saXN0OwoKCiB1bnNpZ25lZCBpbnQgZmxhZ3M7CgoKIGNoYXIgcmVsZWFzZV9h
Z2VudF9wYXRoWzQwOTZdOwoKCiBjaGFyIG5hbWVbNjRdOwp9OwojIDUzMiAiLi9pbmNsdWRl
L2xpbnV4L2Nncm91cC1kZWZzLmgiCnN0cnVjdCBjZnR5cGUgewoKCgoKCiBjaGFyIG5hbWVb
NjRdOwogdW5zaWduZWQgbG9uZyBwcml2YXRlOwoKCgoKCiBzaXplX3QgbWF4X3dyaXRlX2xl
bjsKCgogdW5zaWduZWQgaW50IGZsYWdzOwoKCgoKCgoKIHVuc2lnbmVkIGludCBmaWxlX29m
ZnNldDsKCgoKCgogc3RydWN0IGNncm91cF9zdWJzeXMgKnNzOwogc3RydWN0IGxpc3RfaGVh
ZCBub2RlOwogc3RydWN0IGtlcm5mc19vcHMgKmtmX29wczsKCiBpbnQgKCpvcGVuKShzdHJ1
Y3Qga2VybmZzX29wZW5fZmlsZSAqb2YpOwogdm9pZCAoKnJlbGVhc2UpKHN0cnVjdCBrZXJu
ZnNfb3Blbl9maWxlICpvZik7CgoKCgoKIHU2NCAoKnJlYWRfdTY0KShzdHJ1Y3QgY2dyb3Vw
X3N1YnN5c19zdGF0ZSAqY3NzLCBzdHJ1Y3QgY2Z0eXBlICpjZnQpOwoKCgogczY0ICgqcmVh
ZF9zNjQpKHN0cnVjdCBjZ3JvdXBfc3Vic3lzX3N0YXRlICpjc3MsIHN0cnVjdCBjZnR5cGUg
KmNmdCk7CgoKIGludCAoKnNlcV9zaG93KShzdHJ1Y3Qgc2VxX2ZpbGUgKnNmLCB2b2lkICp2
KTsKCgogdm9pZCAqKCpzZXFfc3RhcnQpKHN0cnVjdCBzZXFfZmlsZSAqc2YsIGxvZmZfdCAq
cHBvcyk7CiB2b2lkICooKnNlcV9uZXh0KShzdHJ1Y3Qgc2VxX2ZpbGUgKnNmLCB2b2lkICp2
LCBsb2ZmX3QgKnBwb3MpOwogdm9pZCAoKnNlcV9zdG9wKShzdHJ1Y3Qgc2VxX2ZpbGUgKnNm
LCB2b2lkICp2KTsKCgoKCgoKIGludCAoKndyaXRlX3U2NCkoc3RydWN0IGNncm91cF9zdWJz
eXNfc3RhdGUgKmNzcywgc3RydWN0IGNmdHlwZSAqY2Z0LAogICAgdTY0IHZhbCk7CgoKCiBp
bnQgKCp3cml0ZV9zNjQpKHN0cnVjdCBjZ3JvdXBfc3Vic3lzX3N0YXRlICpjc3MsIHN0cnVj
dCBjZnR5cGUgKmNmdCwKICAgIHM2NCB2YWwpOwoKCgoKCgoKIHNzaXplX3QgKCp3cml0ZSko
c3RydWN0IGtlcm5mc19vcGVuX2ZpbGUgKm9mLAogICAgY2hhciAqYnVmLCBzaXplX3QgbmJ5
dGVzLCBsb2ZmX3Qgb2ZmKTsKCiBfX3BvbGxfdCAoKnBvbGwpKHN0cnVjdCBrZXJuZnNfb3Bl
bl9maWxlICpvZiwKICAgIHN0cnVjdCBwb2xsX3RhYmxlX3N0cnVjdCAqcHQpOwoKCgoKfTsK
CgoKCgpzdHJ1Y3QgY2dyb3VwX3N1YnN5cyB7CiBzdHJ1Y3QgY2dyb3VwX3N1YnN5c19zdGF0
ZSAqKCpjc3NfYWxsb2MpKHN0cnVjdCBjZ3JvdXBfc3Vic3lzX3N0YXRlICpwYXJlbnRfY3Nz
KTsKIGludCAoKmNzc19vbmxpbmUpKHN0cnVjdCBjZ3JvdXBfc3Vic3lzX3N0YXRlICpjc3Mp
Owogdm9pZCAoKmNzc19vZmZsaW5lKShzdHJ1Y3QgY2dyb3VwX3N1YnN5c19zdGF0ZSAqY3Nz
KTsKIHZvaWQgKCpjc3NfcmVsZWFzZWQpKHN0cnVjdCBjZ3JvdXBfc3Vic3lzX3N0YXRlICpj
c3MpOwogdm9pZCAoKmNzc19mcmVlKShzdHJ1Y3QgY2dyb3VwX3N1YnN5c19zdGF0ZSAqY3Nz
KTsKIHZvaWQgKCpjc3NfcmVzZXQpKHN0cnVjdCBjZ3JvdXBfc3Vic3lzX3N0YXRlICpjc3Mp
Owogdm9pZCAoKmNzc19yc3RhdF9mbHVzaCkoc3RydWN0IGNncm91cF9zdWJzeXNfc3RhdGUg
KmNzcywgaW50IGNwdSk7CiBpbnQgKCpjc3NfZXh0cmFfc3RhdF9zaG93KShzdHJ1Y3Qgc2Vx
X2ZpbGUgKnNlcSwKICAgICAgIHN0cnVjdCBjZ3JvdXBfc3Vic3lzX3N0YXRlICpjc3MpOwoK
IGludCAoKmNhbl9hdHRhY2gpKHN0cnVjdCBjZ3JvdXBfdGFza3NldCAqdHNldCk7CiB2b2lk
ICgqY2FuY2VsX2F0dGFjaCkoc3RydWN0IGNncm91cF90YXNrc2V0ICp0c2V0KTsKIHZvaWQg
KCphdHRhY2gpKHN0cnVjdCBjZ3JvdXBfdGFza3NldCAqdHNldCk7CiB2b2lkICgqcG9zdF9h
dHRhY2gpKHZvaWQpOwogaW50ICgqY2FuX2ZvcmspKHN0cnVjdCB0YXNrX3N0cnVjdCAqdGFz
aywKICAgc3RydWN0IGNzc19zZXQgKmNzZXQpOwogdm9pZCAoKmNhbmNlbF9mb3JrKShzdHJ1
Y3QgdGFza19zdHJ1Y3QgKnRhc2ssIHN0cnVjdCBjc3Nfc2V0ICpjc2V0KTsKIHZvaWQgKCpm
b3JrKShzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRhc2spOwogdm9pZCAoKmV4aXQpKHN0cnVjdCB0
YXNrX3N0cnVjdCAqdGFzayk7CiB2b2lkICgqcmVsZWFzZSkoc3RydWN0IHRhc2tfc3RydWN0
ICp0YXNrKTsKIHZvaWQgKCpiaW5kKShzdHJ1Y3QgY2dyb3VwX3N1YnN5c19zdGF0ZSAqcm9v
dF9jc3MpOwoKIGJvb2wgZWFybHlfaW5pdDoxOwojIDY1NyAiLi9pbmNsdWRlL2xpbnV4L2Nn
cm91cC1kZWZzLmgiCiBib29sIGltcGxpY2l0X29uX2RmbDoxOwojIDY2OSAiLi9pbmNsdWRl
L2xpbnV4L2Nncm91cC1kZWZzLmgiCiBib29sIHRocmVhZGVkOjE7CiMgNjgzICIuL2luY2x1
ZGUvbGludXgvY2dyb3VwLWRlZnMuaCIKIGJvb2wgYnJva2VuX2hpZXJhcmNoeToxOwogYm9v
bCB3YXJuZWRfYnJva2VuX2hpZXJhcmNoeToxOwoKCiBpbnQgaWQ7CiBjb25zdCBjaGFyICpu
YW1lOwoKCiBjb25zdCBjaGFyICpsZWdhY3lfbmFtZTsKCgogc3RydWN0IGNncm91cF9yb290
ICpyb290OwoKCiBzdHJ1Y3QgaWRyIGNzc19pZHI7CgoKCgoKIHN0cnVjdCBsaXN0X2hlYWQg
Y2Z0czsKCgoKCgogc3RydWN0IGNmdHlwZSAqZGZsX2NmdHlwZXM7CiBzdHJ1Y3QgY2Z0eXBl
ICpsZWdhY3lfY2Z0eXBlczsKIyA3MTkgIi4vaW5jbHVkZS9saW51eC9jZ3JvdXAtZGVmcy5o
IgogdW5zaWduZWQgaW50IGRlcGVuZHNfb247Cn07CgpleHRlcm4gc3RydWN0IHBlcmNwdV9y
d19zZW1hcGhvcmUgY2dyb3VwX3RocmVhZGdyb3VwX3J3c2VtOwojIDczMSAiLi9pbmNsdWRl
L2xpbnV4L2Nncm91cC1kZWZzLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGNncm91cF90aHJlYWRncm91
cF9jaGFuZ2VfYmVnaW4oc3RydWN0IHRhc2tfc3RydWN0ICp0c2spCnsKIHBlcmNwdV9kb3du
X3JlYWQoJmNncm91cF90aHJlYWRncm91cF9yd3NlbSk7Cn0KCgoKCgoKCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2
b2lkIGNncm91cF90aHJlYWRncm91cF9jaGFuZ2VfZW5kKHN0cnVjdCB0YXNrX3N0cnVjdCAq
dHNrKQp7CiBwZXJjcHVfdXBfcmVhZCgmY2dyb3VwX3RocmVhZGdyb3VwX3J3c2VtKTsKfQoj
IDg2NyAiLi9pbmNsdWRlL2xpbnV4L2Nncm91cC1kZWZzLmgiCnN0cnVjdCBzb2NrX2Nncm91
cF9kYXRhIHsKfTsKIyAyOSAiLi9pbmNsdWRlL2xpbnV4L2Nncm91cC5oIiAyCgpzdHJ1Y3Qg
a2VybmVsX2Nsb25lX2FyZ3M7CiMgNTIgIi4vaW5jbHVkZS9saW51eC9jZ3JvdXAuaCIKc3Ry
dWN0IGNzc190YXNrX2l0ZXIgewogc3RydWN0IGNncm91cF9zdWJzeXMgKnNzOwogdW5zaWdu
ZWQgaW50IGZsYWdzOwoKIHN0cnVjdCBsaXN0X2hlYWQgKmNzZXRfcG9zOwogc3RydWN0IGxp
c3RfaGVhZCAqY3NldF9oZWFkOwoKIHN0cnVjdCBsaXN0X2hlYWQgKnRjc2V0X3BvczsKIHN0
cnVjdCBsaXN0X2hlYWQgKnRjc2V0X2hlYWQ7Cgogc3RydWN0IGxpc3RfaGVhZCAqdGFza19w
b3M7Cgogc3RydWN0IGxpc3RfaGVhZCAqY3VyX3Rhc2tzX2hlYWQ7CiBzdHJ1Y3QgY3NzX3Nl
dCAqY3VyX2NzZXQ7CiBzdHJ1Y3QgY3NzX3NldCAqY3VyX2Rjc2V0Owogc3RydWN0IHRhc2tf
c3RydWN0ICpjdXJfdGFzazsKIHN0cnVjdCBsaXN0X2hlYWQgaXRlcnNfbm9kZTsKfTsKCmV4
dGVybiBzdHJ1Y3QgY2dyb3VwX3Jvb3QgY2dycF9kZmxfcm9vdDsKZXh0ZXJuIHN0cnVjdCBj
c3Nfc2V0IGluaXRfY3NzX3NldDsKCgojIDEgIi4vaW5jbHVkZS9saW51eC9jZ3JvdXBfc3Vi
c3lzLmgiIDEKIyAxMyAiLi9pbmNsdWRlL2xpbnV4L2Nncm91cF9zdWJzeXMuaCIKZXh0ZXJu
IHN0cnVjdCBjZ3JvdXBfc3Vic3lzIGNwdXNldF9jZ3JwX3N1YnN5czsKCgoKZXh0ZXJuIHN0
cnVjdCBjZ3JvdXBfc3Vic3lzIGNwdV9jZ3JwX3N1YnN5czsKCgoKZXh0ZXJuIHN0cnVjdCBj
Z3JvdXBfc3Vic3lzIGNwdWFjY3RfY2dycF9zdWJzeXM7CiMgNzYgIi4vaW5jbHVkZS9saW51
eC9jZ3JvdXAuaCIgMgoKCgoKCiMgMSAiLi9pbmNsdWRlL2xpbnV4L2Nncm91cF9zdWJzeXMu
aCIgMQojIDEzICIuL2luY2x1ZGUvbGludXgvY2dyb3VwX3N1YnN5cy5oIgpleHRlcm4gc3Ry
dWN0IHN0YXRpY19rZXlfdHJ1ZSBjcHVzZXRfY2dycF9zdWJzeXNfZW5hYmxlZF9rZXk7IGV4
dGVybiBzdHJ1Y3Qgc3RhdGljX2tleV90cnVlIGNwdXNldF9jZ3JwX3N1YnN5c19vbl9kZmxf
a2V5OwoKCgpleHRlcm4gc3RydWN0IHN0YXRpY19rZXlfdHJ1ZSBjcHVfY2dycF9zdWJzeXNf
ZW5hYmxlZF9rZXk7IGV4dGVybiBzdHJ1Y3Qgc3RhdGljX2tleV90cnVlIGNwdV9jZ3JwX3N1
YnN5c19vbl9kZmxfa2V5OwoKCgpleHRlcm4gc3RydWN0IHN0YXRpY19rZXlfdHJ1ZSBjcHVh
Y2N0X2NncnBfc3Vic3lzX2VuYWJsZWRfa2V5OyBleHRlcm4gc3RydWN0IHN0YXRpY19rZXlf
dHJ1ZSBjcHVhY2N0X2NncnBfc3Vic3lzX29uX2RmbF9rZXk7CiMgODIgIi4vaW5jbHVkZS9s
aW51eC9jZ3JvdXAuaCIgMgojIDk4ICIuL2luY2x1ZGUvbGludXgvY2dyb3VwLmgiCmJvb2wg
Y3NzX2hhc19vbmxpbmVfY2hpbGRyZW4oc3RydWN0IGNncm91cF9zdWJzeXNfc3RhdGUgKmNz
cyk7CnN0cnVjdCBjZ3JvdXBfc3Vic3lzX3N0YXRlICpjc3NfZnJvbV9pZChpbnQgaWQsIHN0
cnVjdCBjZ3JvdXBfc3Vic3lzICpzcyk7CnN0cnVjdCBjZ3JvdXBfc3Vic3lzX3N0YXRlICpj
Z3JvdXBfZV9jc3Moc3RydWN0IGNncm91cCAqY2dyb3VwLAogICAgICBzdHJ1Y3QgY2dyb3Vw
X3N1YnN5cyAqc3MpOwpzdHJ1Y3QgY2dyb3VwX3N1YnN5c19zdGF0ZSAqY2dyb3VwX2dldF9l
X2NzcyhzdHJ1Y3QgY2dyb3VwICpjZ3JvdXAsCiAgICAgICAgICBzdHJ1Y3QgY2dyb3VwX3N1
YnN5cyAqc3MpOwpzdHJ1Y3QgY2dyb3VwX3N1YnN5c19zdGF0ZSAqY3NzX3RyeWdldF9vbmxp
bmVfZnJvbV9kaXIoc3RydWN0IGRlbnRyeSAqZGVudHJ5LAogICAgICAgICAgICAgc3RydWN0
IGNncm91cF9zdWJzeXMgKnNzKTsKCnN0cnVjdCBjZ3JvdXAgKmNncm91cF9nZXRfZnJvbV9w
YXRoKGNvbnN0IGNoYXIgKnBhdGgpOwpzdHJ1Y3QgY2dyb3VwICpjZ3JvdXBfZ2V0X2Zyb21f
ZmQoaW50IGZkKTsKCmludCBjZ3JvdXBfYXR0YWNoX3Rhc2tfYWxsKHN0cnVjdCB0YXNrX3N0
cnVjdCAqZnJvbSwgc3RydWN0IHRhc2tfc3RydWN0ICopOwppbnQgY2dyb3VwX3RyYW5zZmVy
X3Rhc2tzKHN0cnVjdCBjZ3JvdXAgKnRvLCBzdHJ1Y3QgY2dyb3VwICpmcm9tKTsKCmludCBj
Z3JvdXBfYWRkX2RmbF9jZnR5cGVzKHN0cnVjdCBjZ3JvdXBfc3Vic3lzICpzcywgc3RydWN0
IGNmdHlwZSAqY2Z0cyk7CmludCBjZ3JvdXBfYWRkX2xlZ2FjeV9jZnR5cGVzKHN0cnVjdCBj
Z3JvdXBfc3Vic3lzICpzcywgc3RydWN0IGNmdHlwZSAqY2Z0cyk7CmludCBjZ3JvdXBfcm1f
Y2Z0eXBlcyhzdHJ1Y3QgY2Z0eXBlICpjZnRzKTsKdm9pZCBjZ3JvdXBfZmlsZV9ub3RpZnko
c3RydWN0IGNncm91cF9maWxlICpjZmlsZSk7CgppbnQgdGFza19jZ3JvdXBfcGF0aChzdHJ1
Y3QgdGFza19zdHJ1Y3QgKnRhc2ssIGNoYXIgKmJ1Ziwgc2l6ZV90IGJ1Zmxlbik7CmludCBj
Z3JvdXBzdGF0c19idWlsZChzdHJ1Y3QgY2dyb3Vwc3RhdHMgKnN0YXRzLCBzdHJ1Y3QgZGVu
dHJ5ICpkZW50cnkpOwppbnQgcHJvY19jZ3JvdXBfc2hvdyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0s
IHN0cnVjdCBwaWRfbmFtZXNwYWNlICpucywKICAgICAgIHN0cnVjdCBwaWQgKnBpZCwgc3Ry
dWN0IHRhc2tfc3RydWN0ICp0c2spOwoKdm9pZCBjZ3JvdXBfZm9yayhzdHJ1Y3QgdGFza19z
dHJ1Y3QgKnApOwpleHRlcm4gaW50IGNncm91cF9jYW5fZm9yayhzdHJ1Y3QgdGFza19zdHJ1
Y3QgKnAsCiAgICAgIHN0cnVjdCBrZXJuZWxfY2xvbmVfYXJncyAqa2FyZ3MpOwpleHRlcm4g
dm9pZCBjZ3JvdXBfY2FuY2VsX2Zvcmsoc3RydWN0IHRhc2tfc3RydWN0ICpwLAogICAgICAg
ICAgc3RydWN0IGtlcm5lbF9jbG9uZV9hcmdzICprYXJncyk7CmV4dGVybiB2b2lkIGNncm91
cF9wb3N0X2Zvcmsoc3RydWN0IHRhc2tfc3RydWN0ICpwLAogICAgICAgIHN0cnVjdCBrZXJu
ZWxfY2xvbmVfYXJncyAqa2FyZ3MpOwp2b2lkIGNncm91cF9leGl0KHN0cnVjdCB0YXNrX3N0
cnVjdCAqcCk7CnZvaWQgY2dyb3VwX3JlbGVhc2Uoc3RydWN0IHRhc2tfc3RydWN0ICpwKTsK
dm9pZCBjZ3JvdXBfZnJlZShzdHJ1Y3QgdGFza19zdHJ1Y3QgKnApOwoKaW50IGNncm91cF9p
bml0X2Vhcmx5KHZvaWQpOwppbnQgY2dyb3VwX2luaXQodm9pZCk7CgppbnQgY2dyb3VwX3Bh
cnNlX2Zsb2F0KGNvbnN0IGNoYXIgKmlucHV0LCB1bnNpZ25lZCBkZWNfc2hpZnQsIHM2NCAq
dik7CgoKCgoKc3RydWN0IGNncm91cF9zdWJzeXNfc3RhdGUgKmNzc19uZXh0X2NoaWxkKHN0
cnVjdCBjZ3JvdXBfc3Vic3lzX3N0YXRlICpwb3MsCiAgICAgICAgc3RydWN0IGNncm91cF9z
dWJzeXNfc3RhdGUgKnBhcmVudCk7CnN0cnVjdCBjZ3JvdXBfc3Vic3lzX3N0YXRlICpjc3Nf
bmV4dF9kZXNjZW5kYW50X3ByZShzdHJ1Y3QgY2dyb3VwX3N1YnN5c19zdGF0ZSAqcG9zLAog
ICAgICAgICAgc3RydWN0IGNncm91cF9zdWJzeXNfc3RhdGUgKmNzcyk7CnN0cnVjdCBjZ3Jv
dXBfc3Vic3lzX3N0YXRlICpjc3NfcmlnaHRtb3N0X2Rlc2NlbmRhbnQoc3RydWN0IGNncm91
cF9zdWJzeXNfc3RhdGUgKnBvcyk7CnN0cnVjdCBjZ3JvdXBfc3Vic3lzX3N0YXRlICpjc3Nf
bmV4dF9kZXNjZW5kYW50X3Bvc3Qoc3RydWN0IGNncm91cF9zdWJzeXNfc3RhdGUgKnBvcywK
ICAgICAgICAgICBzdHJ1Y3QgY2dyb3VwX3N1YnN5c19zdGF0ZSAqY3NzKTsKCnN0cnVjdCB0
YXNrX3N0cnVjdCAqY2dyb3VwX3Rhc2tzZXRfZmlyc3Qoc3RydWN0IGNncm91cF90YXNrc2V0
ICp0c2V0LAogICAgICBzdHJ1Y3QgY2dyb3VwX3N1YnN5c19zdGF0ZSAqKmRzdF9jc3NwKTsK
c3RydWN0IHRhc2tfc3RydWN0ICpjZ3JvdXBfdGFza3NldF9uZXh0KHN0cnVjdCBjZ3JvdXBf
dGFza3NldCAqdHNldCwKICAgICBzdHJ1Y3QgY2dyb3VwX3N1YnN5c19zdGF0ZSAqKmRzdF9j
c3NwKTsKCnZvaWQgY3NzX3Rhc2tfaXRlcl9zdGFydChzdHJ1Y3QgY2dyb3VwX3N1YnN5c19z
dGF0ZSAqY3NzLCB1bnNpZ25lZCBpbnQgZmxhZ3MsCiAgICBzdHJ1Y3QgY3NzX3Rhc2tfaXRl
ciAqaXQpOwpzdHJ1Y3QgdGFza19zdHJ1Y3QgKmNzc190YXNrX2l0ZXJfbmV4dChzdHJ1Y3Qg
Y3NzX3Rhc2tfaXRlciAqaXQpOwp2b2lkIGNzc190YXNrX2l0ZXJfZW5kKHN0cnVjdCBjc3Nf
dGFza19pdGVyICppdCk7CiMgMzEwICIuL2luY2x1ZGUvbGludXgvY2dyb3VwLmgiCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSB1NjQgY2dyb3VwX2lkKHN0cnVjdCBjZ3JvdXAgKmNncnApCnsKIHJldHVybiBjZ3Jw
LT5rbi0+aWQ7Cn0KCgoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGNzc19nZXQoc3RydWN0IGNncm91
cF9zdWJzeXNfc3RhdGUgKmNzcykKewogaWYgKCEoY3NzLT5mbGFncyAmIENTU19OT19SRUYp
KQogIHBlcmNwdV9yZWZfZ2V0KCZjc3MtPnJlZmNudCk7Cn0KIyAzMzQgIi4vaW5jbHVkZS9s
aW51eC9jZ3JvdXAuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgY3NzX2dldF9tYW55KHN0cnVjdCBjZ3Jv
dXBfc3Vic3lzX3N0YXRlICpjc3MsIHVuc2lnbmVkIGludCBuKQp7CiBpZiAoIShjc3MtPmZs
YWdzICYgQ1NTX05PX1JFRikpCiAgcGVyY3B1X3JlZl9nZXRfbWFueSgmY3NzLT5yZWZjbnQs
IG4pOwp9CiMgMzUxICIuL2luY2x1ZGUvbGludXgvY2dyb3VwLmgiCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29s
IGNzc190cnlnZXQoc3RydWN0IGNncm91cF9zdWJzeXNfc3RhdGUgKmNzcykKewogaWYgKCEo
Y3NzLT5mbGFncyAmIENTU19OT19SRUYpKQogIHJldHVybiBwZXJjcHVfcmVmX3RyeWdldCgm
Y3NzLT5yZWZjbnQpOwogcmV0dXJuIHRydWU7Cn0KIyAzNjggIi4vaW5jbHVkZS9saW51eC9j
Z3JvdXAuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgY3NzX3RyeWdldF9vbmxpbmUoc3RydWN0IGNncm91
cF9zdWJzeXNfc3RhdGUgKmNzcykKewogaWYgKCEoY3NzLT5mbGFncyAmIENTU19OT19SRUYp
KQogIHJldHVybiBwZXJjcHVfcmVmX3RyeWdldF9saXZlKCZjc3MtPnJlZmNudCk7CiByZXR1
cm4gdHJ1ZTsKfQojIDM5MCAiLi9pbmNsdWRlL2xpbnV4L2Nncm91cC5oIgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
Ym9vbCBjc3NfaXNfZHlpbmcoc3RydWN0IGNncm91cF9zdWJzeXNfc3RhdGUgKmNzcykKewog
cmV0dXJuICEoY3NzLT5mbGFncyAmIENTU19OT19SRUYpICYmIHBlcmNwdV9yZWZfaXNfZHlp
bmcoJmNzcy0+cmVmY250KTsKfQoKCgoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgY3NzX3B1dChzdHJ1
Y3QgY2dyb3VwX3N1YnN5c19zdGF0ZSAqY3NzKQp7CiBpZiAoIShjc3MtPmZsYWdzICYgQ1NT
X05PX1JFRikpCiAgcGVyY3B1X3JlZl9wdXQoJmNzcy0+cmVmY250KTsKfQojIDQxNCAiLi9p
bmNsdWRlL2xpbnV4L2Nncm91cC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBjc3NfcHV0X21hbnkoc3Ry
dWN0IGNncm91cF9zdWJzeXNfc3RhdGUgKmNzcywgdW5zaWduZWQgaW50IG4pCnsKIGlmICgh
KGNzcy0+ZmxhZ3MgJiBDU1NfTk9fUkVGKSkKICBwZXJjcHVfcmVmX3B1dF9tYW55KCZjc3Mt
PnJlZmNudCwgbik7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGNncm91cF9nZXQoc3RydWN0IGNncm91
cCAqY2dycCkKewogY3NzX2dldCgmY2dycC0+c2VsZik7Cn0KCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIGNn
cm91cF90cnlnZXQoc3RydWN0IGNncm91cCAqY2dycCkKewogcmV0dXJuIGNzc190cnlnZXQo
JmNncnAtPnNlbGYpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBjZ3JvdXBfcHV0KHN0cnVjdCBjZ3Jv
dXAgKmNncnApCnsKIGNzc19wdXQoJmNncnAtPnNlbGYpOwp9CiMgNDc5ICIuL2luY2x1ZGUv
bGludXgvY2dyb3VwLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3QgY3NzX3NldCAqdGFza19jc3Nfc2V0
KHN0cnVjdCB0YXNrX3N0cnVjdCAqdGFzaykKewogcmV0dXJuICh7IHR5cGVvZigqKCh0YXNr
KS0+Y2dyb3VwcykpICpfX19fX19fX3AxID0gKHR5cGVvZigqKCh0YXNrKS0+Y2dyb3Vwcykp
ICopKHsgZG8geyBleHRlcm4gdm9pZCBfX2NvbXBpbGV0aW1lX2Fzc2VydF8yMDcodm9pZCkg
X19hdHRyaWJ1dGVfXygoX19lcnJvcl9fKCJVbnN1cHBvcnRlZCBhY2Nlc3Mgc2l6ZSBmb3Ig
e1JFQUQsV1JJVEV9X09OQ0UoKS4iKSkpOyBpZiAoISgoc2l6ZW9mKCgodGFzayktPmNncm91
cHMpKSA9PSBzaXplb2YoY2hhcikgfHwgc2l6ZW9mKCgodGFzayktPmNncm91cHMpKSA9PSBz
aXplb2Yoc2hvcnQpIHx8IHNpemVvZigoKHRhc2spLT5jZ3JvdXBzKSkgPT0gc2l6ZW9mKGlu
dCkgfHwgc2l6ZW9mKCgodGFzayktPmNncm91cHMpKSA9PSBzaXplb2YobG9uZykpIHx8IHNp
emVvZigoKHRhc2spLT5jZ3JvdXBzKSkgPT0gc2l6ZW9mKGxvbmcgbG9uZykpKSBfX2NvbXBp
bGV0aW1lX2Fzc2VydF8yMDcoKTsgfSB3aGlsZSAoMCk7ICh7IHR5cGVvZiggX0dlbmVyaWMo
KCgodGFzayktPmNncm91cHMpKSwgY2hhcjogKGNoYXIpMCwgdW5zaWduZWQgY2hhcjogKHVu
c2lnbmVkIGNoYXIpMCwgc2lnbmVkIGNoYXI6IChzaWduZWQgY2hhcikwLCB1bnNpZ25lZCBz
aG9ydDogKHVuc2lnbmVkIHNob3J0KTAsIHNpZ25lZCBzaG9ydDogKHNpZ25lZCBzaG9ydCkw
LCB1bnNpZ25lZCBpbnQ6ICh1bnNpZ25lZCBpbnQpMCwgc2lnbmVkIGludDogKHNpZ25lZCBp
bnQpMCwgdW5zaWduZWQgbG9uZzogKHVuc2lnbmVkIGxvbmcpMCwgc2lnbmVkIGxvbmc6IChz
aWduZWQgbG9uZykwLCB1bnNpZ25lZCBsb25nIGxvbmc6ICh1bnNpZ25lZCBsb25nIGxvbmcp
MCwgc2lnbmVkIGxvbmcgbG9uZzogKHNpZ25lZCBsb25nIGxvbmcpMCwgZGVmYXVsdDogKCgo
dGFzayktPmNncm91cHMpKSkpIF9feCA9ICgqKGNvbnN0IHZvbGF0aWxlIHR5cGVvZiggX0dl
bmVyaWMoKCgodGFzayktPmNncm91cHMpKSwgY2hhcjogKGNoYXIpMCwgdW5zaWduZWQgY2hh
cjogKHVuc2lnbmVkIGNoYXIpMCwgc2lnbmVkIGNoYXI6IChzaWduZWQgY2hhcikwLCB1bnNp
Z25lZCBzaG9ydDogKHVuc2lnbmVkIHNob3J0KTAsIHNpZ25lZCBzaG9ydDogKHNpZ25lZCBz
aG9ydCkwLCB1bnNpZ25lZCBpbnQ6ICh1bnNpZ25lZCBpbnQpMCwgc2lnbmVkIGludDogKHNp
Z25lZCBpbnQpMCwgdW5zaWduZWQgbG9uZzogKHVuc2lnbmVkIGxvbmcpMCwgc2lnbmVkIGxv
bmc6IChzaWduZWQgbG9uZykwLCB1bnNpZ25lZCBsb25nIGxvbmc6ICh1bnNpZ25lZCBsb25n
IGxvbmcpMCwgc2lnbmVkIGxvbmcgbG9uZzogKHNpZ25lZCBsb25nIGxvbmcpMCwgZGVmYXVs
dDogKCgodGFzayktPmNncm91cHMpKSkpICopJigoKHRhc2spLT5jZ3JvdXBzKSkpOyBkbyB7
IH0gd2hpbGUgKDApOyAodHlwZW9mKCgodGFzayktPmNncm91cHMpKSlfX3g7IH0pOyB9KTsg
ZG8geyB9IHdoaWxlICgwKTsgOyAoKHR5cGVvZigqKCh0YXNrKS0+Y2dyb3VwcykpICopKF9f
X19fX19fcDEpKTsgfSk7Cn0KIyA0OTEgIi4vaW5jbHVkZS9saW51eC9jZ3JvdXAuaCIKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIHN0cnVjdCBjZ3JvdXBfc3Vic3lzX3N0YXRlICp0YXNrX2NzcyhzdHJ1Y3QgdGFz
a19zdHJ1Y3QgKnRhc2ssCiAgICAgICAgIGludCBzdWJzeXNfaWQpCnsKIHJldHVybiAoeyB0
eXBlb2YoKigoKHRhc2spKS0+Y2dyb3VwcykpICpfX19fX19fX3AxID0gKHR5cGVvZigqKCgo
dGFzaykpLT5jZ3JvdXBzKSkgKikoeyBkbyB7IGV4dGVybiB2b2lkIF9fY29tcGlsZXRpbWVf
YXNzZXJ0XzIwOCh2b2lkKSBfX2F0dHJpYnV0ZV9fKChfX2Vycm9yX18oIlVuc3VwcG9ydGVk
IGFjY2VzcyBzaXplIGZvciB7UkVBRCxXUklURX1fT05DRSgpLiIpKSk7IGlmICghKChzaXpl
b2YoKCgodGFzaykpLT5jZ3JvdXBzKSkgPT0gc2l6ZW9mKGNoYXIpIHx8IHNpemVvZigoKCh0
YXNrKSktPmNncm91cHMpKSA9PSBzaXplb2Yoc2hvcnQpIHx8IHNpemVvZigoKCh0YXNrKSkt
PmNncm91cHMpKSA9PSBzaXplb2YoaW50KSB8fCBzaXplb2YoKCgodGFzaykpLT5jZ3JvdXBz
KSkgPT0gc2l6ZW9mKGxvbmcpKSB8fCBzaXplb2YoKCgodGFzaykpLT5jZ3JvdXBzKSkgPT0g
c2l6ZW9mKGxvbmcgbG9uZykpKSBfX2NvbXBpbGV0aW1lX2Fzc2VydF8yMDgoKTsgfSB3aGls
ZSAoMCk7ICh7IHR5cGVvZiggX0dlbmVyaWMoKCgoKHRhc2spKS0+Y2dyb3VwcykpLCBjaGFy
OiAoY2hhcikwLCB1bnNpZ25lZCBjaGFyOiAodW5zaWduZWQgY2hhcikwLCBzaWduZWQgY2hh
cjogKHNpZ25lZCBjaGFyKTAsIHVuc2lnbmVkIHNob3J0OiAodW5zaWduZWQgc2hvcnQpMCwg
c2lnbmVkIHNob3J0OiAoc2lnbmVkIHNob3J0KTAsIHVuc2lnbmVkIGludDogKHVuc2lnbmVk
IGludCkwLCBzaWduZWQgaW50OiAoc2lnbmVkIGludCkwLCB1bnNpZ25lZCBsb25nOiAodW5z
aWduZWQgbG9uZykwLCBzaWduZWQgbG9uZzogKHNpZ25lZCBsb25nKTAsIHVuc2lnbmVkIGxv
bmcgbG9uZzogKHVuc2lnbmVkIGxvbmcgbG9uZykwLCBzaWduZWQgbG9uZyBsb25nOiAoc2ln
bmVkIGxvbmcgbG9uZykwLCBkZWZhdWx0OiAoKCgodGFzaykpLT5jZ3JvdXBzKSkpKSBfX3gg
PSAoKihjb25zdCB2b2xhdGlsZSB0eXBlb2YoIF9HZW5lcmljKCgoKCh0YXNrKSktPmNncm91
cHMpKSwgY2hhcjogKGNoYXIpMCwgdW5zaWduZWQgY2hhcjogKHVuc2lnbmVkIGNoYXIpMCwg
c2lnbmVkIGNoYXI6IChzaWduZWQgY2hhcikwLCB1bnNpZ25lZCBzaG9ydDogKHVuc2lnbmVk
IHNob3J0KTAsIHNpZ25lZCBzaG9ydDogKHNpZ25lZCBzaG9ydCkwLCB1bnNpZ25lZCBpbnQ6
ICh1bnNpZ25lZCBpbnQpMCwgc2lnbmVkIGludDogKHNpZ25lZCBpbnQpMCwgdW5zaWduZWQg
bG9uZzogKHVuc2lnbmVkIGxvbmcpMCwgc2lnbmVkIGxvbmc6IChzaWduZWQgbG9uZykwLCB1
bnNpZ25lZCBsb25nIGxvbmc6ICh1bnNpZ25lZCBsb25nIGxvbmcpMCwgc2lnbmVkIGxvbmcg
bG9uZzogKHNpZ25lZCBsb25nIGxvbmcpMCwgZGVmYXVsdDogKCgoKHRhc2spKS0+Y2dyb3Vw
cykpKSkgKikmKCgoKHRhc2spKS0+Y2dyb3VwcykpKTsgZG8geyB9IHdoaWxlICgwKTsgKHR5
cGVvZigoKCh0YXNrKSktPmNncm91cHMpKSlfX3g7IH0pOyB9KTsgZG8geyB9IHdoaWxlICgw
KTsgOyAoKHR5cGVvZigqKCgodGFzaykpLT5jZ3JvdXBzKSkgKikoX19fX19fX19wMSkpOyB9
KS0+c3Vic3lzWyhzdWJzeXNfaWQpXTsKfQojIDUwNiAiLi9pbmNsdWRlL2xpbnV4L2Nncm91
cC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgc3RydWN0IGNncm91cF9zdWJzeXNfc3RhdGUgKgp0YXNrX2dldF9j
c3Moc3RydWN0IHRhc2tfc3RydWN0ICp0YXNrLCBpbnQgc3Vic3lzX2lkKQp7CiBzdHJ1Y3Qg
Y2dyb3VwX3N1YnN5c19zdGF0ZSAqY3NzOwoKIHJjdV9yZWFkX2xvY2soKTsKIHdoaWxlICh0
cnVlKSB7CiAgY3NzID0gdGFza19jc3ModGFzaywgc3Vic3lzX2lkKTsKCgoKCgoKICBpZiAo
X19idWlsdGluX2V4cGVjdCghIShjc3NfdHJ5Z2V0KGNzcykpLCAxKSkKICAgYnJlYWs7CiAg
ZG8geyBhc20gdm9sYXRpbGUoIm9yIDEsMSwxCSAgICAgIyBsb3cgcHJpb3JpdHkiKTsgYXNt
IHZvbGF0aWxlKCJvciAyLDIsMgkgICAgICMgbWVkaXVtIHByaW9yaXR5Iik7IF9fYXNtX18g
X192b2xhdGlsZV9fKCIiOiA6IDoibWVtb3J5Iik7IH0gd2hpbGUgKDApOwogfQogcmN1X3Jl
YWRfdW5sb2NrKCk7CiByZXR1cm4gY3NzOwp9CiMgNTM2ICIuL2luY2x1ZGUvbGludXgvY2dy
b3VwLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSBib29sIHRhc2tfY3NzX2lzX3Jvb3Qoc3RydWN0IHRhc2tfc3Ry
dWN0ICp0YXNrLCBpbnQgc3Vic3lzX2lkKQp7CiByZXR1cm4gKHsgdHlwZW9mKCooKCh0YXNr
KSktPmNncm91cHMpKSAqX19fX19fX19wMSA9ICh0eXBlb2YoKigoKHRhc2spKS0+Y2dyb3Vw
cykpICopKHsgZG8geyBleHRlcm4gdm9pZCBfX2NvbXBpbGV0aW1lX2Fzc2VydF8yMDkodm9p
ZCkgX19hdHRyaWJ1dGVfXygoX19lcnJvcl9fKCJVbnN1cHBvcnRlZCBhY2Nlc3Mgc2l6ZSBm
b3Ige1JFQUQsV1JJVEV9X09OQ0UoKS4iKSkpOyBpZiAoISgoc2l6ZW9mKCgoKHRhc2spKS0+
Y2dyb3VwcykpID09IHNpemVvZihjaGFyKSB8fCBzaXplb2YoKCgodGFzaykpLT5jZ3JvdXBz
KSkgPT0gc2l6ZW9mKHNob3J0KSB8fCBzaXplb2YoKCgodGFzaykpLT5jZ3JvdXBzKSkgPT0g
c2l6ZW9mKGludCkgfHwgc2l6ZW9mKCgoKHRhc2spKS0+Y2dyb3VwcykpID09IHNpemVvZihs
b25nKSkgfHwgc2l6ZW9mKCgoKHRhc2spKS0+Y2dyb3VwcykpID09IHNpemVvZihsb25nIGxv
bmcpKSkgX19jb21waWxldGltZV9hc3NlcnRfMjA5KCk7IH0gd2hpbGUgKDApOyAoeyB0eXBl
b2YoIF9HZW5lcmljKCgoKCh0YXNrKSktPmNncm91cHMpKSwgY2hhcjogKGNoYXIpMCwgdW5z
aWduZWQgY2hhcjogKHVuc2lnbmVkIGNoYXIpMCwgc2lnbmVkIGNoYXI6IChzaWduZWQgY2hh
cikwLCB1bnNpZ25lZCBzaG9ydDogKHVuc2lnbmVkIHNob3J0KTAsIHNpZ25lZCBzaG9ydDog
KHNpZ25lZCBzaG9ydCkwLCB1bnNpZ25lZCBpbnQ6ICh1bnNpZ25lZCBpbnQpMCwgc2lnbmVk
IGludDogKHNpZ25lZCBpbnQpMCwgdW5zaWduZWQgbG9uZzogKHVuc2lnbmVkIGxvbmcpMCwg
c2lnbmVkIGxvbmc6IChzaWduZWQgbG9uZykwLCB1bnNpZ25lZCBsb25nIGxvbmc6ICh1bnNp
Z25lZCBsb25nIGxvbmcpMCwgc2lnbmVkIGxvbmcgbG9uZzogKHNpZ25lZCBsb25nIGxvbmcp
MCwgZGVmYXVsdDogKCgoKHRhc2spKS0+Y2dyb3VwcykpKSkgX194ID0gKCooY29uc3Qgdm9s
YXRpbGUgdHlwZW9mKCBfR2VuZXJpYygoKCgodGFzaykpLT5jZ3JvdXBzKSksIGNoYXI6IChj
aGFyKTAsIHVuc2lnbmVkIGNoYXI6ICh1bnNpZ25lZCBjaGFyKTAsIHNpZ25lZCBjaGFyOiAo
c2lnbmVkIGNoYXIpMCwgdW5zaWduZWQgc2hvcnQ6ICh1bnNpZ25lZCBzaG9ydCkwLCBzaWdu
ZWQgc2hvcnQ6IChzaWduZWQgc2hvcnQpMCwgdW5zaWduZWQgaW50OiAodW5zaWduZWQgaW50
KTAsIHNpZ25lZCBpbnQ6IChzaWduZWQgaW50KTAsIHVuc2lnbmVkIGxvbmc6ICh1bnNpZ25l
ZCBsb25nKTAsIHNpZ25lZCBsb25nOiAoc2lnbmVkIGxvbmcpMCwgdW5zaWduZWQgbG9uZyBs
b25nOiAodW5zaWduZWQgbG9uZyBsb25nKTAsIHNpZ25lZCBsb25nIGxvbmc6IChzaWduZWQg
bG9uZyBsb25nKTAsIGRlZmF1bHQ6ICgoKCh0YXNrKSktPmNncm91cHMpKSkpICopJigoKCh0
YXNrKSktPmNncm91cHMpKSk7IGRvIHsgfSB3aGlsZSAoMCk7ICh0eXBlb2YoKCgodGFzaykp
LT5jZ3JvdXBzKSkpX194OyB9KTsgfSk7IGRvIHsgfSB3aGlsZSAoMCk7IDsgKCh0eXBlb2Yo
KigoKHRhc2spKS0+Y2dyb3VwcykpICopKF9fX19fX19fcDEpKTsgfSktPnN1YnN5c1soc3Vi
c3lzX2lkKV0gPT0KICBpbml0X2Nzc19zZXQuc3Vic3lzW3N1YnN5c19pZF07Cn0KCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBzdHJ1Y3QgY2dyb3VwICp0YXNrX2Nncm91cChzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRh
c2ssCiAgICAgIGludCBzdWJzeXNfaWQpCnsKIHJldHVybiB0YXNrX2Nzcyh0YXNrLCBzdWJz
eXNfaWQpLT5jZ3JvdXA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3QgY2dyb3VwICp0YXNrX2RmbF9j
Z3JvdXAoc3RydWN0IHRhc2tfc3RydWN0ICp0YXNrKQp7CiByZXR1cm4gdGFza19jc3Nfc2V0
KHRhc2spLT5kZmxfY2dycDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHN0cnVjdCBjZ3JvdXAgKmNncm91cF9w
YXJlbnQoc3RydWN0IGNncm91cCAqY2dycCkKewogc3RydWN0IGNncm91cF9zdWJzeXNfc3Rh
dGUgKnBhcmVudF9jc3MgPSBjZ3JwLT5zZWxmLnBhcmVudDsKCiBpZiAocGFyZW50X2NzcykK
ICByZXR1cm4gKHsgdm9pZCAqX19tcHRyID0gKHZvaWQgKikocGFyZW50X2Nzcyk7IGRvIHsg
ZXh0ZXJuIHZvaWQgX19jb21waWxldGltZV9hc3NlcnRfMjEwKHZvaWQpIF9fYXR0cmlidXRl
X18oKF9fZXJyb3JfXygicG9pbnRlciB0eXBlIG1pc21hdGNoIGluIGNvbnRhaW5lcl9vZigp
IikpKTsgaWYgKCEoISghX19idWlsdGluX3R5cGVzX2NvbXBhdGlibGVfcCh0eXBlb2YoKihw
YXJlbnRfY3NzKSksIHR5cGVvZigoKHN0cnVjdCBjZ3JvdXAgKikwKS0+c2VsZikpICYmICFf
X2J1aWx0aW5fdHlwZXNfY29tcGF0aWJsZV9wKHR5cGVvZigqKHBhcmVudF9jc3MpKSwgdHlw
ZW9mKHZvaWQpKSkpKSBfX2NvbXBpbGV0aW1lX2Fzc2VydF8yMTAoKTsgfSB3aGlsZSAoMCk7
ICgoc3RydWN0IGNncm91cCAqKShfX21wdHIgLSBfX2J1aWx0aW5fb2Zmc2V0b2Yoc3RydWN0
IGNncm91cCwgc2VsZikpKTsgfSk7CiByZXR1cm4gKCh2b2lkICopMCk7Cn0KIyA1NzEgIi4v
aW5jbHVkZS9saW51eC9jZ3JvdXAuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgY2dyb3VwX2lzX2Rlc2Nl
bmRhbnQoc3RydWN0IGNncm91cCAqY2dycCwKICAgICBzdHJ1Y3QgY2dyb3VwICphbmNlc3Rv
cikKewogaWYgKGNncnAtPnJvb3QgIT0gYW5jZXN0b3ItPnJvb3QgfHwgY2dycC0+bGV2ZWwg
PCBhbmNlc3Rvci0+bGV2ZWwpCiAgcmV0dXJuIGZhbHNlOwogcmV0dXJuIGNncnAtPmFuY2Vz
dG9yX2lkc1thbmNlc3Rvci0+bGV2ZWxdID09IGNncm91cF9pZChhbmNlc3Rvcik7Cn0KIyA1
OTAgIi4vaW5jbHVkZS9saW51eC9jZ3JvdXAuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHN0cnVjdCBjZ3JvdXAg
KmNncm91cF9hbmNlc3RvcihzdHJ1Y3QgY2dyb3VwICpjZ3JwLAogICAgICAgICAgaW50IGFu
Y2VzdG9yX2xldmVsKQp7CiBpZiAoY2dycC0+bGV2ZWwgPCBhbmNlc3Rvcl9sZXZlbCkKICBy
ZXR1cm4gKCh2b2lkICopMCk7CiB3aGlsZSAoY2dycCAmJiBjZ3JwLT5sZXZlbCA+IGFuY2Vz
dG9yX2xldmVsKQogIGNncnAgPSBjZ3JvdXBfcGFyZW50KGNncnApOwogcmV0dXJuIGNncnA7
Cn0KIyA2MDkgIi4vaW5jbHVkZS9saW51eC9jZ3JvdXAuaCIKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgdGFz
a191bmRlcl9jZ3JvdXBfaGllcmFyY2h5KHN0cnVjdCB0YXNrX3N0cnVjdCAqdGFzaywKICAg
ICAgICAgICAgc3RydWN0IGNncm91cCAqYW5jZXN0b3IpCnsKIHN0cnVjdCBjc3Nfc2V0ICpj
c2V0ID0gdGFza19jc3Nfc2V0KHRhc2spOwoKIHJldHVybiBjZ3JvdXBfaXNfZGVzY2VuZGFu
dChjc2V0LT5kZmxfY2dycCwgYW5jZXN0b3IpOwp9CgoKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgY2dyb3Vw
X2lzX3BvcHVsYXRlZChzdHJ1Y3QgY2dyb3VwICpjZ3JwKQp7CiByZXR1cm4gY2dycC0+bnJf
cG9wdWxhdGVkX2NzZXRzICsgY2dycC0+bnJfcG9wdWxhdGVkX2RvbWFpbl9jaGlsZHJlbiAr
CiAgY2dycC0+bnJfcG9wdWxhdGVkX3RocmVhZGVkX2NoaWxkcmVuOwp9CgoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IGlub190IGNncm91cF9pbm8oc3RydWN0IGNncm91cCAqY2dycCkKewogcmV0dXJuIGtlcm5m
c19pbm8oY2dycC0+a24pOwp9CgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHN0cnVjdCBjZnR5cGUgKm9mX2NmdChz
dHJ1Y3Qga2VybmZzX29wZW5fZmlsZSAqb2YpCnsKIHJldHVybiBvZi0+a24tPnByaXY7Cn0K
CnN0cnVjdCBjZ3JvdXBfc3Vic3lzX3N0YXRlICpvZl9jc3Moc3RydWN0IGtlcm5mc19vcGVu
X2ZpbGUgKm9mKTsKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IGNmdHlwZSAqc2VxX2NmdChzdHJ1Y3Qg
c2VxX2ZpbGUgKnNlcSkKewogcmV0dXJuIG9mX2NmdChzZXEtPnByaXZhdGUpOwp9CgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgc3RydWN0IGNncm91cF9zdWJzeXNfc3RhdGUgKnNlcV9jc3Moc3RydWN0IHNlcV9m
aWxlICpzZXEpCnsKIHJldHVybiBvZl9jc3Moc2VxLT5wcml2YXRlKTsKfQoKCgoKCgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgaW50IGNncm91cF9uYW1lKHN0cnVjdCBjZ3JvdXAgKmNncnAsIGNoYXIgKmJ1Ziwg
c2l6ZV90IGJ1ZmxlbikKewogcmV0dXJuIGtlcm5mc19uYW1lKGNncnAtPmtuLCBidWYsIGJ1
Zmxlbik7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgY2dyb3VwX3BhdGgoc3RydWN0IGNncm91cCAqY2dy
cCwgY2hhciAqYnVmLCBzaXplX3QgYnVmbGVuKQp7CiByZXR1cm4ga2VybmZzX3BhdGgoY2dy
cC0+a24sIGJ1ZiwgYnVmbGVuKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgcHJfY29udF9jZ3JvdXBf
bmFtZShzdHJ1Y3QgY2dyb3VwICpjZ3JwKQp7CiBwcl9jb250X2tlcm5mc19uYW1lKGNncnAt
PmtuKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgcHJfY29udF9jZ3JvdXBfcGF0aChzdHJ1Y3QgY2dy
b3VwICpjZ3JwKQp7CiBwcl9jb250X2tlcm5mc19wYXRoKGNncnAtPmtuKTsKfQoKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIHN0cnVjdCBwc2lfZ3JvdXAgKmNncm91cF9wc2koc3RydWN0IGNncm91cCAqY2dycCkK
ewogcmV0dXJuICZjZ3JwLT5wc2k7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGNncm91cF9pbml0X2t0
aHJlYWRkKHZvaWQpCnsKCgoKCgogZ2V0X2N1cnJlbnQoKS0+bm9fY2dyb3VwX21pZ3JhdGlv
biA9IDE7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGNncm91cF9rdGhyZWFkX3JlYWR5KHZvaWQpCnsK
CgoKCiBnZXRfY3VycmVudCgpLT5ub19jZ3JvdXBfbWlncmF0aW9uID0gMDsKfQoKdm9pZCBj
Z3JvdXBfcGF0aF9mcm9tX2tlcm5mc19pZCh1NjQgaWQsIGNoYXIgKmJ1Ziwgc2l6ZV90IGJ1
Zmxlbik7CiMgNzUyICIuL2luY2x1ZGUvbGludXgvY2dyb3VwLmgiCnZvaWQgY2dyb3VwX3Jz
dGF0X3VwZGF0ZWQoc3RydWN0IGNncm91cCAqY2dycCwgaW50IGNwdSk7CnZvaWQgY2dyb3Vw
X3JzdGF0X2ZsdXNoKHN0cnVjdCBjZ3JvdXAgKmNncnApOwp2b2lkIGNncm91cF9yc3RhdF9m
bHVzaF9pcnFzYWZlKHN0cnVjdCBjZ3JvdXAgKmNncnApOwp2b2lkIGNncm91cF9yc3RhdF9m
bHVzaF9ob2xkKHN0cnVjdCBjZ3JvdXAgKmNncnApOwp2b2lkIGNncm91cF9yc3RhdF9mbHVz
aF9yZWxlYXNlKHZvaWQpOwoKCgoKCnZvaWQgY3B1YWNjdF9jaGFyZ2Uoc3RydWN0IHRhc2tf
c3RydWN0ICp0c2ssIHU2NCBjcHV0aW1lKTsKdm9pZCBjcHVhY2N0X2FjY291bnRfZmllbGQo
c3RydWN0IHRhc2tfc3RydWN0ICp0c2ssIGludCBpbmRleCwgdTY0IHZhbCk7CgoKCgoKCnZv
aWQgX19jZ3JvdXBfYWNjb3VudF9jcHV0aW1lKHN0cnVjdCBjZ3JvdXAgKmNncnAsIHU2NCBk
ZWx0YV9leGVjKTsKdm9pZCBfX2Nncm91cF9hY2NvdW50X2NwdXRpbWVfZmllbGQoc3RydWN0
IGNncm91cCAqY2dycCwKICAgICAgICBlbnVtIGNwdV91c2FnZV9zdGF0IGluZGV4LCB1NjQg
ZGVsdGFfZXhlYyk7CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBjZ3JvdXBfYWNjb3VudF9jcHV0aW1lKHN0
cnVjdCB0YXNrX3N0cnVjdCAqdGFzaywKICAgICAgIHU2NCBkZWx0YV9leGVjKQp7CiBzdHJ1
Y3QgY2dyb3VwICpjZ3JwOwoKIGNwdWFjY3RfY2hhcmdlKHRhc2ssIGRlbHRhX2V4ZWMpOwoK
IHJjdV9yZWFkX2xvY2soKTsKIGNncnAgPSB0YXNrX2RmbF9jZ3JvdXAodGFzayk7CiBpZiAo
Y2dyb3VwX3BhcmVudChjZ3JwKSkKICBfX2Nncm91cF9hY2NvdW50X2NwdXRpbWUoY2dycCwg
ZGVsdGFfZXhlYyk7CiByY3VfcmVhZF91bmxvY2soKTsKfQoKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgY2dy
b3VwX2FjY291bnRfY3B1dGltZV9maWVsZChzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRhc2ssCiAg
ICAgIGVudW0gY3B1X3VzYWdlX3N0YXQgaW5kZXgsCiAgICAgIHU2NCBkZWx0YV9leGVjKQp7
CiBzdHJ1Y3QgY2dyb3VwICpjZ3JwOwoKIGNwdWFjY3RfYWNjb3VudF9maWVsZCh0YXNrLCBp
bmRleCwgZGVsdGFfZXhlYyk7CgogcmN1X3JlYWRfbG9jaygpOwogY2dycCA9IHRhc2tfZGZs
X2Nncm91cCh0YXNrKTsKIGlmIChjZ3JvdXBfcGFyZW50KGNncnApKQogIF9fY2dyb3VwX2Fj
Y291bnRfY3B1dGltZV9maWVsZChjZ3JwLCBpbmRleCwgZGVsdGFfZXhlYyk7CiByY3VfcmVh
ZF91bmxvY2soKTsKfQojIDg0OSAiLi9pbmNsdWRlL2xpbnV4L2Nncm91cC5oIgpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgdm9pZCBjZ3JvdXBfc2tfYWxsb2Moc3RydWN0IHNvY2tfY2dyb3VwX2RhdGEgKnNrY2Qp
IHt9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSB2b2lkIGNncm91cF9za19mcmVlKHN0cnVjdCBzb2NrX2Nncm91cF9k
YXRhICpza2NkKSB7fQoKCgpzdHJ1Y3QgY2dyb3VwX25hbWVzcGFjZSB7CiByZWZjb3VudF90
IGNvdW50Owogc3RydWN0IG5zX2NvbW1vbiBuczsKIHN0cnVjdCB1c2VyX25hbWVzcGFjZSAq
dXNlcl9uczsKIHN0cnVjdCB1Y291bnRzICp1Y291bnRzOwogc3RydWN0IGNzc19zZXQgKnJv
b3RfY3NldDsKfTsKCmV4dGVybiBzdHJ1Y3QgY2dyb3VwX25hbWVzcGFjZSBpbml0X2Nncm91
cF9uczsKCgoKdm9pZCBmcmVlX2Nncm91cF9ucyhzdHJ1Y3QgY2dyb3VwX25hbWVzcGFjZSAq
bnMpOwoKc3RydWN0IGNncm91cF9uYW1lc3BhY2UgKmNvcHlfY2dyb3VwX25zKHVuc2lnbmVk
IGxvbmcgZmxhZ3MsCiAgICAgc3RydWN0IHVzZXJfbmFtZXNwYWNlICp1c2VyX25zLAogICAg
IHN0cnVjdCBjZ3JvdXBfbmFtZXNwYWNlICpvbGRfbnMpOwoKaW50IGNncm91cF9wYXRoX25z
KHN0cnVjdCBjZ3JvdXAgKmNncnAsIGNoYXIgKmJ1Ziwgc2l6ZV90IGJ1ZmxlbiwKICAgICBz
dHJ1Y3QgY2dyb3VwX25hbWVzcGFjZSAqbnMpOwojIDg4NyAiLi9pbmNsdWRlL2xpbnV4L2Nn
cm91cC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBnZXRfY2dyb3VwX25zKHN0cnVjdCBjZ3JvdXBfbmFt
ZXNwYWNlICpucykKewogaWYgKG5zKQogIHJlZmNvdW50X2luYygmbnMtPmNvdW50KTsKfQoK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIHZvaWQgcHV0X2Nncm91cF9ucyhzdHJ1Y3QgY2dyb3VwX25hbWVzcGFjZSAq
bnMpCnsKIGlmIChucyAmJiByZWZjb3VudF9kZWNfYW5kX3Rlc3QoJm5zLT5jb3VudCkpCiAg
ZnJlZV9jZ3JvdXBfbnMobnMpOwp9CgoKCnZvaWQgY2dyb3VwX2VudGVyX2Zyb3plbih2b2lk
KTsKdm9pZCBjZ3JvdXBfbGVhdmVfZnJvemVuKGJvb2wgYWx3YXlzX2xlYXZlKTsKdm9pZCBj
Z3JvdXBfdXBkYXRlX2Zyb3plbihzdHJ1Y3QgY2dyb3VwICpjZ3JwKTsKdm9pZCBjZ3JvdXBf
ZnJlZXplKHN0cnVjdCBjZ3JvdXAgKmNncnAsIGJvb2wgZnJlZXplKTsKdm9pZCBjZ3JvdXBf
ZnJlZXplcl9taWdyYXRlX3Rhc2soc3RydWN0IHRhc2tfc3RydWN0ICp0YXNrLCBzdHJ1Y3Qg
Y2dyb3VwICpzcmMsCiAgICAgc3RydWN0IGNncm91cCAqZHN0KTsKCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29s
IGNncm91cF90YXNrX2ZyZWV6ZShzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRhc2spCnsKIGJvb2wg
cmV0OwoKIGlmICh0YXNrLT5mbGFncyAmIDB4MDAyMDAwMDApCiAgcmV0dXJuIGZhbHNlOwoK
IHJjdV9yZWFkX2xvY2soKTsKIHJldCA9IHRlc3RfYml0KENHUlBfRlJFRVpFLCAmdGFza19k
ZmxfY2dyb3VwKHRhc2spLT5mbGFncyk7CiByY3VfcmVhZF91bmxvY2soKTsKCiByZXR1cm4g
cmV0Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBjZ3JvdXBfdGFza19mcm96ZW4oc3RydWN0IHRhc2tf
c3RydWN0ICp0YXNrKQp7CiByZXR1cm4gdGFzay0+ZnJvemVuOwp9CiMgOTU1ICIuL2luY2x1
ZGUvbGludXgvY2dyb3VwLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGNncm91cF9icGZfZ2V0KHN0cnVj
dCBjZ3JvdXAgKmNncnApIHt9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGNncm91cF9icGZfcHV0KHN0cnVj
dCBjZ3JvdXAgKmNncnApIHt9CiMgNTggIi4vaW5jbHVkZS9saW51eC9wZXJmX2V2ZW50Lmgi
IDIKCiMgMSAiLi9pbmNsdWRlL2xpbnV4L3NlY3VyaXR5LmgiIDEKIyAzNCAiLi9pbmNsdWRl
L2xpbnV4L3NlY3VyaXR5LmgiCnN0cnVjdCBsaW51eF9iaW5wcm07CnN0cnVjdCBjcmVkOwpz
dHJ1Y3QgcmxpbWl0OwpzdHJ1Y3Qga2VybmVsX3NpZ2luZm87CnN0cnVjdCBzZW1idWY7CnN0
cnVjdCBrZXJuX2lwY19wZXJtOwpzdHJ1Y3QgYXVkaXRfY29udGV4dDsKc3RydWN0IHN1cGVy
X2Jsb2NrOwpzdHJ1Y3QgaW5vZGU7CnN0cnVjdCBkZW50cnk7CnN0cnVjdCBmaWxlOwpzdHJ1
Y3QgdmZzbW91bnQ7CnN0cnVjdCBwYXRoOwpzdHJ1Y3QgcXN0cjsKc3RydWN0IGlhdHRyOwpz
dHJ1Y3QgZm93bl9zdHJ1Y3Q7CnN0cnVjdCBmaWxlX29wZXJhdGlvbnM7CnN0cnVjdCBtc2df
bXNnOwpzdHJ1Y3QgeGF0dHI7CnN0cnVjdCBrZXJuZnNfbm9kZTsKc3RydWN0IHhmcm1fc2Vj
X2N0eDsKc3RydWN0IG1tX3N0cnVjdDsKc3RydWN0IGZzX2NvbnRleHQ7CnN0cnVjdCBmc19w
YXJhbWV0ZXI7CmVudW0gZnNfdmFsdWVfdHlwZTsKc3RydWN0IHdhdGNoOwpzdHJ1Y3Qgd2F0
Y2hfbm90aWZpY2F0aW9uOwojIDcyICIuL2luY2x1ZGUvbGludXgvc2VjdXJpdHkuaCIKc3Ry
dWN0IGN0bF90YWJsZTsKc3RydWN0IGF1ZGl0X2tydWxlOwpzdHJ1Y3QgdXNlcl9uYW1lc3Bh
Y2U7CnN0cnVjdCB0aW1lem9uZTsKCmVudW0gbHNtX2V2ZW50IHsKIExTTV9QT0xJQ1lfQ0hB
TkdFLAp9OwojIDEwNSAiLi9pbmNsdWRlL2xpbnV4L3NlY3VyaXR5LmgiCmVudW0gbG9ja2Rv
d25fcmVhc29uIHsKIExPQ0tET1dOX05PTkUsCiBMT0NLRE9XTl9NT0RVTEVfU0lHTkFUVVJF
LAogTE9DS0RPV05fREVWX01FTSwKIExPQ0tET1dOX0VGSV9URVNULAogTE9DS0RPV05fS0VY
RUMsCiBMT0NLRE9XTl9ISUJFUk5BVElPTiwKIExPQ0tET1dOX1BDSV9BQ0NFU1MsCiBMT0NL
RE9XTl9JT1BPUlQsCiBMT0NLRE9XTl9NU1IsCiBMT0NLRE9XTl9BQ1BJX1RBQkxFUywKIExP
Q0tET1dOX1BDTUNJQV9DSVMsCiBMT0NLRE9XTl9USU9DU1NFUklBTCwKIExPQ0tET1dOX01P
RFVMRV9QQVJBTUVURVJTLAogTE9DS0RPV05fTU1JT1RSQUNFLAogTE9DS0RPV05fREVCVUdG
UywKIExPQ0tET1dOX1hNT05fV1IsCiBMT0NLRE9XTl9JTlRFR1JJVFlfTUFYLAogTE9DS0RP
V05fS0NPUkUsCiBMT0NLRE9XTl9LUFJPQkVTLAogTE9DS0RPV05fQlBGX1JFQUQsCiBMT0NL
RE9XTl9QRVJGLAogTE9DS0RPV05fVFJBQ0VGUywKIExPQ0tET1dOX1hNT05fUlcsCiBMT0NL
RE9XTl9DT05GSURFTlRJQUxJVFlfTUFYLAp9OwoKZXh0ZXJuIGNvbnN0IGNoYXIgKmNvbnN0
IGxvY2tkb3duX3JlYXNvbnNbTE9DS0RPV05fQ09ORklERU5USUFMSVRZX01BWCsxXTsKCgpl
eHRlcm4gaW50IGNhcF9jYXBhYmxlKGNvbnN0IHN0cnVjdCBjcmVkICpjcmVkLCBzdHJ1Y3Qg
dXNlcl9uYW1lc3BhY2UgKm5zLAogICAgICAgICBpbnQgY2FwLCB1bnNpZ25lZCBpbnQgb3B0
cyk7CmV4dGVybiBpbnQgY2FwX3NldHRpbWUoY29uc3Qgc3RydWN0IHRpbWVzcGVjNjQgKnRz
LCBjb25zdCBzdHJ1Y3QgdGltZXpvbmUgKnR6KTsKZXh0ZXJuIGludCBjYXBfcHRyYWNlX2Fj
Y2Vzc19jaGVjayhzdHJ1Y3QgdGFza19zdHJ1Y3QgKmNoaWxkLCB1bnNpZ25lZCBpbnQgbW9k
ZSk7CmV4dGVybiBpbnQgY2FwX3B0cmFjZV90cmFjZW1lKHN0cnVjdCB0YXNrX3N0cnVjdCAq
cGFyZW50KTsKZXh0ZXJuIGludCBjYXBfY2FwZ2V0KHN0cnVjdCB0YXNrX3N0cnVjdCAqdGFy
Z2V0LCBrZXJuZWxfY2FwX3QgKmVmZmVjdGl2ZSwga2VybmVsX2NhcF90ICppbmhlcml0YWJs
ZSwga2VybmVsX2NhcF90ICpwZXJtaXR0ZWQpOwpleHRlcm4gaW50IGNhcF9jYXBzZXQoc3Ry
dWN0IGNyZWQgKm5ldywgY29uc3Qgc3RydWN0IGNyZWQgKm9sZCwKICAgICAgICBjb25zdCBr
ZXJuZWxfY2FwX3QgKmVmZmVjdGl2ZSwKICAgICAgICBjb25zdCBrZXJuZWxfY2FwX3QgKmlu
aGVyaXRhYmxlLAogICAgICAgIGNvbnN0IGtlcm5lbF9jYXBfdCAqcGVybWl0dGVkKTsKZXh0
ZXJuIGludCBjYXBfYnBybV9jcmVkc19mcm9tX2ZpbGUoc3RydWN0IGxpbnV4X2JpbnBybSAq
YnBybSwgc3RydWN0IGZpbGUgKmZpbGUpOwpleHRlcm4gaW50IGNhcF9pbm9kZV9zZXR4YXR0
cihzdHJ1Y3QgZGVudHJ5ICpkZW50cnksIGNvbnN0IGNoYXIgKm5hbWUsCiAgICAgICAgIGNv
bnN0IHZvaWQgKnZhbHVlLCBzaXplX3Qgc2l6ZSwgaW50IGZsYWdzKTsKZXh0ZXJuIGludCBj
YXBfaW5vZGVfcmVtb3ZleGF0dHIoc3RydWN0IGRlbnRyeSAqZGVudHJ5LCBjb25zdCBjaGFy
ICpuYW1lKTsKZXh0ZXJuIGludCBjYXBfaW5vZGVfbmVlZF9raWxscHJpdihzdHJ1Y3QgZGVu
dHJ5ICpkZW50cnkpOwpleHRlcm4gaW50IGNhcF9pbm9kZV9raWxscHJpdihzdHJ1Y3QgZGVu
dHJ5ICpkZW50cnkpOwpleHRlcm4gaW50IGNhcF9pbm9kZV9nZXRzZWN1cml0eShzdHJ1Y3Qg
aW5vZGUgKmlub2RlLCBjb25zdCBjaGFyICpuYW1lLAogICAgIHZvaWQgKipidWZmZXIsIGJv
b2wgYWxsb2MpOwpleHRlcm4gaW50IGNhcF9tbWFwX2FkZHIodW5zaWduZWQgbG9uZyBhZGRy
KTsKZXh0ZXJuIGludCBjYXBfbW1hcF9maWxlKHN0cnVjdCBmaWxlICpmaWxlLCB1bnNpZ25l
ZCBsb25nIHJlcXByb3QsCiAgICB1bnNpZ25lZCBsb25nIHByb3QsIHVuc2lnbmVkIGxvbmcg
ZmxhZ3MpOwpleHRlcm4gaW50IGNhcF90YXNrX2ZpeF9zZXR1aWQoc3RydWN0IGNyZWQgKm5l
dywgY29uc3Qgc3RydWN0IGNyZWQgKm9sZCwgaW50IGZsYWdzKTsKZXh0ZXJuIGludCBjYXBf
dGFza19wcmN0bChpbnQgb3B0aW9uLCB1bnNpZ25lZCBsb25nIGFyZzIsIHVuc2lnbmVkIGxv
bmcgYXJnMywKICAgICB1bnNpZ25lZCBsb25nIGFyZzQsIHVuc2lnbmVkIGxvbmcgYXJnNSk7
CmV4dGVybiBpbnQgY2FwX3Rhc2tfc2V0c2NoZWR1bGVyKHN0cnVjdCB0YXNrX3N0cnVjdCAq
cCk7CmV4dGVybiBpbnQgY2FwX3Rhc2tfc2V0aW9wcmlvKHN0cnVjdCB0YXNrX3N0cnVjdCAq
cCwgaW50IGlvcHJpbyk7CmV4dGVybiBpbnQgY2FwX3Rhc2tfc2V0bmljZShzdHJ1Y3QgdGFz
a19zdHJ1Y3QgKnAsIGludCBuaWNlKTsKZXh0ZXJuIGludCBjYXBfdm1fZW5vdWdoX21lbW9y
eShzdHJ1Y3QgbW1fc3RydWN0ICptbSwgbG9uZyBwYWdlcyk7CgpzdHJ1Y3QgbXNnaGRyOwpz
dHJ1Y3Qgc2tfYnVmZjsKc3RydWN0IHNvY2s7CnN0cnVjdCBzb2NrYWRkcjsKc3RydWN0IHNv
Y2tldDsKc3RydWN0IGZsb3dpOwpzdHJ1Y3QgZHN0X2VudHJ5OwpzdHJ1Y3QgeGZybV9zZWxl
Y3RvcjsKc3RydWN0IHhmcm1fcG9saWN5OwpzdHJ1Y3QgeGZybV9zdGF0ZTsKc3RydWN0IHhm
cm1fdXNlcl9zZWNfY3R4OwpzdHJ1Y3Qgc2VxX2ZpbGU7CnN0cnVjdCBzY3RwX2VuZHBvaW50
OwoKCmV4dGVybiB1bnNpZ25lZCBsb25nIG1tYXBfbWluX2FkZHI7CmV4dGVybiB1bnNpZ25l
ZCBsb25nIGRhY19tbWFwX21pbl9hZGRyOwojIDIwNiAiLi9pbmNsdWRlL2xpbnV4L3NlY3Vy
aXR5LmgiCnN0cnVjdCBzY2hlZF9wYXJhbTsKc3RydWN0IHJlcXVlc3Rfc29jazsKCgoKCgoK
CmV4dGVybiBpbnQgbW1hcF9taW5fYWRkcl9oYW5kbGVyKHN0cnVjdCBjdGxfdGFibGUgKnRh
YmxlLCBpbnQgd3JpdGUsCiAgICAgdm9pZCAqYnVmZmVyLCBzaXplX3QgKmxlbnAsIGxvZmZf
dCAqcHBvcyk7CgoKCnR5cGVkZWYgaW50ICgqaW5pdHhhdHRycykgKHN0cnVjdCBpbm9kZSAq
aW5vZGUsCiAgICAgIGNvbnN0IHN0cnVjdCB4YXR0ciAqeGF0dHJfYXJyYXksIHZvaWQgKmZz
X2RhdGEpOwoKCgoKCgplbnVtIGtlcm5lbF9sb2FkX2RhdGFfaWQgewogTE9BRElOR19VTktO
T1dOLCBMT0FESU5HX0ZJUk1XQVJFLCBMT0FESU5HX0ZJUk1XQVJFX1BSRUFMTE9DX0JVRkZF
UiwgTE9BRElOR19GSVJNV0FSRV9FRklfRU1CRURERUQsIExPQURJTkdfTU9EVUxFLCBMT0FE
SU5HX0tFWEVDX0lNQUdFLCBMT0FESU5HX0tFWEVDX0lOSVRSQU1GUywgTE9BRElOR19QT0xJ
Q1ksIExPQURJTkdfWDUwOV9DRVJUSUZJQ0FURSwgTE9BRElOR19NQVhfSUQsCn07CgpzdGF0
aWMgY29uc3QgY2hhciAqIGNvbnN0IGtlcm5lbF9sb2FkX2RhdGFfc3RyW10gPSB7CiAidW5r
bm93biIsICJmaXJtd2FyZSIsICJmaXJtd2FyZSIsICJmaXJtd2FyZSIsICJrZXJuZWwtbW9k
dWxlIiwgImtleGVjLWltYWdlIiwgImtleGVjLWluaXRyYW1mcyIsICJzZWN1cml0eS1wb2xp
Y3kiLCAieDUwOS1jZXJ0aWZpY2F0ZSIsICIiLAp9OwoKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGNvbnN0IGNoYXIg
Kmtlcm5lbF9sb2FkX2RhdGFfaWRfc3RyKGVudW0ga2VybmVsX2xvYWRfZGF0YV9pZCBpZCkK
ewogaWYgKCh1bnNpZ25lZClpZCA+PSBMT0FESU5HX01BWF9JRCkKICByZXR1cm4ga2VybmVs
X2xvYWRfZGF0YV9zdHJbTE9BRElOR19VTktOT1dOXTsKCiByZXR1cm4ga2VybmVsX2xvYWRf
ZGF0YV9zdHJbaWRdOwp9CiMgNDU2ICIuL2luY2x1ZGUvbGludXgvc2VjdXJpdHkuaCIKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIGludCBjYWxsX2Jsb2NraW5nX2xzbV9ub3RpZmllcihlbnVtIGxzbV9ldmVudCBl
dmVudCwgdm9pZCAqZGF0YSkKewogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgcmVnaXN0
ZXJfYmxvY2tpbmdfbHNtX25vdGlmaWVyKHN0cnVjdCBub3RpZmllcl9ibG9jayAqbmIpCnsK
IHJldHVybiAwOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHVucmVnaXN0ZXJfYmxvY2tpbmdfbHNtX25v
dGlmaWVyKHN0cnVjdCBub3RpZmllcl9ibG9jayAqbmIpCnsKIHJldHVybiAwOwp9CgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgdm9pZCBzZWN1cml0eV9mcmVlX21udF9vcHRzKHZvaWQgKiptbnRfb3B0cykKewp9
CgoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSBpbnQgc2VjdXJpdHlfaW5pdCh2b2lkKQp7CiByZXR1cm4gMDsK
fQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIGludCBlYXJseV9zZWN1cml0eV9pbml0KHZvaWQpCnsKIHJldHVybiAw
Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgaW50IHNlY3VyaXR5X2JpbmRlcl9zZXRfY29udGV4dF9tZ3Ioc3Ry
dWN0IHRhc2tfc3RydWN0ICptZ3IpCnsKIHJldHVybiAwOwp9CgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHNl
Y3VyaXR5X2JpbmRlcl90cmFuc2FjdGlvbihzdHJ1Y3QgdGFza19zdHJ1Y3QgKmZyb20sCiAg
ICAgICAgICAgc3RydWN0IHRhc2tfc3RydWN0ICp0bykKewogcmV0dXJuIDA7Cn0KCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBpbnQgc2VjdXJpdHlfYmluZGVyX3RyYW5zZmVyX2JpbmRlcihzdHJ1Y3QgdGFza19z
dHJ1Y3QgKmZyb20sCiAgICAgICAgc3RydWN0IHRhc2tfc3RydWN0ICp0bykKewogcmV0dXJu
IDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSBpbnQgc2VjdXJpdHlfYmluZGVyX3RyYW5zZmVyX2ZpbGUoc3Ry
dWN0IHRhc2tfc3RydWN0ICpmcm9tLAogICAgICBzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRvLAog
ICAgICBzdHJ1Y3QgZmlsZSAqZmlsZSkKewogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQg
c2VjdXJpdHlfcHRyYWNlX2FjY2Vzc19jaGVjayhzdHJ1Y3QgdGFza19zdHJ1Y3QgKmNoaWxk
LAogICAgICAgICAgdW5zaWduZWQgaW50IG1vZGUpCnsKIHJldHVybiBjYXBfcHRyYWNlX2Fj
Y2Vzc19jaGVjayhjaGlsZCwgbW9kZSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgc2VjdXJpdHlfcHRy
YWNlX3RyYWNlbWUoc3RydWN0IHRhc2tfc3RydWN0ICpwYXJlbnQpCnsKIHJldHVybiBjYXBf
cHRyYWNlX3RyYWNlbWUocGFyZW50KTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBzZWN1cml0eV9jYXBn
ZXQoc3RydWN0IHRhc2tfc3RydWN0ICp0YXJnZXQsCiAgICAgICBrZXJuZWxfY2FwX3QgKmVm
ZmVjdGl2ZSwKICAgICAgIGtlcm5lbF9jYXBfdCAqaW5oZXJpdGFibGUsCiAgICAgICBrZXJu
ZWxfY2FwX3QgKnBlcm1pdHRlZCkKewogcmV0dXJuIGNhcF9jYXBnZXQodGFyZ2V0LCBlZmZl
Y3RpdmUsIGluaGVyaXRhYmxlLCBwZXJtaXR0ZWQpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHNlY3Vy
aXR5X2NhcHNldChzdHJ1Y3QgY3JlZCAqbmV3LAogICAgICAgY29uc3Qgc3RydWN0IGNyZWQg
Km9sZCwKICAgICAgIGNvbnN0IGtlcm5lbF9jYXBfdCAqZWZmZWN0aXZlLAogICAgICAgY29u
c3Qga2VybmVsX2NhcF90ICppbmhlcml0YWJsZSwKICAgICAgIGNvbnN0IGtlcm5lbF9jYXBf
dCAqcGVybWl0dGVkKQp7CiByZXR1cm4gY2FwX2NhcHNldChuZXcsIG9sZCwgZWZmZWN0aXZl
LCBpbmhlcml0YWJsZSwgcGVybWl0dGVkKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBzZWN1cml0eV9j
YXBhYmxlKGNvbnN0IHN0cnVjdCBjcmVkICpjcmVkLAogICAgICAgc3RydWN0IHVzZXJfbmFt
ZXNwYWNlICpucywKICAgICAgIGludCBjYXAsCiAgICAgICB1bnNpZ25lZCBpbnQgb3B0cykK
ewogcmV0dXJuIGNhcF9jYXBhYmxlKGNyZWQsIG5zLCBjYXAsIG9wdHMpOwp9CgpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgaW50IHNlY3VyaXR5X3F1b3RhY3RsKGludCBjbWRzLCBpbnQgdHlwZSwgaW50IGlkLAog
ICAgICAgICBzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiKQp7CiByZXR1cm4gMDsKfQoKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIGludCBzZWN1cml0eV9xdW90YV9vbihzdHJ1Y3QgZGVudHJ5ICpkZW50cnkpCnsKIHJl
dHVybiAwOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHNlY3VyaXR5X3N5c2xvZyhpbnQgdHlwZSkKewog
cmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgc2VjdXJpdHlfc2V0dGltZTY0KGNvbnN0IHN0
cnVjdCB0aW1lc3BlYzY0ICp0cywKICAgICAgICAgY29uc3Qgc3RydWN0IHRpbWV6b25lICp0
eikKewogcmV0dXJuIGNhcF9zZXR0aW1lKHRzLCB0eik7Cn0KCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgc2Vj
dXJpdHlfdm1fZW5vdWdoX21lbW9yeV9tbShzdHJ1Y3QgbW1fc3RydWN0ICptbSwgbG9uZyBw
YWdlcykKewogcmV0dXJuIF9fdm1fZW5vdWdoX21lbW9yeShtbSwgcGFnZXMsIGNhcF92bV9l
bm91Z2hfbWVtb3J5KG1tLCBwYWdlcykpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHNlY3VyaXR5X2Jw
cm1fY3JlZHNfZm9yX2V4ZWMoc3RydWN0IGxpbnV4X2JpbnBybSAqYnBybSkKewogcmV0dXJu
IDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSBpbnQgc2VjdXJpdHlfYnBybV9jcmVkc19mcm9tX2ZpbGUoc3Ry
dWN0IGxpbnV4X2JpbnBybSAqYnBybSwKICAgICAgc3RydWN0IGZpbGUgKmZpbGUpCnsKIHJl
dHVybiBjYXBfYnBybV9jcmVkc19mcm9tX2ZpbGUoYnBybSwgZmlsZSk7Cn0KCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBpbnQgc2VjdXJpdHlfYnBybV9jaGVjayhzdHJ1Y3QgbGludXhfYmlucHJtICpicHJtKQp7
CiByZXR1cm4gMDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgc2VjdXJpdHlfYnBybV9jb21taXR0aW5n
X2NyZWRzKHN0cnVjdCBsaW51eF9iaW5wcm0gKmJwcm0pCnsKfQoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQg
c2VjdXJpdHlfYnBybV9jb21taXR0ZWRfY3JlZHMoc3RydWN0IGxpbnV4X2JpbnBybSAqYnBy
bSkKewp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgaW50IHNlY3VyaXR5X2ZzX2NvbnRleHRfZHVwKHN0cnVjdCBm
c19jb250ZXh0ICpmYywKICAgICAgIHN0cnVjdCBmc19jb250ZXh0ICpzcmNfZmMpCnsKIHJl
dHVybiAwOwp9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgc2VjdXJpdHlfZnNfY29udGV4dF9wYXJzZV9wYXJh
bShzdHJ1Y3QgZnNfY29udGV4dCAqZmMsCiAgICAgICAgc3RydWN0IGZzX3BhcmFtZXRlciAq
cGFyYW0pCnsKIHJldHVybiAtNTE5Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHNlY3VyaXR5X3NiX2Fs
bG9jKHN0cnVjdCBzdXBlcl9ibG9jayAqc2IpCnsKIHJldHVybiAwOwp9CgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
dm9pZCBzZWN1cml0eV9zYl9mcmVlKHN0cnVjdCBzdXBlcl9ibG9jayAqc2IpCnsgfQoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIGludCBzZWN1cml0eV9zYl9lYXRfbHNtX29wdHMoY2hhciAqb3B0aW9ucywKICAg
ICAgICB2b2lkICoqbW50X29wdHMpCnsKIHJldHVybiAwOwp9CgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHNl
Y3VyaXR5X3NiX3JlbW91bnQoc3RydWN0IHN1cGVyX2Jsb2NrICpzYiwKICAgICAgICAgIHZv
aWQgKm1udF9vcHRzKQp7CiByZXR1cm4gMDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBzZWN1cml0eV9z
Yl9rZXJuX21vdW50KHN0cnVjdCBzdXBlcl9ibG9jayAqc2IpCnsKIHJldHVybiAwOwp9Cgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgaW50IHNlY3VyaXR5X3NiX3Nob3dfb3B0aW9ucyhzdHJ1Y3Qgc2VxX2ZpbGUg
Km0sCiAgICAgICAgc3RydWN0IHN1cGVyX2Jsb2NrICpzYikKewogcmV0dXJuIDA7Cn0KCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSBpbnQgc2VjdXJpdHlfc2Jfc3RhdGZzKHN0cnVjdCBkZW50cnkgKmRlbnRyeSkK
ewogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgc2VjdXJpdHlfc2JfbW91bnQoY29uc3Qg
Y2hhciAqZGV2X25hbWUsIGNvbnN0IHN0cnVjdCBwYXRoICpwYXRoLAogICAgICAgIGNvbnN0
IGNoYXIgKnR5cGUsIHVuc2lnbmVkIGxvbmcgZmxhZ3MsCiAgICAgICAgdm9pZCAqZGF0YSkK
ewogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgc2VjdXJpdHlfc2JfdW1vdW50KHN0cnVj
dCB2ZnNtb3VudCAqbW50LCBpbnQgZmxhZ3MpCnsKIHJldHVybiAwOwp9CgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
aW50IHNlY3VyaXR5X3NiX3Bpdm90cm9vdChjb25zdCBzdHJ1Y3QgcGF0aCAqb2xkX3BhdGgs
CiAgICAgY29uc3Qgc3RydWN0IHBhdGggKm5ld19wYXRoKQp7CiByZXR1cm4gMDsKfQoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIGludCBzZWN1cml0eV9zYl9zZXRfbW50X29wdHMoc3RydWN0IHN1cGVyX2Jsb2Nr
ICpzYiwKICAgICAgICB2b2lkICptbnRfb3B0cywKICAgICAgICB1bnNpZ25lZCBsb25nIGtl
cm5fZmxhZ3MsCiAgICAgICAgdW5zaWduZWQgbG9uZyAqc2V0X2tlcm5fZmxhZ3MpCnsKIHJl
dHVybiAwOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHNlY3VyaXR5X3NiX2Nsb25lX21udF9vcHRzKGNv
bnN0IHN0cnVjdCBzdXBlcl9ibG9jayAqb2xkc2IsCiAgICAgICAgICAgc3RydWN0IHN1cGVy
X2Jsb2NrICpuZXdzYiwKICAgICAgICAgICB1bnNpZ25lZCBsb25nIGtlcm5fZmxhZ3MsCiAg
ICAgICAgICAgdW5zaWduZWQgbG9uZyAqc2V0X2tlcm5fZmxhZ3MpCnsKIHJldHVybiAwOwp9
CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgaW50IHNlY3VyaXR5X2FkZF9tbnRfb3B0KGNvbnN0IGNoYXIgKm9wdGlv
biwgY29uc3QgY2hhciAqdmFsLAogICAgIGludCBsZW4sIHZvaWQgKiptbnRfb3B0cykKewog
cmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgc2VjdXJpdHlfbW92ZV9tb3VudChjb25zdCBz
dHJ1Y3QgcGF0aCAqZnJvbV9wYXRoLAogICAgICAgICAgY29uc3Qgc3RydWN0IHBhdGggKnRv
X3BhdGgpCnsKIHJldHVybiAwOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHNlY3VyaXR5X3BhdGhfbm90
aWZ5KGNvbnN0IHN0cnVjdCBwYXRoICpwYXRoLCB1NjQgbWFzaywKICAgIHVuc2lnbmVkIGlu
dCBvYmpfdHlwZSkKewogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgc2VjdXJpdHlfaW5v
ZGVfYWxsb2Moc3RydWN0IGlub2RlICppbm9kZSkKewogcmV0dXJuIDA7Cn0KCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSB2b2lkIHNlY3VyaXR5X2lub2RlX2ZyZWUoc3RydWN0IGlub2RlICppbm9kZSkKeyB9Cgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgaW50IHNlY3VyaXR5X2RlbnRyeV9pbml0X3NlY3VyaXR5KHN0cnVjdCBkZW50
cnkgKmRlbnRyeSwKICAgICAgIGludCBtb2RlLAogICAgICAgY29uc3Qgc3RydWN0IHFzdHIg
Km5hbWUsCiAgICAgICB2b2lkICoqY3R4LAogICAgICAgdTMyICpjdHhsZW4pCnsKIHJldHVy
biAtOTU7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgc2VjdXJpdHlfZGVudHJ5X2NyZWF0ZV9maWxlc19h
cyhzdHJ1Y3QgZGVudHJ5ICpkZW50cnksCiAgICAgICAgaW50IG1vZGUsIHN0cnVjdCBxc3Ry
ICpuYW1lLAogICAgICAgIGNvbnN0IHN0cnVjdCBjcmVkICpvbGQsCiAgICAgICAgc3RydWN0
IGNyZWQgKm5ldykKewogcmV0dXJuIDA7Cn0KCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHNlY3VyaXR5X2lu
b2RlX2luaXRfc2VjdXJpdHkoc3RydWN0IGlub2RlICppbm9kZSwKICAgICAgc3RydWN0IGlu
b2RlICpkaXIsCiAgICAgIGNvbnN0IHN0cnVjdCBxc3RyICpxc3RyLAogICAgICBjb25zdCBp
bml0eGF0dHJzIHhhdHRycywKICAgICAgdm9pZCAqZnNfZGF0YSkKewogcmV0dXJuIDA7Cn0K
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSBpbnQgc2VjdXJpdHlfb2xkX2lub2RlX2luaXRfc2VjdXJpdHkoc3RydWN0
IGlub2RlICppbm9kZSwKICAgICAgICAgc3RydWN0IGlub2RlICpkaXIsCiAgICAgICAgIGNv
bnN0IHN0cnVjdCBxc3RyICpxc3RyLAogICAgICAgICBjb25zdCBjaGFyICoqbmFtZSwKICAg
ICAgICAgdm9pZCAqKnZhbHVlLCBzaXplX3QgKmxlbikKewogcmV0dXJuIC05NTsKfQoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIGludCBzZWN1cml0eV9pbm9kZV9jcmVhdGUoc3RydWN0IGlub2RlICpkaXIsCiAg
ICAgIHN0cnVjdCBkZW50cnkgKmRlbnRyeSwKICAgICAgdW1vZGVfdCBtb2RlKQp7CiByZXR1
cm4gMDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIGludCBzZWN1cml0eV9pbm9kZV9saW5rKHN0cnVjdCBkZW50
cnkgKm9sZF9kZW50cnksCiAgICAgICAgICAgc3RydWN0IGlub2RlICpkaXIsCiAgICAgICAg
ICAgc3RydWN0IGRlbnRyeSAqbmV3X2RlbnRyeSkKewogcmV0dXJuIDA7Cn0KCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBpbnQgc2VjdXJpdHlfaW5vZGVfdW5saW5rKHN0cnVjdCBpbm9kZSAqZGlyLAogICAgICBz
dHJ1Y3QgZGVudHJ5ICpkZW50cnkpCnsKIHJldHVybiAwOwp9CgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHNl
Y3VyaXR5X2lub2RlX3N5bWxpbmsoc3RydWN0IGlub2RlICpkaXIsCiAgICAgICBzdHJ1Y3Qg
ZGVudHJ5ICpkZW50cnksCiAgICAgICBjb25zdCBjaGFyICpvbGRfbmFtZSkKewogcmV0dXJu
IDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSBpbnQgc2VjdXJpdHlfaW5vZGVfbWtkaXIoc3RydWN0IGlub2Rl
ICpkaXIsCiAgICAgc3RydWN0IGRlbnRyeSAqZGVudHJ5LAogICAgIGludCBtb2RlKQp7CiBy
ZXR1cm4gMDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBzZWN1cml0eV9pbm9kZV9ybWRpcihzdHJ1Y3Qg
aW5vZGUgKmRpciwKICAgICBzdHJ1Y3QgZGVudHJ5ICpkZW50cnkpCnsKIHJldHVybiAwOwp9
CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgaW50IHNlY3VyaXR5X2lub2RlX21rbm9kKHN0cnVjdCBpbm9kZSAqZGly
LAogICAgIHN0cnVjdCBkZW50cnkgKmRlbnRyeSwKICAgICBpbnQgbW9kZSwgZGV2X3QgZGV2
KQp7CiByZXR1cm4gMDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBzZWN1cml0eV9pbm9kZV9yZW5hbWUo
c3RydWN0IGlub2RlICpvbGRfZGlyLAogICAgICBzdHJ1Y3QgZGVudHJ5ICpvbGRfZGVudHJ5
LAogICAgICBzdHJ1Y3QgaW5vZGUgKm5ld19kaXIsCiAgICAgIHN0cnVjdCBkZW50cnkgKm5l
d19kZW50cnksCiAgICAgIHVuc2lnbmVkIGludCBmbGFncykKewogcmV0dXJuIDA7Cn0KCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSBpbnQgc2VjdXJpdHlfaW5vZGVfcmVhZGxpbmsoc3RydWN0IGRlbnRyeSAqZGVu
dHJ5KQp7CiByZXR1cm4gMDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBzZWN1cml0eV9pbm9kZV9mb2xs
b3dfbGluayhzdHJ1Y3QgZGVudHJ5ICpkZW50cnksCiAgICAgICAgICBzdHJ1Y3QgaW5vZGUg
Kmlub2RlLAogICAgICAgICAgYm9vbCByY3UpCnsKIHJldHVybiAwOwp9CgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
aW50IHNlY3VyaXR5X2lub2RlX3Blcm1pc3Npb24oc3RydWN0IGlub2RlICppbm9kZSwgaW50
IG1hc2spCnsKIHJldHVybiAwOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHNlY3VyaXR5X2lub2RlX3Nl
dGF0dHIoc3RydWN0IGRlbnRyeSAqZGVudHJ5LAogICAgICAgc3RydWN0IGlhdHRyICphdHRy
KQp7CiByZXR1cm4gMDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBzZWN1cml0eV9pbm9kZV9nZXRhdHRy
KGNvbnN0IHN0cnVjdCBwYXRoICpwYXRoKQp7CiByZXR1cm4gMDsKfQoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGlu
dCBzZWN1cml0eV9pbm9kZV9zZXR4YXR0cihzdHJ1Y3QgZGVudHJ5ICpkZW50cnksCiAgY29u
c3QgY2hhciAqbmFtZSwgY29uc3Qgdm9pZCAqdmFsdWUsIHNpemVfdCBzaXplLCBpbnQgZmxh
Z3MpCnsKIHJldHVybiBjYXBfaW5vZGVfc2V0eGF0dHIoZGVudHJ5LCBuYW1lLCB2YWx1ZSwg
c2l6ZSwgZmxhZ3MpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBzZWN1cml0eV9pbm9kZV9wb3N0X3Nl
dHhhdHRyKHN0cnVjdCBkZW50cnkgKmRlbnRyeSwKICBjb25zdCBjaGFyICpuYW1lLCBjb25z
dCB2b2lkICp2YWx1ZSwgc2l6ZV90IHNpemUsIGludCBmbGFncykKeyB9CgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
aW50IHNlY3VyaXR5X2lub2RlX2dldHhhdHRyKHN0cnVjdCBkZW50cnkgKmRlbnRyeSwKICAg
Y29uc3QgY2hhciAqbmFtZSkKewogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgc2VjdXJp
dHlfaW5vZGVfbGlzdHhhdHRyKHN0cnVjdCBkZW50cnkgKmRlbnRyeSkKewogcmV0dXJuIDA7
Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSBpbnQgc2VjdXJpdHlfaW5vZGVfcmVtb3ZleGF0dHIoc3RydWN0IGRl
bnRyeSAqZGVudHJ5LAogICBjb25zdCBjaGFyICpuYW1lKQp7CiByZXR1cm4gY2FwX2lub2Rl
X3JlbW92ZXhhdHRyKGRlbnRyeSwgbmFtZSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgc2VjdXJpdHlf
aW5vZGVfbmVlZF9raWxscHJpdihzdHJ1Y3QgZGVudHJ5ICpkZW50cnkpCnsKIHJldHVybiBj
YXBfaW5vZGVfbmVlZF9raWxscHJpdihkZW50cnkpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHNlY3Vy
aXR5X2lub2RlX2tpbGxwcml2KHN0cnVjdCBkZW50cnkgKmRlbnRyeSkKewogcmV0dXJuIGNh
cF9pbm9kZV9raWxscHJpdihkZW50cnkpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHNlY3VyaXR5X2lu
b2RlX2dldHNlY3VyaXR5KHN0cnVjdCBpbm9kZSAqaW5vZGUsIGNvbnN0IGNoYXIgKm5hbWUs
IHZvaWQgKipidWZmZXIsIGJvb2wgYWxsb2MpCnsKIHJldHVybiAtOTU7Cn0KCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBpbnQgc2VjdXJpdHlfaW5vZGVfc2V0c2VjdXJpdHkoc3RydWN0IGlub2RlICppbm9kZSwg
Y29uc3QgY2hhciAqbmFtZSwgY29uc3Qgdm9pZCAqdmFsdWUsIHNpemVfdCBzaXplLCBpbnQg
ZmxhZ3MpCnsKIHJldHVybiAtOTU7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgc2VjdXJpdHlfaW5vZGVf
bGlzdHNlY3VyaXR5KHN0cnVjdCBpbm9kZSAqaW5vZGUsIGNoYXIgKmJ1ZmZlciwgc2l6ZV90
IGJ1ZmZlcl9zaXplKQp7CiByZXR1cm4gMDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgc2VjdXJpdHlf
aW5vZGVfZ2V0c2VjaWQoc3RydWN0IGlub2RlICppbm9kZSwgdTMyICpzZWNpZCkKewogKnNl
Y2lkID0gMDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBzZWN1cml0eV9pbm9kZV9jb3B5X3VwKHN0cnVj
dCBkZW50cnkgKnNyYywgc3RydWN0IGNyZWQgKipuZXcpCnsKIHJldHVybiAwOwp9CgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgaW50IHNlY3VyaXR5X2tlcm5mc19pbml0X3NlY3VyaXR5KHN0cnVjdCBrZXJuZnNf
bm9kZSAqa25fZGlyLAogICAgICBzdHJ1Y3Qga2VybmZzX25vZGUgKmtuKQp7CiByZXR1cm4g
MDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIGludCBzZWN1cml0eV9pbm9kZV9jb3B5X3VwX3hhdHRyKGNvbnN0
IGNoYXIgKm5hbWUpCnsKIHJldHVybiAtOTU7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgc2VjdXJpdHlf
ZmlsZV9wZXJtaXNzaW9uKHN0cnVjdCBmaWxlICpmaWxlLCBpbnQgbWFzaykKewogcmV0dXJu
IDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSBpbnQgc2VjdXJpdHlfZmlsZV9hbGxvYyhzdHJ1Y3QgZmlsZSAq
ZmlsZSkKewogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHNlY3VyaXR5X2ZpbGVfZnJl
ZShzdHJ1Y3QgZmlsZSAqZmlsZSkKeyB9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHNlY3VyaXR5X2ZpbGVf
aW9jdGwoc3RydWN0IGZpbGUgKmZpbGUsIHVuc2lnbmVkIGludCBjbWQsCiAgICAgICAgICB1
bnNpZ25lZCBsb25nIGFyZykKewogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgc2VjdXJp
dHlfbW1hcF9maWxlKHN0cnVjdCBmaWxlICpmaWxlLCB1bnNpZ25lZCBsb25nIHByb3QsCiAg
ICAgICAgIHVuc2lnbmVkIGxvbmcgZmxhZ3MpCnsKIHJldHVybiAwOwp9CgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
aW50IHNlY3VyaXR5X21tYXBfYWRkcih1bnNpZ25lZCBsb25nIGFkZHIpCnsKIHJldHVybiBj
YXBfbW1hcF9hZGRyKGFkZHIpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHNlY3VyaXR5X2ZpbGVfbXBy
b3RlY3Qoc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEsCiAgICAgIHVuc2lnbmVkIGxvbmcg
cmVxcHJvdCwKICAgICAgdW5zaWduZWQgbG9uZyBwcm90KQp7CiByZXR1cm4gMDsKfQoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIGludCBzZWN1cml0eV9maWxlX2xvY2soc3RydWN0IGZpbGUgKmZpbGUsIHVuc2ln
bmVkIGludCBjbWQpCnsKIHJldHVybiAwOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHNlY3VyaXR5X2Zp
bGVfZmNudGwoc3RydWN0IGZpbGUgKmZpbGUsIHVuc2lnbmVkIGludCBjbWQsCiAgICAgICAg
ICB1bnNpZ25lZCBsb25nIGFyZykKewogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHNl
Y3VyaXR5X2ZpbGVfc2V0X2Zvd25lcihzdHJ1Y3QgZmlsZSAqZmlsZSkKewogcmV0dXJuOwp9
CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgaW50IHNlY3VyaXR5X2ZpbGVfc2VuZF9zaWdpb3Rhc2soc3RydWN0IHRh
c2tfc3RydWN0ICp0c2ssCiAgICAgICAgICAgIHN0cnVjdCBmb3duX3N0cnVjdCAqZm93biwK
ICAgICAgICAgICAgaW50IHNpZykKewogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgc2Vj
dXJpdHlfZmlsZV9yZWNlaXZlKHN0cnVjdCBmaWxlICpmaWxlKQp7CiByZXR1cm4gMDsKfQoK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIGludCBzZWN1cml0eV9maWxlX29wZW4oc3RydWN0IGZpbGUgKmZpbGUpCnsK
IHJldHVybiAwOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHNlY3VyaXR5X3Rhc2tfYWxsb2Moc3RydWN0
IHRhc2tfc3RydWN0ICp0YXNrLAogICAgICAgICAgdW5zaWduZWQgbG9uZyBjbG9uZV9mbGFn
cykKewogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHNlY3VyaXR5X3Rhc2tfZnJlZShz
dHJ1Y3QgdGFza19zdHJ1Y3QgKnRhc2spCnsgfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBzZWN1cml0eV9j
cmVkX2FsbG9jX2JsYW5rKHN0cnVjdCBjcmVkICpjcmVkLCBnZnBfdCBnZnApCnsKIHJldHVy
biAwOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBzZWN1cml0eV9jcmVkX2ZyZWUoc3RydWN0IGNyZWQg
KmNyZWQpCnsgfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBzZWN1cml0eV9wcmVwYXJlX2NyZWRzKHN0cnVj
dCBjcmVkICpuZXcsCiAgICAgIGNvbnN0IHN0cnVjdCBjcmVkICpvbGQsCiAgICAgIGdmcF90
IGdmcCkKewogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHNlY3VyaXR5X3RyYW5zZmVy
X2NyZWRzKHN0cnVjdCBjcmVkICpuZXcsCiAgICAgICAgY29uc3Qgc3RydWN0IGNyZWQgKm9s
ZCkKewp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgaW50IHNlY3VyaXR5X2tlcm5lbF9hY3RfYXMoc3RydWN0IGNy
ZWQgKmNyZWQsIHUzMiBzZWNpZCkKewogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgc2Vj
dXJpdHlfa2VybmVsX2NyZWF0ZV9maWxlc19hcyhzdHJ1Y3QgY3JlZCAqY3JlZCwKICAgICAg
ICBzdHJ1Y3QgaW5vZGUgKmlub2RlKQp7CiByZXR1cm4gMDsKfQoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBz
ZWN1cml0eV9rZXJuZWxfbW9kdWxlX3JlcXVlc3QoY2hhciAqa21vZF9uYW1lKQp7CiByZXR1
cm4gMDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIGludCBzZWN1cml0eV9rZXJuZWxfbG9hZF9kYXRhKGVudW0g
a2VybmVsX2xvYWRfZGF0YV9pZCBpZCkKewogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQg
c2VjdXJpdHlfa2VybmVsX3JlYWRfZmlsZShzdHJ1Y3QgZmlsZSAqZmlsZSwKICAgICAgICAg
ZW51bSBrZXJuZWxfcmVhZF9maWxlX2lkIGlkKQp7CiByZXR1cm4gMDsKfQoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IGludCBzZWN1cml0eV9rZXJuZWxfcG9zdF9yZWFkX2ZpbGUoc3RydWN0IGZpbGUgKmZpbGUs
CiAgICAgICBjaGFyICpidWYsIGxvZmZfdCBzaXplLAogICAgICAgZW51bSBrZXJuZWxfcmVh
ZF9maWxlX2lkIGlkKQp7CiByZXR1cm4gMDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBzZWN1cml0eV90
YXNrX2ZpeF9zZXR1aWQoc3RydWN0IGNyZWQgKm5ldywKICAgICAgICBjb25zdCBzdHJ1Y3Qg
Y3JlZCAqb2xkLAogICAgICAgIGludCBmbGFncykKewogcmV0dXJuIGNhcF90YXNrX2ZpeF9z
ZXR1aWQobmV3LCBvbGQsIGZsYWdzKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBzZWN1cml0eV90YXNr
X2ZpeF9zZXRnaWQoc3RydWN0IGNyZWQgKm5ldywKICAgICAgICBjb25zdCBzdHJ1Y3QgY3Jl
ZCAqb2xkLAogICAgICAgIGludCBmbGFncykKewogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBp
bnQgc2VjdXJpdHlfdGFza19zZXRwZ2lkKHN0cnVjdCB0YXNrX3N0cnVjdCAqcCwgcGlkX3Qg
cGdpZCkKewogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgc2VjdXJpdHlfdGFza19nZXRw
Z2lkKHN0cnVjdCB0YXNrX3N0cnVjdCAqcCkKewogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBp
bnQgc2VjdXJpdHlfdGFza19nZXRzaWQoc3RydWN0IHRhc2tfc3RydWN0ICpwKQp7CiByZXR1
cm4gMDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgc2VjdXJpdHlfdGFza19nZXRzZWNpZChzdHJ1Y3Qg
dGFza19zdHJ1Y3QgKnAsIHUzMiAqc2VjaWQpCnsKICpzZWNpZCA9IDA7Cn0KCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBpbnQgc2VjdXJpdHlfdGFza19zZXRuaWNlKHN0cnVjdCB0YXNrX3N0cnVjdCAqcCwgaW50
IG5pY2UpCnsKIHJldHVybiBjYXBfdGFza19zZXRuaWNlKHAsIG5pY2UpOwp9CgpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgaW50IHNlY3VyaXR5X3Rhc2tfc2V0aW9wcmlvKHN0cnVjdCB0YXNrX3N0cnVjdCAqcCwg
aW50IGlvcHJpbykKewogcmV0dXJuIGNhcF90YXNrX3NldGlvcHJpbyhwLCBpb3ByaW8pOwp9
CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgaW50IHNlY3VyaXR5X3Rhc2tfZ2V0aW9wcmlvKHN0cnVjdCB0YXNrX3N0
cnVjdCAqcCkKewogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgc2VjdXJpdHlfdGFza19w
cmxpbWl0KGNvbnN0IHN0cnVjdCBjcmVkICpjcmVkLAogICAgIGNvbnN0IHN0cnVjdCBjcmVk
ICp0Y3JlZCwKICAgICB1bnNpZ25lZCBpbnQgZmxhZ3MpCnsKIHJldHVybiAwOwp9CgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgaW50IHNlY3VyaXR5X3Rhc2tfc2V0cmxpbWl0KHN0cnVjdCB0YXNrX3N0cnVjdCAq
cCwKICAgICAgIHVuc2lnbmVkIGludCByZXNvdXJjZSwKICAgICAgIHN0cnVjdCBybGltaXQg
Km5ld19ybGltKQp7CiByZXR1cm4gMDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBzZWN1cml0eV90YXNr
X3NldHNjaGVkdWxlcihzdHJ1Y3QgdGFza19zdHJ1Y3QgKnApCnsKIHJldHVybiBjYXBfdGFz
a19zZXRzY2hlZHVsZXIocCk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgc2VjdXJpdHlfdGFza19nZXRz
Y2hlZHVsZXIoc3RydWN0IHRhc2tfc3RydWN0ICpwKQp7CiByZXR1cm4gMDsKfQoKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIGludCBzZWN1cml0eV90YXNrX21vdmVtZW1vcnkoc3RydWN0IHRhc2tfc3RydWN0ICpw
KQp7CiByZXR1cm4gMDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBzZWN1cml0eV90YXNrX2tpbGwoc3Ry
dWN0IHRhc2tfc3RydWN0ICpwLAogICAgICAgICBzdHJ1Y3Qga2VybmVsX3NpZ2luZm8gKmlu
Zm8sIGludCBzaWcsCiAgICAgICAgIGNvbnN0IHN0cnVjdCBjcmVkICpjcmVkKQp7CiByZXR1
cm4gMDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIGludCBzZWN1cml0eV90YXNrX3ByY3RsKGludCBvcHRpb24s
IHVuc2lnbmVkIGxvbmcgYXJnMiwKICAgICAgICAgIHVuc2lnbmVkIGxvbmcgYXJnMywKICAg
ICAgICAgIHVuc2lnbmVkIGxvbmcgYXJnNCwKICAgICAgICAgIHVuc2lnbmVkIGxvbmcgYXJn
NSkKewogcmV0dXJuIGNhcF90YXNrX3ByY3RsKG9wdGlvbiwgYXJnMiwgYXJnMywgYXJnNCwg
YXJnNSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHNlY3VyaXR5X3Rhc2tfdG9faW5vZGUoc3RydWN0
IHRhc2tfc3RydWN0ICpwLCBzdHJ1Y3QgaW5vZGUgKmlub2RlKQp7IH0KCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBp
bnQgc2VjdXJpdHlfaXBjX3Blcm1pc3Npb24oc3RydWN0IGtlcm5faXBjX3Blcm0gKmlwY3As
CiAgICAgICBzaG9ydCBmbGFnKQp7CiByZXR1cm4gMDsKfQoKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgc2Vj
dXJpdHlfaXBjX2dldHNlY2lkKHN0cnVjdCBrZXJuX2lwY19wZXJtICppcGNwLCB1MzIgKnNl
Y2lkKQp7CiAqc2VjaWQgPSAwOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHNlY3VyaXR5X21zZ19tc2df
YWxsb2Moc3RydWN0IG1zZ19tc2cgKm1zZykKewogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2
b2lkIHNlY3VyaXR5X21zZ19tc2dfZnJlZShzdHJ1Y3QgbXNnX21zZyAqbXNnKQp7IH0KCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSBpbnQgc2VjdXJpdHlfbXNnX3F1ZXVlX2FsbG9jKHN0cnVjdCBrZXJuX2lwY19w
ZXJtICptc3EpCnsKIHJldHVybiAwOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBzZWN1cml0eV9tc2df
cXVldWVfZnJlZShzdHJ1Y3Qga2Vybl9pcGNfcGVybSAqbXNxKQp7IH0KCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBp
bnQgc2VjdXJpdHlfbXNnX3F1ZXVlX2Fzc29jaWF0ZShzdHJ1Y3Qga2Vybl9pcGNfcGVybSAq
bXNxLAogICAgICAgICAgICBpbnQgbXNxZmxnKQp7CiByZXR1cm4gMDsKfQoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IGludCBzZWN1cml0eV9tc2dfcXVldWVfbXNnY3RsKHN0cnVjdCBrZXJuX2lwY19wZXJtICpt
c3EsIGludCBjbWQpCnsKIHJldHVybiAwOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHNlY3VyaXR5X21z
Z19xdWV1ZV9tc2dzbmQoc3RydWN0IGtlcm5faXBjX3Blcm0gKm1zcSwKICAgICAgICAgc3Ry
dWN0IG1zZ19tc2cgKm1zZywgaW50IG1zcWZsZykKewogcmV0dXJuIDA7Cn0KCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBpbnQgc2VjdXJpdHlfbXNnX3F1ZXVlX21zZ3JjdihzdHJ1Y3Qga2Vybl9pcGNfcGVybSAq
bXNxLAogICAgICAgICBzdHJ1Y3QgbXNnX21zZyAqbXNnLAogICAgICAgICBzdHJ1Y3QgdGFz
a19zdHJ1Y3QgKnRhcmdldCwKICAgICAgICAgbG9uZyB0eXBlLCBpbnQgbW9kZSkKewogcmV0
dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgc2VjdXJpdHlfc2htX2FsbG9jKHN0cnVjdCBrZXJu
X2lwY19wZXJtICpzaHApCnsKIHJldHVybiAwOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBzZWN1cml0
eV9zaG1fZnJlZShzdHJ1Y3Qga2Vybl9pcGNfcGVybSAqc2hwKQp7IH0KCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBp
bnQgc2VjdXJpdHlfc2htX2Fzc29jaWF0ZShzdHJ1Y3Qga2Vybl9pcGNfcGVybSAqc2hwLAog
ICAgICBpbnQgc2htZmxnKQp7CiByZXR1cm4gMDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBzZWN1cml0
eV9zaG1fc2htY3RsKHN0cnVjdCBrZXJuX2lwY19wZXJtICpzaHAsIGludCBjbWQpCnsKIHJl
dHVybiAwOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHNlY3VyaXR5X3NobV9zaG1hdChzdHJ1Y3Qga2Vy
bl9pcGNfcGVybSAqc2hwLAogICAgICAgICBjaGFyICpzaG1hZGRyLCBpbnQgc2htZmxnKQp7
CiByZXR1cm4gMDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBzZWN1cml0eV9zZW1fYWxsb2Moc3RydWN0
IGtlcm5faXBjX3Blcm0gKnNtYSkKewogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHNl
Y3VyaXR5X3NlbV9mcmVlKHN0cnVjdCBrZXJuX2lwY19wZXJtICpzbWEpCnsgfQoKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIGludCBzZWN1cml0eV9zZW1fYXNzb2NpYXRlKHN0cnVjdCBrZXJuX2lwY19wZXJtICpz
bWEsIGludCBzZW1mbGcpCnsKIHJldHVybiAwOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHNlY3VyaXR5
X3NlbV9zZW1jdGwoc3RydWN0IGtlcm5faXBjX3Blcm0gKnNtYSwgaW50IGNtZCkKewogcmV0
dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgc2VjdXJpdHlfc2VtX3NlbW9wKHN0cnVjdCBrZXJu
X2lwY19wZXJtICpzbWEsCiAgICAgICAgIHN0cnVjdCBzZW1idWYgKnNvcHMsIHVuc2lnbmVk
IG5zb3BzLAogICAgICAgICBpbnQgYWx0ZXIpCnsKIHJldHVybiAwOwp9CgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
dm9pZCBzZWN1cml0eV9kX2luc3RhbnRpYXRlKHN0cnVjdCBkZW50cnkgKmRlbnRyeSwKICAg
ICAgIHN0cnVjdCBpbm9kZSAqaW5vZGUpCnsgfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBzZWN1cml0eV9n
ZXRwcm9jYXR0cihzdHJ1Y3QgdGFza19zdHJ1Y3QgKnAsIGNvbnN0IGNoYXIgKmxzbSwKICAg
ICAgICAgICBjaGFyICpuYW1lLCBjaGFyICoqdmFsdWUpCnsKIHJldHVybiAtMjI7Cn0KCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSBpbnQgc2VjdXJpdHlfc2V0cHJvY2F0dHIoY29uc3QgY2hhciAqbHNtLCBjaGFy
ICpuYW1lLAogICAgICAgICAgIHZvaWQgKnZhbHVlLCBzaXplX3Qgc2l6ZSkKewogcmV0dXJu
IC0yMjsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIGludCBzZWN1cml0eV9uZXRsaW5rX3NlbmQoc3RydWN0IHNv
Y2sgKnNrLCBzdHJ1Y3Qgc2tfYnVmZiAqc2tiKQp7CiByZXR1cm4gMDsKfQoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IGludCBzZWN1cml0eV9pc21hY2xhYmVsKGNvbnN0IGNoYXIgKm5hbWUpCnsKIHJldHVybiAw
Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgaW50IHNlY3VyaXR5X3NlY2lkX3RvX3NlY2N0eCh1MzIgc2VjaWQs
IGNoYXIgKipzZWNkYXRhLCB1MzIgKnNlY2xlbikKewogcmV0dXJuIC05NTsKfQoKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIGludCBzZWN1cml0eV9zZWNjdHhfdG9fc2VjaWQoY29uc3QgY2hhciAqc2VjZGF0YSwK
ICAgICAgICB1MzIgc2VjbGVuLAogICAgICAgIHUzMiAqc2VjaWQpCnsKIHJldHVybiAtOTU7
Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSB2b2lkIHNlY3VyaXR5X3JlbGVhc2Vfc2VjY3R4KGNoYXIgKnNlY2Rh
dGEsIHUzMiBzZWNsZW4pCnsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgc2VjdXJpdHlfaW5vZGVfaW52
YWxpZGF0ZV9zZWNjdHgoc3RydWN0IGlub2RlICppbm9kZSkKewp9CgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50
IHNlY3VyaXR5X2lub2RlX25vdGlmeXNlY2N0eChzdHJ1Y3QgaW5vZGUgKmlub2RlLCB2b2lk
ICpjdHgsIHUzMiBjdHhsZW4pCnsKIHJldHVybiAtOTU7Cn0Kc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBzZWN1
cml0eV9pbm9kZV9zZXRzZWNjdHgoc3RydWN0IGRlbnRyeSAqZGVudHJ5LCB2b2lkICpjdHgs
IHUzMiBjdHhsZW4pCnsKIHJldHVybiAtOTU7Cn0Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBzZWN1cml0eV9p
bm9kZV9nZXRzZWNjdHgoc3RydWN0IGlub2RlICppbm9kZSwgdm9pZCAqKmN0eCwgdTMyICpj
dHhsZW4pCnsKIHJldHVybiAtOTU7Cn0Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBzZWN1cml0eV9sb2NrZWRf
ZG93bihlbnVtIGxvY2tkb3duX3JlYXNvbiB3aGF0KQp7CiByZXR1cm4gMDsKfQoKCgoKCgoK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIGludCBzZWN1cml0eV9wb3N0X25vdGlmaWNhdGlvbihjb25zdCBzdHJ1Y3Qg
Y3JlZCAqd19jcmVkLAogICAgICAgICAgY29uc3Qgc3RydWN0IGNyZWQgKmNyZWQsCiAgICAg
ICAgICBzdHJ1Y3Qgd2F0Y2hfbm90aWZpY2F0aW9uICpuKQp7CiByZXR1cm4gMDsKfQoKCgoK
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSBpbnQgc2VjdXJpdHlfd2F0Y2hfa2V5KHN0cnVjdCBrZXkgKmtleSkKewog
cmV0dXJuIDA7Cn0KIyAxMzcwICIuL2luY2x1ZGUvbGludXgvc2VjdXJpdHkuaCIKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIGludCBzZWN1cml0eV91bml4X3N0cmVhbV9jb25uZWN0KHN0cnVjdCBzb2NrICpzb2Nr
LAogICAgICAgICAgICBzdHJ1Y3Qgc29jayAqb3RoZXIsCiAgICAgICAgICAgIHN0cnVjdCBz
b2NrICpuZXdzaykKewogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgc2VjdXJpdHlfdW5p
eF9tYXlfc2VuZChzdHJ1Y3Qgc29ja2V0ICpzb2NrLAogICAgICBzdHJ1Y3Qgc29ja2V0ICpv
dGhlcikKewogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgc2VjdXJpdHlfc29ja2V0X2Ny
ZWF0ZShpbnQgZmFtaWx5LCBpbnQgdHlwZSwKICAgICAgaW50IHByb3RvY29sLCBpbnQga2Vy
bikKewogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgc2VjdXJpdHlfc29ja2V0X3Bvc3Rf
Y3JlYXRlKHN0cnVjdCBzb2NrZXQgKnNvY2ssCiAgICAgICAgICAgaW50IGZhbWlseSwKICAg
ICAgICAgICBpbnQgdHlwZSwKICAgICAgICAgICBpbnQgcHJvdG9jb2wsIGludCBrZXJuKQp7
CiByZXR1cm4gMDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBzZWN1cml0eV9zb2NrZXRfc29ja2V0cGFp
cihzdHJ1Y3Qgc29ja2V0ICpzb2NrYSwKICAgICAgICAgIHN0cnVjdCBzb2NrZXQgKnNvY2ti
KQp7CiByZXR1cm4gMDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBzZWN1cml0eV9zb2NrZXRfYmluZChz
dHJ1Y3Qgc29ja2V0ICpzb2NrLAogICAgICAgICAgIHN0cnVjdCBzb2NrYWRkciAqYWRkcmVz
cywKICAgICAgICAgICBpbnQgYWRkcmxlbikKewogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBp
bnQgc2VjdXJpdHlfc29ja2V0X2Nvbm5lY3Qoc3RydWN0IHNvY2tldCAqc29jaywKICAgICAg
IHN0cnVjdCBzb2NrYWRkciAqYWRkcmVzcywKICAgICAgIGludCBhZGRybGVuKQp7CiByZXR1
cm4gMDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIGludCBzZWN1cml0eV9zb2NrZXRfbGlzdGVuKHN0cnVjdCBz
b2NrZXQgKnNvY2ssIGludCBiYWNrbG9nKQp7CiByZXR1cm4gMDsKfQoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGlu
dCBzZWN1cml0eV9zb2NrZXRfYWNjZXB0KHN0cnVjdCBzb2NrZXQgKnNvY2ssCiAgICAgIHN0
cnVjdCBzb2NrZXQgKm5ld3NvY2spCnsKIHJldHVybiAwOwp9CgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHNl
Y3VyaXR5X3NvY2tldF9zZW5kbXNnKHN0cnVjdCBzb2NrZXQgKnNvY2ssCiAgICAgICBzdHJ1
Y3QgbXNnaGRyICptc2csIGludCBzaXplKQp7CiByZXR1cm4gMDsKfQoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGlu
dCBzZWN1cml0eV9zb2NrZXRfcmVjdm1zZyhzdHJ1Y3Qgc29ja2V0ICpzb2NrLAogICAgICAg
c3RydWN0IG1zZ2hkciAqbXNnLCBpbnQgc2l6ZSwKICAgICAgIGludCBmbGFncykKewogcmV0
dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgc2VjdXJpdHlfc29ja2V0X2dldHNvY2tuYW1lKHN0
cnVjdCBzb2NrZXQgKnNvY2spCnsKIHJldHVybiAwOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHNlY3Vy
aXR5X3NvY2tldF9nZXRwZWVybmFtZShzdHJ1Y3Qgc29ja2V0ICpzb2NrKQp7CiByZXR1cm4g
MDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIGludCBzZWN1cml0eV9zb2NrZXRfZ2V0c29ja29wdChzdHJ1Y3Qg
c29ja2V0ICpzb2NrLAogICAgICAgICAgaW50IGxldmVsLCBpbnQgb3B0bmFtZSkKewogcmV0
dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgc2VjdXJpdHlfc29ja2V0X3NldHNvY2tvcHQoc3Ry
dWN0IHNvY2tldCAqc29jaywKICAgICAgICAgIGludCBsZXZlbCwgaW50IG9wdG5hbWUpCnsK
IHJldHVybiAwOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHNlY3VyaXR5X3NvY2tldF9zaHV0ZG93bihz
dHJ1Y3Qgc29ja2V0ICpzb2NrLCBpbnQgaG93KQp7CiByZXR1cm4gMDsKfQpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
aW50IHNlY3VyaXR5X3NvY2tfcmN2X3NrYihzdHJ1Y3Qgc29jayAqc2ssCiAgICAgc3RydWN0
IHNrX2J1ZmYgKnNrYikKewogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgc2VjdXJpdHlf
c29ja2V0X2dldHBlZXJzZWNfc3RyZWFtKHN0cnVjdCBzb2NrZXQgKnNvY2ssIGNoYXIgKm9w
dHZhbCwKICAgICAgICAgIGludCAqb3B0bGVuLCB1bnNpZ25lZCBsZW4pCnsKIHJldHVybiAt
OTI7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSBpbnQgc2VjdXJpdHlfc29ja2V0X2dldHBlZXJzZWNfZGdyYW0o
c3RydWN0IHNvY2tldCAqc29jaywgc3RydWN0IHNrX2J1ZmYgKnNrYiwgdTMyICpzZWNpZCkK
ewogcmV0dXJuIC05MjsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBzZWN1cml0eV9za19hbGxvYyhzdHJ1
Y3Qgc29jayAqc2ssIGludCBmYW1pbHksIGdmcF90IHByaW9yaXR5KQp7CiByZXR1cm4gMDsK
fQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIHZvaWQgc2VjdXJpdHlfc2tfZnJlZShzdHJ1Y3Qgc29jayAqc2spCnsK
fQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIHZvaWQgc2VjdXJpdHlfc2tfY2xvbmUoY29uc3Qgc3RydWN0IHNvY2sg
KnNrLCBzdHJ1Y3Qgc29jayAqbmV3c2spCnsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgc2VjdXJpdHlf
c2tfY2xhc3NpZnlfZmxvdyhzdHJ1Y3Qgc29jayAqc2ssIHN0cnVjdCBmbG93aSAqZmwpCnsK
fQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIHZvaWQgc2VjdXJpdHlfcmVxX2NsYXNzaWZ5X2Zsb3coY29uc3Qgc3Ry
dWN0IHJlcXVlc3Rfc29jayAqcmVxLCBzdHJ1Y3QgZmxvd2kgKmZsKQp7Cn0KCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSB2b2lkIHNlY3VyaXR5X3NvY2tfZ3JhZnQoc3RydWN0IHNvY2sgKnNrLCBzdHJ1Y3Qgc29j
a2V0ICpwYXJlbnQpCnsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBzZWN1cml0eV9pbmV0X2Nvbm5fcmVx
dWVzdChzdHJ1Y3Qgc29jayAqc2ssCiAgIHN0cnVjdCBza19idWZmICpza2IsIHN0cnVjdCBy
ZXF1ZXN0X3NvY2sgKnJlcSkKewogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHNlY3Vy
aXR5X2luZXRfY3NrX2Nsb25lKHN0cnVjdCBzb2NrICpuZXdzaywKICAgY29uc3Qgc3RydWN0
IHJlcXVlc3Rfc29jayAqcmVxKQp7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHNlY3VyaXR5X2luZXRf
Y29ubl9lc3RhYmxpc2hlZChzdHJ1Y3Qgc29jayAqc2ssCiAgIHN0cnVjdCBza19idWZmICpz
a2IpCnsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIGludCBzZWN1cml0eV9zZWNtYXJrX3JlbGFiZWxfcGFja2V0
KHUzMiBzZWNpZCkKewogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHNlY3VyaXR5X3Nl
Y21hcmtfcmVmY291bnRfaW5jKHZvaWQpCnsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgc2VjdXJpdHlf
c2VjbWFya19yZWZjb3VudF9kZWModm9pZCkKewp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHNlY3VyaXR5
X3R1bl9kZXZfYWxsb2Nfc2VjdXJpdHkodm9pZCAqKnNlY3VyaXR5KQp7CiByZXR1cm4gMDsK
fQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIHZvaWQgc2VjdXJpdHlfdHVuX2Rldl9mcmVlX3NlY3VyaXR5KHZvaWQg
KnNlY3VyaXR5KQp7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgc2VjdXJpdHlfdHVuX2Rldl9jcmVhdGUo
dm9pZCkKewogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgc2VjdXJpdHlfdHVuX2Rldl9h
dHRhY2hfcXVldWUodm9pZCAqc2VjdXJpdHkpCnsKIHJldHVybiAwOwp9CgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
aW50IHNlY3VyaXR5X3R1bl9kZXZfYXR0YWNoKHN0cnVjdCBzb2NrICpzaywgdm9pZCAqc2Vj
dXJpdHkpCnsKIHJldHVybiAwOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHNlY3VyaXR5X3R1bl9kZXZf
b3Blbih2b2lkICpzZWN1cml0eSkKewogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgc2Vj
dXJpdHlfc2N0cF9hc3NvY19yZXF1ZXN0KHN0cnVjdCBzY3RwX2VuZHBvaW50ICplcCwKICAg
ICAgICAgICBzdHJ1Y3Qgc2tfYnVmZiAqc2tiKQp7CiByZXR1cm4gMDsKfQoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IGludCBzZWN1cml0eV9zY3RwX2JpbmRfY29ubmVjdChzdHJ1Y3Qgc29jayAqc2ssIGludCBv
cHRuYW1lLAogICAgICAgICAgc3RydWN0IHNvY2thZGRyICphZGRyZXNzLAogICAgICAgICAg
aW50IGFkZHJsZW4pCnsKIHJldHVybiAwOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBzZWN1cml0eV9z
Y3RwX3NrX2Nsb25lKHN0cnVjdCBzY3RwX2VuZHBvaW50ICplcCwKICAgICAgIHN0cnVjdCBz
b2NrICpzaywKICAgICAgIHN0cnVjdCBzb2NrICpuZXdzaykKewp9CiMgMTU5MyAiLi9pbmNs
dWRlL2xpbnV4L3NlY3VyaXR5LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgc2VjdXJpdHlfaWJfcGtleV9h
Y2Nlc3Modm9pZCAqc2VjLCB1NjQgc3VibmV0X3ByZWZpeCwgdTE2IHBrZXkpCnsKIHJldHVy
biAwOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgaW50IHNlY3VyaXR5X2liX2VuZHBvcnRfbWFuYWdlX3N1Ym5l
dCh2b2lkICpzZWMsIGNvbnN0IGNoYXIgKmRldl9uYW1lLCB1OCBwb3J0X251bSkKewogcmV0
dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgc2VjdXJpdHlfaWJfYWxsb2Nfc2VjdXJpdHkodm9p
ZCAqKnNlYykKewogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHNlY3VyaXR5X2liX2Zy
ZWVfc2VjdXJpdHkodm9pZCAqc2VjKQp7Cn0KIyAxNjM0ICIuL2luY2x1ZGUvbGludXgvc2Vj
dXJpdHkuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIGludCBzZWN1cml0eV94ZnJtX3BvbGljeV9hbGxvYyhzdHJ1
Y3QgeGZybV9zZWNfY3R4ICoqY3R4cCwKICAgICAgICAgIHN0cnVjdCB4ZnJtX3VzZXJfc2Vj
X2N0eCAqc2VjX2N0eCwKICAgICAgICAgIGdmcF90IGdmcCkKewogcmV0dXJuIDA7Cn0KCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSBpbnQgc2VjdXJpdHlfeGZybV9wb2xpY3lfY2xvbmUoc3RydWN0IHhmcm1fc2Vj
X2N0eCAqb2xkLCBzdHJ1Y3QgeGZybV9zZWNfY3R4ICoqbmV3X2N0eHApCnsKIHJldHVybiAw
Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgdm9pZCBzZWN1cml0eV94ZnJtX3BvbGljeV9mcmVlKHN0cnVjdCB4
ZnJtX3NlY19jdHggKmN0eCkKewp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHNlY3VyaXR5X3hmcm1fcG9s
aWN5X2RlbGV0ZShzdHJ1Y3QgeGZybV9zZWNfY3R4ICpjdHgpCnsKIHJldHVybiAwOwp9Cgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgaW50IHNlY3VyaXR5X3hmcm1fc3RhdGVfYWxsb2Moc3RydWN0IHhmcm1fc3Rh
dGUgKngsCiAgICAgc3RydWN0IHhmcm1fdXNlcl9zZWNfY3R4ICpzZWNfY3R4KQp7CiByZXR1
cm4gMDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIGludCBzZWN1cml0eV94ZnJtX3N0YXRlX2FsbG9jX2FjcXVp
cmUoc3RydWN0IHhmcm1fc3RhdGUgKngsCiAgICAgc3RydWN0IHhmcm1fc2VjX2N0eCAqcG9s
c2VjLCB1MzIgc2VjaWQpCnsKIHJldHVybiAwOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBzZWN1cml0
eV94ZnJtX3N0YXRlX2ZyZWUoc3RydWN0IHhmcm1fc3RhdGUgKngpCnsKfQoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IGludCBzZWN1cml0eV94ZnJtX3N0YXRlX2RlbGV0ZShzdHJ1Y3QgeGZybV9zdGF0ZSAqeCkK
ewogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgc2VjdXJpdHlfeGZybV9wb2xpY3lfbG9v
a3VwKHN0cnVjdCB4ZnJtX3NlY19jdHggKmN0eCwgdTMyIGZsX3NlY2lkLCB1OCBkaXIpCnsK
IHJldHVybiAwOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHNlY3VyaXR5X3hmcm1fc3RhdGVfcG9sX2Zs
b3dfbWF0Y2goc3RydWN0IHhmcm1fc3RhdGUgKngsCiAgIHN0cnVjdCB4ZnJtX3BvbGljeSAq
eHAsIGNvbnN0IHN0cnVjdCBmbG93aSAqZmwpCnsKIHJldHVybiAxOwp9CgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
aW50IHNlY3VyaXR5X3hmcm1fZGVjb2RlX3Nlc3Npb24oc3RydWN0IHNrX2J1ZmYgKnNrYiwg
dTMyICpzZWNpZCkKewogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHNlY3VyaXR5X3Nr
Yl9jbGFzc2lmeV9mbG93KHN0cnVjdCBza19idWZmICpza2IsIHN0cnVjdCBmbG93aSAqZmwp
CnsKfQojIDE3MTYgIi4vaW5jbHVkZS9saW51eC9zZWN1cml0eS5oIgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50
IHNlY3VyaXR5X3BhdGhfdW5saW5rKGNvbnN0IHN0cnVjdCBwYXRoICpkaXIsIHN0cnVjdCBk
ZW50cnkgKmRlbnRyeSkKewogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgc2VjdXJpdHlf
cGF0aF9ta2Rpcihjb25zdCBzdHJ1Y3QgcGF0aCAqZGlyLCBzdHJ1Y3QgZGVudHJ5ICpkZW50
cnksCiAgICAgICAgICB1bW9kZV90IG1vZGUpCnsKIHJldHVybiAwOwp9CgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
aW50IHNlY3VyaXR5X3BhdGhfcm1kaXIoY29uc3Qgc3RydWN0IHBhdGggKmRpciwgc3RydWN0
IGRlbnRyeSAqZGVudHJ5KQp7CiByZXR1cm4gMDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBzZWN1cml0
eV9wYXRoX21rbm9kKGNvbnN0IHN0cnVjdCBwYXRoICpkaXIsIHN0cnVjdCBkZW50cnkgKmRl
bnRyeSwKICAgICAgICAgIHVtb2RlX3QgbW9kZSwgdW5zaWduZWQgaW50IGRldikKewogcmV0
dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgc2VjdXJpdHlfcGF0aF90cnVuY2F0ZShjb25zdCBz
dHJ1Y3QgcGF0aCAqcGF0aCkKewogcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgc2VjdXJp
dHlfcGF0aF9zeW1saW5rKGNvbnN0IHN0cnVjdCBwYXRoICpkaXIsIHN0cnVjdCBkZW50cnkg
KmRlbnRyeSwKICAgICBjb25zdCBjaGFyICpvbGRfbmFtZSkKewogcmV0dXJuIDA7Cn0KCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSBpbnQgc2VjdXJpdHlfcGF0aF9saW5rKHN0cnVjdCBkZW50cnkgKm9sZF9kZW50
cnksCiAgICAgICAgIGNvbnN0IHN0cnVjdCBwYXRoICpuZXdfZGlyLAogICAgICAgICBzdHJ1
Y3QgZGVudHJ5ICpuZXdfZGVudHJ5KQp7CiByZXR1cm4gMDsKfQoKc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBz
ZWN1cml0eV9wYXRoX3JlbmFtZShjb25zdCBzdHJ1Y3QgcGF0aCAqb2xkX2RpciwKICAgICAg
ICAgICBzdHJ1Y3QgZGVudHJ5ICpvbGRfZGVudHJ5LAogICAgICAgICAgIGNvbnN0IHN0cnVj
dCBwYXRoICpuZXdfZGlyLAogICAgICAgICAgIHN0cnVjdCBkZW50cnkgKm5ld19kZW50cnks
CiAgICAgICAgICAgdW5zaWduZWQgaW50IGZsYWdzKQp7CiByZXR1cm4gMDsKfQoKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIGludCBzZWN1cml0eV9wYXRoX2NobW9kKGNvbnN0IHN0cnVjdCBwYXRoICpwYXRoLCB1
bW9kZV90IG1vZGUpCnsKIHJldHVybiAwOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHNlY3VyaXR5X3Bh
dGhfY2hvd24oY29uc3Qgc3RydWN0IHBhdGggKnBhdGgsIGt1aWRfdCB1aWQsIGtnaWRfdCBn
aWQpCnsKIHJldHVybiAwOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHNlY3VyaXR5X3BhdGhfY2hyb290
KGNvbnN0IHN0cnVjdCBwYXRoICpwYXRoKQp7CiByZXR1cm4gMDsKfQojIDE3OTIgIi4vaW5j
bHVkZS9saW51eC9zZWN1cml0eS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHNlY3VyaXR5X2tleV9hbGxv
YyhzdHJ1Y3Qga2V5ICprZXksCiAgICAgICAgIGNvbnN0IHN0cnVjdCBjcmVkICpjcmVkLAog
ICAgICAgICB1bnNpZ25lZCBsb25nIGZsYWdzKQp7CiByZXR1cm4gMDsKfQoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IHZvaWQgc2VjdXJpdHlfa2V5X2ZyZWUoc3RydWN0IGtleSAqa2V5KQp7Cn0KCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBpbnQgc2VjdXJpdHlfa2V5X3Blcm1pc3Npb24oa2V5X3JlZl90IGtleV9yZWYsCiAgICAg
ICBjb25zdCBzdHJ1Y3QgY3JlZCAqY3JlZCwKICAgICAgIGVudW0ga2V5X25lZWRfcGVybSBu
ZWVkX3Blcm0pCnsKIHJldHVybiAwOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHNlY3VyaXR5X2tleV9n
ZXRzZWN1cml0eShzdHJ1Y3Qga2V5ICprZXksIGNoYXIgKipfYnVmZmVyKQp7CiAqX2J1ZmZl
ciA9ICgodm9pZCAqKTApOwogcmV0dXJuIDA7Cn0KIyAxODI4ICIuL2luY2x1ZGUvbGludXgv
c2VjdXJpdHkuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBzZWN1cml0eV9hdWRpdF9ydWxlX2luaXQodTMy
IGZpZWxkLCB1MzIgb3AsIGNoYXIgKnJ1bGVzdHIsCiAgICAgICAgdm9pZCAqKmxzbXJ1bGUp
CnsKIHJldHVybiAwOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHNlY3VyaXR5X2F1ZGl0X3J1bGVfa25v
d24oc3RydWN0IGF1ZGl0X2tydWxlICprcnVsZSkKewogcmV0dXJuIDA7Cn0KCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBpbnQgc2VjdXJpdHlfYXVkaXRfcnVsZV9tYXRjaCh1MzIgc2VjaWQsIHUzMiBmaWVsZCwg
dTMyIG9wLAogICAgICAgICB2b2lkICpsc21ydWxlKQp7CiByZXR1cm4gMDsKfQoKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIHZvaWQgc2VjdXJpdHlfYXVkaXRfcnVsZV9mcmVlKHZvaWQgKmxzbXJ1bGUpCnsgfQoj
IDE4NjUgIi4vaW5jbHVkZS9saW51eC9zZWN1cml0eS5oIgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IGRl
bnRyeSAqc2VjdXJpdHlmc19jcmVhdGVfZGlyKGNvbnN0IGNoYXIgKm5hbWUsCiAgICAgICAg
IHN0cnVjdCBkZW50cnkgKnBhcmVudCkKewogcmV0dXJuIEVSUl9QVFIoLTE5KTsKfQoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIHN0cnVjdCBkZW50cnkgKnNlY3VyaXR5ZnNfY3JlYXRlX2ZpbGUoY29uc3QgY2hh
ciAqbmFtZSwKICAgICAgICAgIHVtb2RlX3QgbW9kZSwKICAgICAgICAgIHN0cnVjdCBkZW50
cnkgKnBhcmVudCwKICAgICAgICAgIHZvaWQgKmRhdGEsCiAgICAgICAgICBjb25zdCBzdHJ1
Y3QgZmlsZV9vcGVyYXRpb25zICpmb3BzKQp7CiByZXR1cm4gRVJSX1BUUigtMTkpOwp9Cgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgc3RydWN0IGRlbnRyeSAqc2VjdXJpdHlmc19jcmVhdGVfc3ltbGluayhjb25z
dCBjaGFyICpuYW1lLAogICAgIHN0cnVjdCBkZW50cnkgKnBhcmVudCwKICAgICBjb25zdCBj
aGFyICp0YXJnZXQsCiAgICAgY29uc3Qgc3RydWN0IGlub2RlX29wZXJhdGlvbnMgKmlvcHMp
CnsKIHJldHVybiBFUlJfUFRSKC0xOSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHNlY3VyaXR5ZnNf
cmVtb3ZlKHN0cnVjdCBkZW50cnkgKmRlbnRyeSkKe30KIyAxOTQyICIuL2luY2x1ZGUvbGlu
dXgvc2VjdXJpdHkuaCIKc3RydWN0IHBlcmZfZXZlbnRfYXR0cjsKc3RydWN0IHBlcmZfZXZl
bnQ7CiMgMTk1MiAiLi9pbmNsdWRlL2xpbnV4L3NlY3VyaXR5LmgiCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQg
c2VjdXJpdHlfcGVyZl9ldmVudF9vcGVuKHN0cnVjdCBwZXJmX2V2ZW50X2F0dHIgKmF0dHIs
CiAgICAgICAgaW50IHR5cGUpCnsKIHJldHVybiAwOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHNlY3Vy
aXR5X3BlcmZfZXZlbnRfYWxsb2Moc3RydWN0IHBlcmZfZXZlbnQgKmV2ZW50KQp7CiByZXR1
cm4gMDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgc2VjdXJpdHlfcGVyZl9ldmVudF9mcmVlKHN0cnVj
dCBwZXJmX2V2ZW50ICpldmVudCkKewp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHNlY3VyaXR5X3BlcmZf
ZXZlbnRfcmVhZChzdHJ1Y3QgcGVyZl9ldmVudCAqZXZlbnQpCnsKIHJldHVybiAwOwp9Cgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgaW50IHNlY3VyaXR5X3BlcmZfZXZlbnRfd3JpdGUoc3RydWN0IHBlcmZfZXZl
bnQgKmV2ZW50KQp7CiByZXR1cm4gMDsKfQojIDYwICIuL2luY2x1ZGUvbGludXgvcGVyZl9l
dmVudC5oIiAyCgoKc3RydWN0IHBlcmZfY2FsbGNoYWluX2VudHJ5IHsKIF9fdTY0IG5yOwog
X191NjQgaXBbXTsKfTsKCnN0cnVjdCBwZXJmX2NhbGxjaGFpbl9lbnRyeV9jdHggewogc3Ry
dWN0IHBlcmZfY2FsbGNoYWluX2VudHJ5ICplbnRyeTsKIHUzMiBtYXhfc3RhY2s7CiB1MzIg
bnI7CiBzaG9ydCBjb250ZXh0czsKIGJvb2wgY29udGV4dHNfbWF4ZWQ7Cn07Cgp0eXBlZGVm
IHVuc2lnbmVkIGxvbmcgKCpwZXJmX2NvcHlfZikodm9pZCAqZHN0LCBjb25zdCB2b2lkICpz
cmMsCiAgICAgICAgIHVuc2lnbmVkIGxvbmcgb2ZmLCB1bnNpZ25lZCBsb25nIGxlbik7Cgpz
dHJ1Y3QgcGVyZl9yYXdfZnJhZyB7CiB1bmlvbiB7CiAgc3RydWN0IHBlcmZfcmF3X2ZyYWcg
Km5leHQ7CiAgdW5zaWduZWQgbG9uZyBwYWQ7CiB9OwogcGVyZl9jb3B5X2YgY29weTsKIHZv
aWQgKmRhdGE7CiB1MzIgc2l6ZTsKfSBfX2F0dHJpYnV0ZV9fKChfX3BhY2tlZF9fKSk7Cgpz
dHJ1Y3QgcGVyZl9yYXdfcmVjb3JkIHsKIHN0cnVjdCBwZXJmX3Jhd19mcmFnIGZyYWc7CiB1
MzIgc2l6ZTsKfTsKIyAxMTMgIi4vaW5jbHVkZS9saW51eC9wZXJmX2V2ZW50LmgiCnN0cnVj
dCBwZXJmX2JyYW5jaF9zdGFjayB7CiBfX3U2NCBucjsKIF9fdTY0IGh3X2lkeDsKIHN0cnVj
dCBwZXJmX2JyYW5jaF9lbnRyeSBlbnRyaWVzW107Cn07CgpzdHJ1Y3QgdGFza19zdHJ1Y3Q7
CgoKCgpzdHJ1Y3QgaHdfcGVyZl9ldmVudF9leHRyYSB7CiB1NjQgY29uZmlnOwogdW5zaWdu
ZWQgaW50IHJlZzsKIGludCBhbGxvYzsKIGludCBpZHg7Cn07CgoKCgpzdHJ1Y3QgaHdfcGVy
Zl9ldmVudCB7CgogdW5pb24gewogIHN0cnVjdCB7CiAgIHU2NCBjb25maWc7CiAgIHU2NCBs
YXN0X3RhZzsKICAgdW5zaWduZWQgbG9uZyBjb25maWdfYmFzZTsKICAgdW5zaWduZWQgbG9u
ZyBldmVudF9iYXNlOwogICBpbnQgZXZlbnRfYmFzZV9yZHBtYzsKICAgaW50IGlkeDsKICAg
aW50IGxhc3RfY3B1OwogICBpbnQgZmxhZ3M7CgogICBzdHJ1Y3QgaHdfcGVyZl9ldmVudF9l
eHRyYSBleHRyYV9yZWc7CiAgIHN0cnVjdCBod19wZXJmX2V2ZW50X2V4dHJhIGJyYW5jaF9y
ZWc7CiAgfTsKICBzdHJ1Y3QgewogICBzdHJ1Y3QgaHJ0aW1lciBocnRpbWVyOwogIH07CiAg
c3RydWN0IHsKCiAgIHN0cnVjdCBsaXN0X2hlYWQgdHBfbGlzdDsKICB9OwogIHN0cnVjdCB7
CiAgIHU2NCBwd3JfYWNjOwogICB1NjQgcHRzYzsKICB9OwojIDE3MiAiLi9pbmNsdWRlL2xp
bnV4L3BlcmZfZXZlbnQuaCIKICBzdHJ1Y3QgewogICB1OCBpb21tdV9iYW5rOwogICB1OCBp
b21tdV9jbnRyOwogICB1MTYgcGFkZGluZzsKICAgdTY0IGNvbmY7CiAgIHU2NCBjb25mMTsK
ICB9OwogfTsKCgoKCiBzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRhcmdldDsKCgoKCgogdm9pZCAq
YWRkcl9maWx0ZXJzOwoKCiB1bnNpZ25lZCBsb25nIGFkZHJfZmlsdGVyc19nZW47CiMgMjAy
ICIuL2luY2x1ZGUvbGludXgvcGVyZl9ldmVudC5oIgogaW50IHN0YXRlOwoKCgoKCiBsb2Nh
bDY0X3QgcHJldl9jb3VudDsKCgoKCiB1NjQgc2FtcGxlX3BlcmlvZDsKCgoKCiB1NjQgbGFz
dF9wZXJpb2Q7CgoKCgoKCiBsb2NhbDY0X3QgcGVyaW9kX2xlZnQ7CgoKCgoKIHU2NCBpbnRl
cnJ1cHRzX3NlcTsKIHU2NCBpbnRlcnJ1cHRzOwoKCgoKCiB1NjQgZnJlcV90aW1lX3N0YW1w
OwogdTY0IGZyZXFfY291bnRfc3RhbXA7Cgp9OwoKc3RydWN0IHBlcmZfZXZlbnQ7CiMgMjY0
ICIuL2luY2x1ZGUvbGludXgvcGVyZl9ldmVudC5oIgpzdHJ1Y3QgcGVyZl9vdXRwdXRfaGFu
ZGxlOwoKCgoKc3RydWN0IHBtdSB7CiBzdHJ1Y3QgbGlzdF9oZWFkIGVudHJ5OwoKIHN0cnVj
dCBtb2R1bGUgKm1vZHVsZTsKIHN0cnVjdCBkZXZpY2UgKmRldjsKIGNvbnN0IHN0cnVjdCBh
dHRyaWJ1dGVfZ3JvdXAgKiphdHRyX2dyb3VwczsKIGNvbnN0IHN0cnVjdCBhdHRyaWJ1dGVf
Z3JvdXAgKiphdHRyX3VwZGF0ZTsKIGNvbnN0IGNoYXIgKm5hbWU7CiBpbnQgdHlwZTsKCgoK
CiBpbnQgY2FwYWJpbGl0aWVzOwoKIGludCAqcG11X2Rpc2FibGVfY291bnQ7CiBzdHJ1Y3Qg
cGVyZl9jcHVfY29udGV4dCAqcG11X2NwdV9jb250ZXh0OwogYXRvbWljX3QgZXhjbHVzaXZl
X2NudDsKIGludCB0YXNrX2N0eF9ucjsKIGludCBocnRpbWVyX2ludGVydmFsX21zOwoKCiB1
bnNpZ25lZCBpbnQgbnJfYWRkcl9maWx0ZXJzOwoKCgoKCiB2b2lkICgqcG11X2VuYWJsZSkg
KHN0cnVjdCBwbXUgKnBtdSk7CiB2b2lkICgqcG11X2Rpc2FibGUpIChzdHJ1Y3QgcG11ICpw
bXUpOwojIDMxNiAiLi9pbmNsdWRlL2xpbnV4L3BlcmZfZXZlbnQuaCIKIGludCAoKmV2ZW50
X2luaXQpIChzdHJ1Y3QgcGVyZl9ldmVudCAqZXZlbnQpOwoKCgoKCiB2b2lkICgqZXZlbnRf
bWFwcGVkKSAoc3RydWN0IHBlcmZfZXZlbnQgKmV2ZW50LCBzdHJ1Y3QgbW1fc3RydWN0ICpt
bSk7CiB2b2lkICgqZXZlbnRfdW5tYXBwZWQpIChzdHJ1Y3QgcGVyZl9ldmVudCAqZXZlbnQs
IHN0cnVjdCBtbV9zdHJ1Y3QgKm1tKTsKIyAzNTEgIi4vaW5jbHVkZS9saW51eC9wZXJmX2V2
ZW50LmgiCiBpbnQgKCphZGQpIChzdHJ1Y3QgcGVyZl9ldmVudCAqZXZlbnQsIGludCBmbGFn
cyk7CiB2b2lkICgqZGVsKSAoc3RydWN0IHBlcmZfZXZlbnQgKmV2ZW50LCBpbnQgZmxhZ3Mp
OwojIDM3MiAiLi9pbmNsdWRlL2xpbnV4L3BlcmZfZXZlbnQuaCIKIHZvaWQgKCpzdGFydCkg
KHN0cnVjdCBwZXJmX2V2ZW50ICpldmVudCwgaW50IGZsYWdzKTsKIHZvaWQgKCpzdG9wKSAo
c3RydWN0IHBlcmZfZXZlbnQgKmV2ZW50LCBpbnQgZmxhZ3MpOwoKCgoKCgoKIHZvaWQgKCpy
ZWFkKSAoc3RydWN0IHBlcmZfZXZlbnQgKmV2ZW50KTsKIyAzOTMgIi4vaW5jbHVkZS9saW51
eC9wZXJmX2V2ZW50LmgiCiB2b2lkICgqc3RhcnRfdHhuKSAoc3RydWN0IHBtdSAqcG11LCB1
bnNpZ25lZCBpbnQgdHhuX2ZsYWdzKTsKIyA0MDIgIi4vaW5jbHVkZS9saW51eC9wZXJmX2V2
ZW50LmgiCiBpbnQgKCpjb21taXRfdHhuKSAoc3RydWN0IHBtdSAqcG11KTsKCgoKCgoKIHZv
aWQgKCpjYW5jZWxfdHhuKSAoc3RydWN0IHBtdSAqcG11KTsKCgoKCgogaW50ICgqZXZlbnRf
aWR4KSAoc3RydWN0IHBlcmZfZXZlbnQgKmV2ZW50KTsKCgoKCiB2b2lkICgqc2NoZWRfdGFz
aykgKHN0cnVjdCBwZXJmX2V2ZW50X2NvbnRleHQgKmN0eCwKICAgICBib29sIHNjaGVkX2lu
KTsKCgoKIHNpemVfdCB0YXNrX2N0eF9zaXplOwoKCgoKCgoKIHZvaWQgKCpzd2FwX3Rhc2tf
Y3R4KSAoc3RydWN0IHBlcmZfZXZlbnRfY29udGV4dCAqcHJldiwKICAgICAgc3RydWN0IHBl
cmZfZXZlbnRfY29udGV4dCAqbmV4dCk7CgoKCgoKIHZvaWQgKigqc2V0dXBfYXV4KSAoc3Ry
dWN0IHBlcmZfZXZlbnQgKmV2ZW50LCB2b2lkICoqcGFnZXMsCiAgICAgIGludCBucl9wYWdl
cywgYm9vbCBvdmVyd3JpdGUpOwoKCgoKCiB2b2lkICgqZnJlZV9hdXgpICh2b2lkICphdXgp
OwojIDQ1OCAiLi9pbmNsdWRlL2xpbnV4L3BlcmZfZXZlbnQuaCIKIGxvbmcgKCpzbmFwc2hv
dF9hdXgpIChzdHJ1Y3QgcGVyZl9ldmVudCAqZXZlbnQsCiAgICAgIHN0cnVjdCBwZXJmX291
dHB1dF9oYW5kbGUgKmhhbmRsZSwKICAgICAgdW5zaWduZWQgbG9uZyBzaXplKTsKIyA0NzAg
Ii4vaW5jbHVkZS9saW51eC9wZXJmX2V2ZW50LmgiCiBpbnQgKCphZGRyX2ZpbHRlcnNfdmFs
aWRhdGUpIChzdHJ1Y3QgbGlzdF9oZWFkICpmaWx0ZXJzKTsKIyA0ODQgIi4vaW5jbHVkZS9s
aW51eC9wZXJmX2V2ZW50LmgiCiB2b2lkICgqYWRkcl9maWx0ZXJzX3N5bmMpIChzdHJ1Y3Qg
cGVyZl9ldmVudCAqZXZlbnQpOwojIDQ5NCAiLi9pbmNsdWRlL2xpbnV4L3BlcmZfZXZlbnQu
aCIKIGludCAoKmF1eF9vdXRwdXRfbWF0Y2gpIChzdHJ1Y3QgcGVyZl9ldmVudCAqZXZlbnQp
OwoKCgoKCiBpbnQgKCpmaWx0ZXJfbWF0Y2gpIChzdHJ1Y3QgcGVyZl9ldmVudCAqZXZlbnQp
OwoKCgoKIGludCAoKmNoZWNrX3BlcmlvZCkgKHN0cnVjdCBwZXJmX2V2ZW50ICpldmVudCwg
dTY0IHZhbHVlKTsKfTsKCmVudW0gcGVyZl9hZGRyX2ZpbHRlcl9hY3Rpb25fdCB7CiBQRVJG
X0FERFJfRklMVEVSX0FDVElPTl9TVE9QID0gMCwKIFBFUkZfQUREUl9GSUxURVJfQUNUSU9O
X1NUQVJULAogUEVSRl9BRERSX0ZJTFRFUl9BQ1RJT05fRklMVEVSLAp9OwojIDUyNCAiLi9p
bmNsdWRlL2xpbnV4L3BlcmZfZXZlbnQuaCIKc3RydWN0IHBlcmZfYWRkcl9maWx0ZXIgewog
c3RydWN0IGxpc3RfaGVhZCBlbnRyeTsKIHN0cnVjdCBwYXRoIHBhdGg7CiB1bnNpZ25lZCBs
b25nIG9mZnNldDsKIHVuc2lnbmVkIGxvbmcgc2l6ZTsKIGVudW0gcGVyZl9hZGRyX2ZpbHRl
cl9hY3Rpb25fdCBhY3Rpb247Cn07CiMgNTQyICIuL2luY2x1ZGUvbGludXgvcGVyZl9ldmVu
dC5oIgpzdHJ1Y3QgcGVyZl9hZGRyX2ZpbHRlcnNfaGVhZCB7CiBzdHJ1Y3QgbGlzdF9oZWFk
IGxpc3Q7CiByYXdfc3BpbmxvY2tfdCBsb2NrOwogdW5zaWduZWQgaW50IG5yX2ZpbGVfZmls
dGVyczsKfTsKCnN0cnVjdCBwZXJmX2FkZHJfZmlsdGVyX3JhbmdlIHsKIHVuc2lnbmVkIGxv
bmcgc3RhcnQ7CiB1bnNpZ25lZCBsb25nIHNpemU7Cn07CgoKCgplbnVtIHBlcmZfZXZlbnRf
c3RhdGUgewogUEVSRl9FVkVOVF9TVEFURV9ERUFEID0gLTQsCiBQRVJGX0VWRU5UX1NUQVRF
X0VYSVQgPSAtMywKIFBFUkZfRVZFTlRfU1RBVEVfRVJST1IgPSAtMiwKIFBFUkZfRVZFTlRf
U1RBVEVfT0ZGID0gLTEsCiBQRVJGX0VWRU5UX1NUQVRFX0lOQUNUSVZFID0gMCwKIFBFUkZf
RVZFTlRfU1RBVEVfQUNUSVZFID0gMSwKfTsKCnN0cnVjdCBmaWxlOwpzdHJ1Y3QgcGVyZl9z
YW1wbGVfZGF0YTsKCnR5cGVkZWYgdm9pZCAoKnBlcmZfb3ZlcmZsb3dfaGFuZGxlcl90KShz
dHJ1Y3QgcGVyZl9ldmVudCAqLAogICAgIHN0cnVjdCBwZXJmX3NhbXBsZV9kYXRhICosCiAg
ICAgc3RydWN0IHB0X3JlZ3MgKnJlZ3MpOwojIDU4NSAiLi9pbmNsdWRlL2xpbnV4L3BlcmZf
ZXZlbnQuaCIKc3RydWN0IHN3ZXZlbnRfaGxpc3Qgewogc3RydWN0IGhsaXN0X2hlYWQgaGVh
ZHNbKDEgPDwgOCldOwogc3RydWN0IGNhbGxiYWNrX2hlYWQgY2FsbGJhY2tfaGVhZDsKfTsK
CgoKCgoKCnN0cnVjdCBwZXJmX2Nncm91cDsKc3RydWN0IHBlcmZfYnVmZmVyOwoKc3RydWN0
IHBtdV9ldmVudF9saXN0IHsKIHJhd19zcGlubG9ja190IGxvY2s7CiBzdHJ1Y3QgbGlzdF9o
ZWFkIGxpc3Q7Cn07CiMgNjExICIuL2luY2x1ZGUvbGludXgvcGVyZl9ldmVudC5oIgpzdHJ1
Y3QgcGVyZl9ldmVudCB7CgoKCgoKCiBzdHJ1Y3QgbGlzdF9oZWFkIGV2ZW50X2VudHJ5OwoK
CgoKCiBzdHJ1Y3QgbGlzdF9oZWFkIHNpYmxpbmdfbGlzdDsKIHN0cnVjdCBsaXN0X2hlYWQg
YWN0aXZlX2xpc3Q7CgoKCiBzdHJ1Y3QgcmJfbm9kZSBncm91cF9ub2RlOwogdTY0IGdyb3Vw
X2luZGV4OwoKCgoKCiBzdHJ1Y3QgbGlzdF9oZWFkIG1pZ3JhdGVfZW50cnk7Cgogc3RydWN0
IGhsaXN0X25vZGUgaGxpc3RfZW50cnk7CiBzdHJ1Y3QgbGlzdF9oZWFkIGFjdGl2ZV9lbnRy
eTsKIGludCBucl9zaWJsaW5nczsKCgogaW50IGV2ZW50X2NhcHM7CgogaW50IGdyb3VwX2Nh
cHM7Cgogc3RydWN0IHBlcmZfZXZlbnQgKmdyb3VwX2xlYWRlcjsKIHN0cnVjdCBwbXUgKnBt
dTsKIHZvaWQgKnBtdV9wcml2YXRlOwoKIGVudW0gcGVyZl9ldmVudF9zdGF0ZSBzdGF0ZTsK
IHVuc2lnbmVkIGludCBhdHRhY2hfc3RhdGU7CiBsb2NhbDY0X3QgY291bnQ7CiBhdG9taWM2
NF90IGNoaWxkX2NvdW50OwoKCgoKCgoKIHU2NCB0b3RhbF90aW1lX2VuYWJsZWQ7CiB1NjQg
dG90YWxfdGltZV9ydW5uaW5nOwogdTY0IHRzdGFtcDsKIyA2NzQgIi4vaW5jbHVkZS9saW51
eC9wZXJmX2V2ZW50LmgiCiB1NjQgc2hhZG93X2N0eF90aW1lOwoKIHN0cnVjdCBwZXJmX2V2
ZW50X2F0dHIgYXR0cjsKIHUxNiBoZWFkZXJfc2l6ZTsKIHUxNiBpZF9oZWFkZXJfc2l6ZTsK
IHUxNiByZWFkX3NpemU7CiBzdHJ1Y3QgaHdfcGVyZl9ldmVudCBodzsKCiBzdHJ1Y3QgcGVy
Zl9ldmVudF9jb250ZXh0ICpjdHg7CiBhdG9taWNfbG9uZ190IHJlZmNvdW50OwoKCgoKCiBh
dG9taWM2NF90IGNoaWxkX3RvdGFsX3RpbWVfZW5hYmxlZDsKIGF0b21pYzY0X3QgY2hpbGRf
dG90YWxfdGltZV9ydW5uaW5nOwoKCgoKIHN0cnVjdCBtdXRleCBjaGlsZF9tdXRleDsKIHN0
cnVjdCBsaXN0X2hlYWQgY2hpbGRfbGlzdDsKIHN0cnVjdCBwZXJmX2V2ZW50ICpwYXJlbnQ7
CgogaW50IG9uY3B1OwogaW50IGNwdTsKCiBzdHJ1Y3QgbGlzdF9oZWFkIG93bmVyX2VudHJ5
Owogc3RydWN0IHRhc2tfc3RydWN0ICpvd25lcjsKCgogc3RydWN0IG11dGV4IG1tYXBfbXV0
ZXg7CiBhdG9taWNfdCBtbWFwX2NvdW50OwoKIHN0cnVjdCBwZXJmX2J1ZmZlciAqcmI7CiBz
dHJ1Y3QgbGlzdF9oZWFkIHJiX2VudHJ5OwogdW5zaWduZWQgbG9uZyByY3VfYmF0Y2hlczsK
IGludCByY3VfcGVuZGluZzsKCgogd2FpdF9xdWV1ZV9oZWFkX3Qgd2FpdHE7CiBzdHJ1Y3Qg
ZmFzeW5jX3N0cnVjdCAqZmFzeW5jOwoKCiBpbnQgcGVuZGluZ193YWtldXA7CiBpbnQgcGVu
ZGluZ19raWxsOwogaW50IHBlbmRpbmdfZGlzYWJsZTsKIHN0cnVjdCBpcnFfd29yayBwZW5k
aW5nOwoKIGF0b21pY190IGV2ZW50X2xpbWl0OwoKCiBzdHJ1Y3QgcGVyZl9hZGRyX2ZpbHRl
cnNfaGVhZCBhZGRyX2ZpbHRlcnM7Cgogc3RydWN0IHBlcmZfYWRkcl9maWx0ZXJfcmFuZ2Ug
KmFkZHJfZmlsdGVyX3JhbmdlczsKIHVuc2lnbmVkIGxvbmcgYWRkcl9maWx0ZXJzX2dlbjsK
Cgogc3RydWN0IHBlcmZfZXZlbnQgKmF1eF9ldmVudDsKCiB2b2lkICgqZGVzdHJveSkoc3Ry
dWN0IHBlcmZfZXZlbnQgKik7CiBzdHJ1Y3QgY2FsbGJhY2tfaGVhZCBjYWxsYmFja19oZWFk
OwoKIHN0cnVjdCBwaWRfbmFtZXNwYWNlICpuczsKIHU2NCBpZDsKCiB1NjQgKCpjbG9jayko
dm9pZCk7CiBwZXJmX292ZXJmbG93X2hhbmRsZXJfdCBvdmVyZmxvd19oYW5kbGVyOwogdm9p
ZCAqb3ZlcmZsb3dfaGFuZGxlcl9jb250ZXh0OwoKCgoKCgogc3RydWN0IHRyYWNlX2V2ZW50
X2NhbGwgKnRwX2V2ZW50Owogc3RydWN0IGV2ZW50X2ZpbHRlciAqZmlsdGVyOwojIDc2NCAi
Li9pbmNsdWRlL2xpbnV4L3BlcmZfZXZlbnQuaCIKIHN0cnVjdCBsaXN0X2hlYWQgc2JfbGlz
dDsKCn07CgoKc3RydWN0IHBlcmZfZXZlbnRfZ3JvdXBzIHsKIHN0cnVjdCByYl9yb290IHRy
ZWU7CiB1NjQgaW5kZXg7Cn07CgoKCgoKCnN0cnVjdCBwZXJmX2V2ZW50X2NvbnRleHQgewog
c3RydWN0IHBtdSAqcG11OwoKCgoKIHJhd19zcGlubG9ja190IGxvY2s7CgoKCgoKIHN0cnVj
dCBtdXRleCBtdXRleDsKCiBzdHJ1Y3QgbGlzdF9oZWFkIGFjdGl2ZV9jdHhfbGlzdDsKIHN0
cnVjdCBwZXJmX2V2ZW50X2dyb3VwcyBwaW5uZWRfZ3JvdXBzOwogc3RydWN0IHBlcmZfZXZl
bnRfZ3JvdXBzIGZsZXhpYmxlX2dyb3VwczsKIHN0cnVjdCBsaXN0X2hlYWQgZXZlbnRfbGlz
dDsKCiBzdHJ1Y3QgbGlzdF9oZWFkIHBpbm5lZF9hY3RpdmU7CiBzdHJ1Y3QgbGlzdF9oZWFk
IGZsZXhpYmxlX2FjdGl2ZTsKCiBpbnQgbnJfZXZlbnRzOwogaW50IG5yX2FjdGl2ZTsKIGlu
dCBpc19hY3RpdmU7CiBpbnQgbnJfc3RhdDsKIGludCBucl9mcmVxOwogaW50IHJvdGF0ZV9k
aXNhYmxlOwoKCgoKIGludCByb3RhdGVfbmVjZXNzYXJ5OwogcmVmY291bnRfdCByZWZjb3Vu
dDsKIHN0cnVjdCB0YXNrX3N0cnVjdCAqdGFzazsKCgoKCiB1NjQgdGltZTsKIHU2NCB0aW1l
c3RhbXA7CgoKCgoKIHN0cnVjdCBwZXJmX2V2ZW50X2NvbnRleHQgKnBhcmVudF9jdHg7CiB1
NjQgcGFyZW50X2dlbjsKIHU2NCBnZW5lcmF0aW9uOwogaW50IHBpbl9jb3VudDsKCgoKIHZv
aWQgKnRhc2tfY3R4X2RhdGE7CiBzdHJ1Y3QgY2FsbGJhY2tfaGVhZCBjYWxsYmFja19oZWFk
Owp9OwojIDg0NSAiLi9pbmNsdWRlL2xpbnV4L3BlcmZfZXZlbnQuaCIKc3RydWN0IHBlcmZf
Y3B1X2NvbnRleHQgewogc3RydWN0IHBlcmZfZXZlbnRfY29udGV4dCBjdHg7CiBzdHJ1Y3Qg
cGVyZl9ldmVudF9jb250ZXh0ICp0YXNrX2N0eDsKIGludCBhY3RpdmVfb25jcHU7CiBpbnQg
ZXhjbHVzaXZlOwoKIHJhd19zcGlubG9ja190IGhydGltZXJfbG9jazsKIHN0cnVjdCBocnRp
bWVyIGhydGltZXI7CiBrdGltZV90IGhydGltZXJfaW50ZXJ2YWw7CiB1bnNpZ25lZCBpbnQg
aHJ0aW1lcl9hY3RpdmU7CgoKCgoKCiBzdHJ1Y3QgbGlzdF9oZWFkIHNjaGVkX2NiX2VudHJ5
OwogaW50IHNjaGVkX2NiX3VzYWdlOwoKIGludCBvbmxpbmU7CgoKCgogaW50IGhlYXBfc2l6
ZTsKIHN0cnVjdCBwZXJmX2V2ZW50ICoqaGVhcDsKIHN0cnVjdCBwZXJmX2V2ZW50ICpoZWFw
X2RlZmF1bHRbMl07Cn07CgpzdHJ1Y3QgcGVyZl9vdXRwdXRfaGFuZGxlIHsKIHN0cnVjdCBw
ZXJmX2V2ZW50ICpldmVudDsKIHN0cnVjdCBwZXJmX2J1ZmZlciAqcmI7CiB1bnNpZ25lZCBs
b25nIHdha2V1cDsKIHVuc2lnbmVkIGxvbmcgc2l6ZTsKIHU2NCBhdXhfZmxhZ3M7CiB1bmlv
biB7CiAgdm9pZCAqYWRkcjsKICB1bnNpZ25lZCBsb25nIGhlYWQ7CiB9OwogaW50IHBhZ2U7
Cn07CgpzdHJ1Y3QgYnBmX3BlcmZfZXZlbnRfZGF0YV9rZXJuIHsKIGJwZl91c2VyX3B0X3Jl
Z3NfdCAqcmVnczsKIHN0cnVjdCBwZXJmX3NhbXBsZV9kYXRhICpkYXRhOwogc3RydWN0IHBl
cmZfZXZlbnQgKmV2ZW50Owp9OwojIDkyNiAiLi9pbmNsdWRlL2xpbnV4L3BlcmZfZXZlbnQu
aCIKZXh0ZXJuIHZvaWQgKnBlcmZfYXV4X291dHB1dF9iZWdpbihzdHJ1Y3QgcGVyZl9vdXRw
dXRfaGFuZGxlICpoYW5kbGUsCiAgICAgICBzdHJ1Y3QgcGVyZl9ldmVudCAqZXZlbnQpOwpl
eHRlcm4gdm9pZCBwZXJmX2F1eF9vdXRwdXRfZW5kKHN0cnVjdCBwZXJmX291dHB1dF9oYW5k
bGUgKmhhbmRsZSwKICAgIHVuc2lnbmVkIGxvbmcgc2l6ZSk7CmV4dGVybiBpbnQgcGVyZl9h
dXhfb3V0cHV0X3NraXAoc3RydWN0IHBlcmZfb3V0cHV0X2hhbmRsZSAqaGFuZGxlLAogICAg
dW5zaWduZWQgbG9uZyBzaXplKTsKZXh0ZXJuIHZvaWQgKnBlcmZfZ2V0X2F1eChzdHJ1Y3Qg
cGVyZl9vdXRwdXRfaGFuZGxlICpoYW5kbGUpOwpleHRlcm4gdm9pZCBwZXJmX2F1eF9vdXRw
dXRfZmxhZyhzdHJ1Y3QgcGVyZl9vdXRwdXRfaGFuZGxlICpoYW5kbGUsIHU2NCBmbGFncyk7
CmV4dGVybiB2b2lkIHBlcmZfZXZlbnRfaXRyYWNlX3N0YXJ0ZWQoc3RydWN0IHBlcmZfZXZl
bnQgKmV2ZW50KTsKCmV4dGVybiBpbnQgcGVyZl9wbXVfcmVnaXN0ZXIoc3RydWN0IHBtdSAq
cG11LCBjb25zdCBjaGFyICpuYW1lLCBpbnQgdHlwZSk7CmV4dGVybiB2b2lkIHBlcmZfcG11
X3VucmVnaXN0ZXIoc3RydWN0IHBtdSAqcG11KTsKCmV4dGVybiBpbnQgcGVyZl9udW1fY291
bnRlcnModm9pZCk7CmV4dGVybiBjb25zdCBjaGFyICpwZXJmX3BtdV9uYW1lKHZvaWQpOwpl
eHRlcm4gdm9pZCBfX3BlcmZfZXZlbnRfdGFza19zY2hlZF9pbihzdHJ1Y3QgdGFza19zdHJ1
Y3QgKnByZXYsCiAgICAgICAgICAgc3RydWN0IHRhc2tfc3RydWN0ICp0YXNrKTsKZXh0ZXJu
IHZvaWQgX19wZXJmX2V2ZW50X3Rhc2tfc2NoZWRfb3V0KHN0cnVjdCB0YXNrX3N0cnVjdCAq
cHJldiwKICAgICBzdHJ1Y3QgdGFza19zdHJ1Y3QgKm5leHQpOwpleHRlcm4gaW50IHBlcmZf
ZXZlbnRfaW5pdF90YXNrKHN0cnVjdCB0YXNrX3N0cnVjdCAqY2hpbGQpOwpleHRlcm4gdm9p
ZCBwZXJmX2V2ZW50X2V4aXRfdGFzayhzdHJ1Y3QgdGFza19zdHJ1Y3QgKmNoaWxkKTsKZXh0
ZXJuIHZvaWQgcGVyZl9ldmVudF9mcmVlX3Rhc2soc3RydWN0IHRhc2tfc3RydWN0ICp0YXNr
KTsKZXh0ZXJuIHZvaWQgcGVyZl9ldmVudF9kZWxheWVkX3B1dChzdHJ1Y3QgdGFza19zdHJ1
Y3QgKnRhc2spOwpleHRlcm4gc3RydWN0IGZpbGUgKnBlcmZfZXZlbnRfZ2V0KHVuc2lnbmVk
IGludCBmZCk7CmV4dGVybiBjb25zdCBzdHJ1Y3QgcGVyZl9ldmVudCAqcGVyZl9nZXRfZXZl
bnQoc3RydWN0IGZpbGUgKmZpbGUpOwpleHRlcm4gY29uc3Qgc3RydWN0IHBlcmZfZXZlbnRf
YXR0ciAqcGVyZl9ldmVudF9hdHRycyhzdHJ1Y3QgcGVyZl9ldmVudCAqZXZlbnQpOwpleHRl
cm4gdm9pZCBwZXJmX2V2ZW50X3ByaW50X2RlYnVnKHZvaWQpOwpleHRlcm4gdm9pZCBwZXJm
X3BtdV9kaXNhYmxlKHN0cnVjdCBwbXUgKnBtdSk7CmV4dGVybiB2b2lkIHBlcmZfcG11X2Vu
YWJsZShzdHJ1Y3QgcG11ICpwbXUpOwpleHRlcm4gdm9pZCBwZXJmX3NjaGVkX2NiX2RlYyhz
dHJ1Y3QgcG11ICpwbXUpOwpleHRlcm4gdm9pZCBwZXJmX3NjaGVkX2NiX2luYyhzdHJ1Y3Qg
cG11ICpwbXUpOwpleHRlcm4gaW50IHBlcmZfZXZlbnRfdGFza19kaXNhYmxlKHZvaWQpOwpl
eHRlcm4gaW50IHBlcmZfZXZlbnRfdGFza19lbmFibGUodm9pZCk7CgpleHRlcm4gdm9pZCBw
ZXJmX3BtdV9yZXNjaGVkKHN0cnVjdCBwbXUgKnBtdSk7CgpleHRlcm4gaW50IHBlcmZfZXZl
bnRfcmVmcmVzaChzdHJ1Y3QgcGVyZl9ldmVudCAqZXZlbnQsIGludCByZWZyZXNoKTsKZXh0
ZXJuIHZvaWQgcGVyZl9ldmVudF91cGRhdGVfdXNlcnBhZ2Uoc3RydWN0IHBlcmZfZXZlbnQg
KmV2ZW50KTsKZXh0ZXJuIGludCBwZXJmX2V2ZW50X3JlbGVhc2Vfa2VybmVsKHN0cnVjdCBw
ZXJmX2V2ZW50ICpldmVudCk7CmV4dGVybiBzdHJ1Y3QgcGVyZl9ldmVudCAqCnBlcmZfZXZl
bnRfY3JlYXRlX2tlcm5lbF9jb3VudGVyKHN0cnVjdCBwZXJmX2V2ZW50X2F0dHIgKmF0dHIs
CiAgICBpbnQgY3B1LAogICAgc3RydWN0IHRhc2tfc3RydWN0ICp0YXNrLAogICAgcGVyZl9v
dmVyZmxvd19oYW5kbGVyX3QgY2FsbGJhY2ssCiAgICB2b2lkICpjb250ZXh0KTsKZXh0ZXJu
IHZvaWQgcGVyZl9wbXVfbWlncmF0ZV9jb250ZXh0KHN0cnVjdCBwbXUgKnBtdSwKICAgIGlu
dCBzcmNfY3B1LCBpbnQgZHN0X2NwdSk7CmludCBwZXJmX2V2ZW50X3JlYWRfbG9jYWwoc3Ry
dWN0IHBlcmZfZXZlbnQgKmV2ZW50LCB1NjQgKnZhbHVlLAogICAgIHU2NCAqZW5hYmxlZCwg
dTY0ICpydW5uaW5nKTsKZXh0ZXJuIHU2NCBwZXJmX2V2ZW50X3JlYWRfdmFsdWUoc3RydWN0
IHBlcmZfZXZlbnQgKmV2ZW50LAogICAgIHU2NCAqZW5hYmxlZCwgdTY0ICpydW5uaW5nKTsK
CgpzdHJ1Y3QgcGVyZl9zYW1wbGVfZGF0YSB7CgoKCgogdTY0IGFkZHI7CiBzdHJ1Y3QgcGVy
Zl9yYXdfcmVjb3JkICpyYXc7CiBzdHJ1Y3QgcGVyZl9icmFuY2hfc3RhY2sgKmJyX3N0YWNr
OwogdTY0IHBlcmlvZDsKIHU2NCB3ZWlnaHQ7CiB1NjQgdHhuOwogdW5pb24gcGVyZl9tZW1f
ZGF0YV9zcmMgZGF0YV9zcmM7CgoKCgoKIHU2NCB0eXBlOwogdTY0IGlwOwogc3RydWN0IHsK
ICB1MzIgcGlkOwogIHUzMiB0aWQ7CiB9IHRpZF9lbnRyeTsKIHU2NCB0aW1lOwogdTY0IGlk
OwogdTY0IHN0cmVhbV9pZDsKIHN0cnVjdCB7CiAgdTMyIGNwdTsKICB1MzIgcmVzZXJ2ZWQ7
CiB9IGNwdV9lbnRyeTsKIHN0cnVjdCBwZXJmX2NhbGxjaGFpbl9lbnRyeSAqY2FsbGNoYWlu
OwogdTY0IGF1eF9zaXplOwoKCgoKCiBzdHJ1Y3QgcGVyZl9yZWdzIHJlZ3NfdXNlcjsKIHN0
cnVjdCBwdF9yZWdzIHJlZ3NfdXNlcl9jb3B5OwoKIHN0cnVjdCBwZXJmX3JlZ3MgcmVnc19p
bnRyOwogdTY0IHN0YWNrX3VzZXJfc2l6ZTsKCiB1NjQgcGh5c19hZGRyOwogdTY0IGNncm91
cDsKfSBfX2F0dHJpYnV0ZV9fKChfX2FsaWduZWRfXygoMSA8PCA2KSkpKTsKIyAxMDMzICIu
L2luY2x1ZGUvbGludXgvcGVyZl9ldmVudC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBwZXJmX3NhbXBs
ZV9kYXRhX2luaXQoc3RydWN0IHBlcmZfc2FtcGxlX2RhdGEgKmRhdGEsCiAgICAgIHU2NCBh
ZGRyLCB1NjQgcGVyaW9kKQp7CgogZGF0YS0+YWRkciA9IGFkZHI7CiBkYXRhLT5yYXcgPSAo
KHZvaWQgKikwKTsKIGRhdGEtPmJyX3N0YWNrID0gKCh2b2lkICopMCk7CiBkYXRhLT5wZXJp
b2QgPSBwZXJpb2Q7CiBkYXRhLT53ZWlnaHQgPSAwOwogZGF0YS0+ZGF0YV9zcmMudmFsID0g
KCgoKF9fdTY0KTB4MDEpIDw8IDApIHwgKCgoX191NjQpMHgwMSkgPDwgNSkgfCAoKChfX3U2
NCkweDAxKSA8PCAxOSkgfCAoKChfX3U2NCkweDAxKSA8PCAyNCkgfCAoKChfX3U2NCkweDAx
KSA8PCAyNikpOwogZGF0YS0+dHhuID0gMDsKfQoKZXh0ZXJuIHZvaWQgcGVyZl9vdXRwdXRf
c2FtcGxlKHN0cnVjdCBwZXJmX291dHB1dF9oYW5kbGUgKmhhbmRsZSwKICAgICAgICAgIHN0
cnVjdCBwZXJmX2V2ZW50X2hlYWRlciAqaGVhZGVyLAogICAgICAgICAgc3RydWN0IHBlcmZf
c2FtcGxlX2RhdGEgKmRhdGEsCiAgICAgICAgICBzdHJ1Y3QgcGVyZl9ldmVudCAqZXZlbnQp
OwpleHRlcm4gdm9pZCBwZXJmX3ByZXBhcmVfc2FtcGxlKHN0cnVjdCBwZXJmX2V2ZW50X2hl
YWRlciAqaGVhZGVyLAogICAgc3RydWN0IHBlcmZfc2FtcGxlX2RhdGEgKmRhdGEsCiAgICBz
dHJ1Y3QgcGVyZl9ldmVudCAqZXZlbnQsCiAgICBzdHJ1Y3QgcHRfcmVncyAqcmVncyk7Cgpl
eHRlcm4gaW50IHBlcmZfZXZlbnRfb3ZlcmZsb3coc3RydWN0IHBlcmZfZXZlbnQgKmV2ZW50
LAogICAgIHN0cnVjdCBwZXJmX3NhbXBsZV9kYXRhICpkYXRhLAogICAgIHN0cnVjdCBwdF9y
ZWdzICpyZWdzKTsKCmV4dGVybiB2b2lkIHBlcmZfZXZlbnRfb3V0cHV0X2ZvcndhcmQoc3Ry
dWN0IHBlcmZfZXZlbnQgKmV2ZW50LAogICAgICAgICBzdHJ1Y3QgcGVyZl9zYW1wbGVfZGF0
YSAqZGF0YSwKICAgICAgICAgc3RydWN0IHB0X3JlZ3MgKnJlZ3MpOwpleHRlcm4gdm9pZCBw
ZXJmX2V2ZW50X291dHB1dF9iYWNrd2FyZChzdHJ1Y3QgcGVyZl9ldmVudCAqZXZlbnQsCiAg
ICAgICAgICAgc3RydWN0IHBlcmZfc2FtcGxlX2RhdGEgKmRhdGEsCiAgICAgICAgICAgc3Ry
dWN0IHB0X3JlZ3MgKnJlZ3MpOwpleHRlcm4gaW50IHBlcmZfZXZlbnRfb3V0cHV0KHN0cnVj
dCBwZXJmX2V2ZW50ICpldmVudCwKICAgICAgICBzdHJ1Y3QgcGVyZl9zYW1wbGVfZGF0YSAq
ZGF0YSwKICAgICAgICBzdHJ1Y3QgcHRfcmVncyAqcmVncyk7CgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkKCiMgMTA2
OSAiLi9pbmNsdWRlL2xpbnV4L3BlcmZfZXZlbnQuaCIKICAgICAgICAgICAgICBib29sCmlz
X2RlZmF1bHRfb3ZlcmZsb3dfaGFuZGxlcihzdHJ1Y3QgcGVyZl9ldmVudCAqZXZlbnQpCnsK
IGlmIChfX2J1aWx0aW5fZXhwZWN0KCEhKGV2ZW50LT5vdmVyZmxvd19oYW5kbGVyID09IHBl
cmZfZXZlbnRfb3V0cHV0X2ZvcndhcmQpLCAxKSkKICByZXR1cm4gdHJ1ZTsKIGlmIChfX2J1
aWx0aW5fZXhwZWN0KCEhKGV2ZW50LT5vdmVyZmxvd19oYW5kbGVyID09IHBlcmZfZXZlbnRf
b3V0cHV0X2JhY2t3YXJkKSwgMCkpCiAgcmV0dXJuIHRydWU7CiByZXR1cm4gZmFsc2U7Cn0K
CmV4dGVybiB2b2lkCnBlcmZfZXZlbnRfaGVhZGVyX19pbml0X2lkKHN0cnVjdCBwZXJmX2V2
ZW50X2hlYWRlciAqaGVhZGVyLAogICAgICBzdHJ1Y3QgcGVyZl9zYW1wbGVfZGF0YSAqZGF0
YSwKICAgICAgc3RydWN0IHBlcmZfZXZlbnQgKmV2ZW50KTsKZXh0ZXJuIHZvaWQKcGVyZl9l
dmVudF9fb3V0cHV0X2lkX3NhbXBsZShzdHJ1Y3QgcGVyZl9ldmVudCAqZXZlbnQsCiAgICAg
ICAgc3RydWN0IHBlcmZfb3V0cHV0X2hhbmRsZSAqaGFuZGxlLAogICAgICAgIHN0cnVjdCBw
ZXJmX3NhbXBsZV9kYXRhICpzYW1wbGUpOwoKZXh0ZXJuIHZvaWQKcGVyZl9sb2dfbG9zdF9z
YW1wbGVzKHN0cnVjdCBwZXJmX2V2ZW50ICpldmVudCwgdTY0IGxvc3QpOwoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IGJvb2wgZXZlbnRfaGFzX2FueV9leGNsdWRlX2ZsYWcoc3RydWN0IHBlcmZfZXZlbnQgKmV2
ZW50KQp7CiBzdHJ1Y3QgcGVyZl9ldmVudF9hdHRyICphdHRyID0gJmV2ZW50LT5hdHRyOwoK
IHJldHVybiBhdHRyLT5leGNsdWRlX2lkbGUgfHwgYXR0ci0+ZXhjbHVkZV91c2VyIHx8CiAg
ICAgICAgYXR0ci0+ZXhjbHVkZV9rZXJuZWwgfHwgYXR0ci0+ZXhjbHVkZV9odiB8fAogICAg
ICAgIGF0dHItPmV4Y2x1ZGVfZ3Vlc3QgfHwgYXR0ci0+ZXhjbHVkZV9ob3N0Owp9CgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgYm9vbCBpc19zYW1wbGluZ19ldmVudChzdHJ1Y3QgcGVyZl9ldmVudCAqZXZlbnQp
CnsKIHJldHVybiBldmVudC0+YXR0ci5zYW1wbGVfcGVyaW9kICE9IDA7Cn0KCgoKCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBpbnQgaXNfc29mdHdhcmVfZXZlbnQoc3RydWN0IHBlcmZfZXZlbnQgKmV2ZW50KQp7
CiByZXR1cm4gZXZlbnQtPmV2ZW50X2NhcHMgJiAoKCgoMVVMKSkpIDw8ICgwKSk7Cn0KCgoK
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSBpbnQgaW5fc29mdHdhcmVfY29udGV4dChzdHJ1Y3QgcGVyZl9ldmVudCAq
ZXZlbnQpCnsKIHJldHVybiBldmVudC0+Y3R4LT5wbXUtPnRhc2tfY3R4X25yID09IHBlcmZf
c3dfY29udGV4dDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBpc19leGNsdXNpdmVfcG11KHN0cnVjdCBw
bXUgKnBtdSkKewogcmV0dXJuIHBtdS0+Y2FwYWJpbGl0aWVzICYgMHgxMDsKfQoKZXh0ZXJu
IHN0cnVjdCBzdGF0aWNfa2V5IHBlcmZfc3dldmVudF9lbmFibGVkW1BFUkZfQ09VTlRfU1df
TUFYXTsKCmV4dGVybiB2b2lkIF9fX3BlcmZfc3dfZXZlbnQodTMyLCB1NjQsIHN0cnVjdCBw
dF9yZWdzICosIHU2NCk7CmV4dGVybiB2b2lkIF9fcGVyZl9zd19ldmVudCh1MzIsIHU2NCwg
c3RydWN0IHB0X3JlZ3MgKiwgdTY0KTsKIyAxMTQ5ICIuL2luY2x1ZGUvbGludXgvcGVyZl9l
dmVudC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBwZXJmX2ZldGNoX2NhbGxlcl9yZWdzKHN0cnVjdCBw
dF9yZWdzICpyZWdzKQp7CiBkbyB7IChyZWdzKS0+cmVzdWx0ID0gMDsgKHJlZ3MpLT5uaXAg
PSAoKHVuc2lnbmVkIGxvbmcpX19idWlsdGluX3JldHVybl9hZGRyZXNzKDApKTsgKHJlZ3Mp
LT5ncHJbMV0gPSBjdXJyZW50X3N0YWNrX2ZyYW1lKCk7IGFzbSB2b2xhdGlsZSgibWZtc3Ig
JTAiIDogIj1yIiAoKHJlZ3MpLT5tc3IpKTsgfSB3aGlsZSAoMCk7Cn0KCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBf
X2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHZvaWQKcGVyZl9zd19ldmVudCh1
MzIgZXZlbnRfaWQsIHU2NCBuciwgc3RydWN0IHB0X3JlZ3MgKnJlZ3MsIHU2NCBhZGRyKQp7
CiBpZiAoc3RhdGljX2tleV9mYWxzZSgmcGVyZl9zd2V2ZW50X2VuYWJsZWRbZXZlbnRfaWRd
KSkKICBfX3BlcmZfc3dfZXZlbnQoZXZlbnRfaWQsIG5yLCByZWdzLCBhZGRyKTsKfQoKZXh0
ZXJuIF9fYXR0cmlidXRlX18oKHNlY3Rpb24oIi5kYXRhLi5wZXJjcHUiICIiKSkpIF9fdHlw
ZW9mX18oc3RydWN0IHB0X3JlZ3MpIF9fcGVyZl9yZWdzWzRdOwoKCgoKCgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
X19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB2b2lkCnBlcmZfc3dfZXZlbnRf
c2NoZWQodTMyIGV2ZW50X2lkLCB1NjQgbnIsIHU2NCBhZGRyKQp7CiBpZiAoc3RhdGljX2tl
eV9mYWxzZSgmcGVyZl9zd2V2ZW50X2VuYWJsZWRbZXZlbnRfaWRdKSkgewogIHN0cnVjdCBw
dF9yZWdzICpyZWdzID0gKHsgZG8geyBjb25zdCB2b2lkICpfX3ZwcF92ZXJpZnkgPSAodHlw
ZW9mKCgmX19wZXJmX3JlZ3NbMF0pICsgMCkpKCh2b2lkICopMCk7ICh2b2lkKV9fdnBwX3Zl
cmlmeTsgfSB3aGlsZSAoMCk7ICh7IHVuc2lnbmVkIGxvbmcgX19wdHI7IF9fYXNtX18gKCIi
IDogIj1yIihfX3B0cikgOiAiMCIoKHR5cGVvZigqKCZfX3BlcmZfcmVnc1swXSkpICopKCZf
X3BlcmZfcmVnc1swXSkpKTsgKHR5cGVvZigodHlwZW9mKCooJl9fcGVyZl9yZWdzWzBdKSkg
KikoJl9fcGVyZl9yZWdzWzBdKSkpIChfX3B0ciArICgobG9jYWxfcGFjYS0+ZGF0YV9vZmZz
ZXQpKSk7IH0pOyB9KTsKCiAgcGVyZl9mZXRjaF9jYWxsZXJfcmVncyhyZWdzKTsKICBfX19w
ZXJmX3N3X2V2ZW50KGV2ZW50X2lkLCBuciwgcmVncywgYWRkcik7CiB9Cn0KCmV4dGVybiBz
dHJ1Y3Qgc3RhdGljX2tleV9mYWxzZSBwZXJmX3NjaGVkX2V2ZW50czsKCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBf
X2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpCgojIDExODEgIi4vaW5jbHVkZS9s
aW51eC9wZXJmX2V2ZW50LmgiCiAgICAgICAgICAgICAgICAgICAgICAgYm9vbApwZXJmX3N3
X21pZ3JhdGVfZW5hYmxlZCh2b2lkKQp7CiBpZiAoc3RhdGljX2tleV9mYWxzZSgmcGVyZl9z
d2V2ZW50X2VuYWJsZWRbUEVSRl9DT1VOVF9TV19DUFVfTUlHUkFUSU9OU10pKQogIHJldHVy
biB0cnVlOwogcmV0dXJuIGZhbHNlOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBwZXJmX2V2ZW50X3Rh
c2tfbWlncmF0ZShzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRhc2spCnsKIGlmIChwZXJmX3N3X21p
Z3JhdGVfZW5hYmxlZCgpKQogIHRhc2stPnNjaGVkX21pZ3JhdGVkID0gMTsKfQoKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIHZvaWQgcGVyZl9ldmVudF90YXNrX3NjaGVkX2luKHN0cnVjdCB0YXNrX3N0cnVjdCAq
cHJldiwKICAgICAgICAgc3RydWN0IHRhc2tfc3RydWN0ICp0YXNrKQp7CiBpZiAoX19idWls
dGluX2V4cGVjdCghISgoeyBpZiAoIV9fYnVpbHRpbl90eXBlc19jb21wYXRpYmxlX3AodHlw
ZW9mKComKCZwZXJmX3NjaGVkX2V2ZW50cyktPmtleSksIHN0cnVjdCBzdGF0aWNfa2V5KSAm
JiAhX19idWlsdGluX3R5cGVzX2NvbXBhdGlibGVfcCh0eXBlb2YoKiYoJnBlcmZfc2NoZWRf
ZXZlbnRzKS0+a2V5KSwgc3RydWN0IHN0YXRpY19rZXlfdHJ1ZSkgJiYgIV9fYnVpbHRpbl90
eXBlc19jb21wYXRpYmxlX3AodHlwZW9mKComKCZwZXJmX3NjaGVkX2V2ZW50cyktPmtleSks
IHN0cnVjdCBzdGF0aWNfa2V5X2ZhbHNlKSkgX19fX3dyb25nX2JyYW5jaF9lcnJvcigpOyBz
dGF0aWNfa2V5X2NvdW50KChzdHJ1Y3Qgc3RhdGljX2tleSAqKSYoJnBlcmZfc2NoZWRfZXZl
bnRzKS0+a2V5KSA+IDA7IH0pKSwgMCkpCiAgX19wZXJmX2V2ZW50X3Rhc2tfc2NoZWRfaW4o
cHJldiwgdGFzayk7CgogaWYgKHBlcmZfc3dfbWlncmF0ZV9lbmFibGVkKCkgJiYgdGFzay0+
c2NoZWRfbWlncmF0ZWQpIHsKICBzdHJ1Y3QgcHRfcmVncyAqcmVncyA9ICh7IGRvIHsgY29u
c3Qgdm9pZCAqX192cHBfdmVyaWZ5ID0gKHR5cGVvZigoJl9fcGVyZl9yZWdzWzBdKSArIDAp
KSgodm9pZCAqKTApOyAodm9pZClfX3ZwcF92ZXJpZnk7IH0gd2hpbGUgKDApOyAoeyB1bnNp
Z25lZCBsb25nIF9fcHRyOyBfX2FzbV9fICgiIiA6ICI9ciIoX19wdHIpIDogIjAiKCh0eXBl
b2YoKigmX19wZXJmX3JlZ3NbMF0pKSAqKSgmX19wZXJmX3JlZ3NbMF0pKSk7ICh0eXBlb2Yo
KHR5cGVvZigqKCZfX3BlcmZfcmVnc1swXSkpICopKCZfX3BlcmZfcmVnc1swXSkpKSAoX19w
dHIgKyAoKGxvY2FsX3BhY2EtPmRhdGFfb2Zmc2V0KSkpOyB9KTsgfSk7CgogIHBlcmZfZmV0
Y2hfY2FsbGVyX3JlZ3MocmVncyk7CiAgX19fcGVyZl9zd19ldmVudChQRVJGX0NPVU5UX1NX
X0NQVV9NSUdSQVRJT05TLCAxLCByZWdzLCAwKTsKICB0YXNrLT5zY2hlZF9taWdyYXRlZCA9
IDA7CiB9Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHBlcmZfZXZlbnRfdGFza19zY2hlZF9vdXQoc3Ry
dWN0IHRhc2tfc3RydWN0ICpwcmV2LAogICAgICAgICAgc3RydWN0IHRhc2tfc3RydWN0ICpu
ZXh0KQp7CiBwZXJmX3N3X2V2ZW50X3NjaGVkKFBFUkZfQ09VTlRfU1dfQ09OVEVYVF9TV0lU
Q0hFUywgMSwgMCk7CgogaWYgKF9fYnVpbHRpbl9leHBlY3QoISEoKHsgaWYgKCFfX2J1aWx0
aW5fdHlwZXNfY29tcGF0aWJsZV9wKHR5cGVvZigqJigmcGVyZl9zY2hlZF9ldmVudHMpLT5r
ZXkpLCBzdHJ1Y3Qgc3RhdGljX2tleSkgJiYgIV9fYnVpbHRpbl90eXBlc19jb21wYXRpYmxl
X3AodHlwZW9mKComKCZwZXJmX3NjaGVkX2V2ZW50cyktPmtleSksIHN0cnVjdCBzdGF0aWNf
a2V5X3RydWUpICYmICFfX2J1aWx0aW5fdHlwZXNfY29tcGF0aWJsZV9wKHR5cGVvZigqJigm
cGVyZl9zY2hlZF9ldmVudHMpLT5rZXkpLCBzdHJ1Y3Qgc3RhdGljX2tleV9mYWxzZSkpIF9f
X193cm9uZ19icmFuY2hfZXJyb3IoKTsgc3RhdGljX2tleV9jb3VudCgoc3RydWN0IHN0YXRp
Y19rZXkgKikmKCZwZXJmX3NjaGVkX2V2ZW50cyktPmtleSkgPiAwOyB9KSksIDApKQogIF9f
cGVyZl9ldmVudF90YXNrX3NjaGVkX291dChwcmV2LCBuZXh0KTsKfQoKZXh0ZXJuIHZvaWQg
cGVyZl9ldmVudF9tbWFwKHN0cnVjdCB2bV9hcmVhX3N0cnVjdCAqdm1hKTsKCmV4dGVybiB2
b2lkIHBlcmZfZXZlbnRfa3N5bWJvbCh1MTYga3N5bV90eXBlLCB1NjQgYWRkciwgdTMyIGxl
biwKICAgICAgICAgIGJvb2wgdW5yZWdpc3RlciwgY29uc3QgY2hhciAqc3ltKTsKZXh0ZXJu
IHZvaWQgcGVyZl9ldmVudF9icGZfZXZlbnQoc3RydWN0IGJwZl9wcm9nICpwcm9nLAogICAg
IGVudW0gcGVyZl9icGZfZXZlbnRfdHlwZSB0eXBlLAogICAgIHUxNiBmbGFncyk7CgpleHRl
cm4gc3RydWN0IHBlcmZfZ3Vlc3RfaW5mb19jYWxsYmFja3MgKnBlcmZfZ3Vlc3RfY2JzOwpl
eHRlcm4gaW50IHBlcmZfcmVnaXN0ZXJfZ3Vlc3RfaW5mb19jYWxsYmFja3Moc3RydWN0IHBl
cmZfZ3Vlc3RfaW5mb19jYWxsYmFja3MgKmNhbGxiYWNrcyk7CmV4dGVybiBpbnQgcGVyZl91
bnJlZ2lzdGVyX2d1ZXN0X2luZm9fY2FsbGJhY2tzKHN0cnVjdCBwZXJmX2d1ZXN0X2luZm9f
Y2FsbGJhY2tzICpjYWxsYmFja3MpOwoKZXh0ZXJuIHZvaWQgcGVyZl9ldmVudF9leGVjKHZv
aWQpOwpleHRlcm4gdm9pZCBwZXJmX2V2ZW50X2NvbW0oc3RydWN0IHRhc2tfc3RydWN0ICp0
c2ssIGJvb2wgZXhlYyk7CmV4dGVybiB2b2lkIHBlcmZfZXZlbnRfbmFtZXNwYWNlcyhzdHJ1
Y3QgdGFza19zdHJ1Y3QgKnRzayk7CmV4dGVybiB2b2lkIHBlcmZfZXZlbnRfZm9yayhzdHJ1
Y3QgdGFza19zdHJ1Y3QgKnRzayk7CgoKZXh0ZXJuIF9fYXR0cmlidXRlX18oKHNlY3Rpb24o
Ii5kYXRhLi5wZXJjcHUiICIiKSkpIF9fdHlwZW9mX18oc3RydWN0IHBlcmZfY2FsbGNoYWlu
X2VudHJ5KSBwZXJmX2NhbGxjaGFpbl9lbnRyeTsKCmV4dGVybiB2b2lkIHBlcmZfY2FsbGNo
YWluX3VzZXIoc3RydWN0IHBlcmZfY2FsbGNoYWluX2VudHJ5X2N0eCAqZW50cnksIHN0cnVj
dCBwdF9yZWdzICpyZWdzKTsKZXh0ZXJuIHZvaWQgcGVyZl9jYWxsY2hhaW5fa2VybmVsKHN0
cnVjdCBwZXJmX2NhbGxjaGFpbl9lbnRyeV9jdHggKmVudHJ5LCBzdHJ1Y3QgcHRfcmVncyAq
cmVncyk7CmV4dGVybiBzdHJ1Y3QgcGVyZl9jYWxsY2hhaW5fZW50cnkgKgpnZXRfcGVyZl9j
YWxsY2hhaW4oc3RydWN0IHB0X3JlZ3MgKnJlZ3MsIHUzMiBpbml0X25yLCBib29sIGtlcm5l
bCwgYm9vbCB1c2VyLAogICAgIHUzMiBtYXhfc3RhY2ssIGJvb2wgY3Jvc3N0YXNrLCBib29s
IGFkZF9tYXJrKTsKZXh0ZXJuIHN0cnVjdCBwZXJmX2NhbGxjaGFpbl9lbnRyeSAqcGVyZl9j
YWxsY2hhaW4oc3RydWN0IHBlcmZfZXZlbnQgKmV2ZW50LCBzdHJ1Y3QgcHRfcmVncyAqcmVn
cyk7CmV4dGVybiBpbnQgZ2V0X2NhbGxjaGFpbl9idWZmZXJzKGludCBtYXhfc3RhY2spOwpl
eHRlcm4gdm9pZCBwdXRfY2FsbGNoYWluX2J1ZmZlcnModm9pZCk7CgpleHRlcm4gaW50IHN5
c2N0bF9wZXJmX2V2ZW50X21heF9zdGFjazsKZXh0ZXJuIGludCBzeXNjdGxfcGVyZl9ldmVu
dF9tYXhfY29udGV4dHNfcGVyX3N0YWNrOwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBwZXJmX2NhbGxjaGFp
bl9zdG9yZV9jb250ZXh0KHN0cnVjdCBwZXJmX2NhbGxjaGFpbl9lbnRyeV9jdHggKmN0eCwg
dTY0IGlwKQp7CiBpZiAoY3R4LT5jb250ZXh0cyA8IHN5c2N0bF9wZXJmX2V2ZW50X21heF9j
b250ZXh0c19wZXJfc3RhY2spIHsKICBzdHJ1Y3QgcGVyZl9jYWxsY2hhaW5fZW50cnkgKmVu
dHJ5ID0gY3R4LT5lbnRyeTsKICBlbnRyeS0+aXBbZW50cnktPm5yKytdID0gaXA7CiAgKytj
dHgtPmNvbnRleHRzOwogIHJldHVybiAwOwogfSBlbHNlIHsKICBjdHgtPmNvbnRleHRzX21h
eGVkID0gdHJ1ZTsKICByZXR1cm4gLTE7CiB9Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgcGVyZl9jYWxs
Y2hhaW5fc3RvcmUoc3RydWN0IHBlcmZfY2FsbGNoYWluX2VudHJ5X2N0eCAqY3R4LCB1NjQg
aXApCnsKIGlmIChjdHgtPm5yIDwgY3R4LT5tYXhfc3RhY2sgJiYgIWN0eC0+Y29udGV4dHNf
bWF4ZWQpIHsKICBzdHJ1Y3QgcGVyZl9jYWxsY2hhaW5fZW50cnkgKmVudHJ5ID0gY3R4LT5l
bnRyeTsKICBlbnRyeS0+aXBbZW50cnktPm5yKytdID0gaXA7CiAgKytjdHgtPm5yOwogIHJl
dHVybiAwOwogfSBlbHNlIHsKICByZXR1cm4gLTE7CiB9Cn0KCmV4dGVybiBpbnQgc3lzY3Rs
X3BlcmZfZXZlbnRfcGFyYW5vaWQ7CmV4dGVybiBpbnQgc3lzY3RsX3BlcmZfZXZlbnRfbWxv
Y2s7CmV4dGVybiBpbnQgc3lzY3RsX3BlcmZfZXZlbnRfc2FtcGxlX3JhdGU7CmV4dGVybiBp
bnQgc3lzY3RsX3BlcmZfY3B1X3RpbWVfbWF4X3BlcmNlbnQ7CgpleHRlcm4gdm9pZCBwZXJm
X3NhbXBsZV9ldmVudF90b29rKHU2NCBzYW1wbGVfbGVuX25zKTsKCmludCBwZXJmX3Byb2Nf
dXBkYXRlX2hhbmRsZXIoc3RydWN0IGN0bF90YWJsZSAqdGFibGUsIGludCB3cml0ZSwKICB2
b2lkICpidWZmZXIsIHNpemVfdCAqbGVucCwgbG9mZl90ICpwcG9zKTsKaW50IHBlcmZfY3B1
X3RpbWVfbWF4X3BlcmNlbnRfaGFuZGxlcihzdHJ1Y3QgY3RsX3RhYmxlICp0YWJsZSwgaW50
IHdyaXRlLAogIHZvaWQgKmJ1ZmZlciwgc2l6ZV90ICpsZW5wLCBsb2ZmX3QgKnBwb3MpOwpp
bnQgcGVyZl9ldmVudF9tYXhfc3RhY2tfaGFuZGxlcihzdHJ1Y3QgY3RsX3RhYmxlICp0YWJs
ZSwgaW50IHdyaXRlLAogIHZvaWQgKmJ1ZmZlciwgc2l6ZV90ICpsZW5wLCBsb2ZmX3QgKnBw
b3MpOwojIDEyOTggIi4vaW5jbHVkZS9saW51eC9wZXJmX2V2ZW50LmgiCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBp
bnQgcGVyZl9pc19wYXJhbm9pZCh2b2lkKQp7CiByZXR1cm4gc3lzY3RsX3BlcmZfZXZlbnRf
cGFyYW5vaWQgPiAtMTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBwZXJmX2FsbG93X2tlcm5lbChzdHJ1
Y3QgcGVyZl9ldmVudF9hdHRyICphdHRyKQp7CiBpZiAoc3lzY3RsX3BlcmZfZXZlbnRfcGFy
YW5vaWQgPiAxICYmICFwZXJmbW9uX2NhcGFibGUoKSkKICByZXR1cm4gLTEzOwoKIHJldHVy
biBzZWN1cml0eV9wZXJmX2V2ZW50X29wZW4oYXR0ciwgMik7Cn0KCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQg
cGVyZl9hbGxvd19jcHUoc3RydWN0IHBlcmZfZXZlbnRfYXR0ciAqYXR0cikKewogaWYgKHN5
c2N0bF9wZXJmX2V2ZW50X3BhcmFub2lkID4gMCAmJiAhcGVyZm1vbl9jYXBhYmxlKCkpCiAg
cmV0dXJuIC0xMzsKCiByZXR1cm4gc2VjdXJpdHlfcGVyZl9ldmVudF9vcGVuKGF0dHIsIDEp
Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgaW50IHBlcmZfYWxsb3dfdHJhY2Vwb2ludChzdHJ1Y3QgcGVyZl9l
dmVudF9hdHRyICphdHRyKQp7CiBpZiAoc3lzY3RsX3BlcmZfZXZlbnRfcGFyYW5vaWQgPiAt
MSAmJiAhcGVyZm1vbl9jYXBhYmxlKCkpCiAgcmV0dXJuIC0xOwoKIHJldHVybiBzZWN1cml0
eV9wZXJmX2V2ZW50X29wZW4oYXR0ciwgMyk7Cn0KCmV4dGVybiB2b2lkIHBlcmZfZXZlbnRf
aW5pdCh2b2lkKTsKZXh0ZXJuIHZvaWQgcGVyZl90cF9ldmVudCh1MTYgZXZlbnRfdHlwZSwg
dTY0IGNvdW50LCB2b2lkICpyZWNvcmQsCiAgICAgaW50IGVudHJ5X3NpemUsIHN0cnVjdCBw
dF9yZWdzICpyZWdzLAogICAgIHN0cnVjdCBobGlzdF9oZWFkICpoZWFkLCBpbnQgcmN0eCwK
ICAgICBzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRhc2spOwpleHRlcm4gdm9pZCBwZXJmX2JwX2V2
ZW50KHN0cnVjdCBwZXJmX2V2ZW50ICpldmVudCwgdm9pZCAqZGF0YSk7CiMgMTM0MyAiLi9p
bmNsdWRlL2xpbnV4L3BlcmZfZXZlbnQuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgaGFzX2JyYW5jaF9z
dGFjayhzdHJ1Y3QgcGVyZl9ldmVudCAqZXZlbnQpCnsKIHJldHVybiBldmVudC0+YXR0ci5z
YW1wbGVfdHlwZSAmIFBFUkZfU0FNUExFX0JSQU5DSF9TVEFDSzsKfQoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJv
b2wgbmVlZHNfYnJhbmNoX3N0YWNrKHN0cnVjdCBwZXJmX2V2ZW50ICpldmVudCkKewogcmV0
dXJuIGV2ZW50LT5hdHRyLmJyYW5jaF9zYW1wbGVfdHlwZSAhPSAwOwp9CgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
Ym9vbCBoYXNfYXV4KHN0cnVjdCBwZXJmX2V2ZW50ICpldmVudCkKewogcmV0dXJuIGV2ZW50
LT5wbXUtPnNldHVwX2F1eDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgaXNfd3JpdGVfYmFja3dhcmQo
c3RydWN0IHBlcmZfZXZlbnQgKmV2ZW50KQp7CiByZXR1cm4gISFldmVudC0+YXR0ci53cml0
ZV9iYWNrd2FyZDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgaGFzX2FkZHJfZmlsdGVyKHN0cnVjdCBw
ZXJmX2V2ZW50ICpldmVudCkKewogcmV0dXJuIGV2ZW50LT5wbXUtPm5yX2FkZHJfZmlsdGVy
czsKfQoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHN0cnVjdCBwZXJmX2FkZHJfZmlsdGVyc19oZWFkICoKcGVy
Zl9ldmVudF9hZGRyX2ZpbHRlcnMoc3RydWN0IHBlcmZfZXZlbnQgKmV2ZW50KQp7CiBzdHJ1
Y3QgcGVyZl9hZGRyX2ZpbHRlcnNfaGVhZCAqaWZoID0gJmV2ZW50LT5hZGRyX2ZpbHRlcnM7
CgogaWYgKGV2ZW50LT5wYXJlbnQpCiAgaWZoID0gJmV2ZW50LT5wYXJlbnQtPmFkZHJfZmls
dGVyczsKCiByZXR1cm4gaWZoOwp9CgpleHRlcm4gdm9pZCBwZXJmX2V2ZW50X2FkZHJfZmls
dGVyc19zeW5jKHN0cnVjdCBwZXJmX2V2ZW50ICpldmVudCk7CgpleHRlcm4gaW50IHBlcmZf
b3V0cHV0X2JlZ2luKHN0cnVjdCBwZXJmX291dHB1dF9oYW5kbGUgKmhhbmRsZSwKICAgICAg
ICBzdHJ1Y3QgcGVyZl9ldmVudCAqZXZlbnQsIHVuc2lnbmVkIGludCBzaXplKTsKZXh0ZXJu
IGludCBwZXJmX291dHB1dF9iZWdpbl9mb3J3YXJkKHN0cnVjdCBwZXJmX291dHB1dF9oYW5k
bGUgKmhhbmRsZSwKICAgICAgICBzdHJ1Y3QgcGVyZl9ldmVudCAqZXZlbnQsCiAgICAgICAg
dW5zaWduZWQgaW50IHNpemUpOwpleHRlcm4gaW50IHBlcmZfb3V0cHV0X2JlZ2luX2JhY2t3
YXJkKHN0cnVjdCBwZXJmX291dHB1dF9oYW5kbGUgKmhhbmRsZSwKICAgICAgICAgIHN0cnVj
dCBwZXJmX2V2ZW50ICpldmVudCwKICAgICAgICAgIHVuc2lnbmVkIGludCBzaXplKTsKCmV4
dGVybiB2b2lkIHBlcmZfb3V0cHV0X2VuZChzdHJ1Y3QgcGVyZl9vdXRwdXRfaGFuZGxlICpo
YW5kbGUpOwpleHRlcm4gdW5zaWduZWQgaW50IHBlcmZfb3V0cHV0X2NvcHkoc3RydWN0IHBl
cmZfb3V0cHV0X2hhbmRsZSAqaGFuZGxlLAogICAgICAgIGNvbnN0IHZvaWQgKmJ1ZiwgdW5z
aWduZWQgaW50IGxlbik7CmV4dGVybiB1bnNpZ25lZCBpbnQgcGVyZl9vdXRwdXRfc2tpcChz
dHJ1Y3QgcGVyZl9vdXRwdXRfaGFuZGxlICpoYW5kbGUsCiAgICAgICAgIHVuc2lnbmVkIGlu
dCBsZW4pOwpleHRlcm4gbG9uZyBwZXJmX291dHB1dF9jb3B5X2F1eChzdHJ1Y3QgcGVyZl9v
dXRwdXRfaGFuZGxlICphdXhfaGFuZGxlLAogICAgIHN0cnVjdCBwZXJmX291dHB1dF9oYW5k
bGUgKmhhbmRsZSwKICAgICB1bnNpZ25lZCBsb25nIGZyb20sIHVuc2lnbmVkIGxvbmcgdG8p
OwpleHRlcm4gaW50IHBlcmZfc3dldmVudF9nZXRfcmVjdXJzaW9uX2NvbnRleHQodm9pZCk7
CmV4dGVybiB2b2lkIHBlcmZfc3dldmVudF9wdXRfcmVjdXJzaW9uX2NvbnRleHQoaW50IHJj
dHgpOwpleHRlcm4gdTY0IHBlcmZfc3dldmVudF9zZXRfcGVyaW9kKHN0cnVjdCBwZXJmX2V2
ZW50ICpldmVudCk7CmV4dGVybiB2b2lkIHBlcmZfZXZlbnRfZW5hYmxlKHN0cnVjdCBwZXJm
X2V2ZW50ICpldmVudCk7CmV4dGVybiB2b2lkIHBlcmZfZXZlbnRfZGlzYWJsZShzdHJ1Y3Qg
cGVyZl9ldmVudCAqZXZlbnQpOwpleHRlcm4gdm9pZCBwZXJmX2V2ZW50X2Rpc2FibGVfbG9j
YWwoc3RydWN0IHBlcmZfZXZlbnQgKmV2ZW50KTsKZXh0ZXJuIHZvaWQgcGVyZl9ldmVudF9k
aXNhYmxlX2luYXRvbWljKHN0cnVjdCBwZXJmX2V2ZW50ICpldmVudCk7CmV4dGVybiB2b2lk
IHBlcmZfZXZlbnRfdGFza190aWNrKHZvaWQpOwpleHRlcm4gaW50IHBlcmZfZXZlbnRfYWNj
b3VudF9pbnRlcnJ1cHQoc3RydWN0IHBlcmZfZXZlbnQgKmV2ZW50KTsKZXh0ZXJuIGludCBw
ZXJmX2V2ZW50X3BlcmlvZChzdHJ1Y3QgcGVyZl9ldmVudCAqZXZlbnQsIHU2NCB2YWx1ZSk7
CmV4dGVybiB1NjQgcGVyZl9ldmVudF9wYXVzZShzdHJ1Y3QgcGVyZl9ldmVudCAqZXZlbnQs
IGJvb2wgcmVzZXQpOwojIDE1MDQgIi4vaW5jbHVkZS9saW51eC9wZXJmX2V2ZW50LmgiCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSB2b2lkIHBlcmZfcmVzdG9yZV9kZWJ1Z19zdG9yZSh2b2lkKSB7IH0KCgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBib29sIHBlcmZfcmF3
X2ZyYWdfbGFzdChjb25zdCBzdHJ1Y3QgcGVyZl9yYXdfZnJhZyAqZnJhZykKewogcmV0dXJu
IGZyYWctPnBhZCA8IHNpemVvZih1NjQpOwp9CgoKCnN0cnVjdCBwZXJmX3BtdV9ldmVudHNf
YXR0ciB7CiBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSBhdHRyOwogdTY0IGlkOwogY29uc3Qg
Y2hhciAqZXZlbnRfc3RyOwp9OwoKc3RydWN0IHBlcmZfcG11X2V2ZW50c19odF9hdHRyIHsK
IHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlIGF0dHI7CiB1NjQgaWQ7CiBjb25zdCBjaGFyICpl
dmVudF9zdHJfaHQ7CiBjb25zdCBjaGFyICpldmVudF9zdHJfbm9odDsKfTsKCnNzaXplX3Qg
cGVyZl9ldmVudF9zeXNmc19zaG93KHN0cnVjdCBkZXZpY2UgKmRldiwgc3RydWN0IGRldmlj
ZV9hdHRyaWJ1dGUgKmF0dHIsCiAgICAgICAgIGNoYXIgKnBhZ2UpOwojIDE1NTcgIi4vaW5j
bHVkZS9saW51eC9wZXJmX2V2ZW50LmgiCmludCBwZXJmX2V2ZW50X2luaXRfY3B1KHVuc2ln
bmVkIGludCBjcHUpOwppbnQgcGVyZl9ldmVudF9leGl0X2NwdSh1bnNpZ25lZCBpbnQgY3B1
KTsKCgoKCgpleHRlcm4gdm9pZCBfX2F0dHJpYnV0ZV9fKChfX3dlYWtfXykpIGFyY2hfcGVy
Zl91cGRhdGVfdXNlcnBhZ2Uoc3RydWN0IHBlcmZfZXZlbnQgKmV2ZW50LAogICAgICAgICAg
c3RydWN0IHBlcmZfZXZlbnRfbW1hcF9wYWdlICp1c2VycGcsCiAgICAgICAgICB1NjQgbm93
KTsKIyAxMSAiLi9pbmNsdWRlL2xpbnV4L3RyYWNlX2V2ZW50cy5oIiAyCiMgMSAiLi9pbmNs
dWRlL2xpbnV4L3RyYWNlcG9pbnQuaCIgMQojIDEyICIuL2luY2x1ZGUvbGludXgvdHJhY2Vf
ZXZlbnRzLmgiIDIKCnN0cnVjdCB0cmFjZV9hcnJheTsKc3RydWN0IGFycmF5X2J1ZmZlcjsK
c3RydWN0IHRyYWNlcjsKc3RydWN0IGRlbnRyeTsKc3RydWN0IGJwZl9wcm9nOwoKY29uc3Qg
Y2hhciAqdHJhY2VfcHJpbnRfZmxhZ3Nfc2VxKHN0cnVjdCB0cmFjZV9zZXEgKnAsIGNvbnN0
IGNoYXIgKmRlbGltLAogICAgICB1bnNpZ25lZCBsb25nIGZsYWdzLAogICAgICBjb25zdCBz
dHJ1Y3QgdHJhY2VfcHJpbnRfZmxhZ3MgKmZsYWdfYXJyYXkpOwoKY29uc3QgY2hhciAqdHJh
Y2VfcHJpbnRfc3ltYm9sc19zZXEoc3RydWN0IHRyYWNlX3NlcSAqcCwgdW5zaWduZWQgbG9u
ZyB2YWwsCiAgICAgICAgY29uc3Qgc3RydWN0IHRyYWNlX3ByaW50X2ZsYWdzICpzeW1ib2xf
YXJyYXkpOwojIDM3ICIuL2luY2x1ZGUvbGludXgvdHJhY2VfZXZlbnRzLmgiCmNvbnN0IGNo
YXIgKnRyYWNlX3ByaW50X2JpdG1hc2tfc2VxKHN0cnVjdCB0cmFjZV9zZXEgKnAsIHZvaWQg
KmJpdG1hc2tfcHRyLAogICAgICAgIHVuc2lnbmVkIGludCBiaXRtYXNrX3NpemUpOwoKY29u
c3QgY2hhciAqdHJhY2VfcHJpbnRfaGV4X3NlcShzdHJ1Y3QgdHJhY2Vfc2VxICpwLAogICAg
Y29uc3QgdW5zaWduZWQgY2hhciAqYnVmLCBpbnQgbGVuLAogICAgYm9vbCBjb25jYXRlbmF0
ZSk7Cgpjb25zdCBjaGFyICp0cmFjZV9wcmludF9hcnJheV9zZXEoc3RydWN0IHRyYWNlX3Nl
cSAqcCwKICAgICAgIGNvbnN0IHZvaWQgKmJ1ZiwgaW50IGNvdW50LAogICAgICAgc2l6ZV90
IGVsX3NpemUpOwoKY29uc3QgY2hhciAqCnRyYWNlX3ByaW50X2hleF9kdW1wX3NlcShzdHJ1
Y3QgdHJhY2Vfc2VxICpwLCBjb25zdCBjaGFyICpwcmVmaXhfc3RyLAogICAgaW50IHByZWZp
eF90eXBlLCBpbnQgcm93c2l6ZSwgaW50IGdyb3Vwc2l6ZSwKICAgIGNvbnN0IHZvaWQgKmJ1
Ziwgc2l6ZV90IGxlbiwgYm9vbCBhc2NpaSk7CgpzdHJ1Y3QgdHJhY2VfaXRlcmF0b3I7CnN0
cnVjdCB0cmFjZV9ldmVudDsKCmludCB0cmFjZV9yYXdfb3V0cHV0X3ByZXAoc3RydWN0IHRy
YWNlX2l0ZXJhdG9yICppdGVyLAogICAgIHN0cnVjdCB0cmFjZV9ldmVudCAqZXZlbnQpOwoK
CgoKCgoKc3RydWN0IHRyYWNlX2VudHJ5IHsKIHVuc2lnbmVkIHNob3J0IHR5cGU7CiB1bnNp
Z25lZCBjaGFyIGZsYWdzOwogdW5zaWduZWQgY2hhciBwcmVlbXB0X2NvdW50OwogaW50IHBp
ZDsKfTsKIyA3OSAiLi9pbmNsdWRlL2xpbnV4L3RyYWNlX2V2ZW50cy5oIgpzdHJ1Y3QgdHJh
Y2VfaXRlcmF0b3Igewogc3RydWN0IHRyYWNlX2FycmF5ICp0cjsKIHN0cnVjdCB0cmFjZXIg
KnRyYWNlOwogc3RydWN0IGFycmF5X2J1ZmZlciAqYXJyYXlfYnVmZmVyOwogdm9pZCAqcHJp
dmF0ZTsKIGludCBjcHVfZmlsZTsKIHN0cnVjdCBtdXRleCBtdXRleDsKIHN0cnVjdCByaW5n
X2J1ZmZlcl9pdGVyICoqYnVmZmVyX2l0ZXI7CiB1bnNpZ25lZCBsb25nIGl0ZXJfZmxhZ3M7
CiB2b2lkICp0ZW1wOwogdW5zaWduZWQgaW50IHRlbXBfc2l6ZTsKCgogc3RydWN0IHRyYWNl
X3NlcSB0bXBfc2VxOwoKIGNwdW1hc2tfdmFyX3Qgc3RhcnRlZDsKCgogYm9vbCBzbmFwc2hv
dDsKCgogc3RydWN0IHRyYWNlX3NlcSBzZXE7CiBzdHJ1Y3QgdHJhY2VfZW50cnkgKmVudDsK
IHVuc2lnbmVkIGxvbmcgbG9zdF9ldmVudHM7CiBpbnQgbGVmdG92ZXI7CiBpbnQgZW50X3Np
emU7CiBpbnQgY3B1OwogdTY0IHRzOwoKIGxvZmZfdCBwb3M7CiBsb25nIGlkeDsKCgp9OwoK
ZW51bSB0cmFjZV9pdGVyX2ZsYWdzIHsKIFRSQUNFX0ZJTEVfTEFUX0ZNVCA9IDEsCiBUUkFD
RV9GSUxFX0FOTk9UQVRFID0gMiwKIFRSQUNFX0ZJTEVfVElNRV9JTl9OUyA9IDQsCn07CgoK
dHlwZWRlZiBlbnVtIHByaW50X2xpbmVfdCAoKnRyYWNlX3ByaW50X2Z1bmMpKHN0cnVjdCB0
cmFjZV9pdGVyYXRvciAqaXRlciwKICAgICAgICAgIGludCBmbGFncywgc3RydWN0IHRyYWNl
X2V2ZW50ICpldmVudCk7CgpzdHJ1Y3QgdHJhY2VfZXZlbnRfZnVuY3Rpb25zIHsKIHRyYWNl
X3ByaW50X2Z1bmMgdHJhY2U7CiB0cmFjZV9wcmludF9mdW5jIHJhdzsKIHRyYWNlX3ByaW50
X2Z1bmMgaGV4OwogdHJhY2VfcHJpbnRfZnVuYyBiaW5hcnk7Cn07CgpzdHJ1Y3QgdHJhY2Vf
ZXZlbnQgewogc3RydWN0IGhsaXN0X25vZGUgbm9kZTsKIHN0cnVjdCBsaXN0X2hlYWQgbGlz
dDsKIGludCB0eXBlOwogc3RydWN0IHRyYWNlX2V2ZW50X2Z1bmN0aW9ucyAqZnVuY3M7Cn07
CgpleHRlcm4gaW50IHJlZ2lzdGVyX3RyYWNlX2V2ZW50KHN0cnVjdCB0cmFjZV9ldmVudCAq
ZXZlbnQpOwpleHRlcm4gaW50IHVucmVnaXN0ZXJfdHJhY2VfZXZlbnQoc3RydWN0IHRyYWNl
X2V2ZW50ICpldmVudCk7CgoKZW51bSBwcmludF9saW5lX3QgewogVFJBQ0VfVFlQRV9QQVJU
SUFMX0xJTkUgPSAwLAogVFJBQ0VfVFlQRV9IQU5ETEVEID0gMSwKIFRSQUNFX1RZUEVfVU5I
QU5ETEVEID0gMiwKIFRSQUNFX1RZUEVfTk9fQ09OU1VNRSA9IDMKfTsKCmVudW0gcHJpbnRf
bGluZV90IHRyYWNlX2hhbmRsZV9yZXR1cm4oc3RydWN0IHRyYWNlX3NlcSAqcyk7Cgp2b2lk
IHRyYWNpbmdfZ2VuZXJpY19lbnRyeV91cGRhdGUoc3RydWN0IHRyYWNlX2VudHJ5ICplbnRy
eSwKICAgICAgdW5zaWduZWQgc2hvcnQgdHlwZSwKICAgICAgdW5zaWduZWQgbG9uZyBmbGFn
cywKICAgICAgaW50IHBjKTsKc3RydWN0IHRyYWNlX2V2ZW50X2ZpbGU7CgpzdHJ1Y3Qgcmlu
Z19idWZmZXJfZXZlbnQgKgp0cmFjZV9ldmVudF9idWZmZXJfbG9ja19yZXNlcnZlKHN0cnVj
dCB0cmFjZV9idWZmZXIgKipjdXJyZW50X2J1ZmZlciwKICAgIHN0cnVjdCB0cmFjZV9ldmVu
dF9maWxlICp0cmFjZV9maWxlLAogICAgaW50IHR5cGUsIHVuc2lnbmVkIGxvbmcgbGVuLAog
ICAgdW5zaWduZWQgbG9uZyBmbGFncywgaW50IHBjKTsKCgoKCnZvaWQgdHJhY2luZ19yZWNv
cmRfdGFza2luZm8oc3RydWN0IHRhc2tfc3RydWN0ICp0YXNrLCBpbnQgZmxhZ3MpOwp2b2lk
IHRyYWNpbmdfcmVjb3JkX3Rhc2tpbmZvX3NjaGVkX3N3aXRjaChzdHJ1Y3QgdGFza19zdHJ1
Y3QgKnByZXYsCiAgICAgICBzdHJ1Y3QgdGFza19zdHJ1Y3QgKm5leHQsIGludCBmbGFncyk7
Cgp2b2lkIHRyYWNpbmdfcmVjb3JkX2NtZGxpbmUoc3RydWN0IHRhc2tfc3RydWN0ICp0YXNr
KTsKdm9pZCB0cmFjaW5nX3JlY29yZF90Z2lkKHN0cnVjdCB0YXNrX3N0cnVjdCAqdGFzayk7
CgppbnQgdHJhY2Vfb3V0cHV0X2NhbGwoc3RydWN0IHRyYWNlX2l0ZXJhdG9yICppdGVyLCBj
aGFyICpuYW1lLCBjaGFyICpmbXQsIC4uLik7CgpzdHJ1Y3QgZXZlbnRfZmlsdGVyOwoKZW51
bSB0cmFjZV9yZWcgewogVFJBQ0VfUkVHX1JFR0lTVEVSLAogVFJBQ0VfUkVHX1VOUkVHSVNU
RVIsCgogVFJBQ0VfUkVHX1BFUkZfUkVHSVNURVIsCiBUUkFDRV9SRUdfUEVSRl9VTlJFR0lT
VEVSLAogVFJBQ0VfUkVHX1BFUkZfT1BFTiwKIFRSQUNFX1JFR19QRVJGX0NMT1NFLAoKCgoK
CiBUUkFDRV9SRUdfUEVSRl9BREQsCiBUUkFDRV9SRUdfUEVSRl9ERUwsCgp9OwoKc3RydWN0
IHRyYWNlX2V2ZW50X2NhbGw7CgoKCnN0cnVjdCB0cmFjZV9ldmVudF9maWVsZHMgewogY29u
c3QgY2hhciAqdHlwZTsKIHVuaW9uIHsKICBzdHJ1Y3QgewogICBjb25zdCBjaGFyICpuYW1l
OwogICBjb25zdCBpbnQgc2l6ZTsKICAgY29uc3QgaW50IGFsaWduOwogICBjb25zdCBpbnQg
aXNfc2lnbmVkOwogICBjb25zdCBpbnQgZmlsdGVyX3R5cGU7CiAgfTsKICBpbnQgKCpkZWZp
bmVfZmllbGRzKShzdHJ1Y3QgdHJhY2VfZXZlbnRfY2FsbCAqKTsKIH07Cn07CgpzdHJ1Y3Qg
dHJhY2VfZXZlbnRfY2xhc3MgewogY29uc3QgY2hhciAqc3lzdGVtOwogdm9pZCAqcHJvYmU7
Cgogdm9pZCAqcGVyZl9wcm9iZTsKCiBpbnQgKCpyZWcpKHN0cnVjdCB0cmFjZV9ldmVudF9j
YWxsICpldmVudCwKICAgICAgICAgICBlbnVtIHRyYWNlX3JlZyB0eXBlLCB2b2lkICpkYXRh
KTsKIHN0cnVjdCB0cmFjZV9ldmVudF9maWVsZHMgKmZpZWxkc19hcnJheTsKIHN0cnVjdCBs
aXN0X2hlYWQgKigqZ2V0X2ZpZWxkcykoc3RydWN0IHRyYWNlX2V2ZW50X2NhbGwgKik7CiBz
dHJ1Y3QgbGlzdF9oZWFkIGZpZWxkczsKIGludCAoKnJhd19pbml0KShzdHJ1Y3QgdHJhY2Vf
ZXZlbnRfY2FsbCAqKTsKfTsKCmV4dGVybiBpbnQgdHJhY2VfZXZlbnRfcmVnKHN0cnVjdCB0
cmFjZV9ldmVudF9jYWxsICpldmVudCwKICAgICAgIGVudW0gdHJhY2VfcmVnIHR5cGUsIHZv
aWQgKmRhdGEpOwoKc3RydWN0IHRyYWNlX2V2ZW50X2J1ZmZlciB7CiBzdHJ1Y3QgdHJhY2Vf
YnVmZmVyICpidWZmZXI7CiBzdHJ1Y3QgcmluZ19idWZmZXJfZXZlbnQgKmV2ZW50Owogc3Ry
dWN0IHRyYWNlX2V2ZW50X2ZpbGUgKnRyYWNlX2ZpbGU7CiB2b2lkICplbnRyeTsKIHVuc2ln
bmVkIGxvbmcgZmxhZ3M7CiBpbnQgcGM7CiBzdHJ1Y3QgcHRfcmVncyAqcmVnczsKfTsKCnZv
aWQgKnRyYWNlX2V2ZW50X2J1ZmZlcl9yZXNlcnZlKHN0cnVjdCB0cmFjZV9ldmVudF9idWZm
ZXIgKmZidWZmZXIsCiAgICAgIHN0cnVjdCB0cmFjZV9ldmVudF9maWxlICp0cmFjZV9maWxl
LAogICAgICB1bnNpZ25lZCBsb25nIGxlbik7Cgp2b2lkIHRyYWNlX2V2ZW50X2J1ZmZlcl9j
b21taXQoc3RydWN0IHRyYWNlX2V2ZW50X2J1ZmZlciAqZmJ1ZmZlcik7CgplbnVtIHsKIFRS
QUNFX0VWRU5UX0ZMX0ZJTFRFUkVEX0JJVCwKIFRSQUNFX0VWRU5UX0ZMX0NBUF9BTllfQklU
LAogVFJBQ0VfRVZFTlRfRkxfTk9fU0VUX0ZJTFRFUl9CSVQsCiBUUkFDRV9FVkVOVF9GTF9J
R05PUkVfRU5BQkxFX0JJVCwKIFRSQUNFX0VWRU5UX0ZMX1RSQUNFUE9JTlRfQklULAogVFJB
Q0VfRVZFTlRfRkxfS1BST0JFX0JJVCwKIFRSQUNFX0VWRU5UX0ZMX1VQUk9CRV9CSVQsCn07
CiMgMjY2ICIuL2luY2x1ZGUvbGludXgvdHJhY2VfZXZlbnRzLmgiCmVudW0gewogVFJBQ0Vf
RVZFTlRfRkxfRklMVEVSRUQgPSAoMSA8PCBUUkFDRV9FVkVOVF9GTF9GSUxURVJFRF9CSVQp
LAogVFJBQ0VfRVZFTlRfRkxfQ0FQX0FOWSA9ICgxIDw8IFRSQUNFX0VWRU5UX0ZMX0NBUF9B
TllfQklUKSwKIFRSQUNFX0VWRU5UX0ZMX05PX1NFVF9GSUxURVIgPSAoMSA8PCBUUkFDRV9F
VkVOVF9GTF9OT19TRVRfRklMVEVSX0JJVCksCiBUUkFDRV9FVkVOVF9GTF9JR05PUkVfRU5B
QkxFID0gKDEgPDwgVFJBQ0VfRVZFTlRfRkxfSUdOT1JFX0VOQUJMRV9CSVQpLAogVFJBQ0Vf
RVZFTlRfRkxfVFJBQ0VQT0lOVCA9ICgxIDw8IFRSQUNFX0VWRU5UX0ZMX1RSQUNFUE9JTlRf
QklUKSwKIFRSQUNFX0VWRU5UX0ZMX0tQUk9CRSA9ICgxIDw8IFRSQUNFX0VWRU5UX0ZMX0tQ
Uk9CRV9CSVQpLAogVFJBQ0VfRVZFTlRfRkxfVVBST0JFID0gKDEgPDwgVFJBQ0VfRVZFTlRf
RkxfVVBST0JFX0JJVCksCn07CgoKCnN0cnVjdCB0cmFjZV9ldmVudF9jYWxsIHsKIHN0cnVj
dCBsaXN0X2hlYWQgbGlzdDsKIHN0cnVjdCB0cmFjZV9ldmVudF9jbGFzcyAqY2xhc3M7CiB1
bmlvbiB7CiAgY2hhciAqbmFtZTsKCiAgc3RydWN0IHRyYWNlcG9pbnQgKnRwOwogfTsKIHN0
cnVjdCB0cmFjZV9ldmVudCBldmVudDsKIGNoYXIgKnByaW50X2ZtdDsKIHN0cnVjdCBldmVu
dF9maWx0ZXIgKmZpbHRlcjsKIHZvaWQgKm1vZDsKIHZvaWQgKmRhdGE7CiMgMzAwICIuL2lu
Y2x1ZGUvbGludXgvdHJhY2VfZXZlbnRzLmgiCiBpbnQgZmxhZ3M7CgoKIGludCBwZXJmX3Jl
ZmNvdW50Owogc3RydWN0IGhsaXN0X2hlYWQgKnBlcmZfZXZlbnRzOwogc3RydWN0IGJwZl9w
cm9nX2FycmF5ICpwcm9nX2FycmF5OwoKIGludCAoKnBlcmZfcGVybSkoc3RydWN0IHRyYWNl
X2V2ZW50X2NhbGwgKiwKICAgICAgICBzdHJ1Y3QgcGVyZl9ldmVudCAqKTsKCn07CgoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIGJvb2wgYnBmX3Byb2dfYXJyYXlfdmFsaWQoc3RydWN0IHRyYWNlX2V2ZW50X2Nh
bGwgKmNhbGwpCnsKIyAzMzIgIi4vaW5jbHVkZS9saW51eC90cmFjZV9ldmVudHMuaCIKIHJl
dHVybiAhISh7IGRvIHsgZXh0ZXJuIHZvaWQgX19jb21waWxldGltZV9hc3NlcnRfMjExKHZv
aWQpIF9fYXR0cmlidXRlX18oKF9fZXJyb3JfXygiVW5zdXBwb3J0ZWQgYWNjZXNzIHNpemUg
Zm9yIHtSRUFELFdSSVRFfV9PTkNFKCkuIikpKTsgaWYgKCEoKHNpemVvZihjYWxsLT5wcm9n
X2FycmF5KSA9PSBzaXplb2YoY2hhcikgfHwgc2l6ZW9mKGNhbGwtPnByb2dfYXJyYXkpID09
IHNpemVvZihzaG9ydCkgfHwgc2l6ZW9mKGNhbGwtPnByb2dfYXJyYXkpID09IHNpemVvZihp
bnQpIHx8IHNpemVvZihjYWxsLT5wcm9nX2FycmF5KSA9PSBzaXplb2YobG9uZykpIHx8IHNp
emVvZihjYWxsLT5wcm9nX2FycmF5KSA9PSBzaXplb2YobG9uZyBsb25nKSkpIF9fY29tcGls
ZXRpbWVfYXNzZXJ0XzIxMSgpOyB9IHdoaWxlICgwKTsgKHsgdHlwZW9mKCBfR2VuZXJpYygo
Y2FsbC0+cHJvZ19hcnJheSksIGNoYXI6IChjaGFyKTAsIHVuc2lnbmVkIGNoYXI6ICh1bnNp
Z25lZCBjaGFyKTAsIHNpZ25lZCBjaGFyOiAoc2lnbmVkIGNoYXIpMCwgdW5zaWduZWQgc2hv
cnQ6ICh1bnNpZ25lZCBzaG9ydCkwLCBzaWduZWQgc2hvcnQ6IChzaWduZWQgc2hvcnQpMCwg
dW5zaWduZWQgaW50OiAodW5zaWduZWQgaW50KTAsIHNpZ25lZCBpbnQ6IChzaWduZWQgaW50
KTAsIHVuc2lnbmVkIGxvbmc6ICh1bnNpZ25lZCBsb25nKTAsIHNpZ25lZCBsb25nOiAoc2ln
bmVkIGxvbmcpMCwgdW5zaWduZWQgbG9uZyBsb25nOiAodW5zaWduZWQgbG9uZyBsb25nKTAs
IHNpZ25lZCBsb25nIGxvbmc6IChzaWduZWQgbG9uZyBsb25nKTAsIGRlZmF1bHQ6IChjYWxs
LT5wcm9nX2FycmF5KSkpIF9feCA9ICgqKGNvbnN0IHZvbGF0aWxlIHR5cGVvZiggX0dlbmVy
aWMoKGNhbGwtPnByb2dfYXJyYXkpLCBjaGFyOiAoY2hhcikwLCB1bnNpZ25lZCBjaGFyOiAo
dW5zaWduZWQgY2hhcikwLCBzaWduZWQgY2hhcjogKHNpZ25lZCBjaGFyKTAsIHVuc2lnbmVk
IHNob3J0OiAodW5zaWduZWQgc2hvcnQpMCwgc2lnbmVkIHNob3J0OiAoc2lnbmVkIHNob3J0
KTAsIHVuc2lnbmVkIGludDogKHVuc2lnbmVkIGludCkwLCBzaWduZWQgaW50OiAoc2lnbmVk
IGludCkwLCB1bnNpZ25lZCBsb25nOiAodW5zaWduZWQgbG9uZykwLCBzaWduZWQgbG9uZzog
KHNpZ25lZCBsb25nKTAsIHVuc2lnbmVkIGxvbmcgbG9uZzogKHVuc2lnbmVkIGxvbmcgbG9u
ZykwLCBzaWduZWQgbG9uZyBsb25nOiAoc2lnbmVkIGxvbmcgbG9uZykwLCBkZWZhdWx0OiAo
Y2FsbC0+cHJvZ19hcnJheSkpKSAqKSYoY2FsbC0+cHJvZ19hcnJheSkpOyBkbyB7IH0gd2hp
bGUgKDApOyAodHlwZW9mKGNhbGwtPnByb2dfYXJyYXkpKV9feDsgfSk7IH0pOwp9CgoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIGNvbnN0IGNoYXIgKgp0cmFjZV9ldmVudF9uYW1lKHN0cnVjdCB0cmFjZV9ldmVu
dF9jYWxsICpjYWxsKQp7CiBpZiAoY2FsbC0+ZmxhZ3MgJiBUUkFDRV9FVkVOVF9GTF9UUkFD
RVBPSU5UKQogIHJldHVybiBjYWxsLT50cCA/IGNhbGwtPnRwLT5uYW1lIDogKCh2b2lkICop
MCk7CiBlbHNlCiAgcmV0dXJuIGNhbGwtPm5hbWU7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3QgbGlz
dF9oZWFkICoKdHJhY2VfZ2V0X2ZpZWxkcyhzdHJ1Y3QgdHJhY2VfZXZlbnRfY2FsbCAqZXZl
bnRfY2FsbCkKewogaWYgKCFldmVudF9jYWxsLT5jbGFzcy0+Z2V0X2ZpZWxkcykKICByZXR1
cm4gJmV2ZW50X2NhbGwtPmNsYXNzLT5maWVsZHM7CiByZXR1cm4gZXZlbnRfY2FsbC0+Y2xh
c3MtPmdldF9maWVsZHMoZXZlbnRfY2FsbCk7Cn0KCnN0cnVjdCB0cmFjZV9hcnJheTsKc3Ry
dWN0IHRyYWNlX3N1YnN5c3RlbV9kaXI7CgplbnVtIHsKIEVWRU5UX0ZJTEVfRkxfRU5BQkxF
RF9CSVQsCiBFVkVOVF9GSUxFX0ZMX1JFQ09SREVEX0NNRF9CSVQsCiBFVkVOVF9GSUxFX0ZM
X1JFQ09SREVEX1RHSURfQklULAogRVZFTlRfRklMRV9GTF9GSUxURVJFRF9CSVQsCiBFVkVO
VF9GSUxFX0ZMX05PX1NFVF9GSUxURVJfQklULAogRVZFTlRfRklMRV9GTF9TT0ZUX01PREVf
QklULAogRVZFTlRfRklMRV9GTF9TT0ZUX0RJU0FCTEVEX0JJVCwKIEVWRU5UX0ZJTEVfRkxf
VFJJR0dFUl9NT0RFX0JJVCwKIEVWRU5UX0ZJTEVfRkxfVFJJR0dFUl9DT05EX0JJVCwKIEVW
RU5UX0ZJTEVfRkxfUElEX0ZJTFRFUl9CSVQsCiBFVkVOVF9GSUxFX0ZMX1dBU19FTkFCTEVE
X0JJVCwKfTsKCmV4dGVybiBzdHJ1Y3QgdHJhY2VfZXZlbnRfZmlsZSAqdHJhY2VfZ2V0X2V2
ZW50X2ZpbGUoY29uc3QgY2hhciAqaW5zdGFuY2UsCiAgICAgICAgICAgY29uc3QgY2hhciAq
c3lzdGVtLAogICAgICAgICAgIGNvbnN0IGNoYXIgKmV2ZW50KTsKZXh0ZXJuIHZvaWQgdHJh
Y2VfcHV0X2V2ZW50X2ZpbGUoc3RydWN0IHRyYWNlX2V2ZW50X2ZpbGUgKmZpbGUpOwoKCgpl
bnVtIGR5bmV2ZW50X3R5cGUgewogRFlORVZFTlRfVFlQRV9TWU5USCA9IDEsCiBEWU5FVkVO
VF9UWVBFX0tQUk9CRSwKIERZTkVWRU5UX1RZUEVfTk9ORSwKfTsKCnN0cnVjdCBkeW5ldmVu
dF9jbWQ7Cgp0eXBlZGVmIGludCAoKmR5bmV2ZW50X2NyZWF0ZV9mbl90KShzdHJ1Y3QgZHlu
ZXZlbnRfY21kICpjbWQpOwoKc3RydWN0IGR5bmV2ZW50X2NtZCB7CiBzdHJ1Y3Qgc2VxX2J1
ZiBzZXE7CiBjb25zdCBjaGFyICpldmVudF9uYW1lOwogdW5zaWduZWQgaW50IG5fZmllbGRz
OwogZW51bSBkeW5ldmVudF90eXBlIHR5cGU7CiBkeW5ldmVudF9jcmVhdGVfZm5fdCBydW5f
Y29tbWFuZDsKIHZvaWQgKnByaXZhdGVfZGF0YTsKfTsKCmV4dGVybiBpbnQgZHluZXZlbnRf
Y3JlYXRlKHN0cnVjdCBkeW5ldmVudF9jbWQgKmNtZCk7CgpleHRlcm4gaW50IHN5bnRoX2V2
ZW50X2RlbGV0ZShjb25zdCBjaGFyICpuYW1lKTsKCmV4dGVybiB2b2lkIHN5bnRoX2V2ZW50
X2NtZF9pbml0KHN0cnVjdCBkeW5ldmVudF9jbWQgKmNtZCwKICAgICBjaGFyICpidWYsIGlu
dCBtYXhsZW4pOwoKZXh0ZXJuIGludCBfX3N5bnRoX2V2ZW50X2dlbl9jbWRfc3RhcnQoc3Ry
dWN0IGR5bmV2ZW50X2NtZCAqY21kLAogICAgICAgICAgIGNvbnN0IGNoYXIgKm5hbWUsCiAg
ICAgICAgICAgc3RydWN0IG1vZHVsZSAqbW9kLCAuLi4pOwoKCgoKc3RydWN0IHN5bnRoX2Zp
ZWxkX2Rlc2MgewogY29uc3QgY2hhciAqdHlwZTsKIGNvbnN0IGNoYXIgKm5hbWU7Cn07Cgpl
eHRlcm4gaW50IHN5bnRoX2V2ZW50X2dlbl9jbWRfYXJyYXlfc3RhcnQoc3RydWN0IGR5bmV2
ZW50X2NtZCAqY21kLAogICAgICAgIGNvbnN0IGNoYXIgKm5hbWUsCiAgICAgICAgc3RydWN0
IG1vZHVsZSAqbW9kLAogICAgICAgIHN0cnVjdCBzeW50aF9maWVsZF9kZXNjICpmaWVsZHMs
CiAgICAgICAgdW5zaWduZWQgaW50IG5fZmllbGRzKTsKZXh0ZXJuIGludCBzeW50aF9ldmVu
dF9jcmVhdGUoY29uc3QgY2hhciAqbmFtZSwKICAgICAgICAgc3RydWN0IHN5bnRoX2ZpZWxk
X2Rlc2MgKmZpZWxkcywKICAgICAgICAgdW5zaWduZWQgaW50IG5fZmllbGRzLCBzdHJ1Y3Qg
bW9kdWxlICptb2QpOwoKZXh0ZXJuIGludCBzeW50aF9ldmVudF9hZGRfZmllbGQoc3RydWN0
IGR5bmV2ZW50X2NtZCAqY21kLAogICAgIGNvbnN0IGNoYXIgKnR5cGUsCiAgICAgY29uc3Qg
Y2hhciAqbmFtZSk7CmV4dGVybiBpbnQgc3ludGhfZXZlbnRfYWRkX2ZpZWxkX3N0cihzdHJ1
Y3QgZHluZXZlbnRfY21kICpjbWQsCiAgICAgICAgIGNvbnN0IGNoYXIgKnR5cGVfbmFtZSk7
CmV4dGVybiBpbnQgc3ludGhfZXZlbnRfYWRkX2ZpZWxkcyhzdHJ1Y3QgZHluZXZlbnRfY21k
ICpjbWQsCiAgICAgIHN0cnVjdCBzeW50aF9maWVsZF9kZXNjICpmaWVsZHMsCiAgICAgIHVu
c2lnbmVkIGludCBuX2ZpZWxkcyk7CgoKCgpzdHJ1Y3Qgc3ludGhfZXZlbnQ7CgpzdHJ1Y3Qg
c3ludGhfZXZlbnRfdHJhY2Vfc3RhdGUgewogc3RydWN0IHRyYWNlX2V2ZW50X2J1ZmZlciBm
YnVmZmVyOwogc3RydWN0IHN5bnRoX3RyYWNlX2V2ZW50ICplbnRyeTsKIHN0cnVjdCB0cmFj
ZV9idWZmZXIgKmJ1ZmZlcjsKIHN0cnVjdCBzeW50aF9ldmVudCAqZXZlbnQ7CiB1bnNpZ25l
ZCBpbnQgY3VyX2ZpZWxkOwogdW5zaWduZWQgaW50IG5fdTY0OwogYm9vbCBkaXNhYmxlZDsK
IGJvb2wgYWRkX25leHQ7CiBib29sIGFkZF9uYW1lOwp9OwoKZXh0ZXJuIGludCBzeW50aF9l
dmVudF90cmFjZShzdHJ1Y3QgdHJhY2VfZXZlbnRfZmlsZSAqZmlsZSwKICAgICAgICB1bnNp
Z25lZCBpbnQgbl92YWxzLCAuLi4pOwpleHRlcm4gaW50IHN5bnRoX2V2ZW50X3RyYWNlX2Fy
cmF5KHN0cnVjdCB0cmFjZV9ldmVudF9maWxlICpmaWxlLCB1NjQgKnZhbHMsCiAgICAgICB1
bnNpZ25lZCBpbnQgbl92YWxzKTsKZXh0ZXJuIGludCBzeW50aF9ldmVudF90cmFjZV9zdGFy
dChzdHJ1Y3QgdHJhY2VfZXZlbnRfZmlsZSAqZmlsZSwKICAgICAgIHN0cnVjdCBzeW50aF9l
dmVudF90cmFjZV9zdGF0ZSAqdHJhY2Vfc3RhdGUpOwpleHRlcm4gaW50IHN5bnRoX2V2ZW50
X2FkZF9uZXh0X3ZhbCh1NjQgdmFsLAogICAgICAgIHN0cnVjdCBzeW50aF9ldmVudF90cmFj
ZV9zdGF0ZSAqdHJhY2Vfc3RhdGUpOwpleHRlcm4gaW50IHN5bnRoX2V2ZW50X2FkZF92YWwo
Y29uc3QgY2hhciAqZmllbGRfbmFtZSwgdTY0IHZhbCwKICAgICAgICAgIHN0cnVjdCBzeW50
aF9ldmVudF90cmFjZV9zdGF0ZSAqdHJhY2Vfc3RhdGUpOwpleHRlcm4gaW50IHN5bnRoX2V2
ZW50X3RyYWNlX2VuZChzdHJ1Y3Qgc3ludGhfZXZlbnRfdHJhY2Vfc3RhdGUgKnRyYWNlX3N0
YXRlKTsKCmV4dGVybiBpbnQga3Byb2JlX2V2ZW50X2RlbGV0ZShjb25zdCBjaGFyICpuYW1l
KTsKCmV4dGVybiB2b2lkIGtwcm9iZV9ldmVudF9jbWRfaW5pdChzdHJ1Y3QgZHluZXZlbnRf
Y21kICpjbWQsCiAgICAgIGNoYXIgKmJ1ZiwgaW50IG1heGxlbik7CgoKCgoKCgpleHRlcm4g
aW50IF9fa3Byb2JlX2V2ZW50X2dlbl9jbWRfc3RhcnQoc3RydWN0IGR5bmV2ZW50X2NtZCAq
Y21kLAogICAgIGJvb2wga3JldHByb2JlLAogICAgIGNvbnN0IGNoYXIgKm5hbWUsCiAgICAg
Y29uc3QgY2hhciAqbG9jLCAuLi4pOwoKCgoKCgoKZXh0ZXJuIGludCBfX2twcm9iZV9ldmVu
dF9hZGRfZmllbGRzKHN0cnVjdCBkeW5ldmVudF9jbWQgKmNtZCwgLi4uKTsKIyA1MDcgIi4v
aW5jbHVkZS9saW51eC90cmFjZV9ldmVudHMuaCIKZW51bSB7CiBFVkVOVF9GSUxFX0ZMX0VO
QUJMRUQgPSAoMSA8PCBFVkVOVF9GSUxFX0ZMX0VOQUJMRURfQklUKSwKIEVWRU5UX0ZJTEVf
RkxfUkVDT1JERURfQ01EID0gKDEgPDwgRVZFTlRfRklMRV9GTF9SRUNPUkRFRF9DTURfQklU
KSwKIEVWRU5UX0ZJTEVfRkxfUkVDT1JERURfVEdJRCA9ICgxIDw8IEVWRU5UX0ZJTEVfRkxf
UkVDT1JERURfVEdJRF9CSVQpLAogRVZFTlRfRklMRV9GTF9GSUxURVJFRCA9ICgxIDw8IEVW
RU5UX0ZJTEVfRkxfRklMVEVSRURfQklUKSwKIEVWRU5UX0ZJTEVfRkxfTk9fU0VUX0ZJTFRF
UiA9ICgxIDw8IEVWRU5UX0ZJTEVfRkxfTk9fU0VUX0ZJTFRFUl9CSVQpLAogRVZFTlRfRklM
RV9GTF9TT0ZUX01PREUgPSAoMSA8PCBFVkVOVF9GSUxFX0ZMX1NPRlRfTU9ERV9CSVQpLAog
RVZFTlRfRklMRV9GTF9TT0ZUX0RJU0FCTEVEID0gKDEgPDwgRVZFTlRfRklMRV9GTF9TT0ZU
X0RJU0FCTEVEX0JJVCksCiBFVkVOVF9GSUxFX0ZMX1RSSUdHRVJfTU9ERSA9ICgxIDw8IEVW
RU5UX0ZJTEVfRkxfVFJJR0dFUl9NT0RFX0JJVCksCiBFVkVOVF9GSUxFX0ZMX1RSSUdHRVJf
Q09ORCA9ICgxIDw8IEVWRU5UX0ZJTEVfRkxfVFJJR0dFUl9DT05EX0JJVCksCiBFVkVOVF9G
SUxFX0ZMX1BJRF9GSUxURVIgPSAoMSA8PCBFVkVOVF9GSUxFX0ZMX1BJRF9GSUxURVJfQklU
KSwKIEVWRU5UX0ZJTEVfRkxfV0FTX0VOQUJMRUQgPSAoMSA8PCBFVkVOVF9GSUxFX0ZMX1dB
U19FTkFCTEVEX0JJVCksCn07CgpzdHJ1Y3QgdHJhY2VfZXZlbnRfZmlsZSB7CiBzdHJ1Y3Qg
bGlzdF9oZWFkIGxpc3Q7CiBzdHJ1Y3QgdHJhY2VfZXZlbnRfY2FsbCAqZXZlbnRfY2FsbDsK
IHN0cnVjdCBldmVudF9maWx0ZXIgKmZpbHRlcjsKIHN0cnVjdCBkZW50cnkgKmRpcjsKIHN0
cnVjdCB0cmFjZV9hcnJheSAqdHI7CiBzdHJ1Y3QgdHJhY2Vfc3Vic3lzdGVtX2RpciAqc3lz
dGVtOwogc3RydWN0IGxpc3RfaGVhZCB0cmlnZ2VyczsKIyA1NDYgIi4vaW5jbHVkZS9saW51
eC90cmFjZV9ldmVudHMuaCIKIHVuc2lnbmVkIGxvbmcgZmxhZ3M7CiBhdG9taWNfdCBzbV9y
ZWY7CiBhdG9taWNfdCB0bV9yZWY7Cn07CiMgNTc2ICIuL2luY2x1ZGUvbGludXgvdHJhY2Vf
ZXZlbnRzLmgiCmVudW0gZXZlbnRfdHJpZ2dlcl90eXBlIHsKIEVUVF9OT05FID0gKDApLAog
RVRUX1RSQUNFX09OT0ZGID0gKDEgPDwgMCksCiBFVFRfU05BUFNIT1QgPSAoMSA8PCAxKSwK
IEVUVF9TVEFDS1RSQUNFID0gKDEgPDwgMiksCiBFVFRfRVZFTlRfRU5BQkxFID0gKDEgPDwg
MyksCiBFVFRfRVZFTlRfSElTVCA9ICgxIDw8IDQpLAogRVRUX0hJU1RfRU5BQkxFID0gKDEg
PDwgNSksCn07CgpleHRlcm4gaW50IGZpbHRlcl9tYXRjaF9wcmVkcyhzdHJ1Y3QgZXZlbnRf
ZmlsdGVyICpmaWx0ZXIsIHZvaWQgKnJlYyk7CgpleHRlcm4gZW51bSBldmVudF90cmlnZ2Vy
X3R5cGUKZXZlbnRfdHJpZ2dlcnNfY2FsbChzdHJ1Y3QgdHJhY2VfZXZlbnRfZmlsZSAqZmls
ZSwgdm9pZCAqcmVjLAogICAgICBzdHJ1Y3QgcmluZ19idWZmZXJfZXZlbnQgKmV2ZW50KTsK
ZXh0ZXJuIHZvaWQKZXZlbnRfdHJpZ2dlcnNfcG9zdF9jYWxsKHN0cnVjdCB0cmFjZV9ldmVu
dF9maWxlICpmaWxlLAogICAgZW51bSBldmVudF90cmlnZ2VyX3R5cGUgdHQpOwoKYm9vbCB0
cmFjZV9ldmVudF9pZ25vcmVfdGhpc19waWQoc3RydWN0IHRyYWNlX2V2ZW50X2ZpbGUgKnRy
YWNlX2ZpbGUpOwojIDYwNiAiLi9pbmNsdWRlL2xpbnV4L3RyYWNlX2V2ZW50cy5oIgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkKCiMgNjA2ICIuL2luY2x1ZGUvbGludXgvdHJhY2VfZXZlbnRzLmgiCiAgICAgICAg
ICAgICAgYm9vbAp0cmFjZV90cmlnZ2VyX3NvZnRfZGlzYWJsZWQoc3RydWN0IHRyYWNlX2V2
ZW50X2ZpbGUgKmZpbGUpCnsKIHVuc2lnbmVkIGxvbmcgZWZsYWdzID0gZmlsZS0+ZmxhZ3M7
CgogaWYgKCEoZWZsYWdzICYgRVZFTlRfRklMRV9GTF9UUklHR0VSX0NPTkQpKSB7CiAgaWYg
KGVmbGFncyAmIEVWRU5UX0ZJTEVfRkxfVFJJR0dFUl9NT0RFKQogICBldmVudF90cmlnZ2Vy
c19jYWxsKGZpbGUsICgodm9pZCAqKTApLCAoKHZvaWQgKikwKSk7CiAgaWYgKGVmbGFncyAm
IEVWRU5UX0ZJTEVfRkxfU09GVF9ESVNBQkxFRCkKICAgcmV0dXJuIHRydWU7CiAgaWYgKGVm
bGFncyAmIEVWRU5UX0ZJTEVfRkxfUElEX0ZJTFRFUikKICAgcmV0dXJuIHRyYWNlX2V2ZW50
X2lnbm9yZV90aGlzX3BpZChmaWxlKTsKIH0KIHJldHVybiBmYWxzZTsKfQojIDYzNSAiLi9p
bmNsdWRlL2xpbnV4L3RyYWNlX2V2ZW50cy5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgaW50IHRy
YWNlX2NhbGxfYnBmKHN0cnVjdCB0cmFjZV9ldmVudF9jYWxsICpjYWxsLCB2b2lkICpjdHgp
CnsKIHJldHVybiAxOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50CnBlcmZfZXZlbnRfYXR0YWNoX2JwZl9w
cm9nKHN0cnVjdCBwZXJmX2V2ZW50ICpldmVudCwgc3RydWN0IGJwZl9wcm9nICpwcm9nKQp7
CiByZXR1cm4gLTk1Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBwZXJmX2V2ZW50X2RldGFjaF9icGZf
cHJvZyhzdHJ1Y3QgcGVyZl9ldmVudCAqZXZlbnQpIHsgfQoKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludApwZXJm
X2V2ZW50X3F1ZXJ5X3Byb2dfYXJyYXkoc3RydWN0IHBlcmZfZXZlbnQgKmV2ZW50LCB2b2lk
ICppbmZvKQp7CiByZXR1cm4gLTk1Owp9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgYnBmX3Byb2JlX3JlZ2lz
dGVyKHN0cnVjdCBicGZfcmF3X2V2ZW50X21hcCAqYnRwLCBzdHJ1Y3QgYnBmX3Byb2cgKnAp
CnsKIHJldHVybiAtOTU7Cn0Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBicGZfcHJvYmVfdW5yZWdpc3Rlcihz
dHJ1Y3QgYnBmX3Jhd19ldmVudF9tYXAgKmJ0cCwgc3RydWN0IGJwZl9wcm9nICpwKQp7CiBy
ZXR1cm4gLTk1Owp9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3QgYnBmX3Jhd19ldmVudF9tYXAgKmJwZl9n
ZXRfcmF3X3RyYWNlcG9pbnQoY29uc3QgY2hhciAqbmFtZSkKewogcmV0dXJuICgodm9pZCAq
KTApOwp9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSB2b2lkIGJwZl9wdXRfcmF3X3RyYWNlcG9pbnQoc3RydWN0IGJw
Zl9yYXdfZXZlbnRfbWFwICpidHApCnsKfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGJwZl9nZXRfcGVyZl9l
dmVudF9pbmZvKGNvbnN0IHN0cnVjdCBwZXJmX2V2ZW50ICpldmVudCwKICAgICAgIHUzMiAq
cHJvZ19pZCwgdTMyICpmZF90eXBlLAogICAgICAgY29uc3QgY2hhciAqKmJ1ZiwgdTY0ICpw
cm9iZV9vZmZzZXQsCiAgICAgICB1NjQgKnByb2JlX2FkZHIpCnsKIHJldHVybiAtOTU7Cn0K
CgplbnVtIHsKIEZJTFRFUl9PVEhFUiA9IDAsCiBGSUxURVJfU1RBVElDX1NUUklORywKIEZJ
TFRFUl9EWU5fU1RSSU5HLAogRklMVEVSX1BUUl9TVFJJTkcsCiBGSUxURVJfVFJBQ0VfRk4s
CiBGSUxURVJfQ09NTSwKIEZJTFRFUl9DUFUsCn07CgpleHRlcm4gaW50IHRyYWNlX2V2ZW50
X3Jhd19pbml0KHN0cnVjdCB0cmFjZV9ldmVudF9jYWxsICpjYWxsKTsKZXh0ZXJuIGludCB0
cmFjZV9kZWZpbmVfZmllbGQoc3RydWN0IHRyYWNlX2V2ZW50X2NhbGwgKmNhbGwsIGNvbnN0
IGNoYXIgKnR5cGUsCiAgICAgICAgIGNvbnN0IGNoYXIgKm5hbWUsIGludCBvZmZzZXQsIGlu
dCBzaXplLAogICAgICAgICBpbnQgaXNfc2lnbmVkLCBpbnQgZmlsdGVyX3R5cGUpOwpleHRl
cm4gaW50IHRyYWNlX2FkZF9ldmVudF9jYWxsKHN0cnVjdCB0cmFjZV9ldmVudF9jYWxsICpj
YWxsKTsKZXh0ZXJuIGludCB0cmFjZV9yZW1vdmVfZXZlbnRfY2FsbChzdHJ1Y3QgdHJhY2Vf
ZXZlbnRfY2FsbCAqY2FsbCk7CmV4dGVybiBpbnQgdHJhY2VfZXZlbnRfZ2V0X29mZnNldHMo
c3RydWN0IHRyYWNlX2V2ZW50X2NhbGwgKmNhbGwpOwoKCgppbnQgZnRyYWNlX3NldF9jbHJf
ZXZlbnQoc3RydWN0IHRyYWNlX2FycmF5ICp0ciwgY2hhciAqYnVmLCBpbnQgc2V0KTsKaW50
IHRyYWNlX3NldF9jbHJfZXZlbnQoY29uc3QgY2hhciAqc3lzdGVtLCBjb25zdCBjaGFyICpl
dmVudCwgaW50IHNldCk7CmludCB0cmFjZV9hcnJheV9zZXRfY2xyX2V2ZW50KHN0cnVjdCB0
cmFjZV9hcnJheSAqdHIsIGNvbnN0IGNoYXIgKnN5c3RlbSwKICBjb25zdCBjaGFyICpldmVu
dCwgYm9vbCBlbmFibGUpOwojIDcyMSAiLi9pbmNsdWRlL2xpbnV4L3RyYWNlX2V2ZW50cy5o
IgpzdHJ1Y3QgcGVyZl9ldmVudDsKCmV4dGVybiBfX2F0dHJpYnV0ZV9fKChzZWN0aW9uKCIu
ZGF0YS4ucGVyY3B1IiAiIikpKSBfX3R5cGVvZl9fKHN0cnVjdCBwdF9yZWdzKSBwZXJmX3Ry
YWNlX3JlZ3M7CmV4dGVybiBfX2F0dHJpYnV0ZV9fKChzZWN0aW9uKCIuZGF0YS4ucGVyY3B1
IiAiIikpKSBfX3R5cGVvZl9fKGludCkgYnBmX2twcm9iZV9vdmVycmlkZTsKCmV4dGVybiBp
bnQgcGVyZl90cmFjZV9pbml0KHN0cnVjdCBwZXJmX2V2ZW50ICpldmVudCk7CmV4dGVybiB2
b2lkIHBlcmZfdHJhY2VfZGVzdHJveShzdHJ1Y3QgcGVyZl9ldmVudCAqZXZlbnQpOwpleHRl
cm4gaW50IHBlcmZfdHJhY2VfYWRkKHN0cnVjdCBwZXJmX2V2ZW50ICpldmVudCwgaW50IGZs
YWdzKTsKZXh0ZXJuIHZvaWQgcGVyZl90cmFjZV9kZWwoc3RydWN0IHBlcmZfZXZlbnQgKmV2
ZW50LCBpbnQgZmxhZ3MpOwojIDczOSAiLi9pbmNsdWRlL2xpbnV4L3RyYWNlX2V2ZW50cy5o
IgpleHRlcm4gaW50IHBlcmZfdXByb2JlX2luaXQoc3RydWN0IHBlcmZfZXZlbnQgKmV2ZW50
LAogICAgICAgIHVuc2lnbmVkIGxvbmcgcmVmX2N0cl9vZmZzZXQsIGJvb2wgaXNfcmV0cHJv
YmUpOwpleHRlcm4gdm9pZCBwZXJmX3Vwcm9iZV9kZXN0cm95KHN0cnVjdCBwZXJmX2V2ZW50
ICpldmVudCk7CmV4dGVybiBpbnQgYnBmX2dldF91cHJvYmVfaW5mbyhjb25zdCBzdHJ1Y3Qg
cGVyZl9ldmVudCAqZXZlbnQsCiAgICAgICAgICB1MzIgKmZkX3R5cGUsIGNvbnN0IGNoYXIg
KipmaWxlbmFtZSwKICAgICAgICAgIHU2NCAqcHJvYmVfb2Zmc2V0LCBib29sIHBlcmZfdHlw
ZV90cmFjZXBvaW50KTsKCmV4dGVybiBpbnQgZnRyYWNlX3Byb2ZpbGVfc2V0X2ZpbHRlcihz
dHJ1Y3QgcGVyZl9ldmVudCAqZXZlbnQsIGludCBldmVudF9pZCwKICAgICAgICAgY2hhciAq
ZmlsdGVyX3N0cik7CmV4dGVybiB2b2lkIGZ0cmFjZV9wcm9maWxlX2ZyZWVfZmlsdGVyKHN0
cnVjdCBwZXJmX2V2ZW50ICpldmVudCk7CnZvaWQgcGVyZl90cmFjZV9idWZfdXBkYXRlKHZv
aWQgKnJlY29yZCwgdTE2IHR5cGUpOwp2b2lkICpwZXJmX3RyYWNlX2J1Zl9hbGxvYyhpbnQg
c2l6ZSwgc3RydWN0IHB0X3JlZ3MgKipyZWdzLCBpbnQgKnJjdHhwKTsKCnZvaWQgYnBmX3Ry
YWNlX3J1bjEoc3RydWN0IGJwZl9wcm9nICpwcm9nLCB1NjQgYXJnMSk7CnZvaWQgYnBmX3Ry
YWNlX3J1bjIoc3RydWN0IGJwZl9wcm9nICpwcm9nLCB1NjQgYXJnMSwgdTY0IGFyZzIpOwp2
b2lkIGJwZl90cmFjZV9ydW4zKHN0cnVjdCBicGZfcHJvZyAqcHJvZywgdTY0IGFyZzEsIHU2
NCBhcmcyLAogICAgICB1NjQgYXJnMyk7CnZvaWQgYnBmX3RyYWNlX3J1bjQoc3RydWN0IGJw
Zl9wcm9nICpwcm9nLCB1NjQgYXJnMSwgdTY0IGFyZzIsCiAgICAgIHU2NCBhcmczLCB1NjQg
YXJnNCk7CnZvaWQgYnBmX3RyYWNlX3J1bjUoc3RydWN0IGJwZl9wcm9nICpwcm9nLCB1NjQg
YXJnMSwgdTY0IGFyZzIsCiAgICAgIHU2NCBhcmczLCB1NjQgYXJnNCwgdTY0IGFyZzUpOwp2
b2lkIGJwZl90cmFjZV9ydW42KHN0cnVjdCBicGZfcHJvZyAqcHJvZywgdTY0IGFyZzEsIHU2
NCBhcmcyLAogICAgICB1NjQgYXJnMywgdTY0IGFyZzQsIHU2NCBhcmc1LCB1NjQgYXJnNik7
CnZvaWQgYnBmX3RyYWNlX3J1bjcoc3RydWN0IGJwZl9wcm9nICpwcm9nLCB1NjQgYXJnMSwg
dTY0IGFyZzIsCiAgICAgIHU2NCBhcmczLCB1NjQgYXJnNCwgdTY0IGFyZzUsIHU2NCBhcmc2
LCB1NjQgYXJnNyk7CnZvaWQgYnBmX3RyYWNlX3J1bjgoc3RydWN0IGJwZl9wcm9nICpwcm9n
LCB1NjQgYXJnMSwgdTY0IGFyZzIsCiAgICAgIHU2NCBhcmczLCB1NjQgYXJnNCwgdTY0IGFy
ZzUsIHU2NCBhcmc2LCB1NjQgYXJnNywKICAgICAgdTY0IGFyZzgpOwp2b2lkIGJwZl90cmFj
ZV9ydW45KHN0cnVjdCBicGZfcHJvZyAqcHJvZywgdTY0IGFyZzEsIHU2NCBhcmcyLAogICAg
ICB1NjQgYXJnMywgdTY0IGFyZzQsIHU2NCBhcmc1LCB1NjQgYXJnNiwgdTY0IGFyZzcsCiAg
ICAgIHU2NCBhcmc4LCB1NjQgYXJnOSk7CnZvaWQgYnBmX3RyYWNlX3J1bjEwKHN0cnVjdCBi
cGZfcHJvZyAqcHJvZywgdTY0IGFyZzEsIHU2NCBhcmcyLAogICAgICAgdTY0IGFyZzMsIHU2
NCBhcmc0LCB1NjQgYXJnNSwgdTY0IGFyZzYsIHU2NCBhcmc3LAogICAgICAgdTY0IGFyZzgs
IHU2NCBhcmc5LCB1NjQgYXJnMTApOwp2b2lkIGJwZl90cmFjZV9ydW4xMShzdHJ1Y3QgYnBm
X3Byb2cgKnByb2csIHU2NCBhcmcxLCB1NjQgYXJnMiwKICAgICAgIHU2NCBhcmczLCB1NjQg
YXJnNCwgdTY0IGFyZzUsIHU2NCBhcmc2LCB1NjQgYXJnNywKICAgICAgIHU2NCBhcmc4LCB1
NjQgYXJnOSwgdTY0IGFyZzEwLCB1NjQgYXJnMTEpOwp2b2lkIGJwZl90cmFjZV9ydW4xMihz
dHJ1Y3QgYnBmX3Byb2cgKnByb2csIHU2NCBhcmcxLCB1NjQgYXJnMiwKICAgICAgIHU2NCBh
cmczLCB1NjQgYXJnNCwgdTY0IGFyZzUsIHU2NCBhcmc2LCB1NjQgYXJnNywKICAgICAgIHU2
NCBhcmc4LCB1NjQgYXJnOSwgdTY0IGFyZzEwLCB1NjQgYXJnMTEsIHU2NCBhcmcxMik7CnZv
aWQgcGVyZl90cmFjZV9ydW5fYnBmX3N1Ym1pdCh2b2lkICpyYXdfZGF0YSwgaW50IHNpemUs
IGludCByY3R4LAogICAgICAgICAgc3RydWN0IHRyYWNlX2V2ZW50X2NhbGwgKmNhbGwsIHU2
NCBjb3VudCwKICAgICAgICAgIHN0cnVjdCBwdF9yZWdzICpyZWdzLCBzdHJ1Y3QgaGxpc3Rf
aGVhZCAqaGVhZCwKICAgICAgICAgIHN0cnVjdCB0YXNrX3N0cnVjdCAqdGFzayk7CgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgdm9pZApwZXJmX3RyYWNlX2J1Zl9zdWJtaXQodm9pZCAqcmF3X2RhdGEsIGludCBz
aXplLCBpbnQgcmN0eCwgdTE2IHR5cGUsCiAgICAgICAgIHU2NCBjb3VudCwgc3RydWN0IHB0
X3JlZ3MgKnJlZ3MsIHZvaWQgKmhlYWQsCiAgICAgICAgIHN0cnVjdCB0YXNrX3N0cnVjdCAq
dGFzaykKewogcGVyZl90cF9ldmVudCh0eXBlLCBjb3VudCwgcmF3X2RhdGEsIHNpemUsIHJl
Z3MsIGhlYWQsIHJjdHgsIHRhc2spOwp9CiMgOCAiLi9pbmNsdWRlL3RyYWNlL3N5c2NhbGwu
aCIgMgojIDI1ICIuL2luY2x1ZGUvdHJhY2Uvc3lzY2FsbC5oIgpzdHJ1Y3Qgc3lzY2FsbF9t
ZXRhZGF0YSB7CiBjb25zdCBjaGFyICpuYW1lOwogaW50IHN5c2NhbGxfbnI7CiBpbnQgbmJf
YXJnczsKIGNvbnN0IGNoYXIgKip0eXBlczsKIGNvbnN0IGNoYXIgKiphcmdzOwogc3RydWN0
IGxpc3RfaGVhZCBlbnRlcl9maWVsZHM7Cgogc3RydWN0IHRyYWNlX2V2ZW50X2NhbGwgKmVu
dGVyX2V2ZW50Owogc3RydWN0IHRyYWNlX2V2ZW50X2NhbGwgKmV4aXRfZXZlbnQ7Cn07CgoK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIHZvaWQgc3lzY2FsbF90cmFjZXBvaW50X3VwZGF0ZShzdHJ1Y3QgdGFza19z
dHJ1Y3QgKnApCnsKIGlmICh0ZXN0X3RpX3RocmVhZF9mbGFnKCgoc3RydWN0IHRocmVhZF9p
bmZvICopZ2V0X2N1cnJlbnQoKSksIDE1KSkKICBzZXRfdHNrX3RocmVhZF9mbGFnKHAsIDE1
KTsKIGVsc2UKICBjbGVhcl90c2tfdGhyZWFkX2ZsYWcocCwgMTUpOwp9CiMgODYgIi4vaW5j
bHVkZS9saW51eC9zeXNjYWxscy5oIiAyCiMgMjAwICIuL2luY2x1ZGUvbGludXgvc3lzY2Fs
bHMuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIGludCBpc19zeXNjYWxsX3RyYWNlX2V2ZW50KHN0cnVjdCB0cmFj
ZV9ldmVudF9jYWxsICp0cF9ldmVudCkKewogcmV0dXJuIDA7Cn0KIyAyNTkgIi4vaW5jbHVk
ZS9saW51eC9zeXNjYWxscy5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBhZGRyX2xpbWl0X3VzZXJfY2hl
Y2sodm9pZCkKewoKIGlmICghdGVzdF90aV90aHJlYWRfZmxhZygoKHN0cnVjdCB0aHJlYWRf
aW5mbyAqKWdldF9jdXJyZW50KCkpLCAzKSkKICByZXR1cm47CgoKIGlmIChjaGVja19kYXRh
X2NvcnJ1cHRpb24oKHsgYm9vbCBjb3JydXB0aW9uID0gX19idWlsdGluX2V4cGVjdCghISgh
KCgoZ2V0X2N1cnJlbnQoKS0+dGhyZWFkLmFkZHJfbGltaXQpKS5zZWcgPT0gKCgobW1fc2Vn
bWVudF90KSB7ICgoMHgwMDAwNDAwMDAwMDAwMDAwVUwpIC0gMSkgfSkpLnNlZykpLCAwKTsg
aWYgKGNvcnJ1cHRpb24pIHsgaWYgKDApIHsgcHJpbnRrKCJcMDAxIiAiMyIgIkludmFsaWQg
YWRkcmVzcyBsaW1pdCBvbiB1c2VyLW1vZGUgcmV0dXJuIik7IGRvIHsgX19hc21fXyBfX3Zv
bGF0aWxlX18oICIxOgkiICJ0d2kgMzEsIDAsIDAiICJcbiIgIi5zZWN0aW9uIF9fYnVnX3Rh
YmxlLFwiYXdcIlxuIiAiMjpcdCIgIi44Ynl0ZSIgIiAiICIxYiwgJTBcbiIgIlx0LnNob3J0
ICUxLCAlMlxuIiAiLm9yZyAyYislM1xuIiAiLnByZXZpb3VzXG4iIDogOiAiaSIgKAogIi4v
aW5jbHVkZS9saW51eC9zeXNjYWxscy5oIgojIDI2NiAiLi9pbmNsdWRlL2xpbnV4L3N5c2Nh
bGxzLmgiCiAgICAgKSwgImkiICgKIDI2NwojIDI2NiAiLi9pbmNsdWRlL2xpbnV4L3N5c2Nh
bGxzLmgiCiAgICAgKSwgImkiICgwKSwgImkiIChzaXplb2Yoc3RydWN0IGJ1Z19lbnRyeSkp
KTsgZG8geyA7IGFzbSB2b2xhdGlsZSgiIik7IF9fYnVpbHRpbl91bnJlYWNoYWJsZSgpOyB9
IHdoaWxlICgwKTsgfSB3aGlsZSAoMCk7IH0gZWxzZSAoeyBpbnQgX19yZXRfd2Fybl9vbiA9
ICEhKDEpOyBpZiAoX19idWlsdGluX2V4cGVjdCghIShfX3JldF93YXJuX29uKSwgMCkpIGRv
IHsgZG8geyB9IHdoaWxlKDApOyBfX3dhcm5fcHJpbnRrKCJJbnZhbGlkIGFkZHJlc3MgbGlt
aXQgb24gdXNlci1tb2RlIHJldHVybiIpOyBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CSIg
InR3aSAzMSwgMCwgMCIgIlxuIiAiLnNlY3Rpb24gX19idWdfdGFibGUsXCJhd1wiXG4iICIy
Olx0IiAiLjhieXRlIiAiICIgIjFiLCAlMFxuIiAiXHQuc2hvcnQgJTEsICUyXG4iICIub3Jn
IDJiKyUzXG4iICIucHJldmlvdXNcbiIgOiA6ICJpIiAoCiAiLi9pbmNsdWRlL2xpbnV4L3N5
c2NhbGxzLmgiCiMgMjY2ICIuL2luY2x1ZGUvbGludXgvc3lzY2FsbHMuaCIKICAgICApLCAi
aSIgKAogMjY3CiMgMjY2ICIuL2luY2x1ZGUvbGludXgvc3lzY2FsbHMuaCIKICAgICApLCAi
aSIgKCgxIDw8IDApIHwgKCgxIDw8IDMpIHwgKCg5KSA8PCA4KSkpLCAiaSIgKHNpemVvZihz
dHJ1Y3QgYnVnX2VudHJ5KSkpOyBkbyB7IH0gd2hpbGUoMCk7IH0gd2hpbGUgKDApOyBfX2J1
aWx0aW5fZXhwZWN0KCEhKF9fcmV0X3dhcm5fb24pLCAwKTsgfSk7IH0gY29ycnVwdGlvbjsg
fSkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
KQogIGZvcmNlX3NpZyg5KTsKCgogY2xlYXJfdGlfdGhyZWFkX2ZsYWcoKChzdHJ1Y3QgdGhy
ZWFkX2luZm8gKilnZXRfY3VycmVudCgpKSwgMyk7Cgp9CiMgMjg5ICIuL2luY2x1ZGUvbGlu
dXgvc3lzY2FsbHMuaCIKIGxvbmcgc3lzX2lvX3NldHVwKHVuc2lnbmVkIG5yX3JlcXMsIGFp
b19jb250ZXh0X3QgKmN0eCk7CiBsb25nIHN5c19pb19kZXN0cm95KGFpb19jb250ZXh0X3Qg
Y3R4KTsKIGxvbmcgc3lzX2lvX3N1Ym1pdChhaW9fY29udGV4dF90LCBsb25nLAogICBzdHJ1
Y3QgaW9jYiAqICopOwogbG9uZyBzeXNfaW9fY2FuY2VsKGFpb19jb250ZXh0X3QgY3R4X2lk
LCBzdHJ1Y3QgaW9jYiAqaW9jYiwKICAgICAgICAgc3RydWN0IGlvX2V2ZW50ICpyZXN1bHQp
OwogbG9uZyBzeXNfaW9fZ2V0ZXZlbnRzKGFpb19jb250ZXh0X3QgY3R4X2lkLAogICAgbG9u
ZyBtaW5fbnIsCiAgICBsb25nIG5yLAogICAgc3RydWN0IGlvX2V2ZW50ICpldmVudHMsCiAg
ICBzdHJ1Y3QgX19rZXJuZWxfdGltZXNwZWMgKnRpbWVvdXQpOwogbG9uZyBzeXNfaW9fZ2V0
ZXZlbnRzX3RpbWUzMihfX3UzMiBjdHhfaWQsCiAgICBfX3MzMiBtaW5fbnIsCiAgICBfX3Mz
MiBuciwKICAgIHN0cnVjdCBpb19ldmVudCAqZXZlbnRzLAogICAgc3RydWN0IG9sZF90aW1l
c3BlYzMyICp0aW1lb3V0KTsKIGxvbmcgc3lzX2lvX3BnZXRldmVudHMoYWlvX2NvbnRleHRf
dCBjdHhfaWQsCiAgICBsb25nIG1pbl9uciwKICAgIGxvbmcgbnIsCiAgICBzdHJ1Y3QgaW9f
ZXZlbnQgKmV2ZW50cywKICAgIHN0cnVjdCBfX2tlcm5lbF90aW1lc3BlYyAqdGltZW91dCwK
ICAgIGNvbnN0IHN0cnVjdCBfX2Fpb19zaWdzZXQgKnNpZyk7CiBsb25nIHN5c19pb19wZ2V0
ZXZlbnRzX3RpbWUzMihhaW9fY29udGV4dF90IGN0eF9pZCwKICAgIGxvbmcgbWluX25yLAog
ICAgbG9uZyBuciwKICAgIHN0cnVjdCBpb19ldmVudCAqZXZlbnRzLAogICAgc3RydWN0IG9s
ZF90aW1lc3BlYzMyICp0aW1lb3V0LAogICAgY29uc3Qgc3RydWN0IF9fYWlvX3NpZ3NldCAq
c2lnKTsKIGxvbmcgc3lzX2lvX3VyaW5nX3NldHVwKHUzMiBlbnRyaWVzLAogICAgc3RydWN0
IGlvX3VyaW5nX3BhcmFtcyAqcCk7CiBsb25nIHN5c19pb191cmluZ19lbnRlcih1bnNpZ25l
ZCBpbnQgZmQsIHUzMiB0b19zdWJtaXQsCiAgICB1MzIgbWluX2NvbXBsZXRlLCB1MzIgZmxh
Z3MsCiAgICBjb25zdCBzaWdzZXRfdCAqc2lnLCBzaXplX3Qgc2lnc3opOwogbG9uZyBzeXNf
aW9fdXJpbmdfcmVnaXN0ZXIodW5zaWduZWQgaW50IGZkLCB1bnNpZ25lZCBpbnQgb3AsCiAg
ICB2b2lkICphcmcsIHVuc2lnbmVkIGludCBucl9hcmdzKTsKCgogbG9uZyBzeXNfc2V0eGF0
dHIoY29uc3QgY2hhciAqcGF0aCwgY29uc3QgY2hhciAqbmFtZSwKICAgICAgICBjb25zdCB2
b2lkICp2YWx1ZSwgc2l6ZV90IHNpemUsIGludCBmbGFncyk7CiBsb25nIHN5c19sc2V0eGF0
dHIoY29uc3QgY2hhciAqcGF0aCwgY29uc3QgY2hhciAqbmFtZSwKICAgICAgICAgY29uc3Qg
dm9pZCAqdmFsdWUsIHNpemVfdCBzaXplLCBpbnQgZmxhZ3MpOwogbG9uZyBzeXNfZnNldHhh
dHRyKGludCBmZCwgY29uc3QgY2hhciAqbmFtZSwKICAgICAgICAgY29uc3Qgdm9pZCAqdmFs
dWUsIHNpemVfdCBzaXplLCBpbnQgZmxhZ3MpOwogbG9uZyBzeXNfZ2V0eGF0dHIoY29uc3Qg
Y2hhciAqcGF0aCwgY29uc3QgY2hhciAqbmFtZSwKICAgICAgICB2b2lkICp2YWx1ZSwgc2l6
ZV90IHNpemUpOwogbG9uZyBzeXNfbGdldHhhdHRyKGNvbnN0IGNoYXIgKnBhdGgsIGNvbnN0
IGNoYXIgKm5hbWUsCiAgICAgICAgIHZvaWQgKnZhbHVlLCBzaXplX3Qgc2l6ZSk7CiBsb25n
IHN5c19mZ2V0eGF0dHIoaW50IGZkLCBjb25zdCBjaGFyICpuYW1lLAogICAgICAgICB2b2lk
ICp2YWx1ZSwgc2l6ZV90IHNpemUpOwogbG9uZyBzeXNfbGlzdHhhdHRyKGNvbnN0IGNoYXIg
KnBhdGgsIGNoYXIgKmxpc3QsCiAgICAgICAgIHNpemVfdCBzaXplKTsKIGxvbmcgc3lzX2xs
aXN0eGF0dHIoY29uc3QgY2hhciAqcGF0aCwgY2hhciAqbGlzdCwKICAgICAgICAgIHNpemVf
dCBzaXplKTsKIGxvbmcgc3lzX2ZsaXN0eGF0dHIoaW50IGZkLCBjaGFyICpsaXN0LCBzaXpl
X3Qgc2l6ZSk7CiBsb25nIHN5c19yZW1vdmV4YXR0cihjb25zdCBjaGFyICpwYXRoLAogICAg
Y29uc3QgY2hhciAqbmFtZSk7CiBsb25nIHN5c19scmVtb3ZleGF0dHIoY29uc3QgY2hhciAq
cGF0aCwKICAgICBjb25zdCBjaGFyICpuYW1lKTsKIGxvbmcgc3lzX2ZyZW1vdmV4YXR0cihp
bnQgZmQsIGNvbnN0IGNoYXIgKm5hbWUpOwoKCiBsb25nIHN5c19nZXRjd2QoY2hhciAqYnVm
LCB1bnNpZ25lZCBsb25nIHNpemUpOwoKCiBsb25nIHN5c19sb29rdXBfZGNvb2tpZSh1NjQg
Y29va2llNjQsIGNoYXIgKmJ1Ziwgc2l6ZV90IGxlbik7CgoKIGxvbmcgc3lzX2V2ZW50ZmQy
KHVuc2lnbmVkIGludCBjb3VudCwgaW50IGZsYWdzKTsKCgogbG9uZyBzeXNfZXBvbGxfY3Jl
YXRlMShpbnQgZmxhZ3MpOwogbG9uZyBzeXNfZXBvbGxfY3RsKGludCBlcGZkLCBpbnQgb3As
IGludCBmZCwKICAgIHN0cnVjdCBlcG9sbF9ldmVudCAqZXZlbnQpOwogbG9uZyBzeXNfZXBv
bGxfcHdhaXQoaW50IGVwZmQsIHN0cnVjdCBlcG9sbF9ldmVudCAqZXZlbnRzLAogICAgaW50
IG1heGV2ZW50cywgaW50IHRpbWVvdXQsCiAgICBjb25zdCBzaWdzZXRfdCAqc2lnbWFzaywK
ICAgIHNpemVfdCBzaWdzZXRzaXplKTsKCgogbG9uZyBzeXNfZHVwKHVuc2lnbmVkIGludCBm
aWxkZXMpOwogbG9uZyBzeXNfZHVwMyh1bnNpZ25lZCBpbnQgb2xkZmQsIHVuc2lnbmVkIGlu
dCBuZXdmZCwgaW50IGZsYWdzKTsKIGxvbmcgc3lzX2ZjbnRsKHVuc2lnbmVkIGludCBmZCwg
dW5zaWduZWQgaW50IGNtZCwgdW5zaWduZWQgbG9uZyBhcmcpOwoKCgoKCgogbG9uZyBzeXNf
aW5vdGlmeV9pbml0MShpbnQgZmxhZ3MpOwogbG9uZyBzeXNfaW5vdGlmeV9hZGRfd2F0Y2go
aW50IGZkLCBjb25zdCBjaGFyICpwYXRoLAogICAgIHUzMiBtYXNrKTsKIGxvbmcgc3lzX2lu
b3RpZnlfcm1fd2F0Y2goaW50IGZkLCBfX3MzMiB3ZCk7CgoKIGxvbmcgc3lzX2lvY3RsKHVu
c2lnbmVkIGludCBmZCwgdW5zaWduZWQgaW50IGNtZCwKICAgIHVuc2lnbmVkIGxvbmcgYXJn
KTsKCgogbG9uZyBzeXNfaW9wcmlvX3NldChpbnQgd2hpY2gsIGludCB3aG8sIGludCBpb3By
aW8pOwogbG9uZyBzeXNfaW9wcmlvX2dldChpbnQgd2hpY2gsIGludCB3aG8pOwoKCiBsb25n
IHN5c19mbG9jayh1bnNpZ25lZCBpbnQgZmQsIHVuc2lnbmVkIGludCBjbWQpOwoKCiBsb25n
IHN5c19ta25vZGF0KGludCBkZmQsIGNvbnN0IGNoYXIgKiBmaWxlbmFtZSwgdW1vZGVfdCBt
b2RlLAogICAgICAgdW5zaWduZWQgZGV2KTsKIGxvbmcgc3lzX21rZGlyYXQoaW50IGRmZCwg
Y29uc3QgY2hhciAqIHBhdGhuYW1lLCB1bW9kZV90IG1vZGUpOwogbG9uZyBzeXNfdW5saW5r
YXQoaW50IGRmZCwgY29uc3QgY2hhciAqIHBhdGhuYW1lLCBpbnQgZmxhZyk7CiBsb25nIHN5
c19zeW1saW5rYXQoY29uc3QgY2hhciAqIG9sZG5hbWUsCiAgICAgICAgIGludCBuZXdkZmQs
IGNvbnN0IGNoYXIgKiBuZXduYW1lKTsKIGxvbmcgc3lzX2xpbmthdChpbnQgb2xkZGZkLCBj
b25zdCBjaGFyICpvbGRuYW1lLAogICAgICBpbnQgbmV3ZGZkLCBjb25zdCBjaGFyICpuZXdu
YW1lLCBpbnQgZmxhZ3MpOwogbG9uZyBzeXNfcmVuYW1lYXQoaW50IG9sZGRmZCwgY29uc3Qg
Y2hhciAqIG9sZG5hbWUsCiAgICAgICAgaW50IG5ld2RmZCwgY29uc3QgY2hhciAqIG5ld25h
bWUpOwoKCiBsb25nIHN5c191bW91bnQoY2hhciAqbmFtZSwgaW50IGZsYWdzKTsKIGxvbmcg
c3lzX21vdW50KGNoYXIgKmRldl9uYW1lLCBjaGFyICpkaXJfbmFtZSwKICAgIGNoYXIgKnR5
cGUsIHVuc2lnbmVkIGxvbmcgZmxhZ3MsCiAgICB2b2lkICpkYXRhKTsKIGxvbmcgc3lzX3Bp
dm90X3Jvb3QoY29uc3QgY2hhciAqbmV3X3Jvb3QsCiAgICBjb25zdCBjaGFyICpwdXRfb2xk
KTsKCgoKCiBsb25nIHN5c19zdGF0ZnMoY29uc3QgY2hhciAqIHBhdGgsCiAgICBzdHJ1Y3Qg
c3RhdGZzICpidWYpOwogbG9uZyBzeXNfc3RhdGZzNjQoY29uc3QgY2hhciAqcGF0aCwgc2l6
ZV90IHN6LAogICAgc3RydWN0IHN0YXRmczY0ICpidWYpOwogbG9uZyBzeXNfZnN0YXRmcyh1
bnNpZ25lZCBpbnQgZmQsIHN0cnVjdCBzdGF0ZnMgKmJ1Zik7CiBsb25nIHN5c19mc3RhdGZz
NjQodW5zaWduZWQgaW50IGZkLCBzaXplX3Qgc3osCiAgICBzdHJ1Y3Qgc3RhdGZzNjQgKmJ1
Zik7CiBsb25nIHN5c190cnVuY2F0ZShjb25zdCBjaGFyICpwYXRoLCBsb25nIGxlbmd0aCk7
CiBsb25nIHN5c19mdHJ1bmNhdGUodW5zaWduZWQgaW50IGZkLCB1bnNpZ25lZCBsb25nIGxl
bmd0aCk7CgoKCgogbG9uZyBzeXNfZmFsbG9jYXRlKGludCBmZCwgaW50IG1vZGUsIGxvZmZf
dCBvZmZzZXQsIGxvZmZfdCBsZW4pOwogbG9uZyBzeXNfZmFjY2Vzc2F0KGludCBkZmQsIGNv
bnN0IGNoYXIgKmZpbGVuYW1lLCBpbnQgbW9kZSk7CiBsb25nIHN5c19mYWNjZXNzYXQyKGlu
dCBkZmQsIGNvbnN0IGNoYXIgKmZpbGVuYW1lLCBpbnQgbW9kZSwKICAgICAgICAgIGludCBm
bGFncyk7CiBsb25nIHN5c19jaGRpcihjb25zdCBjaGFyICpmaWxlbmFtZSk7CiBsb25nIHN5
c19mY2hkaXIodW5zaWduZWQgaW50IGZkKTsKIGxvbmcgc3lzX2Nocm9vdChjb25zdCBjaGFy
ICpmaWxlbmFtZSk7CiBsb25nIHN5c19mY2htb2QodW5zaWduZWQgaW50IGZkLCB1bW9kZV90
IG1vZGUpOwogbG9uZyBzeXNfZmNobW9kYXQoaW50IGRmZCwgY29uc3QgY2hhciAqIGZpbGVu
YW1lLAogICAgICAgIHVtb2RlX3QgbW9kZSk7CiBsb25nIHN5c19mY2hvd25hdChpbnQgZGZk
LCBjb25zdCBjaGFyICpmaWxlbmFtZSwgdWlkX3QgdXNlciwKICAgICAgICBnaWRfdCBncm91
cCwgaW50IGZsYWcpOwogbG9uZyBzeXNfZmNob3duKHVuc2lnbmVkIGludCBmZCwgdWlkX3Qg
dXNlciwgZ2lkX3QgZ3JvdXApOwogbG9uZyBzeXNfb3BlbmF0KGludCBkZmQsIGNvbnN0IGNo
YXIgKmZpbGVuYW1lLCBpbnQgZmxhZ3MsCiAgICAgIHVtb2RlX3QgbW9kZSk7CiBsb25nIHN5
c19vcGVuYXQyKGludCBkZmQsIGNvbnN0IGNoYXIgKmZpbGVuYW1lLAogICAgICAgc3RydWN0
IG9wZW5faG93ICpob3csIHNpemVfdCBzaXplKTsKIGxvbmcgc3lzX2Nsb3NlKHVuc2lnbmVk
IGludCBmZCk7CiBsb25nIHN5c192aGFuZ3VwKHZvaWQpOwoKCiBsb25nIHN5c19waXBlMihp
bnQgKmZpbGRlcywgaW50IGZsYWdzKTsKCgogbG9uZyBzeXNfcXVvdGFjdGwodW5zaWduZWQg
aW50IGNtZCwgY29uc3QgY2hhciAqc3BlY2lhbCwKICAgIHFpZF90IGlkLCB2b2lkICphZGRy
KTsKCgogbG9uZyBzeXNfZ2V0ZGVudHM2NCh1bnNpZ25lZCBpbnQgZmQsCiAgICBzdHJ1Y3Qg
bGludXhfZGlyZW50NjQgKmRpcmVudCwKICAgIHVuc2lnbmVkIGludCBjb3VudCk7CgoKIGxv
bmcgc3lzX2xsc2Vlayh1bnNpZ25lZCBpbnQgZmQsIHVuc2lnbmVkIGxvbmcgb2Zmc2V0X2hp
Z2gsCiAgIHVuc2lnbmVkIGxvbmcgb2Zmc2V0X2xvdywgbG9mZl90ICpyZXN1bHQsCiAgIHVu
c2lnbmVkIGludCB3aGVuY2UpOwogbG9uZyBzeXNfbHNlZWsodW5zaWduZWQgaW50IGZkLCBv
ZmZfdCBvZmZzZXQsCiAgICAgdW5zaWduZWQgaW50IHdoZW5jZSk7CiBsb25nIHN5c19yZWFk
KHVuc2lnbmVkIGludCBmZCwgY2hhciAqYnVmLCBzaXplX3QgY291bnQpOwogbG9uZyBzeXNf
d3JpdGUodW5zaWduZWQgaW50IGZkLCBjb25zdCBjaGFyICpidWYsCiAgICAgc2l6ZV90IGNv
dW50KTsKIGxvbmcgc3lzX3JlYWR2KHVuc2lnbmVkIGxvbmcgZmQsCiAgICAgY29uc3Qgc3Ry
dWN0IGlvdmVjICp2ZWMsCiAgICAgdW5zaWduZWQgbG9uZyB2bGVuKTsKIGxvbmcgc3lzX3dy
aXRldih1bnNpZ25lZCBsb25nIGZkLAogICAgICBjb25zdCBzdHJ1Y3QgaW92ZWMgKnZlYywK
ICAgICAgdW5zaWduZWQgbG9uZyB2bGVuKTsKIGxvbmcgc3lzX3ByZWFkNjQodW5zaWduZWQg
aW50IGZkLCBjaGFyICpidWYsCiAgICAgICBzaXplX3QgY291bnQsIGxvZmZfdCBwb3MpOwog
bG9uZyBzeXNfcHdyaXRlNjQodW5zaWduZWQgaW50IGZkLCBjb25zdCBjaGFyICpidWYsCiAg
ICAgICAgc2l6ZV90IGNvdW50LCBsb2ZmX3QgcG9zKTsKIGxvbmcgc3lzX3ByZWFkdih1bnNp
Z25lZCBsb25nIGZkLCBjb25zdCBzdHJ1Y3QgaW92ZWMgKnZlYywKICAgICAgdW5zaWduZWQg
bG9uZyB2bGVuLCB1bnNpZ25lZCBsb25nIHBvc19sLCB1bnNpZ25lZCBsb25nIHBvc19oKTsK
IGxvbmcgc3lzX3B3cml0ZXYodW5zaWduZWQgbG9uZyBmZCwgY29uc3Qgc3RydWN0IGlvdmVj
ICp2ZWMsCiAgICAgICB1bnNpZ25lZCBsb25nIHZsZW4sIHVuc2lnbmVkIGxvbmcgcG9zX2ws
IHVuc2lnbmVkIGxvbmcgcG9zX2gpOwoKCiBsb25nIHN5c19zZW5kZmlsZTY0KGludCBvdXRf
ZmQsIGludCBpbl9mZCwKICAgICAgICAgIGxvZmZfdCAqb2Zmc2V0LCBzaXplX3QgY291bnQp
OwoKCiBsb25nIHN5c19wc2VsZWN0NihpbnQsIGZkX3NldCAqLCBmZF9zZXQgKiwKICAgICAg
ICBmZF9zZXQgKiwgc3RydWN0IF9fa2VybmVsX3RpbWVzcGVjICosCiAgICAgICAgdm9pZCAq
KTsKIGxvbmcgc3lzX3BzZWxlY3Q2X3RpbWUzMihpbnQsIGZkX3NldCAqLCBmZF9zZXQgKiwK
ICAgICAgICBmZF9zZXQgKiwgc3RydWN0IG9sZF90aW1lc3BlYzMyICosCiAgICAgICAgdm9p
ZCAqKTsKIGxvbmcgc3lzX3Bwb2xsKHN0cnVjdCBwb2xsZmQgKiwgdW5zaWduZWQgaW50LAog
ICAgIHN0cnVjdCBfX2tlcm5lbF90aW1lc3BlYyAqLCBjb25zdCBzaWdzZXRfdCAqLAogICAg
IHNpemVfdCk7CiBsb25nIHN5c19wcG9sbF90aW1lMzIoc3RydWN0IHBvbGxmZCAqLCB1bnNp
Z25lZCBpbnQsCiAgICAgc3RydWN0IG9sZF90aW1lc3BlYzMyICosIGNvbnN0IHNpZ3NldF90
ICosCiAgICAgc2l6ZV90KTsKCgogbG9uZyBzeXNfc2lnbmFsZmQ0KGludCB1ZmQsIHNpZ3Nl
dF90ICp1c2VyX21hc2ssIHNpemVfdCBzaXplbWFzaywgaW50IGZsYWdzKTsKCgogbG9uZyBz
eXNfdm1zcGxpY2UoaW50IGZkLCBjb25zdCBzdHJ1Y3QgaW92ZWMgKmlvdiwKICAgICAgICB1
bnNpZ25lZCBsb25nIG5yX3NlZ3MsIHVuc2lnbmVkIGludCBmbGFncyk7CiBsb25nIHN5c19z
cGxpY2UoaW50IGZkX2luLCBsb2ZmX3QgKm9mZl9pbiwKICAgICAgaW50IGZkX291dCwgbG9m
Zl90ICpvZmZfb3V0LAogICAgICBzaXplX3QgbGVuLCB1bnNpZ25lZCBpbnQgZmxhZ3MpOwog
bG9uZyBzeXNfdGVlKGludCBmZGluLCBpbnQgZmRvdXQsIHNpemVfdCBsZW4sIHVuc2lnbmVk
IGludCBmbGFncyk7CgoKIGxvbmcgc3lzX3JlYWRsaW5rYXQoaW50IGRmZCwgY29uc3QgY2hh
ciAqcGF0aCwgY2hhciAqYnVmLAogICAgICAgICAgaW50IGJ1ZnNpeik7CiBsb25nIHN5c19u
ZXdmc3RhdGF0KGludCBkZmQsIGNvbnN0IGNoYXIgKmZpbGVuYW1lLAogICAgICAgICAgc3Ry
dWN0IHN0YXQgKnN0YXRidWYsIGludCBmbGFnKTsKIGxvbmcgc3lzX25ld2ZzdGF0KHVuc2ln
bmVkIGludCBmZCwgc3RydWN0IHN0YXQgKnN0YXRidWYpOwoKIGxvbmcgc3lzX2ZzdGF0NjQo
dW5zaWduZWQgbG9uZyBmZCwgc3RydWN0IHN0YXQ2NCAqc3RhdGJ1Zik7CiBsb25nIHN5c19m
c3RhdGF0NjQoaW50IGRmZCwgY29uc3QgY2hhciAqZmlsZW5hbWUsCiAgICAgICAgICBzdHJ1
Y3Qgc3RhdDY0ICpzdGF0YnVmLCBpbnQgZmxhZyk7CgoKCiBsb25nIHN5c19zeW5jKHZvaWQp
OwogbG9uZyBzeXNfZnN5bmModW5zaWduZWQgaW50IGZkKTsKIGxvbmcgc3lzX2ZkYXRhc3lu
Yyh1bnNpZ25lZCBpbnQgZmQpOwogbG9uZyBzeXNfc3luY19maWxlX3JhbmdlMihpbnQgZmQs
IHVuc2lnbmVkIGludCBmbGFncywKICAgICAgICAgbG9mZl90IG9mZnNldCwgbG9mZl90IG5i
eXRlcyk7CiBsb25nIHN5c19zeW5jX2ZpbGVfcmFuZ2UoaW50IGZkLCBsb2ZmX3Qgb2Zmc2V0
LCBsb2ZmX3QgbmJ5dGVzLAogICAgIHVuc2lnbmVkIGludCBmbGFncyk7CgoKIGxvbmcgc3lz
X3RpbWVyZmRfY3JlYXRlKGludCBjbG9ja2lkLCBpbnQgZmxhZ3MpOwogbG9uZyBzeXNfdGlt
ZXJmZF9zZXR0aW1lKGludCB1ZmQsIGludCBmbGFncywKICAgICAgICBjb25zdCBzdHJ1Y3Qg
X19rZXJuZWxfaXRpbWVyc3BlYyAqdXRtciwKICAgICAgICBzdHJ1Y3QgX19rZXJuZWxfaXRp
bWVyc3BlYyAqb3Rtcik7CiBsb25nIHN5c190aW1lcmZkX2dldHRpbWUoaW50IHVmZCwgc3Ry
dWN0IF9fa2VybmVsX2l0aW1lcnNwZWMgKm90bXIpOwogbG9uZyBzeXNfdGltZXJmZF9nZXR0
aW1lMzIoaW50IHVmZCwKICAgICAgIHN0cnVjdCBvbGRfaXRpbWVyc3BlYzMyICpvdG1yKTsK
IGxvbmcgc3lzX3RpbWVyZmRfc2V0dGltZTMyKGludCB1ZmQsIGludCBmbGFncywKICAgICAg
IGNvbnN0IHN0cnVjdCBvbGRfaXRpbWVyc3BlYzMyICp1dG1yLAogICAgICAgc3RydWN0IG9s
ZF9pdGltZXJzcGVjMzIgKm90bXIpOwoKCiBsb25nIHN5c191dGltZW5zYXQoaW50IGRmZCwg
Y29uc3QgY2hhciAqZmlsZW5hbWUsCiAgICBzdHJ1Y3QgX19rZXJuZWxfdGltZXNwZWMgKnV0
aW1lcywKICAgIGludCBmbGFncyk7CiBsb25nIHN5c191dGltZW5zYXRfdGltZTMyKHVuc2ln
bmVkIGludCBkZmQsCiAgICBjb25zdCBjaGFyICpmaWxlbmFtZSwKICAgIHN0cnVjdCBvbGRf
dGltZXNwZWMzMiAqdCwgaW50IGZsYWdzKTsKCgogbG9uZyBzeXNfYWNjdChjb25zdCBjaGFy
ICpuYW1lKTsKCgogbG9uZyBzeXNfY2FwZ2V0KGNhcF91c2VyX2hlYWRlcl90IGhlYWRlciwK
ICAgIGNhcF91c2VyX2RhdGFfdCBkYXRhcHRyKTsKIGxvbmcgc3lzX2NhcHNldChjYXBfdXNl
cl9oZWFkZXJfdCBoZWFkZXIsCiAgICBjb25zdCBjYXBfdXNlcl9kYXRhX3QgZGF0YSk7CgoK
IGxvbmcgc3lzX3BlcnNvbmFsaXR5KHVuc2lnbmVkIGludCBwZXJzb25hbGl0eSk7CgoKIGxv
bmcgc3lzX2V4aXQoaW50IGVycm9yX2NvZGUpOwogbG9uZyBzeXNfZXhpdF9ncm91cChpbnQg
ZXJyb3JfY29kZSk7CiBsb25nIHN5c193YWl0aWQoaW50IHdoaWNoLCBwaWRfdCBwaWQsCiAg
ICAgIHN0cnVjdCBzaWdpbmZvICppbmZvcCwKICAgICAgaW50IG9wdGlvbnMsIHN0cnVjdCBy
dXNhZ2UgKnJ1KTsKCgogbG9uZyBzeXNfc2V0X3RpZF9hZGRyZXNzKGludCAqdGlkcHRyKTsK
IGxvbmcgc3lzX3Vuc2hhcmUodW5zaWduZWQgbG9uZyB1bnNoYXJlX2ZsYWdzKTsKCgogbG9u
ZyBzeXNfZnV0ZXgodTMyICp1YWRkciwgaW50IG9wLCB1MzIgdmFsLAogICBzdHJ1Y3QgX19r
ZXJuZWxfdGltZXNwZWMgKnV0aW1lLCB1MzIgKnVhZGRyMiwKICAgdTMyIHZhbDMpOwogbG9u
ZyBzeXNfZnV0ZXhfdGltZTMyKHUzMiAqdWFkZHIsIGludCBvcCwgdTMyIHZhbCwKICAgc3Ry
dWN0IG9sZF90aW1lc3BlYzMyICp1dGltZSwgdTMyICp1YWRkcjIsCiAgIHUzMiB2YWwzKTsK
IGxvbmcgc3lzX2dldF9yb2J1c3RfbGlzdChpbnQgcGlkLAogICAgICAgIHN0cnVjdCByb2J1
c3RfbGlzdF9oZWFkICogKmhlYWRfcHRyLAogICAgICAgIHNpemVfdCAqbGVuX3B0cik7CiBs
b25nIHN5c19zZXRfcm9idXN0X2xpc3Qoc3RydWN0IHJvYnVzdF9saXN0X2hlYWQgKmhlYWQs
CiAgICAgICAgc2l6ZV90IGxlbik7CgoKIGxvbmcgc3lzX25hbm9zbGVlcChzdHJ1Y3QgX19r
ZXJuZWxfdGltZXNwZWMgKnJxdHAsCiAgICAgICAgIHN0cnVjdCBfX2tlcm5lbF90aW1lc3Bl
YyAqcm10cCk7CiBsb25nIHN5c19uYW5vc2xlZXBfdGltZTMyKHN0cnVjdCBvbGRfdGltZXNw
ZWMzMiAqcnF0cCwKICAgICAgICAgc3RydWN0IG9sZF90aW1lc3BlYzMyICpybXRwKTsKCgog
bG9uZyBzeXNfZ2V0aXRpbWVyKGludCB3aGljaCwgc3RydWN0IF9fa2VybmVsX29sZF9pdGlt
ZXJ2YWwgKnZhbHVlKTsKIGxvbmcgc3lzX3NldGl0aW1lcihpbnQgd2hpY2gsCiAgICBzdHJ1
Y3QgX19rZXJuZWxfb2xkX2l0aW1lcnZhbCAqdmFsdWUsCiAgICBzdHJ1Y3QgX19rZXJuZWxf
b2xkX2l0aW1lcnZhbCAqb3ZhbHVlKTsKCgogbG9uZyBzeXNfa2V4ZWNfbG9hZCh1bnNpZ25l
ZCBsb25nIGVudHJ5LCB1bnNpZ25lZCBsb25nIG5yX3NlZ21lbnRzLAogICAgc3RydWN0IGtl
eGVjX3NlZ21lbnQgKnNlZ21lbnRzLAogICAgdW5zaWduZWQgbG9uZyBmbGFncyk7CgoKIGxv
bmcgc3lzX2luaXRfbW9kdWxlKHZvaWQgKnVtb2QsIHVuc2lnbmVkIGxvbmcgbGVuLAogICAg
Y29uc3QgY2hhciAqdWFyZ3MpOwogbG9uZyBzeXNfZGVsZXRlX21vZHVsZShjb25zdCBjaGFy
ICpuYW1lX3VzZXIsCiAgICB1bnNpZ25lZCBpbnQgZmxhZ3MpOwoKCiBsb25nIHN5c190aW1l
cl9jcmVhdGUoY2xvY2tpZF90IHdoaWNoX2Nsb2NrLAogICAgIHN0cnVjdCBzaWdldmVudCAq
dGltZXJfZXZlbnRfc3BlYywKICAgICB0aW1lcl90ICogY3JlYXRlZF90aW1lcl9pZCk7CiBs
b25nIHN5c190aW1lcl9nZXR0aW1lKHRpbWVyX3QgdGltZXJfaWQsCiAgICBzdHJ1Y3QgX19r
ZXJuZWxfaXRpbWVyc3BlYyAqc2V0dGluZyk7CiBsb25nIHN5c190aW1lcl9nZXRvdmVycnVu
KHRpbWVyX3QgdGltZXJfaWQpOwogbG9uZyBzeXNfdGltZXJfc2V0dGltZSh0aW1lcl90IHRp
bWVyX2lkLCBpbnQgZmxhZ3MsCiAgICBjb25zdCBzdHJ1Y3QgX19rZXJuZWxfaXRpbWVyc3Bl
YyAqbmV3X3NldHRpbmcsCiAgICBzdHJ1Y3QgX19rZXJuZWxfaXRpbWVyc3BlYyAqb2xkX3Nl
dHRpbmcpOwogbG9uZyBzeXNfdGltZXJfZGVsZXRlKHRpbWVyX3QgdGltZXJfaWQpOwogbG9u
ZyBzeXNfY2xvY2tfc2V0dGltZShjbG9ja2lkX3Qgd2hpY2hfY2xvY2ssCiAgICBjb25zdCBz
dHJ1Y3QgX19rZXJuZWxfdGltZXNwZWMgKnRwKTsKIGxvbmcgc3lzX2Nsb2NrX2dldHRpbWUo
Y2xvY2tpZF90IHdoaWNoX2Nsb2NrLAogICAgc3RydWN0IF9fa2VybmVsX3RpbWVzcGVjICp0
cCk7CiBsb25nIHN5c19jbG9ja19nZXRyZXMoY2xvY2tpZF90IHdoaWNoX2Nsb2NrLAogICAg
c3RydWN0IF9fa2VybmVsX3RpbWVzcGVjICp0cCk7CiBsb25nIHN5c19jbG9ja19uYW5vc2xl
ZXAoY2xvY2tpZF90IHdoaWNoX2Nsb2NrLCBpbnQgZmxhZ3MsCiAgICBjb25zdCBzdHJ1Y3Qg
X19rZXJuZWxfdGltZXNwZWMgKnJxdHAsCiAgICBzdHJ1Y3QgX19rZXJuZWxfdGltZXNwZWMg
KnJtdHApOwogbG9uZyBzeXNfdGltZXJfZ2V0dGltZTMyKHRpbWVyX3QgdGltZXJfaWQsCiAg
ICAgc3RydWN0IG9sZF9pdGltZXJzcGVjMzIgKnNldHRpbmcpOwogbG9uZyBzeXNfdGltZXJf
c2V0dGltZTMyKHRpbWVyX3QgdGltZXJfaWQsIGludCBmbGFncywKICAgICAgc3RydWN0IG9s
ZF9pdGltZXJzcGVjMzIgKm5ldywKICAgICAgc3RydWN0IG9sZF9pdGltZXJzcGVjMzIgKm9s
ZCk7CiBsb25nIHN5c19jbG9ja19zZXR0aW1lMzIoY2xvY2tpZF90IHdoaWNoX2Nsb2NrLAog
ICAgc3RydWN0IG9sZF90aW1lc3BlYzMyICp0cCk7CiBsb25nIHN5c19jbG9ja19nZXR0aW1l
MzIoY2xvY2tpZF90IHdoaWNoX2Nsb2NrLAogICAgc3RydWN0IG9sZF90aW1lc3BlYzMyICp0
cCk7CiBsb25nIHN5c19jbG9ja19nZXRyZXNfdGltZTMyKGNsb2NraWRfdCB3aGljaF9jbG9j
aywKICAgIHN0cnVjdCBvbGRfdGltZXNwZWMzMiAqdHApOwogbG9uZyBzeXNfY2xvY2tfbmFu
b3NsZWVwX3RpbWUzMihjbG9ja2lkX3Qgd2hpY2hfY2xvY2ssIGludCBmbGFncywKICAgIHN0
cnVjdCBvbGRfdGltZXNwZWMzMiAqcnF0cCwKICAgIHN0cnVjdCBvbGRfdGltZXNwZWMzMiAq
cm10cCk7CgoKIGxvbmcgc3lzX3N5c2xvZyhpbnQgdHlwZSwgY2hhciAqYnVmLCBpbnQgbGVu
KTsKCgogbG9uZyBzeXNfcHRyYWNlKGxvbmcgcmVxdWVzdCwgbG9uZyBwaWQsIHVuc2lnbmVk
IGxvbmcgYWRkciwKICAgICAgdW5zaWduZWQgbG9uZyBkYXRhKTsKCgogbG9uZyBzeXNfc2No
ZWRfc2V0cGFyYW0ocGlkX3QgcGlkLAogICAgIHN0cnVjdCBzY2hlZF9wYXJhbSAqcGFyYW0p
OwogbG9uZyBzeXNfc2NoZWRfc2V0c2NoZWR1bGVyKHBpZF90IHBpZCwgaW50IHBvbGljeSwK
ICAgICBzdHJ1Y3Qgc2NoZWRfcGFyYW0gKnBhcmFtKTsKIGxvbmcgc3lzX3NjaGVkX2dldHNj
aGVkdWxlcihwaWRfdCBwaWQpOwogbG9uZyBzeXNfc2NoZWRfZ2V0cGFyYW0ocGlkX3QgcGlk
LAogICAgIHN0cnVjdCBzY2hlZF9wYXJhbSAqcGFyYW0pOwogbG9uZyBzeXNfc2NoZWRfc2V0
YWZmaW5pdHkocGlkX3QgcGlkLCB1bnNpZ25lZCBpbnQgbGVuLAogICAgIHVuc2lnbmVkIGxv
bmcgKnVzZXJfbWFza19wdHIpOwogbG9uZyBzeXNfc2NoZWRfZ2V0YWZmaW5pdHkocGlkX3Qg
cGlkLCB1bnNpZ25lZCBpbnQgbGVuLAogICAgIHVuc2lnbmVkIGxvbmcgKnVzZXJfbWFza19w
dHIpOwogbG9uZyBzeXNfc2NoZWRfeWllbGQodm9pZCk7CiBsb25nIHN5c19zY2hlZF9nZXRf
cHJpb3JpdHlfbWF4KGludCBwb2xpY3kpOwogbG9uZyBzeXNfc2NoZWRfZ2V0X3ByaW9yaXR5
X21pbihpbnQgcG9saWN5KTsKIGxvbmcgc3lzX3NjaGVkX3JyX2dldF9pbnRlcnZhbChwaWRf
dCBwaWQsCiAgICBzdHJ1Y3QgX19rZXJuZWxfdGltZXNwZWMgKmludGVydmFsKTsKIGxvbmcg
c3lzX3NjaGVkX3JyX2dldF9pbnRlcnZhbF90aW1lMzIocGlkX3QgcGlkLAogICAgICAgc3Ry
dWN0IG9sZF90aW1lc3BlYzMyICppbnRlcnZhbCk7CgoKIGxvbmcgc3lzX3Jlc3RhcnRfc3lz
Y2FsbCh2b2lkKTsKIGxvbmcgc3lzX2tpbGwocGlkX3QgcGlkLCBpbnQgc2lnKTsKIGxvbmcg
c3lzX3RraWxsKHBpZF90IHBpZCwgaW50IHNpZyk7CiBsb25nIHN5c190Z2tpbGwocGlkX3Qg
dGdpZCwgcGlkX3QgcGlkLCBpbnQgc2lnKTsKIGxvbmcgc3lzX3NpZ2FsdHN0YWNrKGNvbnN0
IHN0cnVjdCBzaWdhbHRzdGFjayAqdXNzLAogICAgc3RydWN0IHNpZ2FsdHN0YWNrICp1b3Nz
KTsKIGxvbmcgc3lzX3J0X3NpZ3N1c3BlbmQoc2lnc2V0X3QgKnVuZXdzZXQsIHNpemVfdCBz
aWdzZXRzaXplKTsKCiBsb25nIHN5c19ydF9zaWdhY3Rpb24oaW50LAogICAgIGNvbnN0IHN0
cnVjdCBzaWdhY3Rpb24gKiwKICAgICBzdHJ1Y3Qgc2lnYWN0aW9uICosCiAgICAgc2l6ZV90
KTsKCiBsb25nIHN5c19ydF9zaWdwcm9jbWFzayhpbnQgaG93LCBzaWdzZXRfdCAqc2V0LAog
ICAgc2lnc2V0X3QgKm9zZXQsIHNpemVfdCBzaWdzZXRzaXplKTsKIGxvbmcgc3lzX3J0X3Np
Z3BlbmRpbmcoc2lnc2V0X3QgKnNldCwgc2l6ZV90IHNpZ3NldHNpemUpOwogbG9uZyBzeXNf
cnRfc2lndGltZWR3YWl0KGNvbnN0IHNpZ3NldF90ICp1dGhlc2UsCiAgICBzaWdpbmZvX3Qg
KnVpbmZvLAogICAgY29uc3Qgc3RydWN0IF9fa2VybmVsX3RpbWVzcGVjICp1dHMsCiAgICBz
aXplX3Qgc2lnc2V0c2l6ZSk7CiBsb25nIHN5c19ydF9zaWd0aW1lZHdhaXRfdGltZTMyKGNv
bnN0IHNpZ3NldF90ICp1dGhlc2UsCiAgICBzaWdpbmZvX3QgKnVpbmZvLAogICAgY29uc3Qg
c3RydWN0IG9sZF90aW1lc3BlYzMyICp1dHMsCiAgICBzaXplX3Qgc2lnc2V0c2l6ZSk7CiBs
b25nIHN5c19ydF9zaWdxdWV1ZWluZm8ocGlkX3QgcGlkLCBpbnQgc2lnLCBzaWdpbmZvX3Qg
KnVpbmZvKTsKCgogbG9uZyBzeXNfc2V0cHJpb3JpdHkoaW50IHdoaWNoLCBpbnQgd2hvLCBp
bnQgbmljZXZhbCk7CiBsb25nIHN5c19nZXRwcmlvcml0eShpbnQgd2hpY2gsIGludCB3aG8p
OwogbG9uZyBzeXNfcmVib290KGludCBtYWdpYzEsIGludCBtYWdpYzIsIHVuc2lnbmVkIGlu
dCBjbWQsCiAgICB2b2lkICphcmcpOwogbG9uZyBzeXNfc2V0cmVnaWQoZ2lkX3QgcmdpZCwg
Z2lkX3QgZWdpZCk7CiBsb25nIHN5c19zZXRnaWQoZ2lkX3QgZ2lkKTsKIGxvbmcgc3lzX3Nl
dHJldWlkKHVpZF90IHJ1aWQsIHVpZF90IGV1aWQpOwogbG9uZyBzeXNfc2V0dWlkKHVpZF90
IHVpZCk7CiBsb25nIHN5c19zZXRyZXN1aWQodWlkX3QgcnVpZCwgdWlkX3QgZXVpZCwgdWlk
X3Qgc3VpZCk7CiBsb25nIHN5c19nZXRyZXN1aWQodWlkX3QgKnJ1aWQsIHVpZF90ICpldWlk
LCB1aWRfdCAqc3VpZCk7CiBsb25nIHN5c19zZXRyZXNnaWQoZ2lkX3QgcmdpZCwgZ2lkX3Qg
ZWdpZCwgZ2lkX3Qgc2dpZCk7CiBsb25nIHN5c19nZXRyZXNnaWQoZ2lkX3QgKnJnaWQsIGdp
ZF90ICplZ2lkLCBnaWRfdCAqc2dpZCk7CiBsb25nIHN5c19zZXRmc3VpZCh1aWRfdCB1aWQp
OwogbG9uZyBzeXNfc2V0ZnNnaWQoZ2lkX3QgZ2lkKTsKIGxvbmcgc3lzX3RpbWVzKHN0cnVj
dCB0bXMgKnRidWYpOwogbG9uZyBzeXNfc2V0cGdpZChwaWRfdCBwaWQsIHBpZF90IHBnaWQp
OwogbG9uZyBzeXNfZ2V0cGdpZChwaWRfdCBwaWQpOwogbG9uZyBzeXNfZ2V0c2lkKHBpZF90
IHBpZCk7CiBsb25nIHN5c19zZXRzaWQodm9pZCk7CiBsb25nIHN5c19nZXRncm91cHMoaW50
IGdpZHNldHNpemUsIGdpZF90ICpncm91cGxpc3QpOwogbG9uZyBzeXNfc2V0Z3JvdXBzKGlu
dCBnaWRzZXRzaXplLCBnaWRfdCAqZ3JvdXBsaXN0KTsKIGxvbmcgc3lzX25ld3VuYW1lKHN0
cnVjdCBuZXdfdXRzbmFtZSAqbmFtZSk7CiBsb25nIHN5c19zZXRob3N0bmFtZShjaGFyICpu
YW1lLCBpbnQgbGVuKTsKIGxvbmcgc3lzX3NldGRvbWFpbm5hbWUoY2hhciAqbmFtZSwgaW50
IGxlbik7CiBsb25nIHN5c19nZXRybGltaXQodW5zaWduZWQgaW50IHJlc291cmNlLAogICAg
c3RydWN0IHJsaW1pdCAqcmxpbSk7CiBsb25nIHN5c19zZXRybGltaXQodW5zaWduZWQgaW50
IHJlc291cmNlLAogICAgc3RydWN0IHJsaW1pdCAqcmxpbSk7CiBsb25nIHN5c19nZXRydXNh
Z2UoaW50IHdobywgc3RydWN0IHJ1c2FnZSAqcnUpOwogbG9uZyBzeXNfdW1hc2soaW50IG1h
c2spOwogbG9uZyBzeXNfcHJjdGwoaW50IG9wdGlvbiwgdW5zaWduZWQgbG9uZyBhcmcyLCB1
bnNpZ25lZCBsb25nIGFyZzMsCiAgIHVuc2lnbmVkIGxvbmcgYXJnNCwgdW5zaWduZWQgbG9u
ZyBhcmc1KTsKIGxvbmcgc3lzX2dldGNwdSh1bnNpZ25lZCAqY3B1LCB1bnNpZ25lZCAqbm9k
ZSwgc3RydWN0IGdldGNwdV9jYWNoZSAqY2FjaGUpOwoKCiBsb25nIHN5c19nZXR0aW1lb2Zk
YXkoc3RydWN0IF9fa2VybmVsX29sZF90aW1ldmFsICp0diwKICAgIHN0cnVjdCB0aW1lem9u
ZSAqdHopOwogbG9uZyBzeXNfc2V0dGltZW9mZGF5KHN0cnVjdCBfX2tlcm5lbF9vbGRfdGlt
ZXZhbCAqdHYsCiAgICBzdHJ1Y3QgdGltZXpvbmUgKnR6KTsKIGxvbmcgc3lzX2FkanRpbWV4
KHN0cnVjdCBfX2tlcm5lbF90aW1leCAqdHhjX3ApOwogbG9uZyBzeXNfYWRqdGltZXhfdGlt
ZTMyKHN0cnVjdCBvbGRfdGltZXgzMiAqdHhjX3ApOwoKCiBsb25nIHN5c19nZXRwaWQodm9p
ZCk7CiBsb25nIHN5c19nZXRwcGlkKHZvaWQpOwogbG9uZyBzeXNfZ2V0dWlkKHZvaWQpOwog
bG9uZyBzeXNfZ2V0ZXVpZCh2b2lkKTsKIGxvbmcgc3lzX2dldGdpZCh2b2lkKTsKIGxvbmcg
c3lzX2dldGVnaWQodm9pZCk7CiBsb25nIHN5c19nZXR0aWQodm9pZCk7CiBsb25nIHN5c19z
eXNpbmZvKHN0cnVjdCBzeXNpbmZvICppbmZvKTsKCgogbG9uZyBzeXNfbXFfb3Blbihjb25z
dCBjaGFyICpuYW1lLCBpbnQgb2ZsYWcsIHVtb2RlX3QgbW9kZSwgc3RydWN0IG1xX2F0dHIg
KmF0dHIpOwogbG9uZyBzeXNfbXFfdW5saW5rKGNvbnN0IGNoYXIgKm5hbWUpOwogbG9uZyBz
eXNfbXFfdGltZWRzZW5kKG1xZF90IG1xZGVzLCBjb25zdCBjaGFyICptc2dfcHRyLCBzaXpl
X3QgbXNnX2xlbiwgdW5zaWduZWQgaW50IG1zZ19wcmlvLCBjb25zdCBzdHJ1Y3QgX19rZXJu
ZWxfdGltZXNwZWMgKmFic190aW1lb3V0KTsKIGxvbmcgc3lzX21xX3RpbWVkcmVjZWl2ZSht
cWRfdCBtcWRlcywgY2hhciAqbXNnX3B0ciwgc2l6ZV90IG1zZ19sZW4sIHVuc2lnbmVkIGlu
dCAqbXNnX3ByaW8sIGNvbnN0IHN0cnVjdCBfX2tlcm5lbF90aW1lc3BlYyAqYWJzX3RpbWVv
dXQpOwogbG9uZyBzeXNfbXFfbm90aWZ5KG1xZF90IG1xZGVzLCBjb25zdCBzdHJ1Y3Qgc2ln
ZXZlbnQgKm5vdGlmaWNhdGlvbik7CiBsb25nIHN5c19tcV9nZXRzZXRhdHRyKG1xZF90IG1x
ZGVzLCBjb25zdCBzdHJ1Y3QgbXFfYXR0ciAqbXFzdGF0LCBzdHJ1Y3QgbXFfYXR0ciAqb21x
c3RhdCk7CiBsb25nIHN5c19tcV90aW1lZHJlY2VpdmVfdGltZTMyKG1xZF90IG1xZGVzLAog
ICBjaGFyICp1X21zZ19wdHIsCiAgIHVuc2lnbmVkIGludCBtc2dfbGVuLCB1bnNpZ25lZCBp
bnQgKnVfbXNnX3ByaW8sCiAgIGNvbnN0IHN0cnVjdCBvbGRfdGltZXNwZWMzMiAqdV9hYnNf
dGltZW91dCk7CiBsb25nIHN5c19tcV90aW1lZHNlbmRfdGltZTMyKG1xZF90IG1xZGVzLAog
ICBjb25zdCBjaGFyICp1X21zZ19wdHIsCiAgIHVuc2lnbmVkIGludCBtc2dfbGVuLCB1bnNp
Z25lZCBpbnQgbXNnX3ByaW8sCiAgIGNvbnN0IHN0cnVjdCBvbGRfdGltZXNwZWMzMiAqdV9h
YnNfdGltZW91dCk7CgoKIGxvbmcgc3lzX21zZ2dldChrZXlfdCBrZXksIGludCBtc2dmbGcp
OwogbG9uZyBzeXNfb2xkX21zZ2N0bChpbnQgbXNxaWQsIGludCBjbWQsIHN0cnVjdCBtc3Fp
ZF9kcyAqYnVmKTsKIGxvbmcgc3lzX21zZ2N0bChpbnQgbXNxaWQsIGludCBjbWQsIHN0cnVj
dCBtc3FpZF9kcyAqYnVmKTsKIGxvbmcgc3lzX21zZ3JjdihpbnQgbXNxaWQsIHN0cnVjdCBt
c2didWYgKm1zZ3AsCiAgICBzaXplX3QgbXNnc3osIGxvbmcgbXNndHlwLCBpbnQgbXNnZmxn
KTsKIGxvbmcgc3lzX21zZ3NuZChpbnQgbXNxaWQsIHN0cnVjdCBtc2didWYgKm1zZ3AsCiAg
ICBzaXplX3QgbXNnc3osIGludCBtc2dmbGcpOwoKCiBsb25nIHN5c19zZW1nZXQoa2V5X3Qg
a2V5LCBpbnQgbnNlbXMsIGludCBzZW1mbGcpOwogbG9uZyBzeXNfc2VtY3RsKGludCBzZW1p
ZCwgaW50IHNlbW51bSwgaW50IGNtZCwgdW5zaWduZWQgbG9uZyBhcmcpOwogbG9uZyBzeXNf
b2xkX3NlbWN0bChpbnQgc2VtaWQsIGludCBzZW1udW0sIGludCBjbWQsIHVuc2lnbmVkIGxv
bmcgYXJnKTsKIGxvbmcgc3lzX3NlbXRpbWVkb3AoaW50IHNlbWlkLCBzdHJ1Y3Qgc2VtYnVm
ICpzb3BzLAogICAgdW5zaWduZWQgbnNvcHMsCiAgICBjb25zdCBzdHJ1Y3QgX19rZXJuZWxf
dGltZXNwZWMgKnRpbWVvdXQpOwogbG9uZyBzeXNfc2VtdGltZWRvcF90aW1lMzIoaW50IHNl
bWlkLCBzdHJ1Y3Qgc2VtYnVmICpzb3BzLAogICAgdW5zaWduZWQgbnNvcHMsCiAgICBjb25z
dCBzdHJ1Y3Qgb2xkX3RpbWVzcGVjMzIgKnRpbWVvdXQpOwogbG9uZyBzeXNfc2Vtb3AoaW50
IHNlbWlkLCBzdHJ1Y3Qgc2VtYnVmICpzb3BzLAogICAgdW5zaWduZWQgbnNvcHMpOwoKCiBs
b25nIHN5c19zaG1nZXQoa2V5X3Qga2V5LCBzaXplX3Qgc2l6ZSwgaW50IGZsYWcpOwogbG9u
ZyBzeXNfb2xkX3NobWN0bChpbnQgc2htaWQsIGludCBjbWQsIHN0cnVjdCBzaG1pZF9kcyAq
YnVmKTsKIGxvbmcgc3lzX3NobWN0bChpbnQgc2htaWQsIGludCBjbWQsIHN0cnVjdCBzaG1p
ZF9kcyAqYnVmKTsKIGxvbmcgc3lzX3NobWF0KGludCBzaG1pZCwgY2hhciAqc2htYWRkciwg
aW50IHNobWZsZyk7CiBsb25nIHN5c19zaG1kdChjaGFyICpzaG1hZGRyKTsKCgogbG9uZyBz
eXNfc29ja2V0KGludCwgaW50LCBpbnQpOwogbG9uZyBzeXNfc29ja2V0cGFpcihpbnQsIGlu
dCwgaW50LCBpbnQgKik7CiBsb25nIHN5c19iaW5kKGludCwgc3RydWN0IHNvY2thZGRyICos
IGludCk7CiBsb25nIHN5c19saXN0ZW4oaW50LCBpbnQpOwogbG9uZyBzeXNfYWNjZXB0KGlu
dCwgc3RydWN0IHNvY2thZGRyICosIGludCAqKTsKIGxvbmcgc3lzX2Nvbm5lY3QoaW50LCBz
dHJ1Y3Qgc29ja2FkZHIgKiwgaW50KTsKIGxvbmcgc3lzX2dldHNvY2tuYW1lKGludCwgc3Ry
dWN0IHNvY2thZGRyICosIGludCAqKTsKIGxvbmcgc3lzX2dldHBlZXJuYW1lKGludCwgc3Ry
dWN0IHNvY2thZGRyICosIGludCAqKTsKIGxvbmcgc3lzX3NlbmR0byhpbnQsIHZvaWQgKiwg
c2l6ZV90LCB1bnNpZ25lZCwKICAgIHN0cnVjdCBzb2NrYWRkciAqLCBpbnQpOwogbG9uZyBz
eXNfcmVjdmZyb20oaW50LCB2b2lkICosIHNpemVfdCwgdW5zaWduZWQsCiAgICBzdHJ1Y3Qg
c29ja2FkZHIgKiwgaW50ICopOwogbG9uZyBzeXNfc2V0c29ja29wdChpbnQgZmQsIGludCBs
ZXZlbCwgaW50IG9wdG5hbWUsCiAgICBjaGFyICpvcHR2YWwsIGludCBvcHRsZW4pOwogbG9u
ZyBzeXNfZ2V0c29ja29wdChpbnQgZmQsIGludCBsZXZlbCwgaW50IG9wdG5hbWUsCiAgICBj
aGFyICpvcHR2YWwsIGludCAqb3B0bGVuKTsKIGxvbmcgc3lzX3NodXRkb3duKGludCwgaW50
KTsKIGxvbmcgc3lzX3NlbmRtc2coaW50IGZkLCBzdHJ1Y3QgdXNlcl9tc2doZHIgKm1zZywg
dW5zaWduZWQgZmxhZ3MpOwogbG9uZyBzeXNfcmVjdm1zZyhpbnQgZmQsIHN0cnVjdCB1c2Vy
X21zZ2hkciAqbXNnLCB1bnNpZ25lZCBmbGFncyk7CgoKIGxvbmcgc3lzX3JlYWRhaGVhZChp
bnQgZmQsIGxvZmZfdCBvZmZzZXQsIHNpemVfdCBjb3VudCk7CgoKIGxvbmcgc3lzX2Jyayh1
bnNpZ25lZCBsb25nIGJyayk7CiBsb25nIHN5c19tdW5tYXAodW5zaWduZWQgbG9uZyBhZGRy
LCBzaXplX3QgbGVuKTsKIGxvbmcgc3lzX21yZW1hcCh1bnNpZ25lZCBsb25nIGFkZHIsCiAg
ICAgIHVuc2lnbmVkIGxvbmcgb2xkX2xlbiwgdW5zaWduZWQgbG9uZyBuZXdfbGVuLAogICAg
ICB1bnNpZ25lZCBsb25nIGZsYWdzLCB1bnNpZ25lZCBsb25nIG5ld19hZGRyKTsKCgogbG9u
ZyBzeXNfYWRkX2tleShjb25zdCBjaGFyICpfdHlwZSwKICAgICAgIGNvbnN0IGNoYXIgKl9k
ZXNjcmlwdGlvbiwKICAgICAgIGNvbnN0IHZvaWQgKl9wYXlsb2FkLAogICAgICAgc2l6ZV90
IHBsZW4sCiAgICAgICBrZXlfc2VyaWFsX3QgZGVzdHJpbmdpZCk7CiBsb25nIHN5c19yZXF1
ZXN0X2tleShjb25zdCBjaGFyICpfdHlwZSwKICAgIGNvbnN0IGNoYXIgKl9kZXNjcmlwdGlv
biwKICAgIGNvbnN0IGNoYXIgKl9jYWxsb3V0X2luZm8sCiAgICBrZXlfc2VyaWFsX3QgZGVz
dHJpbmdpZCk7CiBsb25nIHN5c19rZXljdGwoaW50IGNtZCwgdW5zaWduZWQgbG9uZyBhcmcy
LCB1bnNpZ25lZCBsb25nIGFyZzMsCiAgICAgIHVuc2lnbmVkIGxvbmcgYXJnNCwgdW5zaWdu
ZWQgbG9uZyBhcmc1KTsKCgoKIGxvbmcgc3lzX2Nsb25lKHVuc2lnbmVkIGxvbmcsIHVuc2ln
bmVkIGxvbmcsIGludCAqLCB1bnNpZ25lZCBsb25nLAogICAgICAgIGludCAqKTsKIyA4NTkg
Ii4vaW5jbHVkZS9saW51eC9zeXNjYWxscy5oIgogbG9uZyBzeXNfY2xvbmUzKHN0cnVjdCBj
bG9uZV9hcmdzICp1YXJncywgc2l6ZV90IHNpemUpOwoKIGxvbmcgc3lzX2V4ZWN2ZShjb25z
dCBjaGFyICpmaWxlbmFtZSwKICBjb25zdCBjaGFyICpjb25zdCAqYXJndiwKICBjb25zdCBj
aGFyICpjb25zdCAqZW52cCk7CgoKIGxvbmcgc3lzX2ZhZHZpc2U2NF82NChpbnQgZmQsIGxv
ZmZfdCBvZmZzZXQsIGxvZmZfdCBsZW4sIGludCBhZHZpY2UpOwoKCiBsb25nIHN5c19zd2Fw
b24oY29uc3QgY2hhciAqc3BlY2lhbGZpbGUsIGludCBzd2FwX2ZsYWdzKTsKIGxvbmcgc3lz
X3N3YXBvZmYoY29uc3QgY2hhciAqc3BlY2lhbGZpbGUpOwogbG9uZyBzeXNfbXByb3RlY3Qo
dW5zaWduZWQgbG9uZyBzdGFydCwgc2l6ZV90IGxlbiwKICAgIHVuc2lnbmVkIGxvbmcgcHJv
dCk7CiBsb25nIHN5c19tc3luYyh1bnNpZ25lZCBsb25nIHN0YXJ0LCBzaXplX3QgbGVuLCBp
bnQgZmxhZ3MpOwogbG9uZyBzeXNfbWxvY2sodW5zaWduZWQgbG9uZyBzdGFydCwgc2l6ZV90
IGxlbik7CiBsb25nIHN5c19tdW5sb2NrKHVuc2lnbmVkIGxvbmcgc3RhcnQsIHNpemVfdCBs
ZW4pOwogbG9uZyBzeXNfbWxvY2thbGwoaW50IGZsYWdzKTsKIGxvbmcgc3lzX211bmxvY2th
bGwodm9pZCk7CiBsb25nIHN5c19taW5jb3JlKHVuc2lnbmVkIGxvbmcgc3RhcnQsIHNpemVf
dCBsZW4sCiAgICB1bnNpZ25lZCBjaGFyICogdmVjKTsKIGxvbmcgc3lzX21hZHZpc2UodW5z
aWduZWQgbG9uZyBzdGFydCwgc2l6ZV90IGxlbiwgaW50IGJlaGF2aW9yKTsKIGxvbmcgc3lz
X3JlbWFwX2ZpbGVfcGFnZXModW5zaWduZWQgbG9uZyBzdGFydCwgdW5zaWduZWQgbG9uZyBz
aXplLAogICB1bnNpZ25lZCBsb25nIHByb3QsIHVuc2lnbmVkIGxvbmcgcGdvZmYsCiAgIHVu
c2lnbmVkIGxvbmcgZmxhZ3MpOwogbG9uZyBzeXNfbWJpbmQodW5zaWduZWQgbG9uZyBzdGFy
dCwgdW5zaWduZWQgbG9uZyBsZW4sCiAgICB1bnNpZ25lZCBsb25nIG1vZGUsCiAgICBjb25z
dCB1bnNpZ25lZCBsb25nICpubWFzaywKICAgIHVuc2lnbmVkIGxvbmcgbWF4bm9kZSwKICAg
IHVuc2lnbmVkIGZsYWdzKTsKIGxvbmcgc3lzX2dldF9tZW1wb2xpY3koaW50ICpwb2xpY3ks
CiAgICB1bnNpZ25lZCBsb25nICpubWFzaywKICAgIHVuc2lnbmVkIGxvbmcgbWF4bm9kZSwK
ICAgIHVuc2lnbmVkIGxvbmcgYWRkciwgdW5zaWduZWQgbG9uZyBmbGFncyk7CiBsb25nIHN5
c19zZXRfbWVtcG9saWN5KGludCBtb2RlLCBjb25zdCB1bnNpZ25lZCBsb25nICpubWFzaywK
ICAgIHVuc2lnbmVkIGxvbmcgbWF4bm9kZSk7CiBsb25nIHN5c19taWdyYXRlX3BhZ2VzKHBp
ZF90IHBpZCwgdW5zaWduZWQgbG9uZyBtYXhub2RlLAogICAgY29uc3QgdW5zaWduZWQgbG9u
ZyAqZnJvbSwKICAgIGNvbnN0IHVuc2lnbmVkIGxvbmcgKnRvKTsKIGxvbmcgc3lzX21vdmVf
cGFnZXMocGlkX3QgcGlkLCB1bnNpZ25lZCBsb25nIG5yX3BhZ2VzLAogICAgY29uc3Qgdm9p
ZCAqICpwYWdlcywKICAgIGNvbnN0IGludCAqbm9kZXMsCiAgICBpbnQgKnN0YXR1cywKICAg
IGludCBmbGFncyk7CgogbG9uZyBzeXNfcnRfdGdzaWdxdWV1ZWluZm8ocGlkX3QgdGdpZCwg
cGlkX3QgcGlkLCBpbnQgc2lnLAogIHNpZ2luZm9fdCAqdWluZm8pOwogbG9uZyBzeXNfcGVy
Zl9ldmVudF9vcGVuKAogIHN0cnVjdCBwZXJmX2V2ZW50X2F0dHIgKmF0dHJfdXB0ciwKICBw
aWRfdCBwaWQsIGludCBjcHUsIGludCBncm91cF9mZCwgdW5zaWduZWQgbG9uZyBmbGFncyk7
CiBsb25nIHN5c19hY2NlcHQ0KGludCwgc3RydWN0IHNvY2thZGRyICosIGludCAqLCBpbnQp
OwogbG9uZyBzeXNfcmVjdm1tc2coaW50IGZkLCBzdHJ1Y3QgbW1zZ2hkciAqbXNnLAogICAg
ICAgIHVuc2lnbmVkIGludCB2bGVuLCB1bnNpZ25lZCBmbGFncywKICAgICAgICBzdHJ1Y3Qg
X19rZXJuZWxfdGltZXNwZWMgKnRpbWVvdXQpOwogbG9uZyBzeXNfcmVjdm1tc2dfdGltZTMy
KGludCBmZCwgc3RydWN0IG1tc2doZHIgKm1zZywKICAgICAgICB1bnNpZ25lZCBpbnQgdmxl
biwgdW5zaWduZWQgZmxhZ3MsCiAgICAgICAgc3RydWN0IG9sZF90aW1lc3BlYzMyICp0aW1l
b3V0KTsKCiBsb25nIHN5c193YWl0NChwaWRfdCBwaWQsIGludCAqc3RhdF9hZGRyLAogICAg
aW50IG9wdGlvbnMsIHN0cnVjdCBydXNhZ2UgKnJ1KTsKIGxvbmcgc3lzX3BybGltaXQ2NChw
aWRfdCBwaWQsIHVuc2lnbmVkIGludCByZXNvdXJjZSwKICAgIGNvbnN0IHN0cnVjdCBybGlt
aXQ2NCAqbmV3X3JsaW0sCiAgICBzdHJ1Y3QgcmxpbWl0NjQgKm9sZF9ybGltKTsKIGxvbmcg
c3lzX2Zhbm90aWZ5X2luaXQodW5zaWduZWQgaW50IGZsYWdzLCB1bnNpZ25lZCBpbnQgZXZl
bnRfZl9mbGFncyk7CiBsb25nIHN5c19mYW5vdGlmeV9tYXJrKGludCBmYW5vdGlmeV9mZCwg
dW5zaWduZWQgaW50IGZsYWdzLAogICAgICB1NjQgbWFzaywgaW50IGZkLAogICAgICBjb25z
dCBjaGFyICpwYXRobmFtZSk7CiBsb25nIHN5c19uYW1lX3RvX2hhbmRsZV9hdChpbnQgZGZk
LCBjb25zdCBjaGFyICpuYW1lLAogICAgICAgICAgc3RydWN0IGZpbGVfaGFuZGxlICpoYW5k
bGUsCiAgICAgICAgICBpbnQgKm1udF9pZCwgaW50IGZsYWcpOwogbG9uZyBzeXNfb3Blbl9i
eV9oYW5kbGVfYXQoaW50IG1vdW50ZGlyZmQsCiAgICAgICAgICBzdHJ1Y3QgZmlsZV9oYW5k
bGUgKmhhbmRsZSwKICAgICAgICAgIGludCBmbGFncyk7CiBsb25nIHN5c19jbG9ja19hZGp0
aW1lKGNsb2NraWRfdCB3aGljaF9jbG9jaywKICAgIHN0cnVjdCBfX2tlcm5lbF90aW1leCAq
dHgpOwogbG9uZyBzeXNfY2xvY2tfYWRqdGltZTMyKGNsb2NraWRfdCB3aGljaF9jbG9jaywK
ICAgIHN0cnVjdCBvbGRfdGltZXgzMiAqdHgpOwogbG9uZyBzeXNfc3luY2ZzKGludCBmZCk7
CiBsb25nIHN5c19zZXRucyhpbnQgZmQsIGludCBuc3R5cGUpOwogbG9uZyBzeXNfcGlkZmRf
b3BlbihwaWRfdCBwaWQsIHVuc2lnbmVkIGludCBmbGFncyk7CiBsb25nIHN5c19zZW5kbW1z
ZyhpbnQgZmQsIHN0cnVjdCBtbXNnaGRyICptc2csCiAgICAgICAgdW5zaWduZWQgaW50IHZs
ZW4sIHVuc2lnbmVkIGZsYWdzKTsKIGxvbmcgc3lzX3Byb2Nlc3Nfdm1fcmVhZHYocGlkX3Qg
cGlkLAogICAgICAgICBjb25zdCBzdHJ1Y3QgaW92ZWMgKmx2ZWMsCiAgICAgICAgIHVuc2ln
bmVkIGxvbmcgbGlvdmNudCwKICAgICAgICAgY29uc3Qgc3RydWN0IGlvdmVjICpydmVjLAog
ICAgICAgICB1bnNpZ25lZCBsb25nIHJpb3ZjbnQsCiAgICAgICAgIHVuc2lnbmVkIGxvbmcg
ZmxhZ3MpOwogbG9uZyBzeXNfcHJvY2Vzc192bV93cml0ZXYocGlkX3QgcGlkLAogICAgICAg
ICAgY29uc3Qgc3RydWN0IGlvdmVjICpsdmVjLAogICAgICAgICAgdW5zaWduZWQgbG9uZyBs
aW92Y250LAogICAgICAgICAgY29uc3Qgc3RydWN0IGlvdmVjICpydmVjLAogICAgICAgICAg
dW5zaWduZWQgbG9uZyByaW92Y250LAogICAgICAgICAgdW5zaWduZWQgbG9uZyBmbGFncyk7
CiBsb25nIHN5c19rY21wKHBpZF90IHBpZDEsIHBpZF90IHBpZDIsIGludCB0eXBlLAogICAg
dW5zaWduZWQgbG9uZyBpZHgxLCB1bnNpZ25lZCBsb25nIGlkeDIpOwogbG9uZyBzeXNfZmlu
aXRfbW9kdWxlKGludCBmZCwgY29uc3QgY2hhciAqdWFyZ3MsIGludCBmbGFncyk7CiBsb25n
IHN5c19zY2hlZF9zZXRhdHRyKHBpZF90IHBpZCwKICAgICBzdHJ1Y3Qgc2NoZWRfYXR0ciAq
YXR0ciwKICAgICB1bnNpZ25lZCBpbnQgZmxhZ3MpOwogbG9uZyBzeXNfc2NoZWRfZ2V0YXR0
cihwaWRfdCBwaWQsCiAgICAgc3RydWN0IHNjaGVkX2F0dHIgKmF0dHIsCiAgICAgdW5zaWdu
ZWQgaW50IHNpemUsCiAgICAgdW5zaWduZWQgaW50IGZsYWdzKTsKIGxvbmcgc3lzX3JlbmFt
ZWF0MihpbnQgb2xkZGZkLCBjb25zdCBjaGFyICpvbGRuYW1lLAogICAgICAgICBpbnQgbmV3
ZGZkLCBjb25zdCBjaGFyICpuZXduYW1lLAogICAgICAgICB1bnNpZ25lZCBpbnQgZmxhZ3Mp
OwogbG9uZyBzeXNfc2VjY29tcCh1bnNpZ25lZCBpbnQgb3AsIHVuc2lnbmVkIGludCBmbGFn
cywKICAgICAgIHZvaWQgKnVhcmdzKTsKIGxvbmcgc3lzX2dldHJhbmRvbShjaGFyICpidWYs
IHNpemVfdCBjb3VudCwKICAgICAgICAgdW5zaWduZWQgaW50IGZsYWdzKTsKIGxvbmcgc3lz
X21lbWZkX2NyZWF0ZShjb25zdCBjaGFyICp1bmFtZV9wdHIsIHVuc2lnbmVkIGludCBmbGFn
cyk7CiBsb25nIHN5c19icGYoaW50IGNtZCwgdW5pb24gYnBmX2F0dHIgKmF0dHIsIHVuc2ln
bmVkIGludCBzaXplKTsKIGxvbmcgc3lzX2V4ZWN2ZWF0KGludCBkZmQsIGNvbnN0IGNoYXIg
KmZpbGVuYW1lLAogICBjb25zdCBjaGFyICpjb25zdCAqYXJndiwKICAgY29uc3QgY2hhciAq
Y29uc3QgKmVudnAsIGludCBmbGFncyk7CiBsb25nIHN5c191c2VyZmF1bHRmZChpbnQgZmxh
Z3MpOwogbG9uZyBzeXNfbWVtYmFycmllcihpbnQgY21kLCBpbnQgZmxhZ3MpOwogbG9uZyBz
eXNfbWxvY2syKHVuc2lnbmVkIGxvbmcgc3RhcnQsIHNpemVfdCBsZW4sIGludCBmbGFncyk7
CiBsb25nIHN5c19jb3B5X2ZpbGVfcmFuZ2UoaW50IGZkX2luLCBsb2ZmX3QgKm9mZl9pbiwK
ICAgICAgICBpbnQgZmRfb3V0LCBsb2ZmX3QgKm9mZl9vdXQsCiAgICAgICAgc2l6ZV90IGxl
biwgdW5zaWduZWQgaW50IGZsYWdzKTsKIGxvbmcgc3lzX3ByZWFkdjIodW5zaWduZWQgbG9u
ZyBmZCwgY29uc3Qgc3RydWN0IGlvdmVjICp2ZWMsCiAgICAgICB1bnNpZ25lZCBsb25nIHZs
ZW4sIHVuc2lnbmVkIGxvbmcgcG9zX2wsIHVuc2lnbmVkIGxvbmcgcG9zX2gsCiAgICAgICBy
d2ZfdCBmbGFncyk7CiBsb25nIHN5c19wd3JpdGV2Mih1bnNpZ25lZCBsb25nIGZkLCBjb25z
dCBzdHJ1Y3QgaW92ZWMgKnZlYywKICAgICAgIHVuc2lnbmVkIGxvbmcgdmxlbiwgdW5zaWdu
ZWQgbG9uZyBwb3NfbCwgdW5zaWduZWQgbG9uZyBwb3NfaCwKICAgICAgIHJ3Zl90IGZsYWdz
KTsKIGxvbmcgc3lzX3BrZXlfbXByb3RlY3QodW5zaWduZWQgbG9uZyBzdGFydCwgc2l6ZV90
IGxlbiwKICAgICAgdW5zaWduZWQgbG9uZyBwcm90LCBpbnQgcGtleSk7CiBsb25nIHN5c19w
a2V5X2FsbG9jKHVuc2lnbmVkIGxvbmcgZmxhZ3MsIHVuc2lnbmVkIGxvbmcgaW5pdF92YWwp
OwogbG9uZyBzeXNfcGtleV9mcmVlKGludCBwa2V5KTsKIGxvbmcgc3lzX3N0YXR4KGludCBk
ZmQsIGNvbnN0IGNoYXIgKnBhdGgsIHVuc2lnbmVkIGZsYWdzLAogICAgIHVuc2lnbmVkIG1h
c2ssIHN0cnVjdCBzdGF0eCAqYnVmZmVyKTsKIGxvbmcgc3lzX3JzZXEoc3RydWN0IHJzZXEg
KnJzZXEsIHVpbnQzMl90IHJzZXFfbGVuLAogICAgaW50IGZsYWdzLCB1aW50MzJfdCBzaWcp
OwogbG9uZyBzeXNfb3Blbl90cmVlKGludCBkZmQsIGNvbnN0IGNoYXIgKnBhdGgsIHVuc2ln
bmVkIGZsYWdzKTsKIGxvbmcgc3lzX21vdmVfbW91bnQoaW50IGZyb21fZGZkLCBjb25zdCBj
aGFyICpmcm9tX3BhdGgsCiAgICAgICAgICBpbnQgdG9fZGZkLCBjb25zdCBjaGFyICp0b19w
YXRoLAogICAgICAgICAgdW5zaWduZWQgaW50IG1zX2ZsYWdzKTsKIGxvbmcgc3lzX2Zzb3Bl
bihjb25zdCBjaGFyICpmc19uYW1lLCB1bnNpZ25lZCBpbnQgZmxhZ3MpOwogbG9uZyBzeXNf
ZnNjb25maWcoaW50IGZzX2ZkLCB1bnNpZ25lZCBpbnQgY21kLCBjb25zdCBjaGFyICprZXks
CiAgICAgICAgY29uc3Qgdm9pZCAqdmFsdWUsIGludCBhdXgpOwogbG9uZyBzeXNfZnNtb3Vu
dChpbnQgZnNfZmQsIHVuc2lnbmVkIGludCBmbGFncywgdW5zaWduZWQgaW50IG1zX2ZsYWdz
KTsKIGxvbmcgc3lzX2ZzcGljayhpbnQgZGZkLCBjb25zdCBjaGFyICpwYXRoLCB1bnNpZ25l
ZCBpbnQgZmxhZ3MpOwogbG9uZyBzeXNfcGlkZmRfc2VuZF9zaWduYWwoaW50IHBpZGZkLCBp
bnQgc2lnLAogICAgICAgICAgIHNpZ2luZm9fdCAqaW5mbywKICAgICAgICAgICB1bnNpZ25l
ZCBpbnQgZmxhZ3MpOwogbG9uZyBzeXNfcGlkZmRfZ2V0ZmQoaW50IHBpZGZkLCBpbnQgZmQs
IHVuc2lnbmVkIGludCBmbGFncyk7CgoKCgoKCiBsb25nIHN5c19pb3Blcm0odW5zaWduZWQg
bG9uZyBmcm9tLCB1bnNpZ25lZCBsb25nIG51bSwgaW50IG9uKTsKCgogbG9uZyBzeXNfcGNp
Y29uZmlnX3JlYWQodW5zaWduZWQgbG9uZyBidXMsIHVuc2lnbmVkIGxvbmcgZGZuLAogICAg
dW5zaWduZWQgbG9uZyBvZmYsIHVuc2lnbmVkIGxvbmcgbGVuLAogICAgdm9pZCAqYnVmKTsK
IGxvbmcgc3lzX3BjaWNvbmZpZ193cml0ZSh1bnNpZ25lZCBsb25nIGJ1cywgdW5zaWduZWQg
bG9uZyBkZm4sCiAgICB1bnNpZ25lZCBsb25nIG9mZiwgdW5zaWduZWQgbG9uZyBsZW4sCiAg
ICB2b2lkICpidWYpOwogbG9uZyBzeXNfcGNpY29uZmlnX2lvYmFzZShsb25nIHdoaWNoLCB1
bnNpZ25lZCBsb25nIGJ1cywgdW5zaWduZWQgbG9uZyBkZXZmbik7CgoKIGxvbmcgc3lzX3Nw
dV9ydW4oaW50IGZkLCBfX3UzMiAqdW5wYywKICAgICBfX3UzMiAqdXN0YXR1cyk7CiBsb25n
IHN5c19zcHVfY3JlYXRlKGNvbnN0IGNoYXIgKm5hbWUsCiAgdW5zaWduZWQgaW50IGZsYWdz
LCB1bW9kZV90IG1vZGUsIGludCBmZCk7CiMgMTAzOCAiLi9pbmNsdWRlL2xpbnV4L3N5c2Nh
bGxzLmgiCiBsb25nIHN5c19vcGVuKGNvbnN0IGNoYXIgKmZpbGVuYW1lLAogICAgaW50IGZs
YWdzLCB1bW9kZV90IG1vZGUpOwogbG9uZyBzeXNfbGluayhjb25zdCBjaGFyICpvbGRuYW1l
LAogICAgY29uc3QgY2hhciAqbmV3bmFtZSk7CiBsb25nIHN5c191bmxpbmsoY29uc3QgY2hh
ciAqcGF0aG5hbWUpOwogbG9uZyBzeXNfbWtub2QoY29uc3QgY2hhciAqZmlsZW5hbWUsIHVt
b2RlX3QgbW9kZSwKICAgIHVuc2lnbmVkIGRldik7CiBsb25nIHN5c19jaG1vZChjb25zdCBj
aGFyICpmaWxlbmFtZSwgdW1vZGVfdCBtb2RlKTsKIGxvbmcgc3lzX2Nob3duKGNvbnN0IGNo
YXIgKmZpbGVuYW1lLAogICAgdWlkX3QgdXNlciwgZ2lkX3QgZ3JvdXApOwogbG9uZyBzeXNf
bWtkaXIoY29uc3QgY2hhciAqcGF0aG5hbWUsIHVtb2RlX3QgbW9kZSk7CiBsb25nIHN5c19y
bWRpcihjb25zdCBjaGFyICpwYXRobmFtZSk7CiBsb25nIHN5c19sY2hvd24oY29uc3QgY2hh
ciAqZmlsZW5hbWUsCiAgICB1aWRfdCB1c2VyLCBnaWRfdCBncm91cCk7CiBsb25nIHN5c19h
Y2Nlc3MoY29uc3QgY2hhciAqZmlsZW5hbWUsIGludCBtb2RlKTsKIGxvbmcgc3lzX3JlbmFt
ZShjb25zdCBjaGFyICpvbGRuYW1lLAogICAgY29uc3QgY2hhciAqbmV3bmFtZSk7CiBsb25n
IHN5c19zeW1saW5rKGNvbnN0IGNoYXIgKm9sZCwgY29uc3QgY2hhciAqbmV3KTsKCiBsb25n
IHN5c19zdGF0NjQoY29uc3QgY2hhciAqZmlsZW5hbWUsCiAgICBzdHJ1Y3Qgc3RhdDY0ICpz
dGF0YnVmKTsKIGxvbmcgc3lzX2xzdGF0NjQoY29uc3QgY2hhciAqZmlsZW5hbWUsCiAgICBz
dHJ1Y3Qgc3RhdDY0ICpzdGF0YnVmKTsKCgoKIGxvbmcgc3lzX3BpcGUoaW50ICpmaWxkZXMp
OwogbG9uZyBzeXNfZHVwMih1bnNpZ25lZCBpbnQgb2xkZmQsIHVuc2lnbmVkIGludCBuZXdm
ZCk7CiBsb25nIHN5c19lcG9sbF9jcmVhdGUoaW50IHNpemUpOwogbG9uZyBzeXNfaW5vdGlm
eV9pbml0KHZvaWQpOwogbG9uZyBzeXNfZXZlbnRmZCh1bnNpZ25lZCBpbnQgY291bnQpOwog
bG9uZyBzeXNfc2lnbmFsZmQoaW50IHVmZCwgc2lnc2V0X3QgKnVzZXJfbWFzaywgc2l6ZV90
IHNpemVtYXNrKTsKCgogbG9uZyBzeXNfc2VuZGZpbGUoaW50IG91dF9mZCwgaW50IGluX2Zk
LAogICAgICAgIG9mZl90ICpvZmZzZXQsIHNpemVfdCBjb3VudCk7CiBsb25nIHN5c19uZXdz
dGF0KGNvbnN0IGNoYXIgKmZpbGVuYW1lLAogICAgc3RydWN0IHN0YXQgKnN0YXRidWYpOwog
bG9uZyBzeXNfbmV3bHN0YXQoY29uc3QgY2hhciAqZmlsZW5hbWUsCiAgICBzdHJ1Y3Qgc3Rh
dCAqc3RhdGJ1Zik7CiBsb25nIHN5c19mYWR2aXNlNjQoaW50IGZkLCBsb2ZmX3Qgb2Zmc2V0
LCBzaXplX3QgbGVuLCBpbnQgYWR2aWNlKTsKCgogbG9uZyBzeXNfYWxhcm0odW5zaWduZWQg
aW50IHNlY29uZHMpOwogbG9uZyBzeXNfZ2V0cGdycCh2b2lkKTsKIGxvbmcgc3lzX3BhdXNl
KHZvaWQpOwogbG9uZyBzeXNfdGltZShfX2tlcm5lbF9vbGRfdGltZV90ICp0bG9jKTsKIGxv
bmcgc3lzX3RpbWUzMihvbGRfdGltZTMyX3QgKnRsb2MpOwoKIGxvbmcgc3lzX3V0aW1lKGNo
YXIgKmZpbGVuYW1lLAogICAgc3RydWN0IHV0aW1idWYgKnRpbWVzKTsKIGxvbmcgc3lzX3V0
aW1lcyhjaGFyICpmaWxlbmFtZSwKICAgIHN0cnVjdCBfX2tlcm5lbF9vbGRfdGltZXZhbCAq
dXRpbWVzKTsKIGxvbmcgc3lzX2Z1dGltZXNhdChpbnQgZGZkLCBjb25zdCBjaGFyICpmaWxl
bmFtZSwKICAgICAgICAgc3RydWN0IF9fa2VybmVsX29sZF90aW1ldmFsICp1dGltZXMpOwoK
IGxvbmcgc3lzX2Z1dGltZXNhdF90aW1lMzIodW5zaWduZWQgaW50IGRmZCwKICAgICAgICAg
Y29uc3QgY2hhciAqZmlsZW5hbWUsCiAgICAgICAgIHN0cnVjdCBvbGRfdGltZXZhbDMyICp0
KTsKIGxvbmcgc3lzX3V0aW1lMzIoY29uc3QgY2hhciAqZmlsZW5hbWUsCiAgICAgc3RydWN0
IG9sZF91dGltYnVmMzIgKnQpOwogbG9uZyBzeXNfdXRpbWVzX3RpbWUzMihjb25zdCBjaGFy
ICpmaWxlbmFtZSwKICAgICAgc3RydWN0IG9sZF90aW1ldmFsMzIgKnQpOwogbG9uZyBzeXNf
Y3JlYXQoY29uc3QgY2hhciAqcGF0aG5hbWUsIHVtb2RlX3QgbW9kZSk7CiBsb25nIHN5c19n
ZXRkZW50cyh1bnNpZ25lZCBpbnQgZmQsCiAgICBzdHJ1Y3QgbGludXhfZGlyZW50ICpkaXJl
bnQsCiAgICB1bnNpZ25lZCBpbnQgY291bnQpOwogbG9uZyBzeXNfc2VsZWN0KGludCBuLCBm
ZF9zZXQgKmlucCwgZmRfc2V0ICpvdXRwLAogICBmZF9zZXQgKmV4cCwgc3RydWN0IF9fa2Vy
bmVsX29sZF90aW1ldmFsICp0dnApOwogbG9uZyBzeXNfcG9sbChzdHJ1Y3QgcG9sbGZkICp1
ZmRzLCB1bnNpZ25lZCBpbnQgbmZkcywKICAgIGludCB0aW1lb3V0KTsKIGxvbmcgc3lzX2Vw
b2xsX3dhaXQoaW50IGVwZmQsIHN0cnVjdCBlcG9sbF9ldmVudCAqZXZlbnRzLAogICAgaW50
IG1heGV2ZW50cywgaW50IHRpbWVvdXQpOwogbG9uZyBzeXNfdXN0YXQodW5zaWduZWQgZGV2
LCBzdHJ1Y3QgdXN0YXQgKnVidWYpOwogbG9uZyBzeXNfdmZvcmsodm9pZCk7CiBsb25nIHN5
c19yZWN2KGludCwgdm9pZCAqLCBzaXplX3QsIHVuc2lnbmVkKTsKIGxvbmcgc3lzX3NlbmQo
aW50LCB2b2lkICosIHNpemVfdCwgdW5zaWduZWQpOwogbG9uZyBzeXNfYmRmbHVzaChpbnQg
ZnVuYywgbG9uZyBkYXRhKTsKIGxvbmcgc3lzX29sZHVtb3VudChjaGFyICpuYW1lKTsKIGxv
bmcgc3lzX3VzZWxpYihjb25zdCBjaGFyICpsaWJyYXJ5KTsKIGxvbmcgc3lzX3N5c2N0bChz
dHJ1Y3QgX19zeXNjdGxfYXJncyAqYXJncyk7CiBsb25nIHN5c19zeXNmcyhpbnQgb3B0aW9u
LAogICAgdW5zaWduZWQgbG9uZyBhcmcxLCB1bnNpZ25lZCBsb25nIGFyZzIpOwogbG9uZyBz
eXNfZm9yayh2b2lkKTsKCgogbG9uZyBzeXNfc3RpbWUoX19rZXJuZWxfb2xkX3RpbWVfdCAq
dHB0cik7CiBsb25nIHN5c19zdGltZTMyKG9sZF90aW1lMzJfdCAqdHB0cik7CgoKIGxvbmcg
c3lzX3NpZ3BlbmRpbmcob2xkX3NpZ3NldF90ICp1c2V0KTsKIGxvbmcgc3lzX3NpZ3Byb2Nt
YXNrKGludCBob3csIG9sZF9zaWdzZXRfdCAqc2V0LAogICAgb2xkX3NpZ3NldF90ICpvc2V0
KTsKCiBsb25nIHN5c19zaWdzdXNwZW5kKG9sZF9zaWdzZXRfdCBtYXNrKTsKIyAxMTQzICIu
L2luY2x1ZGUvbGludXgvc3lzY2FsbHMuaCIKIGxvbmcgc3lzX3NnZXRtYXNrKHZvaWQpOwog
bG9uZyBzeXNfc3NldG1hc2soaW50IG5ld21hc2spOwogbG9uZyBzeXNfc2lnbmFsKGludCBz
aWcsIF9fc2lnaGFuZGxlcl90IGhhbmRsZXIpOwoKCiBsb25nIHN5c19uaWNlKGludCBpbmNy
ZW1lbnQpOwoKCiBsb25nIHN5c19rZXhlY19maWxlX2xvYWQoaW50IGtlcm5lbF9mZCwgaW50
IGluaXRyZF9mZCwKICAgICAgICB1bnNpZ25lZCBsb25nIGNtZGxpbmVfbGVuLAogICAgICAg
IGNvbnN0IGNoYXIgKmNtZGxpbmVfcHRyLAogICAgICAgIHVuc2lnbmVkIGxvbmcgZmxhZ3Mp
OwoKCiBsb25nIHN5c193YWl0cGlkKHBpZF90IHBpZCwgaW50ICpzdGF0X2FkZHIsIGludCBv
cHRpb25zKTsKIyAxMTg3ICIuL2luY2x1ZGUvbGludXgvc3lzY2FsbHMuaCIKIGxvbmcgc3lz
X3NvY2tldGNhbGwoaW50IGNhbGwsIHVuc2lnbmVkIGxvbmcgKmFyZ3MpOwoKCiBsb25nIHN5
c19zdGF0KGNvbnN0IGNoYXIgKmZpbGVuYW1lLAogICBzdHJ1Y3QgX19vbGRfa2VybmVsX3N0
YXQgKnN0YXRidWYpOwogbG9uZyBzeXNfbHN0YXQoY29uc3QgY2hhciAqZmlsZW5hbWUsCiAg
IHN0cnVjdCBfX29sZF9rZXJuZWxfc3RhdCAqc3RhdGJ1Zik7CiBsb25nIHN5c19mc3RhdCh1
bnNpZ25lZCBpbnQgZmQsCiAgIHN0cnVjdCBfX29sZF9rZXJuZWxfc3RhdCAqc3RhdGJ1Zik7
CiBsb25nIHN5c19yZWFkbGluayhjb25zdCBjaGFyICpwYXRoLAogICAgY2hhciAqYnVmLCBp
bnQgYnVmc2l6KTsKCgogbG9uZyBzeXNfb2xkX3NlbGVjdChzdHJ1Y3Qgc2VsX2FyZ19zdHJ1
Y3QgKmFyZyk7CgoKIGxvbmcgc3lzX29sZF9yZWFkZGlyKHVuc2lnbmVkIGludCwgc3RydWN0
IG9sZF9saW51eF9kaXJlbnQgKiwgdW5zaWduZWQgaW50KTsKCgogbG9uZyBzeXNfZ2V0aG9z
dG5hbWUoY2hhciAqbmFtZSwgaW50IGxlbik7CiBsb25nIHN5c191bmFtZShzdHJ1Y3Qgb2xk
X3V0c25hbWUgKik7CiBsb25nIHN5c19vbGR1bmFtZShzdHJ1Y3Qgb2xkb2xkX3V0c25hbWUg
Kik7CgogbG9uZyBzeXNfb2xkX2dldHJsaW1pdCh1bnNpZ25lZCBpbnQgcmVzb3VyY2UsIHN0
cnVjdCBybGltaXQgKnJsaW0pOwoKCgogbG9uZyBzeXNfaXBjKHVuc2lnbmVkIGludCBjYWxs
LCBpbnQgZmlyc3QsIHVuc2lnbmVkIGxvbmcgc2Vjb25kLAogIHVuc2lnbmVkIGxvbmcgdGhp
cmQsIHZvaWQgKnB0ciwgbG9uZyBmaWZ0aCk7CgoKIGxvbmcgc3lzX21tYXBfcGdvZmYodW5z
aWduZWQgbG9uZyBhZGRyLCB1bnNpZ25lZCBsb25nIGxlbiwKICAgdW5zaWduZWQgbG9uZyBw
cm90LCB1bnNpZ25lZCBsb25nIGZsYWdzLAogICB1bnNpZ25lZCBsb25nIGZkLCB1bnNpZ25l
ZCBsb25nIHBnb2ZmKTsKIGxvbmcgc3lzX29sZF9tbWFwKHN0cnVjdCBtbWFwX2FyZ19zdHJ1
Y3QgKmFyZyk7CgoKCgoKCiBsb25nIHN5c19uaV9zeXNjYWxsKHZvaWQpOwojIDEyMzkgIi4v
aW5jbHVkZS9saW51eC9zeXNjYWxscy5oIgppbnQga3N5c191bW91bnQoY2hhciAqbmFtZSwg
aW50IGZsYWdzKTsKaW50IGtzeXNfZHVwKHVuc2lnbmVkIGludCBmaWxkZXMpOwppbnQga3N5
c19jaHJvb3QoY29uc3QgY2hhciAqZmlsZW5hbWUpOwpzc2l6ZV90IGtzeXNfd3JpdGUodW5z
aWduZWQgaW50IGZkLCBjb25zdCBjaGFyICpidWYsIHNpemVfdCBjb3VudCk7CmludCBrc3lz
X2NoZGlyKGNvbnN0IGNoYXIgKmZpbGVuYW1lKTsKaW50IGtzeXNfZmNobW9kKHVuc2lnbmVk
IGludCBmZCwgdW1vZGVfdCBtb2RlKTsKaW50IGtzeXNfZmNob3duKHVuc2lnbmVkIGludCBm
ZCwgdWlkX3QgdXNlciwgZ2lkX3QgZ3JvdXApOwppbnQga3N5c19nZXRkZW50czY0KHVuc2ln
bmVkIGludCBmZCwgc3RydWN0IGxpbnV4X2RpcmVudDY0ICpkaXJlbnQsCiAgICAgIHVuc2ln
bmVkIGludCBjb3VudCk7CmludCBrc3lzX2lvY3RsKHVuc2lnbmVkIGludCBmZCwgdW5zaWdu
ZWQgaW50IGNtZCwgdW5zaWduZWQgbG9uZyBhcmcpOwpvZmZfdCBrc3lzX2xzZWVrKHVuc2ln
bmVkIGludCBmZCwgb2ZmX3Qgb2Zmc2V0LCB1bnNpZ25lZCBpbnQgd2hlbmNlKTsKc3NpemVf
dCBrc3lzX3JlYWQodW5zaWduZWQgaW50IGZkLCBjaGFyICpidWYsIHNpemVfdCBjb3VudCk7
CnZvaWQga3N5c19zeW5jKHZvaWQpOwppbnQga3N5c191bnNoYXJlKHVuc2lnbmVkIGxvbmcg
dW5zaGFyZV9mbGFncyk7CmludCBrc3lzX3NldHNpZCh2b2lkKTsKaW50IGtzeXNfc3luY19m
aWxlX3JhbmdlKGludCBmZCwgbG9mZl90IG9mZnNldCwgbG9mZl90IG5ieXRlcywKICAgIHVu
c2lnbmVkIGludCBmbGFncyk7CnNzaXplX3Qga3N5c19wcmVhZDY0KHVuc2lnbmVkIGludCBm
ZCwgY2hhciAqYnVmLCBzaXplX3QgY291bnQsCiAgICAgICBsb2ZmX3QgcG9zKTsKc3NpemVf
dCBrc3lzX3B3cml0ZTY0KHVuc2lnbmVkIGludCBmZCwgY29uc3QgY2hhciAqYnVmLAogICAg
ICAgIHNpemVfdCBjb3VudCwgbG9mZl90IHBvcyk7CmludCBrc3lzX2ZhbGxvY2F0ZShpbnQg
ZmQsIGludCBtb2RlLCBsb2ZmX3Qgb2Zmc2V0LCBsb2ZmX3QgbGVuKTsKCmludCBrc3lzX2Zh
ZHZpc2U2NF82NChpbnQgZmQsIGxvZmZfdCBvZmZzZXQsIGxvZmZfdCBsZW4sIGludCBhZHZp
Y2UpOwoKCgoKCgoKdW5zaWduZWQgbG9uZyBrc3lzX21tYXBfcGdvZmYodW5zaWduZWQgbG9u
ZyBhZGRyLCB1bnNpZ25lZCBsb25nIGxlbiwKICAgICAgICAgdW5zaWduZWQgbG9uZyBwcm90
LCB1bnNpZ25lZCBsb25nIGZsYWdzLAogICAgICAgICB1bnNpZ25lZCBsb25nIGZkLCB1bnNp
Z25lZCBsb25nIHBnb2ZmKTsKc3NpemVfdCBrc3lzX3JlYWRhaGVhZChpbnQgZmQsIGxvZmZf
dCBvZmZzZXQsIHNpemVfdCBjb3VudCk7CmludCBrc3lzX2lwYyh1bnNpZ25lZCBpbnQgY2Fs
bCwgaW50IGZpcnN0LCB1bnNpZ25lZCBsb25nIHNlY29uZCwKIHVuc2lnbmVkIGxvbmcgdGhp
cmQsIHZvaWQgKiBwdHIsIGxvbmcgZmlmdGgpOwppbnQgY29tcGF0X2tzeXNfaXBjKHUzMiBj
YWxsLCBpbnQgZmlyc3QsIGludCBzZWNvbmQsCiB1MzIgdGhpcmQsIHUzMiBwdHIsIHUzMiBm
aWZ0aCk7CgoKCgoKZXh0ZXJuIGxvbmcgZG9fdW5saW5rYXQoaW50IGRmZCwgc3RydWN0IGZp
bGVuYW1lICpuYW1lKTsKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBsb25nIGtzeXNfdW5saW5rKGNvbnN0IGNoYXIg
KnBhdGhuYW1lKQp7CiByZXR1cm4gZG9fdW5saW5rYXQoLTEwMCwgZ2V0bmFtZShwYXRobmFt
ZSkpOwp9CgpleHRlcm4gbG9uZyBkb19ybWRpcihpbnQgZGZkLCBjb25zdCBjaGFyICpwYXRo
bmFtZSk7CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgbG9uZyBrc3lzX3JtZGlyKGNvbnN0IGNoYXIgKnBhdGhuYW1l
KQp7CiByZXR1cm4gZG9fcm1kaXIoLTEwMCwgcGF0aG5hbWUpOwp9CgpleHRlcm4gbG9uZyBk
b19ta2RpcmF0KGludCBkZmQsIGNvbnN0IGNoYXIgKnBhdGhuYW1lLCB1bW9kZV90IG1vZGUp
OwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIGxvbmcga3N5c19ta2Rpcihjb25zdCBjaGFyICpwYXRobmFtZSwgdW1v
ZGVfdCBtb2RlKQp7CiByZXR1cm4gZG9fbWtkaXJhdCgtMTAwLCBwYXRobmFtZSwgbW9kZSk7
Cn0KCmV4dGVybiBsb25nIGRvX3N5bWxpbmthdChjb25zdCBjaGFyICpvbGRuYW1lLCBpbnQg
bmV3ZGZkLAogICAgY29uc3QgY2hhciAqbmV3bmFtZSk7CgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgbG9uZyBrc3lz
X3N5bWxpbmsoY29uc3QgY2hhciAqb2xkbmFtZSwKICAgIGNvbnN0IGNoYXIgKm5ld25hbWUp
CnsKIHJldHVybiBkb19zeW1saW5rYXQob2xkbmFtZSwgLTEwMCwgbmV3bmFtZSk7Cn0KCmV4
dGVybiBsb25nIGRvX21rbm9kYXQoaW50IGRmZCwgY29uc3QgY2hhciAqZmlsZW5hbWUsIHVt
b2RlX3QgbW9kZSwKICAgICAgICAgdW5zaWduZWQgaW50IGRldik7CgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgbG9u
ZyBrc3lzX21rbm9kKGNvbnN0IGNoYXIgKmZpbGVuYW1lLCB1bW9kZV90IG1vZGUsCiAgICAg
ICAgIHVuc2lnbmVkIGludCBkZXYpCnsKIHJldHVybiBkb19ta25vZGF0KC0xMDAsIGZpbGVu
YW1lLCBtb2RlLCBkZXYpOwp9CgpleHRlcm4gaW50IGRvX2xpbmthdChpbnQgb2xkZGZkLCBj
b25zdCBjaGFyICpvbGRuYW1lLCBpbnQgbmV3ZGZkLAogICAgICAgY29uc3QgY2hhciAqbmV3
bmFtZSwgaW50IGZsYWdzKTsKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBsb25nIGtzeXNfbGluayhjb25zdCBjaGFy
ICpvbGRuYW1lLAogICAgICAgIGNvbnN0IGNoYXIgKm5ld25hbWUpCnsKIHJldHVybiBkb19s
aW5rYXQoLTEwMCwgb2xkbmFtZSwgLTEwMCwgbmV3bmFtZSwgMCk7Cn0KCmV4dGVybiBpbnQg
ZG9fZmNobW9kYXQoaW50IGRmZCwgY29uc3QgY2hhciAqZmlsZW5hbWUsIHVtb2RlX3QgbW9k
ZSk7CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgaW50IGtzeXNfY2htb2QoY29uc3QgY2hhciAqZmlsZW5hbWUsIHVt
b2RlX3QgbW9kZSkKewogcmV0dXJuIGRvX2ZjaG1vZGF0KC0xMDAsIGZpbGVuYW1lLCBtb2Rl
KTsKfQoKbG9uZyBkb19mYWNjZXNzYXQoaW50IGRmZCwgY29uc3QgY2hhciAqZmlsZW5hbWUs
IGludCBtb2RlLCBpbnQgZmxhZ3MpOwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGxvbmcga3N5c19hY2Nlc3MoY29u
c3QgY2hhciAqZmlsZW5hbWUsIGludCBtb2RlKQp7CiByZXR1cm4gZG9fZmFjY2Vzc2F0KC0x
MDAsIGZpbGVuYW1lLCBtb2RlLCAwKTsKfQoKZXh0ZXJuIGludCBkb19mY2hvd25hdChpbnQg
ZGZkLCBjb25zdCBjaGFyICpmaWxlbmFtZSwgdWlkX3QgdXNlciwKICAgICAgICAgZ2lkX3Qg
Z3JvdXAsIGludCBmbGFnKTsKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBsb25nIGtzeXNfY2hvd24oY29uc3QgY2hh
ciAqZmlsZW5hbWUsIHVpZF90IHVzZXIsCiAgICAgICAgIGdpZF90IGdyb3VwKQp7CiByZXR1
cm4gZG9fZmNob3duYXQoLTEwMCwgZmlsZW5hbWUsIHVzZXIsIGdyb3VwLCAwKTsKfQoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIGxvbmcga3N5c19sY2hvd24oY29uc3QgY2hhciAqZmlsZW5hbWUsIHVpZF90IHVz
ZXIsCiAgICAgICAgICBnaWRfdCBncm91cCkKewogcmV0dXJuIGRvX2ZjaG93bmF0KC0xMDAs
IGZpbGVuYW1lLCB1c2VyLCBncm91cCwKICAgICAgICAweDEwMCk7Cn0KCmV4dGVybiBsb25n
IGRvX3N5c19mdHJ1bmNhdGUodW5zaWduZWQgaW50IGZkLCBsb2ZmX3QgbGVuZ3RoLCBpbnQg
c21hbGwpOwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIGxvbmcga3N5c19mdHJ1bmNhdGUodW5zaWduZWQgaW50IGZk
LCBsb2ZmX3QgbGVuZ3RoKQp7CiByZXR1cm4gZG9fc3lzX2Z0cnVuY2F0ZShmZCwgbGVuZ3Ro
LCAxKTsKfQoKZXh0ZXJuIGludCBfX2Nsb3NlX2ZkKHN0cnVjdCBmaWxlc19zdHJ1Y3QgKmZp
bGVzLCB1bnNpZ25lZCBpbnQgZmQpOwoKCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGtzeXNfY2xvc2Uo
dW5zaWduZWQgaW50IGZkKQp7CiByZXR1cm4gX19jbG9zZV9mZChnZXRfY3VycmVudCgpLT5m
aWxlcywgZmQpOwp9CgpleHRlcm4gbG9uZyBkb19zeXNfb3BlbihpbnQgZGZkLCBjb25zdCBj
aGFyICpmaWxlbmFtZSwgaW50IGZsYWdzLAogICB1bW9kZV90IG1vZGUpOwoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IGxvbmcga3N5c19vcGVuKGNvbnN0IGNoYXIgKmZpbGVuYW1lLCBpbnQgZmxhZ3MsCiAgICAg
ICAgdW1vZGVfdCBtb2RlKQp7CiBpZiAoKCEwKSkKICBmbGFncyB8PSAwMjAwMDAwOwogcmV0
dXJuIGRvX3N5c19vcGVuKC0xMDAsIGZpbGVuYW1lLCBmbGFncywgbW9kZSk7Cn0KCmV4dGVy
biBsb25nIGRvX3N5c190cnVuY2F0ZShjb25zdCBjaGFyICpwYXRobmFtZSwgbG9mZl90IGxl
bmd0aCk7CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgbG9uZyBrc3lzX3RydW5jYXRlKGNvbnN0IGNoYXIgKnBhdGhu
YW1lLCBsb2ZmX3QgbGVuZ3RoKQp7CiByZXR1cm4gZG9fc3lzX3RydW5jYXRlKHBhdGhuYW1l
LCBsZW5ndGgpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgaW50IGtzeXNfcGVyc29uYWxpdHko
dW5zaWduZWQgaW50IHBlcnNvbmFsaXR5KQp7CiB1bnNpZ25lZCBpbnQgb2xkID0gZ2V0X2N1
cnJlbnQoKS0+cGVyc29uYWxpdHk7CgogaWYgKHBlcnNvbmFsaXR5ICE9IDB4ZmZmZmZmZmYp
CiAgKGdldF9jdXJyZW50KCktPnBlcnNvbmFsaXR5ID0gKHBlcnNvbmFsaXR5KSk7CgogcmV0
dXJuIG9sZDsKfQoKCmxvbmcga3N5c19zZW10aW1lZG9wKGludCBzZW1pZCwgc3RydWN0IHNl
bWJ1ZiAqdHNvcHMsCiAgICAgICB1bnNpZ25lZCBpbnQgbnNvcHMsCiAgICAgICBjb25zdCBz
dHJ1Y3QgX19rZXJuZWxfdGltZXNwZWMgKnRpbWVvdXQpOwpsb25nIGtzeXNfc2VtZ2V0KGtl
eV90IGtleSwgaW50IG5zZW1zLCBpbnQgc2VtZmxnKTsKbG9uZyBrc3lzX29sZF9zZW1jdGwo
aW50IHNlbWlkLCBpbnQgc2VtbnVtLCBpbnQgY21kLCB1bnNpZ25lZCBsb25nIGFyZyk7Cmxv
bmcga3N5c19tc2dnZXQoa2V5X3Qga2V5LCBpbnQgbXNnZmxnKTsKbG9uZyBrc3lzX29sZF9t
c2djdGwoaW50IG1zcWlkLCBpbnQgY21kLCBzdHJ1Y3QgbXNxaWRfZHMgKmJ1Zik7Cmxvbmcg
a3N5c19tc2dyY3YoaW50IG1zcWlkLCBzdHJ1Y3QgbXNnYnVmICptc2dwLCBzaXplX3QgbXNn
c3osCiAgIGxvbmcgbXNndHlwLCBpbnQgbXNnZmxnKTsKbG9uZyBrc3lzX21zZ3NuZChpbnQg
bXNxaWQsIHN0cnVjdCBtc2didWYgKm1zZ3AsIHNpemVfdCBtc2dzeiwKICAgaW50IG1zZ2Zs
Zyk7Cmxvbmcga3N5c19zaG1nZXQoa2V5X3Qga2V5LCBzaXplX3Qgc2l6ZSwgaW50IHNobWZs
Zyk7Cmxvbmcga3N5c19zaG1kdChjaGFyICpzaG1hZGRyKTsKbG9uZyBrc3lzX29sZF9zaG1j
dGwoaW50IHNobWlkLCBpbnQgY21kLCBzdHJ1Y3Qgc2htaWRfZHMgKmJ1Zik7CmxvbmcgY29t
cGF0X2tzeXNfc2VtdGltZWRvcChpbnQgc2VtaWQsIHN0cnVjdCBzZW1idWYgKnRzZW1zLAog
ICAgICAgdW5zaWduZWQgaW50IG5zb3BzLAogICAgICAgY29uc3Qgc3RydWN0IG9sZF90aW1l
c3BlYzMyICp0aW1lb3V0KTsKIyAyNyAiYXJjaC9wb3dlcnBjL2tlcm5lbC9zaWduYWxfMzIu
YyIgMgoKIyAxICIuL2luY2x1ZGUvbGludXgvY29tcGF0LmgiIDEKIyAxNSAiLi9pbmNsdWRl
L2xpbnV4L2NvbXBhdC5oIgojIDEgIi4vaW5jbHVkZS9saW51eC9zb2NrZXQuaCIgMQoKCgoK
CiMgMSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS91YXBpL2FzbS9zb2NrZXQuaCIgMQojIDE5
ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL3VhcGkvYXNtL3NvY2tldC5oIgojIDEgIi4vaW5j
bHVkZS91YXBpL2FzbS1nZW5lcmljL3NvY2tldC5oIiAxCgoKCgoKIyAxICIuL2FyY2gvcG93
ZXJwYy9pbmNsdWRlL2dlbmVyYXRlZC91YXBpL2FzbS9zb2NraW9zLmgiIDEKIyAxICIuL2lu
Y2x1ZGUvdWFwaS9hc20tZ2VuZXJpYy9zb2NraW9zLmgiIDEKIyAxICIuL2FyY2gvcG93ZXJw
Yy9pbmNsdWRlL2dlbmVyYXRlZC91YXBpL2FzbS9zb2NraW9zLmgiIDIKIyA3ICIuL2luY2x1
ZGUvdWFwaS9hc20tZ2VuZXJpYy9zb2NrZXQuaCIgMgojIDIwICIuL2FyY2gvcG93ZXJwYy9p
bmNsdWRlL3VhcGkvYXNtL3NvY2tldC5oIiAyCiMgNyAiLi9pbmNsdWRlL2xpbnV4L3NvY2tl
dC5oIiAyCiMgMSAiLi9pbmNsdWRlL3VhcGkvbGludXgvc29ja2lvcy5oIiAxCiMgMjMgIi4v
aW5jbHVkZS91YXBpL2xpbnV4L3NvY2tpb3MuaCIKIyAxICIuL2FyY2gvcG93ZXJwYy9pbmNs
dWRlL2dlbmVyYXRlZC91YXBpL2FzbS9zb2NraW9zLmgiIDEKIyAyNCAiLi9pbmNsdWRlL3Vh
cGkvbGludXgvc29ja2lvcy5oIiAyCiMgOCAiLi9pbmNsdWRlL2xpbnV4L3NvY2tldC5oIiAy
CiMgMSAiLi9pbmNsdWRlL2xpbnV4L3Vpby5oIiAxCiMgMTAgIi4vaW5jbHVkZS9saW51eC91
aW8uaCIKIyAxICIuL2luY2x1ZGUvY3J5cHRvL2hhc2guaCIgMQojIDExICIuL2luY2x1ZGUv
Y3J5cHRvL2hhc2guaCIKIyAxICIuL2luY2x1ZGUvbGludXgvY3J5cHRvLmgiIDEKIyAxMzEg
Ii4vaW5jbHVkZS9saW51eC9jcnlwdG8uaCIKc3RydWN0IHNjYXR0ZXJsaXN0OwpzdHJ1Y3Qg
Y3J5cHRvX2FzeW5jX3JlcXVlc3Q7CnN0cnVjdCBjcnlwdG9fdGZtOwpzdHJ1Y3QgY3J5cHRv
X3R5cGU7Cgp0eXBlZGVmIHZvaWQgKCpjcnlwdG9fY29tcGxldGlvbl90KShzdHJ1Y3QgY3J5
cHRvX2FzeW5jX3JlcXVlc3QgKnJlcSwgaW50IGVycik7CiMgMTQ1ICIuL2luY2x1ZGUvbGlu
dXgvY3J5cHRvLmgiCnN0cnVjdCBjcnlwdG9fYXN5bmNfcmVxdWVzdCB7CiBzdHJ1Y3QgbGlz
dF9oZWFkIGxpc3Q7CiBjcnlwdG9fY29tcGxldGlvbl90IGNvbXBsZXRlOwogdm9pZCAqZGF0
YTsKIHN0cnVjdCBjcnlwdG9fdGZtICp0Zm07CgogdTMyIGZsYWdzOwp9OwojIDIwOCAiLi9p
bmNsdWRlL2xpbnV4L2NyeXB0by5oIgpzdHJ1Y3QgY2lwaGVyX2FsZyB7CiB1bnNpZ25lZCBp
bnQgY2lhX21pbl9rZXlzaXplOwogdW5zaWduZWQgaW50IGNpYV9tYXhfa2V5c2l6ZTsKIGlu
dCAoKmNpYV9zZXRrZXkpKHN0cnVjdCBjcnlwdG9fdGZtICp0Zm0sIGNvbnN0IHU4ICprZXks
CiAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQga2V5bGVuKTsKIHZvaWQgKCpjaWFf
ZW5jcnlwdCkoc3RydWN0IGNyeXB0b190Zm0gKnRmbSwgdTggKmRzdCwgY29uc3QgdTggKnNy
Yyk7CiB2b2lkICgqY2lhX2RlY3J5cHQpKHN0cnVjdCBjcnlwdG9fdGZtICp0Zm0sIHU4ICpk
c3QsIGNvbnN0IHU4ICpzcmMpOwp9OwojIDIyOCAiLi9pbmNsdWRlL2xpbnV4L2NyeXB0by5o
IgpzdHJ1Y3QgY29tcHJlc3NfYWxnIHsKIGludCAoKmNvYV9jb21wcmVzcykoc3RydWN0IGNy
eXB0b190Zm0gKnRmbSwgY29uc3QgdTggKnNyYywKICAgICAgIHVuc2lnbmVkIGludCBzbGVu
LCB1OCAqZHN0LCB1bnNpZ25lZCBpbnQgKmRsZW4pOwogaW50ICgqY29hX2RlY29tcHJlc3Mp
KHN0cnVjdCBjcnlwdG9fdGZtICp0Zm0sIGNvbnN0IHU4ICpzcmMsCiAgICAgICAgIHVuc2ln
bmVkIGludCBzbGVuLCB1OCAqZHN0LCB1bnNpZ25lZCBpbnQgKmRsZW4pOwp9OwojIDQzNSAi
Li9pbmNsdWRlL2xpbnV4L2NyeXB0by5oIgpzdHJ1Y3QgY3J5cHRvX2FsZyB7CiBzdHJ1Y3Qg
bGlzdF9oZWFkIGNyYV9saXN0Owogc3RydWN0IGxpc3RfaGVhZCBjcmFfdXNlcnM7CgogdTMy
IGNyYV9mbGFnczsKIHVuc2lnbmVkIGludCBjcmFfYmxvY2tzaXplOwogdW5zaWduZWQgaW50
IGNyYV9jdHhzaXplOwogdW5zaWduZWQgaW50IGNyYV9hbGlnbm1hc2s7CgogaW50IGNyYV9w
cmlvcml0eTsKIHJlZmNvdW50X3QgY3JhX3JlZmNudDsKCiBjaGFyIGNyYV9uYW1lWzEyOF07
CiBjaGFyIGNyYV9kcml2ZXJfbmFtZVsxMjhdOwoKIGNvbnN0IHN0cnVjdCBjcnlwdG9fdHlw
ZSAqY3JhX3R5cGU7CgogdW5pb24gewogIHN0cnVjdCBjaXBoZXJfYWxnIGNpcGhlcjsKICBz
dHJ1Y3QgY29tcHJlc3NfYWxnIGNvbXByZXNzOwogfSBjcmFfdTsKCiBpbnQgKCpjcmFfaW5p
dCkoc3RydWN0IGNyeXB0b190Zm0gKnRmbSk7CiB2b2lkICgqY3JhX2V4aXQpKHN0cnVjdCBj
cnlwdG9fdGZtICp0Zm0pOwogdm9pZCAoKmNyYV9kZXN0cm95KShzdHJ1Y3QgY3J5cHRvX2Fs
ZyAqYWxnKTsKCiBzdHJ1Y3QgbW9kdWxlICpjcmFfbW9kdWxlOwojIDQ3NSAiLi9pbmNsdWRl
L2xpbnV4L2NyeXB0by5oIgp9IF9fYXR0cmlidXRlX18gKChfX2FsaWduZWRfXyhfX2FsaWdu
b2ZfXyh1bnNpZ25lZCBsb25nIGxvbmcpKSkpOwojIDQ5OCAiLi9pbmNsdWRlL2xpbnV4L2Ny
eXB0by5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBjcnlwdG9fc3RhdHNfaW5pdChzdHJ1Y3QgY3J5cHRv
X2FsZyAqYWxnKQp7fQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBjcnlwdG9fc3RhdHNfZ2V0KHN0cnVjdCBj
cnlwdG9fYWxnICphbGcpCnt9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGNyeXB0b19zdGF0c19hZWFkX2Vu
Y3J5cHQodW5zaWduZWQgaW50IGNyeXB0bGVuLCBzdHJ1Y3QgY3J5cHRvX2FsZyAqYWxnLCBp
bnQgcmV0KQp7fQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBjcnlwdG9fc3RhdHNfYWVhZF9kZWNyeXB0KHVu
c2lnbmVkIGludCBjcnlwdGxlbiwgc3RydWN0IGNyeXB0b19hbGcgKmFsZywgaW50IHJldCkK
e30Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIHZvaWQgY3J5cHRvX3N0YXRzX2FoYXNoX3VwZGF0ZSh1bnNpZ25lZCBp
bnQgbmJ5dGVzLCBpbnQgcmV0LCBzdHJ1Y3QgY3J5cHRvX2FsZyAqYWxnKQp7fQpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgdm9pZCBjcnlwdG9fc3RhdHNfYWhhc2hfZmluYWwodW5zaWduZWQgaW50IG5ieXRlcywg
aW50IHJldCwgc3RydWN0IGNyeXB0b19hbGcgKmFsZykKe30Kc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgY3J5
cHRvX3N0YXRzX2FrY2lwaGVyX2VuY3J5cHQodW5zaWduZWQgaW50IHNyY19sZW4sIGludCBy
ZXQsIHN0cnVjdCBjcnlwdG9fYWxnICphbGcpCnt9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19h
dHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGNyeXB0b19z
dGF0c19ha2NpcGhlcl9kZWNyeXB0KHVuc2lnbmVkIGludCBzcmNfbGVuLCBpbnQgcmV0LCBz
dHJ1Y3QgY3J5cHRvX2FsZyAqYWxnKQp7fQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBjcnlwdG9fc3RhdHNf
YWtjaXBoZXJfc2lnbihpbnQgcmV0LCBzdHJ1Y3QgY3J5cHRvX2FsZyAqYWxnKQp7fQpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgdm9pZCBjcnlwdG9fc3RhdHNfYWtjaXBoZXJfdmVyaWZ5KGludCByZXQsIHN0cnVj
dCBjcnlwdG9fYWxnICphbGcpCnt9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGNyeXB0b19zdGF0c19jb21w
cmVzcyh1bnNpZ25lZCBpbnQgc2xlbiwgaW50IHJldCwgc3RydWN0IGNyeXB0b19hbGcgKmFs
ZykKe30Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIHZvaWQgY3J5cHRvX3N0YXRzX2RlY29tcHJlc3ModW5zaWduZWQg
aW50IHNsZW4sIGludCByZXQsIHN0cnVjdCBjcnlwdG9fYWxnICphbGcpCnt9CnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSB2b2lkIGNyeXB0b19zdGF0c19rcHBfc2V0X3NlY3JldChzdHJ1Y3QgY3J5cHRvX2FsZyAq
YWxnLCBpbnQgcmV0KQp7fQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBjcnlwdG9fc3RhdHNfa3BwX2dlbmVy
YXRlX3B1YmxpY19rZXkoc3RydWN0IGNyeXB0b19hbGcgKmFsZywgaW50IHJldCkKe30Kc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIHZvaWQgY3J5cHRvX3N0YXRzX2twcF9jb21wdXRlX3NoYXJlZF9zZWNyZXQoc3Ry
dWN0IGNyeXB0b19hbGcgKmFsZywgaW50IHJldCkKe30Kc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgY3J5cHRv
X3N0YXRzX3JuZ19zZWVkKHN0cnVjdCBjcnlwdG9fYWxnICphbGcsIGludCByZXQpCnt9CnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSB2b2lkIGNyeXB0b19zdGF0c19ybmdfZ2VuZXJhdGUoc3RydWN0IGNyeXB0b19h
bGcgKmFsZywgdW5zaWduZWQgaW50IGRsZW4sIGludCByZXQpCnt9CnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lk
IGNyeXB0b19zdGF0c19za2NpcGhlcl9lbmNyeXB0KHVuc2lnbmVkIGludCBjcnlwdGxlbiwg
aW50IHJldCwgc3RydWN0IGNyeXB0b19hbGcgKmFsZykKe30Kc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgY3J5
cHRvX3N0YXRzX3NrY2lwaGVyX2RlY3J5cHQodW5zaWduZWQgaW50IGNyeXB0bGVuLCBpbnQg
cmV0LCBzdHJ1Y3QgY3J5cHRvX2FsZyAqYWxnKQp7fQoKCgoKc3RydWN0IGNyeXB0b193YWl0
IHsKIHN0cnVjdCBjb21wbGV0aW9uIGNvbXBsZXRpb247CiBpbnQgZXJyOwp9OwojIDU1NSAi
Li9pbmNsdWRlL2xpbnV4L2NyeXB0by5oIgp2b2lkIGNyeXB0b19yZXFfZG9uZShzdHJ1Y3Qg
Y3J5cHRvX2FzeW5jX3JlcXVlc3QgKnJlcSwgaW50IGVycik7CgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGNy
eXB0b193YWl0X3JlcShpbnQgZXJyLCBzdHJ1Y3QgY3J5cHRvX3dhaXQgKndhaXQpCnsKIHN3
aXRjaCAoZXJyKSB7CiBjYXNlIC0xMTU6CiBjYXNlIC0xNjoKICB3YWl0X2Zvcl9jb21wbGV0
aW9uKCZ3YWl0LT5jb21wbGV0aW9uKTsKICByZWluaXRfY29tcGxldGlvbigmd2FpdC0+Y29t
cGxldGlvbik7CiAgZXJyID0gd2FpdC0+ZXJyOwogIGJyZWFrOwogfQoKIHJldHVybiBlcnI7
Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSB2b2lkIGNyeXB0b19pbml0X3dhaXQoc3RydWN0IGNyeXB0b193YWl0
ICp3YWl0KQp7CiBfX2luaXRfY29tcGxldGlvbigmd2FpdC0+Y29tcGxldGlvbik7Cn0KCgoK
CmludCBjcnlwdG9fcmVnaXN0ZXJfYWxnKHN0cnVjdCBjcnlwdG9fYWxnICphbGcpOwp2b2lk
IGNyeXB0b191bnJlZ2lzdGVyX2FsZyhzdHJ1Y3QgY3J5cHRvX2FsZyAqYWxnKTsKaW50IGNy
eXB0b19yZWdpc3Rlcl9hbGdzKHN0cnVjdCBjcnlwdG9fYWxnICphbGdzLCBpbnQgY291bnQp
Owp2b2lkIGNyeXB0b191bnJlZ2lzdGVyX2FsZ3Moc3RydWN0IGNyeXB0b19hbGcgKmFsZ3Ms
IGludCBjb3VudCk7CgoKCgppbnQgY3J5cHRvX2hhc19hbGcoY29uc3QgY2hhciAqbmFtZSwg
dTMyIHR5cGUsIHUzMiBtYXNrKTsKCgoKCgoKCnN0cnVjdCBjcnlwdG9fdGZtIHsKCiB1MzIg
Y3J0X2ZsYWdzOwoKIHZvaWQgKCpleGl0KShzdHJ1Y3QgY3J5cHRvX3RmbSAqdGZtKTsKCiBz
dHJ1Y3QgY3J5cHRvX2FsZyAqX19jcnRfYWxnOwoKIHZvaWQgKl9fY3J0X2N0eFtdIF9fYXR0
cmlidXRlX18gKChfX2FsaWduZWRfXyhfX2FsaWdub2ZfXyh1bnNpZ25lZCBsb25nIGxvbmcp
KSkpOwp9OwoKc3RydWN0IGNyeXB0b19jaXBoZXIgewogc3RydWN0IGNyeXB0b190Zm0gYmFz
ZTsKfTsKCnN0cnVjdCBjcnlwdG9fY29tcCB7CiBzdHJ1Y3QgY3J5cHRvX3RmbSBiYXNlOwp9
OwoKZW51bSB7CiBDUllQVE9BX1VOU1BFQywKIENSWVBUT0FfQUxHLAogQ1JZUFRPQV9UWVBF
LAogQ1JZUFRPQV9VMzIsCiBfX0NSWVBUT0FfTUFYLAp9OwoKCgoKCgpzdHJ1Y3QgY3J5cHRv
X2F0dHJfYWxnIHsKIGNoYXIgbmFtZVsxMjhdOwp9OwoKc3RydWN0IGNyeXB0b19hdHRyX3R5
cGUgewogdTMyIHR5cGU7CiB1MzIgbWFzazsKfTsKCnN0cnVjdCBjcnlwdG9fYXR0cl91MzIg
ewogdTMyIG51bTsKfTsKCgoKCgpzdHJ1Y3QgY3J5cHRvX3RmbSAqY3J5cHRvX2FsbG9jX2Jh
c2UoY29uc3QgY2hhciAqYWxnX25hbWUsIHUzMiB0eXBlLCB1MzIgbWFzayk7CnZvaWQgY3J5
cHRvX2Rlc3Ryb3lfdGZtKHZvaWQgKm1lbSwgc3RydWN0IGNyeXB0b190Zm0gKnRmbSk7Cgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgdm9pZCBjcnlwdG9fZnJlZV90Zm0oc3RydWN0IGNyeXB0b190Zm0gKnRmbSkK
ewogcmV0dXJuIGNyeXB0b19kZXN0cm95X3RmbSh0Zm0sIHRmbSk7Cn0KCmludCBhbGdfdGVz
dChjb25zdCBjaGFyICpkcml2ZXIsIGNvbnN0IGNoYXIgKmFsZywgdTMyIHR5cGUsIHUzMiBt
YXNrKTsKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBjb25zdCBjaGFyICpjcnlwdG9fdGZtX2FsZ19uYW1lKHN0
cnVjdCBjcnlwdG9fdGZtICp0Zm0pCnsKIHJldHVybiB0Zm0tPl9fY3J0X2FsZy0+Y3JhX25h
bWU7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSBjb25zdCBjaGFyICpjcnlwdG9fdGZtX2FsZ19kcml2ZXJfbmFt
ZShzdHJ1Y3QgY3J5cHRvX3RmbSAqdGZtKQp7CiByZXR1cm4gdGZtLT5fX2NydF9hbGctPmNy
YV9kcml2ZXJfbmFtZTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBjcnlwdG9fdGZtX2FsZ19wcmlvcml0
eShzdHJ1Y3QgY3J5cHRvX3RmbSAqdGZtKQp7CiByZXR1cm4gdGZtLT5fX2NydF9hbGctPmNy
YV9wcmlvcml0eTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHUzMiBjcnlwdG9fdGZtX2FsZ190eXBlKHN0cnVj
dCBjcnlwdG9fdGZtICp0Zm0pCnsKIHJldHVybiB0Zm0tPl9fY3J0X2FsZy0+Y3JhX2ZsYWdz
ICYgMHgwMDAwMDAwZjsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHVuc2lnbmVkIGludCBjcnlwdG9fdGZtX2Fs
Z19ibG9ja3NpemUoc3RydWN0IGNyeXB0b190Zm0gKnRmbSkKewogcmV0dXJuIHRmbS0+X19j
cnRfYWxnLT5jcmFfYmxvY2tzaXplOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgaW50IGNyeXB0
b190Zm1fYWxnX2FsaWdubWFzayhzdHJ1Y3QgY3J5cHRvX3RmbSAqdGZtKQp7CiByZXR1cm4g
dGZtLT5fX2NydF9hbGctPmNyYV9hbGlnbm1hc2s7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1MzIgY3J5cHRv
X3RmbV9nZXRfZmxhZ3Moc3RydWN0IGNyeXB0b190Zm0gKnRmbSkKewogcmV0dXJuIHRmbS0+
Y3J0X2ZsYWdzOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBjcnlwdG9fdGZtX3NldF9mbGFncyhzdHJ1
Y3QgY3J5cHRvX3RmbSAqdGZtLCB1MzIgZmxhZ3MpCnsKIHRmbS0+Y3J0X2ZsYWdzIHw9IGZs
YWdzOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBjcnlwdG9fdGZtX2NsZWFyX2ZsYWdzKHN0cnVjdCBj
cnlwdG9fdGZtICp0Zm0sIHUzMiBmbGFncykKewogdGZtLT5jcnRfZmxhZ3MgJj0gfmZsYWdz
Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgdm9pZCAqY3J5cHRvX3RmbV9jdHgoc3RydWN0IGNyeXB0b190Zm0g
KnRmbSkKewogcmV0dXJuIHRmbS0+X19jcnRfY3R4Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQg
aW50IGNyeXB0b190Zm1fY3R4X2FsaWdubWVudCh2b2lkKQp7CiBzdHJ1Y3QgY3J5cHRvX3Rm
bSAqdGZtOwogcmV0dXJuIF9fYWxpZ25vZl9fKHRmbS0+X19jcnRfY3R4KTsKfQojIDczMCAi
Li9pbmNsdWRlL2xpbnV4L2NyeXB0by5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0IGNyeXB0b19jaXBo
ZXIgKl9fY3J5cHRvX2NpcGhlcl9jYXN0KHN0cnVjdCBjcnlwdG9fdGZtICp0Zm0pCnsKIHJl
dHVybiAoc3RydWN0IGNyeXB0b19jaXBoZXIgKil0Zm07Cn0KIyA3NDkgIi4vaW5jbHVkZS9s
aW51eC9jcnlwdG8uaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHN0cnVjdCBjcnlwdG9fY2lwaGVyICpjcnlwdG9f
YWxsb2NfY2lwaGVyKGNvbnN0IGNoYXIgKmFsZ19uYW1lLAogICAgICAgdTMyIHR5cGUsIHUz
MiBtYXNrKQp7CiB0eXBlICY9IH4weDAwMDAwMDBmOwogdHlwZSB8PSAweDAwMDAwMDAxOwog
bWFzayB8PSAweDAwMDAwMDBmOwoKIHJldHVybiBfX2NyeXB0b19jaXBoZXJfY2FzdChjcnlw
dG9fYWxsb2NfYmFzZShhbGdfbmFtZSwgdHlwZSwgbWFzaykpOwp9CgpzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3Ry
dWN0IGNyeXB0b190Zm0gKmNyeXB0b19jaXBoZXJfdGZtKHN0cnVjdCBjcnlwdG9fY2lwaGVy
ICp0Zm0pCnsKIHJldHVybiAmdGZtLT5iYXNlOwp9CgoKCgoKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgY3J5
cHRvX2ZyZWVfY2lwaGVyKHN0cnVjdCBjcnlwdG9fY2lwaGVyICp0Zm0pCnsKIGNyeXB0b19m
cmVlX3RmbShjcnlwdG9fY2lwaGVyX3RmbSh0Zm0pKTsKfQojIDc4MyAiLi9pbmNsdWRlL2xp
bnV4L2NyeXB0by5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGNyeXB0b19oYXNfY2lwaGVyKGNvbnN0IGNo
YXIgKmFsZ19uYW1lLCB1MzIgdHlwZSwgdTMyIG1hc2spCnsKIHR5cGUgJj0gfjB4MDAwMDAw
MGY7CiB0eXBlIHw9IDB4MDAwMDAwMDE7CiBtYXNrIHw9IDB4MDAwMDAwMGY7CgogcmV0dXJu
IGNyeXB0b19oYXNfYWxnKGFsZ19uYW1lLCB0eXBlLCBtYXNrKTsKfQojIDgwMiAiLi9pbmNs
dWRlL2xpbnV4L2NyeXB0by5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgaW50IGNyeXB0b19jaXBo
ZXJfYmxvY2tzaXplKHN0cnVjdCBjcnlwdG9fY2lwaGVyICp0Zm0pCnsKIHJldHVybiBjcnlw
dG9fdGZtX2FsZ19ibG9ja3NpemUoY3J5cHRvX2NpcGhlcl90Zm0odGZtKSk7Cn0KCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSB1bnNpZ25lZCBpbnQgY3J5cHRvX2NpcGhlcl9hbGlnbm1hc2soc3RydWN0IGNyeXB0
b19jaXBoZXIgKnRmbSkKewogcmV0dXJuIGNyeXB0b190Zm1fYWxnX2FsaWdubWFzayhjcnlw
dG9fY2lwaGVyX3RmbSh0Zm0pKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHUzMiBjcnlwdG9fY2lwaGVyX2dl
dF9mbGFncyhzdHJ1Y3QgY3J5cHRvX2NpcGhlciAqdGZtKQp7CiByZXR1cm4gY3J5cHRvX3Rm
bV9nZXRfZmxhZ3MoY3J5cHRvX2NpcGhlcl90Zm0odGZtKSk7Cn0KCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lk
IGNyeXB0b19jaXBoZXJfc2V0X2ZsYWdzKHN0cnVjdCBjcnlwdG9fY2lwaGVyICp0Zm0sCiAg
ICAgICAgdTMyIGZsYWdzKQp7CiBjcnlwdG9fdGZtX3NldF9mbGFncyhjcnlwdG9fY2lwaGVy
X3RmbSh0Zm0pLCBmbGFncyk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGNyeXB0b19jaXBoZXJfY2xl
YXJfZmxhZ3Moc3RydWN0IGNyeXB0b19jaXBoZXIgKnRmbSwKICAgICAgICAgIHUzMiBmbGFn
cykKewogY3J5cHRvX3RmbV9jbGVhcl9mbGFncyhjcnlwdG9fY2lwaGVyX3RmbSh0Zm0pLCBm
bGFncyk7Cn0KIyA4NDUgIi4vaW5jbHVkZS9saW51eC9jcnlwdG8uaCIKaW50IGNyeXB0b19j
aXBoZXJfc2V0a2V5KHN0cnVjdCBjcnlwdG9fY2lwaGVyICp0Zm0sCiAgICBjb25zdCB1OCAq
a2V5LCB1bnNpZ25lZCBpbnQga2V5bGVuKTsKIyA4NTcgIi4vaW5jbHVkZS9saW51eC9jcnlw
dG8uaCIKdm9pZCBjcnlwdG9fY2lwaGVyX2VuY3J5cHRfb25lKHN0cnVjdCBjcnlwdG9fY2lw
aGVyICp0Zm0sCiAgICAgICAgICB1OCAqZHN0LCBjb25zdCB1OCAqc3JjKTsKIyA4NjkgIi4v
aW5jbHVkZS9saW51eC9jcnlwdG8uaCIKdm9pZCBjcnlwdG9fY2lwaGVyX2RlY3J5cHRfb25l
KHN0cnVjdCBjcnlwdG9fY2lwaGVyICp0Zm0sCiAgICAgICAgICB1OCAqZHN0LCBjb25zdCB1
OCAqc3JjKTsKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3QgY3J5cHRvX2NvbXAgKl9fY3J5cHRvX2NvbXBf
Y2FzdChzdHJ1Y3QgY3J5cHRvX3RmbSAqdGZtKQp7CiByZXR1cm4gKHN0cnVjdCBjcnlwdG9f
Y29tcCAqKXRmbTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHN0cnVjdCBjcnlwdG9fY29tcCAqY3J5cHRvX2Fs
bG9jX2NvbXAoY29uc3QgY2hhciAqYWxnX25hbWUsCiAgICAgICAgICB1MzIgdHlwZSwgdTMy
IG1hc2spCnsKIHR5cGUgJj0gfjB4MDAwMDAwMGY7CiB0eXBlIHw9IDB4MDAwMDAwMDI7CiBt
YXNrIHw9IDB4MDAwMDAwMGY7CgogcmV0dXJuIF9fY3J5cHRvX2NvbXBfY2FzdChjcnlwdG9f
YWxsb2NfYmFzZShhbGdfbmFtZSwgdHlwZSwgbWFzaykpOwp9CgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgc3RydWN0
IGNyeXB0b190Zm0gKmNyeXB0b19jb21wX3RmbShzdHJ1Y3QgY3J5cHRvX2NvbXAgKnRmbSkK
ewogcmV0dXJuICZ0Zm0tPmJhc2U7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGNyeXB0b19mcmVlX2Nv
bXAoc3RydWN0IGNyeXB0b19jb21wICp0Zm0pCnsKIGNyeXB0b19mcmVlX3RmbShjcnlwdG9f
Y29tcF90Zm0odGZtKSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgY3J5cHRvX2hhc19jb21wKGNvbnN0
IGNoYXIgKmFsZ19uYW1lLCB1MzIgdHlwZSwgdTMyIG1hc2spCnsKIHR5cGUgJj0gfjB4MDAw
MDAwMGY7CiB0eXBlIHw9IDB4MDAwMDAwMDI7CiBtYXNrIHw9IDB4MDAwMDAwMGY7CgogcmV0
dXJuIGNyeXB0b19oYXNfYWxnKGFsZ19uYW1lLCB0eXBlLCBtYXNrKTsKfQoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IGNvbnN0IGNoYXIgKmNyeXB0b19jb21wX25hbWUoc3RydWN0IGNyeXB0b19jb21wICp0Zm0p
CnsKIHJldHVybiBjcnlwdG9fdGZtX2FsZ19uYW1lKGNyeXB0b19jb21wX3RmbSh0Zm0pKTsK
fQoKaW50IGNyeXB0b19jb21wX2NvbXByZXNzKHN0cnVjdCBjcnlwdG9fY29tcCAqdGZtLAog
ICAgY29uc3QgdTggKnNyYywgdW5zaWduZWQgaW50IHNsZW4sCiAgICB1OCAqZHN0LCB1bnNp
Z25lZCBpbnQgKmRsZW4pOwoKaW50IGNyeXB0b19jb21wX2RlY29tcHJlc3Moc3RydWN0IGNy
eXB0b19jb21wICp0Zm0sCiAgICAgIGNvbnN0IHU4ICpzcmMsIHVuc2lnbmVkIGludCBzbGVu
LAogICAgICB1OCAqZHN0LCB1bnNpZ25lZCBpbnQgKmRsZW4pOwojIDEyICIuL2luY2x1ZGUv
Y3J5cHRvL2hhc2guaCIgMgoKCnN0cnVjdCBjcnlwdG9fYWhhc2g7CiMgNDIgIi4vaW5jbHVk
ZS9jcnlwdG8vaGFzaC5oIgpzdHJ1Y3QgaGFzaF9hbGdfY29tbW9uIHsKIHVuc2lnbmVkIGlu
dCBkaWdlc3RzaXplOwogdW5zaWduZWQgaW50IHN0YXRlc2l6ZTsKCiBzdHJ1Y3QgY3J5cHRv
X2FsZyBiYXNlOwp9OwoKc3RydWN0IGFoYXNoX3JlcXVlc3Qgewogc3RydWN0IGNyeXB0b19h
c3luY19yZXF1ZXN0IGJhc2U7CgogdW5zaWduZWQgaW50IG5ieXRlczsKIHN0cnVjdCBzY2F0
dGVybGlzdCAqc3JjOwogdTggKnJlc3VsdDsKCgogdm9pZCAqcHJpdjsKCiB2b2lkICpfX2N0
eFtdIF9fYXR0cmlidXRlX18gKChfX2FsaWduZWRfXyhfX2FsaWdub2ZfXyh1bnNpZ25lZCBs
b25nIGxvbmcpKSkpOwp9OwojIDEyOCAiLi9pbmNsdWRlL2NyeXB0by9oYXNoLmgiCnN0cnVj
dCBhaGFzaF9hbGcgewogaW50ICgqaW5pdCkoc3RydWN0IGFoYXNoX3JlcXVlc3QgKnJlcSk7
CiBpbnQgKCp1cGRhdGUpKHN0cnVjdCBhaGFzaF9yZXF1ZXN0ICpyZXEpOwogaW50ICgqZmlu
YWwpKHN0cnVjdCBhaGFzaF9yZXF1ZXN0ICpyZXEpOwogaW50ICgqZmludXApKHN0cnVjdCBh
aGFzaF9yZXF1ZXN0ICpyZXEpOwogaW50ICgqZGlnZXN0KShzdHJ1Y3QgYWhhc2hfcmVxdWVz
dCAqcmVxKTsKIGludCAoKmV4cG9ydCkoc3RydWN0IGFoYXNoX3JlcXVlc3QgKnJlcSwgdm9p
ZCAqb3V0KTsKIGludCAoKmltcG9ydCkoc3RydWN0IGFoYXNoX3JlcXVlc3QgKnJlcSwgY29u
c3Qgdm9pZCAqaW4pOwogaW50ICgqc2V0a2V5KShzdHJ1Y3QgY3J5cHRvX2FoYXNoICp0Zm0s
IGNvbnN0IHU4ICprZXksCiAgICAgICAgdW5zaWduZWQgaW50IGtleWxlbik7Cgogc3RydWN0
IGhhc2hfYWxnX2NvbW1vbiBoYWxnOwp9OwoKc3RydWN0IHNoYXNoX2Rlc2Mgewogc3RydWN0
IGNyeXB0b19zaGFzaCAqdGZtOwogdm9pZCAqX19jdHhbXSBfX2F0dHJpYnV0ZV9fICgoX19h
bGlnbmVkX18oX19hbGlnbm9mX18odW5zaWduZWQgbG9uZyBsb25nKSkpKTsKfTsKIyAxOTAg
Ii4vaW5jbHVkZS9jcnlwdG8vaGFzaC5oIgpzdHJ1Y3Qgc2hhc2hfYWxnIHsKIGludCAoKmlu
aXQpKHN0cnVjdCBzaGFzaF9kZXNjICpkZXNjKTsKIGludCAoKnVwZGF0ZSkoc3RydWN0IHNo
YXNoX2Rlc2MgKmRlc2MsIGNvbnN0IHU4ICpkYXRhLAogICAgICAgIHVuc2lnbmVkIGludCBs
ZW4pOwogaW50ICgqZmluYWwpKHN0cnVjdCBzaGFzaF9kZXNjICpkZXNjLCB1OCAqb3V0KTsK
IGludCAoKmZpbnVwKShzdHJ1Y3Qgc2hhc2hfZGVzYyAqZGVzYywgY29uc3QgdTggKmRhdGEs
CiAgICAgICB1bnNpZ25lZCBpbnQgbGVuLCB1OCAqb3V0KTsKIGludCAoKmRpZ2VzdCkoc3Ry
dWN0IHNoYXNoX2Rlc2MgKmRlc2MsIGNvbnN0IHU4ICpkYXRhLAogICAgICAgIHVuc2lnbmVk
IGludCBsZW4sIHU4ICpvdXQpOwogaW50ICgqZXhwb3J0KShzdHJ1Y3Qgc2hhc2hfZGVzYyAq
ZGVzYywgdm9pZCAqb3V0KTsKIGludCAoKmltcG9ydCkoc3RydWN0IHNoYXNoX2Rlc2MgKmRl
c2MsIGNvbnN0IHZvaWQgKmluKTsKIGludCAoKnNldGtleSkoc3RydWN0IGNyeXB0b19zaGFz
aCAqdGZtLCBjb25zdCB1OCAqa2V5LAogICAgICAgIHVuc2lnbmVkIGludCBrZXlsZW4pOwog
aW50ICgqaW5pdF90Zm0pKHN0cnVjdCBjcnlwdG9fc2hhc2ggKnRmbSk7CiB2b2lkICgqZXhp
dF90Zm0pKHN0cnVjdCBjcnlwdG9fc2hhc2ggKnRmbSk7CgogdW5zaWduZWQgaW50IGRlc2Nz
aXplOwoKCiB1bnNpZ25lZCBpbnQgZGlnZXN0c2l6ZQogIF9fYXR0cmlidXRlX18gKChhbGln
bmVkKF9fYWxpZ25vZl9fKHN0cnVjdCBoYXNoX2FsZ19jb21tb24pKSkpOwogdW5zaWduZWQg
aW50IHN0YXRlc2l6ZTsKCiBzdHJ1Y3QgY3J5cHRvX2FsZyBiYXNlOwp9OwoKc3RydWN0IGNy
eXB0b19haGFzaCB7CiBpbnQgKCppbml0KShzdHJ1Y3QgYWhhc2hfcmVxdWVzdCAqcmVxKTsK
IGludCAoKnVwZGF0ZSkoc3RydWN0IGFoYXNoX3JlcXVlc3QgKnJlcSk7CiBpbnQgKCpmaW5h
bCkoc3RydWN0IGFoYXNoX3JlcXVlc3QgKnJlcSk7CiBpbnQgKCpmaW51cCkoc3RydWN0IGFo
YXNoX3JlcXVlc3QgKnJlcSk7CiBpbnQgKCpkaWdlc3QpKHN0cnVjdCBhaGFzaF9yZXF1ZXN0
ICpyZXEpOwogaW50ICgqZXhwb3J0KShzdHJ1Y3QgYWhhc2hfcmVxdWVzdCAqcmVxLCB2b2lk
ICpvdXQpOwogaW50ICgqaW1wb3J0KShzdHJ1Y3QgYWhhc2hfcmVxdWVzdCAqcmVxLCBjb25z
dCB2b2lkICppbik7CiBpbnQgKCpzZXRrZXkpKHN0cnVjdCBjcnlwdG9fYWhhc2ggKnRmbSwg
Y29uc3QgdTggKmtleSwKICAgICAgICB1bnNpZ25lZCBpbnQga2V5bGVuKTsKCiB1bnNpZ25l
ZCBpbnQgcmVxc2l6ZTsKIHN0cnVjdCBjcnlwdG9fdGZtIGJhc2U7Cn07CgpzdHJ1Y3QgY3J5
cHRvX3NoYXNoIHsKIHVuc2lnbmVkIGludCBkZXNjc2l6ZTsKIHN0cnVjdCBjcnlwdG9fdGZt
IGJhc2U7Cn07CiMgMjQ2ICIuL2luY2x1ZGUvY3J5cHRvL2hhc2guaCIKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHN0
cnVjdCBjcnlwdG9fYWhhc2ggKl9fY3J5cHRvX2FoYXNoX2Nhc3Qoc3RydWN0IGNyeXB0b190
Zm0gKnRmbSkKewogcmV0dXJuICh7IHZvaWQgKl9fbXB0ciA9ICh2b2lkICopKHRmbSk7IGRv
IHsgZXh0ZXJuIHZvaWQgX19jb21waWxldGltZV9hc3NlcnRfMjEyKHZvaWQpIF9fYXR0cmli
dXRlX18oKF9fZXJyb3JfXygicG9pbnRlciB0eXBlIG1pc21hdGNoIGluIGNvbnRhaW5lcl9v
ZigpIikpKTsgaWYgKCEoISghX19idWlsdGluX3R5cGVzX2NvbXBhdGlibGVfcCh0eXBlb2Yo
Kih0Zm0pKSwgdHlwZW9mKCgoc3RydWN0IGNyeXB0b19haGFzaCAqKTApLT5iYXNlKSkgJiYg
IV9fYnVpbHRpbl90eXBlc19jb21wYXRpYmxlX3AodHlwZW9mKCoodGZtKSksIHR5cGVvZih2
b2lkKSkpKSkgX19jb21waWxldGltZV9hc3NlcnRfMjEyKCk7IH0gd2hpbGUgKDApOyAoKHN0
cnVjdCBjcnlwdG9fYWhhc2ggKikoX19tcHRyIC0gX19idWlsdGluX29mZnNldG9mKHN0cnVj
dCBjcnlwdG9fYWhhc2gsIGJhc2UpKSk7IH0pOwp9CiMgMjY1ICIuL2luY2x1ZGUvY3J5cHRv
L2hhc2guaCIKc3RydWN0IGNyeXB0b19haGFzaCAqY3J5cHRvX2FsbG9jX2FoYXNoKGNvbnN0
IGNoYXIgKmFsZ19uYW1lLCB1MzIgdHlwZSwKICAgICB1MzIgbWFzayk7CgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
c3RydWN0IGNyeXB0b190Zm0gKmNyeXB0b19haGFzaF90Zm0oc3RydWN0IGNyeXB0b19haGFz
aCAqdGZtKQp7CiByZXR1cm4gJnRmbS0+YmFzZTsKfQoKCgoKCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGNy
eXB0b19mcmVlX2FoYXNoKHN0cnVjdCBjcnlwdG9fYWhhc2ggKnRmbSkKewogY3J5cHRvX2Rl
c3Ryb3lfdGZtKHRmbSwgY3J5cHRvX2FoYXNoX3RmbSh0Zm0pKTsKfQojIDI5MiAiLi9pbmNs
dWRlL2NyeXB0by9oYXNoLmgiCmludCBjcnlwdG9faGFzX2FoYXNoKGNvbnN0IGNoYXIgKmFs
Z19uYW1lLCB1MzIgdHlwZSwgdTMyIG1hc2spOwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGNvbnN0IGNoYXIgKmNy
eXB0b19haGFzaF9hbGdfbmFtZShzdHJ1Y3QgY3J5cHRvX2FoYXNoICp0Zm0pCnsKIHJldHVy
biBjcnlwdG9fdGZtX2FsZ19uYW1lKGNyeXB0b19haGFzaF90Zm0odGZtKSk7Cn0KCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBjb25zdCBjaGFyICpjcnlwdG9fYWhhc2hfZHJpdmVyX25hbWUoc3RydWN0IGNyeXB0
b19haGFzaCAqdGZtKQp7CiByZXR1cm4gY3J5cHRvX3RmbV9hbGdfZHJpdmVyX25hbWUoY3J5
cHRvX2FoYXNoX3RmbSh0Zm0pKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHVuc2lnbmVkIGludCBjcnlwdG9f
YWhhc2hfYWxpZ25tYXNrKAogc3RydWN0IGNyeXB0b19haGFzaCAqdGZtKQp7CiByZXR1cm4g
Y3J5cHRvX3RmbV9hbGdfYWxpZ25tYXNrKGNyeXB0b19haGFzaF90Zm0odGZtKSk7Cn0KIyAz
MTkgIi4vaW5jbHVkZS9jcnlwdG8vaGFzaC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgaW50IGNy
eXB0b19haGFzaF9ibG9ja3NpemUoc3RydWN0IGNyeXB0b19haGFzaCAqdGZtKQp7CiByZXR1
cm4gY3J5cHRvX3RmbV9hbGdfYmxvY2tzaXplKGNyeXB0b19haGFzaF90Zm0odGZtKSk7Cn0K
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSBzdHJ1Y3QgaGFzaF9hbGdfY29tbW9uICpfX2NyeXB0b19oYXNoX2FsZ19j
b21tb24oCiBzdHJ1Y3QgY3J5cHRvX2FsZyAqYWxnKQp7CiByZXR1cm4gKHsgdm9pZCAqX19t
cHRyID0gKHZvaWQgKikoYWxnKTsgZG8geyBleHRlcm4gdm9pZCBfX2NvbXBpbGV0aW1lX2Fz
c2VydF8yMTModm9pZCkgX19hdHRyaWJ1dGVfXygoX19lcnJvcl9fKCJwb2ludGVyIHR5cGUg
bWlzbWF0Y2ggaW4gY29udGFpbmVyX29mKCkiKSkpOyBpZiAoISghKCFfX2J1aWx0aW5fdHlw
ZXNfY29tcGF0aWJsZV9wKHR5cGVvZigqKGFsZykpLCB0eXBlb2YoKChzdHJ1Y3QgaGFzaF9h
bGdfY29tbW9uICopMCktPmJhc2UpKSAmJiAhX19idWlsdGluX3R5cGVzX2NvbXBhdGlibGVf
cCh0eXBlb2YoKihhbGcpKSwgdHlwZW9mKHZvaWQpKSkpKSBfX2NvbXBpbGV0aW1lX2Fzc2Vy
dF8yMTMoKTsgfSB3aGlsZSAoMCk7ICgoc3RydWN0IGhhc2hfYWxnX2NvbW1vbiAqKShfX21w
dHIgLSBfX2J1aWx0aW5fb2Zmc2V0b2Yoc3RydWN0IGhhc2hfYWxnX2NvbW1vbiwgYmFzZSkp
KTsgfSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3QgaGFzaF9hbGdfY29tbW9uICpjcnlwdG9faGFz
aF9hbGdfY29tbW9uKAogc3RydWN0IGNyeXB0b19haGFzaCAqdGZtKQp7CiByZXR1cm4gX19j
cnlwdG9faGFzaF9hbGdfY29tbW9uKGNyeXB0b19haGFzaF90Zm0odGZtKS0+X19jcnRfYWxn
KTsKfQojIDM0NiAiLi9pbmNsdWRlL2NyeXB0by9oYXNoLmgiCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1bnNpZ25l
ZCBpbnQgY3J5cHRvX2FoYXNoX2RpZ2VzdHNpemUoc3RydWN0IGNyeXB0b19haGFzaCAqdGZt
KQp7CiByZXR1cm4gY3J5cHRvX2hhc2hfYWxnX2NvbW1vbih0Zm0pLT5kaWdlc3RzaXplOwp9
CiMgMzYxICIuL2luY2x1ZGUvY3J5cHRvL2hhc2guaCIKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHVuc2lnbmVkIGlu
dCBjcnlwdG9fYWhhc2hfc3RhdGVzaXplKHN0cnVjdCBjcnlwdG9fYWhhc2ggKnRmbSkKewog
cmV0dXJuIGNyeXB0b19oYXNoX2FsZ19jb21tb24odGZtKS0+c3RhdGVzaXplOwp9CgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgdTMyIGNyeXB0b19haGFzaF9nZXRfZmxhZ3Moc3RydWN0IGNyeXB0b19haGFzaCAq
dGZtKQp7CiByZXR1cm4gY3J5cHRvX3RmbV9nZXRfZmxhZ3MoY3J5cHRvX2FoYXNoX3RmbSh0
Zm0pKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgY3J5cHRvX2FoYXNoX3NldF9mbGFncyhzdHJ1Y3Qg
Y3J5cHRvX2FoYXNoICp0Zm0sIHUzMiBmbGFncykKewogY3J5cHRvX3RmbV9zZXRfZmxhZ3Mo
Y3J5cHRvX2FoYXNoX3RmbSh0Zm0pLCBmbGFncyk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRy
aWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkg
X19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGNyeXB0
b19haGFzaF9jbGVhcl9mbGFncyhzdHJ1Y3QgY3J5cHRvX2FoYXNoICp0Zm0sIHUzMiBmbGFn
cykKewogY3J5cHRvX3RmbV9jbGVhcl9mbGFncyhjcnlwdG9fYWhhc2hfdGZtKHRmbSksIGZs
YWdzKTsKfQojIDM5MSAiLi9pbmNsdWRlL2NyeXB0by9oYXNoLmgiCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1
Y3QgY3J5cHRvX2FoYXNoICpjcnlwdG9fYWhhc2hfcmVxdGZtKAogc3RydWN0IGFoYXNoX3Jl
cXVlc3QgKnJlcSkKewogcmV0dXJuIF9fY3J5cHRvX2FoYXNoX2Nhc3QocmVxLT5iYXNlLnRm
bSk7Cn0KCgoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1bnNpZ25lZCBpbnQgY3J5cHRvX2FoYXNoX3JlcXNp
emUoc3RydWN0IGNyeXB0b19haGFzaCAqdGZtKQp7CiByZXR1cm4gdGZtLT5yZXFzaXplOwp9
CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9m
dW5jdGlvbl9fKSkgdm9pZCAqYWhhc2hfcmVxdWVzdF9jdHgoc3RydWN0IGFoYXNoX3JlcXVl
c3QgKnJlcSkKewogcmV0dXJuIHJlcS0+X19jdHg7Cn0KIyA0MjQgIi4vaW5jbHVkZS9jcnlw
dG8vaGFzaC5oIgppbnQgY3J5cHRvX2FoYXNoX3NldGtleShzdHJ1Y3QgY3J5cHRvX2FoYXNo
ICp0Zm0sIGNvbnN0IHU4ICprZXksCiAgIHVuc2lnbmVkIGludCBrZXlsZW4pOwojIDQzOCAi
Li9pbmNsdWRlL2NyeXB0by9oYXNoLmgiCmludCBjcnlwdG9fYWhhc2hfZmludXAoc3RydWN0
IGFoYXNoX3JlcXVlc3QgKnJlcSk7CiMgNDU1ICIuL2luY2x1ZGUvY3J5cHRvL2hhc2guaCIK
aW50IGNyeXB0b19haGFzaF9maW5hbChzdHJ1Y3QgYWhhc2hfcmVxdWVzdCAqcmVxKTsKIyA0
NjggIi4vaW5jbHVkZS9jcnlwdG8vaGFzaC5oIgppbnQgY3J5cHRvX2FoYXNoX2RpZ2VzdChz
dHJ1Y3QgYWhhc2hfcmVxdWVzdCAqcmVxKTsKIyA0ODEgIi4vaW5jbHVkZS9jcnlwdG8vaGFz
aC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgaW50IGNyeXB0b19haGFzaF9leHBvcnQoc3RydWN0IGFoYXNoX3Jl
cXVlc3QgKnJlcSwgdm9pZCAqb3V0KQp7CiByZXR1cm4gY3J5cHRvX2FoYXNoX3JlcXRmbShy
ZXEpLT5leHBvcnQocmVxLCBvdXQpOwp9CiMgNDk3ICIuL2luY2x1ZGUvY3J5cHRvL2hhc2gu
aCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIGludCBjcnlwdG9fYWhhc2hfaW1wb3J0KHN0cnVjdCBhaGFzaF9yZXF1
ZXN0ICpyZXEsIGNvbnN0IHZvaWQgKmluKQp7CiBzdHJ1Y3QgY3J5cHRvX2FoYXNoICp0Zm0g
PSBjcnlwdG9fYWhhc2hfcmVxdGZtKHJlcSk7CgogaWYgKGNyeXB0b19haGFzaF9nZXRfZmxh
Z3ModGZtKSAmIDB4MDAwMDAwMDEpCiAgcmV0dXJuIC0xMjY7CgogcmV0dXJuIHRmbS0+aW1w
b3J0KHJlcSwgaW4pOwp9CiMgNTE4ICIuL2luY2x1ZGUvY3J5cHRvL2hhc2guaCIKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIGludCBjcnlwdG9fYWhhc2hfaW5pdChzdHJ1Y3QgYWhhc2hfcmVxdWVzdCAqcmVxKQp7
CiBzdHJ1Y3QgY3J5cHRvX2FoYXNoICp0Zm0gPSBjcnlwdG9fYWhhc2hfcmVxdGZtKHJlcSk7
CgogaWYgKGNyeXB0b19haGFzaF9nZXRfZmxhZ3ModGZtKSAmIDB4MDAwMDAwMDEpCiAgcmV0
dXJuIC0xMjY7CgogcmV0dXJuIHRmbS0+aW5pdChyZXEpOwp9CiMgNTM5ICIuL2luY2x1ZGUv
Y3J5cHRvL2hhc2guaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBjcnlwdG9fYWhhc2hfdXBkYXRlKHN0cnVj
dCBhaGFzaF9yZXF1ZXN0ICpyZXEpCnsKIHN0cnVjdCBjcnlwdG9fYWhhc2ggKnRmbSA9IGNy
eXB0b19haGFzaF9yZXF0Zm0ocmVxKTsKIHN0cnVjdCBjcnlwdG9fYWxnICphbGcgPSB0Zm0t
PmJhc2UuX19jcnRfYWxnOwogdW5zaWduZWQgaW50IG5ieXRlcyA9IHJlcS0+bmJ5dGVzOwog
aW50IHJldDsKCiBjcnlwdG9fc3RhdHNfZ2V0KGFsZyk7CiByZXQgPSBjcnlwdG9fYWhhc2hf
cmVxdGZtKHJlcSktPnVwZGF0ZShyZXEpOwogY3J5cHRvX3N0YXRzX2FoYXNoX3VwZGF0ZShu
Ynl0ZXMsIHJldCwgYWxnKTsKIHJldHVybiByZXQ7Cn0KIyA1NzEgIi4vaW5jbHVkZS9jcnlw
dG8vaGFzaC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBhaGFzaF9yZXF1ZXN0X3NldF90Zm0oc3RydWN0
IGFoYXNoX3JlcXVlc3QgKnJlcSwKICAgICAgc3RydWN0IGNyeXB0b19haGFzaCAqdGZtKQp7
CiByZXEtPmJhc2UudGZtID0gY3J5cHRvX2FoYXNoX3RmbSh0Zm0pOwp9CiMgNTg5ICIuL2lu
Y2x1ZGUvY3J5cHRvL2hhc2guaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHN0cnVjdCBhaGFzaF9yZXF1ZXN0ICph
aGFzaF9yZXF1ZXN0X2FsbG9jKAogc3RydWN0IGNyeXB0b19haGFzaCAqdGZtLCBnZnBfdCBn
ZnApCnsKIHN0cnVjdCBhaGFzaF9yZXF1ZXN0ICpyZXE7CgogcmVxID0ga21hbGxvYyhzaXpl
b2Yoc3RydWN0IGFoYXNoX3JlcXVlc3QpICsKICAgICAgICBjcnlwdG9fYWhhc2hfcmVxc2l6
ZSh0Zm0pLCBnZnApOwoKIGlmIChfX2J1aWx0aW5fZXhwZWN0KCEhKHJlcSksIDEpKQogIGFo
YXNoX3JlcXVlc3Rfc2V0X3RmbShyZXEsIHRmbSk7CgogcmV0dXJuIHJlcTsKfQoKCgoKCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSB2b2lkIGFoYXNoX3JlcXVlc3RfZnJlZShzdHJ1Y3QgYWhhc2hfcmVxdWVzdCAq
cmVxKQp7CiBremZyZWUocmVxKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgYWhhc2hfcmVxdWVzdF96
ZXJvKHN0cnVjdCBhaGFzaF9yZXF1ZXN0ICpyZXEpCnsKIG1lbXplcm9fZXhwbGljaXQocmVx
LCBzaXplb2YoKnJlcSkgKwogICAgICAgICBjcnlwdG9fYWhhc2hfcmVxc2l6ZShjcnlwdG9f
YWhhc2hfcmVxdGZtKHJlcSkpKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHN0cnVjdCBhaGFzaF9yZXF1ZXN0
ICphaGFzaF9yZXF1ZXN0X2Nhc3QoCiBzdHJ1Y3QgY3J5cHRvX2FzeW5jX3JlcXVlc3QgKnJl
cSkKewogcmV0dXJuICh7IHZvaWQgKl9fbXB0ciA9ICh2b2lkICopKHJlcSk7IGRvIHsgZXh0
ZXJuIHZvaWQgX19jb21waWxldGltZV9hc3NlcnRfMjE0KHZvaWQpIF9fYXR0cmlidXRlX18o
KF9fZXJyb3JfXygicG9pbnRlciB0eXBlIG1pc21hdGNoIGluIGNvbnRhaW5lcl9vZigpIikp
KTsgaWYgKCEoISghX19idWlsdGluX3R5cGVzX2NvbXBhdGlibGVfcCh0eXBlb2YoKihyZXEp
KSwgdHlwZW9mKCgoc3RydWN0IGFoYXNoX3JlcXVlc3QgKikwKS0+YmFzZSkpICYmICFfX2J1
aWx0aW5fdHlwZXNfY29tcGF0aWJsZV9wKHR5cGVvZigqKHJlcSkpLCB0eXBlb2Yodm9pZCkp
KSkpIF9fY29tcGlsZXRpbWVfYXNzZXJ0XzIxNCgpOyB9IHdoaWxlICgwKTsgKChzdHJ1Y3Qg
YWhhc2hfcmVxdWVzdCAqKShfX21wdHIgLSBfX2J1aWx0aW5fb2Zmc2V0b2Yoc3RydWN0IGFo
YXNoX3JlcXVlc3QsIGJhc2UpKSk7IH0pOwp9CiMgNjQ5ICIuL2luY2x1ZGUvY3J5cHRvL2hh
c2guaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIHZvaWQgYWhhc2hfcmVxdWVzdF9zZXRfY2FsbGJhY2soc3RydWN0
IGFoYXNoX3JlcXVlc3QgKnJlcSwKICAgICAgICAgICB1MzIgZmxhZ3MsCiAgICAgICAgICAg
Y3J5cHRvX2NvbXBsZXRpb25fdCBjb21wbCwKICAgICAgICAgICB2b2lkICpkYXRhKQp7CiBy
ZXEtPmJhc2UuY29tcGxldGUgPSBjb21wbDsKIHJlcS0+YmFzZS5kYXRhID0gZGF0YTsKIHJl
cS0+YmFzZS5mbGFncyA9IGZsYWdzOwp9CiMgNjcyICIuL2luY2x1ZGUvY3J5cHRvL2hhc2gu
aCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0
cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRf
ZnVuY3Rpb25fXykpIHZvaWQgYWhhc2hfcmVxdWVzdF9zZXRfY3J5cHQoc3RydWN0IGFoYXNo
X3JlcXVlc3QgKnJlcSwKICAgICAgICBzdHJ1Y3Qgc2NhdHRlcmxpc3QgKnNyYywgdTggKnJl
c3VsdCwKICAgICAgICB1bnNpZ25lZCBpbnQgbmJ5dGVzKQp7CiByZXEtPnNyYyA9IHNyYzsK
IHJlcS0+bmJ5dGVzID0gbmJ5dGVzOwogcmVxLT5yZXN1bHQgPSByZXN1bHQ7Cn0KIyA3MDgg
Ii4vaW5jbHVkZS9jcnlwdG8vaGFzaC5oIgpzdHJ1Y3QgY3J5cHRvX3NoYXNoICpjcnlwdG9f
YWxsb2Nfc2hhc2goY29uc3QgY2hhciAqYWxnX25hbWUsIHUzMiB0eXBlLAogICAgIHUzMiBt
YXNrKTsKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3QgY3J5cHRvX3RmbSAqY3J5cHRvX3NoYXNoX3RmbShz
dHJ1Y3QgY3J5cHRvX3NoYXNoICp0Zm0pCnsKIHJldHVybiAmdGZtLT5iYXNlOwp9CgoKCgoK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIHZvaWQgY3J5cHRvX2ZyZWVfc2hhc2goc3RydWN0IGNyeXB0b19zaGFzaCAq
dGZtKQp7CiBjcnlwdG9fZGVzdHJveV90Zm0odGZtLCBjcnlwdG9fc2hhc2hfdGZtKHRmbSkp
Owp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgY29uc3QgY2hhciAqY3J5cHRvX3NoYXNoX2FsZ19uYW1lKHN0cnVj
dCBjcnlwdG9fc2hhc2ggKnRmbSkKewogcmV0dXJuIGNyeXB0b190Zm1fYWxnX25hbWUoY3J5
cHRvX3NoYXNoX3RmbSh0Zm0pKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGNvbnN0IGNoYXIgKmNyeXB0b19z
aGFzaF9kcml2ZXJfbmFtZShzdHJ1Y3QgY3J5cHRvX3NoYXNoICp0Zm0pCnsKIHJldHVybiBj
cnlwdG9fdGZtX2FsZ19kcml2ZXJfbmFtZShjcnlwdG9fc2hhc2hfdGZtKHRmbSkpOwp9Cgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgdW5zaWduZWQgaW50IGNyeXB0b19zaGFzaF9hbGlnbm1hc2soCiBzdHJ1Y3Qg
Y3J5cHRvX3NoYXNoICp0Zm0pCnsKIHJldHVybiBjcnlwdG9fdGZtX2FsZ19hbGlnbm1hc2so
Y3J5cHRvX3NoYXNoX3RmbSh0Zm0pKTsKfQojIDc1MCAiLi9pbmNsdWRlL2NyeXB0by9oYXNo
LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSB1bnNpZ25lZCBpbnQgY3J5cHRvX3NoYXNoX2Jsb2Nrc2l6ZShzdHJ1
Y3QgY3J5cHRvX3NoYXNoICp0Zm0pCnsKIHJldHVybiBjcnlwdG9fdGZtX2FsZ19ibG9ja3Np
emUoY3J5cHRvX3NoYXNoX3RmbSh0Zm0pKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHN0cnVjdCBzaGFzaF9h
bGcgKl9fY3J5cHRvX3NoYXNoX2FsZyhzdHJ1Y3QgY3J5cHRvX2FsZyAqYWxnKQp7CiByZXR1
cm4gKHsgdm9pZCAqX19tcHRyID0gKHZvaWQgKikoYWxnKTsgZG8geyBleHRlcm4gdm9pZCBf
X2NvbXBpbGV0aW1lX2Fzc2VydF8yMTUodm9pZCkgX19hdHRyaWJ1dGVfXygoX19lcnJvcl9f
KCJwb2ludGVyIHR5cGUgbWlzbWF0Y2ggaW4gY29udGFpbmVyX29mKCkiKSkpOyBpZiAoISgh
KCFfX2J1aWx0aW5fdHlwZXNfY29tcGF0aWJsZV9wKHR5cGVvZigqKGFsZykpLCB0eXBlb2Yo
KChzdHJ1Y3Qgc2hhc2hfYWxnICopMCktPmJhc2UpKSAmJiAhX19idWlsdGluX3R5cGVzX2Nv
bXBhdGlibGVfcCh0eXBlb2YoKihhbGcpKSwgdHlwZW9mKHZvaWQpKSkpKSBfX2NvbXBpbGV0
aW1lX2Fzc2VydF8yMTUoKTsgfSB3aGlsZSAoMCk7ICgoc3RydWN0IHNoYXNoX2FsZyAqKShf
X21wdHIgLSBfX2J1aWx0aW5fb2Zmc2V0b2Yoc3RydWN0IHNoYXNoX2FsZywgYmFzZSkpKTsg
fSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVt
ZW50X2Z1bmN0aW9uX18pKSBzdHJ1Y3Qgc2hhc2hfYWxnICpjcnlwdG9fc2hhc2hfYWxnKHN0
cnVjdCBjcnlwdG9fc2hhc2ggKnRmbSkKewogcmV0dXJuIF9fY3J5cHRvX3NoYXNoX2FsZyhj
cnlwdG9fc2hhc2hfdGZtKHRmbSktPl9fY3J0X2FsZyk7Cn0KIyA3NzQgIi4vaW5jbHVkZS9j
cnlwdG8vaGFzaC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgaW50IGNyeXB0b19zaGFzaF9kaWdl
c3RzaXplKHN0cnVjdCBjcnlwdG9fc2hhc2ggKnRmbSkKewogcmV0dXJuIGNyeXB0b19zaGFz
aF9hbGcodGZtKS0+ZGlnZXN0c2l6ZTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHVuc2lnbmVkIGludCBjcnlw
dG9fc2hhc2hfc3RhdGVzaXplKHN0cnVjdCBjcnlwdG9fc2hhc2ggKnRmbSkKewogcmV0dXJu
IGNyeXB0b19zaGFzaF9hbGcodGZtKS0+c3RhdGVzaXplOwp9CgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdTMyIGNy
eXB0b19zaGFzaF9nZXRfZmxhZ3Moc3RydWN0IGNyeXB0b19zaGFzaCAqdGZtKQp7CiByZXR1
cm4gY3J5cHRvX3RmbV9nZXRfZmxhZ3MoY3J5cHRvX3NoYXNoX3RmbSh0Zm0pKTsKfQoKc3Rh
dGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rp
b25fXykpIHZvaWQgY3J5cHRvX3NoYXNoX3NldF9mbGFncyhzdHJ1Y3QgY3J5cHRvX3NoYXNo
ICp0Zm0sIHUzMiBmbGFncykKewogY3J5cHRvX3RmbV9zZXRfZmxhZ3MoY3J5cHRvX3NoYXNo
X3RmbSh0Zm0pLCBmbGFncyk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIGNyeXB0b19zaGFzaF9jbGVh
cl9mbGFncyhzdHJ1Y3QgY3J5cHRvX3NoYXNoICp0Zm0sIHUzMiBmbGFncykKewogY3J5cHRv
X3RmbV9jbGVhcl9mbGFncyhjcnlwdG9fc2hhc2hfdGZtKHRmbSksIGZsYWdzKTsKfQojIDgx
NCAiLi9pbmNsdWRlL2NyeXB0by9oYXNoLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1bnNpZ25lZCBpbnQgY3J5
cHRvX3NoYXNoX2Rlc2NzaXplKHN0cnVjdCBjcnlwdG9fc2hhc2ggKnRmbSkKewogcmV0dXJu
IHRmbS0+ZGVzY3NpemU7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygo
X19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkICpzaGFzaF9kZXNjX2N0eChzdHJ1
Y3Qgc2hhc2hfZGVzYyAqZGVzYykKewogcmV0dXJuIGRlc2MtPl9fY3R4Owp9CiMgODM3ICIu
L2luY2x1ZGUvY3J5cHRvL2hhc2guaCIKaW50IGNyeXB0b19zaGFzaF9zZXRrZXkoc3RydWN0
IGNyeXB0b19zaGFzaCAqdGZtLCBjb25zdCB1OCAqa2V5LAogICB1bnNpZ25lZCBpbnQga2V5
bGVuKTsKIyA4NTUgIi4vaW5jbHVkZS9jcnlwdG8vaGFzaC5oIgppbnQgY3J5cHRvX3NoYXNo
X2RpZ2VzdChzdHJ1Y3Qgc2hhc2hfZGVzYyAqZGVzYywgY29uc3QgdTggKmRhdGEsCiAgIHVu
c2lnbmVkIGludCBsZW4sIHU4ICpvdXQpOwojIDg3NCAiLi9pbmNsdWRlL2NyeXB0by9oYXNo
LmgiCmludCBjcnlwdG9fc2hhc2hfdGZtX2RpZ2VzdChzdHJ1Y3QgY3J5cHRvX3NoYXNoICp0
Zm0sIGNvbnN0IHU4ICpkYXRhLAogICAgICAgdW5zaWduZWQgaW50IGxlbiwgdTggKm91dCk7
CiMgODg5ICIuL2luY2x1ZGUvY3J5cHRvL2hhc2guaCIKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBjcnlwdG9f
c2hhc2hfZXhwb3J0KHN0cnVjdCBzaGFzaF9kZXNjICpkZXNjLCB2b2lkICpvdXQpCnsKIHJl
dHVybiBjcnlwdG9fc2hhc2hfYWxnKGRlc2MtPnRmbSktPmV4cG9ydChkZXNjLCBvdXQpOwp9
CiMgOTA2ICIuL2luY2x1ZGUvY3J5cHRvL2hhc2guaCIKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCBjcnlwdG9f
c2hhc2hfaW1wb3J0KHN0cnVjdCBzaGFzaF9kZXNjICpkZXNjLCBjb25zdCB2b2lkICppbikK
ewogc3RydWN0IGNyeXB0b19zaGFzaCAqdGZtID0gZGVzYy0+dGZtOwoKIGlmIChjcnlwdG9f
c2hhc2hfZ2V0X2ZsYWdzKHRmbSkgJiAweDAwMDAwMDAxKQogIHJldHVybiAtMTI2OwoKIHJl
dHVybiBjcnlwdG9fc2hhc2hfYWxnKHRmbSktPmltcG9ydChkZXNjLCBpbik7Cn0KIyA5Mjgg
Ii4vaW5jbHVkZS9jcnlwdG8vaGFzaC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmli
dXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGNyeXB0b19zaGFzaF9p
bml0KHN0cnVjdCBzaGFzaF9kZXNjICpkZXNjKQp7CiBzdHJ1Y3QgY3J5cHRvX3NoYXNoICp0
Zm0gPSBkZXNjLT50Zm07CgogaWYgKGNyeXB0b19zaGFzaF9nZXRfZmxhZ3ModGZtKSAmIDB4
MDAwMDAwMDEpCiAgcmV0dXJuIC0xMjY7CgogcmV0dXJuIGNyeXB0b19zaGFzaF9hbGcodGZt
KS0+aW5pdChkZXNjKTsKfQojIDk1MCAiLi9pbmNsdWRlL2NyeXB0by9oYXNoLmgiCmludCBj
cnlwdG9fc2hhc2hfdXBkYXRlKHN0cnVjdCBzaGFzaF9kZXNjICpkZXNjLCBjb25zdCB1OCAq
ZGF0YSwKICAgdW5zaWduZWQgaW50IGxlbik7CiMgOTY3ICIuL2luY2x1ZGUvY3J5cHRvL2hh
c2guaCIKaW50IGNyeXB0b19zaGFzaF9maW5hbChzdHJ1Y3Qgc2hhc2hfZGVzYyAqZGVzYywg
dTggKm91dCk7CiMgOTg0ICIuL2luY2x1ZGUvY3J5cHRvL2hhc2guaCIKaW50IGNyeXB0b19z
aGFzaF9maW51cChzdHJ1Y3Qgc2hhc2hfZGVzYyAqZGVzYywgY29uc3QgdTggKmRhdGEsCiAg
ICAgICAgIHVuc2lnbmVkIGludCBsZW4sIHU4ICpvdXQpOwoKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQgc2hh
c2hfZGVzY196ZXJvKHN0cnVjdCBzaGFzaF9kZXNjICpkZXNjKQp7CiBtZW16ZXJvX2V4cGxp
Y2l0KGRlc2MsCiAgICBzaXplb2YoKmRlc2MpICsgY3J5cHRvX3NoYXNoX2Rlc2NzaXplKGRl
c2MtPnRmbSkpOwp9CiMgMTEgIi4vaW5jbHVkZS9saW51eC91aW8uaCIgMgojIDEgIi4vaW5j
bHVkZS91YXBpL2xpbnV4L3Vpby5oIiAxCiMgMTcgIi4vaW5jbHVkZS91YXBpL2xpbnV4L3Vp
by5oIgpzdHJ1Y3QgaW92ZWMKewogdm9pZCAqaW92X2Jhc2U7CiBfX2tlcm5lbF9zaXplX3Qg
aW92X2xlbjsKfTsKIyAxMiAiLi9pbmNsdWRlL2xpbnV4L3Vpby5oIiAyCgpzdHJ1Y3QgcGFn
ZTsKc3RydWN0IHBpcGVfaW5vZGVfaW5mbzsKCnN0cnVjdCBrdmVjIHsKIHZvaWQgKmlvdl9i
YXNlOwogc2l6ZV90IGlvdl9sZW47Cn07CgplbnVtIGl0ZXJfdHlwZSB7CgogSVRFUl9JT1ZF
QyA9IDQsCiBJVEVSX0tWRUMgPSA4LAogSVRFUl9CVkVDID0gMTYsCiBJVEVSX1BJUEUgPSAz
MiwKIElURVJfRElTQ0FSRCA9IDY0LAp9OwoKc3RydWN0IGlvdl9pdGVyIHsKCgoKCgogdW5z
aWduZWQgaW50IHR5cGU7CiBzaXplX3QgaW92X29mZnNldDsKIHNpemVfdCBjb3VudDsKIHVu
aW9uIHsKICBjb25zdCBzdHJ1Y3QgaW92ZWMgKmlvdjsKICBjb25zdCBzdHJ1Y3Qga3ZlYyAq
a3ZlYzsKICBjb25zdCBzdHJ1Y3QgYmlvX3ZlYyAqYnZlYzsKICBzdHJ1Y3QgcGlwZV9pbm9k
ZV9pbmZvICpwaXBlOwogfTsKIHVuaW9uIHsKICB1bnNpZ25lZCBsb25nIG5yX3NlZ3M7CiAg
c3RydWN0IHsKICAgdW5zaWduZWQgaW50IGhlYWQ7CiAgIHVuc2lnbmVkIGludCBzdGFydF9o
ZWFkOwogIH07CiB9Owp9OwoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChf
X25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGVudW0gaXRlcl90eXBlIGlvdl9pdGVyX3R5
cGUoY29uc3Qgc3RydWN0IGlvdl9pdGVyICppKQp7CiByZXR1cm4gaS0+dHlwZSAmIH4oMCB8
IDEpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBpdGVyX2lzX2lvdmVjKGNvbnN0IHN0cnVjdCBpb3Zf
aXRlciAqaSkKewogcmV0dXJuIGlvdl9pdGVyX3R5cGUoaSkgPT0gSVRFUl9JT1ZFQzsKfQoK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIGJvb2wgaW92X2l0ZXJfaXNfa3ZlYyhjb25zdCBzdHJ1Y3QgaW92X2l0ZXIg
KmkpCnsKIHJldHVybiBpb3ZfaXRlcl90eXBlKGkpID09IElURVJfS1ZFQzsKfQoKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIGJvb2wgaW92X2l0ZXJfaXNfYnZlYyhjb25zdCBzdHJ1Y3QgaW92X2l0ZXIgKmkpCnsK
IHJldHVybiBpb3ZfaXRlcl90eXBlKGkpID09IElURVJfQlZFQzsKfQoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJv
b2wgaW92X2l0ZXJfaXNfcGlwZShjb25zdCBzdHJ1Y3QgaW92X2l0ZXIgKmkpCnsKIHJldHVy
biBpb3ZfaXRlcl90eXBlKGkpID09IElURVJfUElQRTsKfQoKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGJvb2wgaW92
X2l0ZXJfaXNfZGlzY2FyZChjb25zdCBzdHJ1Y3QgaW92X2l0ZXIgKmkpCnsKIHJldHVybiBp
b3ZfaXRlcl90eXBlKGkpID09IElURVJfRElTQ0FSRDsKfQoKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHVuc2lnbmVk
IGNoYXIgaW92X2l0ZXJfcncoY29uc3Qgc3RydWN0IGlvdl9pdGVyICppKQp7CiByZXR1cm4g
aS0+dHlwZSAmICgwIHwgMSk7Cn0KIyA5NiAiLi9pbmNsdWRlL2xpbnV4L3Vpby5oIgpzdGF0
aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlv
bl9fKSkgc2l6ZV90IGlvdl9sZW5ndGgoY29uc3Qgc3RydWN0IGlvdmVjICppb3YsIHVuc2ln
bmVkIGxvbmcgbnJfc2VncykKewogdW5zaWduZWQgbG9uZyBzZWc7CiBzaXplX3QgcmV0ID0g
MDsKCiBmb3IgKHNlZyA9IDA7IHNlZyA8IG5yX3NlZ3M7IHNlZysrKQogIHJldCArPSBpb3Zb
c2VnXS5pb3ZfbGVuOwogcmV0dXJuIHJldDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHN0cnVjdCBpb3ZlYyBp
b3ZfaXRlcl9pb3ZlYyhjb25zdCBzdHJ1Y3QgaW92X2l0ZXIgKml0ZXIpCnsKIHJldHVybiAo
c3RydWN0IGlvdmVjKSB7CiAgLmlvdl9iYXNlID0gaXRlci0+aW92LT5pb3ZfYmFzZSArIGl0
ZXItPmlvdl9vZmZzZXQsCiAgLmlvdl9sZW4gPSBfX2J1aWx0aW5fY2hvb3NlX2V4cHIoKCgh
IShzaXplb2YoKHR5cGVvZihpdGVyLT5jb3VudCkgKikxID09ICh0eXBlb2YoaXRlci0+aW92
LT5pb3ZfbGVuIC0gaXRlci0+aW92X29mZnNldCkgKikxKSkpICYmICgoc2l6ZW9mKGludCkg
PT0gc2l6ZW9mKCooOCA/ICgodm9pZCAqKSgobG9uZykoaXRlci0+Y291bnQpICogMGwpKSA6
IChpbnQgKik4KSkpICYmIChzaXplb2YoaW50KSA9PSBzaXplb2YoKig4ID8gKCh2b2lkICop
KChsb25nKShpdGVyLT5pb3YtPmlvdl9sZW4gLSBpdGVyLT5pb3Zfb2Zmc2V0KSAqIDBsKSkg
OiAoaW50ICopOCkpKSkpLCAoKGl0ZXItPmNvdW50KSA8IChpdGVyLT5pb3YtPmlvdl9sZW4g
LSBpdGVyLT5pb3Zfb2Zmc2V0KSA/IChpdGVyLT5jb3VudCkgOiAoaXRlci0+aW92LT5pb3Zf
bGVuIC0gaXRlci0+aW92X29mZnNldCkpLCAoeyB0eXBlb2YoaXRlci0+Y291bnQpIF9fVU5J
UVVFX0lEX19feDIxNiA9IChpdGVyLT5jb3VudCk7IHR5cGVvZihpdGVyLT5pb3YtPmlvdl9s
ZW4gLSBpdGVyLT5pb3Zfb2Zmc2V0KSBfX1VOSVFVRV9JRF9fX3kyMTcgPSAoaXRlci0+aW92
LT5pb3ZfbGVuIC0gaXRlci0+aW92X29mZnNldCk7ICgoX19VTklRVUVfSURfX194MjE2KSA8
IChfX1VOSVFVRV9JRF9fX3kyMTcpID8gKF9fVU5JUVVFX0lEX19feDIxNikgOiAoX19VTklR
VUVfSURfX195MjE3KSk7IH0pKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAsCiB9Owp9CgpzaXplX3QgaW92X2l0ZXJfY29weV9mcm9tX3VzZXJf
YXRvbWljKHN0cnVjdCBwYWdlICpwYWdlLAogIHN0cnVjdCBpb3ZfaXRlciAqaSwgdW5zaWdu
ZWQgbG9uZyBvZmZzZXQsIHNpemVfdCBieXRlcyk7CnZvaWQgaW92X2l0ZXJfYWR2YW5jZShz
dHJ1Y3QgaW92X2l0ZXIgKmksIHNpemVfdCBieXRlcyk7CnZvaWQgaW92X2l0ZXJfcmV2ZXJ0
KHN0cnVjdCBpb3ZfaXRlciAqaSwgc2l6ZV90IGJ5dGVzKTsKaW50IGlvdl9pdGVyX2ZhdWx0
X2luX3JlYWRhYmxlKHN0cnVjdCBpb3ZfaXRlciAqaSwgc2l6ZV90IGJ5dGVzKTsKc2l6ZV90
IGlvdl9pdGVyX3NpbmdsZV9zZWdfY291bnQoY29uc3Qgc3RydWN0IGlvdl9pdGVyICppKTsK
c2l6ZV90IGNvcHlfcGFnZV90b19pdGVyKHN0cnVjdCBwYWdlICpwYWdlLCBzaXplX3Qgb2Zm
c2V0LCBzaXplX3QgYnl0ZXMsCiAgICBzdHJ1Y3QgaW92X2l0ZXIgKmkpOwpzaXplX3QgY29w
eV9wYWdlX2Zyb21faXRlcihzdHJ1Y3QgcGFnZSAqcGFnZSwgc2l6ZV90IG9mZnNldCwgc2l6
ZV90IGJ5dGVzLAogICAgc3RydWN0IGlvdl9pdGVyICppKTsKCnNpemVfdCBfY29weV90b19p
dGVyKGNvbnN0IHZvaWQgKmFkZHIsIHNpemVfdCBieXRlcywgc3RydWN0IGlvdl9pdGVyICpp
KTsKc2l6ZV90IF9jb3B5X2Zyb21faXRlcih2b2lkICphZGRyLCBzaXplX3QgYnl0ZXMsIHN0
cnVjdCBpb3ZfaXRlciAqaSk7CmJvb2wgX2NvcHlfZnJvbV9pdGVyX2Z1bGwodm9pZCAqYWRk
ciwgc2l6ZV90IGJ5dGVzLCBzdHJ1Y3QgaW92X2l0ZXIgKmkpOwpzaXplX3QgX2NvcHlfZnJv
bV9pdGVyX25vY2FjaGUodm9pZCAqYWRkciwgc2l6ZV90IGJ5dGVzLCBzdHJ1Y3QgaW92X2l0
ZXIgKmkpOwpib29sIF9jb3B5X2Zyb21faXRlcl9mdWxsX25vY2FjaGUodm9pZCAqYWRkciwg
c2l6ZV90IGJ5dGVzLCBzdHJ1Y3QgaW92X2l0ZXIgKmkpOwoKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmli
dXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX193YXJuX3VudXNl
ZF9yZXN1bHRfXykpCnNpemVfdCBjb3B5X3RvX2l0ZXIoY29uc3Qgdm9pZCAqYWRkciwgc2l6
ZV90IGJ5dGVzLCBzdHJ1Y3QgaW92X2l0ZXIgKmkpCnsKIGlmIChfX2J1aWx0aW5fZXhwZWN0
KCEhKCFjaGVja19jb3B5X3NpemUoYWRkciwgYnl0ZXMsIHRydWUpKSwgMCkpCiAgcmV0dXJu
IDA7CiBlbHNlCiAgcmV0dXJuIF9jb3B5X3RvX2l0ZXIoYWRkciwgYnl0ZXMsIGkpOwp9Cgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkKc2l6ZV90IGNvcHlfZnJvbV9pdGVyKHZv
aWQgKmFkZHIsIHNpemVfdCBieXRlcywgc3RydWN0IGlvdl9pdGVyICppKQp7CiBpZiAoX19i
dWlsdGluX2V4cGVjdCghISghY2hlY2tfY29weV9zaXplKGFkZHIsIGJ5dGVzLCBmYWxzZSkp
LCAwKSkKICByZXR1cm4gMDsKIGVsc2UKICByZXR1cm4gX2NvcHlfZnJvbV9pdGVyKGFkZHIs
IGJ5dGVzLCBpKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX193YXJuX3VudXNlZF9yZXN1bHRfXykpCmJvb2wgY29w
eV9mcm9tX2l0ZXJfZnVsbCh2b2lkICphZGRyLCBzaXplX3QgYnl0ZXMsIHN0cnVjdCBpb3Zf
aXRlciAqaSkKewogaWYgKF9fYnVpbHRpbl9leHBlY3QoISEoIWNoZWNrX2NvcHlfc2l6ZShh
ZGRyLCBieXRlcywgZmFsc2UpKSwgMCkpCiAgcmV0dXJuIGZhbHNlOwogZWxzZQogIHJldHVy
biBfY29weV9mcm9tX2l0ZXJfZnVsbChhZGRyLCBieXRlcywgaSk7Cn0KCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBf
X2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fd2Fy
bl91bnVzZWRfcmVzdWx0X18pKQpzaXplX3QgY29weV9mcm9tX2l0ZXJfbm9jYWNoZSh2b2lk
ICphZGRyLCBzaXplX3QgYnl0ZXMsIHN0cnVjdCBpb3ZfaXRlciAqaSkKewogaWYgKF9fYnVp
bHRpbl9leHBlY3QoISEoIWNoZWNrX2NvcHlfc2l6ZShhZGRyLCBieXRlcywgZmFsc2UpKSwg
MCkpCiAgcmV0dXJuIDA7CiBlbHNlCiAgcmV0dXJuIF9jb3B5X2Zyb21faXRlcl9ub2NhY2hl
KGFkZHIsIGJ5dGVzLCBpKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRlX18oKF9fYWx3YXlz
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX193YXJuX3VudXNlZF9yZXN1bHRfXykpCmJv
b2wgY29weV9mcm9tX2l0ZXJfZnVsbF9ub2NhY2hlKHZvaWQgKmFkZHIsIHNpemVfdCBieXRl
cywgc3RydWN0IGlvdl9pdGVyICppKQp7CiBpZiAoX19idWlsdGluX2V4cGVjdCghISghY2hl
Y2tfY29weV9zaXplKGFkZHIsIGJ5dGVzLCBmYWxzZSkpLCAwKSkKICByZXR1cm4gZmFsc2U7
CiBlbHNlCiAgcmV0dXJuIF9jb3B5X2Zyb21faXRlcl9mdWxsX25vY2FjaGUoYWRkciwgYnl0
ZXMsIGkpOwp9CiMgMTg0ICIuL2luY2x1ZGUvbGludXgvdWlvLmgiCnNpemVfdCBfY29weV9m
cm9tX2l0ZXJfZmx1c2hjYWNoZSh2b2lkICphZGRyLCBzaXplX3QgYnl0ZXMsIHN0cnVjdCBp
b3ZfaXRlciAqaSk7CgoKCgoKc2l6ZV90IF9jb3B5X3RvX2l0ZXJfbWNzYWZlKGNvbnN0IHZv
aWQgKmFkZHIsIHNpemVfdCBieXRlcywgc3RydWN0IGlvdl9pdGVyICppKTsKCgoKCnN0YXRp
YyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
KChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9u
X18pKSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKQpzaXplX3QgY29weV9mcm9tX2l0ZXJfZmx1c2hj
YWNoZSh2b2lkICphZGRyLCBzaXplX3QgYnl0ZXMsIHN0cnVjdCBpb3ZfaXRlciAqaSkKewog
aWYgKF9fYnVpbHRpbl9leHBlY3QoISEoIWNoZWNrX2NvcHlfc2l6ZShhZGRyLCBieXRlcywg
ZmFsc2UpKSwgMCkpCiAgcmV0dXJuIDA7CiBlbHNlCiAgcmV0dXJuIF9jb3B5X2Zyb21faXRl
cl9mbHVzaGNhY2hlKGFkZHIsIGJ5dGVzLCBpKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fYXR0cmlidXRl
X18oKF9fYWx3YXlzX2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX193YXJuX3VudXNlZF9y
ZXN1bHRfXykpCnNpemVfdCBjb3B5X3RvX2l0ZXJfbWNzYWZlKHZvaWQgKmFkZHIsIHNpemVf
dCBieXRlcywgc3RydWN0IGlvdl9pdGVyICppKQp7CiBpZiAoX19idWlsdGluX2V4cGVjdCgh
ISghY2hlY2tfY29weV9zaXplKGFkZHIsIGJ5dGVzLCB0cnVlKSksIDApKQogIHJldHVybiAw
OwogZWxzZQogIHJldHVybiBfY29weV90b19pdGVyX21jc2FmZShhZGRyLCBieXRlcywgaSk7
Cn0KCnNpemVfdCBpb3ZfaXRlcl96ZXJvKHNpemVfdCBieXRlcywgc3RydWN0IGlvdl9pdGVy
ICopOwp1bnNpZ25lZCBsb25nIGlvdl9pdGVyX2FsaWdubWVudChjb25zdCBzdHJ1Y3QgaW92
X2l0ZXIgKmkpOwp1bnNpZ25lZCBsb25nIGlvdl9pdGVyX2dhcF9hbGlnbm1lbnQoY29uc3Qg
c3RydWN0IGlvdl9pdGVyICppKTsKdm9pZCBpb3ZfaXRlcl9pbml0KHN0cnVjdCBpb3ZfaXRl
ciAqaSwgdW5zaWduZWQgaW50IGRpcmVjdGlvbiwgY29uc3Qgc3RydWN0IGlvdmVjICppb3Ys
CiAgIHVuc2lnbmVkIGxvbmcgbnJfc2Vncywgc2l6ZV90IGNvdW50KTsKdm9pZCBpb3ZfaXRl
cl9rdmVjKHN0cnVjdCBpb3ZfaXRlciAqaSwgdW5zaWduZWQgaW50IGRpcmVjdGlvbiwgY29u
c3Qgc3RydWN0IGt2ZWMgKmt2ZWMsCiAgIHVuc2lnbmVkIGxvbmcgbnJfc2Vncywgc2l6ZV90
IGNvdW50KTsKdm9pZCBpb3ZfaXRlcl9idmVjKHN0cnVjdCBpb3ZfaXRlciAqaSwgdW5zaWdu
ZWQgaW50IGRpcmVjdGlvbiwgY29uc3Qgc3RydWN0IGJpb192ZWMgKmJ2ZWMsCiAgIHVuc2ln
bmVkIGxvbmcgbnJfc2Vncywgc2l6ZV90IGNvdW50KTsKdm9pZCBpb3ZfaXRlcl9waXBlKHN0
cnVjdCBpb3ZfaXRlciAqaSwgdW5zaWduZWQgaW50IGRpcmVjdGlvbiwgc3RydWN0IHBpcGVf
aW5vZGVfaW5mbyAqcGlwZSwKICAgc2l6ZV90IGNvdW50KTsKdm9pZCBpb3ZfaXRlcl9kaXNj
YXJkKHN0cnVjdCBpb3ZfaXRlciAqaSwgdW5zaWduZWQgaW50IGRpcmVjdGlvbiwgc2l6ZV90
IGNvdW50KTsKc3NpemVfdCBpb3ZfaXRlcl9nZXRfcGFnZXMoc3RydWN0IGlvdl9pdGVyICpp
LCBzdHJ1Y3QgcGFnZSAqKnBhZ2VzLAogICBzaXplX3QgbWF4c2l6ZSwgdW5zaWduZWQgbWF4
cGFnZXMsIHNpemVfdCAqc3RhcnQpOwpzc2l6ZV90IGlvdl9pdGVyX2dldF9wYWdlc19hbGxv
YyhzdHJ1Y3QgaW92X2l0ZXIgKmksIHN0cnVjdCBwYWdlICoqKnBhZ2VzLAogICBzaXplX3Qg
bWF4c2l6ZSwgc2l6ZV90ICpzdGFydCk7CmludCBpb3ZfaXRlcl9ucGFnZXMoY29uc3Qgc3Ry
dWN0IGlvdl9pdGVyICppLCBpbnQgbWF4cGFnZXMpOwoKY29uc3Qgdm9pZCAqZHVwX2l0ZXIo
c3RydWN0IGlvdl9pdGVyICpuZXcsIHN0cnVjdCBpb3ZfaXRlciAqb2xkLCBnZnBfdCBmbGFn
cyk7CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgc2l6ZV90IGlvdl9pdGVyX2NvdW50KGNvbnN0IHN0cnVjdCBpb3Zf
aXRlciAqaSkKewogcmV0dXJuIGktPmNvdW50Owp9CgoKCgoKCgpzdGF0aWMgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRf
XykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBp
b3ZfaXRlcl90cnVuY2F0ZShzdHJ1Y3QgaW92X2l0ZXIgKmksIHU2NCBjb3VudCkKewoKCgoK
CgogaWYgKGktPmNvdW50ID4gY291bnQpCiAgaS0+Y291bnQgPSBjb3VudDsKfQoKCgoKCnN0
YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0
aW9uX18pKSB2b2lkIGlvdl9pdGVyX3JlZXhwYW5kKHN0cnVjdCBpb3ZfaXRlciAqaSwgc2l6
ZV90IGNvdW50KQp7CiBpLT5jb3VudCA9IGNvdW50Owp9CnNpemVfdCBjc3VtX2FuZF9jb3B5
X3RvX2l0ZXIoY29uc3Qgdm9pZCAqYWRkciwgc2l6ZV90IGJ5dGVzLCB2b2lkICpjc3VtcCwg
c3RydWN0IGlvdl9pdGVyICppKTsKc2l6ZV90IGNzdW1fYW5kX2NvcHlfZnJvbV9pdGVyKHZv
aWQgKmFkZHIsIHNpemVfdCBieXRlcywgX193c3VtICpjc3VtLCBzdHJ1Y3QgaW92X2l0ZXIg
KmkpOwpib29sIGNzdW1fYW5kX2NvcHlfZnJvbV9pdGVyX2Z1bGwodm9pZCAqYWRkciwgc2l6
ZV90IGJ5dGVzLCBfX3dzdW0gKmNzdW0sIHN0cnVjdCBpb3ZfaXRlciAqaSk7CnNpemVfdCBo
YXNoX2FuZF9jb3B5X3RvX2l0ZXIoY29uc3Qgdm9pZCAqYWRkciwgc2l6ZV90IGJ5dGVzLCB2
b2lkICpoYXNocCwKICBzdHJ1Y3QgaW92X2l0ZXIgKmkpOwoKc3NpemVfdCBpbXBvcnRfaW92
ZWMoaW50IHR5cGUsIGNvbnN0IHN0cnVjdCBpb3ZlYyAqIHV2ZWN0b3IsCiAgIHVuc2lnbmVk
IG5yX3NlZ3MsIHVuc2lnbmVkIGZhc3Rfc2VncywKICAgc3RydWN0IGlvdmVjICoqaW92LCBz
dHJ1Y3QgaW92X2l0ZXIgKmkpOwoKCnN0cnVjdCBjb21wYXRfaW92ZWM7CnNzaXplX3QgY29t
cGF0X2ltcG9ydF9pb3ZlYyhpbnQgdHlwZSwgY29uc3Qgc3RydWN0IGNvbXBhdF9pb3ZlYyAq
IHV2ZWN0b3IsCiAgIHVuc2lnbmVkIG5yX3NlZ3MsIHVuc2lnbmVkIGZhc3Rfc2VncywKICAg
c3RydWN0IGlvdmVjICoqaW92LCBzdHJ1Y3QgaW92X2l0ZXIgKmkpOwoKCmludCBpbXBvcnRf
c2luZ2xlX3JhbmdlKGludCB0eXBlLCB2b2lkICpidWYsIHNpemVfdCBsZW4sCiAgIHN0cnVj
dCBpb3ZlYyAqaW92LCBzdHJ1Y3QgaW92X2l0ZXIgKmkpOwoKaW50IGlvdl9pdGVyX2Zvcl9l
YWNoX3JhbmdlKHN0cnVjdCBpb3ZfaXRlciAqaSwgc2l6ZV90IGJ5dGVzLAogICAgICAgaW50
ICgqZikoc3RydWN0IGt2ZWMgKnZlYywgdm9pZCAqY29udGV4dCksCiAgICAgICB2b2lkICpj
b250ZXh0KTsKIyA5ICIuL2luY2x1ZGUvbGludXgvc29ja2V0LmgiIDIKCgojIDEgIi4vaW5j
bHVkZS91YXBpL2xpbnV4L3NvY2tldC5oIiAxCiMgMTAgIi4vaW5jbHVkZS91YXBpL2xpbnV4
L3NvY2tldC5oIgp0eXBlZGVmIHVuc2lnbmVkIHNob3J0IF9fa2VybmVsX3NhX2ZhbWlseV90
OwoKCgoKCnN0cnVjdCBfX2tlcm5lbF9zb2NrYWRkcl9zdG9yYWdlIHsKIHVuaW9uIHsKICBz
dHJ1Y3QgewogICBfX2tlcm5lbF9zYV9mYW1pbHlfdCBzc19mYW1pbHk7CgogICBjaGFyIF9f
ZGF0YVsxMjggLSBzaXplb2YodW5zaWduZWQgc2hvcnQpXTsKCgogIH07CiAgdm9pZCAqX19h
bGlnbjsKIH07Cn07CiMgMTIgIi4vaW5jbHVkZS9saW51eC9zb2NrZXQuaCIgMgoKc3RydWN0
IHBpZDsKc3RydWN0IGNyZWQ7CnN0cnVjdCBzb2NrZXQ7CgoKCgoKc3RydWN0IHNlcV9maWxl
OwpleHRlcm4gdm9pZCBzb2NrZXRfc2VxX3Nob3coc3RydWN0IHNlcV9maWxlICpzZXEpOwoK
CnR5cGVkZWYgX19rZXJuZWxfc2FfZmFtaWx5X3Qgc2FfZmFtaWx5X3Q7CgoKCgoKc3RydWN0
IHNvY2thZGRyIHsKIHNhX2ZhbWlseV90IHNhX2ZhbWlseTsKIGNoYXIgc2FfZGF0YVsxNF07
Cn07CgpzdHJ1Y3QgbGluZ2VyIHsKIGludCBsX29ub2ZmOwogaW50IGxfbGluZ2VyOwp9Owoj
IDQ5ICIuL2luY2x1ZGUvbGludXgvc29ja2V0LmgiCnN0cnVjdCBtc2doZHIgewogdm9pZCAq
bXNnX25hbWU7CiBpbnQgbXNnX25hbWVsZW47CiBzdHJ1Y3QgaW92X2l0ZXIgbXNnX2l0ZXI7
CgoKCgoKCiB1bmlvbiB7CiAgdm9pZCAqbXNnX2NvbnRyb2w7CiAgdm9pZCAqbXNnX2NvbnRy
b2xfdXNlcjsKIH07CiBib29sIG1zZ19jb250cm9sX2lzX3VzZXIgOiAxOwogX19rZXJuZWxf
c2l6ZV90IG1zZ19jb250cm9sbGVuOwogdW5zaWduZWQgaW50IG1zZ19mbGFnczsKIHN0cnVj
dCBraW9jYiAqbXNnX2lvY2I7Cn07CgpzdHJ1Y3QgdXNlcl9tc2doZHIgewogdm9pZCAqbXNn
X25hbWU7CiBpbnQgbXNnX25hbWVsZW47CiBzdHJ1Y3QgaW92ZWMgKm1zZ19pb3Y7CiBfX2tl
cm5lbF9zaXplX3QgbXNnX2lvdmxlbjsKIHZvaWQgKm1zZ19jb250cm9sOwogX19rZXJuZWxf
c2l6ZV90IG1zZ19jb250cm9sbGVuOwogdW5zaWduZWQgaW50IG1zZ19mbGFnczsKfTsKCgpz
dHJ1Y3QgbW1zZ2hkciB7CiBzdHJ1Y3QgdXNlcl9tc2doZHIgbXNnX2hkcjsKIHVuc2lnbmVk
IGludCBtc2dfbGVuOwp9OwoKCgoKCgoKc3RydWN0IGNtc2doZHIgewogX19rZXJuZWxfc2l6
ZV90IGNtc2dfbGVuOwogICAgICAgIGludCBjbXNnX2xldmVsOwogICAgICAgIGludCBjbXNn
X3R5cGU7Cn07CiMgMTQwICIuL2luY2x1ZGUvbGludXgvc29ja2V0LmgiCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBz
dHJ1Y3QgY21zZ2hkciAqIF9fY21zZ19ueHRoZHIodm9pZCAqX19jdGwsIF9fa2VybmVsX3Np
emVfdCBfX3NpemUsCiAgICAgICAgICAgIHN0cnVjdCBjbXNnaGRyICpfX2Ntc2cpCnsKIHN0
cnVjdCBjbXNnaGRyICogX19wdHI7CgogX19wdHIgPSAoc3RydWN0IGNtc2doZHIqKSgoKHVu
c2lnbmVkIGNoYXIgKikgX19jbXNnKSArICggKChfX2Ntc2ctPmNtc2dfbGVuKStzaXplb2Yo
bG9uZyktMSkgJiB+KHNpemVvZihsb25nKS0xKSApKTsKIGlmICgodW5zaWduZWQgbG9uZyko
KGNoYXIqKShfX3B0cisxKSAtIChjaGFyICopIF9fY3RsKSA+IF9fc2l6ZSkKICByZXR1cm4g
KHN0cnVjdCBjbXNnaGRyICopMDsKCiByZXR1cm4gX19wdHI7Cn0KCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBzdHJ1
Y3QgY21zZ2hkciAqIGNtc2dfbnh0aGRyIChzdHJ1Y3QgbXNnaGRyICpfX21zZywgc3RydWN0
IGNtc2doZHIgKl9fY21zZykKewogcmV0dXJuIF9fY21zZ19ueHRoZHIoX19tc2ctPm1zZ19j
b250cm9sLCBfX21zZy0+bXNnX2NvbnRyb2xsZW4sIF9fY21zZyk7Cn0KCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBz
aXplX3QgbXNnX2RhdGFfbGVmdChzdHJ1Y3QgbXNnaGRyICptc2cpCnsKIHJldHVybiBpb3Zf
aXRlcl9jb3VudCgmbXNnLT5tc2dfaXRlcik7Cn0KCgoKCgoKCnN0cnVjdCB1Y3JlZCB7CiBf
X3UzMiBwaWQ7CiBfX3UzMiB1aWQ7CiBfX3UzMiBnaWQ7Cn07CiMgMzY2ICIuL2luY2x1ZGUv
bGludXgvc29ja2V0LmgiCmV4dGVybiBpbnQgbW92ZV9hZGRyX3RvX2tlcm5lbCh2b2lkICp1
YWRkciwgaW50IHVsZW4sIHN0cnVjdCBfX2tlcm5lbF9zb2NrYWRkcl9zdG9yYWdlICprYWRk
cik7CmV4dGVybiBpbnQgcHV0X2Ntc2coc3RydWN0IG1zZ2hkciosIGludCBsZXZlbCwgaW50
IHR5cGUsIGludCBsZW4sIHZvaWQgKmRhdGEpOwoKc3RydWN0IHRpbWVzcGVjNjQ7CnN0cnVj
dCBfX2tlcm5lbF90aW1lc3BlYzsKc3RydWN0IG9sZF90aW1lc3BlYzMyOwoKc3RydWN0IHNj
bV90aW1lc3RhbXBpbmdfaW50ZXJuYWwgewogc3RydWN0IHRpbWVzcGVjNjQgdHNbM107Cn07
CgpleHRlcm4gdm9pZCBwdXRfY21zZ19zY21fdGltZXN0YW1waW5nNjQoc3RydWN0IG1zZ2hk
ciAqbXNnLCBzdHJ1Y3Qgc2NtX3RpbWVzdGFtcGluZ19pbnRlcm5hbCAqdHNzKTsKZXh0ZXJu
IHZvaWQgcHV0X2Ntc2dfc2NtX3RpbWVzdGFtcGluZyhzdHJ1Y3QgbXNnaGRyICptc2csIHN0
cnVjdCBzY21fdGltZXN0YW1waW5nX2ludGVybmFsICp0c3MpOwoKCgoKZXh0ZXJuIGxvbmcg
X19zeXNfcmVjdm1zZyhpbnQgZmQsIHN0cnVjdCB1c2VyX21zZ2hkciAqbXNnLAogICAgIHVu
c2lnbmVkIGludCBmbGFncywgYm9vbCBmb3JiaWRfY21zZ19jb21wYXQpOwpleHRlcm4gbG9u
ZyBfX3N5c19zZW5kbXNnKGludCBmZCwgc3RydWN0IHVzZXJfbXNnaGRyICptc2csCiAgICAg
dW5zaWduZWQgaW50IGZsYWdzLCBib29sIGZvcmJpZF9jbXNnX2NvbXBhdCk7CmV4dGVybiBp
bnQgX19zeXNfcmVjdm1tc2coaW50IGZkLCBzdHJ1Y3QgbW1zZ2hkciAqbW1zZywKICAgICB1
bnNpZ25lZCBpbnQgdmxlbiwgdW5zaWduZWQgaW50IGZsYWdzLAogICAgIHN0cnVjdCBfX2tl
cm5lbF90aW1lc3BlYyAqdGltZW91dCwKICAgICBzdHJ1Y3Qgb2xkX3RpbWVzcGVjMzIgKnRp
bWVvdXQzMik7CmV4dGVybiBpbnQgX19zeXNfc2VuZG1tc2coaW50IGZkLCBzdHJ1Y3QgbW1z
Z2hkciAqbW1zZywKICAgICB1bnNpZ25lZCBpbnQgdmxlbiwgdW5zaWduZWQgaW50IGZsYWdz
LAogICAgIGJvb2wgZm9yYmlkX2Ntc2dfY29tcGF0KTsKZXh0ZXJuIGxvbmcgX19zeXNfc2Vu
ZG1zZ19zb2NrKHN0cnVjdCBzb2NrZXQgKnNvY2ssIHN0cnVjdCBtc2doZHIgKm1zZywKICAg
ICAgICAgIHVuc2lnbmVkIGludCBmbGFncyk7CmV4dGVybiBsb25nIF9fc3lzX3JlY3Ztc2df
c29jayhzdHJ1Y3Qgc29ja2V0ICpzb2NrLCBzdHJ1Y3QgbXNnaGRyICptc2csCiAgICAgICAg
ICBzdHJ1Y3QgdXNlcl9tc2doZHIgKnVtc2csCiAgICAgICAgICBzdHJ1Y3Qgc29ja2FkZHIg
KnVhZGRyLAogICAgICAgICAgdW5zaWduZWQgaW50IGZsYWdzKTsKZXh0ZXJuIGludCBzZW5k
bXNnX2NvcHlfbXNnaGRyKHN0cnVjdCBtc2doZHIgKm1zZywKICAgICAgICAgIHN0cnVjdCB1
c2VyX21zZ2hkciAqdW1zZywgdW5zaWduZWQgZmxhZ3MsCiAgICAgICAgICBzdHJ1Y3QgaW92
ZWMgKippb3YpOwpleHRlcm4gaW50IHJlY3Ztc2dfY29weV9tc2doZHIoc3RydWN0IG1zZ2hk
ciAqbXNnLAogICAgICAgICAgc3RydWN0IHVzZXJfbXNnaGRyICp1bXNnLCB1bnNpZ25lZCBm
bGFncywKICAgICAgICAgIHN0cnVjdCBzb2NrYWRkciAqKnVhZGRyLAogICAgICAgICAgc3Ry
dWN0IGlvdmVjICoqaW92KTsKZXh0ZXJuIGludCBfX2NvcHlfbXNnaGRyX2Zyb21fdXNlcihz
dHJ1Y3QgbXNnaGRyICprbXNnLAogICAgICAgc3RydWN0IHVzZXJfbXNnaGRyICp1bXNnLAog
ICAgICAgc3RydWN0IHNvY2thZGRyICoqc2F2ZV9hZGRyLAogICAgICAgc3RydWN0IGlvdmVj
ICoqdWlvdiwgc2l6ZV90ICpuc2Vncyk7CgoKZXh0ZXJuIGludCBfX3N5c19yZWN2ZnJvbShp
bnQgZmQsIHZvaWQgKnVidWYsIHNpemVfdCBzaXplLAogICAgIHVuc2lnbmVkIGludCBmbGFn
cywgc3RydWN0IHNvY2thZGRyICphZGRyLAogICAgIGludCAqYWRkcl9sZW4pOwpleHRlcm4g
aW50IF9fc3lzX3NlbmR0byhpbnQgZmQsIHZvaWQgKmJ1ZmYsIHNpemVfdCBsZW4sCiAgIHVu
c2lnbmVkIGludCBmbGFncywgc3RydWN0IHNvY2thZGRyICphZGRyLAogICBpbnQgYWRkcl9s
ZW4pOwpleHRlcm4gaW50IF9fc3lzX2FjY2VwdDRfZmlsZShzdHJ1Y3QgZmlsZSAqZmlsZSwg
dW5zaWduZWQgZmlsZV9mbGFncywKICAgc3RydWN0IHNvY2thZGRyICp1cGVlcl9zb2NrYWRk
ciwKICAgIGludCAqdXBlZXJfYWRkcmxlbiwgaW50IGZsYWdzLAogICAgdW5zaWduZWQgbG9u
ZyBub2ZpbGUpOwpleHRlcm4gaW50IF9fc3lzX2FjY2VwdDQoaW50IGZkLCBzdHJ1Y3Qgc29j
a2FkZHIgKnVwZWVyX3NvY2thZGRyLAogICAgaW50ICp1cGVlcl9hZGRybGVuLCBpbnQgZmxh
Z3MpOwpleHRlcm4gaW50IF9fc3lzX3NvY2tldChpbnQgZmFtaWx5LCBpbnQgdHlwZSwgaW50
IHByb3RvY29sKTsKZXh0ZXJuIGludCBfX3N5c19iaW5kKGludCBmZCwgc3RydWN0IHNvY2th
ZGRyICp1bXlhZGRyLCBpbnQgYWRkcmxlbik7CmV4dGVybiBpbnQgX19zeXNfY29ubmVjdF9m
aWxlKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgX19rZXJuZWxfc29ja2FkZHJfc3RvcmFn
ZSAqYWRkciwKICAgICAgICAgaW50IGFkZHJsZW4sIGludCBmaWxlX2ZsYWdzKTsKZXh0ZXJu
IGludCBfX3N5c19jb25uZWN0KGludCBmZCwgc3RydWN0IHNvY2thZGRyICp1c2VydmFkZHIs
CiAgICBpbnQgYWRkcmxlbik7CmV4dGVybiBpbnQgX19zeXNfbGlzdGVuKGludCBmZCwgaW50
IGJhY2tsb2cpOwpleHRlcm4gaW50IF9fc3lzX2dldHNvY2tuYW1lKGludCBmZCwgc3RydWN0
IHNvY2thZGRyICp1c29ja2FkZHIsCiAgICAgICAgaW50ICp1c29ja2FkZHJfbGVuKTsKZXh0
ZXJuIGludCBfX3N5c19nZXRwZWVybmFtZShpbnQgZmQsIHN0cnVjdCBzb2NrYWRkciAqdXNv
Y2thZGRyLAogICAgICAgIGludCAqdXNvY2thZGRyX2xlbik7CmV4dGVybiBpbnQgX19zeXNf
c29ja2V0cGFpcihpbnQgZmFtaWx5LCBpbnQgdHlwZSwgaW50IHByb3RvY29sLAogICAgICAg
aW50ICp1c29ja3ZlYyk7CmV4dGVybiBpbnQgX19zeXNfc2h1dGRvd24oaW50IGZkLCBpbnQg
aG93KTsKCmV4dGVybiBzdHJ1Y3QgbnNfY29tbW9uICpnZXRfbmV0X25zKHN0cnVjdCBuc19j
b21tb24gKm5zKTsKIyAxNiAiLi9pbmNsdWRlL2xpbnV4L2NvbXBhdC5oIiAyCiMgMSAiLi9p
bmNsdWRlL3VhcGkvbGludXgvaWYuaCIgMQojIDIzICIuL2luY2x1ZGUvdWFwaS9saW51eC9p
Zi5oIgojIDEgIi4vaW5jbHVkZS91YXBpL2xpbnV4L2xpYmMtY29tcGF0LmgiIDEKIyAyNCAi
Li9pbmNsdWRlL3VhcGkvbGludXgvaWYuaCIgMgojIDM3ICIuL2luY2x1ZGUvdWFwaS9saW51
eC9pZi5oIgojIDEgIi4vaW5jbHVkZS91YXBpL2xpbnV4L2hkbGMvaW9jdGwuaCIgMQojIDQw
ICIuL2luY2x1ZGUvdWFwaS9saW51eC9oZGxjL2lvY3RsLmgiCnR5cGVkZWYgc3RydWN0IHsK
IHVuc2lnbmVkIGludCBjbG9ja19yYXRlOwogdW5zaWduZWQgaW50IGNsb2NrX3R5cGU7CiB1
bnNpZ25lZCBzaG9ydCBsb29wYmFjazsKfSBzeW5jX3NlcmlhbF9zZXR0aW5nczsKCnR5cGVk
ZWYgc3RydWN0IHsKIHVuc2lnbmVkIGludCBjbG9ja19yYXRlOwogdW5zaWduZWQgaW50IGNs
b2NrX3R5cGU7CiB1bnNpZ25lZCBzaG9ydCBsb29wYmFjazsKIHVuc2lnbmVkIGludCBzbG90
X21hcDsKfSB0ZTFfc2V0dGluZ3M7Cgp0eXBlZGVmIHN0cnVjdCB7CiB1bnNpZ25lZCBzaG9y
dCBlbmNvZGluZzsKIHVuc2lnbmVkIHNob3J0IHBhcml0eTsKfSByYXdfaGRsY19wcm90bzsK
CnR5cGVkZWYgc3RydWN0IHsKIHVuc2lnbmVkIGludCB0MzkxOwogdW5zaWduZWQgaW50IHQz
OTI7CiB1bnNpZ25lZCBpbnQgbjM5MTsKIHVuc2lnbmVkIGludCBuMzkyOwogdW5zaWduZWQg
aW50IG4zOTM7CiB1bnNpZ25lZCBzaG9ydCBsbWk7CiB1bnNpZ25lZCBzaG9ydCBkY2U7Cn0g
ZnJfcHJvdG87Cgp0eXBlZGVmIHN0cnVjdCB7CiB1bnNpZ25lZCBpbnQgZGxjaTsKfSBmcl9w
cm90b19wdmM7Cgp0eXBlZGVmIHN0cnVjdCB7CiB1bnNpZ25lZCBpbnQgZGxjaTsKIGNoYXIg
bWFzdGVyWzE2XTsKfWZyX3Byb3RvX3B2Y19pbmZvOwoKdHlwZWRlZiBzdHJ1Y3QgewogICAg
dW5zaWduZWQgaW50IGludGVydmFsOwogICAgdW5zaWduZWQgaW50IHRpbWVvdXQ7Cn0gY2lz
Y29fcHJvdG87Cgp0eXBlZGVmIHN0cnVjdCB7CiB1bnNpZ25lZCBzaG9ydCBkY2U7CiB1bnNp
Z25lZCBpbnQgbW9kdWxvOwogdW5zaWduZWQgaW50IHdpbmRvdzsKIHVuc2lnbmVkIGludCB0
MTsKIHVuc2lnbmVkIGludCB0MjsKIHVuc2lnbmVkIGludCBuMjsKfSB4MjVfaGRsY19wcm90
bzsKIyAzOCAiLi9pbmNsdWRlL3VhcGkvbGludXgvaWYuaCIgMgojIDgyICIuL2luY2x1ZGUv
dWFwaS9saW51eC9pZi5oIgplbnVtIG5ldF9kZXZpY2VfZmxhZ3MgewoKCiBJRkZfVVAgPSAx
PDwwLAogSUZGX0JST0FEQ0FTVCA9IDE8PDEsCiBJRkZfREVCVUcgPSAxPDwyLAogSUZGX0xP
T1BCQUNLID0gMTw8MywKIElGRl9QT0lOVE9QT0lOVCA9IDE8PDQsCiBJRkZfTk9UUkFJTEVS
UyA9IDE8PDUsCiBJRkZfUlVOTklORyA9IDE8PDYsCiBJRkZfTk9BUlAgPSAxPDw3LAogSUZG
X1BST01JU0MgPSAxPDw4LAogSUZGX0FMTE1VTFRJID0gMTw8OSwKIElGRl9NQVNURVIgPSAx
PDwxMCwKIElGRl9TTEFWRSA9IDE8PDExLAogSUZGX01VTFRJQ0FTVCA9IDE8PDEyLAogSUZG
X1BPUlRTRUwgPSAxPDwxMywKIElGRl9BVVRPTUVESUEgPSAxPDwxNCwKIElGRl9EWU5BTUlD
ID0gMTw8MTUsCgoKIElGRl9MT1dFUl9VUCA9IDE8PDE2LAogSUZGX0RPUk1BTlQgPSAxPDwx
NywKIElGRl9FQ0hPID0gMTw8MTgsCgp9OwojIDE2NyAiLi9pbmNsdWRlL3VhcGkvbGludXgv
aWYuaCIKZW51bSB7CiBJRl9PUEVSX1VOS05PV04sCiBJRl9PUEVSX05PVFBSRVNFTlQsCiBJ
Rl9PUEVSX0RPV04sCiBJRl9PUEVSX0xPV0VSTEFZRVJET1dOLAogSUZfT1BFUl9URVNUSU5H
LAogSUZfT1BFUl9ET1JNQU5ULAogSUZfT1BFUl9VUCwKfTsKCgplbnVtIHsKIElGX0xJTktf
TU9ERV9ERUZBVUxULAogSUZfTElOS19NT0RFX0RPUk1BTlQsCiBJRl9MSU5LX01PREVfVEVT
VElORywKfTsKIyAxOTYgIi4vaW5jbHVkZS91YXBpL2xpbnV4L2lmLmgiCnN0cnVjdCBpZm1h
cCB7CiB1bnNpZ25lZCBsb25nIG1lbV9zdGFydDsKIHVuc2lnbmVkIGxvbmcgbWVtX2VuZDsK
IHVuc2lnbmVkIHNob3J0IGJhc2VfYWRkcjsKIHVuc2lnbmVkIGNoYXIgaXJxOwogdW5zaWdu
ZWQgY2hhciBkbWE7CiB1bnNpZ25lZCBjaGFyIHBvcnQ7Cgp9OwoKCnN0cnVjdCBpZl9zZXR0
aW5ncyB7CiB1bnNpZ25lZCBpbnQgdHlwZTsKIHVuc2lnbmVkIGludCBzaXplOwogdW5pb24g
ewoKICByYXdfaGRsY19wcm90byAqcmF3X2hkbGM7CiAgY2lzY29fcHJvdG8gKmNpc2NvOwog
IGZyX3Byb3RvICpmcjsKICBmcl9wcm90b19wdmMgKmZyX3B2YzsKICBmcl9wcm90b19wdmNf
aW5mbyAqZnJfcHZjX2luZm87CiAgeDI1X2hkbGNfcHJvdG8gKngyNTsKCgogIHN5bmNfc2Vy
aWFsX3NldHRpbmdzICpzeW5jOwogIHRlMV9zZXR0aW5ncyAqdGUxOwogfSBpZnNfaWZzdTsK
fTsKIyAyMzQgIi4vaW5jbHVkZS91YXBpL2xpbnV4L2lmLmgiCnN0cnVjdCBpZnJlcSB7Cgog
dW5pb24KIHsKICBjaGFyIGlmcm5fbmFtZVsxNl07CiB9IGlmcl9pZnJuOwoKIHVuaW9uIHsK
ICBzdHJ1Y3Qgc29ja2FkZHIgaWZydV9hZGRyOwogIHN0cnVjdCBzb2NrYWRkciBpZnJ1X2Rz
dGFkZHI7CiAgc3RydWN0IHNvY2thZGRyIGlmcnVfYnJvYWRhZGRyOwogIHN0cnVjdCBzb2Nr
YWRkciBpZnJ1X25ldG1hc2s7CiAgc3RydWN0IHNvY2thZGRyIGlmcnVfaHdhZGRyOwogIHNo
b3J0IGlmcnVfZmxhZ3M7CiAgaW50IGlmcnVfaXZhbHVlOwogIGludCBpZnJ1X210dTsKICBz
dHJ1Y3QgaWZtYXAgaWZydV9tYXA7CiAgY2hhciBpZnJ1X3NsYXZlWzE2XTsKICBjaGFyIGlm
cnVfbmV3bmFtZVsxNl07CiAgdm9pZCAqIGlmcnVfZGF0YTsKICBzdHJ1Y3QgaWZfc2V0dGlu
Z3MgaWZydV9zZXR0aW5nczsKIH0gaWZyX2lmcnU7Cn07CiMgMjg2ICIuL2luY2x1ZGUvdWFw
aS9saW51eC9pZi5oIgpzdHJ1Y3QgaWZjb25mIHsKIGludCBpZmNfbGVuOwogdW5pb24gewog
IGNoYXIgKmlmY3VfYnVmOwogIHN0cnVjdCBpZnJlcSAqaWZjdV9yZXE7CiB9IGlmY19pZmN1
Owp9OwojIDE3ICIuL2luY2x1ZGUvbGludXgvY29tcGF0LmgiIDIKCgoKCgojIDEgIi4vYXJj
aC9wb3dlcnBjL2luY2x1ZGUvYXNtL2NvbXBhdC5oIiAxCiMgMTEgIi4vYXJjaC9wb3dlcnBj
L2luY2x1ZGUvYXNtL2NvbXBhdC5oIgojIDEgIi4vaW5jbHVkZS9hc20tZ2VuZXJpYy9jb21w
YXQuaCIgMQoKCgoKCnR5cGVkZWYgdTMyIGNvbXBhdF9zaXplX3Q7CnR5cGVkZWYgczMyIGNv
bXBhdF9zc2l6ZV90Owp0eXBlZGVmIHMzMiBjb21wYXRfY2xvY2tfdDsKdHlwZWRlZiBzMzIg
Y29tcGF0X3BpZF90Owp0eXBlZGVmIHUzMiBjb21wYXRfaW5vX3Q7CnR5cGVkZWYgczMyIGNv
bXBhdF9vZmZfdDsKdHlwZWRlZiBzNjQgY29tcGF0X2xvZmZfdDsKdHlwZWRlZiBzMzIgY29t
cGF0X2RhZGRyX3Q7CnR5cGVkZWYgczMyIGNvbXBhdF90aW1lcl90Owp0eXBlZGVmIHMzMiBj
b21wYXRfa2V5X3Q7CnR5cGVkZWYgczE2IGNvbXBhdF9zaG9ydF90Owp0eXBlZGVmIHMzMiBj
b21wYXRfaW50X3Q7CnR5cGVkZWYgczMyIGNvbXBhdF9sb25nX3Q7CnR5cGVkZWYgdTE2IGNv
bXBhdF91c2hvcnRfdDsKdHlwZWRlZiB1MzIgY29tcGF0X3VpbnRfdDsKdHlwZWRlZiB1MzIg
Y29tcGF0X3Vsb25nX3Q7CnR5cGVkZWYgdTMyIGNvbXBhdF91cHRyX3Q7CnR5cGVkZWYgdTMy
IGNvbXBhdF9haW9fY29udGV4dF90OwojIDEyICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2Fz
bS9jb21wYXQuaCIgMgojIDIwICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9jb21wYXQu
aCIKdHlwZWRlZiB1MzIgX19jb21wYXRfdWlkX3Q7CnR5cGVkZWYgdTMyIF9fY29tcGF0X2dp
ZF90Owp0eXBlZGVmIHUzMiBfX2NvbXBhdF91aWQzMl90Owp0eXBlZGVmIHUzMiBfX2NvbXBh
dF9naWQzMl90Owp0eXBlZGVmIHUzMiBjb21wYXRfbW9kZV90Owp0eXBlZGVmIHUzMiBjb21w
YXRfZGV2X3Q7CnR5cGVkZWYgczE2IGNvbXBhdF9ubGlua190Owp0eXBlZGVmIHUxNiBjb21w
YXRfaXBjX3BpZF90Owp0eXBlZGVmIHUzMiBjb21wYXRfY2FkZHJfdDsKdHlwZWRlZiBfX2tl
cm5lbF9mc2lkX3QgY29tcGF0X2ZzaWRfdDsKdHlwZWRlZiBzNjQgY29tcGF0X3M2NDsKdHlw
ZWRlZiB1NjQgY29tcGF0X3U2NDsKCnN0cnVjdCBjb21wYXRfc3RhdCB7CiBjb21wYXRfZGV2
X3Qgc3RfZGV2OwogY29tcGF0X2lub190IHN0X2lubzsKIGNvbXBhdF9tb2RlX3Qgc3RfbW9k
ZTsKIGNvbXBhdF9ubGlua190IHN0X25saW5rOwogX19jb21wYXRfdWlkMzJfdCBzdF91aWQ7
CiBfX2NvbXBhdF9naWQzMl90IHN0X2dpZDsKIGNvbXBhdF9kZXZfdCBzdF9yZGV2OwogY29t
cGF0X29mZl90IHN0X3NpemU7CiBjb21wYXRfb2ZmX3Qgc3RfYmxrc2l6ZTsKIGNvbXBhdF9v
ZmZfdCBzdF9ibG9ja3M7CiBvbGRfdGltZTMyX3Qgc3RfYXRpbWU7CiB1MzIgc3RfYXRpbWVf
bnNlYzsKIG9sZF90aW1lMzJfdCBzdF9tdGltZTsKIHUzMiBzdF9tdGltZV9uc2VjOwogb2xk
X3RpbWUzMl90IHN0X2N0aW1lOwogdTMyIHN0X2N0aW1lX25zZWM7CiB1MzIgX191bnVzZWQ0
WzJdOwp9OwoKc3RydWN0IGNvbXBhdF9mbG9jayB7CiBzaG9ydCBsX3R5cGU7CiBzaG9ydCBs
X3doZW5jZTsKIGNvbXBhdF9vZmZfdCBsX3N0YXJ0OwogY29tcGF0X29mZl90IGxfbGVuOwog
Y29tcGF0X3BpZF90IGxfcGlkOwp9OwoKCgoKCnN0cnVjdCBjb21wYXRfZmxvY2s2NCB7CiBz
aG9ydCBsX3R5cGU7CiBzaG9ydCBsX3doZW5jZTsKIGNvbXBhdF9sb2ZmX3QgbF9zdGFydDsK
IGNvbXBhdF9sb2ZmX3QgbF9sZW47CiBjb21wYXRfcGlkX3QgbF9waWQ7Cn07CgpzdHJ1Y3Qg
Y29tcGF0X3N0YXRmcyB7CiBpbnQgZl90eXBlOwogaW50IGZfYnNpemU7CiBpbnQgZl9ibG9j
a3M7CiBpbnQgZl9iZnJlZTsKIGludCBmX2JhdmFpbDsKIGludCBmX2ZpbGVzOwogaW50IGZf
ZmZyZWU7CiBjb21wYXRfZnNpZF90IGZfZnNpZDsKIGludCBmX25hbWVsZW47CiBpbnQgZl9m
cnNpemU7CiBpbnQgZl9mbGFnczsKIGludCBmX3NwYXJlWzRdOwp9OwoKCgp0eXBlZGVmIHUz
MiBjb21wYXRfb2xkX3NpZ3NldF90OwoKCgoKdHlwZWRlZiB1MzIgY29tcGF0X3NpZ3NldF93
b3JkOwoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgdm9pZCAqYXJjaF9jb21wYXRfYWxsb2NfdXNlcl9zcGFjZShs
b25nIGxlbikKewogc3RydWN0IHB0X3JlZ3MgKnJlZ3MgPSBnZXRfY3VycmVudCgpLT50aHJl
YWQucmVnczsKIHVuc2lnbmVkIGxvbmcgdXNwID0gcmVncy0+Z3ByWzFdOwoKCgoKCgogaWYg
KCEodGVzdF90aV90aHJlYWRfZmxhZygoKHN0cnVjdCB0aHJlYWRfaW5mbyAqKWdldF9jdXJy
ZW50KCkpLCAyMCkpKQogIHVzcCAtPSA1MTI7CgogcmV0dXJuICh2b2lkICopICh1c3AgLSBs
ZW4pOwp9CgoKCgoKc3RydWN0IGNvbXBhdF9pcGM2NF9wZXJtIHsKIGNvbXBhdF9rZXlfdCBr
ZXk7CiBfX2NvbXBhdF91aWRfdCB1aWQ7CiBfX2NvbXBhdF9naWRfdCBnaWQ7CiBfX2NvbXBh
dF91aWRfdCBjdWlkOwogX19jb21wYXRfZ2lkX3QgY2dpZDsKIGNvbXBhdF9tb2RlX3QgbW9k
ZTsKIHVuc2lnbmVkIGludCBzZXE7CiB1bnNpZ25lZCBpbnQgX19wYWQyOwogdW5zaWduZWQg
bG9uZyBfX3VudXNlZDE7CiB1bnNpZ25lZCBsb25nIF9fdW51c2VkMjsKfTsKCnN0cnVjdCBj
b21wYXRfc2VtaWQ2NF9kcyB7CiBzdHJ1Y3QgY29tcGF0X2lwYzY0X3Blcm0gc2VtX3Blcm07
CiB1bnNpZ25lZCBpbnQgc2VtX290aW1lX2hpZ2g7CiB1bnNpZ25lZCBpbnQgc2VtX290aW1l
OwogdW5zaWduZWQgaW50IHNlbV9jdGltZV9oaWdoOwogdW5zaWduZWQgaW50IHNlbV9jdGlt
ZTsKIGNvbXBhdF91bG9uZ190IHNlbV9uc2VtczsKIGNvbXBhdF91bG9uZ190IF9fdW51c2Vk
MzsKIGNvbXBhdF91bG9uZ190IF9fdW51c2VkNDsKfTsKCnN0cnVjdCBjb21wYXRfbXNxaWQ2
NF9kcyB7CiBzdHJ1Y3QgY29tcGF0X2lwYzY0X3Blcm0gbXNnX3Blcm07CiB1bnNpZ25lZCBp
bnQgbXNnX3N0aW1lX2hpZ2g7CiB1bnNpZ25lZCBpbnQgbXNnX3N0aW1lOwogdW5zaWduZWQg
aW50IG1zZ19ydGltZV9oaWdoOwogdW5zaWduZWQgaW50IG1zZ19ydGltZTsKIHVuc2lnbmVk
IGludCBtc2dfY3RpbWVfaGlnaDsKIHVuc2lnbmVkIGludCBtc2dfY3RpbWU7CiBjb21wYXRf
dWxvbmdfdCBtc2dfY2J5dGVzOwogY29tcGF0X3Vsb25nX3QgbXNnX3FudW07CiBjb21wYXRf
dWxvbmdfdCBtc2dfcWJ5dGVzOwogY29tcGF0X3BpZF90IG1zZ19sc3BpZDsKIGNvbXBhdF9w
aWRfdCBtc2dfbHJwaWQ7CiBjb21wYXRfdWxvbmdfdCBfX3VudXNlZDQ7CiBjb21wYXRfdWxv
bmdfdCBfX3VudXNlZDU7Cn07CgpzdHJ1Y3QgY29tcGF0X3NobWlkNjRfZHMgewogc3RydWN0
IGNvbXBhdF9pcGM2NF9wZXJtIHNobV9wZXJtOwogdW5zaWduZWQgaW50IHNobV9hdGltZV9o
aWdoOwogdW5zaWduZWQgaW50IHNobV9hdGltZTsKIHVuc2lnbmVkIGludCBzaG1fZHRpbWVf
aGlnaDsKIHVuc2lnbmVkIGludCBzaG1fZHRpbWU7CiB1bnNpZ25lZCBpbnQgc2htX2N0aW1l
X2hpZ2g7CiB1bnNpZ25lZCBpbnQgc2htX2N0aW1lOwogdW5zaWduZWQgaW50IF9fdW51c2Vk
NDsKIGNvbXBhdF9zaXplX3Qgc2htX3NlZ3N6OwogY29tcGF0X3BpZF90IHNobV9jcGlkOwog
Y29tcGF0X3BpZF90IHNobV9scGlkOwogY29tcGF0X3Vsb25nX3Qgc2htX25hdHRjaDsKIGNv
bXBhdF91bG9uZ190IF9fdW51c2VkNTsKIGNvbXBhdF91bG9uZ190IF9fdW51c2VkNjsKfTsK
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSBpbnQgaXNfY29tcGF0X3Rhc2sodm9pZCkKewogcmV0dXJuICh0ZXN0X3Rp
X3RocmVhZF9mbGFnKCgoc3RydWN0IHRocmVhZF9pbmZvICopZ2V0X2N1cnJlbnQoKSksIDIw
KSk7Cn0KIyAyMyAiLi9pbmNsdWRlL2xpbnV4L2NvbXBhdC5oIiAyCgoKIyAxICIuL2FyY2gv
cG93ZXJwYy9pbmNsdWRlL2dlbmVyYXRlZC91YXBpL2FzbS9zaWdpbmZvLmgiIDEKIyAyNiAi
Li9pbmNsdWRlL2xpbnV4L2NvbXBhdC5oIiAyCiMgMTAwICIuL2luY2x1ZGUvbGludXgvY29t
cGF0LmgiCnR5cGVkZWYgc3RydWN0IGNvbXBhdF9zaWdhbHRzdGFjayB7CiBjb21wYXRfdXB0
cl90IHNzX3NwOwogaW50IHNzX2ZsYWdzOwogY29tcGF0X3NpemVfdCBzc19zaXplOwp9IGNv
bXBhdF9zdGFja190OwojIDExMyAiLi9pbmNsdWRlL2xpbnV4L2NvbXBhdC5oIgp0eXBlZGVm
IF9fY29tcGF0X3VpZDMyX3QgY29tcGF0X3VpZF90Owp0eXBlZGVmIF9fY29tcGF0X2dpZDMy
X3QgY29tcGF0X2dpZF90OwoKc3RydWN0IGNvbXBhdF9zZWxfYXJnX3N0cnVjdDsKc3RydWN0
IHJ1c2FnZTsKCnN0cnVjdCBvbGRfaXRpbWVydmFsMzI7CgpzdHJ1Y3QgY29tcGF0X3RtcyB7
CiBjb21wYXRfY2xvY2tfdCB0bXNfdXRpbWU7CiBjb21wYXRfY2xvY2tfdCB0bXNfc3RpbWU7
CiBjb21wYXRfY2xvY2tfdCB0bXNfY3V0aW1lOwogY29tcGF0X2Nsb2NrX3QgdG1zX2NzdGlt
ZTsKfTsKCgoKdHlwZWRlZiBzdHJ1Y3QgewogY29tcGF0X3NpZ3NldF93b3JkIHNpZ1soNjQg
LyAzMildOwp9IGNvbXBhdF9zaWdzZXRfdDsKCmludCBzZXRfY29tcGF0X3VzZXJfc2lnbWFz
ayhjb25zdCBjb21wYXRfc2lnc2V0X3QgKnVtYXNrLAogICAgICAgc2l6ZV90IHNpZ3NldHNp
emUpOwoKc3RydWN0IGNvbXBhdF9zaWdhY3Rpb24gewoKIGNvbXBhdF91cHRyX3Qgc2FfaGFu
ZGxlcjsKIGNvbXBhdF91bG9uZ190IHNhX2ZsYWdzOwoKCgoKCiBjb21wYXRfdXB0cl90IHNh
X3Jlc3RvcmVyOwoKIGNvbXBhdF9zaWdzZXRfdCBzYV9tYXNrIF9fYXR0cmlidXRlX18oKF9f
cGFja2VkX18pKTsKfTsKCnR5cGVkZWYgdW5pb24gY29tcGF0X3NpZ3ZhbCB7CiBjb21wYXRf
aW50X3Qgc2l2YWxfaW50OwogY29tcGF0X3VwdHJfdCBzaXZhbF9wdHI7Cn0gY29tcGF0X3Np
Z3ZhbF90OwoKdHlwZWRlZiBzdHJ1Y3QgY29tcGF0X3NpZ2luZm8gewogaW50IHNpX3NpZ25v
OwoKIGludCBzaV9lcnJubzsKIGludCBzaV9jb2RlOwoKCgoKCiB1bmlvbiB7CiAgaW50IF9w
YWRbMTI4L3NpemVvZihpbnQpIC0gM107CgoKICBzdHJ1Y3QgewogICBjb21wYXRfcGlkX3Qg
X3BpZDsKICAgX19jb21wYXRfdWlkMzJfdCBfdWlkOwogIH0gX2tpbGw7CgoKICBzdHJ1Y3Qg
ewogICBjb21wYXRfdGltZXJfdCBfdGlkOwogICBpbnQgX292ZXJydW47CiAgIGNvbXBhdF9z
aWd2YWxfdCBfc2lndmFsOwogIH0gX3RpbWVyOwoKCiAgc3RydWN0IHsKICAgY29tcGF0X3Bp
ZF90IF9waWQ7CiAgIF9fY29tcGF0X3VpZDMyX3QgX3VpZDsKICAgY29tcGF0X3NpZ3ZhbF90
IF9zaWd2YWw7CiAgfSBfcnQ7CgoKICBzdHJ1Y3QgewogICBjb21wYXRfcGlkX3QgX3BpZDsK
ICAgX19jb21wYXRfdWlkMzJfdCBfdWlkOwogICBpbnQgX3N0YXR1czsKICAgY29tcGF0X2Ns
b2NrX3QgX3V0aW1lOwogICBjb21wYXRfY2xvY2tfdCBfc3RpbWU7CiAgfSBfc2lnY2hsZDsK
IyAyMTAgIi4vaW5jbHVkZS9saW51eC9jb21wYXQuaCIKICBzdHJ1Y3QgewogICBjb21wYXRf
dXB0cl90IF9hZGRyOwoKCgoKCiAgIHVuaW9uIHsKCgoKCiAgICBzaG9ydCBpbnQgX2FkZHJf
bHNiOwoKICAgIHN0cnVjdCB7CiAgICAgY2hhciBfZHVtbXlfYm5kWyhfX2FsaWdub2ZfXyhj
b21wYXRfdXB0cl90KSA8IHNpemVvZihzaG9ydCkgPyBzaXplb2Yoc2hvcnQpIDogX19hbGln
bm9mX18oY29tcGF0X3VwdHJfdCkpXTsKICAgICBjb21wYXRfdXB0cl90IF9sb3dlcjsKICAg
ICBjb21wYXRfdXB0cl90IF91cHBlcjsKICAgIH0gX2FkZHJfYm5kOwoKICAgIHN0cnVjdCB7
CiAgICAgY2hhciBfZHVtbXlfcGtleVsoX19hbGlnbm9mX18oY29tcGF0X3VwdHJfdCkgPCBz
aXplb2Yoc2hvcnQpID8gc2l6ZW9mKHNob3J0KSA6IF9fYWxpZ25vZl9fKGNvbXBhdF91cHRy
X3QpKV07CiAgICAgdTMyIF9wa2V5OwogICAgfSBfYWRkcl9wa2V5OwogICB9OwogIH0gX3Np
Z2ZhdWx0OwoKCiAgc3RydWN0IHsKICAgY29tcGF0X2xvbmdfdCBfYmFuZDsKICAgaW50IF9m
ZDsKICB9IF9zaWdwb2xsOwoKICBzdHJ1Y3QgewogICBjb21wYXRfdXB0cl90IF9jYWxsX2Fk
ZHI7CiAgIGludCBfc3lzY2FsbDsKICAgdW5zaWduZWQgaW50IF9hcmNoOwogIH0gX3NpZ3N5
czsKIH0gX3NpZmllbGRzOwp9IGNvbXBhdF9zaWdpbmZvX3Q7CgpzdHJ1Y3QgY29tcGF0X2lv
dmVjIHsKIGNvbXBhdF91cHRyX3QgaW92X2Jhc2U7CiBjb21wYXRfc2l6ZV90IGlvdl9sZW47
Cn07CgpzdHJ1Y3QgY29tcGF0X3JsaW1pdCB7CiBjb21wYXRfdWxvbmdfdCBybGltX2N1cjsK
IGNvbXBhdF91bG9uZ190IHJsaW1fbWF4Owp9OwoKc3RydWN0IGNvbXBhdF9ydXNhZ2Ugewog
c3RydWN0IG9sZF90aW1ldmFsMzIgcnVfdXRpbWU7CiBzdHJ1Y3Qgb2xkX3RpbWV2YWwzMiBy
dV9zdGltZTsKIGNvbXBhdF9sb25nX3QgcnVfbWF4cnNzOwogY29tcGF0X2xvbmdfdCBydV9p
eHJzczsKIGNvbXBhdF9sb25nX3QgcnVfaWRyc3M7CiBjb21wYXRfbG9uZ190IHJ1X2lzcnNz
OwogY29tcGF0X2xvbmdfdCBydV9taW5mbHQ7CiBjb21wYXRfbG9uZ190IHJ1X21hamZsdDsK
IGNvbXBhdF9sb25nX3QgcnVfbnN3YXA7CiBjb21wYXRfbG9uZ190IHJ1X2luYmxvY2s7CiBj
b21wYXRfbG9uZ190IHJ1X291YmxvY2s7CiBjb21wYXRfbG9uZ190IHJ1X21zZ3NuZDsKIGNv
bXBhdF9sb25nX3QgcnVfbXNncmN2OwogY29tcGF0X2xvbmdfdCBydV9uc2lnbmFsczsKIGNv
bXBhdF9sb25nX3QgcnVfbnZjc3c7CiBjb21wYXRfbG9uZ190IHJ1X25pdmNzdzsKfTsKCmV4
dGVybiBpbnQgcHV0X2NvbXBhdF9ydXNhZ2UoY29uc3Qgc3RydWN0IHJ1c2FnZSAqLAogICAg
ICAgIHN0cnVjdCBjb21wYXRfcnVzYWdlICopOwoKc3RydWN0IGNvbXBhdF9zaWdpbmZvOwpz
dHJ1Y3QgX19jb21wYXRfYWlvX3NpZ3NldDsKCnN0cnVjdCBjb21wYXRfZGlyZW50IHsKIHUz
MiBkX2lubzsKIGNvbXBhdF9vZmZfdCBkX29mZjsKIHUxNiBkX3JlY2xlbjsKIGNoYXIgZF9u
YW1lWzI1Nl07Cn07CgpzdHJ1Y3QgY29tcGF0X3VzdGF0IHsKIGNvbXBhdF9kYWRkcl90IGZf
dGZyZWU7CiBjb21wYXRfaW5vX3QgZl90aW5vZGU7CiBjaGFyIGZfZm5hbWVbNl07CiBjaGFy
IGZfZnBhY2tbNl07Cn07CgoKCnR5cGVkZWYgc3RydWN0IGNvbXBhdF9zaWdldmVudCB7CiBj
b21wYXRfc2lndmFsX3Qgc2lnZXZfdmFsdWU7CiBjb21wYXRfaW50X3Qgc2lnZXZfc2lnbm87
CiBjb21wYXRfaW50X3Qgc2lnZXZfbm90aWZ5OwogdW5pb24gewogIGNvbXBhdF9pbnRfdCBf
cGFkWygoNjQvc2l6ZW9mKGludCkpIC0gMyldOwogIGNvbXBhdF9pbnRfdCBfdGlkOwoKICBz
dHJ1Y3QgewogICBjb21wYXRfdXB0cl90IF9mdW5jdGlvbjsKICAgY29tcGF0X3VwdHJfdCBf
YXR0cmlidXRlOwogIH0gX3NpZ2V2X3RocmVhZDsKIH0gX3NpZ2V2X3VuOwp9IGNvbXBhdF9z
aWdldmVudF90OwoKc3RydWN0IGNvbXBhdF9pZm1hcCB7CiBjb21wYXRfdWxvbmdfdCBtZW1f
c3RhcnQ7CiBjb21wYXRfdWxvbmdfdCBtZW1fZW5kOwogdW5zaWduZWQgc2hvcnQgYmFzZV9h
ZGRyOwogdW5zaWduZWQgY2hhciBpcnE7CiB1bnNpZ25lZCBjaGFyIGRtYTsKIHVuc2lnbmVk
IGNoYXIgcG9ydDsKfTsKCnN0cnVjdCBjb21wYXRfaWZfc2V0dGluZ3MgewogdW5zaWduZWQg
aW50IHR5cGU7CiB1bnNpZ25lZCBpbnQgc2l6ZTsKIGNvbXBhdF91cHRyX3QgaWZzX2lmc3U7
Cn07CgpzdHJ1Y3QgY29tcGF0X2lmcmVxIHsKIHVuaW9uIHsKICBjaGFyIGlmcm5fbmFtZVsx
Nl07CiB9IGlmcl9pZnJuOwogdW5pb24gewogIHN0cnVjdCBzb2NrYWRkciBpZnJ1X2FkZHI7
CiAgc3RydWN0IHNvY2thZGRyIGlmcnVfZHN0YWRkcjsKICBzdHJ1Y3Qgc29ja2FkZHIgaWZy
dV9icm9hZGFkZHI7CiAgc3RydWN0IHNvY2thZGRyIGlmcnVfbmV0bWFzazsKICBzdHJ1Y3Qg
c29ja2FkZHIgaWZydV9od2FkZHI7CiAgc2hvcnQgaWZydV9mbGFnczsKICBjb21wYXRfaW50
X3QgaWZydV9pdmFsdWU7CiAgY29tcGF0X2ludF90IGlmcnVfbXR1OwogIHN0cnVjdCBjb21w
YXRfaWZtYXAgaWZydV9tYXA7CiAgY2hhciBpZnJ1X3NsYXZlWzE2XTsKICBjaGFyIGlmcnVf
bmV3bmFtZVsxNl07CiAgY29tcGF0X2NhZGRyX3QgaWZydV9kYXRhOwogIHN0cnVjdCBjb21w
YXRfaWZfc2V0dGluZ3MgaWZydV9zZXR0aW5nczsKIH0gaWZyX2lmcnU7Cn07CgpzdHJ1Y3Qg
Y29tcGF0X2lmY29uZiB7CiBjb21wYXRfaW50X3QgaWZjX2xlbjsKIGNvbXBhdF9jYWRkcl90
IGlmY2J1ZjsKfTsKCnN0cnVjdCBjb21wYXRfcm9idXN0X2xpc3QgewogY29tcGF0X3VwdHJf
dCBuZXh0Owp9OwoKc3RydWN0IGNvbXBhdF9yb2J1c3RfbGlzdF9oZWFkIHsKIHN0cnVjdCBj
b21wYXRfcm9idXN0X2xpc3QgbGlzdDsKIGNvbXBhdF9sb25nX3QgZnV0ZXhfb2Zmc2V0Owog
Y29tcGF0X3VwdHJfdCBsaXN0X29wX3BlbmRpbmc7Cn07CgoKc3RydWN0IGNvbXBhdF9vbGRf
c2lnYWN0aW9uIHsKIGNvbXBhdF91cHRyX3Qgc2FfaGFuZGxlcjsKIGNvbXBhdF9vbGRfc2ln
c2V0X3Qgc2FfbWFzazsKIGNvbXBhdF91bG9uZ190IHNhX2ZsYWdzOwogY29tcGF0X3VwdHJf
dCBzYV9yZXN0b3JlcjsKfTsKCgpzdHJ1Y3QgY29tcGF0X2tleWN0bF9rZGZfcGFyYW1zIHsK
IGNvbXBhdF91cHRyX3QgaGFzaG5hbWU7CiBjb21wYXRfdXB0cl90IG90aGVyaW5mbzsKIF9f
dTMyIG90aGVyaW5mb2xlbjsKIF9fdTMyIF9fc3BhcmVbOF07Cn07CgpzdHJ1Y3QgY29tcGF0
X3N0YXRmczsKc3RydWN0IGNvbXBhdF9zdGF0ZnM2NDsKc3RydWN0IGNvbXBhdF9vbGRfbGlu
dXhfZGlyZW50OwpzdHJ1Y3QgY29tcGF0X2xpbnV4X2RpcmVudDsKc3RydWN0IGxpbnV4X2Rp
cmVudDY0OwpzdHJ1Y3QgY29tcGF0X21zZ2hkcjsKc3RydWN0IGNvbXBhdF9tbXNnaGRyOwpz
dHJ1Y3QgY29tcGF0X3N5c2luZm87CnN0cnVjdCBjb21wYXRfc3lzY3RsX2FyZ3M7CnN0cnVj
dCBjb21wYXRfa2V4ZWNfc2VnbWVudDsKc3RydWN0IGNvbXBhdF9tcV9hdHRyOwpzdHJ1Y3Qg
Y29tcGF0X21zZ2J1ZjsKCgoKCgpsb25nIGNvbXBhdF9nZXRfYml0bWFwKHVuc2lnbmVkIGxv
bmcgKm1hc2ssIGNvbnN0IGNvbXBhdF91bG9uZ190ICp1bWFzaywKICAgICAgICAgdW5zaWdu
ZWQgbG9uZyBiaXRtYXBfc2l6ZSk7CmxvbmcgY29tcGF0X3B1dF9iaXRtYXAoY29tcGF0X3Vs
b25nX3QgKnVtYXNrLCB1bnNpZ25lZCBsb25nICptYXNrLAogICAgICAgICB1bnNpZ25lZCBs
b25nIGJpdG1hcF9zaXplKTsKdm9pZCBjb3B5X3NpZ2luZm9fdG9fZXh0ZXJuYWwzMihzdHJ1
Y3QgY29tcGF0X3NpZ2luZm8gKnRvLAogIGNvbnN0IHN0cnVjdCBrZXJuZWxfc2lnaW5mbyAq
ZnJvbSk7CmludCBjb3B5X3NpZ2luZm9fZnJvbV91c2VyMzIoa2VybmVsX3NpZ2luZm9fdCAq
dG8sCiAgY29uc3Qgc3RydWN0IGNvbXBhdF9zaWdpbmZvICpmcm9tKTsKaW50IF9fY29weV9z
aWdpbmZvX3RvX3VzZXIzMihzdHJ1Y3QgY29tcGF0X3NpZ2luZm8gKnRvLAogIGNvbnN0IGtl
cm5lbF9zaWdpbmZvX3QgKmZyb20pOwoKCgppbnQgZ2V0X2NvbXBhdF9zaWdldmVudChzdHJ1
Y3Qgc2lnZXZlbnQgKmV2ZW50LAogIGNvbnN0IHN0cnVjdCBjb21wYXRfc2lnZXZlbnQgKnVf
ZXZlbnQpOwoKZXh0ZXJuIGludCBnZXRfY29tcGF0X3NpZ3NldChzaWdzZXRfdCAqc2V0LCBj
b25zdCBjb21wYXRfc2lnc2V0X3QgKmNvbXBhdCk7CgoKCgoKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludApwdXRf
Y29tcGF0X3NpZ3NldChjb21wYXRfc2lnc2V0X3QgKmNvbXBhdCwgY29uc3Qgc2lnc2V0X3Qg
KnNldCwKICAgIHVuc2lnbmVkIGludCBzaXplKQp7CgoKIGNvbXBhdF9zaWdzZXRfdCB2Owog
c3dpdGNoICgoNjQgLyA2NCkpIHsKIGNhc2UgNDogdi5zaWdbN10gPSAoc2V0LT5zaWdbM10g
Pj4gMzIpOyB2LnNpZ1s2XSA9IHNldC0+c2lnWzNdOwoKIGNhc2UgMzogdi5zaWdbNV0gPSAo
c2V0LT5zaWdbMl0gPj4gMzIpOyB2LnNpZ1s0XSA9IHNldC0+c2lnWzJdOwoKIGNhc2UgMjog
di5zaWdbM10gPSAoc2V0LT5zaWdbMV0gPj4gMzIpOyB2LnNpZ1syXSA9IHNldC0+c2lnWzFd
OwoKIGNhc2UgMTogdi5zaWdbMV0gPSAoc2V0LT5zaWdbMF0gPj4gMzIpOyB2LnNpZ1swXSA9
IHNldC0+c2lnWzBdOwogfQogcmV0dXJuIGNvcHlfdG9fdXNlcihjb21wYXQsICZ2LCBzaXpl
KSA/IC0xNCA6IDA7CgoKCn0KCmV4dGVybiBpbnQgY29tcGF0X3B0cmFjZV9yZXF1ZXN0KHN0
cnVjdCB0YXNrX3N0cnVjdCAqY2hpbGQsCiAgICAgY29tcGF0X2xvbmdfdCByZXF1ZXN0LAog
ICAgIGNvbXBhdF91bG9uZ190IGFkZHIsIGNvbXBhdF91bG9uZ190IGRhdGEpOwoKZXh0ZXJu
IGxvbmcgY29tcGF0X2FyY2hfcHRyYWNlKHN0cnVjdCB0YXNrX3N0cnVjdCAqY2hpbGQsIGNv
bXBhdF9sb25nX3QgcmVxdWVzdCwKICAgICAgICAgIGNvbXBhdF91bG9uZ190IGFkZHIsIGNv
bXBhdF91bG9uZ190IGRhdGEpOwoKc3RydWN0IGVwb2xsX2V2ZW50OwoKZXh0ZXJuIHNzaXpl
X3QgY29tcGF0X3J3X2NvcHlfY2hlY2tfdXZlY3RvcihpbnQgdHlwZSwKICBjb25zdCBzdHJ1
Y3QgY29tcGF0X2lvdmVjICp1dmVjdG9yLAogIHVuc2lnbmVkIGxvbmcgbnJfc2VncywKICB1
bnNpZ25lZCBsb25nIGZhc3Rfc2Vncywgc3RydWN0IGlvdmVjICpmYXN0X3BvaW50ZXIsCiAg
c3RydWN0IGlvdmVjICoqcmV0X3BvaW50ZXIpOwoKZXh0ZXJuIHZvaWQgKmNvbXBhdF9hbGxv
Y191c2VyX3NwYWNlKHVuc2lnbmVkIGxvbmcgbGVuKTsKCmludCBjb21wYXRfcmVzdG9yZV9h
bHRzdGFjayhjb25zdCBjb21wYXRfc3RhY2tfdCAqdXNzKTsKaW50IF9fY29tcGF0X3NhdmVf
YWx0c3RhY2soY29tcGF0X3N0YWNrX3QgKiwgdW5zaWduZWQgbG9uZyk7CiMgNDg5ICIuL2lu
Y2x1ZGUvbGludXgvY29tcGF0LmgiCiBsb25nIGNvbXBhdF9zeXNfaW9fc2V0dXAodW5zaWdu
ZWQgbnJfcmVxcywgdTMyICpjdHgzMnApOwogbG9uZyBjb21wYXRfc3lzX2lvX3N1Ym1pdChj
b21wYXRfYWlvX2NvbnRleHRfdCBjdHhfaWQsIGludCBuciwKICAgICAgICAgdTMyICppb2Ni
KTsKIGxvbmcgY29tcGF0X3N5c19pb19wZ2V0ZXZlbnRzKGNvbXBhdF9haW9fY29udGV4dF90
IGN0eF9pZCwKICAgICBjb21wYXRfbG9uZ190IG1pbl9uciwKICAgICBjb21wYXRfbG9uZ190
IG5yLAogICAgIHN0cnVjdCBpb19ldmVudCAqZXZlbnRzLAogICAgIHN0cnVjdCBvbGRfdGlt
ZXNwZWMzMiAqdGltZW91dCwKICAgICBjb25zdCBzdHJ1Y3QgX19jb21wYXRfYWlvX3NpZ3Nl
dCAqdXNpZyk7CiBsb25nIGNvbXBhdF9zeXNfaW9fcGdldGV2ZW50c190aW1lNjQoY29tcGF0
X2Fpb19jb250ZXh0X3QgY3R4X2lkLAogICAgIGNvbXBhdF9sb25nX3QgbWluX25yLAogICAg
IGNvbXBhdF9sb25nX3QgbnIsCiAgICAgc3RydWN0IGlvX2V2ZW50ICpldmVudHMsCiAgICAg
c3RydWN0IF9fa2VybmVsX3RpbWVzcGVjICp0aW1lb3V0LAogICAgIGNvbnN0IHN0cnVjdCBf
X2NvbXBhdF9haW9fc2lnc2V0ICp1c2lnKTsKCgogbG9uZyBjb21wYXRfc3lzX2xvb2t1cF9k
Y29va2llKHUzMiwgdTMyLCBjaGFyICosIGNvbXBhdF9zaXplX3QpOwoKCiBsb25nIGNvbXBh
dF9zeXNfZXBvbGxfcHdhaXQoaW50IGVwZmQsCiAgIHN0cnVjdCBlcG9sbF9ldmVudCAqZXZl
bnRzLAogICBpbnQgbWF4ZXZlbnRzLCBpbnQgdGltZW91dCwKICAgY29uc3QgY29tcGF0X3Np
Z3NldF90ICpzaWdtYXNrLAogICBjb21wYXRfc2l6ZV90IHNpZ3NldHNpemUpOwoKCiBsb25n
IGNvbXBhdF9zeXNfZmNudGwodW5zaWduZWQgaW50IGZkLCB1bnNpZ25lZCBpbnQgY21kLAog
ICAgIGNvbXBhdF91bG9uZ190IGFyZyk7CiBsb25nIGNvbXBhdF9zeXNfZmNudGw2NCh1bnNp
Z25lZCBpbnQgZmQsIHVuc2lnbmVkIGludCBjbWQsCiAgICAgICBjb21wYXRfdWxvbmdfdCBh
cmcpOwoKCiBsb25nIGNvbXBhdF9zeXNfaW9jdGwodW5zaWduZWQgaW50IGZkLCB1bnNpZ25l
ZCBpbnQgY21kLAogICAgIGNvbXBhdF91bG9uZ190IGFyZyk7CgoKIGxvbmcgY29tcGF0X3N5
c19tb3VudChjb25zdCBjaGFyICpkZXZfbmFtZSwKICAgICBjb25zdCBjaGFyICpkaXJfbmFt
ZSwKICAgICBjb25zdCBjaGFyICp0eXBlLCBjb21wYXRfdWxvbmdfdCBmbGFncywKICAgICBj
b25zdCB2b2lkICpkYXRhKTsKCgogbG9uZyBjb21wYXRfc3lzX3N0YXRmcyhjb25zdCBjaGFy
ICpwYXRobmFtZSwKICAgICAgc3RydWN0IGNvbXBhdF9zdGF0ZnMgKmJ1Zik7CiBsb25nIGNv
bXBhdF9zeXNfc3RhdGZzNjQoY29uc3QgY2hhciAqcGF0aG5hbWUsCiAgICAgICAgY29tcGF0
X3NpemVfdCBzeiwKICAgICAgICBzdHJ1Y3QgY29tcGF0X3N0YXRmczY0ICpidWYpOwogbG9u
ZyBjb21wYXRfc3lzX2ZzdGF0ZnModW5zaWduZWQgaW50IGZkLAogICAgICAgc3RydWN0IGNv
bXBhdF9zdGF0ZnMgKmJ1Zik7CiBsb25nIGNvbXBhdF9zeXNfZnN0YXRmczY0KHVuc2lnbmVk
IGludCBmZCwgY29tcGF0X3NpemVfdCBzeiwKICAgICAgICAgc3RydWN0IGNvbXBhdF9zdGF0
ZnM2NCAqYnVmKTsKIGxvbmcgY29tcGF0X3N5c190cnVuY2F0ZShjb25zdCBjaGFyICosIGNv
bXBhdF9vZmZfdCk7CiBsb25nIGNvbXBhdF9zeXNfZnRydW5jYXRlKHVuc2lnbmVkIGludCwg
Y29tcGF0X3Vsb25nX3QpOwoKIGxvbmcgY29tcGF0X3N5c19vcGVuYXQoaW50IGRmZCwgY29u
c3QgY2hhciAqZmlsZW5hbWUsCiAgICAgIGludCBmbGFncywgdW1vZGVfdCBtb2RlKTsKCgog
bG9uZyBjb21wYXRfc3lzX2dldGRlbnRzKHVuc2lnbmVkIGludCBmZCwKICAgICAgICBzdHJ1
Y3QgY29tcGF0X2xpbnV4X2RpcmVudCAqZGlyZW50LAogICAgICAgIHVuc2lnbmVkIGludCBj
b3VudCk7CgoKIGxvbmcgY29tcGF0X3N5c19sc2Vlayh1bnNpZ25lZCBpbnQsIGNvbXBhdF9v
ZmZfdCwgdW5zaWduZWQgaW50KTsKIHNzaXplX3QgY29tcGF0X3N5c19yZWFkdihjb21wYXRf
dWxvbmdfdCBmZCwKICBjb25zdCBzdHJ1Y3QgY29tcGF0X2lvdmVjICp2ZWMsIGNvbXBhdF91
bG9uZ190IHZsZW4pOwogc3NpemVfdCBjb21wYXRfc3lzX3dyaXRldihjb21wYXRfdWxvbmdf
dCBmZCwKICBjb25zdCBzdHJ1Y3QgY29tcGF0X2lvdmVjICp2ZWMsIGNvbXBhdF91bG9uZ190
IHZsZW4pOwoKIHNzaXplX3QgY29tcGF0X3N5c19wcmVhZHYoY29tcGF0X3Vsb25nX3QgZmQs
CiAgY29uc3Qgc3RydWN0IGNvbXBhdF9pb3ZlYyAqdmVjLAogIGNvbXBhdF91bG9uZ190IHZs
ZW4sIHUzMiBwb3NfbG93LCB1MzIgcG9zX2hpZ2gpOwogc3NpemVfdCBjb21wYXRfc3lzX3B3
cml0ZXYoY29tcGF0X3Vsb25nX3QgZmQsCiAgY29uc3Qgc3RydWN0IGNvbXBhdF9pb3ZlYyAq
dmVjLAogIGNvbXBhdF91bG9uZ190IHZsZW4sIHUzMiBwb3NfbG93LCB1MzIgcG9zX2hpZ2gp
OwojIDU3OCAiLi9pbmNsdWRlL2xpbnV4L2NvbXBhdC5oIgogbG9uZyBjb21wYXRfc3lzX3Nl
bmRmaWxlKGludCBvdXRfZmQsIGludCBpbl9mZCwKICAgICAgICBjb21wYXRfb2ZmX3QgKm9m
ZnNldCwgY29tcGF0X3NpemVfdCBjb3VudCk7CiBsb25nIGNvbXBhdF9zeXNfc2VuZGZpbGU2
NChpbnQgb3V0X2ZkLCBpbnQgaW5fZmQsCiAgICAgICAgY29tcGF0X2xvZmZfdCAqb2Zmc2V0
LCBjb21wYXRfc2l6ZV90IGNvdW50KTsKCgogbG9uZyBjb21wYXRfc3lzX3BzZWxlY3Q2X3Rp
bWUzMihpbnQgbiwgY29tcGF0X3Vsb25nX3QgKmlucCwKICAgICAgICBjb21wYXRfdWxvbmdf
dCAqb3V0cCwKICAgICAgICBjb21wYXRfdWxvbmdfdCAqZXhwLAogICAgICAgIHN0cnVjdCBv
bGRfdGltZXNwZWMzMiAqdHNwLAogICAgICAgIHZvaWQgKnNpZyk7CiBsb25nIGNvbXBhdF9z
eXNfcHNlbGVjdDZfdGltZTY0KGludCBuLCBjb21wYXRfdWxvbmdfdCAqaW5wLAogICAgICAg
IGNvbXBhdF91bG9uZ190ICpvdXRwLAogICAgICAgIGNvbXBhdF91bG9uZ190ICpleHAsCiAg
ICAgICAgc3RydWN0IF9fa2VybmVsX3RpbWVzcGVjICp0c3AsCiAgICAgICAgdm9pZCAqc2ln
KTsKIGxvbmcgY29tcGF0X3N5c19wcG9sbF90aW1lMzIoc3RydWN0IHBvbGxmZCAqdWZkcywK
ICAgICB1bnNpZ25lZCBpbnQgbmZkcywKICAgICBzdHJ1Y3Qgb2xkX3RpbWVzcGVjMzIgKnRz
cCwKICAgICBjb25zdCBjb21wYXRfc2lnc2V0X3QgKnNpZ21hc2ssCiAgICAgY29tcGF0X3Np
emVfdCBzaWdzZXRzaXplKTsKIGxvbmcgY29tcGF0X3N5c19wcG9sbF90aW1lNjQoc3RydWN0
IHBvbGxmZCAqdWZkcywKICAgICB1bnNpZ25lZCBpbnQgbmZkcywKICAgICBzdHJ1Y3QgX19r
ZXJuZWxfdGltZXNwZWMgKnRzcCwKICAgICBjb25zdCBjb21wYXRfc2lnc2V0X3QgKnNpZ21h
c2ssCiAgICAgY29tcGF0X3NpemVfdCBzaWdzZXRzaXplKTsKCgogbG9uZyBjb21wYXRfc3lz
X3NpZ25hbGZkNChpbnQgdWZkLAogICAgICAgICBjb25zdCBjb21wYXRfc2lnc2V0X3QgKnNp
Z21hc2ssCiAgICAgICAgIGNvbXBhdF9zaXplX3Qgc2lnc2V0c2l6ZSwgaW50IGZsYWdzKTsK
CgogbG9uZyBjb21wYXRfc3lzX3Ztc3BsaWNlKGludCBmZCwgY29uc3Qgc3RydWN0IGNvbXBh
dF9pb3ZlYyAqLAogICAgICAgIHVuc2lnbmVkIGludCBucl9zZWdzLCB1bnNpZ25lZCBpbnQg
ZmxhZ3MpOwoKCiBsb25nIGNvbXBhdF9zeXNfbmV3ZnN0YXRhdCh1bnNpZ25lZCBpbnQgZGZk
LAogICAgICAgICAgY29uc3QgY2hhciAqZmlsZW5hbWUsCiAgICAgICAgICBzdHJ1Y3QgY29t
cGF0X3N0YXQgKnN0YXRidWYsCiAgICAgICAgICBpbnQgZmxhZyk7CiBsb25nIGNvbXBhdF9z
eXNfbmV3ZnN0YXQodW5zaWduZWQgaW50IGZkLAogICAgICAgIHN0cnVjdCBjb21wYXRfc3Rh
dCAqc3RhdGJ1Zik7CgoKCgogbG9uZyBjb21wYXRfc3lzX3dhaXRpZChpbnQsIGNvbXBhdF9w
aWRfdCwKICBzdHJ1Y3QgY29tcGF0X3NpZ2luZm8gKiwgaW50LAogIHN0cnVjdCBjb21wYXRf
cnVzYWdlICopOwoKCgoKIGxvbmcKY29tcGF0X3N5c19zZXRfcm9idXN0X2xpc3Qoc3RydWN0
IGNvbXBhdF9yb2J1c3RfbGlzdF9oZWFkICpoZWFkLAogICAgICBjb21wYXRfc2l6ZV90IGxl
bik7CiBsb25nCmNvbXBhdF9zeXNfZ2V0X3JvYnVzdF9saXN0KGludCBwaWQsIGNvbXBhdF91
cHRyX3QgKmhlYWRfcHRyLAogICAgICBjb21wYXRfc2l6ZV90ICpsZW5fcHRyKTsKCgogbG9u
ZyBjb21wYXRfc3lzX2dldGl0aW1lcihpbnQgd2hpY2gsCiAgICAgICAgIHN0cnVjdCBvbGRf
aXRpbWVydmFsMzIgKml0KTsKIGxvbmcgY29tcGF0X3N5c19zZXRpdGltZXIoaW50IHdoaWNo
LAogICAgICAgICBzdHJ1Y3Qgb2xkX2l0aW1lcnZhbDMyICppbiwKICAgICAgICAgc3RydWN0
IG9sZF9pdGltZXJ2YWwzMiAqb3V0KTsKCgogbG9uZyBjb21wYXRfc3lzX2tleGVjX2xvYWQo
Y29tcGF0X3Vsb25nX3QgZW50cnksCiAgICAgICAgICBjb21wYXRfdWxvbmdfdCBucl9zZWdt
ZW50cywKICAgICAgICAgIHN0cnVjdCBjb21wYXRfa2V4ZWNfc2VnbWVudCAqLAogICAgICAg
ICAgY29tcGF0X3Vsb25nX3QgZmxhZ3MpOwoKCiBsb25nIGNvbXBhdF9zeXNfdGltZXJfY3Jl
YXRlKGNsb2NraWRfdCB3aGljaF9jbG9jaywKICAgc3RydWN0IGNvbXBhdF9zaWdldmVudCAq
dGltZXJfZXZlbnRfc3BlYywKICAgdGltZXJfdCAqY3JlYXRlZF90aW1lcl9pZCk7CgoKIGxv
bmcgY29tcGF0X3N5c19wdHJhY2UoY29tcGF0X2xvbmdfdCByZXF1ZXN0LCBjb21wYXRfbG9u
Z190IHBpZCwKICAgICAgY29tcGF0X2xvbmdfdCBhZGRyLCBjb21wYXRfbG9uZ190IGRhdGEp
OwoKCiBsb25nIGNvbXBhdF9zeXNfc2NoZWRfc2V0YWZmaW5pdHkoY29tcGF0X3BpZF90IHBp
ZCwKICAgICAgICAgdW5zaWduZWQgaW50IGxlbiwKICAgICAgICAgY29tcGF0X3Vsb25nX3Qg
KnVzZXJfbWFza19wdHIpOwogbG9uZyBjb21wYXRfc3lzX3NjaGVkX2dldGFmZmluaXR5KGNv
bXBhdF9waWRfdCBwaWQsCiAgICAgICAgIHVuc2lnbmVkIGludCBsZW4sCiAgICAgICAgIGNv
bXBhdF91bG9uZ190ICp1c2VyX21hc2tfcHRyKTsKCgogbG9uZyBjb21wYXRfc3lzX3NpZ2Fs
dHN0YWNrKGNvbnN0IGNvbXBhdF9zdGFja190ICp1c3NfcHRyLAogICAgICAgICAgIGNvbXBh
dF9zdGFja190ICp1b3NzX3B0cik7CiBsb25nIGNvbXBhdF9zeXNfcnRfc2lnc3VzcGVuZChj
b21wYXRfc2lnc2V0X3QgKnVuZXdzZXQsCiAgICAgIGNvbXBhdF9zaXplX3Qgc2lnc2V0c2l6
ZSk7CgogbG9uZyBjb21wYXRfc3lzX3J0X3NpZ2FjdGlvbihpbnQsCiAgICAgY29uc3Qgc3Ry
dWN0IGNvbXBhdF9zaWdhY3Rpb24gKiwKICAgICBzdHJ1Y3QgY29tcGF0X3NpZ2FjdGlvbiAq
LAogICAgIGNvbXBhdF9zaXplX3QpOwoKIGxvbmcgY29tcGF0X3N5c19ydF9zaWdwcm9jbWFz
ayhpbnQgaG93LCBjb21wYXRfc2lnc2V0X3QgKnNldCwKICAgICAgIGNvbXBhdF9zaWdzZXRf
dCAqb3NldCwKICAgICAgIGNvbXBhdF9zaXplX3Qgc2lnc2V0c2l6ZSk7CiBsb25nIGNvbXBh
dF9zeXNfcnRfc2lncGVuZGluZyhjb21wYXRfc2lnc2V0X3QgKnVzZXQsCiAgICAgIGNvbXBh
dF9zaXplX3Qgc2lnc2V0c2l6ZSk7CiBsb25nIGNvbXBhdF9zeXNfcnRfc2lndGltZWR3YWl0
X3RpbWUzMihjb21wYXRfc2lnc2V0X3QgKnV0aGVzZSwKICBzdHJ1Y3QgY29tcGF0X3NpZ2lu
Zm8gKnVpbmZvLAogIHN0cnVjdCBvbGRfdGltZXNwZWMzMiAqdXRzLCBjb21wYXRfc2l6ZV90
IHNpZ3NldHNpemUpOwogbG9uZyBjb21wYXRfc3lzX3J0X3NpZ3RpbWVkd2FpdF90aW1lNjQo
Y29tcGF0X3NpZ3NldF90ICp1dGhlc2UsCiAgc3RydWN0IGNvbXBhdF9zaWdpbmZvICp1aW5m
bywKICBzdHJ1Y3QgX19rZXJuZWxfdGltZXNwZWMgKnV0cywgY29tcGF0X3NpemVfdCBzaWdz
ZXRzaXplKTsKIGxvbmcgY29tcGF0X3N5c19ydF9zaWdxdWV1ZWluZm8oY29tcGF0X3BpZF90
IHBpZCwgaW50IHNpZywKICAgIHN0cnVjdCBjb21wYXRfc2lnaW5mbyAqdWluZm8pOwoKCgog
bG9uZyBjb21wYXRfc3lzX3RpbWVzKHN0cnVjdCBjb21wYXRfdG1zICp0YnVmKTsKIGxvbmcg
Y29tcGF0X3N5c19nZXRybGltaXQodW5zaWduZWQgaW50IHJlc291cmNlLAogICAgICAgICBz
dHJ1Y3QgY29tcGF0X3JsaW1pdCAqcmxpbSk7CiBsb25nIGNvbXBhdF9zeXNfc2V0cmxpbWl0
KHVuc2lnbmVkIGludCByZXNvdXJjZSwKICAgICAgICAgc3RydWN0IGNvbXBhdF9ybGltaXQg
KnJsaW0pOwogbG9uZyBjb21wYXRfc3lzX2dldHJ1c2FnZShpbnQgd2hvLCBzdHJ1Y3QgY29t
cGF0X3J1c2FnZSAqcnUpOwoKCiBsb25nIGNvbXBhdF9zeXNfZ2V0dGltZW9mZGF5KHN0cnVj
dCBvbGRfdGltZXZhbDMyICp0diwKICBzdHJ1Y3QgdGltZXpvbmUgKnR6KTsKIGxvbmcgY29t
cGF0X3N5c19zZXR0aW1lb2ZkYXkoc3RydWN0IG9sZF90aW1ldmFsMzIgKnR2LAogIHN0cnVj
dCB0aW1lem9uZSAqdHopOwoKCiBsb25nIGNvbXBhdF9zeXNfc3lzaW5mbyhzdHJ1Y3QgY29t
cGF0X3N5c2luZm8gKmluZm8pOwoKCiBsb25nIGNvbXBhdF9zeXNfbXFfb3Blbihjb25zdCBj
aGFyICp1X25hbWUsCiAgIGludCBvZmxhZywgY29tcGF0X21vZGVfdCBtb2RlLAogICBzdHJ1
Y3QgY29tcGF0X21xX2F0dHIgKnVfYXR0cik7CiBsb25nIGNvbXBhdF9zeXNfbXFfbm90aWZ5
KG1xZF90IG1xZGVzLAogICBjb25zdCBzdHJ1Y3QgY29tcGF0X3NpZ2V2ZW50ICp1X25vdGlm
aWNhdGlvbik7CiBsb25nIGNvbXBhdF9zeXNfbXFfZ2V0c2V0YXR0cihtcWRfdCBtcWRlcywK
ICAgY29uc3Qgc3RydWN0IGNvbXBhdF9tcV9hdHRyICp1X21xc3RhdCwKICAgc3RydWN0IGNv
bXBhdF9tcV9hdHRyICp1X29tcXN0YXQpOwoKCiBsb25nIGNvbXBhdF9zeXNfbXNnY3RsKGlu
dCBmaXJzdCwgaW50IHNlY29uZCwgdm9pZCAqdXB0cik7CiBsb25nIGNvbXBhdF9zeXNfbXNn
cmN2KGludCBtc3FpZCwgY29tcGF0X3VwdHJfdCBtc2dwLAogIGNvbXBhdF9zc2l6ZV90IG1z
Z3N6LCBjb21wYXRfbG9uZ190IG1zZ3R5cCwgaW50IG1zZ2ZsZyk7CiBsb25nIGNvbXBhdF9z
eXNfbXNnc25kKGludCBtc3FpZCwgY29tcGF0X3VwdHJfdCBtc2dwLAogIGNvbXBhdF9zc2l6
ZV90IG1zZ3N6LCBpbnQgbXNnZmxnKTsKCgogbG9uZyBjb21wYXRfc3lzX3NlbWN0bChpbnQg
c2VtaWQsIGludCBzZW1udW0sIGludCBjbWQsIGludCBhcmcpOwoKCiBsb25nIGNvbXBhdF9z
eXNfc2htY3RsKGludCBmaXJzdCwgaW50IHNlY29uZCwgdm9pZCAqdXB0cik7CiBsb25nIGNv
bXBhdF9zeXNfc2htYXQoaW50IHNobWlkLCBjb21wYXRfdXB0cl90IHNobWFkZHIsIGludCBz
aG1mbGcpOwoKCiBsb25nIGNvbXBhdF9zeXNfcmVjdmZyb20oaW50IGZkLCB2b2lkICpidWYs
IGNvbXBhdF9zaXplX3QgbGVuLAogICAgICAgdW5zaWduZWQgZmxhZ3MsIHN0cnVjdCBzb2Nr
YWRkciAqYWRkciwKICAgICAgIGludCAqYWRkcmxlbik7CiBsb25nIGNvbXBhdF9zeXNfc2V0
c29ja29wdChpbnQgZmQsIGludCBsZXZlbCwgaW50IG9wdG5hbWUsCiAgICAgICAgICBjaGFy
ICpvcHR2YWwsIHVuc2lnbmVkIGludCBvcHRsZW4pOwogbG9uZyBjb21wYXRfc3lzX2dldHNv
Y2tvcHQoaW50IGZkLCBpbnQgbGV2ZWwsIGludCBvcHRuYW1lLAogICAgICAgICAgY2hhciAq
b3B0dmFsLCBpbnQgKm9wdGxlbik7CiBsb25nIGNvbXBhdF9zeXNfc2VuZG1zZyhpbnQgZmQs
IHN0cnVjdCBjb21wYXRfbXNnaGRyICptc2csCiAgICAgICB1bnNpZ25lZCBmbGFncyk7CiBs
b25nIGNvbXBhdF9zeXNfcmVjdm1zZyhpbnQgZmQsIHN0cnVjdCBjb21wYXRfbXNnaGRyICpt
c2csCiAgICAgICB1bnNpZ25lZCBpbnQgZmxhZ3MpOwoKCgoKIGxvbmcgY29tcGF0X3N5c19r
ZXljdGwodTMyIG9wdGlvbiwKICAgICAgICAgdTMyIGFyZzIsIHUzMiBhcmczLCB1MzIgYXJn
NCwgdTMyIGFyZzUpOwoKCiBsb25nIGNvbXBhdF9zeXNfZXhlY3ZlKGNvbnN0IGNoYXIgKmZp
bGVuYW1lLCBjb25zdCBjb21wYXRfdXB0cl90ICphcmd2LAogICAgICAgY29uc3QgY29tcGF0
X3VwdHJfdCAqZW52cCk7CgoKCgogbG9uZyBjb21wYXRfc3lzX21iaW5kKGNvbXBhdF91bG9u
Z190IHN0YXJ0LCBjb21wYXRfdWxvbmdfdCBsZW4sCiAgICAgY29tcGF0X3Vsb25nX3QgbW9k
ZSwKICAgICBjb21wYXRfdWxvbmdfdCAqbm1hc2ssCiAgICAgY29tcGF0X3Vsb25nX3QgbWF4
bm9kZSwgY29tcGF0X3Vsb25nX3QgZmxhZ3MpOwogbG9uZyBjb21wYXRfc3lzX2dldF9tZW1w
b2xpY3koaW50ICpwb2xpY3ksCiAgICAgIGNvbXBhdF91bG9uZ190ICpubWFzaywKICAgICAg
Y29tcGF0X3Vsb25nX3QgbWF4bm9kZSwKICAgICAgY29tcGF0X3Vsb25nX3QgYWRkciwKICAg
ICAgY29tcGF0X3Vsb25nX3QgZmxhZ3MpOwogbG9uZyBjb21wYXRfc3lzX3NldF9tZW1wb2xp
Y3koaW50IG1vZGUsIGNvbXBhdF91bG9uZ190ICpubWFzaywKICAgICAgY29tcGF0X3Vsb25n
X3QgbWF4bm9kZSk7CiBsb25nIGNvbXBhdF9zeXNfbWlncmF0ZV9wYWdlcyhjb21wYXRfcGlk
X3QgcGlkLAogIGNvbXBhdF91bG9uZ190IG1heG5vZGUsIGNvbnN0IGNvbXBhdF91bG9uZ190
ICpvbGRfbm9kZXMsCiAgY29uc3QgY29tcGF0X3Vsb25nX3QgKm5ld19ub2Rlcyk7CiBsb25n
IGNvbXBhdF9zeXNfbW92ZV9wYWdlcyhwaWRfdCBwaWQsIGNvbXBhdF91bG9uZ190IG5yX3Bh
Z2VzLAogICAgICAgICAgX191MzIgKnBhZ2VzLAogICAgICAgICAgY29uc3QgaW50ICpub2Rl
cywKICAgICAgICAgIGludCAqc3RhdHVzLAogICAgICAgICAgaW50IGZsYWdzKTsKCiBsb25n
IGNvbXBhdF9zeXNfcnRfdGdzaWdxdWV1ZWluZm8oY29tcGF0X3BpZF90IHRnaWQsCiAgICAg
Y29tcGF0X3BpZF90IHBpZCwgaW50IHNpZywKICAgICBzdHJ1Y3QgY29tcGF0X3NpZ2luZm8g
KnVpbmZvKTsKIGxvbmcgY29tcGF0X3N5c19yZWN2bW1zZ190aW1lNjQoaW50IGZkLCBzdHJ1
Y3QgY29tcGF0X21tc2doZHIgKm1tc2csCiAgICAgICAgdW5zaWduZWQgdmxlbiwgdW5zaWdu
ZWQgaW50IGZsYWdzLAogICAgICAgIHN0cnVjdCBfX2tlcm5lbF90aW1lc3BlYyAqdGltZW91
dCk7CiBsb25nIGNvbXBhdF9zeXNfcmVjdm1tc2dfdGltZTMyKGludCBmZCwgc3RydWN0IGNv
bXBhdF9tbXNnaGRyICptbXNnLAogICAgICAgIHVuc2lnbmVkIHZsZW4sIHVuc2lnbmVkIGlu
dCBmbGFncywKICAgICAgICBzdHJ1Y3Qgb2xkX3RpbWVzcGVjMzIgKnRpbWVvdXQpOwogbG9u
ZyBjb21wYXRfc3lzX3dhaXQ0KGNvbXBhdF9waWRfdCBwaWQsCiAgICAgY29tcGF0X3VpbnRf
dCAqc3RhdF9hZGRyLCBpbnQgb3B0aW9ucywKICAgICBzdHJ1Y3QgY29tcGF0X3J1c2FnZSAq
cnUpOwogbG9uZyBjb21wYXRfc3lzX2Zhbm90aWZ5X21hcmsoaW50LCB1bnNpZ25lZCBpbnQs
IF9fdTMyLCBfX3UzMiwKICAgICAgICAgaW50LCBjb25zdCBjaGFyICopOwogbG9uZyBjb21w
YXRfc3lzX29wZW5fYnlfaGFuZGxlX2F0KGludCBtb3VudGRpcmZkLAogICAgICAgICAgc3Ry
dWN0IGZpbGVfaGFuZGxlICpoYW5kbGUsCiAgICAgICAgICBpbnQgZmxhZ3MpOwogbG9uZyBj
b21wYXRfc3lzX3NlbmRtbXNnKGludCBmZCwgc3RydWN0IGNvbXBhdF9tbXNnaGRyICptbXNn
LAogICAgICAgIHVuc2lnbmVkIHZsZW4sIHVuc2lnbmVkIGludCBmbGFncyk7CiBzc2l6ZV90
IGNvbXBhdF9zeXNfcHJvY2Vzc192bV9yZWFkdihjb21wYXRfcGlkX3QgcGlkLAogIGNvbnN0
IHN0cnVjdCBjb21wYXRfaW92ZWMgKmx2ZWMsCiAgY29tcGF0X3Vsb25nX3QgbGlvdmNudCwg
Y29uc3Qgc3RydWN0IGNvbXBhdF9pb3ZlYyAqcnZlYywKICBjb21wYXRfdWxvbmdfdCByaW92
Y250LCBjb21wYXRfdWxvbmdfdCBmbGFncyk7CiBzc2l6ZV90IGNvbXBhdF9zeXNfcHJvY2Vz
c192bV93cml0ZXYoY29tcGF0X3BpZF90IHBpZCwKICBjb25zdCBzdHJ1Y3QgY29tcGF0X2lv
dmVjICpsdmVjLAogIGNvbXBhdF91bG9uZ190IGxpb3ZjbnQsIGNvbnN0IHN0cnVjdCBjb21w
YXRfaW92ZWMgKnJ2ZWMsCiAgY29tcGF0X3Vsb25nX3QgcmlvdmNudCwgY29tcGF0X3Vsb25n
X3QgZmxhZ3MpOwogbG9uZyBjb21wYXRfc3lzX2V4ZWN2ZWF0KGludCBkZmQsIGNvbnN0IGNo
YXIgKmZpbGVuYW1lLAogICAgICAgY29uc3QgY29tcGF0X3VwdHJfdCAqYXJndiwKICAgICAg
IGNvbnN0IGNvbXBhdF91cHRyX3QgKmVudnAsIGludCBmbGFncyk7CiBzc2l6ZV90IGNvbXBh
dF9zeXNfcHJlYWR2Mihjb21wYXRfdWxvbmdfdCBmZCwKICBjb25zdCBzdHJ1Y3QgY29tcGF0
X2lvdmVjICp2ZWMsCiAgY29tcGF0X3Vsb25nX3QgdmxlbiwgdTMyIHBvc19sb3csIHUzMiBw
b3NfaGlnaCwgcndmX3QgZmxhZ3MpOwogc3NpemVfdCBjb21wYXRfc3lzX3B3cml0ZXYyKGNv
bXBhdF91bG9uZ190IGZkLAogIGNvbnN0IHN0cnVjdCBjb21wYXRfaW92ZWMgKnZlYywKICBj
b21wYXRfdWxvbmdfdCB2bGVuLCB1MzIgcG9zX2xvdywgdTMyIHBvc19oaWdoLCByd2ZfdCBm
bGFncyk7CiMgODM3ICIuL2luY2x1ZGUvbGludXgvY29tcGF0LmgiCiBsb25nIGNvbXBhdF9z
eXNfb3Blbihjb25zdCBjaGFyICpmaWxlbmFtZSwgaW50IGZsYWdzLAogICAgdW1vZGVfdCBt
b2RlKTsKCgogbG9uZyBjb21wYXRfc3lzX3NpZ25hbGZkKGludCB1ZmQsCiAgICAgICAgY29u
c3QgY29tcGF0X3NpZ3NldF90ICpzaWdtYXNrLAogICAgICAgIGNvbXBhdF9zaXplX3Qgc2ln
c2V0c2l6ZSk7CgoKIGxvbmcgY29tcGF0X3N5c19uZXdzdGF0KGNvbnN0IGNoYXIgKmZpbGVu
YW1lLAogICAgICAgc3RydWN0IGNvbXBhdF9zdGF0ICpzdGF0YnVmKTsKIGxvbmcgY29tcGF0
X3N5c19uZXdsc3RhdChjb25zdCBjaGFyICpmaWxlbmFtZSwKICAgICAgICBzdHJ1Y3QgY29t
cGF0X3N0YXQgKnN0YXRidWYpOwoKCiBsb25nIGNvbXBhdF9zeXNfc2VsZWN0KGludCBuLCBj
b21wYXRfdWxvbmdfdCAqaW5wLAogIGNvbXBhdF91bG9uZ190ICpvdXRwLCBjb21wYXRfdWxv
bmdfdCAqZXhwLAogIHN0cnVjdCBvbGRfdGltZXZhbDMyICp0dnApOwogbG9uZyBjb21wYXRf
c3lzX3VzdGF0KHVuc2lnbmVkIGRldiwgc3RydWN0IGNvbXBhdF91c3RhdCAqdTMyKTsKIGxv
bmcgY29tcGF0X3N5c19yZWN2KGludCBmZCwgdm9pZCAqYnVmLCBjb21wYXRfc2l6ZV90IGxl
biwKICAgIHVuc2lnbmVkIGZsYWdzKTsKIGxvbmcgY29tcGF0X3N5c19zeXNjdGwoc3RydWN0
IGNvbXBhdF9zeXNjdGxfYXJncyAqYXJncyk7CgoKIGxvbmcgY29tcGF0X3N5c19vbGRfcmVh
ZGRpcih1bnNpZ25lZCBpbnQgZmQsCiAgICAgICAgICAgc3RydWN0IGNvbXBhdF9vbGRfbGlu
dXhfZGlyZW50ICosCiAgICAgICAgICAgdW5zaWduZWQgaW50IGNvdW50KTsKCgogbG9uZyBj
b21wYXRfc3lzX29sZF9zZWxlY3Qoc3RydWN0IGNvbXBhdF9zZWxfYXJnX3N0cnVjdCAqYXJn
KTsKCgogbG9uZyBjb21wYXRfc3lzX2lwYyh1MzIsIGludCwgaW50LCB1MzIsIGNvbXBhdF91
cHRyX3QsIHUzMik7CgoKCiBsb25nIGNvbXBhdF9zeXNfc2lncGVuZGluZyhjb21wYXRfb2xk
X3NpZ3NldF90ICpzZXQpOwoKCgogbG9uZyBjb21wYXRfc3lzX3NpZ3Byb2NtYXNrKGludCBo
b3csIGNvbXBhdF9vbGRfc2lnc2V0X3QgKm5zZXQsCiAgICAgICAgICAgY29tcGF0X29sZF9z
aWdzZXRfdCAqb3NldCk7CgoKIGxvbmcgY29tcGF0X3N5c19zaWdhY3Rpb24oaW50IHNpZywK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHJ1Y3QgY29tcGF0
X29sZF9zaWdhY3Rpb24gKmFjdCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBzdHJ1Y3QgY29tcGF0X29sZF9zaWdhY3Rpb24gKm9hY3QpOwoKCgogbG9uZyBjb21wYXRf
c3lzX3NvY2tldGNhbGwoaW50IGNhbGwsIHUzMiAqYXJncyk7CiMgODk5ICIuL2luY2x1ZGUv
bGludXgvY29tcGF0LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19u
b19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIGluX2NvbXBhdF9zeXNjYWxsKHZvaWQp
IHsgcmV0dXJuIGlzX2NvbXBhdF90YXNrKCk7IH0KIyA5MDggIi4vaW5jbHVkZS9saW51eC9j
b21wYXQuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIHN0cnVjdCBvbGRfdGltZXZhbDMyIG5zX3RvX29sZF90aW1l
dmFsMzIoczY0IG5zZWMpCnsKIHN0cnVjdCBfX2tlcm5lbF9vbGRfdGltZXZhbCB0djsKIHN0
cnVjdCBvbGRfdGltZXZhbDMyIGN0djsKCiB0diA9IG5zX3RvX2tlcm5lbF9vbGRfdGltZXZh
bChuc2VjKTsKIGN0di50dl9zZWMgPSB0di50dl9zZWM7CiBjdHYudHZfdXNlYyA9IHR2LnR2
X3VzZWM7CgogcmV0dXJuIGN0djsKfQoKCgoKCgoKaW50IGtjb21wYXRfc3lzX3N0YXRmczY0
KGNvbnN0IGNoYXIgKiBwYXRobmFtZSwgY29tcGF0X3NpemVfdCBzeiwKICAgICAgIHN0cnVj
dCBjb21wYXRfc3RhdGZzNjQgKiBidWYpOwppbnQga2NvbXBhdF9zeXNfZnN0YXRmczY0KHVu
c2lnbmVkIGludCBmZCwgY29tcGF0X3NpemVfdCBzeiwKICAgICBzdHJ1Y3QgY29tcGF0X3N0
YXRmczY0ICogYnVmKTsKIyA5NDcgIi4vaW5jbHVkZS9saW51eC9jb21wYXQuaCIKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIHZvaWQgKmNvbXBhdF9wdHIoY29tcGF0X3VwdHJfdCB1cHRyKQp7CiByZXR1cm4gKHZv
aWQgKikodW5zaWduZWQgbG9uZyl1cHRyOwp9CgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGNvbXBhdF91cHRyX3Qg
cHRyX3RvX2NvbXBhdCh2b2lkICp1cHRyKQp7CiByZXR1cm4gKHUzMikodW5zaWduZWQgbG9u
Zyl1cHRyOwp9CiMgMjkgImFyY2gvcG93ZXJwYy9rZXJuZWwvc2lnbmFsXzMyLmMiIDIKIyAz
OSAiYXJjaC9wb3dlcnBjL2tlcm5lbC9zaWduYWxfMzIuYyIKIyAxICIuL2FyY2gvcG93ZXJw
Yy9pbmNsdWRlL2FzbS9zeXNjYWxscy5oIiAxCiMgMTAgIi4vYXJjaC9wb3dlcnBjL2luY2x1
ZGUvYXNtL3N5c2NhbGxzLmgiCnN0cnVjdCBydGFzX2FyZ3M7CgogbG9uZyBzeXNfbW1hcCh1
bnNpZ25lZCBsb25nIGFkZHIsIHNpemVfdCBsZW4sCiAgdW5zaWduZWQgbG9uZyBwcm90LCB1
bnNpZ25lZCBsb25nIGZsYWdzLAogIHVuc2lnbmVkIGxvbmcgZmQsIG9mZl90IG9mZnNldCk7
CiBsb25nIHN5c19tbWFwMih1bnNpZ25lZCBsb25nIGFkZHIsIHNpemVfdCBsZW4sCiAgdW5z
aWduZWQgbG9uZyBwcm90LCB1bnNpZ25lZCBsb25nIGZsYWdzLAogIHVuc2lnbmVkIGxvbmcg
ZmQsIHVuc2lnbmVkIGxvbmcgcGdvZmYpOwogbG9uZyBwcGM2NF9wZXJzb25hbGl0eSh1bnNp
Z25lZCBsb25nIHBlcnNvbmFsaXR5KTsKIGxvbmcgc3lzX3J0YXMoc3RydWN0IHJ0YXNfYXJn
cyAqdWFyZ3MpOwojIDQwICJhcmNoL3Bvd2VycGMva2VybmVsL3NpZ25hbF8zMi5jIiAyCiMg
MSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS91YXBpL2FzbS9zaWdjb250ZXh0LmgiIDEKIyAx
NyAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS91YXBpL2FzbS9zaWdjb250ZXh0LmgiCnN0cnVj
dCBzaWdjb250ZXh0IHsKIHVuc2lnbmVkIGxvbmcgX3VudXNlZFs0XTsKIGludCBzaWduYWw7
CgogaW50IF9wYWQwOwoKIHVuc2lnbmVkIGxvbmcgaGFuZGxlcjsKIHVuc2lnbmVkIGxvbmcg
b2xkbWFzazsKCiBzdHJ1Y3QgdXNlcl9wdF9yZWdzICpyZWdzOwoKCgoKIGVsZl9ncmVnc2V0
X3QgZ3BfcmVnczsKIGVsZl9mcHJlZ3NldF90IGZwX3JlZ3M7CiMgODcgIi4vYXJjaC9wb3dl
cnBjL2luY2x1ZGUvdWFwaS9hc20vc2lnY29udGV4dC5oIgogZWxmX3ZycmVnX3QgKnZfcmVn
czsKIGxvbmcgdm14X3Jlc2VydmVbMzQgKyAzNCArIDEgKyAzMl07Cgp9OwojIDQxICJhcmNo
L3Bvd2VycGMva2VybmVsL3NpZ25hbF8zMi5jIiAyCiMgMSAiLi9hcmNoL3Bvd2VycGMvaW5j
bHVkZS9hc20vdmRzby5oIiAxCiMgMTkgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL3Zk
c28uaCIKZXh0ZXJuIHVuc2lnbmVkIGxvbmcgdmRzbzY0X3J0X3NpZ3RyYW1wOwpleHRlcm4g
dW5zaWduZWQgbG9uZyB2ZHNvMzJfc2lndHJhbXA7CmV4dGVybiB1bnNpZ25lZCBsb25nIHZk
c28zMl9ydF9zaWd0cmFtcDsKCmludCB2ZHNvX2dldGNwdV9pbml0KHZvaWQpOwojIDQyICJh
cmNoL3Bvd2VycGMva2VybmVsL3NpZ25hbF8zMi5jIiAyCiMgMSAiLi9hcmNoL3Bvd2VycGMv
aW5jbHVkZS9hc20vc3dpdGNoX3RvLmgiIDEKIyAxMSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVk
ZS9hc20vc3dpdGNoX3RvLmgiCnN0cnVjdCB0aHJlYWRfc3RydWN0OwpzdHJ1Y3QgdGFza19z
dHJ1Y3Q7CnN0cnVjdCBwdF9yZWdzOwoKZXh0ZXJuIHN0cnVjdCB0YXNrX3N0cnVjdCAqX19z
d2l0Y2hfdG8oc3RydWN0IHRhc2tfc3RydWN0ICosCiBzdHJ1Y3QgdGFza19zdHJ1Y3QgKik7
CgoKZXh0ZXJuIHN0cnVjdCB0YXNrX3N0cnVjdCAqX3N3aXRjaChzdHJ1Y3QgdGhyZWFkX3N0
cnVjdCAqcHJldiwKICAgICAgIHN0cnVjdCB0aHJlYWRfc3RydWN0ICpuZXh0KTsKCmV4dGVy
biB2b2lkIHN3aXRjaF9ib29rZV9kZWJ1Z19yZWdzKHN0cnVjdCBkZWJ1Z19yZWcgKm5ld19k
ZWJ1Zyk7CgpleHRlcm4gaW50IGVtdWxhdGVfYWx0aXZlYyhzdHJ1Y3QgcHRfcmVncyAqKTsK
CgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSB2b2lkIHJlc3RvcmVfbWF0aChzdHJ1Y3QgcHRfcmVncyAqcmVncykK
ewp9CgoKdm9pZCByZXN0b3JlX3RtX3N0YXRlKHN0cnVjdCBwdF9yZWdzICpyZWdzKTsKCmV4
dGVybiB2b2lkIGZsdXNoX2FsbF90b190aHJlYWQoc3RydWN0IHRhc2tfc3RydWN0ICopOwpl
eHRlcm4gdm9pZCBnaXZldXBfYWxsKHN0cnVjdCB0YXNrX3N0cnVjdCAqKTsKCgpleHRlcm4g
dm9pZCBlbmFibGVfa2VybmVsX2ZwKHZvaWQpOwpleHRlcm4gdm9pZCBmbHVzaF9mcF90b190
aHJlYWQoc3RydWN0IHRhc2tfc3RydWN0ICopOwpleHRlcm4gdm9pZCBnaXZldXBfZnB1KHN0
cnVjdCB0YXNrX3N0cnVjdCAqKTsKZXh0ZXJuIHZvaWQgc2F2ZV9mcHUoc3RydWN0IHRhc2tf
c3RydWN0ICopOwpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBkaXNhYmxlX2tlcm5lbF9mcCh2b2lkKQp7CiBt
c3JfY2hlY2tfYW5kX2NsZWFyKCgxVUw8PCgxMykpKTsKfQoKCgoKCgpleHRlcm4gdm9pZCBl
bmFibGVfa2VybmVsX2FsdGl2ZWModm9pZCk7CmV4dGVybiB2b2lkIGZsdXNoX2FsdGl2ZWNf
dG9fdGhyZWFkKHN0cnVjdCB0YXNrX3N0cnVjdCAqKTsKZXh0ZXJuIHZvaWQgZ2l2ZXVwX2Fs
dGl2ZWMoc3RydWN0IHRhc2tfc3RydWN0ICopOwpleHRlcm4gdm9pZCBzYXZlX2FsdGl2ZWMo
c3RydWN0IHRhc2tfc3RydWN0ICopOwpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRl
X18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBkaXNhYmxlX2tlcm5lbF9h
bHRpdmVjKHZvaWQpCnsKIG1zcl9jaGVja19hbmRfY2xlYXIoKDFVTDw8KDI1KSkpOwp9CiMg
ODYgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL3N3aXRjaF90by5oIgpzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
dm9pZCBfX2dpdmV1cF9zcGUoc3RydWN0IHRhc2tfc3RydWN0ICp0KSB7IH0KCgpzdGF0aWMg
aW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygo
X191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9f
KSkgdm9pZCBjbGVhcl90YXNrX2ViYihzdHJ1Y3QgdGFza19zdHJ1Y3QgKnQpCnsKIyAxMDMg
Ii4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL3N3aXRjaF90by5oIgp9CgpleHRlcm4gaW50
IHNldF90aHJlYWRfdGlkcihzdHJ1Y3QgdGFza19zdHJ1Y3QgKnQpOwojIDQzICJhcmNoL3Bv
d2VycGMva2VybmVsL3NpZ25hbF8zMi5jIiAyCiMgMSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVk
ZS9hc20vdG0uaCIgMQojIDkgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL3RtLmgiCiMg
MSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS91YXBpL2FzbS90bS5oIiAxCiMgMTAgIi4vYXJj
aC9wb3dlcnBjL2luY2x1ZGUvYXNtL3RtLmgiIDIKCgoKZXh0ZXJuIHZvaWQgdG1fcmVjbGFp
bShzdHJ1Y3QgdGhyZWFkX3N0cnVjdCAqdGhyZWFkLAogICAgICAgICB1aW50OF90IGNhdXNl
KTsKZXh0ZXJuIHZvaWQgdG1fcmVjbGFpbV9jdXJyZW50KHVpbnQ4X3QgY2F1c2UpOwpleHRl
cm4gdm9pZCB0bV9yZWNoZWNrcG9pbnQoc3RydWN0IHRocmVhZF9zdHJ1Y3QgKnRocmVhZCk7
CmV4dGVybiB2b2lkIHRtX3NhdmVfc3BycyhzdHJ1Y3QgdGhyZWFkX3N0cnVjdCAqdGhyZWFk
KTsKZXh0ZXJuIHZvaWQgdG1fcmVzdG9yZV9zcHJzKHN0cnVjdCB0aHJlYWRfc3RydWN0ICp0
aHJlYWQpOwoKZXh0ZXJuIGJvb2wgdG1fc3VzcGVuZF9kaXNhYmxlZDsKIyA0NCAiYXJjaC9w
b3dlcnBjL2tlcm5lbC9zaWduYWxfMzIuYyIgMgojIDEgIi4vYXJjaC9wb3dlcnBjL2luY2x1
ZGUvYXNtL2FzbS1wcm90b3R5cGVzLmgiIDEKIyAxMyAiLi9hcmNoL3Bvd2VycGMvaW5jbHVk
ZS9hc20vYXNtLXByb3RvdHlwZXMuaCIKIyAxICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2Fz
bS9jaGVja3N1bS5oIiAxCiMgMTAgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2NoZWNr
c3VtLmgiCiMgMSAiLi9pbmNsdWRlL2xpbnV4L2luNi5oIiAxCiMgMTkgIi4vaW5jbHVkZS9s
aW51eC9pbjYuaCIKIyAxICIuL2luY2x1ZGUvdWFwaS9saW51eC9pbjYuaCIgMQojIDMzICIu
L2luY2x1ZGUvdWFwaS9saW51eC9pbjYuaCIKc3RydWN0IGluNl9hZGRyIHsKIHVuaW9uIHsK
ICBfX3U4IHU2X2FkZHI4WzE2XTsKCiAgX19iZTE2IHU2X2FkZHIxNls4XTsKICBfX2JlMzIg
dTZfYWRkcjMyWzRdOwoKIH0gaW42X3U7CgoKCgoKfTsKCgoKc3RydWN0IHNvY2thZGRyX2lu
NiB7CiB1bnNpZ25lZCBzaG9ydCBpbnQgc2luNl9mYW1pbHk7CiBfX2JlMTYgc2luNl9wb3J0
OwogX19iZTMyIHNpbjZfZmxvd2luZm87CiBzdHJ1Y3QgaW42X2FkZHIgc2luNl9hZGRyOwog
X191MzIgc2luNl9zY29wZV9pZDsKfTsKCgoKc3RydWN0IGlwdjZfbXJlcSB7Cgogc3RydWN0
IGluNl9hZGRyIGlwdjZtcl9tdWx0aWFkZHI7CgoKIGludCBpcHY2bXJfaWZpbmRleDsKfTsK
CgoKCnN0cnVjdCBpbjZfZmxvd2xhYmVsX3JlcSB7CiBzdHJ1Y3QgaW42X2FkZHIgZmxyX2Rz
dDsKIF9fYmUzMiBmbHJfbGFiZWw7CiBfX3U4IGZscl9hY3Rpb247CiBfX3U4IGZscl9zaGFy
ZTsKIF9fdTE2IGZscl9mbGFnczsKIF9fdTE2IGZscl9leHBpcmVzOwogX191MTYgZmxyX2xp
bmdlcjsKIF9fdTMyIF9fZmxyX3BhZDsKCn07CiMgMjAgIi4vaW5jbHVkZS9saW51eC9pbjYu
aCIgMgoKCgoKCmV4dGVybiBjb25zdCBzdHJ1Y3QgaW42X2FkZHIgaW42YWRkcl9hbnk7Cgpl
eHRlcm4gY29uc3Qgc3RydWN0IGluNl9hZGRyIGluNmFkZHJfbG9vcGJhY2s7CgpleHRlcm4g
Y29uc3Qgc3RydWN0IGluNl9hZGRyIGluNmFkZHJfbGlua2xvY2FsX2FsbG5vZGVzOwoKCmV4
dGVybiBjb25zdCBzdHJ1Y3QgaW42X2FkZHIgaW42YWRkcl9saW5rbG9jYWxfYWxscm91dGVy
czsKCgpleHRlcm4gY29uc3Qgc3RydWN0IGluNl9hZGRyIGluNmFkZHJfaW50ZXJmYWNlbG9j
YWxfYWxsbm9kZXM7CgoKZXh0ZXJuIGNvbnN0IHN0cnVjdCBpbjZfYWRkciBpbjZhZGRyX2lu
dGVyZmFjZWxvY2FsX2FsbHJvdXRlcnM7CgoKZXh0ZXJuIGNvbnN0IHN0cnVjdCBpbjZfYWRk
ciBpbjZhZGRyX3NpdGVsb2NhbF9hbGxyb3V0ZXJzOwojIDExICIuL2FyY2gvcG93ZXJwYy9p
bmNsdWRlL2FzbS9jaGVja3N1bS5oIiAyCiMgMjEgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUv
YXNtL2NoZWNrc3VtLmgiCmV4dGVybiBfX3dzdW0gY3N1bV9wYXJ0aWFsX2NvcHlfZ2VuZXJp
Yyhjb25zdCB2b2lkICpzcmMsIHZvaWQgKmRzdCwKICAgICAgICAgICBpbnQgbGVuLCBfX3dz
dW0gc3VtLAogICAgICAgICAgIGludCAqc3JjX2VyciwgaW50ICpkc3RfZXJyKTsKCgpleHRl
cm4gX193c3VtIGNzdW1fYW5kX2NvcHlfZnJvbV91c2VyKGNvbnN0IHZvaWQgKnNyYywgdm9p
ZCAqZHN0LAogICAgICAgICAgaW50IGxlbiwgX193c3VtIHN1bSwgaW50ICplcnJfcHRyKTsK
CmV4dGVybiBfX3dzdW0gY3N1bV9hbmRfY29weV90b191c2VyKGNvbnN0IHZvaWQgKnNyYywg
dm9pZCAqZHN0LAogICAgICAgIGludCBsZW4sIF9fd3N1bSBzdW0sIGludCAqZXJyX3B0cik7
CiMgNDAgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2NoZWNrc3VtLmgiCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSBfX3N1bTE2IGNzdW1fZm9sZChfX3dzdW0gc3VtKQp7CiB1bnNpZ25lZCBpbnQgdG1wOwoK
CiBfX2FzbV9fKCJybHdpbm0gJTAsJTEsMTYsMCwzMSIgOiAiPXIiICh0bXApIDogInIiIChz
dW0pKTsKCgoKIHJldHVybiAoIF9fc3VtMTYpKH4oKCB1MzIpc3VtICsgdG1wKSA+PiAxNik7
Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50
X2Z1bmN0aW9uX18pKSB1MzIgZnJvbTY0dG8zMih1NjQgeCkKewogcmV0dXJuICh4ICsgcm9y
NjQoeCwgMzIpKSA+PiAzMjsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIF9fd3N1bSBjc3VtX3RjcHVkcF9ub2Zv
bGQoX19iZTMyIHNhZGRyLCBfX2JlMzIgZGFkZHIsIF9fdTMyIGxlbiwKICAgICBfX3U4IHBy
b3RvLCBfX3dzdW0gc3VtKQp7CgogdTY0IHMgPSAoIHUzMilzdW07CgogcyArPSAoIHUzMilz
YWRkcjsKIHMgKz0gKCB1MzIpZGFkZHI7CgogcyArPSBwcm90byArIGxlbjsKCgoKIHJldHVy
biAoIF9fd3N1bSkgZnJvbTY0dG8zMihzKTsKIyA4MiAiLi9hcmNoL3Bvd2VycGMvaW5jbHVk
ZS9hc20vY2hlY2tzdW0uaCIKfQoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBfX3N1bTE2IGNzdW1fdGNwdWRw
X21hZ2ljKF9fYmUzMiBzYWRkciwgX19iZTMyIGRhZGRyLCBfX3UzMiBsZW4sCiAgICAgX191
OCBwcm90bywgX193c3VtIHN1bSkKewogcmV0dXJuIGNzdW1fZm9sZChjc3VtX3RjcHVkcF9u
b2ZvbGQoc2FkZHIsIGRhZGRyLCBsZW4sIHByb3RvLCBzdW0pKTsKfQoKCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBf
X3dzdW0gY3N1bV9hZGQoX193c3VtIGNzdW0sIF9fd3N1bSBhZGRlbmQpCnsKCiB1NjQgcmVz
ID0gKCB1NjQpY3N1bTsKCiBpZiAoX19idWlsdGluX2NvbnN0YW50X3AoY3N1bSkgJiYgY3N1
bSA9PSAwKQogIHJldHVybiBhZGRlbmQ7CiBpZiAoX19idWlsdGluX2NvbnN0YW50X3AoYWRk
ZW5kKSAmJiBhZGRlbmQgPT0gMCkKICByZXR1cm4gY3N1bTsKCgogcmVzICs9ICggdTY0KWFk
ZGVuZDsKIHJldHVybiAoIF9fd3N1bSkoKHUzMilyZXMgKyAocmVzID4+IDMyKSk7CgoKCgoK
Cn0KCgoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIF9fd3N1bSBpcF9mYXN0X2NzdW1fbm9mb2xkKGNvbnN0IHZv
aWQgKmlwaCwgdW5zaWduZWQgaW50IGlobCkKewogY29uc3QgdTMyICpwdHIgPSAoY29uc3Qg
dTMyICopaXBoICsgMTsKCiB1bnNpZ25lZCBpbnQgaTsKIHU2NCBzID0gKihjb25zdCB1MzIg
KilpcGg7CgogZm9yIChpID0gMDsgaSA8IGlobCAtIDE7IGkrKywgcHRyKyspCiAgcyArPSAq
cHRyOwogcmV0dXJuICggX193c3VtKWZyb202NHRvMzIocyk7CiMgMTQ2ICIuL2FyY2gvcG93
ZXJwYy9pbmNsdWRlL2FzbS9jaGVja3N1bS5oIgp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgX19zdW0xNiBpcF9m
YXN0X2NzdW0oY29uc3Qgdm9pZCAqaXBoLCB1bnNpZ25lZCBpbnQgaWhsKQp7CiByZXR1cm4g
Y3N1bV9mb2xkKGlwX2Zhc3RfY3N1bV9ub2ZvbGQoaXBoLCBpaGwpKTsKfQojIDE2NSAiLi9h
cmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vY2hlY2tzdW0uaCIKX193c3VtIF9fY3N1bV9wYXJ0
aWFsKGNvbnN0IHZvaWQgKmJ1ZmYsIGludCBsZW4sIF9fd3N1bSBzdW0pOwoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IF9fd3N1bSBjc3VtX3BhcnRpYWwoY29uc3Qgdm9pZCAqYnVmZiwgaW50IGxlbiwgX193c3Vt
IHN1bSkKewogaWYgKF9fYnVpbHRpbl9jb25zdGFudF9wKGxlbikgJiYgbGVuIDw9IDE2ICYm
IChsZW4gJiAxKSA9PSAwKSB7CiAgaWYgKGxlbiA9PSAyKQogICBzdW0gPSBjc3VtX2FkZChz
dW0sICggX193c3VtKSooY29uc3QgdTE2ICopYnVmZik7CiAgaWYgKGxlbiA+PSA0KQogICBz
dW0gPSBjc3VtX2FkZChzdW0sICggX193c3VtKSooY29uc3QgdTMyICopYnVmZik7CiAgaWYg
KGxlbiA9PSA2KQogICBzdW0gPSBjc3VtX2FkZChzdW0sICggX193c3VtKQogICAgICAgICAq
KGNvbnN0IHUxNiAqKShidWZmICsgNCkpOwogIGlmIChsZW4gPj0gOCkKICAgc3VtID0gY3N1
bV9hZGQoc3VtLCAoIF9fd3N1bSkKICAgICAgICAgKihjb25zdCB1MzIgKikoYnVmZiArIDQp
KTsKICBpZiAobGVuID09IDEwKQogICBzdW0gPSBjc3VtX2FkZChzdW0sICggX193c3VtKQog
ICAgICAgICAqKGNvbnN0IHUxNiAqKShidWZmICsgOCkpOwogIGlmIChsZW4gPj0gMTIpCiAg
IHN1bSA9IGNzdW1fYWRkKHN1bSwgKCBfX3dzdW0pCiAgICAgICAgICooY29uc3QgdTMyICop
KGJ1ZmYgKyA4KSk7CiAgaWYgKGxlbiA9PSAxNCkKICAgc3VtID0gY3N1bV9hZGQoc3VtLCAo
IF9fd3N1bSkKICAgICAgICAgKihjb25zdCB1MTYgKikoYnVmZiArIDEyKSk7CiAgaWYgKGxl
biA+PSAxNikKICAgc3VtID0gY3N1bV9hZGQoc3VtLCAoIF9fd3N1bSkKICAgICAgICAgKihj
b25zdCB1MzIgKikoYnVmZiArIDEyKSk7CiB9IGVsc2UgaWYgKF9fYnVpbHRpbl9jb25zdGFu
dF9wKGxlbikgJiYgKGxlbiAmIDMpID09IDApIHsKICBzdW0gPSBjc3VtX2FkZChzdW0sIGlw
X2Zhc3RfY3N1bV9ub2ZvbGQoYnVmZiwgbGVuID4+IDIpKTsKIH0gZWxzZSB7CiAgc3VtID0g
X19jc3VtX3BhcnRpYWwoYnVmZiwgbGVuLCBzdW0pOwogfQogcmV0dXJuIHN1bTsKfQoKCgoK
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSBfX3N1bTE2IGlwX2NvbXB1dGVfY3N1bShjb25zdCB2b2lkICpidWZmLCBp
bnQgbGVuKQp7CiByZXR1cm4gY3N1bV9mb2xkKGNzdW1fcGFydGlhbChidWZmLCBsZW4sIDAp
KTsKfQoKCl9fc3VtMTYgY3N1bV9pcHY2X21hZ2ljKGNvbnN0IHN0cnVjdCBpbjZfYWRkciAq
c2FkZHIsCiAgIGNvbnN0IHN0cnVjdCBpbjZfYWRkciAqZGFkZHIsCiAgIF9fdTMyIGxlbiwg
X191OCBwcm90bywgX193c3VtIHN1bSk7CiMgMTQgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUv
YXNtL2FzbS1wcm90b3R5cGVzLmgiIDIKCiMgMSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9h
c20vZXBhcHJfaGNhbGxzLmgiIDEKIyA1MyAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20v
ZXBhcHJfaGNhbGxzLmgiCiMgMSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS91YXBpL2FzbS9l
cGFwcl9oY2FsbHMuaCIgMQojIDU0ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9lcGFw
cl9oY2FsbHMuaCIgMgojIDEwNSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vZXBhcHJf
aGNhbGxzLmgiCmV4dGVybiBib29sIGVwYXByX3BhcmF2aXJ0X2VuYWJsZWQ7CmV4dGVybiB1
MzIgZXBhcHJfaHlwZXJjYWxsX3N0YXJ0W107CgoKaW50IF9fYXR0cmlidXRlX18oKF9fc2Vj
dGlvbl9fKCIuaW5pdC50ZXh0IikpKSBfX2F0dHJpYnV0ZV9fKChfX2NvbGRfXykpIGVwYXBy
X3BhcmF2aXJ0X2Vhcmx5X2luaXQodm9pZCk7CiMgMTM2ICIuL2FyY2gvcG93ZXJwYy9pbmNs
dWRlL2FzbS9lcGFwcl9oY2FsbHMuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHVuc2lnbmVkIGludCBldl9pbnRf
c2V0X2NvbmZpZyh1bnNpZ25lZCBpbnQgaW50ZXJydXB0LAogdWludDMyX3QgY29uZmlnLCB1
bnNpZ25lZCBpbnQgcHJpb3JpdHksIHVpbnQzMl90IGRlc3RpbmF0aW9uKQp7CiByZWdpc3Rl
ciB1aW50cHRyX3QgcjExIF9fYXNtX18oInIxMSIpOwogcmVnaXN0ZXIgdWludHB0cl90IHIz
IF9fYXNtX18oInIzIik7CiByZWdpc3RlciB1aW50cHRyX3QgcjQgX19hc21fXygicjQiKTsK
IHJlZ2lzdGVyIHVpbnRwdHJfdCByNSBfX2FzbV9fKCJyNSIpOwogcmVnaXN0ZXIgdWludHB0
cl90IHI2IF9fYXNtX18oInI2Iik7CgogcjExID0gKCgoMSkgPDwgMTYpIHwgKDQpKTsKIHIz
ID0gaW50ZXJydXB0OwogcjQgPSBjb25maWc7CiByNSA9IHByaW9yaXR5OwogcjYgPSBkZXN0
aW5hdGlvbjsKCiBhc20gdm9sYXRpbGUoImJsCWVwYXByX2h5cGVyY2FsbF9zdGFydCIKICA6
ICIrciIgKHIxMSksICIrciIgKHIzKSwgIityIiAocjQpLCAiK3IiIChyNSksICIrciIgKHI2
KQogIDogOiAicjAiLCAicjEyIiwgInhlciIsICJjdHIiLCAibHIiLCAiY2MiLCAibWVtb3J5
IiwgInIxMCIsICJyOSIsICJyOCIsICJyNyIKICk7CgogcmV0dXJuIHIzOwp9CiMgMTY4ICIu
L2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9lcGFwcl9oY2FsbHMuaCIKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHVu
c2lnbmVkIGludCBldl9pbnRfZ2V0X2NvbmZpZyh1bnNpZ25lZCBpbnQgaW50ZXJydXB0LAog
dWludDMyX3QgKmNvbmZpZywgdW5zaWduZWQgaW50ICpwcmlvcml0eSwgdWludDMyX3QgKmRl
c3RpbmF0aW9uKQp7CiByZWdpc3RlciB1aW50cHRyX3QgcjExIF9fYXNtX18oInIxMSIpOwog
cmVnaXN0ZXIgdWludHB0cl90IHIzIF9fYXNtX18oInIzIik7CiByZWdpc3RlciB1aW50cHRy
X3QgcjQgX19hc21fXygicjQiKTsKIHJlZ2lzdGVyIHVpbnRwdHJfdCByNSBfX2FzbV9fKCJy
NSIpOwogcmVnaXN0ZXIgdWludHB0cl90IHI2IF9fYXNtX18oInI2Iik7CgogcjExID0gKCgo
MSkgPDwgMTYpIHwgKDUpKTsKIHIzID0gaW50ZXJydXB0OwoKIGFzbSB2b2xhdGlsZSgiYmwJ
ZXBhcHJfaHlwZXJjYWxsX3N0YXJ0IgogIDogIityIiAocjExKSwgIityIiAocjMpLCAiPXIi
IChyNCksICI9ciIgKHI1KSwgIj1yIiAocjYpCiAgOiA6ICJyMCIsICJyMTIiLCAieGVyIiwg
ImN0ciIsICJsciIsICJjYyIsICJtZW1vcnkiLCAicjEwIiwgInI5IiwgInI4IiwgInI3Igog
KTsKCiAqY29uZmlnID0gcjQ7CiAqcHJpb3JpdHkgPSByNTsKICpkZXN0aW5hdGlvbiA9IHI2
OwoKIHJldHVybiByMzsKfQojIDE5OSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vZXBh
cHJfaGNhbGxzLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1bnNpZ25lZCBpbnQgZXZfaW50X3NldF9tYXNrKHVu
c2lnbmVkIGludCBpbnRlcnJ1cHQsCiB1bnNpZ25lZCBpbnQgbWFzaykKewogcmVnaXN0ZXIg
dWludHB0cl90IHIxMSBfX2FzbV9fKCJyMTEiKTsKIHJlZ2lzdGVyIHVpbnRwdHJfdCByMyBf
X2FzbV9fKCJyMyIpOwogcmVnaXN0ZXIgdWludHB0cl90IHI0IF9fYXNtX18oInI0Iik7Cgog
cjExID0gKCgoMSkgPDwgMTYpIHwgKDYpKTsKIHIzID0gaW50ZXJydXB0OwogcjQgPSBtYXNr
OwoKIGFzbSB2b2xhdGlsZSgiYmwJZXBhcHJfaHlwZXJjYWxsX3N0YXJ0IgogIDogIityIiAo
cjExKSwgIityIiAocjMpLCAiK3IiIChyNCkKICA6IDogInIwIiwgInIxMiIsICJ4ZXIiLCAi
Y3RyIiwgImxyIiwgImNjIiwgIm1lbW9yeSIsICJyMTAiLCAicjkiLCAicjgiLCAicjciLCAi
cjYiLCAicjUiCiApOwoKIHJldHVybiByMzsKfQojIDIyNSAiLi9hcmNoL3Bvd2VycGMvaW5j
bHVkZS9hc20vZXBhcHJfaGNhbGxzLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1bnNpZ25lZCBpbnQgZXZfaW50
X2dldF9tYXNrKHVuc2lnbmVkIGludCBpbnRlcnJ1cHQsCiB1bnNpZ25lZCBpbnQgKm1hc2sp
CnsKIHJlZ2lzdGVyIHVpbnRwdHJfdCByMTEgX19hc21fXygicjExIik7CiByZWdpc3RlciB1
aW50cHRyX3QgcjMgX19hc21fXygicjMiKTsKIHJlZ2lzdGVyIHVpbnRwdHJfdCByNCBfX2Fz
bV9fKCJyNCIpOwoKIHIxMSA9ICgoKDEpIDw8IDE2KSB8ICg3KSk7CiByMyA9IGludGVycnVw
dDsKCiBhc20gdm9sYXRpbGUoImJsCWVwYXByX2h5cGVyY2FsbF9zdGFydCIKICA6ICIrciIg
KHIxMSksICIrciIgKHIzKSwgIj1yIiAocjQpCiAgOiA6ICJyMCIsICJyMTIiLCAieGVyIiwg
ImN0ciIsICJsciIsICJjYyIsICJtZW1vcnkiLCAicjEwIiwgInI5IiwgInI4IiwgInI3Iiwg
InI2IiwgInI1IgogKTsKCiAqbWFzayA9IHI0OwoKIHJldHVybiByMzsKfQojIDI1NSAiLi9h
cmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vZXBhcHJfaGNhbGxzLmgiCnN0YXRpYyBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNl
ZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1bnNp
Z25lZCBpbnQgZXZfaW50X2VvaSh1bnNpZ25lZCBpbnQgaW50ZXJydXB0KQp7CiByZWdpc3Rl
ciB1aW50cHRyX3QgcjExIF9fYXNtX18oInIxMSIpOwogcmVnaXN0ZXIgdWludHB0cl90IHIz
IF9fYXNtX18oInIzIik7CgogcjExID0gKCgoMSkgPDwgMTYpIHwgKDEwKSk7CiByMyA9IGlu
dGVycnVwdDsKCiBhc20gdm9sYXRpbGUoImJsCWVwYXByX2h5cGVyY2FsbF9zdGFydCIKICA6
ICIrciIgKHIxMSksICIrciIgKHIzKQogIDogOiAicjAiLCAicjEyIiwgInhlciIsICJjdHIi
LCAibHIiLCAiY2MiLCAibWVtb3J5IiwgInIxMCIsICJyOSIsICJyOCIsICJyNyIsICJyNiIs
ICJyNSIsICJyNCIKICk7CgogcmV0dXJuIHIzOwp9CiMgMjgyICIuL2FyY2gvcG93ZXJwYy9p
bmNsdWRlL2FzbS9lcGFwcl9oY2FsbHMuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHVuc2lnbmVkIGludCBldl9i
eXRlX2NoYW5uZWxfc2VuZCh1bnNpZ25lZCBpbnQgaGFuZGxlLAogdW5zaWduZWQgaW50ICpj
b3VudCwgY29uc3QgY2hhciBidWZmZXJbMTZdKQp7CiByZWdpc3RlciB1aW50cHRyX3QgcjEx
IF9fYXNtX18oInIxMSIpOwogcmVnaXN0ZXIgdWludHB0cl90IHIzIF9fYXNtX18oInIzIik7
CiByZWdpc3RlciB1aW50cHRyX3QgcjQgX19hc21fXygicjQiKTsKIHJlZ2lzdGVyIHVpbnRw
dHJfdCByNSBfX2FzbV9fKCJyNSIpOwogcmVnaXN0ZXIgdWludHB0cl90IHI2IF9fYXNtX18o
InI2Iik7CiByZWdpc3RlciB1aW50cHRyX3QgcjcgX19hc21fXygicjciKTsKIHJlZ2lzdGVy
IHVpbnRwdHJfdCByOCBfX2FzbV9fKCJyOCIpOwogY29uc3QgdWludDMyX3QgKnAgPSAoY29u
c3QgdWludDMyX3QgKikgYnVmZmVyOwoKIHIxMSA9ICgoKDEpIDw8IDE2KSB8ICgxKSk7CiBy
MyA9IGhhbmRsZTsKIHI0ID0gKmNvdW50OwogcjUgPSAoKCBfX3UzMikoX19iZTMyKShwWzBd
KSk7CiByNiA9ICgoIF9fdTMyKShfX2JlMzIpKHBbMV0pKTsKIHI3ID0gKCggX191MzIpKF9f
YmUzMikocFsyXSkpOwogcjggPSAoKCBfX3UzMikoX19iZTMyKShwWzNdKSk7CgogYXNtIHZv
bGF0aWxlKCJibAllcGFwcl9oeXBlcmNhbGxfc3RhcnQiCiAgOiAiK3IiIChyMTEpLCAiK3Ii
IChyMyksCiAgICAiK3IiIChyNCksICIrciIgKHI1KSwgIityIiAocjYpLCAiK3IiIChyNyks
ICIrciIgKHI4KQogIDogOiAicjAiLCAicjEyIiwgInhlciIsICJjdHIiLCAibHIiLCAiY2Mi
LCAibWVtb3J5IiwgInIxMCIsICJyOSIKICk7CgogKmNvdW50ID0gcjQ7CgogcmV0dXJuIHIz
Owp9CiMgMzI1ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9lcGFwcl9oY2FsbHMuaCIK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIHVuc2lnbmVkIGludCBldl9ieXRlX2NoYW5uZWxfcmVjZWl2ZSh1bnNpZ25l
ZCBpbnQgaGFuZGxlLAogdW5zaWduZWQgaW50ICpjb3VudCwgY2hhciBidWZmZXJbMTZdKQp7
CiByZWdpc3RlciB1aW50cHRyX3QgcjExIF9fYXNtX18oInIxMSIpOwogcmVnaXN0ZXIgdWlu
dHB0cl90IHIzIF9fYXNtX18oInIzIik7CiByZWdpc3RlciB1aW50cHRyX3QgcjQgX19hc21f
XygicjQiKTsKIHJlZ2lzdGVyIHVpbnRwdHJfdCByNSBfX2FzbV9fKCJyNSIpOwogcmVnaXN0
ZXIgdWludHB0cl90IHI2IF9fYXNtX18oInI2Iik7CiByZWdpc3RlciB1aW50cHRyX3Qgcjcg
X19hc21fXygicjciKTsKIHJlZ2lzdGVyIHVpbnRwdHJfdCByOCBfX2FzbV9fKCJyOCIpOwog
dWludDMyX3QgKnAgPSAodWludDMyX3QgKikgYnVmZmVyOwoKIHIxMSA9ICgoKDEpIDw8IDE2
KSB8ICgyKSk7CiByMyA9IGhhbmRsZTsKIHI0ID0gKmNvdW50OwoKIGFzbSB2b2xhdGlsZSgi
YmwJZXBhcHJfaHlwZXJjYWxsX3N0YXJ0IgogIDogIityIiAocjExKSwgIityIiAocjMpLCAi
K3IiIChyNCksCiAgICAiPXIiIChyNSksICI9ciIgKHI2KSwgIj1yIiAocjcpLCAiPXIiIChy
OCkKICA6IDogInIwIiwgInIxMiIsICJ4ZXIiLCAiY3RyIiwgImxyIiwgImNjIiwgIm1lbW9y
eSIsICJyMTAiLCAicjkiCiApOwoKICpjb3VudCA9IHI0OwogcFswXSA9ICgoIF9fYmUzMiko
X191MzIpKHI1KSk7CiBwWzFdID0gKCggX19iZTMyKShfX3UzMikocjYpKTsKIHBbMl0gPSAo
KCBfX2JlMzIpKF9fdTMyKShyNykpOwogcFszXSA9ICgoIF9fYmUzMikoX191MzIpKHI4KSk7
CgogcmV0dXJuIHIzOwp9CiMgMzY4ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9lcGFw
cl9oY2FsbHMuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2lu
c3RydW1lbnRfZnVuY3Rpb25fXykpIHVuc2lnbmVkIGludCBldl9ieXRlX2NoYW5uZWxfcG9s
bCh1bnNpZ25lZCBpbnQgaGFuZGxlLAogdW5zaWduZWQgaW50ICpyeF9jb3VudCwgdW5zaWdu
ZWQgaW50ICp0eF9jb3VudCkKewogcmVnaXN0ZXIgdWludHB0cl90IHIxMSBfX2FzbV9fKCJy
MTEiKTsKIHJlZ2lzdGVyIHVpbnRwdHJfdCByMyBfX2FzbV9fKCJyMyIpOwogcmVnaXN0ZXIg
dWludHB0cl90IHI0IF9fYXNtX18oInI0Iik7CiByZWdpc3RlciB1aW50cHRyX3QgcjUgX19h
c21fXygicjUiKTsKCiByMTEgPSAoKCgxKSA8PCAxNikgfCAoMykpOwogcjMgPSBoYW5kbGU7
CgogYXNtIHZvbGF0aWxlKCJibAllcGFwcl9oeXBlcmNhbGxfc3RhcnQiCiAgOiAiK3IiIChy
MTEpLCAiK3IiIChyMyksICI9ciIgKHI0KSwgIj1yIiAocjUpCiAgOiA6ICJyMCIsICJyMTIi
LCAieGVyIiwgImN0ciIsICJsciIsICJjYyIsICJtZW1vcnkiLCAicjEwIiwgInI5IiwgInI4
IiwgInI3IiwgInI2IgogKTsKCiAqcnhfY291bnQgPSByNDsKICp0eF9jb3VudCA9IHI1OwoK
IHJldHVybiByMzsKfQojIDQwMiAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vZXBhcHJf
aGNhbGxzLmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSB1bnNpZ25lZCBpbnQgZXZfaW50X2lhY2sodW5zaWduZWQg
aW50IGhhbmRsZSwKIHVuc2lnbmVkIGludCAqdmVjdG9yKQp7CiByZWdpc3RlciB1aW50cHRy
X3QgcjExIF9fYXNtX18oInIxMSIpOwogcmVnaXN0ZXIgdWludHB0cl90IHIzIF9fYXNtX18o
InIzIik7CiByZWdpc3RlciB1aW50cHRyX3QgcjQgX19hc21fXygicjQiKTsKCiByMTEgPSAo
KCgxKSA8PCAxNikgfCAoOSkpOwogcjMgPSBoYW5kbGU7CgogYXNtIHZvbGF0aWxlKCJibAll
cGFwcl9oeXBlcmNhbGxfc3RhcnQiCiAgOiAiK3IiIChyMTEpLCAiK3IiIChyMyksICI9ciIg
KHI0KQogIDogOiAicjAiLCAicjEyIiwgInhlciIsICJjdHIiLCAibHIiLCAiY2MiLCAibWVt
b3J5IiwgInIxMCIsICJyOSIsICJyOCIsICJyNyIsICJyNiIsICJyNSIKICk7CgogKnZlY3Rv
ciA9IHI0OwoKIHJldHVybiByMzsKfQoKCgoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0
ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0
dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHVuc2lnbmVkIGludCBl
dl9kb29yYmVsbF9zZW5kKHVuc2lnbmVkIGludCBoYW5kbGUpCnsKIHJlZ2lzdGVyIHVpbnRw
dHJfdCByMTEgX19hc21fXygicjExIik7CiByZWdpc3RlciB1aW50cHRyX3QgcjMgX19hc21f
XygicjMiKTsKCiByMTEgPSAoKCgxKSA8PCAxNikgfCAoMTQpKTsKIHIzID0gaGFuZGxlOwoK
IGFzbSB2b2xhdGlsZSgiYmwJZXBhcHJfaHlwZXJjYWxsX3N0YXJ0IgogIDogIityIiAocjEx
KSwgIityIiAocjMpCiAgOiA6ICJyMCIsICJyMTIiLCAieGVyIiwgImN0ciIsICJsciIsICJj
YyIsICJtZW1vcnkiLCAicjEwIiwgInI5IiwgInI4IiwgInI3IiwgInI2IiwgInI1IiwgInI0
IgogKTsKCiByZXR1cm4gcjM7Cn0KCgoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9f
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJp
YnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHVuc2lnbmVkIGludCBldl9p
ZGxlKHZvaWQpCnsKIHJlZ2lzdGVyIHVpbnRwdHJfdCByMTEgX19hc21fXygicjExIik7CiBy
ZWdpc3RlciB1aW50cHRyX3QgcjMgX19hc21fXygicjMiKTsKCiByMTEgPSAoKCgxKSA8PCAx
NikgfCAoMTYpKTsKCiBhc20gdm9sYXRpbGUoImJsCWVwYXByX2h5cGVyY2FsbF9zdGFydCIK
ICA6ICIrciIgKHIxMSksICI9ciIgKHIzKQogIDogOiAicjAiLCAicjEyIiwgInhlciIsICJj
dHIiLCAibHIiLCAiY2MiLCAibWVtb3J5IiwgInIxMCIsICJyOSIsICJyOCIsICJyNyIsICJy
NiIsICJyNSIsICJyNCIKICk7CgogcmV0dXJuIHIzOwp9CgoKc3RhdGljIGlubGluZSBfX2F0
dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18p
KSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHVuc2lnbmVk
IGxvbmcgZXBhcHJfaHlwZXJjYWxsKHVuc2lnbmVkIGxvbmcgKmluLAogICAgICAgdW5zaWdu
ZWQgbG9uZyAqb3V0LAogICAgICAgdW5zaWduZWQgbG9uZyBucikKewogcmVnaXN0ZXIgdW5z
aWduZWQgbG9uZyByMCBhc20oInIwIik7CiByZWdpc3RlciB1bnNpZ25lZCBsb25nIHIzIGFz
bSgicjMiKSA9IGluWzBdOwogcmVnaXN0ZXIgdW5zaWduZWQgbG9uZyByNCBhc20oInI0Iikg
PSBpblsxXTsKIHJlZ2lzdGVyIHVuc2lnbmVkIGxvbmcgcjUgYXNtKCJyNSIpID0gaW5bMl07
CiByZWdpc3RlciB1bnNpZ25lZCBsb25nIHI2IGFzbSgicjYiKSA9IGluWzNdOwogcmVnaXN0
ZXIgdW5zaWduZWQgbG9uZyByNyBhc20oInI3IikgPSBpbls0XTsKIHJlZ2lzdGVyIHVuc2ln
bmVkIGxvbmcgcjggYXNtKCJyOCIpID0gaW5bNV07CiByZWdpc3RlciB1bnNpZ25lZCBsb25n
IHI5IGFzbSgicjkiKSA9IGluWzZdOwogcmVnaXN0ZXIgdW5zaWduZWQgbG9uZyByMTAgYXNt
KCJyMTAiKSA9IGluWzddOwogcmVnaXN0ZXIgdW5zaWduZWQgbG9uZyByMTEgYXNtKCJyMTEi
KSA9IG5yOwogcmVnaXN0ZXIgdW5zaWduZWQgbG9uZyByMTIgYXNtKCJyMTIiKTsKCiBhc20g
dm9sYXRpbGUoImJsCWVwYXByX2h5cGVyY2FsbF9zdGFydCIKICAgICAgIDogIj1yIihyMCks
ICI9ciIocjMpLCAiPXIiKHI0KSwgIj1yIihyNSksICI9ciIocjYpLAogICAgICAgICAiPXIi
KHI3KSwgIj1yIihyOCksICI9ciIocjkpLCAiPXIiKHIxMCksICI9ciIocjExKSwKICAgICAg
ICAgIj1yIihyMTIpCiAgICAgICA6ICJyIihyMyksICJyIihyNCksICJyIihyNSksICJyIihy
NiksICJyIihyNyksICJyIihyOCksCiAgICAgICAgICJyIihyOSksICJyIihyMTApLCAiciIo
cjExKQogICAgICAgOiAibWVtb3J5IiwgImNjIiwgInhlciIsICJjdHIiLCAibHIiKTsKCiBv
dXRbMF0gPSByNDsKIG91dFsxXSA9IHI1Owogb3V0WzJdID0gcjY7CiBvdXRbM10gPSByNzsK
IG91dFs0XSA9IHI4Owogb3V0WzVdID0gcjk7CiBvdXRbNl0gPSByMTA7CiBvdXRbN10gPSBy
MTE7CgogcmV0dXJuIHIzOwp9CiMgNTA5ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9l
cGFwcl9oY2FsbHMuaCIKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25v
X2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGxvbmcgZXBhcHJfaHlwZXJjYWxsMF8xKHVuc2ln
bmVkIGludCBuciwgdW5zaWduZWQgbG9uZyAqcjIpCnsKIHVuc2lnbmVkIGxvbmcgaW5bOF0g
PSB7MH07CiB1bnNpZ25lZCBsb25nIG91dFs4XTsKIHVuc2lnbmVkIGxvbmcgcjsKCiByID0g
ZXBhcHJfaHlwZXJjYWxsKGluLCBvdXQsIG5yKTsKICpyMiA9IG91dFswXTsKCiByZXR1cm4g
cjsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIGxvbmcgZXBhcHJfaHlwZXJjYWxsMCh1bnNpZ25lZCBpbnQgbnIp
CnsKIHVuc2lnbmVkIGxvbmcgaW5bOF0gPSB7MH07CiB1bnNpZ25lZCBsb25nIG91dFs4XTsK
CiByZXR1cm4gZXBhcHJfaHlwZXJjYWxsKGluLCBvdXQsIG5yKTsKfQoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGxv
bmcgZXBhcHJfaHlwZXJjYWxsMSh1bnNpZ25lZCBpbnQgbnIsIHVuc2lnbmVkIGxvbmcgcDEp
CnsKIHVuc2lnbmVkIGxvbmcgaW5bOF0gPSB7MH07CiB1bnNpZ25lZCBsb25nIG91dFs4XTsK
CiBpblswXSA9IHAxOwogcmV0dXJuIGVwYXByX2h5cGVyY2FsbChpbiwgb3V0LCBucik7Cn0K
CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1
bmN0aW9uX18pKSBsb25nIGVwYXByX2h5cGVyY2FsbDIodW5zaWduZWQgaW50IG5yLCB1bnNp
Z25lZCBsb25nIHAxLAogICAgICAgIHVuc2lnbmVkIGxvbmcgcDIpCnsKIHVuc2lnbmVkIGxv
bmcgaW5bOF0gPSB7MH07CiB1bnNpZ25lZCBsb25nIG91dFs4XTsKCiBpblswXSA9IHAxOwog
aW5bMV0gPSBwMjsKIHJldHVybiBlcGFwcl9oeXBlcmNhbGwoaW4sIG91dCwgbnIpOwp9Cgpz
dGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5j
dGlvbl9fKSkgbG9uZyBlcGFwcl9oeXBlcmNhbGwzKHVuc2lnbmVkIGludCBuciwgdW5zaWdu
ZWQgbG9uZyBwMSwKICAgICAgICB1bnNpZ25lZCBsb25nIHAyLCB1bnNpZ25lZCBsb25nIHAz
KQp7CiB1bnNpZ25lZCBsb25nIGluWzhdID0gezB9OwogdW5zaWduZWQgbG9uZyBvdXRbOF07
CgogaW5bMF0gPSBwMTsKIGluWzFdID0gcDI7CiBpblsyXSA9IHAzOwogcmV0dXJuIGVwYXBy
X2h5cGVyY2FsbChpbiwgb3V0LCBucik7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBsb25nIGVwYXByX2h5cGVy
Y2FsbDQodW5zaWduZWQgaW50IG5yLCB1bnNpZ25lZCBsb25nIHAxLAogICAgICAgIHVuc2ln
bmVkIGxvbmcgcDIsIHVuc2lnbmVkIGxvbmcgcDMsCiAgICAgICAgdW5zaWduZWQgbG9uZyBw
NCkKewogdW5zaWduZWQgbG9uZyBpbls4XSA9IHswfTsKIHVuc2lnbmVkIGxvbmcgb3V0Wzhd
OwoKIGluWzBdID0gcDE7CiBpblsxXSA9IHAyOwogaW5bMl0gPSBwMzsKIGluWzNdID0gcDQ7
CiByZXR1cm4gZXBhcHJfaHlwZXJjYWxsKGluLCBvdXQsIG5yKTsKfQojIDE2ICIuL2FyY2gv
cG93ZXJwYy9pbmNsdWRlL2FzbS9hc20tcHJvdG90eXBlcy5oIiAyCiMgMSAiLi9hcmNoL3Bv
d2VycGMvaW5jbHVkZS9hc20vZGNyLmgiIDEKIyAxNyAiLi9hcmNoL3Bvd2VycGMvaW5jbHVk
ZS9hc20vYXNtLXByb3RvdHlwZXMuaCIgMgojIDEgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUv
YXNtL21tdV9jb250ZXh0LmgiIDEKIyAxMiAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20v
bW11X2NvbnRleHQuaCIKIyAxICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9jcHV0aHJl
YWRzLmgiIDEKIyAyMyAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vY3B1dGhyZWFkcy5o
IgpleHRlcm4gaW50IHRocmVhZHNfcGVyX2NvcmU7CmV4dGVybiBpbnQgdGhyZWFkc19wZXJf
c3ViY29yZTsKZXh0ZXJuIGludCB0aHJlYWRzX3NoaWZ0OwpleHRlcm4gYm9vbCBoYXNfYmln
X2NvcmVzOwpleHRlcm4gY3B1bWFza190IHRocmVhZHNfY29yZV9tYXNrOwojIDQ3ICIuL2Fy
Y2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9jcHV0aHJlYWRzLmgiCnN0YXRpYyBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9f
KSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBjcHVtYXNr
X3QgY3B1X3RocmVhZF9tYXNrX3RvX2NvcmVzKGNvbnN0IHN0cnVjdCBjcHVtYXNrICp0aHJl
YWRzKQp7CiBjcHVtYXNrX3QgdG1wLCByZXM7CiBpbnQgaSwgY3B1OwoKIGNwdW1hc2tfY2xl
YXIoJnJlcyk7CiBmb3IgKGkgPSAwOyBpIDwgMjQ7IGkgKz0gdGhyZWFkc19wZXJfY29yZSkg
ewogIGNwdW1hc2tfc2hpZnRfbGVmdCgmdG1wLCAmdGhyZWFkc19jb3JlX21hc2ssIGkpOwog
IGlmIChjcHVtYXNrX2ludGVyc2VjdHModGhyZWFkcywgJnRtcCkpIHsKICAgY3B1ID0gY3B1
bWFza19uZXh0X2FuZCgtMSwgJnRtcCwgKChjb25zdCBzdHJ1Y3QgY3B1bWFzayAqKSZfX2Nw
dV9vbmxpbmVfbWFzaykpOwogICBpZiAoY3B1IDwgbnJfY3B1X2lkcykKICAgIGNwdW1hc2tf
c2V0X2NwdShjcHUsICZyZXMpOwogIH0KIH0KIHJldHVybiByZXM7Cn0KCnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBp
bnQgY3B1X25yX2NvcmVzKHZvaWQpCnsKIHJldHVybiBucl9jcHVfaWRzID4+IHRocmVhZHNf
c2hpZnQ7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBjcHVtYXNrX3QgY3B1X29ubGluZV9jb3Jlc19tYXAodm9p
ZCkKewogcmV0dXJuIGNwdV90aHJlYWRfbWFza190b19jb3JlcygoKGNvbnN0IHN0cnVjdCBj
cHVtYXNrICopJl9fY3B1X29ubGluZV9tYXNrKSk7Cn0KCgppbnQgY3B1X2NvcmVfaW5kZXhf
b2ZfdGhyZWFkKGludCBjcHUpOwppbnQgY3B1X2ZpcnN0X3RocmVhZF9vZl9jb3JlKGludCBj
b3JlKTsKCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5z
dHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGNwdV90aHJlYWRfaW5fY29yZShpbnQgY3B1KQp7
CiByZXR1cm4gY3B1ICYgKHRocmVhZHNfcGVyX2NvcmUgLSAxKTsKfQoKc3RhdGljIGlubGlu
ZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51
c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGlu
dCBjcHVfdGhyZWFkX2luX3N1YmNvcmUoaW50IGNwdSkKewogcmV0dXJuIGNwdSAmICh0aHJl
YWRzX3Blcl9zdWJjb3JlIC0gMSk7Cn0KCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgY3B1X2ZpcnN0X3RocmVh
ZF9zaWJsaW5nKGludCBjcHUpCnsKIHJldHVybiBjcHUgJiB+KHRocmVhZHNfcGVyX2NvcmUg
LSAxKTsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3Ry
dW1lbnRfZnVuY3Rpb25fXykpIGludCBjcHVfbGFzdF90aHJlYWRfc2libGluZyhpbnQgY3B1
KQp7CiByZXR1cm4gY3B1IHwgKHRocmVhZHNfcGVyX2NvcmUgLSAxKTsKfQoKc3RhdGljIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9f
dW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykp
IHUzMiBnZXRfdGVuc3Iodm9pZCkKewoKIGlmIChjcHVfaGFzX2ZlYXR1cmUoMHgwMDAwMDAw
MDAwMTAwMDAwVUwpKQogIHJldHVybiAoe3Vuc2lnbmVkIGxvbmcgcnZhbDsgYXNtIHZvbGF0
aWxlKCJtZnNwciAlMCwiICIweDFiNSIgOiAiPXIiIChydmFsKSk7IHJ2YWw7fSk7CgogcmV0
dXJuIDE7Cn0KCnZvaWQgYm9vazNlX3N0YXJ0X3RocmVhZChpbnQgdGhyZWFkLCB1bnNpZ25l
ZCBsb25nIGFkZHIpOwp2b2lkIGJvb2szZV9zdG9wX3RocmVhZChpbnQgdGhyZWFkKTsKIyAx
MyAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vbW11X2NvbnRleHQuaCIgMgoKCgoKZXh0
ZXJuIGludCBpbml0X25ld19jb250ZXh0KHN0cnVjdCB0YXNrX3N0cnVjdCAqdHNrLCBzdHJ1
Y3QgbW1fc3RydWN0ICptbSk7CmV4dGVybiB2b2lkIGRlc3Ryb3lfY29udGV4dChzdHJ1Y3Qg
bW1fc3RydWN0ICptbSk7CiMgNTAgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL21tdV9j
b250ZXh0LmgiCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBib29sIG1tX2lvbW11X2lzX2Rldm1lbShzdHJ1Y3QgbW1f
c3RydWN0ICptbSwgdW5zaWduZWQgbG9uZyBocGEsCiAgdW5zaWduZWQgaW50IHBhZ2VzaGlm
dCwgdW5zaWduZWQgbG9uZyAqc2l6ZSkKewogcmV0dXJuIGZhbHNlOwp9CnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2
b2lkIG1tX2lvbW11X2luaXQoc3RydWN0IG1tX3N0cnVjdCAqbW0pIHsgfQoKZXh0ZXJuIHZv
aWQgc3dpdGNoX3NsYihzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRzaywgc3RydWN0IG1tX3N0cnVj
dCAqbW0pOwpleHRlcm4gdm9pZCBzZXRfY29udGV4dCh1bnNpZ25lZCBsb25nIGlkLCBwZ2Rf
dCAqcGdkKTsKIyAxMDQgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL21tdV9jb250ZXh0
LmgiCmV4dGVybiB2b2lkIHN3aXRjaF9tbXVfY29udGV4dChzdHJ1Y3QgbW1fc3RydWN0ICpw
cmV2LCBzdHJ1Y3QgbW1fc3RydWN0ICpuZXh0LAogICAgICAgICAgc3RydWN0IHRhc2tfc3Ry
dWN0ICp0c2spOwpleHRlcm4gdW5zaWduZWQgbG9uZyBfX2luaXRfbmV3X2NvbnRleHQodm9p
ZCk7CmV4dGVybiB2b2lkIF9fZGVzdHJveV9jb250ZXh0KHVuc2lnbmVkIGxvbmcgY29udGV4
dF9pZCk7CmV4dGVybiB2b2lkIG1tdV9jb250ZXh0X2luaXQodm9pZCk7CnN0YXRpYyBpbmxp
bmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3Vu
dXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSBp
bnQgYWxsb2NfZXh0ZW5kZWRfY29udGV4dChzdHJ1Y3QgbW1fc3RydWN0ICptbSwKICAgICAg
dW5zaWduZWQgbG9uZyBlYSkKewoKICh7IGludCBfX3JldF93YXJuX29uID0gISEoMSk7IGlm
IChfX2J1aWx0aW5fY29uc3RhbnRfcChfX3JldF93YXJuX29uKSkgeyBpZiAoX19yZXRfd2Fy
bl9vbikgX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgkiICJ0d2kgMzEsIDAsIDAiICJcbiIg
Ii5zZWN0aW9uIF9fYnVnX3RhYmxlLFwiYXdcIlxuIiAiMjpcdCIgIi44Ynl0ZSIgIiAiICIx
YiwgJTBcbiIgIlx0LnNob3J0ICUxLCAlMlxuIiAiLm9yZyAyYislM1xuIiAiLnByZXZpb3Vz
XG4iIDogOiAiaSIgKCIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9tbXVfY29udGV4dC5o
IiksICJpIiAoMTEzKSwgImkiICgoMSA8PCAwKSB8ICgoKDkpIDw8IDgpKSksICJpIiAoc2l6
ZW9mKHN0cnVjdCBidWdfZW50cnkpKSk7IH0gZWxzZSB7IF9fYXNtX18gX192b2xhdGlsZV9f
KCAiMToJIiAidGRuZWkiICIgIiAiICU0LCAwIiAiXG4iICIuc2VjdGlvbiBfX2J1Z190YWJs
ZSxcImF3XCJcbiIgIjI6XHQiICIuOGJ5dGUiICIgIiAiMWIsICUwXG4iICJcdC5zaG9ydCAl
MSwgJTJcbiIgIi5vcmcgMmIrJTNcbiIgIi5wcmV2aW91c1xuIiA6IDogImkiICgiLi9hcmNo
L3Bvd2VycGMvaW5jbHVkZS9hc20vbW11X2NvbnRleHQuaCIpLCAiaSIgKDExMyksICJpIiAo
KDEgPDwgMCkgfCAoKDkpIDw8IDgpKSwgImkiIChzaXplb2Yoc3RydWN0IGJ1Z19lbnRyeSkp
LCAiciIgKF9fcmV0X3dhcm5fb24pKTsgfSBfX2J1aWx0aW5fZXhwZWN0KCEhKF9fcmV0X3dh
cm5fb24pLCAwKTsgfSk7CiByZXR1cm4gLTEyOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9f
YXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBuZWVkX2V4
dHJhX2NvbnRleHQoc3RydWN0IG1tX3N0cnVjdCAqbW0sIHVuc2lnbmVkIGxvbmcgZWEpCnsK
IHJldHVybiBmYWxzZTsKfQoKCgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVf
XygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHJhZGl4X2t2bV9wcmVmZXRj
aF93b3JrYXJvdW5kKHN0cnVjdCBtbV9zdHJ1Y3QgKm1tKSB7IH0KCgpleHRlcm4gdm9pZCBz
d2l0Y2hfY29wKHN0cnVjdCBtbV9zdHJ1Y3QgKm5leHQpOwpleHRlcm4gaW50IHVzZV9jb3Ao
dW5zaWduZWQgbG9uZyBhY29wLCBzdHJ1Y3QgbW1fc3RydWN0ICptbSk7CmV4dGVybiB2b2lk
IGRyb3BfY29wKHVuc2lnbmVkIGxvbmcgYWNvcCwgc3RydWN0IG1tX3N0cnVjdCAqbW0pOwoj
IDIxNyAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vbW11X2NvbnRleHQuaCIKc3RhdGlj
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18o
KF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25f
XykpIHZvaWQgaW5jX21tX2FjdGl2ZV9jcHVzKHN0cnVjdCBtbV9zdHJ1Y3QgKm1tKSB7IH0K
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIHZvaWQgZGVjX21tX2FjdGl2ZV9jcHVzKHN0cnVjdCBtbV9zdHJ1Y3QgKm1t
KSB7IH0Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIHZvaWQgbW1fY29udGV4dF9hZGRfY29wcm8oc3RydWN0IG1tX3N0
cnVjdCAqbW0pIHsgfQpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9f
aW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBtbV9jb250ZXh0X3JlbW92ZV9jb3Bybyhz
dHJ1Y3QgbW1fc3RydWN0ICptbSkgeyB9CnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1
dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIG1tX2NvbnRleHRfYWRk
X3Zhc193aW5kb3dzKHN0cnVjdCBtbV9zdHJ1Y3QgKm1tKSB7IH0Kc3RhdGljIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2Vk
X18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQg
bW1fY29udGV4dF9yZW1vdmVfdmFzX3dpbmRvd3Moc3RydWN0IG1tX3N0cnVjdCAqbW0pIHsg
fQoKCgpleHRlcm4gdm9pZCBzd2l0Y2hfbW1faXJxc19vZmYoc3RydWN0IG1tX3N0cnVjdCAq
cHJldiwgc3RydWN0IG1tX3N0cnVjdCAqbmV4dCwKICAgICAgICAgIHN0cnVjdCB0YXNrX3N0
cnVjdCAqdHNrKTsKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19p
bnN0cnVtZW50X2Z1bmN0aW9uX18pKSB2b2lkIHN3aXRjaF9tbShzdHJ1Y3QgbW1fc3RydWN0
ICpwcmV2LCBzdHJ1Y3QgbW1fc3RydWN0ICpuZXh0LAogICAgICAgIHN0cnVjdCB0YXNrX3N0
cnVjdCAqdHNrKQp7CiB1bnNpZ25lZCBsb25nIGZsYWdzOwoKIGRvIHsgZG8geyAoeyB1bnNp
Z25lZCBsb25nIF9fZHVtbXk7IHR5cGVvZihmbGFncykgX19kdW1teTI7ICh2b2lkKSgmX19k
dW1teSA9PSAmX19kdW1teTIpOyAxOyB9KTsgZmxhZ3MgPSBhcmNoX2xvY2FsX2lycV9zYXZl
KCk7IH0gd2hpbGUgKDApOyB9IHdoaWxlICgwKTsKIHN3aXRjaF9tbV9pcnFzX29mZihwcmV2
LCBuZXh0LCB0c2spOwogZG8geyBkbyB7ICh7IHVuc2lnbmVkIGxvbmcgX19kdW1teTsgdHlw
ZW9mKGZsYWdzKSBfX2R1bW15MjsgKHZvaWQpKCZfX2R1bW15ID09ICZfX2R1bW15Mik7IDE7
IH0pOyBhcmNoX2xvY2FsX2lycV9yZXN0b3JlKGZsYWdzKTsgfSB3aGlsZSAoMCk7IH0gd2hp
bGUgKDApOwp9CiMgMjQ3ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9tbXVfY29udGV4
dC5oIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVu
dF9mdW5jdGlvbl9fKSkgdm9pZCBhY3RpdmF0ZV9tbShzdHJ1Y3QgbW1fc3RydWN0ICpwcmV2
LCBzdHJ1Y3QgbW1fc3RydWN0ICpuZXh0KQp7CiBzd2l0Y2hfbW0ocHJldiwgbmV4dCwgZ2V0
X2N1cnJlbnQoKSk7Cn0KCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBlbnRlcl9sYXp5X3RsYihzdHJ1Y3Qg
bW1fc3RydWN0ICptbSwKICAgICAgc3RydWN0IHRhc2tfc3RydWN0ICp0c2spCnsKCgogbG9j
YWxfcGFjYS0+cGdkID0gKCh2b2lkICopMCk7Cgp9CgpleHRlcm4gdm9pZCBhcmNoX2V4aXRf
bW1hcChzdHJ1Y3QgbW1fc3RydWN0ICptbSk7CgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRl
X18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0
cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgdm9pZCBhcmNoX3VubWFw
KHN0cnVjdCBtbV9zdHJ1Y3QgKm1tLAogICAgICAgICB1bnNpZ25lZCBsb25nIHN0YXJ0LCB1
bnNpZ25lZCBsb25nIGVuZCkKewogaWYgKHN0YXJ0IDw9IG1tLT5jb250ZXh0LnZkc29fYmFz
ZSAmJiBtbS0+Y29udGV4dC52ZHNvX2Jhc2UgPCBlbmQpCiAgbW0tPmNvbnRleHQudmRzb19i
YXNlID0gMDsKfQoKCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9f
bm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgYm9vbCBhcmNoX3ZtYV9hY2Nlc3NfcGVybWl0
dGVkKHN0cnVjdCB2bV9hcmVhX3N0cnVjdCAqdm1hLAogIGJvb2wgd3JpdGUsIGJvb2wgZXhl
Y3V0ZSwgYm9vbCBmb3JlaWduKQp7CgogcmV0dXJuIHRydWU7Cn0KCgoKCgoKCnN0YXRpYyBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fKChf
X3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18p
KSB1NjQgcHRlX3RvX2hwdGVfcGtleV9iaXRzKHU2NCBwdGVmbGFncykKewogcmV0dXJuIDB4
MFVMOwp9CgoKCnN0YXRpYyBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19nbnVfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fKChfX3VudXNlZF9fKSkgX19hdHRyaWJ1dGVfXygoX19ub19pbnN0
cnVtZW50X2Z1bmN0aW9uX18pKSBpbnQgYXJjaF9kdXBfbW1hcChzdHJ1Y3QgbW1fc3RydWN0
ICpvbGRtbSwKICAgIHN0cnVjdCBtbV9zdHJ1Y3QgKm1tKQp7CiA7CiByZXR1cm4gMDsKfQoj
IDE4ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9hc20tcHJvdG90eXBlcy5oIiAyCiMg
MSAiLi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vdWx0cmF2aXNvci1hcGkuaCIgMQojIDE5
ICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9hc20tcHJvdG90eXBlcy5oIiAyCgojIDEg
Ii4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvdWFwaS9hc20vdWNvbnRleHQuaCIgMQojIDIxICIu
L2FyY2gvcG93ZXJwYy9pbmNsdWRlL3VhcGkvYXNtL3Vjb250ZXh0LmgiCnN0cnVjdCB1Y29u
dGV4dCB7CiB1bnNpZ25lZCBsb25nIHVjX2ZsYWdzOwogc3RydWN0IHVjb250ZXh0ICp1Y19s
aW5rOwogc3RhY2tfdCB1Y19zdGFjazsKCgoKCiBzaWdzZXRfdCB1Y19zaWdtYXNrOwoKCiBz
aWdzZXRfdCBfX3VudXNlZFsxNV07CiBzdHJ1Y3Qgc2lnY29udGV4dCB1Y19tY29udGV4dDsK
CgoKCgp9OwojIDIxICIuL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9hc20tcHJvdG90eXBl
cy5oIiAyCgoKZXh0ZXJuIHN0cnVjdCB0YXNrX3N0cnVjdCAqY3VycmVudF9zZXRbMjRdOwpl
eHRlcm4gc3RydWN0IHRhc2tfc3RydWN0ICpzZWNvbmRhcnlfY3VycmVudDsKdm9pZCBzdGFy
dF9zZWNvbmRhcnkodm9pZCAqdW51c2VkKTsKCgpzdHJ1Y3QgcGFjYV9zdHJ1Y3Q7CnN0cnVj
dCBraW1hZ2U7CmV4dGVybiBzdHJ1Y3QgcGFjYV9zdHJ1Y3Qga2V4ZWNfcGFjYTsKdm9pZCBr
ZXhlY19jb3B5X2ZsdXNoKHN0cnVjdCBraW1hZ2UgKmltYWdlKTsKCgpleHRlcm4gc3RydWN0
IHN0YXRpY19rZXkgaGNhbGxfdHJhY2Vwb2ludF9rZXk7CnZvaWQgX190cmFjZV9oY2FsbF9l
bnRyeSh1bnNpZ25lZCBsb25nIG9wY29kZSwgdW5zaWduZWQgbG9uZyAqYXJncyk7CnZvaWQg
X190cmFjZV9oY2FsbF9leGl0KGxvbmcgb3Bjb2RlLCBsb25nIHJldHZhbCwgdW5zaWduZWQg
bG9uZyAqcmV0YnVmKTsKCgoKCgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgbG9uZyB1Y2FsbF9ub3JldHModW5zaWdu
ZWQgbG9uZyBvcGNvZGUsIC4uLikKewogcmV0dXJuIDM7Cn0KCgoKaW50NjRfdCBfX29wYWxf
Y2FsbChpbnQ2NF90IGEwLCBpbnQ2NF90IGExLCBpbnQ2NF90IGEyLCBpbnQ2NF90IGEzLAog
ICAgICBpbnQ2NF90IGE0LCBpbnQ2NF90IGE1LCBpbnQ2NF90IGE2LCBpbnQ2NF90IGE3LAog
ICAgICBpbnQ2NF90IG9wY29kZSwgdWludDY0X3QgbXNyKTsKCgppbnQgZW50ZXJfdm14X3Vz
ZXJjb3B5KHZvaWQpOwppbnQgZXhpdF92bXhfdXNlcmNvcHkodm9pZCk7CmludCBlbnRlcl92
bXhfb3BzKHZvaWQpOwp2b2lkICpleGl0X3ZteF9vcHModm9pZCAqZGVzdCk7CgoKbG9uZyBt
YWNoaW5lX2NoZWNrX2Vhcmx5KHN0cnVjdCBwdF9yZWdzICpyZWdzKTsKbG9uZyBobWlfZXhj
ZXB0aW9uX3JlYWxtb2RlKHN0cnVjdCBwdF9yZWdzICpyZWdzKTsKdm9pZCBTTUlFeGNlcHRp
b24oc3RydWN0IHB0X3JlZ3MgKnJlZ3MpOwp2b2lkIGhhbmRsZV9obWlfZXhjZXB0aW9uKHN0
cnVjdCBwdF9yZWdzICpyZWdzKTsKdm9pZCBpbnN0cnVjdGlvbl9icmVha3BvaW50X2V4Y2Vw
dGlvbihzdHJ1Y3QgcHRfcmVncyAqcmVncyk7CnZvaWQgUnVuTW9kZUV4Y2VwdGlvbihzdHJ1
Y3QgcHRfcmVncyAqcmVncyk7CnZvaWQgc2luZ2xlX3N0ZXBfZXhjZXB0aW9uKHN0cnVjdCBw
dF9yZWdzICpyZWdzKTsKdm9pZCBwcm9ncmFtX2NoZWNrX2V4Y2VwdGlvbihzdHJ1Y3QgcHRf
cmVncyAqcmVncyk7CnZvaWQgYWxpZ25tZW50X2V4Y2VwdGlvbihzdHJ1Y3QgcHRfcmVncyAq
cmVncyk7CnZvaWQgU3RhY2tPdmVyZmxvdyhzdHJ1Y3QgcHRfcmVncyAqcmVncyk7CnZvaWQg
a2VybmVsX2ZwX3VuYXZhaWxhYmxlX2V4Y2VwdGlvbihzdHJ1Y3QgcHRfcmVncyAqcmVncyk7
CnZvaWQgYWx0aXZlY191bmF2YWlsYWJsZV9leGNlcHRpb24oc3RydWN0IHB0X3JlZ3MgKnJl
Z3MpOwp2b2lkIHZzeF91bmF2YWlsYWJsZV9leGNlcHRpb24oc3RydWN0IHB0X3JlZ3MgKnJl
Z3MpOwp2b2lkIGZwX3VuYXZhaWxhYmxlX3RtKHN0cnVjdCBwdF9yZWdzICpyZWdzKTsKdm9p
ZCBhbHRpdmVjX3VuYXZhaWxhYmxlX3RtKHN0cnVjdCBwdF9yZWdzICpyZWdzKTsKdm9pZCB2
c3hfdW5hdmFpbGFibGVfdG0oc3RydWN0IHB0X3JlZ3MgKnJlZ3MpOwp2b2lkIGZhY2lsaXR5
X3VuYXZhaWxhYmxlX2V4Y2VwdGlvbihzdHJ1Y3QgcHRfcmVncyAqcmVncyk7CnZvaWQgVEFV
RXhjZXB0aW9uKHN0cnVjdCBwdF9yZWdzICpyZWdzKTsKdm9pZCBhbHRpdmVjX2Fzc2lzdF9l
eGNlcHRpb24oc3RydWN0IHB0X3JlZ3MgKnJlZ3MpOwp2b2lkIHVucmVjb3ZlcmFibGVfZXhj
ZXB0aW9uKHN0cnVjdCBwdF9yZWdzICpyZWdzKTsKdm9pZCBrZXJuZWxfYmFkX3N0YWNrKHN0
cnVjdCBwdF9yZWdzICpyZWdzKTsKdm9pZCBzeXN0ZW1fcmVzZXRfZXhjZXB0aW9uKHN0cnVj
dCBwdF9yZWdzICpyZWdzKTsKdm9pZCBtYWNoaW5lX2NoZWNrX2V4Y2VwdGlvbihzdHJ1Y3Qg
cHRfcmVncyAqcmVncyk7CnZvaWQgZW11bGF0aW9uX2Fzc2lzdF9pbnRlcnJ1cHQoc3RydWN0
IHB0X3JlZ3MgKnJlZ3MpOwpsb25nIGRvX3NsYl9mYXVsdChzdHJ1Y3QgcHRfcmVncyAqcmVn
cywgdW5zaWduZWQgbG9uZyBlYSk7CnZvaWQgZG9fYmFkX3NsYl9mYXVsdChzdHJ1Y3QgcHRf
cmVncyAqcmVncywgdW5zaWduZWQgbG9uZyBlYSwgbG9uZyBlcnIpOwoKCmxvbmcgc3lzX3N3
YXBjb250ZXh0KHN0cnVjdCB1Y29udGV4dCAqb2xkX2N0eCwKICAgICAgc3RydWN0IHVjb250
ZXh0ICpuZXdfY3R4LAogICAgICBsb25nIGN0eF9zaXplKTsKIyAxMDAgIi4vYXJjaC9wb3dl
cnBjL2luY2x1ZGUvYXNtL2FzbS1wcm90b3R5cGVzLmgiCmxvbmcgc3lzdGVtX2NhbGxfZXhj
ZXB0aW9uKGxvbmcgcjMsIGxvbmcgcjQsIGxvbmcgcjUsIGxvbmcgcjYsIGxvbmcgcjcsIGxv
bmcgcjgsIHVuc2lnbmVkIGxvbmcgcjAsIHN0cnVjdCBwdF9yZWdzICpyZWdzKTsKX19hdHRy
aWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1bnNpZ25lZCBsb25nIHN5
c2NhbGxfZXhpdF9wcmVwYXJlKHVuc2lnbmVkIGxvbmcgcjMsIHN0cnVjdCBwdF9yZWdzICpy
ZWdzKTsKX19hdHRyaWJ1dGVfXygoX19ub19pbnN0cnVtZW50X2Z1bmN0aW9uX18pKSB1bnNp
Z25lZCBsb25nIGludGVycnVwdF9leGl0X3VzZXJfcHJlcGFyZShzdHJ1Y3QgcHRfcmVncyAq
cmVncywgdW5zaWduZWQgbG9uZyBtc3IpOwpfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1l
bnRfZnVuY3Rpb25fXykpIHVuc2lnbmVkIGxvbmcgaW50ZXJydXB0X2V4aXRfa2VybmVsX3By
ZXBhcmUoc3RydWN0IHB0X3JlZ3MgKnJlZ3MsIHVuc2lnbmVkIGxvbmcgbXNyKTsKCmxvbmcg
cHBjX2ZhZHZpc2U2NF82NChpbnQgZmQsIGludCBhZHZpY2UsIHUzMiBvZmZzZXRfaGlnaCwg
dTMyIG9mZnNldF9sb3csCiAgICAgICAgdTMyIGxlbl9oaWdoLCB1MzIgbGVuX2xvdyk7Cmxv
bmcgc3lzX3N3aXRjaF9lbmRpYW4odm9pZCk7Cl9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1
bWVudF9mdW5jdGlvbl9fKSkgdW5zaWduZWQgaW50IF9fY2hlY2tfaXJxX3JlcGxheSh2b2lk
KTsKdm9pZCBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHJl
c3RvcmVfaW50ZXJydXB0cyh2b2lkKTsKCgp1bnNpZ25lZCBsb25nIF9fYXR0cmlidXRlX18o
KF9fc2VjdGlvbl9fKCIuaW5pdC50ZXh0IikpKSBfX2F0dHJpYnV0ZV9fKChfX2NvbGRfXykp
IHByb21faW5pdCh1bnNpZ25lZCBsb25nIHIzLCB1bnNpZ25lZCBsb25nIHI0LAogICAgICAg
ICAgdW5zaWduZWQgbG9uZyBwcCwKICAgICAgICAgIHVuc2lnbmVkIGxvbmcgcjYsIHVuc2ln
bmVkIGxvbmcgcjcsCiAgICAgICAgICB1bnNpZ25lZCBsb25nIGtiYXNlKTsKCgp2b2lkIF9f
YXR0cmlidXRlX18oKF9fc2VjdGlvbl9fKCIuaW5pdC50ZXh0IikpKSBfX2F0dHJpYnV0ZV9f
KChfX2NvbGRfXykpIGVhcmx5X3NldHVwKHVuc2lnbmVkIGxvbmcgZHRfcHRyKTsKdm9pZCBl
YXJseV9zZXR1cF9zZWNvbmRhcnkodm9pZCk7CgoKZXh0ZXJuIHU2NCBfX2Jzd2FwZGkyKHU2
NCk7CmV4dGVybiBzNjQgX19sc2hyZGkzKHM2NCwgaW50KTsKZXh0ZXJuIHM2NCBfX2FzaGxk
aTMoczY0LCBpbnQpOwpleHRlcm4gczY0IF9fYXNocmRpMyhzNjQsIGludCk7CmV4dGVybiBp
bnQgX19jbXBkaTIoczY0LCBzNjQpOwpleHRlcm4gaW50IF9fdWNtcGRpMih1NjQsIHU2NCk7
CgoKdm9pZCBfbWNvdW50KHZvaWQpOwp1bnNpZ25lZCBsb25nIHByZXBhcmVfZnRyYWNlX3Jl
dHVybih1bnNpZ25lZCBsb25nIHBhcmVudCwgdW5zaWduZWQgbG9uZyBpcCwKICAgICAgdW5z
aWduZWQgbG9uZyBzcCk7Cgp2b2lkIHBudl9wb3dlcjlfZm9yY2Vfc210NF9jYXRjaCh2b2lk
KTsKdm9pZCBwbnZfcG93ZXI5X2ZvcmNlX3NtdDRfcmVsZWFzZSh2b2lkKTsKCgp2b2lkIHRt
X2VuYWJsZSh2b2lkKTsKdm9pZCB0bV9kaXNhYmxlKHZvaWQpOwp2b2lkIHRtX2Fib3J0KHVp
bnQ4X3QgY2F1c2UpOwoKc3RydWN0IGt2bV92Y3B1Owp2b2lkIF9rdm1wcGNfcmVzdG9yZV90
bV9wcihzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsIHU2NCBndWVzdF9tc3IpOwp2b2lkIF9rdm1w
cGNfc2F2ZV90bV9wcihzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsIHU2NCBndWVzdF9tc3IpOwoK
CmV4dGVybiBzMzIgcGF0Y2hfX2NhbGxfZmx1c2hfY291bnRfY2FjaGU7CmV4dGVybiBzMzIg
cGF0Y2hfX2ZsdXNoX2NvdW50X2NhY2hlX3JldHVybjsKZXh0ZXJuIHMzMiBwYXRjaF9fZmx1
c2hfbGlua19zdGFja19yZXR1cm47CmV4dGVybiBzMzIgcGF0Y2hfX2NhbGxfa3ZtX2ZsdXNo
X2xpbmtfc3RhY2s7CmV4dGVybiBzMzIgcGF0Y2hfX21lbXNldF9ub2NhY2hlLCBwYXRjaF9f
bWVtY3B5X25vY2FjaGU7CgpleHRlcm4gbG9uZyBmbHVzaF9jb3VudF9jYWNoZTsKZXh0ZXJu
IGxvbmcga3ZtX2ZsdXNoX2xpbmtfc3RhY2s7CgoKCgoKc3RhdGljIGlubGluZSBfX2F0dHJp
YnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBf
X2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQga3ZtcHBj
X3NhdmVfdG1faHYoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCB1NjQgbXNyLAogICAgICAgICBi
b29sIHByZXNlcnZlX252KSB7IH0Kc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9f
KChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIHZvaWQga3ZtcHBjX3Jlc3RvcmVfdG1f
aHYoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCB1NjQgbXNyLAogICAgIGJvb2wgcHJlc2VydmVf
bnYpIHsgfQoKCnZvaWQga3ZtaHZfc2F2ZV9ob3N0X3BtdSh2b2lkKTsKdm9pZCBrdm1odl9s
b2FkX2hvc3RfcG11KHZvaWQpOwp2b2lkIGt2bWh2X3NhdmVfZ3Vlc3RfcG11KHN0cnVjdCBr
dm1fdmNwdSAqdmNwdSwgYm9vbCBwbXVfaW5fdXNlKTsKdm9pZCBrdm1odl9sb2FkX2d1ZXN0
X3BtdShzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpOwoKaW50IF9fa3ZtaHZfdmNwdV9lbnRyeV9w
OShzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpOwoKbG9uZyBrdm1wcGNfaF9zZXRfZGFicihzdHJ1
Y3Qga3ZtX3ZjcHUgKnZjcHUsIHVuc2lnbmVkIGxvbmcgZGFicik7Cmxvbmcga3ZtcHBjX2hf
c2V0X3hkYWJyKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwgdW5zaWduZWQgbG9uZyBkYWJyLAog
ICB1bnNpZ25lZCBsb25nIGRhYnJ4KTsKIyA0NSAiYXJjaC9wb3dlcnBjL2tlcm5lbC9zaWdu
YWxfMzIuYyIgMgoKIyAxICJhcmNoL3Bvd2VycGMva2VybmVsL3BwYzMyLmgiIDEKCgoKCgoj
IDEgIi4vYXJjaC9wb3dlcnBjL2luY2x1ZGUvZ2VuZXJhdGVkL3VhcGkvYXNtL3NpZ2luZm8u
aCIgMQojIDcgImFyY2gvcG93ZXJwYy9rZXJuZWwvcHBjMzIuaCIgMgojIDE1ICJhcmNoL3Bv
d2VycGMva2VybmVsL3BwYzMyLmgiCnN0cnVjdCBwdF9yZWdzMzIgewogdW5zaWduZWQgaW50
IGdwclszMl07CiB1bnNpZ25lZCBpbnQgbmlwOwogdW5zaWduZWQgaW50IG1zcjsKIHVuc2ln
bmVkIGludCBvcmlnX2dwcjM7CiB1bnNpZ25lZCBpbnQgY3RyOwogdW5zaWduZWQgaW50IGxp
bms7CiB1bnNpZ25lZCBpbnQgeGVyOwogdW5zaWduZWQgaW50IGNjcjsKIHVuc2lnbmVkIGlu
dCBtcTsKIHVuc2lnbmVkIGludCB0cmFwOwogdW5zaWduZWQgaW50IGRhcjsKIHVuc2lnbmVk
IGludCBkc2lzcjsKIHVuc2lnbmVkIGludCByZXN1bHQ7Cn07CgpzdHJ1Y3Qgc2lnY29udGV4
dDMyIHsKIHVuc2lnbmVkIGludCBfdW51c2VkWzRdOwogaW50IHNpZ25hbDsKIGNvbXBhdF91
cHRyX3QgaGFuZGxlcjsKIHVuc2lnbmVkIGludCBvbGRtYXNrOwogY29tcGF0X3VwdHJfdCBy
ZWdzOwp9OwoKc3RydWN0IG1jb250ZXh0MzIgewogZWxmX2dyZWdzZXRfdDMyIG1jX2dyZWdz
OwogZWxmX2ZwcmVnc2V0X3QgbWNfZnJlZ3M7CiB1bnNpZ25lZCBpbnQgbWNfcGFkWzJdOwog
ZWxmX3ZycmVnc2V0X3QzMiBtY192cmVncyBfX2F0dHJpYnV0ZV9fKChfX2FsaWduZWRfXygx
NikpKTsKIGVsZl92c3JyZWdoYWxmX3QzMiBtY192c3JlZ3MgX19hdHRyaWJ1dGVfXygoX19h
bGlnbmVkX18oMTYpKSk7Cn07CgpzdHJ1Y3QgdWNvbnRleHQzMiB7CiB1bnNpZ25lZCBpbnQg
dWNfZmxhZ3M7CiB1bnNpZ25lZCBpbnQgdWNfbGluazsKIGNvbXBhdF9zdGFja190IHVjX3N0
YWNrOwogaW50IHVjX3BhZFs3XTsKIGNvbXBhdF91cHRyX3QgdWNfcmVnczsKIGNvbXBhdF9z
aWdzZXRfdCB1Y19zaWdtYXNrOwoKIGludCB1Y19tYXNrZXh0WzMwXTsKIGludCB1Y19wYWQy
WzNdOwogc3RydWN0IG1jb250ZXh0MzIgdWNfbWNvbnRleHQ7Cn07CiMgNDcgImFyY2gvcG93
ZXJwYy9rZXJuZWwvc2lnbmFsXzMyLmMiIDIKCgoKCgojIDEgImFyY2gvcG93ZXJwYy9rZXJu
ZWwvc2lnbmFsLmgiIDEKIyAxMyAiYXJjaC9wb3dlcnBjL2tlcm5lbC9zaWduYWwuaCIKZXh0
ZXJuIHZvaWQgKmdldF9zaWdmcmFtZShzdHJ1Y3Qga3NpZ25hbCAqa3NpZywgdW5zaWduZWQg
bG9uZyBzcCwKICAgICAgc2l6ZV90IGZyYW1lX3NpemUsIGludCBpc18zMik7CgpleHRlcm4g
aW50IGhhbmRsZV9zaWduYWwzMihzdHJ1Y3Qga3NpZ25hbCAqa3NpZywgc2lnc2V0X3QgKm9s
ZHNldCwKICAgICAgc3RydWN0IHRhc2tfc3RydWN0ICp0c2spOwoKZXh0ZXJuIGludCBoYW5k
bGVfcnRfc2lnbmFsMzIoc3RydWN0IGtzaWduYWwgKmtzaWcsIHNpZ3NldF90ICpvbGRzZXQs
CiAgICAgICAgIHN0cnVjdCB0YXNrX3N0cnVjdCAqdHNrKTsKCmV4dGVybiB1bnNpZ25lZCBs
b25nIGNvcHlfZnByX3RvX3VzZXIodm9pZCAqdG8sCiAgICAgICAgICBzdHJ1Y3QgdGFza19z
dHJ1Y3QgKnRhc2spOwpleHRlcm4gdW5zaWduZWQgbG9uZyBjb3B5X2NrZnByX3RvX3VzZXIo
dm9pZCAqdG8sCiAgICAgICAgICAgIHN0cnVjdCB0YXNrX3N0cnVjdCAqdGFzayk7CmV4dGVy
biB1bnNpZ25lZCBsb25nIGNvcHlfZnByX2Zyb21fdXNlcihzdHJ1Y3QgdGFza19zdHJ1Y3Qg
KnRhc2ssCiAgICAgdm9pZCAqZnJvbSk7CmV4dGVybiB1bnNpZ25lZCBsb25nIGNvcHlfY2tm
cHJfZnJvbV91c2VyKHN0cnVjdCB0YXNrX3N0cnVjdCAqdGFzaywKICAgICAgIHZvaWQgKmZy
b20pOwpleHRlcm4gdW5zaWduZWQgbG9uZyBnZXRfdG1fc3RhY2twb2ludGVyKHN0cnVjdCB0
YXNrX3N0cnVjdCAqdHNrKTsKIyA0NSAiYXJjaC9wb3dlcnBjL2tlcm5lbC9zaWduYWwuaCIK
ZXh0ZXJuIGludCBoYW5kbGVfcnRfc2lnbmFsNjQoc3RydWN0IGtzaWduYWwgKmtzaWcsIHNp
Z3NldF90ICpzZXQsCiAgICAgICAgIHN0cnVjdCB0YXNrX3N0cnVjdCAqdHNrKTsKIyA1MyAi
YXJjaC9wb3dlcnBjL2tlcm5lbC9zaWduYWxfMzIuYyIgMgojIDg3ICJhcmNoL3Bvd2VycGMv
a2VybmVsL3NpZ25hbF8zMi5jIgpzdGF0aWMgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykpIF9fYXR0cmlidXRlX18o
KF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IHB1dF9zaWdzZXRfdChjb21wYXRf
c2lnc2V0X3QgKnVzZXQsIHNpZ3NldF90ICpzZXQpCnsKIHJldHVybiBwdXRfY29tcGF0X3Np
Z3NldCh1c2V0LCBzZXQsIHNpemVvZigqdXNldCkpOwp9CgpzdGF0aWMgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVzZWRfXykp
IF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgaW50IGdldF9z
aWdzZXRfdChzaWdzZXRfdCAqc2V0LAogICAgICAgICAgY29uc3QgY29tcGF0X3NpZ3NldF90
ICp1c2V0KQp7CiByZXR1cm4gZ2V0X2NvbXBhdF9zaWdzZXQoc2V0LCB1c2V0KTsKfQoKCgoK
c3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0ZV9fKChfX25vX2luc3RydW1lbnRfZnVu
Y3Rpb25fXykpIGludCBzYXZlX2dlbmVyYWxfcmVncyhzdHJ1Y3QgcHRfcmVncyAqcmVncywK
ICBzdHJ1Y3QgbWNvbnRleHQzMiAqZnJhbWUpCnsKIGVsZl9ncmVnX3Q2NCAqZ3JlZ3MgPSAo
ZWxmX2dyZWdfdDY0ICopcmVnczsKIGludCBpOwoKIGVsZl9ncmVnX3Q2NCBzb2Z0ZSA9IDB4
MTsKCiAoeyBpbnQgX19yZXRfd2Fybl9vbiA9ICEhKCEoKChyZWdzKS0+dHJhcCAmIDEpID09
IDApKTsgaWYgKF9fYnVpbHRpbl9jb25zdGFudF9wKF9fcmV0X3dhcm5fb24pKSB7IGlmIChf
X3JldF93YXJuX29uKSBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CSIgInR3aSAzMSwgMCwg
MCIgIlxuIiAiLnNlY3Rpb24gX19idWdfdGFibGUsXCJhd1wiXG4iICIyOlx0IiAiLjhieXRl
IiAiICIgIjFiLCAlMFxuIiAiXHQuc2hvcnQgJTEsICUyXG4iICIub3JnIDJiKyUzXG4iICIu
cHJldmlvdXNcbiIgOiA6ICJpIiAoImFyY2gvcG93ZXJwYy9rZXJuZWwvc2lnbmFsXzMyLmMi
KSwgImkiICgxMDkpLCAiaSIgKCgxIDw8IDApIHwgKCgoOSkgPDwgOCkpKSwgImkiIChzaXpl
b2Yoc3RydWN0IGJ1Z19lbnRyeSkpKTsgfSBlbHNlIHsgX19hc21fXyBfX3ZvbGF0aWxlX18o
ICIxOgkiICJ0ZG5laSIgIiAiICIgJTQsIDAiICJcbiIgIi5zZWN0aW9uIF9fYnVnX3RhYmxl
LFwiYXdcIlxuIiAiMjpcdCIgIi44Ynl0ZSIgIiAiICIxYiwgJTBcbiIgIlx0LnNob3J0ICUx
LCAlMlxuIiAiLm9yZyAyYislM1xuIiAiLnByZXZpb3VzXG4iIDogOiAiaSIgKCJhcmNoL3Bv
d2VycGMva2VybmVsL3NpZ25hbF8zMi5jIiksICJpIiAoMTA5KSwgImkiICgoMSA8PCAwKSB8
ICgoOSkgPDwgOCkpLCAiaSIgKHNpemVvZihzdHJ1Y3QgYnVnX2VudHJ5KSksICJyIiAoX19y
ZXRfd2Fybl9vbikpOyB9IF9fYnVpbHRpbl9leHBlY3QoISEoX19yZXRfd2Fybl9vbiksIDAp
OyB9KTsKCiBmb3IgKGkgPSAwOyBpIDw9IDQzOyBpICsrKSB7CiAgaWYgKGkgPT0gMTQgJiYg
ISgoKHJlZ3MpLT50cmFwICYgMSkgPT0gMCkpCiAgIGkgPSAzMjsKICBpZiAoIGkgPT0gMzkp
IHsKICAgaWYoKHsgbG9uZyBfX3B1X2VycjsgX190eXBlb2ZfXygqKCgmZnJhbWUtPm1jX2dy
ZWdzW2ldKSkpICpfX3B1X2FkZHIgPSAoKCZmcmFtZS0+bWNfZ3JlZ3NbaV0pKTsgX190eXBl
b2ZfXygqKCgmZnJhbWUtPm1jX2dyZWdzW2ldKSkpIF9fcHVfdmFsID0gKChfX3R5cGVvZl9f
KCooJmZyYW1lLT5tY19ncmVnc1tpXSkpKSgodW5zaWduZWQgaW50KXNvZnRlKSk7IF9fdHlw
ZW9mX18oc2l6ZW9mKCooJmZyYW1lLT5tY19ncmVnc1tpXSkpKSBfX3B1X3NpemUgPSAoc2l6
ZW9mKCooJmZyYW1lLT5tY19ncmVnc1tpXSkpKTsgaWYgKCEoKCh1bnNpZ25lZCBsb25nKV9f
cHVfYWRkcikgPj0gMHg4MDAwMDAwMDAwMDAwMDAwdWwpKSBtaWdodF9mYXVsdCgpOyAodm9p
ZCkwOyBkbyB7IGFsbG93X3dyaXRlX3RvX3VzZXIoX19wdV9hZGRyLCBfX3B1X3NpemUpOyBk
byB7IF9fcHVfZXJyID0gMDsgc3dpdGNoIChfX3B1X3NpemUpIHsgY2FzZSAxOiBfX2FzbV9f
IF9fdm9sYXRpbGVfXyggIjE6CSIgInN0YiIgIiVVMiVYMiAlMSwlMgkjIHB1dF91c2VyXG4i
ICIyOlxuIiAiLnNlY3Rpb24gLmZpeHVwLFwiYXhcIlxuIiAiMzoJbGkgJTAsJTNcbiIgIgli
IDJiXG4iICIucHJldmlvdXNcbiIgIi5zZWN0aW9uIF9fZXhfdGFibGUsXCJhXCI7IiAiICIg
Ii5iYWxpZ24gNDsiICIgIiAiLmxvbmcgKDFiKSAtIC4gOyIgIiAiICIubG9uZyAoM2IpIC0g
LiA7IiAiICIgIi5wcmV2aW91cyIgIiAiIDogIj1yIiAoX19wdV9lcnIpIDogInIiIChfX3B1
X3ZhbCksICJtPD4iICgqX19wdV9hZGRyKSwgImkiICgtMTQpLCAiMCIgKF9fcHVfZXJyKSk7
IGJyZWFrOyBjYXNlIDI6IF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJIiAic3RoIiAiJVUy
JVgyICUxLCUyCSMgcHV0X3VzZXJcbiIgIjI6XG4iICIuc2VjdGlvbiAuZml4dXAsXCJheFwi
XG4iICIzOglsaSAlMCwlM1xuIiAiCWIgMmJcbiIgIi5wcmV2aW91c1xuIiAiLnNlY3Rpb24g
X19leF90YWJsZSxcImFcIjsiICIgIiAiLmJhbGlnbiA0OyIgIiAiICIubG9uZyAoMWIpIC0g
LiA7IiAiICIgIi5sb25nICgzYikgLSAuIDsiICIgIiAiLnByZXZpb3VzIiAiICIgOiAiPXIi
IChfX3B1X2VycikgOiAiciIgKF9fcHVfdmFsKSwgIm08PiIgKCpfX3B1X2FkZHIpLCAiaSIg
KC0xNCksICIwIiAoX19wdV9lcnIpKTsgYnJlYWs7IGNhc2UgNDogX19hc21fXyBfX3ZvbGF0
aWxlX18oICIxOgkiICJzdHciICIlVTIlWDIgJTEsJTIJIyBwdXRfdXNlclxuIiAiMjpcbiIg
Ii5zZWN0aW9uIC5maXh1cCxcImF4XCJcbiIgIjM6CWxpICUwLCUzXG4iICIJYiAyYlxuIiAi
LnByZXZpb3VzXG4iICIuc2VjdGlvbiBfX2V4X3RhYmxlLFwiYVwiOyIgIiAiICIuYmFsaWdu
IDQ7IiAiICIgIi5sb25nICgxYikgLSAuIDsiICIgIiAiLmxvbmcgKDNiKSAtIC4gOyIgIiAi
ICIucHJldmlvdXMiICIgIiA6ICI9ciIgKF9fcHVfZXJyKSA6ICJyIiAoX19wdV92YWwpLCAi
bTw+IiAoKl9fcHVfYWRkciksICJpIiAoLTE0KSwgIjAiIChfX3B1X2VycikpOyBicmVhazsg
Y2FzZSA4OiBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CSIgInN0ZCIgIiVVMiVYMiAlMSwl
MgkjIHB1dF91c2VyXG4iICIyOlxuIiAiLnNlY3Rpb24gLmZpeHVwLFwiYXhcIlxuIiAiMzoJ
bGkgJTAsJTNcbiIgIgliIDJiXG4iICIucHJldmlvdXNcbiIgIi5zZWN0aW9uIF9fZXhfdGFi
bGUsXCJhXCI7IiAiICIgIi5iYWxpZ24gNDsiICIgIiAiLmxvbmcgKDFiKSAtIC4gOyIgIiAi
ICIubG9uZyAoM2IpIC0gLiA7IiAiICIgIi5wcmV2aW91cyIgIiAiIDogIj1yIiAoX19wdV9l
cnIpIDogInIiIChfX3B1X3ZhbCksICJtPD4iICgqX19wdV9hZGRyKSwgImkiICgtMTQpLCAi
MCIgKF9fcHVfZXJyKSk7IGJyZWFrOyBkZWZhdWx0OiBfX3B1dF91c2VyX2JhZCgpOyB9IH0g
d2hpbGUgKDApOyBwcmV2ZW50X3dyaXRlX3RvX3VzZXIoX19wdV9hZGRyLCBfX3B1X3NpemUp
OyB9IHdoaWxlICgwKTsgX19wdV9lcnI7IH0pKQogICAgcmV0dXJuIC0xNDsKICAgZWxzZQog
ICAgY29udGludWU7CiAgfQogIGlmICgoeyBsb25nIF9fcHVfZXJyOyBfX3R5cGVvZl9fKCoo
KCZmcmFtZS0+bWNfZ3JlZ3NbaV0pKSkgKl9fcHVfYWRkciA9ICgoJmZyYW1lLT5tY19ncmVn
c1tpXSkpOyBfX3R5cGVvZl9fKCooKCZmcmFtZS0+bWNfZ3JlZ3NbaV0pKSkgX19wdV92YWwg
PSAoKF9fdHlwZW9mX18oKigmZnJhbWUtPm1jX2dyZWdzW2ldKSkpKCh1bnNpZ25lZCBpbnQp
Z3JlZ3NbaV0pKTsgX190eXBlb2ZfXyhzaXplb2YoKigmZnJhbWUtPm1jX2dyZWdzW2ldKSkp
IF9fcHVfc2l6ZSA9IChzaXplb2YoKigmZnJhbWUtPm1jX2dyZWdzW2ldKSkpOyBpZiAoISgo
KHVuc2lnbmVkIGxvbmcpX19wdV9hZGRyKSA+PSAweDgwMDAwMDAwMDAwMDAwMDB1bCkpIG1p
Z2h0X2ZhdWx0KCk7ICh2b2lkKTA7IGRvIHsgYWxsb3dfd3JpdGVfdG9fdXNlcihfX3B1X2Fk
ZHIsIF9fcHVfc2l6ZSk7IGRvIHsgX19wdV9lcnIgPSAwOyBzd2l0Y2ggKF9fcHVfc2l6ZSkg
eyBjYXNlIDE6IF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJIiAic3RiIiAiJVUyJVgyICUx
LCUyCSMgcHV0X3VzZXJcbiIgIjI6XG4iICIuc2VjdGlvbiAuZml4dXAsXCJheFwiXG4iICIz
OglsaSAlMCwlM1xuIiAiCWIgMmJcbiIgIi5wcmV2aW91c1xuIiAiLnNlY3Rpb24gX19leF90
YWJsZSxcImFcIjsiICIgIiAiLmJhbGlnbiA0OyIgIiAiICIubG9uZyAoMWIpIC0gLiA7IiAi
ICIgIi5sb25nICgzYikgLSAuIDsiICIgIiAiLnByZXZpb3VzIiAiICIgOiAiPXIiIChfX3B1
X2VycikgOiAiciIgKF9fcHVfdmFsKSwgIm08PiIgKCpfX3B1X2FkZHIpLCAiaSIgKC0xNCks
ICIwIiAoX19wdV9lcnIpKTsgYnJlYWs7IGNhc2UgMjogX19hc21fXyBfX3ZvbGF0aWxlX18o
ICIxOgkiICJzdGgiICIlVTIlWDIgJTEsJTIJIyBwdXRfdXNlclxuIiAiMjpcbiIgIi5zZWN0
aW9uIC5maXh1cCxcImF4XCJcbiIgIjM6CWxpICUwLCUzXG4iICIJYiAyYlxuIiAiLnByZXZp
b3VzXG4iICIuc2VjdGlvbiBfX2V4X3RhYmxlLFwiYVwiOyIgIiAiICIuYmFsaWduIDQ7IiAi
ICIgIi5sb25nICgxYikgLSAuIDsiICIgIiAiLmxvbmcgKDNiKSAtIC4gOyIgIiAiICIucHJl
dmlvdXMiICIgIiA6ICI9ciIgKF9fcHVfZXJyKSA6ICJyIiAoX19wdV92YWwpLCAibTw+IiAo
Kl9fcHVfYWRkciksICJpIiAoLTE0KSwgIjAiIChfX3B1X2VycikpOyBicmVhazsgY2FzZSA0
OiBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CSIgInN0dyIgIiVVMiVYMiAlMSwlMgkjIHB1
dF91c2VyXG4iICIyOlxuIiAiLnNlY3Rpb24gLmZpeHVwLFwiYXhcIlxuIiAiMzoJbGkgJTAs
JTNcbiIgIgliIDJiXG4iICIucHJldmlvdXNcbiIgIi5zZWN0aW9uIF9fZXhfdGFibGUsXCJh
XCI7IiAiICIgIi5iYWxpZ24gNDsiICIgIiAiLmxvbmcgKDFiKSAtIC4gOyIgIiAiICIubG9u
ZyAoM2IpIC0gLiA7IiAiICIgIi5wcmV2aW91cyIgIiAiIDogIj1yIiAoX19wdV9lcnIpIDog
InIiIChfX3B1X3ZhbCksICJtPD4iICgqX19wdV9hZGRyKSwgImkiICgtMTQpLCAiMCIgKF9f
cHVfZXJyKSk7IGJyZWFrOyBjYXNlIDg6IF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJIiAi
c3RkIiAiJVUyJVgyICUxLCUyCSMgcHV0X3VzZXJcbiIgIjI6XG4iICIuc2VjdGlvbiAuZml4
dXAsXCJheFwiXG4iICIzOglsaSAlMCwlM1xuIiAiCWIgMmJcbiIgIi5wcmV2aW91c1xuIiAi
LnNlY3Rpb24gX19leF90YWJsZSxcImFcIjsiICIgIiAiLmJhbGlnbiA0OyIgIiAiICIubG9u
ZyAoMWIpIC0gLiA7IiAiICIgIi5sb25nICgzYikgLSAuIDsiICIgIiAiLnByZXZpb3VzIiAi
ICIgOiAiPXIiIChfX3B1X2VycikgOiAiciIgKF9fcHVfdmFsKSwgIm08PiIgKCpfX3B1X2Fk
ZHIpLCAiaSIgKC0xNCksICIwIiAoX19wdV9lcnIpKTsgYnJlYWs7IGRlZmF1bHQ6IF9fcHV0
X3VzZXJfYmFkKCk7IH0gfSB3aGlsZSAoMCk7IHByZXZlbnRfd3JpdGVfdG9fdXNlcihfX3B1
X2FkZHIsIF9fcHVfc2l6ZSk7IH0gd2hpbGUgKDApOyBfX3B1X2VycjsgfSkpCiAgIHJldHVy
biAtMTQ7CiB9CiByZXR1cm4gMDsKfQoKc3RhdGljIGlubGluZSBfX2F0dHJpYnV0ZV9fKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSBfX2F0dHJpYnV0
ZV9fKChfX25vX2luc3RydW1lbnRfZnVuY3Rpb25fXykpIGludCByZXN0b3JlX2dlbmVyYWxf
cmVncyhzdHJ1Y3QgcHRfcmVncyAqcmVncywKICBzdHJ1Y3QgbWNvbnRleHQzMiAqc3IpCnsK
IGVsZl9ncmVnX3Q2NCAqZ3JlZ3MgPSAoZWxmX2dyZWdfdDY0ICopcmVnczsKIGludCBpOwoK
IGZvciAoaSA9IDA7IGkgPD0gNDM7IGkrKykgewogIGlmICgoaSA9PSAzMykgfHwgKGkgPT0g
MzkpKQogICBjb250aW51ZTsKICBpZiAoKHsgbG9uZyBfX2d1X2VycjsgX190eXBlb2ZfXyhf
X2J1aWx0aW5fY2hvb3NlX2V4cHIoc2l6ZW9mKCooKCZzci0+bWNfZ3JlZ3NbaV0pKSkgPiBz
aXplb2YoMFVMKSwgMFVMTCwgMFVMKSkgX19ndV92YWw7IF9fdHlwZW9mX18oKigoJnNyLT5t
Y19ncmVnc1tpXSkpKSAqX19ndV9hZGRyID0gKCgmc3ItPm1jX2dyZWdzW2ldKSk7IF9fdHlw
ZW9mX18oc2l6ZW9mKCooJnNyLT5tY19ncmVnc1tpXSkpKSBfX2d1X3NpemUgPSAoc2l6ZW9m
KCooJnNyLT5tY19ncmVnc1tpXSkpKTsgKHZvaWQpMDsgaWYgKCEoKCh1bnNpZ25lZCBsb25n
KV9fZ3VfYWRkcikgPj0gMHg4MDAwMDAwMDAwMDAwMDAwdWwpKSBtaWdodF9mYXVsdCgpOyBh
c20gKCI5NTM6IC5wdXNoc2VjdGlvbiBfX2JhcnJpZXJfbm9zcGVjX2ZpeHVwLFwiYVwiOyAu
YWxpZ24gMjsgOTU0OiAuOGJ5dGUgOTUzYi05NTRiOyAucG9wc2VjdGlvbjs7IG5vcDsgbm9w
IiAiICIgOjo6ICJtZW1vcnkiKTsgaWYgKHRydWUpIGRvIHsgYWxsb3dfcmVhZF9mcm9tX3Vz
ZXIoX19ndV9hZGRyLCBfX2d1X3NpemUpOyBkbyB7IF9fZ3VfZXJyID0gMDsgKHZvaWQpMDsg
aWYgKF9fZ3Vfc2l6ZSA+IHNpemVvZihfX2d1X3ZhbCkpIChfX2d1X3ZhbCkgPSBfX2dldF91
c2VyX2JhZCgpOyBzd2l0Y2ggKF9fZ3Vfc2l6ZSkgeyBjYXNlIDE6IF9fYXNtX18gX192b2xh
dGlsZV9fKCAiMToJIiJsYnoiIiVVMiVYMiAlMSwgJTIJIyBnZXRfdXNlclxuIiAiMjpcbiIg
Ii5zZWN0aW9uIC5maXh1cCxcImF4XCJcbiIgIjM6CWxpICUwLCUzXG4iICIJbGkgJTEsMFxu
IiAiCWIgMmJcbiIgIi5wcmV2aW91c1xuIiAiLnNlY3Rpb24gX19leF90YWJsZSxcImFcIjsi
ICIgIiAiLmJhbGlnbiA0OyIgIiAiICIubG9uZyAoMWIpIC0gLiA7IiAiICIgIi5sb25nICgz
YikgLSAuIDsiICIgIiAiLnByZXZpb3VzIiAiICIgOiAiPXIiIChfX2d1X2VyciksICI9ciIg
KF9fZ3VfdmFsKSA6ICJtPD4iICgqKHU4ICopX19ndV9hZGRyKSwgImkiICgtMTQpLCAiMCIg
KF9fZ3VfZXJyKSk7IGJyZWFrOyBjYXNlIDI6IF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJ
IiJsaHoiIiVVMiVYMiAlMSwgJTIJIyBnZXRfdXNlclxuIiAiMjpcbiIgIi5zZWN0aW9uIC5m
aXh1cCxcImF4XCJcbiIgIjM6CWxpICUwLCUzXG4iICIJbGkgJTEsMFxuIiAiCWIgMmJcbiIg
Ii5wcmV2aW91c1xuIiAiLnNlY3Rpb24gX19leF90YWJsZSxcImFcIjsiICIgIiAiLmJhbGln
biA0OyIgIiAiICIubG9uZyAoMWIpIC0gLiA7IiAiICIgIi5sb25nICgzYikgLSAuIDsiICIg
IiAiLnByZXZpb3VzIiAiICIgOiAiPXIiIChfX2d1X2VyciksICI9ciIgKF9fZ3VfdmFsKSA6
ICJtPD4iICgqKHUxNiAqKV9fZ3VfYWRkciksICJpIiAoLTE0KSwgIjAiIChfX2d1X2Vycikp
OyBicmVhazsgY2FzZSA0OiBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CSIibHd6IiIlVTIl
WDIgJTEsICUyCSMgZ2V0X3VzZXJcbiIgIjI6XG4iICIuc2VjdGlvbiAuZml4dXAsXCJheFwi
XG4iICIzOglsaSAlMCwlM1xuIiAiCWxpICUxLDBcbiIgIgliIDJiXG4iICIucHJldmlvdXNc
biIgIi5zZWN0aW9uIF9fZXhfdGFibGUsXCJhXCI7IiAiICIgIi5iYWxpZ24gNDsiICIgIiAi
LmxvbmcgKDFiKSAtIC4gOyIgIiAiICIubG9uZyAoM2IpIC0gLiA7IiAiICIgIi5wcmV2aW91
cyIgIiAiIDogIj1yIiAoX19ndV9lcnIpLCAiPXIiIChfX2d1X3ZhbCkgOiAibTw+IiAoKih1
MzIgKilfX2d1X2FkZHIpLCAiaSIgKC0xNCksICIwIiAoX19ndV9lcnIpKTsgYnJlYWs7IGNh
c2UgODogX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgkiImxkIiIlVTIlWDIgJTEsICUyCSMg
Z2V0X3VzZXJcbiIgIjI6XG4iICIuc2VjdGlvbiAuZml4dXAsXCJheFwiXG4iICIzOglsaSAl
MCwlM1xuIiAiCWxpICUxLDBcbiIgIgliIDJiXG4iICIucHJldmlvdXNcbiIgIi5zZWN0aW9u
IF9fZXhfdGFibGUsXCJhXCI7IiAiICIgIi5iYWxpZ24gNDsiICIgIiAiLmxvbmcgKDFiKSAt
IC4gOyIgIiAiICIubG9uZyAoM2IpIC0gLiA7IiAiICIgIi5wcmV2aW91cyIgIiAiIDogIj1y
IiAoX19ndV9lcnIpLCAiPXIiIChfX2d1X3ZhbCkgOiAibTw+IiAoKih1NjQgKilfX2d1X2Fk
ZHIpLCAiaSIgKC0xNCksICIwIiAoX19ndV9lcnIpKTsgYnJlYWs7IGRlZmF1bHQ6IChfX2d1
X3ZhbCkgPSBfX2dldF91c2VyX2JhZCgpOyB9IH0gd2hpbGUgKDApOyBwcmV2ZW50X3JlYWRf
ZnJvbV91c2VyKF9fZ3VfYWRkciwgX19ndV9zaXplKTsgfSB3aGlsZSAoMCk7IGVsc2UgZG8g
eyBfX2d1X2VyciA9IDA7ICh2b2lkKTA7IGlmIChfX2d1X3NpemUgPiBzaXplb2YoX19ndV92
YWwpKSAoX19ndV92YWwpID0gX19nZXRfdXNlcl9iYWQoKTsgc3dpdGNoIChfX2d1X3NpemUp
IHsgY2FzZSAxOiBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CSIibGJ6IiIlVTIlWDIgJTEs
ICUyCSMgZ2V0X3VzZXJcbiIgIjI6XG4iICIuc2VjdGlvbiAuZml4dXAsXCJheFwiXG4iICIz
OglsaSAlMCwlM1xuIiAiCWxpICUxLDBcbiIgIgliIDJiXG4iICIucHJldmlvdXNcbiIgIi5z
ZWN0aW9uIF9fZXhfdGFibGUsXCJhXCI7IiAiICIgIi5iYWxpZ24gNDsiICIgIiAiLmxvbmcg
KDFiKSAtIC4gOyIgIiAiICIubG9uZyAoM2IpIC0gLiA7IiAiICIgIi5wcmV2aW91cyIgIiAi
IDogIj1yIiAoX19ndV9lcnIpLCAiPXIiIChfX2d1X3ZhbCkgOiAibTw+IiAoKih1OCAqKV9f
Z3VfYWRkciksICJpIiAoLTE0KSwgIjAiIChfX2d1X2VycikpOyBicmVhazsgY2FzZSAyOiBf
X2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CSIibGh6IiIlVTIlWDIgJTEsICUyCSMgZ2V0X3Vz
ZXJcbiIgIjI6XG4iICIuc2VjdGlvbiAuZml4dXAsXCJheFwiXG4iICIzOglsaSAlMCwlM1xu
IiAiCWxpICUxLDBcbiIgIgliIDJiXG4iICIucHJldmlvdXNcbiIgIi5zZWN0aW9uIF9fZXhf
dGFibGUsXCJhXCI7IiAiICIgIi5iYWxpZ24gNDsiICIgIiAiLmxvbmcgKDFiKSAtIC4gOyIg
IiAiICIubG9uZyAoM2IpIC0gLiA7IiAiICIgIi5wcmV2aW91cyIgIiAiIDogIj1yIiAoX19n
dV9lcnIpLCAiPXIiIChfX2d1X3ZhbCkgOiAibTw+IiAoKih1MTYgKilfX2d1X2FkZHIpLCAi
aSIgKC0xNCksICIwIiAoX19ndV9lcnIpKTsgYnJlYWs7IGNhc2UgNDogX19hc21fXyBfX3Zv
bGF0aWxlX18oICIxOgkiImx3eiIiJVUyJVgyICUxLCAlMgkjIGdldF91c2VyXG4iICIyOlxu
IiAiLnNlY3Rpb24gLmZpeHVwLFwiYXhcIlxuIiAiMzoJbGkgJTAsJTNcbiIgIglsaSAlMSww
XG4iICIJYiAyYlxuIiAiLnByZXZpb3VzXG4iICIuc2VjdGlvbiBfX2V4X3RhYmxlLFwiYVwi
OyIgIiAiICIuYmFsaWduIDQ7IiAiICIgIi5sb25nICgxYikgLSAuIDsiICIgIiAiLmxvbmcg
KDNiKSAtIC4gOyIgIiAiICIucHJldmlvdXMiICIgIiA6ICI9ciIgKF9fZ3VfZXJyKSwgIj1y
IiAoX19ndV92YWwpIDogIm08PiIgKCoodTMyICopX19ndV9hZGRyKSwgImkiICgtMTQpLCAi
MCIgKF9fZ3VfZXJyKSk7IGJyZWFrOyBjYXNlIDg6IF9fYXNtX18gX192b2xhdGlsZV9fKCAi
MToJIiJsZCIiJVUyJVgyICUxLCAlMgkjIGdldF91c2VyXG4iICIyOlxuIiAiLnNlY3Rpb24g
LmZpeHVwLFwiYXhcIlxuIiAiMzoJbGkgJTAsJTNcbiIgIglsaSAlMSwwXG4iICIJYiAyYlxu
IiAiLnByZXZpb3VzXG4iICIuc2VjdGlvbiBfX2V4X3RhYmxlLFwiYVwiOyIgIiAiICIuYmFs
aWduIDQ7IiAiICIgIi5sb25nICgxYikgLSAuIDsiICIgIiAiLmxvbmcgKDNiKSAtIC4gOyIg
IiAiICIucHJldmlvdXMiICIgIiA6ICI9ciIgKF9fZ3VfZXJyKSwgIj1yIiAoX19ndV92YWwp
IDogIm08PiIgKCoodTY0ICopX19ndV9hZGRyKSwgImkiICgtMTQpLCAiMCIgKF9fZ3VfZXJy
KSk7IGJyZWFrOyBkZWZhdWx0OiAoX19ndV92YWwpID0gX19nZXRfdXNlcl9iYWQoKTsgfSB9
IHdoaWxlICgwKTsgKChncmVnc1tpXSkpID0gKF9fdHlwZW9mX18oKigoJnNyLT5tY19ncmVn
c1tpXSkpKSlfX2d1X3ZhbDsgX19ndV9lcnI7IH0pKQogICByZXR1cm4gLTE0OwogfQogcmV0
dXJuIDA7Cn0KIyAxOTIgImFyY2gvcG93ZXJwYy9rZXJuZWwvc2lnbmFsXzMyLmMiCnN0cnVj
dCBzaWdmcmFtZSB7CiBzdHJ1Y3Qgc2lnY29udGV4dDMyIHNjdHg7CiBzdHJ1Y3QgbWNvbnRl
eHQzMiBtY3R4OwojIDIwMyAiYXJjaC9wb3dlcnBjL2tlcm5lbC9zaWduYWxfMzIuYyIKIGlu
dCBhYmlnYXBbNTZdOwp9OwojIDIyMCAiYXJjaC9wb3dlcnBjL2tlcm5lbC9zaWduYWxfMzIu
YyIKc3RydWN0IHJ0X3NpZ2ZyYW1lIHsKCiBjb21wYXRfc2lnaW5mb190IGluZm87CgoKCiBz
dHJ1Y3QgdWNvbnRleHQzMiB1YzsKCgoKCgoKCiBpbnQgYWJpZ2FwWzU2XTsKfTsKCgoKCgoK
c3RhdGljIGludCBzYXZlX3VzZXJfcmVncyhzdHJ1Y3QgcHRfcmVncyAqcmVncywgc3RydWN0
IG1jb250ZXh0MzIgKmZyYW1lLAogICAgIHN0cnVjdCBtY29udGV4dDMyICp0bV9mcmFtZSwg
aW50IHNpZ3JldCwKICAgICBpbnQgY3R4X2hhc192c3hfcmVnaW9uKQp7CiB1bnNpZ25lZCBs
b25nIG1zciA9IHJlZ3MtPm1zcjsKCgogZmx1c2hfZnBfdG9fdGhyZWFkKGdldF9jdXJyZW50
KCkpOwoKCiBpZiAoc2F2ZV9nZW5lcmFsX3JlZ3MocmVncywgZnJhbWUpKQogIHJldHVybiAx
OwoKCgogaWYgKGdldF9jdXJyZW50KCktPnRocmVhZC51c2VkX3ZyKSB7CiAgZmx1c2hfYWx0
aXZlY190b190aHJlYWQoZ2V0X2N1cnJlbnQoKSk7CiAgaWYgKF9fY29weV90b191c2VyKCZm
cmFtZS0+bWNfdnJlZ3MsICZnZXRfY3VycmVudCgpLT50aHJlYWQudnJfc3RhdGUsCiAgICAg
ICAzMyAqIHNpemVvZih2ZWN0b3IxMjgpKSkKICAgcmV0dXJuIDE7CgoKICBtc3IgfD0gKDFV
TDw8KDI1KSk7CiB9CiMgMjc0ICJhcmNoL3Bvd2VycGMva2VybmVsL3NpZ25hbF8zMi5jIgog
aWYgKGNwdV9oYXNfZmVhdHVyZSgweDAwMDAwMDAyVUwpKQogIGdldF9jdXJyZW50KCktPnRo
cmVhZC52cnNhdmUgPSAoe3Vuc2lnbmVkIGxvbmcgcnZhbDsgYXNtIHZvbGF0aWxlKCJtZnNw
ciAlMCwiICIweDEwMCIgOiAiPXIiIChydmFsKSk7IHJ2YWw7fSk7CiBpZiAoKHsgbG9uZyBf
X3B1X2VycjsgX190eXBlb2ZfXygqKCgodTMyICopJmZyYW1lLT5tY192cmVnc1szMl0pKSkg
Kl9fcHVfYWRkciA9ICgoKHUzMiAqKSZmcmFtZS0+bWNfdnJlZ3NbMzJdKSk7IF9fdHlwZW9m
X18oKigoKHUzMiAqKSZmcmFtZS0+bWNfdnJlZ3NbMzJdKSkpIF9fcHVfdmFsID0gKChfX3R5
cGVvZl9fKCooKHUzMiAqKSZmcmFtZS0+bWNfdnJlZ3NbMzJdKSkpKGdldF9jdXJyZW50KCkt
PnRocmVhZC52cnNhdmUpKTsgX190eXBlb2ZfXyhzaXplb2YoKigodTMyICopJmZyYW1lLT5t
Y192cmVnc1szMl0pKSkgX19wdV9zaXplID0gKHNpemVvZigqKCh1MzIgKikmZnJhbWUtPm1j
X3ZyZWdzWzMyXSkpKTsgaWYgKCEoKCh1bnNpZ25lZCBsb25nKV9fcHVfYWRkcikgPj0gMHg4
MDAwMDAwMDAwMDAwMDAwdWwpKSBtaWdodF9mYXVsdCgpOyAodm9pZCkwOyBkbyB7IGFsbG93
X3dyaXRlX3RvX3VzZXIoX19wdV9hZGRyLCBfX3B1X3NpemUpOyBkbyB7IF9fcHVfZXJyID0g
MDsgc3dpdGNoIChfX3B1X3NpemUpIHsgY2FzZSAxOiBfX2FzbV9fIF9fdm9sYXRpbGVfXygg
IjE6CSIgInN0YiIgIiVVMiVYMiAlMSwlMgkjIHB1dF91c2VyXG4iICIyOlxuIiAiLnNlY3Rp
b24gLmZpeHVwLFwiYXhcIlxuIiAiMzoJbGkgJTAsJTNcbiIgIgliIDJiXG4iICIucHJldmlv
dXNcbiIgIi5zZWN0aW9uIF9fZXhfdGFibGUsXCJhXCI7IiAiICIgIi5iYWxpZ24gNDsiICIg
IiAiLmxvbmcgKDFiKSAtIC4gOyIgIiAiICIubG9uZyAoM2IpIC0gLiA7IiAiICIgIi5wcmV2
aW91cyIgIiAiIDogIj1yIiAoX19wdV9lcnIpIDogInIiIChfX3B1X3ZhbCksICJtPD4iICgq
X19wdV9hZGRyKSwgImkiICgtMTQpLCAiMCIgKF9fcHVfZXJyKSk7IGJyZWFrOyBjYXNlIDI6
IF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJIiAic3RoIiAiJVUyJVgyICUxLCUyCSMgcHV0
X3VzZXJcbiIgIjI6XG4iICIuc2VjdGlvbiAuZml4dXAsXCJheFwiXG4iICIzOglsaSAlMCwl
M1xuIiAiCWIgMmJcbiIgIi5wcmV2aW91c1xuIiAiLnNlY3Rpb24gX19leF90YWJsZSxcImFc
IjsiICIgIiAiLmJhbGlnbiA0OyIgIiAiICIubG9uZyAoMWIpIC0gLiA7IiAiICIgIi5sb25n
ICgzYikgLSAuIDsiICIgIiAiLnByZXZpb3VzIiAiICIgOiAiPXIiIChfX3B1X2VycikgOiAi
ciIgKF9fcHVfdmFsKSwgIm08PiIgKCpfX3B1X2FkZHIpLCAiaSIgKC0xNCksICIwIiAoX19w
dV9lcnIpKTsgYnJlYWs7IGNhc2UgNDogX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgkiICJz
dHciICIlVTIlWDIgJTEsJTIJIyBwdXRfdXNlclxuIiAiMjpcbiIgIi5zZWN0aW9uIC5maXh1
cCxcImF4XCJcbiIgIjM6CWxpICUwLCUzXG4iICIJYiAyYlxuIiAiLnByZXZpb3VzXG4iICIu
c2VjdGlvbiBfX2V4X3RhYmxlLFwiYVwiOyIgIiAiICIuYmFsaWduIDQ7IiAiICIgIi5sb25n
ICgxYikgLSAuIDsiICIgIiAiLmxvbmcgKDNiKSAtIC4gOyIgIiAiICIucHJldmlvdXMiICIg
IiA6ICI9ciIgKF9fcHVfZXJyKSA6ICJyIiAoX19wdV92YWwpLCAibTw+IiAoKl9fcHVfYWRk
ciksICJpIiAoLTE0KSwgIjAiIChfX3B1X2VycikpOyBicmVhazsgY2FzZSA4OiBfX2FzbV9f
IF9fdm9sYXRpbGVfXyggIjE6CSIgInN0ZCIgIiVVMiVYMiAlMSwlMgkjIHB1dF91c2VyXG4i
ICIyOlxuIiAiLnNlY3Rpb24gLmZpeHVwLFwiYXhcIlxuIiAiMzoJbGkgJTAsJTNcbiIgIgli
IDJiXG4iICIucHJldmlvdXNcbiIgIi5zZWN0aW9uIF9fZXhfdGFibGUsXCJhXCI7IiAiICIg
Ii5iYWxpZ24gNDsiICIgIiAiLmxvbmcgKDFiKSAtIC4gOyIgIiAiICIubG9uZyAoM2IpIC0g
LiA7IiAiICIgIi5wcmV2aW91cyIgIiAiIDogIj1yIiAoX19wdV9lcnIpIDogInIiIChfX3B1
X3ZhbCksICJtPD4iICgqX19wdV9hZGRyKSwgImkiICgtMTQpLCAiMCIgKF9fcHVfZXJyKSk7
IGJyZWFrOyBkZWZhdWx0OiBfX3B1dF91c2VyX2JhZCgpOyB9IH0gd2hpbGUgKDApOyBwcmV2
ZW50X3dyaXRlX3RvX3VzZXIoX19wdV9hZGRyLCBfX3B1X3NpemUpOyB9IHdoaWxlICgwKTsg
X19wdV9lcnI7IH0pKQogIHJldHVybiAxOwoKIGlmIChjb3B5X2Zwcl90b191c2VyKCZmcmFt
ZS0+bWNfZnJlZ3MsIGdldF9jdXJyZW50KCkpKQogIHJldHVybiAxOwoKCgoKCiBtc3IgJj0g
figxVUw8PCgyMykpOwojIDMxOSAiYXJjaC9wb3dlcnBjL2tlcm5lbC9zaWduYWxfMzIuYyIK
IGlmICgoeyBsb25nIF9fcHVfZXJyOyBfX3R5cGVvZl9fKCooKCZmcmFtZS0+bWNfZ3JlZ3Nb
MzNdKSkpICpfX3B1X2FkZHIgPSAoKCZmcmFtZS0+bWNfZ3JlZ3NbMzNdKSk7IF9fdHlwZW9m
X18oKigoJmZyYW1lLT5tY19ncmVnc1szM10pKSkgX19wdV92YWwgPSAoKF9fdHlwZW9mX18o
KigmZnJhbWUtPm1jX2dyZWdzWzMzXSkpKShtc3IpKTsgX190eXBlb2ZfXyhzaXplb2YoKigm
ZnJhbWUtPm1jX2dyZWdzWzMzXSkpKSBfX3B1X3NpemUgPSAoc2l6ZW9mKCooJmZyYW1lLT5t
Y19ncmVnc1szM10pKSk7IGlmICghKCgodW5zaWduZWQgbG9uZylfX3B1X2FkZHIpID49IDB4
ODAwMDAwMDAwMDAwMDAwMHVsKSkgbWlnaHRfZmF1bHQoKTsgKHZvaWQpMDsgZG8geyBhbGxv
d193cml0ZV90b191c2VyKF9fcHVfYWRkciwgX19wdV9zaXplKTsgZG8geyBfX3B1X2VyciA9
IDA7IHN3aXRjaCAoX19wdV9zaXplKSB7IGNhc2UgMTogX19hc21fXyBfX3ZvbGF0aWxlX18o
ICIxOgkiICJzdGIiICIlVTIlWDIgJTEsJTIJIyBwdXRfdXNlclxuIiAiMjpcbiIgIi5zZWN0
aW9uIC5maXh1cCxcImF4XCJcbiIgIjM6CWxpICUwLCUzXG4iICIJYiAyYlxuIiAiLnByZXZp
b3VzXG4iICIuc2VjdGlvbiBfX2V4X3RhYmxlLFwiYVwiOyIgIiAiICIuYmFsaWduIDQ7IiAi
ICIgIi5sb25nICgxYikgLSAuIDsiICIgIiAiLmxvbmcgKDNiKSAtIC4gOyIgIiAiICIucHJl
dmlvdXMiICIgIiA6ICI9ciIgKF9fcHVfZXJyKSA6ICJyIiAoX19wdV92YWwpLCAibTw+IiAo
Kl9fcHVfYWRkciksICJpIiAoLTE0KSwgIjAiIChfX3B1X2VycikpOyBicmVhazsgY2FzZSAy
OiBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CSIgInN0aCIgIiVVMiVYMiAlMSwlMgkjIHB1
dF91c2VyXG4iICIyOlxuIiAiLnNlY3Rpb24gLmZpeHVwLFwiYXhcIlxuIiAiMzoJbGkgJTAs
JTNcbiIgIgliIDJiXG4iICIucHJldmlvdXNcbiIgIi5zZWN0aW9uIF9fZXhfdGFibGUsXCJh
XCI7IiAiICIgIi5iYWxpZ24gNDsiICIgIiAiLmxvbmcgKDFiKSAtIC4gOyIgIiAiICIubG9u
ZyAoM2IpIC0gLiA7IiAiICIgIi5wcmV2aW91cyIgIiAiIDogIj1yIiAoX19wdV9lcnIpIDog
InIiIChfX3B1X3ZhbCksICJtPD4iICgqX19wdV9hZGRyKSwgImkiICgtMTQpLCAiMCIgKF9f
cHVfZXJyKSk7IGJyZWFrOyBjYXNlIDQ6IF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJIiAi
c3R3IiAiJVUyJVgyICUxLCUyCSMgcHV0X3VzZXJcbiIgIjI6XG4iICIuc2VjdGlvbiAuZml4
dXAsXCJheFwiXG4iICIzOglsaSAlMCwlM1xuIiAiCWIgMmJcbiIgIi5wcmV2aW91c1xuIiAi
LnNlY3Rpb24gX19leF90YWJsZSxcImFcIjsiICIgIiAiLmJhbGlnbiA0OyIgIiAiICIubG9u
ZyAoMWIpIC0gLiA7IiAiICIgIi5sb25nICgzYikgLSAuIDsiICIgIiAiLnByZXZpb3VzIiAi
ICIgOiAiPXIiIChfX3B1X2VycikgOiAiciIgKF9fcHVfdmFsKSwgIm08PiIgKCpfX3B1X2Fk
ZHIpLCAiaSIgKC0xNCksICIwIiAoX19wdV9lcnIpKTsgYnJlYWs7IGNhc2UgODogX19hc21f
XyBfX3ZvbGF0aWxlX18oICIxOgkiICJzdGQiICIlVTIlWDIgJTEsJTIJIyBwdXRfdXNlclxu
IiAiMjpcbiIgIi5zZWN0aW9uIC5maXh1cCxcImF4XCJcbiIgIjM6CWxpICUwLCUzXG4iICIJ
YiAyYlxuIiAiLnByZXZpb3VzXG4iICIuc2VjdGlvbiBfX2V4X3RhYmxlLFwiYVwiOyIgIiAi
ICIuYmFsaWduIDQ7IiAiICIgIi5sb25nICgxYikgLSAuIDsiICIgIiAiLmxvbmcgKDNiKSAt
IC4gOyIgIiAiICIucHJldmlvdXMiICIgIiA6ICI9ciIgKF9fcHVfZXJyKSA6ICJyIiAoX19w
dV92YWwpLCAibTw+IiAoKl9fcHVfYWRkciksICJpIiAoLTE0KSwgIjAiIChfX3B1X2Vycikp
OyBicmVhazsgZGVmYXVsdDogX19wdXRfdXNlcl9iYWQoKTsgfSB9IHdoaWxlICgwKTsgcHJl
dmVudF93cml0ZV90b191c2VyKF9fcHVfYWRkciwgX19wdV9zaXplKTsgfSB3aGlsZSAoMCk7
IF9fcHVfZXJyOyB9KSkKICByZXR1cm4gMTsKCgoKIGlmICh0bV9mcmFtZSAmJiAoeyBsb25n
IF9fcHVfZXJyOyBfX3R5cGVvZl9fKCooKCZ0bV9mcmFtZS0+bWNfZ3JlZ3NbMzNdKSkpICpf
X3B1X2FkZHIgPSAoKCZ0bV9mcmFtZS0+bWNfZ3JlZ3NbMzNdKSk7IF9fdHlwZW9mX18oKigo
JnRtX2ZyYW1lLT5tY19ncmVnc1szM10pKSkgX19wdV92YWwgPSAoKF9fdHlwZW9mX18oKigm
dG1fZnJhbWUtPm1jX2dyZWdzWzMzXSkpKSgwKSk7IF9fdHlwZW9mX18oc2l6ZW9mKCooJnRt
X2ZyYW1lLT5tY19ncmVnc1szM10pKSkgX19wdV9zaXplID0gKHNpemVvZigqKCZ0bV9mcmFt
ZS0+bWNfZ3JlZ3NbMzNdKSkpOyBpZiAoISgoKHVuc2lnbmVkIGxvbmcpX19wdV9hZGRyKSA+
PSAweDgwMDAwMDAwMDAwMDAwMDB1bCkpIG1pZ2h0X2ZhdWx0KCk7ICh2b2lkKTA7IGRvIHsg
YWxsb3dfd3JpdGVfdG9fdXNlcihfX3B1X2FkZHIsIF9fcHVfc2l6ZSk7IGRvIHsgX19wdV9l
cnIgPSAwOyBzd2l0Y2ggKF9fcHVfc2l6ZSkgeyBjYXNlIDE6IF9fYXNtX18gX192b2xhdGls
ZV9fKCAiMToJIiAic3RiIiAiJVUyJVgyICUxLCUyCSMgcHV0X3VzZXJcbiIgIjI6XG4iICIu
c2VjdGlvbiAuZml4dXAsXCJheFwiXG4iICIzOglsaSAlMCwlM1xuIiAiCWIgMmJcbiIgIi5w
cmV2aW91c1xuIiAiLnNlY3Rpb24gX19leF90YWJsZSxcImFcIjsiICIgIiAiLmJhbGlnbiA0
OyIgIiAiICIubG9uZyAoMWIpIC0gLiA7IiAiICIgIi5sb25nICgzYikgLSAuIDsiICIgIiAi
LnByZXZpb3VzIiAiICIgOiAiPXIiIChfX3B1X2VycikgOiAiciIgKF9fcHVfdmFsKSwgIm08
PiIgKCpfX3B1X2FkZHIpLCAiaSIgKC0xNCksICIwIiAoX19wdV9lcnIpKTsgYnJlYWs7IGNh
c2UgMjogX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgkiICJzdGgiICIlVTIlWDIgJTEsJTIJ
IyBwdXRfdXNlclxuIiAiMjpcbiIgIi5zZWN0aW9uIC5maXh1cCxcImF4XCJcbiIgIjM6CWxp
ICUwLCUzXG4iICIJYiAyYlxuIiAiLnByZXZpb3VzXG4iICIuc2VjdGlvbiBfX2V4X3RhYmxl
LFwiYVwiOyIgIiAiICIuYmFsaWduIDQ7IiAiICIgIi5sb25nICgxYikgLSAuIDsiICIgIiAi
LmxvbmcgKDNiKSAtIC4gOyIgIiAiICIucHJldmlvdXMiICIgIiA6ICI9ciIgKF9fcHVfZXJy
KSA6ICJyIiAoX19wdV92YWwpLCAibTw+IiAoKl9fcHVfYWRkciksICJpIiAoLTE0KSwgIjAi
IChfX3B1X2VycikpOyBicmVhazsgY2FzZSA0OiBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6
CSIgInN0dyIgIiVVMiVYMiAlMSwlMgkjIHB1dF91c2VyXG4iICIyOlxuIiAiLnNlY3Rpb24g
LmZpeHVwLFwiYXhcIlxuIiAiMzoJbGkgJTAsJTNcbiIgIgliIDJiXG4iICIucHJldmlvdXNc
biIgIi5zZWN0aW9uIF9fZXhfdGFibGUsXCJhXCI7IiAiICIgIi5iYWxpZ24gNDsiICIgIiAi
LmxvbmcgKDFiKSAtIC4gOyIgIiAiICIubG9uZyAoM2IpIC0gLiA7IiAiICIgIi5wcmV2aW91
cyIgIiAiIDogIj1yIiAoX19wdV9lcnIpIDogInIiIChfX3B1X3ZhbCksICJtPD4iICgqX19w
dV9hZGRyKSwgImkiICgtMTQpLCAiMCIgKF9fcHVfZXJyKSk7IGJyZWFrOyBjYXNlIDg6IF9f
YXNtX18gX192b2xhdGlsZV9fKCAiMToJIiAic3RkIiAiJVUyJVgyICUxLCUyCSMgcHV0X3Vz
ZXJcbiIgIjI6XG4iICIuc2VjdGlvbiAuZml4dXAsXCJheFwiXG4iICIzOglsaSAlMCwlM1xu
IiAiCWIgMmJcbiIgIi5wcmV2aW91c1xuIiAiLnNlY3Rpb24gX19leF90YWJsZSxcImFcIjsi
ICIgIiAiLmJhbGlnbiA0OyIgIiAiICIubG9uZyAoMWIpIC0gLiA7IiAiICIgIi5sb25nICgz
YikgLSAuIDsiICIgIiAiLnByZXZpb3VzIiAiICIgOiAiPXIiIChfX3B1X2VycikgOiAiciIg
KF9fcHVfdmFsKSwgIm08PiIgKCpfX3B1X2FkZHIpLCAiaSIgKC0xNCksICIwIiAoX19wdV9l
cnIpKTsgYnJlYWs7IGRlZmF1bHQ6IF9fcHV0X3VzZXJfYmFkKCk7IH0gfSB3aGlsZSAoMCk7
IHByZXZlbnRfd3JpdGVfdG9fdXNlcihfX3B1X2FkZHIsIF9fcHVfc2l6ZSk7IH0gd2hpbGUg
KDApOyBfX3B1X2VycjsgfSkpCiAgcmV0dXJuIDE7CgogaWYgKHNpZ3JldCkgewoKICBpZiAo
KHsgbG9uZyBfX3B1X2VycjsgX190eXBlb2ZfXygqKCgmZnJhbWUtPm1jX3BhZFswXSkpKSAq
X19wdV9hZGRyID0gKCgmZnJhbWUtPm1jX3BhZFswXSkpOyBfX3R5cGVvZl9fKCooKCZmcmFt
ZS0+bWNfcGFkWzBdKSkpIF9fcHVfdmFsID0gKChfX3R5cGVvZl9fKCooJmZyYW1lLT5tY19w
YWRbMF0pKSkoMHgzODAwMDAwMCArIHNpZ3JldCkpOyBfX3R5cGVvZl9fKHNpemVvZigqKCZm
cmFtZS0+bWNfcGFkWzBdKSkpIF9fcHVfc2l6ZSA9IChzaXplb2YoKigmZnJhbWUtPm1jX3Bh
ZFswXSkpKTsgaWYgKCEoKCh1bnNpZ25lZCBsb25nKV9fcHVfYWRkcikgPj0gMHg4MDAwMDAw
MDAwMDAwMDAwdWwpKSBtaWdodF9mYXVsdCgpOyAodm9pZCkwOyBkbyB7IGFsbG93X3dyaXRl
X3RvX3VzZXIoX19wdV9hZGRyLCBfX3B1X3NpemUpOyBkbyB7IF9fcHVfZXJyID0gMDsgc3dp
dGNoIChfX3B1X3NpemUpIHsgY2FzZSAxOiBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CSIg
InN0YiIgIiVVMiVYMiAlMSwlMgkjIHB1dF91c2VyXG4iICIyOlxuIiAiLnNlY3Rpb24gLmZp
eHVwLFwiYXhcIlxuIiAiMzoJbGkgJTAsJTNcbiIgIgliIDJiXG4iICIucHJldmlvdXNcbiIg
Ii5zZWN0aW9uIF9fZXhfdGFibGUsXCJhXCI7IiAiICIgIi5iYWxpZ24gNDsiICIgIiAiLmxv
bmcgKDFiKSAtIC4gOyIgIiAiICIubG9uZyAoM2IpIC0gLiA7IiAiICIgIi5wcmV2aW91cyIg
IiAiIDogIj1yIiAoX19wdV9lcnIpIDogInIiIChfX3B1X3ZhbCksICJtPD4iICgqX19wdV9h
ZGRyKSwgImkiICgtMTQpLCAiMCIgKF9fcHVfZXJyKSk7IGJyZWFrOyBjYXNlIDI6IF9fYXNt
X18gX192b2xhdGlsZV9fKCAiMToJIiAic3RoIiAiJVUyJVgyICUxLCUyCSMgcHV0X3VzZXJc
biIgIjI6XG4iICIuc2VjdGlvbiAuZml4dXAsXCJheFwiXG4iICIzOglsaSAlMCwlM1xuIiAi
CWIgMmJcbiIgIi5wcmV2aW91c1xuIiAiLnNlY3Rpb24gX19leF90YWJsZSxcImFcIjsiICIg
IiAiLmJhbGlnbiA0OyIgIiAiICIubG9uZyAoMWIpIC0gLiA7IiAiICIgIi5sb25nICgzYikg
LSAuIDsiICIgIiAiLnByZXZpb3VzIiAiICIgOiAiPXIiIChfX3B1X2VycikgOiAiciIgKF9f
cHVfdmFsKSwgIm08PiIgKCpfX3B1X2FkZHIpLCAiaSIgKC0xNCksICIwIiAoX19wdV9lcnIp
KTsgYnJlYWs7IGNhc2UgNDogX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgkiICJzdHciICIl
VTIlWDIgJTEsJTIJIyBwdXRfdXNlclxuIiAiMjpcbiIgIi5zZWN0aW9uIC5maXh1cCxcImF4
XCJcbiIgIjM6CWxpICUwLCUzXG4iICIJYiAyYlxuIiAiLnByZXZpb3VzXG4iICIuc2VjdGlv
biBfX2V4X3RhYmxlLFwiYVwiOyIgIiAiICIuYmFsaWduIDQ7IiAiICIgIi5sb25nICgxYikg
LSAuIDsiICIgIiAiLmxvbmcgKDNiKSAtIC4gOyIgIiAiICIucHJldmlvdXMiICIgIiA6ICI9
ciIgKF9fcHVfZXJyKSA6ICJyIiAoX19wdV92YWwpLCAibTw+IiAoKl9fcHVfYWRkciksICJp
IiAoLTE0KSwgIjAiIChfX3B1X2VycikpOyBicmVhazsgY2FzZSA4OiBfX2FzbV9fIF9fdm9s
YXRpbGVfXyggIjE6CSIgInN0ZCIgIiVVMiVYMiAlMSwlMgkjIHB1dF91c2VyXG4iICIyOlxu
IiAiLnNlY3Rpb24gLmZpeHVwLFwiYXhcIlxuIiAiMzoJbGkgJTAsJTNcbiIgIgliIDJiXG4i
ICIucHJldmlvdXNcbiIgIi5zZWN0aW9uIF9fZXhfdGFibGUsXCJhXCI7IiAiICIgIi5iYWxp
Z24gNDsiICIgIiAiLmxvbmcgKDFiKSAtIC4gOyIgIiAiICIubG9uZyAoM2IpIC0gLiA7IiAi
ICIgIi5wcmV2aW91cyIgIiAiIDogIj1yIiAoX19wdV9lcnIpIDogInIiIChfX3B1X3ZhbCks
ICJtPD4iICgqX19wdV9hZGRyKSwgImkiICgtMTQpLCAiMCIgKF9fcHVfZXJyKSk7IGJyZWFr
OyBkZWZhdWx0OiBfX3B1dF91c2VyX2JhZCgpOyB9IH0gd2hpbGUgKDApOyBwcmV2ZW50X3dy
aXRlX3RvX3VzZXIoX19wdV9hZGRyLCBfX3B1X3NpemUpOyB9IHdoaWxlICgwKTsgX19wdV9l
cnI7IH0pCiAgICAgIHx8ICh7IGxvbmcgX19wdV9lcnI7IF9fdHlwZW9mX18oKigoJmZyYW1l
LT5tY19wYWRbMV0pKSkgKl9fcHVfYWRkciA9ICgoJmZyYW1lLT5tY19wYWRbMV0pKTsgX190
eXBlb2ZfXygqKCgmZnJhbWUtPm1jX3BhZFsxXSkpKSBfX3B1X3ZhbCA9ICgoX190eXBlb2Zf
XygqKCZmcmFtZS0+bWNfcGFkWzFdKSkpKDB4NDQwMDAwMDIpKTsgX190eXBlb2ZfXyhzaXpl
b2YoKigmZnJhbWUtPm1jX3BhZFsxXSkpKSBfX3B1X3NpemUgPSAoc2l6ZW9mKCooJmZyYW1l
LT5tY19wYWRbMV0pKSk7IGlmICghKCgodW5zaWduZWQgbG9uZylfX3B1X2FkZHIpID49IDB4
ODAwMDAwMDAwMDAwMDAwMHVsKSkgbWlnaHRfZmF1bHQoKTsgKHZvaWQpMDsgZG8geyBhbGxv
d193cml0ZV90b191c2VyKF9fcHVfYWRkciwgX19wdV9zaXplKTsgZG8geyBfX3B1X2VyciA9
IDA7IHN3aXRjaCAoX19wdV9zaXplKSB7IGNhc2UgMTogX19hc21fXyBfX3ZvbGF0aWxlX18o
ICIxOgkiICJzdGIiICIlVTIlWDIgJTEsJTIJIyBwdXRfdXNlclxuIiAiMjpcbiIgIi5zZWN0
aW9uIC5maXh1cCxcImF4XCJcbiIgIjM6CWxpICUwLCUzXG4iICIJYiAyYlxuIiAiLnByZXZp
b3VzXG4iICIuc2VjdGlvbiBfX2V4X3RhYmxlLFwiYVwiOyIgIiAiICIuYmFsaWduIDQ7IiAi
ICIgIi5sb25nICgxYikgLSAuIDsiICIgIiAiLmxvbmcgKDNiKSAtIC4gOyIgIiAiICIucHJl
dmlvdXMiICIgIiA6ICI9ciIgKF9fcHVfZXJyKSA6ICJyIiAoX19wdV92YWwpLCAibTw+IiAo
Kl9fcHVfYWRkciksICJpIiAoLTE0KSwgIjAiIChfX3B1X2VycikpOyBicmVhazsgY2FzZSAy
OiBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CSIgInN0aCIgIiVVMiVYMiAlMSwlMgkjIHB1
dF91c2VyXG4iICIyOlxuIiAiLnNlY3Rpb24gLmZpeHVwLFwiYXhcIlxuIiAiMzoJbGkgJTAs
JTNcbiIgIgliIDJiXG4iICIucHJldmlvdXNcbiIgIi5zZWN0aW9uIF9fZXhfdGFibGUsXCJh
XCI7IiAiICIgIi5iYWxpZ24gNDsiICIgIiAiLmxvbmcgKDFiKSAtIC4gOyIgIiAiICIubG9u
ZyAoM2IpIC0gLiA7IiAiICIgIi5wcmV2aW91cyIgIiAiIDogIj1yIiAoX19wdV9lcnIpIDog
InIiIChfX3B1X3ZhbCksICJtPD4iICgqX19wdV9hZGRyKSwgImkiICgtMTQpLCAiMCIgKF9f
cHVfZXJyKSk7IGJyZWFrOyBjYXNlIDQ6IF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJIiAi
c3R3IiAiJVUyJVgyICUxLCUyCSMgcHV0X3VzZXJcbiIgIjI6XG4iICIuc2VjdGlvbiAuZml4
dXAsXCJheFwiXG4iICIzOglsaSAlMCwlM1xuIiAiCWIgMmJcbiIgIi5wcmV2aW91c1xuIiAi
LnNlY3Rpb24gX19leF90YWJsZSxcImFcIjsiICIgIiAiLmJhbGlnbiA0OyIgIiAiICIubG9u
ZyAoMWIpIC0gLiA7IiAiICIgIi5sb25nICgzYikgLSAuIDsiICIgIiAiLnByZXZpb3VzIiAi
ICIgOiAiPXIiIChfX3B1X2VycikgOiAiciIgKF9fcHVfdmFsKSwgIm08PiIgKCpfX3B1X2Fk
ZHIpLCAiaSIgKC0xNCksICIwIiAoX19wdV9lcnIpKTsgYnJlYWs7IGNhc2UgODogX19hc21f
XyBfX3ZvbGF0aWxlX18oICIxOgkiICJzdGQiICIlVTIlWDIgJTEsJTIJIyBwdXRfdXNlclxu
IiAiMjpcbiIgIi5zZWN0aW9uIC5maXh1cCxcImF4XCJcbiIgIjM6CWxpICUwLCUzXG4iICIJ
YiAyYlxuIiAiLnByZXZpb3VzXG4iICIuc2VjdGlvbiBfX2V4X3RhYmxlLFwiYVwiOyIgIiAi
ICIuYmFsaWduIDQ7IiAiICIgIi5sb25nICgxYikgLSAuIDsiICIgIiAiLmxvbmcgKDNiKSAt
IC4gOyIgIiAiICIucHJldmlvdXMiICIgIiA6ICI9ciIgKF9fcHVfZXJyKSA6ICJyIiAoX19w
dV92YWwpLCAibTw+IiAoKl9fcHVfYWRkciksICJpIiAoLTE0KSwgIjAiIChfX3B1X2Vycikp
OyBicmVhazsgZGVmYXVsdDogX19wdXRfdXNlcl9iYWQoKTsgfSB9IHdoaWxlICgwKTsgcHJl
dmVudF93cml0ZV90b191c2VyKF9fcHVfYWRkciwgX19wdV9zaXplKTsgfSB3aGlsZSAoMCk7
IF9fcHVfZXJyOyB9KSkKICAgcmV0dXJuIDE7CiAgZmx1c2hfaWNhY2hlX3JhbmdlKCh1bnNp
Z25lZCBsb25nKSAmZnJhbWUtPm1jX3BhZFswXSwKICAgICAgICh1bnNpZ25lZCBsb25nKSAm
ZnJhbWUtPm1jX3BhZFsyXSk7CiB9CgogcmV0dXJuIDA7Cn0KIyA0ODUgImFyY2gvcG93ZXJw
Yy9rZXJuZWwvc2lnbmFsXzMyLmMiCnN0YXRpYyBsb25nIHJlc3RvcmVfdXNlcl9yZWdzKHN0
cnVjdCBwdF9yZWdzICpyZWdzLAogICAgICAgICBzdHJ1Y3QgbWNvbnRleHQzMiAqc3IsIGlu
dCBzaWcpCnsKIGxvbmcgZXJyOwogdW5zaWduZWQgaW50IHNhdmVfcjIgPSAwOwogdW5zaWdu
ZWQgbG9uZyBtc3I7CiMgNDk5ICJhcmNoL3Bvd2VycGMva2VybmVsL3NpZ25hbF8zMi5jIgog
aWYgKCFzaWcpCiAgc2F2ZV9yMiA9ICh1bnNpZ25lZCBpbnQpcmVncy0+Z3ByWzJdOwogZXJy
ID0gcmVzdG9yZV9nZW5lcmFsX3JlZ3MocmVncywgc3IpOwogc2V0X3RyYXBfbm9yZXN0YXJ0
KHJlZ3MpOwogZXJyIHw9ICh7IGxvbmcgX19ndV9lcnI7IF9fdHlwZW9mX18oX19idWlsdGlu
X2Nob29zZV9leHByKHNpemVvZigqKCgmc3ItPm1jX2dyZWdzWzMzXSkpKSA+IHNpemVvZigw
VUwpLCAwVUxMLCAwVUwpKSBfX2d1X3ZhbDsgX190eXBlb2ZfXygqKCgmc3ItPm1jX2dyZWdz
WzMzXSkpKSAqX19ndV9hZGRyID0gKCgmc3ItPm1jX2dyZWdzWzMzXSkpOyBfX3R5cGVvZl9f
KHNpemVvZigqKCZzci0+bWNfZ3JlZ3NbMzNdKSkpIF9fZ3Vfc2l6ZSA9IChzaXplb2YoKigm
c3ItPm1jX2dyZWdzWzMzXSkpKTsgKHZvaWQpMDsgaWYgKCEoKCh1bnNpZ25lZCBsb25nKV9f
Z3VfYWRkcikgPj0gMHg4MDAwMDAwMDAwMDAwMDAwdWwpKSBtaWdodF9mYXVsdCgpOyBhc20g
KCI5NTM6IC5wdXNoc2VjdGlvbiBfX2JhcnJpZXJfbm9zcGVjX2ZpeHVwLFwiYVwiOyAuYWxp
Z24gMjsgOTU0OiAuOGJ5dGUgOTUzYi05NTRiOyAucG9wc2VjdGlvbjs7IG5vcDsgbm9wIiAi
ICIgOjo6ICJtZW1vcnkiKTsgaWYgKHRydWUpIGRvIHsgYWxsb3dfcmVhZF9mcm9tX3VzZXIo
X19ndV9hZGRyLCBfX2d1X3NpemUpOyBkbyB7IF9fZ3VfZXJyID0gMDsgKHZvaWQpMDsgaWYg
KF9fZ3Vfc2l6ZSA+IHNpemVvZihfX2d1X3ZhbCkpIChfX2d1X3ZhbCkgPSBfX2dldF91c2Vy
X2JhZCgpOyBzd2l0Y2ggKF9fZ3Vfc2l6ZSkgeyBjYXNlIDE6IF9fYXNtX18gX192b2xhdGls
ZV9fKCAiMToJIiJsYnoiIiVVMiVYMiAlMSwgJTIJIyBnZXRfdXNlclxuIiAiMjpcbiIgIi5z
ZWN0aW9uIC5maXh1cCxcImF4XCJcbiIgIjM6CWxpICUwLCUzXG4iICIJbGkgJTEsMFxuIiAi
CWIgMmJcbiIgIi5wcmV2aW91c1xuIiAiLnNlY3Rpb24gX19leF90YWJsZSxcImFcIjsiICIg
IiAiLmJhbGlnbiA0OyIgIiAiICIubG9uZyAoMWIpIC0gLiA7IiAiICIgIi5sb25nICgzYikg
LSAuIDsiICIgIiAiLnByZXZpb3VzIiAiICIgOiAiPXIiIChfX2d1X2VyciksICI9ciIgKF9f
Z3VfdmFsKSA6ICJtPD4iICgqKHU4ICopX19ndV9hZGRyKSwgImkiICgtMTQpLCAiMCIgKF9f
Z3VfZXJyKSk7IGJyZWFrOyBjYXNlIDI6IF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJIiJs
aHoiIiVVMiVYMiAlMSwgJTIJIyBnZXRfdXNlclxuIiAiMjpcbiIgIi5zZWN0aW9uIC5maXh1
cCxcImF4XCJcbiIgIjM6CWxpICUwLCUzXG4iICIJbGkgJTEsMFxuIiAiCWIgMmJcbiIgIi5w
cmV2aW91c1xuIiAiLnNlY3Rpb24gX19leF90YWJsZSxcImFcIjsiICIgIiAiLmJhbGlnbiA0
OyIgIiAiICIubG9uZyAoMWIpIC0gLiA7IiAiICIgIi5sb25nICgzYikgLSAuIDsiICIgIiAi
LnByZXZpb3VzIiAiICIgOiAiPXIiIChfX2d1X2VyciksICI9ciIgKF9fZ3VfdmFsKSA6ICJt
PD4iICgqKHUxNiAqKV9fZ3VfYWRkciksICJpIiAoLTE0KSwgIjAiIChfX2d1X2VycikpOyBi
cmVhazsgY2FzZSA0OiBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CSIibHd6IiIlVTIlWDIg
JTEsICUyCSMgZ2V0X3VzZXJcbiIgIjI6XG4iICIuc2VjdGlvbiAuZml4dXAsXCJheFwiXG4i
ICIzOglsaSAlMCwlM1xuIiAiCWxpICUxLDBcbiIgIgliIDJiXG4iICIucHJldmlvdXNcbiIg
Ii5zZWN0aW9uIF9fZXhfdGFibGUsXCJhXCI7IiAiICIgIi5iYWxpZ24gNDsiICIgIiAiLmxv
bmcgKDFiKSAtIC4gOyIgIiAiICIubG9uZyAoM2IpIC0gLiA7IiAiICIgIi5wcmV2aW91cyIg
IiAiIDogIj1yIiAoX19ndV9lcnIpLCAiPXIiIChfX2d1X3ZhbCkgOiAibTw+IiAoKih1MzIg
KilfX2d1X2FkZHIpLCAiaSIgKC0xNCksICIwIiAoX19ndV9lcnIpKTsgYnJlYWs7IGNhc2Ug
ODogX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgkiImxkIiIlVTIlWDIgJTEsICUyCSMgZ2V0
X3VzZXJcbiIgIjI6XG4iICIuc2VjdGlvbiAuZml4dXAsXCJheFwiXG4iICIzOglsaSAlMCwl
M1xuIiAiCWxpICUxLDBcbiIgIgliIDJiXG4iICIucHJldmlvdXNcbiIgIi5zZWN0aW9uIF9f
ZXhfdGFibGUsXCJhXCI7IiAiICIgIi5iYWxpZ24gNDsiICIgIiAiLmxvbmcgKDFiKSAtIC4g
OyIgIiAiICIubG9uZyAoM2IpIC0gLiA7IiAiICIgIi5wcmV2aW91cyIgIiAiIDogIj1yIiAo
X19ndV9lcnIpLCAiPXIiIChfX2d1X3ZhbCkgOiAibTw+IiAoKih1NjQgKilfX2d1X2FkZHIp
LCAiaSIgKC0xNCksICIwIiAoX19ndV9lcnIpKTsgYnJlYWs7IGRlZmF1bHQ6IChfX2d1X3Zh
bCkgPSBfX2dldF91c2VyX2JhZCgpOyB9IH0gd2hpbGUgKDApOyBwcmV2ZW50X3JlYWRfZnJv
bV91c2VyKF9fZ3VfYWRkciwgX19ndV9zaXplKTsgfSB3aGlsZSAoMCk7IGVsc2UgZG8geyBf
X2d1X2VyciA9IDA7ICh2b2lkKTA7IGlmIChfX2d1X3NpemUgPiBzaXplb2YoX19ndV92YWwp
KSAoX19ndV92YWwpID0gX19nZXRfdXNlcl9iYWQoKTsgc3dpdGNoIChfX2d1X3NpemUpIHsg
Y2FzZSAxOiBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CSIibGJ6IiIlVTIlWDIgJTEsICUy
CSMgZ2V0X3VzZXJcbiIgIjI6XG4iICIuc2VjdGlvbiAuZml4dXAsXCJheFwiXG4iICIzOgls
aSAlMCwlM1xuIiAiCWxpICUxLDBcbiIgIgliIDJiXG4iICIucHJldmlvdXNcbiIgIi5zZWN0
aW9uIF9fZXhfdGFibGUsXCJhXCI7IiAiICIgIi5iYWxpZ24gNDsiICIgIiAiLmxvbmcgKDFi
KSAtIC4gOyIgIiAiICIubG9uZyAoM2IpIC0gLiA7IiAiICIgIi5wcmV2aW91cyIgIiAiIDog
Ij1yIiAoX19ndV9lcnIpLCAiPXIiIChfX2d1X3ZhbCkgOiAibTw+IiAoKih1OCAqKV9fZ3Vf
YWRkciksICJpIiAoLTE0KSwgIjAiIChfX2d1X2VycikpOyBicmVhazsgY2FzZSAyOiBfX2Fz
bV9fIF9fdm9sYXRpbGVfXyggIjE6CSIibGh6IiIlVTIlWDIgJTEsICUyCSMgZ2V0X3VzZXJc
biIgIjI6XG4iICIuc2VjdGlvbiAuZml4dXAsXCJheFwiXG4iICIzOglsaSAlMCwlM1xuIiAi
CWxpICUxLDBcbiIgIgliIDJiXG4iICIucHJldmlvdXNcbiIgIi5zZWN0aW9uIF9fZXhfdGFi
bGUsXCJhXCI7IiAiICIgIi5iYWxpZ24gNDsiICIgIiAiLmxvbmcgKDFiKSAtIC4gOyIgIiAi
ICIubG9uZyAoM2IpIC0gLiA7IiAiICIgIi5wcmV2aW91cyIgIiAiIDogIj1yIiAoX19ndV9l
cnIpLCAiPXIiIChfX2d1X3ZhbCkgOiAibTw+IiAoKih1MTYgKilfX2d1X2FkZHIpLCAiaSIg
KC0xNCksICIwIiAoX19ndV9lcnIpKTsgYnJlYWs7IGNhc2UgNDogX19hc21fXyBfX3ZvbGF0
aWxlX18oICIxOgkiImx3eiIiJVUyJVgyICUxLCAlMgkjIGdldF91c2VyXG4iICIyOlxuIiAi
LnNlY3Rpb24gLmZpeHVwLFwiYXhcIlxuIiAiMzoJbGkgJTAsJTNcbiIgIglsaSAlMSwwXG4i
ICIJYiAyYlxuIiAiLnByZXZpb3VzXG4iICIuc2VjdGlvbiBfX2V4X3RhYmxlLFwiYVwiOyIg
IiAiICIuYmFsaWduIDQ7IiAiICIgIi5sb25nICgxYikgLSAuIDsiICIgIiAiLmxvbmcgKDNi
KSAtIC4gOyIgIiAiICIucHJldmlvdXMiICIgIiA6ICI9ciIgKF9fZ3VfZXJyKSwgIj1yIiAo
X19ndV92YWwpIDogIm08PiIgKCoodTMyICopX19ndV9hZGRyKSwgImkiICgtMTQpLCAiMCIg
KF9fZ3VfZXJyKSk7IGJyZWFrOyBjYXNlIDg6IF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJ
IiJsZCIiJVUyJVgyICUxLCAlMgkjIGdldF91c2VyXG4iICIyOlxuIiAiLnNlY3Rpb24gLmZp
eHVwLFwiYXhcIlxuIiAiMzoJbGkgJTAsJTNcbiIgIglsaSAlMSwwXG4iICIJYiAyYlxuIiAi
LnByZXZpb3VzXG4iICIuc2VjdGlvbiBfX2V4X3RhYmxlLFwiYVwiOyIgIiAiICIuYmFsaWdu
IDQ7IiAiICIgIi5sb25nICgxYikgLSAuIDsiICIgIiAiLmxvbmcgKDNiKSAtIC4gOyIgIiAi
ICIucHJldmlvdXMiICIgIiA6ICI9ciIgKF9fZ3VfZXJyKSwgIj1yIiAoX19ndV92YWwpIDog
Im08PiIgKCoodTY0ICopX19ndV9hZGRyKSwgImkiICgtMTQpLCAiMCIgKF9fZ3VfZXJyKSk7
IGJyZWFrOyBkZWZhdWx0OiAoX19ndV92YWwpID0gX19nZXRfdXNlcl9iYWQoKTsgfSB9IHdo
aWxlICgwKTsgKChtc3IpKSA9IChfX3R5cGVvZl9fKCooKCZzci0+bWNfZ3JlZ3NbMzNdKSkp
KV9fZ3VfdmFsOyBfX2d1X2VycjsgfSk7CiBpZiAoIXNpZykKICByZWdzLT5ncHJbMl0gPSAo
dW5zaWduZWQgbG9uZykgc2F2ZV9yMjsKIGlmIChlcnIpCiAgcmV0dXJuIDE7CgoKIGlmIChz
aWcpCiAgcmVncy0+bXNyID0gKHJlZ3MtPm1zciAmIH4oMVVMPDwoMCkpKSB8IChtc3IgJiAo
MVVMPDwoMCkpKTsKCgoKCgoKIHJlZ3MtPm1zciAmPSB+KDFVTDw8KDI1KSk7CiBpZiAobXNy
ICYgKDFVTDw8KDI1KSkpIHsKCiAgaWYgKF9fY29weV9mcm9tX3VzZXIoJmdldF9jdXJyZW50
KCktPnRocmVhZC52cl9zdGF0ZSwgJnNyLT5tY192cmVncywKICAgICAgICAgc2l6ZW9mKHNy
LT5tY192cmVncykpKQogICByZXR1cm4gMTsKICBnZXRfY3VycmVudCgpLT50aHJlYWQudXNl
ZF92ciA9IHRydWU7CiB9IGVsc2UgaWYgKGdldF9jdXJyZW50KCktPnRocmVhZC51c2VkX3Zy
KQogIG1lbXNldCgmZ2V0X2N1cnJlbnQoKS0+dGhyZWFkLnZyX3N0YXRlLCAwLAogICAgICAg
ICAzMyAqIHNpemVvZih2ZWN0b3IxMjgpKTsKCgogaWYgKCh7IGxvbmcgX19ndV9lcnI7IF9f
dHlwZW9mX18oX19idWlsdGluX2Nob29zZV9leHByKHNpemVvZigqKCgodTMyICopJnNyLT5t
Y192cmVnc1szMl0pKSkgPiBzaXplb2YoMFVMKSwgMFVMTCwgMFVMKSkgX19ndV92YWw7IF9f
dHlwZW9mX18oKigoKHUzMiAqKSZzci0+bWNfdnJlZ3NbMzJdKSkpICpfX2d1X2FkZHIgPSAo
KCh1MzIgKikmc3ItPm1jX3ZyZWdzWzMyXSkpOyBfX3R5cGVvZl9fKHNpemVvZigqKCh1MzIg
Kikmc3ItPm1jX3ZyZWdzWzMyXSkpKSBfX2d1X3NpemUgPSAoc2l6ZW9mKCooKHUzMiAqKSZz
ci0+bWNfdnJlZ3NbMzJdKSkpOyAodm9pZCkwOyBpZiAoISgoKHVuc2lnbmVkIGxvbmcpX19n
dV9hZGRyKSA+PSAweDgwMDAwMDAwMDAwMDAwMDB1bCkpIG1pZ2h0X2ZhdWx0KCk7IGFzbSAo
Ijk1MzogLnB1c2hzZWN0aW9uIF9fYmFycmllcl9ub3NwZWNfZml4dXAsXCJhXCI7IC5hbGln
biAyOyA5NTQ6IC44Ynl0ZSA5NTNiLTk1NGI7IC5wb3BzZWN0aW9uOzsgbm9wOyBub3AiICIg
IiA6OjogIm1lbW9yeSIpOyBpZiAodHJ1ZSkgZG8geyBhbGxvd19yZWFkX2Zyb21fdXNlcihf
X2d1X2FkZHIsIF9fZ3Vfc2l6ZSk7IGRvIHsgX19ndV9lcnIgPSAwOyAodm9pZCkwOyBpZiAo
X19ndV9zaXplID4gc2l6ZW9mKF9fZ3VfdmFsKSkgKF9fZ3VfdmFsKSA9IF9fZ2V0X3VzZXJf
YmFkKCk7IHN3aXRjaCAoX19ndV9zaXplKSB7IGNhc2UgMTogX19hc21fXyBfX3ZvbGF0aWxl
X18oICIxOgkiImxieiIiJVUyJVgyICUxLCAlMgkjIGdldF91c2VyXG4iICIyOlxuIiAiLnNl
Y3Rpb24gLmZpeHVwLFwiYXhcIlxuIiAiMzoJbGkgJTAsJTNcbiIgIglsaSAlMSwwXG4iICIJ
YiAyYlxuIiAiLnByZXZpb3VzXG4iICIuc2VjdGlvbiBfX2V4X3RhYmxlLFwiYVwiOyIgIiAi
ICIuYmFsaWduIDQ7IiAiICIgIi5sb25nICgxYikgLSAuIDsiICIgIiAiLmxvbmcgKDNiKSAt
IC4gOyIgIiAiICIucHJldmlvdXMiICIgIiA6ICI9ciIgKF9fZ3VfZXJyKSwgIj1yIiAoX19n
dV92YWwpIDogIm08PiIgKCoodTggKilfX2d1X2FkZHIpLCAiaSIgKC0xNCksICIwIiAoX19n
dV9lcnIpKTsgYnJlYWs7IGNhc2UgMjogX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgkiImxo
eiIiJVUyJVgyICUxLCAlMgkjIGdldF91c2VyXG4iICIyOlxuIiAiLnNlY3Rpb24gLmZpeHVw
LFwiYXhcIlxuIiAiMzoJbGkgJTAsJTNcbiIgIglsaSAlMSwwXG4iICIJYiAyYlxuIiAiLnBy
ZXZpb3VzXG4iICIuc2VjdGlvbiBfX2V4X3RhYmxlLFwiYVwiOyIgIiAiICIuYmFsaWduIDQ7
IiAiICIgIi5sb25nICgxYikgLSAuIDsiICIgIiAiLmxvbmcgKDNiKSAtIC4gOyIgIiAiICIu
cHJldmlvdXMiICIgIiA6ICI9ciIgKF9fZ3VfZXJyKSwgIj1yIiAoX19ndV92YWwpIDogIm08
PiIgKCoodTE2ICopX19ndV9hZGRyKSwgImkiICgtMTQpLCAiMCIgKF9fZ3VfZXJyKSk7IGJy
ZWFrOyBjYXNlIDQ6IF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJIiJsd3oiIiVVMiVYMiAl
MSwgJTIJIyBnZXRfdXNlclxuIiAiMjpcbiIgIi5zZWN0aW9uIC5maXh1cCxcImF4XCJcbiIg
IjM6CWxpICUwLCUzXG4iICIJbGkgJTEsMFxuIiAiCWIgMmJcbiIgIi5wcmV2aW91c1xuIiAi
LnNlY3Rpb24gX19leF90YWJsZSxcImFcIjsiICIgIiAiLmJhbGlnbiA0OyIgIiAiICIubG9u
ZyAoMWIpIC0gLiA7IiAiICIgIi5sb25nICgzYikgLSAuIDsiICIgIiAiLnByZXZpb3VzIiAi
ICIgOiAiPXIiIChfX2d1X2VyciksICI9ciIgKF9fZ3VfdmFsKSA6ICJtPD4iICgqKHUzMiAq
KV9fZ3VfYWRkciksICJpIiAoLTE0KSwgIjAiIChfX2d1X2VycikpOyBicmVhazsgY2FzZSA4
OiBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CSIibGQiIiVVMiVYMiAlMSwgJTIJIyBnZXRf
dXNlclxuIiAiMjpcbiIgIi5zZWN0aW9uIC5maXh1cCxcImF4XCJcbiIgIjM6CWxpICUwLCUz
XG4iICIJbGkgJTEsMFxuIiAiCWIgMmJcbiIgIi5wcmV2aW91c1xuIiAiLnNlY3Rpb24gX19l
eF90YWJsZSxcImFcIjsiICIgIiAiLmJhbGlnbiA0OyIgIiAiICIubG9uZyAoMWIpIC0gLiA7
IiAiICIgIi5sb25nICgzYikgLSAuIDsiICIgIiAiLnByZXZpb3VzIiAiICIgOiAiPXIiIChf
X2d1X2VyciksICI9ciIgKF9fZ3VfdmFsKSA6ICJtPD4iICgqKHU2NCAqKV9fZ3VfYWRkciks
ICJpIiAoLTE0KSwgIjAiIChfX2d1X2VycikpOyBicmVhazsgZGVmYXVsdDogKF9fZ3VfdmFs
KSA9IF9fZ2V0X3VzZXJfYmFkKCk7IH0gfSB3aGlsZSAoMCk7IHByZXZlbnRfcmVhZF9mcm9t
X3VzZXIoX19ndV9hZGRyLCBfX2d1X3NpemUpOyB9IHdoaWxlICgwKTsgZWxzZSBkbyB7IF9f
Z3VfZXJyID0gMDsgKHZvaWQpMDsgaWYgKF9fZ3Vfc2l6ZSA+IHNpemVvZihfX2d1X3ZhbCkp
IChfX2d1X3ZhbCkgPSBfX2dldF91c2VyX2JhZCgpOyBzd2l0Y2ggKF9fZ3Vfc2l6ZSkgeyBj
YXNlIDE6IF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJIiJsYnoiIiVVMiVYMiAlMSwgJTIJ
IyBnZXRfdXNlclxuIiAiMjpcbiIgIi5zZWN0aW9uIC5maXh1cCxcImF4XCJcbiIgIjM6CWxp
ICUwLCUzXG4iICIJbGkgJTEsMFxuIiAiCWIgMmJcbiIgIi5wcmV2aW91c1xuIiAiLnNlY3Rp
b24gX19leF90YWJsZSxcImFcIjsiICIgIiAiLmJhbGlnbiA0OyIgIiAiICIubG9uZyAoMWIp
IC0gLiA7IiAiICIgIi5sb25nICgzYikgLSAuIDsiICIgIiAiLnByZXZpb3VzIiAiICIgOiAi
PXIiIChfX2d1X2VyciksICI9ciIgKF9fZ3VfdmFsKSA6ICJtPD4iICgqKHU4ICopX19ndV9h
ZGRyKSwgImkiICgtMTQpLCAiMCIgKF9fZ3VfZXJyKSk7IGJyZWFrOyBjYXNlIDI6IF9fYXNt
X18gX192b2xhdGlsZV9fKCAiMToJIiJsaHoiIiVVMiVYMiAlMSwgJTIJIyBnZXRfdXNlclxu
IiAiMjpcbiIgIi5zZWN0aW9uIC5maXh1cCxcImF4XCJcbiIgIjM6CWxpICUwLCUzXG4iICIJ
bGkgJTEsMFxuIiAiCWIgMmJcbiIgIi5wcmV2aW91c1xuIiAiLnNlY3Rpb24gX19leF90YWJs
ZSxcImFcIjsiICIgIiAiLmJhbGlnbiA0OyIgIiAiICIubG9uZyAoMWIpIC0gLiA7IiAiICIg
Ii5sb25nICgzYikgLSAuIDsiICIgIiAiLnByZXZpb3VzIiAiICIgOiAiPXIiIChfX2d1X2Vy
ciksICI9ciIgKF9fZ3VfdmFsKSA6ICJtPD4iICgqKHUxNiAqKV9fZ3VfYWRkciksICJpIiAo
LTE0KSwgIjAiIChfX2d1X2VycikpOyBicmVhazsgY2FzZSA0OiBfX2FzbV9fIF9fdm9sYXRp
bGVfXyggIjE6CSIibHd6IiIlVTIlWDIgJTEsICUyCSMgZ2V0X3VzZXJcbiIgIjI6XG4iICIu
c2VjdGlvbiAuZml4dXAsXCJheFwiXG4iICIzOglsaSAlMCwlM1xuIiAiCWxpICUxLDBcbiIg
IgliIDJiXG4iICIucHJldmlvdXNcbiIgIi5zZWN0aW9uIF9fZXhfdGFibGUsXCJhXCI7IiAi
ICIgIi5iYWxpZ24gNDsiICIgIiAiLmxvbmcgKDFiKSAtIC4gOyIgIiAiICIubG9uZyAoM2Ip
IC0gLiA7IiAiICIgIi5wcmV2aW91cyIgIiAiIDogIj1yIiAoX19ndV9lcnIpLCAiPXIiIChf
X2d1X3ZhbCkgOiAibTw+IiAoKih1MzIgKilfX2d1X2FkZHIpLCAiaSIgKC0xNCksICIwIiAo
X19ndV9lcnIpKTsgYnJlYWs7IGNhc2UgODogX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgki
ImxkIiIlVTIlWDIgJTEsICUyCSMgZ2V0X3VzZXJcbiIgIjI6XG4iICIuc2VjdGlvbiAuZml4
dXAsXCJheFwiXG4iICIzOglsaSAlMCwlM1xuIiAiCWxpICUxLDBcbiIgIgliIDJiXG4iICIu
cHJldmlvdXNcbiIgIi5zZWN0aW9uIF9fZXhfdGFibGUsXCJhXCI7IiAiICIgIi5iYWxpZ24g
NDsiICIgIiAiLmxvbmcgKDFiKSAtIC4gOyIgIiAiICIubG9uZyAoM2IpIC0gLiA7IiAiICIg
Ii5wcmV2aW91cyIgIiAiIDogIj1yIiAoX19ndV9lcnIpLCAiPXIiIChfX2d1X3ZhbCkgOiAi
bTw+IiAoKih1NjQgKilfX2d1X2FkZHIpLCAiaSIgKC0xNCksICIwIiAoX19ndV9lcnIpKTsg
YnJlYWs7IGRlZmF1bHQ6IChfX2d1X3ZhbCkgPSBfX2dldF91c2VyX2JhZCgpOyB9IH0gd2hp
bGUgKDApOyAoKGdldF9jdXJyZW50KCktPnRocmVhZC52cnNhdmUpKSA9IChfX3R5cGVvZl9f
KCooKCh1MzIgKikmc3ItPm1jX3ZyZWdzWzMyXSkpKSlfX2d1X3ZhbDsgX19ndV9lcnI7IH0p
KQogIHJldHVybiAxOwogaWYgKGNwdV9oYXNfZmVhdHVyZSgweDAwMDAwMDAyVUwpKQogIGFz
bSB2b2xhdGlsZSgibXRzcHIgIiAiMHgxMDAiICIsJTAiIDogOiAiciIgKCh1bnNpZ25lZCBs
b25nKShnZXRfY3VycmVudCgpLT50aHJlYWQudnJzYXZlKSkgOiAibWVtb3J5Iik7CgogaWYg
KGNvcHlfZnByX2Zyb21fdXNlcihnZXRfY3VycmVudCgpLCAmc3ItPm1jX2ZyZWdzKSkKICBy
ZXR1cm4gMTsKIyA1NjAgImFyY2gvcG93ZXJwYy9rZXJuZWwvc2lnbmFsXzMyLmMiCiByZWdz
LT5tc3IgJj0gfigoMVVMPDwoMTMpKSB8ICgxVUw8PCgxMSkpIHwgKDFVTDw8KDgpKSk7CiMg
NTgwICJhcmNoL3Bvd2VycGMva2VybmVsL3NpZ25hbF8zMi5jIgogcmV0dXJuIDA7Cn0KIyA3
NTUgImFyY2gvcG93ZXJwYy9rZXJuZWwvc2lnbmFsXzMyLmMiCmludCBoYW5kbGVfcnRfc2ln
bmFsMzIoc3RydWN0IGtzaWduYWwgKmtzaWcsIHNpZ3NldF90ICpvbGRzZXQsCiAgICAgICAg
IHN0cnVjdCB0YXNrX3N0cnVjdCAqdHNrKQp7CiBzdHJ1Y3QgcnRfc2lnZnJhbWUgKnJ0X3Nm
Owogc3RydWN0IG1jb250ZXh0MzIgKmZyYW1lOwogc3RydWN0IG1jb250ZXh0MzIgKnRtX2Zy
YW1lID0gKCh2b2lkICopMCk7CiB2b2lkICphZGRyOwogdW5zaWduZWQgbG9uZyBuZXdzcCA9
IDA7CiBpbnQgc2lncmV0OwogdW5zaWduZWQgbG9uZyBtY19wYWQ7CiBzdHJ1Y3QgcHRfcmVn
cyAqcmVncyA9IHRzay0+dGhyZWFkLnJlZ3M7CgoKCgoKIGRvIHsgaWYgKF9fYnVpbHRpbl9j
b25zdGFudF9wKHRzayAhPSBnZXRfY3VycmVudCgpKSkgeyBpZiAodHNrICE9IGdldF9jdXJy
ZW50KCkpIGRvIHsgX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgkiICJ0d2kgMzEsIDAsIDAi
ICJcbiIgIi5zZWN0aW9uIF9fYnVnX3RhYmxlLFwiYXdcIlxuIiAiMjpcdCIgIi44Ynl0ZSIg
IiAiICIxYiwgJTBcbiIgIlx0LnNob3J0ICUxLCAlMlxuIiAiLm9yZyAyYislM1xuIiAiLnBy
ZXZpb3VzXG4iIDogOiAiaSIgKCJhcmNoL3Bvd2VycGMva2VybmVsL3NpZ25hbF8zMi5jIiks
ICJpIiAoNzcxKSwgImkiICgwKSwgImkiIChzaXplb2Yoc3RydWN0IGJ1Z19lbnRyeSkpKTsg
ZG8geyA7IGFzbSB2b2xhdGlsZSgiIik7IF9fYnVpbHRpbl91bnJlYWNoYWJsZSgpOyB9IHdo
aWxlICgwKTsgfSB3aGlsZSAoMCk7IH0gZWxzZSB7IF9fYXNtX18gX192b2xhdGlsZV9fKCAi
MToJIiAidGRuZWkiICIgIiAiICU0LCAwIiAiXG4iICIuc2VjdGlvbiBfX2J1Z190YWJsZSxc
ImF3XCJcbiIgIjI6XHQiICIuOGJ5dGUiICIgIiAiMWIsICUwXG4iICJcdC5zaG9ydCAlMSwg
JTJcbiIgIi5vcmcgMmIrJTNcbiIgIi5wcmV2aW91c1xuIiA6IDogImkiICgiYXJjaC9wb3dl
cnBjL2tlcm5lbC9zaWduYWxfMzIuYyIpLCAiaSIgKDc3MSksICJpIiAoMCksICJpIiAoc2l6
ZW9mKHN0cnVjdCBidWdfZW50cnkpKSwgInIiICgoIGxvbmcpKHRzayAhPSBnZXRfY3VycmVu
dCgpKSkpOyB9IH0gd2hpbGUgKDApOwoKCgogcnRfc2YgPSBnZXRfc2lnZnJhbWUoa3NpZywg
Z2V0X3RtX3N0YWNrcG9pbnRlcih0c2spLCBzaXplb2YoKnJ0X3NmKSwgMSk7CiBhZGRyID0g
cnRfc2Y7CiBpZiAoX19idWlsdGluX2V4cGVjdCghIShydF9zZiA9PSAoKHZvaWQgKikwKSks
IDApKQogIGdvdG8gYmFkZnJhbWU7CgoKIGlmIChfX2NvcHlfc2lnaW5mb190b191c2VyMzIo
JnJ0X3NmLT5pbmZvLCAma3NpZy0+aW5mbykKICAgICB8fCAoeyBsb25nIF9fcHVfZXJyOyBf
X3R5cGVvZl9fKCooKCZydF9zZi0+dWMudWNfZmxhZ3MpKSkgKl9fcHVfYWRkciA9ICgoJnJ0
X3NmLT51Yy51Y19mbGFncykpOyBfX3R5cGVvZl9fKCooKCZydF9zZi0+dWMudWNfZmxhZ3Mp
KSkgX19wdV92YWwgPSAoKF9fdHlwZW9mX18oKigmcnRfc2YtPnVjLnVjX2ZsYWdzKSkpKDAp
KTsgX190eXBlb2ZfXyhzaXplb2YoKigmcnRfc2YtPnVjLnVjX2ZsYWdzKSkpIF9fcHVfc2l6
ZSA9IChzaXplb2YoKigmcnRfc2YtPnVjLnVjX2ZsYWdzKSkpOyBpZiAoISgoKHVuc2lnbmVk
IGxvbmcpX19wdV9hZGRyKSA+PSAweDgwMDAwMDAwMDAwMDAwMDB1bCkpIG1pZ2h0X2ZhdWx0
KCk7ICh2b2lkKTA7IGRvIHsgYWxsb3dfd3JpdGVfdG9fdXNlcihfX3B1X2FkZHIsIF9fcHVf
c2l6ZSk7IGRvIHsgX19wdV9lcnIgPSAwOyBzd2l0Y2ggKF9fcHVfc2l6ZSkgeyBjYXNlIDE6
IF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJIiAic3RiIiAiJVUyJVgyICUxLCUyCSMgcHV0
X3VzZXJcbiIgIjI6XG4iICIuc2VjdGlvbiAuZml4dXAsXCJheFwiXG4iICIzOglsaSAlMCwl
M1xuIiAiCWIgMmJcbiIgIi5wcmV2aW91c1xuIiAiLnNlY3Rpb24gX19leF90YWJsZSxcImFc
IjsiICIgIiAiLmJhbGlnbiA0OyIgIiAiICIubG9uZyAoMWIpIC0gLiA7IiAiICIgIi5sb25n
ICgzYikgLSAuIDsiICIgIiAiLnByZXZpb3VzIiAiICIgOiAiPXIiIChfX3B1X2VycikgOiAi
ciIgKF9fcHVfdmFsKSwgIm08PiIgKCpfX3B1X2FkZHIpLCAiaSIgKC0xNCksICIwIiAoX19w
dV9lcnIpKTsgYnJlYWs7IGNhc2UgMjogX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgkiICJz
dGgiICIlVTIlWDIgJTEsJTIJIyBwdXRfdXNlclxuIiAiMjpcbiIgIi5zZWN0aW9uIC5maXh1
cCxcImF4XCJcbiIgIjM6CWxpICUwLCUzXG4iICIJYiAyYlxuIiAiLnByZXZpb3VzXG4iICIu
c2VjdGlvbiBfX2V4X3RhYmxlLFwiYVwiOyIgIiAiICIuYmFsaWduIDQ7IiAiICIgIi5sb25n
ICgxYikgLSAuIDsiICIgIiAiLmxvbmcgKDNiKSAtIC4gOyIgIiAiICIucHJldmlvdXMiICIg
IiA6ICI9ciIgKF9fcHVfZXJyKSA6ICJyIiAoX19wdV92YWwpLCAibTw+IiAoKl9fcHVfYWRk
ciksICJpIiAoLTE0KSwgIjAiIChfX3B1X2VycikpOyBicmVhazsgY2FzZSA0OiBfX2FzbV9f
IF9fdm9sYXRpbGVfXyggIjE6CSIgInN0dyIgIiVVMiVYMiAlMSwlMgkjIHB1dF91c2VyXG4i
ICIyOlxuIiAiLnNlY3Rpb24gLmZpeHVwLFwiYXhcIlxuIiAiMzoJbGkgJTAsJTNcbiIgIgli
IDJiXG4iICIucHJldmlvdXNcbiIgIi5zZWN0aW9uIF9fZXhfdGFibGUsXCJhXCI7IiAiICIg
Ii5iYWxpZ24gNDsiICIgIiAiLmxvbmcgKDFiKSAtIC4gOyIgIiAiICIubG9uZyAoM2IpIC0g
LiA7IiAiICIgIi5wcmV2aW91cyIgIiAiIDogIj1yIiAoX19wdV9lcnIpIDogInIiIChfX3B1
X3ZhbCksICJtPD4iICgqX19wdV9hZGRyKSwgImkiICgtMTQpLCAiMCIgKF9fcHVfZXJyKSk7
IGJyZWFrOyBjYXNlIDg6IF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJIiAic3RkIiAiJVUy
JVgyICUxLCUyCSMgcHV0X3VzZXJcbiIgIjI6XG4iICIuc2VjdGlvbiAuZml4dXAsXCJheFwi
XG4iICIzOglsaSAlMCwlM1xuIiAiCWIgMmJcbiIgIi5wcmV2aW91c1xuIiAiLnNlY3Rpb24g
X19leF90YWJsZSxcImFcIjsiICIgIiAiLmJhbGlnbiA0OyIgIiAiICIubG9uZyAoMWIpIC0g
LiA7IiAiICIgIi5sb25nICgzYikgLSAuIDsiICIgIiAiLnByZXZpb3VzIiAiICIgOiAiPXIi
IChfX3B1X2VycikgOiAiciIgKF9fcHVfdmFsKSwgIm08PiIgKCpfX3B1X2FkZHIpLCAiaSIg
KC0xNCksICIwIiAoX19wdV9lcnIpKTsgYnJlYWs7IGRlZmF1bHQ6IF9fcHV0X3VzZXJfYmFk
KCk7IH0gfSB3aGlsZSAoMCk7IHByZXZlbnRfd3JpdGVfdG9fdXNlcihfX3B1X2FkZHIsIF9f
cHVfc2l6ZSk7IH0gd2hpbGUgKDApOyBfX3B1X2VycjsgfSkKICAgICB8fCBfX2NvbXBhdF9z
YXZlX2FsdHN0YWNrKCZydF9zZi0+dWMudWNfc3RhY2ssIHJlZ3MtPmdwclsxXSkKICAgICB8
fCAoeyBsb25nIF9fcHVfZXJyOyBfX3R5cGVvZl9fKCooKCZydF9zZi0+dWMudWNfcmVncykp
KSAqX19wdV9hZGRyID0gKCgmcnRfc2YtPnVjLnVjX3JlZ3MpKTsgX190eXBlb2ZfXygqKCgm
cnRfc2YtPnVjLnVjX3JlZ3MpKSkgX19wdV92YWwgPSAoKF9fdHlwZW9mX18oKigmcnRfc2Yt
PnVjLnVjX3JlZ3MpKSkocHRyX3RvX2NvbXBhdCgmcnRfc2YtPnVjLnVjX21jb250ZXh0KSkp
OyBfX3R5cGVvZl9fKHNpemVvZigqKCZydF9zZi0+dWMudWNfcmVncykpKSBfX3B1X3NpemUg
PSAoc2l6ZW9mKCooJnJ0X3NmLT51Yy51Y19yZWdzKSkpOyBpZiAoISgoKHVuc2lnbmVkIGxv
bmcpX19wdV9hZGRyKSA+PSAweDgwMDAwMDAwMDAwMDAwMDB1bCkpIG1pZ2h0X2ZhdWx0KCk7
ICh2b2lkKTA7IGRvIHsgYWxsb3dfd3JpdGVfdG9fdXNlcihfX3B1X2FkZHIsIF9fcHVfc2l6
ZSk7IGRvIHsgX19wdV9lcnIgPSAwOyBzd2l0Y2ggKF9fcHVfc2l6ZSkgeyBjYXNlIDE6IF9f
YXNtX18gX192b2xhdGlsZV9fKCAiMToJIiAic3RiIiAiJVUyJVgyICUxLCUyCSMgcHV0X3Vz
ZXJcbiIgIjI6XG4iICIuc2VjdGlvbiAuZml4dXAsXCJheFwiXG4iICIzOglsaSAlMCwlM1xu
IiAiCWIgMmJcbiIgIi5wcmV2aW91c1xuIiAiLnNlY3Rpb24gX19leF90YWJsZSxcImFcIjsi
ICIgIiAiLmJhbGlnbiA0OyIgIiAiICIubG9uZyAoMWIpIC0gLiA7IiAiICIgIi5sb25nICgz
YikgLSAuIDsiICIgIiAiLnByZXZpb3VzIiAiICIgOiAiPXIiIChfX3B1X2VycikgOiAiciIg
KF9fcHVfdmFsKSwgIm08PiIgKCpfX3B1X2FkZHIpLCAiaSIgKC0xNCksICIwIiAoX19wdV9l
cnIpKTsgYnJlYWs7IGNhc2UgMjogX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgkiICJzdGgi
ICIlVTIlWDIgJTEsJTIJIyBwdXRfdXNlclxuIiAiMjpcbiIgIi5zZWN0aW9uIC5maXh1cCxc
ImF4XCJcbiIgIjM6CWxpICUwLCUzXG4iICIJYiAyYlxuIiAiLnByZXZpb3VzXG4iICIuc2Vj
dGlvbiBfX2V4X3RhYmxlLFwiYVwiOyIgIiAiICIuYmFsaWduIDQ7IiAiICIgIi5sb25nICgx
YikgLSAuIDsiICIgIiAiLmxvbmcgKDNiKSAtIC4gOyIgIiAiICIucHJldmlvdXMiICIgIiA6
ICI9ciIgKF9fcHVfZXJyKSA6ICJyIiAoX19wdV92YWwpLCAibTw+IiAoKl9fcHVfYWRkciks
ICJpIiAoLTE0KSwgIjAiIChfX3B1X2VycikpOyBicmVhazsgY2FzZSA0OiBfX2FzbV9fIF9f
dm9sYXRpbGVfXyggIjE6CSIgInN0dyIgIiVVMiVYMiAlMSwlMgkjIHB1dF91c2VyXG4iICIy
OlxuIiAiLnNlY3Rpb24gLmZpeHVwLFwiYXhcIlxuIiAiMzoJbGkgJTAsJTNcbiIgIgliIDJi
XG4iICIucHJldmlvdXNcbiIgIi5zZWN0aW9uIF9fZXhfdGFibGUsXCJhXCI7IiAiICIgIi5i
YWxpZ24gNDsiICIgIiAiLmxvbmcgKDFiKSAtIC4gOyIgIiAiICIubG9uZyAoM2IpIC0gLiA7
IiAiICIgIi5wcmV2aW91cyIgIiAiIDogIj1yIiAoX19wdV9lcnIpIDogInIiIChfX3B1X3Zh
bCksICJtPD4iICgqX19wdV9hZGRyKSwgImkiICgtMTQpLCAiMCIgKF9fcHVfZXJyKSk7IGJy
ZWFrOyBjYXNlIDg6IF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJIiAic3RkIiAiJVUyJVgy
ICUxLCUyCSMgcHV0X3VzZXJcbiIgIjI6XG4iICIuc2VjdGlvbiAuZml4dXAsXCJheFwiXG4i
ICIzOglsaSAlMCwlM1xuIiAiCWIgMmJcbiIgIi5wcmV2aW91c1xuIiAiLnNlY3Rpb24gX19l
eF90YWJsZSxcImFcIjsiICIgIiAiLmJhbGlnbiA0OyIgIiAiICIubG9uZyAoMWIpIC0gLiA7
IiAiICIgIi5sb25nICgzYikgLSAuIDsiICIgIiAiLnByZXZpb3VzIiAiICIgOiAiPXIiIChf
X3B1X2VycikgOiAiciIgKF9fcHVfdmFsKSwgIm08PiIgKCpfX3B1X2FkZHIpLCAiaSIgKC0x
NCksICIwIiAoX19wdV9lcnIpKTsgYnJlYWs7IGRlZmF1bHQ6IF9fcHV0X3VzZXJfYmFkKCk7
IH0gfSB3aGlsZSAoMCk7IHByZXZlbnRfd3JpdGVfdG9fdXNlcihfX3B1X2FkZHIsIF9fcHVf
c2l6ZSk7IH0gd2hpbGUgKDApOyBfX3B1X2VycjsgfSkKCiAgICAgfHwgcHV0X3NpZ3NldF90
KCZydF9zZi0+dWMudWNfc2lnbWFzaywgb2xkc2V0KSkKICBnb3RvIGJhZGZyYW1lOwoKCiBm
cmFtZSA9ICZydF9zZi0+dWMudWNfbWNvbnRleHQ7CiBhZGRyID0gZnJhbWU7CiBpZiAodmRz
bzMyX3J0X3NpZ3RyYW1wICYmIHRzay0+bW0tPmNvbnRleHQudmRzb19iYXNlKSB7CiAgc2ln
cmV0ID0gMDsKICBtY19wYWQgPSB0c2stPm1tLT5jb250ZXh0LnZkc29fYmFzZSArIHZkc28z
Ml9ydF9zaWd0cmFtcDsKIH0gZWxzZSB7CiAgc2lncmV0ID0gMTcyOwogIG1jX3BhZCA9ICh1
bnNpZ25lZCBsb25nKSBmcmFtZS0+bWNfcGFkOwogfQojIDgxMyAiYXJjaC9wb3dlcnBjL2tl
cm5lbC9zaWduYWxfMzIuYyIKIHsKICBpZiAoKHsgbG9uZyBfX3B1X2VycjsgX190eXBlb2Zf
XygqKCgmcnRfc2YtPnVjLnVjX2xpbmspKSkgKl9fcHVfYWRkciA9ICgoJnJ0X3NmLT51Yy51
Y19saW5rKSk7IF9fdHlwZW9mX18oKigoJnJ0X3NmLT51Yy51Y19saW5rKSkpIF9fcHVfdmFs
ID0gKChfX3R5cGVvZl9fKCooJnJ0X3NmLT51Yy51Y19saW5rKSkpKDApKTsgX190eXBlb2Zf
XyhzaXplb2YoKigmcnRfc2YtPnVjLnVjX2xpbmspKSkgX19wdV9zaXplID0gKHNpemVvZigq
KCZydF9zZi0+dWMudWNfbGluaykpKTsgaWYgKCEoKCh1bnNpZ25lZCBsb25nKV9fcHVfYWRk
cikgPj0gMHg4MDAwMDAwMDAwMDAwMDAwdWwpKSBtaWdodF9mYXVsdCgpOyAodm9pZCkwOyBk
byB7IGFsbG93X3dyaXRlX3RvX3VzZXIoX19wdV9hZGRyLCBfX3B1X3NpemUpOyBkbyB7IF9f
cHVfZXJyID0gMDsgc3dpdGNoIChfX3B1X3NpemUpIHsgY2FzZSAxOiBfX2FzbV9fIF9fdm9s
YXRpbGVfXyggIjE6CSIgInN0YiIgIiVVMiVYMiAlMSwlMgkjIHB1dF91c2VyXG4iICIyOlxu
IiAiLnNlY3Rpb24gLmZpeHVwLFwiYXhcIlxuIiAiMzoJbGkgJTAsJTNcbiIgIgliIDJiXG4i
ICIucHJldmlvdXNcbiIgIi5zZWN0aW9uIF9fZXhfdGFibGUsXCJhXCI7IiAiICIgIi5iYWxp
Z24gNDsiICIgIiAiLmxvbmcgKDFiKSAtIC4gOyIgIiAiICIubG9uZyAoM2IpIC0gLiA7IiAi
ICIgIi5wcmV2aW91cyIgIiAiIDogIj1yIiAoX19wdV9lcnIpIDogInIiIChfX3B1X3ZhbCks
ICJtPD4iICgqX19wdV9hZGRyKSwgImkiICgtMTQpLCAiMCIgKF9fcHVfZXJyKSk7IGJyZWFr
OyBjYXNlIDI6IF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJIiAic3RoIiAiJVUyJVgyICUx
LCUyCSMgcHV0X3VzZXJcbiIgIjI6XG4iICIuc2VjdGlvbiAuZml4dXAsXCJheFwiXG4iICIz
OglsaSAlMCwlM1xuIiAiCWIgMmJcbiIgIi5wcmV2aW91c1xuIiAiLnNlY3Rpb24gX19leF90
YWJsZSxcImFcIjsiICIgIiAiLmJhbGlnbiA0OyIgIiAiICIubG9uZyAoMWIpIC0gLiA7IiAi
ICIgIi5sb25nICgzYikgLSAuIDsiICIgIiAiLnByZXZpb3VzIiAiICIgOiAiPXIiIChfX3B1
X2VycikgOiAiciIgKF9fcHVfdmFsKSwgIm08PiIgKCpfX3B1X2FkZHIpLCAiaSIgKC0xNCks
ICIwIiAoX19wdV9lcnIpKTsgYnJlYWs7IGNhc2UgNDogX19hc21fXyBfX3ZvbGF0aWxlX18o
ICIxOgkiICJzdHciICIlVTIlWDIgJTEsJTIJIyBwdXRfdXNlclxuIiAiMjpcbiIgIi5zZWN0
aW9uIC5maXh1cCxcImF4XCJcbiIgIjM6CWxpICUwLCUzXG4iICIJYiAyYlxuIiAiLnByZXZp
b3VzXG4iICIuc2VjdGlvbiBfX2V4X3RhYmxlLFwiYVwiOyIgIiAiICIuYmFsaWduIDQ7IiAi
ICIgIi5sb25nICgxYikgLSAuIDsiICIgIiAiLmxvbmcgKDNiKSAtIC4gOyIgIiAiICIucHJl
dmlvdXMiICIgIiA6ICI9ciIgKF9fcHVfZXJyKSA6ICJyIiAoX19wdV92YWwpLCAibTw+IiAo
Kl9fcHVfYWRkciksICJpIiAoLTE0KSwgIjAiIChfX3B1X2VycikpOyBicmVhazsgY2FzZSA4
OiBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CSIgInN0ZCIgIiVVMiVYMiAlMSwlMgkjIHB1
dF91c2VyXG4iICIyOlxuIiAiLnNlY3Rpb24gLmZpeHVwLFwiYXhcIlxuIiAiMzoJbGkgJTAs
JTNcbiIgIgliIDJiXG4iICIucHJldmlvdXNcbiIgIi5zZWN0aW9uIF9fZXhfdGFibGUsXCJh
XCI7IiAiICIgIi5iYWxpZ24gNDsiICIgIiAiLmxvbmcgKDFiKSAtIC4gOyIgIiAiICIubG9u
ZyAoM2IpIC0gLiA7IiAiICIgIi5wcmV2aW91cyIgIiAiIDogIj1yIiAoX19wdV9lcnIpIDog
InIiIChfX3B1X3ZhbCksICJtPD4iICgqX19wdV9hZGRyKSwgImkiICgtMTQpLCAiMCIgKF9f
cHVfZXJyKSk7IGJyZWFrOyBkZWZhdWx0OiBfX3B1dF91c2VyX2JhZCgpOyB9IH0gd2hpbGUg
KDApOyBwcmV2ZW50X3dyaXRlX3RvX3VzZXIoX19wdV9hZGRyLCBfX3B1X3NpemUpOyB9IHdo
aWxlICgwKTsgX19wdV9lcnI7IH0pKQogICBnb3RvIGJhZGZyYW1lOwogIGlmIChzYXZlX3Vz
ZXJfcmVncyhyZWdzLCBmcmFtZSwgdG1fZnJhbWUsIHNpZ3JldCwgMSkpCiAgIGdvdG8gYmFk
ZnJhbWU7CiB9CiByZWdzLT5saW5rID0gbWNfcGFkOwoKIHRzay0+dGhyZWFkLmZwX3N0YXRl
LmZwc2NyID0gMDsKCgogbmV3c3AgPSAoKHVuc2lnbmVkIGxvbmcpcnRfc2YpIC0gKDY0ICsg
MTYpOwogYWRkciA9ICh2b2lkICopcmVncy0+Z3ByWzFdOwogaWYgKCh7IGxvbmcgX19wdV9l
cnIgPSAtMTQ7IF9fdHlwZW9mX18oKigoKHUzMiAqKW5ld3NwKSkpICpfX3B1X2FkZHIgPSAo
KCh1MzIgKiluZXdzcCkpOyBfX3R5cGVvZl9fKCooKCh1MzIgKiluZXdzcCkpKSBfX3B1X3Zh
bCA9ICgoX190eXBlb2ZfXygqKCh1MzIgKiluZXdzcCkpKShyZWdzLT5ncHJbMV0pKTsgX190
eXBlb2ZfXyhzaXplb2YoKigodTMyICopbmV3c3ApKSkgX19wdV9zaXplID0gKHNpemVvZigq
KCh1MzIgKiluZXdzcCkpKTsgbWlnaHRfZmF1bHQoKTsgaWYgKCgodm9pZCkwLCAoKCgoIHVu
c2lnbmVkIGxvbmcpKF9fcHVfYWRkcikpIDw9ICgoZ2V0X2N1cnJlbnQoKS0+dGhyZWFkLmFk
ZHJfbGltaXQpKS5zZWcpICYmICgoKF9fcHVfc2l6ZSkpIDw9ICgoZ2V0X2N1cnJlbnQoKS0+
dGhyZWFkLmFkZHJfbGltaXQpKS5zZWcpKSkpIGRvIHsgYWxsb3dfd3JpdGVfdG9fdXNlcihf
X3B1X2FkZHIsIF9fcHVfc2l6ZSk7IGRvIHsgX19wdV9lcnIgPSAwOyBzd2l0Y2ggKF9fcHVf
c2l6ZSkgeyBjYXNlIDE6IF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJIiAic3RiIiAiJVUy
JVgyICUxLCUyCSMgcHV0X3VzZXJcbiIgIjI6XG4iICIuc2VjdGlvbiAuZml4dXAsXCJheFwi
XG4iICIzOglsaSAlMCwlM1xuIiAiCWIgMmJcbiIgIi5wcmV2aW91c1xuIiAiLnNlY3Rpb24g
X19leF90YWJsZSxcImFcIjsiICIgIiAiLmJhbGlnbiA0OyIgIiAiICIubG9uZyAoMWIpIC0g
LiA7IiAiICIgIi5sb25nICgzYikgLSAuIDsiICIgIiAiLnByZXZpb3VzIiAiICIgOiAiPXIi
IChfX3B1X2VycikgOiAiciIgKF9fcHVfdmFsKSwgIm08PiIgKCpfX3B1X2FkZHIpLCAiaSIg
KC0xNCksICIwIiAoX19wdV9lcnIpKTsgYnJlYWs7IGNhc2UgMjogX19hc21fXyBfX3ZvbGF0
aWxlX18oICIxOgkiICJzdGgiICIlVTIlWDIgJTEsJTIJIyBwdXRfdXNlclxuIiAiMjpcbiIg
Ii5zZWN0aW9uIC5maXh1cCxcImF4XCJcbiIgIjM6CWxpICUwLCUzXG4iICIJYiAyYlxuIiAi
LnByZXZpb3VzXG4iICIuc2VjdGlvbiBfX2V4X3RhYmxlLFwiYVwiOyIgIiAiICIuYmFsaWdu
IDQ7IiAiICIgIi5sb25nICgxYikgLSAuIDsiICIgIiAiLmxvbmcgKDNiKSAtIC4gOyIgIiAi
ICIucHJldmlvdXMiICIgIiA6ICI9ciIgKF9fcHVfZXJyKSA6ICJyIiAoX19wdV92YWwpLCAi
bTw+IiAoKl9fcHVfYWRkciksICJpIiAoLTE0KSwgIjAiIChfX3B1X2VycikpOyBicmVhazsg
Y2FzZSA0OiBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CSIgInN0dyIgIiVVMiVYMiAlMSwl
MgkjIHB1dF91c2VyXG4iICIyOlxuIiAiLnNlY3Rpb24gLmZpeHVwLFwiYXhcIlxuIiAiMzoJ
bGkgJTAsJTNcbiIgIgliIDJiXG4iICIucHJldmlvdXNcbiIgIi5zZWN0aW9uIF9fZXhfdGFi
bGUsXCJhXCI7IiAiICIgIi5iYWxpZ24gNDsiICIgIiAiLmxvbmcgKDFiKSAtIC4gOyIgIiAi
ICIubG9uZyAoM2IpIC0gLiA7IiAiICIgIi5wcmV2aW91cyIgIiAiIDogIj1yIiAoX19wdV9l
cnIpIDogInIiIChfX3B1X3ZhbCksICJtPD4iICgqX19wdV9hZGRyKSwgImkiICgtMTQpLCAi
MCIgKF9fcHVfZXJyKSk7IGJyZWFrOyBjYXNlIDg6IF9fYXNtX18gX192b2xhdGlsZV9fKCAi
MToJIiAic3RkIiAiJVUyJVgyICUxLCUyCSMgcHV0X3VzZXJcbiIgIjI6XG4iICIuc2VjdGlv
biAuZml4dXAsXCJheFwiXG4iICIzOglsaSAlMCwlM1xuIiAiCWIgMmJcbiIgIi5wcmV2aW91
c1xuIiAiLnNlY3Rpb24gX19leF90YWJsZSxcImFcIjsiICIgIiAiLmJhbGlnbiA0OyIgIiAi
ICIubG9uZyAoMWIpIC0gLiA7IiAiICIgIi5sb25nICgzYikgLSAuIDsiICIgIiAiLnByZXZp
b3VzIiAiICIgOiAiPXIiIChfX3B1X2VycikgOiAiciIgKF9fcHVfdmFsKSwgIm08PiIgKCpf
X3B1X2FkZHIpLCAiaSIgKC0xNCksICIwIiAoX19wdV9lcnIpKTsgYnJlYWs7IGRlZmF1bHQ6
IF9fcHV0X3VzZXJfYmFkKCk7IH0gfSB3aGlsZSAoMCk7IHByZXZlbnRfd3JpdGVfdG9fdXNl
cihfX3B1X2FkZHIsIF9fcHVfc2l6ZSk7IH0gd2hpbGUgKDApOyBfX3B1X2VycjsgfSkpCiAg
Z290byBiYWRmcmFtZTsKCgogcmVncy0+Z3ByWzFdID0gbmV3c3A7CiByZWdzLT5ncHJbM10g
PSBrc2lnLT5zaWc7CiByZWdzLT5ncHJbNF0gPSAodW5zaWduZWQgbG9uZykgJnJ0X3NmLT5p
bmZvOwogcmVncy0+Z3ByWzVdID0gKHVuc2lnbmVkIGxvbmcpICZydF9zZi0+dWM7CiByZWdz
LT5ncHJbNl0gPSAodW5zaWduZWQgbG9uZykgcnRfc2Y7CiByZWdzLT5uaXAgPSAodW5zaWdu
ZWQgbG9uZykga3NpZy0+a2Euc2Euc2FfaGFuZGxlcjsKCiByZWdzLT5tc3IgJj0gfigxVUw8
PCgwKSk7CiByZWdzLT5tc3IgfD0gKCgoKDFVTDw8KDEyKSkgfCAoMVVMPDwoMSkpIHwgKDFV
TDw8KDE3KSkpIHwgKDFVTDw8KDMxKSkpICYgKDFVTDw8KDApKSk7CiByZXR1cm4gMDsKCmJh
ZGZyYW1lOgogaWYgKHNob3dfdW5oYW5kbGVkX3NpZ25hbHMpCiAgKHsgc3RhdGljIHN0cnVj
dCByYXRlbGltaXRfc3RhdGUgX3JzID0geyAubG9jayA9IChyYXdfc3BpbmxvY2tfdCkgeyAu
cmF3X2xvY2sgPSB7IDAgfSwgfSwgLmludGVydmFsID0gKDUgKiAyNTApLCAuYnVyc3QgPSAx
MCwgfTsgaWYgKF9fX3JhdGVsaW1pdCgmX3JzLCBfX2Z1bmNfXykpIHByaW50aygiXDAwMSIg
IjYiICIlc1slZF06IGJhZCBmcmFtZSBpbiBoYW5kbGVfcnRfc2lnbmFsMzI6ICIgIiVwIG5p
cCAlMDhseCBsciAlMDhseFxuIiwgdHNrLT5jb21tLCB0c2stPnBpZCwgYWRkciwgcmVncy0+
bmlwLCByZWdzLT5saW5rKTsgfSkKCgoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICA7CgogcmV0dXJuIDE7Cn0KCnN0YXRpYyBpbnQgZG9fc2V0Y29udGV4dChzdHJ1Y3Qg
dWNvbnRleHQzMiAqdWNwLCBzdHJ1Y3QgcHRfcmVncyAqcmVncywgaW50IHNpZykKewogc2ln
c2V0X3Qgc2V0Owogc3RydWN0IG1jb250ZXh0MzIgKm1jcDsKCiBpZiAoZ2V0X3NpZ3NldF90
KCZzZXQsICZ1Y3AtPnVjX3NpZ21hc2spKQogIHJldHVybiAtMTQ7CgogewogIHUzMiBjbWNw
OwoKICBpZiAoKHsgbG9uZyBfX2d1X2VycjsgX190eXBlb2ZfXyhfX2J1aWx0aW5fY2hvb3Nl
X2V4cHIoc2l6ZW9mKCooKCZ1Y3AtPnVjX3JlZ3MpKSkgPiBzaXplb2YoMFVMKSwgMFVMTCwg
MFVMKSkgX19ndV92YWw7IF9fdHlwZW9mX18oKigoJnVjcC0+dWNfcmVncykpKSAqX19ndV9h
ZGRyID0gKCgmdWNwLT51Y19yZWdzKSk7IF9fdHlwZW9mX18oc2l6ZW9mKCooJnVjcC0+dWNf
cmVncykpKSBfX2d1X3NpemUgPSAoc2l6ZW9mKCooJnVjcC0+dWNfcmVncykpKTsgKHZvaWQp
MDsgaWYgKCEoKCh1bnNpZ25lZCBsb25nKV9fZ3VfYWRkcikgPj0gMHg4MDAwMDAwMDAwMDAw
MDAwdWwpKSBtaWdodF9mYXVsdCgpOyBhc20gKCI5NTM6IC5wdXNoc2VjdGlvbiBfX2JhcnJp
ZXJfbm9zcGVjX2ZpeHVwLFwiYVwiOyAuYWxpZ24gMjsgOTU0OiAuOGJ5dGUgOTUzYi05NTRi
OyAucG9wc2VjdGlvbjs7IG5vcDsgbm9wIiAiICIgOjo6ICJtZW1vcnkiKTsgaWYgKHRydWUp
IGRvIHsgYWxsb3dfcmVhZF9mcm9tX3VzZXIoX19ndV9hZGRyLCBfX2d1X3NpemUpOyBkbyB7
IF9fZ3VfZXJyID0gMDsgKHZvaWQpMDsgaWYgKF9fZ3Vfc2l6ZSA+IHNpemVvZihfX2d1X3Zh
bCkpIChfX2d1X3ZhbCkgPSBfX2dldF91c2VyX2JhZCgpOyBzd2l0Y2ggKF9fZ3Vfc2l6ZSkg
eyBjYXNlIDE6IF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJIiJsYnoiIiVVMiVYMiAlMSwg
JTIJIyBnZXRfdXNlclxuIiAiMjpcbiIgIi5zZWN0aW9uIC5maXh1cCxcImF4XCJcbiIgIjM6
CWxpICUwLCUzXG4iICIJbGkgJTEsMFxuIiAiCWIgMmJcbiIgIi5wcmV2aW91c1xuIiAiLnNl
Y3Rpb24gX19leF90YWJsZSxcImFcIjsiICIgIiAiLmJhbGlnbiA0OyIgIiAiICIubG9uZyAo
MWIpIC0gLiA7IiAiICIgIi5sb25nICgzYikgLSAuIDsiICIgIiAiLnByZXZpb3VzIiAiICIg
OiAiPXIiIChfX2d1X2VyciksICI9ciIgKF9fZ3VfdmFsKSA6ICJtPD4iICgqKHU4ICopX19n
dV9hZGRyKSwgImkiICgtMTQpLCAiMCIgKF9fZ3VfZXJyKSk7IGJyZWFrOyBjYXNlIDI6IF9f
YXNtX18gX192b2xhdGlsZV9fKCAiMToJIiJsaHoiIiVVMiVYMiAlMSwgJTIJIyBnZXRfdXNl
clxuIiAiMjpcbiIgIi5zZWN0aW9uIC5maXh1cCxcImF4XCJcbiIgIjM6CWxpICUwLCUzXG4i
ICIJbGkgJTEsMFxuIiAiCWIgMmJcbiIgIi5wcmV2aW91c1xuIiAiLnNlY3Rpb24gX19leF90
YWJsZSxcImFcIjsiICIgIiAiLmJhbGlnbiA0OyIgIiAiICIubG9uZyAoMWIpIC0gLiA7IiAi
ICIgIi5sb25nICgzYikgLSAuIDsiICIgIiAiLnByZXZpb3VzIiAiICIgOiAiPXIiIChfX2d1
X2VyciksICI9ciIgKF9fZ3VfdmFsKSA6ICJtPD4iICgqKHUxNiAqKV9fZ3VfYWRkciksICJp
IiAoLTE0KSwgIjAiIChfX2d1X2VycikpOyBicmVhazsgY2FzZSA0OiBfX2FzbV9fIF9fdm9s
YXRpbGVfXyggIjE6CSIibHd6IiIlVTIlWDIgJTEsICUyCSMgZ2V0X3VzZXJcbiIgIjI6XG4i
ICIuc2VjdGlvbiAuZml4dXAsXCJheFwiXG4iICIzOglsaSAlMCwlM1xuIiAiCWxpICUxLDBc
biIgIgliIDJiXG4iICIucHJldmlvdXNcbiIgIi5zZWN0aW9uIF9fZXhfdGFibGUsXCJhXCI7
IiAiICIgIi5iYWxpZ24gNDsiICIgIiAiLmxvbmcgKDFiKSAtIC4gOyIgIiAiICIubG9uZyAo
M2IpIC0gLiA7IiAiICIgIi5wcmV2aW91cyIgIiAiIDogIj1yIiAoX19ndV9lcnIpLCAiPXIi
IChfX2d1X3ZhbCkgOiAibTw+IiAoKih1MzIgKilfX2d1X2FkZHIpLCAiaSIgKC0xNCksICIw
IiAoX19ndV9lcnIpKTsgYnJlYWs7IGNhc2UgODogX19hc21fXyBfX3ZvbGF0aWxlX18oICIx
OgkiImxkIiIlVTIlWDIgJTEsICUyCSMgZ2V0X3VzZXJcbiIgIjI6XG4iICIuc2VjdGlvbiAu
Zml4dXAsXCJheFwiXG4iICIzOglsaSAlMCwlM1xuIiAiCWxpICUxLDBcbiIgIgliIDJiXG4i
ICIucHJldmlvdXNcbiIgIi5zZWN0aW9uIF9fZXhfdGFibGUsXCJhXCI7IiAiICIgIi5iYWxp
Z24gNDsiICIgIiAiLmxvbmcgKDFiKSAtIC4gOyIgIiAiICIubG9uZyAoM2IpIC0gLiA7IiAi
ICIgIi5wcmV2aW91cyIgIiAiIDogIj1yIiAoX19ndV9lcnIpLCAiPXIiIChfX2d1X3ZhbCkg
OiAibTw+IiAoKih1NjQgKilfX2d1X2FkZHIpLCAiaSIgKC0xNCksICIwIiAoX19ndV9lcnIp
KTsgYnJlYWs7IGRlZmF1bHQ6IChfX2d1X3ZhbCkgPSBfX2dldF91c2VyX2JhZCgpOyB9IH0g
d2hpbGUgKDApOyBwcmV2ZW50X3JlYWRfZnJvbV91c2VyKF9fZ3VfYWRkciwgX19ndV9zaXpl
KTsgfSB3aGlsZSAoMCk7IGVsc2UgZG8geyBfX2d1X2VyciA9IDA7ICh2b2lkKTA7IGlmIChf
X2d1X3NpemUgPiBzaXplb2YoX19ndV92YWwpKSAoX19ndV92YWwpID0gX19nZXRfdXNlcl9i
YWQoKTsgc3dpdGNoIChfX2d1X3NpemUpIHsgY2FzZSAxOiBfX2FzbV9fIF9fdm9sYXRpbGVf
XyggIjE6CSIibGJ6IiIlVTIlWDIgJTEsICUyCSMgZ2V0X3VzZXJcbiIgIjI6XG4iICIuc2Vj
dGlvbiAuZml4dXAsXCJheFwiXG4iICIzOglsaSAlMCwlM1xuIiAiCWxpICUxLDBcbiIgIgli
IDJiXG4iICIucHJldmlvdXNcbiIgIi5zZWN0aW9uIF9fZXhfdGFibGUsXCJhXCI7IiAiICIg
Ii5iYWxpZ24gNDsiICIgIiAiLmxvbmcgKDFiKSAtIC4gOyIgIiAiICIubG9uZyAoM2IpIC0g
LiA7IiAiICIgIi5wcmV2aW91cyIgIiAiIDogIj1yIiAoX19ndV9lcnIpLCAiPXIiIChfX2d1
X3ZhbCkgOiAibTw+IiAoKih1OCAqKV9fZ3VfYWRkciksICJpIiAoLTE0KSwgIjAiIChfX2d1
X2VycikpOyBicmVhazsgY2FzZSAyOiBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CSIibGh6
IiIlVTIlWDIgJTEsICUyCSMgZ2V0X3VzZXJcbiIgIjI6XG4iICIuc2VjdGlvbiAuZml4dXAs
XCJheFwiXG4iICIzOglsaSAlMCwlM1xuIiAiCWxpICUxLDBcbiIgIgliIDJiXG4iICIucHJl
dmlvdXNcbiIgIi5zZWN0aW9uIF9fZXhfdGFibGUsXCJhXCI7IiAiICIgIi5iYWxpZ24gNDsi
ICIgIiAiLmxvbmcgKDFiKSAtIC4gOyIgIiAiICIubG9uZyAoM2IpIC0gLiA7IiAiICIgIi5w
cmV2aW91cyIgIiAiIDogIj1yIiAoX19ndV9lcnIpLCAiPXIiIChfX2d1X3ZhbCkgOiAibTw+
IiAoKih1MTYgKilfX2d1X2FkZHIpLCAiaSIgKC0xNCksICIwIiAoX19ndV9lcnIpKTsgYnJl
YWs7IGNhc2UgNDogX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgkiImx3eiIiJVUyJVgyICUx
LCAlMgkjIGdldF91c2VyXG4iICIyOlxuIiAiLnNlY3Rpb24gLmZpeHVwLFwiYXhcIlxuIiAi
MzoJbGkgJTAsJTNcbiIgIglsaSAlMSwwXG4iICIJYiAyYlxuIiAiLnByZXZpb3VzXG4iICIu
c2VjdGlvbiBfX2V4X3RhYmxlLFwiYVwiOyIgIiAiICIuYmFsaWduIDQ7IiAiICIgIi5sb25n
ICgxYikgLSAuIDsiICIgIiAiLmxvbmcgKDNiKSAtIC4gOyIgIiAiICIucHJldmlvdXMiICIg
IiA6ICI9ciIgKF9fZ3VfZXJyKSwgIj1yIiAoX19ndV92YWwpIDogIm08PiIgKCoodTMyICop
X19ndV9hZGRyKSwgImkiICgtMTQpLCAiMCIgKF9fZ3VfZXJyKSk7IGJyZWFrOyBjYXNlIDg6
IF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJIiJsZCIiJVUyJVgyICUxLCAlMgkjIGdldF91
c2VyXG4iICIyOlxuIiAiLnNlY3Rpb24gLmZpeHVwLFwiYXhcIlxuIiAiMzoJbGkgJTAsJTNc
biIgIglsaSAlMSwwXG4iICIJYiAyYlxuIiAiLnByZXZpb3VzXG4iICIuc2VjdGlvbiBfX2V4
X3RhYmxlLFwiYVwiOyIgIiAiICIuYmFsaWduIDQ7IiAiICIgIi5sb25nICgxYikgLSAuIDsi
ICIgIiAiLmxvbmcgKDNiKSAtIC4gOyIgIiAiICIucHJldmlvdXMiICIgIiA6ICI9ciIgKF9f
Z3VfZXJyKSwgIj1yIiAoX19ndV92YWwpIDogIm08PiIgKCoodTY0ICopX19ndV9hZGRyKSwg
ImkiICgtMTQpLCAiMCIgKF9fZ3VfZXJyKSk7IGJyZWFrOyBkZWZhdWx0OiAoX19ndV92YWwp
ID0gX19nZXRfdXNlcl9iYWQoKTsgfSB9IHdoaWxlICgwKTsgKChjbWNwKSkgPSAoX190eXBl
b2ZfXygqKCgmdWNwLT51Y19yZWdzKSkpKV9fZ3VfdmFsOyBfX2d1X2VycjsgfSkpCiAgIHJl
dHVybiAtMTQ7CiAgbWNwID0gKHN0cnVjdCBtY29udGV4dDMyICopKHU2NCljbWNwOwoKIH0K
CgoKCgoKIHNldF9jdXJyZW50X2Jsb2NrZWQoJnNldCk7CiBpZiAocmVzdG9yZV91c2VyX3Jl
Z3MocmVncywgbWNwLCBzaWcpKQogIHJldHVybiAtMTQ7CgogcmV0dXJuIDA7Cn0KIyA5MTEg
ImFyY2gvcG93ZXJwYy9rZXJuZWwvc2lnbmFsXzMyLmMiCgojcHJhZ21hIEdDQyBkaWFnbm9z
dGljIHB1c2gKIyA5MTEgImFyY2gvcG93ZXJwYy9rZXJuZWwvc2lnbmFsXzMyLmMiCjsgOyBs
b25nIGNvbXBhdF9zeXNfc3dhcGNvbnRleHQoc3RydWN0IHVjb250ZXh0MzIgKiBvbGRfY3R4
LCBzdHJ1Y3QgdWNvbnRleHQzMiAqIG5ld19jdHgsIGludCBjdHhfc2l6ZSk7IGxvbmcgY29t
cGF0X3N5c19zd2FwY29udGV4dChzdHJ1Y3QgdWNvbnRleHQzMiAqIG9sZF9jdHgsIHN0cnVj
dCB1Y29udGV4dDMyICogbmV3X2N0eCwgaW50IGN0eF9zaXplKSBfX2F0dHJpYnV0ZV9fKChh
bGlhcygiX19zZV9jb21wYXRfc3lzX3N3YXBjb250ZXh0IikpKTsgOyBzdGF0aWMgaW5saW5l
IF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191bnVz
ZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkgbG9u
ZyBfX2RvX2NvbXBhdF9zeXNfc3dhcGNvbnRleHQoc3RydWN0IHVjb250ZXh0MzIgKiBvbGRf
Y3R4LCBzdHJ1Y3QgdWNvbnRleHQzMiAqIG5ld19jdHgsIGludCBjdHhfc2l6ZSk7IGxvbmcg
X19zZV9jb21wYXRfc3lzX3N3YXBjb250ZXh0KF9fdHlwZW9mKF9fYnVpbHRpbl9jaG9vc2Vf
ZXhwcigoX19idWlsdGluX3R5cGVzX2NvbXBhdGlibGVfcCh0eXBlb2YoKCBzdHJ1Y3QgdWNv
bnRleHQzMiAqKTApLCB0eXBlb2YoMExMKSkgfHwgX19idWlsdGluX3R5cGVzX2NvbXBhdGli
bGVfcCh0eXBlb2YoKCBzdHJ1Y3QgdWNvbnRleHQzMiAqKTApLCB0eXBlb2YoMFVMTCkpKSwg
MExMLCAwTCkpIG9sZF9jdHgsIF9fdHlwZW9mKF9fYnVpbHRpbl9jaG9vc2VfZXhwcigoX19i
dWlsdGluX3R5cGVzX2NvbXBhdGlibGVfcCh0eXBlb2YoKCBzdHJ1Y3QgdWNvbnRleHQzMiAq
KTApLCB0eXBlb2YoMExMKSkgfHwgX19idWlsdGluX3R5cGVzX2NvbXBhdGlibGVfcCh0eXBl
b2YoKCBzdHJ1Y3QgdWNvbnRleHQzMiAqKTApLCB0eXBlb2YoMFVMTCkpKSwgMExMLCAwTCkp
IG5ld19jdHgsIF9fdHlwZW9mKF9fYnVpbHRpbl9jaG9vc2VfZXhwcigoX19idWlsdGluX3R5
cGVzX2NvbXBhdGlibGVfcCh0eXBlb2YoKCBpbnQpMCksIHR5cGVvZigwTEwpKSB8fCBfX2J1
aWx0aW5fdHlwZXNfY29tcGF0aWJsZV9wKHR5cGVvZigoIGludCkwKSwgdHlwZW9mKDBVTEwp
KSksIDBMTCwgMEwpKSBjdHhfc2l6ZSk7IGxvbmcgX19zZV9jb21wYXRfc3lzX3N3YXBjb250
ZXh0KF9fdHlwZW9mKF9fYnVpbHRpbl9jaG9vc2VfZXhwcigoX19idWlsdGluX3R5cGVzX2Nv
bXBhdGlibGVfcCh0eXBlb2YoKCBzdHJ1Y3QgdWNvbnRleHQzMiAqKTApLCB0eXBlb2YoMExM
KSkgfHwgX19idWlsdGluX3R5cGVzX2NvbXBhdGlibGVfcCh0eXBlb2YoKCBzdHJ1Y3QgdWNv
bnRleHQzMiAqKTApLCB0eXBlb2YoMFVMTCkpKSwgMExMLCAwTCkpIG9sZF9jdHgsIF9fdHlw
ZW9mKF9fYnVpbHRpbl9jaG9vc2VfZXhwcigoX19idWlsdGluX3R5cGVzX2NvbXBhdGlibGVf
cCh0eXBlb2YoKCBzdHJ1Y3QgdWNvbnRleHQzMiAqKTApLCB0eXBlb2YoMExMKSkgfHwgX19i
dWlsdGluX3R5cGVzX2NvbXBhdGlibGVfcCh0eXBlb2YoKCBzdHJ1Y3QgdWNvbnRleHQzMiAq
KTApLCB0eXBlb2YoMFVMTCkpKSwgMExMLCAwTCkpIG5ld19jdHgsIF9fdHlwZW9mKF9fYnVp
bHRpbl9jaG9vc2VfZXhwcigoX19idWlsdGluX3R5cGVzX2NvbXBhdGlibGVfcCh0eXBlb2Yo
KCBpbnQpMCksIHR5cGVvZigwTEwpKSB8fCBfX2J1aWx0aW5fdHlwZXNfY29tcGF0aWJsZV9w
KHR5cGVvZigoIGludCkwKSwgdHlwZW9mKDBVTEwpKSksIDBMTCwgMEwpKSBjdHhfc2l6ZSkg
eyBsb25nIHJldCA9IF9fZG9fY29tcGF0X3N5c19zd2FwY29udGV4dCgoKCBzdHJ1Y3QgdWNv
bnRleHQzMiAqKSh1bnNpZ25lZCBsb25nKShvbGRfY3R4KSksICgoIHN0cnVjdCB1Y29udGV4
dDMyICopKHVuc2lnbmVkIGxvbmcpKG5ld19jdHgpKSwgKCggaW50KSh1bnNpZ25lZCBsb25n
KShjdHhfc2l6ZSkpKTsgKHZvaWQpKChpbnQpKHNpemVvZihzdHJ1Y3QgeyBpbnQ6KC0hISgh
KF9fYnVpbHRpbl90eXBlc19jb21wYXRpYmxlX3AodHlwZW9mKCggc3RydWN0IHVjb250ZXh0
MzIgKikwKSwgdHlwZW9mKDBMTCkpIHx8IF9fYnVpbHRpbl90eXBlc19jb21wYXRpYmxlX3Ao
dHlwZW9mKCggc3RydWN0IHVjb250ZXh0MzIgKikwKSwgdHlwZW9mKDBVTEwpKSkgJiYgc2l6
ZW9mKHN0cnVjdCB1Y29udGV4dDMyICopID4gc2l6ZW9mKGxvbmcpKSk7IH0pKSksICh2b2lk
KSgoaW50KShzaXplb2Yoc3RydWN0IHsgaW50OigtISEoIShfX2J1aWx0aW5fdHlwZXNfY29t
cGF0aWJsZV9wKHR5cGVvZigoIHN0cnVjdCB1Y29udGV4dDMyICopMCksIHR5cGVvZigwTEwp
KSB8fCBfX2J1aWx0aW5fdHlwZXNfY29tcGF0aWJsZV9wKHR5cGVvZigoIHN0cnVjdCB1Y29u
dGV4dDMyICopMCksIHR5cGVvZigwVUxMKSkpICYmIHNpemVvZihzdHJ1Y3QgdWNvbnRleHQz
MiAqKSA+IHNpemVvZihsb25nKSkpOyB9KSkpLCAodm9pZCkoKGludCkoc2l6ZW9mKHN0cnVj
dCB7IGludDooLSEhKCEoX19idWlsdGluX3R5cGVzX2NvbXBhdGlibGVfcCh0eXBlb2YoKCBp
bnQpMCksIHR5cGVvZigwTEwpKSB8fCBfX2J1aWx0aW5fdHlwZXNfY29tcGF0aWJsZV9wKHR5
cGVvZigoIGludCkwKSwgdHlwZW9mKDBVTEwpKSkgJiYgc2l6ZW9mKGludCkgPiBzaXplb2Yo
bG9uZykpKTsgfSkpKTsgcmV0dXJuIHJldDsgfQojcHJhZ21hIEdDQyBkaWFnbm9zdGljIHBv
cAojIDkxMSAiYXJjaC9wb3dlcnBjL2tlcm5lbC9zaWduYWxfMzIuYyIKOyBzdGF0aWMgaW5s
aW5lIF9fYXR0cmlidXRlX18oKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXygoX191
bnVzZWRfXykpIF9fYXR0cmlidXRlX18oKF9fbm9faW5zdHJ1bWVudF9mdW5jdGlvbl9fKSkg
bG9uZyBfX2RvX2NvbXBhdF9zeXNfc3dhcGNvbnRleHQoc3RydWN0IHVjb250ZXh0MzIgKiBv
bGRfY3R4LCBzdHJ1Y3QgdWNvbnRleHQzMiAqIG5ld19jdHgsIGludCBjdHhfc2l6ZSkKCgoK
Cgp7CiBzdHJ1Y3QgcHRfcmVncyAqcmVncyA9ICgoc3RydWN0IHB0X3JlZ3MgKikoKHVuc2ln
bmVkIGxvbmcpdGFza19zdGFja19wYWdlKGdldF9jdXJyZW50KCkpICsgKDEgPDwgMTQpKSAt
IDEpOwogaW50IGN0eF9oYXNfdnN4X3JlZ2lvbiA9IDA7CgoKIHVuc2lnbmVkIGxvbmcgbmV3
X21zciA9IDA7CgogaWYgKG5ld19jdHgpIHsKICBzdHJ1Y3QgbWNvbnRleHQzMiAqbWNwOwog
IHUzMiBjbWNwOwoKCgoKCgogIGlmICgoeyBsb25nIF9fZ3VfZXJyOyBfX3R5cGVvZl9fKF9f
YnVpbHRpbl9jaG9vc2VfZXhwcihzaXplb2YoKigoJm5ld19jdHgtPnVjX3JlZ3MpKSkgPiBz
aXplb2YoMFVMKSwgMFVMTCwgMFVMKSkgX19ndV92YWw7IF9fdHlwZW9mX18oKigoJm5ld19j
dHgtPnVjX3JlZ3MpKSkgKl9fZ3VfYWRkciA9ICgoJm5ld19jdHgtPnVjX3JlZ3MpKTsgX190
eXBlb2ZfXyhzaXplb2YoKigmbmV3X2N0eC0+dWNfcmVncykpKSBfX2d1X3NpemUgPSAoc2l6
ZW9mKCooJm5ld19jdHgtPnVjX3JlZ3MpKSk7ICh2b2lkKTA7IGlmICghKCgodW5zaWduZWQg
bG9uZylfX2d1X2FkZHIpID49IDB4ODAwMDAwMDAwMDAwMDAwMHVsKSkgbWlnaHRfZmF1bHQo
KTsgYXNtICgiOTUzOiAucHVzaHNlY3Rpb24gX19iYXJyaWVyX25vc3BlY19maXh1cCxcImFc
IjsgLmFsaWduIDI7IDk1NDogLjhieXRlIDk1M2ItOTU0YjsgLnBvcHNlY3Rpb247OyBub3A7
IG5vcCIgIiAiIDo6OiAibWVtb3J5Iik7IGlmICh0cnVlKSBkbyB7IGFsbG93X3JlYWRfZnJv
bV91c2VyKF9fZ3VfYWRkciwgX19ndV9zaXplKTsgZG8geyBfX2d1X2VyciA9IDA7ICh2b2lk
KTA7IGlmIChfX2d1X3NpemUgPiBzaXplb2YoX19ndV92YWwpKSAoX19ndV92YWwpID0gX19n
ZXRfdXNlcl9iYWQoKTsgc3dpdGNoIChfX2d1X3NpemUpIHsgY2FzZSAxOiBfX2FzbV9fIF9f
dm9sYXRpbGVfXyggIjE6CSIibGJ6IiIlVTIlWDIgJTEsICUyCSMgZ2V0X3VzZXJcbiIgIjI6
XG4iICIuc2VjdGlvbiAuZml4dXAsXCJheFwiXG4iICIzOglsaSAlMCwlM1xuIiAiCWxpICUx
LDBcbiIgIgliIDJiXG4iICIucHJldmlvdXNcbiIgIi5zZWN0aW9uIF9fZXhfdGFibGUsXCJh
XCI7IiAiICIgIi5iYWxpZ24gNDsiICIgIiAiLmxvbmcgKDFiKSAtIC4gOyIgIiAiICIubG9u
ZyAoM2IpIC0gLiA7IiAiICIgIi5wcmV2aW91cyIgIiAiIDogIj1yIiAoX19ndV9lcnIpLCAi
PXIiIChfX2d1X3ZhbCkgOiAibTw+IiAoKih1OCAqKV9fZ3VfYWRkciksICJpIiAoLTE0KSwg
IjAiIChfX2d1X2VycikpOyBicmVhazsgY2FzZSAyOiBfX2FzbV9fIF9fdm9sYXRpbGVfXygg
IjE6CSIibGh6IiIlVTIlWDIgJTEsICUyCSMgZ2V0X3VzZXJcbiIgIjI6XG4iICIuc2VjdGlv
biAuZml4dXAsXCJheFwiXG4iICIzOglsaSAlMCwlM1xuIiAiCWxpICUxLDBcbiIgIgliIDJi
XG4iICIucHJldmlvdXNcbiIgIi5zZWN0aW9uIF9fZXhfdGFibGUsXCJhXCI7IiAiICIgIi5i
YWxpZ24gNDsiICIgIiAiLmxvbmcgKDFiKSAtIC4gOyIgIiAiICIubG9uZyAoM2IpIC0gLiA7
IiAiICIgIi5wcmV2aW91cyIgIiAiIDogIj1yIiAoX19ndV9lcnIpLCAiPXIiIChfX2d1X3Zh
bCkgOiAibTw+IiAoKih1MTYgKilfX2d1X2FkZHIpLCAiaSIgKC0xNCksICIwIiAoX19ndV9l
cnIpKTsgYnJlYWs7IGNhc2UgNDogX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgkiImx3eiIi
JVUyJVgyICUxLCAlMgkjIGdldF91c2VyXG4iICIyOlxuIiAiLnNlY3Rpb24gLmZpeHVwLFwi
YXhcIlxuIiAiMzoJbGkgJTAsJTNcbiIgIglsaSAlMSwwXG4iICIJYiAyYlxuIiAiLnByZXZp
b3VzXG4iICIuc2VjdGlvbiBfX2V4X3RhYmxlLFwiYVwiOyIgIiAiICIuYmFsaWduIDQ7IiAi
ICIgIi5sb25nICgxYikgLSAuIDsiICIgIiAiLmxvbmcgKDNiKSAtIC4gOyIgIiAiICIucHJl
dmlvdXMiICIgIiA6ICI9ciIgKF9fZ3VfZXJyKSwgIj1yIiAoX19ndV92YWwpIDogIm08PiIg
KCoodTMyICopX19ndV9hZGRyKSwgImkiICgtMTQpLCAiMCIgKF9fZ3VfZXJyKSk7IGJyZWFr
OyBjYXNlIDg6IF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJIiJsZCIiJVUyJVgyICUxLCAl
MgkjIGdldF91c2VyXG4iICIyOlxuIiAiLnNlY3Rpb24gLmZpeHVwLFwiYXhcIlxuIiAiMzoJ
bGkgJTAsJTNcbiIgIglsaSAlMSwwXG4iICIJYiAyYlxuIiAiLnByZXZpb3VzXG4iICIuc2Vj
dGlvbiBfX2V4X3RhYmxlLFwiYVwiOyIgIiAiICIuYmFsaWduIDQ7IiAiICIgIi5sb25nICgx
YikgLSAuIDsiICIgIiAiLmxvbmcgKDNiKSAtIC4gOyIgIiAiICIucHJldmlvdXMiICIgIiA6
ICI9ciIgKF9fZ3VfZXJyKSwgIj1yIiAoX19ndV92YWwpIDogIm08PiIgKCoodTY0ICopX19n
dV9hZGRyKSwgImkiICgtMTQpLCAiMCIgKF9fZ3VfZXJyKSk7IGJyZWFrOyBkZWZhdWx0OiAo
X19ndV92YWwpID0gX19nZXRfdXNlcl9iYWQoKTsgfSB9IHdoaWxlICgwKTsgcHJldmVudF9y
ZWFkX2Zyb21fdXNlcihfX2d1X2FkZHIsIF9fZ3Vfc2l6ZSk7IH0gd2hpbGUgKDApOyBlbHNl
IGRvIHsgX19ndV9lcnIgPSAwOyAodm9pZCkwOyBpZiAoX19ndV9zaXplID4gc2l6ZW9mKF9f
Z3VfdmFsKSkgKF9fZ3VfdmFsKSA9IF9fZ2V0X3VzZXJfYmFkKCk7IHN3aXRjaCAoX19ndV9z
aXplKSB7IGNhc2UgMTogX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgkiImxieiIiJVUyJVgy
ICUxLCAlMgkjIGdldF91c2VyXG4iICIyOlxuIiAiLnNlY3Rpb24gLmZpeHVwLFwiYXhcIlxu
IiAiMzoJbGkgJTAsJTNcbiIgIglsaSAlMSwwXG4iICIJYiAyYlxuIiAiLnByZXZpb3VzXG4i
ICIuc2VjdGlvbiBfX2V4X3RhYmxlLFwiYVwiOyIgIiAiICIuYmFsaWduIDQ7IiAiICIgIi5s
b25nICgxYikgLSAuIDsiICIgIiAiLmxvbmcgKDNiKSAtIC4gOyIgIiAiICIucHJldmlvdXMi
ICIgIiA6ICI9ciIgKF9fZ3VfZXJyKSwgIj1yIiAoX19ndV92YWwpIDogIm08PiIgKCoodTgg
KilfX2d1X2FkZHIpLCAiaSIgKC0xNCksICIwIiAoX19ndV9lcnIpKTsgYnJlYWs7IGNhc2Ug
MjogX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgkiImxoeiIiJVUyJVgyICUxLCAlMgkjIGdl
dF91c2VyXG4iICIyOlxuIiAiLnNlY3Rpb24gLmZpeHVwLFwiYXhcIlxuIiAiMzoJbGkgJTAs
JTNcbiIgIglsaSAlMSwwXG4iICIJYiAyYlxuIiAiLnByZXZpb3VzXG4iICIuc2VjdGlvbiBf
X2V4X3RhYmxlLFwiYVwiOyIgIiAiICIuYmFsaWduIDQ7IiAiICIgIi5sb25nICgxYikgLSAu
IDsiICIgIiAiLmxvbmcgKDNiKSAtIC4gOyIgIiAiICIucHJldmlvdXMiICIgIiA6ICI9ciIg
KF9fZ3VfZXJyKSwgIj1yIiAoX19ndV92YWwpIDogIm08PiIgKCoodTE2ICopX19ndV9hZGRy
KSwgImkiICgtMTQpLCAiMCIgKF9fZ3VfZXJyKSk7IGJyZWFrOyBjYXNlIDQ6IF9fYXNtX18g
X192b2xhdGlsZV9fKCAiMToJIiJsd3oiIiVVMiVYMiAlMSwgJTIJIyBnZXRfdXNlclxuIiAi
MjpcbiIgIi5zZWN0aW9uIC5maXh1cCxcImF4XCJcbiIgIjM6CWxpICUwLCUzXG4iICIJbGkg
JTEsMFxuIiAiCWIgMmJcbiIgIi5wcmV2aW91c1xuIiAiLnNlY3Rpb24gX19leF90YWJsZSxc
ImFcIjsiICIgIiAiLmJhbGlnbiA0OyIgIiAiICIubG9uZyAoMWIpIC0gLiA7IiAiICIgIi5s
b25nICgzYikgLSAuIDsiICIgIiAiLnByZXZpb3VzIiAiICIgOiAiPXIiIChfX2d1X2Vyciks
ICI9ciIgKF9fZ3VfdmFsKSA6ICJtPD4iICgqKHUzMiAqKV9fZ3VfYWRkciksICJpIiAoLTE0
KSwgIjAiIChfX2d1X2VycikpOyBicmVhazsgY2FzZSA4OiBfX2FzbV9fIF9fdm9sYXRpbGVf
XyggIjE6CSIibGQiIiVVMiVYMiAlMSwgJTIJIyBnZXRfdXNlclxuIiAiMjpcbiIgIi5zZWN0
aW9uIC5maXh1cCxcImF4XCJcbiIgIjM6CWxpICUwLCUzXG4iICIJbGkgJTEsMFxuIiAiCWIg
MmJcbiIgIi5wcmV2aW91c1xuIiAiLnNlY3Rpb24gX19leF90YWJsZSxcImFcIjsiICIgIiAi
LmJhbGlnbiA0OyIgIiAiICIubG9uZyAoMWIpIC0gLiA7IiAiICIgIi5sb25nICgzYikgLSAu
IDsiICIgIiAiLnByZXZpb3VzIiAiICIgOiAiPXIiIChfX2d1X2VyciksICI9ciIgKF9fZ3Vf
dmFsKSA6ICJtPD4iICgqKHU2NCAqKV9fZ3VfYWRkciksICJpIiAoLTE0KSwgIjAiIChfX2d1
X2VycikpOyBicmVhazsgZGVmYXVsdDogKF9fZ3VfdmFsKSA9IF9fZ2V0X3VzZXJfYmFkKCk7
IH0gfSB3aGlsZSAoMCk7ICgoY21jcCkpID0gKF9fdHlwZW9mX18oKigoJm5ld19jdHgtPnVj
X3JlZ3MpKSkpX19ndV92YWw7IF9fZ3VfZXJyOyB9KSkKICAgcmV0dXJuIC0xNDsKICBtY3Ag
PSAoc3RydWN0IG1jb250ZXh0MzIgKikodTY0KWNtY3A7CiAgaWYgKCh7IGxvbmcgX19ndV9l
cnI7IF9fdHlwZW9mX18oX19idWlsdGluX2Nob29zZV9leHByKHNpemVvZigqKCgmbWNwLT5t
Y19ncmVnc1szM10pKSkgPiBzaXplb2YoMFVMKSwgMFVMTCwgMFVMKSkgX19ndV92YWw7IF9f
dHlwZW9mX18oKigoJm1jcC0+bWNfZ3JlZ3NbMzNdKSkpICpfX2d1X2FkZHIgPSAoKCZtY3At
Pm1jX2dyZWdzWzMzXSkpOyBfX3R5cGVvZl9fKHNpemVvZigqKCZtY3AtPm1jX2dyZWdzWzMz
XSkpKSBfX2d1X3NpemUgPSAoc2l6ZW9mKCooJm1jcC0+bWNfZ3JlZ3NbMzNdKSkpOyAodm9p
ZCkwOyBpZiAoISgoKHVuc2lnbmVkIGxvbmcpX19ndV9hZGRyKSA+PSAweDgwMDAwMDAwMDAw
MDAwMDB1bCkpIG1pZ2h0X2ZhdWx0KCk7IGFzbSAoIjk1MzogLnB1c2hzZWN0aW9uIF9fYmFy
cmllcl9ub3NwZWNfZml4dXAsXCJhXCI7IC5hbGlnbiAyOyA5NTQ6IC44Ynl0ZSA5NTNiLTk1
NGI7IC5wb3BzZWN0aW9uOzsgbm9wOyBub3AiICIgIiA6OjogIm1lbW9yeSIpOyBpZiAodHJ1
ZSkgZG8geyBhbGxvd19yZWFkX2Zyb21fdXNlcihfX2d1X2FkZHIsIF9fZ3Vfc2l6ZSk7IGRv
IHsgX19ndV9lcnIgPSAwOyAodm9pZCkwOyBpZiAoX19ndV9zaXplID4gc2l6ZW9mKF9fZ3Vf
dmFsKSkgKF9fZ3VfdmFsKSA9IF9fZ2V0X3VzZXJfYmFkKCk7IHN3aXRjaCAoX19ndV9zaXpl
KSB7IGNhc2UgMTogX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgkiImxieiIiJVUyJVgyICUx
LCAlMgkjIGdldF91c2VyXG4iICIyOlxuIiAiLnNlY3Rpb24gLmZpeHVwLFwiYXhcIlxuIiAi
MzoJbGkgJTAsJTNcbiIgIglsaSAlMSwwXG4iICIJYiAyYlxuIiAiLnByZXZpb3VzXG4iICIu
c2VjdGlvbiBfX2V4X3RhYmxlLFwiYVwiOyIgIiAiICIuYmFsaWduIDQ7IiAiICIgIi5sb25n
ICgxYikgLSAuIDsiICIgIiAiLmxvbmcgKDNiKSAtIC4gOyIgIiAiICIucHJldmlvdXMiICIg
IiA6ICI9ciIgKF9fZ3VfZXJyKSwgIj1yIiAoX19ndV92YWwpIDogIm08PiIgKCoodTggKilf
X2d1X2FkZHIpLCAiaSIgKC0xNCksICIwIiAoX19ndV9lcnIpKTsgYnJlYWs7IGNhc2UgMjog
X19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgkiImxoeiIiJVUyJVgyICUxLCAlMgkjIGdldF91
c2VyXG4iICIyOlxuIiAiLnNlY3Rpb24gLmZpeHVwLFwiYXhcIlxuIiAiMzoJbGkgJTAsJTNc
biIgIglsaSAlMSwwXG4iICIJYiAyYlxuIiAiLnByZXZpb3VzXG4iICIuc2VjdGlvbiBfX2V4
X3RhYmxlLFwiYVwiOyIgIiAiICIuYmFsaWduIDQ7IiAiICIgIi5sb25nICgxYikgLSAuIDsi
ICIgIiAiLmxvbmcgKDNiKSAtIC4gOyIgIiAiICIucHJldmlvdXMiICIgIiA6ICI9ciIgKF9f
Z3VfZXJyKSwgIj1yIiAoX19ndV92YWwpIDogIm08PiIgKCoodTE2ICopX19ndV9hZGRyKSwg
ImkiICgtMTQpLCAiMCIgKF9fZ3VfZXJyKSk7IGJyZWFrOyBjYXNlIDQ6IF9fYXNtX18gX192
b2xhdGlsZV9fKCAiMToJIiJsd3oiIiVVMiVYMiAlMSwgJTIJIyBnZXRfdXNlclxuIiAiMjpc
biIgIi5zZWN0aW9uIC5maXh1cCxcImF4XCJcbiIgIjM6CWxpICUwLCUzXG4iICIJbGkgJTEs
MFxuIiAiCWIgMmJcbiIgIi5wcmV2aW91c1xuIiAiLnNlY3Rpb24gX19leF90YWJsZSxcImFc
IjsiICIgIiAiLmJhbGlnbiA0OyIgIiAiICIubG9uZyAoMWIpIC0gLiA7IiAiICIgIi5sb25n
ICgzYikgLSAuIDsiICIgIiAiLnByZXZpb3VzIiAiICIgOiAiPXIiIChfX2d1X2VyciksICI9
ciIgKF9fZ3VfdmFsKSA6ICJtPD4iICgqKHUzMiAqKV9fZ3VfYWRkciksICJpIiAoLTE0KSwg
IjAiIChfX2d1X2VycikpOyBicmVhazsgY2FzZSA4OiBfX2FzbV9fIF9fdm9sYXRpbGVfXygg
IjE6CSIibGQiIiVVMiVYMiAlMSwgJTIJIyBnZXRfdXNlclxuIiAiMjpcbiIgIi5zZWN0aW9u
IC5maXh1cCxcImF4XCJcbiIgIjM6CWxpICUwLCUzXG4iICIJbGkgJTEsMFxuIiAiCWIgMmJc
biIgIi5wcmV2aW91c1xuIiAiLnNlY3Rpb24gX19leF90YWJsZSxcImFcIjsiICIgIiAiLmJh
bGlnbiA0OyIgIiAiICIubG9uZyAoMWIpIC0gLiA7IiAiICIgIi5sb25nICgzYikgLSAuIDsi
ICIgIiAiLnByZXZpb3VzIiAiICIgOiAiPXIiIChfX2d1X2VyciksICI9ciIgKF9fZ3VfdmFs
KSA6ICJtPD4iICgqKHU2NCAqKV9fZ3VfYWRkciksICJpIiAoLTE0KSwgIjAiIChfX2d1X2Vy
cikpOyBicmVhazsgZGVmYXVsdDogKF9fZ3VfdmFsKSA9IF9fZ2V0X3VzZXJfYmFkKCk7IH0g
fSB3aGlsZSAoMCk7IHByZXZlbnRfcmVhZF9mcm9tX3VzZXIoX19ndV9hZGRyLCBfX2d1X3Np
emUpOyB9IHdoaWxlICgwKTsgZWxzZSBkbyB7IF9fZ3VfZXJyID0gMDsgKHZvaWQpMDsgaWYg
KF9fZ3Vfc2l6ZSA+IHNpemVvZihfX2d1X3ZhbCkpIChfX2d1X3ZhbCkgPSBfX2dldF91c2Vy
X2JhZCgpOyBzd2l0Y2ggKF9fZ3Vfc2l6ZSkgeyBjYXNlIDE6IF9fYXNtX18gX192b2xhdGls
ZV9fKCAiMToJIiJsYnoiIiVVMiVYMiAlMSwgJTIJIyBnZXRfdXNlclxuIiAiMjpcbiIgIi5z
ZWN0aW9uIC5maXh1cCxcImF4XCJcbiIgIjM6CWxpICUwLCUzXG4iICIJbGkgJTEsMFxuIiAi
CWIgMmJcbiIgIi5wcmV2aW91c1xuIiAiLnNlY3Rpb24gX19leF90YWJsZSxcImFcIjsiICIg
IiAiLmJhbGlnbiA0OyIgIiAiICIubG9uZyAoMWIpIC0gLiA7IiAiICIgIi5sb25nICgzYikg
LSAuIDsiICIgIiAiLnByZXZpb3VzIiAiICIgOiAiPXIiIChfX2d1X2VyciksICI9ciIgKF9f
Z3VfdmFsKSA6ICJtPD4iICgqKHU4ICopX19ndV9hZGRyKSwgImkiICgtMTQpLCAiMCIgKF9f
Z3VfZXJyKSk7IGJyZWFrOyBjYXNlIDI6IF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJIiJs
aHoiIiVVMiVYMiAlMSwgJTIJIyBnZXRfdXNlclxuIiAiMjpcbiIgIi5zZWN0aW9uIC5maXh1
cCxcImF4XCJcbiIgIjM6CWxpICUwLCUzXG4iICIJbGkgJTEsMFxuIiAiCWIgMmJcbiIgIi5w
cmV2aW91c1xuIiAiLnNlY3Rpb24gX19leF90YWJsZSxcImFcIjsiICIgIiAiLmJhbGlnbiA0
OyIgIiAiICIubG9uZyAoMWIpIC0gLiA7IiAiICIgIi5sb25nICgzYikgLSAuIDsiICIgIiAi
LnByZXZpb3VzIiAiICIgOiAiPXIiIChfX2d1X2VyciksICI9ciIgKF9fZ3VfdmFsKSA6ICJt
PD4iICgqKHUxNiAqKV9fZ3VfYWRkciksICJpIiAoLTE0KSwgIjAiIChfX2d1X2VycikpOyBi
cmVhazsgY2FzZSA0OiBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CSIibHd6IiIlVTIlWDIg
JTEsICUyCSMgZ2V0X3VzZXJcbiIgIjI6XG4iICIuc2VjdGlvbiAuZml4dXAsXCJheFwiXG4i
ICIzOglsaSAlMCwlM1xuIiAiCWxpICUxLDBcbiIgIgliIDJiXG4iICIucHJldmlvdXNcbiIg
Ii5zZWN0aW9uIF9fZXhfdGFibGUsXCJhXCI7IiAiICIgIi5iYWxpZ24gNDsiICIgIiAiLmxv
bmcgKDFiKSAtIC4gOyIgIiAiICIubG9uZyAoM2IpIC0gLiA7IiAiICIgIi5wcmV2aW91cyIg
IiAiIDogIj1yIiAoX19ndV9lcnIpLCAiPXIiIChfX2d1X3ZhbCkgOiAibTw+IiAoKih1MzIg
KilfX2d1X2FkZHIpLCAiaSIgKC0xNCksICIwIiAoX19ndV9lcnIpKTsgYnJlYWs7IGNhc2Ug
ODogX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgkiImxkIiIlVTIlWDIgJTEsICUyCSMgZ2V0
X3VzZXJcbiIgIjI6XG4iICIuc2VjdGlvbiAuZml4dXAsXCJheFwiXG4iICIzOglsaSAlMCwl
M1xuIiAiCWxpICUxLDBcbiIgIgliIDJiXG4iICIucHJldmlvdXNcbiIgIi5zZWN0aW9uIF9f
ZXhfdGFibGUsXCJhXCI7IiAiICIgIi5iYWxpZ24gNDsiICIgIiAiLmxvbmcgKDFiKSAtIC4g
OyIgIiAiICIubG9uZyAoM2IpIC0gLiA7IiAiICIgIi5wcmV2aW91cyIgIiAiIDogIj1yIiAo
X19ndV9lcnIpLCAiPXIiIChfX2d1X3ZhbCkgOiAibTw+IiAoKih1NjQgKilfX2d1X2FkZHIp
LCAiaSIgKC0xNCksICIwIiAoX19ndV9lcnIpKTsgYnJlYWs7IGRlZmF1bHQ6IChfX2d1X3Zh
bCkgPSBfX2dldF91c2VyX2JhZCgpOyB9IH0gd2hpbGUgKDApOyAoKG5ld19tc3IpKSA9IChf
X3R5cGVvZl9fKCooKCZtY3AtPm1jX2dyZWdzWzMzXSkpKSlfX2d1X3ZhbDsgX19ndV9lcnI7
IH0pKQogICByZXR1cm4gLTE0OwogfQoKCgoKIGlmIChjdHhfc2l6ZSA8IChzaXplb2Yoc3Ry
dWN0IHVjb250ZXh0MzIpIC0gc2l6ZW9mKGVsZl92c3JyZWdoYWxmX3QzMikpKQogIHJldHVy
biAtMjI7CgoKCgogaWYgKChjdHhfc2l6ZSA8IHNpemVvZihzdHJ1Y3QgdWNvbnRleHQzMikp
ICYmCiAgICAgKG5ld19tc3IgJiAoMVVMPDwoMjMpKSkpCiAgcmV0dXJuIC0yMjsKCiBpZiAo
Y3R4X3NpemUgPj0gc2l6ZW9mKHN0cnVjdCB1Y29udGV4dDMyKSkKICBjdHhfaGFzX3ZzeF9y
ZWdpb24gPSAxOwoKCgoKCgoKIGlmIChvbGRfY3R4ICE9ICgodm9pZCAqKTApKSB7CiAgc3Ry
dWN0IG1jb250ZXh0MzIgKm1jdHg7CiMgOTcyICJhcmNoL3Bvd2VycGMva2VybmVsL3NpZ25h
bF8zMi5jIgogIG1jdHggPSAoc3RydWN0IG1jb250ZXh0MzIgKikKICAgKCh1bnNpZ25lZCBs
b25nKSAmb2xkX2N0eC0+dWNfbWNvbnRleHQgJiB+MHhmVUwpOwogIGlmICghKCh2b2lkKTAs
ICgoKCggdW5zaWduZWQgbG9uZykob2xkX2N0eCkpIDw9ICgoZ2V0X2N1cnJlbnQoKS0+dGhy
ZWFkLmFkZHJfbGltaXQpKS5zZWcpICYmICgoKGN0eF9zaXplKSkgPD0gKChnZXRfY3VycmVu
dCgpLT50aHJlYWQuYWRkcl9saW1pdCkpLnNlZykpKQogICAgICB8fCBzYXZlX3VzZXJfcmVn
cyhyZWdzLCBtY3R4LCAoKHZvaWQgKikwKSwgMCwgY3R4X2hhc192c3hfcmVnaW9uKQogICAg
ICB8fCBwdXRfc2lnc2V0X3QoJm9sZF9jdHgtPnVjX3NpZ21hc2ssICZnZXRfY3VycmVudCgp
LT5ibG9ja2VkKQogICAgICB8fCAoeyBsb25nIF9fcHVfZXJyOyBfX3R5cGVvZl9fKCooKCZv
bGRfY3R4LT51Y19yZWdzKSkpICpfX3B1X2FkZHIgPSAoKCZvbGRfY3R4LT51Y19yZWdzKSk7
IF9fdHlwZW9mX18oKigoJm9sZF9jdHgtPnVjX3JlZ3MpKSkgX19wdV92YWwgPSAoKF9fdHlw
ZW9mX18oKigmb2xkX2N0eC0+dWNfcmVncykpKShwdHJfdG9fY29tcGF0KG1jdHgpKSk7IF9f
dHlwZW9mX18oc2l6ZW9mKCooJm9sZF9jdHgtPnVjX3JlZ3MpKSkgX19wdV9zaXplID0gKHNp
emVvZigqKCZvbGRfY3R4LT51Y19yZWdzKSkpOyBpZiAoISgoKHVuc2lnbmVkIGxvbmcpX19w
dV9hZGRyKSA+PSAweDgwMDAwMDAwMDAwMDAwMDB1bCkpIG1pZ2h0X2ZhdWx0KCk7ICh2b2lk
KTA7IGRvIHsgYWxsb3dfd3JpdGVfdG9fdXNlcihfX3B1X2FkZHIsIF9fcHVfc2l6ZSk7IGRv
IHsgX19wdV9lcnIgPSAwOyBzd2l0Y2ggKF9fcHVfc2l6ZSkgeyBjYXNlIDE6IF9fYXNtX18g
X192b2xhdGlsZV9fKCAiMToJIiAic3RiIiAiJVUyJVgyICUxLCUyCSMgcHV0X3VzZXJcbiIg
IjI6XG4iICIuc2VjdGlvbiAuZml4dXAsXCJheFwiXG4iICIzOglsaSAlMCwlM1xuIiAiCWIg
MmJcbiIgIi5wcmV2aW91c1xuIiAiLnNlY3Rpb24gX19leF90YWJsZSxcImFcIjsiICIgIiAi
LmJhbGlnbiA0OyIgIiAiICIubG9uZyAoMWIpIC0gLiA7IiAiICIgIi5sb25nICgzYikgLSAu
IDsiICIgIiAiLnByZXZpb3VzIiAiICIgOiAiPXIiIChfX3B1X2VycikgOiAiciIgKF9fcHVf
dmFsKSwgIm08PiIgKCpfX3B1X2FkZHIpLCAiaSIgKC0xNCksICIwIiAoX19wdV9lcnIpKTsg
YnJlYWs7IGNhc2UgMjogX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgkiICJzdGgiICIlVTIl
WDIgJTEsJTIJIyBwdXRfdXNlclxuIiAiMjpcbiIgIi5zZWN0aW9uIC5maXh1cCxcImF4XCJc
biIgIjM6CWxpICUwLCUzXG4iICIJYiAyYlxuIiAiLnByZXZpb3VzXG4iICIuc2VjdGlvbiBf
X2V4X3RhYmxlLFwiYVwiOyIgIiAiICIuYmFsaWduIDQ7IiAiICIgIi5sb25nICgxYikgLSAu
IDsiICIgIiAiLmxvbmcgKDNiKSAtIC4gOyIgIiAiICIucHJldmlvdXMiICIgIiA6ICI9ciIg
KF9fcHVfZXJyKSA6ICJyIiAoX19wdV92YWwpLCAibTw+IiAoKl9fcHVfYWRkciksICJpIiAo
LTE0KSwgIjAiIChfX3B1X2VycikpOyBicmVhazsgY2FzZSA0OiBfX2FzbV9fIF9fdm9sYXRp
bGVfXyggIjE6CSIgInN0dyIgIiVVMiVYMiAlMSwlMgkjIHB1dF91c2VyXG4iICIyOlxuIiAi
LnNlY3Rpb24gLmZpeHVwLFwiYXhcIlxuIiAiMzoJbGkgJTAsJTNcbiIgIgliIDJiXG4iICIu
cHJldmlvdXNcbiIgIi5zZWN0aW9uIF9fZXhfdGFibGUsXCJhXCI7IiAiICIgIi5iYWxpZ24g
NDsiICIgIiAiLmxvbmcgKDFiKSAtIC4gOyIgIiAiICIubG9uZyAoM2IpIC0gLiA7IiAiICIg
Ii5wcmV2aW91cyIgIiAiIDogIj1yIiAoX19wdV9lcnIpIDogInIiIChfX3B1X3ZhbCksICJt
PD4iICgqX19wdV9hZGRyKSwgImkiICgtMTQpLCAiMCIgKF9fcHVfZXJyKSk7IGJyZWFrOyBj
YXNlIDg6IF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJIiAic3RkIiAiJVUyJVgyICUxLCUy
CSMgcHV0X3VzZXJcbiIgIjI6XG4iICIuc2VjdGlvbiAuZml4dXAsXCJheFwiXG4iICIzOgls
aSAlMCwlM1xuIiAiCWIgMmJcbiIgIi5wcmV2aW91c1xuIiAiLnNlY3Rpb24gX19leF90YWJs
ZSxcImFcIjsiICIgIiAiLmJhbGlnbiA0OyIgIiAiICIubG9uZyAoMWIpIC0gLiA7IiAiICIg
Ii5sb25nICgzYikgLSAuIDsiICIgIiAiLnByZXZpb3VzIiAiICIgOiAiPXIiIChfX3B1X2Vy
cikgOiAiciIgKF9fcHVfdmFsKSwgIm08PiIgKCpfX3B1X2FkZHIpLCAiaSIgKC0xNCksICIw
IiAoX19wdV9lcnIpKTsgYnJlYWs7IGRlZmF1bHQ6IF9fcHV0X3VzZXJfYmFkKCk7IH0gfSB3
aGlsZSAoMCk7IHByZXZlbnRfd3JpdGVfdG9fdXNlcihfX3B1X2FkZHIsIF9fcHVfc2l6ZSk7
IH0gd2hpbGUgKDApOyBfX3B1X2VycjsgfSkpCiAgIHJldHVybiAtMTQ7CiB9CiBpZiAobmV3
X2N0eCA9PSAoKHZvaWQgKikwKSkKICByZXR1cm4gMDsKIGlmICghKCh2b2lkKTAsICgoKCgg
dW5zaWduZWQgbG9uZykobmV3X2N0eCkpIDw9ICgoZ2V0X2N1cnJlbnQoKS0+dGhyZWFkLmFk
ZHJfbGltaXQpKS5zZWcpICYmICgoKGN0eF9zaXplKSkgPD0gKChnZXRfY3VycmVudCgpLT50
aHJlYWQuYWRkcl9saW1pdCkpLnNlZykpKSB8fAogICAgIGZhdWx0X2luX3BhZ2VzX3JlYWRh
YmxlKCh1OCAqKW5ld19jdHgsIGN0eF9zaXplKSkKICByZXR1cm4gLTE0OwojIDk5NyAiYXJj
aC9wb3dlcnBjL2tlcm5lbC9zaWduYWxfMzIuYyIKIGlmIChkb19zZXRjb250ZXh0KG5ld19j
dHgsIHJlZ3MsIDApKQogIGRvX2V4aXQoMTEpOwoKIHNldF90aV90aHJlYWRfZmxhZygoKHN0
cnVjdCB0aHJlYWRfaW5mbyAqKWdldF9jdXJyZW50KCkpLCAxMSk7CiByZXR1cm4gMDsKfQoK
CiBsb25nIGNvbXBhdF9zeXNfcnRfc2lncmV0dXJuKHZvaWQpOyA7IGxvbmcgY29tcGF0X3N5
c19ydF9zaWdyZXR1cm4odm9pZCkKCgoKewogc3RydWN0IHJ0X3NpZ2ZyYW1lICpydF9zZjsK
IHN0cnVjdCBwdF9yZWdzICpyZWdzID0gKChzdHJ1Y3QgcHRfcmVncyAqKSgodW5zaWduZWQg
bG9uZyl0YXNrX3N0YWNrX3BhZ2UoZ2V0X2N1cnJlbnQoKSkgKyAoMSA8PCAxNCkpIC0gMSk7
CiBpbnQgdG1fcmVzdG9yZSA9IDA7CgoKCgoKCiBnZXRfY3VycmVudCgpLT5yZXN0YXJ0X2Js
b2NrLmZuID0gZG9fbm9fcmVzdGFydF9zeXNjYWxsOwoKIHJ0X3NmID0gKHN0cnVjdCBydF9z
aWdmcmFtZSAqKQogIChyZWdzLT5ncHJbMV0gKyA2NCArIDE2KTsKIGlmICghKCh2b2lkKTAs
ICgoKCggdW5zaWduZWQgbG9uZykocnRfc2YpKSA8PSAoKGdldF9jdXJyZW50KCktPnRocmVh
ZC5hZGRyX2xpbWl0KSkuc2VnKSAmJiAoKChzaXplb2YoKnJ0X3NmKSkpIDw9ICgoZ2V0X2N1
cnJlbnQoKS0+dGhyZWFkLmFkZHJfbGltaXQpKS5zZWcpKSkpCiAgZ290byBiYWQ7CiMgMTA3
NyAiYXJjaC9wb3dlcnBjL2tlcm5lbC9zaWduYWxfMzIuYyIKIGlmICghdG1fcmVzdG9yZSkK
ICBpZiAoZG9fc2V0Y29udGV4dCgmcnRfc2YtPnVjLCByZWdzLCAxKSkKICAgZ290byBiYWQ7
CiMgMTA4OSAiYXJjaC9wb3dlcnBjL2tlcm5lbC9zaWduYWxfMzIuYyIKIGlmIChjb21wYXRf
cmVzdG9yZV9hbHRzdGFjaygmcnRfc2YtPnVjLnVjX3N0YWNrKSkKICBnb3RvIGJhZDsKCgoK
CiBzZXRfdGlfdGhyZWFkX2ZsYWcoKChzdHJ1Y3QgdGhyZWFkX2luZm8gKilnZXRfY3VycmVu
dCgpKSwgMTEpOwogcmV0dXJuIDA7CgogYmFkOgogaWYgKHNob3dfdW5oYW5kbGVkX3NpZ25h
bHMpCiAgKHsgc3RhdGljIHN0cnVjdCByYXRlbGltaXRfc3RhdGUgX3JzID0geyAubG9jayA9
IChyYXdfc3BpbmxvY2tfdCkgeyAucmF3X2xvY2sgPSB7IDAgfSwgfSwgLmludGVydmFsID0g
KDUgKiAyNTApLCAuYnVyc3QgPSAxMCwgfTsgaWYgKF9fX3JhdGVsaW1pdCgmX3JzLCBfX2Z1
bmNfXykpIHByaW50aygiXDAwMSIgIjYiICIlc1slZF06IGJhZCBmcmFtZSBpbiBzeXNfcnRf
c2lncmV0dXJuOiAiICIlcCBuaXAgJTA4bHggbHIgJTA4bHhcbiIsIGdldF9jdXJyZW50KCkt
PmNvbW0sIGdldF9jdXJyZW50KCktPnBpZCwgcnRfc2YsIHJlZ3MtPm5pcCwgcmVncy0+bGlu
ayk7IH0pCgoKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDsKCiBmb3Jj
ZV9zaWcoMTEpOwogcmV0dXJuIDA7Cn0KIyAxMjE3ICJhcmNoL3Bvd2VycGMva2VybmVsL3Np
Z25hbF8zMi5jIgppbnQgaGFuZGxlX3NpZ25hbDMyKHN0cnVjdCBrc2lnbmFsICprc2lnLCBz
aWdzZXRfdCAqb2xkc2V0LAogIHN0cnVjdCB0YXNrX3N0cnVjdCAqdHNrKQp7CiBzdHJ1Y3Qg
c2lnY29udGV4dDMyICpzYzsKIHN0cnVjdCBzaWdmcmFtZSAqZnJhbWU7CiBzdHJ1Y3QgbWNv
bnRleHQzMiAqdG1fbWN0eCA9ICgodm9pZCAqKTApOwogdW5zaWduZWQgbG9uZyBuZXdzcCA9
IDA7CiBpbnQgc2lncmV0OwogdW5zaWduZWQgbG9uZyBtY19wYWQ7CiBzdHJ1Y3QgcHRfcmVn
cyAqcmVncyA9IHRzay0+dGhyZWFkLnJlZ3M7CgoKCgoKIGRvIHsgaWYgKF9fYnVpbHRpbl9j
b25zdGFudF9wKHRzayAhPSBnZXRfY3VycmVudCgpKSkgeyBpZiAodHNrICE9IGdldF9jdXJy
ZW50KCkpIGRvIHsgX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgkiICJ0d2kgMzEsIDAsIDAi
ICJcbiIgIi5zZWN0aW9uIF9fYnVnX3RhYmxlLFwiYXdcIlxuIiAiMjpcdCIgIi44Ynl0ZSIg
IiAiICIxYiwgJTBcbiIgIlx0LnNob3J0ICUxLCAlMlxuIiAiLm9yZyAyYislM1xuIiAiLnBy
ZXZpb3VzXG4iIDogOiAiaSIgKCJhcmNoL3Bvd2VycGMva2VybmVsL3NpZ25hbF8zMi5jIiks
ICJpIiAoMTIzMiksICJpIiAoMCksICJpIiAoc2l6ZW9mKHN0cnVjdCBidWdfZW50cnkpKSk7
IGRvIHsgOyBhc20gdm9sYXRpbGUoIiIpOyBfX2J1aWx0aW5fdW5yZWFjaGFibGUoKTsgfSB3
aGlsZSAoMCk7IH0gd2hpbGUgKDApOyB9IGVsc2UgeyBfX2FzbV9fIF9fdm9sYXRpbGVfXygg
IjE6CSIgInRkbmVpIiAiICIgIiAlNCwgMCIgIlxuIiAiLnNlY3Rpb24gX19idWdfdGFibGUs
XCJhd1wiXG4iICIyOlx0IiAiLjhieXRlIiAiICIgIjFiLCAlMFxuIiAiXHQuc2hvcnQgJTEs
ICUyXG4iICIub3JnIDJiKyUzXG4iICIucHJldmlvdXNcbiIgOiA6ICJpIiAoImFyY2gvcG93
ZXJwYy9rZXJuZWwvc2lnbmFsXzMyLmMiKSwgImkiICgxMjMyKSwgImkiICgwKSwgImkiIChz
aXplb2Yoc3RydWN0IGJ1Z19lbnRyeSkpLCAiciIgKCggbG9uZykodHNrICE9IGdldF9jdXJy
ZW50KCkpKSk7IH0gfSB3aGlsZSAoMCk7CgoKIGZyYW1lID0gZ2V0X3NpZ2ZyYW1lKGtzaWcs
IGdldF90bV9zdGFja3BvaW50ZXIodHNrKSwgc2l6ZW9mKCpmcmFtZSksIDEpOwogaWYgKF9f
YnVpbHRpbl9leHBlY3QoISEoZnJhbWUgPT0gKCh2b2lkICopMCkpLCAwKSkKICBnb3RvIGJh
ZGZyYW1lOwogc2MgPSAoc3RydWN0IHNpZ2NvbnRleHQzMiAqKSAmZnJhbWUtPnNjdHg7CgoK
CgogaWYgKCh7IGxvbmcgX19wdV9lcnI7IF9fdHlwZW9mX18oKigoJnNjLT5oYW5kbGVyKSkp
ICpfX3B1X2FkZHIgPSAoKCZzYy0+aGFuZGxlcikpOyBfX3R5cGVvZl9fKCooKCZzYy0+aGFu
ZGxlcikpKSBfX3B1X3ZhbCA9ICgoX190eXBlb2ZfXygqKCZzYy0+aGFuZGxlcikpKShwdHJf
dG9fY29tcGF0KGtzaWctPmthLnNhLnNhX2hhbmRsZXIpKSk7IF9fdHlwZW9mX18oc2l6ZW9m
KCooJnNjLT5oYW5kbGVyKSkpIF9fcHVfc2l6ZSA9IChzaXplb2YoKigmc2MtPmhhbmRsZXIp
KSk7IGlmICghKCgodW5zaWduZWQgbG9uZylfX3B1X2FkZHIpID49IDB4ODAwMDAwMDAwMDAw
MDAwMHVsKSkgbWlnaHRfZmF1bHQoKTsgKHZvaWQpMDsgZG8geyBhbGxvd193cml0ZV90b191
c2VyKF9fcHVfYWRkciwgX19wdV9zaXplKTsgZG8geyBfX3B1X2VyciA9IDA7IHN3aXRjaCAo
X19wdV9zaXplKSB7IGNhc2UgMTogX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgkiICJzdGIi
ICIlVTIlWDIgJTEsJTIJIyBwdXRfdXNlclxuIiAiMjpcbiIgIi5zZWN0aW9uIC5maXh1cCxc
ImF4XCJcbiIgIjM6CWxpICUwLCUzXG4iICIJYiAyYlxuIiAiLnByZXZpb3VzXG4iICIuc2Vj
dGlvbiBfX2V4X3RhYmxlLFwiYVwiOyIgIiAiICIuYmFsaWduIDQ7IiAiICIgIi5sb25nICgx
YikgLSAuIDsiICIgIiAiLmxvbmcgKDNiKSAtIC4gOyIgIiAiICIucHJldmlvdXMiICIgIiA6
ICI9ciIgKF9fcHVfZXJyKSA6ICJyIiAoX19wdV92YWwpLCAibTw+IiAoKl9fcHVfYWRkciks
ICJpIiAoLTE0KSwgIjAiIChfX3B1X2VycikpOyBicmVhazsgY2FzZSAyOiBfX2FzbV9fIF9f
dm9sYXRpbGVfXyggIjE6CSIgInN0aCIgIiVVMiVYMiAlMSwlMgkjIHB1dF91c2VyXG4iICIy
OlxuIiAiLnNlY3Rpb24gLmZpeHVwLFwiYXhcIlxuIiAiMzoJbGkgJTAsJTNcbiIgIgliIDJi
XG4iICIucHJldmlvdXNcbiIgIi5zZWN0aW9uIF9fZXhfdGFibGUsXCJhXCI7IiAiICIgIi5i
YWxpZ24gNDsiICIgIiAiLmxvbmcgKDFiKSAtIC4gOyIgIiAiICIubG9uZyAoM2IpIC0gLiA7
IiAiICIgIi5wcmV2aW91cyIgIiAiIDogIj1yIiAoX19wdV9lcnIpIDogInIiIChfX3B1X3Zh
bCksICJtPD4iICgqX19wdV9hZGRyKSwgImkiICgtMTQpLCAiMCIgKF9fcHVfZXJyKSk7IGJy
ZWFrOyBjYXNlIDQ6IF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJIiAic3R3IiAiJVUyJVgy
ICUxLCUyCSMgcHV0X3VzZXJcbiIgIjI6XG4iICIuc2VjdGlvbiAuZml4dXAsXCJheFwiXG4i
ICIzOglsaSAlMCwlM1xuIiAiCWIgMmJcbiIgIi5wcmV2aW91c1xuIiAiLnNlY3Rpb24gX19l
eF90YWJsZSxcImFcIjsiICIgIiAiLmJhbGlnbiA0OyIgIiAiICIubG9uZyAoMWIpIC0gLiA7
IiAiICIgIi5sb25nICgzYikgLSAuIDsiICIgIiAiLnByZXZpb3VzIiAiICIgOiAiPXIiIChf
X3B1X2VycikgOiAiciIgKF9fcHVfdmFsKSwgIm08PiIgKCpfX3B1X2FkZHIpLCAiaSIgKC0x
NCksICIwIiAoX19wdV9lcnIpKTsgYnJlYWs7IGNhc2UgODogX19hc21fXyBfX3ZvbGF0aWxl
X18oICIxOgkiICJzdGQiICIlVTIlWDIgJTEsJTIJIyBwdXRfdXNlclxuIiAiMjpcbiIgIi5z
ZWN0aW9uIC5maXh1cCxcImF4XCJcbiIgIjM6CWxpICUwLCUzXG4iICIJYiAyYlxuIiAiLnBy
ZXZpb3VzXG4iICIuc2VjdGlvbiBfX2V4X3RhYmxlLFwiYVwiOyIgIiAiICIuYmFsaWduIDQ7
IiAiICIgIi5sb25nICgxYikgLSAuIDsiICIgIiAiLmxvbmcgKDNiKSAtIC4gOyIgIiAiICIu
cHJldmlvdXMiICIgIiA6ICI9ciIgKF9fcHVfZXJyKSA6ICJyIiAoX19wdV92YWwpLCAibTw+
IiAoKl9fcHVfYWRkciksICJpIiAoLTE0KSwgIjAiIChfX3B1X2VycikpOyBicmVhazsgZGVm
YXVsdDogX19wdXRfdXNlcl9iYWQoKTsgfSB9IHdoaWxlICgwKTsgcHJldmVudF93cml0ZV90
b191c2VyKF9fcHVfYWRkciwgX19wdV9zaXplKTsgfSB3aGlsZSAoMCk7IF9fcHVfZXJyOyB9
KQogICAgIHx8ICh7IGxvbmcgX19wdV9lcnI7IF9fdHlwZW9mX18oKigoJnNjLT5vbGRtYXNr
KSkpICpfX3B1X2FkZHIgPSAoKCZzYy0+b2xkbWFzaykpOyBfX3R5cGVvZl9fKCooKCZzYy0+
b2xkbWFzaykpKSBfX3B1X3ZhbCA9ICgoX190eXBlb2ZfXygqKCZzYy0+b2xkbWFzaykpKShv
bGRzZXQtPnNpZ1swXSkpOyBfX3R5cGVvZl9fKHNpemVvZigqKCZzYy0+b2xkbWFzaykpKSBf
X3B1X3NpemUgPSAoc2l6ZW9mKCooJnNjLT5vbGRtYXNrKSkpOyBpZiAoISgoKHVuc2lnbmVk
IGxvbmcpX19wdV9hZGRyKSA+PSAweDgwMDAwMDAwMDAwMDAwMDB1bCkpIG1pZ2h0X2ZhdWx0
KCk7ICh2b2lkKTA7IGRvIHsgYWxsb3dfd3JpdGVfdG9fdXNlcihfX3B1X2FkZHIsIF9fcHVf
c2l6ZSk7IGRvIHsgX19wdV9lcnIgPSAwOyBzd2l0Y2ggKF9fcHVfc2l6ZSkgeyBjYXNlIDE6
IF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJIiAic3RiIiAiJVUyJVgyICUxLCUyCSMgcHV0
X3VzZXJcbiIgIjI6XG4iICIuc2VjdGlvbiAuZml4dXAsXCJheFwiXG4iICIzOglsaSAlMCwl
M1xuIiAiCWIgMmJcbiIgIi5wcmV2aW91c1xuIiAiLnNlY3Rpb24gX19leF90YWJsZSxcImFc
IjsiICIgIiAiLmJhbGlnbiA0OyIgIiAiICIubG9uZyAoMWIpIC0gLiA7IiAiICIgIi5sb25n
ICgzYikgLSAuIDsiICIgIiAiLnByZXZpb3VzIiAiICIgOiAiPXIiIChfX3B1X2VycikgOiAi
ciIgKF9fcHVfdmFsKSwgIm08PiIgKCpfX3B1X2FkZHIpLCAiaSIgKC0xNCksICIwIiAoX19w
dV9lcnIpKTsgYnJlYWs7IGNhc2UgMjogX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgkiICJz
dGgiICIlVTIlWDIgJTEsJTIJIyBwdXRfdXNlclxuIiAiMjpcbiIgIi5zZWN0aW9uIC5maXh1
cCxcImF4XCJcbiIgIjM6CWxpICUwLCUzXG4iICIJYiAyYlxuIiAiLnByZXZpb3VzXG4iICIu
c2VjdGlvbiBfX2V4X3RhYmxlLFwiYVwiOyIgIiAiICIuYmFsaWduIDQ7IiAiICIgIi5sb25n
ICgxYikgLSAuIDsiICIgIiAiLmxvbmcgKDNiKSAtIC4gOyIgIiAiICIucHJldmlvdXMiICIg
IiA6ICI9ciIgKF9fcHVfZXJyKSA6ICJyIiAoX19wdV92YWwpLCAibTw+IiAoKl9fcHVfYWRk
ciksICJpIiAoLTE0KSwgIjAiIChfX3B1X2VycikpOyBicmVhazsgY2FzZSA0OiBfX2FzbV9f
IF9fdm9sYXRpbGVfXyggIjE6CSIgInN0dyIgIiVVMiVYMiAlMSwlMgkjIHB1dF91c2VyXG4i
ICIyOlxuIiAiLnNlY3Rpb24gLmZpeHVwLFwiYXhcIlxuIiAiMzoJbGkgJTAsJTNcbiIgIgli
IDJiXG4iICIucHJldmlvdXNcbiIgIi5zZWN0aW9uIF9fZXhfdGFibGUsXCJhXCI7IiAiICIg
Ii5iYWxpZ24gNDsiICIgIiAiLmxvbmcgKDFiKSAtIC4gOyIgIiAiICIubG9uZyAoM2IpIC0g
LiA7IiAiICIgIi5wcmV2aW91cyIgIiAiIDogIj1yIiAoX19wdV9lcnIpIDogInIiIChfX3B1
X3ZhbCksICJtPD4iICgqX19wdV9hZGRyKSwgImkiICgtMTQpLCAiMCIgKF9fcHVfZXJyKSk7
IGJyZWFrOyBjYXNlIDg6IF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJIiAic3RkIiAiJVUy
JVgyICUxLCUyCSMgcHV0X3VzZXJcbiIgIjI6XG4iICIuc2VjdGlvbiAuZml4dXAsXCJheFwi
XG4iICIzOglsaSAlMCwlM1xuIiAiCWIgMmJcbiIgIi5wcmV2aW91c1xuIiAiLnNlY3Rpb24g
X19leF90YWJsZSxcImFcIjsiICIgIiAiLmJhbGlnbiA0OyIgIiAiICIubG9uZyAoMWIpIC0g
LiA7IiAiICIgIi5sb25nICgzYikgLSAuIDsiICIgIiAiLnByZXZpb3VzIiAiICIgOiAiPXIi
IChfX3B1X2VycikgOiAiciIgKF9fcHVfdmFsKSwgIm08PiIgKCpfX3B1X2FkZHIpLCAiaSIg
KC0xNCksICIwIiAoX19wdV9lcnIpKTsgYnJlYWs7IGRlZmF1bHQ6IF9fcHV0X3VzZXJfYmFk
KCk7IH0gfSB3aGlsZSAoMCk7IHByZXZlbnRfd3JpdGVfdG9fdXNlcihfX3B1X2FkZHIsIF9f
cHVfc2l6ZSk7IH0gd2hpbGUgKDApOyBfX3B1X2VycjsgfSkKCiAgICAgfHwgKHsgbG9uZyBf
X3B1X2VycjsgX190eXBlb2ZfXygqKCgmc2MtPl91bnVzZWRbM10pKSkgKl9fcHVfYWRkciA9
ICgoJnNjLT5fdW51c2VkWzNdKSk7IF9fdHlwZW9mX18oKigoJnNjLT5fdW51c2VkWzNdKSkp
IF9fcHVfdmFsID0gKChfX3R5cGVvZl9fKCooJnNjLT5fdW51c2VkWzNdKSkpKChvbGRzZXQt
PnNpZ1swXSA+PiAzMikpKTsgX190eXBlb2ZfXyhzaXplb2YoKigmc2MtPl91bnVzZWRbM10p
KSkgX19wdV9zaXplID0gKHNpemVvZigqKCZzYy0+X3VudXNlZFszXSkpKTsgaWYgKCEoKCh1
bnNpZ25lZCBsb25nKV9fcHVfYWRkcikgPj0gMHg4MDAwMDAwMDAwMDAwMDAwdWwpKSBtaWdo
dF9mYXVsdCgpOyAodm9pZCkwOyBkbyB7IGFsbG93X3dyaXRlX3RvX3VzZXIoX19wdV9hZGRy
LCBfX3B1X3NpemUpOyBkbyB7IF9fcHVfZXJyID0gMDsgc3dpdGNoIChfX3B1X3NpemUpIHsg
Y2FzZSAxOiBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CSIgInN0YiIgIiVVMiVYMiAlMSwl
MgkjIHB1dF91c2VyXG4iICIyOlxuIiAiLnNlY3Rpb24gLmZpeHVwLFwiYXhcIlxuIiAiMzoJ
bGkgJTAsJTNcbiIgIgliIDJiXG4iICIucHJldmlvdXNcbiIgIi5zZWN0aW9uIF9fZXhfdGFi
bGUsXCJhXCI7IiAiICIgIi5iYWxpZ24gNDsiICIgIiAiLmxvbmcgKDFiKSAtIC4gOyIgIiAi
ICIubG9uZyAoM2IpIC0gLiA7IiAiICIgIi5wcmV2aW91cyIgIiAiIDogIj1yIiAoX19wdV9l
cnIpIDogInIiIChfX3B1X3ZhbCksICJtPD4iICgqX19wdV9hZGRyKSwgImkiICgtMTQpLCAi
MCIgKF9fcHVfZXJyKSk7IGJyZWFrOyBjYXNlIDI6IF9fYXNtX18gX192b2xhdGlsZV9fKCAi
MToJIiAic3RoIiAiJVUyJVgyICUxLCUyCSMgcHV0X3VzZXJcbiIgIjI6XG4iICIuc2VjdGlv
biAuZml4dXAsXCJheFwiXG4iICIzOglsaSAlMCwlM1xuIiAiCWIgMmJcbiIgIi5wcmV2aW91
c1xuIiAiLnNlY3Rpb24gX19leF90YWJsZSxcImFcIjsiICIgIiAiLmJhbGlnbiA0OyIgIiAi
ICIubG9uZyAoMWIpIC0gLiA7IiAiICIgIi5sb25nICgzYikgLSAuIDsiICIgIiAiLnByZXZp
b3VzIiAiICIgOiAiPXIiIChfX3B1X2VycikgOiAiciIgKF9fcHVfdmFsKSwgIm08PiIgKCpf
X3B1X2FkZHIpLCAiaSIgKC0xNCksICIwIiAoX19wdV9lcnIpKTsgYnJlYWs7IGNhc2UgNDog
X19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgkiICJzdHciICIlVTIlWDIgJTEsJTIJIyBwdXRf
dXNlclxuIiAiMjpcbiIgIi5zZWN0aW9uIC5maXh1cCxcImF4XCJcbiIgIjM6CWxpICUwLCUz
XG4iICIJYiAyYlxuIiAiLnByZXZpb3VzXG4iICIuc2VjdGlvbiBfX2V4X3RhYmxlLFwiYVwi
OyIgIiAiICIuYmFsaWduIDQ7IiAiICIgIi5sb25nICgxYikgLSAuIDsiICIgIiAiLmxvbmcg
KDNiKSAtIC4gOyIgIiAiICIucHJldmlvdXMiICIgIiA6ICI9ciIgKF9fcHVfZXJyKSA6ICJy
IiAoX19wdV92YWwpLCAibTw+IiAoKl9fcHVfYWRkciksICJpIiAoLTE0KSwgIjAiIChfX3B1
X2VycikpOyBicmVhazsgY2FzZSA4OiBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6CSIgInN0
ZCIgIiVVMiVYMiAlMSwlMgkjIHB1dF91c2VyXG4iICIyOlxuIiAiLnNlY3Rpb24gLmZpeHVw
LFwiYXhcIlxuIiAiMzoJbGkgJTAsJTNcbiIgIgliIDJiXG4iICIucHJldmlvdXNcbiIgIi5z
ZWN0aW9uIF9fZXhfdGFibGUsXCJhXCI7IiAiICIgIi5iYWxpZ24gNDsiICIgIiAiLmxvbmcg
KDFiKSAtIC4gOyIgIiAiICIubG9uZyAoM2IpIC0gLiA7IiAiICIgIi5wcmV2aW91cyIgIiAi
IDogIj1yIiAoX19wdV9lcnIpIDogInIiIChfX3B1X3ZhbCksICJtPD4iICgqX19wdV9hZGRy
KSwgImkiICgtMTQpLCAiMCIgKF9fcHVfZXJyKSk7IGJyZWFrOyBkZWZhdWx0OiBfX3B1dF91
c2VyX2JhZCgpOyB9IH0gd2hpbGUgKDApOyBwcmV2ZW50X3dyaXRlX3RvX3VzZXIoX19wdV9h
ZGRyLCBfX3B1X3NpemUpOyB9IHdoaWxlICgwKTsgX19wdV9lcnI7IH0pCgoKCiAgICAgfHwg
KHsgbG9uZyBfX3B1X2VycjsgX190eXBlb2ZfXygqKCgmc2MtPnJlZ3MpKSkgKl9fcHVfYWRk
ciA9ICgoJnNjLT5yZWdzKSk7IF9fdHlwZW9mX18oKigoJnNjLT5yZWdzKSkpIF9fcHVfdmFs
ID0gKChfX3R5cGVvZl9fKCooJnNjLT5yZWdzKSkpKHB0cl90b19jb21wYXQoJmZyYW1lLT5t
Y3R4KSkpOyBfX3R5cGVvZl9fKHNpemVvZigqKCZzYy0+cmVncykpKSBfX3B1X3NpemUgPSAo
c2l6ZW9mKCooJnNjLT5yZWdzKSkpOyBpZiAoISgoKHVuc2lnbmVkIGxvbmcpX19wdV9hZGRy
KSA+PSAweDgwMDAwMDAwMDAwMDAwMDB1bCkpIG1pZ2h0X2ZhdWx0KCk7ICh2b2lkKTA7IGRv
IHsgYWxsb3dfd3JpdGVfdG9fdXNlcihfX3B1X2FkZHIsIF9fcHVfc2l6ZSk7IGRvIHsgX19w
dV9lcnIgPSAwOyBzd2l0Y2ggKF9fcHVfc2l6ZSkgeyBjYXNlIDE6IF9fYXNtX18gX192b2xh
dGlsZV9fKCAiMToJIiAic3RiIiAiJVUyJVgyICUxLCUyCSMgcHV0X3VzZXJcbiIgIjI6XG4i
ICIuc2VjdGlvbiAuZml4dXAsXCJheFwiXG4iICIzOglsaSAlMCwlM1xuIiAiCWIgMmJcbiIg
Ii5wcmV2aW91c1xuIiAiLnNlY3Rpb24gX19leF90YWJsZSxcImFcIjsiICIgIiAiLmJhbGln
biA0OyIgIiAiICIubG9uZyAoMWIpIC0gLiA7IiAiICIgIi5sb25nICgzYikgLSAuIDsiICIg
IiAiLnByZXZpb3VzIiAiICIgOiAiPXIiIChfX3B1X2VycikgOiAiciIgKF9fcHVfdmFsKSwg
Im08PiIgKCpfX3B1X2FkZHIpLCAiaSIgKC0xNCksICIwIiAoX19wdV9lcnIpKTsgYnJlYWs7
IGNhc2UgMjogX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgkiICJzdGgiICIlVTIlWDIgJTEs
JTIJIyBwdXRfdXNlclxuIiAiMjpcbiIgIi5zZWN0aW9uIC5maXh1cCxcImF4XCJcbiIgIjM6
CWxpICUwLCUzXG4iICIJYiAyYlxuIiAiLnByZXZpb3VzXG4iICIuc2VjdGlvbiBfX2V4X3Rh
YmxlLFwiYVwiOyIgIiAiICIuYmFsaWduIDQ7IiAiICIgIi5sb25nICgxYikgLSAuIDsiICIg
IiAiLmxvbmcgKDNiKSAtIC4gOyIgIiAiICIucHJldmlvdXMiICIgIiA6ICI9ciIgKF9fcHVf
ZXJyKSA6ICJyIiAoX19wdV92YWwpLCAibTw+IiAoKl9fcHVfYWRkciksICJpIiAoLTE0KSwg
IjAiIChfX3B1X2VycikpOyBicmVhazsgY2FzZSA0OiBfX2FzbV9fIF9fdm9sYXRpbGVfXygg
IjE6CSIgInN0dyIgIiVVMiVYMiAlMSwlMgkjIHB1dF91c2VyXG4iICIyOlxuIiAiLnNlY3Rp
b24gLmZpeHVwLFwiYXhcIlxuIiAiMzoJbGkgJTAsJTNcbiIgIgliIDJiXG4iICIucHJldmlv
dXNcbiIgIi5zZWN0aW9uIF9fZXhfdGFibGUsXCJhXCI7IiAiICIgIi5iYWxpZ24gNDsiICIg
IiAiLmxvbmcgKDFiKSAtIC4gOyIgIiAiICIubG9uZyAoM2IpIC0gLiA7IiAiICIgIi5wcmV2
aW91cyIgIiAiIDogIj1yIiAoX19wdV9lcnIpIDogInIiIChfX3B1X3ZhbCksICJtPD4iICgq
X19wdV9hZGRyKSwgImkiICgtMTQpLCAiMCIgKF9fcHVfZXJyKSk7IGJyZWFrOyBjYXNlIDg6
IF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJIiAic3RkIiAiJVUyJVgyICUxLCUyCSMgcHV0
X3VzZXJcbiIgIjI6XG4iICIuc2VjdGlvbiAuZml4dXAsXCJheFwiXG4iICIzOglsaSAlMCwl
M1xuIiAiCWIgMmJcbiIgIi5wcmV2aW91c1xuIiAiLnNlY3Rpb24gX19leF90YWJsZSxcImFc
IjsiICIgIiAiLmJhbGlnbiA0OyIgIiAiICIubG9uZyAoMWIpIC0gLiA7IiAiICIgIi5sb25n
ICgzYikgLSAuIDsiICIgIiAiLnByZXZpb3VzIiAiICIgOiAiPXIiIChfX3B1X2VycikgOiAi
ciIgKF9fcHVfdmFsKSwgIm08PiIgKCpfX3B1X2FkZHIpLCAiaSIgKC0xNCksICIwIiAoX19w
dV9lcnIpKTsgYnJlYWs7IGRlZmF1bHQ6IF9fcHV0X3VzZXJfYmFkKCk7IH0gfSB3aGlsZSAo
MCk7IHByZXZlbnRfd3JpdGVfdG9fdXNlcihfX3B1X2FkZHIsIF9fcHVfc2l6ZSk7IH0gd2hp
bGUgKDApOyBfX3B1X2VycjsgfSkKICAgICB8fCAoeyBsb25nIF9fcHVfZXJyOyBfX3R5cGVv
Zl9fKCooKCZzYy0+c2lnbmFsKSkpICpfX3B1X2FkZHIgPSAoKCZzYy0+c2lnbmFsKSk7IF9f
dHlwZW9mX18oKigoJnNjLT5zaWduYWwpKSkgX19wdV92YWwgPSAoKF9fdHlwZW9mX18oKigm
c2MtPnNpZ25hbCkpKShrc2lnLT5zaWcpKTsgX190eXBlb2ZfXyhzaXplb2YoKigmc2MtPnNp
Z25hbCkpKSBfX3B1X3NpemUgPSAoc2l6ZW9mKCooJnNjLT5zaWduYWwpKSk7IGlmICghKCgo
dW5zaWduZWQgbG9uZylfX3B1X2FkZHIpID49IDB4ODAwMDAwMDAwMDAwMDAwMHVsKSkgbWln
aHRfZmF1bHQoKTsgKHZvaWQpMDsgZG8geyBhbGxvd193cml0ZV90b191c2VyKF9fcHVfYWRk
ciwgX19wdV9zaXplKTsgZG8geyBfX3B1X2VyciA9IDA7IHN3aXRjaCAoX19wdV9zaXplKSB7
IGNhc2UgMTogX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgkiICJzdGIiICIlVTIlWDIgJTEs
JTIJIyBwdXRfdXNlclxuIiAiMjpcbiIgIi5zZWN0aW9uIC5maXh1cCxcImF4XCJcbiIgIjM6
CWxpICUwLCUzXG4iICIJYiAyYlxuIiAiLnByZXZpb3VzXG4iICIuc2VjdGlvbiBfX2V4X3Rh
YmxlLFwiYVwiOyIgIiAiICIuYmFsaWduIDQ7IiAiICIgIi5sb25nICgxYikgLSAuIDsiICIg
IiAiLmxvbmcgKDNiKSAtIC4gOyIgIiAiICIucHJldmlvdXMiICIgIiA6ICI9ciIgKF9fcHVf
ZXJyKSA6ICJyIiAoX19wdV92YWwpLCAibTw+IiAoKl9fcHVfYWRkciksICJpIiAoLTE0KSwg
IjAiIChfX3B1X2VycikpOyBicmVhazsgY2FzZSAyOiBfX2FzbV9fIF9fdm9sYXRpbGVfXygg
IjE6CSIgInN0aCIgIiVVMiVYMiAlMSwlMgkjIHB1dF91c2VyXG4iICIyOlxuIiAiLnNlY3Rp
b24gLmZpeHVwLFwiYXhcIlxuIiAiMzoJbGkgJTAsJTNcbiIgIgliIDJiXG4iICIucHJldmlv
dXNcbiIgIi5zZWN0aW9uIF9fZXhfdGFibGUsXCJhXCI7IiAiICIgIi5iYWxpZ24gNDsiICIg
IiAiLmxvbmcgKDFiKSAtIC4gOyIgIiAiICIubG9uZyAoM2IpIC0gLiA7IiAiICIgIi5wcmV2
aW91cyIgIiAiIDogIj1yIiAoX19wdV9lcnIpIDogInIiIChfX3B1X3ZhbCksICJtPD4iICgq
X19wdV9hZGRyKSwgImkiICgtMTQpLCAiMCIgKF9fcHVfZXJyKSk7IGJyZWFrOyBjYXNlIDQ6
IF9fYXNtX18gX192b2xhdGlsZV9fKCAiMToJIiAic3R3IiAiJVUyJVgyICUxLCUyCSMgcHV0
X3VzZXJcbiIgIjI6XG4iICIuc2VjdGlvbiAuZml4dXAsXCJheFwiXG4iICIzOglsaSAlMCwl
M1xuIiAiCWIgMmJcbiIgIi5wcmV2aW91c1xuIiAiLnNlY3Rpb24gX19leF90YWJsZSxcImFc
IjsiICIgIiAiLmJhbGlnbiA0OyIgIiAiICIubG9uZyAoMWIpIC0gLiA7IiAiICIgIi5sb25n
ICgzYikgLSAuIDsiICIgIiAiLnByZXZpb3VzIiAiICIgOiAiPXIiIChfX3B1X2VycikgOiAi
ciIgKF9fcHVfdmFsKSwgIm08PiIgKCpfX3B1X2FkZHIpLCAiaSIgKC0xNCksICIwIiAoX19w
dV9lcnIpKTsgYnJlYWs7IGNhc2UgODogX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgkiICJz
dGQiICIlVTIlWDIgJTEsJTIJIyBwdXRfdXNlclxuIiAiMjpcbiIgIi5zZWN0aW9uIC5maXh1
cCxcImF4XCJcbiIgIjM6CWxpICUwLCUzXG4iICIJYiAyYlxuIiAiLnByZXZpb3VzXG4iICIu
c2VjdGlvbiBfX2V4X3RhYmxlLFwiYVwiOyIgIiAiICIuYmFsaWduIDQ7IiAiICIgIi5sb25n
ICgxYikgLSAuIDsiICIgIiAiLmxvbmcgKDNiKSAtIC4gOyIgIiAiICIucHJldmlvdXMiICIg
IiA6ICI9ciIgKF9fcHVfZXJyKSA6ICJyIiAoX19wdV92YWwpLCAibTw+IiAoKl9fcHVfYWRk
ciksICJpIiAoLTE0KSwgIjAiIChfX3B1X2VycikpOyBicmVhazsgZGVmYXVsdDogX19wdXRf
dXNlcl9iYWQoKTsgfSB9IHdoaWxlICgwKTsgcHJldmVudF93cml0ZV90b191c2VyKF9fcHVf
YWRkciwgX19wdV9zaXplKTsgfSB3aGlsZSAoMCk7IF9fcHVfZXJyOyB9KSkKICBnb3RvIGJh
ZGZyYW1lOwoKIGlmICh2ZHNvMzJfc2lndHJhbXAgJiYgdHNrLT5tbS0+Y29udGV4dC52ZHNv
X2Jhc2UpIHsKICBzaWdyZXQgPSAwOwogIG1jX3BhZCA9IHRzay0+bW0tPmNvbnRleHQudmRz
b19iYXNlICsgdmRzbzMyX3NpZ3RyYW1wOwogfSBlbHNlIHsKICBzaWdyZXQgPSAxMTk7CiAg
bWNfcGFkID0gKHVuc2lnbmVkIGxvbmcpIGZyYW1lLT5tY3R4Lm1jX3BhZDsKIH0KIyAxMjcx
ICJhcmNoL3Bvd2VycGMva2VybmVsL3NpZ25hbF8zMi5jIgogewogIGlmIChzYXZlX3VzZXJf
cmVncyhyZWdzLCAmZnJhbWUtPm1jdHgsIHRtX21jdHgsIHNpZ3JldCwgMSkpCiAgIGdvdG8g
YmFkZnJhbWU7CiB9CgogcmVncy0+bGluayA9IG1jX3BhZDsKCiB0c2stPnRocmVhZC5mcF9z
dGF0ZS5mcHNjciA9IDA7CgoKIG5ld3NwID0gKCh1bnNpZ25lZCBsb25nKWZyYW1lKSAtIDY0
OwogaWYgKCh7IGxvbmcgX19wdV9lcnIgPSAtMTQ7IF9fdHlwZW9mX18oKigoKHUzMiAqKW5l
d3NwKSkpICpfX3B1X2FkZHIgPSAoKCh1MzIgKiluZXdzcCkpOyBfX3R5cGVvZl9fKCooKCh1
MzIgKiluZXdzcCkpKSBfX3B1X3ZhbCA9ICgoX190eXBlb2ZfXygqKCh1MzIgKiluZXdzcCkp
KShyZWdzLT5ncHJbMV0pKTsgX190eXBlb2ZfXyhzaXplb2YoKigodTMyICopbmV3c3ApKSkg
X19wdV9zaXplID0gKHNpemVvZigqKCh1MzIgKiluZXdzcCkpKTsgbWlnaHRfZmF1bHQoKTsg
aWYgKCgodm9pZCkwLCAoKCgoIHVuc2lnbmVkIGxvbmcpKF9fcHVfYWRkcikpIDw9ICgoZ2V0
X2N1cnJlbnQoKS0+dGhyZWFkLmFkZHJfbGltaXQpKS5zZWcpICYmICgoKF9fcHVfc2l6ZSkp
IDw9ICgoZ2V0X2N1cnJlbnQoKS0+dGhyZWFkLmFkZHJfbGltaXQpKS5zZWcpKSkpIGRvIHsg
YWxsb3dfd3JpdGVfdG9fdXNlcihfX3B1X2FkZHIsIF9fcHVfc2l6ZSk7IGRvIHsgX19wdV9l
cnIgPSAwOyBzd2l0Y2ggKF9fcHVfc2l6ZSkgeyBjYXNlIDE6IF9fYXNtX18gX192b2xhdGls
ZV9fKCAiMToJIiAic3RiIiAiJVUyJVgyICUxLCUyCSMgcHV0X3VzZXJcbiIgIjI6XG4iICIu
c2VjdGlvbiAuZml4dXAsXCJheFwiXG4iICIzOglsaSAlMCwlM1xuIiAiCWIgMmJcbiIgIi5w
cmV2aW91c1xuIiAiLnNlY3Rpb24gX19leF90YWJsZSxcImFcIjsiICIgIiAiLmJhbGlnbiA0
OyIgIiAiICIubG9uZyAoMWIpIC0gLiA7IiAiICIgIi5sb25nICgzYikgLSAuIDsiICIgIiAi
LnByZXZpb3VzIiAiICIgOiAiPXIiIChfX3B1X2VycikgOiAiciIgKF9fcHVfdmFsKSwgIm08
PiIgKCpfX3B1X2FkZHIpLCAiaSIgKC0xNCksICIwIiAoX19wdV9lcnIpKTsgYnJlYWs7IGNh
c2UgMjogX19hc21fXyBfX3ZvbGF0aWxlX18oICIxOgkiICJzdGgiICIlVTIlWDIgJTEsJTIJ
IyBwdXRfdXNlclxuIiAiMjpcbiIgIi5zZWN0aW9uIC5maXh1cCxcImF4XCJcbiIgIjM6CWxp
ICUwLCUzXG4iICIJYiAyYlxuIiAiLnByZXZpb3VzXG4iICIuc2VjdGlvbiBfX2V4X3RhYmxl
LFwiYVwiOyIgIiAiICIuYmFsaWduIDQ7IiAiICIgIi5sb25nICgxYikgLSAuIDsiICIgIiAi
LmxvbmcgKDNiKSAtIC4gOyIgIiAiICIucHJldmlvdXMiICIgIiA6ICI9ciIgKF9fcHVfZXJy
KSA6ICJyIiAoX19wdV92YWwpLCAibTw+IiAoKl9fcHVfYWRkciksICJpIiAoLTE0KSwgIjAi
IChfX3B1X2VycikpOyBicmVhazsgY2FzZSA0OiBfX2FzbV9fIF9fdm9sYXRpbGVfXyggIjE6
CSIgInN0dyIgIiVVMiVYMiAlMSwlMgkjIHB1dF91c2VyXG4iICIyOlxuIiAiLnNlY3Rpb24g
LmZpeHVwLFwiYXhcIlxuIiAiMzoJbGkgJTAsJTNcbiIgIgliIDJiXG4iICIucHJldmlvdXNc
biIgIi5zZWN0aW9uIF9fZXhfdGFibGUsXCJhXCI7IiAiICIgIi5iYWxpZ24gNDsiICIgIiAi
LmxvbmcgKDFiKSAtIC4gOyIgIiAiICIubG9uZyAoM2IpIC0gLiA7IiAiICIgIi5wcmV2aW91
cyIgIiAiIDogIj1yIiAoX19wdV9lcnIpIDogInIiIChfX3B1X3ZhbCksICJtPD4iICgqX19w
dV9hZGRyKSwgImkiICgtMTQpLCAiMCIgKF9fcHVfZXJyKSk7IGJyZWFrOyBjYXNlIDg6IF9f
YXNtX18gX192b2xhdGlsZV9fKCAiMToJIiAic3RkIiAiJVUyJVgyICUxLCUyCSMgcHV0X3Vz
ZXJcbiIgIjI6XG4iICIuc2VjdGlvbiAuZml4dXAsXCJheFwiXG4iICIzOglsaSAlMCwlM1xu
IiAiCWIgMmJcbiIgIi5wcmV2aW91c1xuIiAiLnNlY3Rpb24gX19leF90YWJsZSxcImFcIjsi
ICIgIiAiLmJhbGlnbiA0OyIgIiAiICIubG9uZyAoMWIpIC0gLiA7IiAiICIgIi5sb25nICgz
YikgLSAuIDsiICIgIiAiLnByZXZpb3VzIiAiICIgOiAiPXIiIChfX3B1X2VycikgOiAiciIg
KF9fcHVfdmFsKSwgIm08PiIgKCpfX3B1X2FkZHIpLCAiaSIgKC0xNCksICIwIiAoX19wdV9l
cnIpKTsgYnJlYWs7IGRlZmF1bHQ6IF9fcHV0X3VzZXJfYmFkKCk7IH0gfSB3aGlsZSAoMCk7
IHByZXZlbnRfd3JpdGVfdG9fdXNlcihfX3B1X2FkZHIsIF9fcHVfc2l6ZSk7IH0gd2hpbGUg
KDApOyBfX3B1X2VycjsgfSkpCiAgZ290byBiYWRmcmFtZTsKCiByZWdzLT5ncHJbMV0gPSBu
ZXdzcDsKIHJlZ3MtPmdwclszXSA9IGtzaWctPnNpZzsKIHJlZ3MtPmdwcls0XSA9ICh1bnNp
Z25lZCBsb25nKSBzYzsKIHJlZ3MtPm5pcCA9ICh1bnNpZ25lZCBsb25nKSAodW5zaWduZWQg
bG9uZylrc2lnLT5rYS5zYS5zYV9oYW5kbGVyOwoKIHJlZ3MtPm1zciAmPSB+KDFVTDw8KDAp
KTsKIHJldHVybiAwOwoKYmFkZnJhbWU6CiBpZiAoc2hvd191bmhhbmRsZWRfc2lnbmFscykK
ICAoeyBzdGF0aWMgc3RydWN0IHJhdGVsaW1pdF9zdGF0ZSBfcnMgPSB7IC5sb2NrID0gKHJh
d19zcGlubG9ja190KSB7IC5yYXdfbG9jayA9IHsgMCB9LCB9LCAuaW50ZXJ2YWwgPSAoNSAq
IDI1MCksIC5idXJzdCA9IDEwLCB9OyBpZiAoX19fcmF0ZWxpbWl0KCZfcnMsIF9fZnVuY19f
KSkgcHJpbnRrKCJcMDAxIiAiNiIgIiVzWyVkXTogYmFkIGZyYW1lIGluIGhhbmRsZV9zaWdu
YWwzMjogIiAiJXAgbmlwICUwOGx4IGxyICUwOGx4XG4iLCB0c2stPmNvbW0sIHRzay0+cGlk
LCBmcmFtZSwgcmVncy0+bmlwLCByZWdzLT5saW5rKTsgfSkKCgoKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgOwoKIHJldHVybiAxOwp9CgoKCgoKIGxvbmcgY29tcGF0
X3N5c19zaWdyZXR1cm4odm9pZCk7IDsgbG9uZyBjb21wYXRfc3lzX3NpZ3JldHVybih2b2lk
KQoKCgp7CiBzdHJ1Y3QgcHRfcmVncyAqcmVncyA9ICgoc3RydWN0IHB0X3JlZ3MgKikoKHVu
c2lnbmVkIGxvbmcpdGFza19zdGFja19wYWdlKGdldF9jdXJyZW50KCkpICsgKDEgPDwgMTQp
KSAtIDEpOwogc3RydWN0IHNpZ2ZyYW1lICpzZjsKIHN0cnVjdCBzaWdjb250ZXh0MzIgKnNj
Owogc3RydWN0IHNpZ2NvbnRleHQzMiBzaWdjdHg7CiBzdHJ1Y3QgbWNvbnRleHQzMiAqc3I7
CiB2b2lkICphZGRyOwogc2lnc2V0X3Qgc2V0OwoKCgoKCgogZ2V0X2N1cnJlbnQoKS0+cmVz
dGFydF9ibG9jay5mbiA9IGRvX25vX3Jlc3RhcnRfc3lzY2FsbDsKCiBzZiA9IChzdHJ1Y3Qg
c2lnZnJhbWUgKikocmVncy0+Z3ByWzFdICsgNjQpOwogc2MgPSAmc2YtPnNjdHg7CiBhZGRy
ID0gc2M7CiBpZiAoY29weV9mcm9tX3VzZXIoJnNpZ2N0eCwgc2MsIHNpemVvZihzaWdjdHgp
KSkKICBnb3RvIGJhZGZyYW1lOwoKCgoKCgogc2V0LnNpZ1swXSA9IHNpZ2N0eC5vbGRtYXNr
ICsgKChsb25nKShzaWdjdHguX3VudXNlZFszXSkgPDwgMzIpOwoKCgoKIHNldF9jdXJyZW50
X2Jsb2NrZWQoJnNldCk7CiMgMTM1OCAiYXJjaC9wb3dlcnBjL2tlcm5lbC9zaWduYWxfMzIu
YyIKIHsKICBzciA9IChzdHJ1Y3QgbWNvbnRleHQzMiAqKWNvbXBhdF9wdHIoc2lnY3R4LnJl
Z3MpOwogIGFkZHIgPSBzcjsKICBpZiAoISgodm9pZCkwLCAoKCgoIHVuc2lnbmVkIGxvbmcp
KHNyKSkgPD0gKChnZXRfY3VycmVudCgpLT50aHJlYWQuYWRkcl9saW1pdCkpLnNlZykgJiYg
KCgoc2l6ZW9mKCpzcikpKSA8PSAoKGdldF9jdXJyZW50KCktPnRocmVhZC5hZGRyX2xpbWl0
KSkuc2VnKSkpCiAgICAgIHx8IHJlc3RvcmVfdXNlcl9yZWdzKHJlZ3MsIHNyLCAxKSkKICAg
Z290byBiYWRmcmFtZTsKIH0KCiBzZXRfdGlfdGhyZWFkX2ZsYWcoKChzdHJ1Y3QgdGhyZWFk
X2luZm8gKilnZXRfY3VycmVudCgpKSwgMTEpOwogcmV0dXJuIDA7CgpiYWRmcmFtZToKIGlm
IChzaG93X3VuaGFuZGxlZF9zaWduYWxzKQogICh7IHN0YXRpYyBzdHJ1Y3QgcmF0ZWxpbWl0
X3N0YXRlIF9ycyA9IHsgLmxvY2sgPSAocmF3X3NwaW5sb2NrX3QpIHsgLnJhd19sb2NrID0g
eyAwIH0sIH0sIC5pbnRlcnZhbCA9ICg1ICogMjUwKSwgLmJ1cnN0ID0gMTAsIH07IGlmIChf
X19yYXRlbGltaXQoJl9ycywgX19mdW5jX18pKSBwcmludGsoIlwwMDEiICI2IiAiJXNbJWRd
OiBiYWQgZnJhbWUgaW4gc3lzX3NpZ3JldHVybjogIiAiJXAgbmlwICUwOGx4IGxyICUwOGx4
XG4iLCBnZXRfY3VycmVudCgpLT5jb21tLCBnZXRfY3VycmVudCgpLT5waWQsIGFkZHIsIHJl
Z3MtPm5pcCwgcmVncy0+bGluayk7IH0pCgoKCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgOwoKIGZvcmNlX3NpZygxMSk7CiByZXR1cm4gMDsKfQo=
--------------8566AE628493B5C35158C76F--
