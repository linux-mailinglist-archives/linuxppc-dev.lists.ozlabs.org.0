Return-Path: <linuxppc-dev-bounces+lists+linuxppc-dev=lfdr.de@lists.ozlabs.org>
X-Original-To: lists+linuxppc-dev@lfdr.de
Delivered-To: lists+linuxppc-dev@lfdr.de
Received: from lists.ozlabs.org (lists.ozlabs.org [IPv6:2404:9400:2:0:216:3eff:fee1:b9f1])
	by mail.lfdr.de (Postfix) with ESMTPS id A22A573AFBC
	for <lists+linuxppc-dev@lfdr.de>; Fri, 23 Jun 2023 07:15:13 +0200 (CEST)
Authentication-Results: lists.ozlabs.org;
	dkim=pass (2048-bit key; unprotected) header.d=csgroup.eu header.i=@csgroup.eu header.a=rsa-sha256 header.s=selector2 header.b=gUzJtMJj;
	dkim-atps=neutral
Received: from boromir.ozlabs.org (localhost [IPv6:::1])
	by lists.ozlabs.org (Postfix) with ESMTP id 4QnQRM3sdpz3bkD
	for <lists+linuxppc-dev@lfdr.de>; Fri, 23 Jun 2023 15:15:11 +1000 (AEST)
X-Original-To: linuxppc-dev@lists.ozlabs.org
Delivered-To: linuxppc-dev@lists.ozlabs.org
Authentication-Results: lists.ozlabs.org;
	dkim=pass (2048-bit key; unprotected) header.d=csgroup.eu header.i=@csgroup.eu header.a=rsa-sha256 header.s=selector2 header.b=gUzJtMJj;
	dkim-atps=neutral
Authentication-Results: lists.ozlabs.org; spf=pass (sender SPF authorized) smtp.mailfrom=csgroup.eu (client-ip=2a01:111:f400:7e18::630; helo=fra01-pr2-obe.outbound.protection.outlook.com; envelope-from=christophe.leroy@csgroup.eu; receiver=lists.ozlabs.org)
Received: from FRA01-PR2-obe.outbound.protection.outlook.com (mail-pr2fra01on20630.outbound.protection.outlook.com [IPv6:2a01:111:f400:7e18::630])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by lists.ozlabs.org (Postfix) with ESMTPS id 4QnQQM1xslz2yHT
	for <linuxppc-dev@lists.ozlabs.org>; Fri, 23 Jun 2023 15:14:18 +1000 (AEST)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=FUKGoTEC8b0TU8Lr1Hi+Bdd9EBnWS3hT3DBUwFBgeQq5PpCEulOct/zePpm3BFeV1g6yLpXDeiQsCfdPrAe23lsZFrYSHjSCH6ZFDyQn8VPIlqBwZeWIwL4D5hqV+uZoZBZsu4+ELhaqELl5xrcy+4+uxd8WzDo9ZR4AZx3yxCB/JPe4DRKtQUGoHFO09RtHwXYAI8SxEGNAhkCNrorStdZOmKvwxr5CloXJf4/eBdTNcOxeZNsyIuU5E+F7gQNTGllCkKE09X18JRqokloFjlOO4aFUxOMyZ/S/Y4Hl+R1Y4i9FzIOMGjnhrD9qRsQgIXpDH4ZpTI0tj3/hWm4PQw==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com;
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-AntiSpam-MessageData-ChunkCount:X-MS-Exchange-AntiSpam-MessageData-0:X-MS-Exchange-AntiSpam-MessageData-1;
 bh=czNIYi4ptpkXEwnunzmYsenoTC6xDfWJuEfW868e4sQ=;
 b=OvfE6s1vuHo9iUjyEo9VsKk0ll2542VIPe+Vec5ENq1FwikYszKMVLDUpNGJ8Ns/rMF8WiJ+x/J8rztvQQRWfAoc+GZS41hoI+yHuedOtELji6oezn0Cz28qGDqFySSu8ORlsdZ2V11JxSgdYi8yKkvStjADG0LvZggW5mOWriCDQjAgbcMxUTmZK/dK2ZyA23PLjjDKN+8TuYqH03oM9Jrd9SUEuidyeoBNdp09mar98b6vU22uEi0xANSX+vBVrx5oGCv3P5wSg+DFWk396dTFEYKWgNCYTOi7XLyYKCuhkeuUD94SUveIiC9dh36fW7lnAoXZXRrcF6Zzy0THag==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=csgroup.eu; dmarc=pass action=none header.from=csgroup.eu;
 dkim=pass header.d=csgroup.eu; arc=none
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=csgroup.eu;
 s=selector2;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=czNIYi4ptpkXEwnunzmYsenoTC6xDfWJuEfW868e4sQ=;
 b=gUzJtMJjYnT/9Ur3NcdrCaNcmTtRDocBbRETJFG7PMg6H2seXHVCyAfvDiB3+MtUEjUokKsWNDVLwKwhGgYp4Z9b8OCqZhRCwlBZYua987y+PkKk8sJ0QaEeO7jkuox8cN3/OAKt46mzYCtRvslF5mr1U65YKnX+ioRA+C8jLCOKqoy/3AjS354S9vTG9FRITdII4RH/okOs4ODvcxijprrg6KlUUDnqbhSqaqOa6ksN2w5OzTdAooi1JjIhplwuZARO2i/8VHikkr8OwnaUN8fjKx+YeKxVS0jj6NwpT3P29QNNY6+S8ken0AsOF1MHuYLKIsQVljeB0QtwgIXmNw==
Received: from MRZP264MB2988.FRAP264.PROD.OUTLOOK.COM (2603:10a6:501:31::15)
 by MR1P264MB1809.FRAP264.PROD.OUTLOOK.COM (2603:10a6:501:10::22) with
 Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.6521.26; Fri, 23 Jun
 2023 05:13:59 +0000
Received: from MRZP264MB2988.FRAP264.PROD.OUTLOOK.COM
 ([fe80::802b:33:561c:4217]) by MRZP264MB2988.FRAP264.PROD.OUTLOOK.COM
 ([fe80::802b:33:561c:4217%4]) with mapi id 15.20.6521.026; Fri, 23 Jun 2023
 05:13:59 +0000
From: Christophe Leroy <christophe.leroy@csgroup.eu>
To: Naveen N Rao <naveen@kernel.org>, "linuxppc-dev@lists.ozlabs.org"
	<linuxppc-dev@lists.ozlabs.org>
Subject: Re: [PATCH 03/17] powerpc64/ftrace: Move ELFv1 and -pg support code
 into a separate file
Thread-Topic: [PATCH 03/17] powerpc64/ftrace: Move ELFv1 and -pg support code
 into a separate file
Thread-Index: AQHZopQG2RdRV2HIxUiznmgoryxCqa+X3d8A
Date: Fri, 23 Jun 2023 05:13:59 +0000
Message-ID: <6641cb07-270e-a9e6-f724-5c0a53be9ac4@csgroup.eu>
References: <cover.1687166935.git.naveen@kernel.org>
 <1eb6cc6c3141ddb77a2a25f8a9e83d83ff312b02.1687166935.git.naveen@kernel.org>
In-Reply-To:  <1eb6cc6c3141ddb77a2a25f8a9e83d83ff312b02.1687166935.git.naveen@kernel.org>
Accept-Language: fr-FR, en-US
Content-Language: fr-FR
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
user-agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101
 Thunderbird/102.11.0
authentication-results: dkim=none (message not signed)
 header.d=none;dmarc=none action=none header.from=csgroup.eu;
x-ms-publictraffictype: Email
x-ms-traffictypediagnostic: MRZP264MB2988:EE_|MR1P264MB1809:EE_
x-ms-office365-filtering-correlation-id: e41cf188-bf2a-4fc6-ce42-08db73a8a6da
x-ms-exchange-senderadcheck: 1
x-ms-exchange-antispam-relay: 0
x-microsoft-antispam: BCL:0;
x-microsoft-antispam-message-info:  /1RymsvsIAuyWlq6tUWGDjJxSVTEw+xCWIr9qJFNGFhAx9nv4aGUC1nqptEf39qnSRmPStgebWy2/pKJLhG8Qr7sZXicqeYvkGALLL2ZTUuwCOtFGq7akfsZxPRTN2U63e7c0M2zCSnhiX4T0us19ocx0qAosEBaeBwzaVIIIHyJscxn9yCYPq2gVVWLT4Pn12mE1ayVXmwXhMa5z44sqOc5GXMjDs7nmQlwIOCDOTyjctpfX1Epe9zDqI//e7UHXe25RkkorEC3ZHhdnwbrU6BbetR1kfDJsoJt7/cGDZ08Rg+X4nfUH3HZ1fn+oMu36mTVGCNU4tY26wbx+Tq5gQp9bDV9bHX3o5kj/Sc9cUqbsPXiKWgckY9hDRLlILA7lK8pvfINwiI7pszrjCVdwqpw78xzkcd8GsABCyDcp5uNEn3Mv2A4CyIoKJxOvj/hgreNfLlCK/06d/GNUIm7eIP6ZwmnF6ErNkRKYbdmgY33kgsrOWLEpzTTsvQSovIPFRYAKabHgijref8MYIx0qs+hdaEA8HGmVSvTzBgUhfTGnZMsRQg2KU8st11iFIQlLWhPtoN/UCM/otxuJv0uvh5oGoElQxUod+R/gBRokPj8a+qhc41dHoHgxPWVWOTMtYrWVvI/HVsQGM19l6vWJ28KnUlzkHFDKfruvsesEhLAwFJtJajd7Gh2vTJMaHFJ
x-forefront-antispam-report:  CIP:255.255.255.255;CTRY:;LANG:en;SCL:1;SRV:;IPV:NLI;SFV:NSPM;H:MRZP264MB2988.FRAP264.PROD.OUTLOOK.COM;PTR:;CAT:NONE;SFS:(13230028)(4636009)(39850400004)(346002)(396003)(376002)(136003)(366004)(451199021)(122000001)(38100700002)(38070700005)(86362001)(31696002)(76116006)(91956017)(4326008)(66556008)(316002)(64756008)(66446008)(66946007)(66476007)(2616005)(110136005)(5660300002)(66574015)(8936002)(83380400001)(8676002)(41300700001)(6486002)(31686004)(6512007)(26005)(478600001)(186003)(71200400001)(6506007)(2906002)(30864003)(36756003)(44832011)(45980500001)(43740500002)(559001)(579004);DIR:OUT;SFP:1101;
x-ms-exchange-antispam-messagedata-chunkcount: 1
x-ms-exchange-antispam-messagedata-0:  =?utf-8?B?Vm1zblRUdUFGU0hJWGVZUTBpRFEvQ3VvYVBUNmsyOFpORDAwbVVaeGhaWWV6?=
 =?utf-8?B?UWdNb3RSY2dJTVkwMUtyQVJtYzhRdVdFeE50VWpyOGlmZ3BOSDI3bFZXdC9T?=
 =?utf-8?B?UnlBeUhaL0JkaU5pMC9KbFFpQVFmU083NkxneGV0OEdPd2NZZUlvaHprcEhV?=
 =?utf-8?B?WFc2eWx4OHNwc0ZmMEpRaEVkYWhBYnhuL1NHenljejZwaW9KYmthR0M1TUNw?=
 =?utf-8?B?Tm5vMGx0bU9GMlg4RjJ2ZUZNYUY3cm52WU9vY1dXamYyRUVkbm05TXNvSkZK?=
 =?utf-8?B?akxxN0g4L2h6NUNhMXd4aWlibXhxRHVBcUpFMW5SZVlHL1BpenVuNkc4emVj?=
 =?utf-8?B?bG51djFlVThzdmhUb3RTWFZ1ZG1WMVJ3UGVPNFUybnloa3djMGJrR1V3OUxO?=
 =?utf-8?B?dTd4UTRudkVNMjFqTEgrdnZSR1FnU0RpRk9UcjBnWHd0OHoxQmx2RThoQmts?=
 =?utf-8?B?T2Vsb1dwb29FNWhUVTVrc1VhK1NmL2p4bWc3dG5WVHlTbU5oUkh3Z0F1NHFQ?=
 =?utf-8?B?Vlpiak52Sk1FOXlSbHRlZUNNMG50YnRlc0I4RlJZUjErZnlzZzl2cExGZ3kz?=
 =?utf-8?B?OUE1R0dRdjU3N2NidE9Nc0QyUEVUbWV6dWlPTmptQ3JtNW5wK1dndmRaRk5M?=
 =?utf-8?B?ZjkrQk8rSjVUNE50MXc3cUt6Y0s0SUlYZFNOcDI0czNDdmpzK1VYak9vWm1x?=
 =?utf-8?B?M0tMVTZUWGxoQUd0WnQvMjkvQUFEL2pyaUxxMDFEVDBINGRoMzlHZlJsVU5z?=
 =?utf-8?B?QmllRWM5TXBSTWt2YWpVMDBpRHlwbnc0SlpsOWFBUkl1K2tJUmxMbmczTjJN?=
 =?utf-8?B?WWFFNHdVZDRmV1pFQVh1eVNtNFQ1T3ZJSnNiOXZlZy92UXo2R1dObXhSVFFo?=
 =?utf-8?B?bVpyOWJKaFFjUm9KS1RIN2tiYWFvdFdueEpEeXVtc0ZGMmZhZjJ5dkhXMFdp?=
 =?utf-8?B?RVhtNFkxRE9mOXUxNGliKytmQkx5bkh1UW9BeWR0M25KN0RhaWRkTzZ3OERu?=
 =?utf-8?B?cVdQMkNNT05SdEhqUk5QRjNUd2YwbEdkcmdvajJ4M0Z6RTlqZFVWZkVyaTli?=
 =?utf-8?B?ZldwbkZQaFRpdGNwVkhiUWJTMDd2R1pYTUE0VmtoUkc4L1lZYkJucEp5VklG?=
 =?utf-8?B?OUZicUZybFBkYmtOYnRwS3pQUjNJelpmMFZwaFIrRURPRUgrbzhsYVB2OUNq?=
 =?utf-8?B?UXYvWHE1WnY3YUlXR2FRMGJmdFNwTkV2aVpXNzc4NjRYN25GN3ZyR3VDb3Vl?=
 =?utf-8?B?bEZoUXI4TUpWV0dkN25ZdS9haWdHenRNKzBSQ2FyYkRRTkMyOEFtcERLeldy?=
 =?utf-8?B?ZTlmQk84cmRwK015QVdFaXIyM29OMEE0Mm9nWUMyTGh0Q1lXY0xnOHFqcC8z?=
 =?utf-8?B?V1ZsZTVDY1NTWlNzWU9XYkJSRWlBWVJFc1doOWxIck1iMy9KY253ZlpVY3po?=
 =?utf-8?B?ZGVxYmpiTFVFTE9vS0F6WWdZTW01N21KRHIrVHErcXdOUEpqcllYWGUvK2Fp?=
 =?utf-8?B?T25sTDlRMjlHTGgwSE5ROG1oSU1LL0I3eFFGSm5HSTBzNCtqRUM4bEdSdnNB?=
 =?utf-8?B?eVhUTjI0QVVzamlMS3A3ZldzaERjN0F4dmRXRDgvQjN2dWhKSTlSZSswMlMy?=
 =?utf-8?B?cUw5UE9Ydmt0NkhjWUlER1hhcE1EV0JWYnBQaHR1ZXJPZ0hvaHh2N0M1MzVp?=
 =?utf-8?B?Vm5SKzViK1BsMlRxL2E4QnplaEU3RFBXcXY3WTMvMlJIYytsdFRDWkNGT1Bv?=
 =?utf-8?B?eC9RNk1IUzlPUW8xUkZhdS9CNHRCZlh5aExmZU5vYUc4WGE4a2tnVGVUSWlw?=
 =?utf-8?B?UThBTjdyS0w3SUd5QXR4djBDSDlFbkQ2M0FuUjVnYzlnVGptTnRra3NLUnp1?=
 =?utf-8?B?RlErV0tTS1U4WENOQW9lYjBTbVZ6cVZOL01vZWFnSlFmckhZU2JrcnpOalVG?=
 =?utf-8?B?RVdsQzd5azlCUW5zcnFpRDFESTFJdjdqY0g2YkwxSUVYVDBqVUk5NmR0RDhF?=
 =?utf-8?B?T0FncG1KR2xvVSswcHo4R2k1MEUrWWh6em0rbHlXMlBoZ1hFRUdtRmQ1cjRa?=
 =?utf-8?B?REIzcDc1UHV1bjBRWFgwRVMwbkt6eHAwRFQ4YWxBNEJLNDVkYWxzak1VNUZL?=
 =?utf-8?B?bXlPZU0vbklCcmlXRHFyQ1ZjUjlpd0hoMW5SUk9UMWVzeU9VN3ZtUWkwUGdn?=
 =?utf-8?B?UGc9PQ==?=
Content-Type: text/plain; charset="utf-8"
Content-ID: <A6B8F47E0183334BA639190969EF2E93@FRAP264.PROD.OUTLOOK.COM>
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-OriginatorOrg: csgroup.eu
X-MS-Exchange-CrossTenant-AuthAs: Internal
X-MS-Exchange-CrossTenant-AuthSource: MRZP264MB2988.FRAP264.PROD.OUTLOOK.COM
X-MS-Exchange-CrossTenant-Network-Message-Id: e41cf188-bf2a-4fc6-ce42-08db73a8a6da
X-MS-Exchange-CrossTenant-originalarrivaltime: 23 Jun 2023 05:13:59.3763
 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 9914def7-b676-4fda-8815-5d49fb3b45c8
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: 7es8583hFXfItc9bEfyD5vDmOngjikmfxvnzRSNqO7Xt+Tk1jnnaxjhmhANcV41cow80oxP6tUCKczLTLeCBUeRyAp8du/bla/isnXkCtWo=
X-MS-Exchange-Transport-CrossTenantHeadersStamped: MR1P264MB1809
X-BeenThere: linuxppc-dev@lists.ozlabs.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Linux on PowerPC Developers Mail List <linuxppc-dev.lists.ozlabs.org>
List-Unsubscribe: <https://lists.ozlabs.org/options/linuxppc-dev>,
 <mailto:linuxppc-dev-request@lists.ozlabs.org?subject=unsubscribe>
List-Archive: <http://lists.ozlabs.org/pipermail/linuxppc-dev/>
List-Post: <mailto:linuxppc-dev@lists.ozlabs.org>
List-Help: <mailto:linuxppc-dev-request@lists.ozlabs.org?subject=help>
List-Subscribe: <https://lists.ozlabs.org/listinfo/linuxppc-dev>,
 <mailto:linuxppc-dev-request@lists.ozlabs.org?subject=subscribe>
Cc: Steven Rostedt <rostedt@goodmis.org>
Errors-To: linuxppc-dev-bounces+lists+linuxppc-dev=lfdr.de@lists.ozlabs.org
Sender: "Linuxppc-dev" <linuxppc-dev-bounces+lists+linuxppc-dev=lfdr.de@lists.ozlabs.org>

DQoNCkxlIDE5LzA2LzIwMjMgw6AgMTE6NDcsIE5hdmVlbiBOIFJhbyBhIMOpY3JpdMKgOg0KPiBF
TEZ2MSBzdXBwb3J0IGlzIGRlcHJlY2F0ZWQgYW5kIG9uIHRoZSB3YXkgb3V0LiBQcmUgLW1wcm9m
aWxlLWtlcm5lbA0KPiBmdHJhY2Ugc3VwcG9ydCAoLXBnIG9ubHkpIGlzIHZlcnkgbGltaXRlZCBh
bmQgaXMgcmV0YWluZWQgcHJpbWFyaWx5IGZvcg0KPiBjbGFuZyBidWlsZHMuIEl0IHdvbid0IGJl
IG5lY2Vzc2FyeSBvbmNlIGNsYW5nIGxhbmRzIHN1cHBvcnQgZm9yDQo+IC1mcGF0Y2hhYmxlLWZ1
bmN0aW9uLWVudHJ5Lg0KPiANCj4gQ29weSB0aGUgZXhpc3RpbmcgZnRyYWNlIGNvZGUgc3VwcG9y
dGluZyB0aGVzZSBpbnRvIGZ0cmFjZV9wZy5jLg0KPiBmdHJhY2UuYyBjYW4gdGhlbiBiZSByZWZh
Y3RvcmVkIGFuZCBlbmhhbmNlZCB3aXRoIGEgZm9jdXMgb24gcHBjMzIgYW5kDQo+IHBwYzY0IEVM
RnYyLg0KPiANCj4gU2lnbmVkLW9mZi1ieTogTmF2ZWVuIE4gUmFvIDxuYXZlZW5Aa2VybmVsLm9y
Zz4NCg0KUmV2aWV3ZWQtYnk6IENocmlzdG9waGUgTGVyb3kgPGNocmlzdG9waGUubGVyb3lAY3Nn
cm91cC5ldT4NCg0KPiAtLS0NCj4gICBhcmNoL3Bvd2VycGMva2VybmVsL3RyYWNlL01ha2VmaWxl
ICAgIHwgIDEzICstDQo+ICAgYXJjaC9wb3dlcnBjL2tlcm5lbC90cmFjZS9mdHJhY2UuYyAgICB8
ICAxMCAtDQo+ICAgYXJjaC9wb3dlcnBjL2tlcm5lbC90cmFjZS9mdHJhY2VfcGcuYyB8IDg0NiAr
KysrKysrKysrKysrKysrKysrKysrKysrKw0KPiAgIDMgZmlsZXMgY2hhbmdlZCwgODU1IGluc2Vy
dGlvbnMoKyksIDE0IGRlbGV0aW9ucygtKQ0KPiAgIGNyZWF0ZSBtb2RlIDEwMDY0NCBhcmNoL3Bv
d2VycGMva2VybmVsL3RyYWNlL2Z0cmFjZV9wZy5jDQo+IA0KPiBkaWZmIC0tZ2l0IGEvYXJjaC9w
b3dlcnBjL2tlcm5lbC90cmFjZS9NYWtlZmlsZSBiL2FyY2gvcG93ZXJwYy9rZXJuZWwvdHJhY2Uv
TWFrZWZpbGUNCj4gaW5kZXggYjE2YTlmOWMwYjM1ZjIuLjM0MmEyZDFhZTg2Y2QwIDEwMDY0NA0K
PiAtLS0gYS9hcmNoL3Bvd2VycGMva2VybmVsL3RyYWNlL01ha2VmaWxlDQo+ICsrKyBiL2FyY2gv
cG93ZXJwYy9rZXJuZWwvdHJhY2UvTWFrZWZpbGUNCj4gQEAgLTYsMTUgKzYsMTYgQEANCj4gICBp
ZmRlZiBDT05GSUdfRlVOQ1RJT05fVFJBQ0VSDQo+ICAgIyBkbyBub3QgdHJhY2UgdHJhY2VyIGNv
ZGUNCj4gICBDRkxBR1NfUkVNT1ZFX2Z0cmFjZS5vID0gJChDQ19GTEFHU19GVFJBQ0UpDQo+ICtD
RkxBR1NfUkVNT1ZFX2Z0cmFjZV9wZy5vID0gJChDQ19GTEFHU19GVFJBQ0UpDQo+ICAgZW5kaWYN
Cj4gICANCj4gLW9iajMyLSQoQ09ORklHX0ZVTkNUSU9OX1RSQUNFUikJCSs9IGZ0cmFjZV9tcHJv
ZmlsZS5vDQo+ICtvYmozMi0kKENPTkZJR19GVU5DVElPTl9UUkFDRVIpCQkrPSBmdHJhY2VfbXBy
b2ZpbGUubyBmdHJhY2Uubw0KPiAgIGlmZGVmIENPTkZJR19NUFJPRklMRV9LRVJORUwNCj4gLW9i
ajY0LSQoQ09ORklHX0ZVTkNUSU9OX1RSQUNFUikJCSs9IGZ0cmFjZV9tcHJvZmlsZS5vDQo+ICtv
Ymo2NC0kKENPTkZJR19GVU5DVElPTl9UUkFDRVIpCQkrPSBmdHJhY2VfbXByb2ZpbGUubyBmdHJh
Y2Uubw0KPiAgIGVsc2UNCj4gLW9iajY0LSQoQ09ORklHX0ZVTkNUSU9OX1RSQUNFUikJCSs9IGZ0
cmFjZV82NF9wZy5vDQo+ICtvYmo2NC0kKENPTkZJR19GVU5DVElPTl9UUkFDRVIpCQkrPSBmdHJh
Y2VfNjRfcGcubyBmdHJhY2VfcGcubw0KPiAgIGVuZGlmDQo+IC1vYmotJChDT05GSUdfRlVOQ1RJ
T05fVFJBQ0VSKQkJKz0gZnRyYWNlX2xvdy5vIGZ0cmFjZS5vDQo+ICtvYmotJChDT05GSUdfRlVO
Q1RJT05fVFJBQ0VSKQkJKz0gZnRyYWNlX2xvdy5vDQo+ICAgb2JqLSQoQ09ORklHX1RSQUNJTkcp
CQkJKz0gdHJhY2VfY2xvY2subw0KPiAgIA0KPiAgIG9iai0kKENPTkZJR19QUEM2NCkJCQkrPSAk
KG9iajY0LXkpDQo+IEBAIC0yNSwzICsyNiw3IEBAIEdDT1ZfUFJPRklMRV9mdHJhY2UubyA6PSBu
DQo+ICAgS0NPVl9JTlNUUlVNRU5UX2Z0cmFjZS5vIDo9IG4NCj4gICBLQ1NBTl9TQU5JVElaRV9m
dHJhY2UubyA6PSBuDQo+ICAgVUJTQU5fU0FOSVRJWkVfZnRyYWNlLm8gOj0gbg0KPiArR0NPVl9Q
Uk9GSUxFX2Z0cmFjZV9wZy5vIDo9IG4NCj4gK0tDT1ZfSU5TVFJVTUVOVF9mdHJhY2VfcGcubyA6
PSBuDQo+ICtLQ1NBTl9TQU5JVElaRV9mdHJhY2VfcGcubyA6PSBuDQo+ICtVQlNBTl9TQU5JVEla
RV9mdHJhY2VfcGcubyA6PSBuDQo+IGRpZmYgLS1naXQgYS9hcmNoL3Bvd2VycGMva2VybmVsL3Ry
YWNlL2Z0cmFjZS5jIGIvYXJjaC9wb3dlcnBjL2tlcm5lbC90cmFjZS9mdHJhY2UuYw0KPiBpbmRl
eCBhNDdmMzAzNzM0MjMzYi4uODFhMTIxYjU2YzRkN2YgMTAwNjQ0DQo+IC0tLSBhL2FyY2gvcG93
ZXJwYy9rZXJuZWwvdHJhY2UvZnRyYWNlLmMNCj4gKysrIGIvYXJjaC9wb3dlcnBjL2tlcm5lbC90
cmFjZS9mdHJhY2UuYw0KPiBAQCAtODY0LDEzICs4NjQsMyBAQCB1bnNpZ25lZCBsb25nIHByZXBh
cmVfZnRyYWNlX3JldHVybih1bnNpZ25lZCBsb25nIHBhcmVudCwgdW5zaWduZWQgbG9uZyBpcCwN
Cj4gICB9DQo+ICAgI2VuZGlmDQo+ICAgI2VuZGlmIC8qIENPTkZJR19GVU5DVElPTl9HUkFQSF9U
UkFDRVIgKi8NCj4gLQ0KPiAtI2lmZGVmIENPTkZJR19QUEM2NF9FTEZfQUJJX1YxDQo+IC1jaGFy
ICphcmNoX2Z0cmFjZV9tYXRjaF9hZGp1c3QoY2hhciAqc3RyLCBjb25zdCBjaGFyICpzZWFyY2gp
DQo+IC17DQo+IC0JaWYgKHN0clswXSA9PSAnLicgJiYgc2VhcmNoWzBdICE9ICcuJykNCj4gLQkJ
cmV0dXJuIHN0ciArIDE7DQo+IC0JZWxzZQ0KPiAtCQlyZXR1cm4gc3RyOw0KPiAtfQ0KPiAtI2Vu
ZGlmIC8qIENPTkZJR19QUEM2NF9FTEZfQUJJX1YxICovDQo+IGRpZmYgLS1naXQgYS9hcmNoL3Bv
d2VycGMva2VybmVsL3RyYWNlL2Z0cmFjZV9wZy5jIGIvYXJjaC9wb3dlcnBjL2tlcm5lbC90cmFj
ZS9mdHJhY2VfcGcuYw0KPiBuZXcgZmlsZSBtb2RlIDEwMDY0NA0KPiBpbmRleCAwMDAwMDAwMDAw
MDAwMC4uN2I4NWMzYjQ2MGEzYzANCj4gLS0tIC9kZXYvbnVsbA0KPiArKysgYi9hcmNoL3Bvd2Vy
cGMva2VybmVsL3RyYWNlL2Z0cmFjZV9wZy5jDQo+IEBAIC0wLDAgKzEsODQ2IEBADQo+ICsvLyBT
UERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMA0KPiArLyoNCj4gKyAqIENvZGUgZm9yIHJl
cGxhY2luZyBmdHJhY2UgY2FsbHMgd2l0aCBqdW1wcy4NCj4gKyAqDQo+ICsgKiBDb3B5cmlnaHQg
KEMpIDIwMDctMjAwOCBTdGV2ZW4gUm9zdGVkdCA8c3Jvc3RlZHRAcmVkaGF0LmNvbT4NCj4gKyAq
DQo+ICsgKiBUaGFua3MgZ29lcyBvdXQgdG8gUC5BLiBTZW1pLCBJbmMgZm9yIHN1cHBseWluZyBt
ZSB3aXRoIGEgUFBDNjQgYm94Lg0KPiArICoNCj4gKyAqIEFkZGVkIGZ1bmN0aW9uIGdyYXBoIHRy
YWNlciBjb2RlLCB0YWtlbiBmcm9tIHg4NiB0aGF0IHdhcyB3cml0dGVuDQo+ICsgKiBieSBGcmVk
ZXJpYyBXZWlzYmVja2VyLCBhbmQgcG9ydGVkIHRvIFBQQyBieSBTdGV2ZW4gUm9zdGVkdC4NCj4g
KyAqDQo+ICsgKi8NCj4gKw0KPiArI2RlZmluZSBwcl9mbXQoZm10KSAiZnRyYWNlLXBvd2VycGM6
ICIgZm10DQo+ICsNCj4gKyNpbmNsdWRlIDxsaW51eC9zcGlubG9jay5oPg0KPiArI2luY2x1ZGUg
PGxpbnV4L2hhcmRpcnEuaD4NCj4gKyNpbmNsdWRlIDxsaW51eC91YWNjZXNzLmg+DQo+ICsjaW5j
bHVkZSA8bGludXgvbW9kdWxlLmg+DQo+ICsjaW5jbHVkZSA8bGludXgvZnRyYWNlLmg+DQo+ICsj
aW5jbHVkZSA8bGludXgvcGVyY3B1Lmg+DQo+ICsjaW5jbHVkZSA8bGludXgvaW5pdC5oPg0KPiAr
I2luY2x1ZGUgPGxpbnV4L2xpc3QuaD4NCj4gKw0KPiArI2luY2x1ZGUgPGFzbS9jYWNoZWZsdXNo
Lmg+DQo+ICsjaW5jbHVkZSA8YXNtL2NvZGUtcGF0Y2hpbmcuaD4NCj4gKyNpbmNsdWRlIDxhc20v
ZnRyYWNlLmg+DQo+ICsjaW5jbHVkZSA8YXNtL3N5c2NhbGwuaD4NCj4gKyNpbmNsdWRlIDxhc20v
aW5zdC5oPg0KPiArDQo+ICsvKg0KPiArICogV2UgZ2VuZXJhbGx5IG9ubHkgaGF2ZSBhIHNpbmds
ZSBsb25nX2JyYW5jaCB0cmFtcCBhbmQgYXQgbW9zdCAyIG9yIDMgcGx0DQo+ICsgKiB0cmFtcHMg
Z2VuZXJhdGVkLiBCdXQsIHdlIGRvbid0IHVzZSB0aGUgcGx0IHRyYW1wcyBjdXJyZW50bHkuIFdl
IGFsc28gYWxsb3QNCj4gKyAqIDIgdHJhbXBzIGFmdGVyIC50ZXh0IGFuZCAuaW5pdC50ZXh0LiBT
bywgd2Ugb25seSBlbmQgdXAgd2l0aCBhcm91bmQgMyB1c2FibGUNCj4gKyAqIHRyYW1wcyBpbiB0
b3RhbC4gU2V0IGFzaWRlIDgganVzdCB0byBiZSBzdXJlLg0KPiArICovDQo+ICsjZGVmaW5lCU5V
TV9GVFJBQ0VfVFJBTVBTCTgNCj4gK3N0YXRpYyB1bnNpZ25lZCBsb25nIGZ0cmFjZV90cmFtcHNb
TlVNX0ZUUkFDRV9UUkFNUFNdOw0KPiArDQo+ICtzdGF0aWMgcHBjX2luc3RfdA0KPiArZnRyYWNl
X2NhbGxfcmVwbGFjZSh1bnNpZ25lZCBsb25nIGlwLCB1bnNpZ25lZCBsb25nIGFkZHIsIGludCBs
aW5rKQ0KPiArew0KPiArCXBwY19pbnN0X3Qgb3A7DQo+ICsNCj4gKwlhZGRyID0gcHBjX2Z1bmN0
aW9uX2VudHJ5KCh2b2lkICopYWRkcik7DQo+ICsNCj4gKwkvKiBpZiAobGluaykgc2V0IG9wIHRv
ICdibCcgZWxzZSAnYicgKi8NCj4gKwljcmVhdGVfYnJhbmNoKCZvcCwgKHUzMiAqKWlwLCBhZGRy
LCBsaW5rID8gQlJBTkNIX1NFVF9MSU5LIDogMCk7DQo+ICsNCj4gKwlyZXR1cm4gb3A7DQo+ICt9
DQo+ICsNCj4gK3N0YXRpYyBpbmxpbmUgaW50DQo+ICtmdHJhY2VfbW9kaWZ5X2NvZGUodW5zaWdu
ZWQgbG9uZyBpcCwgcHBjX2luc3RfdCBvbGQsIHBwY19pbnN0X3QgbmV3KQ0KPiArew0KPiArCXBw
Y19pbnN0X3QgcmVwbGFjZWQ7DQo+ICsNCj4gKwkvKg0KPiArCSAqIE5vdGU6DQo+ICsJICogV2Ug
YXJlIHBhcmFub2lkIGFib3V0IG1vZGlmeWluZyB0ZXh0LCBhcyBpZiBhIGJ1ZyB3YXMgdG8gaGFw
cGVuLCBpdA0KPiArCSAqIGNvdWxkIGNhdXNlIHVzIHRvIHJlYWQgb3Igd3JpdGUgdG8gc29tZXBs
YWNlIHRoYXQgY291bGQgY2F1c2UgaGFybS4NCj4gKwkgKiBDYXJlZnVsbHkgcmVhZCBhbmQgbW9k
aWZ5IHRoZSBjb2RlIHdpdGggcHJvYmVfa2VybmVsXyooKSwgYW5kIG1ha2UNCj4gKwkgKiBzdXJl
IHdoYXQgd2UgcmVhZCBpcyB3aGF0IHdlIGV4cGVjdGVkIGl0IHRvIGJlIGJlZm9yZSBtb2RpZnlp
bmcgaXQuDQo+ICsJICovDQo+ICsNCj4gKwkvKiByZWFkIHRoZSB0ZXh0IHdlIHdhbnQgdG8gbW9k
aWZ5ICovDQo+ICsJaWYgKGNvcHlfaW5zdF9mcm9tX2tlcm5lbF9ub2ZhdWx0KCZyZXBsYWNlZCwg
KHZvaWQgKilpcCkpDQo+ICsJCXJldHVybiAtRUZBVUxUOw0KPiArDQo+ICsJLyogTWFrZSBzdXJl
IGl0IGlzIHdoYXQgd2UgZXhwZWN0IGl0IHRvIGJlICovDQo+ICsJaWYgKCFwcGNfaW5zdF9lcXVh
bChyZXBsYWNlZCwgb2xkKSkgew0KPiArCQlwcl9lcnIoIiVwOiByZXBsYWNlZCAoJTA4bHgpICE9
IG9sZCAoJTA4bHgpIiwgKHZvaWQgKilpcCwNCj4gKwkJICAgICAgIHBwY19pbnN0X2FzX3Vsb25n
KHJlcGxhY2VkKSwgcHBjX2luc3RfYXNfdWxvbmcob2xkKSk7DQo+ICsJCXJldHVybiAtRUlOVkFM
Ow0KPiArCX0NCj4gKw0KPiArCS8qIHJlcGxhY2UgdGhlIHRleHQgd2l0aCB0aGUgbmV3IHRleHQg
Ki8NCj4gKwlyZXR1cm4gcGF0Y2hfaW5zdHJ1Y3Rpb24oKHUzMiAqKWlwLCBuZXcpOw0KPiArfQ0K
PiArDQo+ICsvKg0KPiArICogSGVscGVyIGZ1bmN0aW9ucyB0aGF0IGFyZSB0aGUgc2FtZSBmb3Ig
Ym90aCBQUEM2NCBhbmQgUFBDMzIuDQo+ICsgKi8NCj4gK3N0YXRpYyBpbnQgdGVzdF8yNGJpdF9h
ZGRyKHVuc2lnbmVkIGxvbmcgaXAsIHVuc2lnbmVkIGxvbmcgYWRkcikNCj4gK3sNCj4gKwlhZGRy
ID0gcHBjX2Z1bmN0aW9uX2VudHJ5KCh2b2lkICopYWRkcik7DQo+ICsNCj4gKwlyZXR1cm4gaXNf
b2Zmc2V0X2luX2JyYW5jaF9yYW5nZShhZGRyIC0gaXApOw0KPiArfQ0KPiArDQo+ICtzdGF0aWMg
aW50IGlzX2JsX29wKHBwY19pbnN0X3Qgb3ApDQo+ICt7DQo+ICsJcmV0dXJuIChwcGNfaW5zdF92
YWwob3ApICYgflBQQ19MSV9NQVNLKSA9PSBQUENfUkFXX0JMKDApOw0KPiArfQ0KPiArDQo+ICtz
dGF0aWMgaW50IGlzX2Jfb3AocHBjX2luc3RfdCBvcCkNCj4gK3sNCj4gKwlyZXR1cm4gKHBwY19p
bnN0X3ZhbChvcCkgJiB+UFBDX0xJX01BU0spID09IFBQQ19SQVdfQlJBTkNIKDApOw0KPiArfQ0K
PiArDQo+ICtzdGF0aWMgdW5zaWduZWQgbG9uZyBmaW5kX2JsX3RhcmdldCh1bnNpZ25lZCBsb25n
IGlwLCBwcGNfaW5zdF90IG9wKQ0KPiArew0KPiArCWludCBvZmZzZXQ7DQo+ICsNCj4gKwlvZmZz
ZXQgPSBQUENfTEkocHBjX2luc3RfdmFsKG9wKSk7DQo+ICsJLyogbWFrZSBpdCBzaWduZWQgKi8N
Cj4gKwlpZiAob2Zmc2V0ICYgMHgwMjAwMDAwMCkNCj4gKwkJb2Zmc2V0IHw9IDB4ZmUwMDAwMDA7
DQo+ICsNCj4gKwlyZXR1cm4gaXAgKyAobG9uZylvZmZzZXQ7DQo+ICt9DQo+ICsNCj4gKyNpZmRl
ZiBDT05GSUdfTU9EVUxFUw0KPiArc3RhdGljIGludA0KPiArX19mdHJhY2VfbWFrZV9ub3Aoc3Ry
dWN0IG1vZHVsZSAqbW9kLA0KPiArCQkgIHN0cnVjdCBkeW5fZnRyYWNlICpyZWMsIHVuc2lnbmVk
IGxvbmcgYWRkcikNCj4gK3sNCj4gKwl1bnNpZ25lZCBsb25nIGVudHJ5LCBwdHIsIHRyYW1wOw0K
PiArCXVuc2lnbmVkIGxvbmcgaXAgPSByZWMtPmlwOw0KPiArCXBwY19pbnN0X3Qgb3AsIHBvcDsN
Cj4gKw0KPiArCS8qIHJlYWQgd2hlcmUgdGhpcyBnb2VzICovDQo+ICsJaWYgKGNvcHlfaW5zdF9m
cm9tX2tlcm5lbF9ub2ZhdWx0KCZvcCwgKHZvaWQgKilpcCkpIHsNCj4gKwkJcHJfZXJyKCJGZXRj
aGluZyBvcGNvZGUgZmFpbGVkLlxuIik7DQo+ICsJCXJldHVybiAtRUZBVUxUOw0KPiArCX0NCj4g
Kw0KPiArCS8qIE1ha2Ugc3VyZSB0aGF0IHRoaXMgaXMgc3RpbGwgYSAyNGJpdCBqdW1wICovDQo+
ICsJaWYgKCFpc19ibF9vcChvcCkpIHsNCj4gKwkJcHJfZXJyKCJOb3QgZXhwZWN0ZWQgYmw6IG9w
Y29kZSBpcyAlMDhseFxuIiwgcHBjX2luc3RfYXNfdWxvbmcob3ApKTsNCj4gKwkJcmV0dXJuIC1F
SU5WQUw7DQo+ICsJfQ0KPiArDQo+ICsJLyogbGV0cyBmaW5kIHdoZXJlIHRoZSBwb2ludGVyIGdv
ZXMgKi8NCj4gKwl0cmFtcCA9IGZpbmRfYmxfdGFyZ2V0KGlwLCBvcCk7DQo+ICsNCj4gKwlwcl9k
ZXZlbCgiaXA6JWx4IGp1bXBzIHRvICVseCIsIGlwLCB0cmFtcCk7DQo+ICsNCj4gKwlpZiAobW9k
dWxlX3RyYW1wb2xpbmVfdGFyZ2V0KG1vZCwgdHJhbXAsICZwdHIpKSB7DQo+ICsJCXByX2Vycigi
RmFpbGVkIHRvIGdldCB0cmFtcG9saW5lIHRhcmdldFxuIik7DQo+ICsJCXJldHVybiAtRUZBVUxU
Ow0KPiArCX0NCj4gKw0KPiArCXByX2RldmVsKCJ0cmFtcG9saW5lIHRhcmdldCAlbHgiLCBwdHIp
Ow0KPiArDQo+ICsJZW50cnkgPSBwcGNfZ2xvYmFsX2Z1bmN0aW9uX2VudHJ5KCh2b2lkICopYWRk
cik7DQo+ICsJLyogVGhpcyBzaG91bGQgbWF0Y2ggd2hhdCB3YXMgY2FsbGVkICovDQo+ICsJaWYg
KHB0ciAhPSBlbnRyeSkgew0KPiArCQlwcl9lcnIoImFkZHIgJWx4IGRvZXMgbm90IG1hdGNoIGV4
cGVjdGVkICVseFxuIiwgcHRyLCBlbnRyeSk7DQo+ICsJCXJldHVybiAtRUlOVkFMOw0KPiArCX0N
Cj4gKw0KPiArCWlmIChJU19FTkFCTEVEKENPTkZJR19NUFJPRklMRV9LRVJORUwpKSB7DQo+ICsJ
CWlmIChjb3B5X2luc3RfZnJvbV9rZXJuZWxfbm9mYXVsdCgmb3AsICh2b2lkICopKGlwIC0gNCkp
KSB7DQo+ICsJCQlwcl9lcnIoIkZldGNoaW5nIGluc3RydWN0aW9uIGF0ICVseCBmYWlsZWQuXG4i
LCBpcCAtIDQpOw0KPiArCQkJcmV0dXJuIC1FRkFVTFQ7DQo+ICsJCX0NCj4gKw0KPiArCQkvKiBX
ZSBleHBlY3QgZWl0aGVyIGEgbWZsciByMCwgb3IgYSBzdGQgcjAsIExSU0FWRShyMSkgKi8NCj4g
KwkJaWYgKCFwcGNfaW5zdF9lcXVhbChvcCwgcHBjX2luc3QoUFBDX1JBV19NRkxSKF9SMCkpKSAm
Jg0KPiArCQkgICAgIXBwY19pbnN0X2VxdWFsKG9wLCBwcGNfaW5zdChQUENfSU5TVF9TVERfTFIp
KSkgew0KPiArCQkJcHJfZXJyKCJVbmV4cGVjdGVkIGluc3RydWN0aW9uICUwOGx4IGFyb3VuZCBi
bCBfbWNvdW50XG4iLA0KPiArCQkJICAgICAgIHBwY19pbnN0X2FzX3Vsb25nKG9wKSk7DQo+ICsJ
CQlyZXR1cm4gLUVJTlZBTDsNCj4gKwkJfQ0KPiArCX0gZWxzZSBpZiAoSVNfRU5BQkxFRChDT05G
SUdfUFBDNjQpKSB7DQo+ICsJCS8qDQo+ICsJCSAqIENoZWNrIHdoYXQgaXMgaW4gdGhlIG5leHQg
aW5zdHJ1Y3Rpb24uIFdlIGNhbiBzZWUgbGQgcjIsNDAocjEpLCBidXQNCj4gKwkJICogb24gZmly
c3QgcGFzcyBhZnRlciBib290IHdlIHdpbGwgc2VlIG1mbHIgcjAuDQo+ICsJCSAqLw0KPiArCQlp
ZiAoY29weV9pbnN0X2Zyb21fa2VybmVsX25vZmF1bHQoJm9wLCAodm9pZCAqKShpcCArIDQpKSkg
ew0KPiArCQkJcHJfZXJyKCJGZXRjaGluZyBvcCBmYWlsZWQuXG4iKTsNCj4gKwkJCXJldHVybiAt
RUZBVUxUOw0KPiArCQl9DQo+ICsNCj4gKwkJaWYgKCFwcGNfaW5zdF9lcXVhbChvcCwgIHBwY19p
bnN0KFBQQ19JTlNUX0xEX1RPQykpKSB7DQo+ICsJCQlwcl9lcnIoIkV4cGVjdGVkICUwOGx4IGZv
dW5kICUwOGx4XG4iLCBQUENfSU5TVF9MRF9UT0MsDQo+ICsJCQkgICAgICAgcHBjX2luc3RfYXNf
dWxvbmcob3ApKTsNCj4gKwkJCXJldHVybiAtRUlOVkFMOw0KPiArCQl9DQo+ICsJfQ0KPiArDQo+
ICsJLyoNCj4gKwkgKiBXaGVuIHVzaW5nIC1tcHJvZmlsZS1rZXJuZWwgb3IgUFBDMzIgdGhlcmUg
aXMgbm8gbG9hZCB0byBqdW1wIG92ZXIuDQo+ICsJICoNCj4gKwkgKiBPdGhlcndpc2Ugb3VyIG9y
aWdpbmFsIGNhbGwgc2l0ZSBsb29rcyBsaWtlOg0KPiArCSAqDQo+ICsJICogYmwgPHRyYW1wPg0K
PiArCSAqIGxkIHIyLFhYKHIxKQ0KPiArCSAqDQo+ICsJICogTWlsdG9uIE1pbGxlciBwb2ludGVk
IG91dCB0aGF0IHdlIGNhbiBub3Qgc2ltcGx5IG5vcCB0aGUgYnJhbmNoLg0KPiArCSAqIElmIGEg
dGFzayB3YXMgcHJlZW1wdGVkIHdoZW4gY2FsbGluZyBhIHRyYWNlIGZ1bmN0aW9uLCB0aGUgbm9w
cw0KPiArCSAqIHdpbGwgcmVtb3ZlIHRoZSB3YXkgdG8gcmVzdG9yZSB0aGUgVE9DIGluIHIyIGFu
ZCB0aGUgcjIgVE9DIHdpbGwNCj4gKwkgKiBnZXQgY29ycnVwdGVkLg0KPiArCSAqDQo+ICsJICog
VXNlIGEgYiArOCB0byBqdW1wIG92ZXIgdGhlIGxvYWQuDQo+ICsJICovDQo+ICsJaWYgKElTX0VO
QUJMRUQoQ09ORklHX01QUk9GSUxFX0tFUk5FTCkgfHwgSVNfRU5BQkxFRChDT05GSUdfUFBDMzIp
KQ0KPiArCQlwb3AgPSBwcGNfaW5zdChQUENfUkFXX05PUCgpKTsNCj4gKwllbHNlDQo+ICsJCXBv
cCA9IHBwY19pbnN0KFBQQ19SQVdfQlJBTkNIKDgpKTsJLyogYiArOCAqLw0KPiArDQo+ICsJaWYg
KHBhdGNoX2luc3RydWN0aW9uKCh1MzIgKilpcCwgcG9wKSkgew0KPiArCQlwcl9lcnIoIlBhdGNo
aW5nIE5PUCBmYWlsZWQuXG4iKTsNCj4gKwkJcmV0dXJuIC1FUEVSTTsNCj4gKwl9DQo+ICsNCj4g
KwlyZXR1cm4gMDsNCj4gK30NCj4gKyNlbHNlDQo+ICtzdGF0aWMgaW50IF9fZnRyYWNlX21ha2Vf
bm9wKHN0cnVjdCBtb2R1bGUgKm1vZCwgc3RydWN0IGR5bl9mdHJhY2UgKnJlYywgdW5zaWduZWQg
bG9uZyBhZGRyKQ0KPiArew0KPiArCXJldHVybiAwOw0KPiArfQ0KPiArI2VuZGlmIC8qIENPTkZJ
R19NT0RVTEVTICovDQo+ICsNCj4gK3N0YXRpYyB1bnNpZ25lZCBsb25nIGZpbmRfZnRyYWNlX3Ry
YW1wKHVuc2lnbmVkIGxvbmcgaXApDQo+ICt7DQo+ICsJaW50IGk7DQo+ICsNCj4gKwkvKg0KPiAr
CSAqIFdlIGhhdmUgdGhlIGNvbXBpbGVyIGdlbmVyYXRlZCBsb25nX2JyYW5jaCB0cmFtcHMgYXQg
dGhlIGVuZA0KPiArCSAqIGFuZCB3ZSBwcmVmZXIgdGhvc2UNCj4gKwkgKi8NCj4gKwlmb3IgKGkg
PSBOVU1fRlRSQUNFX1RSQU1QUyAtIDE7IGkgPj0gMDsgaS0tKQ0KPiArCQlpZiAoIWZ0cmFjZV90
cmFtcHNbaV0pDQo+ICsJCQljb250aW51ZTsNCj4gKwkJZWxzZSBpZiAoaXNfb2Zmc2V0X2luX2Jy
YW5jaF9yYW5nZShmdHJhY2VfdHJhbXBzW2ldIC0gaXApKQ0KPiArCQkJcmV0dXJuIGZ0cmFjZV90
cmFtcHNbaV07DQo+ICsNCj4gKwlyZXR1cm4gMDsNCj4gK30NCj4gKw0KPiArc3RhdGljIGludCBh
ZGRfZnRyYWNlX3RyYW1wKHVuc2lnbmVkIGxvbmcgdHJhbXApDQo+ICt7DQo+ICsJaW50IGk7DQo+
ICsNCj4gKwlmb3IgKGkgPSAwOyBpIDwgTlVNX0ZUUkFDRV9UUkFNUFM7IGkrKykNCj4gKwkJaWYg
KCFmdHJhY2VfdHJhbXBzW2ldKSB7DQo+ICsJCQlmdHJhY2VfdHJhbXBzW2ldID0gdHJhbXA7DQo+
ICsJCQlyZXR1cm4gMDsNCj4gKwkJfQ0KPiArDQo+ICsJcmV0dXJuIC0xOw0KPiArfQ0KPiArDQo+
ICsvKg0KPiArICogSWYgdGhpcyBpcyBhIGNvbXBpbGVyIGdlbmVyYXRlZCBsb25nX2JyYW5jaCB0
cmFtcG9saW5lIChlc3NlbnRpYWxseSwgYQ0KPiArICogdHJhbXBvbGluZSB0aGF0IGhhcyBhIGJy
YW5jaCB0byBfbWNvdW50KCkpLCB3ZSByZS13cml0ZSB0aGUgYnJhbmNoIHRvDQo+ICsgKiBpbnN0
ZWFkIGdvIHRvIGZ0cmFjZV9bcmVnc19dY2FsbGVyKCkgYW5kIG5vdGUgZG93biB0aGUgbG9jYXRp
b24gb2YgdGhpcw0KPiArICogdHJhbXBvbGluZS4NCj4gKyAqLw0KPiArc3RhdGljIGludCBzZXR1
cF9tY291bnRfY29tcGlsZXJfdHJhbXAodW5zaWduZWQgbG9uZyB0cmFtcCkNCj4gK3sNCj4gKwlp
bnQgaTsNCj4gKwlwcGNfaW5zdF90IG9wOw0KPiArCXVuc2lnbmVkIGxvbmcgcHRyOw0KPiArDQo+
ICsJLyogSXMgdGhpcyBhIGtub3duIGxvbmcganVtcCB0cmFtcD8gKi8NCj4gKwlmb3IgKGkgPSAw
OyBpIDwgTlVNX0ZUUkFDRV9UUkFNUFM7IGkrKykNCj4gKwkJaWYgKGZ0cmFjZV90cmFtcHNbaV0g
PT0gdHJhbXApDQo+ICsJCQlyZXR1cm4gMDsNCj4gKw0KPiArCS8qIE5ldyB0cmFtcG9saW5lIC0t
IHJlYWQgd2hlcmUgdGhpcyBnb2VzICovDQo+ICsJaWYgKGNvcHlfaW5zdF9mcm9tX2tlcm5lbF9u
b2ZhdWx0KCZvcCwgKHZvaWQgKil0cmFtcCkpIHsNCj4gKwkJcHJfZGVidWcoIkZldGNoaW5nIG9w
Y29kZSBmYWlsZWQuXG4iKTsNCj4gKwkJcmV0dXJuIC0xOw0KPiArCX0NCj4gKw0KPiArCS8qIElz
IHRoaXMgYSAyNCBiaXQgYnJhbmNoPyAqLw0KPiArCWlmICghaXNfYl9vcChvcCkpIHsNCj4gKwkJ
cHJfZGVidWcoIlRyYW1wb2xpbmUgaXMgbm90IGEgbG9uZyBicmFuY2ggdHJhbXAuXG4iKTsNCj4g
KwkJcmV0dXJuIC0xOw0KPiArCX0NCj4gKw0KPiArCS8qIGxldHMgZmluZCB3aGVyZSB0aGUgcG9p
bnRlciBnb2VzICovDQo+ICsJcHRyID0gZmluZF9ibF90YXJnZXQodHJhbXAsIG9wKTsNCj4gKw0K
PiArCWlmIChwdHIgIT0gcHBjX2dsb2JhbF9mdW5jdGlvbl9lbnRyeSgodm9pZCAqKV9tY291bnQp
KSB7DQo+ICsJCXByX2RlYnVnKCJUcmFtcG9saW5lIHRhcmdldCAlcCBpcyBub3QgX21jb3VudFxu
IiwgKHZvaWQgKilwdHIpOw0KPiArCQlyZXR1cm4gLTE7DQo+ICsJfQ0KPiArDQo+ICsJLyogTGV0
J3MgcmUtd3JpdGUgdGhlIHRyYW1wIHRvIGdvIHRvIGZ0cmFjZV9bcmVnc19dY2FsbGVyICovDQo+
ICsJaWYgKElTX0VOQUJMRUQoQ09ORklHX0RZTkFNSUNfRlRSQUNFX1dJVEhfUkVHUykpDQo+ICsJ
CXB0ciA9IHBwY19nbG9iYWxfZnVuY3Rpb25fZW50cnkoKHZvaWQgKilmdHJhY2VfcmVnc19jYWxs
ZXIpOw0KPiArCWVsc2UNCj4gKwkJcHRyID0gcHBjX2dsb2JhbF9mdW5jdGlvbl9lbnRyeSgodm9p
ZCAqKWZ0cmFjZV9jYWxsZXIpOw0KPiArDQo+ICsJaWYgKHBhdGNoX2JyYW5jaCgodTMyICopdHJh
bXAsIHB0ciwgMCkpIHsNCj4gKwkJcHJfZGVidWcoIlJFTDI0IG91dCBvZiByYW5nZSFcbiIpOw0K
PiArCQlyZXR1cm4gLTE7DQo+ICsJfQ0KPiArDQo+ICsJaWYgKGFkZF9mdHJhY2VfdHJhbXAodHJh
bXApKSB7DQo+ICsJCXByX2RlYnVnKCJObyB0cmFtcCBsb2NhdGlvbnMgbGVmdFxuIik7DQo+ICsJ
CXJldHVybiAtMTsNCj4gKwl9DQo+ICsNCj4gKwlyZXR1cm4gMDsNCj4gK30NCj4gKw0KPiArc3Rh
dGljIGludCBfX2Z0cmFjZV9tYWtlX25vcF9rZXJuZWwoc3RydWN0IGR5bl9mdHJhY2UgKnJlYywg
dW5zaWduZWQgbG9uZyBhZGRyKQ0KPiArew0KPiArCXVuc2lnbmVkIGxvbmcgdHJhbXAsIGlwID0g
cmVjLT5pcDsNCj4gKwlwcGNfaW5zdF90IG9wOw0KPiArDQo+ICsJLyogUmVhZCB3aGVyZSB0aGlz
IGdvZXMgKi8NCj4gKwlpZiAoY29weV9pbnN0X2Zyb21fa2VybmVsX25vZmF1bHQoJm9wLCAodm9p
ZCAqKWlwKSkgew0KPiArCQlwcl9lcnIoIkZldGNoaW5nIG9wY29kZSBmYWlsZWQuXG4iKTsNCj4g
KwkJcmV0dXJuIC1FRkFVTFQ7DQo+ICsJfQ0KPiArDQo+ICsJLyogTWFrZSBzdXJlIHRoYXQgdGhp
cyBpcyBzdGlsbCBhIDI0Yml0IGp1bXAgKi8NCj4gKwlpZiAoIWlzX2JsX29wKG9wKSkgew0KPiAr
CQlwcl9lcnIoIk5vdCBleHBlY3RlZCBibDogb3Bjb2RlIGlzICUwOGx4XG4iLCBwcGNfaW5zdF9h
c191bG9uZyhvcCkpOw0KPiArCQlyZXR1cm4gLUVJTlZBTDsNCj4gKwl9DQo+ICsNCj4gKwkvKiBM
ZXQncyBmaW5kIHdoZXJlIHRoZSBwb2ludGVyIGdvZXMgKi8NCj4gKwl0cmFtcCA9IGZpbmRfYmxf
dGFyZ2V0KGlwLCBvcCk7DQo+ICsNCj4gKwlwcl9kZXZlbCgiaXA6JWx4IGp1bXBzIHRvICVseCIs
IGlwLCB0cmFtcCk7DQo+ICsNCj4gKwlpZiAoc2V0dXBfbWNvdW50X2NvbXBpbGVyX3RyYW1wKHRy
YW1wKSkgew0KPiArCQkvKiBBcmUgb3RoZXIgdHJhbXBvbGluZXMgcmVhY2hhYmxlPyAqLw0KPiAr
CQlpZiAoIWZpbmRfZnRyYWNlX3RyYW1wKGlwKSkgew0KPiArCQkJcHJfZXJyKCJObyBmdHJhY2Ug
dHJhbXBvbGluZXMgcmVhY2hhYmxlIGZyb20gJXBzXG4iLA0KPiArCQkJCQkodm9pZCAqKWlwKTsN
Cj4gKwkJCXJldHVybiAtRUlOVkFMOw0KPiArCQl9DQo+ICsJfQ0KPiArDQo+ICsJaWYgKHBhdGNo
X2luc3RydWN0aW9uKCh1MzIgKilpcCwgcHBjX2luc3QoUFBDX1JBV19OT1AoKSkpKSB7DQo+ICsJ
CXByX2VycigiUGF0Y2hpbmcgTk9QIGZhaWxlZC5cbiIpOw0KPiArCQlyZXR1cm4gLUVQRVJNOw0K
PiArCX0NCj4gKw0KPiArCXJldHVybiAwOw0KPiArfQ0KPiArDQo+ICtpbnQgZnRyYWNlX21ha2Vf
bm9wKHN0cnVjdCBtb2R1bGUgKm1vZCwNCj4gKwkJICAgIHN0cnVjdCBkeW5fZnRyYWNlICpyZWMs
IHVuc2lnbmVkIGxvbmcgYWRkcikNCj4gK3sNCj4gKwl1bnNpZ25lZCBsb25nIGlwID0gcmVjLT5p
cDsNCj4gKwlwcGNfaW5zdF90IG9sZCwgbmV3Ow0KPiArDQo+ICsJLyoNCj4gKwkgKiBJZiB0aGUg
Y2FsbGluZyBhZGRyZXNzIGlzIG1vcmUgdGhhdCAyNCBiaXRzIGF3YXksDQo+ICsJICogdGhlbiB3
ZSBoYWQgdG8gdXNlIGEgdHJhbXBvbGluZSB0byBtYWtlIHRoZSBjYWxsLg0KPiArCSAqIE90aGVy
d2lzZSBqdXN0IHVwZGF0ZSB0aGUgY2FsbCBzaXRlLg0KPiArCSAqLw0KPiArCWlmICh0ZXN0XzI0
Yml0X2FkZHIoaXAsIGFkZHIpKSB7DQo+ICsJCS8qIHdpdGhpbiByYW5nZSAqLw0KPiArCQlvbGQg
PSBmdHJhY2VfY2FsbF9yZXBsYWNlKGlwLCBhZGRyLCAxKTsNCj4gKwkJbmV3ID0gcHBjX2luc3Qo
UFBDX1JBV19OT1AoKSk7DQo+ICsJCXJldHVybiBmdHJhY2VfbW9kaWZ5X2NvZGUoaXAsIG9sZCwg
bmV3KTsNCj4gKwl9IGVsc2UgaWYgKGNvcmVfa2VybmVsX3RleHQoaXApKSB7DQo+ICsJCXJldHVy
biBfX2Z0cmFjZV9tYWtlX25vcF9rZXJuZWwocmVjLCBhZGRyKTsNCj4gKwl9IGVsc2UgaWYgKCFJ
U19FTkFCTEVEKENPTkZJR19NT0RVTEVTKSkgew0KPiArCQlyZXR1cm4gLUVJTlZBTDsNCj4gKwl9
DQo+ICsNCj4gKwkvKg0KPiArCSAqIE91dCBvZiByYW5nZSBqdW1wcyBhcmUgY2FsbGVkIGZyb20g
bW9kdWxlcy4NCj4gKwkgKiBXZSBzaG91bGQgZWl0aGVyIGFscmVhZHkgaGF2ZSBhIHBvaW50ZXIg
dG8gdGhlIG1vZHVsZQ0KPiArCSAqIG9yIGl0IGhhcyBiZWVuIHBhc3NlZCBpbi4NCj4gKwkgKi8N
Cj4gKwlpZiAoIXJlYy0+YXJjaC5tb2QpIHsNCj4gKwkJaWYgKCFtb2QpIHsNCj4gKwkJCXByX2Vy
cigiTm8gbW9kdWxlIGxvYWRlZCBhZGRyPSVseFxuIiwgYWRkcik7DQo+ICsJCQlyZXR1cm4gLUVG
QVVMVDsNCj4gKwkJfQ0KPiArCQlyZWMtPmFyY2gubW9kID0gbW9kOw0KPiArCX0gZWxzZSBpZiAo
bW9kKSB7DQo+ICsJCWlmIChtb2QgIT0gcmVjLT5hcmNoLm1vZCkgew0KPiArCQkJcHJfZXJyKCJS
ZWNvcmQgbW9kICVwIG5vdCBlcXVhbCB0byBwYXNzZWQgaW4gbW9kICVwXG4iLA0KPiArCQkJICAg
ICAgIHJlYy0+YXJjaC5tb2QsIG1vZCk7DQo+ICsJCQlyZXR1cm4gLUVJTlZBTDsNCj4gKwkJfQ0K
PiArCQkvKiBub3RoaW5nIHRvIGRvIGlmIG1vZCA9PSByZWMtPmFyY2gubW9kICovDQo+ICsJfSBl
bHNlDQo+ICsJCW1vZCA9IHJlYy0+YXJjaC5tb2Q7DQo+ICsNCj4gKwlyZXR1cm4gX19mdHJhY2Vf
bWFrZV9ub3AobW9kLCByZWMsIGFkZHIpOw0KPiArfQ0KPiArDQo+ICsjaWZkZWYgQ09ORklHX01P
RFVMRVMNCj4gKy8qDQo+ICsgKiBFeGFtaW5lIHRoZSBleGlzdGluZyBpbnN0cnVjdGlvbnMgZm9y
IF9fZnRyYWNlX21ha2VfY2FsbC4NCj4gKyAqIFRoZXkgc2hvdWxkIGVmZmVjdGl2ZWx5IGJlIGEg
Tk9QLCBhbmQgZm9sbG93IGZvcm1hbCBjb25zdHJhaW50cywNCj4gKyAqIGRlcGVuZGluZyBvbiB0
aGUgQUJJLiBSZXR1cm4gZmFsc2UgaWYgdGhleSBkb24ndC4NCj4gKyAqLw0KPiArc3RhdGljIGJv
b2wgZXhwZWN0ZWRfbm9wX3NlcXVlbmNlKHZvaWQgKmlwLCBwcGNfaW5zdF90IG9wMCwgcHBjX2lu
c3RfdCBvcDEpDQo+ICt7DQo+ICsJaWYgKElTX0VOQUJMRUQoQ09ORklHX0RZTkFNSUNfRlRSQUNF
X1dJVEhfUkVHUykpDQo+ICsJCXJldHVybiBwcGNfaW5zdF9lcXVhbChvcDAsIHBwY19pbnN0KFBQ
Q19SQVdfTk9QKCkpKTsNCj4gKwllbHNlDQo+ICsJCXJldHVybiBwcGNfaW5zdF9lcXVhbChvcDAs
IHBwY19pbnN0KFBQQ19SQVdfQlJBTkNIKDgpKSkgJiYNCj4gKwkJICAgICAgIHBwY19pbnN0X2Vx
dWFsKG9wMSwgcHBjX2luc3QoUFBDX0lOU1RfTERfVE9DKSk7DQo+ICt9DQo+ICsNCj4gK3N0YXRp
YyBpbnQNCj4gK19fZnRyYWNlX21ha2VfY2FsbChzdHJ1Y3QgZHluX2Z0cmFjZSAqcmVjLCB1bnNp
Z25lZCBsb25nIGFkZHIpDQo+ICt7DQo+ICsJcHBjX2luc3RfdCBvcFsyXTsNCj4gKwl2b2lkICpp
cCA9ICh2b2lkICopcmVjLT5pcDsNCj4gKwl1bnNpZ25lZCBsb25nIGVudHJ5LCBwdHIsIHRyYW1w
Ow0KPiArCXN0cnVjdCBtb2R1bGUgKm1vZCA9IHJlYy0+YXJjaC5tb2Q7DQo+ICsNCj4gKwkvKiBy
ZWFkIHdoZXJlIHRoaXMgZ29lcyAqLw0KPiArCWlmIChjb3B5X2luc3RfZnJvbV9rZXJuZWxfbm9m
YXVsdChvcCwgaXApKQ0KPiArCQlyZXR1cm4gLUVGQVVMVDsNCj4gKw0KPiArCWlmICghSVNfRU5B
QkxFRChDT05GSUdfRFlOQU1JQ19GVFJBQ0VfV0lUSF9SRUdTKSAmJg0KPiArCSAgICBjb3B5X2lu
c3RfZnJvbV9rZXJuZWxfbm9mYXVsdChvcCArIDEsIGlwICsgNCkpDQo+ICsJCXJldHVybiAtRUZB
VUxUOw0KPiArDQo+ICsJaWYgKCFleHBlY3RlZF9ub3Bfc2VxdWVuY2UoaXAsIG9wWzBdLCBvcFsx
XSkpIHsNCj4gKwkJcHJfZXJyKCJVbmV4cGVjdGVkIGNhbGwgc2VxdWVuY2UgYXQgJXA6ICUwOGx4
ICUwOGx4XG4iLCBpcCwNCj4gKwkJICAgICAgIHBwY19pbnN0X2FzX3Vsb25nKG9wWzBdKSwgcHBj
X2luc3RfYXNfdWxvbmcob3BbMV0pKTsNCj4gKwkJcmV0dXJuIC1FSU5WQUw7DQo+ICsJfQ0KPiAr
DQo+ICsJLyogSWYgd2UgbmV2ZXIgc2V0IHVwIGZ0cmFjZSB0cmFtcG9saW5lKHMpLCB0aGVuIGJh
aWwgKi8NCj4gKwlpZiAoIW1vZC0+YXJjaC50cmFtcCB8fA0KPiArCSAgICAoSVNfRU5BQkxFRChD
T05GSUdfRFlOQU1JQ19GVFJBQ0VfV0lUSF9SRUdTKSAmJiAhbW9kLT5hcmNoLnRyYW1wX3JlZ3Mp
KSB7DQo+ICsJCXByX2VycigiTm8gZnRyYWNlIHRyYW1wb2xpbmVcbiIpOw0KPiArCQlyZXR1cm4g
LUVJTlZBTDsNCj4gKwl9DQo+ICsNCj4gKwlpZiAoSVNfRU5BQkxFRChDT05GSUdfRFlOQU1JQ19G
VFJBQ0VfV0lUSF9SRUdTKSAmJiByZWMtPmZsYWdzICYgRlRSQUNFX0ZMX1JFR1MpDQo+ICsJCXRy
YW1wID0gbW9kLT5hcmNoLnRyYW1wX3JlZ3M7DQo+ICsJZWxzZQ0KPiArCQl0cmFtcCA9IG1vZC0+
YXJjaC50cmFtcDsNCj4gKw0KPiArCWlmIChtb2R1bGVfdHJhbXBvbGluZV90YXJnZXQobW9kLCB0
cmFtcCwgJnB0cikpIHsNCj4gKwkJcHJfZXJyKCJGYWlsZWQgdG8gZ2V0IHRyYW1wb2xpbmUgdGFy
Z2V0XG4iKTsNCj4gKwkJcmV0dXJuIC1FRkFVTFQ7DQo+ICsJfQ0KPiArDQo+ICsJcHJfZGV2ZWwo
InRyYW1wb2xpbmUgdGFyZ2V0ICVseCIsIHB0cik7DQo+ICsNCj4gKwllbnRyeSA9IHBwY19nbG9i
YWxfZnVuY3Rpb25fZW50cnkoKHZvaWQgKilhZGRyKTsNCj4gKwkvKiBUaGlzIHNob3VsZCBtYXRj
aCB3aGF0IHdhcyBjYWxsZWQgKi8NCj4gKwlpZiAocHRyICE9IGVudHJ5KSB7DQo+ICsJCXByX2Vy
cigiYWRkciAlbHggZG9lcyBub3QgbWF0Y2ggZXhwZWN0ZWQgJWx4XG4iLCBwdHIsIGVudHJ5KTsN
Cj4gKwkJcmV0dXJuIC1FSU5WQUw7DQo+ICsJfQ0KPiArDQo+ICsJaWYgKHBhdGNoX2JyYW5jaChp
cCwgdHJhbXAsIEJSQU5DSF9TRVRfTElOSykpIHsNCj4gKwkJcHJfZXJyKCJSRUwyNCBvdXQgb2Yg
cmFuZ2UhXG4iKTsNCj4gKwkJcmV0dXJuIC1FSU5WQUw7DQo+ICsJfQ0KPiArDQo+ICsJcmV0dXJu
IDA7DQo+ICt9DQo+ICsjZWxzZQ0KPiArc3RhdGljIGludCBfX2Z0cmFjZV9tYWtlX2NhbGwoc3Ry
dWN0IGR5bl9mdHJhY2UgKnJlYywgdW5zaWduZWQgbG9uZyBhZGRyKQ0KPiArew0KPiArCXJldHVy
biAwOw0KPiArfQ0KPiArI2VuZGlmIC8qIENPTkZJR19NT0RVTEVTICovDQo+ICsNCj4gK3N0YXRp
YyBpbnQgX19mdHJhY2VfbWFrZV9jYWxsX2tlcm5lbChzdHJ1Y3QgZHluX2Z0cmFjZSAqcmVjLCB1
bnNpZ25lZCBsb25nIGFkZHIpDQo+ICt7DQo+ICsJcHBjX2luc3RfdCBvcDsNCj4gKwl2b2lkICpp
cCA9ICh2b2lkICopcmVjLT5pcDsNCj4gKwl1bnNpZ25lZCBsb25nIHRyYW1wLCBlbnRyeSwgcHRy
Ow0KPiArDQo+ICsJLyogTWFrZSBzdXJlIHdlJ3JlIGJlaW5nIGFza2VkIHRvIHBhdGNoIGJyYW5j
aCB0byBhIGtub3duIGZ0cmFjZSBhZGRyICovDQo+ICsJZW50cnkgPSBwcGNfZ2xvYmFsX2Z1bmN0
aW9uX2VudHJ5KCh2b2lkICopZnRyYWNlX2NhbGxlcik7DQo+ICsJcHRyID0gcHBjX2dsb2JhbF9m
dW5jdGlvbl9lbnRyeSgodm9pZCAqKWFkZHIpOw0KPiArDQo+ICsJaWYgKHB0ciAhPSBlbnRyeSAm
JiBJU19FTkFCTEVEKENPTkZJR19EWU5BTUlDX0ZUUkFDRV9XSVRIX1JFR1MpKQ0KPiArCQllbnRy
eSA9IHBwY19nbG9iYWxfZnVuY3Rpb25fZW50cnkoKHZvaWQgKilmdHJhY2VfcmVnc19jYWxsZXIp
Ow0KPiArDQo+ICsJaWYgKHB0ciAhPSBlbnRyeSkgew0KPiArCQlwcl9lcnIoIlVua25vd24gZnRy
YWNlIGFkZHIgdG8gcGF0Y2g6ICVwc1xuIiwgKHZvaWQgKilwdHIpOw0KPiArCQlyZXR1cm4gLUVJ
TlZBTDsNCj4gKwl9DQo+ICsNCj4gKwkvKiBNYWtlIHN1cmUgd2UgaGF2ZSBhIG5vcCAqLw0KPiAr
CWlmIChjb3B5X2luc3RfZnJvbV9rZXJuZWxfbm9mYXVsdCgmb3AsIGlwKSkgew0KPiArCQlwcl9l
cnIoIlVuYWJsZSB0byByZWFkIGZ0cmFjZSBsb2NhdGlvbiAlcFxuIiwgaXApOw0KPiArCQlyZXR1
cm4gLUVGQVVMVDsNCj4gKwl9DQo+ICsNCj4gKwlpZiAoIXBwY19pbnN0X2VxdWFsKG9wLCBwcGNf
aW5zdChQUENfUkFXX05PUCgpKSkpIHsNCj4gKwkJcHJfZXJyKCJVbmV4cGVjdGVkIGNhbGwgc2Vx
dWVuY2UgYXQgJXA6ICUwOGx4XG4iLA0KPiArCQkgICAgICAgaXAsIHBwY19pbnN0X2FzX3Vsb25n
KG9wKSk7DQo+ICsJCXJldHVybiAtRUlOVkFMOw0KPiArCX0NCj4gKw0KPiArCXRyYW1wID0gZmlu
ZF9mdHJhY2VfdHJhbXAoKHVuc2lnbmVkIGxvbmcpaXApOw0KPiArCWlmICghdHJhbXApIHsNCj4g
KwkJcHJfZXJyKCJObyBmdHJhY2UgdHJhbXBvbGluZXMgcmVhY2hhYmxlIGZyb20gJXBzXG4iLCBp
cCk7DQo+ICsJCXJldHVybiAtRUlOVkFMOw0KPiArCX0NCj4gKw0KPiArCWlmIChwYXRjaF9icmFu
Y2goaXAsIHRyYW1wLCBCUkFOQ0hfU0VUX0xJTkspKSB7DQo+ICsJCXByX2VycigiRXJyb3IgcGF0
Y2hpbmcgYnJhbmNoIHRvIGZ0cmFjZSB0cmFtcCFcbiIpOw0KPiArCQlyZXR1cm4gLUVJTlZBTDsN
Cj4gKwl9DQo+ICsNCj4gKwlyZXR1cm4gMDsNCj4gK30NCj4gKw0KPiAraW50IGZ0cmFjZV9tYWtl
X2NhbGwoc3RydWN0IGR5bl9mdHJhY2UgKnJlYywgdW5zaWduZWQgbG9uZyBhZGRyKQ0KPiArew0K
PiArCXVuc2lnbmVkIGxvbmcgaXAgPSByZWMtPmlwOw0KPiArCXBwY19pbnN0X3Qgb2xkLCBuZXc7
DQo+ICsNCj4gKwkvKg0KPiArCSAqIElmIHRoZSBjYWxsaW5nIGFkZHJlc3MgaXMgbW9yZSB0aGF0
IDI0IGJpdHMgYXdheSwNCj4gKwkgKiB0aGVuIHdlIGhhZCB0byB1c2UgYSB0cmFtcG9saW5lIHRv
IG1ha2UgdGhlIGNhbGwuDQo+ICsJICogT3RoZXJ3aXNlIGp1c3QgdXBkYXRlIHRoZSBjYWxsIHNp
dGUuDQo+ICsJICovDQo+ICsJaWYgKHRlc3RfMjRiaXRfYWRkcihpcCwgYWRkcikpIHsNCj4gKwkJ
Lyogd2l0aGluIHJhbmdlICovDQo+ICsJCW9sZCA9IHBwY19pbnN0KFBQQ19SQVdfTk9QKCkpOw0K
PiArCQluZXcgPSBmdHJhY2VfY2FsbF9yZXBsYWNlKGlwLCBhZGRyLCAxKTsNCj4gKwkJcmV0dXJu
IGZ0cmFjZV9tb2RpZnlfY29kZShpcCwgb2xkLCBuZXcpOw0KPiArCX0gZWxzZSBpZiAoY29yZV9r
ZXJuZWxfdGV4dChpcCkpIHsNCj4gKwkJcmV0dXJuIF9fZnRyYWNlX21ha2VfY2FsbF9rZXJuZWwo
cmVjLCBhZGRyKTsNCj4gKwl9IGVsc2UgaWYgKCFJU19FTkFCTEVEKENPTkZJR19NT0RVTEVTKSkg
ew0KPiArCQkvKiBXZSBzaG91bGQgbm90IGdldCBoZXJlIHdpdGhvdXQgbW9kdWxlcyAqLw0KPiAr
CQlyZXR1cm4gLUVJTlZBTDsNCj4gKwl9DQo+ICsNCj4gKwkvKg0KPiArCSAqIE91dCBvZiByYW5n
ZSBqdW1wcyBhcmUgY2FsbGVkIGZyb20gbW9kdWxlcy4NCj4gKwkgKiBCZWluZyB0aGF0IHdlIGFy
ZSBjb252ZXJ0aW5nIGZyb20gbm9wLCBpdCBoYWQgYmV0dGVyDQo+ICsJICogYWxyZWFkeSBoYXZl
IGEgbW9kdWxlIGRlZmluZWQuDQo+ICsJICovDQo+ICsJaWYgKCFyZWMtPmFyY2gubW9kKSB7DQo+
ICsJCXByX2VycigiTm8gbW9kdWxlIGxvYWRlZFxuIik7DQo+ICsJCXJldHVybiAtRUlOVkFMOw0K
PiArCX0NCj4gKw0KPiArCXJldHVybiBfX2Z0cmFjZV9tYWtlX2NhbGwocmVjLCBhZGRyKTsNCj4g
K30NCj4gKw0KPiArI2lmZGVmIENPTkZJR19EWU5BTUlDX0ZUUkFDRV9XSVRIX1JFR1MNCj4gKyNp
ZmRlZiBDT05GSUdfTU9EVUxFUw0KPiArc3RhdGljIGludA0KPiArX19mdHJhY2VfbW9kaWZ5X2Nh
bGwoc3RydWN0IGR5bl9mdHJhY2UgKnJlYywgdW5zaWduZWQgbG9uZyBvbGRfYWRkciwNCj4gKwkJ
CQkJdW5zaWduZWQgbG9uZyBhZGRyKQ0KPiArew0KPiArCXBwY19pbnN0X3Qgb3A7DQo+ICsJdW5z
aWduZWQgbG9uZyBpcCA9IHJlYy0+aXA7DQo+ICsJdW5zaWduZWQgbG9uZyBlbnRyeSwgcHRyLCB0
cmFtcDsNCj4gKwlzdHJ1Y3QgbW9kdWxlICptb2QgPSByZWMtPmFyY2gubW9kOw0KPiArDQo+ICsJ
LyogSWYgd2UgbmV2ZXIgc2V0IHVwIGZ0cmFjZSB0cmFtcG9saW5lcywgdGhlbiBiYWlsICovDQo+
ICsJaWYgKCFtb2QtPmFyY2gudHJhbXAgfHwgIW1vZC0+YXJjaC50cmFtcF9yZWdzKSB7DQo+ICsJ
CXByX2VycigiTm8gZnRyYWNlIHRyYW1wb2xpbmVcbiIpOw0KPiArCQlyZXR1cm4gLUVJTlZBTDsN
Cj4gKwl9DQo+ICsNCj4gKwkvKiByZWFkIHdoZXJlIHRoaXMgZ29lcyAqLw0KPiArCWlmIChjb3B5
X2luc3RfZnJvbV9rZXJuZWxfbm9mYXVsdCgmb3AsICh2b2lkICopaXApKSB7DQo+ICsJCXByX2Vy
cigiRmV0Y2hpbmcgb3Bjb2RlIGZhaWxlZC5cbiIpOw0KPiArCQlyZXR1cm4gLUVGQVVMVDsNCj4g
Kwl9DQo+ICsNCj4gKwkvKiBNYWtlIHN1cmUgdGhhdCB0aGlzIGlzIHN0aWxsIGEgMjRiaXQganVt
cCAqLw0KPiArCWlmICghaXNfYmxfb3Aob3ApKSB7DQo+ICsJCXByX2VycigiTm90IGV4cGVjdGVk
IGJsOiBvcGNvZGUgaXMgJTA4bHhcbiIsIHBwY19pbnN0X2FzX3Vsb25nKG9wKSk7DQo+ICsJCXJl
dHVybiAtRUlOVkFMOw0KPiArCX0NCj4gKw0KPiArCS8qIGxldHMgZmluZCB3aGVyZSB0aGUgcG9p
bnRlciBnb2VzICovDQo+ICsJdHJhbXAgPSBmaW5kX2JsX3RhcmdldChpcCwgb3ApOw0KPiArCWVu
dHJ5ID0gcHBjX2dsb2JhbF9mdW5jdGlvbl9lbnRyeSgodm9pZCAqKW9sZF9hZGRyKTsNCj4gKw0K
PiArCXByX2RldmVsKCJpcDolbHgganVtcHMgdG8gJWx4IiwgaXAsIHRyYW1wKTsNCj4gKw0KPiAr
CWlmICh0cmFtcCAhPSBlbnRyeSkgew0KPiArCQkvKiBvbGRfYWRkciBpcyBub3Qgd2l0aGluIHJh
bmdlLCBzbyB3ZSBtdXN0IGhhdmUgdXNlZCBhIHRyYW1wb2xpbmUgKi8NCj4gKwkJaWYgKG1vZHVs
ZV90cmFtcG9saW5lX3RhcmdldChtb2QsIHRyYW1wLCAmcHRyKSkgew0KPiArCQkJcHJfZXJyKCJG
YWlsZWQgdG8gZ2V0IHRyYW1wb2xpbmUgdGFyZ2V0XG4iKTsNCj4gKwkJCXJldHVybiAtRUZBVUxU
Ow0KPiArCQl9DQo+ICsNCj4gKwkJcHJfZGV2ZWwoInRyYW1wb2xpbmUgdGFyZ2V0ICVseCIsIHB0
cik7DQo+ICsNCj4gKwkJLyogVGhpcyBzaG91bGQgbWF0Y2ggd2hhdCB3YXMgY2FsbGVkICovDQo+
ICsJCWlmIChwdHIgIT0gZW50cnkpIHsNCj4gKwkJCXByX2VycigiYWRkciAlbHggZG9lcyBub3Qg
bWF0Y2ggZXhwZWN0ZWQgJWx4XG4iLCBwdHIsIGVudHJ5KTsNCj4gKwkJCXJldHVybiAtRUlOVkFM
Ow0KPiArCQl9DQo+ICsJfQ0KPiArDQo+ICsJLyogVGhlIG5ldyB0YXJnZXQgbWF5IGJlIHdpdGhp
biByYW5nZSAqLw0KPiArCWlmICh0ZXN0XzI0Yml0X2FkZHIoaXAsIGFkZHIpKSB7DQo+ICsJCS8q
IHdpdGhpbiByYW5nZSAqLw0KPiArCQlpZiAocGF0Y2hfYnJhbmNoKCh1MzIgKilpcCwgYWRkciwg
QlJBTkNIX1NFVF9MSU5LKSkgew0KPiArCQkJcHJfZXJyKCJSRUwyNCBvdXQgb2YgcmFuZ2UhXG4i
KTsNCj4gKwkJCXJldHVybiAtRUlOVkFMOw0KPiArCQl9DQo+ICsNCj4gKwkJcmV0dXJuIDA7DQo+
ICsJfQ0KPiArDQo+ICsJaWYgKHJlYy0+ZmxhZ3MgJiBGVFJBQ0VfRkxfUkVHUykNCj4gKwkJdHJh
bXAgPSBtb2QtPmFyY2gudHJhbXBfcmVnczsNCj4gKwllbHNlDQo+ICsJCXRyYW1wID0gbW9kLT5h
cmNoLnRyYW1wOw0KPiArDQo+ICsJaWYgKG1vZHVsZV90cmFtcG9saW5lX3RhcmdldChtb2QsIHRy
YW1wLCAmcHRyKSkgew0KPiArCQlwcl9lcnIoIkZhaWxlZCB0byBnZXQgdHJhbXBvbGluZSB0YXJn
ZXRcbiIpOw0KPiArCQlyZXR1cm4gLUVGQVVMVDsNCj4gKwl9DQo+ICsNCj4gKwlwcl9kZXZlbCgi
dHJhbXBvbGluZSB0YXJnZXQgJWx4IiwgcHRyKTsNCj4gKw0KPiArCWVudHJ5ID0gcHBjX2dsb2Jh
bF9mdW5jdGlvbl9lbnRyeSgodm9pZCAqKWFkZHIpOw0KPiArCS8qIFRoaXMgc2hvdWxkIG1hdGNo
IHdoYXQgd2FzIGNhbGxlZCAqLw0KPiArCWlmIChwdHIgIT0gZW50cnkpIHsNCj4gKwkJcHJfZXJy
KCJhZGRyICVseCBkb2VzIG5vdCBtYXRjaCBleHBlY3RlZCAlbHhcbiIsIHB0ciwgZW50cnkpOw0K
PiArCQlyZXR1cm4gLUVJTlZBTDsNCj4gKwl9DQo+ICsNCj4gKwlpZiAocGF0Y2hfYnJhbmNoKCh1
MzIgKilpcCwgdHJhbXAsIEJSQU5DSF9TRVRfTElOSykpIHsNCj4gKwkJcHJfZXJyKCJSRUwyNCBv
dXQgb2YgcmFuZ2UhXG4iKTsNCj4gKwkJcmV0dXJuIC1FSU5WQUw7DQo+ICsJfQ0KPiArDQo+ICsJ
cmV0dXJuIDA7DQo+ICt9DQo+ICsjZWxzZQ0KPiArc3RhdGljIGludCBfX2Z0cmFjZV9tb2RpZnlf
Y2FsbChzdHJ1Y3QgZHluX2Z0cmFjZSAqcmVjLCB1bnNpZ25lZCBsb25nIG9sZF9hZGRyLCB1bnNp
Z25lZCBsb25nIGFkZHIpDQo+ICt7DQo+ICsJcmV0dXJuIDA7DQo+ICt9DQo+ICsjZW5kaWYNCj4g
Kw0KPiAraW50IGZ0cmFjZV9tb2RpZnlfY2FsbChzdHJ1Y3QgZHluX2Z0cmFjZSAqcmVjLCB1bnNp
Z25lZCBsb25nIG9sZF9hZGRyLA0KPiArCQkJdW5zaWduZWQgbG9uZyBhZGRyKQ0KPiArew0KPiAr
CXVuc2lnbmVkIGxvbmcgaXAgPSByZWMtPmlwOw0KPiArCXBwY19pbnN0X3Qgb2xkLCBuZXc7DQo+
ICsNCj4gKwkvKg0KPiArCSAqIElmIHRoZSBjYWxsaW5nIGFkZHJlc3MgaXMgbW9yZSB0aGF0IDI0
IGJpdHMgYXdheSwNCj4gKwkgKiB0aGVuIHdlIGhhZCB0byB1c2UgYSB0cmFtcG9saW5lIHRvIG1h
a2UgdGhlIGNhbGwuDQo+ICsJICogT3RoZXJ3aXNlIGp1c3QgdXBkYXRlIHRoZSBjYWxsIHNpdGUu
DQo+ICsJICovDQo+ICsJaWYgKHRlc3RfMjRiaXRfYWRkcihpcCwgYWRkcikgJiYgdGVzdF8yNGJp
dF9hZGRyKGlwLCBvbGRfYWRkcikpIHsNCj4gKwkJLyogd2l0aGluIHJhbmdlICovDQo+ICsJCW9s
ZCA9IGZ0cmFjZV9jYWxsX3JlcGxhY2UoaXAsIG9sZF9hZGRyLCAxKTsNCj4gKwkJbmV3ID0gZnRy
YWNlX2NhbGxfcmVwbGFjZShpcCwgYWRkciwgMSk7DQo+ICsJCXJldHVybiBmdHJhY2VfbW9kaWZ5
X2NvZGUoaXAsIG9sZCwgbmV3KTsNCj4gKwl9IGVsc2UgaWYgKGNvcmVfa2VybmVsX3RleHQoaXAp
KSB7DQo+ICsJCS8qDQo+ICsJCSAqIFdlIGFsd2F5cyBwYXRjaCBvdXQgb2YgcmFuZ2UgbG9jYXRp
b25zIHRvIGdvIHRvIHRoZSByZWdzDQo+ICsJCSAqIHZhcmlhbnQsIHNvIHRoZXJlIGlzIG5vdGhp
bmcgdG8gZG8gaGVyZQ0KPiArCQkgKi8NCj4gKwkJcmV0dXJuIDA7DQo+ICsJfSBlbHNlIGlmICgh
SVNfRU5BQkxFRChDT05GSUdfTU9EVUxFUykpIHsNCj4gKwkJLyogV2Ugc2hvdWxkIG5vdCBnZXQg
aGVyZSB3aXRob3V0IG1vZHVsZXMgKi8NCj4gKwkJcmV0dXJuIC1FSU5WQUw7DQo+ICsJfQ0KPiAr
DQo+ICsJLyoNCj4gKwkgKiBPdXQgb2YgcmFuZ2UganVtcHMgYXJlIGNhbGxlZCBmcm9tIG1vZHVs
ZXMuDQo+ICsJICovDQo+ICsJaWYgKCFyZWMtPmFyY2gubW9kKSB7DQo+ICsJCXByX2VycigiTm8g
bW9kdWxlIGxvYWRlZFxuIik7DQo+ICsJCXJldHVybiAtRUlOVkFMOw0KPiArCX0NCj4gKw0KPiAr
CXJldHVybiBfX2Z0cmFjZV9tb2RpZnlfY2FsbChyZWMsIG9sZF9hZGRyLCBhZGRyKTsNCj4gK30N
Cj4gKyNlbmRpZg0KPiArDQo+ICtpbnQgZnRyYWNlX3VwZGF0ZV9mdHJhY2VfZnVuYyhmdHJhY2Vf
ZnVuY190IGZ1bmMpDQo+ICt7DQo+ICsJdW5zaWduZWQgbG9uZyBpcCA9ICh1bnNpZ25lZCBsb25n
KSgmZnRyYWNlX2NhbGwpOw0KPiArCXBwY19pbnN0X3Qgb2xkLCBuZXc7DQo+ICsJaW50IHJldDsN
Cj4gKw0KPiArCW9sZCA9IHBwY19pbnN0X3JlYWQoKHUzMiAqKSZmdHJhY2VfY2FsbCk7DQo+ICsJ
bmV3ID0gZnRyYWNlX2NhbGxfcmVwbGFjZShpcCwgKHVuc2lnbmVkIGxvbmcpZnVuYywgMSk7DQo+
ICsJcmV0ID0gZnRyYWNlX21vZGlmeV9jb2RlKGlwLCBvbGQsIG5ldyk7DQo+ICsNCj4gKwkvKiBB
bHNvIHVwZGF0ZSB0aGUgcmVncyBjYWxsYmFjayBmdW5jdGlvbiAqLw0KPiArCWlmIChJU19FTkFC
TEVEKENPTkZJR19EWU5BTUlDX0ZUUkFDRV9XSVRIX1JFR1MpICYmICFyZXQpIHsNCj4gKwkJaXAg
PSAodW5zaWduZWQgbG9uZykoJmZ0cmFjZV9yZWdzX2NhbGwpOw0KPiArCQlvbGQgPSBwcGNfaW5z
dF9yZWFkKCh1MzIgKikmZnRyYWNlX3JlZ3NfY2FsbCk7DQo+ICsJCW5ldyA9IGZ0cmFjZV9jYWxs
X3JlcGxhY2UoaXAsICh1bnNpZ25lZCBsb25nKWZ1bmMsIDEpOw0KPiArCQlyZXQgPSBmdHJhY2Vf
bW9kaWZ5X2NvZGUoaXAsIG9sZCwgbmV3KTsNCj4gKwl9DQo+ICsNCj4gKwlyZXR1cm4gcmV0Ow0K
PiArfQ0KPiArDQo+ICsvKg0KPiArICogVXNlIHRoZSBkZWZhdWx0IGZ0cmFjZV9tb2RpZnlfYWxs
X2NvZGUsIGJ1dCB3aXRob3V0DQo+ICsgKiBzdG9wX21hY2hpbmUoKS4NCj4gKyAqLw0KPiArdm9p
ZCBhcmNoX2Z0cmFjZV91cGRhdGVfY29kZShpbnQgY29tbWFuZCkNCj4gK3sNCj4gKwlmdHJhY2Vf
bW9kaWZ5X2FsbF9jb2RlKGNvbW1hbmQpOw0KPiArfQ0KPiArDQo+ICsjaWZkZWYgQ09ORklHX1BQ
QzY0DQo+ICsjZGVmaW5lIFBBQ0FUT0Mgb2Zmc2V0b2Yoc3RydWN0IHBhY2Ffc3RydWN0LCBrZXJu
ZWxfdG9jKQ0KPiArDQo+ICtleHRlcm4gdW5zaWduZWQgaW50IGZ0cmFjZV90cmFtcF90ZXh0W10s
IGZ0cmFjZV90cmFtcF9pbml0W107DQo+ICsNCj4gK3ZvaWQgZnRyYWNlX2ZyZWVfaW5pdF90cmFt
cCh2b2lkKQ0KPiArew0KPiArCWludCBpOw0KPiArDQo+ICsJZm9yIChpID0gMDsgaSA8IE5VTV9G
VFJBQ0VfVFJBTVBTICYmIGZ0cmFjZV90cmFtcHNbaV07IGkrKykNCj4gKwkJaWYgKGZ0cmFjZV90
cmFtcHNbaV0gPT0gKHVuc2lnbmVkIGxvbmcpZnRyYWNlX3RyYW1wX2luaXQpIHsNCj4gKwkJCWZ0
cmFjZV90cmFtcHNbaV0gPSAwOw0KPiArCQkJcmV0dXJuOw0KPiArCQl9DQo+ICt9DQo+ICsNCj4g
K2ludCBfX2luaXQgZnRyYWNlX2R5bl9hcmNoX2luaXQodm9pZCkNCj4gK3sNCj4gKwlpbnQgaTsN
Cj4gKwl1bnNpZ25lZCBpbnQgKnRyYW1wW10gPSB7IGZ0cmFjZV90cmFtcF90ZXh0LCBmdHJhY2Vf
dHJhbXBfaW5pdCB9Ow0KPiArCXUzMiBzdHViX2luc25zW10gPSB7DQo+ICsJCVBQQ19SQVdfTEQo
X1IxMiwgX1IxMywgUEFDQVRPQyksDQo+ICsJCVBQQ19SQVdfQURESVMoX1IxMiwgX1IxMiwgMCks
DQo+ICsJCVBQQ19SQVdfQURESShfUjEyLCBfUjEyLCAwKSwNCj4gKwkJUFBDX1JBV19NVENUUihf
UjEyKSwNCj4gKwkJUFBDX1JBV19CQ1RSKCkNCj4gKwl9Ow0KPiArCXVuc2lnbmVkIGxvbmcgYWRk
cjsNCj4gKwlsb25nIHJlbGFkZHI7DQo+ICsNCj4gKwlpZiAoSVNfRU5BQkxFRChDT05GSUdfRFlO
QU1JQ19GVFJBQ0VfV0lUSF9SRUdTKSkNCj4gKwkJYWRkciA9IHBwY19nbG9iYWxfZnVuY3Rpb25f
ZW50cnkoKHZvaWQgKilmdHJhY2VfcmVnc19jYWxsZXIpOw0KPiArCWVsc2UNCj4gKwkJYWRkciA9
IHBwY19nbG9iYWxfZnVuY3Rpb25fZW50cnkoKHZvaWQgKilmdHJhY2VfY2FsbGVyKTsNCj4gKw0K
PiArCXJlbGFkZHIgPSBhZGRyIC0ga2VybmVsX3RvY19hZGRyKCk7DQo+ICsNCj4gKwlpZiAocmVs
YWRkciA+PSBTWl8yRyB8fCByZWxhZGRyIDwgLShsb25nKVNaXzJHKSB7DQo+ICsJCXByX2Vycigi
QWRkcmVzcyBvZiAlcHMgb3V0IG9mIHJhbmdlIG9mIGtlcm5lbF90b2MuXG4iLA0KPiArCQkJCSh2
b2lkICopYWRkcik7DQo+ICsJCXJldHVybiAtMTsNCj4gKwl9DQo+ICsNCj4gKwlmb3IgKGkgPSAw
OyBpIDwgMjsgaSsrKSB7DQo+ICsJCW1lbWNweSh0cmFtcFtpXSwgc3R1Yl9pbnNucywgc2l6ZW9m
KHN0dWJfaW5zbnMpKTsNCj4gKwkJdHJhbXBbaV1bMV0gfD0gUFBDX0hBKHJlbGFkZHIpOw0KPiAr
CQl0cmFtcFtpXVsyXSB8PSBQUENfTE8ocmVsYWRkcik7DQo+ICsJCWFkZF9mdHJhY2VfdHJhbXAo
KHVuc2lnbmVkIGxvbmcpdHJhbXBbaV0pOw0KPiArCX0NCj4gKw0KPiArCXJldHVybiAwOw0KPiAr
fQ0KPiArI2VuZGlmDQo+ICsNCj4gKyNpZmRlZiBDT05GSUdfRlVOQ1RJT05fR1JBUEhfVFJBQ0VS
DQo+ICsNCj4gK2V4dGVybiB2b2lkIGZ0cmFjZV9ncmFwaF9jYWxsKHZvaWQpOw0KPiArZXh0ZXJu
IHZvaWQgZnRyYWNlX2dyYXBoX3N0dWIodm9pZCk7DQo+ICsNCj4gK3N0YXRpYyBpbnQgZnRyYWNl
X21vZGlmeV9mdHJhY2VfZ3JhcGhfY2FsbGVyKGJvb2wgZW5hYmxlKQ0KPiArew0KPiArCXVuc2ln
bmVkIGxvbmcgaXAgPSAodW5zaWduZWQgbG9uZykoJmZ0cmFjZV9ncmFwaF9jYWxsKTsNCj4gKwl1
bnNpZ25lZCBsb25nIGFkZHIgPSAodW5zaWduZWQgbG9uZykoJmZ0cmFjZV9ncmFwaF9jYWxsZXIp
Ow0KPiArCXVuc2lnbmVkIGxvbmcgc3R1YiA9ICh1bnNpZ25lZCBsb25nKSgmZnRyYWNlX2dyYXBo
X3N0dWIpOw0KPiArCXBwY19pbnN0X3Qgb2xkLCBuZXc7DQo+ICsNCj4gKwlpZiAoSVNfRU5BQkxF
RChDT05GSUdfRFlOQU1JQ19GVFJBQ0VfV0lUSF9BUkdTKSkNCj4gKwkJcmV0dXJuIDA7DQo+ICsN
Cj4gKwlvbGQgPSBmdHJhY2VfY2FsbF9yZXBsYWNlKGlwLCBlbmFibGUgPyBzdHViIDogYWRkciwg
MCk7DQo+ICsJbmV3ID0gZnRyYWNlX2NhbGxfcmVwbGFjZShpcCwgZW5hYmxlID8gYWRkciA6IHN0
dWIsIDApOw0KPiArDQo+ICsJcmV0dXJuIGZ0cmFjZV9tb2RpZnlfY29kZShpcCwgb2xkLCBuZXcp
Ow0KPiArfQ0KPiArDQo+ICtpbnQgZnRyYWNlX2VuYWJsZV9mdHJhY2VfZ3JhcGhfY2FsbGVyKHZv
aWQpDQo+ICt7DQo+ICsJcmV0dXJuIGZ0cmFjZV9tb2RpZnlfZnRyYWNlX2dyYXBoX2NhbGxlcih0
cnVlKTsNCj4gK30NCj4gKw0KPiAraW50IGZ0cmFjZV9kaXNhYmxlX2Z0cmFjZV9ncmFwaF9jYWxs
ZXIodm9pZCkNCj4gK3sNCj4gKwlyZXR1cm4gZnRyYWNlX21vZGlmeV9mdHJhY2VfZ3JhcGhfY2Fs
bGVyKGZhbHNlKTsNCj4gK30NCj4gKw0KPiArLyoNCj4gKyAqIEhvb2sgdGhlIHJldHVybiBhZGRy
ZXNzIGFuZCBwdXNoIGl0IGluIHRoZSBzdGFjayBvZiByZXR1cm4gYWRkcnMNCj4gKyAqIGluIGN1
cnJlbnQgdGhyZWFkIGluZm8uIFJldHVybiB0aGUgYWRkcmVzcyB3ZSB3YW50IHRvIGRpdmVydCB0
by4NCj4gKyAqLw0KPiArc3RhdGljIHVuc2lnbmVkIGxvbmcNCj4gK19fcHJlcGFyZV9mdHJhY2Vf
cmV0dXJuKHVuc2lnbmVkIGxvbmcgcGFyZW50LCB1bnNpZ25lZCBsb25nIGlwLCB1bnNpZ25lZCBs
b25nIHNwKQ0KPiArew0KPiArCXVuc2lnbmVkIGxvbmcgcmV0dXJuX2hvb2tlcjsNCj4gKwlpbnQg
Yml0Ow0KPiArDQo+ICsJaWYgKHVubGlrZWx5KGZ0cmFjZV9ncmFwaF9pc19kZWFkKCkpKQ0KPiAr
CQlnb3RvIG91dDsNCj4gKw0KPiArCWlmICh1bmxpa2VseShhdG9taWNfcmVhZCgmY3VycmVudC0+
dHJhY2luZ19ncmFwaF9wYXVzZSkpKQ0KPiArCQlnb3RvIG91dDsNCj4gKw0KPiArCWJpdCA9IGZ0
cmFjZV90ZXN0X3JlY3Vyc2lvbl90cnlsb2NrKGlwLCBwYXJlbnQpOw0KPiArCWlmIChiaXQgPCAw
KQ0KPiArCQlnb3RvIG91dDsNCj4gKw0KPiArCXJldHVybl9ob29rZXIgPSBwcGNfZnVuY3Rpb25f
ZW50cnkocmV0dXJuX3RvX2hhbmRsZXIpOw0KPiArDQo+ICsJaWYgKCFmdW5jdGlvbl9ncmFwaF9l
bnRlcihwYXJlbnQsIGlwLCAwLCAodW5zaWduZWQgbG9uZyAqKXNwKSkNCj4gKwkJcGFyZW50ID0g
cmV0dXJuX2hvb2tlcjsNCj4gKw0KPiArCWZ0cmFjZV90ZXN0X3JlY3Vyc2lvbl91bmxvY2soYml0
KTsNCj4gK291dDoNCj4gKwlyZXR1cm4gcGFyZW50Ow0KPiArfQ0KPiArDQo+ICsjaWZkZWYgQ09O
RklHX0RZTkFNSUNfRlRSQUNFX1dJVEhfQVJHUw0KPiArdm9pZCBmdHJhY2VfZ3JhcGhfZnVuYyh1
bnNpZ25lZCBsb25nIGlwLCB1bnNpZ25lZCBsb25nIHBhcmVudF9pcCwNCj4gKwkJICAgICAgIHN0
cnVjdCBmdHJhY2Vfb3BzICpvcCwgc3RydWN0IGZ0cmFjZV9yZWdzICpmcmVncykNCj4gK3sNCj4g
KwlmcmVncy0+cmVncy5saW5rID0gX19wcmVwYXJlX2Z0cmFjZV9yZXR1cm4ocGFyZW50X2lwLCBp
cCwgZnJlZ3MtPnJlZ3MuZ3ByWzFdKTsNCj4gK30NCj4gKyNlbHNlDQo+ICt1bnNpZ25lZCBsb25n
IHByZXBhcmVfZnRyYWNlX3JldHVybih1bnNpZ25lZCBsb25nIHBhcmVudCwgdW5zaWduZWQgbG9u
ZyBpcCwNCj4gKwkJCQkgICAgdW5zaWduZWQgbG9uZyBzcCkNCj4gK3sNCj4gKwlyZXR1cm4gX19w
cmVwYXJlX2Z0cmFjZV9yZXR1cm4ocGFyZW50LCBpcCwgc3ApOw0KPiArfQ0KPiArI2VuZGlmDQo+
ICsjZW5kaWYgLyogQ09ORklHX0ZVTkNUSU9OX0dSQVBIX1RSQUNFUiAqLw0KPiArDQo+ICsjaWZk
ZWYgQ09ORklHX1BQQzY0X0VMRl9BQklfVjENCj4gK2NoYXIgKmFyY2hfZnRyYWNlX21hdGNoX2Fk
anVzdChjaGFyICpzdHIsIGNvbnN0IGNoYXIgKnNlYXJjaCkNCj4gK3sNCj4gKwlpZiAoc3RyWzBd
ID09ICcuJyAmJiBzZWFyY2hbMF0gIT0gJy4nKQ0KPiArCQlyZXR1cm4gc3RyICsgMTsNCj4gKwll
bHNlDQo+ICsJCXJldHVybiBzdHI7DQo+ICt9DQo+ICsjZW5kaWYgLyogQ09ORklHX1BQQzY0X0VM
Rl9BQklfVjEgKi8NCg==
