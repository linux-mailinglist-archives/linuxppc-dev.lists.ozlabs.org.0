Return-Path: <linuxppc-dev-bounces+lists+linuxppc-dev=lfdr.de@lists.ozlabs.org>
X-Original-To: lists+linuxppc-dev@lfdr.de
Delivered-To: lists+linuxppc-dev@lfdr.de
Received: from lists.ozlabs.org (lists.ozlabs.org [IPv6:2404:9400:2:0:216:3eff:fee1:b9f1])
	by mail.lfdr.de (Postfix) with ESMTPS id DD700924239
	for <lists+linuxppc-dev@lfdr.de>; Tue,  2 Jul 2024 17:20:43 +0200 (CEST)
Authentication-Results: lists.ozlabs.org;
	dkim=fail reason="signature verification failed" (2048-bit key; unprotected) header.d=kernel.org header.i=@kernel.org header.a=rsa-sha256 header.s=k20201202 header.b=K6i1SNuY;
	dkim-atps=neutral
Received: from boromir.ozlabs.org (localhost [IPv6:::1])
	by lists.ozlabs.org (Postfix) with ESMTP id 4WD66x5Nz0z3fSg
	for <lists+linuxppc-dev@lfdr.de>; Wed,  3 Jul 2024 01:20:41 +1000 (AEST)
X-Original-To: linuxppc-dev@lists.ozlabs.org
Delivered-To: linuxppc-dev@lists.ozlabs.org
Authentication-Results: lists.ozlabs.org; dmarc=pass (p=none dis=none) header.from=kernel.org
Authentication-Results: lists.ozlabs.org;
	dkim=pass (2048-bit key; unprotected) header.d=kernel.org header.i=@kernel.org header.a=rsa-sha256 header.s=k20201202 header.b=K6i1SNuY;
	dkim-atps=neutral
Authentication-Results: lists.ozlabs.org; spf=pass (sender SPF authorized) smtp.mailfrom=kernel.org (client-ip=139.178.84.217; helo=dfw.source.kernel.org; envelope-from=maz@kernel.org; receiver=lists.ozlabs.org)
Received: from dfw.source.kernel.org (dfw.source.kernel.org [139.178.84.217])
	(using TLSv1.3 with cipher TLS_AES_256_GCM_SHA384 (256/256 bits)
	 key-exchange X25519 server-signature RSA-PSS (2048 bits) server-digest SHA256)
	(No client certificate requested)
	by lists.ozlabs.org (Postfix) with ESMTPS id 4WD66F0bn5z3cTD
	for <linuxppc-dev@lists.ozlabs.org>; Wed,  3 Jul 2024 01:20:05 +1000 (AEST)
Received: from smtp.kernel.org (transwarp.subspace.kernel.org [100.75.92.58])
	by dfw.source.kernel.org (Postfix) with ESMTP id C421B61D5C;
	Tue,  2 Jul 2024 15:20:02 +0000 (UTC)
Received: by smtp.kernel.org (Postfix) with ESMTPSA id 7421BC116B1;
	Tue,  2 Jul 2024 15:20:02 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=kernel.org;
	s=k20201202; t=1719933602;
	bh=vDRfgq1khjg3V3GqZTi2bS11LujWGqPMZ8TLlczYvnA=;
	h=Date:From:To:Cc:Subject:In-Reply-To:References:From;
	b=K6i1SNuYGTNT6OO7pKaDxagvIFhwMk/t6uNJ9i46XtUxP4y5uzmIZICtKnJoLWvyi
	 bAfF4fZTOJbdEWSWfisAINCU7oOyYbWkmSmscs7ke8iVrcTAVPvRYirHnCllSmU1I2
	 uCIvzfnu8OIIbanoZCrinKiyQfZ9LIt+3iY0PpQcmuHg9Q0/bvX722/lqmk9bOVsci
	 zjgN3S/rCZalTlcvt6P9xAIlOvoCeI5Nl6cr9j20FoC4Dyhq5hiS90LMMXlljEWo3s
	 6jHC3aA9BNmSbcRduDOZcYCOAE0ZvZxXmoFvCPj394sPQzvzSQwmN3PXaToy6F5OYa
	 2/uBd1pdHcWyg==
Received: from sofa.misterjones.org ([185.219.108.64] helo=goblin-girl.misterjones.org)
	by disco-boy.misterjones.org with esmtpsa  (TLS1.3) tls TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
	(Exim 4.95)
	(envelope-from <maz@kernel.org>)
	id 1sOfIV-0099Nu-US;
	Tue, 02 Jul 2024 16:20:00 +0100
Date: Tue, 02 Jul 2024 16:19:59 +0100
Message-ID: <861q4bizxc.wl-maz@kernel.org>
From: Marc Zyngier <maz@kernel.org>
To: Christian Zigotzky <chzigotzky@xenosoft.de>
Subject: Re: [PowerPC] [PASEMI] Issue with the identification of ATA drives after the of/irq updates 2024-05-29
In-Reply-To: <3ab66fab-c3f2-4bed-a04d-a10c57dcdd9b@xenosoft.de>
References: <3ab66fab-c3f2-4bed-a04d-a10c57dcdd9b@xenosoft.de>
User-Agent: Wanderlust/2.15.9 (Almost Unreal) SEMI-EPG/1.14.7 (Harue)
 FLIM-LB/1.14.9 (=?UTF-8?B?R29qxY0=?=) APEL-LB/10.8 EasyPG/1.0.0 Emacs/29.2
 (aarch64-unknown-linux-gnu) MULE/6.0 (HANACHIRUSATO)
MIME-Version: 1.0 (generated by SEMI-EPG 1.14.7 - "Harue")
Content-Type: text/plain; charset=US-ASCII
X-SA-Exim-Connect-IP: 185.219.108.64
X-SA-Exim-Rcpt-To: chzigotzky@xenosoft.de, robh@kernel.org, apatel@ventanamicro.com, devicetree@vger.kernel.org, linux-kernel@vger.kernel.org, linuxppc-dev@lists.ozlabs.org, madskateman@gmail.com, rtd2@xtra.co.nz, matthew@a-eon.biz, darren@stevens-zone.net, info@xenosoft.de
X-SA-Exim-Mail-From: maz@kernel.org
X-SA-Exim-Scanned: No (on disco-boy.misterjones.org); SAEximRunCond expanded to false
X-BeenThere: linuxppc-dev@lists.ozlabs.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Linux on PowerPC Developers Mail List <linuxppc-dev.lists.ozlabs.org>
List-Unsubscribe: <https://lists.ozlabs.org/options/linuxppc-dev>,
 <mailto:linuxppc-dev-request@lists.ozlabs.org?subject=unsubscribe>
List-Archive: <http://lists.ozlabs.org/pipermail/linuxppc-dev/>
List-Post: <mailto:linuxppc-dev@lists.ozlabs.org>
List-Help: <mailto:linuxppc-dev-request@lists.ozlabs.org?subject=help>
List-Subscribe: <https://lists.ozlabs.org/listinfo/linuxppc-dev>,
 <mailto:linuxppc-dev-request@lists.ozlabs.org?subject=subscribe>
Cc: apatel@ventanamicro.com, Rob Herring <robh@kernel.org>, Darren Stevens <darren@stevens-zone.net>, "R.T.Dickinson" <rtd2@xtra.co.nz>, DTML <devicetree@vger.kernel.org>, Linux Kernel Mailing List <linux-kernel@vger.kernel.org>, mad skateman <madskateman@gmail.com>, Matthew Leaman <matthew@a-eon.biz>, linuxppc-dev <linuxppc-dev@lists.ozlabs.org>, Christian Zigotzky <info@xenosoft.de>
Errors-To: linuxppc-dev-bounces+lists+linuxppc-dev=lfdr.de@lists.ozlabs.org
Sender: "Linuxppc-dev" <linuxppc-dev-bounces+lists+linuxppc-dev=lfdr.de@lists.ozlabs.org>

Christian,

On Sun, 30 Jun 2024 11:21:55 +0100,
Christian Zigotzky <chzigotzky@xenosoft.de> wrote:
> 
> Hello,
> 
> There is an issue with the identification of ATA drives with our
> P.A. Semi Nemo boards [1] after the
> commit "of/irq: Factor out parsing of interrupt-map parent
> phandle+args from of_irq_parse_raw()" [2].
> 
> Error messages:
> 
> ata2.00: failed to IDENTIFY (I/O error, err_mask=0x4)
> ata2.00: qc timeout after 10000 mssecs (cmd 0xec)
> 
> Screenshots [3]
> 
> I bisected yesterday [4] and "of/irq: Factor out parsing of
> interrupt-map parent phandle+args from of_irq_parse_raw()" [2] is the
> first bad commit.
> 
> Then I created a patch for reverting this first bad commit. I also
> reverted the changes in drivers/of/property.c. [5]
> 
> The patched kernel boots with successful detection of the ATA devices.
> 
> Please check the of/irq updates.

It is hard to understand what is going on with so little information.

Please provide the device tree for your platform. It isn't possible to
debug this without it, no matter how many pictures you provide. If it
doesn't exist in source form, you can dump it using:

# dtc -I dtb /sys/firmware/fdt

and posting the full output.

Additionally, a full dmesg of both working and non working boots would
be useful.

Thanks,

	M.

-- 
Without deviation from the norm, progress is not possible.
